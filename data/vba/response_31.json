[{"tags": ["sql", "performance", "vba", "ms-access", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 4965908, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155655834780066/picture?type=large", "display_name": "Deaner117", "link": "https://stackoverflow.com/users/4965908/deaner117"}, "edited": false, "score": 0, "creation_date": 1439479945, "post_id": 31981767, "comment_id": 51889446, "body": "Thanks for the response. I just tried .Column and it is equally slow. It seems that the combobox also has to populate before accessing values via .Column. I tried the recordset method, to no avail. Also, the comboboxes are not restricted to a sequence. The user can start in any box. E.g: a user could go to the &quot;Model&quot; box and select &quot;Corolla&quot; before having selected &quot;Toyota&quot; in the &quot;Make&quot; box. The Model box would just list all models from all car manufacturers if they did so. If they started by selecting Toyota, however, then only Toyota models would be left to choose from in the Model box."}, {"owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "reply_to_user": {"reputation": 36, "user_id": 4965908, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155655834780066/picture?type=large", "display_name": "Deaner117", "link": "https://stackoverflow.com/users/4965908/deaner117"}, "edited": false, "score": 0, "creation_date": 1439503479, "post_id": 31981767, "comment_id": 51901811, "body": "Might be time to look at getting an MS SQL Server backend, then you can use table-valued functions, which should see significant speed gains."}, {"owner": {"reputation": 36, "user_id": 4965908, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155655834780066/picture?type=large", "display_name": "Deaner117", "link": "https://stackoverflow.com/users/4965908/deaner117"}, "edited": false, "score": 0, "creation_date": 1439567341, "post_id": 31981767, "comment_id": 51930370, "body": "Thanks JCro. Yeah, upon further investigation I think my speed limitations may be from running the actual queries to populate the comboboxes, not from the population of the comboboxes directly."}], "tags": [], "owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "is_accepted": false, "score": 0, "last_activity_date": 1439449963, "creation_date": 1439449963, "answer_id": 31981767, "question_id": 31977341, "link": "https://stackoverflow.com/questions/31977341/accessing-the-first-few-items-in-a-comboboxs-rowsource-before-the-whole-list-ha/31981767#31981767", "title": "Accessing the first few items in a Combobox&#39;s rowsource before the whole list has populated (populated by SQL string)", "body": "<p>Two things to try:</p>\n\n<p>1) Just use Me.ComboBox.Column(0,1) to check.</p>\n\n<p>2) Use a recordset object and step forward once, then check for rst.EOF</p>\n\n<pre><code>Dim rst As ADODB.Recordset\nSet rst = New ADODB.Recordset\nrst.ActiveConnection = CurrentProject.Connection\nrst.CursorType = adOpenStatic\nrst.LockType = adLockOptimistic\n\nrst.Open \"SELECT * FROM tblMyTable WHERE Condition=1\"\n\nrst.MoveNext\n\nif rst.EOF then\n'Only one row in RST\nend if\n</code></pre>\n\n<p>But I think the best option would be to leave all comboboxes unbound until the immediate previous combobox is filled.</p>\n\n<p>That way you are only loading one at a time. If they are sequentially dependant then you can assume that as soon as one returns 0 rows, then all subsequent comboboxes will have zero rows.</p>\n"}], "owner": {"reputation": 36, "user_id": 4965908, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155655834780066/picture?type=large", "display_name": "Deaner117", "link": "https://stackoverflow.com/users/4965908/deaner117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439449963, "creation_date": 1439423792, "question_id": 31977341, "link": "https://stackoverflow.com/questions/31977341/accessing-the-first-few-items-in-a-comboboxs-rowsource-before-the-whole-list-ha", "title": "Accessing the first few items in a Combobox&#39;s rowsource before the whole list has populated (populated by SQL string)", "body": "<p>SO, I've looked everywhere and I'm at a loss. I'm building an access database. <br><br>\nI have a form with 18 comboboxes on it. The combobox rowsources are set via vba using SQL SELECT statements (see SetSourcetbl sub below). The idea is for the user to \"filter\" records based on any of the fields (comboboxes) they choose. After a combobox is updated, an SQL WHERE statement is tagged onto the end of the rowsource query for each combobox on the form, so each box is updated to only display records from the predefined query (qryListAll) that meet the \"filters\" the user has selected so far.<br> <br>\nBasically the user is using these comboboxes to build a specific SQL statement that will be used to populate a \"results\" form later on. <br> <br>\nEach field allows zero length strings. I've set it up so that if the \"filter\" (SQL statement) they've built results in one of the comboboxes having exactly one item left in its list that isn't a zero length string, the combobox is set to that item. If the query they've built results in only the zero length string (or a \"single space\" entry) being left in the combobox's list, the combobox turns red. <br> <br>\nMy issue is that after an item has been selected in one box and all of the rowsources for the other boxes have been updated with the new SQL string, it takes a long time to check if .ListCount = 1 for each box, since the combobox has to be entirely populated before checking the .ListCount property (and each box has between ~10 and 1000 items in its list).<br><br>\nIs there any way (like with a recordset's .RecordCount property) to know if there is more than one item in the combobox's list without waiting for the whole list to populate? I tried setting a recordset to the same SQL string used for the rowsource of each box and using the .RecordCount property or the .Move property (to check if a second/third item exists), but it takes just as long to Set the recordset to each SQL string as it does to wait for the combobox's .ListCount to load. Here is my code. Note that SQLCriteria is a global string (bad, bad, I know) that records which \"filters\" have been applied thus far, and FilterCounter is a global long to see whether the SQL string needs to be prefixes with a \"WHERE \" or an \"AND \" (basically checking if the current filter is the first one that's been applied so far):<br><br></p>\n\n<p>The update event of one of the comboboxes (they are all essentially the same):<br></p>\n\n<pre><code>Private Sub SelectOEMName_AfterUpdate()\n    UpdateBrowseField Me.SelectOEMName\n    Me!SelectFamilyName.SetFocus\n    AutofillComboBoxes\nEnd Sub\n</code></pre>\n\n<p><br>\nAnd the corresponding functions that are called:<br></p>\n\n<pre><code>Private Sub AutofillComboBoxes()\nDim Ctl As Control\n\nFor Each Ctl In Me.Controls\n    If Ctl.ControlType = acComboBox Then\n        If Ctl.ListCount = 1 Then\n            If Ctl.ItemData(0) = \"\" Or Ctl.ItemData(0) = \" \" Or _\n                                    IsNull(Ctl.ItemData(0)) Then\n                Ctl.BackColor = REDTINT\n            Else\n                Ctl = Ctl.ItemData(0)\n            End If\n        End If\n        Ctl.RowSource = \"\"\n    End If\nNext Ctl\n\nSetSourcetbl\nEnd Sub\n</code></pre>\n\n<p><br>\nThe UpdateBrowseField sub (in a public module): <br></p>\n\n<pre><code>Public Sub UpdateBrowseField(Ctl As Control)\n   Dim FieldName As String\n   FieldName = Replace(Ctl.Name, \"Select\", \"\")\n\n   If Ctl &lt;&gt; \"\" And Ctl &lt;&gt; \" \" And IsNull(Ctl) = False Then\n       If FilterCounter = 0 Then\n           SQLCriteria = \" WHERE \" &amp; FieldName &amp; \" = '\" &amp; Ctl.Value &amp; \"'\"\n       Else\n           SQLCriteria = SQLCriteria &amp; \" AND \" &amp; FieldName &amp; \" = '\" &amp; Ctl.Value &amp; \"'\"\n       End If\n\n       SetSourcetbl\n       FilterCounter = FilterCounter + 1\n\n       Ctl.BackColor = BLUETINT\n       Ctl.BackTint = 1\n       If Ctl.Enabled = True Then Ctl.SetFocus\n   End If\nEnd Sub\n</code></pre>\n\n<p><br><br>\nThe SetSourcetbl Sub (in a public module):<br></p>\n\n<pre><code>Public Sub SetSourcetbl()\n   Dim CurrentForm As Form\n\n   For Each CurrentForm In Application.Forms\n       If CurrentForm.Visible And (CurrentForm.Name = \"frmChooseReport\" Or CurrentForm.Name = \"frmBrowse\") Then Exit For\n   Next CurrentForm\n\n   If CurrentForm.Name = \"frmChooseReport\" Or CurrentForm.Name = \"frmBrowse\" Then\n       With CurrentForm.Controls\n           !SelectOEMName.RowSource = \"SELECT DISTINCT OEMName FROM (SELECT * FROM qryListAll\" &amp; SQLCriteria &amp; \")\"\n           !SelectFamilyName.RowSource = \"SELECT DISTINCT FamilyName FROM (SELECT * FROM qryListAll\" &amp; SQLCriteria &amp; \")\"\n           !SelectModSubmod.RowSource = \"SELECT DISTINCT ModSubmod FROM (SELECT * FROM qryListAll\" &amp; SQLCriteria &amp; \")\"\n           !SelectFrameName.RowSource = \"SELECT DISTINCT FrameName FROM (SELECT * FROM qryListAll\" &amp; SQLCriteria &amp; \")\"\n        ' etc. etc. for all 18 comboboxes\n       End With\n   End If\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba", "parsing"], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "edited": false, "score": 0, "creation_date": 1439426235, "post_id": 31977425, "comment_id": 51861373, "body": "I added my code to the question.  How would this work with what I have?  I don&#39;t think I have access to each line as it comes in, so I&#39;m not sure how I would manipulate that portion of it."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "edited": false, "score": 0, "creation_date": 1439645849, "post_id": 31977425, "comment_id": 51952131, "body": "@KingKong  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "edited": false, "score": 0, "creation_date": 1440181269, "post_id": 31977425, "comment_id": 52183309, "body": "Oh, I didn&#39;t know about some of these functions.  Appreciate you showing me some new VBA features.  This does seem to work though. Thanks!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1439645824, "last_edit_date": 1439645824, "creation_date": 1439424350, "answer_id": 31977425, "question_id": 31977309, "link": "https://stackoverflow.com/questions/31977309/parsing-txt-file-into-excel-with-multiple-delimiters/31977425#31977425", "title": "Parsing txt file into Excel with multiple delimiters", "body": "<p>Read the file in line-by-line.  Then convert the multiple delimiters into a single delimiter by using <strong>Replace()</strong>.  Then use <strong>Split()</strong> on the common delimiter.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Here is some sample code to illustrate.  Say we want to parse using both <strong>+</strong> and <strong>-</strong></p>\n\n<p>with data like:</p>\n\n<pre><code>hello+world-goodby+for-now\n12+34+qwerty-poiunyt\n</code></pre>\n\n<p>This macro:</p>\n\n<pre><code>Sub ParseData()\n    Dim FileSpec As String, TextLine As String\n    Dim RowNumber As Long\n    folder = \"C:\\TestFolder\\textfiles\"\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set folder = fso.GetFolder(folder)\n    RowNumber = 1\n    Close #1\n\n    For Each file In folder.Files\n        FileSpec = folder &amp; \"\\\" &amp; file.Name\n        Open FileSpec For Input As #1\n        Do While Not EOF(1)\n            Line Input #1, TextLine\n            TextLine = Replace(TextLine, \"+\", \"-\")\n            If InStr(TextLine, \"-\") = 0 Then\n                Cells(RowNumber, 1) = TextLine\n            Else\n                ary = Split(TextLine, \"-\")\n                ccol = 1\n                For Each a In ary\n                    Cells(RowNumber, ccol) = a\n                    ccol = ccol + 1\n                Next a\n            End If\n            RowNumber = RowNumber + 1\n        Loop\n        Close #1\n    Next file\nEnd Sub\n</code></pre>\n\n<p>will produce:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FrmrC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FrmrC.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 351, "user_id": 4484829, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/9e67521a149838fd6fb023c678716905?s=128&d=identicon&r=PG&f=1", "display_name": "KingKong", "link": "https://stackoverflow.com/users/4484829/kingkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2338, "favorite_count": 0, "accepted_answer_id": 31977425, "answer_count": 1, "score": 0, "last_activity_date": 1439645824, "creation_date": 1439423553, "last_edit_date": 1439426147, "question_id": 31977309, "link": "https://stackoverflow.com/questions/31977309/parsing-txt-file-into-excel-with-multiple-delimiters", "title": "Parsing txt file into Excel with multiple delimiters", "body": "<p>Is there a way to parse lines of data from a .txt file using multiple delimitters?  Specifically, I'm importing a .txt file using VBA and QueryTables and the .TextFileOtherDelimiter method.  But my file has different delimitters (ex: \":\" &amp; \"=\") that I want to be able separate in one passing.</p>\n\n<p>Also, is there a way to parse the data using more than one character such as \".-\" or \":(tab)\"? </p>\n\n<p>I'm iterating through a bunch of files in multiple directories.  Here's the code I'm using:</p>\n\n<pre><code>For Each File In Folder.Files\n    With ActiveSheet.QueryTables.Add(Connection:=\"TEXT;\" _\n          &amp; File, Destination:=Range(\"A1\"))\n            .FieldNames = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .TextFilePromptOnRefresh = False\n            .TextFilePlatform = 437\n            .TextFileStartRow = DataStartRow\n            .TextFileParseType = xlDelimited\n            .TextFileTextQualifier = xlTextQualifierDoubleQuote\n            .TextFileConsecutiveDelimiter = True\n            .TextFileTabDelimiter = False\n            .TextFileSemicolonDelimiter = False\n            .TextFileCommaDelimiter = False\n            .TextFileSpaceDelimiter = False\n            .TextFileOtherDelimiter = TestDataDelimiter\n            .TextFileColumnDataTypes = Array(1, 1, 1)\n            .TextFileTrailingMinusNumbers = True\n            .Refresh BackgroundQuery:=False\n        End With\nnext\n</code></pre>\n\n<p>So can my TestDataDelimiter be something besides a single char?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1439426491, "post_id": 31977146, "comment_id": 51861428, "body": "If saveReportContents() sub belongs to the sheet that gets copied Excel might get confused about the reference to <b>ThisWorkbook</b>. Try replacing <code>ThisWorkbook</code> with <code>ActiveWorkbook</code> or <code>Workbooks(&quot;ExplicitFileName&quot;)</code>, and also add <code>Set wb = Nothing</code> after closing it"}], "owner": {"reputation": 213, "user_id": 853779, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/735dfabd3d1c16fcca1face6a8e20a18?s=128&d=identicon&r=PG", "display_name": "Zhe Xin", "link": "https://stackoverflow.com/users/853779/zhe-xin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1686, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1439422455, "creation_date": 1439422455, "last_edit_date": 1531164843, "question_id": 31977146, "link": "https://stackoverflow.com/questions/31977146/vba-error-the-object-invoked-has-disconnected-from-its-clients", "title": "VBA error: The object invoked has disconnected from its clients", "body": "<p>I wrote following code to copy the content from current worksheet to create a new workbook, if I don't double click the new created workbook, the code can be invoked without any errors, but once I open the new created workbook and close it, the code will throw exception :     </p>\n\n<pre><code>Automation error :\nThe object invoked has disconnected from its clients\n</code></pre>\n\n<p>see my code below:</p>\n\n<pre><code>Private Sub saveReportContents(smInstance As String, companyCode As String, jobName As String, onb_grp As String)\n    Dim fileName As String\n    Dim wb As Workbook\n\n    Set wb = Workbooks.Add\n    ThisWorkbook.Sheets(\"Contacts\").Activate\n    ThisWorkbook.Sheets(\"Contacts\").Copy before:=wb.Sheets(1)\n\n    fileName = ThisWorkbook.Path &amp; \"\\\" &amp; \"TDL_CTI_Onboard_\" &amp; smInstance &amp; \"_\" &amp; companyCode &amp; \"_\" &amp; jobName &amp; \"_\" &amp; onb_grp &amp; \"_\" &amp; _\n               Format(Now, \"yyyymmdd_hhmmss\") &amp; \".xlsx\"\n\n    wb.SaveAs fileName\n    For Each butt In wb.Sheets(\"Contacts\").Buttons\n        butt.Delete\n    Next butt\n    wb.Sheets(\"Contacts\").Rows(1).EntireRow.Delete\n    wb.Save\n    wb.Close savechanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>the error line that will be highlighted VBA code editor is:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Contacts\").Copy before:=wb.Sheets(1)\n</code></pre>\n\n<p>I don't know why, could you guys tell me the reason and how to avoid this issue?</p>\n"}, {"tags": ["vba", "excel", "crash", "solver"], "owner": {"reputation": 11, "user_id": 5221289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce2fa04773da1ea5f574cdcb85f4a91?s=128&d=identicon&r=PG&f=1", "display_name": "CapriciousWind", "link": "https://stackoverflow.com/users/5221289/capriciouswind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1439453027, "creation_date": 1439422026, "last_edit_date": 1439453027, "question_id": 31977078, "link": "https://stackoverflow.com/questions/31977078/vba-code-for-looping-solver-selectively-crashes-excel", "title": "vba code for looping solver selectively crashes excel?", "body": "<p>I have an issue I was hoping someone could help with. I put together some vba code to have excel loop solver (set to the evolutionary method). The code is as follows:</p>\n\n<pre><code>Sub Repeat_Solver()\n\n    Worksheets(\"DC Ranking by CM (All DC costs)\").Activate\n    limit = 148\n    i = 147\n\n    Application.ScreenUpdating = True\n\n    Do Until i = limit\n\n        If Range(\"BV\" &amp; i).Value = \"Y\" Then\n\n            SolverReset\n\n            SolverOk SetCell:=\"$EQ$\" &amp; i, MaxMinVal:=1, ValueOf:=0, ByChange:=\"$CA$\" &amp; i, _\n                     Engine:=3, EngineDesc:=\"Evolutionary\"\n\n            SolverAdd CellRef:=\"$CG$\" &amp; i, Relation:=3, FormulaText:=\"45\"\n            SolverAdd CellRef:=\"$CH$\" &amp; i, Relation:=1, FormulaText:=\"0.4\"\n            SolverAdd CellRef:=\"$CA$\" &amp; i, Relation:=1, FormulaText:=\"$E$\" &amp; i\n            SolverAdd CellRef:=\"$CA$\" &amp; i, Relation:=4, FormulaText:=\"integer\"\n\n            SolverOptions MaxTime:=60, Iterations:=200, Precision:=0.000001, _\n                          AssumeLinear:=False, StepThru:=False, Estimates:=1, _\n                          Derivatives:=1, SearchOption:=1, IntTolerance:=1, _\n                          Scaling:=False, Convergence:=0.000001, AssumeNonNeg:=True, _\n                          PopulationSize:=100, RandomSeed:=0, MutationRate:=0.075, _\n                          Multistart:=False, RequireBounds:=False, MaxSubproblems:=3, _\n                          MaxIntegerSols:=2, SolveWithout:=False, MaxTimeNoImp:=30\n\n            SolverOk SetCell:=\"$EQ$\" &amp; i, MaxMinVal:=1, ValueOf:=0, ByChange:=\"$CA$\" &amp; i, _\n                     Engine:=3, EngineDesc:=\"Evolutionary\"\n\n            SolverOk SetCell:=\"$EQ$\" &amp; i, MaxMinVal:=1, ValueOf:=0, ByChange:=\"$CA$\" &amp; i, _\n                     Engine:=3, EngineDesc:=\"Evolutionary\"\n\n            SolverSolve UserFinish:=True\n            SolverFinish KeepFinal:=1\n            i = i + 1\n\n        Else\n            i = i + 1\n        End If\n\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>When I set <code>limit=147</code> and <code>i=146</code> (to run it just for row 146), it works - but for some strange reason, when I run it for <code>limit=148</code> and <code>i=147</code> (as in the code above), it stalls on 'setting up problem ... 33%' and then excel stops responding.</p>\n\n<p>I even tried running solver manually on line 147 (without the vba code), but still the same problem - excel crashes. (It does seems to work, strangely enough, if I set solver to GRG Nonlinear, instead of evolutionary.)</p>\n\n<p>Does anyone know what I'm doing wrong? Thanks in advance for your help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1439437502, "post_id": 31976819, "comment_id": 51863935, "body": "Consider running some performance tests? This question could easily be answered by trial, error, and good debugging. (And it&#39;s not likely you&#39;ll notice huge performance gains unless you have some exceptionally large ranges, etc.)  From a style, readability (and maintainability) perspective, the second method is more explicit and legible."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1439437617, "post_id": 31976819, "comment_id": 51863965, "body": "Alternatively: <code>wb2.Sheets(1).Cells(2, TrpCdblCol).Resize(99).Copy wb1.Sheets(&quot;BL Import&quot;).Cells(2, TrpCdCol)</code>  ... there are <i>many</i> ways to express essentially the same &quot;copy/paste&quot; operation."}], "answers": [{"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1439436532, "post_id": 31976946, "comment_id": 51863731, "body": "Transpose isn&#39;t necessary for using an array. Also works on a 1D range only (so it while it works for this particular question, wont work for a range with multiple rows and multiple columns)."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1439437382, "post_id": 31976946, "comment_id": 51863907, "body": "I was transposing to an array due to the resize as I was using a dynamic range and needed the ubound of the array to do it. If I don&#39;t transpose it, it errors and MyArr is empty. I spose taking your comment though (Thanks I didn&#39;t actually know this before I thought it HAD to use transpose) I could do it like this <code>Sheets(&quot;Sheet2&quot;).Range(&quot;A1:A&quot; &amp; Sheets(&quot;Sheet1&quot;).Range(&quot;A&quot; &amp; Rows.count).end(xlup).row).value = Sheets(&quot;Sheet1&quot;).Range(&quot;A1:A&quot; &amp; Sheets(&quot;Sheet1&quot;).Range(&quot;A&quot; &amp; Rows.count).end(xlup).row).value</code>"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1439421160, "creation_date": 1439421160, "answer_id": 31976946, "question_id": 31976819, "link": "https://stackoverflow.com/questions/31976819/which-is-a-faster-copying-method-excel-vba/31976946#31976946", "title": "Which is a faster copying method? Excel VBA", "body": "<p>I would probably skip the copying altogether and use an array. For example:</p>\n\n<pre><code>Sub CopyWithoutCopying()\nDim MyArr As Variant\n    MyArr = Application.Transpose(Range(\"A1:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row))\n    Sheets(\"Sheet2\").Range(\"A1\").Resize(UBound(MyArr), 1) = Application.Transpose(MyArr)\nEnd Sub\n</code></pre>\n\n<p>This will copy the data in column A to a sheet called Sheet2 column A</p>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1439473181, "post_id": 31977567, "comment_id": 51884174, "body": "Thanks a lot for answering my question and providing a quick solution for repeating this process easily. Appreciate it!"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1439517587, "post_id": 31977567, "comment_id": 51905608, "body": "Had missed this response which covered the same area I did later in Option 2. +1"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 2, "last_activity_date": 1439425416, "creation_date": 1439425416, "answer_id": 31977567, "question_id": 31976819, "link": "https://stackoverflow.com/questions/31976819/which-is-a-faster-copying-method-excel-vba/31977567#31977567", "title": "Which is a faster copying method? Excel VBA", "body": "<p>The only (very slight) difference in performance between your 2 options is that the second one will perform the extra operation of creating 2 more Range objects</p>\n\n<p>Main consideration related to performance when copying data is if you need the formatting of cells (colors, fonts, etc) which requires a lot of work behind the scenes but it's preferable to doing it yourself. If you don't need the formatting you immediately gain a significant boost in performance</p>\n\n<p>For maintainability the second option is better, but you should also use explicitly references to all objects (including Cells()), and bypass the clipboard entirely. Also, there is no need to repeat the code: create a shared sub that takes 2 worksheets as parameters</p>\n\n<p>.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub copyData(ByRef wsFrom As Worksheet, ByRef wsTo As Worksheet)\n\n    With wsFrom\n        Set copyRange = .Range(.Cells(2, TrpCdBLCol), .Cells(100, TrpCdBLCol))\n    End With\n\n    With wsTo\n        Set destRange = .Range(.Cells(2, TrpCdBLCol), .Cells(100, TrpCdBLCol))\n    End With\n\n    destRange.Value2 = copyRange.Value2\n\nEnd Sub\n</code></pre>\n\n<p>.</p>\n\n<p>and use this line to call it from whatever worksheet you need:</p>\n\n<pre><code>copyData wb2.Worksheets(1), wb1.Worksheets(\"BL Import\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 0, "creation_date": 1439473343, "post_id": 31979016, "comment_id": 51884304, "body": "Thanks Brett, appreciate you add a figure to how much quicker one process is. Any reason you set TrpCdBLCol as Long as opposed to as an Integer? I had been setting them to Integers, but I&#39;m still learning about all this"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "edited": false, "score": 1, "creation_date": 1439517654, "post_id": 31979016, "comment_id": 51905625, "body": "@arbitel will add further comments above to my answer"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1439517986, "post_id": 31979016, "comment_id": 51905699, "body": "option 1 is ideal solution both for readability and performance +1 (and the details)"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 3, "last_activity_date": 1439519312, "last_edit_date": 1495542612, "creation_date": 1439436439, "answer_id": 31979016, "question_id": 31976819, "link": "https://stackoverflow.com/questions/31976819/which-is-a-faster-copying-method-excel-vba/31979016#31979016", "title": "Which is a faster copying method? Excel VBA", "body": "<p>You can get identical contents from range1 to range2 without a copy and paste by:</p>\n\n<ol>\n<li>Setting the values directly in Range2 from Range1 (this method copies values, and can be used to calculate formulae, but not formats)</li>\n<li>Using a variant array (which adds a step)</li>\n</ol>\n\n<p>On my testing the first option ran in 2/3 the time of the second - which would be due to the additional step. </p>\n\n<p><em>Update: Efficient techniques</em></p>\n\n<ul>\n<li>On using <em>Long</em> rather than <em>Integer</em>, <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\">Why Use Integer Instead of Long?</a></li>\n<li>On using <em>Value2</em> rather than <em>Value</em>, see post from Charles Williams <a href=\"https://fastexcel.wordpress.com/2011/11/30/text-vs-value-vs-value2-slow-text-and-how-to-avoid-it/\" rel=\"nofollow noreferrer\">here</a></li>\n<li>If you are manipulating data and writing it back to a sheet use a variant array, not a range object. If you are working with strings then <a href=\"http://www.aivosto.com/vbtips/stringopt.html\" rel=\"nofollow noreferrer\">here</a>is a one stop reference on efficient coding</li>\n</ul>\n\n<p><em>Option 1</em></p>\n\n<pre><code>Sub Recut1()\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim TrpCdBLCol As Long\n\nTrpCdBLCol = 1\nSet ws1 = Sheets(1)\nSet ws2 = Sheets(2)\n\nvArr = ws1.Range(ws1.Cells(2, TrpCdBLCol), ws1.Cells(100, TrpCdBLCol))\nws2.Range(ws2.Cells(2, TrpCdBLCol),ws2.Cells(100, TrpCdBLCol)).Value2 = vArr\n\nEnd Sub\n</code></pre>\n\n<p><em>Option 2</em></p>\n\n<pre><code>Sub Recut2()\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim TrpCdBLCol As Long\nSet ws1 = Sheets(1)\nSet ws2 = Sheets(2)\nTrpCdBLCol = 1\n\nws2.Range(ws2.Cells(2, TrpCdBLCol), ws2.Cells(100, TrpCdBLCol)).Value2 = ws1.Range(ws1.Cells(2, TrpCdBLCol), ws1.Cells(100, TrpCdBLCol))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 3026842, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b0ddfd1473f28b90224090f001dd1ad?s=128&d=identicon&r=PG&f=1", "display_name": "arbitel", "link": "https://stackoverflow.com/users/3026842/arbitel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5111, "favorite_count": 0, "accepted_answer_id": 31979016, "answer_count": 3, "score": 0, "last_activity_date": 1439519312, "creation_date": 1439420423, "question_id": 31976819, "link": "https://stackoverflow.com/questions/31976819/which-is-a-faster-copying-method-excel-vba", "title": "Which is a faster copying method? Excel VBA", "body": "<p>I'm going to be repeating part of a VBA module many times and I want to make sure I'm doing this the most efficient way. Most efficient meaning the quickest loading time.</p>\n\n<p>Basically, I'm copying data from a range on wb2 and pasting it to a wb1 destination.</p>\n\n<p>The first method seems easier as it's shorter:</p>\n\n<pre><code>wb2.Sheets(1).Range(Cells(2, TrpCdBLCol), Cells(100, TrpCdBLCol)).Copy wb1.Sheets(\"BL Import\").Cells(2, TrpCdCol)\n</code></pre>\n\n<p>The second method I declare two variables as ranges, set them, and the copy</p>\n\n<pre><code>Dim CopyRange As Range, Dest As Range\n    Set CopyRange = wb2.Sheets(1).Range(Cells(2, TrpCdBLCol), Cells(100, TrpCdBLCol))\n    Set Dest = wb1.Sheets(\"BL Import\").Cells(2, TrpCdCol)\n    CopyRange.Copy Dest\n</code></pre>\n\n<p>Is there any difference or is one way better than the other?\nThanks!</p>\n"}, {"tags": ["vba", "ms-access-2010", "lotus"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "edited": false, "score": 0, "creation_date": 1439490387, "post_id": 31978442, "comment_id": 51895588, "body": "Dim Maildb As Object     Dim UserName As String      Dim MailDbName As String     Dim MailDoc As Object     Dim stSignature As String     Dim attachme As Object     Dim Session As Object     Dim EmbedObj As Object     Set Session = CreateObject(&quot;Notes.NotesSession&quot;)     UserName = Session.UserName     MailDbName = Left$(UserName, 1) &amp; Right$(UserName, (Len(UserName) - InStr(1, UserName, &quot; &quot;))) &amp; &quot;.nsf&quot;     Set Maildb = Session.GETDATABASE(&quot;&quot;, MailDbName)      If Maildb.ISOPEN = True Then      Else          Maildb.OPENMAIL      End If"}, {"owner": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "edited": false, "score": 0, "creation_date": 1439490417, "post_id": 31978442, "comment_id": 51895605, "body": "Set MailDoc = Maildb.CREATEDOCUMENT         MailDoc.CREATERICHTEXTITEM (&quot;Attachment&quot;)     MailDoc.PostedDate = Now()      MailDoc.Send 0, Recipient     Maildb.Close     Set Maildb = Nothing     Set MailDoc = Nothing     Set attachme = Nothing     Set EmbedObj = Nothing     Session.Close     Set Session = Nothing"}, {"owner": {"reputation": 21, "user_id": 5216809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UudXT.png?s=128&g=1", "display_name": "B Quesnel", "link": "https://stackoverflow.com/users/5216809/b-quesnel"}, "reply_to_user": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "edited": false, "score": 0, "creation_date": 1439583405, "post_id": 31978442, "comment_id": 51938492, "body": "You&#39;re using Notes.NotesSession, which is OLE class, maybe that&#39;s the problem. Do you really need to open LotusNotes? Maybe try using &quot;Lotus Domino Objects&quot;, which is COM class (Win32 only). If not, try to use windows API call to find Lotus Notes Window and then close it : Win32 API - FindWindow and SendMessage"}, {"owner": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "edited": false, "score": 0, "creation_date": 1439824892, "post_id": 31978442, "comment_id": 52007046, "body": "I implemented the sendmessage on friday.  Thanks for  your help.  I would like to see the example via lotus domino objects"}], "tags": [], "owner": {"reputation": 21, "user_id": 5216809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UudXT.png?s=128&g=1", "display_name": "B Quesnel", "link": "https://stackoverflow.com/users/5216809/b-quesnel"}, "is_accepted": false, "score": 0, "last_activity_date": 1439432205, "creation_date": 1439432205, "answer_id": 31978442, "question_id": 31976724, "link": "https://stackoverflow.com/questions/31976724/closing-lotus-notes-via-access-2010-vba/31978442#31978442", "title": "Closing Lotus notes via access 2010 vba", "body": "<p>Hard to say without any code... Try to set your Lotus Notes object to \"nothing\" after your process.</p>\n\n<pre><code>Set objLotusNotes = Nothing\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4638680, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5b7a10859e152baa23eed6be99d5b8df?s=128&d=identicon&r=PG&f=1", "display_name": "schalld", "link": "https://stackoverflow.com/users/4638680/schalld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439432205, "creation_date": 1439419931, "question_id": 31976724, "link": "https://stackoverflow.com/questions/31976724/closing-lotus-notes-via-access-2010-vba", "title": "Closing Lotus notes via access 2010 vba", "body": "<p>I am able to open lotus notes via access 2010 vba.  I can attach an excel spreadsheet.  </p>\n\n<p>I cannot find anything on how to shut down Lotus notes once I am done sending my message.</p>\n\n<p>I have tried appactivate \"Lotus Notes\" and send keys of alt f4 but it doesnt work</p>\n"}, {"tags": ["vba", "export-to-excel", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1439824130, "last_edit_date": 1439824130, "creation_date": 1439424786, "answer_id": 31977480, "question_id": 31976111, "link": "https://stackoverflow.com/questions/31976111/how-do-i-export-all-records-from-a-form-to-an-excel-worksheet/31977480#31977480", "title": "How do I export all records from a form to an Excel worksheet", "body": "<p>You basically have to open Excel and fill in each cell one by one. Or that's the only way I know how to do it at least... The original code is from <a href=\"http://bytes.com/topic/access/answers/730311-exporting-record-access-excel\" rel=\"nofollow\">here</a>, but I've modified it since the original was only exporting one record.</p>\n\n<pre><code>Private Sub btnExportExcel_Click()\nDim appExcel As Object\nDim wkbWorkBook As Object\nDim wksSheet As Object\n\n' creates Excel application\nSet appExcel = CreateObject(\"Excel.Application\")\n' opens workbook for output\nSet wkbWorkBook = appExcel.Workbooks.Open(\"C:\\Users\\mikec\\Desktop\\Book1.xlsx\")\n' get reference to sheet for output\nSet wksSheet = wkbWorkBook.Worksheets(\"RawData\")\n\n\n' for each record, output all fields in the record\nDim rs As Recordset\nDim row As Integer: row = 1\nDim col As Integer: col = 1\nSet rs = Me.Form.Recordset\nIf rs.RecordCount &gt; 0 Then\n    rs.MoveFirst\n    Do While Not rs.EOF\n        Dim fld As Field\n        For Each fld In Me.Recordset.Fields\n            wksSheet.Cells(row, col) = fld\n            col = col + 1\n        Next fld\n        rs.MoveNext\n        col = 1\n        row = row + 1\n    Loop\nEnd If\n\n' save and quit\nwkbWorkBook.Save\nappExcel.Quit\n\nSet wksSheet = Nothing\nSet wkbWorkBook = Nothing\nSet appExcel = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 981, "favorite_count": 0, "accepted_answer_id": 31977480, "answer_count": 1, "score": 0, "last_activity_date": 1439824130, "creation_date": 1439416673, "last_edit_date": 1439424359, "question_id": 31976111, "link": "https://stackoverflow.com/questions/31976111/how-do-i-export-all-records-from-a-form-to-an-excel-worksheet", "title": "How do I export all records from a form to an Excel worksheet", "body": "<p>edit: nevermind, I found a way to do it. I will post my answer as a separate post.</p>\n\n<p>I have a continuous form containing multiple records. I would like to be able to export all record information on the form into an Excel worksheet named \"RawData\", where the Excel file is at some static location.</p>\n\n<p>I tried Docmd.OutputTo, but that replaces all content with a single sheet containing the form records, and Docmd.TransferSpreadsheet seems to only import the text \"F1\" in cell A1 (dunno why). Maybe I am using them wrong?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1439416948, "post_id": 31975900, "comment_id": 51858875, "body": "@jabberwocky this is fixed now."}], "tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": false, "score": 2, "last_activity_date": 1439416926, "last_edit_date": 1439416926, "creation_date": 1439415698, "answer_id": 31975900, "question_id": 31975853, "link": "https://stackoverflow.com/questions/31975853/end-with-without-with/31975900#31975900", "title": "End With without With", "body": "<p>Excuse me, I missed your <code>Next scenario_index</code> at the bottom. I edited the answer to instead reverse the order of your With block and For Loop.</p>\n\n<p>Just FYI, using multiple <code>With</code> blocks inside each other can cause problems if the same line could be qualified by multiple <code>With</code> references. In my experience, this doesn't happen often enough to stop doing it, but keep it in mind for future debugging. If you suspect it is causing you a problem, try adding the appropriate reference to the line and see if your problem is fixed.</p>\n\n<pre><code>CB = Left(ActiveSheet.Range(\"D10\").Value, 3)\nRT = Left(ActiveSheet.Range(\"B\" &amp; Application.WorksheetFunction.Match(\"HBR\", ActiveSheet.Range(\"D1:D100\"), 0)).Value, 3)\nIf RT = \"P\" Then\n    ShtName = CB &amp; \"_TR\"\nElse\n    ShtName = CB &amp; \"_ATR\"\nEnd If\nRScenarios = FindCase(CB, \"abc\")\nArraysize = UBound(RScenarios) - LBound(RScenarios) + 1\nThisWorkbook.Sheets(CB &amp; \"_Summary\").Rows(5 &amp; \":\" &amp; Rows.Count).Delete\nFor scenario_index = LBound(RScenarios) To UBound(RScenarios)\n    With ThisWorkbook.Worksheets(ShtName)\n        If RT = \"P\" Then\n            pTableName = \"PivotTable\" &amp; CB &amp; \"abc\"\n            RName = CB &amp; \"_Rrt_\"\n        Else\n            pTableName = \"PivotTable\" &amp; CB &amp; \"def\"\n            RName = CB &amp; \"_Rdt_\"\n        End If\n        Dsweepcases = .Range(\"Z34\").Value\n        Tsweepcases = .Range(\"Y34\").Value\n        .Range(\"Q59\").Value = RScenarios(scenario_index)\n        .Calculate\n        Set pt = Sheets(CB &amp; \"Results_PivotTable\").PivotTables(pTableName)\n        pt.RefreshTable\n        ThisWorkbook.Worksheets(CB &amp; \"Results_PivotTable\").Range(CB &amp; \"_RxPivotTable\").Copy\n    End With\n    With ThisWorkbook.Sheets(CB &amp; \"_Summary\")\n        If scenario_index = 0 Then\n            LastRow = 6\n        Else\n            LastRow = .Range(\"Q\" &amp; Rows.Count).End(xlUp).Row + 3\n        End If\n        Set Destination = .Range(\"A\" &amp; LastRow)\n        With Destination\n            .PasteSpecial xlPasteValues\n            .PasteSpecial xlPasteFormats\n            With ThisWorkbook.Worksheets(CB &amp; \"_TR\")\n                CaseName = .Range(\"R59\").Value &amp; \" + \" &amp; .Range(\"U59\").Value &amp; \" (AM\" &amp; .Range(\"Y59\").Value &amp; \")\"\n            End With\n            .Value = CaseName\n        End With\n        TempLastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n        HeaderRow = TempLastRow - 1 - Dsweepcases\n        .Range(\"A\" &amp; TempLastRow).Value = blah blah\n        .Range(\"C\" &amp; TempLastRow).Value = blah blah\n        Set DVal = Worksheets(\"B\").Range(RName &amp; Left(.Range(\"A\" &amp; HeaderRow).Value, InStr(.Range(\"A\" &amp; HeaderRow).Value, \" +\") - 1))\n        If IsError(Application.Match(DVal, .Range(\"A\" &amp; HeaderRow + 1 &amp; \":A\" &amp; TempLastRow - 1), 0)) = False Then\n            DValRow = blah blah\n        Else\n            DValRow = blah blah\n        End If\n        .Range(\"A\" &amp; HeaderRow + DValRow).Resize(, Tsweepcases + 1).BorderAround Weight:=xlThick\n    End With\nNext scenario_index\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1439416193, "post_id": 31975906, "comment_id": 51858598, "body": "Hmm.. I suspected this. I do have a &quot;Next scenario_index&quot; right at the bottom of the code. I don&#39;t understand why it needs to be closed inside the &quot;with...end with&quot; block. The for is a loop and needs to extend as far as it does in my code. The with is not really a loop, just a construct to qualify the workbook/sheet, etc and avoid repetition, correct?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1439416713, "post_id": 31975906, "comment_id": 51858783, "body": "Oh, if that&#39;s the case then you can just reverse the order of the loops. Editing my answer."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1439417543, "post_id": 31975906, "comment_id": 51859067, "body": "As for the why, I couldn&#39;t tell you - I&#39;m self taught and am not familiar enough with the nitty gritty to answer."}, {"owner": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1439417718, "post_id": 31975906, "comment_id": 51859120, "body": "Got it. I have already adjusted the for/with order and it works fine. A little irksome that this needs to be done. In this case, makes no difference and I didn&#39;t need to have it the other way. Maybe not so always. Thanks for the answers."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 1, "creation_date": 1439418852, "post_id": 31975906, "comment_id": 51859509, "body": "Yes, the With qualifies an object. I&#39;ve added an explanation which may be helpful albeit whimsical."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1439478022, "post_id": 31975906, "comment_id": 51887948, "body": "@Jabberwocky This is a complete guess, but maybe the reason was to enable Intellisense to be as helpful as possible for troubleshooting, and allowing you to close blocks in variable rather than strict orders caused it too much confusion/that is to say, the programmers couldn&#39;t figure out how to get it to account for errors and allow variable closing order."}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 2, "last_activity_date": 1439480381, "last_edit_date": 1439480381, "creation_date": 1439415744, "answer_id": 31975906, "question_id": 31975853, "link": "https://stackoverflow.com/questions/31975853/end-with-without-with/31975906#31975906", "title": "End With without With", "body": "<p>This can actually be caused by not having other control structures closed. The compiler can get confused and report this as a missing End With. Here are items to look for:</p>\n\n<ul>\n<li>If/End If</li>\n<li>Select/End Select</li>\n<li>For/Next</li>\n<li>Do/Loop</li>\n<li>While/Wend</li>\n</ul>\n\n<p>And of course,</p>\n\n<ul>\n<li>With/End With</li>\n</ul>\n\n<p>If you check to be sure each of these is closed properly, You'll find the issue in your code.</p>\n\n<p><strong>As to why</strong>? </p>\n\n<p>You can think of each of these structures like <a href=\"https://en.wikipedia.org/wiki/Matryoshka_doll#As_metaphor\" rel=\"nofollow noreferrer\">Russian nesting dolls</a>. You have to close each one before putting in into a larger doll. Likewise, you have to open each doll in order to get the next smaller one. </p>\n\n<p>Take this mental exercise a bit further for a moment. Try to imagine how you would manage to do otherwise? In other words, how would you place a doll inside the next larger doll without first closing it? You could just put in the bases and leave all the heads till the end, but that's not how Russian nesting dolls work. You can't put the heads on out of order.</p>\n\n<p>That is what you are asking the compiler to do without closing each item in turn and a compiler can only take explicit instructions, so it can not determine your intent.</p>\n\n<p>For a visual, consider this structure. It's orderly and makes immediate logical sense. What makes sense is the nesting. Each structure is nested inside another structure.</p>\n\n<pre><code>--------+\n--+     |\n  |     |\n--+     |\n------+ |\n----+ | |\n    | | |\n----+ | |\n------+ |\n--------+\n</code></pre>\n\n<p>Compare to this:</p>\n\n<pre><code>------+\n--------+\n--+   | |\n--|-+ | |\n--|-------+\n  | | | | |\n--+ | | | |\n    | | | |\n----|-+ | |\n----+   | |\n--------+ |\n----------+\n</code></pre>\n\n<p>Try putting these nesting dolls back together by following these Steps:</p>\n\n<ol>\n<li>Take the smallest body</li>\n<li>Close it with one or more random head </li>\n<li>Put this inside of the next larger body</li>\n<li>Repeat</li>\n</ol>\n\n<p>Ironman's head on Nick Fury's body and then put that into Captain America with the Hulk's head and put all of that into the Thor's body with Nick Fury's head. And then put that into Hulk's body. Good luck!</p>\n\n<p>There's only one step above that makes this process NOT work.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bJtmO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bJtmO.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 2, "last_activity_date": 1439417960, "creation_date": 1439417960, "answer_id": 31976371, "question_id": 31975853, "link": "https://stackoverflow.com/questions/31975853/end-with-without-with/31976371#31976371", "title": "End With without With", "body": "<p>You can't have:</p>\n\n<pre><code>With X\n    For Y\nEnd With\n    Next Y\n</code></pre>\n\n<p>The reason is when Y loops after the first iteration there would be no X as you closed the loop.</p>\n\n<p>You can however set up multiple for loops within the With or have some advanced IF checks inside there.</p>\n\n<p>puzzlepiece87 has fixed the code for you but I noticed you asked WHY it is like this in one of the comments.</p>\n"}], "owner": {"reputation": 37, "user_id": 4552977, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d72d60561358b3961ed6689059206080?s=128&d=identicon&r=PG&f=1", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/4552977/jabberwocky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1439480381, "creation_date": 1439415486, "last_edit_date": 1531164843, "question_id": 31975853, "link": "https://stackoverflow.com/questions/31975853/end-with-without-with", "title": "End With without With", "body": "<p>This appears to be a fairly common question, but I'm not able to see the error even after looking over previous answers. Please help with the compile error: End With without With, that I'm getting. The error is on the first instance of \"End With\". See code inset below (made simple for easy review):</p>\n\n<pre><code>CB = Left(ActiveSheet.Range(\"D10\").Value, 3)\nRT = Left(ActiveSheet.Range(\"B\" &amp; Application.WorksheetFunction.Match(\"HBR\", ActiveSheet.Range(\"D1:D100\"), 0)).Value, 3)\nIf RT = \"P\" Then\n    ShtName = CB &amp; \"_TR\"\nElse\n    ShtName = CB &amp; \"_ATR\"\nEnd If\nRScenarios = FindCase(CB, \"abc\")\nArraysize = UBound(RScenarios) - LBound(RScenarios) + 1\nThisWorkbook.Sheets(CB &amp; \"_Summary\").Rows(5 &amp; \":\" &amp; Rows.Count).Delete\nWith ThisWorkbook.Worksheets(ShtName)\n    For scenario_index = LBound(RScenarios) To UBound(RScenarios)\n        If RT = \"P\" Then\n            pTableName = \"PivotTable\" &amp; CB &amp; \"abc\"\n            RName = CB &amp; \"_Rrt_\"\n        Else\n            pTableName = \"PivotTable\" &amp; CB &amp; \"def\"\n            RName = CB &amp; \"_Rdt_\"\n        End If\n        Dsweepcases = .Range(\"Z34\").Value\n        Tsweepcases = .Range(\"Y34\").Value\n        .Range(\"Q59\").Value = RScenarios(scenario_index)\n        .Calculate\n        Set pt = Sheets(CB &amp; \"Results_PivotTable\").PivotTables(pTableName)\n        pt.RefreshTable\n        ThisWorkbook.Worksheets(CB &amp; \"Results_PivotTable\").Range(CB &amp; \"_RxPivotTable\").Copy\nEnd With\nWith ThisWorkbook.Sheets(CB &amp; \"_Summary\")\n    If scenario_index = 0 Then\n        LastRow = 6\n    Else\n        LastRow = .Range(\"Q\" &amp; Rows.Count).End(xlUp).Row + 3\n    End If\n    Set Destination = .Range(\"A\" &amp; LastRow)\n    With Destination\n        .PasteSpecial xlPasteValues\n        .PasteSpecial xlPasteFormats\n        With ThisWorkbook.Worksheets(CB &amp; \"_TR\")\n            CaseName = .Range(\"R59\").Value &amp; \" + \" &amp; .Range(\"U59\").Value &amp; \" (AM\" &amp; .Range(\"Y59\").Value &amp; \")\"\n        End With\n        .Value = CaseName\n    End With\n    TempLastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n    HeaderRow = TempLastRow - 1 - Dsweepcases\n    .Range(\"A\" &amp; TempLastRow).Value = blah blah\n    .Range(\"C\" &amp; TempLastRow).Value = blah blah\n    Set DVal = Worksheets(\"B\").Range(RName &amp; Left(.Range(\"A\" &amp; HeaderRow).Value, InStr(.Range(\"A\" &amp; HeaderRow).Value, \" +\") - 1))\n    If IsError(Application.Match(DVal, .Range(\"A\" &amp; HeaderRow + 1 &amp; \":A\" &amp; TempLastRow - 1), 0)) = False Then\n        DValRow = blah blah\n    Else\n        DValRow = blah blah\n    End If\n    .Range(\"A\" &amp; HeaderRow + DValRow).Resize(, Tsweepcases + 1).BorderAround Weight:=xlThick\nEnd With\nNext scenario_index\n</code></pre>\n"}, {"tags": ["vba", "excel", "graph", "charts"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5221065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0db9b5cbbc1ed1b0bf080fd4afb8ff4?s=128&d=identicon&r=PG&f=1", "display_name": "Dan V", "link": "https://stackoverflow.com/users/5221065/dan-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1439417943, "creation_date": 1439417943, "answer_id": 31976366, "question_id": 31975736, "link": "https://stackoverflow.com/questions/31975736/hide-all-graphs-and-show-them-based-on-combobox-selection/31976366#31976366", "title": "Hide all Graphs and show them based on ComboBox Selection", "body": "<p>It was an error with the way I was labeling my Worksheet. The Code should have actually been:</p>\n\n<pre><code>Private Sub ENT_Click()\n\n'Error if you do not select the City\nIf Me.City.Value = \"\" Then\n    MsgBox \"Please Select a City\", vbExclamation, \"Select a City\"\n    Me.City.SetFocus\n    Exit Sub\nEnd If\n\n'Change \"Mississauga\" to the item in your ComboBox\nIf Me.City.Value = \"Mississauga\" Then \nWorksheets(4).Visible = True\n    Worksheets(4).Activate\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5221065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0db9b5cbbc1ed1b0bf080fd4afb8ff4?s=128&d=identicon&r=PG&f=1", "display_name": "Dan V", "link": "https://stackoverflow.com/users/5221065/dan-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 202, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439417943, "creation_date": 1439414911, "question_id": 31975736, "link": "https://stackoverflow.com/questions/31975736/hide-all-graphs-and-show-them-based-on-combobox-selection", "title": "Hide all Graphs and show them based on ComboBox Selection", "body": "<p>I am fairly new to VBA, and have been searching the forum for one particular code.</p>\n\n<p>I have a workbook with multiple different graphs. I also have a UserForm with a popbox box where the User can select the city and click enter. What I would like to do is Hide all the Worksheets with the graphs, and when the user selects one particular city, I would like Excel to show that particular Graph. For Example, The user Selects Vancouver, and Excel will show the worksheet Pertaining to Vancouver. </p>\n\n<p>I would also Like to Have a done button, where if the user clicks that, it will go back to the sheet where the UserForm is.</p>\n\n<pre><code>Private Sub ENT_Click()\n\n'Error if you do not select the City\nIf Me.City.Value = \"\" Then\n    MsgBox \"Please Select a City\", vbExclamation, \"Select a City\"\n    Me.City.SetFocus\n    Exit Sub\nEnd If\n\nIf Me.City.Value = \"Mississauga\" Then\nSheets(\"Sheet4\").Visible = True\n    Sheets(\"Sheet4\").Activate\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Every time I run the code, with the Worksheets hidden, Or UnHidden, I keep getting a Subscript out of Range error.</p>\n\n<p>Thank you again for the help</p>\n"}, {"tags": ["vba", "excel", "pdf", "save"], "comments": [{"owner": {"reputation": 41, "user_id": 5208873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa00e544c85251e00aeb279abb6ae77b?s=128&d=identicon&r=PG&f=1", "display_name": "JT31", "link": "https://stackoverflow.com/users/5208873/jt31"}, "edited": false, "score": 0, "creation_date": 1440795999, "post_id": 31975724, "comment_id": 52438194, "body": "Someone Please help on this"}], "owner": {"reputation": 41, "user_id": 5208873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa00e544c85251e00aeb279abb6ae77b?s=128&d=identicon&r=PG&f=1", "display_name": "JT31", "link": "https://stackoverflow.com/users/5208873/jt31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 969, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1439414862, "creation_date": 1439414862, "question_id": 31975724, "link": "https://stackoverflow.com/questions/31975724/vba-in-excel-how-to-save-http-blahblah-pdf-webpage-as-pdf-file", "title": "VBA in excel How to Save http://blahblah.pdf webpage as pdf file?", "body": "<p>Currently my macro navigates through IE following specific links and brings me to a point where I click the pdf link and open it in IE.</p>\n\n<p>What I am trying to do now is save that open page as a pdf file. I have tried URLDownloadtofile which saves the file but will not allow me to open it.</p>\n\n<p>Here is a sample of the end of my code:</p>\n\n<pre><code>Loop\nFor Each e In ie.document.getElementsByTagName(\"span\")\nIf e.InnerText = \"View Assigned Workout\" Then\ne.ParentElement.Click\nExit For\nEnd If\nNext\nDo While (ie.Busy Or ie.READYSTATE &lt;&gt; 4)\nDoEvents\nLoop\n\nApplication.Wait (Now + TimeValue(\"0:00:1\"))\n\nFor Each e In ie.document.getElementsByTagName(\"strong\")\nIf e.InnerText = \"View/Print Workout\" Then\ne.ParentElement.Click\nExit For\nEnd If\nNext\n\nDo While (ie.Busy Or ie.READYSTATE &lt;&gt; 4)\nDoEvents\nLoop\nFor Each e In ie.document.getElementsByTagName(\"strong\")\nIf e.InnerText = \"View Workout Card\" Then\ne.ParentElement.Click\nExit For\nEnd If\nNext\nApplication.Wait (Now + TimeValue(\"0:00:1\"))\nDo While (ie.Busy Or ie.READYSTATE &lt;&gt; 4)\nDoEvents\nLoop\n\nFor Each e In ie.document.getElementsByTagName(\"strong\")\nIf e.InnerText = \"Print\" Then\ne.ParentElement.Click\nExit For\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>At this point click the print link opens a file in IE\n<a href=\"http://blahblah.pdf\" rel=\"nofollow\">http://blahblah.pdf</a> (cant access actual link as need login)</p>\n\n<p>How do I save this file as a PDF to a folder on my desktop?</p>\n\n<p>I tried using the following code:</p>\n\n<pre><code>Option Explicit\nPrivate Declare Function URLDownloadToFile Lib \"urlmon\" Alias _\n\"URLDownloadToFileA\" (ByVal pCaller As Long, ByVal szURL As String, ByVal _\nszFileName As String, ByVal dwReserved As Long, ByVal lpfnCB As Long) As     Long\n\nSub Test()\nDim strPDFLink As String\nDim strPDFFile As String\nDim Result As Boolean\nstrPDFLink =  \"http://blahblah.pdf\"\nstrPDFFile = \"savetestworkout.pdf\"\nResult = DownloadFile(strPDFLink, strPDFFile)\nEnd Sub\n\nFunction DownloadFile(URL As String, LocalFilename As String) As Boolean\nDim lngRetVal As Long\nlngRetVal = URLDownloadToFile(0, URL, LocalFilename, 0, 0)\nIf lngRetVal = 0 Then DownloadFile = True\nEnd Function\n</code></pre>\n\n<p>The file is created but when I try to open it an error occurs.\nAny help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439415593, "post_id": 31975695, "comment_id": 51858388, "body": "<a href=\"http://stackoverflow.com/questions/31479575/vba-how-to-find-search-value-from-sheet-dmr-and-then-from-found-search-value/31480620#31480620\" title=\"vba how to find search value from sheet dmr and then from found search value\">stackoverflow.com/questions/31479575/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439419536, "post_id": 31976626, "comment_id": 51859738, "body": "You&#39;re making the assumption that critvalue only occurs in column A which we do not know if it&#39;s true. You want to use find as I alluded to in my comment."}], "tags": [], "owner": {"reputation": 286, "user_id": 5049651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cd55a8c32a0ce5677880cf5a8830e9?s=128&d=identicon&r=PG&f=1", "display_name": "bbishopca", "link": "https://stackoverflow.com/users/5049651/bbishopca"}, "is_accepted": false, "score": 0, "last_activity_date": 1439419290, "creation_date": 1439419290, "answer_id": 31976626, "question_id": 31975695, "link": "https://stackoverflow.com/questions/31975695/excel-vba-code-to-find-a-certain-cell-and-delete-a-section-surrounding-it/31976626#31976626", "title": "Excel VBA code to find a certain cell and delete a section surrounding it", "body": "<pre><code>Sub clearCells()\nDim ws As Worksheet\nDim lastrow As Long, currow As Long\nDim critvalue As String\n\nSet ws = Sheets(\"Sheet1\")\n\n' Change A to a row with data in it\nlastrow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Row - 1\n\n'Change 2 to the first row to check\nFor currow = 2 To lastrow\n    critvalue = \"Attached Packaging\"\n\n    ' Change A to the row you are looking in\n    If ws.Range(\"A\" &amp; currow).Value = critvalue Then\n\n        ' Use the currow to select the row and then create an offset\n        ws.Range(\"A\" &amp; currow).offset(\"B\" &amp; currow - 1).clear\n        ws.Range(\"A\" &amp; currow).offset(\"B\" &amp; currow + 1).clear\n\n    End If\nNext currow\n\nEnd Sub\n</code></pre>\n\n<p>Make the changes needed where I commented. It should work.</p>\n"}, {"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1439460024, "post_id": 31977129, "comment_id": 51874988, "body": "Find is better than looking at each cell."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": true, "score": 2, "last_activity_date": 1439422340, "creation_date": 1439422340, "answer_id": 31977129, "question_id": 31975695, "link": "https://stackoverflow.com/questions/31975695/excel-vba-code-to-find-a-certain-cell-and-delete-a-section-surrounding-it/31977129#31977129", "title": "Excel VBA code to find a certain cell and delete a section surrounding it", "body": "<pre><code>Sub clear()\n\nDim ws As Worksheet\nDim search As String\nDim f As Variant\nDim fRow As Long\nDim fCol As Long\n\nsearch = \"Attached Packaging\"\nSet ws = ThisWorkbook.Worksheets(\"Sheet4\") 'change sheet as needed\n\nWith ws.Range(\"A1:AA1000\") 'change range as needed\n    Set f = .Find(search, LookIn:=xlValues)\n    If Not f Is Nothing Then\n        Do\n            fRow = f.Row\n            fCol = f.Column\n            ws.Range(Cells(fRow, fCol), Cells(fRow + 1, fCol + 3)).clear\n            ws.Cells(fRow + 1, fCol - 1).clear\n            Set f = .FindNext(f)\n        Loop While Not f Is Nothing\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 31977129, "answer_count": 2, "score": 0, "last_activity_date": 1439422340, "creation_date": 1439414715, "question_id": 31975695, "link": "https://stackoverflow.com/questions/31975695/excel-vba-code-to-find-a-certain-cell-and-delete-a-section-surrounding-it", "title": "Excel VBA code to find a certain cell and delete a section surrounding it", "body": "<p>I am writing a macro in Excel. Part of the code finds the cell that has \"Attached Packaging\" in it and then deletes the contents of a group of cells surrounding that cell. </p>\n\n<p>Here is the code that currently achieves this:</p>\n\n<pre><code>Cells.Find(\"Attached Packaging\").Activate\nActiveCell.Resize(2, 4).Select\nSelection.Clear\nActiveCell.Offset(1, -1).Select\nSelection.Clear\n</code></pre>\n\n<p>My problem now is that I, unexpectedly, have multiple cells with \"Attached Packaging\" in them which now also have to be deleted.</p>\n\n<p>So, to summarize: I need to modify this code so It finds all \"Attached Packaging\" cells in a spreadsheet and deletes the group around them.</p>\n"}, {"tags": ["excel", "vba", "ms-access", "errorbar", "stdev"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5195205, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f619aca928770617064b676de405b563?s=128&d=identicon&r=PG&f=1", "display_name": "andruemily", "link": "https://stackoverflow.com/users/5195205/andruemily"}, "edited": false, "score": 0, "creation_date": 1439415717, "post_id": 31975679, "comment_id": 51858433, "body": "Nice catch. However, now with the updated code there is no error but all of my standard error bars are set to 50, instead of the values within the range object. Any idea how to fix that/why it&#39;s doing this?"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1439414664, "creation_date": 1439414664, "answer_id": 31975679, "question_id": 31975284, "link": "https://stackoverflow.com/questions/31975284/creating-custom-standard-deviation-bars-in-vba-from-access/31975679#31975679", "title": "Creating custom standard deviation bars in VBA from Access", "body": "<p>If rngStD has been declared as a range then you need to add .Value to it. This will pass the value stored by the range not the range object itself. </p>\n"}, {"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1440082286, "creation_date": 1440082286, "answer_id": 32121515, "question_id": 31975284, "link": "https://stackoverflow.com/questions/31975284/creating-custom-standard-deviation-bars-in-vba-from-access/32121515#32121515", "title": "Creating custom standard deviation bars in VBA from Access", "body": "<p>You need to pass in the address of the range in R1C1 notation, preceded by an equals sign. Try this syntax:</p>\n\n<pre><code>.ErrorBar Direction:=xlY, Include:=xlBoth, _\n    Type:=xlCustom, Amount:=\"=\" &amp; rngStD.Address(, , xlR1C1, True), _\n    MinusValues:=\"=\" &amp; rngStD.Address(, , xlR1C1, True)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5195205, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f619aca928770617064b676de405b563?s=128&d=identicon&r=PG&f=1", "display_name": "andruemily", "link": "https://stackoverflow.com/users/5195205/andruemily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1124, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594643837, "creation_date": 1439413070, "last_edit_date": 1594643837, "question_id": 31975284, "link": "https://stackoverflow.com/questions/31975284/creating-custom-standard-deviation-bars-in-vba-from-access", "title": "Creating custom standard deviation bars in VBA from Access", "body": "<p>I'm trying to include custom standard deviation bars in a chart using VBA, but I keep getting a run time error 13 \"type mismatch\" in the line that actually adds the bars. I believe it has a problem with my range object (rngStD), but I don't know why. I'm using this VBA in Access, but I've created an Excel application (xlApp), which is where the data is now and where the graphs are being created.</p>\n\n<pre><code>'Start of relevant code\nxlApp.Sheets(\"Monday\").Select\nSet rngAv = Range(Cells(numRows + 2, 3), Cells(numRows + 2, 26))\nSet rngStD = Range(Cells(numRows + 3, 3), Cells(numRows + 3, 25))\nxlApp.Sheets(\"Graphs\").Select\n'Creates graph for average usage with standard deviation at each point\nSet oChart = xlApp.Worksheets(\"Graphs\").ChartObjects.Add(600, 10, 500, 250).Chart\n    oChart.SetSourceData Source:=rngAv   'xlApp.Selection\n    oChart.Type = xlLine\n    oChart.HasTitle = True\n    oChart.ChartTitle.Text = \"Average Usage for Mondays\"\n\n'At this point the code works and correctly creates the above graph\n\nWith oChart.FullSeriesCollection(1)\n    .HasErrorBars = True\n    .ErrorBars.Select\n    'Error is on the next line, I believe it doesn't like the \"Amount:=rngStD\"\n    .ErrorBar Direction:=xlY, Include:= _\n        xlBoth, Type:=xlCustom, Amount:=rngStD.Value\n    .ErrorBars.Select\n\nEnd With\n</code></pre>\n\n<p>EDIT: added .Value at the end of rngStD.Value in the last line. Now the amount is fixed at 50 though instead of the individual values for each point in range. Not sure why or how to fix it.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1439469146, "post_id": 31975154, "comment_id": 51881039, "body": "You&#39;re right, it was not what I intended. I fixed it, thanks for pointing it out!"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1439475942, "post_id": 31975154, "comment_id": 51886218, "body": "You should also stop using directly <code>CurrentDb</code>. Create a variable, <code>Set db=CurrentDb</code> and use <code>db</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": true, "score": 2, "last_activity_date": 1439798727, "last_edit_date": 1495539834, "creation_date": 1439413092, "answer_id": 31975287, "question_id": 31975154, "link": "https://stackoverflow.com/questions/31975154/adding-a-new-record-with-vba/31975287#31975287", "title": "Adding a new record with VBA", "body": "<p>You're asking which is preferable when inserting a record: to use an SQL statement issued to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195520.aspx\" rel=\"nofollow noreferrer\">Database</a> object, or to use the methods of the <a href=\"https://msdn.microsoft.com/EN-US/library/office/dn125824.aspx\" rel=\"nofollow noreferrer\">Recordset</a> object.</p>\n\n<p>For a single record, it doesn't matter. However, you could issue the <code>INSERT</code> statement like this:</p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO Feuilles ([AHNS], [Contrat], [No Projet]) VALUES (\" &amp; strDessin &amp; \", \" &amp; strContrat &amp; \", \" &amp; strDessin &amp; \")\", dbFailOnError\n</code></pre>\n\n<p>(You should use the <code>dbFailOnError</code> option to catch certain errors, as HansUp points out in <a href=\"https://stackoverflow.com/a/31993117/111794\">this answer</a>.)</p>\n\n<hr>\n\n<p>For inserting multiple records from another table or query, it is generally faster and more efficient to issue an SQL statement like this:</p>\n\n<pre><code>Dim sql = _\n    \"INSERT INTO DestinationTable (Field1, Field2, Field3) \" &amp; _\n    \"SELECT Field1, Field2, Field3 \" &amp; _\n    \"FROM SourceTable\"\nCurrentDb.Execute sql\n</code></pre>\n\n<p>than the equivalent using the Recordset object:</p>\n\n<pre><code>Dim rsSource As DAO.Recordset, rsDestination As DAO.Recordset\nSet rsSource = CurrentDb.OpenRecordset(\"SourceTable\")\nSet rsDestination = CurrentDb.OpenRecordset(\"DestinationTable\")\nDo Until rs.EOF\n    rsDestination.AddNew\n    rsDestination!Field1 = rsSource!Field1\n    rsDestination!Field2 = rsSource!Field2\n    rsDestination!Field3 = rsSource!Field3\n    rsDestination.Update\n    rs.MoveNext\nLoop\n</code></pre>\n\n<p>That said, using an SQL statement has its limitations:</p>\n\n<ul>\n<li><p><strong>You are limited to <a href=\"https://msdn.microsoft.com/en-us/library/bb259125(v=office.12).aspx\" rel=\"nofollow noreferrer\">SQL syntax and functions</a>.</strong></p>\n\n<p>This is partially mitigated in Access, because SQL statements can use many <a href=\"https://msdn.microsoft.com/EN-US/library/office/jj692811.aspx\" rel=\"nofollow noreferrer\">VBA built-in functions</a> or functions that you define.</p></li>\n<li><p><strong>SQL statements are designed to work on blocks of rows.</strong> Per-row logic is harder to express using only the <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264412.aspx\" rel=\"nofollow noreferrer\">Iif</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264716.aspx\" rel=\"nofollow noreferrer\">Choose</a>, or <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg264257.aspx\" rel=\"nofollow noreferrer\">Switch</a> functions; and logic that depends on the current state (e.g. <a href=\"https://stackoverflow.com/a/23791408/111794\">insert every other record</a>) is harder or impossible using pure SQL. This can be easily done using the Recordset methods approach.</p>\n\n<p>This too can be enabled using a combination of VBA and SQL, if you have functions that persist state in module-level variables. One caveat: you'll need to reset the state each time before issuing the SQL statement. See <a href=\"https://stackoverflow.com/a/32045144/\">here</a> for an example.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": false, "score": 1, "last_activity_date": 1439481457, "creation_date": 1439481457, "answer_id": 31993117, "question_id": 31975154, "link": "https://stackoverflow.com/questions/31975154/adding-a-new-record-with-vba/31993117#31993117", "title": "Adding a new record with VBA", "body": "<p>One part<sup>*</sup> of your question asked about <code>INSERT</code> vs. <code>Recordset.AddNew</code> to add one row.  I suggest this recordset approach: </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim R As DAO.Recordset\nSet db = CurrentDb\nSet R = db.OpenRecordset(\"Dessins\", dbOpenTable, dbAppendOnly)\nWith R\n    .AddNew\n    !Contrat = rsDessin![Projet HNA].Value\n    !Projet = Me.Combo_Projet.Value\n    !AHNS = Me.Combo_Dessin.Value\n    .Update\n    .Close\nEnd With\n</code></pre>\n\n<hr>\n\n<p><sup>*</sup> You also asked how to execute an <code>INSERT</code>.  Use the <code>DAO.Database.Execute</code> method which Zev recommended and include the <em>dbFailOnError</em> option.  That will add clarity about certain insert failures.  For example, a key violation error could otherwise make your <code>INSERT</code> fail silently.  But including <em>dbFailOnError</em> ensures you get notified about the problem immediately.  So always include that option ... except in cases where you actually want to allow an <code>INSERT</code> to fail silently.  (For me, that's never.)</p>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9680, "favorite_count": 0, "accepted_answer_id": 31975287, "answer_count": 2, "score": 0, "last_activity_date": 1439798727, "creation_date": 1439412654, "last_edit_date": 1439428140, "question_id": 31975154, "link": "https://stackoverflow.com/questions/31975154/adding-a-new-record-with-vba", "title": "Adding a new record with VBA", "body": "<p>I have a form in which one of the ComboBoxes lists all the documents of a given project. The user should select one and after pressing a button, and if present in Table <code>Dessins</code>it opens a second form showing that record. If it is not present in that table, I want to add it in.</p>\n\n<p>One of my collegues told me all I had to do was to execute an SQL query with VBA. What I have so far is this:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim rsDessin As DAO.Recordset\n    Dim strContrat As String\n    Dim strProjet As String\n    Dim strDessin As String\n    Dim sqlquery As String\n\n  'I think these next 3 lines are unimportant. I set a first query to get information I need from another table\n\n    strDessin = Me.Combo_Dessin\n    strProjet = Me.Combo_Projet\n    sqlquery = \"SELECT [Projet HNA] FROM [Projets] WHERE [Projet AHNS] = '\" &amp; strProjet &amp; \"'\"\n\n    Set rsDessin = CurrentDb.OpenRecordset(sqlquery)\n\n    If Not rsDessin.RecordCount &gt; 0 Then 'If not present I want to add it \n        strContrat = rsDessin![Projet HNA]\n        sqlquery = \"INSERT INTO Feuilles ([AHNS], [Contrat], [No Projet]) VALUES (strDessin, strContrat, strDessin)\"\n        'Not sure what to do with this query or how to make sure it worked.\n    End If\n\n 'Checking my variables\n    Debug.Print strProjet\n    Debug.Print strContrat\n    Debug.Print strDessin\n\n 'By here I'd like to have inserted my new record.\n\n    rsDessin.Close\n    Set rsDessin = Nothing\n</code></pre>\n\n<p>I also read online that i could achieve a similar result with something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set R = CurrentDb.OpenRecordset(\"SELECT * FROM [Dessins]\")\nR.AddNew\nR![Contrat] = strContrat\nR![Projet] = strProjet\nR![AHNS] = strDessin\nR.Update\nR.Close\nSet R = Nothing\nDoCmd.Close\n</code></pre>\n\n<p>Is one way better than the other? In the case where my INSERT INTO query is better, what should I do to execute it?</p>\n"}, {"tags": ["forms", "vba", "ms-access", "listbox"], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "is_accepted": false, "score": 0, "last_activity_date": 1439419154, "last_edit_date": 1439419154, "creation_date": 1439418707, "answer_id": 31976530, "question_id": 31975092, "link": "https://stackoverflow.com/questions/31975092/access-form-go-to-record/31976530#31976530", "title": "Access Form Go To Record", "body": "<p>Assuming the listbox has a rowsource, you can requery the ListBox to show the new record like this:\n<code>ListBox1.Requery</code></p>\n\n<p>Then to move the 'main' form to the latest record (assuming the ID/PK is an autonumber field, which is how the form recordsource is sorted):\n<code>DoCmd.GoToRecord , \"MainFormNameHere\",acLast</code></p>\n\n<p>If you don't have an ordered recordset, you can use </p>\n\n<pre><code>  Me.Recordset.FindFirst \"PrimaryKeyField = \" &amp; NewRecordPK\n</code></pre>\n\n<p>Where NewRecordPK is a variable with the new records primary key stored.</p>\n\n<p>You could call this from the dialog if you like. Just make sure you save the record first using something like <code>Docmd.Save</code> Then, </p>\n\n<pre><code>Forms!frmMainForm.Form.Recordset.FindFirst \"PrimaryKeyField = \" &amp; Me.PrimaryKeyField\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2577090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90e9cb88d462554366078091d4dcff92?s=128&d=identicon&r=PG", "display_name": "likearock83", "link": "https://stackoverflow.com/users/2577090/likearock83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1862, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439419154, "creation_date": 1439412453, "question_id": 31975092, "link": "https://stackoverflow.com/questions/31975092/access-form-go-to-record", "title": "Access Form Go To Record", "body": "<p>In Access, I have a main form with a listbox.  The listbox is used to navigate to different records on the main form.   The main form also has a button with the following code to open a dialog form on which I add a new record.</p>\n\n<pre><code>Private Sub New_Btn_Click()\n    DoCmd.OpenForm \"New Issue\", , , , acFormAdd, acDialog\n    Requery\n\n    Me.ID_Box.SetFocus\nEnd Sub\n</code></pre>\n\n<p>After I close the dialog form, I want the listbox to update and to select the new record that added on the \"New Issue\" form AND I want the main form to navigate to the new record.</p>\n\n<p>I cannot figure out how to make either of these actions occur.  Please help me find the best method for these steps.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 198, "user_id": 4036445, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/8d9a8aed81114fac957a7299a91bb67b?s=128&d=identicon&r=PG&f=1", "display_name": "tia97", "link": "https://stackoverflow.com/users/4036445/tia97"}, "edited": false, "score": 0, "creation_date": 1439423350, "post_id": 31975209, "comment_id": 51860766, "body": "Oh I def don&#39;t expect anyone to wrote it for me, I was just hoping it would be an easy fix. Thank you!"}], "tags": [], "owner": {"reputation": 1848, "user_id": 1467261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/324ea790a16c05831bd720258eddd78c?s=128&d=identicon&r=PG", "display_name": "AFischbein", "link": "https://stackoverflow.com/users/1467261/afischbein"}, "is_accepted": false, "score": 0, "last_activity_date": 1439412837, "creation_date": 1439412837, "answer_id": 31975209, "question_id": 31975020, "link": "https://stackoverflow.com/questions/31975020/save-macro-results-to-excel-sheet-vba/31975209#31975209", "title": "Save Macro results to Excel sheet - VBA", "body": "<p>You're going to have trouble saving as an <code>.xlsx</code> file, since that it reserved for macro-free workbooks, and obviously, your workbook has a macro. Instead, you can create a new workbook in VBA, store the results of the query in the new workbook, then save it as <code>.xlsx</code>. \nI understand you have little experience in VBA, but I wouldn't expect anyone from SO to write the complete macro for you...</p>\n"}], "owner": {"reputation": 198, "user_id": 4036445, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/8d9a8aed81114fac957a7299a91bb67b?s=128&d=identicon&r=PG&f=1", "display_name": "tia97", "link": "https://stackoverflow.com/users/4036445/tia97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1022, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439478227, "creation_date": 1439412198, "last_edit_date": 1439478227, "question_id": 31975020, "link": "https://stackoverflow.com/questions/31975020/save-macro-results-to-excel-sheet-vba", "title": "Save Macro results to Excel sheet - VBA", "body": "<p>I have an Excel sheet (.xlsm) running SQL code. I have added a run button to the Macro sheet to run the query and then output the results in a network folder. The problem is the only form I can seem to get it to work is in Text. I would like it to export to an Excel (.xlsx) file. My module contents is as follows:</p>\n\n<pre><code> Sub Run()\n\n    Sheets(\"QM_INQ_DATA\").Range(\"A1\").ListObject.QueryTable.Refresh BackgroundQuery:=False\n\n    ThisWorkbook.SaveAs Filename:= _\n        \"Z:\\QMDaily\\Queue Manager INQ Daily Report \" &amp; Format(Date - 1, \"MM.DD.YYYY\") &amp; \".xlsx\" _\n        , FileFormat:=51, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n\n<p>I really know nothing about VBA so Im sure this is an easy fix. </p>\n"}, {"tags": ["vba", "imacros"], "comments": [{"owner": {"reputation": 5129, "user_id": 4270557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f3Yol.jpg?s=128&g=1", "display_name": "Shugar", "link": "https://stackoverflow.com/users/4270557/shugar"}, "edited": false, "score": 0, "creation_date": 1439455730, "post_id": 31974710, "comment_id": 51872288, "body": "Don\u2019t merge an \u2018iMacros\u2019 code (first five lines) with a script (last five lines). Just apply the Scripting Interface properly."}], "answers": [{"tags": [], "owner": {"reputation": 3402, "user_id": 1452141, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/v7JO0.png?s=128&g=1", "display_name": "macroscripts", "link": "https://stackoverflow.com/users/1452141/macroscripts"}, "is_accepted": false, "score": 0, "last_activity_date": 1439436071, "creation_date": 1439436071, "answer_id": 31978967, "question_id": 31974710, "link": "https://stackoverflow.com/questions/31974710/playing-macro-from-imacro/31978967#31978967", "title": "Playing macro from iMacro", "body": "<p>Try this.</p>\n\n<pre><code>iimPlay (\"PlayThisMacro1.iim\")\n</code></pre>\n\n<p>Make sure the macro is in same folder as #Current.iim</p>\n"}], "owner": {"reputation": 1, "user_id": 1027038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d6343ef97909b918188bda4db65db2?s=128&d=identicon&r=PG", "display_name": "user1027038", "link": "https://stackoverflow.com/users/1027038/user1027038"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441507775, "creation_date": 1439411043, "last_edit_date": 1441507775, "question_id": 31974710, "link": "https://stackoverflow.com/questions/31974710/playing-macro-from-imacro", "title": "Playing macro from iMacro", "body": "<p>I have tried using the iMacros iimPlay to start iimPlay (\"PlayThisMacro1\") but I get no satisfaction. Any ideas?</p>\n\n<pre><code>VERSION BUILD=8920312 RECORDER=FX\n\nTAB T=1\n\nSET !ERRORIGNORE YES\n\nPROMPT Please&lt;SP&gt;Enter&lt;SP&gt;Number&lt;SP&gt;to&lt;SP&gt;Start&lt;SP&gt;With !VAR1\n\nPROMPT Please&lt;SP&gt;Enter&lt;SP&gt;Column&lt;SP&gt;to&lt;SP&gt;Write&lt;SP&gt;To !VAR2\n\nIf iret &gt; 0 Then\n\n    iimPlay (\"PlayThisMacro1\")\n\nElse\n\n    iimPlay (\"PlayThisMacro2\")\n\nEnd If\n</code></pre>\n"}, {"tags": ["xml", "excel", "vba", "ixmldomdocument"], "owner": {"reputation": 11, "user_id": 5220872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d6e32a991f57738258793ece2f3e90?s=128&d=identicon&r=PG&f=1", "display_name": "EJ Moreland", "link": "https://stackoverflow.com/users/5220872/ej-moreland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1439410921, "creation_date": 1439410921, "question_id": 31974671, "link": "https://stackoverflow.com/questions/31974671/can-i-add-a-linefeed-or-other-formatting-between-msxml2-ixmldomattribute-nodes", "title": "Can I add a linefeed or other formatting between MSXML2.IXMLDOMAttribute nodes?", "body": "<p>I am trying to add white space when I export data from an Excel VBA DOMDocument to XML.</p>\n\n<p>I can successfully do these between normal node and elements of any type, but I'd like to add a linefeed and some white space for indentation between two attributes of an element.</p>\n\n<p>Example:\nGet this...</p>\n\n<pre><code>&lt;elements&gt;\n&lt;element id=\"idvalue\"&gt;\n    &lt;subelement id=\"idvalue\" item-type=\"10\" store-category=\"3\" purchase-limit=\"1\" min-roster-space=\"4\" ui-headerbg=\"tex.icon\" ui-icon=\"tex.coolicon\"&gt;\n</code></pre>\n\n<p>To look like this...</p>\n\n<pre><code>&lt;elements&gt;\n&lt;element id=\"idvalue\"&gt;\n    &lt;subelement id=\"idvalue\" item-type=\"10\" store-category=\"3\" \n    purchase-limit=\"1\" min-roster-space=\"4\" ui-headerbg=\"tex.icon\" \n    ui-icon=\"tex.coolicon\"&gt;\n</code></pre>\n\n<p>Doing this with normal elements is fairly straightforward using code similar to this:</p>\n\n<pre><code>    parentElement.InsertBefore _\n        parentElement.OwnerDocument.createTextNode(strElementFormat), _\n        parentElement.ChildNodes.Item(0)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    parentElement.appendChild _\n        parentElement.OwnerDocument.createTextNode(strLastElementFormat)\n</code></pre>\n\n<p>I've tried iterating through the attributes as nodes, inserting before using the parent element, etc. </p>\n\n<p>It seems to treat the second text element as part of the attribute value, like so:</p>\n\n<pre><code>    &lt;item id=\"2024_MINNOW_CONVERSION\" item-type=\"10\" store-category=\"3\" purchase-limit=\"1&amp;#xA;            \" min-roster-space=\"4\"&gt;\n</code></pre>\n\n<p>Using this code snippet:</p>\n\n<pre><code>Sub formatXMLAttributes(currentElement As MSXML2.IXMLDOMElement, _\n                    toolXMLDoc As MSXML2.DOMDocument60, _\n                    Indent As Integer)\n    Dim attributeNode As MSXML2.IXMLDOMNode, _\n        intIndex As Integer, _\n        strElementFormat As String\n\n    intIndex = 0\n    strElementFormat = vbCrLf &amp; Space$(Indent * 4)\n    For Each attributeNode In currentElement.Attributes\n        intIndex = intIndex + 1\n        If intIndex Mod 4 = 0 And currentElement.Attributes.Length &gt; 4 Then\n           attributeNode.appendChild _\n           attributeNode.OwnerDocument.createTextNode(strElementFormat)\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Any thoughts? My suspicion is that it is not supported</p>\n"}, {"tags": ["excel", "for-loop", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439410371, "post_id": 31974417, "comment_id": 51855715, "body": "Instead of an inner loop (the <code>for k</code>), maybe do k=k+12?"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439437638, "post_id": 31974417, "comment_id": 51863970, "body": "let me confirm, what you want to insert to cells from Sheet2, value or formula."}], "answers": [{"tags": [], "owner": {"reputation": 925, "user_id": 5197739, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0eb1950fceec1477ac6713029546eab9?s=128&d=identicon&r=PG&f=1", "display_name": "JamTay317", "link": "https://stackoverflow.com/users/5197739/jamtay317"}, "is_accepted": false, "score": 0, "last_activity_date": 1439410913, "creation_date": 1439410913, "answer_id": 31974667, "question_id": 31974417, "link": "https://stackoverflow.com/questions/31974417/endless-loop-with-for-next-statement/31974667#31974667", "title": "Endless loop with For..Next statement", "body": "<p>I would use index to do this <code>=INDEX(Sheet1!$N$58:$N$142,(ROWS($A$114:$A114)-1)*12)/1.35</code> please make N the column that you are trying to divide just put this in the cells that you are trying to populate in sheet2</p>\n"}, {"tags": [], "owner": {"reputation": 961, "user_id": 2697139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c2437120b3292f1340ad0100ac12d4?s=128&d=identicon&r=PG&f=1", "display_name": "AlexT82", "link": "https://stackoverflow.com/users/2697139/alext82"}, "is_accepted": false, "score": 0, "last_activity_date": 1439412615, "creation_date": 1439412615, "answer_id": 31975144, "question_id": 31974417, "link": "https://stackoverflow.com/questions/31974417/endless-loop-with-for-next-statement/31975144#31975144", "title": "Endless loop with For..Next statement", "body": "<p>the trick is to take out the \"do - loop L \". That is causing the infinite loop, as you are never increasing \"L\". (the for loop which uses the same named variable, has the variable only within his own scope... then it won't be infinite anymore.</p>\n"}, {"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1439438031, "creation_date": 1439438031, "answer_id": 31979236, "question_id": 31974417, "link": "https://stackoverflow.com/questions/31974417/endless-loop-with-for-next-statement/31979236#31979236", "title": "Endless loop with For..Next statement", "body": "<p>Try as follow:</p>\n\n<pre><code>Dim k, l As Integer\n\n'Set before row\nk = 46\n\nFor l = 114 To 121 Step 1\n    Sheets(\"Sheet2\").Cells(l, 12) = Sheets(\"Sheet1\").Cells(k + 12, 14) / 1.35\nNext l\n</code></pre>\n\n<p>I am not clear with your requirement, means, don't know what you want to insert (formula or value).</p>\n\n<p><strong>if you want to set formula to Sheet2's cells</strong>, modify the setting line as follow:</p>\n\n<pre><code>Sheets(\"Sheet2\").Cells(l, 12).Formula  = \"=\" &amp; Sheets(\"Sheet1\").Cells(k + 12, 14).Address &amp; \"/1.35\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1439514749, "last_edit_date": 1439514749, "creation_date": 1439514405, "answer_id": 32000839, "question_id": 31974417, "link": "https://stackoverflow.com/questions/31974417/endless-loop-with-for-next-statement/32000839#32000839", "title": "Endless loop with For..Next statement", "body": "<p>This should work:</p>\n\n<pre><code>Sub Temp2()\n    Dim X As Long, ReadCol As Long, UpdateCode As Long\n    ReadCol = 14\n    UpdateCol = 12\n    For X = 114 To 121\n        Worksheets(\"Sheet2\").Cells(X, UpdateCol).Formula = Worksheets(\"Sheet1\").Cells(58 + ((X - 114) * 12), ReadCol) / 1.35\n    Next\nEnd Sub\n</code></pre>\n\n<p>I don't have any sample data to test so here is a debug version that will output to the immediate window (CTRL-G) what the complete line compiles to:</p>\n\n<pre><code>Sub Temp2()\n    Dim X As Long, ReadCol As Long, UpdateCode As Long\n    ReadCol = 14\n    UpdateCol = 12\n    For X = 114 To 121\n        Debug.Print \"Worksheets(\"\"Sheet2\"\").Cells(\" &amp; X &amp; \", \" &amp; UpdateCol &amp; \").Formula = Worksheets(\"\"Sheet1\"\").Cells(\" &amp; 58 + ((X - 114) * 12) &amp; \", \" &amp; ReadCol &amp; \") / 1.35\"\n    Next\nEnd Sub\n</code></pre>\n\n<p>results:</p>\n\n<pre><code>Worksheets(\"Sheet2\").Cells(114, 12).Formula = Worksheets(\"Sheet1\").Cells(58, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(115, 12).Formula = Worksheets(\"Sheet1\").Cells(70, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(116, 12).Formula = Worksheets(\"Sheet1\").Cells(82, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(117, 12).Formula = Worksheets(\"Sheet1\").Cells(94, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(118, 12).Formula = Worksheets(\"Sheet1\").Cells(106, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(119, 12).Formula = Worksheets(\"Sheet1\").Cells(118, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(120, 12).Formula = Worksheets(\"Sheet1\").Cells(130, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(121, 12).Formula = Worksheets(\"Sheet1\").Cells(142, 14) / 1.35\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5822eb7090f9c2bac3be3610ed07837e?s=128&d=identicon&r=PG&f=1", "display_name": "Marty", "link": "https://stackoverflow.com/users/5220823/marty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1439514749, "creation_date": 1439410037, "last_edit_date": 1531164843, "question_id": 31974417, "link": "https://stackoverflow.com/questions/31974417/endless-loop-with-for-next-statement", "title": "Endless loop with For..Next statement", "body": "<p>Objective: Develop a Macro whereby I select in sheet1, divide the values in every twelfth row by 1.35 and transfer them into a selected range of cells in sheet2.</p>\n\n<p>I started simple and it worked:</p>\n\n<pre><code>Worksheets(\"Sheet2\").Cells(114, 12).Formula = Worksheets(\"Sheet1\").Cells(58, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(115, 12).Formula = Worksheets(\"Sheet1\").Cells(70, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(116, 12).Formula = Worksheets(\"Sheet1\").Cells(82, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(117, 12).Formula = Worksheets(\"Sheet1\").Cells(94, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(118, 12).Formula = Worksheets(\"Sheet1\").Cells(106, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(119, 12).Formula = Worksheets(\"Sheet1\").Cells(118, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(120, 12).Formula = Worksheets(\"Sheet1\").Cells(130, 14) / 1.35\nWorksheets(\"Sheet2\").Cells(121, 12).Formula = Worksheets(\"Sheet1\").Cells(142, 14) / 1.35\n</code></pre>\n\n<p>I then wanted to breakdown the code by using a loop, but cannot get it right.</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>Dim i As Integer\nDim j As Integer\nDim k As Integer\nDim l As Integer\nDo\ni = 12\nj = 14\nFor l = 114 To 121\nFor k = 58 To 142 Step 12\nWorksheets(\"Sheet2\").Cells(l, i).Formula = Worksheets(\"Sheet1\").Cells(k, j) / 1.35\nNext k\nNext l\nLoop Until l = 121\n</code></pre>\n\n<p>My ultimate goal is to repeat this loop across different columns as the data comes in.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 2, "creation_date": 1439410940, "post_id": 31974145, "comment_id": 51855992, "body": "Might be easier to just to a Index(match) , copy/paste ...Otherwise , have you tried anything ? Basically you will need to pull the first column into an array, then the data on the 2nd sheet into an array then run some matching loops"}, {"owner": {"reputation": 237, "user_id": 949402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6a8d6b61a39b86727574092ffb9c3e1?s=128&d=identicon&r=PG", "display_name": "James Chen", "link": "https://stackoverflow.com/users/949402/james-chen"}, "reply_to_user": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1439416520, "post_id": 31974145, "comment_id": 51858704, "body": "currently i&#39;m just manually entering the information in the corresponding cell.  The thing is that i am trying to dummy proof this thing so someone else can run it while i&#39;m away. I guess another way to ask this question is how do i select a cell in sheet 2 column A that has chronological dates that corresponds to a date value in lets say cell 1,1 in sheet 1. in VBA though"}, {"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 1, "creation_date": 1439416869, "post_id": 31974145, "comment_id": 51858835, "body": "well i am happy to help you with it, if you want to throw some code up there, i don&#39;t know your level of VBA, but this is fair simple"}, {"owner": {"reputation": 237, "user_id": 949402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6a8d6b61a39b86727574092ffb9c3e1?s=128&d=identicon&r=PG", "display_name": "James Chen", "link": "https://stackoverflow.com/users/949402/james-chen"}, "reply_to_user": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1439419401, "post_id": 31974145, "comment_id": 51859686, "body": "i have a very basic VBA skills, i added the code i have above.  it works it is just not efficient since i have to use the match formula in sheet 1 to count the number of rows. i know i can do this in VBA, but my mind is just mush right now."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 5194761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4VLXN.jpg?s=128&g=1", "display_name": "Felix_Dragonhammer", "link": "https://stackoverflow.com/users/5194761/felix-dragonhammer"}, "is_accepted": false, "score": 1, "last_activity_date": 1439413966, "creation_date": 1439413966, "answer_id": 31975512, "question_id": 31974145, "link": "https://stackoverflow.com/questions/31974145/how-to-reference-a-cell-in-vba-thats-dependent-on-a-date-value/31975512#31975512", "title": "How to reference a cell in VBA that&#39;s dependent on a date value", "body": "<p>This seems like something that could be solved with a <a href=\"https://support.office.com/en-us/article/Lookup-and-reference-functions-reference-8aa21a3a-b56a-4055-8257-3ec89df2b23e\" rel=\"nofollow\">Lookup function</a>. Look at the VLOOKUP or the HLOOKUP. Or, if you want to learn an advanced method, use <a href=\"http://www.randomwok.com/excel/how-to-use-index-match/\" rel=\"nofollow\">INDEX(MATCH())</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 237, "user_id": 949402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6a8d6b61a39b86727574092ffb9c3e1?s=128&d=identicon&r=PG", "display_name": "James Chen", "link": "https://stackoverflow.com/users/949402/james-chen"}, "is_accepted": false, "score": 0, "last_activity_date": 1439421293, "creation_date": 1439421293, "answer_id": 31976965, "question_id": 31974145, "link": "https://stackoverflow.com/questions/31974145/how-to-reference-a-cell-in-vba-thats-dependent-on-a-date-value/31976965#31976965", "title": "How to reference a cell in VBA that&#39;s dependent on a date value", "body": "<p>Couldn't figure out how to work around using a cheat value i.e. DateRow which basically is just a match function that returns me what row my date is in.</p>\n\n<pre><code>Sub InventoryUpdate()\n\nSet DateRow = Sheets(\"Inputs\").Cells(40, 8)\nSet DateValues = Sheets(\"Inputs\").Range(\"B40:F40\")\n\nDateValues.Copy\nSheets(\"Inventory\").Activate\nRange(\"A1\").Offset(DateRow - 1, 30).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "is_accepted": true, "score": 1, "last_activity_date": 1439421302, "creation_date": 1439421302, "answer_id": 31976968, "question_id": 31974145, "link": "https://stackoverflow.com/questions/31974145/how-to-reference-a-cell-in-vba-thats-dependent-on-a-date-value/31976968#31976968", "title": "How to reference a cell in VBA that&#39;s dependent on a date value", "body": "<p>James Let me throw this too you to give you something to work with and then come back with another question when you need help (don't want to figure the whole project out for you) </p>\n\n<p>short hand code: </p>\n\n<pre><code>Sub FindStuff()\n\nApplication.ScreenUpdating = False\n\nDim VariableToLookUp() as Variant 'i used all variants because i don't know what data you have\nDim Results() as Variant \nDim VariableWithValues() as Variant\nDim I,II as long\n\nRedim Results(UBound(VariableToLookUp))\n\nSet VariableToLookUp Range(Cell(1,1),Cell(LastRow,1) \nSet VariableWithValues Sheet2.Range(Cell(1,1),Cell(LastRow,2) 'this gets column2\n\nFor I = 0 to UBound(VariableToLookUp)\n    For II = 0 to UBound(VariableWithValues)\n        If VariableToLookup(I,1) = VariableWithValues(II,1) Then\n              Results(I) = VariableWithValues(II,2)\n              exit for\n        endIf\n    next\nnext\n\nSheet1.Range(\"B2\").Activate\nFor I = 0 to Ubound(Results)\n     ActiveCell.Offset(I,0).Value = Results(I)\nnext\n\nApplication.ScreenUpdating = True\n)\n</code></pre>\n\n<p>Now keep in mind a few things ...1 i did not test this since i hope it to be more of guide to get you to the next question. and 2 I may have the wrong syntax but i promise the right ideas or close enough. If you post another question respond to this one with a link so i can find it\n.. As a side note, if you can set both to tables or add a logic to sort them in some order you can get real complex search features to speed them up, I have had to check 3MM+ numbers against 90K in VBA so had to come up with some index logic</p>\n"}, {"comments": [{"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1439482127, "post_id": 31977258, "comment_id": 51890967, "body": "Yeah, I was going that way but he said no formula, had to be &quot;dummy proof this thing so someone else can run it while i&#39;m away&quot;"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 0, "creation_date": 1439513199, "post_id": 31977258, "comment_id": 51904587, "body": "Thanks @HolmesIV, to make this dummy proof, there is a lot of work. Not to mention hiding and protecting Worksheets and Ranges. To me if a daily update is required, I would have the Daily fresh data on individual file and use VBS to transfer new data to the historical file. Can set up a batch file to execute the VBS and set that to Task Scheduler, the VBS will check for update files and act on it if required. Too bad I don&#39;t have the joy to implement it..."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1439423180, "creation_date": 1439423180, "answer_id": 31977258, "question_id": 31974145, "link": "https://stackoverflow.com/questions/31974145/how-to-reference-a-cell-in-vba-thats-dependent-on-a-date-value/31977258#31977258", "title": "How to reference a cell in VBA that&#39;s dependent on a date value", "body": "<p>Depends how and how often this Source sheet is updated, there will be different better solution. Since you didn't say how the source data is updated, I assume it's one off thing where new data will be on different sheet.</p>\n\n<p>You may not need a macro at all based on what you have in hand.<br>\n - Name the source data range (static or dynamic), say <strong>SourceRange</strong><br>\n - Ensure they are sorted in Ascending order (can be done in macro)<br>\n - Then in the Col B of the other sheet, use formula <br>\n<strong><code>=IFERROR(VLOOKUP(&lt;col A&gt;,SourceRange,2,FALSE),0)</code></strong></p>\n\n<p>To illustrate, I have put all in one sheet:<br>\n<a href=\"https://i.stack.imgur.com/Usmeo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Usmeo.png\" alt=\"illustration\"></a></p>\n\n<p>And since you did not mention how the historical data is stored when updated, nothing has done.</p>\n\n<p>The approach will change based on how the source data is updated/retrieved and what to do with the old data.</p>\n"}], "owner": {"reputation": 237, "user_id": 949402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b6a8d6b61a39b86727574092ffb9c3e1?s=128&d=identicon&r=PG", "display_name": "James Chen", "link": "https://stackoverflow.com/users/949402/james-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2429, "favorite_count": 0, "accepted_answer_id": 31976968, "answer_count": 4, "score": 0, "last_activity_date": 1440389355, "creation_date": 1439408975, "last_edit_date": 1440389355, "question_id": 31974145, "link": "https://stackoverflow.com/questions/31974145/how-to-reference-a-cell-in-vba-thats-dependent-on-a-date-value", "title": "How to reference a cell in VBA that&#39;s dependent on a date value", "body": "<p>I need to update daily volumes calculated from one sheet to a table with historical data.  </p>\n\n<p>For example: In sheet 1 I have a date in 1 cell and a value in the adjacent cell. In another sheet I have several columns with the column A being dates and the rest of the columns filled with data. </p>\n\n<p>I need a macro that references the date in sheet 1, and pastes the value in sheet 2 in column B that corresponds to the date in sheet 1.</p>\n\n<p>This is the code I'm using now but it's not efficient.  </p>\n\n<p>The date that I'm looking up is in sheet1 cell(1,2) Datematch is basically a numeric value that counts how far down I'll need to offset in sheet2 and DateValues is the value that I'm trying to enter in column B</p>\n\n<p>I want to do this without using the Datematch value </p>\n\n<pre><code>Sub testing()\nSet Datematch = Sheet1.Cells(1, 1)\nSet DateValues = Sheet1.Cells(2, 2)\nSheet2.Activate\nRange(\"A1\").Offset(Datematch, 1).Value = DateValues\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439408751, "post_id": 31973937, "comment_id": 51854906, "body": "Look at the Format function MsgBox (Format(Input1, &quot;short date&quot;)) or MsgBox (Format(Input1, &quot;MM/dd/yyyy&quot;)) or MsgBox (Format(Input1, &quot;yyyy/MM/dd&quot;)) or whatever format you want."}], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 2, "last_activity_date": 1439409199, "last_edit_date": 1439409199, "creation_date": 1439408759, "answer_id": 31974087, "question_id": 31973937, "link": "https://stackoverflow.com/questions/31973937/fixing-a-formatting-issue-using-excel/31974087#31974087", "title": "Fixing a formatting issue using Excel", "body": "<p>You can use the length of the value to determine how many numbers to use for the month and where to start the extraction of the day:</p>\n\n<pre><code>=DATE(2000+RIGHT(A1,2),LEFT(A1,LEN(A1)-4),MID(A1,LEN(A1)-3,2))\n</code></pre>\n\n<p>This will work for dates in the year 2000 or later, since your string values only include two digits for the year.</p>\n\n<p>Since this returns a date value, make sure your cells are formatted as dates to see the proper date string.</p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 4279612, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ab3d41de0439212aaaa4216e7c273558?s=128&d=identicon&r=PG&f=1", "display_name": "MadChadders", "link": "https://stackoverflow.com/users/4279612/madchadders"}, "edited": false, "score": 0, "creation_date": 1439409245, "post_id": 31974127, "comment_id": 51855177, "body": "This works great, I added a tiny bit to it so it better serves my purposes but I didn&#39;t state that before thanks for you response.        =TEXT(DATEVALUE(LEFT(RIGHT(&quot;0&quot;&amp;A3,6),2)&amp;&quot;/&quot;&amp;MID(RIGHT(&quot;0&quot;&amp;A3&zwnj;&#8203;,6),3,2)&amp;&quot;/&quot;&amp;RIGHT(R&zwnj;&#8203;IGHT(&quot;0&quot;&amp;A3,6),2)),&quot;&zwnj;&#8203;MM/DD/YY&quot;)"}], "tags": [], "owner": {"reputation": 961, "user_id": 2697139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c2437120b3292f1340ad0100ac12d4?s=128&d=identicon&r=PG&f=1", "display_name": "AlexT82", "link": "https://stackoverflow.com/users/2697139/alext82"}, "is_accepted": true, "score": 3, "last_activity_date": 1439408897, "creation_date": 1439408897, "answer_id": 31974127, "question_id": 31973937, "link": "https://stackoverflow.com/questions/31973937/fixing-a-formatting-issue-using-excel/31974127#31974127", "title": "Fixing a formatting issue using Excel", "body": "<p>try this formula:</p>\n\n<p>'string only:</p>\n\n<pre><code>=LEFT(RIGHT(\"0\"&amp;A1,6),2) &amp; \"/\" &amp; MID(RIGHT(\"0\"&amp;A1,6),3,2) &amp; \"/\" &amp; RIGHT(RIGHT(\"0\"&amp;A1,6),2)\n\n'as date:\n=DATEVALUE(LEFT(RIGHT(\"0\"&amp;A1,6),2) &amp; \"/\" &amp; MID(RIGHT(\"0\"&amp;A1,6),3,2) &amp; \"/\" &amp; RIGHT(RIGHT(\"0\"&amp;A1,6),2))\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 4279612, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ab3d41de0439212aaaa4216e7c273558?s=128&d=identicon&r=PG&f=1", "display_name": "MadChadders", "link": "https://stackoverflow.com/users/4279612/madchadders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 1, "accepted_answer_id": 31974127, "answer_count": 2, "score": 1, "last_activity_date": 1439409381, "creation_date": 1439408232, "last_edit_date": 1439409381, "question_id": 31973937, "link": "https://stackoverflow.com/questions/31973937/fixing-a-formatting-issue-using-excel", "title": "Fixing a formatting issue using Excel", "body": "<p>I'm trying to convert a string of text that is either 5 or 6 characters long into a date by inserting / at the correct spots for it. I'm having a really hard time getting excel to do this.  </p>\n\n<p>I've tried googling this, I tried using Cdate or  </p>\n\n<pre><code>=IF(LEN(A1)=5,DATE(RIGHT(A1,2),LEFT(A1,1),MID(A,2,2)),0)  \n</code></pre>\n\n<p>But they don't return the correct date because it assumes the data is already for the correct date. This seems like it should be so simple to do. It is very simple without using excel, you just type in the / in the 2 spots and it's converted to the correct date.</p>\n\n<p>For example I might have in A1 a string of text like: </p>\n\n<pre><code>80715\n80715\n80715\n122515\n122515\n122515\n</code></pre>\n\n<p>What I want to happen is:</p>\n\n<pre><code>8/07/15\n8/07/15\n8/07/15\n12/15/15\n12/15/15\n12/15/15\n</code></pre>\n\n<p>What I'm thinking about doing (if there isn't a simpler solution) is have a user input the date upfront and then have it fill the range ie:</p>\n\n<pre><code>Dim Input1 As Date\nInput1 = InputBox(\"Please Enter the Date\", \"Input1\", 0)\nRange(\"A1\").Value = Input1\n</code></pre>\n\n<p>but surely there is an easier way right? Please help me excel geniuses. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 925, "user_id": 5197739, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0eb1950fceec1477ac6713029546eab9?s=128&d=identicon&r=PG&f=1", "display_name": "JamTay317", "link": "https://stackoverflow.com/users/5197739/jamtay317"}, "edited": false, "score": 0, "creation_date": 1439407805, "post_id": 31973755, "comment_id": 51854450, "body": "which line does it stop on?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439407885, "post_id": 31973755, "comment_id": 51854481, "body": "Is your macro run from the same workbook as Sheets(&quot;PARTS&quot;)? Does Sheets(&quot;PARTS&quot;) actually exist? Does it always break, or just with some values of rand?"}, {"owner": {"reputation": 13, "user_id": 5220684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f96b7e4a775d50f4764ba8885a0b869?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/5220684/diego"}, "edited": false, "score": 0, "creation_date": 1439407940, "post_id": 31973755, "comment_id": 51854509, "body": "The error occurs if I stop it at &#39;Acount = Acount + 1&#39; So I think the If statement causes the error"}, {"owner": {"reputation": 13, "user_id": 5220684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f96b7e4a775d50f4764ba8885a0b869?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/5220684/diego"}, "edited": false, "score": 0, "creation_date": 1439408062, "post_id": 31973755, "comment_id": 51854566, "body": "Yes, the macro is for a command button on the first sheet of the workbook.  the sheet PARTS is what I typed into the tab for the second sheet and it breaks on all values of rand."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439408502, "post_id": 31973755, "comment_id": 51854785, "body": "This is a tangent but theoretically the loop could be infinite? I mean, how often does A appear?"}, {"owner": {"reputation": 13, "user_id": 5220684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f96b7e4a775d50f4764ba8885a0b869?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/5220684/diego"}, "edited": false, "score": 0, "creation_date": 1439409081, "post_id": 31973755, "comment_id": 51855092, "body": "About 3% of the time, that&#39;s the percentage of those parts."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439409135, "post_id": 31973755, "comment_id": 51855118, "body": "That&#39;s cool. I am curious why 6451-2+1. Can&#39;t you just do 6450? (I am not good at math.)"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439408879, "post_id": 31974067, "comment_id": 51854977, "body": "Hmm. Not sure if that&#39;s the entirety of his code that he posted. Also if you don&#39;t initialize a variable I think it starts at 0 and will still work. Kind of like when you do a for loop with <code>for i=1</code>. Rarely is that initialized. I think rand is the issue. He forced it to be an integer but maybe something isn&#39;t right there."}, {"owner": {"reputation": 13, "user_id": 5220684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f96b7e4a775d50f4764ba8885a0b869?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/5220684/diego"}, "edited": false, "score": 0, "creation_date": 1439408998, "post_id": 31974067, "comment_id": 51855046, "body": "Thanks for the insight, unfortunately I did initialize Acount (as integer, then Acount = 0) I only posted the loop that gave me issues.  I will see if option explicit helps though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5180298"}, "edited": false, "score": 0, "creation_date": 1439409002, "post_id": 31974067, "comment_id": 51855051, "body": "you are right, but as you said it starts from 0 and there is no 0 row and that`s why there is an error"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439409042, "post_id": 31974067, "comment_id": 51855069, "body": "lol there you go Diego! Why would you initialize it as 0?! =P"}, {"owner": {"reputation": 13, "user_id": 5220684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f96b7e4a775d50f4764ba8885a0b869?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/5220684/diego"}, "edited": false, "score": 0, "creation_date": 1439410387, "post_id": 31974067, "comment_id": 51855722, "body": "....so it was even more of a rookie move than I had expected! Thanks a bunch for the heads up.  I got it to populate the list but sometimes I get an error saying &#39;subscript out of range&#39;.  I set the random number within the values of the rows populated in the parts list. Any advice?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439410635, "post_id": 31974067, "comment_id": 51855823, "body": "We&#39;ve all been there. Try setting a <code>debug.print Account</code> and <code>debug.print rand</code> inside the <code>if statement</code> then review the immediate window. Should tell you right away what went wrong. Edit: actually place the rand print right below when you set it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5180298"}, "edited": false, "score": 1, "creation_date": 1439410883, "post_id": 31974067, "comment_id": 51855961, "body": "maybe try to replace the integer value type to long value type for the &#39;subscript out of range&#39;"}, {"owner": {"reputation": 13, "user_id": 5220684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f96b7e4a775d50f4764ba8885a0b869?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/5220684/diego"}, "edited": false, "score": 0, "creation_date": 1439473881, "post_id": 31974067, "comment_id": 51884702, "body": "Thanks for all of the suggestions everyone, the code&#39;s running correctly now.  I appreciate the help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5180298"}, "is_accepted": false, "score": 0, "last_activity_date": 1439408896, "last_edit_date": 1439408896, "creation_date": 1439408688, "answer_id": 31974067, "question_id": 31973755, "link": "https://stackoverflow.com/questions/31973755/populating-cells-from-a-different-sheet-in-vba/31974067#31974067", "title": "Populating cells from a different sheet in VBA", "body": "<p>because you didnt initialized the 'acount' variable so its empty, hence you get error 1004. also i recommend to use 'option explicit' declaration to prevent such errors. here is your code with the missing parts:</p>\n\n<pre><code>    Option Explicit\nPrivate Sub CommandButton1_Click()\n'While loop to obtain 6 A-Class part numbers to audit\nDim rand As Variant\nDim Acount As Integer\nAcount = 1 ' 1 or whatever number you would like to get start...\nDo While Acount &lt;= 6\n'Random number generator\nrand = Int((6451 - 2 + 1) * Rnd + 2)\n'checking part class ***If statement gives error***\nIf Sheets(\"PARTS\").Cells(rand, 5).Value = \"A\" Then\n    Acount = Acount + 1\n    'audit list copies cell from parts list\n    Sheets(\"AUDIT POPULATOR\").Cells(Acount, 1).Value = Sheets(\"PARTS\").Cells(rand, 1).Value\nElse\n    Acount = Acount\n    Sheets(\"AUDIT POPULATOR\").Cells(Acount, 1).Value = \"\"\nEnd If\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5220684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f96b7e4a775d50f4764ba8885a0b869?s=128&d=identicon&r=PG&f=1", "display_name": "Diego", "link": "https://stackoverflow.com/users/5220684/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439408896, "creation_date": 1439407505, "last_edit_date": 1439408066, "question_id": 31973755, "link": "https://stackoverflow.com/questions/31973755/populating-cells-from-a-different-sheet-in-vba", "title": "Populating cells from a different sheet in VBA", "body": "<p>I am creating a tool that populates a list of parts to be audited from a parts list on the 2nd sheet (PARTS).  The parts are in classes (A, B, or C) so the tool uses a random number generator to select what row to check the part class in. I am getting <code>1004 runtime error</code> when I try to check the part class and would appreciate some help getting around this.  Here is the loop that is giving me an error:</p>\n\n<pre><code>'While loop to obtain 6 A-Class part numbers to audit\nDim rand As Variant\n\nDo While Acount &lt;= 6\n    'Random number generator\n    rand = Int((6451 - 2 + 1) * Rnd + 2)\n    'checking part class ***If statement gives error***\n    If Sheets(\"PARTS\").Cells(rand, 5).Value = \"A\" Then\n        Acount = Acount + 1\n        'audit list copies cell from parts list\n        Sheets(\"AUDIT POPULATOR\").Cells(Acount, 1).Value = Sheets(\"PARTS\").Cells(rand, 1).Value\n    Else\n        Acount = Acount\n        Sheets(\"AUDIT POPULATOR\").Cells(Acount, 1).Value = \"\"\n    End If\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 925, "user_id": 5197739, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0eb1950fceec1477ac6713029546eab9?s=128&d=identicon&r=PG&f=1", "display_name": "JamTay317", "link": "https://stackoverflow.com/users/5197739/jamtay317"}, "is_accepted": false, "score": 0, "last_activity_date": 1439408116, "creation_date": 1439408116, "answer_id": 31973911, "question_id": 31973745, "link": "https://stackoverflow.com/questions/31973745/plotting-count-in-excel/31973911#31973911", "title": "Plotting count in Excel", "body": "<p><a href=\"https://www.youtube.com/watch?v=sqmMnsxAwvI\" rel=\"nofollow\">Click here</a> and watch a YouTude, you will discover select data.</p>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439408116, "creation_date": 1439407460, "question_id": 31973745, "link": "https://stackoverflow.com/questions/31973745/plotting-count-in-excel", "title": "Plotting count in Excel", "body": "<p>My data is like :</p>\n\n<pre><code>Portfolio         Type of Assets     Count\n\nPortfolio 1        Type A              10\n                   Type B              5\n                   Type C              7\n\nPortfolio 2        Type A              5\n                   Type B              10\n</code></pre>\n\n<p>I am trying to plot a  Bar graph where the each bar will have Portfolio 1 or similar on x-axis, the count of assets on the bar representing different colors and labels of colors like Red area in a bar represents the Type A assets. How can I plot that, I have tried this for a very long time, but not able to get it. Can anyone throw some hint please?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439406540, "post_id": 31973435, "comment_id": 51853760, "body": "Using On Error Resume Next is almost NEVER advised.  You will not see errors that happen."}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1439407505, "post_id": 31973552, "comment_id": 51854284, "body": "Thanks that do the trick, anyway on I how I can loop both macros and make it one macro function?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1439408975, "post_id": 31973552, "comment_id": 51855035, "body": "I get Argument is not optional, At the line where you put &#39;Call your sub here with the *****  I put Call MakeMyFolder"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1439409036, "post_id": 31973552, "comment_id": 51855065, "body": "The next line calls it.  MakeMyFolder cell.Value  I am assuming cell.Value holds the folder you want to create. You need to pass the argument to MakeMyFolder. Just put the folder name after it.  From your code i don&#39;t know where you are getting the folder to be created."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1439409269, "post_id": 31973552, "comment_id": 51855195, "body": "Does J hold the folder value for each row?"}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1439409306, "post_id": 31973552, "comment_id": 51855218, "body": "Got you so I made the correction but it&#39;s doing the makemyfolder command for each pdf it&#39;s generating in my dropdown how to alter it to get to the point where the folder is created it doesn&#39;t have to run the command over and over or stop with the msg box pop up of &quot;Found It&quot;?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1439409403, "post_id": 31973552, "comment_id": 51855252, "body": "It depends on the larger scope of what you want. If you want it just to create the folder once, move it above the For Each loop."}, {"owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "edited": false, "score": 0, "creation_date": 1439409637, "post_id": 31973552, "comment_id": 51855384, "body": "Perfect moved it above the loop.  You rock thanks so much!"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1440389575, "last_edit_date": 1440389575, "creation_date": 1439406741, "answer_id": 31973552, "question_id": 31973435, "link": "https://stackoverflow.com/questions/31973435/vba-to-create-a-folder-based-on-the-save-path-located-in-a-cell/31973552#31973552", "title": "VBA to Create a folder based on the save path located in a cell", "body": "<p>These are functions so they have a return value. Try it like this:</p>\n\n<pre><code>fsoFSO.FolderExists(Range(\"J2\"))  \n</code></pre>\n\n<p>instead of  </p>\n\n<pre><code>fsoFSO.FolderExists = Range(\"J2\")\n</code></pre>\n\n<p>The same for <code>CreateFolder</code>:</p>\n\n<pre><code>Sub MakeMyFolder(strFolder as string)\n    Set fsoFSO = CreateObject(\"Scripting.FileSystemObject\")\n    If fsoFSO.FolderExists(strFolder) Then\n        MsgBox \"found it\"\n    Else\n        fsoFSO.CreateFolder(strFolder)\n        MsgBox \"Done\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>To combine them, add an argument to your <code>sub MakeMyFolder(strFolder as string)</code><br>\nI am assuming your cell that could have exclude will have the folder path, so call your sub with that as the argument; <code>MakeMyFolder cell.Value</code> from in your <code>PDF_generate</code> sub.</p>\n\n<pre><code>Sub MakeMyFolder(strFolder as string)\n    Set fsoFSO = CreateObject(\"Scripting.FileSystemObject\")\n    If fsoFSO.FolderExists(strFolder) Then\n        MsgBox \"found it\"\n    Else\n        fsoFSO.CreateFolder(strFolder)\n        MsgBox \"Done\"\n    End If\nEnd Sub\n\nSub PDF_Generator()\n\nDim cell As Range\nDim wsSummary As Worksheet\nDim counter As Long\n\nSet wsSummary = Sheets(\"SUMMARY BY PROVIDER\")\n\nFor Each cell In Worksheets(\"NAME KEY\").Range(\"$H2:$H60\")\n  If cell.Value &lt;&gt; \"Exclude\" Then\n\n     '******* Call your sub here with the folder to be creted ****************************\n     MakeMyFolder cell.Value\n\n     'progress in status bar\n     counter = counter + 1\n     Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n\n     With wsSummary\n        .Range(\"$B$8\").Value = cell.Value\n        .ExportAsFixedFormat _\n              Type:=xlTypePDF, _\n              Filename:=ThisWorkbook.Sheets(\"SUMMARY BY PROVIDER\").Range(\"J2\").Value &amp; _\n      \"\\\" &amp; cell.Value &amp; \".pdf\", _\n              Quality:=xlQualityStandard, _\n              IncludeDocProperties:=True, _\n              IgnorePrintAreas:=False, _\n              OpenAfterPublish:=False\n     End With\n  End If\nNext cell\n\nSet wsSummary = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3666237, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/45ba9c861d3ec2d51f40bc99f63dcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "user3666237", "link": "https://stackoverflow.com/users/3666237/user3666237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2012, "favorite_count": 0, "accepted_answer_id": 31973552, "answer_count": 1, "score": 1, "last_activity_date": 1440389575, "creation_date": 1439406329, "last_edit_date": 1531161705, "question_id": 31973435, "link": "https://stackoverflow.com/questions/31973435/vba-to-create-a-folder-based-on-the-save-path-located-in-a-cell", "title": "VBA to Create a folder based on the save path located in a cell", "body": "<p>I have the file save path located in J2, so I want to have a macro that creates a folder in the location that's in J2 and if that file is already created to end the process and loop to my other code which creates PDF's and save each one into that location. I already have that code working. I will paste both below:</p>\n\n<p>This is the first code that I'm working on to create a folder based on the location in the cell</p>\n\n<pre><code>Sub MakeMyFolder()\nDim FldrName As String\nOn Error Resume Next\nSet fsoFSO = CreateObject(\"Scripting.FileSystemObject\")\nIf fsoFSO.FolderExists = Range(\"J2\") Then\n    MsgBox \"found it\"\nElse\n    fsoFSO.CreateFolder = Range(\"J2\")\n    MsgBox \"Done\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This is my second code that's already working that creates and saves PDF's in the location in J2</p>\n\n<pre><code>Sub PDF_Generator()\n\n   Dim cell As Range\n   Dim wsSummary As Worksheet\n   Dim counter As Long\n\n   Set wsSummary = Sheets(\"SUMMARY BY PROVIDER\")\n\n   For Each cell In Worksheets(\"NAME KEY\").Range(\"$H2:$H60\")\n      If cell.Value &lt;&gt; \"Exclude\" Then\n\n         'progress in status bar\n         counter = counter + 1\n         Application.StatusBar = \"Processing file: \" &amp; counter &amp; \"/1042\"\n\n         With wsSummary\n            .Range(\"$B$8\").Value = cell.Value\n            .ExportAsFixedFormat _\n                  Type:=xlTypePDF, _\n                  Filename:=ThisWorkbook.Sheets(\"SUMMARY BY PROVIDER\").Range(\"J2\").Value &amp; _\n          \"\\\" &amp; cell.Value &amp; \".pdf\", _\n                  Quality:=xlQualityStandard, _\n                  IncludeDocProperties:=True, _\n                  IgnorePrintAreas:=False, _\n                  OpenAfterPublish:=False\n         End With\n      End If\nNext cell\n\nSet wsSummary = Nothing\nEnd Sub\n</code></pre>\n\n<p>I want to get the first code working than combine that procedure with the next, any insight on this question will be great!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 769, "user_id": 3522344, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e4d9454b44db39f3af1660c18cc1fc3c?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Wang", "link": "https://stackoverflow.com/users/3522344/eric-wang"}, "edited": false, "score": 0, "creation_date": 1547617698, "post_id": 31973331, "comment_id": 95248137, "body": "Is there an add-on to do this?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5219796"}, "edited": false, "score": 0, "creation_date": 1439450403, "post_id": 31973811, "comment_id": 51869111, "body": "thanks, I tried the code above but get a &quot;object required&quot; error for the row intLastRow = Sheet2.Cells(Sheet2.Rows.Count, &quot;A&quot;).End(xlUp).Row"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439463675, "post_id": 31973811, "comment_id": 51877360, "body": "Do you have a Sheet2?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5219796"}, "edited": false, "score": 0, "creation_date": 1439549540, "post_id": 31973811, "comment_id": 51919013, "body": "sorry my mistake.. I just had to change the declaration &quot;sheet2&quot; to the german declaration used my excel version which is &quot;Tabelle2&quot;.. its now running perfectly.. Thanks a lot"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 3, "last_activity_date": 1439408088, "last_edit_date": 1439408088, "creation_date": 1439407731, "answer_id": 31973811, "question_id": 31973331, "link": "https://stackoverflow.com/questions/31973331/if-cell-value-changes-copy-value-to-another-worksheet/31973811#31973811", "title": "If cell value changes, copy value to another worksheet", "body": "<p>You can use the <code>Worksheet_Change()</code> event. For example, if the cell you're changing is <code>A1</code>, test to see if the <code>Target</code> cell matches. If so, determine the last used row on your destination sheet (<code>Sheet2</code>, below) and then assign the value.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = Range(\"A1\").Address Then\n\n        ' Get the last row on our destination sheet (using Sheet2, col A here)...\n        Dim intLastRow As Long\n        intLastRow = Sheet2.Cells(Sheet2.Rows.Count, \"A\").End(xlUp).Row\n\n        ' Add our value to the next row...\n        Sheet2.Cells(intLastRow + 1, \"A\") = Target.Value\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5219796"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9641, "favorite_count": 0, "protected_date": 1547653476, "accepted_answer_id": 31973811, "answer_count": 1, "score": 4, "last_activity_date": 1547643211, "creation_date": 1439405963, "last_edit_date": 1440594637, "question_id": 31973331, "link": "https://stackoverflow.com/questions/31973331/if-cell-value-changes-copy-value-to-another-worksheet", "title": "If cell value changes, copy value to another worksheet", "body": "<p>I created a project management template where I update the project's status on a regular basis. </p>\n\n<p>I want as soon as the cell value of one cell changes, the exact value will be copied to a cell on another worksheet. </p>\n\n<p>If the cell value of the original cell is changed again (due to further project updates), I want the value to be copied again but below the previous copy, and so on. </p>\n\n<p>As I would like to solve the problem on my own, I would be happy if you could give me some hints on how to proceed or where to look.</p>\n"}, {"tags": ["excel", "vba", "filtering", "simultaneous"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439405468, "post_id": 31973104, "comment_id": 51853181, "body": "You might be able to detect filter change on the worksheet, and apply the same filter to the second. <a href=\"http://stackoverflow.com/questions/28979396/excel-vba-filter-change-event-handler\" title=\"excel vba filter change event handler\">stackoverflow.com/questions/28979396/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 4938956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-KYzubtHUx9c/AAAAAAAAAAI/AAAAAAAAAC8/LQqRiKje6B8/photo.jpg?sz=128", "display_name": "piccolomair", "link": "https://stackoverflow.com/users/4938956/piccolomair"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439410945, "post_id": 31973104, "comment_id": 51855995, "body": "MatthewD , Okay that is pretty interesting. So following the link (and the link in within the link) I didn&#39;t see of a way to pull the results of the filter, unless I am reading it wrong."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439411082, "post_id": 31973104, "comment_id": 51856078, "body": "I&#39;m not sure about that.  But wouldn&#39;t the result be what is left on the sheet. Worst case you could loop the sheet checking if each row is hidden. If so hid it on the next sheet."}, {"owner": {"reputation": 25, "user_id": 4938956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-KYzubtHUx9c/AAAAAAAAAAI/AAAAAAAAAC8/LQqRiKje6B8/photo.jpg?sz=128", "display_name": "piccolomair", "link": "https://stackoverflow.com/users/4938956/piccolomair"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439412597, "post_id": 31973104, "comment_id": 51856915, "body": "Ah i see. So this probably wouldnt work for me. I already have a button that imports the schema (and copies it into the control and editable tabs) and then Hides columns (as the users do not need to see them and having them may confuse them).  I guess maybe I could create a button that would essentially run &quot;Record Macro&quot; and call the button &quot;Sort table&quot;, doing so would apply the filter and then record the users inputs, and then when the user is done performing the sorts, they would have to hit the STOP SORT button and that would trigger to end the recorded macro and run it on the control tab"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439416589, "post_id": 31973104, "comment_id": 51858730, "body": "It might be easier to give them a form with checkboxes or a combobox so they could define their filter and hit apply rather than having them use the excel filter through the worksheet.  That way when they hit apply you could apply the filter to both sheets based on what they selected on the form."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1439425431, "post_id": 31973104, "comment_id": 51861223, "body": "I rather use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775(v=office.14).aspx\" rel=\"nofollow noreferrer\">Worksheet.Change Event</a> to record changes. Or even the builtin <b><a href=\"https://support.office.com/en-za/article/Track-changes-in-a-shared-workbook-22aea671-cac7-4fa3-845d-eeb23725bd15\" rel=\"nofollow noreferrer\">Track Changes</a></b> feature."}], "owner": {"reputation": 25, "user_id": 4938956, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-KYzubtHUx9c/AAAAAAAAAAI/AAAAAAAAAC8/LQqRiKje6B8/photo.jpg?sz=128", "display_name": "piccolomair", "link": "https://stackoverflow.com/users/4938956/piccolomair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439405182, "creation_date": 1439405182, "question_id": 31973104, "link": "https://stackoverflow.com/questions/31973104/filter-two-tabs-with-the-same-data-simultaneously-in-excel", "title": "Filter two tabs with the same data simultaneously in Excel", "body": "<p>I've been looking for an answer to this and while I have found similar situations, the solutions provided did not help my current situation.</p>\n\n<p>I have a workbook that features two tabs that houses the same data. One tab is used as a \"control\" tab, the other one is used as an editable one so that users can change information and when they send submit the workbook, our database specialist can quickly find the altered values.</p>\n\n<p>The way this works is that the editable worksheet has a conditional format linking back to the \"control\" worksheet (i.e. A1 on the editable worksheet = A1 on the 'control' worksheet, A34 = A34, so on and so fourth).</p>\n\n<p>The issue is that our users want to be able to be able to sort out their projects only, and when they do that the control and editable sheets no longer will mirror one another and the conditional format activates on the entire set of data.</p>\n\n<p>I'm looking for a way that a user can sort on the editable sheet, and the \"control\" sheet will automatically do the same sort to maintain uniformity and thus the conditional format will only activate when an actual cell value is changed.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1439403585, "post_id": 31972559, "comment_id": 51852154, "body": "What line are you getting the error on?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 5, "creation_date": 1439403683, "post_id": 31972559, "comment_id": 51852208, "body": "Include <code>Set db = CurrentDb</code> somewhere before the first call to <code>db.OpenRecordset</code>"}, {"owner": {"reputation": 202, "user_id": 3847362, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38a21a9a8af071b8c5c3251cbfdca7e7?s=128&d=identicon&r=PG&f=1", "display_name": "theCowardlyFrench", "link": "https://stackoverflow.com/users/3847362/thecowardlyfrench"}, "edited": false, "score": 0, "creation_date": 1439403698, "post_id": 31972559, "comment_id": 51852215, "body": "Sorry, I&#39;ll edit my post.  It fails on: Set Records = db.OpenRecordset(&quot;SELECT consumer_id, program_id FROM billing_days_allentown1_temp&quot;)"}, {"owner": {"reputation": 202, "user_id": 3847362, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38a21a9a8af071b8c5c3251cbfdca7e7?s=128&d=identicon&r=PG&f=1", "display_name": "theCowardlyFrench", "link": "https://stackoverflow.com/users/3847362/thecowardlyfrench"}, "edited": false, "score": 0, "creation_date": 1439403783, "post_id": 31972559, "comment_id": 51852267, "body": "Thank you for the quick response HansUp, worked perfectly.  I knew I had to be missing something."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1439404252, "post_id": 31972559, "comment_id": 51852521, "body": "About that other issue ... do you mean here? <code>WHERE contract_name = [contract]</code>  What is <code>[contract]</code> supposed to represent?  You have a VBA variable named <i>contract</i>, but the db engine doesn&#39;t know anything about VBA variables.  If that is the issue, you can include the variable&#39;s value instead of its name in your SQL statement.  Or reference <code>Forms!formAllentownMasterGeneration!cboContract</code> directly in the SQL statement.  Or use a parameter query."}], "answers": [{"tags": [], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "is_accepted": false, "score": 0, "last_activity_date": 1439408706, "creation_date": 1439408706, "answer_id": 31974071, "question_id": 31972559, "link": "https://stackoverflow.com/questions/31972559/very-simple-module-failing-error-91-object-variable-or-with-block-variable-no/31974071#31974071", "title": "Very simple module failing. Error: 91, Object variable or With block variable not set", "body": "<p>Try this...it should clean up your SQL statements a little...and pass the variables, not [variable]</p>\n\n<pre><code>Dim year As String\nDim month As String\nDim contract As String\nDim programId As String\nDim ConsumerId As String\nDim programName As String\nDim strSQL As String\nDim strSQL2 As String\nDim db As Database\n\nDim Records As DAO.recordset\nDim Records2 As DAO.recordset\n\nyear = Me.cboYear   '&lt;--- Assuming you are on Forms!formAllentownMasterGeneration - you can use Me.\nmonth = Me.cboMonth\ncontract = Me.cboContract\n\n'Empty temporary table\nstrSQL = \"DELETE * FROM billing_days_allentown1_temp\"\n\n DoCmd.RunSQL (strSQL)\n\n 'Gather and insert consumer information into temp table\n strSQL = \"INSERT INTO Billing_days_allentown1_temp (consumer_id, program_id, lname, fname, dob, transport_type, memo) \" &amp; _\n          \"SELECT consumer_info.consumer_id, consumer_info.program_id, consumer_info.lname, consumer_info.fname, consumer_info.dob, consumer_info.transport_type, consumer_info.memo \" &amp; _\n          \"FROM consumer_info \" &amp; _\n          \"WHERE contract_name =\" &amp; contract\n\nDoCmd.RunSQL (strSQL)\n\n'Get ID's of all consumers in temp table so we can find program names\nstrSQL = \"SELECT consumer_id, program_id \" &amp; _\n         \"FROM Billing_days_allentown1_temp\"\n\nSet Records = db.OpenRecordset(strSQL)\n\nWhile Not Records.EOF\n  ConsumerId = Records!Fields(0)\n  programId = Records!Fields(1)\n\n  strSQL2 = \"SELECT name \" &amp; _\n            \"FROM program_info \" &amp; _\n            \"WHERE program_id = \" &amp; programId\n  Set Records2 = db.OpenRecordset(strSQL2)\n\n  ProgramName = Records2!Fields(0)\n\n  strSQL2 = \"UPDATE billing_days_allentown1_temp \" &amp; _\n            \"SET program_name = \" &amp; ProgramName &amp; \" \" &amp; _\n            \"WHERE program_id = \" &amp; programId &amp; \" and consumer_id = \" &amp; consumerId\n  DoCmd.RunSQL (strSQL2)\n\n  Records.MoveNext\n\nWend\n\nDoCmd.Close acForm, \"formAllentownMasterGeneration\"\n</code></pre>\n"}], "owner": {"reputation": 202, "user_id": 3847362, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/38a21a9a8af071b8c5c3251cbfdca7e7?s=128&d=identicon&r=PG&f=1", "display_name": "theCowardlyFrench", "link": "https://stackoverflow.com/users/3847362/thecowardlyfrench"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439408706, "creation_date": 1439403381, "question_id": 31972559, "link": "https://stackoverflow.com/questions/31972559/very-simple-module-failing-error-91-object-variable-or-with-block-variable-no", "title": "Very simple module failing. Error: 91, Object variable or With block variable not set", "body": "<p>This code simply pulls information from a table, and inserts it into a temporary table.  From there, it updates the rows with the correct program name that correlates to the program id given, which is where it fails.</p>\n\n<p>I'm not sure why this simple module won't run, I've declared the variable, as well as initialized it.  The query is super simple, as well.  Any help would  be appreciated -- I have got to me missing something painfully obvious.</p>\n\n<pre><code>Dim year As String\nDim month As String\nDim contract As String\nDim programId As String\nDim ConsumerId As String\nDim programName As String\n\nDim db As Database\n\nDim Records As DAO.recordset\nDim Records2 As DAO.recordset\n\n\nyear = Forms!formAllentownMasterGeneration!cboYear\nmonth = Forms!formAllentownMasterGeneration!cboMonth\ncontract = Forms!formAllentownMasterGeneration!cboContract\n\n'Empty temporary table\nstrSQL = \"DELETE * FROM billing_days_allentown1_temp\"\n\n DoCmd.RunSQL (strSQL)\n\n 'Gather and insert consumer information into temp table\n strSQL = \"INSERT INTO Billing_days_allentown1_temp (consumer_id, program_id, lname, fname, dob, transport_type, memo) SELECT consumer_info.consumer_id, consumer_info.program_id, consumer_info.lname, consumer_info.fname, consumer_info.dob, consumer_info.transport_type, consumer_info.memo FROM consumer_info WHERE contract_name = [contract]\"\n\nDoCmd.RunSQL (strSQL)\n\n'Get ID's of all consumers in temp table so we can find program names\nstrSQL = \"SELECT consumer_id, program_id FROM Billing_days_allentown1_temp\"\n\nSet Records = db.OpenRecordset(\"SELECT consumer_id, program_id FROM billing_days_allentown1_temp\")\n\nWhile Not Records.EOF\n\nConsumerId = Records!Fields(0)\nprogramId = Records!Fields(1)\n\nstrSQL2 = \"SELECT name FROM program_info where program_id = [programId]\"\nSet Records2 = db.OpenRecordset(\"SELECT name FROM program_info where program_id = [programId]\")\n\nprogramName = Records2!Fields(0)\n\nstrSQL2 = \"UPDATE billing_days_allentown1_temp SET program_name = [ProgramName] WHERE program_id = programId and consumer_id = [consumerId]\"\nDoCmd.RunSQL (strSQL2)\n\nRecords.MoveNext\n\nWend\n\nDoCmd.Close acForm, \"formAllentownMasterGeneration\"\n</code></pre>\n\n<p>Additionally (but admittedly a problem I haven't looked into yet), it prompts me for the contract name, despite providing it in the form.  I'm sure I am referencing the variable wrong in a query; but my VBA is pretty rusty.  If it's a quick fix, I'd appreciate someone pointing that out as well, otherwise it's something I'll fix on my own in due time.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "charts"], "owner": {"reputation": 97, "user_id": 4978108, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/663dc6868e6100b80bba674020008c91?s=128&d=identicon&r=PG&f=1", "display_name": "adventurer", "link": "https://stackoverflow.com/users/4978108/adventurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1440389723, "creation_date": 1439403221, "last_edit_date": 1440389723, "question_id": 31972517, "link": "https://stackoverflow.com/questions/31972517/plot-charts-dynamically-for-the-range-against-same-string-values", "title": "Plot charts dynamically for the range against same string values", "body": "<p>The sample data set is given at <a href=\"http://bit.ly/1L67ZFu\" rel=\"nofollow\">http://bit.ly/1L67ZFu</a>\nThe charts I'm getting from these by the below code is given at <a href=\"http://bit.ly/1P73A2U\" rel=\"nofollow\">http://bit.ly/1P73A2U</a></p>\n\n<p>In the code below, the rows are fixed from 1 to 7. I am having dynamic number of depts and dynamic number od parameters say like I can have parameters till parameter 6 and each of parameters can occur for any number of times in column 1. How should I modify the code if I want to plot a chart all the parameters dynamically. I want the code to plot the chart for the rows against same parameter. Like I want in total 14 graphs if the number of paramerters are from parameter1 to parameter 7.Kindly suggest me modifications in code for this.</p>\n\n<pre><code>Sub PlotSeparateChartsByMergedFirstRow()\n Dim rUsed As Range, rMerged As Range, rChtData As Range\n Dim rChtDat1 As Range, rChtDat2 As Range\n Dim iColMerge As Long, iColData As Long\n Dim cht1 As Chart, cht2 As Chart\n Dim lastCol As Integer\n\n Const iChtHeight As Double = 175\n lastCol = ActiveSheet.Cells(1, ActiveSheet.Columns.Count).End(xlToLeft).Column     \n Set rUsed = ActiveSheet.Range(Cells(1, 2), Cells(7, lastCol))\n iColMerge = 1\n\n Do\n    iColMerge = iColMerge + 1\n    If iColMerge &gt; rUsed.Columns.Count Then Exit Do\n\n    If rUsed.Cells(1, iColMerge).mergecells Then\n       Set rMerged = rUsed.Cells(1, iColMerge).MergeArea\n       Set rChtData = rMerged.Resize(rUsed.Rows.Count)\n\n       ' x values\n       Set rChtDat1 = rUsed.Columns(1)\n       Set rChtDat2 = rUsed.Columns(1)\n\n       ' y values\n       For iColData = 1 To rChtData.Columns.Count - 1 Step 2\n          Set rChtDat1 = Union(rChtDat1, rChtData.Columns(iColData))\n          Set rChtDat2 = Union(rChtDat2, rChtData.Columns(iColData + 1))\n       Next\n\n       ' charts\n       ' 2007, 2010\n       Set cht1 = ActiveSheet.Shapes.AddChart(xlColumnClustered, rChtData.left,   rChtData.Height, rChtData.Width, iChtHeight).Chart\n       ' 2013\n       'Set cht1 = ActiveSheet.Shapes.AddChart2(201, xlColumnClustered, rChtData.Left, rChtData.Height, rChtData.Width, iChtHeight).Chart\n       With cht1\n          .HasTitle = True\n          .ChartTitle.Text = \"=\" &amp; rUsed.Cells(1, iColMerge).Address(, , , True)\n\n          .SetSourceData rChtDat1, xlColumns\n\n       End With\n\n       ' 2007, 2010\n       Set cht2 = ActiveSheet.Shapes.AddChart(xlColumnClustered, rChtData.left, rChtData.Height + iChtHeight, _\n       rChtData.Width, iChtHeight).Chart\n       ' 2013\n       'Set cht2 = ActiveSheet.Shapes.AddChart2(201, xlColumnClustered, rChtData.Left, rChtData.Height + iChtHeight, rChtData.Width, iChtHeight).Chart\n\n        With cht2\n          .HasTitle = True\n          .ChartTitle.Text = \"=\" &amp; rUsed.Cells(1, iColMerge).Address(, , , True)\n          .SetSourceData rChtDat2, xlColumns\n       End With\n\n    End If\n    iColMerge = iColMerge + rMerged.Columns.Count - 1\n Loop\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439402952, "post_id": 31972263, "comment_id": 51851794, "body": "To add a little clarity here, declaring it as type Long will exponentially increase the value able to be held in the variable."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439403423, "post_id": 31972263, "comment_id": 51852047, "body": "@Grade&#39;Eh&#39;Bacon it will increase it from 181 to 46340."}], "tags": [], "owner": {"reputation": 18440, "user_id": 2441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WcvRM.png?s=128&g=1", "display_name": "aphoria", "link": "https://stackoverflow.com/users/2441/aphoria"}, "is_accepted": false, "score": 0, "last_activity_date": 1439402349, "creation_date": 1439402349, "answer_id": 31972263, "question_id": 31972060, "link": "https://stackoverflow.com/questions/31972060/excel-vba-function-collapses-if-variables-have-declared-type/31972263#31972263", "title": "Excel VBA function collapses if variables have declared type", "body": "<p>In VBA, an integer can have a maximum value of 32,767. I'm guessing you're exceeding that and getting an error.</p>\n\n<p>When you don't declare your variable <code>As Integer</code>, it is automatically created as type <code>Variant</code> which has a much larger maximum value.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4911108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a1fcdf8133e60d1bd269f3e62453e3?s=128&d=identicon&r=PG&f=1", "display_name": "Skipper", "link": "https://stackoverflow.com/users/4911108/skipper"}, "edited": false, "score": 0, "creation_date": 1439417949, "post_id": 31972526, "comment_id": 51859185, "body": "Thanks! It works! I use Long as ULong and Decimal is not recognized by Excel for Mac 2011. For the demonstration of RSA I need just two small primes (eg. 13, 17). Long is enough."}], "tags": [], "owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "is_accepted": false, "score": 0, "last_activity_date": 1439403251, "creation_date": 1439403251, "answer_id": 31972526, "question_id": 31972060, "link": "https://stackoverflow.com/questions/31972060/excel-vba-function-collapses-if-variables-have-declared-type/31972526#31972526", "title": "Excel VBA function collapses if variables have declared type", "body": "<p>Your data type needs to be able to handle up to <code>m * m</code>.  The Integer datatype has a maximum value of 2^15-1 (or 32,767), so can handle <strong>m</strong> up to 181.</p>\n\n<p>The default data type works because it's <code>double</code> which has a large range, but is also not an exact numeric.  Whet you probably want is to declare everything as <code>Decimal</code> which has a range up to <strong><em>10^28</em></strong>, so can handle <strong>m</strong> up to 100,000,000,000,000 and is an exact numeric.</p>\n"}], "owner": {"reputation": 11, "user_id": 4911108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a1fcdf8133e60d1bd269f3e62453e3?s=128&d=identicon&r=PG&f=1", "display_name": "Skipper", "link": "https://stackoverflow.com/users/4911108/skipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1439407693, "creation_date": 1439401610, "last_edit_date": 1439407693, "question_id": 31972060, "link": "https://stackoverflow.com/questions/31972060/excel-vba-function-collapses-if-variables-have-declared-type", "title": "Excel VBA function collapses if variables have declared type", "body": "<p>I have written a short function to calculate a power of a number modulo N. I can get out of the range of any integer like type, so I've written a loop, that calculates only modulus values:</p>\n\n<pre><code>Function ModPwr(b As Integer, e As Integer, m As Integer) As Integer\nDim r As Integer\nr = 1\nDo While e &gt; 0\n    r = r * b Mod m\n    e = e - 1\nLoop\nModPwr = r\nEnd Function\n</code></pre>\n\n<p>The function collapses or return zero for some input (eg: 217, 143, 221). If I completly remove all \"As Integer\" and the Dim declaration, everything works fine:</p>\n\n<pre><code>Function ModPwr(b, e, m)\nr = 1\nDo While e &gt; 0\n    r = r * b Mod m\n    e = e - 1\nLoop\nModPwr = r\nEnd Function\n</code></pre>\n\n<p>I have to implement an RSA demo in Excel to demonstrate the encryption/decryption method (using small primes!). I am a newby in VBA.</p>\n\n<p>In other (more complicated) functions I need the type declaration, so I have to find the problem.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1439401803, "post_id": 31972050, "comment_id": 51851175, "body": "Can&#39;t you just use x=date()?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439402090, "post_id": 31972050, "comment_id": 51851348, "body": "OP have you actually tried to run the code above? Simply pasting some code saying &#39;this is what I have now&#39; doesnt tell us what fails in that code. Explain what you want it to do, and what it actually does."}], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1439402444, "post_id": 31972183, "comment_id": 51851557, "body": "Hey Tim, just saw your answer and mine is very similar. Feel free to delete mine/merge whatever extra bits I have if it&#39;s appropriate."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1439438089, "post_id": 31972183, "comment_id": 51864092, "body": "@puzzlepiece87 while similar, Tim&#39;s code caters for no match with the <code>Is Nothing</code> test. Its a better way to go."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1439477755, "post_id": 31972183, "comment_id": 51887723, "body": "@brettdj I completely agree, <i>and</i> he won the fastest gun contest :P I am not completely sure of the meta on two questions entered at the same time, but I was saying that since mine doesn&#39;t have much value that Tim&#39;s answer doesn&#39;t already have, he can feel free to delete my answer and take anything extra I might have added for his answer :)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1439481405, "post_id": 31972183, "comment_id": 51890455, "body": "I don&#39;t care either way - I&#39;m certainly not going to delete anyone else&#39;s answer."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1439402049, "creation_date": 1439402049, "answer_id": 31972183, "question_id": 31972050, "link": "https://stackoverflow.com/questions/31972050/vba-how-do-i-search-for-a-formula-driven-value/31972183#31972183", "title": "VBA: How do I search for a formula driven value?", "body": "<p>This should do it.  Note that your original code will throw an error if today's date isn't found. Typically when working with Find() it's safer to test the returned value before trying to do something with it.</p>\n\n<pre><code>Dim f As Range\nSet f = Columns(\"A:A\").Find(What:=Date(), After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n\nIf Not f Is Nothing then\n    'do something with f\nElse\n    '???? do what\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": false, "score": 0, "last_activity_date": 1439402268, "last_edit_date": 1495540331, "creation_date": 1439402268, "answer_id": 31972236, "question_id": 31972050, "link": "https://stackoverflow.com/questions/31972050/vba-how-do-i-search-for-a-formula-driven-value/31972236#31972236", "title": "VBA: How do I search for a formula driven value?", "body": "<p>You could replace your entire code with this:</p>\n\n<pre><code>Activesheet.Columns(\"A:A\").Find(What:=ActiveSheet.Range(\"K1\"), After:=ActiveCell, _\nLookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False).Activate\n</code></pre>\n\n<p>What was happening is that there's no way to paste a cell's contents via .Copy directly into a VBA function. So I placed what you wanted to paste into it into the function directly.</p>\n\n<p>I think you will also find this helpful:\n<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n"}], "owner": {"reputation": 11, "user_id": 5220457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13309ccffd3d551bbbf82ee57029f5dd?s=128&d=identicon&r=PG&f=1", "display_name": "jordancole", "link": "https://stackoverflow.com/users/5220457/jordancole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1440389814, "creation_date": 1439401581, "last_edit_date": 1440389814, "question_id": 31972050, "link": "https://stackoverflow.com/questions/31972050/vba-how-do-i-search-for-a-formula-driven-value", "title": "VBA: How do I search for a formula driven value?", "body": "<p>I am trying to search for the date, which I have in cell K1 as <code>=today()</code>....</p>\n\n<p>Whenever I am recording the macro, however, it will continue to use the date which the macro was written. What I am curious about is a methodology of pasting what is on the clipboard into the VBA search function. </p>\n\n<p>So I want to search column A for what is in cell K1. This is what code I have now (the find what is what I just typed to help you all have an idea of what I'm looking for)</p>\n\n<pre><code>Range(\"K1\").Select\nSelection.Copy\nColumns(\"A:A\").Select\nSelection.Find(What:=\"COPY CONTENTS OF CELL K1\", After:=ActiveCell,    LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439401890, "post_id": 31971990, "comment_id": 51851221, "body": "You declare your variables as &#39;Private&#39; outside of your sub window. I was not aware that this is possible; have you tried moving those declarations down to being held within the subs that use them?"}], "answers": [{"comments": [{"owner": {"reputation": 781, "user_id": 5175125, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10206341392667431/picture?type=large", "display_name": "Richard Lusch", "link": "https://stackoverflow.com/users/5175125/richard-lusch"}, "edited": false, "score": 0, "creation_date": 1439402697, "post_id": 31972219, "comment_id": 51851660, "body": "Good grief.  Thanks for the extra set of eyes!  I did reverse the Sheet name and Chart name.  The code works fine."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 0, "last_activity_date": 1439402211, "creation_date": 1439402211, "answer_id": 31972219, "question_id": 31971990, "link": "https://stackoverflow.com/questions/31971990/how-to-overcome-runtime-error-9-when-using-passed-variables-in-activeworkbook-sh/31972219#31972219", "title": "How to overcome Runtime Error 9 when using passed variables in ActiveWorkbook.Sheets()?", "body": "<p>the strings being passed to the parameters are indeed names of sheets and charts in my excel file.</p>\n\n<p>Are you sure?</p>\n\n<p>Does a sheet named \"Chart 3\" have a chart object with the name \"Chart\".  (When the chart is selected the chart name is shown on the toolbar to the left of the formulabar ).  Charts are normally named \"Chart 1\", \"Chart 2\" unless you change them!</p>\n\n<p>Also add a break point on the problem line and in the immediate window check the active workbook!  debug.print Activeworkbook.name </p>\n\n<p>You code looks ok.<br>\nh</p>\n"}], "owner": {"reputation": 781, "user_id": 5175125, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10206341392667431/picture?type=large", "display_name": "Richard Lusch", "link": "https://stackoverflow.com/users/5175125/richard-lusch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 31972219, "answer_count": 1, "score": 0, "last_activity_date": 1439402211, "creation_date": 1439401333, "question_id": 31971990, "link": "https://stackoverflow.com/questions/31971990/how-to-overcome-runtime-error-9-when-using-passed-variables-in-activeworkbook-sh", "title": "How to overcome Runtime Error 9 when using passed variables in ActiveWorkbook.Sheets()?", "body": "<p>I am writing code in Excel VBA, 2007, to copy specific charts and tables into specific Slides and specific Placeholders.  I have made working code to do this, but it is long and hard to read and understand what is happening.  To that end, I decided to write a sub to handle the brunt of the workload and reduce the amount of code I have.  I worked through some syntax errors in passing the parameters, but now I have run into an issue that I cannot quite understand.  I am getting Runtime error 9 in reference to the line of code below.</p>\n\n<pre><code>ActiveWorkbook.Sheets(oSheet).ChartObjects(oChart).CopyPicture\n</code></pre>\n\n<p>This line of code works just fine in the old program, without the variables having been passed to it.  I tried a couple different ways of attacking the problem based on some information I had, such as enclosing the variable in quotation marks,adding \u2018.Value\u2019 to the end of the variable, and I have also switched between ByVal and ByRef in the beginning of the code.  I have also verified that the parameters are beeing passed correctly to Sub CopyChart correctly by stepping through the code and watching the Locals window.  Also, the strings being passed to the parameters are indeed names of sheets and charts in my excel file.  Below is a shortened version of the code I am using.</p>\n\n<pre><code>            Private nPlcHolder As Integer\n            Private PPApp As PowerPoint.Application\n            Private PPPres As PowerPoint.Presentation\n            Private PPSlide As PowerPoint.Slide\n            Private x As Integer\n            Private oSheet As String\n            Private oChart As String\n\n            Public Sub CopyChart(ByRef x As Integer, ByRef y As Integer, ByRef oSheet As String, ByRef oChart As String)\n            'x is slide number(count zero as 1), y as placeholder number\n                ActiveWorkbook.Sheets(oSheet).ChartObjects(oChart).CopyPicture\n                PPPres.Slides(x).Select\n                With PPPres\n                    nPlcHolder = y\n                    .Slides(x).Shapes.Placeholders(nPlcHolder).Select msoTrue\n                    .Windows(1).View.PasteSpecial (ppPasteMetafilePicture)\n                End With\n            End Sub\n\n            Sub ChartToPresentation()\n                ' Uses Early Binding to the PowerPoint Object Model\n                ' Reference existing instance of PowerPoint\n                    Set PPApp = GetObject(, \"Powerpoint.Application\")\n                    ' Reference active presentation\n                    Set PPPres = PPApp.ActivePresentation\n                    PPApp.ActiveWindow.ViewType = ppViewSlide\n\n                    Call CopyChart(6, 2, \"Chart 3\", \"Charts\")\n                    Call CopyChart(7, 2, \"Chart 1\", \"Charts\")\n                   ' Clean up\n                    Set PPSlide = Nothing\n                    Set PPPres = Nothing\n                    Set PPApp = Nothing\n            End Sub\n</code></pre>\n\n<p>Any and all help is greatly appreciated.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1439401138, "post_id": 31971861, "comment_id": 51850813, "body": "If the second option group has no option button with a value of 0, I can set the default to 0 anyways? Also, will disabling group 2 cause it to revert to its default value of 0?"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1439401381, "post_id": 31971861, "comment_id": 51850947, "body": "No and No.  The second option button should have a value for 0 - even if it is a hidden option button the the user cannot chnage.  Consider: f the optional group value is stored in a field you might end up with non-0 values being stored when option group 1 has been set to 0.  So store 0 for option group 2 as a adefault just to make the data in the table clearer."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1439402237, "post_id": 31971861, "comment_id": 51851436, "body": "I ended up creating a GotFocus event on the first group that sets group 2 = 0 if None is selected! Works like a charm as far as I can tell."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1439402306, "post_id": 31971861, "comment_id": 51851475, "body": "Great, there&#39;s always many ways to get something done... That sounds elegant.  Can you tick my answer as an answer! Tahnks"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 0, "last_activity_date": 1439400851, "creation_date": 1439400851, "answer_id": 31971861, "question_id": 31971355, "link": "https://stackoverflow.com/questions/31971355/bind-an-option-button-to-2-fields-vba-to-change-a-field-based-on-option-button/31971861#31971861", "title": "Bind an Option Button to 2 Fields / VBA to change a field based on Option Button", "body": "<p>I would change the the first option group so that it has event code which will alter properties of the second option group.</p>\n\n<p>So if the user changes option group 1 to be 101, or 102 the option group 2 controls have their \"enabled\" property set to true.  If the 1st is set to 0 then enabled is set to false AND ALSO the 2nd option group value is set to 0.</p>\n\n<p>If you need more help with adding events and VBA let me know, but from what I can tell from your profile I think you will be able to take it from here.</p>\n\n<p>You will ONLY need to write code in the After_Update event property of the 1st option group.  This code manages the second option group.</p>\n\n<p>You should also set the default value of the 2nd option group to be 0.</p>\n\n<p>Harvey</p>\n"}], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 31971861, "answer_count": 1, "score": 0, "last_activity_date": 1439402378, "creation_date": 1439399025, "question_id": 31971355, "link": "https://stackoverflow.com/questions/31971355/bind-an-option-button-to-2-fields-vba-to-change-a-field-based-on-option-button", "title": "Bind an Option Button to 2 Fields / VBA to change a field based on Option Button", "body": "<p><strong>What I have</strong></p>\n\n<p>I have a form in which there is a section with 2 Option groups. The first option group has 3 values - 101, 102, and \"None\" which respectively return 101, 102, and 0 to the bound field. There is a second Option group underneath, that should only be filled when the first is not \"None\". That option group is also bound to a different field and has no default value. </p>\n\n<p><strong>My question</strong></p>\n\n<p>Is it possible to have the \"None\" OptionButton return 0 for both option groups? If not, it is probably possible if I un-bind the tables and do it all via VBA, which I have no problem with (and even prefer). I am not sure how, though - which VBA statement can update a field based on any criteria, be it group value or other?</p>\n"}, {"tags": ["vba", "sockets", "visual-c++", "network-programming"], "answers": [{"comments": [{"owner": {"reputation": 1428, "user_id": 1971306, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9927c82a5965998d91e3a2fe484e7f33?s=128&d=identicon&r=PG", "display_name": "aquirdturtle", "link": "https://stackoverflow.com/users/1971306/aquirdturtle"}, "edited": false, "score": 0, "creation_date": 1439401479, "post_id": 31971523, "comment_id": 51851000, "body": "Indeed I was being an idiot, even though I don&#39;t program in PHP/jQuery. Turns out I just don&#39;t understand how to code in Visual Basic XD  The short answer is -&gt;yes this is possible. If you correctly set up a server in one program and a client on another, they should be able to communicate with each other.  Thanks for the answer, sorry for the bad question."}], "tags": [], "owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "is_accepted": true, "score": 1, "last_activity_date": 1439399609, "creation_date": 1439399609, "answer_id": 31971523, "question_id": 31971104, "link": "https://stackoverflow.com/questions/31971104/basic-communicating-between-programs-running-on-different-computers-running-diff/31971523#31971523", "title": "Basic Communicating Between Programs Running on Different Computers Running Different Languages", "body": "<blockquote>\n  <p>is a direct socket communication between Visual C++ and Visual Basic\n  Possible?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>Are there better alternatives?</p>\n</blockquote>\n\n<p>Possibly, depends...</p>\n\n<blockquote>\n  <p>Am I an idiot?</p>\n</blockquote>\n\n<p>Unknown at this time.  Do you also program in PHP/jQuery? </p>\n\n<blockquote>\n<pre><code>Is there somewhere a beginner should go to learn about these types of things?\nLet me know if there is anything I can do to clarify the question.\n</code></pre>\n</blockquote>\n\n<p>There are LOADS of Q&amp;A on socket programming on SO :)</p>\n"}], "owner": {"reputation": 1428, "user_id": 1971306, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9927c82a5965998d91e3a2fe484e7f33?s=128&d=identicon&r=PG", "display_name": "aquirdturtle", "link": "https://stackoverflow.com/users/1971306/aquirdturtle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 31971523, "answer_count": 1, "score": 0, "last_activity_date": 1439399609, "creation_date": 1439398174, "question_id": 31971104, "link": "https://stackoverflow.com/questions/31971104/basic-communicating-between-programs-running-on-different-computers-running-diff", "title": "Basic Communicating Between Programs Running on Different Computers Running Different Languages", "body": "<p><strong>The Problem:</strong> For beginners, what is the fastest / simplest way to get two programs running in different languages and running on different computers to send simple messages to each other?</p>\n\n<p><strong>My Details:</strong> I have two computers, one running a program in Visual C++, and one running a program in Visual Basic (both off of visual studio 2013, although I may need to do this with some older visual basic code, pre .NET era). They are running in different languages for a combination of hardware and legacy reasons. The communication would be simple: a simple binary trigger (on/off signal) would work, or if it was easy a single character, word, or string describing the program's status.</p>\n\n<p><strong>What I've Tried:</strong> I know little about communication protocols and this sort of thing, but I understand that \"Socket\" programming might be a simple way to do such communication. It sounds like the TCP Protocol would suit me fine. Unfortunately all examples that I have seen communicate using the same programming language (e.g. C++ to C++ or basic to basic). I also understand that an alternative might be to run some basic code from within C++ or vice-versa, but this seems like a somewhat cumbersome solution.</p>\n\n<p>Using some online guides, I've been able to get my two computers to communicate with each other when they are both using C++ (via the Winsock tool), but when I try to mash a C++ Server with a Visual Basic Client, they fail to connect. The code I am using, which has largely been hijacked and slightly modified from the following websites (<a href=\"https://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient(v=vs.110).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient(v=vs.110).aspx</a>) and (<a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms738545(v=vs.85).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms738545(v=vs.85).aspx</a>)\nis below, in case you'd like to look at it.</p>\n\n<p><strong>Summary Questions:</strong></p>\n\n<ul>\n<li>Is a direct socket communication between Visual C++ and Visual Basic Possible?</li>\n<li>Are there better alternatives?</li>\n<li>Am I an idiot?</li>\n<li>Is there somewhere a beginner should go to learn about these types of things?</li>\n<li>Let me know if there is anything I can do to clarify the question.</li>\n</ul>\n\n<p><strong>The Visual Basic TCP Client:</strong></p>\n\n<pre><code>Imports System\nImports System.Text\nImports System.IO\nImports System.Net\nImports System.Net.Sockets\nImports Microsoft.VisualBasic\n\nPublic Class GetSocket\n\nShared Sub Connect(server As [String], message As [String])\n    Try\n        ' Create a TcpClient. \n        ' Note, for this client to work you need to have a TcpServer  \n        ' connected to the same address as specified by the server, port \n        ' combination. \n        Dim port As Int32 = 27015\n        Dim client As New TcpClient(server, port)\n\n        ' Translate the passed message into ASCII and store it as a Byte array. \n        Dim data As [Byte]() = System.Text.Encoding.ASCII.GetBytes(message)\n\n        ' Get a client stream for reading and writing. \n        '  Stream stream = client.GetStream(); \n        Dim stream As NetworkStream = client.GetStream()\n\n        ' Send the message to the connected TcpServer. \n        stream.Write(data, 0, data.Length)\n\n        Console.WriteLine(\"Sent: {0}\", message)\n\n        ' Receive the TcpServer.response. \n        ' Buffer to store the response bytes.\n        data = New [Byte](256) {}\n\n        ' String to store the response ASCII representation. \n        Dim responseData As [String] = [String].Empty\n\n        ' Read the first batch of the TcpServer response bytes. \n        Dim bytes As Int32 = stream.Read(data, 0, data.Length)\n        responseData = System.Text.Encoding.ASCII.GetString(data, 0, bytes)\n        Console.WriteLine(\"Received: {0}\", responseData)\n\n        ' Close everything.\n        stream.Close()\n        client.Close()\n    Catch e As ArgumentNullException\n        Console.WriteLine(\"ArgumentNullException: {0}\", e)\n    Catch e As SocketException\n        Console.WriteLine(\"SocketException: {0}\", e)\n    End Try\n\n    Console.WriteLine(ControlChars.Cr + \" Press Enter to continue...\")\n    Console.Read()\nEnd Sub 'Connect\n\nPublic Shared Sub Main()\n    Dim host As String = \"192.168.107.254\"\n    Dim message As String = \"I SPEAK TO YOU FROM THE OTHER SIDE\"\n\n    Connect(host, message)\n\nEnd Sub 'Main\n' WHY ARE COMMENTS SO WEIRD IN BASIC\nEnd Class\n</code></pre>\n\n<p><strong>The Visual C++ Server:</strong></p>\n\n<pre><code>#include \"stdafx.h\"\n\n#include &lt;winsock2.h&gt;\n\n#include &lt;ws2tcpip.h&gt;\n\n#include &lt;stdio.h&gt;\n\n\n\n\n#pragma comment(lib, \"Ws2_32.lib\")\n\n#define DEFAULT_PORT \"27015\"\n\n#define DEFAULT_BUFLEN 512\n\n\n\n\nint main() {\n\nWSADATA wsaData;\n\nint iResult;\n\n\n\n\n// Initialize Winsock\n\niResult = WSAStartup(MAKEWORD(2, 2), &amp;wsaData);\n\nif (iResult != 0) {\n\n    printf(\"WSAStartup failed: %d\\n\", iResult);\n\n    getchar();\n\n    return 1;\n\n}\n\n\n\n\nstruct addrinfo *result = NULL, *ptr = NULL, hints;\n\n\n\n\nZeroMemory(&amp;hints, sizeof(hints));\n\nhints.ai_family = AF_INET;\n\nhints.ai_socktype = SOCK_STREAM;\n\nhints.ai_protocol = IPPROTO_TCP;\n\nhints.ai_flags = AI_PASSIVE;\n\n\n\n\n// Resolve the local address and port to be used by the server\n\niResult = getaddrinfo(NULL, DEFAULT_PORT, &amp;hints, &amp;result);\n\n\n\nif (iResult != 0) {\n\n    printf(\"getaddrinfo failed: %d\\n\", iResult);\n\n    WSACleanup();\n\n    getchar();\n\n    return 1;\n\n}\n\n\n\n\nSOCKET ListenSocket = INVALID_SOCKET;\n\n\n\n\nListenSocket = socket(result-&gt;ai_family, result-&gt;ai_socktype, result-&gt;ai_protocol);\n\n\n\nif (ListenSocket == INVALID_SOCKET) {\n\n    printf(\"Error at socket(): %ld\\n\", WSAGetLastError());\n\n    freeaddrinfo(result);\n\n    WSACleanup();\n\n    getchar();\n\n    return 1;\n\n}\n\n\n\n\n// Setup the TCP listening socket\n\niResult = bind(ListenSocket, result-&gt;ai_addr, (int)result-&gt;ai_addrlen);\n\nif (iResult == SOCKET_ERROR) {\n\n    printf(\"bind failed with error: %d\\n\", WSAGetLastError());\n\n    freeaddrinfo(result);\n\n    closesocket(ListenSocket);\n\n    WSACleanup();\n\n    getchar();\n\n    return 1;\n\n}\n\n\n\n\nfreeaddrinfo(result);\n\n\n\n\nif (listen(ListenSocket, SOMAXCONN) == SOCKET_ERROR) {\n\n    printf(\"Listen failed with error: %ld\\n\", WSAGetLastError());\n\n    closesocket(ListenSocket);\n\n    WSACleanup();\n\n    return 1;\n\n}\n\n\n\n\nSOCKET ClientSocket;\n\n\n\n\nClientSocket = INVALID_SOCKET;\n\n\n\n\n// Accept a client socket\n\nClientSocket = accept(ListenSocket, NULL, NULL);\n\nif (ClientSocket == INVALID_SOCKET) {\n\n    printf(\"accept failed: %d\\n\", WSAGetLastError());\n\n    closesocket(ListenSocket);\n\n    WSACleanup();\n\n    return 1;\n\n}\n\n\n\n\nchar recvbuf[DEFAULT_BUFLEN];\n\nint iSendResult;\n\nint recvbuflen = DEFAULT_BUFLEN;\n\n\n\n\n// Receive until the peer shuts down the connection\n\ndo {\n\n    iResult = recv(ClientSocket, recvbuf, recvbuflen, 0);\n\n    if (iResult &gt; 0) {\n\n        printf(\"Bytes received: %d\\n\", iResult);\n\n        printf(\"recieved message: %s\\n\", recvbuf);\n\n        // Echo the buffer back to the sender\n\n        iSendResult = send(ClientSocket, recvbuf, iResult, 0);\n\n        if (iSendResult == SOCKET_ERROR) {\n\n            printf(\"send failed: %d\\n\", WSAGetLastError());\n\n            closesocket(ClientSocket);\n\n            WSACleanup();\n\n            return 1;\n\n        }\n\n        printf(\"Bytes sent: %d\\n\", iSendResult);\n\n    }\n\n    else if (iResult == 0)\n\n        printf(\"Connection closing...\\n\");\n\n    else {\n\n        printf(\"recv failed: %d\\n\", WSAGetLastError());\n\n        closesocket(ClientSocket);\n\n        WSACleanup();\n\n        return 1;\n\n    }\n\n\n\n\n} while (iResult &gt; 0);\n\n\n\n\n// shutdown the send half of the connection since no more data will be sent\n\niResult = shutdown(ClientSocket, SD_SEND);\n\nif (iResult == SOCKET_ERROR) {\n\n    printf(\"shutdown failed: %d\\n\", WSAGetLastError());\n\n    closesocket(ClientSocket);\n\n    WSACleanup();\n\n    return 1;\n\n}\n\n\n\n\n// cleanup\n\nclosesocket(ClientSocket);\n\nWSACleanup();\n\n\n\n\nprintf(\"Success!\");\n\ngetchar();\n\nreturn 0;\n\n}\n</code></pre>\n"}, {"tags": ["vba", "excel", "criteria", "delete-row"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439399306, "post_id": 31971074, "comment_id": 51849742, "body": "My guess is that one of your cells contains, for example, &quot;Add&quot;, which is not all uppercase like ADD; therefore it is not considered &#39;identical&#39; to your search term. See my answer below which eliminates some common &#39;invisible&#39; differences between text values."}], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1439399583, "last_edit_date": 1495540680, "creation_date": 1439399583, "answer_id": 31971515, "question_id": 31971074, "link": "https://stackoverflow.com/questions/31971074/vba-delete-rows-based-on-multiple-criteria-code-is-missing-some-of-the-criteri/31971515#31971515", "title": "vba delete rows based on multiple criteria - code is missing some of the criteria", "body": "<p>[Answer taken from a previous question here: <a href=\"https://stackoverflow.com/q/31943667/5090027\">IF-THEN w/ strings in VBA</a>]</p>\n\n<p>How 'identical' are the two strings? Is one capitalized and the other not? Does one have leading/trailing zeros? Does one have non-printable characters?</p>\n\n<p>Try this, which turns Cell into CleanedCell before using as a comparison:</p>\n\n<pre><code>CleanedCell = AllCleanedUp(Cell)\n\nIf CleanedCell = \"ADD\" Or CleanedCell = \"ANFR\" Or CleanedCell = \"CADV\" Or CleanedCell = \"DEF\" Or CleanedCell = \"DEFD\" Or CleanedCell = \"OIL\" Or CleanedCell = \"PROP\" Or CleanedCell = \"STAX\" Or CleanedCell = \"UREA\" Or CleanedCell = \"WWFL\" Or CleanedCell = \"NGAS\" Then\n    Cell.EntireRow.Delete\nEnd If\n</code></pre>\n\n<p>...</p>\n\n<p>Which refers to the following function:</p>\n\n<pre><code>Function AllCleanedUp (DirtyString byVal) As String\n\n    AllCleanedUp = Trim(Application.Clean(Ucase(DirtyString)))\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1439399790, "post_id": 31971516, "comment_id": 51850042, "body": "Note that there could also be non-printable characters (such as line-breaks), which are not considered trailing spaces and cannot be &#39;trimmed&#39;. Instead, you need the additional &#39;clean&#39; function applied as well. See my answer for details."}], "tags": [], "owner": {"reputation": 366, "user_id": 4919511, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/10153644441556549/picture?type=large", "display_name": "Oliver Humphreys", "link": "https://stackoverflow.com/users/4919511/oliver-humphreys"}, "is_accepted": false, "score": 0, "last_activity_date": 1439399584, "creation_date": 1439399584, "answer_id": 31971516, "question_id": 31971074, "link": "https://stackoverflow.com/questions/31971074/vba-delete-rows-based-on-multiple-criteria-code-is-missing-some-of-the-criteri/31971516#31971516", "title": "vba delete rows based on multiple criteria - code is missing some of the criteria", "body": "<p>it may be that the values in Cell are in a different case, or have leading or trailing spaces. (I often find this problem in manually input data)</p>\n\n<p>try using:</p>\n\n<pre><code>If UCase(Trim(Cell.Value)) = \"ADD\" Or UCase(Trim(Cell.Value)) = \"ANFR\" Or ....... Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1439401081, "post_id": 31971746, "comment_id": 51850768, "body": "I agree fully with your comments, but I only add that you can actually work backwards with a For loop, by using the For statement: For x = MAX_VALUE to MIN_VALUE Step - 1 [Step + 1 is assumed; you can also do Step + 2 to only loop every other one, etc.]"}, {"owner": {"reputation": 358, "user_id": 5042442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21c40fa5a3ec804e543cb7d510a3d9?s=128&d=identicon&r=PG", "display_name": "Latch", "link": "https://stackoverflow.com/users/5042442/latch"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439401668, "post_id": 31971746, "comment_id": 51851097, "body": "Oh that&#39;s my bad, my comment on this was not very clear, what I meant is that (as far as I know) you cannot go backward if you use for each cell in range(...), but you can if you iterate over numbers. I will clarify it, thank you!"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439401721, "post_id": 31971746, "comment_id": 51851119, "body": "Ah right, you mean &#39;For Each&#39; cant go backwards. So far as I know, that&#39;s not possible, so I agree with you again."}], "tags": [], "owner": {"reputation": 358, "user_id": 5042442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21c40fa5a3ec804e543cb7d510a3d9?s=128&d=identicon&r=PG", "display_name": "Latch", "link": "https://stackoverflow.com/users/5042442/latch"}, "is_accepted": false, "score": 0, "last_activity_date": 1439401774, "last_edit_date": 1439401774, "creation_date": 1439400469, "answer_id": 31971746, "question_id": 31971074, "link": "https://stackoverflow.com/questions/31971074/vba-delete-rows-based-on-multiple-criteria-code-is-missing-some-of-the-criteri/31971746#31971746", "title": "vba delete rows based on multiple criteria - code is missing some of the criteria", "body": "<p>It could be one of the orther answers, but my guess is that the problem is that when you delete a row, \"cell\" becomes the next one under and you then hit the \"next\" and skip this row completly. \nFor exemple, if you do: </p>\n\n<pre><code>Sub test()\nDim cell\nFor Each cell In Range(\"A1\", \"A10\")\n    cell.EntireRow.Delete\nNext cell\nEnd Sub\n</code></pre>\n\n<p>You will only delete rows 1,3,5,7,9</p>\n\n<p>You should loop in reverse, which as far as i'm aware is not possible with a for each cell in range(...) loop, but can be done by iterating over numbers like so:</p>\n\n<pre><code>for i=cells(rows.count,\"B\").end(xlup).row to 2 step -1\n    If Cells(i,\"B\") = \"ADD\" Or Cells(i,\"B\") = \"ANFR\" Or Cells(i,\"B\") = \"CADV\" Or Cells(i,\"B\") = \"DEF\" Or Cells(i,\"B\") = \"DEFD\" Or Cells(i,\"B\") = \"OIL\" Or Cells(i,\"B\") = \"PROP\" Or Cells(i,\"B\") = \"STAX\" Or Cells(i,\"B\") = \"UREA\" Or Cells(i,\"B\") = \"WWFL\" Or Cells(i,\"B\") = \"NGAS\" Then\n        Cell.EntireRow.Delete\n    End If\nnext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 612, "user_id": 870125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06695080a7e3c8ab55a4c246db6a3aeb?s=128&d=identicon&r=PG", "display_name": "mourad", "link": "https://stackoverflow.com/users/870125/mourad"}, "is_accepted": false, "score": 0, "last_activity_date": 1439404141, "last_edit_date": 1439404141, "creation_date": 1439401672, "answer_id": 31972075, "question_id": 31971074, "link": "https://stackoverflow.com/questions/31971074/vba-delete-rows-based-on-multiple-criteria-code-is-missing-some-of-the-criteri/31972075#31972075", "title": "vba delete rows based on multiple criteria - code is missing some of the criteria", "body": "<p>i like to do :</p>\n\n<pre><code>If Cell LIKE \"*ADD*\" Or Cell LIKE \"*ANFR*\" Or Cell LIKE \"*CADV*\" Or Cell LIKE \"*DEF*\" Or Cell LIKE \"*DEFD*\" Or Cell LIKE \"*OIL*\" Or Cell LIKE \"*PROP*\" Or Cell LIKE \"*STAX*\" Or Cell LIKE \"*UREA*\" Or Cell LIKE \"*WWFL*\" Or Cell LIKE \"*NGAS*\" Then\n    Cell.EntireRow.Delete\nEnd If\n</code></pre>\n\n<p>the star (*) means any letters, numbers, spaces... can be before or after (in my example) your given values.</p>\n\n<ul>\n<li>this is case unsensitive, that's why i like it!</li>\n</ul>\n\n<p>Hope this help.</p>\n"}], "owner": {"reputation": 1, "user_id": 5220290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a40c9eee5d74f860bfaebf6f8e116bd?s=128&d=identicon&r=PG&f=1", "display_name": "Hcbrucey", "link": "https://stackoverflow.com/users/5220290/hcbrucey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1439404141, "creation_date": 1439398087, "last_edit_date": 1439400228, "question_id": 31971074, "link": "https://stackoverflow.com/questions/31971074/vba-delete-rows-based-on-multiple-criteria-code-is-missing-some-of-the-criteri", "title": "vba delete rows based on multiple criteria - code is missing some of the criteria", "body": "<p>I have a vba code that deletes rows based on multiple criteria. It works very well and I like how short and simple the code is. However, I have noticed that it somehow misses some of the cells that contain the criteria. Typically just three or so of the listed criteria I would like deleted. Any clue why this may be happening??</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub DeleteMyRows()\n\nDim Rng As Range, Cell As Range\nSet Rng = Range(Range(\"B2\"), Range(\"B\" &amp; Rows.Count).End(xlUp))\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nFor Each Cell In Rng\n\nIf Cell = \"ADD\" Or Cell = \"ANFR\" Or Cell = \"CADV\" Or Cell = \"DEF\" Or Cell = \"DEFD\" Or Cell = \"OIL\" Or Cell = \"PROP\" Or Cell = \"STAX\" Or Cell = \"UREA\" Or Cell = \"WWFL\" Or Cell = \"NGAS\" Then\n    Cell.EntireRow.Delete\nEnd If\n\nNext Cell\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["regex", "string", "vba", "excel"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439400309, "post_id": 31970873, "comment_id": 51850337, "body": "It sounds like you&#39;re just trying to find text that ends in a newline and then removes the newline."}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439400473, "post_id": 31970873, "comment_id": 51850415, "body": "Almost, because spaces also matter. I have to improve the space the string uses but maintain readability cause it&#39;s a fixed paragraph"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439401230, "post_id": 31970873, "comment_id": 51850862, "body": "What if there&#39;s a dot or comma immediately followed by a newline?"}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439401593, "post_id": 31970873, "comment_id": 51851058, "body": "Thanks for the observation, I haven&#39;t thought about that. It would be the same as 1st case, newline should be replaced with space"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439401674, "post_id": 31970873, "comment_id": 51851098, "body": "See if my answer fits your needs."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1439402192, "post_id": 31970873, "comment_id": 51851404, "body": "What do you mean by <b>character</b>?"}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1439402097, "post_id": 31972072, "comment_id": 51851350, "body": "nit-picking:  <code>\\w</code> also matches the underscore <code>_</code>  e.g: <code>\\w</code> = <code>[A-Za-z0-9_]</code>  (in vbscript)"}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1439402122, "post_id": 31972072, "comment_id": 51851363, "body": "The line <code>strText = re.Replace(strText, &quot;$1 &quot;)</code> is replacing the patterno found directly in the text searched, right? And the <code>$1</code> is the result of the regexp processing?"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1439402268, "post_id": 31972072, "comment_id": 51851453, "body": "@Kronos - The <code>$1</code> represents the first capture group (in this case, the ending character, <code>.</code>, or <code>,</code>). So it replaces the entire pattern found with just the ending character plus a space. Also, as @Ron mentioned, the <code>\\w</code> includes the underscore character. If you don&#39;t want to count that, we&#39;ll need to use <code>[a-zA-Z0-9,.]</code> instead."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1439402402, "post_id": 31972072, "comment_id": 51851534, "body": "What to capture depends on what he meant by <b>character</b> in his original question.  Might be as simple as <code>(.)</code>  ;-)."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1439402442, "post_id": 31972072, "comment_id": 51851555, "body": "@RonRosenfeld - Yep. I made sure to specify <i>alphanumeric</i> in my answer but I forgot about the <code>_</code>."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1439402816, "post_id": 31972072, "comment_id": 51851713, "body": "Also, of possible interest, is that in vbscript, characters that are not in that set are not matched.  So some foreign alphabet characters, and Unicode characters, would be excluded."}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1439402848, "post_id": 31972072, "comment_id": 51851733, "body": "By character I mean any alphanumeric character, underscore included but it&#39;s little chance it have to be considered cause it&#39;s not used."}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1439405984, "post_id": 31972072, "comment_id": 51853463, "body": "That worked! Thanks both. The implementation was easier this way"}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1439407650, "post_id": 31972072, "comment_id": 51854356, "body": "Sure, don&#39;t worry about it. Now I am trying to define my function to be called with a range of cells selected by the user. I tried giving it a range argument and trying to loop with a <code>For Each</code> every row within the column range  but it gives me an error. Do you know how to achieve this? I found this <a href=\"http://stackoverflow.com/questions/18168151/vba-pass-a-group-of-cells-as-range-to-function\">link</a>"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 3, "last_activity_date": 1439401662, "creation_date": 1439401662, "answer_id": 31972072, "question_id": 31970873, "link": "https://stackoverflow.com/questions/31970873/how-to-parse-excels-cell-string-with-regexp-in-vba-macro/31972072#31972072", "title": "How to parse Excel&#39;s cell string with regexp in VBA macro", "body": "<p>This pattern will find any alphanumeric character, <code>.</code>, or <code>,</code> followed by optional whitespace and then a newline and replace it with the matched ending character, followed by one space.</p>\n\n<pre><code>Dim re\nSet re = CreateObject(\"VBScript.RegExp\")\nre.Pattern = \"([\\w.,])\\s*\\n\"\nstrText = re.Replace(strText, \"$1 \")\n</code></pre>\n\n<p>Output from testing. Ignore the brackets. They're just there to show spaces.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[the end.]     = [the end.]\n[the end.\\n]   = [the end. ]\n[the end. \\n]  = [the end. ]\n[the end.  \\n] = [the end. ]\n[the end,]     = [the end,]\n[the end,\\n]   = [the end, ]\n[the end, \\n]  = [the end, ]\n[the end,  \\n] = [the end, ]\n[the end]      = [the end]\n[the end\\n]    = [the end ]\n[the end \\n]   = [the end ]\n[the end  \\n]  = [the end ]\n</code></pre>\n"}], "owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1246, "favorite_count": 0, "accepted_answer_id": 31972072, "answer_count": 1, "score": 1, "last_activity_date": 1439401884, "creation_date": 1439397323, "last_edit_date": 1495541642, "question_id": 31970873, "link": "https://stackoverflow.com/questions/31970873/how-to-parse-excels-cell-string-with-regexp-in-vba-macro", "title": "How to parse Excel&#39;s cell string with regexp in VBA macro", "body": "<p>I'm writing a macro in Excel 2010 in order to remove line breaks in multiple cells of a column.\nActually, I have 5 cases for which I have to search within the cells.\nI enumerate them as follows:</p>\n\n<ol>\n<li>If there's a dot or a comma followed by a blank space and then a newline(\\n), replace it with dot or comma( whatever it had before regexp applied) followed by a blank space</li>\n<li>If there's a character followed by blank space and then newline, replace it with character and blank space</li>\n<li>If there's a character followed by a newline, replace it with character + blank space</li>\n<li>If there's a character followed by two blank spaces and then a newline, replace it with character + blank space</li>\n<li>If there's a dot at the end of the line, leave it like that cause it's a finishing dot.</li>\n</ol>\n\n<p>As you can see, 2 and 3 are really similar, so I think the regexp could be something like <code>[a-zA-Z0-9]\\n</code> but I don't know...first, if it's correct to search for a newline just adding \\n and asecond, how to search for a blank space. After detecting the regexp, what follows I think it could be solved with a single <code>.Replace(Text,\"regexp\",\"regexp \")</code> where the ending blank space is from the form \"char\" + \" \"<br>\nSo basically my question is, what could be the regexp for this patterns? \nIn the 5th case, how can I search for the line terminator so it does not try to search for a newline after the last dot of a parragraph.<br>\nCan I use Chr(10) for newline and Chr(32) for space? <br>\nBtw, I've been following these references:<br>\n<a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use RegExp</a><br>\n<a href=\"https://stackoverflow.com/questions/17993389/vba-split-string-by-spaces\">VBA Split strings</a></p>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5220229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6799de0dabab5fd5fa10a3425440b8?s=128&d=identicon&r=PG&f=1", "display_name": "david_r", "link": "https://stackoverflow.com/users/5220229/david-r"}, "edited": false, "score": 0, "creation_date": 1439403907, "post_id": 31971308, "comment_id": 51852335, "body": "Harvey, Thanks for the response! I can&#39;t figure out exactly how to fit this into what I&#39;m doing though. Which method I would use, syntax, etc."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 1, "user_id": 5220229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6799de0dabab5fd5fa10a3425440b8?s=128&d=identicon&r=PG&f=1", "display_name": "david_r", "link": "https://stackoverflow.com/users/5220229/david-r"}, "edited": false, "score": 0, "creation_date": 1439411392, "post_id": 31971308, "comment_id": 51856235, "body": "In your code replace userforms  with VBA.UserForms and it might work. If not read the page I previously sent you and experiment. Show me what you tried."}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1613021696, "post_id": 31971308, "comment_id": 116948883, "body": "The whole point of SO is for you to explain it HERE"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1439398867, "last_edit_date": 1525816189, "creation_date": 1439398867, "answer_id": 31971308, "question_id": 31970858, "link": "https://stackoverflow.com/questions/31970858/how-to-open-a-userform-using-a-variable-in-the-name/31971308#31971308", "title": "How to open a Userform using a variable in the Name?", "body": "<p>You can use the often overlooked VBA.UserForms object. See <a href=\"http://www.cpearson.com/Excel/showanyform.htm\" rel=\"nofollow noreferrer\">this link</a> which fully descibes what you need to do.</p>\n\n<p>There's no point in my explaining it here.</p>\n\n<p>Harvey</p>\n"}, {"tags": [], "owner": {"reputation": 18, "user_id": 5215393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/232a8bdb78c3d213cd99108bdf8240e5?s=128&d=identicon&r=PG&f=1", "display_name": "PangolinPaws", "link": "https://stackoverflow.com/users/5215393/pangolinpaws"}, "is_accepted": false, "score": 0, "last_activity_date": 1439412544, "creation_date": 1439412544, "answer_id": 31975120, "question_id": 31970858, "link": "https://stackoverflow.com/questions/31970858/how-to-open-a-userform-using-a-variable-in-the-name/31975120#31975120", "title": "How to open a Userform using a variable in the Name?", "body": "<p>I've never come accross the method mentioned by @Harvey (I like it, though) so would have used some sort of Select Case statement:</p>\n\n<pre><code>Select Case .Cells(1,1).Value\n    Case 1:\n        FormOne.Show\n    Case 2:\n        FormTwo.Show\n    ' And so on and do forth...\n    Case Else:\n        MsgBox (\"Invalid entry\")\nEnd Select \n</code></pre>\n\n<p>Simpler than 17 If statements, at least.</p>\n"}, {"tags": [], "owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "is_accepted": false, "score": 2, "last_activity_date": 1458082795, "creation_date": 1458082795, "answer_id": 36023845, "question_id": 31970858, "link": "https://stackoverflow.com/questions/31970858/how-to-open-a-userform-using-a-variable-in-the-name/36023845#36023845", "title": "How to open a Userform using a variable in the Name?", "body": "<p>Paste the code from the link Harvey provided, then adjust this line in your code:</p>\n\n<pre><code>UserForms(\"UserForm\" &amp; i).Show  ****THIS is what doesn't work\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>ShowAnyForm (\"UserForm\" &amp; i)\n</code></pre>\n\n<p>That's a great link Harvey, I've bookmarked it!</p>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 8750114, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qHxrl.png?s=128&g=1", "display_name": "Juan Joya", "link": "https://stackoverflow.com/users/8750114/juan-joya"}, "is_accepted": false, "score": 0, "last_activity_date": 1540825533, "last_edit_date": 1540825533, "creation_date": 1540825380, "answer_id": 53048295, "question_id": 31970858, "link": "https://stackoverflow.com/questions/31970858/how-to-open-a-userform-using-a-variable-in-the-name/53048295#53048295", "title": "How to open a Userform using a variable in the Name?", "body": "<p>The easiest way is this one:</p>\n\n<pre><code>Dim activeuf as Object\nSet activeuf = UserForm &amp; i\nactiveuf.show\n</code></pre>\n\n<p>Perhaps it will not work for the person who asked, but I'm sure it will help people who check this question in the future</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15096819, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a3cc239d1ecf8da11d65aca46f657c82?s=128&d=identicon&r=PG", "display_name": "Haribabu G L", "link": "https://stackoverflow.com/users/15096819/haribabu-g-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1611817951, "last_edit_date": 1611817951, "creation_date": 1611817287, "answer_id": 65932381, "question_id": 31970858, "link": "https://stackoverflow.com/questions/31970858/how-to-open-a-userform-using-a-variable-in-the-name/65932381#65932381", "title": "How to open a Userform using a variable in the Name?", "body": "<p>Get <code>UserForm</code> object defined by its string name</p>\n<pre><code>Function Form(Name As String) As Object\n  Set Form = CallByName(UserForms, &quot;Add&quot;, VbMethod, Name)\nEnd Function\n\nSub Test()\n  Dim strFormName As String\n  strFormName = &quot;UserForm1&quot;  ' &lt;-- replace by your lookup code instead\n  Form(strFormName).Show\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5220229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f6799de0dabab5fd5fa10a3425440b8?s=128&d=identicon&r=PG&f=1", "display_name": "david_r", "link": "https://stackoverflow.com/users/5220229/david-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7609, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1611817951, "creation_date": 1439397278, "last_edit_date": 1543993415, "question_id": 31970858, "link": "https://stackoverflow.com/questions/31970858/how-to-open-a-userform-using-a-variable-in-the-name", "title": "How to open a Userform using a variable in the Name?", "body": "<p>I'm trying to open UserForms based on the values of cells in one row of a sheet. There are 17 UserForms so I don't want to have to use 17 if statements for each form like this:</p>\n\n<pre><code>If ActiveCell.Value = 1 Then\n     UserForm1.Show\nEnd If\n</code></pre>\n\n<p>Is there a way that I can use a variable to show the forms?</p>\n\n<p>I was thinking something along the lines of:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim i\nDo\n   If ActiveCell.Value = \"\" Then\n      Exit DO\n   End If\n   i = ActiveCell.Value\n   UserForms(\"UserForm\" &amp; i).Show   ****THIS is what doesn't work\n   ActiveCell.Offset(0,1).Select\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel", "ldap", "ado", "ldap-query"], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 1, "last_activity_date": 1439398447, "creation_date": 1439398447, "answer_id": 31971187, "question_id": 31970597, "link": "https://stackoverflow.com/questions/31970597/read-ldap-description-using-ado/31971187#31971187", "title": "Read LDAP Description using ADO", "body": "<p>Please see teh text below which will sort you out.\nthis was copied from <a href=\"http://www.rlmueller.net/ADOSearchTips.htm\" rel=\"nofollow\">here</a></p>\n\n<p>It should be pointed out that the \"description\" attribute of user objects is actually multi-valued. However, it can only have one value. It is treated as a normal string by ADSI, but not by ADO. ADO returns either a Null (if the \"description\" attribute has no value) or an array of one string value. You must use code similar to BELOW for this attribute.</p>\n\n<p>Most Active Directory attributes have string values, so you can echo the values directly, or assign the values to variables. Some Active Directory attributes are not single-valued strings. Multi-valued attributes are returned by ADO as arrays. Examples include the attributes memberOf, directReports, otherHomePhone, and objectClass. In these cases, the Value property of the Fields collection will be Null if there are no values in the multi-valued attribute, and will be an array if there is one or more values. For example, if the list of attributes includes the sAMAccountName and memberOf attributes, you could enumerate the Recordset object with a loop similar to:</p>\n\n<pre><code>Do Until adoRecordset.EOF\n    strName = adoRecordset.Fields(\"sAMAccountName\").Value\n    Wscript.Echo \"User: \" &amp; strName\n    arrGroups = adoRecordset.Fields(\"memberOf\").Value\n    If IsNull(arrGroups) Then\n        Wscript.Echo \"-- No group memberships\"\n    Else\n        For Each strGroup In arrGroups\n            Wscript.Echo \"-- Member of group: \" &amp; strGroup\n        Next\n    End If\n    adoRecordset.MoveNext\nLoop\n</code></pre>\n"}], "owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1750, "favorite_count": 0, "accepted_answer_id": 31971187, "answer_count": 1, "score": 0, "last_activity_date": 1439411341, "creation_date": 1439396473, "last_edit_date": 1439411341, "question_id": 31970597, "link": "https://stackoverflow.com/questions/31970597/read-ldap-description-using-ado", "title": "Read LDAP Description using ADO", "body": "<p>I'm trying the LDAP query below. The \"Description\" field is usually Null but if data is present I get a Type Mismatch error on RS.Fields(vFields(iCol)).Value  for the description column. The ADO datatype is reported as 12 - Variant. I tried to assign the value to a VBA Variant but it didn't work.</p>\n\n<p>Please excuse the extraneous lines for writing to a file. Needs reference to Microsoft ADO 6 if you try to reproduce. Also change to your OU </p>\n\n<p>How do I work with ADP Data Type 12 in VBA? Can I modify the SELECT statement to covert Description too another data type?</p>\n\n<pre><code>        Option Explicit\n\n        Sub GatherAttrs()\n        On Error GoTo Local_error\n            Dim objShell\n            Dim objFSO\n            Dim strOutputFileName, objOutputFileName, s, s2\n            Dim RS As ADODB.Recordset\n            Dim objConnection As ADODB.Connection\n            Dim objCommand As ADODB.Command\n            Const ForReading = 1, ForWriting = 2, ForAppending = 8\n            Dim i As Integer\n            Dim iRow As Integer\n            Dim iCol As Integer\n            Dim wks As Worksheet\n            Dim sFields As String\n            Dim vFields() As String\n            Dim v As Variant\n\n            Set wks = Worksheets.Add()\n\n        '    Set objShell = WScript.CreateObject(\"WScript.Shell\")\n        '    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n        '    strOutputFileName = InputBox(\"Out filename:\", , \"UserList2.txt\")\n        '    Set objOutputFileName = objFSO.OpenTextFile(strOutputFileName, ForWriting, True)\n            Const ADS_SCOPE_SUBTREE = 2\n\n            Set objConnection = CreateObject(\"ADODB.Connection\")\n            Set objCommand = CreateObject(\"ADODB.Command\")\n            objConnection.Provider = \"ADsDSOObject\"\n            objConnection.Open \"Active Directory Provider\"\n            Set objCommand.ActiveConnection = objConnection\n\n\n            ' ** ** top 1000\n            objCommand.Properties(\"Page Size\") = 1000\n            objCommand.Properties(\"Searchscope\") = ADS_SCOPE_SUBTREE\n\n\n            sFields = \"givenName,initials,sn,displayName,userPrincipalName,sAMAccountName,description,physicalDeliveryOfficeName,telephoneNumber,mail,pager,mobile,facsimileTelephoneNumber,employeeID,employeeNumber,departmentNumber,title,department,company,manager\"\n            vFields = Split(sFields, \",\")\n\n            s = \"SELECT \"\n            s = s &amp; sFields\n            ' ** ** modify OU for your scope ** **\n            s = s &amp; \" FROM 'LDAP://ou=APCD,dc=wings,dc=co,dc=slo,dc=ca,dc=us' \"\n            s = s &amp; \" WHERE objectCategory='user' order by Name\"\n            objCommand.CommandText = s\n\n            Set RS = objCommand.Execute\n\n            If RS.EOF Then\n                MsgBox \"ADS search failed - check OU\" &amp; vbNewLine &amp; objCommand.CommandText\n                GoTo Local_Exit\n            End If\n            iRow = 1\n            For iCol = 1 To UBound(vFields)\n                wks.Cells(iRow, iCol) = vFields(iCol)\n            Next iCol\n\n            RS.MoveFirst\n            Do Until RS.EOF\n                iRow = iRow + 1\n                For iCol = 1 To UBound(vFields)\n                    v = RS.Fields(vFields(iCol)).Value\n                    wks.Cells(iRow, iCol) = RS.Fields(vFields(iCol)).Value &amp; \"\"\n                Next iCol\n                RS.MoveNext\n            Loop\n        '    objOutputFileName.Writeline (s)\n        '    objOutputFileName.Close\n            'Wscript.Echo s\n            wks.Activate\n        Local_Exit:\n            Exit Sub\n        Local_error:\n            MsgBox Err &amp; \" \" &amp; Err.Description\n            If Err.Number = 13 Then Resume Next\n            Resume Local_Exit\n            Resume\n            Resume Next\n        End Sub\n</code></pre>\n\n<hr>\n\n<p>Final code after suggested answer.</p>\n\n<pre><code>RS.MoveFirst\nDo Until RS.EOF\n    iRow = iRow + 1\n    For iCol = 1 To UBound(vFields)\n        If RS.Fields(vFields(iCol)).Type = 12 Then\n             If Not IsNull(RS.Fields(vFields(iCol))) Then\n                vData = RS.Fields(vFields(iCol)) ' vData is declared as a Variant\n                wks.Cells(iRow, iCol) = vData(0) &amp; \"\" ' only captures first array element\n             End If\n        Else\n            wks.Cells(iRow, iCol) = RS.Fields(vFields(iCol)).Value &amp; \"\"\n        End If\n    Next iCol\n    RS.MoveNext\nLoop\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1439402764, "post_id": 31970589, "comment_id": 51851694, "body": "Perhaps perform a loop as you suggest over each character, but do an extra loop at the beginning, just looking to see which characters are listed as <b>BOLD</b> and store that TRUE / FALSE declaration in an array variable. Then perform your letter changes, and then do your loop over only the letters which WERE bold, and make them bold again. This will prevent you from bolding something which can&#39;t  be bolded."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 3, "creation_date": 1439403461, "post_id": 31970589, "comment_id": 51852069, "body": "You can use the <code>Range.Characters(intStart, intLen).Text = strNewText</code> to replace text while still maintaining the formatting but you have to be mindful of your positioning as you replace your text with <i>more</i> characters than you started with."}, {"owner": {"reputation": 2653, "user_id": 1068470, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b479cae944c0938546a8af85141e401a?s=128&d=identicon&r=PG&f=1", "display_name": "ThePerson", "link": "https://stackoverflow.com/users/1068470/theperson"}, "edited": false, "score": 1, "creation_date": 1439500912, "post_id": 31970589, "comment_id": 51900839, "body": "Thanks for the input! Grade bacon&#39;s answer is good but unfortunately only works for bold, maybe my question should have been clearer that all formatting is needed. Bonds answer did the trick.. any chance of adding it as an answer so it can be accepted?  Thanks."}], "owner": {"reputation": 2653, "user_id": 1068470, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b479cae944c0938546a8af85141e401a?s=128&d=identicon&r=PG&f=1", "display_name": "ThePerson", "link": "https://stackoverflow.com/users/1068470/theperson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1693, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439397508, "creation_date": 1439396447, "last_edit_date": 1439397508, "question_id": 31970589, "link": "https://stackoverflow.com/questions/31970589/vba-replace-selection-text-but-keep-formatting", "title": "VBA replace selection.text but keep formatting", "body": "<p><strong>Problem Description</strong></p>\n\n<p>I am trying to alter some text in a word document without losing the formatting. The alterations will not modify the length of the text. </p>\n\n<p><strong>Example</strong></p>\n\n<p>I start with the text selected: </p>\n\n<p>Hello <strong>there</strong> this is some text <strong>with</strong> bits in bold</p>\n\n<p>I would like to change the characters, but keep the text. Lets say I add one to each character and we get:</p>\n\n<p>Ifmmp uifsf uijt jt tpnf ufyu xjui cjut jo cpme</p>\n\n<p>I can then use:</p>\n\n<p>Selection.text = \"Ifmmp uifsf uijt jt tpnf ufyu xjui cjut jo cpme\"</p>\n\n<p>(Of course instead of hard coding, that string would be returned from a method which takes in the text).</p>\n\n<p>I then get the text updated, but it has lost all formatting. Ideally, my aim is to end with:</p>\n\n<p>Ifmmp <strong>uifsf</strong> uijt jt tpnf ufyu <strong>xjui</strong> cjut jo cpme</p>\n\n<p><strong>What I can think of, but isn't very good</strong></p>\n\n<p>I can think of one solution but it seems rather hacky and like it may break. My solution is to loop through the selected region, select one character at a time and use Selection.TypeText to override it. Hopefully if i'm lucky it wont break because of new line characters or if there are images/tables in the way.</p>\n\n<p><strong>Q</strong>\nIs there no more sensible way to change the text of a selection <strong>without</strong> changing the formatting of it?</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1, "user_id": 4616017, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101503642879574/picture?type=large", "display_name": "Henry ", "link": "https://stackoverflow.com/users/4616017/henry"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1439484128, "post_id": 31970484, "comment_id": 51892068, "body": "I would say that they would look up whether the previous record has the same ID as the new record (IE: NYC, 2013, 95%) So I would like the new record to show (NYC, 2014, 95%) with the 95% being pulled from the previous entry in a different field of course."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4616017, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101503642879574/picture?type=large", "display_name": "Henry ", "link": "https://stackoverflow.com/users/4616017/henry"}, "edited": false, "score": 0, "creation_date": 1439405428, "post_id": 31971450, "comment_id": 51853159, "body": "Harvey, can you provide me with a sample of how to do this? I am not too familiar with coding VBA."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 1, "user_id": 4616017, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101503642879574/picture?type=large", "display_name": "Henry ", "link": "https://stackoverflow.com/users/4616017/henry"}, "edited": false, "score": 0, "creation_date": 1439411244, "post_id": 31971450, "comment_id": 51856152, "body": "No sorry.  Do some googling and buy an excel programming vba book"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1439399382, "creation_date": 1439399382, "answer_id": 31971450, "question_id": 31970484, "link": "https://stackoverflow.com/questions/31970484/access-2010-how-to-pre-fill-new-record-with-information-from-previous-record/31971450#31971450", "title": "Access 2010: How to Pre-fill new record with information from previous record", "body": "<p>Write a function in a module that will use the access DLookup  function. Dlookup will let you get a single value from a single field of a table given certain criteria (ie get me last years row, and get the final percentage field .)</p>\n\n<p>When you start a new record in a form, call this function to get the value you need, passing it criteria from the current record.</p>\n\n<p>I think you will need to use the AfterUpdate event of the control that contains the criteria (ie the current year) to update the last year's value control.  This controls event VBA will use the function you wrote.</p>\n\n<p>Harvey</p>\n\n<p>Harvey</p>\n"}], "owner": {"reputation": 1, "user_id": 4616017, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101503642879574/picture?type=large", "display_name": "Henry ", "link": "https://stackoverflow.com/users/4616017/henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594643801, "creation_date": 1439396121, "last_edit_date": 1594643801, "question_id": 31970484, "link": "https://stackoverflow.com/questions/31970484/access-2010-how-to-pre-fill-new-record-with-information-from-previous-record", "title": "Access 2010: How to Pre-fill new record with information from previous record", "body": "<p>I would like to know how to Pre-fill a field in a new record with a field from it's previous record. To be specific I will provide an example.</p>\n\n<p>The first record is the year 2013 with a \"Final Percentage\" of 95%.\nThe second record would be the year 2014 and it will have a Field that says \"Last Year's Final Percentage.\" How do I get this field to populate the 95% from the previous record?</p>\n"}, {"tags": ["vba", "excel", "save-as"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1439394380, "post_id": 31969865, "comment_id": 51846821, "body": "Will that automatically say yes for both saves?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1439395194, "post_id": 31969865, "comment_id": 51847380, "body": "It should do providing you put it before the first save.  I&#39;m looking at @MatthewD answer - I&#39;ve never seen that method so it may work better."}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1439395396, "post_id": 31969865, "comment_id": 51847513, "body": "Worked! I knew it was something simple. Thanks"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1439394199, "creation_date": 1439394199, "answer_id": 31969865, "question_id": 31969747, "link": "https://stackoverflow.com/questions/31969747/force-yes-for-save-over-and-save-as-macro-free-workbook/31969865#31969865", "title": "Force yes for save over and save as macro free workbook", "body": "<p>Add <code>Application.DisplayAlerts = False</code> before you try and save.  Remember to turn in back to True after you've saved.</p>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 3299327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e9ba1a4d3468aac8624f8a22e618d9?s=128&d=identicon&r=PG&f=1", "display_name": "xiaomy", "link": "https://stackoverflow.com/users/3299327/xiaomy"}, "edited": false, "score": 0, "creation_date": 1511890979, "post_id": 31970034, "comment_id": 82032444, "body": "This is incorrect. <code>ConflictReslution</code> deals with conflicts over shared workbooks, not the overwrite prompts, as is stated in the linked answers."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1439394651, "last_edit_date": 1495535308, "creation_date": 1439394651, "answer_id": 31970034, "question_id": 31969747, "link": "https://stackoverflow.com/questions/31969747/force-yes-for-save-over-and-save-as-macro-free-workbook/31970034#31970034", "title": "Force yes for save over and save as macro free workbook", "body": "<p>ConflictResolution should be xlLocalSessionChanges to not see the prompt</p>\n\n<pre><code>ConflictResolution:=Excel.XlSaveConflictResolution.xlLocalSessionChanges \n</code></pre>\n\n<p>from </p>\n\n<p><a href=\"https://stackoverflow.com/questions/14634453/how-to-use-workbook-saveas-with-automatic-overwrite\">How to use workbook.saveas with automatic Overwrite</a></p>\n"}], "owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8963, "favorite_count": 0, "accepted_answer_id": 31969865, "answer_count": 2, "score": 1, "last_activity_date": 1439395526, "creation_date": 1439393786, "last_edit_date": 1439395526, "question_id": 31969747, "link": "https://stackoverflow.com/questions/31969747/force-yes-for-save-over-and-save-as-macro-free-workbook", "title": "Force yes for save over and save as macro free workbook", "body": "<p>The macro I made saves a template workbook as two separate files. One is saved per test (Location1,2,3, or 4) then is used in another macro to use the data from each test. The Second is a raw data file kept for back up. Now the issue is every time I run the test per location and run this macro it ask me if I want to save over the previous test. How can I tell it to say yes with out asking. Same for the do i want to save this workbook as a macro free workbook. What do i have to put in my code and where should i put it? Any helps is much appreciated. \nThanks</p>\n\n<p>Solved Code:</p>\n\n<pre><code>Sub Auto_Open()\n\n   With Range(\"A30\")\n   .Value = Time\n   .NumberFormat = \"h-mm-ss AM/PM\"\n   End With\n\n    Dim FileName    As String\n    Dim FilePath    As String\n    Dim FileDate    As String\n\n    MyNote = \"Is Cell 'B27' Overview Information\" &amp; SavePath &amp; \" Location1,2,3,or 4?\"\n\n    Answer = MsgBox(MyNote, vbQuestion + vbYesNo)\n\n    If Answer = vbYes Then\n\n        FilePath = \"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\"\n        FileName = Sheets(\"Data\").Range(\"B27\").Text\n\n        Application.DisplayAlerts = False\n\n        ThisWorkbook.SaveAs FileName:=FilePath &amp; \"\\\" &amp; FileName\n\n        Dim FileCopyName    As String\n        Dim FileCopyPath    As String\n        Dim FileTime        As String\n\n        FilePath = \"C:\\Users\\aholiday\\Desktop\\Backup\"\n        FileName = Sheets(\"Data\").Range(\"B27\").Text\n        FileTime = Sheets(\"Data\").Range(\"A30\").Text\n\n\n        ThisWorkbook.SaveAs FileName:=FilePath &amp; \"\\\" &amp; FileName &amp; FileTime &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook\n\n        MsgBox \"File was saved!\"\n        MsgBox \"Ready for Next Test, Please Exit.\"\n\n        Application.DisplayAlerts = True\n\n    Else\n       MsgBox \"File was not saved, Please Use Location_1,2,3or,4 Durring SIG ATM Test\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": false, "score": 0, "last_activity_date": 1446825693, "creation_date": 1446825693, "answer_id": 33570799, "question_id": 31969704, "link": "https://stackoverflow.com/questions/31969704/vba-excel-transfer-individual-sheet-to-access/33570799#33570799", "title": "VBA Excel: Transfer individual sheet to Access", "body": "<p>Use ADO to connect to Access and then INSERT the records into a table</p>\n"}], "owner": {"reputation": 49, "user_id": 5174339, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5354b9ba58c097e5b27c769d2a21930a?s=128&d=identicon&r=PG&f=1", "display_name": "bmyers", "link": "https://stackoverflow.com/users/5174339/bmyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446825693, "creation_date": 1439393671, "question_id": 31969704, "link": "https://stackoverflow.com/questions/31969704/vba-excel-transfer-individual-sheet-to-access", "title": "VBA Excel: Transfer individual sheet to Access", "body": "<p>I'm attempting to transfer an individual sheet (only 2 columns) in my Excel workbook to Access through VBA.  I would much prefer for the code to be written in Excel rather than Access, but the other way would work too.  Is there anyway to do this?</p>\n\n<p>I have been searching for a way to do this but have yet to find anything beneficial.  I have a very limited amount of knowledge on this subject and lack other resources so any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel", "collections"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1439396611, "post_id": 31969692, "comment_id": 51848238, "body": "change <code>For loopCounter = 2 To endRow</code> to <code>For loopCounter = 2 To 16</code>"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1439397182, "post_id": 31969692, "comment_id": 51848558, "body": "Or just keep a count of how many items you add to the collection, then exit the loop when it&#39;s 15."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5219955, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/686d44294a507c09c4234a743342906f?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5219955/tim"}, "edited": false, "score": 0, "creation_date": 1439407438, "post_id": 31973072, "comment_id": 51854250, "body": "It worked perfectly and I can&#39;t believe it was just a one liner. Thanks!"}, {"owner": {"reputation": 961, "user_id": 2697139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c2437120b3292f1340ad0100ac12d4?s=128&d=identicon&r=PG&f=1", "display_name": "AlexT82", "link": "https://stackoverflow.com/users/2697139/alext82"}, "reply_to_user": {"reputation": 25, "user_id": 5219955, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/686d44294a507c09c4234a743342906f?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5219955/tim"}, "edited": false, "score": 0, "creation_date": 1439408270, "post_id": 31973072, "comment_id": 51854663, "body": "it&#39;s a pleasure Tim! (p.s. don&#39;t forget the upvote :))"}], "tags": [], "owner": {"reputation": 961, "user_id": 2697139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c2437120b3292f1340ad0100ac12d4?s=128&d=identicon&r=PG&f=1", "display_name": "AlexT82", "link": "https://stackoverflow.com/users/2697139/alext82"}, "is_accepted": true, "score": 0, "last_activity_date": 1439405108, "creation_date": 1439405108, "answer_id": 31973072, "question_id": 31969692, "link": "https://stackoverflow.com/questions/31969692/excel-vba-add-a-set-number-of-items-to-a-collection/31973072#31973072", "title": "excel vba add a set number of items to a collection", "body": "<p>Sure thing, just check on the collection.Count > 14 then exit for</p>\n\n<pre><code>For loopCounter = 2 To endRow\nDim item As Variant\nDim lineArray()\nDim myString As String\n\nmyString = Cells(loopCounter, 3).Value\n\nReDim lineArray(1 To endColumn)\n\nIf Not (Left(myString, 1) = \"P\" Or Left(myString, 1) = \"I\" Or myString = \"RESW\" Or myString = \"REPC\") Then\n     For x = 1 To endColumn\n          lineArray(x) = dataArray(loopCounter, x)\n     Next x\n\n     itemCollection.Add lineArray\n     if itemCollection.Count = 15 then exit for\nEnd If\nNext loopCounter\n</code></pre>\n\n<p>if it would have been an array, then use if UBOUND(array) = 14 then exit for</p>\n"}], "owner": {"reputation": 25, "user_id": 5219955, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/686d44294a507c09c4234a743342906f?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5219955/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 844, "favorite_count": 0, "accepted_answer_id": 31973072, "answer_count": 1, "score": 0, "last_activity_date": 1439405108, "creation_date": 1439393646, "last_edit_date": 1439396806, "question_id": 31969692, "link": "https://stackoverflow.com/questions/31969692/excel-vba-add-a-set-number-of-items-to-a-collection", "title": "excel vba add a set number of items to a collection", "body": "<p>I have the following set of code:</p>\n\n<pre><code>For loopCounter = 2 To endRow\nDim item As Variant\nDim lineArray()\nDim myString As String\n\nmyString = Cells(loopCounter, 3).Value\n\nReDim lineArray(1 To endColumn)\n\nIf Not (Left(myString, 1) = \"P\" Or Left(myString, 1) = \"I\" Or myString = \"RESW\" Or myString = \"REPC\") Then\n     For x = 1 To endColumn\n          lineArray(x) = dataArray(loopCounter, x)\n     Next x\n\n     itemCollection.Add lineArray\nEnd If\nNext loopCounter\n</code></pre>\n\n<p>For the purpose of keeping this question short and to the point, I have a bunch of excel worksheets that contains hundreds of rows of data. To make a long story short, the code above add items from the worksheet to the collection, but it's adding every row (minus the conditions I set - if statement). However, I only want to add a fix amount of items to the collection, 15. I can't seem to figure it out and haven't found any help online.</p>\n\n<p>My question for help is, does anyone know how I can make it that once 15 items are added to the collection it will exit out of the loop and finish the rest of the subroutine? </p>\n\n<p>I purposely didn't add the whole code because it's quite lengthy and not necessary.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1440390086, "post_id": 31969622, "comment_id": 52234938, "body": "Please add some example data with your expected result ;)."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1439393849, "creation_date": 1439393849, "answer_id": 31969769, "question_id": 31969622, "link": "https://stackoverflow.com/questions/31969622/excel-using-vlookup-to-return-value-between-2-columns/31969769#31969769", "title": "Excel: Using vlookup to return value between 2 columns", "body": "<p>You could add two Vlookups together, <code>=VLOOKUP(D1,$A$1:$C$10000,2,FALSE)&amp;\", \"&amp;VLOOKUP(D1,$A$1:$C$10000,3,FALSE)</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 2737536, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000787474886/picture?type=large", "display_name": "TVT", "link": "https://stackoverflow.com/users/2737536/tvt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440390012, "creation_date": 1439393485, "last_edit_date": 1440390012, "question_id": 31969622, "link": "https://stackoverflow.com/questions/31969622/excel-using-vlookup-to-return-value-between-2-columns", "title": "Excel: Using vlookup to return value between 2 columns", "body": "<p>I have an Excel sheet that looks like this:</p>\n\n<pre><code>+----+---------------+-----------------+----+--------+\n| A  |       B       |        C        | D  |   E    |\n+----+---------------+-----------------+----+--------+\n| ID | Primary Email | Secondary Email | ID | Emails |\n| -  | -             | -               | -  | -      |\n| -  | -             | -               | -  | -      |\n+----+---------------+-----------------+----+--------+\n</code></pre>\n\n<p>I need a formula/macro that compares the E column (emails) with column B and C and return them in column F.</p>\n\n<p>I'm trying to use <code>VLOOKUP</code> but it can only takes 1 index. Is there an alternative? </p>\n\n<pre><code>=VLOOKUP(D1,$A$1:$C$10000,3,FALSE)\n</code></pre>\n\n<p>This formula only returns from column C but I need it to return from both</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 0, "creation_date": 1439415701, "post_id": 31974607, "comment_id": 51858427, "body": "Thank you for looking at this Paul. The first half is a command button that allows me to create a copy of my New_Part tab when selected, thus generating the New_Part (2). I have a tab named &quot;Master&quot; that is already created. The issue I am running into is when I run the VBA to create a new New_Part (2) or New_Part(3), etc. I want it to paste the C2:C3 from the newly created sheet into the next empty column of &quot;Master&quot;."}, {"owner": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 0, "creation_date": 1439475325, "post_id": 31974607, "comment_id": 51885724, "body": "Thanks for the update Paul. The script is running into an issue with how it is calling the cells. Is there a way to have that script read only the values in the cell instead of the formulas? Also can it read the page of source?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 0, "creation_date": 1439475905, "post_id": 31974607, "comment_id": 51886191, "body": "To copy just the values replace the last line <code>ws2.Range(&quot;C2:C3&quot;).Copy Destination:=wsM.Cells(lr, 1)</code> with <code>wsM.Range(wsM.Cells(lr, 1), wsM.Cells(lr + 1, 1)).Value2 = ws2.Range(&quot;C2:C3&quot;).Value2</code>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 0, "creation_date": 1439476039, "post_id": 31974607, "comment_id": 51886301, "body": "Not sure what you mean by &quot;can it read the page of source?&quot;. Can you reformulate the question?"}, {"owner": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 0, "creation_date": 1439479459, "post_id": 31974607, "comment_id": 51889111, "body": "When trying to copy the contents of C2 and C3, how can it read just the values and not the formulas? I tried to run your last change and it runs but nothing is pasting into the &quot;Master&quot; sheet. Thanks again for all of your help Paul."}, {"owner": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 0, "creation_date": 1439480634, "post_id": 31974607, "comment_id": 51889962, "body": "Hm...I am still trying to change this even after the last edit and the script is running but nothing is pasting in the &quot;Master&quot; sheet. I ran it 10-15 times for both the original sheet as well as for the copy and still nothing :(..."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 0, "creation_date": 1439480807, "post_id": 31974607, "comment_id": 51890062, "body": "can you send me your test file at dexxus at rogers.com"}, {"owner": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 0, "creation_date": 1439829025, "post_id": 31974607, "comment_id": 52009558, "body": "Hey Paul. I was able to fix the script, but I have now run into another issue where it is copying the hidden sheets. It is also now pasting into the next available row as opposed to column. I have tried to shift it to columns but I am running into an issue. Any ideas? Thanks for everything thus far."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 1, "creation_date": 1439830103, "post_id": 31974607, "comment_id": 52010181, "body": "Hi @DanteSmith: your question is becoming too dynamic (you&#39;re not supposed to change the initial requirements as you build your code). You should accept the answer if it solved the initial problem, and if you have new issues open a new question (divide and conquer mothod)"}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 2, "creation_date": 1439831458, "post_id": 31974607, "comment_id": 52010877, "body": "OP: see <a href=\"http://meta.opensource.stackexchange.com/questions/403/how-to-discourage-chameleon-questions\">here</a> and <a href=\"http://meta.stackexchange.com/questions/43478/exit-strategies-for-chameleon-questions\">here</a> regarding chameleon questions."}, {"owner": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "edited": false, "score": 0, "creation_date": 1439833994, "post_id": 31974607, "comment_id": 52012230, "body": "I actually salved the issue outside of this solution but I will accept it to satisfy your and CBRF23s response to &quot;chameleon&quot; questions. It wasn&#39;t a different question but more of a difference in how it was formatted but thank you for your time."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1439835179, "post_id": 31974607, "comment_id": 52012873, "body": "You should post your own answer that solved your problem, and accept it, such that if someone else that has a similar issue, your answer will help solve their problem as well (you don&#39;t have to accept my answer if it didn&#39;t provide a reasonable solution). The point is to accept the most generic and helpful solution to a specific issue (without too many adjustments)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1439480157, "last_edit_date": 1439480157, "creation_date": 1439410714, "answer_id": 31974607, "question_id": 31969404, "link": "https://stackoverflow.com/questions/31969404/when-creating-new-workbook-paste-select-cells-into-columns/31974607#31974607", "title": "When Creating New Workbook, Paste Select Cells into Columns", "body": "<p>Tested:</p>\n\n<pre><code>Option Explicit\n\nSub CommandButton()\n\n    Dim ws1 As Worksheet, ws2 As Worksheet, wsM As Worksheet, lr As Long\n\n    Set wsM = Worksheets(\"Master\")\n    Set ws1 = Worksheets(\"New_Part\")\n    ws1.Copy After:=Worksheets(ws1.Index)\n    Set ws2 = Worksheets(ws1.Index + 1)\n\n    lr = wsM.Cells(wsM.Rows.Count, 1).End(xlUp).Row + 1\n\n    wsM.Range(wsM.Cells(lr, 1), wsM.Cells(lr + 1, 1)).Value2 = ws2.Range(\"C2:C3\").Value2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 471, "user_id": 5219965, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d113c56e8f08b439cec3fef619f05b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Dante Smith", "link": "https://stackoverflow.com/users/5219965/dante-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440350530, "creation_date": 1439392912, "last_edit_date": 1440350530, "question_id": 31969404, "link": "https://stackoverflow.com/questions/31969404/when-creating-new-workbook-paste-select-cells-into-columns", "title": "When Creating New Workbook, Paste Select Cells into Columns", "body": "<p>This script copies all cells from C2:C3 for all sheets in the workbook. I would like for it to ignore all hidden sheets. Also the current script is pasting into the next available row when I am trying to paste into the next available column.</p>\n\n<pre><code>Option Explicit\nSub Sample()\nDim wsInput As Worksheet, wsOutput As Worksheet\nDim rng As Range\nDim LRowO As Long, LRowI As Long\n\n'Set the output sheet\nSet wsOutput = ThisWorkbook.Sheets(\"Master\")\n\nFor Each wsInput In ThisWorkbook.Worksheets\n    If wsInput.Name &lt;&gt; wsOutput.Name Then\n        With wsInput      \n            Set rng = .Range(\"C2:C3\")\n            rng.Copy\n            With wsOutput             \n                LRowO = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row + 1\n                .Range(\"A\" &amp; LRowO).PasteSpecial xlPasteValues, _\n                Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            End With\n        End With\n    End If\nNext wsInput\n\nExit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "datetime"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1439392813, "post_id": 31969268, "comment_id": 51845667, "body": "Is there a reason you want to do this in VBA instead of just typing the formula into a cell and dragging down the formula?  I am confused because the first paragraph says you want to apply this to dates in a column, yet the second says the dates are stored in an array.  Is there pre-existing VBA code that you are using?"}, {"owner": {"reputation": 93, "user_id": 5078984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a717d53f6503bde25fc38f92e9390428?s=128&d=identicon&r=PG&f=1", "display_name": "absundo", "link": "https://stackoverflow.com/users/5078984/absundo"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1439392985, "post_id": 31969268, "comment_id": 51845792, "body": "yes there is a pre-exiting VBA code I am using. Otherwise I would simply just use the formulas, but I cannot modify the original database."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 5078984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a717d53f6503bde25fc38f92e9390428?s=128&d=identicon&r=PG&f=1", "display_name": "absundo", "link": "https://stackoverflow.com/users/5078984/absundo"}, "edited": false, "score": 0, "creation_date": 1439396446, "post_id": 31970458, "comment_id": 51848135, "body": "How would I hide the time or make it zero?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 93, "user_id": 5078984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a717d53f6503bde25fc38f92e9390428?s=128&d=identicon&r=PG&f=1", "display_name": "absundo", "link": "https://stackoverflow.com/users/5078984/absundo"}, "edited": false, "score": 1, "creation_date": 1439397890, "post_id": 31970458, "comment_id": 51848974, "body": "@absundo: change the format of the cell using <code>.NumberFormat</code>. If you don&#39;t know which format you want, then just right-click on a cell, format it to Date, click OK and then go into VBA and write into the direct window: <code>? Selection.NumberFormat</code>That&#39;s the format you want to apply."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 3, "last_activity_date": 1439398347, "last_edit_date": 1439398347, "creation_date": 1439396027, "answer_id": 31970458, "question_id": 31969268, "link": "https://stackoverflow.com/questions/31969268/removing-time-from-date-for-an-entire-data-stored-in-an-array/31970458#31970458", "title": "Removing time from date for an entire data stored in an array", "body": "<p>All dates in Excel include time: datetime. It is not possible to store a date only or a time only in a cell. The reason is that Excel stores them as numbers. Anything before the decimal point is the date and anything after the decimal point is the time. So, even if you put the number 42000 in a cell (without anything after the decimal point) and change the format of that cell to date, the value will still be December 27, 2014 (42000 days after December 31, 1899) with an assumed time of zero = 00:00:00 in the morning.</p>\n\n<p>Since all numbers can potentially have something after the decimal point, all dates have time in Excel and all times have dates.</p>\n\n<p>The only thing you can do is: format a cell to show only the date part or the time part or both. So, all you need to do is to hide the time.</p>\n\n<p>If you want to change all dates to have zero after the decimal point then you'll have to loop through the numbers and change all values to INT values.</p>\n\n<pre><code>For intColumn = 1 to 1000\n   If Sheet1.Cells(1, intColumn).Value2 = vbNullString then Exit For\n   Sheet1.Cells(1, intColumn).Value2 = Int(Sheet1.Cells(1, intColumn).Value2) ' Do not use CInt but Int only!\nnext intColumn\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1550604823, "post_id": 31970717, "comment_id": 96327323, "body": "(Late) side note :-) Consider that  the <code>CLng</code> function <b>rounds up</b> to next day <i>all</i> afternoon hours after midday which possibly  returns unwanted results.  So it&#39;s perfectly okay to use  <i>VBA</i>&#39;s <code>Int</code>  or <code>Fix</code> function in  code lines: <code>DateOnly = CDate(Int(DateTime))</code> @xidgel"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 10, "last_activity_date": 1550607725, "last_edit_date": 1550607725, "creation_date": 1439396788, "answer_id": 31970717, "question_id": 31969268, "link": "https://stackoverflow.com/questions/31969268/removing-time-from-date-for-an-entire-data-stored-in-an-array/31970717#31970717", "title": "Removing time from date for an entire data stored in an array", "body": "<p>If you want to change the display format of your data while preserving the time information, you can use something like NumberFormat = \"mm/dd/yyyy\" in cells of a worksheet or chart axis.</p>\n\n<p>Excel stores date/time info as a floating point number. The days are to the left of the decimal and fractions of days (hh:mm:ss) are to the right. If you want to strip out the time information from the underlying data, then convert to Long then back to Date. In VBA (thanks to T.M. for the correction):</p>\n\n<pre><code>DateOnly = CDate(Int(DateTime))\n</code></pre>\n\n<p>In worksheet formulas just convert to Int and format as you please</p>\n\n<pre><code>DateOnly = INT(DateTime)\n</code></pre>\n\n<p>Hope that helps</p>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1550609614, "last_edit_date": 1550609614, "creation_date": 1550608827, "answer_id": 54774569, "question_id": 31969268, "link": "https://stackoverflow.com/questions/31969268/removing-time-from-date-for-an-entire-data-stored-in-an-array/54774569#54774569", "title": "Removing time from date for an entire data stored in an array", "body": "<p><strong>Removing time from date for an entire data stored in an array</strong></p>\n\n<p>IMO this question rather asks how to change values <em>directly in an array</em> containing <em>dates</em> including time indications.\nTherefore I the following example code just as an addition to the valid solutions above demonstrating how to </p>\n\n<ul>\n<li>get a zero-based 1-dim array from a data column (without loops),</li>\n<li>execute the time removals (in a Loop) using <em>VBA</em>'s <code>Fix</code> function *) to cut the decimal part of the date value and</li>\n<li>(optionally write back the array to any wanted column) </li>\n</ul>\n\n<p>*) Using the <code>CLng</code> instead of <code>Fix</code>(or <code>Int</code>) would round up to the next day any dates with afternoon hours after midday.</p>\n\n<p><strong>Example code</strong></p>\n\n<p>Assumes date values e.g. in column <code>B:B</code> (omitting a title row).</p>\n\n<pre><code>Sub chngDateArray()\n  Dim ws As Worksheet  \n  Set ws = ThisWorkbook.Worksheets(\"MySheetName\")                             ' &lt;&lt; change to your sheet name string\n  Dim lastRow&amp;, i&amp;, arr\n  lastRow = ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row     \n' [1a] assign dates to (1-based) 2-dim datafield array\n       arr = ws.Range(\"B2:B\" &amp; lastRow).Value2                                ' get date values as numbers\n' [1b] rearrange to (0-based) 1-dim array\n       arr = Application.Transpose(arr): ReDim Preserve arr(0 To UBound(arr) -1) ' make it a \"flat\" (zero-based) array\n' [2]  eliminate time portions and reconvert to date\n       For i = 0 To UBound(arr)    \n           arr(i) = CDate(Fix(arr(i)))                                        ' cut time portions from entire dates\n       Next i\n       ' Debug.Print Join(arr, \"|\")                                           ' check in immediate window\n\n' [3]  {optional}: write back array to any wanted column (e.g. D:D)\n       ws.Range(\"D2\").Resize(UBound(arr), 1).Value2 = Application.Transpose(arr)\nEnd Sub\n</code></pre>\n\n<p><strong>Additional note</strong></p>\n\n<p>Using <code>.Value2</code> in section <code>[1a]</code> allows to get dates as numbers only. The reconversion to date format in section <code>[2]</code> eventually allows to write back the array data to any wanted column in section <code>[3]</code> <em>without prior column formatting</em> via <code>NumberFormat</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1580419364, "creation_date": 1580419364, "answer_id": 59994712, "question_id": 31969268, "link": "https://stackoverflow.com/questions/31969268/removing-time-from-date-for-an-entire-data-stored-in-an-array/59994712#59994712", "title": "Removing time from date for an entire data stored in an array", "body": "<p>In addition to the above, you should also be able to pull just the date from those strings using either <code>DateValue()</code> or <code>Format()</code> like so:</p>\n\n<pre><code>DateValue(\"30/04/1995 9:35:00 AM\")\nFormat(\"30/04/1995 9:35:00 AM\", \"dd/mm/yyyy\")\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5078984, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a717d53f6503bde25fc38f92e9390428?s=128&d=identicon&r=PG&f=1", "display_name": "absundo", "link": "https://stackoverflow.com/users/5078984/absundo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30571, "favorite_count": 1, "answer_count": 4, "score": 8, "last_activity_date": 1580419364, "creation_date": 1439392576, "last_edit_date": 1550562293, "question_id": 31969268, "link": "https://stackoverflow.com/questions/31969268/removing-time-from-date-for-an-entire-data-stored-in-an-array", "title": "Removing time from date for an entire data stored in an array", "body": "<p>Using Excel VBA, how would I apply the formula <code>Date(year(A1),Month(A1),Day(A1))</code> to all the dates in an entire column? Currently the data is in date time format (e.g. 30/04/1995  9:35:00 AM) but I want just the date - 30/04/1995.</p>\n\n<p>Currently all of the dates are stored in an array and I have tried <code>Columns(data_column).NumberFormat = \"[$-1009]d-mmm-yy;@\"</code>,\nbut I have not been successful in removing the time from the dates. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1439392632, "post_id": 31969157, "comment_id": 51845527, "body": "Is there event code that is running for worksheet events?  Like <code>Worksheet_Change</code> or <code>Worksheeet_Activate</code> or anything like that?"}, {"owner": {"reputation": 63, "user_id": 4874750, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/305b88ca5dc6b91bfdddde5e1336f9c1?s=128&d=identicon&r=PG&f=1", "display_name": "Athrika", "link": "https://stackoverflow.com/users/4874750/athrika"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1439444539, "post_id": 31969157, "comment_id": 51866126, "body": "No not really. Just very simple loops and variables without any event."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4874750, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/305b88ca5dc6b91bfdddde5e1336f9c1?s=128&d=identicon&r=PG&f=1", "display_name": "Athrika", "link": "https://stackoverflow.com/users/4874750/athrika"}, "edited": false, "score": 0, "creation_date": 1439444439, "post_id": 31969301, "comment_id": 51866080, "body": "Thank you for your response. It seems like it got a shade better but yet the screen flickers. The result comes ofcourse every time. For executing small calculations this doesn&#39;t happen though. I am not a profi yet in VBA. May be my coding might not be that efficient. Thank you once again nevertheless."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 63, "user_id": 4874750, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/305b88ca5dc6b91bfdddde5e1336f9c1?s=128&d=identicon&r=PG&f=1", "display_name": "Athrika", "link": "https://stackoverflow.com/users/4874750/athrika"}, "edited": false, "score": 0, "creation_date": 1439475060, "post_id": 31969301, "comment_id": 51885541, "body": "If your code isn&#39;t too long, you can post it to see if there&#39;s any suggestions to be made.  Are you using <code>.Select</code> or <code>.Activate</code> a lot?"}, {"owner": {"reputation": 63, "user_id": 4874750, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/305b88ca5dc6b91bfdddde5e1336f9c1?s=128&d=identicon&r=PG&f=1", "display_name": "Athrika", "link": "https://stackoverflow.com/users/4874750/athrika"}, "edited": false, "score": 0, "creation_date": 1439530892, "post_id": 31969301, "comment_id": 51908886, "body": "Yes I have used in during the plot. But even if I comment out the plot sub procedure, the screen flickers during the calculation. And the calulation is quite clean. It is complicated with loops but yet with simple logically. Unfortunately I can&#39;t upload the entire code. Its about 10.000 lines and in collaboration to confidential work."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 63, "user_id": 4874750, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/305b88ca5dc6b91bfdddde5e1336f9c1?s=128&d=identicon&r=PG&f=1", "display_name": "Athrika", "link": "https://stackoverflow.com/users/4874750/athrika"}, "edited": false, "score": 0, "creation_date": 1439563791, "post_id": 31969301, "comment_id": 51928146, "body": "@Athrika - Ah, well it might just be due to the size/complexity of the macro.  If you let it run, does it successfully finish correctly?"}, {"owner": {"reputation": 63, "user_id": 4874750, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/305b88ca5dc6b91bfdddde5e1336f9c1?s=128&d=identicon&r=PG&f=1", "display_name": "Athrika", "link": "https://stackoverflow.com/users/4874750/athrika"}, "edited": false, "score": 0, "creation_date": 1439614935, "post_id": 31969301, "comment_id": 51945401, "body": "yes with datas that are small..it doesn&#39;t create any problem (no flickering atall), and with big data it takes like 5 seconds, but the code is entirely executed every time."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 63, "user_id": 4874750, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/305b88ca5dc6b91bfdddde5e1336f9c1?s=128&d=identicon&r=PG&f=1", "display_name": "Athrika", "link": "https://stackoverflow.com/users/4874750/athrika"}, "edited": false, "score": 0, "creation_date": 1439670224, "post_id": 31969301, "comment_id": 51959524, "body": "@Athrika - that&#39;s what happens with some of mine too.  I guess Excel can&#39;t be open and running a macro without looking like it&#39;s going to crash, or something. If you do find a solution though, let us know!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1439392672, "creation_date": 1439392672, "answer_id": 31969301, "question_id": 31969157, "link": "https://stackoverflow.com/questions/31969157/screen-flickering-vba-excel/31969301#31969301", "title": "Screen Flickering VBA Excel", "body": "<p>Try adding this at the start of the sub:</p>\n\n<pre><code>Application.EnableEvents = False\nApplication.DisplayStatusBar = False\nApplication.Calculation = xlCalculationManual\n</code></pre>\n\n<p>And this just before the end:</p>\n\n<pre><code>Application.EnableEvents = True\nApplication.DisplayStatusBar = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n\n<p>That should help.  Note though, my screen also flickers sometimes when running complex macros (Excel looks like it's not responding, but it's working in the background).</p>\n"}], "owner": {"reputation": 63, "user_id": 4874750, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/305b88ca5dc6b91bfdddde5e1336f9c1?s=128&d=identicon&r=PG&f=1", "display_name": "Athrika", "link": "https://stackoverflow.com/users/4874750/athrika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1031, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439392672, "creation_date": 1439392305, "question_id": 31969157, "link": "https://stackoverflow.com/questions/31969157/screen-flickering-vba-excel", "title": "Screen Flickering VBA Excel", "body": "<p>This is something I have read a lot myself but couldn't find the solution.\nI have a program of about 10,000 lines where I have a procedure attach to a particular command button. This calculates some complex equations.</p>\n\n<p>I have started the code as usual with Application.ScreenUpdating = False and turned it to True just before ending of the main procedure. Yet just the upper part of my Excel Sheet (near the Menu Bar) keeps flickering about 10 second until the result appears. I tried disabling events, as well as turning the calculations to manual, but nothing helps. Even tried mentioning screen updating to false at the beginning of sub procedures related to main procedure.</p>\n\n<p>Any suggestion regarding this will be really appreciated. Thank you!</p>\n"}, {"tags": ["excel", "vba", "charts"], "answers": [{"comments": [{"owner": {"reputation": 937, "user_id": 3143679, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dec162275f3f2038fd180792dedd63cc?s=128&d=identicon&r=PG&f=1", "display_name": "George Skelton", "link": "https://stackoverflow.com/users/3143679/george-skelton"}, "edited": false, "score": 0, "creation_date": 1439412042, "post_id": 31970309, "comment_id": 51856598, "body": "Thanks I tried that but the <code>TickLabels.NumberFormat</code> is already in a date format and playing around with it doesn&#39;t seem to help"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 937, "user_id": 3143679, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dec162275f3f2038fd180792dedd63cc?s=128&d=identicon&r=PG&f=1", "display_name": "George Skelton", "link": "https://stackoverflow.com/users/3143679/george-skelton"}, "edited": false, "score": 0, "creation_date": 1439413061, "post_id": 31970309, "comment_id": 51857179, "body": "That&#39;s curious --- it worked for me when I ran your code with the new line of code added. I&#39;m using Excel 2010, what version are you using?"}, {"owner": {"reputation": 937, "user_id": 3143679, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dec162275f3f2038fd180792dedd63cc?s=128&d=identicon&r=PG&f=1", "display_name": "George Skelton", "link": "https://stackoverflow.com/users/3143679/george-skelton"}, "edited": false, "score": 0, "creation_date": 1439415269, "post_id": 31970309, "comment_id": 51858258, "body": "Excel 2010 v14 32-bit"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 937, "user_id": 3143679, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dec162275f3f2038fd180792dedd63cc?s=128&d=identicon&r=PG&f=1", "display_name": "George Skelton", "link": "https://stackoverflow.com/users/3143679/george-skelton"}, "edited": false, "score": 0, "creation_date": 1439416848, "post_id": 31970309, "comment_id": 51858828, "body": "Maybe this behavior is related to the chart type. The code example I gave works for scatter charts. When I tried it with line charts, it looked similar to your chart before close and re-open. Try experimenting with the scatter charts: c.ChartType=xlXYScatterLines"}, {"owner": {"reputation": 937, "user_id": 3143679, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dec162275f3f2038fd180792dedd63cc?s=128&d=identicon&r=PG&f=1", "display_name": "George Skelton", "link": "https://stackoverflow.com/users/3143679/george-skelton"}, "edited": false, "score": 0, "creation_date": 1439432258, "post_id": 31970309, "comment_id": 51862694, "body": "You&#39;re right, xlXYScatterLines works as it should. Thanks"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": false, "score": 1, "last_activity_date": 1439395505, "creation_date": 1439395505, "answer_id": 31970309, "question_id": 31969010, "link": "https://stackoverflow.com/questions/31969010/vba-excel-charts-enter-array-as-xvalue-on-date-axis/31970309#31970309", "title": "VBA Excel Charts: Enter Array as XValue on Date Axis", "body": "<p>When I execute this expression in the Immediate Window:</p>\n\n<pre><code>TypeName(Array(42228, 42229, 42235, 42277, 42338, 42613)(1))\n</code></pre>\n\n<p>VBA returns \"Long\". So I believe your input is already numeric. </p>\n\n<p>I think Excel is \"helping you\" by changing the number format of your tick labels to a non-date format. You can change the format back to date with something like this:</p>\n\n<pre><code>ch.Axes(xlCategory).TickLabels.NumberFormat = \"m/d/yyyy\"\n</code></pre>\n\n<p>Hope that helps</p>\n"}, {"comments": [{"owner": {"reputation": 937, "user_id": 3143679, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dec162275f3f2038fd180792dedd63cc?s=128&d=identicon&r=PG&f=1", "display_name": "George Skelton", "link": "https://stackoverflow.com/users/3143679/george-skelton"}, "edited": false, "score": 0, "creation_date": 1440171945, "post_id": 32121987, "comment_id": 52178306, "body": "Thanks Jon, actually it wasn&#39;t changing the axis type. My solution is to use scatter line charts when I can and when it has to be a line chart then I wrote a macro to make a copy in the same position (and delete the old one) which forces it to appear the way it should"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "reply_to_user": {"reputation": 937, "user_id": 3143679, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dec162275f3f2038fd180792dedd63cc?s=128&d=identicon&r=PG&f=1", "display_name": "George Skelton", "link": "https://stackoverflow.com/users/3143679/george-skelton"}, "edited": false, "score": 0, "creation_date": 1440257678, "post_id": 32121987, "comment_id": 52203615, "body": "If you use my procedure, you don&#39;t need to recreate the chart (and hose any custom formatting you&#39;ve applied). Resetting the category type and number format makes the chart look right."}], "tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 1, "last_activity_date": 1440083434, "creation_date": 1440083434, "answer_id": 32121987, "question_id": 31969010, "link": "https://stackoverflow.com/questions/31969010/vba-excel-charts-enter-array-as-xvalue-on-date-axis/32121987#32121987", "title": "VBA Excel Charts: Enter Array as XValue on Date Axis", "body": "<p>When your X value array was passed in, they were not in a date format. Excel, being ever so helpful, decided the axis was no longer a date scale axis. But you can easily fix that:</p>\n\n<pre><code>Sub test()\n  Dim c As Chart\n  Set c = ActiveChart\n  With c.SeriesCollection(1)\n    .XValues = Array(42228, 42229, 42235, 42277, 42338, 42613)\n    .Values = Array(1, 2, 3, 4, 5, 6)\n  End With\n  With c.Axes(xlCategory, xlPrimary)\n    .CategoryType = xlTimeScale\n    .TickLabels.NumberFormat = \"m/dd/yy\"\n  End With\nEnd Sub\n</code></pre>\n\n<p>My initial thought, which didn't work, was to enter the values as dates:</p>\n\n<pre><code>Array(#8/12/2015#, #8/13/2015#, #8/19/2015#, #9/30/2015#, #11/30/2015#, #8/31/2016#)\n</code></pre>\n\n<p>but this made the axis behave as a text axis, with the dates equally spaced. Although the Date Axis option was selected, the rest of the axis options was the same as a text axis, and didn't show the date scaling section of a date axis.</p>\n"}], "owner": {"reputation": 937, "user_id": 3143679, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/dec162275f3f2038fd180792dedd63cc?s=128&d=identicon&r=PG&f=1", "display_name": "George Skelton", "link": "https://stackoverflow.com/users/3143679/george-skelton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6386, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1440083434, "creation_date": 1439391940, "question_id": 31969010, "link": "https://stackoverflow.com/questions/31969010/vba-excel-charts-enter-array-as-xvalue-on-date-axis", "title": "VBA Excel Charts: Enter Array as XValue on Date Axis", "body": "<p>I am trying to create/modify an Excel line chart with a Date x-axis using VBA and assigning the Series.Xvalues using an array rather than a range:</p>\n\n<pre><code>Sub test()\n  Dim c As Chart: Set c = ActiveChart\n  With c.SeriesCollection(1)\n    .XValues = Array(42228, 42229, 42235, 42277, 42338, 42613)        \n    .Values = Array(1, 2, 3, 4, 5, 6)  \n  End With\nEnd Sub\n</code></pre>\n\n<p>The problem is when I run that the .resulting .XValues are of type Variant/String rather than Variant/Double, so the chart shows as if the x-axis were a Text axis rather than a Date axis (i.e. the points appear evenly spaced along the x-axis):</p>\n\n<p><a href=\"https://i.stack.imgur.com/n6Ozb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n6Ozb.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>However if I save the file, close it and then reopen it magically appears as a Date axis, with the points spaced along the x-axis according to their true distance:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R8pgV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R8pgV.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If I inspect the Series.XValues object after reopening, the array elements have been transformed into Variant/Double. I tried coercing them manually before reopening but it causes Excel to crash. Actually even if I just copy the chart it's enough to make it appear properly, so somehow Excel \"knows\" it's a date axis but is just not showing it as such. I'm going to have to use that as the solution (i.e. make a copy and delete the old one whenever I change the chart), however it's pretty clunky and I would love to figure out what's going on here. I found this <a href=\"http://www.ozgrid.com/forum/showthread.php?t=66504\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/forum/showthread.php?t=66504</a> but he doesn't seem to have the same problem. I'm using Excel 2010.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439395904, "post_id": 31969007, "comment_id": 51847818, "body": "I think that the sheet may be protected. So, check it again and say me, it is protected or not."}], "answers": [{"comments": [{"owner": {"reputation": 1210, "user_id": 4867148, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5d91b0057ed27b336f7aac48e0373fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathon64", "link": "https://stackoverflow.com/users/4867148/johnathon64"}, "edited": false, "score": 0, "creation_date": 1439392245, "post_id": 31969091, "comment_id": 51845277, "body": "I just tried that however I still got the same error"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1210, "user_id": 4867148, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5d91b0057ed27b336f7aac48e0373fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathon64", "link": "https://stackoverflow.com/users/4867148/johnathon64"}, "edited": false, "score": 0, "creation_date": 1439392337, "post_id": 31969091, "comment_id": 51845331, "body": "Really? It worked for me, hmm.... If you walk through the macro (press F8), does it still show you the same error on that line?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1210, "user_id": 4867148, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5d91b0057ed27b336f7aac48e0373fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathon64", "link": "https://stackoverflow.com/users/4867148/johnathon64"}, "edited": false, "score": 0, "creation_date": 1439393527, "post_id": 31969091, "comment_id": 51846187, "body": "Is the Sub in the worksheet, or a new module? I Don&#39;t think it matters though...hm."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1439392167, "creation_date": 1439392167, "answer_id": 31969091, "question_id": 31969007, "link": "https://stackoverflow.com/questions/31969007/delete-method-of-range-failed-vba/31969091#31969091", "title": "Delete method of range failed vba", "body": "<p>Oh, you're close!  Just add the \"EntireRow\" qualifier (I have no idea if that's the right term for that) to that line: <code>xSheet.Rows(i).EntireRow.Delete</code>.</p>\n"}], "owner": {"reputation": 1210, "user_id": 4867148, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5d91b0057ed27b336f7aac48e0373fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathon64", "link": "https://stackoverflow.com/users/4867148/johnathon64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1255, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439392167, "creation_date": 1439391929, "question_id": 31969007, "link": "https://stackoverflow.com/questions/31969007/delete-method-of-range-failed-vba", "title": "Delete method of range failed vba", "body": "<p>I have 2 columns, I am doing a comparison on each cell of the column A and B with row count of 1613 to check if it does not contain a select number of strings.  I then try and delete the row if it doesnt contain either of the strings however I have come across an error <code>Delete method of Range class failed</code>  However I am not sure what is wrong </p>\n\n<pre><code>Sub macro()\nDim i As Integer\nDim ws As Worksheet\nSet xSheet = Worksheets(\"RAW DATA (2)\")\nxSheet.Select\nFor i = 1 To 1613\n    If InStr(Cells(i, 2).Value, \"Error\") = False Or InStr(Cells(i, 2).Value, \"No credentials\") = False Or InStr(Cells(i, 2).Value, \"Connection Failed\") = False Then\n        xSheet.Rows(i).Delete\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "plot", "scatter-plot"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "edited": false, "score": 0, "creation_date": 1439450586, "post_id": 31969512, "comment_id": 51869225, "body": "Admittetly, the code isn&#39;t clean. I often rely on a sheet being active so my references can be shorter but using variables is of course better. I&#39;ll work on that. With <code>MesEnd = Worksheets(SourceName).Columns(&quot;b&quot;).find(what:=Dateend, after:=Cells(1, 2), searchdirection:=xlPrevious).Row1</code> is it really necesary to add the worksheets before <code>Cells(1, 2)</code>? because you already specified that you want to search within <code>worksheets(sourcename)</code>. Also in <code>worksheets(sourcename)</code>, sourcename is a variable so i dont know if it&#39;s safe to declare a variable for this. After cleaning, code stil didn&#39;t work."}, {"owner": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "edited": false, "score": 0, "creation_date": 1439451589, "post_id": 31969512, "comment_id": 51869830, "body": "Now that i cleaned the code. It breaks on the line <code>ws3.ComboBox1.Clear</code>, When i change this back to <code>ThisWorkbook.Worksheets(&quot;blad3&quot;).ComboBox1.Clear</code> it works again. I did set ws3 earlier by <code>Set ws3 = ThisWorkbook.Worksheets(&quot;blad3&quot;)</code>"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "edited": false, "score": 0, "creation_date": 1439452508, "post_id": 31969512, "comment_id": 51870327, "body": "Yes cells refers to the active sheet!    It is safe: &quot;sourcename is a variable so I don&#39;t know if it&#39;s safe to declare a variable for this.&quot;     When you say it Breaks&quot; what error message is given?  You need to give more information.  Just saying &quot;it doesn;t work&quot; won&#39;t help.  Repost you new &quot;cleaned&quot; code and use the debugger to step through and examine to find where and why it is failing."}, {"owner": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "edited": false, "score": 0, "creation_date": 1439453566, "post_id": 31969512, "comment_id": 51870951, "body": "Forgive me for not being clear. Im relatively new to programming and english is not my native language. Depending on a listboxselection the variable &#39;sourcename&#39; can be the name of one of 20 sheets. If i declare a variable <code>wssrc</code> for <code>thisworkbook.worksheets(sourcename)</code> will the code still recognize which sheet is referenced to? Also I will update the code in the question."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "edited": false, "score": 0, "creation_date": 1439454168, "post_id": 31969512, "comment_id": 51871303, "body": "wssrc will be set to the worksheet with the name given in the brackets, either whne the name is given explicitly (eg &quot;MyWorksheet&quot;) or using a variable."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1439393206, "creation_date": 1439393206, "answer_id": 31969512, "question_id": 31968914, "link": "https://stackoverflow.com/questions/31968914/excel-vba-scatterplot-not-plotting-x-values-but-sequence/31969512#31969512", "title": "excel vba scatterplot not plotting x values but sequence", "body": "<p>I've not tried to understand the logic of the code (yet), but I can see many potential bugs:</p>\n\n<hr>\n\n<p>In the code below which is used twice, the <code>Cells(1, 2)</code> does not have the worksheet in front of it.  eg in this case  <code>Worksheets(SourceName).Cells(1, 2)</code></p>\n\n<pre><code>MesEnd = Worksheets(SourceName).Columns(\"b\").find(what:=Dateend, after:=Cells(1, 2), searchdirection:=xlPrevious).Row\n</code></pre>\n\n<hr>\n\n<p>Similarly in the code below which .  AND also which worksheet is number 5.\nUse <code>Worksheets(\"Predictions\")</code> if this is what you mean.</p>\n\n<pre><code>Set PredRange = Worksheets(5).Range(Cells(PredStart, Predcol), Cells(PredEnd, Predcol))\n</code></pre>\n\n<hr>\n\n<p>Also here:</p>\n\n<pre><code>Set MesRange = Worksheets(SourceName).Range(Cells(MesStart, MesCol), Cells(MesEnd, MesCol))\n</code></pre>\n\n<hr>\n\n<p>Also</p>\n\n<pre><code>.XValues = Range(Cells(2, 1), Cells(3, 1))\n.Values = Range(Cells(2, 1), Cells(3, 1))\n</code></pre>\n\n<h2>----------------------------------</h2>\n\n<p>You should consider using with statements (which also nest) not the full stops.\neg </p>\n\n<pre><code>With Worksheets(SourceName)\n    Set MesRange = .Range(.Cells(MesStart, MesCol), .Cells(MesEnd, MesCol))\nEnd with\n</code></pre>\n\n<h2>----------------------------------</h2>\n\n<p>You might use an object variable to store the reference to you worksheet</p>\n\n<pre><code>eg\nDim wsPred as Worksheeet\nSet  wsPred  = Worksheets(\"Predictions\")\n</code></pre>\n\n<p>then in later code you can use <code>wsPred</code> instead of <code>Worksheets(\"Predictions\")</code></p>\n\n<p>Harvey</p>\n"}], "owner": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 675, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439455480, "creation_date": 1439391712, "last_edit_date": 1439455480, "question_id": 31968914, "link": "https://stackoverflow.com/questions/31968914/excel-vba-scatterplot-not-plotting-x-values-but-sequence", "title": "excel vba scatterplot not plotting x values but sequence", "body": "<p>I'm trying to create a few scattercharts that will tell how close a measurement is to a prediction. On the X axis we will have the predicted value and on the y axis we will have the measured value. When the two are the same the datapoint lies an a red line which has the same x as y value. In this way we can say whether our predictions are good, or maybe too conservative. Below is an example of 4 datapoints. </p>\n\n<pre><code>Measured  predicted\n12        10    \n15        14\n16        17\n18        18\n</code></pre>\n\n<p>Instead of plotting the points at (12, 10) (15, 14) etc... it plots the points at (1, 10) (2, 14) (3, 16) and (4, 18). So on the x value it's actually plotting the rownumber and not the value.<br>\nIm using a rather large VBA script to accomplish this because the user has a lot of options when choosing which data to plot. When I rightclick the graph and click 'select data' and then check the selected ranges they do match with the ranges of values I'd like to plot. Both datasets are stored in different worksheets. </p>\n\n<p>I've already found some solutions that had to do with numbers saved as text, the nature of the x axis and inconsistensies in the datasets however none of those worked for me.</p>\n\n<p>these are some of the relevant variables. The worksheets ws1, ws2, ws3 and wspred are declared earlier with <code>set ws1 = thisworkbook.worksheets(\"blad1\")</code>\nthe measured data is stored in one of 20 worksheets which are referred to with the variable sourcename. The predicted data is stored in wspred.</p>\n\n<pre><code>'date processing\nDim DateStart As String\nDim Dateend As String\nDim rngstart As Range\nDim rngend As Range\n'listboxprocessing\nDim plotvar As String\nDim SourceSig As String\nDim SourceLength As Long\nDim SourceName As String\nDim SignalLength As Long\nDim SignalName As String\nDim SignalRange As Range\nDim predSignalName As String\n'dataselection for blad 3 &amp; 4\nDim predRange As Range\nDim MesRange As Range\nDim predcol As Long\nDim MesCol As Long\nDim predStart As Long\nDim predEnd As Long\nDim MesStart As Long\nDim MesEnd As Long\n</code></pre>\n\n<p>This is the code concerning the graphs</p>\n\n<pre><code> If CheckBox2.Value = True Then\nws3.Activate\nws3.Shapes.AddChart\nws3.ChartObjects.Delete\nThisWorkbook.Worksheets(\"blad3\").ComboBox1.Clear\nws1.Activate\n'create red reference line\nws3.Cells(1, 1).Value = \"red\" &amp; \" \" &amp; \"line\"\nws3.Cells(2, 1).Value = 0\nws3.Cells(3, 1).Value = 10\n\n'matching measured data with selected predicted data\nFor i = 0 To ListBox23.ListCount - 1\n    plotvar = ListBox23.List(i)\n    SourceSig = Mid(ListBox23.List(i), 13)\n    SignalLength = InStr(plotvar, \"--&gt;\") + 3\n    SignalName = Mid(plotvar, SignalLength)\n    predSignalName = Mid(plotvar, SignalLength)\n    If Left(SourceSig, 5) = \"a thing\" Then\n        SourceName = Left(SourceSig, 7)\n        SignalName = Mid(SignalName, 10, 4)\n        ElseIf Left(SourceSig, 9) = \"something\" Then\n            SourceName = Left(SourceSig, 13)\n            SignalName = Mid(SignalName, 16, 4)\n        ElseIf Left(SourceSig, 7) = \"something else\" Then\n            SourceName = Left(SourceSig, 10)\n            SignalName = Mid(SignalName, 13, 4)\n        Else: SourceName = \"something different\"\n    End If\n    'creating range from Predictions\n    wspred.Activate\n    If OptionButton2.Value = True Then\n        DateStart = TextboxMonth1 &amp; \"/\" &amp; textboxDate1 &amp; \"/\" &amp; TextboxYear1 \n        Dateend = TextboxMonth2 &amp; \"/\" &amp; TextboxDate2 &amp; \"/\" &amp; TextboxYear2 \n        On Error Resume Next\n        predStart = wspred.Columns(\"b\").find(DateStart).Row\n        If predStart = 0 Then\n            MsgBox \"selected date not found\"\n            predStart = 2\n        Else: predEnd = wspred.Columns(\"b\").find(what:=Dateend, after:=Cells(1, 2), searchdirection:=xlPrevious).Row\n            If predEnd = 0 Then\n                MsgBox \"selected date not found\"\n                predEnd = wspred.Cells(wspred.rows.Count, 2).End(xlUp).Row\n            End If\n        On Error GoTo 0\n        End If\n        ElseIf OptionButton2.Value = False Then\n        predStart = 1\n        predEnd = wspred.Cells(wspred.rows.Count, 2).End(xlUp).Row\n    End If\n    predcol = wspred.rows(1).find(predSignalName).Column\n    Set predRange = wspred.Range(Cells(predStart, predcol), Cells(predEnd, predcol))\n    'creating range from source\n    Worksheets(SourceName).Activate\n    If OptionButton2.Value = True Then\n        DateStart = TextboxMonth1 &amp; \"/\" &amp; textboxDate1 &amp; \"/\" &amp; TextboxYear1 \n        Dateend = TextboxMonth2 &amp; \"/\" &amp; TextboxDate2 &amp; \"/\" &amp; TextboxYear2 \n        On Error Resume Next\n        MesStart = Worksheets(SourceName).Columns(\"b\").find(DateStart).Row\n        If MesStart = 0 Then\n            MsgBox \"selected date not found\"\n        Else: MesEnd = Worksheets(SourceName).Columns(\"b\").find(what:=Dateend, after:=Cells(1, 2), searchdirection:=xlPrevious).Row\n            If MesEnd = 0 Then\n                MsgBox \"selected date not found\"\n                MesEnd = Worksheets(SourceName).Cells(Worksheets(SourceName).rows.Count, 2).End(xlUp).Row\n            End If\n        On Error GoTo 0\n        End If\n        ElseIf OptionButton2.Value = False Then\n        MesStart = 1\n        MesEnd = Worksheets(SourceName).Cells(Worksheets(SourceName).rows.Count, 2).End(xlUp).Row\n    End If\n    MesCol = Worksheets(SourceName).rows(1).find(SignalName).Column\n    Set MesRange = Worksheets(SourceName).Range(Cells(MesStart, MesCol), Cells(MesEnd, MesCol))\n\n        'makes red line\n    ws3.Activate\n    'ws3.ChartObjects.Delete\n\n        j = i + 1\n        m = 3 * j\n        ws3.Shapes.AddChart(xlXYScatter, (j - 1) * 300, 0, 300, 300).Select\n        With ActiveChart\n            .HasLegend = False\n            .Axes(xlValue).HasTitle = True\n            .Axes(xlValue).AxisTitle.Caption = Worksheets(SourceName).Cells(1, MesCol)\n            .Axes(xlCategory).HasTitle = True\n            .Axes(xlCategory).AxisTitle.Caption = wspred.Cells(1, predcol)\n            .Axes(xlValue).MaximumScale = 5\n            .Axes(xlCategory).MaximumScale = 5\n        End With\n\n        ActiveChart.SeriesCollection.NewSeries\n        With ActiveChart.SeriesCollection(1)\n            .Name = \"\"\n            .XValues = ws3.Range(Cells(2, 1), Cells(3, 1))\n            .Values = ws3.Range(Cells(2, 1), Cells(3, 1))\n            .MarkerSize = 2\n            .MarkerStyle = xlMarkerStyleDot\n            .Format.Line.Visible = msoTrue\n            .Format.Line.ForeColor.RGB = RGB(255, 0, 0)\n            .Format.Line.Transparency = 0\n        End With\n        ActiveChart.SeriesCollection.NewSeries\n        With ActiveChart.SeriesCollection(2)\n            .Name = \"predicted/measured\"\n            .XValues = predRange.Value\n            .Values = MesRange\n            .MarkerStyle = xlMarkerStylePlus\n            .MarkerSize = 2\n            .Format.Line.Visible = msoFalse\n            .MarkerForegroundColor = RGB(85, 143, 213)\n            .MarkerBackgroundColorIndex = xlColorIndexNone\n        End With\n\n        thisworkbook.worksheets(\"blad3\").ComboBox1.AddItem Mid(ActiveChart.Name, 7, 11)\nNext i\nEnd If\n</code></pre>\n\n<p>Edit: I cleaned the code so it uses variables as reference to worksheets. The problem of the x axis showing numbers instead of the actual values still exists. There is another curious error as well. Twice I refer to <code>thisworkbook.worksheets(\"blad3\").combobox1</code>, this works. When i use <code>ws3.combobox1</code> instead vba returns a 'compile error: method or data member not found' even though `ws3 = thisworkbook.worksheets(\"blad3\").</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439391824, "post_id": 31968830, "comment_id": 51844995, "body": "I assume cell &quot;F&quot; &amp; i is part of the data dump, and identifies that the row you&#39;re on is something like a line-item? Or is that cell something where you have a manual formula that checks whether all categories are met, and then puts in &quot;All&quot;?"}, {"owner": {"reputation": 291, "user_id": 947769, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/34ca059c1dee6f7b2831c473a57567d9?s=128&d=identicon&r=PG", "display_name": "Erik Rasmussen", "link": "https://stackoverflow.com/users/947769/erik-rasmussen"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439392118, "post_id": 31968830, "comment_id": 51845191, "body": "column F is the column that lists the size of the product, and All is a row for each product that contains data for the entire product. It those rows that I&#39;m interesting in meeting my criteria, thats why I&#39;ve included that"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1439399827, "post_id": 31968830, "comment_id": 51850067, "body": "You routine is slow because you&#39;re trying to walk through each cell in the range.  What you want to do is range-array copying, explained here, along with other performance tips: <a href=\"http://stackoverflow.com/a/19167804/109122\">stackoverflow.com/a/19167804/109122</a>"}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 947769, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/34ca059c1dee6f7b2831c473a57567d9?s=128&d=identicon&r=PG", "display_name": "Erik Rasmussen", "link": "https://stackoverflow.com/users/947769/erik-rasmussen"}, "edited": false, "score": 0, "creation_date": 1439412163, "post_id": 31970583, "comment_id": 51856661, "body": "Cheers, this works well. I haven&#39;t dealt with something like this before, so took a second to get my head around it, but I like the logic.  I&#39;ll test the sumifs answer on my data tomorrow as well, but this processed everything reasonably quick, which works for me."}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 2, "last_activity_date": 1439396439, "creation_date": 1439396439, "answer_id": 31970583, "question_id": 31968830, "link": "https://stackoverflow.com/questions/31968830/vba-faster-data-clean-up/31970583#31970583", "title": "VBA Faster Data Clean Up", "body": "<p>My general advice would be to create a dictionary, which is an Array of values that can be accessed with either an ordered index number or a name key. With that dictionary, first go through all rows of data. Look column E: does the name in \"E\" &amp; i exist yet in the dictionary? If not, add it to the dictionary. Then take the dictionary ID (either newly created, or which was created on a previous row), and add that row with columns K, L, and O to the value of the dictionary's entry. </p>\n\n<p>Then, once you have all the names collected with the dictionary, and you have added up columns K, L, and O, go back through all rows (from bottom-up). For the index ID of that row, is the value from the dictionary entry >0? If yes, delete that row.</p>\n\n<p>But to complicate things, you need to add a separate (free, microsoft supported) scripting package to use Dictionaries. So instead, we will make our own. The only thing this means is that each time a new row is checked for a unique name, we need to cycle through the list of unique names thus-far, and check each one individually, instead of using that name as an index. See my revised code below, with comments on changes made from yours. Note that I set all variables at the beginning, including declaring Data to be = sheets(1), which may differ from your sub.</p>\n\n<pre><code>Sub Delete_Unnecessary_Rows()\n\nDim i As Integer\nDim TY_Sales As Long, LY_Sales As Long, TY_Stock As Long, Sales_Stock As Long, LastRow As Long\nDim data As Worksheet\nDim vendor_ref As String\n\nDim VendorStringArray() As String 'This Array will hold all unique vendor names\nDim VendorNumArray() As Long 'This array will hold the Sales Stock value for each unique vendor name\nDim VendorRowIdentifier() As Long 'For each row, this will hold the index for particular unique vendor name\nDim UniqueNameCounter As Long 'This will hold the number of confirmed unique names\n\nDim UniqueCheck As Boolean\n\n\nSet data = Sheets(1)\n\nLastRow = data.Cells(data.Rows.Count, \"B\").End(xlUp).Row\n\nReDim VendorStringArray(3 To LastRow) 'resize the array to be the full possible amount of unique string values\nReDim VendorNumArray(3 To LastRow)\nReDim VendorRowIdentifier(3 To LastRow)\n\nFor i = 3 To LastRow 'new loop to find new dictionary names\n    If data.Range(\"F\" &amp; i) = \"All\" Then 'This is a data row to be searched for a unique vendor name\n\n        UniqueCheck = True 'Holds TRUE until a duplicate value is found in a higher row\n\n        vendor_ref = data.Range(\"E\" &amp; i).Formula 'Grabs the vendor name and Sales_Stock amount for that row\n        TY_Sales = data.Range(\"K\" &amp; i)\n        LY_Sales = data.Range(\"L\" &amp; i)\n        TY_Stock = data.Range(\"O\" &amp; i)\n        Sales_Stock = TY_Sales + LY_Sales + TY_Stock\n        If UniqueNameCounter &gt; 0 Then 'If there's already been at least 1 unique name, check prior unique names to try and find a match\n\n            For j = UniqueNameCounter To 1 Step -1 'works backwards through prior unique counters to find a match\n                If vendor_ref = VendorStringArray(j + 2) Then\n                    UniqueCheck = False 'A match has been found\n                    VendorRowIdentifier(i) = j + 2 'associates the row being searched with the index of the unique vendor name for the matched row\n                    VendorNumArray(VendorRowIdentifier(i)) = VendorNumArray(VendorRowIdentifier(i)) + Sales_Stock 'adds the new sales stock value to the old one with that unique vendor name\n                    j = 0 'stops the formula from looping after a match is found\n\n                End If\n            Next j\n        End If\n        If UniqueCheck Then 'no match was found for that name in an above row\n                UniqueNameCounter = UniqueNameCounter + 1\n                VendorStringArray(UniqueNameCounter + 2) = vendor_ref 'adds the text to be matched against future values in the array, starting at 3 instead of 1\n                VendorRowIdentifier(i) = UniqueNameCounter + 2 'associates the row being searched with the index of the unique vendor name\n                VendorNumArray(UniqueNameCounter + 2) = Sales_Stock\n        End If\n    End If\n\nNext i\n\n\nFor i = LastRow To 3 Step -1 'After determining which rows have values, delete all such rows\n    If data.Range(\"F\" &amp; i) = \"All\" Then\n        If VendorNumArray(VendorRowIdentifier(i)) &gt; 0 Then 'Pull the value of the unique vendor name associated with that row #'s vendor and check the size associated\n            data.Rows(i).Delete 'Delete the row if any value has been assigned to that vendor\n        End If\n    End If\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>As suggested by Dr. Trey, you can also eliminate auto-updating etc. during the processing, to further save time in operation.</p>\n"}, {"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1439398969, "creation_date": 1439398969, "answer_id": 31971336, "question_id": 31968830, "link": "https://stackoverflow.com/questions/31968830/vba-faster-data-clean-up/31971336#31971336", "title": "VBA Faster Data Clean Up", "body": "<p>Here's an alternative method. Instead of manually looping and checking for values in matching vendor names, this method uses the native Excel SUMIFS function on each line, to see if any matching rows have values. Each row is then assigned either TRUE or FALSE through an Array of Boolean values. Then the loop is performed again and the rows marked TRUE are deleted. This method only loops through all rows 2x, although using SUMIFS may be more intensive than the manual loop above. However I believe this method is easier to understand.</p>\n\n<p>Disclosure: I have tested both methods and confirmed they work, but not sure on what the difference in processing time will be.</p>\n\n<pre><code>Sub CheckDelete_WithSumifs()\n\nDim i As Integer\nDim TY_Sales As Long, LY_Sales As Long, TY_Stock As Long, Sales_Stock As Long, LastRow As Long\nDim data As Worksheet\nDim Vendor_Ref As String\nDim DeleteRowCheck() As Boolean\n\nSet data = Sheets(1)\n\nLastRow = data.Cells(data.Rows.Count, \"B\").End(xlUp).Row\n\nReDim DeleteRowCheck(3 To LastRow) 'resize the array to be the full possible amount of unique string values\n\nFor i = LastRow To 3 Step -1  'new loop to find new dictionary names\n    If data.Range(\"F\" &amp; i) = \"All\" Then 'Only check to delete if the word All is in column F\n\n        Vendor_Ref = data.Range(\"E\" &amp; i).Formula 'Grabs the vendor name and Sales_Stock amount for that row\n        TY_Sales = GrabSumifs(data.Range(\"K:K\"), Vendor_Ref, data) ' See function below\n        LY_Sales = GrabSumifs(data.Range(\"L:L\"), Vendor_Ref, data)\n        TY_Stock = GrabSumifs(data.Range(\"O:O\"), Vendor_Ref, data)\n\n        Sales_Stock = TY_Sales + LY_Sales + TY_Stock 'Total value of all columns K, L, O for that vendor name\n\n        If Sales_Stock &gt; 0 Then\n            DeleteRowCheck(i) = True 'Used in the loop below to define whether to delete the row\n        Else\n            DeleteRowCheck(i) = False\n        End If\n    End If\n\nNext i\n\nFor i = LastRow To 3 Step -1 'After determining which rows have are marked TRUE to delete, delete those rows\n    If DeleteRowCheck(i) Then\n        data.Rows(i).Delete 'Delete the row if any value has been assigned to that vendor\n    End If\nNext\n\n\nEnd Sub\n\nFunction GrabSumifs(SumRange, Vendor_Ref, data) As Long\n\n'This function uses the SUMIFS formula native to Excel, to check the given column to see if any values are present with an identicial vendor name &amp; \"All\" in column F.\nGrabSumifs = Application.WorksheetFunction.SumIfs(SumRange, data.Range(\"F:F\"), \"All\", data.Range(\"E:E\"), Vendor_Ref)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 947769, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/34ca059c1dee6f7b2831c473a57567d9?s=128&d=identicon&r=PG", "display_name": "Erik Rasmussen", "link": "https://stackoverflow.com/users/947769/erik-rasmussen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 308, "favorite_count": 0, "accepted_answer_id": 31970583, "answer_count": 2, "score": 0, "last_activity_date": 1439398969, "creation_date": 1439391502, "question_id": 31968830, "link": "https://stackoverflow.com/questions/31968830/vba-faster-data-clean-up", "title": "VBA Faster Data Clean Up", "body": "<p>I'm working on a Sub to help clean up a large data set I need to work with each week. the data is a list of products, with a total and size for each, so it looks something like this:</p>\n\n<p>Product 1 All</p>\n\n<p>Product 1 Small</p>\n\n<p>Product 1 Medium</p>\n\n<p>Product 2 All</p>\n\n<p>I only want to keep a product if it matches one of 3 criteria, but if it does I want to keep all rows for that product. If a product doesn't match any of the 3 criteria, I want to delete every row that has that product.</p>\n\n<p>I've written the below code, which does seem to be working, but takes ages.</p>\n\n<pre><code>For i = Data.Cells(Rows.Count, \"B\").End(xlUp).Row To 3 Step -1\nIf Data.Range(\"F\" &amp; i) = \"All\" Then\n\n    TY_Sales = Data.Range(\"K\" &amp; i)\n    LY_Sales = Data.Range(\"L\" &amp; i)\n    TY_Stock = Data.Range(\"O\" &amp; i)\n    Sales_Stock = TY_Sales + LY_Sales + TY_Stock\n\n    If Sales_Stock &lt;= 0 Then\n    vendor_ref = Data.Range(\"E\" &amp; i)\n        For j = i + 10 To i Step -1\n            If Data.Range(\"E\" &amp; j) = vendor_ref Then\n            Data.Range(\"E\" &amp; j).EntireRow.Delete\n            End If\n        Next\n    End If\nEnd If\nNext\n</code></pre>\n\n<p>Its taking ages because my original data set is 17k rows, and I know I'm iterating through it all over and over again, but I don't know a better way to do it more quickly. Any help is greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1439394259, "creation_date": 1439394259, "answer_id": 31969887, "question_id": 31968363, "link": "https://stackoverflow.com/questions/31968363/excel-vba-macro-to-look-up-intranet-link-into-querytable/31969887#31969887", "title": "Excel VBA macro to look up intranet link into querytable", "body": "<p>I'd say the link is incorrect and therefore you're getting the error. The rest seems fine and can be easily verified using the macro recorder anyway. Therefore, I'd suggest that you build and verify the link before you use it.</p>\n\n<pre><code>strURL = Range(\"link1\").Value &amp; Range(\"day\").Value &amp; Symbol &amp; Range(\"month\").Value &amp; Symbol &amp; Range(\"Year\").Value &amp; Symbol &amp; \"the_shift=\" &amp; Range(\"shift\").Value &amp; \"_1\" ' This is copied from your code and cannot be verified\nDebug.Print strURL 'copy this into the IE and see if it works\nWith ActiveSheet.QueryTables.Add(Connection:=strURL, Destination:=Range(\"$B$4\"))\n        .Name = \"TestName\"\n'... the rest of your code as is ...\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 2878384, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a3848fd5a039400f6c9c0ca723367c2c?s=128&d=identicon&r=PG", "display_name": "Gokotai", "link": "https://stackoverflow.com/users/2878384/gokotai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1440548371, "creation_date": 1439390318, "last_edit_date": 1440548371, "question_id": 31968363, "link": "https://stackoverflow.com/questions/31968363/excel-vba-macro-to-look-up-intranet-link-into-querytable", "title": "Excel VBA macro to look up intranet link into querytable", "body": "<p>I'm trying to write a macro to extract information from an intranet page onto an excel worksheet. I'm trying to automate this because the URL can change depending on the date and \"shift\" chosen on the webpage. </p>\n\n<p>I'm getting several errors upon compiling my code. I've tried a few different approaches but none of them seem to work. </p>\n\n<p>Any thoughts?</p>\n\n<pre><code>    Sub InfoExtract()\n\n    Dim Symbol As String\n    Dim URL As String\n    Dim ws1 As Worksheet\n\n    Set ws1 = Sheets(\"Sheet3\")\n    ws1.Select\n\n    Symbol = \"%20\"\n\n    With ActiveSheet.QueryTables.Add(Connection:=Range(\"link1\").Value &amp; Range(\"day\").Value &amp; Symbol &amp; Range(\"month\").Value &amp; Symbol &amp; Range(\"Year\").Value &amp; Symbol &amp; \"the_shift=\" &amp; Range(\"shift\").Value &amp; \"_1\", Destination:=Range(\"$B$4\"))\n        .Name = \"shift_report.asp?the_date=\" &amp; Range(\"day\").Value &amp; Symbol &amp; Range(\"month\").Value &amp; Symbol &amp; Range(\"Year\").Value &amp; Symbol &amp; \"the_shift=\" &amp; Range(\"shift\").Value\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlEntirePage\n        .WebFormatting = xlWebFormattingNone\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba", "export-to-excel"], "comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 2, "creation_date": 1439396960, "post_id": 31968178, "comment_id": 51848418, "body": "I believe this couldbe of interest to you <a href=\"http://stackoverflow.com/questions/1849580/export-ms-access-tables-through-vba-to-an-excel-spreadsheet-in-same-directory\" title=\"export ms access tables through vba to an excel spreadsheet in same directory\">stackoverflow.com/questions/1849580/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "is_accepted": false, "score": 0, "last_activity_date": 1439419859, "creation_date": 1439419859, "answer_id": 31976715, "question_id": 31968178, "link": "https://stackoverflow.com/questions/31968178/exporting-a-table-from-access-to-excel-based-on-the-click-of-a-command-button/31976715#31976715", "title": "Exporting a Table from Access to Excel based on the click of a command button", "body": "<p>You can open the book via VBA, add/modify the contents, then save it or save it elsewhere.</p>\n\n<p>The below example will open an existing workbook, add some data, then save it as a new workbook and open the excel file on the screen for the user.</p>\n\n<pre><code>   'Open a workbook in Excel\n   Dim oExcel As Object\n   Dim oBook As Object\n   Dim oSheet As Object\n\n   Set oExcel = CreateObject(\"Excel.Application\")\n   Set oBook = oExcel.Open(\"C:\\Temp\\ExcelFileName.xlsx\")\n   Set oSheet = oBook.Worksheets(1)\n\n    'HEADINGS\n    oSheet.Range(\"A1\").Value = \"Heading1\"\n    oSheet.Range(\"B1\").Value = \"Heading2\"\n    oSheet.Range(\"C1\").Value = \"Heading3\"\n\n   'Transfer the data to Excel\n    oSheet.Range(\"A2\").Value = \"Text Data\"\n    oSheet.Range(\"B2\").Value = 1.05\n    oSheet.Range(\"C2\").Value = Now()\n\n   'Save the Workbook and Quit Excel\n   oBook.SaveAs \"C:\\Temp\\ExcelFileName1.xlsx\"\n\n   oExcel.Quit\n   Application.FollowHyperlink \"C:\\Temp\\ExcelFileName1.xlsx\"\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 987, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1594643870, "creation_date": 1439389848, "last_edit_date": 1594643870, "question_id": 31968178, "link": "https://stackoverflow.com/questions/31968178/exporting-a-table-from-access-to-excel-based-on-the-click-of-a-command-button", "title": "Exporting a Table from Access to Excel based on the click of a command button", "body": "<p>I am trying to find a way to allow a user to automatically have a certain table from an access database to export to an excel sheet based on the click of a command button on a form. After the table has been exported I want the excel sheet to automatically pop up. But I have other tabs that are already on the spreadsheet so is there a way to allow the table to only be exported to that one tab and have it automatically update when the user presses the command button. I have tried to make the command button using the macro so I wouldnt mess up the coding. I usually code VBA but I am stumped on this. Thanks so much!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4874543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202870143234874/picture?type=large", "display_name": "Tushar Taliyan", "link": "https://stackoverflow.com/users/4874543/tushar-taliyan"}, "edited": false, "score": 0, "creation_date": 1439392088, "post_id": 31968598, "comment_id": 51845164, "body": "Perfect...this worked...Thank you so much, this is very helpful. Your advice is noted."}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 2, "last_activity_date": 1439390924, "creation_date": 1439390924, "answer_id": 31968598, "question_id": 31968117, "link": "https://stackoverflow.com/questions/31968117/need-to-remove-specific-words-from-a-list-of-words-in-excel-using-vba/31968598#31968598", "title": "Need to remove specific words from a List of words in excel using VBA", "body": "<p>I made some changes to your code as noted in the comments below.</p>\n\n<pre><code>Sub DeleteRowWithContents()\n\n Dim ExcludWords() As Variant\n Dim r As Long\n Dim txt As Range 'txt is a Range, so we can set it to a cell - you can't change the text of a cell by declaring that text as its own variable\n Dim ws As Worksheet 'specifically created a variable to refer to your spreadsheet, otherwise it always assumes the active sheet, which may not be appropriate\n Dim i As Long\n Dim LR As Long\n\n  ExcludWords = Array(\"ANY\", \"I\", \"GO\", \"THROUGH\", \"OUT\", \"IT\", \"ALL\", \"TO\", \"THE\", _\n    \"BUT\", \"IN\", \"&amp;\", \"E-MAIL\", \"AN\", \" FOR \", \"US\", \"AS\", \"AND\", _\n    \"6-12CT\", \"WITH\", \"SAVINGS\")\n\nSet ws = Sheets(1) 'set the ws variable to your current sheet (may need to change this depending on which sheet you run this on)\n\nLR = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row 'Note that I started from the bottom and went up, instead of starting from the top and going down. Less prone to error\n\nFor i = 1 To LR 'Here you had referred to lastrow, which is not how you defined the variable above\nSet txt = ws.Cells(i, \"A\") '\nFor r = 0 To UBound(ExcludWords)\n   txt.Formula = Replace(UCase(txt.Formula), ExcludWords(r), \"\") 'Note that I made the text in txt.Formula Uppercase as your ExcludWords is all uppercase\n    Next r\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I have tested and confirmed that this works on my Sheet1; please ask questions if you don't understand my comments above. Some things to consider based on my changes: (1) Declare your variables for sheets and cells ahead of time, it makes it easier to work with them later; (2) Make sure you refer to variables exactly the same way as you declared them [it helps here to make very descriptive names, instead of just \"LR\" or \"txt\"]; and finally (3) test your code line by line by entering the code editor and pressing f8, one line at a time. This will reveal quite clearly where your errors are.</p>\n"}], "owner": {"reputation": 1, "user_id": 4874543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202870143234874/picture?type=large", "display_name": "Tushar Taliyan", "link": "https://stackoverflow.com/users/4874543/tushar-taliyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3450, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439390924, "creation_date": 1439389692, "question_id": 31968117, "link": "https://stackoverflow.com/questions/31968117/need-to-remove-specific-words-from-a-list-of-words-in-excel-using-vba", "title": "Need to remove specific words from a List of words in excel using VBA", "body": "<p>I have a list of words in <strong>Column A</strong>(one word per row), I want to remove certain words and delete that particular row. I have the below code but it doesn't do anything when executed(Nothing Happens). I cannot figure out what is wrong. Please help</p>\n\n<pre><code>  Sub DeleteRowWithContents()\n\n  Dim ExcludWords() As Variant\n Dim r As Long\n Dim txt As String\n Dim i As Long\n Dim LR As Long\n\n  ExcludWords = Array(\"ANY\", \"I\", \"GO\", \"THROUGH\", \"OUT\", \"IT\", \"ALL\", \"TO\", \"THE\", _\n    \"BUT\", \"IN\", \"&amp;\", \"E-MAIL\", \"AN\", \" FOR \", \"US\", \"AS\", \"AND\", _\n    \"6-12CT\", \"WITH\", \"SAVINGS\")\n\nLast = Range(\"A2\").End(xlDown).Row\nFor i = 1 To Last\ntxt = Cells(i, \"A\")\nFor r = 0 To UBound(ExcludWords)\n   txt = Replace(txt, ExcludWords(r), \"\")\n    Next r\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1210, "user_id": 4867148, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5d91b0057ed27b336f7aac48e0373fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathon64", "link": "https://stackoverflow.com/users/4867148/johnathon64"}, "edited": false, "score": 0, "creation_date": 1439390978, "post_id": 31968245, "comment_id": 51844344, "body": "I have no got an a subscript out of range when assigning the worksheet to a variable"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 1210, "user_id": 4867148, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5d91b0057ed27b336f7aac48e0373fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathon64", "link": "https://stackoverflow.com/users/4867148/johnathon64"}, "edited": false, "score": 0, "creation_date": 1439391091, "post_id": 31968245, "comment_id": 51844434, "body": "@Johnathon64 Did you change how you assigned the worksheet to a variable? Because I didn&#39;t require you to do that. Is this an error you saw before? Make sure your ws name &quot;Raw Data (2)&quot; is correct."}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1439390042, "creation_date": 1439390042, "answer_id": 31968245, "question_id": 31968112, "link": "https://stackoverflow.com/questions/31968112/delete-row-if-string-found-vba-excel/31968245#31968245", "title": "delete row if string found vba excel", "body": "<p>You are mixing your methods a bit.</p>\n\n<p>'.EntireRow' Is the property of a Range, not a Row.</p>\n\n<p>So where you have:</p>\n\n<pre><code>ws.rows(i).EntireRow.Delete\n</code></pre>\n\n<p>You should put something like:</p>\n\n<pre><code>ws.Range(\"B\"&amp;i).EntireRow.Delete\n</code></pre>\n\n<p>But really, you could simplify this with one of the .Row methods, which is just Delete. So, you could alternatively just say:</p>\n\n<pre><code>ws.rows(i).Delete\n</code></pre>\n\n<p>I've tested both and confirmed syntax is correct; I can't see any other issues with your code.</p>\n"}, {"comments": [{"owner": {"reputation": 1210, "user_id": 4867148, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5d91b0057ed27b336f7aac48e0373fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathon64", "link": "https://stackoverflow.com/users/4867148/johnathon64"}, "edited": false, "score": 0, "creation_date": 1439394328, "post_id": 31968393, "comment_id": 51846780, "body": "Just tried to copy and paste your solution but got errors"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1210, "user_id": 4867148, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5d91b0057ed27b336f7aac48e0373fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathon64", "link": "https://stackoverflow.com/users/4867148/johnathon64"}, "edited": false, "score": 0, "creation_date": 1439394877, "post_id": 31968393, "comment_id": 51847167, "body": "my apologies. I wrote that off the top of my head and made an error. <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">InStr function</a>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1439394771, "last_edit_date": 1439394771, "creation_date": 1439390394, "answer_id": 31968393, "question_id": 31968112, "link": "https://stackoverflow.com/questions/31968112/delete-row-if-string-found-vba-excel/31968393#31968393", "title": "delete row if string found vba excel", "body": "<p>Modify all of your string comparisons to be closer to,</p>\n\n<pre><code>    If NOT InStr(1, \" error no credentials connection failed \", lcase(Cells(i, 2).Value), vbTextCompare) Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 7687219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de604965720a8343d1883e4f9f0572db?s=128&d=identicon&r=PG&f=1", "display_name": "DougLSchneider", "link": "https://stackoverflow.com/users/7687219/douglschneider"}, "is_accepted": false, "score": 0, "last_activity_date": 1489674562, "creation_date": 1489674562, "answer_id": 42836940, "question_id": 31968112, "link": "https://stackoverflow.com/questions/31968112/delete-row-if-string-found-vba-excel/42836940#42836940", "title": "delete row if string found vba excel", "body": "<p>Autofilter is more efficient than looping</p>\n\n<pre><code>Sub DeleteRows()\n    Sheet1.Range(\"a1:c35\").AutoFilter Field:=2, Criteria1:=\"&lt;&gt;error\"\n    Sheet1.UsedRange.Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    Sheet1.UsedRange.AutoFilter\n'repeat for each value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1210, "user_id": 4867148, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5d91b0057ed27b336f7aac48e0373fb9?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathon64", "link": "https://stackoverflow.com/users/4867148/johnathon64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1025, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1489674562, "creation_date": 1439389679, "last_edit_date": 1439396465, "question_id": 31968112, "link": "https://stackoverflow.com/questions/31968112/delete-row-if-string-found-vba-excel", "title": "delete row if string found vba excel", "body": "<p>I am trying to delete rows if the excel file does not contain a certain word.</p>\n\n<p>I loop through the cells within column B and check if the cell value contains this string and if not then I will delete it.</p>\n\n<p>However, I am getting an error saying <strong>Delete method of range class failed</strong>.</p>\n\n<pre><code>Sub macro()\n\nDim i As Integer, intValueToFind As Integer\nDim ws As Worksheet\n\nSet ws = Worksheets(\"RAW DATA (2)\")\n\nFor i = 1 To 500    ' Revise the 500 to include all of your values\n\n    If InStr(Cells(i, 2).Value, \"Error\") = False Or InStr(Cells(i, 2).Value, \"No credentials\") = False Or InStr(Cells(i, 2).Value, \"Connection Failed\") = False Then\n        ws.Rows(i).EntireRow.Delete\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "save", "overwrite"], "answers": [{"tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": true, "score": 0, "last_activity_date": 1439392502, "last_edit_date": 1439392502, "creation_date": 1439390818, "answer_id": 31968545, "question_id": 31967780, "link": "https://stackoverflow.com/questions/31967780/export-a-cell-range-into-a-new-csv-file-with-vba-and-save-it-without-overwritin/31968545#31968545", "title": "Export a cell range into a new .csv file with VBA and save it without overwriting", "body": "<p>I just re-read the ? again. What you need is a way to get a new number and add it to the file name. </p>\n\n<pre><code>FiNum = ... 'get file number from a text file\nFiName = \"C:\\Users\\User\\Desktop\\Range\" &amp; FiNum &amp; \".csv\"\nActiveWorkbook.SaveAs Filename:=FiName, FileFormat:=xlCSV, CreateBackup:=False\nFiNum = FiNum + 1\nCall WriteToFile(FiNum)  ... 'write file number back to text file\n\nSub WriteToFile(ByVal FiNum As Long)\n    Open \"C:\\FiNumber.txt\" For Output As #1\n    Print #1, CStr(FiNum) 'print as string for optimum results\n    Close #1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2462, "user_id": 1870412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NeIJB.jpg?s=128&g=1", "display_name": "Datacrawler", "link": "https://stackoverflow.com/users/1870412/datacrawler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3913, "favorite_count": 0, "accepted_answer_id": 31968545, "answer_count": 1, "score": 0, "last_activity_date": 1439392502, "creation_date": 1439388861, "question_id": 31967780, "link": "https://stackoverflow.com/questions/31967780/export-a-cell-range-into-a-new-csv-file-with-vba-and-save-it-without-overwritin", "title": "Export a cell range into a new .csv file with VBA and save it without overwriting", "body": "<p>All I am trying to do is copy, paste a cell range into a new CSV file and save the new file with VBA. I will might use this VBA for this file many times. So, I would like to make it save the files with a number.</p>\n\n<p>I am using the code below and it is working: </p>\n\n<pre><code>Sub ExportRangetoFile()\nDim Rng As Range\nDim WorkRng As Range\nDim xFile As Variant\nDim xFileString As String\nOn Error Resume Next\nxTitleId = \"KutoolsforExcel\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\nApplication.ActiveSheet.Copy\nApplication.ActiveSheet.Cells.Clear\nWorkRng.Copy Application.ActiveSheet.Range(\"A1\")\nSet xFile = CreateObject(\"Scripting.FileSystemObject\")\nActiveWorkbook.SaveAs Filename:=\"C:\\Users\\User\\Desktop\\Range.csv\", FileFormat:=xlCSV, CreateBackup:=False\nEnd Sub\n</code></pre>\n\n<p>The saved file with the cell range I selected from the original excel file is called Range. I want to change the code and make it save the files <strong>without</strong> overwriting any other file.</p>\n\n<p>I presume this is the part I should change : </p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\User\\Desktop\\Range.csv\", FileFormat:=xlCSV, CreateBackup:=False\n</code></pre>\n\n<p>I tried to change the \"False\" to \"True\" but it did not work. Maybe for another reason though. </p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 5174339, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5354b9ba58c097e5b27c769d2a21930a?s=128&d=identicon&r=PG&f=1", "display_name": "bmyers", "link": "https://stackoverflow.com/users/5174339/bmyers"}, "edited": false, "score": 0, "creation_date": 1439393346, "post_id": 31967939, "comment_id": 51846035, "body": "Ok thanks, I don&#39;t currently have access to a book so I will rephrase my question on a simpler scale.  Mainly, I am trying to transfer a single sheet of Excel to Access."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 49, "user_id": 5174339, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5354b9ba58c097e5b27c769d2a21930a?s=128&d=identicon&r=PG&f=1", "display_name": "bmyers", "link": "https://stackoverflow.com/users/5174339/bmyers"}, "edited": false, "score": 0, "creation_date": 1439394932, "post_id": 31967939, "comment_id": 51847212, "body": "See extra text in my answer - but still get a book"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 1, "last_activity_date": 1439394913, "last_edit_date": 1439394913, "creation_date": 1439389261, "answer_id": 31967939, "question_id": 31967436, "link": "https://stackoverflow.com/questions/31967436/vba-excel-transfer-to-word-and-access/31967939#31967939", "title": "VBA Excel: Transfer to Word and Access", "body": "<p>Your question asks for to much.  Books on Excel VBA like \"Excel 2013 Power Programming with VBA (Mr. Spreadsheet's Bookshelf)\" will help.</p>\n\n<p>I will say that it will be easier for Access to pull the data from excel using it's own VBA code.  To send data to word int he way you describe, will involve initialising a new word application and a new document.</p>\n\n<p>Get a book, it will pay for itself as this sort of situation is often described.</p>\n\n<p>Try google searche for:</p>\n\n<p>\"linking to excel data in an access application\"</p>\n\n<p>Also see:</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/698670-using-excel-visual-basic-applications-export-data-ms-access-table.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/698670-using-excel-visual-basic-applications-export-data-ms-access-table.html</a></p>\n\n<p><a href=\"https://www.youtube.com/watch?v=PhpZQw1ktP4\" rel=\"nofollow\">https://www.youtube.com/watch?v=PhpZQw1ktP4</a></p>\n\n<p>And Youtube channel ExcelisFun.</p>\n\n<p>Harvey</p>\n"}], "owner": {"reputation": 49, "user_id": 5174339, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5354b9ba58c097e5b27c769d2a21930a?s=128&d=identicon&r=PG&f=1", "display_name": "bmyers", "link": "https://stackoverflow.com/users/5174339/bmyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1473171489, "creation_date": 1439388047, "last_edit_date": 1439395972, "question_id": 31967436, "link": "https://stackoverflow.com/questions/31967436/vba-excel-transfer-to-word-and-access", "title": "VBA Excel: Transfer to Word and Access", "body": "<p>I have a program in VBA excel that manipulates data and transfers it to a few different sheets.  What I would like to do now is transfer one sheet to Microsoft Access and one sheet to Microsoft Word.  I would like to keep all of the code in my excel VBA workbook if possible, as opposed to Access or Word.</p>\n\n<p>I want the sheet named \"Data\" transferred to Word and \"Points\" transferred to Access.  I want the code to transfer these sheets to uncreated documents, then name the documents and save it.  Each sheet can be transferred individually.</p>\n\n<p>I have tried looking up answers to this question but have failed to find any good information!  I have little idea where to begin with this specific code, so any help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5195356, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203621987750315/picture?type=large", "display_name": "Ryan K", "link": "https://stackoverflow.com/users/5195356/ryan-k"}, "edited": false, "score": 0, "creation_date": 1439389040, "post_id": 31967613, "comment_id": 51842755, "body": "Okay, I&#39;ll investigate this and give it a try. Unfortunately, the formatting of the source cell isn&#39;t consistent, so I&#39;ll no idea where the bold characters are. Thanks!"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1439388489, "creation_date": 1439388489, "answer_id": 31967613, "question_id": 31967318, "link": "https://stackoverflow.com/questions/31967318/retaining-font-style-while-using-text-to-columns/31967613#31967613", "title": "Retaining font style while using Text-To-Columns", "body": "<p>You will need to write code to scan through each character in the source cell and move the character along with it's formatting to the destination cell changing the destination cell when a \"break\" character is reached. </p>\n\n<p>There will be no benefit in using text-to-columns.  There is no easier way of doing this that I know of.</p>\n\n<p>Needless to say it's quite a bit of work.</p>\n\n<p><a href=\"http://www.excelforum.com/excel-programming-vba-macros/368575-copy-partial-cell-character-format-s-from-one-cell-to-another-an-example.html\" rel=\"nofollow\">This</a> page might give you an insight into the sort of code you might write and the properties and methods you might use.</p>\n\n<p>Note that the code is simpler if your formatting in teh source cell is simple as you have suggested).  If the source cell is ALWAYS \"nonbold bold nonbold bold\" with a delimiting character between you could code differently.   </p>\n\n<p>Harvey</p>\n"}], "owner": {"reputation": 1, "user_id": 5195356, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203621987750315/picture?type=large", "display_name": "Ryan K", "link": "https://stackoverflow.com/users/5195356/ryan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439388752, "creation_date": 1439387743, "last_edit_date": 1439388752, "question_id": 31967318, "link": "https://stackoverflow.com/questions/31967318/retaining-font-style-while-using-text-to-columns", "title": "Retaining font style while using Text-To-Columns", "body": "<p>When using Text-To-Columns, is there a way to keep the font style of the text within the cell you are using the command on? For example, I have a cell with text in the form: <em>12345</em>, <strong>12345</strong>, <strong><em>12345</em></strong>, 12345. </p>\n\n<p>Using Text-To-Columns, I want the end result to be 4 columns with the text retaining its current font style, however the function reverts the text to the style of the 4th '12345'. I tried using Destination:= [code].Font.ColorIndex, but that didn't seem to work. </p>\n\n<p>Any ideas?</p>\n\n<pre><code>                        ActiveSheet.Range(\"M\" &amp; k).Select\n                        Selection.Font.ColorIndex = ActiveSheet.Range(MyValueAIMS &amp; k).Font.ColorIndex\n\n                        If InStr(ActiveSheet.Range(MyValueAIMS &amp; k).Value, \",\") &gt; 0 Then\n                            Range(MyValueAIMS &amp; k).Select\n                            ActiveSheet.Range(MyValueAIMS &amp; k).Replace _\n                                What:=Chr(10), Replacement:=\"\" 'maybe change this so it puts in an actual delimiter?\n                                    '.Font.ColorIndex = ActiveSheet.Range(MyValueAIMS &amp; k).Font.ColorIndex\n                            Selection.TextToColumns Destination:=Range(\"M\" &amp; k), DataType:=xlDelimited, _\n                                TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n                                Semicolon:=True, Comma:=True, Space:=True, Other:=True, OtherChar _\n                                :=\"-\", FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), _\n                                Array(6, 1), Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1)), TrailingMinusNumbers:=True\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "tsql", "encryption", "converter"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 3, "creation_date": 1439387586, "post_id": 31967081, "comment_id": 51841582, "body": "So here is the approach.  (1) Figure out what the code is supposed to do.  (2) Determine the appropriate data structures needed in SQL.  (3) Re-implement the code."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1439387992, "post_id": 31967081, "comment_id": 51841877, "body": "Code like that should be deleted rather than converted. Seriously -- one of the weakest possible encryption schemes (which can literally be broken using 19th century cryptanalysis since it is in effect just a Vigenere cipher -- broken in the 1850s) with a fixed key as well."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1439388052, "post_id": 31967081, "comment_id": 51841928, "body": "@John  I love your comment.  I was just thinking it didn&#39;t look to hard to crack..."}, {"owner": {"reputation": 88781, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 1, "creation_date": 1439388571, "post_id": 31967081, "comment_id": 51842352, "body": "SQL Server already has very strong encryption capabilities. Throw away this code and use one of the available options"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1439388620, "post_id": 31967081, "comment_id": 51842389, "body": "To expand on my comment. I don&#39;t know the politics of OP&#39;s situation -- but if this is something that OP has been tasked to do at work and it is meant to be in production code then it could show a certain amount of initiative to suggest to the powers that be that it would be better to use a more secure encryption method."}, {"owner": {"reputation": 11, "user_id": 5219501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c17d62b62b39c90970b9adf66106f278?s=128&d=identicon&r=PG&f=1", "display_name": "ridan413", "link": "https://stackoverflow.com/users/5219501/ridan413"}, "reply_to_user": {"reputation": 88781, "user_id": 134204, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vwnA5.jpg?s=128&g=1", "display_name": "Panagiotis Kanavos", "link": "https://stackoverflow.com/users/134204/panagiotis-kanavos"}, "edited": false, "score": 0, "creation_date": 1439393697, "post_id": 31967081, "comment_id": 51846312, "body": "@PanagiotisKanavos Can you explain to me how to use these &quot;encryption capabilities&quot;? I&#39;m a Junio SQL developer so I am still learning."}], "answers": [{"comments": [{"owner": {"reputation": 377, "user_id": 4409034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GnwdRAP7Cgc/AAAAAAAAAAI/AAAAAAAAAD0/F0GBNeqqq-A/photo.jpg?sz=128", "display_name": "Juan-Carlos", "link": "https://stackoverflow.com/users/4409034/juan-carlos"}, "edited": false, "score": 0, "creation_date": 1439566428, "post_id": 31974368, "comment_id": 51929790, "body": "Your code sample above can be pasted directly into a VB6 project and it runs without modification.  It can be pasted into a VB 2010 .Net project and the only change is to set a default value = &quot;&quot; to the STRDATAOUT variables.  So, you can very easily step execute it and figure out what it is doing.    Essentially, it loops thru the input string, taking 1 byte from the string, converting into ASCII, then taking 1 byte from the CodeWord, and convert that to ASCII, strings them together does an XOR operation, converts that to HEX, adds a &quot;0&quot; if the hex result is only 1 byte long, adds that to ...."}, {"owner": {"reputation": 377, "user_id": 4409034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GnwdRAP7Cgc/AAAAAAAAAAI/AAAAAAAAAD0/F0GBNeqqq-A/photo.jpg?sz=128", "display_name": "Juan-Carlos", "link": "https://stackoverflow.com/users/4409034/juan-carlos"}, "edited": false, "score": 0, "creation_date": 1439566655, "post_id": 31974368, "comment_id": 51929913, "body": "adds that to STRDATAOUT...repeat until at end of string, return to caller.  The input string is at that point converted/encrypted.  The merely basically reverses that.   So, in TSQL you will need to be able to 1) iterate a string, one byte at a time, calculate an offset using a modulus operation, convert to ASC, convert to HEX, perform and XOR, and concatentate a string.    TSQL is not as strong at these things as VB, C# and other languages, but it can be done."}, {"owner": {"reputation": 377, "user_id": 4409034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GnwdRAP7Cgc/AAAAAAAAAAI/AAAAAAAAAD0/F0GBNeqqq-A/photo.jpg?sz=128", "display_name": "Juan-Carlos", "link": "https://stackoverflow.com/users/4409034/juan-carlos"}, "edited": false, "score": 0, "creation_date": 1439566709, "post_id": 31974368, "comment_id": 51929941, "body": "I&#39;m assuming the encrypted results are stored in a database.    ( perhaps as encrypted passwords ? )    If so, I second the recommendation of  Panagiotis Kanavos, and strongly suggest you use the existing VBA Decryption function to decrypt the existing database values, and re-encrypt them using SQL Server encryption features.  And....adapt the application to use SQL Server to do the encryption  &amp; decryption work going forward."}, {"owner": {"reputation": 377, "user_id": 4409034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GnwdRAP7Cgc/AAAAAAAAAAI/AAAAAAAAAD0/F0GBNeqqq-A/photo.jpg?sz=128", "display_name": "Juan-Carlos", "link": "https://stackoverflow.com/users/4409034/juan-carlos"}, "edited": false, "score": 0, "creation_date": 1440790627, "post_id": 31974368, "comment_id": 52435915, "body": "Here is a link explaining XOR in ciphering.  Hope this helps..       <a href=\"https://en.wikipedia.org/wiki/XOR_cipher\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/XOR_cipher</a>"}], "tags": [], "owner": {"reputation": 377, "user_id": 4409034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GnwdRAP7Cgc/AAAAAAAAAAI/AAAAAAAAAD0/F0GBNeqqq-A/photo.jpg?sz=128", "display_name": "Juan-Carlos", "link": "https://stackoverflow.com/users/4409034/juan-carlos"}, "is_accepted": false, "score": 0, "last_activity_date": 1439409840, "creation_date": 1439409840, "answer_id": 31974368, "question_id": 31967081, "link": "https://stackoverflow.com/questions/31967081/convert-vba-code-to-t-sql-code/31974368#31974368", "title": "Convert VBA code to T-SQL code", "body": "<p>Assumably, the original author is gone, so...   if you have anyone in the shop who knows ANY version of VB ( .Net, VBS, VBA, VB Classic ), get their help in reverse engineering the VBA code.  </p>\n\n<p>Once you understand the WHAT and HOW of the VBA Code, you'll be able to match the functionality in TSQL.      </p>\n\n<p>Otherwise...it's trial by fire.    Do web searches on the VB commands and learn them one by one.  Fortunately, there are not very many in that block of logic.</p>\n"}, {"tags": [], "owner": {"reputation": 377, "user_id": 4409034, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GnwdRAP7Cgc/AAAAAAAAAAI/AAAAAAAAAD0/F0GBNeqqq-A/photo.jpg?sz=128", "display_name": "Juan-Carlos", "link": "https://stackoverflow.com/users/4409034/juan-carlos"}, "is_accepted": false, "score": 0, "last_activity_date": 1439569382, "creation_date": 1439569382, "answer_id": 32014576, "question_id": 31967081, "link": "https://stackoverflow.com/questions/31967081/convert-vba-code-to-t-sql-code/32014576#32014576", "title": "Convert VBA code to T-SQL code", "body": "<p>Ridan,   I've commented the original code with additional comments to help clarify what is happening.   My comments are in the form of '##   comment.....</p>\n\n<p>Hope this helps.</p>\n\n<pre><code>Public Function XORDecryption(DataIn As String) As String\n\nDim lonDataPtr As Long\nDim strDataOut As String\nDim intXOrValue1 As Integer\nDim intXOrValue2 As Integer\nDim CodeKey As String\n\nCodeKey = \"R@ndomWord7\"\n'   establish a loop, to walk thru theinput string, stepping thru it two ( 2 ), yes two bytes at a time.\nFor lonDataPtr = 1 To (Len(DataIn) / 2)\n'The first value to be XOr-ed comes from the data to be encrypted\n'###     Take the 1st of two bytes from data in.  Let the Val function know that this data exists in its Hex form\n'###     Place it into intXOrValue1\nintXOrValue1 = Val(\"&amp;H\" &amp; (Mid$(DataIn, (2 * lonDataPtr) - 1, 2)))\n'The second value comes from the code key\n'###    Take the 2nd of two bytes from data in.  \n'###     Place it into intXOrValue2\nintXOrValue2 = Asc(Mid$(CodeKey, ((lonDataPtr Mod Len(CodeKey)) + 1), 1))\n\n'###     Do an XOR on the two fields ( intXORValue1 and intXORValue2) and then convert the results to its CHR form\n'###     Place the result into strDataOut ( via concatenation )\nstrDataOut = strDataOut + Chr(intXOrValue1 Xor intXOrValue2)\n'###    Loop until done....\nNext lonDataPtr\n'###    Return result to caller\nXORDecryption = strDataOut\nEnd Function\n\nPlus this code needs to be converted as well:\n\nPublic Function XOREncryption(DataIn As String) As String\n\nDim lonDataPtr As Long\nDim strDataOut As String\nDim temp As Integer\nDim tempstring As String\nDim intXOrValue1 As Integer\nDim intXOrValue2 As Integer\nDim CodeKey As String\n\nCodeKey = \"R@ndomWord7\"\nFor lonDataPtr = 1 To Len(DataIn)\n'The first value to be XOr-ed comes from the data to be encrypted\n'###   Pull one byte of data from the input string.  On first pass thru loop pull byte # 1, on 2nd pass pull byte # 2, etc\n'###   Convert that one byte to its ASCII form \n'###    Place it into variable intXORValue1\nintXOrValue1 = Asc(Mid$(DataIn, lonDataPtr, 1))\n'The second value comes from the code key\n'###   Pull one byte of data from the Codeword.  Chose that one byte based on the result of this formula :\n'###      divide lonDataPtr by the length of CodeKey ( 11 bytes in this case ) and hold onto the REMAINDER following the division\n'###      add 1 to the remainder ( in case it was 0 )\n'###      Now, pick the Nth byte from Codekey  ( as calcuated above with the division and modulus and the plus 1 )\n'###         and...convert it to its ASCII form\n'###        and place the result into intXORValue2\nintXOrValue2 = Asc(Mid$(CodeKey, ((lonDataPtr Mod Len(CodeKey)) + 1), 1))\n\n'###   Now, do the XOR operation, placing the result into the variable TEMP\n'###      see this web page for more on the XOR operation :\ntemp = (intXOrValue1 Xor intXOrValue2)\n'###   Convert the TEMP result into its HEX form\ntempstring = Hex(temp)\n'###   If it is only 1 byte long, prefix it with a \"0\".  \n'###     as you will see in the Decrypt function, two bytes of output for each 1 byte of input is important.\nIf Len(tempstring) = 1 Then tempstring = \"0\" &amp; tempstring\n'###   Add it ( via concatenation) to the output string\nstrDataOut = strDataOut + tempstring\nNext lonDataPtr\n'###   When all bytes converted....return the encrypted result to the caller.\nXOREncryption = strDataOut\nEnd Function\n\n'USAGE\n    Private Sub cmdEncryptdecrypt_Click()\n    Dim strEncryptedText As String\n    'strCodeKey = InputBox(\"Please enter your password\", \"XOr Encryption\")\n    strEncryptedText = XOREncryption(\"TestEncryptedWords\")\n    ' Note:  the strEncryptedText should be:  140B1C1B28390C001D4726250A33001F331C\n    MsgBox XORDecryption(strEncryptedText)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5219501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c17d62b62b39c90970b9adf66106f278?s=128&d=identicon&r=PG&f=1", "display_name": "ridan413", "link": "https://stackoverflow.com/users/5219501/ridan413"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1439569382, "creation_date": 1439387132, "last_edit_date": 1439388041, "question_id": 31967081, "link": "https://stackoverflow.com/questions/31967081/convert-vba-code-to-t-sql-code", "title": "Convert VBA code to T-SQL code", "body": "<p>I have an encryption project where I need to convert this VBA code into T-SQL. I am a SQL developer and I am having a hard time trying to figure out what this VBA code is trying to do:</p>\n\n<pre><code>Public Function XORDecryption(DataIn As String) As String\n\nDim lonDataPtr As Long\nDim strDataOut As String\nDim intXOrValue1 As Integer\nDim intXOrValue2 As Integer\nDim CodeKey As String\n\nCodeKey = \"R@ndomWord7\"\n\nFor lonDataPtr = 1 To (Len(DataIn) / 2)\n'The first value to be XOr-ed comes from the data to be encrypted\nintXOrValue1 = Val(\"&amp;H\" &amp; (Mid$(DataIn, (2 * lonDataPtr) - 1, 2)))\n'The second value comes from the code key\nintXOrValue2 = Asc(Mid$(CodeKey, ((lonDataPtr Mod Len(CodeKey)) + 1), 1))\n\nstrDataOut = strDataOut + Chr(intXOrValue1 Xor intXOrValue2)\nNext lonDataPtr\nXORDecryption = strDataOut\nEnd Function\n</code></pre>\n\n<p>Plus this code needs to be converted as well:</p>\n\n<pre><code>Public Function XOREncryption(DataIn As String) As String\n\nDim lonDataPtr As Long\nDim strDataOut As String\nDim temp As Integer\nDim tempstring As String\nDim intXOrValue1 As Integer\nDim intXOrValue2 As Integer\nDim CodeKey As String\n\nCodeKey = \"R@ndomWord7\"\nFor lonDataPtr = 1 To Len(DataIn)\n'The first value to be XOr-ed comes from the data to be encrypted\nintXOrValue1 = Asc(Mid$(DataIn, lonDataPtr, 1))\n'The second value comes from the code key\nintXOrValue2 = Asc(Mid$(CodeKey, ((lonDataPtr Mod Len(CodeKey)) + 1), 1))\n\ntemp = (intXOrValue1 Xor intXOrValue2)\ntempstring = Hex(temp)\nIf Len(tempstring) = 1 Then tempstring = \"0\" &amp; tempstring\n\nstrDataOut = strDataOut + tempstring\nNext lonDataPtr\nXOREncryption = strDataOut\nEnd Function\n\n'USAGE\n    Private Sub cmdEncryptdecrypt_Click()\n    Dim strEncryptedText As String\n    'strCodeKey = InputBox(\"Please enter your password\", \"XOr Encryption\")\n    strEncryptedText = XOREncryption(\"TestEncryptedWords\")\n    ' Note:  the strEncryptedText should be:  140B1C1B28390C001D4726250A33001F331C\n    MsgBox XORDecryption(strEncryptedText)\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone please help me?</p>\n"}, {"tags": ["c#", "vba", "vsto", "powerpoint", "add-in"], "answers": [{"tags": [], "owner": {"reputation": 546, "user_id": 4567386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11f8fce6de0ea6f1be214fa8a8469481?s=128&d=identicon&r=PG&f=1", "display_name": "Shyam Pillai", "link": "https://stackoverflow.com/users/4567386/shyam-pillai"}, "is_accepted": false, "score": 0, "last_activity_date": 1439390407, "creation_date": 1439390407, "answer_id": 31968399, "question_id": 31966983, "link": "https://stackoverflow.com/questions/31966983/how-to-save-color-scheme-in-ppt-application-c-vsto/31968399#31968399", "title": "How to save Color Scheme in ppt application c# vsto", "body": "<p>The theme needs to be physically present on the users profile to be listed on the Design tab everytime. Save the theme in this location: \n\"%AppData%\\Microsoft\\Templates\\Document Themes\"</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5219522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GlpoD.jpg?s=128&g=1", "display_name": "Katy", "link": "https://stackoverflow.com/users/5219522/katy"}, "is_accepted": true, "score": 0, "last_activity_date": 1439394415, "creation_date": 1439394415, "answer_id": 31969945, "question_id": 31966983, "link": "https://stackoverflow.com/questions/31966983/how-to-save-color-scheme-in-ppt-application-c-vsto/31969945#31969945", "title": "How to save Color Scheme in ppt application c# vsto", "body": "<pre><code>String programfilesPath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);\n            String msOfficePath = \"Microsoft\\\\Templates\\\\Document Themes\\\\Test.thmx\";\n            String fullPath = Path.Combine(programfilesPath, msOfficePath);\n\n            Globals.ThisAddIn.Application.ActivePresentation.SaveCopyAs(fullPath);\n</code></pre>\n\n<p>This one works.</p>\n"}], "owner": {"reputation": 1, "user_id": 5219522, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GlpoD.jpg?s=128&g=1", "display_name": "Katy", "link": "https://stackoverflow.com/users/5219522/katy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 1, "accepted_answer_id": 31969945, "answer_count": 2, "score": 0, "last_activity_date": 1439394415, "creation_date": 1439386896, "question_id": 31966983, "link": "https://stackoverflow.com/questions/31966983/how-to-save-color-scheme-in-ppt-application-c-vsto", "title": "How to save Color Scheme in ppt application c# vsto", "body": "<p>I want to know if it is possible to save the colors of a ppt document programatically using C# vsto ppt add-in. <br/>\nI have logic to save it for current document</p>\n\n<pre><code>private void ThisAddIn_Startup(object sender, System.EventArgs e)\n        {\n            pptApp = this.Application;\n            pptApp.AfterNewPresentation += new Microsoft.Office.Interop.PowerPoint.EApplication_AfterNewPresentationEventHandler(pptApp_AfterNewPresentation);\n        }\n\nprivate void pptApp_AfterNewPresentation(PowerPoint.Presentation pres)\n        {\n            AddTheme(pres);\n        }\n\n        private void AddTheme(PowerPoint.Presentation pres)\n        {\n            pres.ApplyTheme(theme);\n            PowerPoint.ColorScheme myScheme = Globals.ThisAddIn.Application.ActiveWindow.View.Slide.ColorScheme;\n            Globals.ThisAddIn.Application.ActivePresentation.ColorSchemes.Add(myScheme);\n\n            //????\n\n        }\n</code></pre>\n\n<p>it's adding color scheme to presentation and color schemes in design tab.\nWhen I choose other color scheme mine is disappearing from Design tab :( <br/>\nI need it to always be there. </p>\n"}, {"tags": ["excel", "vba", "ms-access", "recordset"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1439387009, "post_id": 31966763, "comment_id": 51841132, "body": "Are you getting the error when you are reading the fields from the recordset? tempString = CStr(rstAnswer!Program)"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439387247, "post_id": 31966763, "comment_id": 51841288, "body": "Have you tried Str(rstAnswer!BU)?"}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439387261, "post_id": 31966763, "comment_id": 51841303, "body": "yes, specifically on the lines which can possible generate (0/0) as a result. The first to do so is [Drawings Released by Need Date]"}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1439387465, "post_id": 31966763, "comment_id": 51841484, "body": "using Str(rstAnswer!BU) gives me a type mismatch error"}], "answers": [{"comments": [{"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439388565, "post_id": 31966981, "comment_id": 51842351, "body": "I&#39;ll give this a try. on the line (oAdoConnect.Open = Application.ActiveWorkbook.Path &amp; &quot;\\Inventory.mdb&quot;) What do I set the final part to, the &quot;Inventory.mdb&quot; string. The name of my access database?"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439388720, "post_id": 31966981, "comment_id": 51842486, "body": "@Dp  forget the example code for now if you don&#39;t understand it.  Simply replace your whole if statement and the code it include with <code>xlSheet.Range(&quot;BA1&quot;).CopyFromRecordset  rstAnswer </code> and see what happens."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 1, "last_activity_date": 1439386895, "creation_date": 1439386895, "answer_id": 31966981, "question_id": 31966763, "link": "https://stackoverflow.com/questions/31966763/access-vba-detect-if-recordset-entry-will-give-overflow/31966981#31966981", "title": "Access VBA. Detect if recordset entry will give overflow", "body": "<p>If you are not aware of using the method CopyFromRecordset  on the range object check it out.  If your recordset only contained the columns you wanted to dump into excel you could massively simplify your code.</p>\n\n<pre><code>eg xlSheet.Range(\"BA\"&amp;1).CopyFromRecordset  rstAnswer \n</code></pre>\n\n<p>Here some example code using an ADO recordset but DAO will work too!</p>\n\n<pre><code>'\n'Example of gathering data from an Access Application\n' into excel (but similar for other apps)\n'\nPrivate Sub cmdGather_Click()\n\n    'Define Variables\n    Dim xlApp As Object\n    Dim xlWorkbook As Object\n    Dim xlSheet As Object\n    Dim oAdoConnect As Object\n    Dim adoRecordset As ADODB.Recordset\n    Dim lngColumn  As Long\n    Dim strNewFile As String\n    Dim strFilePath As String\n    Dim strSQL As String\n\n    'Always have a way to handle errors\n    On Error GoTo Handler\n\n    'Establish your ADO connection\n    Set oAdoConnect = CreateObject(\"ADODB.Connection\")\n    oAdoConnect.Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    oAdoConnect.Open = Application.ActiveWorkbook.Path &amp; \"\\Inventory.mdb\"\n\n    'Create the SQL statement\n    strSQL = _\n        \"SELECT Customers.* \" &amp; _\n        \"FROM Customers \" &amp; _\n        \"WHERE (((Customers.ContactName) Like \"\"M*\"\"));\"\n\n    'Create and open your recordset\n    Set adoRecordset = CreateObject(\"ADODB.Recordset\")\n    adoRecordset.Open strSQL, oAdoConnect, adOpenStatic, adLockReadOnly\n\n    'Create your Excel spreadsheet\n    Set xlApp = Application\n    Set xlWorkbook = xlApp.Workbooks.Add\n\n    'Add the new Worksheet\n    With xlWorkbook\n\n        Set xlSheet = .Worksheets.Add\n        xlSheet.Name = \"Customers\"\n\n        ' Adds field names as column headers\n        For lngColumn = 0 To adoRecordset.Fields.Count - 1\n            xlSheet.Cells(1, lngColumn + 1).Value = adoRecordset.Fields(lngColumn).Name\n        Next\n\n        ' bold headers\n        xlSheet.Range(xlSheet.Cells(1, 1), xlSheet.Cells(1, adoRecordset.Fields.Count)).Font.Bold = True\n\n        ' dump the data from the query\n        xlSheet.Range(\"A2\").CopyFromRecordset adoRecordset\n\n    End With\n\n    'Close the RecordSet\n    adoRecordset.Close\n\n    'Cleanup variables\n    Set adoRecordset = Nothing\n    Set oAdoConnect = Nothing\n    Set xlSheet = Nothing\n    Set xlWorkbook = Nothing\n    Set xlApp = Nothing\n    Exit Sub\n\nHandler:\n    MsgBox _\n        \"An Error Occurred!\" &amp; vbNewLine &amp; vbNewLine &amp; _\n        \"Error Number: \" &amp; Err.Number &amp; vbNewLine &amp; vbNewLine &amp; _\n        \"Error Message: \" &amp; vbNewLine &amp; Err.Description &amp; vbNewLine &amp; vbNewLine &amp; _\n        \"Error Source: \" &amp; Err.Source, vbOKOnly, \"Error\"\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439387690, "post_id": 31967107, "comment_id": 51841649, "body": "This seems good, but still gives me an overflow error. Just trying to read the value apparently will cause an overflow. Also I don&#39;t think the value in the cell is literally &quot;0/0&quot;, but is first evaluated. I assume it has something like &quot;#DIV/0&quot; in it, but I don&#39;t know of any way to check."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439387833, "post_id": 31967107, "comment_id": 51841752, "body": "Maybe whatever is in the recordset doesn&#39;t need cast. Try changing the assignment inside the if statement.  tempString = rstAnswer.Fields(&quot;Drawings Released by Need Date&quot;).Value or tempString = str(rstAnswer.Fields(&quot;Drawings Released by Need Date&quot;).Value)"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439387933, "post_id": 31967107, "comment_id": 51841833, "body": "Also, you could try changing Dim tempString As Variant"}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439388191, "post_id": 31967107, "comment_id": 51842024, "body": "Thanks for the help Matt, but I tried getting rid of the Cstr() cast and using a variant, still giving the same error."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439388489, "post_id": 31967107, "comment_id": 51842266, "body": "We need to know what is in the &quot;Drawings Released by Need Date&quot; field of the DB. Are the null maybe?"}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439388653, "post_id": 31967107, "comment_id": 51842424, "body": "the &quot;Drawings Released by Need Date&quot; field is one line of an output from a query involving a division. I don&#39;t know how to access this value without getting the overflow error, so I don&#39;t know what it may contain."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439388766, "post_id": 31967107, "comment_id": 51842520, "body": "What will it do if you do a msgbox(rstAnswer.Fields(&quot;Drawings Released by Need Date&quot;).Value) right before the line tempString = CStr(rstAnswer![Drawings Released by Need Date])"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439389386, "post_id": 31967107, "comment_id": 51843063, "body": "What does your locals window show? Can you see what the recordset shows for that field as far as type?"}, {"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439390054, "post_id": 31967107, "comment_id": 51843591, "body": "Running MsgBox TypeName(rstAnswer![Drawings Released by Need Date]) gives me &quot;Field2&quot; as a type"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1439391425, "post_id": 31967107, "comment_id": 51844710, "body": "I don&#39;t know why it would make a difference but try declaring a field and set the that=thefield  Dim f As Field then do something like f.Value = rstAnswer![Drawings Released by Need Date] See if that takes it and then try to work with that."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1439387197, "creation_date": 1439387197, "answer_id": 31967107, "question_id": 31966763, "link": "https://stackoverflow.com/questions/31966763/access-vba-detect-if-recordset-entry-will-give-overflow/31967107#31967107", "title": "Access VBA. Detect if recordset entry will give overflow", "body": "<p>Check the value before you cast it.</p>\n\n<pre><code>If rstAnswer.Fields(\"Drawings Released by Need Date\").Value &lt;&gt; \"0/0\" Then\n    tempString = CStr(rstAnswer!Drawings Released by Need Date)\nElse\n    tempString = \"0%\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 31966981, "answer_count": 2, "score": 1, "last_activity_date": 1439387197, "creation_date": 1439386425, "question_id": 31966763, "link": "https://stackoverflow.com/questions/31966763/access-vba-detect-if-recordset-entry-will-give-overflow", "title": "Access VBA. Detect if recordset entry will give overflow", "body": "<p>I have the following code where I loop through a recordset generated by a query, and sometimes, a couple of the lines in the query will return (0/0). When looping through the recordset to write out to excel, if the line in the query did return (0/0), I receive an overflow error when trying to access it. I am trying to catch this overflow error, and assign the string \"0%\" to my variable, instead of the overflow value. Does anybody know a way to catch, and get around these overflow errors?</p>\n\n<pre><code>Set qdf = CurrentDb.CreateQueryDef(\"Latest Estimate\", sSQL)\n\n            Set dbs = CurrentDb\n            Set rstAnswer = dbs.OpenRecordset(\"Latest Estimate\")\n\n            If Not (rstAnswer.EOF And rstAnswer.BOF) Then\n                rstAnswer.MoveFirst\n                Do Until rstAnswer.EOF\n                    tempString = CStr(rstAnswer!BU)\n                    xlSheet.Range(\"BA\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer!Program)\n                    xlSheet.Range(\"BB\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![EIS Date])\n                    xlSheet.Range(\"BC\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![Part Count])\n                    xlSheet.Range(\"BD\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![Current Actual Cost Index])\n                    xlSheet.Range(\"BE\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![LTA Index ($)])\n                    xlSheet.Range(\"BF\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![LTA Index (part count)])\n                    xlSheet.Range(\"BG\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![LCB Index])\n                    xlSheet.Range(\"BH\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![Drawings Released by Need Date])\n                    xlSheet.Range(\"BI\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![Total Drawings released vs Needed])\n                    xlSheet.Range(\"BJ\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![% Of Parts With Suppliers Selected])\n                    xlSheet.Range(\"BK\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![% POs placed vs needed])\n                    xlSheet.Range(\"BL\" &amp; CStr(tempRow)).Value = tempString\n                    'tempString = CStr(rstAnswer![UPPAP Requirement])\n                    xlSheet.Range(\"BM\" &amp; CStr(tempRow)).Value = tempString\n                    tempString = CStr(rstAnswer![Number of parts identified for UPPAP])\n                    xlSheet.Range(\"BN\" &amp; CStr(tempRow)).Value = tempString\n                    rstAnswer.MoveNext\n                    tempRow = tempRow + 1\n                Loop\n\n            Else\n                MsgBox \"There are no records in this recordset\"\n            End If\n            programsAnswer.MoveNext\n        Loop\n</code></pre>\n\n<p>I've tried using GoTo's to catch the overflow error and assign the new value to my tempString variable but this did't work, and even if it did, the way I was implementing it would be cumbersome.</p>\n"}, {"tags": ["ms-access", "vba", "client-certificates", "wininet"], "owner": {"reputation": 51, "user_id": 5213147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3aa0b5b273a7b2a6284c521d9e5c0456?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan P", "link": "https://stackoverflow.com/users/5213147/bryan-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 983, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1439385970, "creation_date": 1439385970, "last_edit_date": 1495540678, "question_id": 31966601, "link": "https://stackoverflow.com/questions/31966601/using-vba-to-attach-a-client-certificate-to-a-wininet-httpsendrequest", "title": "Using VBA to attach a client certificate to a WinINet HTTPSendRequest", "body": "<p>(This is a more expansive discussion of the problem in <a href=\"https://stackoverflow.com/questions/31942165/identifying-correct-client-certificate-for-serverxmlhttp-setoption\">Identifying correct client certificate for ServerXMLHTTP.SetOption</a>, where I tried a workaround that ran into different problems.)</p>\n\n<p>I am attempting to restore a back-end web service capability in an MS Access database after the web server moved to certificate-based STS authentication.  I must use VBA.</p>\n\n<p>I have the sequence of web calls and expected header and cookie returns ready, but I am unable to attach the client certificate to the request handle successfully using either WinHTTP or WinINet.  (I need to use the functions and not the COM interface, because of the need to handle the returned server cookies.)</p>\n\n<p>Attempting to use InternetSetOption with the client certificate's context handle fails with a hard-dump to the desktop.  I think I've got the wrong size for the lpdwBufferLength parameter, but I am not sure.</p>\n\n<pre><code>' All API declares\nPrivate Declare Function InternetOpen Lib \"wininet.dll\" Alias \"InternetOpenA\" ( _\n    ByVal lpszAgent As String, _\n    ByVal dwAccessType As Long, _\n    ByVal lpszProxyName As String, _\n    ByVal lpszProxyBypass As String, _\n    ByVal dwFlags As Long) As Long\n\nPrivate Declare Function InternetConnect Lib \"wininet.dll\" Alias \"InternetConnectA\" ( _\n    ByVal hInternetSession As Long, _\n    ByVal lpszServerName As String, _\n    ByVal nServerPort As Integer, _\n    ByVal lpszUsername As String, _\n    ByVal lpszPassword As String, _\n    ByVal dwService As Long, _\n    ByVal dwFlags As Long, _\n    ByVal dwContext As Long) As Long\n\nPrivate Declare Function HttpOpenRequest Lib \"wininet.dll\" Alias \"HttpOpenRequestA\" ( _\n    ByVal hHttpSession As Long, _\n    ByVal lpszVerb As String, _\n    ByVal lpszObjectName As String, _\n    ByVal lpszVersion As String, _\n    ByVal lpszReferer As String, _\n    ByVal lpszAcceptTypes As String, _\n    ByVal dwFlags As Long, _\n    ByVal dwContext As Long) As Long\n\nPrivate Declare Function HttpSendRequest Lib \"wininet.dll\" Alias \"HttpSendRequestA\" ( _\n    ByVal hHttpRequest As Long, _\n    ByVal lpszHeaders As String, _\n    ByVal dwHeadersLength As Long, _\n    ByVal lpOptional As String, _\n    ByVal dwOptionalLength As Long) As Boolean\n\nPrivate Declare Function InternetSetOption Lib \"wininet.dll\" ( _\n    ByVal hInternet As IntPtr, ByVal dwOption As Integer, _\n    ByVal lpBuffer As IntPtr, ByVal lpdwBufferLength As Integer) As Boolean\n\nPrivate Declare Function CertOpenSystemStore Lib \"Crypt32.dll\" Alias \"CertOpenSystemStoreA\" (ByVal hCryptProv As Long, _\n    ByVal pvFindPara As String) As Long\n\nPrivate Declare Function CryptUIDlgSelectCertificateFromStore Lib \"cryptui.dll\" ( _\n    ByVal hCertStore as Long, ByVal hwnd as Long, byRef pwszTitle as String, _\n    ByRef pwszDisplayString as String, ByVal dwDontUseColumn as Long, _\n    ByVal dwFlags as Long, ByVal pvReserved as Any) as Long\n\nPrivate Declare Function CertFreeCertificateContext Lib \"crypt32.dll\" ( _\n    ByVal pCertContext as Long) as Long\n\nPrivate Declare Function CertCloseStore lib \"crypt32.dll\" ( _\n    ByVal hCertStore as Long, ByVal dwFlags as Long) as Long\n\n' All API constants ...\n' ....\nConst INTERNET_OPTION_CLIENT_CERT_CONTEXT = 84\nConst CRYPTUI_SELECT_LOCATION_COLUMN = 16\nConst ERROR_INTERNET_CLIENT_AUTH_CERT_NEEDED = 12044\nConst INTERNET_FLAG_SECURE = &amp;H800000\nConst INTERNET_FLAG_IGNORE_CERT_CN_INVALID = &amp;H1000\nConst INTERNET_SERVICE_HTTP = 3\nConst INTERNET_DEFAULT_HTTPS_PORT = 443\nConst INTERNET_OPEN_TYPE_PRECONFIG = 0\n\nPrivate Type CERT_CONTEXT\n    dwCertEncodingType as Long\n    pbCertEncoded as Long\n    cbCertEncoded as Long\n    pCertInfo as Long\n    hCertStore as Long\nEnd type\n\n\n' Test routine\n\nPrivate Sub TestHTTPCert(myURL as String)\n    Dim hISession as Long, hIConnect as Long, hRequest as Long, hCert as Long, hStore as Long\n    Dim myURLStart as String, myURLEnd as String\n    Dim lgRep as Long, myCERT_CONTEXT as CERT_CONTEXT\n    Dim lpszHeaders as String\n\n    ' Open the session using the WININET API\n    ' Should I be using an lpszAgent = \"Mozilla/5.0 (compatible)\" ??\n    hISession = InternetOpen(vbNullString, INTERNET_OPEN_TYPE_PRECONFIG, _\n                             vbNullString, vbNullString, 0)\n\n    if CBool(hISession) then\n\n        ' Separate the server and the destination\n        myURLStart = Replace(lcase(myURL),\"https://\",vbNullString)\n        myURLEnd = myURLStart\n        myURLStart = Left(myURLStart,InStr(1,myURLStart,\"/\")-1)\n        myURLEnd = Mid(myURLEnd,InStr(1,myURLEnd,\"/\")+1)\n\n        ' Begin the internet connection using WININET API\n        hIConnect = InternetConnect(hISession,myURLStart,INTERNET_DEFAULT_HTTPS_PORT, _\n                                    vbNullString,vbNullString,INTERNET_SERVICE_HTTP,0,0)\n\n        ' Begin the HTTP request using the WININET API\n        hRequest = HttpOpenRequest(hIConnect,\"GET\",myURLEnd,vbNullString,0, _\n                       INTERNET_FLAG_SECURE Or INTERNET_FLAG_IGNORE_CERT_CN_INVALID,0)\n\n        ' Set an additional header\n        lpszHeaders = \"Content-Type: application/x-www-form-urlencoded\" &amp; Chr(0)\n\n        ' Try sending the request, expecting a CERT_NEEDED error\n        HttpSendRequest hRequest, lpszHeaders, len(lpszHeaders), vbNullString, 0\n\n        ' Handle the expected CERT_NEEDED error\n        if Err.LastDLLError = ERROR_INTERNET_CLIENT_AUTH_CERT_NEEDED then\n\n            ' Open the certificate store\n            hStore = CertOpenSystemStore(0, \"MY\")\n\n            if Not IsNull(hStore) then\n                ' Use the CryptUI API to select the right certicate\n                hCert = CryptUIDlgSelectCertificateFromStore(hStore, 0&amp;, vbNullString, vbNullString, CRYPTUI_SELECT_LOCATION_COLUMN, 0, 0&amp;)\n\n                ' Attempt to attach the context to the hRequest handle\n                ' FAILS WITH APPLICATION DUMP TO DESKTOP\n                InternetSetOption hRequest, INTERNET_OPTION_CLIENT_CERT_CONTEXT, hCert, len(myCERT_CONTEXT)\n\n                CertFreeCertificateContext hCert\n                CertCloseStore hStore, 0\n\n                ' Retry the HttpSendRequest\n                HttpSendRequest hRequest, lpszHeaders, len(lpszHeaders), vbNullString, 0\n\n                ' Check the headers for expected returns and required cookies\n                ' .\n                ' .\n                ' .\n                ' Close all handles etc etc\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "video", "video-capture", "emgucv"], "comments": [{"owner": {"reputation": 812, "user_id": 3345749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pB6n0.jpg?s=128&g=1", "display_name": "Olivier A", "link": "https://stackoverflow.com/users/3345749/olivier-a"}, "edited": false, "score": 0, "creation_date": 1450347949, "post_id": 31966514, "comment_id": 56405744, "body": "In C#, I solve this problem by adding the opencv_ffmpeg300.dll If the dll is not here there is no error message and the number of frames is 0. But after adding the dll, I got my frames and can process them."}], "owner": {"reputation": 21, "user_id": 5218781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q0XZR.jpg?s=128&g=1", "display_name": "Borderline", "link": "https://stackoverflow.com/users/5218781/borderline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 565, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1439385767, "creation_date": 1439385767, "question_id": 31966514, "link": "https://stackoverflow.com/questions/31966514/analysing-frames-from-a-video-file-using-emgu-3-0-0-in-visual-basic-2013", "title": "Analysing frames from a video file using EMGU 3.0.0 in visual basic 2013", "body": "<p>I have been using EMGU 2.9.0 in the Visual basic environment to open a video file,  read the frames sequentially, analyse them and close the video.</p>\n\n<p>This was accomplished by:</p>\n\n<pre><code>Private Sub BW_SBD_DoWork(ByVal sender As System.Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles BW_SBD.DoWork\n    'Background Worker - Do Work Thread\n\n    Dim currentFrame As New Image(Of Gray, Byte)(FrameHeight, FrameWidh) 'Declare image objects to hold current and previous frame \n    Dim frameCount As Integer = 1\n    Dim numFrames As Integer  'number of frame for the video\n\n    For Each file As String In lstbSelectedVideoList.Items\n        ' For Each file As String In files - Loop through the list of files \n        Dim previousFrame As New Image(Of Gray, Byte)(FrameHeight, FrameWidh)\n\n        Using fingerprintCapture As New Capture(file)  ' Create a capture from file \n            numFrames = CType(Math.Round(fingerprintCapture.GetCaptureProperty(CAP_PROP.CV_CAP_PROP_FRAME_COUNT)), Integer)     ' Get video's total number of frames\n\n            frameCount = 1\n\n            fingerprintCapture.SetCaptureProperty(CAP_PROP.CV_CAP_PROP_POS_FRAMES, 0)                                   ' Jump to start frame\n            currentFrame = fingerprintCapture.QueryGrayFrame()                                                          ' get a frame\n\n            While fingerprintCapture.GetCaptureProperty(CAP_PROP.CV_CAP_PROP_POS_FRAMES) &lt; 0.0                          ' Make sure the start frame was found (codecs create problems with the set frame pos function)\n                currentFrame = fingerprintCapture.QueryGrayFrame()                                                      ' get a frame\n            End While\n\n            While currentFrame IsNot Nothing\n\n            'The analysis procedure requires the frames from the video\n                If MyFrameAnalysisFunction(currentFrame, previousFrame) = 1 Then\n                    MessageBox.Show('This part is irrelevant')\n                End If\n\n\n                previousFrame = currentFrame.Clone()               ' Update frame objects by saving previous frame and querying a new one\n                currentFrame = fingerprintCapture.QueryGrayFrame() ' get new frame\n\n                frameCount += 1\n            End While\n\n        End Using\n    Next\nEnd Sub\n</code></pre>\n\n<p>When updating the code to the newer version of Emgu 3.0.0, I have been struggling to get it to work again.  It seems that the new version has moved away from working with Image classes and prefer the Mat class.  </p>\n\n<p>The updated code compiles but the frames I try to retrieve stays NOTHING.  The adapted code is as follow:</p>\n\n<pre><code>    Private Sub BW_JSD_DoWork(sender As Object, e As System.ComponentModel.DoWorkEventArgs) Handles BW_JSD.DoWork\n    Dim CurrentFrameMAT As New Mat()\n\n    Dim frameCount As Integer = 1\n    Dim numFrames As Integer                                                 ' video identifier, percentage complete, and number of frame for the video\n\n    Dim filenr As Long = 0\n\n    For Each file As String In lstbAnalysisList.Items\n        Dim previousFrameMAT As New Mat()\n\n        filenr += 1\n\n        Using fingerprintCapture As New Capture(file)                                                                   ' Create a capture from file \n            numFrames = CType(Math.Round(fingerprintCapture.GetCaptureProperty(CapProp.FrameCount)), Integer)     ' Get video's total number of frames\n\n            frameCount = 1\n\n            fingerprintCapture.SetCaptureProperty(CapProp.PosFrames, 0)                                   ' Jump to start frame\n            CurrentFrameMAT = fingerprintCapture.QueryFrame()\n\n            While fingerprintCapture.GetCaptureProperty(CapProp.PosFrames) &lt; 0.0                          ' Make sure the start frame was found (codecs create problems with the set frame pos function)\n                CurrentFrameMAT = fingerprintCapture.QueryFrame()\n            End While\n\n            While CurrentFrameMAT IsNot Nothing                                                                            \n\n                If MyFrameAnalysisFunction(currentFrameMAT, previousFrameMAT) = 1 Then\n                    MessageBox.Show('This part is irrelevant')\n                End If\n\n                previousFrameMAT = CurrentFrameMAT.Clone()     ' Update frame objects by saving previous frame and querying a new one\n                CurrentFrameMAT = fingerprintCapture.QueryFrame()\n\n                frameCount += 1\n            End While\n\n        End Using\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>While debugging,  the CurrentFrameMAT stays nothing.</p>\n\n<p>Any advice on how to read the frames sequentially?</p>\n\n<p>I have seen a function called Grab() and retrieve pertaining to the capture object but could not get it to work.  Where would one start the process?</p>\n\n<pre><code>fingerprintCapture.Start()\nfingerprintCapture.Grab() 'Grab a frame\nfingerprintCapture.Retrieve() 'Gray image after Grab()\n</code></pre>\n\n<p>Any advice or a link to an implementation of the new Emgu version on video / webcam capture would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "module", "commandbutton"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1439384168, "post_id": 31965758, "comment_id": 51838788, "body": "Link to a <b>Module</b> or a <b>Sub</b> within a Module??"}, {"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1439384290, "post_id": 31965758, "comment_id": 51838901, "body": "link to a sub within a module @Gary&#39;sStudent"}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1439386026, "last_edit_date": 1439386026, "creation_date": 1439384268, "answer_id": 31965948, "question_id": 31965758, "link": "https://stackoverflow.com/questions/31965758/linking-activex-controls-command-button-to-a-module/31965948#31965948", "title": "linking activeX control&#39;s command button to a module", "body": "<p>It's simple.  When you add an active control to an excel sheet, you can then open the module for the worksheet and then add code for it there.</p>\n\n<p>Make sure you add an activeX button NOT a excel button as these are different things.</p>\n\n<p>You will need the \"developer tab\" on the ribbon showing (google \"add developer tab to excel ribbon\") to allow you to insert controls and access the VBA editor.</p>\n\n<p>You can right click  on the control button and choose \"view code\" - which will create the click event.  You can add code to call any existing macro.  eg <code>Call MyMacro1</code></p>\n\n<p>Note that in the module editor you can use the combo boxes at the top to select the control name and the type of event you want to add to create the event handler declaration code.  So you can add the code for all 10 buttons from here.</p>\n\n<p>Harvey</p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1439456053, "post_id": 31966024, "comment_id": 51872485, "body": "Thanks!  I have 1 question if you could answer me it would be great. is it possible to link the &quot;submit&quot; button in the picture above to a userform? is it the same as calling a subroutine? @JoshuaRoss"}, {"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "reply_to_user": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1439469792, "post_id": 31966024, "comment_id": 51881500, "body": "If you want to show a userform you can use the <code>UserForm.Show</code> method, I will update my answer to reflect this."}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 4, "last_activity_date": 1439469925, "last_edit_date": 1439469925, "creation_date": 1439384458, "answer_id": 31966024, "question_id": 31965758, "link": "https://stackoverflow.com/questions/31965758/linking-activex-controls-command-button-to-a-module/31966024#31966024", "title": "linking activeX control&#39;s command button to a module", "body": "<ol>\n<li>Open the VB Editor (<kbd>Alt</kbd>+<kbd>F11</kbd>)</li>\n<li>Under 'Microsoft Excel Objects' in the Project Explorer window, right click the sheet that the buttons appear on and select 'View Code'</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/03rCR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/03rCR.png\" alt=\"View Code\"></a></p>\n\n<ol start=\"3\">\n<li>In the upper left-hand drop down, select the appropriate command button</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/XdQG5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XdQG5.png\" alt=\"Command Button\"></a></p>\n\n<ol start=\"4\">\n<li><p>This will add the following code into the appropriate worksheet module</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n'Your on click actions go here\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>Which means now we can do actions (call our subroutine, for example)</p>\n\n<pre><code>    Private Sub CommandButton21_Click()\n        Call MyMacro\n    End Sub\n</code></pre>\n\n<p>Now, <code>MyMacro</code> can be present either in the worksheet level code that the <code>Click</code> event is in, or it can exist as a <code>Public Sub</code> somewhere in a module.</p>\n\n<h2>Update</h2>\n\n<p>To show a userform use the name of the userform with the <code>Show</code> method.  The default name is <code>UserForm1</code> (or <code>UserForm2</code> or <code>UserForm3</code> etc. depending on how many you add).</p>\n\n<p>If you want to show this userform on click you could use this code:</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n        UserForm1.Show\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9559, "favorite_count": 0, "accepted_answer_id": 31966024, "answer_count": 2, "score": 0, "last_activity_date": 1439469925, "creation_date": 1439383831, "question_id": 31965758, "link": "https://stackoverflow.com/questions/31965758/linking-activex-controls-command-button-to-a-module", "title": "linking activeX control&#39;s command button to a module", "body": "<p>okay so here is my question. Is it possible to call a module from an activeX Control command button on the Excel sheet?</p>\n\n<p>Here is the scenario: i have a sheet called Menu. On Menu, there is 10 activeX Control command buttons.I need the command button to call or linked it to a module. I haven't the slightest idea on how this could be achieved. Is it even possible? If so, how do i go about doing it? if not is there an alternative?</p>\n\n<p><a href=\"https://i.stack.imgur.com/MMlnZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MMlnZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you very much.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1439383852, "post_id": 31965607, "comment_id": 51838524, "body": "Do you only want to copy the value or the whole cell with formatting"}, {"owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1439384720, "post_id": 31965607, "comment_id": 51839242, "body": "i wanna save the first one a add the modified one at the buttom"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "edited": false, "score": 0, "creation_date": 1439388562, "post_id": 31965957, "comment_id": 51842348, "body": "I tried ur solution ..but it did just reimport the old column not the modified one ..But  the problem is that i just want to import the modified cells not all of them"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "edited": false, "score": 0, "creation_date": 1439389238, "post_id": 31965957, "comment_id": 51842920, "body": "so correct me if I am wrong, if c10, c30 and c12 changed then you want to copy only those 3 cells?"}, {"owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "edited": false, "score": 0, "creation_date": 1439408575, "post_id": 31965957, "comment_id": 51854820, "body": "exactly ..and i wanna add them at the buttom"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "edited": false, "score": 0, "creation_date": 1439443397, "post_id": 31965957, "comment_id": 51865716, "body": "In that case <a href=\"http://stackoverflow.com/questions/13860894/ms-excel-crashes-when-vba-code-runs/13861640#13861640\">this</a> will get you started..."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1439384288, "last_edit_date": 1495542118, "creation_date": 1439384288, "answer_id": 31965957, "question_id": 31965607, "link": "https://stackoverflow.com/questions/31965607/how-to-import-modified-cells-at-the-bottom-of-another-sheet/31965957#31965957", "title": "How to import modified cells at the bottom of another sheet", "body": "<p>Is this what you are trying? (<strong>Untested</strong>)</p>\n\n<p>I have commented the code so you shouldn't have a problem understanding it. Still if you do, simply ask :)</p>\n\n<pre><code>Public Sub Click()\n    Dim wsI As Worksheet, wsO As Worksheet\n    Dim lRowWsI As Long, lRowWsO As Long\n\n    '~~&gt; Set your output sheet\n    Set wsO = ThisWorkbook.Worksheets(\"PTR\")\n    '~~&gt; Find the last row where the data needs to go\n    lRowWsO = wsO.Range(\"B\" &amp; wsO.Rows.Count).End(xlUp).Row + 1\n\n    '~~&gt; Set Input Sheet\n    Set wsI = ThisWorkbook.Worksheets(\"Analyse\")\n\n    With wsI\n        '~~&gt; Find Last Row to get the range you want to copy\n        lRowWsI = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row\n        '~~&gt; Do the final Copy\n        .Range(\"C6:C\" &amp; lRowWsI).Copy Destination:=wsO.Range(\"B\" &amp; lRowWsO)\n    End With\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>To find the last row, you may want to see <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">THIS</a> post.</p>\n"}], "owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439884303, "creation_date": 1439383426, "last_edit_date": 1439884303, "question_id": 31965607, "link": "https://stackoverflow.com/questions/31965607/how-to-import-modified-cells-at-the-bottom-of-another-sheet", "title": "How to import modified cells at the bottom of another sheet", "body": "<p>I developed a macro that  imports a column from one sheet to another in the same Workbook. This works, but now what I want is that when I modify a cell in the first sheet, it doesn't crush it in the other sheet. Instead I would like it to add it to the bottom of the other sheet.</p>\n\n<pre><code>Public Sub Click()\n\n Sheets(\"PTR\").Range(\"B6\").Select\n lRow = Worksheets(\"Analyse\").Range(\"C6\").End(xlDown).Row\n Worksheets(\"Analyse\").Range(\"C6:C\" &amp; lRow).Copy Destination:=Sheets(\"PTR\").Range(\"B6:B\" &amp; lRow)\n Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 2, "creation_date": 1439384076, "post_id": 31965513, "comment_id": 51838709, "body": "For questions like this you should use the Macro Recorder, and then manually do the change you want. When you go back and review the recorded macro, it will show you all the terms you need to know, and if it doesn&#39;t make sense explicitly, you can search for those terms online."}, {"owner": {"reputation": 133, "user_id": 2355273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28c5bb5892f11cbe6897f37a0c3d2cb4?s=128&d=identicon&r=PG", "display_name": "jvh", "link": "https://stackoverflow.com/users/2355273/jvh"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439384353, "post_id": 31965513, "comment_id": 51838960, "body": "Right, totally forgot about that one.. My bad. Not used to having that &#39;tool&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 2355273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28c5bb5892f11cbe6897f37a0c3d2cb4?s=128&d=identicon&r=PG", "display_name": "jvh", "link": "https://stackoverflow.com/users/2355273/jvh"}, "edited": false, "score": 0, "creation_date": 1439383663, "post_id": 31965635, "comment_id": 51838352, "body": "Sorry if I didn&#39;t phrase it properly. I want them to be able to select locked cells, but not change the value of them. If you use the userinterface there is an option for this. What&#39;s the option for that when using VBA? I have WS.Protect UserInterfaceOnly:=True, AllowFormattingRows:=True right now:"}, {"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "reply_to_user": {"reputation": 133, "user_id": 2355273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28c5bb5892f11cbe6897f37a0c3d2cb4?s=128&d=identicon&r=PG", "display_name": "jvh", "link": "https://stackoverflow.com/users/2355273/jvh"}, "edited": false, "score": 0, "creation_date": 1439383801, "post_id": 31965635, "comment_id": 51838478, "body": "Not a problem, I added a second piece of code that might accomplish what you&#39;re asking.  I am testing on my machine right now."}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": false, "score": 1, "last_activity_date": 1439383738, "last_edit_date": 1439383738, "creation_date": 1439383484, "answer_id": 31965635, "question_id": 31965513, "link": "https://stackoverflow.com/questions/31965513/parameter-to-allow-users-to-select-locked-cells/31965635#31965635", "title": "Parameter to allow users to select locked cells?", "body": "<p>If you mean you that you want to keep certain cells unlocked when the worksheet is protected (so that users may select, edit, etc.) you can use:</p>\n\n<pre><code>Range(\"A1\").Locked = False\n</code></pre>\n\n<p>Where <code>A1</code> can be replaced with whichever range of cells you want to leave unlocked when the sheet is protected.</p>\n\n<p>Alternatively, you may be able to accomplish what you need by using:</p>\n\n<pre><code>Worksheets(\"Sheet1\").EnableSelection = xlNoRestrictions\n</code></pre>\n\n<p>And changing <code>Sheet1</code> to whichever worksheet you want users to be able to select on.</p>\n"}], "owner": {"reputation": 133, "user_id": 2355273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28c5bb5892f11cbe6897f37a0c3d2cb4?s=128&d=identicon&r=PG", "display_name": "jvh", "link": "https://stackoverflow.com/users/2355273/jvh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2553, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1527177603, "creation_date": 1439383185, "last_edit_date": 1531164843, "question_id": 31965513, "link": "https://stackoverflow.com/questions/31965513/parameter-to-allow-users-to-select-locked-cells", "title": "Parameter to allow users to select locked cells?", "body": "<p>What's the parameter to allow users to select locked cells? When you manually protect a worksheet there is an option for this, but I can't find it for VBA.</p>\n\n<p>Sorry if this question has been asked but I can't find it with so many overlapping words with other results.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439382129, "post_id": 31964512, "comment_id": 51837138, "body": "What does this question even mean? All I see is a block of timestamps, which were apperently created multiple times a second. Do you just want to figure out how to remove time stamps that are from the same minute? What generates these timestamps? Is there other data associated with each row?"}, {"owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439382406, "post_id": 31964512, "comment_id": 51837340, "body": "I have updated the data and i want it that it views just per minute as its currently viewing data several times a second"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439382549, "post_id": 31964512, "comment_id": 51837429, "body": "What do you mean by &quot;views just per minute&quot;? We still don&#39;t know where your data is coming from, how can we help?"}, {"owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439382748, "post_id": 31964512, "comment_id": 51837588, "body": "The data is from a generator and it records different values(fan speed voltage etc.) 9 times a second and as the data is really large i want that that it just shows what were the values at every minute interval instead of every second"}], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 0, "last_activity_date": 1439383800, "creation_date": 1439383800, "answer_id": 31965745, "question_id": 31964512, "link": "https://stackoverflow.com/questions/31964512/view-per-minute-data-instead-of-per-second/31965745#31965745", "title": "View per minute data instead of per second", "body": "<p>I'll assume you don't want to / can't change how the number generator actually works. I'll further assume that you dump this data into Excel manually [if you do this automatically through the number generator, this can't be solved without solving at the source number generator]. Therefore, I recommend you have 1 data dump tab, and one review tab.</p>\n\n<p>I further assume for reference that your source tab is called sheet1, and has data in the following columns: </p>\n\n<p>A:A = Date [I assume that this is only run for a single day, and that each day a new Excel file will be created]\nB:B = Time\nC:C = All other data [if data is in different columns here, adjust the answer below to reflect that]</p>\n\n<p>On your review tab, in A1 simply put the following. Copy down as needed.</p>\n\n<pre><code>=Sheet1!A1\n</code></pre>\n\n<p>On B1, put the following:</p>\n\n<pre><code>=MIN(Sheet1!B:B)\n</code></pre>\n\n<p>This will pull the lowest timestamp found in Sheet1. Then, on B2 and copied down, put the following:</p>\n\n<pre><code>=VLOOKUP(B1+0.001,Sheet1!B:B,1,1)\n</code></pre>\n\n<p>This looks for the time found in the cell above, adding a single minute. If it doesn't find it exactly (matched to the second), it takes the closest appropriate match as your data is sorted.</p>\n\n<p>Put this in C1 and copied down (if your data is also in columns D, E, etc., just copy this formula replacing reference to column C with D, etc - should be able to just copy to the right)</p>\n\n<pre><code>=INDEX(Sheet1!C:C,MATCH($B1,Sheet1!$B:$B,0))\n</code></pre>\n\n<p>This looks for an exact match of the timestamp produced in column B on your new sheet. Then it pulls that data with INDEX onto your new sheet.</p>\n"}], "owner": {"reputation": 51, "user_id": 4819972, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c8d00191b3a6139b3c7fc488807f4dc4?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Mehra", "link": "https://stackoverflow.com/users/4819972/harshit-mehra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 31965745, "answer_count": 1, "score": -1, "last_activity_date": 1439383800, "creation_date": 1439380541, "last_edit_date": 1531161705, "question_id": 31964512, "link": "https://stackoverflow.com/questions/31964512/view-per-minute-data-instead-of-per-second", "title": "View per minute data instead of per second", "body": "<p>I have a excel file that shows data for every second interval. I would like to get the data for every minute interval . I dont want average but  a way that it shows data just for every minute eg.(22:06:25 22:07:25 22:06:25 22:08:25 22:06:25 ).</p>\n\n<p>My current data is like this.</p>\n\n<pre><code>08.08.2015 22:06:25 114507783   1000000 49087   612\n08.08.2015 22:06:25 114507892   1000000 49087   612\n08.08.2015 22:06:25 114508002   1000000 49087   612\n08.08.2015 22:06:25 114508111   1000000 49087   612\n08.08.2015 22:06:25 114508220   1000000 49087   612\n08.08.2015 22:06:25 114508329   1000000 49087   612\n08.08.2015 22:06:25 114508438   1000000 49087   612\n08.08.2015 22:06:25 114508548   1000000 49087   612\n08.08.2015 22:06:25 114508657   1000000 49087   612\n08.08.2015 22:06:26 114508766   1000000 49087   612\n08.08.2015 22:06:26 114508875   1000000 49087   612\n08.08.2015 22:06:26 114508984   1000000 49087   612\n08.08.2015 22:06:26 114509094   1000000 49087   612\n08.08.2015 22:06:26 114509203   1000000 49087   612\n08.08.2015 22:06:26 114509312   1000000 49087   612\n08.08.2015 22:06:26 114509421   1000000 49087   612\n08.08.2015 22:06:26 114509530   1000000 49087   612\n08.08.2015 22:06:26 114509640   1000000 49087   612\n08.08.2015 22:06:27 114509749   1000000 49087   612\n08.08.2015 22:06:27 114509858   1000000 49087   612\n08.08.2015 22:06:27 114509967   1000000 49087   612\n08.08.2015 22:06:27 114510076   1000000 49087   612\n08.08.2015 22:06:27 114510186   1000000 49087   612\n08.08.2015 22:06:27 114510295   1000000 49087   612\n</code></pre>\n\n<p>any help would be highly appreciated.</p>\n"}, {"tags": ["vba", "internet-explorer", "automation"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439380566, "post_id": 31964442, "comment_id": 51836058, "body": "to me it sounds like you are not permitted to access the IEdocument with the click event"}, {"owner": {"reputation": 71, "user_id": 4280876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209209431ae2fd73c9f5598afea84ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Avishek Pandey", "link": "https://stackoverflow.com/users/4280876/avishek-pandey"}, "reply_to_user": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439380861, "post_id": 31964442, "comment_id": 51836268, "body": "What to do for this then?"}, {"owner": {"reputation": 71, "user_id": 4280876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209209431ae2fd73c9f5598afea84ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Avishek Pandey", "link": "https://stackoverflow.com/users/4280876/avishek-pandey"}, "reply_to_user": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439380882, "post_id": 31964442, "comment_id": 51836285, "body": "But at the first time it is doing that."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439381613, "post_id": 31964442, "comment_id": 51836736, "body": "I don&#39;t know the properties of the tagx object. But if you say it&#39;s doing it on the first time, only one element is locked or not permitted. Could you identify which <code>tagx</code> object throws the error?"}, {"owner": {"reputation": 71, "user_id": 4280876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209209431ae2fd73c9f5598afea84ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Avishek Pandey", "link": "https://stackoverflow.com/users/4280876/avishek-pandey"}, "reply_to_user": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439381689, "post_id": 31964442, "comment_id": 51836793, "body": "For Each tagx In tags         If tagx.alt = &quot;Search Request&quot; Then             tagx.Click         End If"}, {"owner": {"reputation": 71, "user_id": 4280876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209209431ae2fd73c9f5598afea84ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Avishek Pandey", "link": "https://stackoverflow.com/users/4280876/avishek-pandey"}, "reply_to_user": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439381728, "post_id": 31964442, "comment_id": 51836825, "body": "Set tags = IE.document.getElementsByTagName(&quot;img&quot;)"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439381798, "post_id": 31964442, "comment_id": 51836880, "body": "Does your for each loop throws an error already at the first time or later?"}, {"owner": {"reputation": 71, "user_id": 4280876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209209431ae2fd73c9f5598afea84ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Avishek Pandey", "link": "https://stackoverflow.com/users/4280876/avishek-pandey"}, "reply_to_user": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439382427, "post_id": 31964442, "comment_id": 51837355, "body": "loop throws permission denied error after the first time"}], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 0, "last_activity_date": 1439385879, "last_edit_date": 1439385879, "creation_date": 1439385338, "answer_id": 31966364, "question_id": 31964442, "link": "https://stackoverflow.com/questions/31964442/runtime-error-70-permission-denied/31966364#31966364", "title": "Runtime error 70: Permission Denied", "body": "<p>I think the probably reason is the following:</p>\n\n<p>At some point of your code you obtain the collection containing all elements with <code>img</code> tag name.</p>\n\n<p>Later on the code goes into a loop. In every iteration of this loop one of this tag is clicked:</p>\n\n<pre><code>tagx.Click\n</code></pre>\n\n<p>I suppose this fires some JS script and some changes are made in the HTML structure. This causes the collection obtained before is not longer usable and it should be obtained from scratch.</p>\n\n<p>So if you move this part of code:</p>\n\n<pre><code>Set tags = IE.document.getElementsByTagName(\"img\")\n</code></pre>\n\n<p>into this loop, it should work.</p>\n\n<hr>\n\n<p>Here is your code with this modification:</p>\n\n<pre><code>Sub reconwebscrap() ' ' reconwebscrap Macro ' ' Keyboard Shortcut: Ctrl+Shift+R\n    Dim requestsearchrange As Range\n    Dim cell1 As Range\n    Dim cell2 As Range\n    Dim entire As Range\n    Dim IE As Object\n    Dim revocdate As String\n    Dim i As Integer\n    Dim tags As Object\n    Dim tagx As Object\n    Dim tags2 As Object\n    Dim tagsx As Object\n\n    Application.DisplayStatusBar = True\n\n    i = 0\n\n    With ActiveWorkbook.Sheets(2)\n        Set requestsearchrange = .Range(.Range(\"B2\"), .Range(\"B2\").End(xlDown))\n    End With\n\n    ActiveWorkbook.Worksheets.Add\n\n    With ActiveWorkbook.Sheets(3)\n        Set entire = .Range(.Range(\"A1\"), .Range(\"A65536\").End(xlUp))\n    End With\nthe_start:\n\n    Set IE = New InternetExplorerMedium\n\n    'Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    '-----------------------------------------------------------------------------------------------------------------\n    'These attributes decide the position of internet explorer window.\n    '-----------------------------------------------------------------------------------------------------------------\n\n    IE.Top = 0\n    IE.Left = 0\n    IE.Width = 800\n    IE.Height = 600\n\n    '-----------------------------------------------------------------------------------------------------------------\n    'Disable the viewing of Internet Explorer window.\n    '-----------------------------------------------------------------------------------------------------------------\n\n    IE.Visible = True\n\n    '-----------------------------------------------------------------------------------------------------------------\n    'Navigate to the website.\n    '-----------------------------------------------------------------------------------------------------------------\n\n    IE.Navigate (\"https://ibid.abc.com/RMT/MyDashboard\")\n\n    '-----------------------------------------------------------------------------------------------------------------\n    'Let the website load completely.\n    'Error handling in case the website is not available.\n    '-----------------------------------------------------------------------------------------------------------------\n    Do Until Not IE.Busy\n        DoEvents\n        Application.StatusBar = \" Running\"\n    Loop\n\n    'Do\n        'DoEvents\n            'If Err.Number &lt;&gt; 0 Then\n                'IE.Quit\n                'Set IE = Nothing\n                'GoTo the_start:\n            'End If\n    'Loop Until IE.readystate = 4\n\n    MsgBox \"webpage has loaded\"\n\n    revocdate = InputBox(\"enter the last revocation date\")\n\n\n    'Set tags2 = IE.document.getElementById(\"dashboardSelect\")\n\n    For Each cell1 In requestsearchrange\n        IE.document.getElementById(\"dashboardSelect\").Value = \"recipientSid\"\n        IE.document.getElementById(\"quickSearchCriteriaVar\").Value = cell1.Value\n\n        Set tags = IE.document.getElementsByTagName(\"img\")\n\n        For Each tagx In tags\n            If tagx.alt = \"Search Request\" Then\n                tagx.Click\n            End If\n        Next tagx\n\n        Do Until Not IE.Busy\n            DoEvents\n        Loop\n\n        i = i + 1\n        Application.StatusBar = i &amp; \" Running\"\n\n    Next cell1\n\n    Application.StatusBar = \"\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4280876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/209209431ae2fd73c9f5598afea84ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Avishek Pandey", "link": "https://stackoverflow.com/users/4280876/avishek-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2008, "favorite_count": 0, "accepted_answer_id": 31966364, "answer_count": 1, "score": 0, "last_activity_date": 1440391219, "creation_date": 1439380323, "last_edit_date": 1440391219, "question_id": 31964442, "link": "https://stackoverflow.com/questions/31964442/runtime-error-70-permission-denied", "title": "Runtime error 70: Permission Denied", "body": "<p>I am getting an error saying </p>\n\n<blockquote>\n  <p>\"Runtime error 70: Permission Denied\" </p>\n</blockquote>\n\n<p>Below is code in which I am getting this error.</p>\n\n<pre><code>Sub reconwebscrap() ' ' reconwebscrap Macro ' ' Keyboard Shortcut: Ctrl+Shift+R\n    Dim requestsearchrange As Range\n    Dim cell1 As Range\n    Dim cell2 As Range\n    Dim entire As Range\n    Dim IE As Object\n    Dim revocdate As String\n    Dim i As Integer\n    Dim tags As Object\n    Dim tagx As Object\n    Dim tags2 As Object\n    Dim tagsx As Object\n\n    Application.DisplayStatusBar = True\n\n    i = 0\n\n    With ActiveWorkbook.Sheets(2)\n        Set requestsearchrange = .Range(.Range(\"B2\"), .Range(\"B2\").End(xlDown))\n    End With\n\n    ActiveWorkbook.Worksheets.Add\n\n    With ActiveWorkbook.Sheets(3)\n        Set entire = .Range(.Range(\"A1\"), .Range(\"A65536\").End(xlUp))\n    End With\nthe_start:\n\n    Set IE = New InternetExplorerMedium\n\n    'Set IE = CreateObject(\"InternetExplorer.Application\")\n    '-----------------------------------------------------------------------------------------------------------------\n    'These attributes decide the position of internet explorer window.\n    '-----------------------------------------------------------------------------------------------------------------\n\n    IE.Top = 0\n    IE.Left = 0\n    IE.Width = 800\n    IE.Height = 600\n\n    '-----------------------------------------------------------------------------------------------------------------\n    'Disable the viewing of Internet Explorer window.\n    '-----------------------------------------------------------------------------------------------------------------\n\n    IE.Visible = True\n\n    '-----------------------------------------------------------------------------------------------------------------\n    'Navigate to the website.\n    '-----------------------------------------------------------------------------------------------------------------\n\n    IE.Navigate (\"https://ibid.abc.com/RMT/MyDashboard\")\n\n    '-----------------------------------------------------------------------------------------------------------------\n    'Let the website load completely.\n    'Error handling in case the website is not available.\n    '-----------------------------------------------------------------------------------------------------------------\n    Do Until Not IE.Busy\n        DoEvents\n        Application.StatusBar = \" Running\"\n    Loop\n\n    'Do\n        'DoEvents\n            'If Err.Number &lt;&gt; 0 Then\n                'IE.Quit\n                'Set IE = Nothing\n                'GoTo the_start:\n            'End If\n    'Loop Until IE.readystate = 4\n\n    MsgBox \"webpage has loaded\"\n\n    revocdate = InputBox(\"enter the last revocation date\")\n\n    Set tags = IE.document.getElementsByTagName(\"img\")\n    'Set tags2 = IE.document.getElementById(\"dashboardSelect\")\n\n    For Each cell1 In requestsearchrange\n        IE.document.getElementById(\"dashboardSelect\").Value = \"recipientSid\"\n        IE.document.getElementById(\"quickSearchCriteriaVar\").Value = cell1.Value\n        For Each tagx In tags\n            If tagx.alt = \"Search Request\" Then\n                tagx.Click\n            End If\n        Next tagx\n\n        Do Until Not IE.Busy\n            DoEvents\n        Loop\n\n        i = i + 1\n        Application.StatusBar = i &amp; \" Running\"\n\n    Next cell1\n\n    Application.StatusBar = \"\"\nEnd Sub\n</code></pre>\n\n<p>I am getting this error in</p>\n\n<pre><code>For Each tagx In tags\n    If tagx.alt = \"Search Request\" Then\n        tagx.Click\n    End If\nNext tagx\n</code></pre>\n\n<p>In this code I am trying to enter a number in the search box and then click on the button. Then wait for it to load and then enter the next number. But it is doing it for only first cell in excel sheet. After that I am getting this error.</p>\n"}, {"tags": ["excel", "vba", "curve-fitting"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1439381294, "post_id": 31964202, "comment_id": 51836527, "body": "Consider using <b>Solver</b> to drive the difference between the data line and a model line to a minimum."}, {"owner": {"reputation": 103, "user_id": 5157154, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/VsVeg.jpg?s=128&g=1", "display_name": "Frannzz", "link": "https://stackoverflow.com/users/5157154/frannzz"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1439398644, "post_id": 31964202, "comment_id": 51849412, "body": "interesting, i will try this way and update here if i manage to do it or if i fail"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5157154, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/VsVeg.jpg?s=128&g=1", "display_name": "Frannzz", "link": "https://stackoverflow.com/users/5157154/frannzz"}, "edited": false, "score": 0, "creation_date": 1439398546, "post_id": 31966186, "comment_id": 51849366, "body": "I didn&#39;t knw what solver is just five minutes ago, so yes maybe it makes sense, but i need to experiment a bit with it ;)"}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 1, "last_activity_date": 1439384835, "creation_date": 1439384835, "answer_id": 31966186, "question_id": 31964202, "link": "https://stackoverflow.com/questions/31964202/vba-excel-fitting-curve-with-freely-chosen-function/31966186#31966186", "title": "VBA EXCEL Fitting Curve with freely chosen function", "body": "<p>I did something to similar to this a while ago. The approach I took was to use the solver (as gary's student suggests). I think it was fired from VBA but that's unimportant. </p>\n\n<p>Basically you'd have two input cells per row of data with your variables K and C. Then you need to find the difference (errors) between the values the function produces with the values in the input cells compared to the actual values (I think using errors^2 gives quicker conversion). You then sum the differences in another cell. When running the solver, you ask it to minimise the sum of differences by changing K and C.</p>\n\n<p>Does that makes sense...?</p>\n"}], "owner": {"reputation": 103, "user_id": 5157154, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/VsVeg.jpg?s=128&g=1", "display_name": "Frannzz", "link": "https://stackoverflow.com/users/5157154/frannzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2186, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524256222, "creation_date": 1439379671, "last_edit_date": 1524256222, "question_id": 31964202, "link": "https://stackoverflow.com/questions/31964202/vba-excel-fitting-curve-with-freely-chosen-function", "title": "VBA EXCEL Fitting Curve with freely chosen function", "body": "<p>As start situation, I have an xy-chart with some values on it whose progression resemble an exponential function. I need to write a code that draws a fitting curve on the chart, but I have to use a particular function which is not exponential (because I need to get some coefficients from it). </p>\n\n<p>One of the functions i need to use is K(C-x)\u00b2/(1+x) whereby k and C are the parameters I need.(They are two and it makes it a lot more complicated) Obviously you can't find this kind of structure on the fitting curve tool in Excel. Is there any possibility to have a fitting curve to a chart where you can write yourself the structure of the function? </p>\n\n<p>Sorry if I don't add any written code, but i just need a hint to start writing. \nThank you</p>\n\n<p><a href=\"https://i.stack.imgur.com/8lQtz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8lQtz.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "sql-server", "vba", "outlook"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1439384336, "post_id": 31963771, "comment_id": 51838941, "body": "the  error/issue is? You&#39;re not giving us much to go on."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1439396076, "post_id": 31963771, "comment_id": 51847907, "body": "You&#39;ve said an Outlook macro, but the code starts with <code>Workbook_Open</code> which is Excel.  Should the procedure be called <code>Application_Startup</code> if it&#39;s in Outlook?"}, {"owner": {"reputation": 59, "user_id": 3202060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf19bfbd68fbddc9b569840529876b9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan M.", "link": "https://stackoverflow.com/users/3202060/juan-m"}, "edited": false, "score": 0, "creation_date": 1439399040, "post_id": 31963771, "comment_id": 51849610, "body": "I&#39;ve changed that but it doesn&#39;t work either...  Could it be because the way I connect to the database should be different?"}], "answers": [{"tags": [], "owner": {"reputation": 1315, "user_id": 4874271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KZm2c.png?s=128&g=1", "display_name": "CodePhobia", "link": "https://stackoverflow.com/users/4874271/codephobia"}, "is_accepted": false, "score": 8, "last_activity_date": 1439379901, "creation_date": 1439379901, "answer_id": 31964279, "question_id": 31963771, "link": "https://stackoverflow.com/questions/31963771/connect-to-a-sql-server-database-with-outlook/31964279#31964279", "title": "Connect to a SQL Server database with Outlook", "body": "<p>On eye-test I am not able to figure out whats wrong, I think it has to do something with the way you are doing the ADO operations.  </p>\n\n<p>But I am just putting up the last macro I wrote to connect to SQL-Server from Macro. Hope it helps. </p>\n\n<pre><code>Private Sub Workbook_Open()\nOn Error GoTo ErrorHandler\n    '**************************************Initialize Variables**************************************\n    sServer = \"&lt;SQL SERVER Server&gt;\"\n    sDBName = \"&lt;SQL SERVER DB&gt;\"\n\n    '**************************************Open Connection**************************************\n    'adodb connection to other database\n    stg_cn.Open \"Provider=SQLOLEDB;Data Source=\" &amp; sServer &amp; _\n                  \";Initial Catalog=\" &amp; sDBName &amp; _\n                  \";Integrated Security=SSPI;\"\n\n    sQuery = \"SELECT * \" &amp; _\n             \"FROM Table \"\n\n    'set reference to query\n    Set cmd = New ADODB.Command\n        cmd.ActiveConnection = stg_cn\n        cmd.CommandType = adCmdText\n        cmd.CommandText = sQuery\n    Set rs = cmd.Execute\n    Do While Not rs.EOF\n        For i = 0 To rs.Fields.Count - 1\n            &lt;PERFORM OPERATIONS&gt;\n        Next\n        rs.MoveNext\n    Loop\n\nExitHere:\n    If Not stg_cn Is Nothing Then stg_cn.Close\n    Set rs = Nothing\n    Set stg_cn = Nothing\n    Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 3202060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf19bfbd68fbddc9b569840529876b9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan M.", "link": "https://stackoverflow.com/users/3202060/juan-m"}, "edited": false, "score": 0, "creation_date": 1439392545, "post_id": 31965483, "comment_id": 51845466, "body": "...The database cannot be reached... I&#39;m pretty sure the IP, table, username and password are correct. &lt;code&gt; Conn.connectionString = &quot;Provider = sqloledb;&quot; &amp; _ &quot;Data Source = hugeDB;&quot; &amp; _ &quot;Integrated Security=SSPI;&quot; &amp; _ &quot;User ID = hdbmread;&quot; &amp; _ &quot;Password = hdbmreadonly;&quot; Conn.Open Set Rst.ActiveConnection = Conn Rst.Open &quot;select COUNT(*) from Nav n&quot; &amp; _ &quot;group by n.Nav_Date&quot; rs.Close Set rs = Nothing CN.Close Set CN = Nothing End Sub &lt;code&gt;"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 59, "user_id": 3202060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf19bfbd68fbddc9b569840529876b9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan M.", "link": "https://stackoverflow.com/users/3202060/juan-m"}, "edited": false, "score": 0, "creation_date": 1439392956, "post_id": 31965483, "comment_id": 51845774, "body": "Have you included <code>&quot;Initial Catalog = myCatalog;&quot; &amp; _</code> in your connection string? This is the catalog within the database you want to connect to."}, {"owner": {"reputation": 59, "user_id": 3202060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf19bfbd68fbddc9b569840529876b9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan M.", "link": "https://stackoverflow.com/users/3202060/juan-m"}, "edited": false, "score": 0, "creation_date": 1439394396, "post_id": 31965483, "comment_id": 51846828, "body": "Conn.connectionString = &quot;Provider = sqloledb;&quot; &amp; _                         &quot;Data Source = 192.168.100.100;&quot; &amp; _                         &quot;Initial Catalog=&quot; &amp; hugeDB &amp; _                         &quot;Integrated Security=SSPI;&quot; &amp; _                         &quot;User ID = hdbmread;&quot; &amp; _                         &quot;Password = hdbmreadread;&quot;  Still the same issue. It cannot connect from Outlook, but I can do it through Microsoft SQL Server Management Studio, therefore is not a problem with permissions... I&#39;m blocked here and it should be easy."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 59, "user_id": 3202060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf19bfbd68fbddc9b569840529876b9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan M.", "link": "https://stackoverflow.com/users/3202060/juan-m"}, "edited": false, "score": 0, "creation_date": 1439400663, "post_id": 31965483, "comment_id": 51850520, "body": "The <code>Data Source</code> should be the server name; is your server name an IP address?"}, {"owner": {"reputation": 59, "user_id": 3202060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf19bfbd68fbddc9b569840529876b9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan M.", "link": "https://stackoverflow.com/users/3202060/juan-m"}, "edited": false, "score": 0, "creation_date": 1439454396, "post_id": 31965483, "comment_id": 51871442, "body": "In my macro I have the server name. Here I&#39;ve added the IP but just because I didn&#39;t want to use the same internal names we use in the company. But yes, I&#39;m using the server name."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 59, "user_id": 3202060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf19bfbd68fbddc9b569840529876b9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan M.", "link": "https://stackoverflow.com/users/3202060/juan-m"}, "edited": false, "score": 0, "creation_date": 1439454473, "post_id": 31965483, "comment_id": 51871497, "body": "Got you. Fair enough, well providing all of the details are correct, that should connect you to the server. Without seeing the actual details and knowing the server you&#39;re trying to connect to, I&#39;m afraid there&#39;s not much else I can advise."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 1, "last_activity_date": 1439383115, "creation_date": 1439383115, "answer_id": 31965483, "question_id": 31963771, "link": "https://stackoverflow.com/questions/31963771/connect-to-a-sql-server-database-with-outlook/31965483#31965483", "title": "Connect to a SQL Server database with Outlook", "body": "<p>The connection string @CodePhobia has provided should work for you.</p>\n\n<p>The below just includes User ID and Password functionality, as your original question showed trying to connect using this.</p>\n\n<pre><code>Dim rsConn as ADODB.Connection\nSet rsConn = New ADODB.Connection\nWith rsConn\n    .ConnectionString = \"Provider = sqloledb;\" &amp; _\n                        \"Data Source = myServerName;\" &amp; _\n                        \"Initial Catalog = myCatalog;\" &amp; _\n                        \"Integrated Security=SSPI;\" &amp; _\n                        \"User ID = myUserID;\" &amp; _\n                        \"Password = myPassword;\"\n    .Open\nEnd With\n</code></pre>\n\n<p>You can use <a href=\"https://www.connectionstrings.com/sql-server/\" rel=\"nofollow\">this website</a> to find connection strings in the future. It should cover all possible connections you wish to establish.</p>\n"}], "owner": {"reputation": 59, "user_id": 3202060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf19bfbd68fbddc9b569840529876b9?s=128&d=identicon&r=PG&f=1", "display_name": "Juan M.", "link": "https://stackoverflow.com/users/3202060/juan-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7018, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1592900533, "creation_date": 1439378517, "last_edit_date": 1592900533, "question_id": 31963771, "link": "https://stackoverflow.com/questions/31963771/connect-to-a-sql-server-database-with-outlook", "title": "Connect to a SQL Server database with Outlook", "body": "<p>I want to connect to a MS SQL Server database using an Outlook macro. But I don't know if the code is wrong or I need to add a library/driver or what happens here but it doesn't work.</p>\n\n<pre><code>Private Sub Application_Startup()\nOn Error GoTo ExitHere\n    'adodb connection to other database\n    stg_cn.Open \"Provider = SQLOLEDB;\" &amp; _\n                        \"Data Source = 192.168.100.100;\" &amp; _\n                        \"Initial Catalog = hugeDB;\" &amp; _\n                        \"Integrated Security=SSPI;\" &amp; _\n                        \"User ID = oneuser;\" &amp; _\n                        \"Password = onepassword;\"\n\n    sQuery = \"SELECT * FROM documents where location = 'IE'\"\n\n    'set reference to query\n    Set cmd = New ADODB.Command\n        cmd.ActiveConnection = stg_cn\n        cmd.CommandType = adCmdText\n        cmd.CommandText = sQuery\n    Set rs = cmd.Execute\n    Do While Not rs.EOF\n        For i = 0 To rs.Fields.count - 1\n            MsgBox (i + 1)\n        Next\n        rs.MoveNext\n    Loop\nExitHere:\n    If Not stg_cn Is Nothing Then stg_cn.Close\n    Set rs = Nothing\n    Set stg_cn = Nothing\n    Exit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4444478"}, "edited": false, "score": 0, "creation_date": 1439997146, "post_id": 31963760, "comment_id": 52093255, "body": "Any other information that might help me achieve this?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4444478"}, "edited": false, "score": 0, "creation_date": 1439379604, "post_id": 31963980, "comment_id": 51835401, "body": "Yup, I have apparently got that ticked in the list, but I still get an error returned when using the Process type, any ideas?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4444478"}, "edited": false, "score": 0, "creation_date": 1439384028, "post_id": 31963980, "comment_id": 51838668, "body": "Compile error: User-defined type not defined  It highlights the following: Dim proc() As Process"}, {"owner": {"reputation": 925, "user_id": 5197739, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0eb1950fceec1477ac6713029546eab9?s=128&d=identicon&r=PG&f=1", "display_name": "JamTay317", "link": "https://stackoverflow.com/users/5197739/jamtay317"}, "edited": false, "score": 0, "creation_date": 1439385850, "post_id": 31963980, "comment_id": 51840161, "body": "did you check and make sure it is in the object browser?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4444478"}, "edited": false, "score": 0, "creation_date": 1439387526, "post_id": 31963980, "comment_id": 51841531, "body": "It&#39;s not in the object browser, thank you for pointing me to this view, I wasn&#39;t aware of it in vba excel. I can select the system reference but the process type isn&#39;t listed. I need to get system.diagnostics referenced. This is very confusing! :("}, {"owner": {"reputation": 925, "user_id": 5197739, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0eb1950fceec1477ac6713029546eab9?s=128&d=identicon&r=PG&f=1", "display_name": "JamTay317", "link": "https://stackoverflow.com/users/5197739/jamtay317"}, "edited": false, "score": 0, "creation_date": 1439395047, "post_id": 31963980, "comment_id": 51847285, "body": "can you create a class library in Visual Studio and import it into VBA editor?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4444478"}, "edited": false, "score": 0, "creation_date": 1439395374, "post_id": 31963980, "comment_id": 51847494, "body": "I know roughly the process involved in this but how would I recreate the process class in this library that is to be imported? Sorry for this.."}], "tags": [], "owner": {"reputation": 925, "user_id": 5197739, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0eb1950fceec1477ac6713029546eab9?s=128&d=identicon&r=PG&f=1", "display_name": "JamTay317", "link": "https://stackoverflow.com/users/5197739/jamtay317"}, "is_accepted": false, "score": 0, "last_activity_date": 1439379125, "creation_date": 1439379125, "answer_id": 31963980, "question_id": 31963760, "link": "https://stackoverflow.com/questions/31963760/system-diagnostics-in-vb-excel/31963980#31963980", "title": "System.Diagnostics in VB Excel", "body": "<p>it is there for me. You can use the browse button and search for system.dll</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4444478"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1492, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439379125, "creation_date": 1439378492, "last_edit_date": 1531164843, "question_id": 31963760, "link": "https://stackoverflow.com/questions/31963760/system-diagnostics-in-vb-excel", "title": "System.Diagnostics in VB Excel", "body": "<p>Is it at all possible to reference System.Diagnostics in VB Excel? When I go to Tools > References and browse to the .NET 4 folders, I can't add a reference to the System.dll file as I get an error and I don't see the System.Diagnostics either. I need to be able to use System.Diagnostics.Process in my code.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8946, "user_id": 4374739, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/292ca74d572d7871fbae034b12ace389?s=128&d=identicon&r=PG", "display_name": "SuperBiasedMan", "link": "https://stackoverflow.com/users/4374739/superbiasedman"}, "edited": false, "score": 1, "creation_date": 1439380505, "post_id": 31963740, "comment_id": 51836012, "body": "I added your code and explanation from the comments to your question and also tidied up your question a bit. Have a look at how I formatted the code since you said you had trouble with it before, <a href=\"http://stackoverflow.com/editing-help\">the editing help</a> is also a useful resource. If you could <a href=\"http://stackoverflow.com/posts/31963740/edit\">edit your question</a> to explain how this code &#39;didn&#39;t work well&#39; it would help anyone trying to answer your question."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1439381844, "post_id": 31963740, "comment_id": 51836919, "body": "&quot;r1x contains the text of both r1 and r1x.&quot; - What do you mean here?"}, {"owner": {"reputation": 37, "user_id": 4987592, "user_type": "registered", "profile_image": "https://graph.facebook.com/970926112997960/picture?type=large", "display_name": "Mohammed Sawalha", "link": "https://stackoverflow.com/users/4987592/mohammed-sawalha"}, "edited": false, "score": 0, "creation_date": 1439383333, "post_id": 31963740, "comment_id": 51838051, "body": "ah, seems SuperBiasedMan edited it wrongly, but thanks anyway :3  btw grade, look how i&#39;ll explain it i need to copy about 8 or 9 cells, so i decided to create first cell and last cell, so it would be easily to copy, e.g: A1:A9 instead of A1,A2,A3,etc.. r1 is the first cell (A1) r1x is the last cell (A9) so i wanna copy all this (A1 to A9) range"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1439385211, "post_id": 31963740, "comment_id": 51839665, "body": "What are r1, r1x, c1, and c2? Are those shapes that you&#39;ve created? Are they meant to be cells? Because if they are meant to be cells, you are using the .Text function when I would expect .Formula or .Value. My recommendation would be to have your variables set to equal specific cells in your spreadsheet, which you then Name specially to be able to reference them in your code regardless of how those cells move when columns / rows are inserted."}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1439385667, "creation_date": 1439385667, "answer_id": 31966474, "question_id": 31963740, "link": "https://stackoverflow.com/questions/31963740/vba-application-on-excel/31966474#31966474", "title": "VBA application on excel", "body": "<p>Here you go, this how to do a copy :</p>\n\n<pre><code>'Copy range A1:A9 from Sheet1 to Sheet2 A1 :\nThisWorkbook.Sheets(\"Sheet1\").Range(\"A1\" &amp; \":\" &amp; \"A9\").Copy _\n    Destination:=ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1\")\n\n'With your references :\nForm1.ex.Range(r1.Text &amp; \":\" &amp; r1x.Text).Copy _\n    Destination:=Form1.ex.Range(c1.Text)\n</code></pre>\n\n<p>In your example you use Form1 and ex, if they are respectively a workbook and a sheet, the code would work, but if it is an UserForm, this won't.</p>\n\n<p>Don't use <code>+</code> to concatenate strings, it is the operator <code>&amp;</code></p>\n"}], "owner": {"reputation": 37, "user_id": 4987592, "user_type": "registered", "profile_image": "https://graph.facebook.com/970926112997960/picture?type=large", "display_name": "Mohammed Sawalha", "link": "https://stackoverflow.com/users/4987592/mohammed-sawalha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1439385667, "creation_date": 1439378451, "last_edit_date": 1439381482, "question_id": 31963740, "link": "https://stackoverflow.com/questions/31963740/vba-application-on-excel", "title": "VBA application on excel", "body": "<p>I'm using VBA with an application to automate excel with some operations in an spreadsheet. However I don't know how to copy cells programmatically.</p>\n\n<p>I tried using this code:</p>\n\n<pre><code>Form1.ex.Range(r1.Text + \":\" + r1x.Text).Activate()\nForm1.ex.ActiveCell.Copy(Destination:=Form1.ex.Range(c1.Text + \":\" + c2.Text))\n</code></pre>\n\n<p>Where <code>r1</code> is what I copy from, and then <code>r1x</code> contains the text of both <code>r1</code> and <code>r1x</code>. It basically selects a range of cells and is then meant to copy them, but it didn't work well.</p>\n\n<p>How can I fix this code to copy a cell from one location to another?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 165, "user_id": 2867342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d371c33253d6bcf1e661d49ef47cd7?s=128&d=identicon&r=PG&f=1", "display_name": "user2867342", "link": "https://stackoverflow.com/users/2867342/user2867342"}, "edited": false, "score": 0, "creation_date": 1439378361, "post_id": 31963552, "comment_id": 51834567, "body": "Is the colon &#39;:&#39; actually in your code: Else: DeleteQuantity ?"}, {"owner": {"reputation": 47, "user_id": 5218974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VSLQy.jpg?s=128&g=1", "display_name": "Sonal", "link": "https://stackoverflow.com/users/5218974/sonal"}, "reply_to_user": {"reputation": 165, "user_id": 2867342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50d371c33253d6bcf1e661d49ef47cd7?s=128&d=identicon&r=PG&f=1", "display_name": "user2867342", "link": "https://stackoverflow.com/users/2867342/user2867342"}, "edited": false, "score": 0, "creation_date": 1439380834, "post_id": 31963552, "comment_id": 51836245, "body": "Yes it updated with the colon automatically."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5218974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VSLQy.jpg?s=128&g=1", "display_name": "Sonal", "link": "https://stackoverflow.com/users/5218974/sonal"}, "edited": false, "score": 0, "creation_date": 1439381291, "post_id": 31963737, "comment_id": 51836526, "body": "Thanks! This one worked perfectly! You are a star :)"}], "tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": true, "score": 3, "last_activity_date": 1439378442, "creation_date": 1439378442, "answer_id": 31963737, "question_id": 31963552, "link": "https://stackoverflow.com/questions/31963552/vba-update-cells-in-column-d-if-value-is-entered-in-column-a-if-the-value-is/31963737#31963737", "title": "VBA - update cells in column D if value is entered in column A. If the value is then deleted from column A then also delete from column D", "body": "<p>Something like this would avoid all the looping and might work better -</p>\n\n<pre><code>Sub worksheet_change(ByVal Target As Range)\nDim lastrow As Integer\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nIf Not Intersect(Target, Range(\"A5:A\" &amp; lastrow)) Is Nothing Then\n    If IsEmpty(Target) Then\n        Target.Offset(, 3) = vbNullString\n    Else: Target.Offset(, 3) = 1\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>You'd just place it in the sheet module for the sheet you want to watch.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 5218974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VSLQy.jpg?s=128&g=1", "display_name": "Sonal", "link": "https://stackoverflow.com/users/5218974/sonal"}, "edited": false, "score": 0, "creation_date": 1439381315, "post_id": 31964013, "comment_id": 51836541, "body": "Thanks! This one worked as well, appreciate the help :)"}], "tags": [], "owner": {"reputation": 149, "user_id": 3493931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a08c8e4048058fb45843f748500873?s=128&d=identicon&r=PG&f=1", "display_name": "leal32b", "link": "https://stackoverflow.com/users/3493931/leal32b"}, "is_accepted": false, "score": 1, "last_activity_date": 1439379213, "creation_date": 1439379213, "answer_id": 31964013, "question_id": 31963552, "link": "https://stackoverflow.com/questions/31963552/vba-update-cells-in-column-d-if-value-is-entered-in-column-a-if-the-value-is/31964013#31964013", "title": "VBA - update cells in column D if value is entered in column A. If the value is then deleted from column A then also delete from column D", "body": "<p>Put this code in the sheet module:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 1 And Target.Rows.Count = 1 And Target.Columns.Count = 1 Then\n        If Not IsEmpty(Target.Value) Then\n            Cells(Target.Row, 4) = 1\n        Else\n            Cells(Target.Row, 4).ClearContents\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5218974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VSLQy.jpg?s=128&g=1", "display_name": "Sonal", "link": "https://stackoverflow.com/users/5218974/sonal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3881, "favorite_count": 0, "accepted_answer_id": 31963737, "answer_count": 2, "score": 0, "last_activity_date": 1439649595, "creation_date": 1439377947, "last_edit_date": 1439380818, "question_id": 31963552, "link": "https://stackoverflow.com/questions/31963552/vba-update-cells-in-column-d-if-value-is-entered-in-column-a-if-the-value-is", "title": "VBA - update cells in column D if value is entered in column A. If the value is then deleted from column A then also delete from column D", "body": "<p>I am trying to make a sales sheet in excel for a point of sale. I need: </p>\n\n<ol>\n<li><p>When a barcode is entered into cell A5 onwards, I would like cell D5 onwards to update with a default quantity of '1', and </p></li>\n<li><p>If the barcode is then removed, the quantity should be cleared too. </p></li>\n</ol>\n\n<p>I am able to achieve #1 but not #2. I have the below code so far, can anyone help?</p>\n\n<pre><code>Sub SetQuantity()\n\nDim LastRow As Long\nDim i As Long\n\nLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 5 To LastRow\n    If Not IsEmpty(Range(\"A\" &amp; i).Value) Then\n        Range(\"D\" &amp; i).Value = 1\n     Else: DeleteQuantity\n    End If\nNext i\n\nEnd Sub\n\nSub DeleteQuantity()\n\nDim LastRow As Long\nDim i As Long\n\nLastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 5 To LastRow\n    If Range(\"A\" &amp; i).Value = \"\" Then\n        Range(\"D\" &amp; i).Value = \"\"\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "is_accepted": false, "score": 0, "last_activity_date": 1439377827, "creation_date": 1439377827, "answer_id": 31963504, "question_id": 31963358, "link": "https://stackoverflow.com/questions/31963358/move-pagebreak-up-or-down-depending-on-hidden-or-unhidden-rows/31963504#31963504", "title": "Move pagebreak up or down depending on hidden or unhidden rows", "body": "<p>You can copy only the non hide  cells to another sheet with:</p>\n\n<p>On the Home tab, in the Editing group, click Find &amp; Select, and then click Go To.</p>\n\n<p>In the Go To dialog box, click Special.</p>\n\n<p>Under Select, click Visible cells only, and then click OK.</p>\n\n<p>On the Home tab, in the Clipboard group, click Copy </p>\n"}], "owner": {"reputation": 133, "user_id": 2355273, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/28c5bb5892f11cbe6897f37a0c3d2cb4?s=128&d=identicon&r=PG", "display_name": "jvh", "link": "https://stackoverflow.com/users/2355273/jvh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439378543, "creation_date": 1439377428, "last_edit_date": 1531161705, "question_id": 31963358, "link": "https://stackoverflow.com/questions/31963358/move-pagebreak-up-or-down-depending-on-hidden-or-unhidden-rows", "title": "Move pagebreak up or down depending on hidden or unhidden rows", "body": "<p>I have a worksheet with VBA code to hide or unhide a bunch of rows depending on if we need those or not. The problem is that when we hide the rows, we are printing a bunch of half empty pages. Is there a way to dynamically change the pagebreaks depending on if the rows are hidden or not?</p>\n\n<p>Edit: Pref without VBA</p>\n\n<p>Regards</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 1, "creation_date": 1439377231, "post_id": 31963239, "comment_id": 51833830, "body": "Ok, post the whole code. Or let me confirm, Is this line shown error. I don&#39;t think so. Because <code>Sheets(&quot;Cycle&quot;).Range(&quot;A2:A&quot; &amp; lastRowSrc)</code> is right."}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 1, "creation_date": 1439377275, "post_id": 31963239, "comment_id": 51833860, "body": "Probably wrong name (&quot;Cycle&quot;)"}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 1, "creation_date": 1439377371, "post_id": 31963239, "comment_id": 51833917, "body": "As Nicolas stated, <code>Sheets(&quot;Cycle&quot;).Range(&quot;A2:A&quot; &amp; lastRowSrc)</code> is correct as long as 1. your active workbook contains a sheet &quot;Cycle&quot;, and 2. lastRowSrc is a number &gt;0. Also, don&#39;t forget <code>Set</code> in <code>Set srcClm2 = ...</code>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1439377376, "post_id": 31963239, "comment_id": 51833924, "body": "If you want to get an array of  <b>Values</b>, your code is O.K.  If you want to define a range, then you need <b>Set</b>"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1439377637, "post_id": 31963239, "comment_id": 51834095, "body": "@Robert, rather then posting code in comment, please improve your question."}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "reply_to_user": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "edited": false, "score": 0, "creation_date": 1439378069, "post_id": 31963239, "comment_id": 51834388, "body": "@Amit If the name of worksheet would be wrong, another error would be thrown - Subscript out of range."}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "reply_to_user": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 0, "creation_date": 1439378278, "post_id": 31963239, "comment_id": 51834516, "body": "@Verzweifler It depends what Robert wants to achieve. If he wants to get reference to range he needs to use <code>Set</code> keyword, just like you said. But if he wants to get an array of values from worksheet, he should declare variables as <code>Variant</code> and assign the value without using <code>Set</code> keyword."}, {"owner": {"reputation": 41440, "user_id": 3887516, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62e0310897139a10f3293022b6eb7054?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/3887516/amit"}, "reply_to_user": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "edited": false, "score": 0, "creation_date": 1439378506, "post_id": 31963239, "comment_id": 51834677, "body": "@mielk - true... that&#39;s what happens when people don&#39;t read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. other people have to guess what the problem might be"}], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 2, "last_activity_date": 1439377858, "creation_date": 1439377858, "answer_id": 31963518, "question_id": 31963239, "link": "https://stackoverflow.com/questions/31963239/choosing-sheet-by-name/31963518#31963518", "title": "Choosing sheet by name", "body": "<p>You need to declare variables <code>srcClm1</code>, <code>srcClm2</code> as Variant.</p>\n\n<pre><code>Dim srcClm1 As Variant, srcClm2 As Variant\nDim lastRowSrc As Long\n\nlastRowSrc = Sheets(\"Line_Cycle_working_sheet\").Cells(Rows.Count, 1).End(xlUp).row\nsrcClm1 = Sheets(\"Line_Cycle_working_sheet\").Range(\"A2:A\" &amp; lastRowSrc)\nsrcClm2 = Sheets(\"Line_Cycle_working_sheet\").Range(\"B2:B\" &amp; lastRowSrc)\n</code></pre>\n\n<hr>\n\n<p>Actually you could skip <code>As Variant</code> and declare it just like this:</p>\n\n<pre><code>Dim srcClm1, srcClm2\n</code></pre>\n\n<p>since <code>Variant</code> type is default. However, it is good practice to add <code>As Variant</code> to make it clear that you declare it as <code>Variant</code> by purpose and not by mistake.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5193123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 31963518, "answer_count": 1, "score": 0, "last_activity_date": 1439377959, "creation_date": 1439377081, "last_edit_date": 1531164843, "question_id": 31963239, "link": "https://stackoverflow.com/questions/31963239/choosing-sheet-by-name", "title": "Choosing sheet by name", "body": "<p>I have a code in VB:</p>\n\n<pre><code>srcClm2 = Sheet45.Range(\"B2:B\" &amp; lastRowSrc)\n</code></pre>\n\n<p>But I wanna choose sheet by name. I try the different ways, for example:</p>\n\n<pre><code>Sheets(\"Cycle\").Range(\"A2:A\" &amp; lastRowSrc)\n</code></pre>\n\n<p>But I have got error: \"Type mismatch.\"</p>\n\n<p><strong>EDIT:</strong>\nThis is fragment of my code:</p>\n\n<pre><code>Dim srcClm1(), srcClm2()\nDim lastRowSrc As Long\n\nlastRowSrc = Sheets(\"Line_Cycle_working_sheet\").Cells(Rows.Count, 1).End(xlUp).Row\n\n\nsrcClm1 = Sheets(\"Line_Cycle_working_sheet\").Range(\"A2:A\" &amp; lastRowSrc)\n\nsrcClm2 = Sheets(\"Line_Cycle_working_sheet\").Range(\"B2:B\" &amp; lastRowSrc)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4461, "user_id": 4424957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3oNL.jpg?s=128&g=1", "display_name": "Blackwood", "link": "https://stackoverflow.com/users/4424957/blackwood"}, "edited": false, "score": 0, "creation_date": 1439375765, "post_id": 31962650, "comment_id": 51832847, "body": "Post the code you have tried and explain what happens when you run it."}, {"owner": {"reputation": 11, "user_id": 5218812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e20a2d883d464b8cd311eedb96769f?s=128&d=identicon&r=PG&f=1", "display_name": "Zeropoint", "link": "https://stackoverflow.com/users/5218812/zeropoint"}, "reply_to_user": {"reputation": 4461, "user_id": 4424957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W3oNL.jpg?s=128&g=1", "display_name": "Blackwood", "link": "https://stackoverflow.com/users/4424957/blackwood"}, "edited": false, "score": 0, "creation_date": 1439466195, "post_id": 31962650, "comment_id": 51878972, "body": "Thanks Blackwood....I found some code this morning for select 1000 and modded that. Works fine."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5218812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e20a2d883d464b8cd311eedb96769f?s=128&d=identicon&r=PG&f=1", "display_name": "Zeropoint", "link": "https://stackoverflow.com/users/5218812/zeropoint"}, "edited": false, "score": 0, "creation_date": 1439466453, "post_id": 31962892, "comment_id": 51879168, "body": "Ahhhh I was trying to figure out how to do that when I was trying to record my own macro. Cool. Thanks"}], "tags": [], "owner": {"reputation": 1794, "user_id": 111698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c56312f503f0ebfe61dd717489f279b3?s=128&d=identicon&r=PG", "display_name": "Paolo Bonzini", "link": "https://stackoverflow.com/users/111698/paolo-bonzini"}, "is_accepted": false, "score": -1, "last_activity_date": 1439376144, "creation_date": 1439376144, "answer_id": 31962892, "question_id": 31962650, "link": "https://stackoverflow.com/questions/31962650/excel-vba-for-select-next-100-cells-in-column-below-active-cell/31962892#31962892", "title": "Excel VBA for select next 100 cells in column below active cell", "body": "<p>You can use the macro recorder and ask it to use relative cell addresses.</p>\n"}], "owner": {"reputation": 11, "user_id": 5218812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6e20a2d883d464b8cd311eedb96769f?s=128&d=identicon&r=PG&f=1", "display_name": "Zeropoint", "link": "https://stackoverflow.com/users/5218812/zeropoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 458, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1440391054, "creation_date": 1439375501, "last_edit_date": 1440391054, "question_id": 31962650, "link": "https://stackoverflow.com/questions/31962650/excel-vba-for-select-next-100-cells-in-column-below-active-cell", "title": "Excel VBA for select next 100 cells in column below active cell", "body": "<p>As above I'm trying to find an Excel macro to select and copy next 100 cells below from active cell in a column.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2232, "user_id": 1969804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b96e9ac4dfd8702e91b87753d6516e5?s=128&d=identicon&r=PG", "display_name": "SBI", "link": "https://stackoverflow.com/users/1969804/sbi"}, "edited": false, "score": 0, "creation_date": 1439374883, "post_id": 31962353, "comment_id": 51832276, "body": "The code here looks entirely fine. Is this inside a trigger? What does the rest of the function do? I could imagine a trigger on added rows being a reason for this seeming infinite."}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "reply_to_user": {"reputation": 2232, "user_id": 1969804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b96e9ac4dfd8702e91b87753d6516e5?s=128&d=identicon&r=PG", "display_name": "SBI", "link": "https://stackoverflow.com/users/1969804/sbi"}, "edited": false, "score": 0, "creation_date": 1439374953, "post_id": 31962353, "comment_id": 51832316, "body": "Cool, thanks for the conformation. I&#39;ll edit in the rest of the code now."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1439375796, "post_id": 31962353, "comment_id": 51832865, "body": "My psychic powers tell me <code>N</code> becomes zero before <code>i</code> reaches 400."}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1439376011, "post_id": 31962353, "comment_id": 51833010, "body": "@GSerg, I thought that was the case, too, but I added the line <code>Rng.Value = N</code> before the <code>If...</code> line, and it prints the correct numbers into the range Rng."}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1439377894, "post_id": 31962796, "comment_id": 51834270, "body": "Thanks, this method of copy and pasting didn&#39;t lead to the infinite loop. Thanks!"}], "tags": [], "owner": {"reputation": 925, "user_id": 5197739, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0eb1950fceec1477ac6713029546eab9?s=128&d=identicon&r=PG&f=1", "display_name": "JamTay317", "link": "https://stackoverflow.com/users/5197739/jamtay317"}, "is_accepted": true, "score": 1, "last_activity_date": 1439375897, "creation_date": 1439375897, "answer_id": 31962796, "question_id": 31962353, "link": "https://stackoverflow.com/questions/31962353/for-to-vba-loop-is-not-ending/31962796#31962796", "title": "For... To VBA loop is not ending?", "body": "<p>This will do as you ask. </p>\n\n<pre><code>Sub test()\nDim rng As Range\nDim ws As Worksheet: Set ws = ThisWorkbook.ActiveSheet\nSet rng = ws.Range(\"1:1\")\n    For i = 1 To 5\n        rng.Offset(1).Insert Shift:=xlDown\n        rng.Copy\n        rng.Offset(1).PasteSpecial xlPasteValues\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 31962796, "answer_count": 1, "score": 0, "last_activity_date": 1439375897, "creation_date": 1439374677, "last_edit_date": 1439375661, "question_id": 31962353, "link": "https://stackoverflow.com/questions/31962353/for-to-vba-loop-is-not-ending", "title": "For... To VBA loop is not ending?", "body": "<p>I have the following loop written,</p>\n\n<pre><code>For X = 1 To N\n    Rng.Offset(, -3).Resize(, 670).Copy\n    Rng.Offset(1, -3).Insert Shift:=xlDown\nNext X\ni = i + N\n</code></pre>\n\n<p>Which is supposed to start on a row (defined by i), and make new rows based on what N is. If N is equal to 20, I want this code to make 20 copies, then move onto the next row. However, on row 1, N = 3, and copy/pasting just seems to happen over and over. Any suggestions?</p>\n\n<p>For context, the entire the code is as follows:</p>\n\n<pre><code>Sub NuPubPrepare()\n\n    Dim i As Long, k As Long, N As Long, Entry As Range, Rng As Range\n\n    i = 2\n    While i &lt;= 400\n        Set Entry = Range(\"K\" &amp; i)\n        For k = Columns(\"K\").Column To Columns(\"GB\").Column Step 5\n            Set Entry = Union(Entry, Cells(i, k))\n        Next k\n        Set Rng = Range(\"D\" &amp; i)\n        N = Application.WorksheetFunction.CountA(Entry)\n\n        If N = 1 Then\n            i = i + 1\n        Else\n            For X = 1 To N\n                Rng.Offset(, -3).Resize(, 670).Copy\n                Rng.Offset(1, -3).Insert Shift:=xlDown\n            Next X\n            i = i + N \n\n        End If\n    Wend\nEnd Sub\n</code></pre>\n\n<p>So N will count the number of cells with data in them across a wide range (Every 5 cells from Ki to GBi), and I'm trying to make the script insert new lines based on this number.</p>\n"}, {"tags": ["excel", "vba", "merge", "concat"], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 2, "last_activity_date": 1439373493, "last_edit_date": 1439373493, "creation_date": 1439373179, "answer_id": 31961783, "question_id": 31961649, "link": "https://stackoverflow.com/questions/31961649/concat-excel-column-cell-strings-per-row-with-comma/31961783#31961783", "title": "Concat Excel Column Cell Strings per row with comma", "body": "<p>Most of the worksheet functions can be used in VBA like that:</p>\n\n<pre><code>Application.WorksheetFunction.Sum(1, 2)\n</code></pre>\n\n<p>However, some worksheet functions cannot be used in VBA, and unfortunately <code>CONCATENATE</code> is one of them.</p>\n\n<p><code>&amp;</code> is operator used in VBA to concatenate strings.</p>\n\n<hr>\n\n<p>The code below should work for you:</p>\n\n<pre><code>Sub sisk()\n    Dim sisk As String\n    Dim row As Long\n    Dim col As Long\n\n    For row = 2 To 4\n        sisk = vbNullString\n        For col = 1 To 4\n            If VBA.Len(sisk) Then sisk = sisk &amp; \",\"\n            sisk = sisk &amp; Cells(row, col)\n        Next col\n\n        Worksheets(\"Sheet1\").Cells(row, 6) = sisk\n\n    Next row\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2462, "user_id": 1870412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NeIJB.jpg?s=128&g=1", "display_name": "Datacrawler", "link": "https://stackoverflow.com/users/1870412/datacrawler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1908, "favorite_count": 0, "accepted_answer_id": 31961783, "answer_count": 1, "score": 1, "last_activity_date": 1439373493, "creation_date": 1439372831, "question_id": 31961649, "link": "https://stackoverflow.com/questions/31961649/concat-excel-column-cell-strings-per-row-with-comma", "title": "Concat Excel Column Cell Strings per row with comma", "body": "<p>I have an excel file with some columns. I have been trying to merge the columns and keep the cell strings separated with a comma. </p>\n\n<p><a href=\"https://i.stack.imgur.com/M2dO1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M2dO1.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, I want a new table with the concat results per row :</p>\n\n<pre><code>=CONCATENATE(A2,\",\",B2,\",\",C2,\",\",D2)\n=CONCATENATE(A3,\",\",B3,\",\",C3,\",\",D3)\n=CONCATENATE(A4,\",\",B4,\",\",C4,\",\",D4)\n</code></pre>\n\n<p>I tried to use VBA but with no success :</p>\n\n<pre><code>Sub sisk()\nDim sisk As String\n\nFor i = 2 To 4\n    sisk = CONCATENATE(Range(Cells(1, i).Value), Cells(1, 4).Value)\nNext i\nWorksheets(\"Sheet1\").Cells(1, 6) = sisk\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1439372484, "post_id": 31961350, "comment_id": 51830587, "body": "If you indent your code it will be much easier to see how your code blocks line up. The standard is 4 spaces for each indent level."}, {"owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "edited": false, "score": 0, "creation_date": 1439374020, "post_id": 31961350, "comment_id": 51831697, "body": "Endif ... its in wrong place."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5211488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9057447d9596e7c5dc7487464ef02cb8?s=128&d=identicon&r=PG&f=1", "display_name": "finvba7", "link": "https://stackoverflow.com/users/5211488/finvba7"}, "edited": false, "score": 0, "creation_date": 1439373107, "post_id": 31961414, "comment_id": 51831067, "body": "Thanks a lot. it worked at first but now is teloing me that the code execution as been interupted. Ever seen that?"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "reply_to_user": {"reputation": 1, "user_id": 5211488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9057447d9596e7c5dc7487464ef02cb8?s=128&d=identicon&r=PG&f=1", "display_name": "finvba7", "link": "https://stackoverflow.com/users/5211488/finvba7"}, "edited": false, "score": 0, "creation_date": 1439373271, "post_id": 31961414, "comment_id": 51831207, "body": "at which line occurs this message?"}, {"owner": {"reputation": 1, "user_id": 5211488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9057447d9596e7c5dc7487464ef02cb8?s=128&d=identicon&r=PG&f=1", "display_name": "finvba7", "link": "https://stackoverflow.com/users/5211488/finvba7"}, "edited": false, "score": 0, "creation_date": 1439373751, "post_id": 31961414, "comment_id": 51831533, "body": "The seconf line. And if I click on Debug it tells me something is wrong with &quot;End if&quot;."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "reply_to_user": {"reputation": 1, "user_id": 5211488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9057447d9596e7c5dc7487464ef02cb8?s=128&d=identicon&r=PG&f=1", "display_name": "finvba7", "link": "https://stackoverflow.com/users/5211488/finvba7"}, "edited": false, "score": 0, "creation_date": 1439373847, "post_id": 31961414, "comment_id": 51831580, "body": "what does it say exactly?"}, {"owner": {"reputation": 1, "user_id": 5211488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9057447d9596e7c5dc7487464ef02cb8?s=128&d=identicon&r=PG&f=1", "display_name": "finvba7", "link": "https://stackoverflow.com/users/5211488/finvba7"}, "edited": false, "score": 0, "creation_date": 1439374170, "post_id": 31961414, "comment_id": 51831808, "body": "Just &quot;Code execution has been interrupted&quot;"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "reply_to_user": {"reputation": 1, "user_id": 5211488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9057447d9596e7c5dc7487464ef02cb8?s=128&d=identicon&r=PG&f=1", "display_name": "finvba7", "link": "https://stackoverflow.com/users/5211488/finvba7"}, "edited": false, "score": 0, "creation_date": 1439374359, "post_id": 31961414, "comment_id": 51831923, "body": "try the methods recommended in this msdn thread, <a href=\"https://social.msdn.microsoft.com/Forums/en-US/3a5cf3ab-fe20-45d5-912c-bbb249b1e391/code-execution-has-been-interrupted?forum=isvvba\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a> I don&#39;t remember if I ever had this issue"}, {"owner": {"reputation": 1, "user_id": 5211488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9057447d9596e7c5dc7487464ef02cb8?s=128&d=identicon&r=PG&f=1", "display_name": "finvba7", "link": "https://stackoverflow.com/users/5211488/finvba7"}, "edited": false, "score": 0, "creation_date": 1439382352, "post_id": 31961414, "comment_id": 51837311, "body": "Now it works, but i keeps running in circles and never gives me an answer"}], "tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": false, "score": 1, "last_activity_date": 1439373799, "last_edit_date": 1439373799, "creation_date": 1439372249, "answer_id": 31961414, "question_id": 31961350, "link": "https://stackoverflow.com/questions/31961350/next-without-for-on-a-if-statement-in-vba/31961414#31961414", "title": "&quot;Next Without For&quot; on a IF Statement in VBA", "body": "<p>you need to close the if statement before you can use the next keyword</p>\n\n<pre><code>Sub ISIN()\n\nDim i As Integer\nDim y As Integer\nDim t As Integer\nDim z As Integer\n For i = 20 To 53\n  For y = 6 To 38\n   For t = 20 To 53\n    For z = 53 To 87\n     If Cells(i, 3) = Cells(y, 1) Then\n      Cells(t, 19) = \"Abracadabra\"\n     Else\n      Cells(z, 3) = Cells(y, 1)\n     end if\n   Next z\n  Next t\n Next y\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5211488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9057447d9596e7c5dc7487464ef02cb8?s=128&d=identicon&r=PG&f=1", "display_name": "finvba7", "link": "https://stackoverflow.com/users/5211488/finvba7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439373799, "creation_date": 1439372103, "question_id": 31961350, "link": "https://stackoverflow.com/questions/31961350/next-without-for-on-a-if-statement-in-vba", "title": "&quot;Next Without For&quot; on a IF Statement in VBA", "body": "<p>I am trying to verify that there are no error between the value in cells on column A and in Column C.\nI keep getting an error saying \"Next Without For\"</p>\n\n<pre><code>Sub ISIN()\n\nDim i As Integer\nDim y As Integer\nDim t As Integer\nDim z As Integer\nFor i = 20 To 53\nFor y = 6 To 38\nFor t = 20 To 53\nFor z = 53 To 87\nIf Cells(i, 3) = Cells(y, 1) Then\nCells(t, 19) = \"Abracadabra\"\nElse: Cells(z, 3) = Cells(y, 1)\nNext z\nNext t\nNext y\nNext i\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "edited": false, "score": 0, "creation_date": 1439372321, "post_id": 31961275, "comment_id": 51830470, "body": "Why don&#39;t you just trim the leftmost character of the string to get the number?"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439376169, "post_id": 31961275, "comment_id": 51833119, "body": "I think that only four item is valid for use."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1439372675, "creation_date": 1439372675, "answer_id": 31961594, "question_id": 31961275, "link": "https://stackoverflow.com/questions/31961275/convert-a-text-to-a-number/31961594#31961594", "title": "convert a text to a number", "body": "<p>That may be because you may have unwanted leading or trailing spaces which fails the comparison. Also you do not need <code>Exit Function</code> at the end of the code. It will exit any ways :)</p>\n\n<p>Try this</p>\n\n<pre><code>Public Function ConvertCOMPLEXITYToNumber(ByVal chain As String) As Integer\n    Dim Num As Integer\n\n    Select Case Trim(chain)\n        Case \"1 - Tr\u00e8s difficile\": Num = 1\n        Case \"2 - Difficile\": Num = 2\n        Case \"3 - Mod\u00e9r\u00e9e\": Num = 3\n        Case \"4 - Facile\": Num = 4\n        Case Else: Num = 0\n    End Select\n\n    ConvertCOMPLEXITYToNumber = Num\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1439374861, "post_id": 31961678, "comment_id": 51832266, "body": "What if the <code>Chain = &quot;1 - Tr&#232;s Sid&quot;</code>?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1439375005, "post_id": 31961678, "comment_id": 51832355, "body": "or <code>Chain = &quot;2-Excel Developers&quot;</code> In such scenarios, the value of <code>ConvertCOMPLEXITYTToNumber</code> should be <code>0</code> but if you look at left number then you will get incorrect results :)"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1439375068, "post_id": 31961678, "comment_id": 51832391, "body": "Ah, yes, if those are possibilities then my answer won&#39;t work."}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 0, "last_activity_date": 1439372907, "creation_date": 1439372907, "answer_id": 31961678, "question_id": 31961275, "link": "https://stackoverflow.com/questions/31961275/convert-a-text-to-a-number/31961678#31961678", "title": "convert a text to a number", "body": "<pre><code>If IsNumeric(Left(Trim(chain),1)) Then\n    ConvertCOMPLEXITYToNumber = Left(Trim(chain),1)\nElse\n    ConvertCOMPLEXITYToNumber = 0\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1439375804, "post_id": 31962712, "comment_id": 51832870, "body": "How is this different than what Excel Developers Posted? :)"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1439376058, "post_id": 31962712, "comment_id": 51833048, "body": "Actually, his code not work well, I do this for code clear and easily understandable. My logic is <code>1. Get the first char</code>, <code>2. IF not a numberic, it will return 0 by default</code>, <code>3. If less than 5, return by changing integer type</code>. I already tested and it work well."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1439376146, "post_id": 31962712, "comment_id": 51833102, "body": "did you see my comment below his post?"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1439376375, "post_id": 31962712, "comment_id": 51833250, "body": "Yes I know, I am giving reference for condition like data has no duplicate first char. I think so, I did it. If there is no duplicate, my way is good. If not, your way is good. I just want to show different usage."}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1439375665, "creation_date": 1439375665, "answer_id": 31962712, "question_id": 31961275, "link": "https://stackoverflow.com/questions/31961275/convert-a-text-to-a-number/31962712#31962712", "title": "convert a text to a number", "body": "<p>Here, my approach for you:</p>\n\n<pre><code>Public Function ConvertCOMPLEXITYToNumber(ByVal chain As String) As Integer\n\n    'Get the first character\n    chain = Left(Trim(chain), 1)\n\n    'If frist character is numeric\n    If IsNumeric(chain) Then\n\n        'If first number is less than 5, return value\n        If chain &lt; 5 Then\n            ConvertCOMPLEXITYToNumber = CInt(chain)\n        End If\n\n    End If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1441243847, "creation_date": 1439371890, "last_edit_date": 1439372563, "question_id": 31961275, "link": "https://stackoverflow.com/questions/31961275/convert-a-text-to-a-number", "title": "convert a text to a number", "body": "<p>I don't know why this code doesn't work ..i wanna just convert text to number .. It doesn't give me any error but it doesn't work</p>\n\n<pre><code>Public Function ConvertCOMPLEXITYToNumber(ByVal chain As String) As Integer\n\n Select Case chain\n        Case \"1 - Tr\u00e8s difficile\"\n            ConvertCOMPLEXITYTToNumber = 1\n        Case \"2 - Difficile\"\n            ConvertCOMPLEXITYTToNumber = 2\n        Case \"3 - Mod\u00e9r\u00e9e\"\n            ConvertCOMPLEXITYTToNumber = 3\n        Case \"4 - Facile\"\n            ConvertCOMPLEXITYTToNumber = 4\n        Case Else\n            ConvertCOMPLEXITYTToNumber = 0\n    End Select\n\n    Exit Function\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1439370623, "post_id": 31960590, "comment_id": 51829251, "body": "This could be achieved using a Vlookup/Index-Match?"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1439372197, "post_id": 31960590, "comment_id": 51830392, "body": "vlookup can be very tedious for over 6000 rows of data and the database expands every month. A change of location could ruin the whole document thus i do not want to take such a risk @99moorem"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1439372956, "post_id": 31960590, "comment_id": 51830951, "body": "Should Dim and Set the workbooks as well."}], "answers": [{"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1439372468, "post_id": 31961334, "comment_id": 51830580, "body": "-what is <code>target.Range(&quot;A&quot;)</code>? that is not a valid range is it?"}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1439372626, "post_id": 31961334, "comment_id": 51830692, "body": "You can use cells instead of range to compare the two data.  source.Cells(a, 1).Value = target.Cells(a, 1).Value  Yes. It should be target.Range(&quot;A&quot; &amp; a). Sorry about that."}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1439372656, "post_id": 31961334, "comment_id": 51830711, "body": "it defines rows! @John F"}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "edited": false, "score": 0, "creation_date": 1439372780, "post_id": 31961334, "comment_id": 51830818, "body": "try using      target.Range(&quot;A&quot; &amp; a)"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1439372878, "post_id": 31961334, "comment_id": 51830893, "body": "i tried, the programme runs but nothing comes out. @John F"}, {"owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "edited": false, "score": 0, "creation_date": 1439373126, "post_id": 31961334, "comment_id": 51831084, "body": "Try target.Range(&quot;C&quot; &amp; a).Entirerow.select. The row of the activecell will be selected and copied to another workook."}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1439433115, "post_id": 31961334, "comment_id": 51862934, "body": "it only works if the rows are exactly in the same order if it is not then it does not display. i think we have to incorporate a find coding in it but im not sure on how do i go about it @JohnF"}], "tags": [], "owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1439373331, "last_edit_date": 1439373331, "creation_date": 1439372050, "answer_id": 31961334, "question_id": 31960590, "link": "https://stackoverflow.com/questions/31960590/retrieval-of-information-from-a-workbook-using-unique-id/31961334#31961334", "title": "Retrieval of information from a workbook using unique ID", "body": "<pre><code>target.Activate\n\nFor a = 2 To 50\n\n If source.Range(\"A\" &amp; a).Value = target.Range(\"A\" &amp; a).Value Then\n\n target.Range(\"C\" &amp; a).EntireRow.Select\n Selection.Copy\n source.Range(\"B\" &amp; a).PasteSpecial\n\n End If\n</code></pre>\n\n<p>Next a</p>\n"}, {"comments": [{"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1439431536, "post_id": 31961376, "comment_id": 51862521, "body": "hi there, the code works but it only works if the cells on both workbooks of different sheet correspond on the same rows.  if the data is in row 1 of target but row 3 in source it does not find and match it @ChipsLetten"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1439491512, "post_id": 31961376, "comment_id": 51896161, "body": "I&#39;ve just checked and it works fine. The <code>Range.Find</code> method means that the order of the items isn&#39;t important. Can you give an example of it not working?"}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": true, "score": 1, "last_activity_date": 1439372149, "creation_date": 1439372149, "answer_id": 31961376, "question_id": 31960590, "link": "https://stackoverflow.com/questions/31960590/retrieval-of-information-from-a-workbook-using-unique-id/31961376#31961376", "title": "Retrieval of information from a workbook using unique ID", "body": "<p>You are misunderstanding how you use the <code>Range</code> object. This <code>.Range(\"A\").Value</code> does not work, you need to include a row number as well, such as <code>.Range(\"A1\").Value</code>.</p>\n\n<p>Your logic assumes that both lists are in exactly the same order. Using the <code>Range.Find</code> method gets round that problem.</p>\n\n<pre><code>Sub AAA()\n    Dim source As Worksheet\n    Dim target As Worksheet\n    Dim cell As Range\n    Dim cellFound As Range\n\n    Set target = Workbooks(\"Target.xlsm\").Sheets(\"Sheet1\")\n    Set source = Workbooks(\"Source.xlsm\").Sheets(\"Sheet2\")\n\n    For Each cell In target.Range(\"A2:A50\")\n        ' Try to find this value in the source sheet\n        Set cellFound = source.Range(\"A:A\").Find(What:=cell.Value, LookIn:=xlValues, LookAt:=xlWhole)\n        If Not cellFound Is Nothing Then\n            ' A matching value was found\n            ' So copy the cell 2 columns across to the cell adjacent to matching value\n            ' Do a \"normal\" copy &amp; paste\n            cell.Offset(ColumnOffset:=2).Copy cellFound.Offset(ColumnOffset:=1)\n            ' Or do a copy &amp; paste special values\n            'cell.Offset(ColumnOffset:=2).Copy\n            'cellFound.Offset(ColumnOffset:=1).PasteSpecial xlPasteValues\n\n        Else\n            ' The value in this cell does not exist in the source\n            ' Should anything be done?\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Are you aware that you are using different sheets for <code>source</code> and for <code>target</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1439374196, "creation_date": 1439374196, "answer_id": 31962166, "question_id": 31960590, "link": "https://stackoverflow.com/questions/31960590/retrieval-of-information-from-a-workbook-using-unique-id/31962166#31962166", "title": "Retrieval of information from a workbook using unique ID", "body": "<p>Not sure what volume of data you're going to be working with, but you could also use <a href=\"https://msdn.microsoft.com/en-us/library/wak0wfyt.aspx\" rel=\"nofollow\">arrays</a> to achieve what you're after.</p>\n\n<pre><code>Option Explicit\nSub AAA()\n    Dim i As Long, j As Long, k As Integer\n    Dim source As Worksheet, target As Worksheet\n    Dim arrTarget() As Variant, arrSource() As Variant\n    Dim lrowSrc As Long, lcolSrc As Long, lrowTrgt As Long, lcolTrgt As Long\n\n    Set target = Workbooks(\"Book4.xlsb\").Sheets(\"Sheet1\")\n    Set source = Workbooks(\"Book3.xlsb\").Sheets(\"Sheet1\")\n    lrowSrc = source.Cells(target.Rows.Count, 1).End(xlUp).Row\n    lcolSrc = source.Cells(2, source.Columns.Count).End(xlToLeft).Column\n    lrowTrgt = target.Cells(target.Rows.Count, 1).End(xlUp).Row\n    lcolTrgt = target.Cells(2, target.Columns.Count).End(xlToLeft).Column\n\n    target.Activate\n    arrTarget = target.Range(Cells(2, 1), Cells(lrowTrgt, lcolSrc))\n    source.Activate\n    arrSource = source.Range(Cells(2, 1), Cells(lrowSrc, lcolSrc))\n    target.Activate\n\n    For i = LBound(arrTarget, 1) To UBound(arrTarget, 1)\n        For j = LBound(arrSource, 1) To UBound(arrSource, 1)\n            If arrTarget(i, 1) = arrSource(j, 1) Then\n                For k = LBound(arrSource, 2) To UBound(arrSource, 2)\n                    arrTarget(i, k) = arrSource(j, k)\n                Next k\n                Exit For\n            End If\n        Next j\n    Next i\n\n    target.Range(\"A2\").Resize(UBound(arrTarget, 1), UBound(arrTarget, 2)).Value = arrTarget\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Working on 12,000 rows of data in the <code>Target workbook</code> and 25,000 in the <code>Source workbook</code>, with 6,000 matches, the code took 9.91 seconds to run.</p>\n</blockquote>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 31961376, "answer_count": 3, "score": 1, "last_activity_date": 1439374196, "creation_date": 1439370178, "last_edit_date": 1439373090, "question_id": 31960590, "link": "https://stackoverflow.com/questions/31960590/retrieval-of-information-from-a-workbook-using-unique-id", "title": "Retrieval of information from a workbook using unique ID", "body": "<p>I have two workbooks , one is a active list(database) and the other is a project tracker(dashboard). </p>\n\n<p>Both workbooks have a project ID. </p>\n\n<p>I want that the workbook and active list should have a loop to match the exact project IDs. </p>\n\n<p>If the project ID is found in the active list, it would retrieve information from that row and overwrite the existing row in the project tracker,which contains that project ID. </p>\n\n<p>This is an example of the code which i have done, I did something relevant but it does not seem to work :</p>\n\n<pre><code>Sub AAA()\n\n'If Workbooks(\"Source.xlsm\").Sheets(\"Sheet2\").Range(\"A2\").Value = Workbooks(\"Target.xlsm\").Sheets(\"Sheet1\").Range(\"A2\").Value Then\n'Workbooks(\"Source.xlsm\").Sheets(\"Sheet2\").Range(\"B2\").Value = Workbooks(\"Target.xlsm\").Sheets(\"Sheet1\").Range(\"C2\").Value\nDim a As Long\nDim lastrow As Long\nDim lastcol As Long\nDim source As Worksheet\nDim target As Worksheet\n\n    Set target = Workbooks(\"Target.xlsm\").Sheets(\"Sheet1\")\n    Set source = Workbooks(\"Source.xlsm\").Sheets(\"Sheet2\")\n    lastrow = source.Range(\"A\" &amp; target.Rows.Count).End(xlUp).Row\n    lastcol = target.Cells(2, target.Columns.Count).Column\n\n    target.Activate\n\nFor a = 2 To 50\n\n     If source.Range(\"A\" &amp; a).Value = target.Range(\"A\" &amp; a).Value Then\n\n     target.Range(\"C\" &amp; a).Select\n     Range(ActiveCell, ActiveCell.Offset(0)).Copy\n     source.Range(\"B\" &amp; a).PasteSpecial\n\n     End If\n\nNext a\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 2, "last_activity_date": 1439370184, "creation_date": 1439370184, "answer_id": 31960591, "question_id": 31960330, "link": "https://stackoverflow.com/questions/31960330/object-getfolder-error-variable-of-bloc-with-not-defined/31960591#31960591", "title": "object.getfolder error variable of bloc with not defined", "body": "<p>You're defining the variable <code>MyObject</code> but then using <code>MyObj</code> to set the folder.</p>\n\n<p>Try this:</p>\n\n<pre><code>Set MyObject = CreateObject(\"Scripting.FileSystemObject\")\nSet MySource = MyObject.GetFolder(folder)\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 5194744, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152971582513038/picture?type=large", "display_name": "Juan Sebasti&#225;n Calder&#243;n", "link": "https://stackoverflow.com/users/5194744/juan-sebasti%c3%a1n-calder%c3%b3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1402, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439370485, "creation_date": 1439369396, "last_edit_date": 1439370485, "question_id": 31960330, "link": "https://stackoverflow.com/questions/31960330/object-getfolder-error-variable-of-bloc-with-not-defined", "title": "object.getfolder error variable of bloc with not defined", "body": "<p>Im writting a code to import all files of a folder into one excel sheet. here is my code:</p>\n\n<pre><code>Sub ImportLiabs()\nDim destination As String\nDim Colonne1Tableau As Integer\nDim Ligne1Tableau As Integer\nDim nb_onglets_param As Integer\nDim OngletMacro As String\nDim i As Integer: i = 1\nDim folder As String\n\n  'Param\u00e9trage\ndestination = ThisWorkbook.Name\nDim NomFichier() As String\n\nDim MyObj As Object, MySource As Object, file As Variant\nfolder = Range(\"Folder\").Value\nSet MyObject = CreateObject(\"Scripting.FileSystemObject\")\nSet MySource = MyObj.GetFolder(folder)\nFor Each file In MySource.Files\n\n        If Left(file.Name, 9) = \"liab_data\" Then\n\n        i = i + 1\n        ReDim Preserve NomFichier(i)\n        NomFichier(i) = file.Name\n\n        Workbooks.Open file\n        Sheets.Copy After:=Workbooks(destination).Sheets(i)\n        Windows(NomFichier(i)).Close\n\n\n        i = i + 1\n\n\n    End If\n    Next file\n\n\nEnd Sub\n</code></pre>\n\n<p>the problem is that when excecuting it displays , variable or object not defined of block with at this line:</p>\n\n<pre><code>Set MySource = MyObj.GetFolder(folder)\n</code></pre>\n\n<p>Cant manage to figure what the problem is, thank you for your help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5435910, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/331123497536f91244ed0490290215a4?s=128&d=identicon&r=PG&f=1", "display_name": "Gwen", "link": "https://stackoverflow.com/users/5435910/gwen"}, "edited": false, "score": 0, "creation_date": 1439369775, "post_id": 31960357, "comment_id": 51828612, "body": "Whole Column. Now there&#39;s no error, but right now nothing happened when I click search. I&#39;m trying to get the data in the column beside the found cell into a textbox in my userform.  @nicolas"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 1, "user_id": 5435910, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/331123497536f91244ed0490290215a4?s=128&d=identicon&r=PG&f=1", "display_name": "Gwen", "link": "https://stackoverflow.com/users/5435910/gwen"}, "edited": false, "score": 0, "creation_date": 1439369873, "post_id": 31960357, "comment_id": 51828687, "body": "you should debug the code, so, you can see the line which not work well."}, {"owner": {"reputation": 1, "user_id": 5435910, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/331123497536f91244ed0490290215a4?s=128&d=identicon&r=PG&f=1", "display_name": "Gwen", "link": "https://stackoverflow.com/users/5435910/gwen"}, "edited": false, "score": 0, "creation_date": 1439370374, "post_id": 31960357, "comment_id": 51829051, "body": "Sorry, I am a newbie in excel. To debug I press F8 right? They just highlight my lines and move down each time I press F8. @nicolas"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 1, "user_id": 5435910, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/331123497536f91244ed0490290215a4?s=128&d=identicon&r=PG&f=1", "display_name": "Gwen", "link": "https://stackoverflow.com/users/5435910/gwen"}, "edited": false, "score": 0, "creation_date": 1439370523, "post_id": 31960357, "comment_id": 51829162, "body": "Yes, right, do it. And check the values of variables. Here is small <a href=\"http://www.excel-easy.com/vba/examples/debugging.html\" rel=\"nofollow noreferrer\">reference</a>"}, {"owner": {"reputation": 1, "user_id": 5435910, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/331123497536f91244ed0490290215a4?s=128&d=identicon&r=PG&f=1", "display_name": "Gwen", "link": "https://stackoverflow.com/users/5435910/gwen"}, "edited": false, "score": 0, "creation_date": 1439370852, "post_id": 31960357, "comment_id": 51829404, "body": "I added another set of codes above. Is it right that both my application enable events = false? @nicolas"}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1439369508, "creation_date": 1439369508, "answer_id": 31960357, "question_id": 31960282, "link": "https://stackoverflow.com/questions/31960282/vba-excel-run-time-error-1004-method-range-of-object-worksheet-failed/31960357#31960357", "title": "VBA EXCEL Run time error 1004 Method &#39;Range of Object_worksheet&#39; failed", "body": "<p>It should be, because you used incomplete range as <code>Range(\"F8:F\")</code>. </p>\n\n<p>Where you want to find the word, the whole F column or just the part of F column. </p>\n\n<p>For the whole column, you should use as follow:</p>\n\n<pre><code>Set FoundCell = ws.Range(\"F:F\").Find(what:=WHAT_TO_FIND, lookat:=xlWhole)\n</code></pre>\n\n<p>For the part of column, you should use as follow:</p>\n\n<pre><code>Set FoundCell = ws.Range(\"F8:F100\").Find(what:=WHAT_TO_FIND, lookat:=xlWhole)\n</code></pre>\n\n<p>If you don't know the fixed last row, you can use as follow.</p>\n\n<pre><code>Set FoundCell = ws.Range(\"F8:F\" &amp; ws.Range(\"F8\").SpecialCells(xlCellTypeLastCell).Row).Find(what:=WHAT_TO_FIND, lookat:=xlWhole)\n</code></pre>\n\n<p>where, <code>ws.Range(\"F8\").SpecialCells(xlCellTypeLastCell).Row</code> get the last used cell.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5435910, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/331123497536f91244ed0490290215a4?s=128&d=identicon&r=PG&f=1", "display_name": "Gwen", "link": "https://stackoverflow.com/users/5435910/gwen"}, "edited": false, "score": 0, "creation_date": 1439373415, "post_id": 31961738, "comment_id": 51831319, "body": "Hi, thank you! But when I remove the &quot;&quot; there&#39;s a compile error &quot; constant expression required. Oh and Nicolas told me to debug right? but my       For Each PP In rngList                    SearchSelectPPComboBox.AddItem PP.Offset(, 1)             Next PP    is looping. How do I make it loop until empty row? I tried adding Nicolas&#39; to stop the loop for this but there&#39;s error @DragonSamu"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "reply_to_user": {"reputation": 1, "user_id": 5435910, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/331123497536f91244ed0490290215a4?s=128&d=identicon&r=PG&f=1", "display_name": "Gwen", "link": "https://stackoverflow.com/users/5435910/gwen"}, "edited": false, "score": 0, "creation_date": 1439374896, "post_id": 31961738, "comment_id": 51832283, "body": "My mistake, a constant requires a non-variable string, SearchSelectPPComboBox.value is a variable string and therefor can not be defined as a constant. What is the reason for using a constant? and not just defining Dim WHAT_TO_FIND as string and then WHAT_TO_FIND = SearchSelectPPComboBox.value"}], "tags": [], "owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "is_accepted": false, "score": 0, "last_activity_date": 1439391221, "last_edit_date": 1439391221, "creation_date": 1439373068, "answer_id": 31961738, "question_id": 31960282, "link": "https://stackoverflow.com/questions/31960282/vba-excel-run-time-error-1004-method-range-of-object-worksheet-failed/31961738#31961738", "title": "VBA EXCEL Run time error 1004 Method &#39;Range of Object_worksheet&#39; failed", "body": "<p>Nicolas provided the anwser to your first issue.</p>\n\n<blockquote>\n  <p>Whole Column. Now there's no error, but right now nothing happened when I click search. I'm trying to get the data in the column beside the found cell into a textbox in my userform. @nicolas\u2013  Gwen44 mins ago </p>\n</blockquote>\n\n<p>The following code is incorrect:</p>\n\n<pre><code>Const WHAT_TO_FIND As String = \"SearchSelectPPComboBox.value\"\n</code></pre>\n\n<p>You are giving the value \"SearchSelectPPComboBox.value\" to WHAT_TO_FIND.\nThe code should be:</p>\n\n<pre><code>Const WHAT_TO_FIND As String = SearchSelectPPComboBox.value\n</code></pre>\n\n<p>the text inside \"\" becomes a string thus its searching for the string \"SearchSelectPPComboBox.value\", by removing the \"\" the value of SearchSelectPPComboBox.value becomes the string.</p>\n\n<p>EDIT:</p>\n\n<p>a constant requires a non-variable string.\nSearchSelectPPComboBox.value is a variable string and therefor can not be defined as a constant. </p>\n\n<p>Use the following code instead:</p>\n\n<pre><code>Dim WHAT_TO_FIND as string \nWHAT_TO_FIND = SearchSelectPPComboBox.value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5435910, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/331123497536f91244ed0490290215a4?s=128&d=identicon&r=PG&f=1", "display_name": "Gwen", "link": "https://stackoverflow.com/users/5435910/gwen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 410, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1439391221, "creation_date": 1439369264, "last_edit_date": 1531164843, "question_id": 31960282, "link": "https://stackoverflow.com/questions/31960282/vba-excel-run-time-error-1004-method-range-of-object-worksheet-failed", "title": "VBA EXCEL Run time error 1004 Method &#39;Range of Object_worksheet&#39; failed", "body": "<p>I'm trying to extract data from worksheet after selecting an option in the combobox. So what I'm doing here is that when I click the search button, based on the option chosen in the SearchSelectPPComboBox, I should go into the ws in the wb to find this option value then locate which row this value is in so I can extract the data individually by moving to the next column in the same row. </p>\n\n<p>However, my code below is having \"Run time error 1004 Method 'Range of Object_worksheet' failed\" at this line </p>\n\n<p><strong>Set FoundCell = ws.Range(\"F8:F\").Find(what:=WHAT_TO_FIND, lookat:=xlWhole)</strong></p>\n\n<p>Thank you for your help in advance!!</p>\n\n<pre><code>Private Sub SearchButton_Click()\n    If SearchTeamComboBox.ListIndex &lt; 0 And SearchSelectPPComboBox.ListIndex &lt; 0 Then\n    MsgBox \"Please select Team and the Process/project you want to search .\"\n    SearchTeamComboBox.SetFocus\n    ElseIf SearchTeamComboBox.ListIndex &lt; 0 Then\n    MsgBox \"Please select Team.\"\n    SearchTeamComboBox.SetFocus\n    ElseIf SearchSelectPPComboBox.ListIndex &lt; 0 Then\n    MsgBox \"Please select the Process/project you want to search .\"\n    SearchSelectPPComboBox.SetFocus\n    Else\n\n    Const WHAT_TO_FIND As String = \"SearchSelectPPComboBox.value\"\n    Dim ws As Excel.Worksheet\n    Dim FoundCell As Excel.Range\n\n    Set ws = Sheets(SearchTeamComboBox.Value)\n    Set FoundCell = ws.Range(\"F8:F\").Find(what:=WHAT_TO_FIND, lookat:=xlWhole)\n    If Not FoundCell Is Nothing Then\n        MsgBox (WHAT_TO_FIND &amp; \" is found \")\n        Me.checklistComboBox.Value = FoundCell.Offset(0, 1).Value\n\n    End If\n    End If\n    End Sub\n</code></pre>\n\n<p>Additional codes: </p>\n\n<pre><code>Private Sub SearchTeamComboBox_Change()\n    Application.EnableEvents = False\n    SearchSelectPPComboBox.Clear\n    Application.EnableEvents = True\n\nDim PP As Object\nDim rngList As Range\nDim strSelected As String\nDim LastRow As Long\n\n        ' check that a team has been selected\n      If SearchTeamComboBox.ListIndex &lt;&gt; -1 Then\n\n           strSelected = SearchTeamComboBox.Value\n            If strSelected = \"ACLT\" Then\n            LastRow = Worksheets(\"ACLT\").Range(\"E\" &amp; Rows.Count).End(xlUp).row\n            Set rngList = Worksheets(\"ACLT\").Range(\"E8:E\" &amp; LastRow)\n\n                ElseIf strSelected = \"AIF/CIF\" Then\n                LastRow = Worksheets(\"AIFCIF\").Range(\"E\" &amp; Rows.Count).End(xlUp).row\n                Set rngList = Worksheets(\"AIFCIF\").Range(\"E8:E\" &amp; LastRow)\n\n                ElseIf strSelected = \"FDM\" Then\n                LastRow = Worksheets(\"FDM\").Range(\"E\" &amp; Rows.Count).End(xlUp).row\n                Set rngList = Worksheets(\"FDM\").Range(\"E8:E\" &amp; LastRow)\n\n                ElseIf strSelected = \"Imaging\" Then\n                LastRow = Worksheets(\"Imaging\").Range(\"E\" &amp; Rows.Count).End(xlUp).row\n                Set rngList = Worksheets(\"Imaging\").Range(\"E8:E\" &amp; LastRow)\n\n                ElseIf strSelected = \"MRT\" Then\n                LastRow = Worksheets(\"MRT\").Range(\"E\" &amp; Rows.Count).End(xlUp).row\n                Set rngList = Worksheets(\"MRT\").Range(\"E8:E\" &amp; LastRow)\n\n                ElseIf strSelected = \"PAT\" Then\n                LastRow = Worksheets(\"PAT\").Range(\"E\" &amp; Rows.Count).End(xlUp).row\n                Set rngList = Worksheets(\"PAT\").Range(\"E8:E\" &amp; LastRow)\n\n                ElseIf strSelected = \"SSU\" Then\n                LastRow = Worksheets(\"SSU\").Range(\"E\" &amp; Rows.Count).End(xlUp).row\n                Set rngList = Worksheets(\"SSU\").Range(\"E8:E\" &amp; LastRow)\n\n                ElseIf strSelected = \"VEL\" Then\n                LastRow = Worksheets(\"VEL\").Range(\"E\" &amp; Rows.Count).End(xlUp).row\n                Set rngList = Worksheets(\"VEL\").Range(\"E8:E\" &amp; LastRow)\n\n            End If\n                For Each PP In rngList\n                   SearchSelectPPComboBox.AddItem PP.Offset(, 1)\n            Next PP\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "insert"], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1439369790, "creation_date": 1439369790, "answer_id": 31960464, "question_id": 31960139, "link": "https://stackoverflow.com/questions/31960139/insert-rows-into-the-specified-columns/31960464#31960464", "title": "Insert rows into the specified columns", "body": "<p>You should just be able to use the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195769(v=office.11).aspx\" rel=\"nofollow\"><code>.Insert</code> Method</a>, passing in <code>xlDown</code> to shift rows down.</p>\n\n<p>The below will only insert new cells in columns A:D.</p>\n\n<pre><code>Sub insertRow()\n    Dim z As Integer, intLR As Integer\n    intLR = Range(\"A5536\").End(xlUp).Row\n\n    For z = intLR To 2 Step -1\n        If Cells(z, 1).Value &lt;&gt; Cells(z - 1, 1).Value Then\n            Range(Cells(z, 1), Cells(z, 4)).Insert xlDown\n        End If\n    Next z\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5201464"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 31960464, "answer_count": 1, "score": 2, "last_activity_date": 1439369790, "creation_date": 1439368839, "last_edit_date": 1531164843, "question_id": 31960139, "link": "https://stackoverflow.com/questions/31960139/insert-rows-into-the-specified-columns", "title": "Insert rows into the specified columns", "body": "<p>I have a little problem. I would like to insert the rows only in columns A - D. This code inserts a new row if it aligns with the upper value.</p>\n\n<pre><code>Dim z     As Integer\nDim intLR As Integer\n\nintLR = Range(\"A5536\").End(xlUp).Row\n\nFor z = intLR To 2 Step -1\n  If Cells(z, 1).Value &lt;&gt; Cells(z - 1, 1).Value Then\n    Cells(z, 1).EntireRow.Insert\n  Else\n\n  End If\nNext z\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 2, "creation_date": 1439368541, "post_id": 31959959, "comment_id": 51827755, "body": "For me it&#39;s not clear what your actual question is besides that you want us to write some code."}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "reply_to_user": {"reputation": 14110, "user_id": 2416958, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/w8lZr.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2416958/stefan"}, "edited": false, "score": 0, "creation_date": 1439368635, "post_id": 31959959, "comment_id": 51827810, "body": "Apologies. I&#39;ll update to include what&#39;s actually going wrong with this code."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1439369302, "post_id": 31959959, "comment_id": 51828272, "body": "@user1996971 : When editing your post, use the space and formatting to make it more readable (preview right under edition box). Use 2 line returns to actually change line, use ** to mark <b>surrounded text in bold</b>, ..."}, {"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1439369592, "post_id": 31959959, "comment_id": 51828484, "body": "Is there any particular part where the formatting is off?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1439370305, "post_id": 31959959, "comment_id": 51828983, "body": "Formatting: every block must be indented 4 spaces relative to the enclosing block. So at the end before <code>End Sub</code>, the <code>Wend</code> must be indented 4 spaces and before that the <code>End If</code> must be indented 8 spaces. Block indentations help giving the reader the overview of your program structure."}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1439372218, "post_id": 31961236, "comment_id": 51830406, "body": "Thanks for the suggestion. I edited out the OriginalN and went with a different approach. Still not working yet!"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 2, "last_activity_date": 1439371807, "creation_date": 1439371807, "answer_id": 31961236, "question_id": 31959959, "link": "https://stackoverflow.com/questions/31959959/looking-to-make-a-data-sorting-vba-script-for-excel-i-have-most-of-it-written/31961236#31961236", "title": "Looking to make a data sorting VBA script for excel. I have most of it written, but I&#39;m stuck on one line", "body": "<p>The only explanation is that <code>ElseIf N = OriginalN Then</code> is never true, which means that in <code>N = Application.WorksheetFunction.CountA(Entry)</code> the count never yields <code>N</code>. You can take the program into the debugger to check this.</p>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439372178, "creation_date": 1439368288, "last_edit_date": 1439372178, "question_id": 31959959, "link": "https://stackoverflow.com/questions/31959959/looking-to-make-a-data-sorting-vba-script-for-excel-i-have-most-of-it-written", "title": "Looking to make a data sorting VBA script for excel. I have most of it written, but I&#39;m stuck on one line", "body": "<p><strong>EDIT: I've updated the question to be more specific as to what the issue is. After the code is posted, I go into detail about what's going wrong, and the advice I'm looking for.</strong></p>\n\n<p>Thanks for all the help so far. I'll be more thorough in this post than I've been before. </p>\n\n<p><a href=\"https://i.stack.imgur.com/2B6jE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2B6jE.png\" alt=\"Sample Dataset\"></a>\nThe dataset I have looks like this. Columns A and B contain data for each person, represented by and ID number. C contains the numbers of \"entries\" available for them. There are four Headers for each entry. D to G are the cells I want to populate.</p>\n\n<p>The rest of the rows contain the actual data we want to sort. Column H tell us whether or not there is data available. Column I contains the same ID number again (matches with row A). ID 505 has 8 entries (only 2 shown), each with four headers. What I want to do is write a script that will copy that will first, create 7 more rows for ID 505, and past the four headers of Entry 1 into the first, Entry 2 into the second, and so on. Where there is only 1 Entry, there is no need to make a new row. Because there are 400 IDs, and some with 36 entries, I'm trying to make this as automated as possible. A previous approach had me write a script with 1000s of lines, having each entry defined as a separate Dim, with statements like <code>If Entry7 &lt;&gt; \"\" and Entry 8 = \"\" Then</code> followed by the specific instructions for copying and pasting the 8 lines. This, however, would be a very long script. </p>\n\n<p>What I have so far is as follows.</p>\n\n<pre><code>Sub EntrySort()\n\n\nDim i As Long, k As Long, N As Long, Entry As Range, Rng As Range\n\n\n    i = 2\n    While i &lt;= 400\n        Set Entry = Range(\"K\" &amp; i)\n        For k = Columns(\"K\").Column To Columns(\"GB\").Column Step 5\n            Set Entry = Union(Entry, Cells(i, k))\n        Next k\n        Set Rng = Range(\"D\" &amp; i)\n        N = Application.WorksheetFunction.CountA(Entry)  \n\n        'count the number of entries for each ID'\n        If Rng.Offset(, 4) = False Then\n            i = i + 1 'skip IDs with no data'\n        ElseIf N = 1 Then\n            Rng.Offset(, 7).Resize(, 4).Copy\n            Rng.PasteSpecial Paste:=xlPasteValues\n            i = i + 2\n\n        ElseIf N &lt;&gt; 1\n            For X = 1 N\n                Rng.Offset(, -3).Resize(, 670).Copy\n                Rng.Offset(1, -3).Insert Shift:=xlDown \n                'This should create the number of rows required, based on the number of entries\n            Next X\n        Else\n            Rng.Offset(, 7 + 5 * N).Resize(, 4).Copy\n            Rng.Offset(N, 0).PasteSpecial Paste:=xlPasteValues \n            'after the new rows are made, this should copy the data from each entry and past it into its own row.'\n            N = N - 1\n        End If\n\n        N = N - 1\n\n    Wend\nEnd Sub\n</code></pre>\n\n<p>Where the problem seems to lie is in <code>X to OriginalN... Next</code> statement. I want it to repeat the making of a new line N times, but when I execute this code, it seems to skip over that part. Is this the correct annotation? I've used OriginalN as an integer, since the original value for N (as the next few lines will start to decrease it). Is this the correct approach? It seems as if the script is skipping these two lines entirely and going straight to the copy/paste part.</p>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5003768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f4a551a61cc7918b512efcfb99d4e62?s=128&d=identicon&r=PG", "display_name": "Alfred Emsenhuber", "link": "https://stackoverflow.com/users/5003768/alfred-emsenhuber"}, "edited": false, "score": 0, "creation_date": 1439751909, "post_id": 31977379, "comment_id": 51978436, "body": "Thank you very much for your answer. I will try it as soon as i am back at work and give you feedback after i tested it."}, {"owner": {"reputation": 45, "user_id": 5003768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f4a551a61cc7918b512efcfb99d4e62?s=128&d=identicon&r=PG", "display_name": "Alfred Emsenhuber", "link": "https://stackoverflow.com/users/5003768/alfred-emsenhuber"}, "edited": false, "score": 0, "creation_date": 1439798509, "post_id": 31977379, "comment_id": 51990596, "body": "Okay, your answer seems to work but there is still one thing missing. I need this code to be executed every time a new entry is added in table 1. And then the sum needs to be inserted in table 2."}, {"owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "reply_to_user": {"reputation": 45, "user_id": 5003768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f4a551a61cc7918b512efcfb99d4e62?s=128&d=identicon&r=PG", "display_name": "Alfred Emsenhuber", "link": "https://stackoverflow.com/users/5003768/alfred-emsenhuber"}, "edited": false, "score": 0, "creation_date": 1439866919, "post_id": 31977379, "comment_id": 52023939, "body": "@AlfredEmsenhuber You shouldn&#39;t need to insert it into a table, you should just be able to use the query in place of the table (or LEFT/RIGHT JOIN it in to existing query).  In the majority of cases it is bad practice to insert sums into tables, from other tables. However, if you are strongly set on doing it, look at <a href=\"https://support.office.com/en-ca/article/Create-a-data-macro-b1b94bca-4f17-47ad-a66d-f296ef834200?CorrelationId=8142a824-e190-4c88-b98b-f7bd30546594&amp;ui=en-US&amp;rs=en-CA&amp;ad=CA\" rel=\"nofollow noreferrer\">data macros</a>"}, {"owner": {"reputation": 45, "user_id": 5003768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f4a551a61cc7918b512efcfb99d4e62?s=128&d=identicon&r=PG", "display_name": "Alfred Emsenhuber", "link": "https://stackoverflow.com/users/5003768/alfred-emsenhuber"}, "edited": false, "score": 0, "creation_date": 1439894861, "post_id": 31977379, "comment_id": 52037304, "body": "Okay i see. Well then thank you very much for your help. I&#39;ll change the database to use your code as query instead of saving it into a table."}], "tags": [], "owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "is_accepted": true, "score": 1, "last_activity_date": 1439424027, "creation_date": 1439424027, "answer_id": 31977379, "question_id": 31959597, "link": "https://stackoverflow.com/questions/31959597/summing-columns-up-with-some-exceptions/31977379#31977379", "title": "Summing Columns up with some exceptions", "body": "<p>This below will return the sum of each record for a particular Object 'MyObj' starting from the last instance of a 'Special' entry (inclusive).</p>\n\n<p><em>(Untested)</em></p>\n\n<pre><code>SELECT Sum(a.Amount) AS TheSum\nFROM tblMyTable a\nWHERE ID_PK&gt; = nz((\n    SELECT max(ID_PK) \n    FROM tblMyTable \n    WHERE Object=a.Object AND IsSpecial=1\n),0) \nAND a.Object='MyObj'\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5003768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f4a551a61cc7918b512efcfb99d4e62?s=128&d=identicon&r=PG", "display_name": "Alfred Emsenhuber", "link": "https://stackoverflow.com/users/5003768/alfred-emsenhuber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 31977379, "answer_count": 1, "score": 0, "last_activity_date": 1594643035, "creation_date": 1439367139, "last_edit_date": 1594643035, "question_id": 31959597, "link": "https://stackoverflow.com/questions/31959597/summing-columns-up-with-some-exceptions", "title": "Summing Columns up with some exceptions", "body": "<p>I am working on a database with two different tables.<br>\nThe first contains every change in the database like a transaction table. It contains the object that was bought/sold, how many of them where bought/sold, when this tranaction happend and in which place.\nThe second table contains the total value of every object that should be available in those places.</p>\n\n<p>Now here is my question:<br>\nI want to automaticly sum up every entry with the same object and location inside of table one and save this value inside of table two.<br>\nBUT<br>\nSometimes there are special entrys in table one which should not be summed up with the other values. They should overwrite the value.</p>\n\n<p>I have an example of how this summing up should look like:</p>\n\n<pre><code>n = normal value, s = special value   \nn:  1  sum:  1  \nn:  2  sum:  3  \ns:  7  sum:  7  \nn:  5  sum: 12  \nn:  4  sum: 16  \nn:  7  sum: 23  \ns: 20  sum: 20  \n</code></pre>\n\n<p>To help you help me I have some additional informations:<br>\nThere are 4 columns inside of table one</p>\n\n<p>The first one is called object and contains the object number for which this entry takes effect.</p>\n\n<p>The second column contains the amount of that object. Whether it was bought or sold.</p>\n\n<p>The third column tells me on which locations this transaction belongs to. Which also means that every object has different amounts depending on the location.</p>\n\n<p>The fourth column contains an information why this transaction happend. It tells me if this transaction happend because I bought something or because I sold something OR because I counted my stock.<br>\nThis is the special indicator which should tell my database not to sum up this value but instead overwrite the previous one with this.</p>\n\n<p>The fifth and last column contains the date when this transaction happend. This is very important because the whole table is sorted by the date. And it tells when those special values come in place.</p>\n\n<p>The other table just contains the summed up value for every object in every location.</p>\n"}, {"tags": ["excel", "copy", "format", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1439367266, "post_id": 31959418, "comment_id": 51827050, "body": "What is in the cells N2 to N4?"}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1439367886, "post_id": 31959418, "comment_id": 51827410, "body": "Formulas. N2: =37*(Count(A:A)). N3: =SUM(C12:I12) N4: =N3/COUNT(A:A)."}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1439379323, "post_id": 31959418, "comment_id": 51835238, "body": "Why is &quot;.Range(&quot;P2&quot;).Value = .Range(&quot;N2&quot;).Value&quot; and &quot;.Range(&quot;P4&quot;).Value = .Range(&quot;N4&quot;).Value&quot; not working when &quot;.Range(&quot;P3&quot;).Value = .Range(&quot;N3&quot;).Value&quot; is? I believe that the error is here somewhere."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1439386217, "post_id": 31959418, "comment_id": 51840488, "body": "First off, you shouldn&#39;t use &quot;formula&quot; as a variable name; it is poor form to use terms defined elsewhere, even if Excel allows you to (ie: formula refers to the property of a range, but Excel allows you to use it outside of that context. Also, I advise you to look up &quot;.FormulaR1C1&quot;, which is a method of creating a formula in a cell, which automatically acknowledges that cell&#39;s position and uses it to change how the formula is displayed. Your find/replace of # with row #&#39;s is an inneficient way of doing this."}], "owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1439367114, "creation_date": 1439366561, "last_edit_date": 1531161705, "question_id": 31959418, "link": "https://stackoverflow.com/questions/31959418/copy-values-not-formulas-in-the-same-worksheet", "title": "Copy values, not formulas in the same worksheet", "body": "<p>I want to copy three cells (\"N2\", \"N3\" and \"N4\") in a specific worksheet to three other cells (\"P2\", \"P3\" and \"P4\") in the same worksheet. Currently the only value that is copied correctly is cell \"N3\". Cell \"P4\" is empty and cell \"P2\" just contains \"0:00\" (using [t]:mm format). How do I make all cells copy correctly? You can see the code below. Have also tried using \".copy\" and \".PasteSpecial xlPasteValues\", but this didn't work either.</p>\n\n<pre><code>Private Sub adjustSheets()\n    Dim ws As Worksheet\n    Dim cnt&amp;, lRow&amp;, sRow&amp;\n    Dim formula$\n\n    Application.DisplayAlerts = False\n\nFor Each ws In ThisWorkbook.Sheets\n    If ws.Range(\"Z1\") &lt;&gt; \"Specific_Sheet\" Then GoTo ContLoop\n\n    ws.Range(\"Block\").EntireRow.Delete\n\n    With ws\n        lRow = .Cells(Rows.Count, \"B\").End(xlUp).row\n        cnt = 1\n        formula = vbNullString\n        For sRow = 12 To lRow Step 7\n            If cnt = 1 Then\n                formula = \"=\"\n            Else\n                formula = formula &amp; \"+\"\n            End If\n\n            formula = formula &amp; Replace(\"SUM(C#:I#)\", \"#\", sRow)\n            cnt = cnt + 1\n        Next\n        ' apply formula\n        .Range(\"N4\").formula = formula\n\n            .Range(\"P2\").Value = .Range(\"N2\").Value\n.Range(\"P3\").Value = .Range(\"N3\").Value\n.Range(\"P4\").Value = .Range(\"N4\").Value\n\n    End With\n\nContLoop:\n    If ws.Visible = xlSheetVisible Then Application.Goto ws.Range(\"A1\"), True\nNext\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "edited": false, "score": 2, "creation_date": 1439366376, "post_id": 31959317, "comment_id": 51826506, "body": "Use <code>Call Application.Calculate</code>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "edited": false, "score": 0, "creation_date": 1439370940, "post_id": 31959747, "comment_id": 51829474, "body": "I tried ur solution but it still doesn&#39;t work.. the problem is that i have linked formulas in each column ..when i change one of them ..all cells should refresh it result without clicking anywhere"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "edited": false, "score": 0, "creation_date": 1439371163, "post_id": 31959747, "comment_id": 51829646, "body": "You mean that you are already in <code>Automatic calculation</code> mode? And that <b>F9</b> didn&#39;t refresh the values? What about the code? Because if it didn&#39;t update with code nor keyboard, you might have another issue there."}, {"owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "edited": false, "score": 0, "creation_date": 1439371389, "post_id": 31959747, "comment_id": 51829816, "body": "Without &#39;Automatic CALCULATION&#39; neither F9.. because this workbook will be used by other collaborators..and not everyone know how to activate &quot;automatic calculation&quot; ..this is why i wanna something in the code that can refresh the results automatically"}, {"owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "edited": false, "score": 0, "creation_date": 1439371481, "post_id": 31959747, "comment_id": 51829885, "body": "Do you think that i should add a button that refresh the results ?"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 2, "last_activity_date": 1439367654, "creation_date": 1439367654, "answer_id": 31959747, "question_id": 31959317, "link": "https://stackoverflow.com/questions/31959317/how-to-refresh-calculation-instantaneously-in-excel/31959747#31959747", "title": "How to refresh calculation instantaneously in excel", "body": "<p>You could simply press : </p>\n\n<p><code>F9</code> to calculate the whole active workbook </p>\n\n<p><code>Shift + F9</code> to calculate the active sheet</p>\n\n<hr>\n\n<p>Anyway, here are the different options with <code>.Calculate</code> :</p>\n\n<pre><code>Sub Souma()\n\n'Use this to calculate all the open workbooks\nApplication.Calculate\n\n'Use this to calculate the whole sheet, called \"Sheet1\"\nThisWorkbook.Worksheets(\"Sheet1\").Calculate\n\n\n'Use this to calculate the cell A1 on the sheet called \"Sheet1\"\nThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Calculate\n'Use this to calculate the range A1 to D10 on the sheet called \"Sheet1\"\nThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1:D10\").Calculate\n'Use this to calculate the column A on the sheet called \"Sheet1\"\nThisWorkbook.Worksheets(\"Sheet1\").Columns(1).Calculate\n'Use this to calculate the row 1 on the sheet called \"Sheet1\"\nThisWorkbook.Worksheets(\"Sheet1\").Rows(1).Calculate\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100, "user_id": 5186587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b61b36f84c44ff11c26625abdc9060a?s=128&d=identicon&r=PG&f=1", "display_name": "Paulo", "link": "https://stackoverflow.com/users/5186587/paulo"}, "is_accepted": false, "score": 1, "last_activity_date": 1439841681, "creation_date": 1439841681, "answer_id": 32058698, "question_id": 31959317, "link": "https://stackoverflow.com/questions/31959317/how-to-refresh-calculation-instantaneously-in-excel/32058698#32058698", "title": "How to refresh calculation instantaneously in excel", "body": "<p>Copy and paste the code below to your VBA project:</p>\n\n<pre><code>Private Sub Workbook_Open()\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>This code should automatically run after you open the Excel file, enabling automatic calculation in <em>all</em> opened files. </p>\n"}, {"comments": [{"owner": {"reputation": 549, "user_id": 5624836, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0c64388f8bc649d7aa0d2a73af663bbc?s=128&d=identicon&r=PG&f=1", "display_name": "TimFinnegan", "link": "https://stackoverflow.com/users/5624836/timfinnegan"}, "edited": false, "score": 0, "creation_date": 1616093343, "post_id": 60088526, "comment_id": 117902459, "body": "This should be the accepted answer! The others did not work for me!"}], "tags": [], "owner": {"reputation": 131, "user_id": 5188429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI05O.jpg?s=128&g=1", "display_name": "Spere", "link": "https://stackoverflow.com/users/5188429/spere"}, "is_accepted": false, "score": 2, "last_activity_date": 1580968618, "creation_date": 1580968618, "answer_id": 60088526, "question_id": 31959317, "link": "https://stackoverflow.com/questions/31959317/how-to-refresh-calculation-instantaneously-in-excel/60088526#60088526", "title": "How to refresh calculation instantaneously in excel", "body": "<p>To force all formulas to update, including custom vba formulas, execute the following in VBA:</p>\n\n<pre><code>Application.CalculateFullRebuild\n</code></pre>\n\n<p>This can also be executed from the VBA immediate window.</p>\n\n<p>More documentation here:\n<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.calculatefullrebuild\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.application.calculatefullrebuild</a></p>\n"}], "owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39704, "favorite_count": 2, "answer_count": 3, "score": 4, "last_activity_date": 1580968618, "creation_date": 1439366308, "last_edit_date": 1439367165, "question_id": 31959317, "link": "https://stackoverflow.com/questions/31959317/how-to-refresh-calculation-instantaneously-in-excel", "title": "How to refresh calculation instantaneously in excel", "body": "<p>I have a problem in refreshing the cell's calculation.</p>\n\n<p>In other words, I have many columns where i have a formula or macro in each one of them.</p>\n\n<p>But the problem is that i should absolutely activate the option \" automatic calculation\" in the excel options or i should save then the new results appear.</p>\n\n<p>Now, I would insert something in the macro that can refresh me the results instantaneously.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "ms-access", "adodb", "oledbconnection"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1439371601, "post_id": 31958994, "comment_id": 51829967, "body": "Is the &quot;network share drive&quot; mapped in Windows? Is the share a Windows / SAMBA share? Do you have the proper permissions on this share and these permissions were entered when you mapped the share? Did you try to open it whith the Access Database on the local machine (for example C:\\tmp&#41;?"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 3, "creation_date": 1439373268, "post_id": 31958994, "comment_id": 51831204, "body": "What does Initialize.GetDbConnectionString return?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1450754591, "post_id": 31958994, "comment_id": 56557604, "body": "What happens when you manually try and open that file from the users PC? It could be that the windows user doesn&#39;t have access. Is the path a UNC or a drive letter?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1450803552, "post_id": 31958994, "comment_id": 56583053, "body": "If it&#39;s Windows 7 there&#39;s a known issue with network drives where sometimes the drive is still refreshing and files are locked by &quot;another user&quot; as far as I know this still hasn&#39;t been fixed in 2015."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1451075864, "post_id": 31958994, "comment_id": 56674454, "body": "If the problem occurs only on &#39;one PC&#39; then this PC itself will probably by the source of the problem. Have you looked into <a href=\"https://www.youtube.com/watch?v=J6vUOyxmU1o\" rel=\"nofollow noreferrer\">Windows Event Log</a> on that particulare PC to get more information about what went wrong? Is this one PC somehow specific? Howthis one PC difers from the other PC&#39;s where your code works?"}], "answers": [{"comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1450877429, "post_id": 32065521, "comment_id": 56614356, "body": "Any results after repairing the Office?"}], "tags": [], "owner": {"reputation": 61, "user_id": 5218139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc3a0a24c537cab8ad1503e5712ccb6?s=128&d=identicon&r=PG", "display_name": "tawfiq", "link": "https://stackoverflow.com/users/5218139/tawfiq"}, "is_accepted": false, "score": 0, "last_activity_date": 1439880810, "creation_date": 1439880810, "answer_id": 32065521, "question_id": 31958994, "link": "https://stackoverflow.com/questions/31958994/unspecified-error-while-opening-an-adodb-connection/32065521#32065521", "title": "&quot;Unspecified error&quot; while opening an ADODB connection", "body": "<p>Still haven't found any solution to this issue but it seem the issue is limited to only one user.</p>\n\n<p>I wrote some test macros, in the same file which has the original macros, that open DB connection to local DB file and remote DB file. The test is successful but for some reason that one particular macro still throws that \"Unspecified Error\" in that specific users machine.</p>\n\n<p>We concluded it is most likely due to a office got corrupted. We will repair the office and hopefully that should fix the issue. Will let you know if this works.</p>\n\n<p>Thanks.</p>\n"}, {"tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": false, "score": 2, "last_activity_date": 1450751657, "last_edit_date": 1450751657, "creation_date": 1450750252, "answer_id": 34407447, "question_id": 31958994, "link": "https://stackoverflow.com/questions/31958994/unspecified-error-while-opening-an-adodb-connection/34407447#34407447", "title": "&quot;Unspecified error&quot; while opening an ADODB connection", "body": "<p>I have the same issue while making an ADODB connection from a local Excel file to another local <em>Excel</em> file.</p>\n\n<p><em>The only way how I solve it is <strong>re-opening the main</strong> Excel <strong>file</strong> from which I do the connection. Nothing else done, and the function works again.</em></p>\n\n<p>My connection function:</p>\n\n<pre><code>Sub SetConReadOnly(ByRef con1 As Object, ByRef rst1 As Object, sFile As String)\n    If con1 Is Nothing Then Set con1 = CreateObject(\"ADODB.Connection\")\n    If rst1 Is Nothing Then Set rst1 = CreateObject(\"ADODB.Recordset\")\n\n    con1.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n     \"Data Source=\" &amp; sFile &amp; \";\" &amp; _\n     \"Extended Properties=\"\"Excel 12.0;HDR=No;IMEX=1;\"\"\"\nEnd Sub\n</code></pre>\n\n<p><sub>(I use Office 2013 32-bit, Windows 7 64-bit)</sub></p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 5707527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/048a713779556c4fbe54517afaf47c2f?s=128&d=identicon&r=PG&f=1", "display_name": "Joana Brand&#227;o", "link": "https://stackoverflow.com/users/5707527/joana-brand%c3%a3o"}, "is_accepted": false, "score": 1, "last_activity_date": 1450821402, "last_edit_date": 1450821402, "creation_date": 1450793681, "answer_id": 34417826, "question_id": 31958994, "link": "https://stackoverflow.com/questions/31958994/unspecified-error-while-opening-an-adodb-connection/34417826#34417826", "title": "&quot;Unspecified error&quot; while opening an ADODB connection", "body": "<p>What is the version of your Excel?</p>\n\n<p>I had that error, and the solution was changing the provider. Try changing to this:</p>\n\n<pre><code>On Error GoTo CatchError\n Set cn = New ADODB.Connection\n\n With cn\n .provider = \"Microsoft.Mashup.OleDb.1\"\n .Properties(\"Jet OLEDB:Database Password\") = Initialize.GetDBPwd 'returns pass\n .Open Initialize.GetDbConnectionString 'returns the network DB path\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6702685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ab8c1ad035d6d973241ab26bee72eb?s=128&d=identicon&r=PG&f=1", "display_name": "Anu Abraham", "link": "https://stackoverflow.com/users/6702685/anu-abraham"}, "edited": false, "score": 0, "creation_date": 1470878469, "post_id": 38885846, "comment_id": 65132321, "body": "Insights invited from people who can decode the reason behind the behaviour"}], "tags": [], "owner": {"reputation": 1, "user_id": 6702685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92ab8c1ad035d6d973241ab26bee72eb?s=128&d=identicon&r=PG&f=1", "display_name": "Anu Abraham", "link": "https://stackoverflow.com/users/6702685/anu-abraham"}, "is_accepted": false, "score": 0, "last_activity_date": 1472713646, "last_edit_date": 1472713646, "creation_date": 1470878153, "answer_id": 38885846, "question_id": 31958994, "link": "https://stackoverflow.com/questions/31958994/unspecified-error-while-opening-an-adodb-connection/38885846#38885846", "title": "&quot;Unspecified error&quot; while opening an ADODB connection", "body": "<p>I have faced this issue and identified that this issue is specific to a Win7 64 Bit with a 32 Bit Office Installation. The solution I accidentally came across was that If I saved the file manually and rerun the code, it worked seamlessly post that. On trying to incorporate a save in the error handler and calling in the main function again did not work. However saving the file through Application.SendKeys \"^s\" and then running the file through another thread could replicate the outcome of the manual save.</p>\n\n<p>On further investigation, I identified that the error was because of certain columns in the source being added at run-time before the query and it seems the sql engine queries from a different internal raw source which is not updated with the changes unless the save happens and that was the reason for error.</p>\n"}], "owner": {"reputation": 61, "user_id": 5218139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc3a0a24c537cab8ad1503e5712ccb6?s=128&d=identicon&r=PG", "display_name": "tawfiq", "link": "https://stackoverflow.com/users/5218139/tawfiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7374, "favorite_count": 0, "answer_count": 4, "score": 6, "last_activity_date": 1594641465, "creation_date": 1439365414, "last_edit_date": 1594641465, "question_id": 31958994, "link": "https://stackoverflow.com/questions/31958994/unspecified-error-while-opening-an-adodb-connection", "title": "&quot;Unspecified error&quot; while opening an ADODB connection", "body": "<p>I am facing <strong>\"Unspecified error\"</strong> in <strong>only one PC</strong> of my users.</p>\n\n<blockquote>\n  <p>Run-time error '-2147467259 (80004005)':<br>\n  Unspecified error</p>\n</blockquote>\n\n<p>I am running the below VBA code to open a connection to Access database located in network shared drive. But <strong>the code throws the error whenever it is trying to run the <code>.Open</code> statement</strong>.</p>\n\n<p>I thought it is a driver issue and installed Access 2007 Database engine in the user's PC and replaced Provider with \"<code>Microsoft.ACE.OLEDB.12.0</code>\" but it doesn't work.</p>\n\n<p>Code:           </p>\n\n<pre><code> Dim cn As ADODB.Connection\n Dim rs As ADODB.Recordset\n Dim retVal As Boolean\n Dim strSQL As String\n retVal = False\n\n    On Error GoTo CatchError\n     Set cn = New ADODB.Connection\n\n     With cn\n     .Provider = \"Microsoft.Jet.OLEDB.4.0\"\n     .Properties(\"Jet OLEDB:Database Password\") = Initialize.GetDBPwd 'returns pass\n     .Open Initialize.GetDbConnectionString 'returns the network DB path\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1439365293, "post_id": 31958907, "comment_id": 51825861, "body": "Try something like <code>isna(vlookup(string, table, ....))</code> as your conditional formatting condition?"}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 0, "last_activity_date": 1439401177, "last_edit_date": 1439401177, "creation_date": 1439368504, "answer_id": 31960028, "question_id": 31958907, "link": "https://stackoverflow.com/questions/31958907/excel-conditional-formatting-column-base-on-comparing-two-columns/31960028#31960028", "title": "Excel, conditional formatting column base on comparing two columns", "body": "<p>In worksheet 1 you need to create a new column (say column AA) which uses the formula VLOOKUP to find the same data (if it exists) in the other sheet.  If is is not found VLOOKUP will return and error #N/A.  So you formula will look soemthing like:</p>\n\n<p>IF(ISERROR(VLOOKUP(A2, 'Sheet2'!$SA$1:$X$9999, 3, false)),\"NOT FOUND\",\"FOUND\")</p>\n\n<p>You would then add conditional formatting to sheet1 column A that references the value in your new column (AA) and sets the colour accordingly.</p>\n\n<p>If you don't know how to use VLOOKUP or get the conditional formatting to work, there are plenty of resource on the internet to help you learn these.  eg youtube channel ExcelisFun, WiseOwl.co.uk.</p>\n\n<p>I hope this helps.</p>\n\n<p>PS You do not need to use VBA to do this! In fact using a foumula can be preferable as if a single value changes it can cause the colours to be changed. </p>\n\n<p>Harvey</p>\n"}, {"comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1439401097, "post_id": 31963618, "comment_id": 51850780, "body": "You will also need to change the colour if they are not equal"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1439435712, "post_id": 31963618, "comment_id": 51863566, "body": "I think that questioner said only for equal case."}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1439378141, "creation_date": 1439378141, "answer_id": 31963618, "question_id": 31958907, "link": "https://stackoverflow.com/questions/31958907/excel-conditional-formatting-column-base-on-comparing-two-columns/31963618#31963618", "title": "Excel, conditional formatting column base on comparing two columns", "body": "<p>If you want to use VBA, try as follow:</p>\n\n<pre><code>Public Sub findDuplicate()\n\n    Dim sh1row, sh2Row As Long\n\n    For sh1row = 1 To 20 'loop all row from Sheet2 (if more than 20, modify it)\n\n        For sh2Row = 1 To 2000 'loop all row from Sheet1 (if more than 2000, modify it)\n\n            'If A cell are equal\n            If Sheets(\"Sheet1\").Range(\"A\" &amp; sh2Row) = Sheets(\"Sheet2\").Range(\"A\" &amp; sh1row) Then\n\n                'Change background color to green.\n                Sheets(\"Sheet1\").Range(\"A\" &amp; sh2Row).Interior.Color = RGB(0, 255, 0)\n\n            End If\n\n        Next sh2Row\n\n    Next sh1row\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 5218087, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/958024560913177/picture?type=large", "display_name": "stanedav", "link": "https://stackoverflow.com/users/5218087/stanedav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 31960028, "answer_count": 2, "score": 0, "last_activity_date": 1439401177, "creation_date": 1439365132, "question_id": 31958907, "link": "https://stackoverflow.com/questions/31958907/excel-conditional-formatting-column-base-on-comparing-two-columns", "title": "Excel, conditional formatting column base on comparing two columns", "body": "<p>I have excel worksheet, with two sheets. First one (Worksheet 1) is big table (about 2000 rows), and in second (Worksheet2) I have only about 20 rows.</p>\n\n<p>I need to check, if string in first column in each row in worksheet 1 is already in Worksheet 2, if so, make it green.</p>\n\n<p>Thanks for solutions, both EXCEL or VBA will be appreciated :)</p>\n"}, {"tags": ["vba", "excel", "textbox", "userform"], "comments": [{"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1439365243, "post_id": 31958713, "comment_id": 51825833, "body": "Is this a userform in Excel or a form within Access?"}, {"owner": {"reputation": 210, "user_id": 5196715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e3f6c7924f8b9177c4cfb1fc8f7344?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin K", "link": "https://stackoverflow.com/users/5196715/ashwin-k"}, "edited": false, "score": 1, "creation_date": 1439365384, "post_id": 31958713, "comment_id": 51825902, "body": "Are you trying to retrieve number from password.output.Caption? Because Val function returns the numbers contained in string, else it returns 0."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5024056"}, "edited": false, "score": 0, "creation_date": 1439365437, "post_id": 31958713, "comment_id": 51825932, "body": "Actually I wanna retrieve string . Any ideas how could I do it? I am new to vba"}, {"owner": {"reputation": 210, "user_id": 5196715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e3f6c7924f8b9177c4cfb1fc8f7344?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin K", "link": "https://stackoverflow.com/users/5196715/ashwin-k"}, "edited": false, "score": 0, "creation_date": 1439365548, "post_id": 31958713, "comment_id": 51825990, "body": "Try this.  <code>Dim value = password.output.Caption</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5024056"}, "edited": false, "score": 0, "creation_date": 1439365742, "post_id": 31958713, "comment_id": 51826093, "body": "Nope this does not works for me"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5024056"}, "edited": false, "score": 0, "creation_date": 1439365834, "post_id": 31958713, "comment_id": 51826150, "body": "Thanks now its working :D"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1439366188, "post_id": 31958713, "comment_id": 51826372, "body": "If that line of code is working (I&#39;m pretty skeptic), it isn&#39;t really clean one, because you declare and assign a value at the same..."}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1439367716, "last_edit_date": 1439367716, "creation_date": 1439366039, "answer_id": 31959213, "question_id": 31958713, "link": "https://stackoverflow.com/questions/31958713/getting-value-from-textbox-and-storing-it-in-a-variable-in-vba/31959213#31959213", "title": "Getting value from textbox and storing it in a variable in VBA", "body": "<p>Here you go :</p>\n\n<pre><code>Dim ValuePw As String\n\nValuePw = Password.output.Value\nPassword.game.Value = ValuePw\n</code></pre>\n\n<p><code>.Caption</code> is used for <em>Labels' content</em> and <em>UserForms' title</em>, for <em>TextBoxes' content</em>, it is <code>.Value</code></p>\n"}, {"tags": [], "owner": {"reputation": 210, "user_id": 5196715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e3f6c7924f8b9177c4cfb1fc8f7344?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin K", "link": "https://stackoverflow.com/users/5196715/ashwin-k"}, "is_accepted": false, "score": 3, "last_activity_date": 1439366391, "creation_date": 1439366391, "answer_id": 31959354, "question_id": 31958713, "link": "https://stackoverflow.com/questions/31958713/getting-value-from-textbox-and-storing-it-in-a-variable-in-vba/31959354#31959354", "title": "Getting value from textbox and storing it in a variable in VBA", "body": "<p>Val function returns the numbers contained in string, else it returns 0.</p>\n\n<p>Try this. </p>\n\n<pre><code> Dim value As String\n value = password.output.Caption\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5024056"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11952, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1487251839, "creation_date": 1439364571, "last_edit_date": 1487251839, "question_id": 31958713, "link": "https://stackoverflow.com/questions/31958713/getting-value-from-textbox-and-storing-it-in-a-variable-in-vba", "title": "Getting value from textbox and storing it in a variable in VBA", "body": "<p>I am trying to make an application to get the data from the textbox and store it in a variable for further uses thou I am getting value of it as 0 . Anyone can help out? </p>\n\n<pre><code>Dim value As Long\n\nvalue = Val(password.output.Caption)\ngame.Caption = value\n</code></pre>\n\n<p>In the above code password is my form name and output is the name of field from where it shall get data and then later it is changing the value of game field to the value fetched of output and I am getting 0 as the value . What to do guys? Any help will be appreciated  </p>\n\n<h2><strong>UPDATE</strong></h2>\n\n<p>I would actually like to retrieve the string any idea how to do it?</p>\n"}, {"tags": ["vba", "popup"], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 5201769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9fef359c4018ee9eb8a7bfb06040eff8?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5201769/chris"}, "is_accepted": true, "score": 0, "last_activity_date": 1439422937, "creation_date": 1439422937, "answer_id": 31977223, "question_id": 31958610, "link": "https://stackoverflow.com/questions/31958610/open-pop-up-in-the-same-current-page-in-ie11/31977223#31977223", "title": "Open pop up in the same, current page in IE11", "body": "<p>@Bond taught me a workaround here - instead of clicking on the link that will result in the pop-up, you can always just re-navigate to this link by referencing its href (as in the source code of the original page you'd click on). This keeps the window the same but changes the page to display the pop-up</p>\n"}], "owner": {"reputation": 155, "user_id": 5201769, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9fef359c4018ee9eb8a7bfb06040eff8?s=128&d=identicon&r=PG&f=1", "display_name": "chris", "link": "https://stackoverflow.com/users/5201769/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 31977223, "answer_count": 1, "score": 1, "last_activity_date": 1442371034, "creation_date": 1439364308, "last_edit_date": 1442371034, "question_id": 31958610, "link": "https://stackoverflow.com/questions/31958610/open-pop-up-in-the-same-current-page-in-ie11", "title": "Open pop up in the same, current page in IE11", "body": "<p>Is there a way to use VBA to force a pop up (generated by clicking on a link on a website) to open in the same window of the website on which your VBA code clicks the link? So the pop up actually replaces the original website.</p>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1439366337, "post_id": 31958559, "comment_id": 51826475, "body": "Even in VBA, you&#39;ll have to redefine the whole range, but if it is a continuous data set, you can get it automatically so it&#39;ll be effortless afterwards."}, {"owner": {"reputation": 75, "user_id": 4869070, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51c8b5ead6e5214c15e4600e3a171e03?s=128&d=identicon&r=PG&f=1", "display_name": "Kartiki ", "link": "https://stackoverflow.com/users/4869070/kartiki"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1439372499, "post_id": 31958559, "comment_id": 51830596, "body": "what do you mean by continuous data set?"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 1, "creation_date": 1439373576, "post_id": 31958559, "comment_id": 51831424, "body": "Are you allowed to place the values in a table (ListObject)? If you can, then it is easy to create a dynamic named range which you can use in your chart, and it will automatically include new data points."}], "owner": {"reputation": 75, "user_id": 4869070, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51c8b5ead6e5214c15e4600e3a171e03?s=128&d=identicon&r=PG&f=1", "display_name": "Kartiki ", "link": "https://stackoverflow.com/users/4869070/kartiki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1439366366, "creation_date": 1439364137, "last_edit_date": 1439366366, "question_id": 31958559, "link": "https://stackoverflow.com/questions/31958559/add-data-in-active-chart-in-excel-through-vba", "title": "Add data in Active chart in Excel through VBA", "body": "<p>I have a chart which updates every second based on values copied in worksheet from another worksheet.</p>\n\n<p>Every time I have to update the chart with entire range.</p>\n\n<p>Is there a way to edit the chart range to add data points rather than updating the chart with full data?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 0, "last_activity_date": 1439364960, "creation_date": 1439364960, "answer_id": 31958844, "question_id": 31958214, "link": "https://stackoverflow.com/questions/31958214/removing-object-required-errors/31958844#31958844", "title": "Removing object required errors", "body": "<p>You variables (<code>R</code> and <code>rng</code>) are inconsistent, you should be using<br>\n<code>If TypeName(R) &lt;&gt; \"Range\" Then</code></p>\n\n<p>That said, suggest you try checking for a valid range as below:</p>\n\n<pre><code>    Dim R As Range\n    On Error Resume Next\n    Set R = Application.InputBox(\"Select cells To be deleted\", , , , , , , 8)\n    On Error GoTo 0\n    If R Is Nothing Then\n        MsgBox \"Cancelled\", vbInformation\n        Exit Sub\n    Else\n        R.Delete\n    End If\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 31958844, "answer_count": 1, "score": 1, "last_activity_date": 1439365135, "creation_date": 1439363148, "last_edit_date": 1439365135, "question_id": 31958214, "link": "https://stackoverflow.com/questions/31958214/removing-object-required-errors", "title": "Removing object required errors", "body": "<p>I am performing a delete function and I tried removing the \"object required\" whenever there is no or invalid user input.</p>\n\n<p>However when I do so, it does not perform the delete action. </p>\n\n<p>I need help to correct my mistake!</p>\n\n<pre><code>Sub deletetry2()\n\n    Dim R As Range\n    On Error Resume Next\n    Set R = Application.InputBox(\"Select cells To be deleted\", , , , , , , 8)\n    On Error GoTo 0\n    If TypeName(rng) &lt;&gt; \"Range\" Then\n        MsgBox \"Cancelled\", vbInformation\n        Exit Sub\n    Else\n        R.delete\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439362024, "post_id": 31957605, "comment_id": 51824022, "body": "what is the problem exactly? your code throws an error, doesn&#39;t work as expected? ..."}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "reply_to_user": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439362066, "post_id": 31957605, "comment_id": 51824039, "body": "It simply does nothing"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439362236, "post_id": 31957605, "comment_id": 51824134, "body": "you didn&#39;t provide enough arguments to removeduplicates (according to msdn) try: <code>ActiveSheet.Range(&quot;B&quot; &amp; i, &quot;QC&quot; &amp; i).RemoveDuplicates Columns:=Array(2,3), Header:=xlYes</code> I don&#39;t know if you have a header. But try if this removes duplicates of the columns B and C or wherever you know duplicates are"}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "reply_to_user": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439362555, "post_id": 31957605, "comment_id": 51824315, "body": "Sub delete() Dim i As Long i = 1      While Sheets(&quot;Test&quot;).Cells(i, 1).Value &lt;&gt; &quot;end&quot;         Sheets(&quot;Test&quot;).Range(&quot;B&quot; &amp; i, &quot;QC&quot; &amp; i).RemoveDuplicates Columns:=Array(2, 3), Header:=xlNo         i = i + 1              Wend  End Sub  Now and it still does nothing."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439362624, "post_id": 31957605, "comment_id": 51824360, "body": "could you please provide a screenshot of your data (few columns are enough) so i can test it."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 1, "creation_date": 1439362632, "post_id": 31957605, "comment_id": 51824366, "body": "let me confirm, what you want to remove, duplicate row or duplicate cells?"}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439363039, "post_id": 31957605, "comment_id": 51824587, "body": "Cells row by row  Picture: <a href=\"http://picload.org/image/iwgoicp/now.jpg\" rel=\"nofollow noreferrer\">picload.org/image/iwgoicp/now.jpg</a>"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439363575, "post_id": 31957605, "comment_id": 51824870, "body": "does it work when you mark the cells on the sheet and use the <code>remove duplicate</code> function on the ribbon? and record the macro too. If Excel says: &quot;no duplicates found&quot; your code isn&#39;t wrong I guess"}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439364202, "post_id": 31957605, "comment_id": 51825212, "body": "No matter what i do it doesn&#39;t work 0.o AS it seems the ribbon button tries to to delete duplicates from columns not range or rows. that&#39;s what I believe at least."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "reply_to_user": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439364919, "post_id": 31957605, "comment_id": 51825656, "body": "That&#39;s the reason why @Nicolas asked what you want to remove. because <code>remove duplicates</code> checks the content of the columns. for example: you have &quot;28 mm&quot; in 3 columns. If you remove duplicates with these 3 columns as basis. Excel will delete all rows which have &quot;28 mm&quot; as value -&gt; deleting the &quot;height&quot; information from all articles which have &quot;28 mm&quot; as height, except the first one"}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439365056, "post_id": 31957605, "comment_id": 51825727, "body": "Can you provide an alternative?"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439366078, "post_id": 31957605, "comment_id": 51826314, "body": "probably, but you have to tell us what you want to delete exactly. the best is you provide us a screenshot example what the result after the code execution shall be"}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439367110, "post_id": 31957605, "comment_id": 51826953, "body": "First delete the duplicates from the sample data above  <a href=\"http://picload.org/image/iwglcdc/afterdelete.jpg\" rel=\"nofollow noreferrer\">picload.org/image/iwglcdc/afterdelete.jpg</a>  than join the remaining values seperated by comma  <a href=\"http://picload.org/image/iwglcdp/final.jpg\" rel=\"nofollow noreferrer\">picload.org/image/iwglcdp/final.jpg</a>  This is what I&#39;m looking for"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439367771, "post_id": 31957605, "comment_id": 51827340, "body": "is it possible for you to edit your question and post the pictures there?"}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439368264, "post_id": 31957605, "comment_id": 51827610, "body": "not enough points to post pictures yet, sorry :-( But I can post the links there :-)"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1439368750, "post_id": 31957605, "comment_id": 51827890, "body": "this is also a solution, but you should reupload it somewhere else, because these pics are blocked at my current location. otherwise i&#39;m able to help in approx. 12 hours"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439375624, "post_id": 31962428, "comment_id": 51832774, "body": "As awesome as this looks, I get an error at this line:  wsTemp.Range(&quot;A1&quot;).Resize(UBound(v, 2), 1).Value = Application.Transpose(v)  Type mismatch"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439375877, "post_id": 31962428, "comment_id": 51832922, "body": "What is the value of UBound(v,2) when you get the error?"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439376026, "post_id": 31962428, "comment_id": 51833024, "body": "It is probably in a row with only 1 entry, ie a value in column A and nothing to the right of it. Maybe just add a condition to check if LastCol = 1 then skip that row."}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439378373, "post_id": 31962428, "comment_id": 51834575, "body": "the value of Ubound(v,2) is &lt;type mismatch&gt;. To be totally honest: I don&#39;t even understand the code below the LastCol=.Cells(i, .Columns.Count).End(xlToLeft).Column. Where would you put that If condition?"}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439381747, "post_id": 31962428, "comment_id": 51836840, "body": "Figured it out myself, I still get an error every few lines because of unknown reasons. I just restart the Macro and the error pops up at a later point. it&#39;s mostly empty rows that seem to cause troubles and most of the time its the .Cells(i, 1).Resize(1, UBound(v, 1)).Value = Application.Transpose(v) which is causing troubles  sometimes i look at the values and there is no evidence of any error at all"}, {"owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439385321, "post_id": 31962428, "comment_id": 51839757, "body": "Thanks a lot! You are awesome!"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "edited": false, "score": 0, "creation_date": 1439385971, "post_id": 31962428, "comment_id": 51840270, "body": "You&#39;re welcome. If you are happy with my answer, please accept it by clicking the tick next to it."}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": true, "score": 0, "last_activity_date": 1439382631, "last_edit_date": 1439382631, "creation_date": 1439374889, "answer_id": 31962428, "question_id": 31957605, "link": "https://stackoverflow.com/questions/31957605/vba-remove-duplicates-from-rows/31962428#31962428", "title": "VBA Remove duplicates from rows", "body": "<pre><code>Sub DeleteRows()\n\nDim LastRow As Long\nDim LastCol As Long\nDim i As Long\nDim wsTemp As Worksheet\nDim v As Variant\n\nSet wsTemp = ActiveWorkbook.Worksheets.Add\n\nWith Sheets(\"Test\")\n    LastRow = .Range(\"A:A\").Find(what:=\"end\", after:=.Cells(.Rows.Count, 1), LookIn:=xlValues, lookat:=xlWhole).Row\n\n    For i = 1 To LastRow\n        LastCol = .Cells(i, .Columns.Count).End(xlToLeft).Column\n        If LastCol &gt; 1 Then\n            v = .Cells(i, 1).Resize(1, LastCol).Value\n            .Cells(i, 1).Resize(1, LastCol).ClearContents\n            wsTemp.Range(\"A:A\").Clear\n            wsTemp.Range(\"A1\").Resize(UBound(v, 2), 1).Value = Application.Transpose(v)\n            wsTemp.Range(\"A1\").Resize(UBound(v, 2), 1).RemoveDuplicates Columns:=1, Header:=xlNo\n            v = wsTemp.Range(\"A:A\").SpecialCells(xlCellTypeConstants).Value\n            .Cells(i, 1).Resize(1, UBound(v, 1)).Value = Application.Transpose(v)\n        End If\n    Next\nEnd With\n\nApplication.DisplayAlerts = False\nwsTemp.Delete\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3703835, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100000498760276/picture?type=large", "display_name": "user3703835", "link": "https://stackoverflow.com/users/3703835/user3703835"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1027, "favorite_count": 0, "accepted_answer_id": 31962428, "answer_count": 1, "score": 0, "last_activity_date": 1439382631, "creation_date": 1439361143, "last_edit_date": 1439370368, "question_id": 31957605, "link": "https://stackoverflow.com/questions/31957605/vba-remove-duplicates-from-rows", "title": "VBA Remove duplicates from rows", "body": "<p>The problem is fairly simple, yet i can't find a solution.\nI want to remove duplicates per row in a fairly long excel sheet</p>\n\n<p>my code looks like this but doesn't work:</p>\n\n<pre><code>Sub delete()\n\nDim i As Long, j As Integer\ni = 1\nj = 2\nWhile Sheets(\"Test\").Cells(i, 1).Value &lt;&gt; \"end\"\n    While Sheets(\"Test\").Cells(i, j).Value &lt;&gt; \"\"\n        If Sheets(\"Test\").Cells(i, j) &lt;&gt; Sheets(\"Test\").Cells(i, j).offset(, 1) Then\n            j = j + 1\n        Else\n            Sheets(\"Test\").Cells(i, j).offset(, 1).Clear\n            j = j + 1\n        End If\n    Wend\ni = i + 1\nWend\n</code></pre>\n\n<p>End Sub</p>\n\n<p>at the bottom of Column A is the word end, the data to be sorted out is in the columns B to QC. Some rows have duplicates, some don't.\nIn the next step I need to gather the non duplicate Values in column B seperated by a comma. Can anybody provide me help?</p>\n\n<p>Images: </p>\n\n<p><a href=\"http://picload.org/image/iwgoicp/now.jpg\" rel=\"nofollow\">Current datastructure</a></p>\n\n<p><a href=\"http://picload.org/image/iwglcdc/afterdelete.jpg\" rel=\"nofollow\">After deletion of the Duplicates</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1044, "user_id": 640989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c03ae2d5b1bf5f2f87e2697b5f51202?s=128&d=identicon&r=PG", "display_name": "Israel", "link": "https://stackoverflow.com/users/640989/israel"}, "edited": false, "score": 0, "creation_date": 1439381617, "post_id": 31957497, "comment_id": 51836739, "body": "I&#39;ve just updated my answer with the complete and tested solution for your edited requirement. Please mark it as the solution for your question."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 3655236, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/822e7da9de28072ca9e76c12da4bc95d?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit", "link": "https://stackoverflow.com/users/3655236/mohit"}, "edited": false, "score": 0, "creation_date": 1439361252, "post_id": 31957617, "comment_id": 51823604, "body": "I would like to use vba . Find is not working in vba code"}], "tags": [], "owner": {"reputation": 144, "user_id": 5126595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f49e9ce781768595ffe9f455c6daf69?s=128&d=identicon&r=PG&f=1", "display_name": "Looker", "link": "https://stackoverflow.com/users/5126595/looker"}, "is_accepted": false, "score": 0, "last_activity_date": 1439361189, "creation_date": 1439361189, "answer_id": 31957617, "question_id": 31957497, "link": "https://stackoverflow.com/questions/31957497/split-text-and-number-in-vba/31957617#31957617", "title": "Split Text and number IN VBA", "body": "<p>You probably had that formula in a specific cell, right? I think the following should do:</p>\n\n<pre><code>Range(\"yourcell\").FormulaR1C1 = \"=MID(\"XA 2009\",1,FIND(\" \",\"XA 2009\",FIND(\" \",\"XA 2009\")+1)-1)\"\n</code></pre>\n\n<p>Just replace \"yourcell\" with the cell number you had the formula in. So if you had it in cell A1, for example, it should be <code>Range(\"A1\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 1044, "user_id": 640989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c03ae2d5b1bf5f2f87e2697b5f51202?s=128&d=identicon&r=PG", "display_name": "Israel", "link": "https://stackoverflow.com/users/640989/israel"}, "is_accepted": false, "score": 1, "last_activity_date": 1439381449, "last_edit_date": 1495535201, "creation_date": 1439361458, "answer_id": 31957693, "question_id": 31957497, "link": "https://stackoverflow.com/questions/31957497/split-text-and-number-in-vba/31957693#31957693", "title": "Split Text and number IN VBA", "body": "<p>First, see in the answer for the following SO question, the general approach and prerequisites for using Regex search in VBA:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a></p>\n\n<p>Now, as for your specific requirement, try the following pattern:</p>\n\n<pre><code>(\\D*)\\s+\\d*\\s+(\\D*)\\s+\\d*\\s+(\\D*)\\s+\\d*\n</code></pre>\n\n<p>It will work for your precise example, but if you need the input string to be a bit more general you might need to modify the pattern.</p>\n\n<p>Some explanations:<br>\n\\D* will match one or more non numerical text characters (\"alpha character\")<br>\n\\s+ will match at least one space character<br>\n\\d* will match one or more numerical digits<br>\nthe (parenthesis) are for grouping sets of results, so I used them to surround what you wish to extract from the input string.</p>\n\n<p>If for example you know for sure that there's only one white-space character you can use:<br>\n[\\s]<br>\nSo the pattern might look like:</p>\n\n<pre><code>(\\D*)[\\s]\\d*[\\s](\\D*)[\\s]\\d*[\\s](\\D*)[\\s]\\d*\n</code></pre>\n\n<p>Also, this is a great tool for online pattern testing:</p>\n\n<p><a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">https://regex101.com/</a></p>\n\n<p>This is the solution for your edited requirement:</p>\n\n<ol>\n<li><p>In the VBA editor, go to tools=>references, find and select the checkbox next to \"Microsoft VBScript Regular Expressions 5.5\", press ok</p></li>\n<li><p>add this code to \"ThisWorkbook\" module:</p>\n\n<pre><code>Private Sub solution()\n    Dim regEx As New RegExp\nDim strPattern As String\nDim myInput As Range\nDim myOutput As Range\n\nSet myInput = ActiveSheet.Range(\"A1\")\nSet myOutput = ActiveSheet.Range(\"A2\")\n\nstrPattern = \"(\\D*)[\\s]\\d*[\\s](\\D*)[\\s]\\d*[\\s](\\D*)[\\s]\\d*\"\n\nstrInput = myInput.Value\n\nWith regEx\n    .Global = True\n    .MultiLine = True\n    .IgnoreCase = False\n    .Pattern = strPattern\n    End With\n\n    If regEx.test(strInput) Then\n        ActiveSheet.Range(\"A2\") = regEx.Replace(strInput, \"$1, $2, $3\")\n    End If\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 69, "user_id": 3655236, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/822e7da9de28072ca9e76c12da4bc95d?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit", "link": "https://stackoverflow.com/users/3655236/mohit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2878, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1439381449, "creation_date": 1439360744, "last_edit_date": 1439366234, "question_id": 31957497, "link": "https://stackoverflow.com/questions/31957497/split-text-and-number-in-vba", "title": "Split Text and number IN VBA", "body": "<p>I have <code>column header</code> which I want to <code>split</code></p>\n\n<p><strong>Heading</strong>\nXA 2009\nWW YY 2010\nXXA 2011</p>\n\n<p>I Want output like</p>\n\n<p><strong>XA,\nWW YY,\nXXA</strong></p>\n\n<p>Earlier I was using find function in <code>excel</code> which was working fine</p>\n\n<p><strong>=MID(\"XA 2009\",1,FIND(\" \",\"XA 2009\",FIND(\" \",\"XA 2009\")+1)-1)</strong> </p>\n\n<p>OUTPUT AS <strong>XA,\nWW YY</strong> </p>\n\n<p>Now requirement has change to code in vba</p>\n\n<p>I was trying to use Instr() instead of find as it is not working in VBA</p>\n\n<p><strong>Mid(\"XA 2009\", 1, InStr(1, \"XA 2009\", \" \", InStr(1, \"XA 2009\", \"2\")) - 1)</strong></p>\n\n<p>Now the output is XA,\nWW instead of WW YY.</p>\n\n<p>Can anyone suggest what I am doing wrong. I am pretty new to vba.</p>\n\n<p>I Want output like</p>\n\n<p><strong>XA,\nWW YY,\nXXA</strong></p>\n\n<p>I am using <code>excel 2013</code></p>\n"}, {"tags": ["javascript", "jquery", "vba", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 5217792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71079959f6757915805873a1b92eb72a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell", "link": "https://stackoverflow.com/users/5217792/mitchell"}, "reply_to_user": {"reputation": 3053, "user_id": 1436926, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/X1720.jpg?s=128&g=1", "display_name": "Raghavendra", "link": "https://stackoverflow.com/users/1436926/raghavendra"}, "edited": false, "score": 0, "creation_date": 1439360130, "post_id": 31957165, "comment_id": 51823119, "body": "Yeah, after toying around a bit, definitely an iFrame. I still don&#39;t really know how to deal with that, though. I&#39;ll try reading through other posts."}], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 0, "last_activity_date": 1439365654, "creation_date": 1439365654, "answer_id": 31959067, "question_id": 31957165, "link": "https://stackoverflow.com/questions/31957165/vba-cant-find-text-box-possibly-an-issue-with-javascript-hiding-box/31959067#31959067", "title": "VBA can&#39;t find text box- possibly an issue with JavaScript hiding box", "body": "<p>If this text box is stored in iFrame first you need to get the reference to this iFrame and then use its <code>ContentWindow</code> property:</p>\n\n<pre><code>Dim frame As Object\nDim textBox As Object\n\nSet frame = IE.Document.getElementById(\"frame_id\")\nSet textBox = frame.contentWindow.Document.getElementById(\"DISPLAY_SearchParameters_MemberID_ID\")\ntextBox.value = \"text\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5217792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71079959f6757915805873a1b92eb72a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell", "link": "https://stackoverflow.com/users/5217792/mitchell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1439365654, "creation_date": 1439359494, "question_id": 31957165, "link": "https://stackoverflow.com/questions/31957165/vba-cant-find-text-box-possibly-an-issue-with-javascript-hiding-box", "title": "VBA can&#39;t find text box- possibly an issue with JavaScript hiding box", "body": "<p>I'm trying to set up a VBA module which will automatically log in to a website, navigate to a specific page, and input data from Excel to check if the data is permissible. I've gotten to the final page, where I will be plugging in the data from Excel, but am having trouble actually changing the values of the text boxes on the webpage. I suspect that this is an issue caused by the JavaScript of the cell.</p>\n\n<pre><code>&lt;input type=\"text\" onkeypress=\"getNMContext().handleTextBoxOnKeyPress(event);\" onblur=\"handleTextBoxOnBlur(this, '',event);\" onfocus=\"handleTextBoxOnFocus(this, '');\" onchange=\"getNMContext().handleTextBoxOnChange(event);\" style=\"width: 200px; color: rgb(0, 0, 0);\" name=\"DISPLAY_SearchParameters_MemberID\" id=\"DISPLAY_SearchParameters_MemberID_ID\" maxlength=\"8\" title=\"\"&gt;\n</code></pre>\n\n<p>The above is an example of one field which I need to modify. Using</p>\n\n<pre><code>IE.document.getElementById(\"DISPLAY_SearchParameters_MemberID_ID\").value = \"text\"\n</code></pre>\n\n<p>doesn't update the field, instead returning error 424, informing me that an object is required (so no box with the ID is even being detected).</p>\n\n<p>What reason could there be that VBA is unable to detect the text field, even when given the ID?</p>\n\n<p>I would post a picture of the box, but I don't have the reputation required (I'm a new user).</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 1, "last_activity_date": 1439361261, "creation_date": 1439361261, "answer_id": 31957639, "question_id": 31956234, "link": "https://stackoverflow.com/questions/31956234/restrict-user-interface-in-excel-while-macro-is-running/31957639#31957639", "title": "Restrict User Interface in Excel while macro is running", "body": "<p>Display a \"modal\" userform while the macro runs. Users are unable to interact with Excel while the form is displayed.</p>\n\n<p>It could be as simple as having just a label on the form saying \"Please wait while macro runs\".  If the macro takes more than a few seconds to run, you could display a progress bar.</p>\n\n<p>You will probably need to use the QueryClose event to stop the user clicking the close button in the top right corner of the form.</p>\n"}], "owner": {"reputation": 75, "user_id": 4869070, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51c8b5ead6e5214c15e4600e3a171e03?s=128&d=identicon&r=PG&f=1", "display_name": "Kartiki ", "link": "https://stackoverflow.com/users/4869070/kartiki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1441507782, "creation_date": 1439354781, "last_edit_date": 1441507782, "question_id": 31956234, "link": "https://stackoverflow.com/questions/31956234/restrict-user-interface-in-excel-while-macro-is-running", "title": "Restrict User Interface in Excel while macro is running", "body": "<p>I have 4-5 workbooks open and one workbook has macro written for copying of data from other workbooks.\nBut if a user is working on some other workbook while the macro is running, excel freezes and goes into not responding mode.</p>\n\n<p>How do I disable user interface in this case for all workbooks till macro completes it's coding?</p>\n"}, {"tags": ["vba", "combinations", "permutation", "factorial"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1439356992, "post_id": 31956227, "comment_id": 51821830, "body": "All you examples sum to 5 which is misleading. Presumably less than 5 is ok too?"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1439357228, "post_id": 31956227, "comment_id": 51821916, "body": "@Bathsheba - How could it be less than five if each employee is rated exactly 5 times?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1439357279, "post_id": 31956227, "comment_id": 51821935, "body": "Some ratings score zero."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439357310, "post_id": 31956227, "comment_id": 51821946, "body": "But they&#39;re bucket counts."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1439357634, "post_id": 31956227, "comment_id": 51822045, "body": "Oops you&#39;re correct. Have an upvote!"}], "answers": [{"comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1439357639, "post_id": 31956276, "comment_id": 51822047, "body": "This isn&#39;t correct. You&#39;re only going to get the following numbers: <code>1111, 1112, 1121, 1211, 2111</code>. Also, much of that isn&#39;t VBA. <code>For ... As</code>, <code>Debug.WriteLine</code>, <code>ToString</code>, ..."}], "tags": [], "owner": {"reputation": 1691, "user_id": 4422908, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/48YJT.png?s=128&g=1", "display_name": "A. Abramov", "link": "https://stackoverflow.com/users/4422908/a-abramov"}, "is_accepted": false, "score": 0, "last_activity_date": 1439357687, "last_edit_date": 1439357687, "creation_date": 1439355067, "answer_id": 31956276, "question_id": 31956227, "link": "https://stackoverflow.com/questions/31956227/combinations-of-4-digit-numbers-whose-individual-digits-sum-to-5/31956276#31956276", "title": "Combinations of 4-digit numbers whose individual digits sum to 5", "body": "<p>c#:</p>\n\n<pre><code>// numbering 1 to 4 - i.e.\n// 1 sucessful, 2 unsucessful, 3 exception, 4 other\nfor(int i=1;i&lt;4;i++)\n{\n for(int n=1;n&lt;4;n++)\n {\n  for(int d=1;d&lt;4;d++)\n  {\n   for(int q=1;q&lt;4;q++)\n   {\n    if(i+d+n+q&lt;=5)\n     Console.WriteLine(i+n+d+q+\", \");\n   }\n  }\n }\n}\n</code></pre>\n\n<p><strong>EDIT</strong>: just saw you asked for vba:</p>\n\n<pre><code>For number1 As Integer = 1 To 4 Step 1\n For number2 As Integer = 1 To 4 Step 1\n  For number3 As Integer = 1 To 4 Step 1\n   For number4 As Integer = 1 To 4 Step 1\n    if(number1+number2+number3+number4&lt;=5) Then\n     Debug.WriteLine(number1.ToString &amp; number2.toString &amp;number3.toString &amp;number4.ToString &amp; \",\");\n    End If\n   Next number4\n  Next number3\n Next number2\nNext number1  \n</code></pre>\n\n<p>The most simple solution I could think of, there's probably better though.</p>\n"}, {"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 1, "last_activity_date": 1439358352, "last_edit_date": 1439358352, "creation_date": 1439356695, "answer_id": 31956574, "question_id": 31956227, "link": "https://stackoverflow.com/questions/31956227/combinations-of-4-digit-numbers-whose-individual-digits-sum-to-5/31956574#31956574", "title": "Combinations of 4-digit numbers whose individual digits sum to 5", "body": "<p>Since your numbers can range from <code>0005</code> to <code>5000</code>, you could just write a simple loop that tests each number to see if the digits total <code>5</code>:</p>\n\n<pre><code>Sub GetPermutations()\n    Dim i As Long\n    For i = 5 To 5000\n        If SumDigits(i) = 5 Then Debug.Print Format$(i, \"0000\")\n    Next\nEnd Sub\n\nFunction SumDigits(s As Variant) As Long\n    Dim i As Long\n    For i = 1 To Len(s)\n        SumDigits = SumDigits + CLng(Mid$(s, i, 1))\n    Next\nEnd Function\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>Dim w As Long, x As Long, y As Long, z As Long\nFor w = 0 To 5\nFor x = 0 To 5\nFor y = 0 To 5\nFor z = 0 To 5\n    If w + x + y + z = 5 Then Debug.Print w &amp; x &amp; y &amp; z\nNext\nNext\nNext\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5217599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21bc18b8f4c77cdc591d09ff9dd2da6?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Barnes", "link": "https://stackoverflow.com/users/5217599/scott-barnes"}, "is_accepted": false, "score": 0, "last_activity_date": 1439813064, "creation_date": 1439813064, "answer_id": 32049919, "question_id": 31956227, "link": "https://stackoverflow.com/questions/31956227/combinations-of-4-digit-numbers-whose-individual-digits-sum-to-5/32049919#32049919", "title": "Combinations of 4-digit numbers whose individual digits sum to 5", "body": "<p>Thanks for your help everyone - i managed to use a combination of suggestions by starting with the number 1, auto-filling down to 5000, then \"text to columns\", fixed width to separate the digits, sum to 5, filter and hey presto! Seems to have produced the right number of possible combinations adding up to 5.</p>\n\n<p>Thanks again for your help!</p>\n"}], "owner": {"reputation": 1, "user_id": 5217599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f21bc18b8f4c77cdc591d09ff9dd2da6?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Barnes", "link": "https://stackoverflow.com/users/5217599/scott-barnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2255, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1439813064, "creation_date": 1439354744, "last_edit_date": 1439358604, "question_id": 31956227, "link": "https://stackoverflow.com/questions/31956227/combinations-of-4-digit-numbers-whose-individual-digits-sum-to-5", "title": "Combinations of 4-digit numbers whose individual digits sum to 5", "body": "<p>I'm working on a scorecard at work which has columns representing 4 possible outcomes, for example:</p>\n\n<ol>\n<li>Successful,</li>\n<li>unsuccessful,</li>\n<li>Exceptional,</li>\n<li>Other</li>\n</ol>\n\n<p>Each staff member is assessed 5 times in the month against those ratings. So <strong>1 person</strong> might have <strong>3 successful</strong>, <strong>2 exceptional</strong>, <strong>0 unsuccessful</strong>, <strong>0 other</strong>.</p>\n\n<p>So the max instances of each outcome is 5 but the total sum of instances can't be more than 5.</p>\n\n<p>I could try to type out all the combinations (and get them wrong) - is there any function/formula/VBA that anyone knows of that will list out all of the possible combinations of outcomes for me?</p>\n\n<pre><code>e.g. 5000,4100,4010,4001,3200,3020,3002,3110,3011, etc...\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 961, "user_id": 2697139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c2437120b3292f1340ad0100ac12d4?s=128&d=identicon&r=PG&f=1", "display_name": "AlexT82", "link": "https://stackoverflow.com/users/2697139/alext82"}, "edited": false, "score": 0, "creation_date": 1439357767, "post_id": 31955969, "comment_id": 51822107, "body": "i strongly recommend against using a A:A range in the sumifs formula. Sumifs is a array formula, and will very quickly become very slow, if you reference the entire column. try to go for A1:A50000 , or however many rows you need."}, {"owner": {"reputation": 71, "user_id": 2885747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bad9cf8449e7c8087cf96ce806321f4?s=128&d=identicon&r=PG&f=1", "display_name": "Z9z9z9", "link": "https://stackoverflow.com/users/2885747/z9z9z9"}, "reply_to_user": {"reputation": 961, "user_id": 2697139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c2437120b3292f1340ad0100ac12d4?s=128&d=identicon&r=PG&f=1", "display_name": "AlexT82", "link": "https://stackoverflow.com/users/2697139/alext82"}, "edited": false, "score": 0, "creation_date": 1439362738, "post_id": 31955969, "comment_id": 51824415, "body": "I&#39;ll take note of that. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 0, "last_activity_date": 1439355286, "last_edit_date": 1439355286, "creation_date": 1439354951, "answer_id": 31956256, "question_id": 31955969, "link": "https://stackoverflow.com/questions/31955969/sumifs-function-in-vba/31956256#31956256", "title": "SUMIFS function in VBA", "body": "<p>You can just assign the formula string to the <code>Formula</code> property of a <code>Range</code> object, so that shouldn't be any more difficult than entering it into the formula bar, really. You can keep it pretty much as is.</p>\n\n<p>It sounds like the only issue you really have is locating <code>\"Grand Total\"</code>.</p>\n\n<p>If it's always the last row in column A, you can do the following:</p>\n\n<pre><code>Dim intLastRow As Long\nintLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n</code></pre>\n\n<p>Now that you have your last row, you can address your cell in column N and assign it your formula:</p>\n\n<pre><code>Cells(intLastRow, \"N\").Formula = \"=SUMIFS(N:N,A:A,\"\"*Team*\"\",A:A,\"\"*Total*\"\")\"\n</code></pre>\n\n<p>The only tricky thing here is that any quotes (used in string literals) must be doubled.</p>\n"}], "owner": {"reputation": 71, "user_id": 2885747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bad9cf8449e7c8087cf96ce806321f4?s=128&d=identicon&r=PG&f=1", "display_name": "Z9z9z9", "link": "https://stackoverflow.com/users/2885747/z9z9z9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1548, "favorite_count": 0, "accepted_answer_id": 31956256, "answer_count": 1, "score": 0, "last_activity_date": 1439355423, "creation_date": 1439353243, "last_edit_date": 1439355423, "question_id": 31955969, "link": "https://stackoverflow.com/questions/31955969/sumifs-function-in-vba", "title": "SUMIFS function in VBA", "body": "<p>I need help in figuring out on the project I've been working on lately.  In excel, I know how to use <code>SUMIFS</code>. I know it's possible to make it work in VBA (VBA beginner here) but I really have no idea how. As I would like to use the formula instead(manually) or just reference the columns, I really need to do it in VBA, because the sheet gets updated every month. This is the formula:</p>\n\n<pre><code>=SUMIFS(N:N,A:A,\"*Team*\", A:A, \"*Total*\")\n</code></pre>\n\n<p>I have a sheet (Budget) that gets updated every month. It should find the words <code>\"Team\"</code> and <code>\"Total\"</code> in column A til the last row and sum up those Amount in column N (same row), and find the words \"Grand Total\" til the last row in column A and its sum will be placed on column N. Here's the sample table.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SNdjl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SNdjl.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This problem has been bugging me lately and I really need help. Any suggestions will be appreciated. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439351790, "post_id": 31955702, "comment_id": 51820316, "body": "I tested the code, it is OK for me. Which line give you error?"}, {"owner": {"reputation": 21, "user_id": 5217480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e901c5e5f0d2f7ef4f1512c1a59084b?s=128&d=identicon&r=PG&f=1", "display_name": "wwight", "link": "https://stackoverflow.com/users/5217480/wwight"}, "reply_to_user": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439352270, "post_id": 31955702, "comment_id": 51820430, "body": "the line with the split function in it."}, {"owner": {"reputation": 21, "user_id": 5217480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e901c5e5f0d2f7ef4f1512c1a59084b?s=128&d=identicon&r=PG&f=1", "display_name": "wwight", "link": "https://stackoverflow.com/users/5217480/wwight"}, "reply_to_user": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439352524, "post_id": 31955702, "comment_id": 51820499, "body": "Wierd, when I put the macro in another excel file it works. Why would that be?"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1439352602, "post_id": 31955702, "comment_id": 51820525, "body": "I don&#39;t know, sometime it happen to me. Later, It is OK without doing nothing."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1439353213, "post_id": 31955702, "comment_id": 51820699, "body": "I see <code>split</code> is not capitalized as a keyword which leads me to believe that your project is confused from previous declarations.  Reminds me of @Tim Williams response to this <a href=\"http://stackoverflow.com/q/22312696/2521004\">question</a>"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 5, "creation_date": 1439354006, "post_id": 31955702, "comment_id": 51820887, "body": "Replace <code>split</code> with <code>VBA.Split</code> and see if it works."}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "edited": false, "score": 0, "creation_date": 1439365864, "post_id": 31955702, "comment_id": 51826172, "body": "Bond is right, <code>VBA.Split</code> should work. It happens if some reference is missing in your project. Go to Tools &gt; References and see if there is a library with word MISSING appended."}, {"owner": {"reputation": 348, "user_id": 10079909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce35f3ce075b77881e5aa546c526507?s=128&d=identicon&r=PG&f=1", "display_name": "Richard", "link": "https://stackoverflow.com/users/10079909/richard"}, "edited": false, "score": 0, "creation_date": 1611246017, "post_id": 31955702, "comment_id": 116394812, "body": "Adding VBA.split worked for me. Must be a reference, but I can&#39;t check as it&#39;s a work computer and I don&#39;t have the rights."}], "owner": {"reputation": 21, "user_id": 5217480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e901c5e5f0d2f7ef4f1512c1a59084b?s=128&d=identicon&r=PG&f=1", "display_name": "wwight", "link": "https://stackoverflow.com/users/5217480/wwight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2795, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1439352889, "creation_date": 1439351473, "last_edit_date": 1439352889, "question_id": 31955702, "link": "https://stackoverflow.com/questions/31955702/compile-error-with-vba-split-function", "title": "compile error with vba split function", "body": "<p>I am trying to incorporate the excel vba split function in my code. However I get a \"compile error, wrong number of arguments or invalid property assignment\". I have tried the function in many different ways but still get the compile error. Do I need another library? Below is a simple macro that gets the error:</p>\n\n<pre><code>Sub testSplit()\n    Dim txt As String, i As Integer, FullName As Variant\n    txt = \"John Q Public\"\n    FullName = split(txt, \" \")\n    For i = 0 To UBound(FullName)\n        Cells(1, i + 1).Value = FullName(i)\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 1, "creation_date": 1439353901, "post_id": 31955680, "comment_id": 51820855, "body": "Good approach. Would add Selection.Address as the default option for the Inputbox"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1439384930, "post_id": 31955680, "comment_id": 51839419, "body": "@brettdj Good idea. I modified the code to reflect it. Thanks."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1439384897, "last_edit_date": 1439384897, "creation_date": 1439351293, "answer_id": 31955680, "question_id": 31955627, "link": "https://stackoverflow.com/questions/31955627/removing-object-required-message-with-cancel-msgbox-but-does-not-perform-delete/31955680#31955680", "title": "Removing object required message with cancel msgbox but does not perform delete action", "body": "<p><code>Application.InputBox</code> is more flexible than <code>InputBox</code>. It's last parameter is a type parameter, with type 8 corresponding to selecting a range with the mouse.</p>\n\n<p>Sample code:</p>\n\n<pre><code>Sub DeleteCells()\n    Dim R As Range\n    On Error GoTo err_handler 'if user hits \"Cancel\"\n    Set R = Application.InputBox(\"Select cells To be deleted\", , Selection.Address, , , , , 8)\n    R.Delete\nerr_handler:\n    'any needed error handling code here\nEnd Sub\n</code></pre>\n\n<p>On edit: I modified the code to incorporate brettdj's excellent suggestion to include the selection as the default range. I also added some error trapping to catch the case that the user clicks \"Cancel\" on the input box. In this case the error handling is to just exit the function, though certainly more involved error handling could be appropriate for your specific case.</p>\n\n<p>A final thought -- make sure that you really want to <code>delete</code> the cells. That is sometimes a problematic move since it causes other cells to shift around to fill the vacuum. In many cases <code>Clear</code> or <code>ClearContents</code> can delete what you want to delete without effecting other cells.</p>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "accepted_answer_id": 31955680, "answer_count": 1, "score": 0, "last_activity_date": 1439384897, "creation_date": 1439350881, "last_edit_date": 1439360183, "question_id": 31955627, "link": "https://stackoverflow.com/questions/31955627/removing-object-required-message-with-cancel-msgbox-but-does-not-perform-delete", "title": "Removing object required message with cancel msgbox but does not perform delete action", "body": "<p>Now i can delete but whenever i fail to highlight a cell to delete it gives me an object required . i tried removing the error message with a cancel message box but it does not perform the delete action. Would need help to correct my mistake!</p>\n\n<pre><code>Sub deletetry2()\n\n    Dim R As Range\n    On Error Resume Next\n    Set R = Application.InputBox(\"Select cells To be deleted\", , , , , , , 8)\n    On Error GoTo 0\n    If TypeName(rng) &lt;&gt; \"Range\" Then\n        MsgBox \"Cancelled\", vbInformation\n        Exit Sub\n    Else\n    R.delete\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}]