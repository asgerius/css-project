[{"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 2690, "user_id": 3296811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lt27n.jpg?s=128&g=1", "display_name": "Quill", "link": "https://stackoverflow.com/users/3296811/quill"}, "edited": false, "score": 1, "creation_date": 1452729334, "post_id": 34779259, "comment_id": 57303650, "body": "This may be a good question for <a href=\"https://codereview.stackexchange.com\">Code Review</a>, so long as: <b>(A)</b> <i>the code works</i>, <b>and (B)</b> <i>it&#39;s not hypothetical or incomplete in any way</i>. Please read the <a href=\"http://codereview.stackexchange.com/help/on-topic\">on-topic guide</a> before posting, if you choose to go to <a href=\"http://codereview.stackexchange.com/questions/ask\">Code Review</a>. If you have any questions or concerns, join us at our <a href=\"http://chat.stackexchange.com/rooms/34045\">CR Help Desk</a>."}, {"owner": {"reputation": 2690, "user_id": 3296811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lt27n.jpg?s=128&g=1", "display_name": "Quill", "link": "https://stackoverflow.com/users/3296811/quill"}, "edited": false, "score": 1, "creation_date": 1452729395, "post_id": 34779259, "comment_id": 57303670, "body": "This seems like a hypothetical question, which are off-topic on Code Review."}, {"owner": {"reputation": 1814, "user_id": 1163640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1362b92f06e22d16575db47d342ac3d0?s=128&d=identicon&r=PG", "display_name": "CodingBeagle", "link": "https://stackoverflow.com/users/1163640/codingbeagle"}, "reply_to_user": {"reputation": 2690, "user_id": 3296811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lt27n.jpg?s=128&g=1", "display_name": "Quill", "link": "https://stackoverflow.com/users/3296811/quill"}, "edited": false, "score": 0, "creation_date": 1452729490, "post_id": 34779259, "comment_id": 57303697, "body": "@Quill This is definitely not a hypothetical question? The above code is compiled and verified to work, and the question specifically states that it works and if it is a safe practice :)"}, {"owner": {"reputation": 2690, "user_id": 3296811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lt27n.jpg?s=128&g=1", "display_name": "Quill", "link": "https://stackoverflow.com/users/3296811/quill"}, "edited": false, "score": 0, "creation_date": 1452729566, "post_id": 34779259, "comment_id": 57303721, "body": "Your question is a hypothetical question stating <i>is it a safe practice to do x</i>. I&#39;m not saying the code is hypothetical."}, {"owner": {"reputation": 2690, "user_id": 3296811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lt27n.jpg?s=128&g=1", "display_name": "Quill", "link": "https://stackoverflow.com/users/3296811/quill"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452729614, "post_id": 34779259, "comment_id": 57303740, "body": "@ScottHoltzman simply because a question may be <i>better</i> for another site is not a reason to close. Asking questions about side affects and code safety is on-topic on Stack Overflow."}, {"owner": {"reputation": 1814, "user_id": 1163640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1362b92f06e22d16575db47d342ac3d0?s=128&d=identicon&r=PG", "display_name": "CodingBeagle", "link": "https://stackoverflow.com/users/1163640/codingbeagle"}, "reply_to_user": {"reputation": 2690, "user_id": 3296811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lt27n.jpg?s=128&g=1", "display_name": "Quill", "link": "https://stackoverflow.com/users/3296811/quill"}, "edited": false, "score": 0, "creation_date": 1452729735, "post_id": 34779259, "comment_id": 57303792, "body": "@Quill What could I do in order to improve the question for either website? All I want to know is if removing entries from a dictionary in VBA during a for each loop (like the working code above) can cause undesired side-effects (because of iterators), which I definitely feel like is something that can be answered quite objectively?"}, {"owner": {"reputation": 2690, "user_id": 3296811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lt27n.jpg?s=128&g=1", "display_name": "Quill", "link": "https://stackoverflow.com/users/3296811/quill"}, "edited": false, "score": 1, "creation_date": 1452729834, "post_id": 34779259, "comment_id": 57303821, "body": "This question is on-topic for Stack Overflow, as given by the first on-topic reason: <a href=\"http://stackoverflow.com/help/on-topic\"><i>the question is on-topic if it&#39;s about: a specific programming problem</i></a>"}, {"owner": {"reputation": 1814, "user_id": 1163640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1362b92f06e22d16575db47d342ac3d0?s=128&d=identicon&r=PG", "display_name": "CodingBeagle", "link": "https://stackoverflow.com/users/1163640/codingbeagle"}, "reply_to_user": {"reputation": 2690, "user_id": 3296811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Lt27n.jpg?s=128&g=1", "display_name": "Quill", "link": "https://stackoverflow.com/users/3296811/quill"}, "edited": false, "score": 0, "creation_date": 1452729938, "post_id": 34779259, "comment_id": 57303853, "body": "@Quill Thank you :) I was about to say this is all very quite unreasonable as I also feel it is very much on-topic."}, {"owner": {"reputation": 6639, "user_id": 1157100, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/1f9W9.png?s=128&g=1", "display_name": "200_success", "link": "https://stackoverflow.com/users/1157100/200-success"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452731396, "post_id": 34779259, "comment_id": 57304282, "body": "@ScottHoltzman &quot;Is this safe?&quot; is a question that is on-topic for Stack Overflow, and far from a request for open-ended critique. Please read <a href=\"http://meta.codereview.stackexchange.com/q/5777\">A Guide to Code Review for Stack Overflow Users</a> and <a href=\"http://meta.stackoverflow.com/q/313266/1157100\">this discussion of proper closure procedures for code review requests</a>."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1452736143, "post_id": 34779259, "comment_id": 57305729, "body": "retracting my close vote. thanks all for the education :) Apologies for any confusion or misunderstanding I put anyone through."}], "answers": [{"comments": [{"owner": {"reputation": 1814, "user_id": 1163640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1362b92f06e22d16575db47d342ac3d0?s=128&d=identicon&r=PG", "display_name": "CodingBeagle", "link": "https://stackoverflow.com/users/1163640/codingbeagle"}, "edited": false, "score": 0, "creation_date": 1452730702, "post_id": 34779505, "comment_id": 57304090, "body": "Hey Tim! Thanks for the reply :) Okay, so is it best to check if a key exists in the dictionary before using item? Or should another method be used to access an item by key?  Also, for clarification, is removing elements from the dictionary during a for each a safe operation?  I will accept the answer once the clarifications are made :) And thank you again for the answer."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1452732364, "last_edit_date": 1452732364, "creation_date": 1452730429, "answer_id": 34779505, "question_id": 34779259, "link": "https://stackoverflow.com/questions/34779259/vba-is-it-safe-to-remove-items-from-a-dictionary-within-a-for-each/34779505#34779505", "title": "VBA - Is it safe to remove items from a dictionary within a for each?", "body": "<p>The last line illustrates the problem with this approach.</p>\n\n<p>Just referring to <code>testDict.Item(Key)</code> will create a key if it doesn't exist, so you should always use <code>testDict.Exists(Key)</code> before trying to check the value of a key which may not be present.</p>\n\n<p>As for making deletions while looping over the keys, if you want to be sure then start by grabbing a copy of the keys and loop over that...</p>\n\n<p>Added: if you <em>add</em> an item inside the loop it will not show up as a value of <code>Key</code> variable.</p>\n\n<pre><code>Sub TT()\n\n    Dim testDict As New Scripting.Dictionary\n\n    testDict.Add 1, 5\n    testDict.Add 2, 10\n    testDict.Add 3, 15\n    testDict.Add 4, 20\n    testDict.Add 5, 25\n    testDict.Add 6, 30\n\n    Dim Key As Variant\n\n    For Each Key In testDict.Keys()\n        If testDict.Item(Key) = 5 Then\n            testDict.Remove (Key)\n            Debug.Print \"Removed \", Key\n        End If\n\n        If testDict.Item(Key) = 20 Then\n            testDict.Remove (Key)\n            Debug.Print \"Removed \", Key\n        End If\n    Next Key\n    '&gt;&gt;&gt; Removed        1 \n    '&gt;&gt;&gt; Removed        4 \n\n\n    Debug.Print Join(testDict.Keys, \",\")\n     '&gt;&gt;&gt;  2,3,5,6,1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1814, "user_id": 1163640, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1362b92f06e22d16575db47d342ac3d0?s=128&d=identicon&r=PG", "display_name": "CodingBeagle", "link": "https://stackoverflow.com/users/1163640/codingbeagle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1604, "favorite_count": 0, "accepted_answer_id": 34779505, "answer_count": 1, "score": 1, "last_activity_date": 1452732364, "creation_date": 1452728889, "last_edit_date": 1452729318, "question_id": 34779259, "link": "https://stackoverflow.com/questions/34779259/vba-is-it-safe-to-remove-items-from-a-dictionary-within-a-for-each", "title": "VBA - Is it safe to remove items from a dictionary within a for each?", "body": "<p>So, I'm completely inexperienced with VBA (Visual Basic For Applications).</p>\n\n<p>Basically, I have code that runs through dictionaries and removes certain elements from them. Here's a quick examples (that is NOT in the production code):</p>\n\n<pre><code>Dim testDict As New Scripting.Dictionary\n\ntestDict.Add 1, 5\ntestDict.Add 2, 10\ntestDict.Add 3, 15\ntestDict.Add 4, 20\ntestDict.Add 5, 25\ntestDict.Add 6, 30\n\nDim Key As Variant\n\nFor Each Key In testDict.Keys()\n    If testDict.Item(Key) = 5 Then\n        testDict.Remove (Key)\n    End If\n\n    If testDict.Item(Key) = 20 Then\n        testDict.Remove (Key)\n    End If\nNext Key \n</code></pre>\n\n<p>I know that in some languages, this will throw off the underlying iterator. However I have no experience in Visual Basic, so I don't know how it works.</p>\n\n<p>The reason I'm asking is that the above code works perfectly fine, and the algorithm which uses this approach works just fine too. I just need to have verified that this is a safe practice in VBA, and if not, how are cases like these usually dealt with in VBA?</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1452727381, "post_id": 34778955, "comment_id": 57302883, "body": "You&#39;re testing for <code>A5:A500</code> but pulling data from columns D, L and M. Is that intentional? Edit: can you even do <code>Range(&quot;D&quot; &amp; r)</code> if <code>r</code> is a range? And you might want to change the second <code>r</code> to <code>c</code> for instance."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452728270, "post_id": 34778955, "comment_id": 57303238, "body": "yes, change the 2nd <code>r</code> to <code>c</code> (or whatever letter) and then change <code>Range(&quot;D&#39; &amp; r)</code> to <code>Range(&quot;D&quot; &amp; c.Row)</code>"}, {"owner": {"reputation": 27, "user_id": 5760039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-z4aBoGTlqxQ/AAAAAAAAAAI/AAAAAAAAABs/-VO9STBI__Y/photo.jpg?sz=128", "display_name": "Dee Wolf", "link": "https://stackoverflow.com/users/5760039/dee-wolf"}, "edited": false, "score": 0, "creation_date": 1452729586, "post_id": 34778955, "comment_id": 57303734, "body": "Thanks. I&#39;m not sure if I followed your direction correctly but I modified my code to the following, and it produces no results (where with my original code, it produces results, just not the correct results.)  Edit: Sorry, I&#39;m having trouble figuring out the syntax of the message board system.  [For Each c In r.Cells] [(&quot;D&quot; &amp; c.Row)]"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5760039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-z4aBoGTlqxQ/AAAAAAAAAAI/AAAAAAAAABs/-VO9STBI__Y/photo.jpg?sz=128", "display_name": "Dee Wolf", "link": "https://stackoverflow.com/users/5760039/dee-wolf"}, "edited": false, "score": 0, "creation_date": 1452728669, "post_id": 34779055, "comment_id": 57303378, "body": "Thanks Smackenzie. I am using range A5:A500 to determine the cell color. Then, once the specified cell color is found, I&#39;m taking the data from that row&#39;s D, L, and M columns. I tried using your suggestion but the macro is no longer producing any results. It sounds like the method I&#39;m using isn&#39;t quite normal but it also worked, it just wasn&#39;t giving me the correct results. So I&#39;m more confused. lol."}, {"owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "reply_to_user": {"reputation": 27, "user_id": 5760039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-z4aBoGTlqxQ/AAAAAAAAAAI/AAAAAAAAABs/-VO9STBI__Y/photo.jpg?sz=128", "display_name": "Dee Wolf", "link": "https://stackoverflow.com/users/5760039/dee-wolf"}, "edited": false, "score": 1, "creation_date": 1452730167, "post_id": 34779055, "comment_id": 57303930, "body": "to use Range(&quot;M&quot; &amp; r) can only give results if you are storing the row number in the cells with the colors in, and the code is then taking r.value?  Do you have the row numbers written in the cells A5:500."}, {"owner": {"reputation": 27, "user_id": 5760039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-z4aBoGTlqxQ/AAAAAAAAAAI/AAAAAAAAABs/-VO9STBI__Y/photo.jpg?sz=128", "display_name": "Dee Wolf", "link": "https://stackoverflow.com/users/5760039/dee-wolf"}, "edited": false, "score": 0, "creation_date": 1452731575, "post_id": 34779055, "comment_id": 57304330, "body": "It works!! Thank you @smackenzie I really appreciate the visual aid you provided."}], "tags": [], "owner": {"reputation": 2456, "user_id": 1754307, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/7170dd9a6ce7317ab73835c15ef1d9f7?s=128&d=identicon&r=PG", "display_name": "smackenzie", "link": "https://stackoverflow.com/users/1754307/smackenzie"}, "is_accepted": true, "score": 1, "last_activity_date": 1452730670, "last_edit_date": 1452730670, "creation_date": 1452727877, "answer_id": 34779055, "question_id": 34778955, "link": "https://stackoverflow.com/questions/34778955/excel-2010-macro-to-detect-specific-interior-color-of-a-cell-and-produce-a-res/34779055#34779055", "title": "Excel 2010 - Macro to Detect Specific Interior Color of a Cell and Produce a Result", "body": "<p>Why are you using the r variable twice for 2 purposes, and why are you building a range using (\"D\" &amp; r).  r is an object (specifically a cell). I am assuming you want to take data from D and M, but on the same row?  </p>\n\n<p>If so this should read as below.</p>\n\n<p>Dim aCell as Range</p>\n\n<pre><code>For Each aCell In r.Cells\n    If r.Interior.Color = RGB(255, 255, 204) Then\n        m = m &amp; \"&lt;tr&gt;&lt;td&gt;\" &amp; ActiveSheet.Range(\"D\" &amp; aCell.Row) &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; ActiveSheet.Range(\"L\" &amp; aCell.Row) &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; _\n            ActiveSheet.Range(\"M\" &amp; aCell.Row) &amp; \"&lt;/td&gt;&lt;/tr&gt;\"\n    End If\nNext\n</code></pre>\n\n<p>You may of course be taking a shortcut, and actually are using r.Value when you build a range using Range(\"D\" &amp; r).  i.e. this is shot for Range(\"D\" &amp; r.Value)...so if \"r\" references a cell with a number in it like 599, then you want to reference cell \"D599\" which is what your code does?</p>\n\n<p><a href=\"https://i.stack.imgur.com/gVF7D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gVF7D.png\" alt=\"This works for me\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 5760039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-z4aBoGTlqxQ/AAAAAAAAAAI/AAAAAAAAABs/-VO9STBI__Y/photo.jpg?sz=128", "display_name": "Dee Wolf", "link": "https://stackoverflow.com/users/5760039/dee-wolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 34779055, "answer_count": 1, "score": 0, "last_activity_date": 1452730670, "creation_date": 1452727203, "last_edit_date": 1531161705, "question_id": 34778955, "link": "https://stackoverflow.com/questions/34778955/excel-2010-macro-to-detect-specific-interior-color-of-a-cell-and-produce-a-res", "title": "Excel 2010 - Macro to Detect Specific Interior Color of a Cell and Produce a Result", "body": "<p>I created an Excel spreadsheet with a command button that calls a macro. The macro produces an new email through Microsoft Outlook that provides a list of data, specifically data from cells ranged A5 through A500 that have an interior color of RGB(255, 255, 204).</p>\n\n<p>However, I'm not getting accurate results. The macro is not exclusively capturing the data from cells of the specified interior color and is giving me data from cells of alternate colors as well. This may be a logic error on my part.</p>\n\n<p>Here is the code I am currently working with:</p>\n\n<pre><code>Private Sub btnReport_Click()\n'Create Email Message\nDim r As Range\nDim m As String\nSet r = ActiveSheet.Range(\"A5:A500\")\nm = \"Hello,&lt;br&gt;&lt;br&gt;Here is some information:&lt;br&gt;&lt;br&gt;\" &amp; _\n    \"&lt;table border=\"\"1\"\" style=\"\"width:98.7%\"\" align=\"\"left\"\" &gt;&lt;tr style=\"\"vertical-align:top;\"\"&gt;&lt;td style=\"\"width:9.3%\"\" nowrap&gt;\" &amp; _\n    \"&lt;b&gt;Column 1&lt;/b&gt;&lt;/td&gt;&lt;td style=\"\"width:10%\"\" nowrap&gt;&lt;b&gt;Column 2&lt;/b&gt;&lt;/td&gt;&lt;td style=\"\"width:10%\"\" nowrap&gt;&lt;b&gt;Column 3&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;\"\n\nFor Each r In r.Cells\n    If r.Interior.Color = RGB(255, 255, 204) Then\n        m = m &amp; \"&lt;tr&gt;&lt;td&gt;\" &amp; ActiveSheet.Range(\"D\" &amp; r) &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; ActiveSheet.Range(\"L\" &amp; r) &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; _\n            ActiveSheet.Range(\"M\" &amp; r) &amp; \"&lt;/td&gt;&lt;/tr&gt;\"\n    End If\nNext\n\n'Open Email\nDim olApp As Object\nDim olMail As Object\nDim name As String\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olMail = olApp.CreateItem(olMailItem)\nWith olMail\n    .To = \"Dee Wolf\"\n    .Subject = \"This is a subject line\"  \n    .HTMLBody = m\n    .Display\nEnd With\nSet olMail = Nothing\nSet olApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5786906, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a22dc13cc2fad8780434f123fca2512?s=128&d=identicon&r=PG&f=1", "display_name": "eee333", "link": "https://stackoverflow.com/users/5786906/eee333"}, "edited": false, "score": 0, "creation_date": 1473876261, "post_id": 39247633, "comment_id": 66311342, "body": "I used the clunky way I described above. I tried this way, and it almost works, but not consistently (I&#39;m sure it&#39;s consistent and I just haven&#39;t figured out the pattern). When I enter 1 the first time and tab, the background stays white. Then when I go back and enter 2, it updates with the blue. But then when I go back and enter 1 again, it stays blue. When I enter 1 again (after it having just been one), then it will turn green."}, {"owner": {"reputation": 41, "user_id": 5786906, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a22dc13cc2fad8780434f123fca2512?s=128&d=identicon&r=PG&f=1", "display_name": "eee333", "link": "https://stackoverflow.com/users/5786906/eee333"}, "edited": false, "score": 0, "creation_date": 1474031537, "post_id": 39247633, "comment_id": 66379022, "body": "No, I mean, I tried the way you gave me, and it almost works, but not perfectly. When I enter 1 the first time and tab, the background stays white. Then when I go back and enter 2, it updates with the blue. But then when I go back and enter 1 again, it stays blue. When I enter 1 again (after it having just been one), then it will turn green"}, {"owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "reply_to_user": {"reputation": 41, "user_id": 5786906, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a22dc13cc2fad8780434f123fca2512?s=128&d=identicon&r=PG&f=1", "display_name": "eee333", "link": "https://stackoverflow.com/users/5786906/eee333"}, "edited": false, "score": 0, "creation_date": 1474205173, "post_id": 39247633, "comment_id": 66426894, "body": "Ok. I think I found my mistake. I changed my answer. Could you please check again?"}], "tags": [], "owner": {"reputation": 693, "user_id": 1930374, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/wwGpP.jpg?s=128&g=1", "display_name": "Blenikos", "link": "https://stackoverflow.com/users/1930374/blenikos"}, "is_accepted": true, "score": 1, "last_activity_date": 1474205107, "last_edit_date": 1474205107, "creation_date": 1472640746, "answer_id": 39247633, "question_id": 34778522, "link": "https://stackoverflow.com/questions/34778522/vba-code-that-changes-background-color-of-form-conditionally-by-answer/39247633#39247633", "title": "VBA code that changes background color of form conditionally by answer", "body": "<p>I know it is a really old question (probably you have already solved it in a better way) but I will give it a try anyways.</p>\n\n<p>Try the following:</p>\n\n<pre><code>Private Sub Text0_Change()\n    Select Case Me.Text0.Text\n    Case \"\"\n\n    Case \"1\"\n        Me.Detail.BackColor = 15325906\n    Case \"2\"\n        Me.Detail.BackColor = 13888226\n    Case Else\n        Me.Detail.BackColor = vbWhite\n    End Select\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong> \nI tried that and it works I think now as it supposed to do. \nWhen you change the <em>text</em> on the text box triggers this event every time, runs the Sub, checks it's own <em>text</em> and changes the color of the form as described.</p>\n\n<p>The change is that I changed the property of the field it checks. From <em>Value</em> to <em>Text</em>. We want when the event triggers to check the current text because the Value property updates when you \"finish\" with the textbox (after you press enter or the focus on the control is lost) and we want the change to happen the same moment we press the key changing the value and not later.</p>\n\n<p>The second change and the reason we got strange patterns before is that I have added one more Case when the text is \"\" to do nothing on that change (empty case). Without that case when we used delete or backspace to remove the text and left the textbox empty (\"\") then the case else was True and it changed the background color.</p>\n\n<p>I hope this is the correct answer now. Please let me know! </p>\n"}], "owner": {"reputation": 41, "user_id": 5786906, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9a22dc13cc2fad8780434f123fca2512?s=128&d=identicon&r=PG&f=1", "display_name": "eee333", "link": "https://stackoverflow.com/users/5786906/eee333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17131, "favorite_count": 0, "accepted_answer_id": 39247633, "answer_count": 1, "score": 2, "last_activity_date": 1525897393, "creation_date": 1452725203, "last_edit_date": 1452781472, "question_id": 34778522, "link": "https://stackoverflow.com/questions/34778522/vba-code-that-changes-background-color-of-form-conditionally-by-answer", "title": "VBA code that changes background color of form conditionally by answer", "body": "<p>I want to use VBA (or some other solution) to conditionally change the background color of a form based off what number users enter in a numeric field. Basically, after they enter their answer to the Starter question, if they entered 1 then I want the form background to change to a specific shade of blue, and if they entered 2 then I want the form background to change to a specific shade of green. I saw a code that looks like it would be very similar to my need in another question on here, but I couldn't figure out how to make the code work, and was having trouble figuring out exactly how/where to put each module. </p>\n\n<p>Some information:\nThe field I want it to be based off of is numeric, called Starter, and through data validation users are limited to entering 1, 2, 9, or leaving it blank. I only want the color to change if it's entered as 1 or 2. </p>\n\n<p>I'm using Access 2010</p>\n\n<p>the form has neither header nor footer</p>\n\n<p>the code I was attempting to use and made some alterations to is the following:</p>\n\n<pre><code>Private Sub Form_AfterUpdate()\nblue_yes = \"15325906\"\ngreen_no = \"13888226\"\n\nDim colorThis As String\n\nbooWhatever = Me.Starter  ''Use of the variable can prevent problems\n\nIf booWhatever = 1 Then\ncolorThis = \"blue_yes\"\nEnd If\nIf booWhatever = 2 Then\ncolorThis = \"green_no\"\nEnd If\nsubFrm.Form.Section(acDetail).BackColor = colorThis\n\nsubFrm.Form.Repaint\nEnd Sub\n</code></pre>\n\n<p>I've also managed, off a very different piece of code, to sort of do what I want, but the way it's working it seems to change the status of all forms, not just the one I'm currently working with, which is the goal. So for example if I enter 2 to starter, it changes the background color of every single record's form.</p>\n\n<pre><code>Private Sub Starter_AfterUpdate()\nIf Me.Starter = \"1\" Then Me.Detail.BackColor = vbBlue\nIf Me.Starter = \"2\" Then Me.Detail.BackColor = vbGreen\nEnd Sub\n</code></pre>\n\n<p>EDIT:\nWelp, embarrassingly I found the solution. It's not a very neat one, but it works.</p>\n\n<pre><code>Private Sub Form_Current()\nDim Presence As String\nPresence = Nz(Me.Starter.Value, 9)\nSelect Case Presence\nCase \"1\"\nMe.Detail.BackColor = 15325906\nCase \"2\"\nMe.Detail.BackColor = 13888226\nCase Else\nMe.Detail.BackColor = vbWhite\nEnd Select\n\nEnd Sub\n\nPrivate Sub Starter_AfterUpdate()\nDim Presence As String\nPresence = Nz(Me.Starter.Value, 9)\nSelect Case Presence\nCase \"1\"\nMe.Detail.BackColor = 15325906\nCase \"2\"\nMe.Detail.BackColor = 13888226\nCase Else\nMe.Detail.BackColor = vbWhite\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1452721952, "post_id": 34777774, "comment_id": 57300519, "body": "<code>pasted as values</code> If you don&#39;t need formatting, don&#39;t copy paste. Set ranges to each other."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1452723881, "post_id": 34777774, "comment_id": 57301440, "body": "Change this line <code>SrcRng.Copy Destination:=DstSht.Range(&quot;A&quot; &amp; DstRow + 1)</code>  to <code>DstSht.Range(&quot;A&quot; &amp; DstRow + 1).Resize(SrcRng.Rows,SrcRng.Columns).Value = SrcRng.Value</code>  As @findwindow stated it will assign the value and will be quicker than the copy paste."}, {"owner": {"reputation": 145, "user_id": 5079780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f9128a513afd6797ca74aceef2e9f34?s=128&d=identicon&r=PG&f=1", "display_name": "Mikey", "link": "https://stackoverflow.com/users/5079780/mikey"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1453024027, "post_id": 34777774, "comment_id": 57414803, "body": "@ScottCraner This now fails to transfer the information from existing sheets to the consolidated sheet after the amendment. On running no data is moved over,  suggestions please? Need also just to take from row two down on each data sheet."}, {"owner": {"reputation": 145, "user_id": 5079780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f9128a513afd6797ca74aceef2e9f34?s=128&d=identicon&r=PG&f=1", "display_name": "Mikey", "link": "https://stackoverflow.com/users/5079780/mikey"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1453052483, "post_id": 34777774, "comment_id": 57423624, "body": "@findwindow could you give an example?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1453217956, "post_id": 34777774, "comment_id": 57499743, "body": "<a href=\"http://stackoverflow.com/questions/20637835/vba-excel-assigning-range-values-to-a-new-range\" title=\"vba excel assigning range values to a new range\">stackoverflow.com/questions/20637835/&hellip;</a>"}, {"owner": {"reputation": 145, "user_id": 5079780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f9128a513afd6797ca74aceef2e9f34?s=128&d=identicon&r=PG&f=1", "display_name": "Mikey", "link": "https://stackoverflow.com/users/5079780/mikey"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1453218069, "post_id": 34777774, "comment_id": 57499844, "body": "@findwindow sorry don&#39;t get it, could you offer an amendment to the code I&#39;ve included above please?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1453218188, "post_id": 34777774, "comment_id": 57499943, "body": ".... what part don&#39;t you get? Did you even write the code above?"}], "owner": {"reputation": 145, "user_id": 5079780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6f9128a513afd6797ca74aceef2e9f34?s=128&d=identicon&r=PG&f=1", "display_name": "Mikey", "link": "https://stackoverflow.com/users/5079780/mikey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1453052446, "creation_date": 1452721908, "last_edit_date": 1453052446, "question_id": 34777774, "link": "https://stackoverflow.com/questions/34777774/consolidate-paste-special-values", "title": "Consolidate Paste Special (Values)", "body": "<p>How can the data copied to the consolidated sheet be pasted as values, currently works but where formulas are present these are copied over as is when in fact its the result needed from the initial sheet that needs to be taken.</p>\n\n<p>An additional mod is also needed to only copy from row 2 on each entry sheet to the consolidated data tab.</p>\n\n<pre><code>Sub Consolidate_Data_From_Different_Sheets_Into_Single_Sheet()\n\nOn Error GoTo IfError\n\nDim Sht As Worksheet, DstSht As Worksheet\nDim LstRow As Long, LstCol As Long, DstRow As Long\nDim i As Integer, EnRange As String\nDim SrcRng As Range\n\nWith Application\n .ScreenUpdating = False\n .EnableEvents = False\nEnd With\n\nApplication.DisplayAlerts = False\nOn Error Resume Next\nActiveWorkbook.Sheets(\"Consolidate_Data\").Delete\nApplication.DisplayAlerts = True\n\nWith ActiveWorkbook\n Set DstSht = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n DstSht.Name = \"Consolidate_Data\"\nEnd With\n\nFor Each Sht In ActiveWorkbook.Worksheets\n\n    If Sht.Name &lt;&gt; DstSht.Name Then\n\n        DstRow = fn_LastRow(DstSht)     \n\n        LstRow = fn_LastRow(Sht)\n        LstCol = fn_LastColumn(Sht)\n        EnRange = Sht.Cells(LstRow, LstCol).Address\n        Set SrcRng = Sht.Range(\"A1:\" &amp; EnRange)\n\n        If DstRow + SrcRng.Rows.Count &gt; DstSht.Rows.Count Then\n            MsgBox \"There are not enough rows to place the data in the Consolidate_Data worksheet.\"\n            GoTo IfError\n        End If\n\n        SrcRng.Copy Destination:=DstSht.Range(\"A\" &amp; DstRow + 1)\n\n    End If\n\nNext\n\nDstSht.Range(\"A1\") = \"X\"\n\nIfError:\n    With Application\n     .ScreenUpdating = True\n     .EnableEvents = True\n    End With\n\nEnd Sub\n\nFunction fn_LastRow(Sht As Worksheet)\n\nDim lastRow As Long\nlastRow = Sht.Cells.SpecialCells(xlLastCell).Row\nlRow = Sht.Cells.SpecialCells(xlLastCell).Row\nDo While Application.CountA(Sht.Rows(lRow)) = 0 And lRow &lt;&gt; 1\n    lRow = lRow - 1\nLoop\nfn_LastRow = lRow\n\nEnd Function\n\nFunction fn_LastColumn(Sht As Worksheet)\n\nDim lastCol As Long\nlastCol = Sht.Cells.SpecialCells(xlLastCell).Column\nlCol = Sht.Cells.SpecialCells(xlLastCell).Column\nDo While Application.CountA(Sht.Columns(lCol)) = 0 And lCol &lt;&gt; 1\n    lCol = lCol - 1\nLoop\nfn_LastColumn = lCol\n\nEnd Function\n</code></pre>\n\n<p>Tried adding:</p>\n\n<pre><code>Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452721844, "post_id": 34777670, "comment_id": 57300468, "body": "How do you have code that can output sheet name for one condition but not know how to output <code>0</code> for the opposite???"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5780356"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452722249, "post_id": 34777670, "comment_id": 57300662, "body": "Because I suck at VBA and this was all I could figure out. :&#39;( -jon"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1452722393, "post_id": 34777670, "comment_id": 57300757, "body": "Uh I don&#39;t think you figured out anything. If you did, you&#39;d know exactly what to do XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452722637, "post_id": 34777670, "comment_id": 57300876, "body": "The term you are looking for is <code>Else</code> it is part of the <code>If</code> function.  It allows you to do something when the <code>If</code> returns a false."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5780356"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452723657, "post_id": 34777670, "comment_id": 57301347, "body": "Haha Thank you @Scott for the &quot;else&quot; definition, but unfortunately I do already understand that. The &quot;Else&quot; Statement I need is beyond what i have ACTUALLY learned and done (it may have taken me days). The output currently is obviously calling the dates that are associated with the sheets name, but I can not simply tell it to enter in the next available date as &quot;0&quot;. I need to write the else statement to check the dates against a very specific range and not have it output zero for every sheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5780356"}, "edited": false, "score": 0, "creation_date": 1452723762, "post_id": 34777670, "comment_id": 57301390, "body": "Not looking for someone to write it for me, just looking for someone who has more know how to give some advice."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452724272, "post_id": 34777670, "comment_id": 57301606, "body": "<code>check the dates against a very specific range</code> What Range?  You might want to edit your original post with more information.  maybe a picture of the data and what you are trying to output.  It has been a long day and my brain is not firing on all cylinders."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5780356"}, "edited": false, "score": 0, "creation_date": 1452725352, "post_id": 34777670, "comment_id": 57302127, "body": "Thanks Scott, This is my first post on here so thank you for the help. The Dates in that picture although not random are indeed missing dates. So hopefully you can see my where my lack of knowledge makes searching a range to make changes to my previous output is confusing for me."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452726584, "post_id": 34777670, "comment_id": 57302596, "body": "Reading at your code, you are basically looping through all your sheets (except for OUTPUTS) and each time that you find a date which is qualified as PLUS, you&#39;re copying it (along with the name of the sheet) into the spreadsheet OUTPUT. So in the end you find yourself with a list of dates + source sheet name which are qualified as PLUS. How exactly do you expect to have dates that are not qualified as PLUS somewhere into the sheet OUTPUT, if the only dates you&#39;re adding to this are the ones qualified as PLUS?"}, {"owner": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 1, "creation_date": 1452726680, "post_id": 34777670, "comment_id": 57302633, "body": "As a quick-and-dirty, why not just add an Else to your If statement that does the exact same thing as you have, but change the line &#39;.Cells(iRowDestiny, 2).Value = oSht.Name&#39; to &#39;.Cells(iRowDestiny, 2).Value = 0&#39;?  Wouldn&#39;t that do what you want?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 0, "creation_date": 1452726846, "post_id": 34777670, "comment_id": 57302693, "body": "Exactly, if you really want to see the dates that are not qualified as PLUS with a &quot;0&quot; close to it in the OUTPUTS sheet, then @Brad just gave you the exact solution."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5780356"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452726849, "post_id": 34777670, "comment_id": 57302695, "body": "@Matteo you are very correct, I taught myself enough VBA to do just the simple code above. This was a last minute change that I now have to do for reasons beyond me. Am I going To have to write a section to insert the  needed dates with the &quot;0&quot; after the output?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5780356"}, "reply_to_user": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 0, "creation_date": 1452726926, "post_id": 34777670, "comment_id": 57302722, "body": "Sorry just saw your post update @Brad"}, {"owner": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 0, "creation_date": 1452727021, "post_id": 34777670, "comment_id": 57302768, "body": "@Jonathan Alling, if that is what will work for your issue, I&#39;ll put it below as an answer that can be accepted."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5780356"}, "reply_to_user": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 0, "creation_date": 1452727094, "post_id": 34777670, "comment_id": 57302799, "body": "I think it should ! let me tinker with it @Brad. You guys are awesome, thanks for being patient with me. I am VERY new here, How do i give you guys good reputation?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1452727166, "post_id": 34777670, "comment_id": 57302817, "body": "@JonathanAlling if Brad&#39;s solution will work, he&#39;ll write it as an answer to the post. Then you&#39;ll just accept it (and upvote it, if useful ;) ) to give him the deserved credit / to communicate other users with your same issue that this is the correct solution."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5780356"}, "edited": false, "score": 0, "creation_date": 1452727337, "post_id": 34777670, "comment_id": 57302866, "body": "my rep is not high enough to upvote -_- sorry Brad"}, {"owner": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 0, "creation_date": 1452727385, "post_id": 34777670, "comment_id": 57302886, "body": "No worries.  Just glad I could help."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "edited": false, "score": 0, "creation_date": 1452727448, "post_id": 34777670, "comment_id": 57302916, "body": "No worries, @Brad will have it from me for having been the only one really understanding your request ;)"}], "answers": [{"tags": [], "owner": {"reputation": 252, "user_id": 1866809, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/536ac11714e671a831c02e8f3470d2f3?s=128&d=identicon&r=PG", "display_name": "Brad", "link": "https://stackoverflow.com/users/1866809/brad"}, "is_accepted": true, "score": 2, "last_activity_date": 1452727313, "last_edit_date": 1452727313, "creation_date": 1452727123, "answer_id": 34778936, "question_id": 34777670, "link": "https://stackoverflow.com/questions/34777670/vba-newbie-trying-to-correct-date-outputs/34778936#34778936", "title": "VBA Newbie, Trying to correct date outputs", "body": "<p>As a quick-and-dirty, why not just add an <code>Else</code> to your <code>If</code> statement that does the exact same thing as you have, but change the line <code>.Cells(iRowDestiny, 2).Value = oSht.Name</code> to <code>.Cells(iRowDestiny, 2).Value = 0</code>? Wouldn't that do what you want?</p>\n\n<pre><code>If oSht.Cells(iLoop, 19).Value = \"PLUS\" Then\n    With oShtDestiny\n        iRowDestiny = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n        .Cells(iRowDestiny, 1).Value = oSht.Cells(iLoop, 1).Value\n        .Cells(iRowDestiny, 2).Value = oSht.Name\n    End With\nElse\n    With oShtDestiny\n        iRowDestiny = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n        .Cells(iRowDestiny, 1).Value = oSht.Cells(iLoop, 1).Value\n        .Cells(iRowDestiny, 2).Value = \"0\"\n    End With\nEnd If\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5780356"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 34778936, "answer_count": 1, "score": 0, "last_activity_date": 1452727313, "creation_date": 1452721557, "last_edit_date": 1452725640, "question_id": 34777670, "link": "https://stackoverflow.com/questions/34777670/vba-newbie-trying-to-correct-date-outputs", "title": "VBA Newbie, Trying to correct date outputs", "body": "<p>The program simply outputs a list of the sheets that qualified as a \"plus\" status along with the date that they qualified on. </p>\n\n<p><a href=\"https://i.stack.imgur.com/rtJfp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rtJfp.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am currently attempting to insure that the dates that nothing qualified on are outputted with a \"0\" in the adjacent field instead of the name of the sheet. The current program does not do this and want to know what commands i need to add.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pqvjk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pqvjk.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub FilterPlusData()\n\nDim oWbk As Workbook\nDim oSht As Worksheet\nDim oShtDestiny As Worksheet\nDim iLoop As Integer\nDim iFirstRow As Integer\nDim iRows As Integer\nDim iRowDestiny As Integer\n\nSet oWbk = ThisWorkbook\nSet oShtDestiny = oWbk.Worksheets(\"OUTPUT\")\niFirstRow = 4\n\nFor Each oSht In oWbk.Worksheets\n    If oSht.Name &lt;&gt; \"OUTPUT\" Then\n        If oSht.Range(\"$A$2\").Value = \"Date\" Then\n            iRows = oSht.Cells(Rows.Count, 1).End(xlUp).Row\n            For iLoop = iFirstRow To iRows\n                If oSht.Cells(iLoop, 19).Value = \"PLUS\" Then\n                    With oShtDestiny\n                    iRowDestiny = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n                  .Cells(iRowDestiny, 1).Value = oSht.Cells(iLoop, 1).Value\n                  .Cells(iRowDestiny, 2).Value = oSht.Name\n\n                    End With\n                End If\n            Next iLoop\n        End If\n    End If\nNext oSht\n\n'Order Ascendent\niRowDestiny = oShtDestiny.Cells(Rows.Count, 1).End(xlUp).Row + 1\nWith oShtDestiny.Sort\n    .SetRange Range(\"$A$3:C\" &amp; iRowDestiny)\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1452721116, "post_id": 34777486, "comment_id": 57300134, "body": "Are you trying to get your cell to have the formula <code>=C2&amp;&quot; &quot;&amp;C3</code>, or do you want it to show the values of C2 and C3, separated by a space?  Try <code>ws.Range(&quot;A2&quot;).Formula = &quot;=&quot; &amp; a &amp; &quot;&amp;&quot;&quot; &quot;&quot;&amp;&quot; &amp; b</code>.  If you want the <i>values</i> of your variables, separated by a space, use <code>ws.Range(&quot;A2&quot;).Value = a &amp; &quot; &quot; &amp; b</code>."}, {"owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1452722708, "post_id": 34777486, "comment_id": 57300908, "body": "@BruceWayne this is the correct answer the first one worked great. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 1, "creation_date": 1452726169, "post_id": 34778074, "comment_id": 57302446, "body": "Actually also works with .Value interestingly enough"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 0, "creation_date": 1452727687, "post_id": 34778074, "comment_id": 57303000, "body": "@TylerCowan - UUhmmm, I&#39;m just going to ignore that then, to keep my sanity :P I <i>thought</i> I was getting the hang of VBA, and then you tell me I can do <code>.Value</code> just the same.  If someone can comment as to why, that&#39;d be appreciated! Perhaps it&#39;s because you&#39;re using an <code>=</code> at the start, so of course, when Excel sees an <code>=</code> at the start, it uses it as a formula.  I wonder then, what the &quot;real&quot; big difference in using <code>.Value</code> and <code>.Formula</code> for setting formulas is."}, {"owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 1, "creation_date": 1452728103, "post_id": 34778074, "comment_id": 57303168, "body": "Imagine you have integers, doubles for certain calculations and if you use .formula you gonna get screwed. Because .FORMULA always return a String. (Any value set to .formula without is a plain value not a formula) Unless you have exception handling and the extras ready in your code. Whereas .VALUE returns your data&#39;s data type as you expect them to be.  In terms of retrieving formula: Value is one way road in case to set formula but not to retrieve.  <a href=\"http://stackoverflow.com/questions/13687800/why-use-range-formula-in-vba-for-excel-2003-instead-of-range-value\" title=\"why use range formula in vba for excel 2003 instead of range value\">stackoverflow.com/questions/13687800/&hellip;</a>"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1452723068, "creation_date": 1452723068, "answer_id": 34778074, "question_id": 34777486, "link": "https://stackoverflow.com/questions/34777486/vba-variable-string-concatenation/34778074#34778074", "title": "VBA variable string concatenation", "body": "<p>From my comment,</p>\n\n<p><code>ws.Range(\"A2\").Formula = \"=\" &amp; a &amp; \"&amp;\"\" \"\"&amp;\" &amp; b</code></p>\n\n<p>This works because you need to use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838835.aspx\" rel=\"nofollow\"><code>.Formula</code></a> instead of <code>.Value</code>.  </p>\n"}], "owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1734, "favorite_count": 0, "accepted_answer_id": 34778074, "answer_count": 1, "score": 0, "last_activity_date": 1452723068, "creation_date": 1452720909, "question_id": 34777486, "link": "https://stackoverflow.com/questions/34777486/vba-variable-string-concatenation", "title": "VBA variable string concatenation", "body": "<p>I have a variable a = \"C2\"\nand variable b = \"C3\"</p>\n\n<p>I need to do something like</p>\n\n<pre><code>ws.Range(\"A2\").Value = \"=\" &amp; a &amp;\"\" \"\"&amp; b\n</code></pre>\n\n<p>which should return:</p>\n\n<pre><code>=C2&amp;\" \"&amp;C3\n</code></pre>\n\n<p>in an excel formula however I cant seem to get this to work anyone have a solution??</p>\n"}, {"tags": ["vba", "ms-access", "report"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 5552256, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/71757d0892009d76e1b81cbd8453c961?s=128&d=identicon&r=PG&f=1", "display_name": "barry17", "link": "https://stackoverflow.com/users/5552256/barry17"}, "edited": false, "score": 0, "creation_date": 1452778551, "post_id": 34778025, "comment_id": 57325060, "body": "Yes x and z were meant to be declared as Integer. Thank you this solved my problem."}], "tags": [], "owner": {"reputation": 2602, "user_id": 5565170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d110c1241538fcf7c1fd6b6ebfa6153f?s=128&d=identicon&r=PG&f=1", "display_name": "Stidgeon", "link": "https://stackoverflow.com/users/5565170/stidgeon"}, "is_accepted": true, "score": 2, "last_activity_date": 1452724011, "last_edit_date": 1452724011, "creation_date": 1452722874, "answer_id": 34778025, "question_id": 34777461, "link": "https://stackoverflow.com/questions/34777461/access-queries-and-reporting-with-vba/34778025#34778025", "title": "Access queries and reporting with VBA?", "body": "<p>Depending on whether you want to insert from your query into a new table or an existing table, there's always 'SELECT INTO' or 'INSERT INTO', but going from your VBA code as a guide . . . </p>\n\n<p>I'm not certain about some of the lines in your code - there's two variable (x and z), only one declared, so I think these are meant to be the same thing, and I think you want to call that many records from the recordset. There's also an odd declaration of 'db' two times.</p>\n\n<p>Here's an approach that I've used for copying query results to a table, along with a few comments to explain what's what:</p>\n\n<pre><code>' declare two recordsets - one for the query, one for the target table\nDim rs1 As DAO.Recordset\nDim rs2 As DAO.Recordset\n\n' declare a string which will house your SQL statement\nDim SQL As String\n\n' specify your SQL statement here\nSQL = \"SELECT * FROM table WHERE conditions\"\n\n' set the two recordsets to the query and the target table\nSet rs1 = CurrentDb.OpenRecordset(SQL)\nSet rs2 = CurrentDb.OpenRecordset(\"tbl_TempTable\")\n\n' step through the query results, one record at a time\n' for each entry, copy that info to the 2nd recordset\n' stop at End Of File\nWith rs1\nWhile Not .EOF\n    rs2.AddNew\n    rs2(\"CompanyID\") = rs1(\"CompanyID\")\n    rs2(\"CompanyName\") = rs1(\"CompanyName\")\n    rs2(\"UnitPrice\") = rs1(\"UnitPrice\")\n    rs2.Update\n    .MoveNext\nWend\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5552256, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/71757d0892009d76e1b81cbd8453c961?s=128&d=identicon&r=PG&f=1", "display_name": "barry17", "link": "https://stackoverflow.com/users/5552256/barry17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 34778025, "answer_count": 1, "score": 0, "last_activity_date": 1452724011, "creation_date": 1452720811, "last_edit_date": 1452722326, "question_id": 34777461, "link": "https://stackoverflow.com/questions/34777461/access-queries-and-reporting-with-vba", "title": "Access queries and reporting with VBA?", "body": "<p>I have a few queries that I've created for a report. I'm trying to write some VB code so that I am able create a recordSet from the data in my query and populate tbl_TempTable with that data. </p>\n\n<p>My table is:</p>\n\n<pre><code>tbl_TempTable \nCompanyID     CompanyName     UnitPrice\n-------------------------------------------\n</code></pre>\n\n<p>my qryCompanyInfo has the same columns as the above table, but obviously each column is populated with 30 records or so. </p>\n\n<p>This is my code so far:</p>\n\n<pre><code>dim rs as dao.recordset\ndim db as dao.recordset\ndim db = currentDB()\ndim x as integer\n\nSet rs = db.openrecordset(\"qryCompanyInfo\")\nz=rs.recordcount\nmsgbox z\n</code></pre>\n\n<p>What happens here is that ONLY 1 record gets selected. Why is it doing that, there should be about 30 records being selected? Do I need to execute the query first before selecting the data? How would I also go about populating my tbl_TempTable with the data that I extract from the qry?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1452720827, "post_id": 34777439, "comment_id": 57299991, "body": "<code>.address</code> is not a function of <code>Index</code>  Index is going to return a value not a range object."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1452721084, "creation_date": 1452721084, "answer_id": 34777530, "question_id": 34777439, "link": "https://stackoverflow.com/questions/34777439/object-variable-index-match-error/34777530#34777530", "title": "Object variable index match error", "body": "<p>try this</p>\n\n<pre><code>set found_value = Range_Lookup1.Find(artnr)\nfound_value1 = Workbooks(\"queries.xlsm\").Worksheets(\"artnr_package\").found_value.Offset(0, 6)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 4001735, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dayR9.jpg?s=128&g=1", "display_name": "scorpion", "link": "https://stackoverflow.com/users/4001735/scorpion"}, "is_accepted": true, "score": 0, "last_activity_date": 1452975753, "creation_date": 1452975753, "answer_id": 34831733, "question_id": 34777439, "link": "https://stackoverflow.com/questions/34777439/object-variable-index-match-error/34831733#34831733", "title": "Object variable index match error", "body": "<p>I tried several options and decided to do it with arrays.\nI' ve filled the 2 arrays and merged the 2 arrays and search within.\nAnd I think it's must faster, see piece of code below.</p>\n\n<p>Suggestions are always welcome.</p>\n\n<pre><code>Dim art_data() As Variant\nReDim art_data(1 To lr - 1, 1 To 25)\nart_data = Workbooks(\"queries.xlsm\").Worksheets(\"Data\").Range(\"A2:Y\" &amp; lr).Value\n\nDim art_package() As Variant\nReDim art_package(1 To lr1 - 1, 1 To 10)\nart_package = Workbooks(\"queries.xlsm\").Worksheets(\"artnr_package\").Range(\"A2:J88\").Value\n\nFor i = 1 To lr - 1\n\n    For j = 1 To lr1 - 1\n\n    If art_data(i, 2) = art_package(j, 1) Then\n    ReDim Preserve art_data(LBound(art_data) To UBound(art_data), 1 To 35)\n        art_data(i, 26) = art_package(j, 1)\nart_data(i, 27) = art_package(j, 2)\nart_data(i, 28) = art_package(j, 3)\nart_data(i, 29) = art_package(j, 4)\nart_data(i, 30) = art_package(j, 5)\nart_data(i, 31) = art_package(j, 6)\nart_data(i, 32) = art_package(j, 7)\nart_data(i, 33) = art_package(j, 8)\nart_data(i, 34) = art_package(j, 9)\nart_data(i, 35) = art_package(j, 10)\n    End If\n\n    Next j\n\nNext i\n\n    For k = 1 To lr - 1\n\n    If Trim(art_data(k, 10)) = \"\" Then\n    ReDim Preserve art_data(LBound(art_data) To UBound(art_data), 1 To 35)\n    art_data(k, 10) = art_data(k, 35)\n\n    End If\n\n    Next k\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4001735, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dayR9.jpg?s=128&g=1", "display_name": "scorpion", "link": "https://stackoverflow.com/users/4001735/scorpion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 34831733, "answer_count": 2, "score": 0, "last_activity_date": 1452975753, "creation_date": 1452720736, "question_id": 34777439, "link": "https://stackoverflow.com/questions/34777439/object-variable-index-match-error", "title": "Object variable index match error", "body": "<p>Could anyone help me with this please?\nIt's probably something simple, but I dont't see it.\nThanks in advance.</p>\n\n<p>Object variable or With block variable not set (Error 91)\n( in index/match line )</p>\n\n<pre><code>Dim last_row_Datasheet As Long\nDim i As Long\nDim j As Long\nDim found_value As Range\nDim found_value1 As Variant\nDim artnr As Variant\nDim Range_Lookup As Variant\nDim Range_Lookup1 As Variant\n\nFor i = 2 To last_row_Datasheet\n\nartnr = Workbooks(\"queries.xlsm\").Worksheets(\"Data\").Cells(i, 2)\n\nSet Range_Lookup = Workbooks(\"queries.xlsm\").Worksheets(\"artnr_package\").Range(\"A2:A88\")\nSet Range_Lookup1 = Workbooks(\"queries.xlsm\").Worksheets(\"artnr_package\").Range(\"A2:A88\")\nfound_value = Application.WorksheetFunction.Index(Range_Lookup, Application.WorksheetFunction.Match(artnr, Range_Lookup1, 0)).Address\nfound_value1 = Workbooks(\"queries.xlsm\").Worksheets(\"artnr_package\").Range(found_value).Offset(0, 6)\n\nIf ActiveSheet.Cells(i, 10) = \"Not packed\" Then\nWorkbooks(\"queries.xlsm\").Worksheets(\"Data\").Cells(i, 10) = found_value1\nEnd If\n\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "userform"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1452720407, "post_id": 34777311, "comment_id": 57299790, "body": "Could you show us some code?  We might be able to help you get it working."}, {"owner": {"reputation": 1, "user_id": 5753827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935c090b3678c48ea16bc4d2a181f250?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/5753827/ashley"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1452869745, "post_id": 34777311, "comment_id": 57369459, "body": "I added the code that I currently have but it doesn&#39;t account for the possibility of a different UserForm being opened. Is there a was of saying If UserForm A called UserForm C to open then transfer the information back to UserForm A? I have only been working with VBA for a few months so I only know the basics."}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1452720679, "creation_date": 1452720679, "answer_id": 34777417, "question_id": 34777311, "link": "https://stackoverflow.com/questions/34777311/can-you-use-an-if-statement-to-decide-what-userform-to-put-information-in/34777417#34777417", "title": "Can you use an if statement to decide what UserForm to put information in?", "body": "<p>You could base it on option button values.  On your FormC place two option buttons with the text FormA and the other FormB.  Then in the click or change event of the control you are \"choosing an ID number from UserForm C\", use an if statement </p>\n\n<pre><code>If OptionButton1.Value = True Then\n    UserFormA.Label1.Value = \"A\"\nElse\n    UserFormB.Label1.Value = \"B\"\nEnd If\n</code></pre>\n\n<p>That is all I can offer without seeing your forms and or code. </p>\n"}], "owner": {"reputation": 1, "user_id": 5753827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935c090b3678c48ea16bc4d2a181f250?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/5753827/ashley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 845, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452865676, "creation_date": 1452720337, "last_edit_date": 1452865676, "question_id": 34777311, "link": "https://stackoverflow.com/questions/34777311/can-you-use-an-if-statement-to-decide-what-userform-to-put-information-in", "title": "Can you use an if statement to decide what UserForm to put information in?", "body": "<p>I have the following issue: I have UserForm A and UserForm B in excel. Both UserForms call UserForm C. The user chooses an ID number from UserForm C that I then want to be put into a label in either UserForm A or UserForm B depending on which one is currently open. </p>\n\n<p>I have searched for a possible answer or alternative solution to this but haven't been able to find anything that helped. I am trying to avoid having to make two UserForm C's if I can help it. Any help is greatly appreciated. </p>\n\n<p>Thanks!</p>\n\n<p>Edit: Right now my code for Userform C is initiated by a click event. So, the user selects the ID number from a list box which gets saved automatically into a label that is hidden. When the user clicks the save button the hidden labels caption (the ID) gets transferred to UserForm A. What I would ultimately like is for there to be some kind of if statement to differentiate if Userform A is open and if not then the hidden labels caption would instead get transferred to UserForm B. I have thought about using an option button for the user for choose from, but not all users have access to UserForm B so I would prefer to not let the user try to determine where they should be saving the ID to. </p>\n\n<p>The code I have for the click event is:<br>\n    Private Sub cmd_save_Click()<br>\n    UserFormC.Label1.Caption=UserFormA.Label1.Caption<br>\n    Unload UserFormC<br>\n    End Sub  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 7, "creation_date": 1452719927, "post_id": 34776922, "comment_id": 57299552, "body": "If the code works as intended, you may not be aware that <a href=\"https://codereview.stackexchange.com\">Code Review</a> specializes in exactly this: turning <i>working code</i> into <i>great code</i>. Just saying ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1452720501, "post_id": 34777065, "comment_id": 57299833, "body": "This is a nice and concise post Scott! I&#39;ll make sure to keep a link to it, as reminding folks to qualify ranges, and remove <code>.Select</code> is one of my most common comments. Kudos!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1452721953, "post_id": 34777065, "comment_id": 57300520, "body": "Eh, you&#39;re right. This isn&#39;t that great.  :P (kidding, of course)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1452719415, "creation_date": 1452719415, "answer_id": 34777065, "question_id": 34776922, "link": "https://stackoverflow.com/questions/34776922/lets-make-this-vba-code-more-efficient/34777065#34777065", "title": "Lets make this vba code more efficient", "body": "<p>Always qualify your Ranges</p>\n\n<pre><code>Cells(1, 19)\n</code></pre>\n\n<p>Should have the worksheet qualifier</p>\n\n<pre><code>Worksheets(\"Sheet1\").Cells(1, 19)\n</code></pre>\n\n<p>This keeps proper references.</p>\n\n<p>Also remove all <code>.Select</code> it slows it down:</p>\n\n<p>This:</p>\n\n<pre><code>Rows(\"1:1\").Select\n    With Selection.Font\n        .Name = \"Arial\"\n        ...\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>With Worksheet(\"Sheet1\").Rows(\"1:1\").Font\n    .Name = \"Arial\"\n    ...\n</code></pre>\n\n<p>or you could:</p>\n\n<pre><code>With Worksheet(\"Sheet1\").Rows(\"1:1\")\n    With .Font\n        .Name = \"Arial\"\n        .Size = 8\n        .Bold = True\n    End with\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlCenter\n    With .Interior\n        .Pattern = xlNone\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5775599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/332d60e123ba909b71cf8b1295562022?s=128&d=identicon&r=PG&f=1", "display_name": "AdministrativeAssistantMike", "link": "https://stackoverflow.com/users/5775599/administrativeassistantmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 34777065, "answer_count": 1, "score": -1, "last_activity_date": 1452719415, "creation_date": 1452718835, "question_id": 34776922, "link": "https://stackoverflow.com/questions/34776922/lets-make-this-vba-code-more-efficient", "title": "Lets make this vba code more efficient", "body": "<p>I'm new to coding and have tried many recording and editing in VBA to learn somewhat what to do. I've also seached many sites to learn the basics of VBA. I'm finally finished with this VBA mini-program that I'm working on. Could you all take a look at it and tell me what I could change to make it more efficient or adaptable to other spreadsheets?</p>\n\n<p>First of all, I copy and paste 2 worksheets from other workbooks into this new workbook and use this program on it. The first worksheet will have the most current information on all the products and new incoming products(without any comments). The second worksheet will basically be the worksheet I generated from the day before (with all the comments that other people have put onto it throughout the day). So basically it's an updating program. Most of the time, the second worksheet will go up to column R, but sometimes other people will delete a column and the last column used will be Q instead. So if someone could help in this it would be very much appreciated.</p>\n\n<p>I usually start out entering in Due Date, Owner, and Location into the last 3 new columns. Then to make sure that they have the same font and spacing as the others, I change them to the same font accordingly. After that, I have to go through the 2nd worksheet, and copy the Due Date, Owner, and Location details and comments to the 1st worksheet in the corresponding cell that has the same serial number (usually in column F) and assembly number (usually in column E). There are a lot of the same assebly numbers but a few that are the same for serial numbers, that's why I did the If statements for the serial number first. After all the information is copied over, some of the comments are highlighted in various colors, so I have to make sure that the whole row has to be highlighted too.</p>\n\n<p>After that, I change all of the body of the worksheet to a certain font, then autofit both columns and rows to make it look neater. Lastly, I order the 1st spreadsheet in decending order, then copy and paste it to a new spreadsheet so that it would be a regular spreadsheet without any macros on it.</p>\n\n<p>I didn't know how to write some of the codes, so I just copied and pasted the recorded macros I tried before. All I did was change the range of it to cover the last entry at the least.</p>\n\n<pre><code>Dim a As Integer\nDim b As Integer\nDim s1 As Worksheet\nDim s2 As Worksheet\n\nSet s1 = ThisWorkbook.Worksheets(\"Sheet1\")\nSet s2 = ThisWorkbook.Worksheets(\"Sheet2\")\n\na = s1.UsedRange.Rows.Count\nb = s2.UsedRange.Rows.Count\n\nCells(1, 19) = \"Due Date\"\nCells(1, 20) = \"Owner\"\nCells(1, 21) = \"Location\"\n\nRows(\"1:1\").Select\nWith Selection.Font\n    .Name = \"Arial\"\n    .Size = 8\nEnd With\nSelection.Font.Bold = True\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlCenter\nEnd With\nWith Selection.Interior\n    .Pattern = xlNone\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\n\nActiveSheet.Range(\"$A$1:$U$500\").AutoFilter Field:=3, Criteria1:=\"=WO\", _\n    Operator:=xlOr, Criteria2:=\"=WR\"\nRows(\"2:500\").Select\nSelection.Delete Shift:=xlUp\nActiveSheet.AutoFilterMode = False\nActiveSheet.Range(\"$A$1:$U$500\").AutoFilter Field:=8, Criteria1:= _\n    \"Inventory\"\nSelection.Delete Shift:=xlUp\nActiveSheet.AutoFilterMode = False\n\nDim i As Integer\nDim ii As Integer\n\ni = 2\nii = 2\n\nFor i = 2 To a\n    For ii = 2 To b\n        If s1.Cells(i, 6) = s2.Cells(ii, 6) Then\n            If s1.Cells(i, 5) = s2.Cells(ii, 5) Then\n                s2.Range(s2.Cells(ii, 18), s2.Cells(ii, 21)).Copy s1.Range(s1.Cells(i, 18), s1.Cells(i, 21))\n                s1.Range(s1.Cells(i, 1), s1.Cells(i, 17)).Interior.ColorIndex = Cells(i, 18).Interior.ColorIndex\n            End If\n        End If\n    Next ii\nNext i\n\nWith Selection.Font\n    .Name = \"Calibri\"\n    .Size = 8\nEnd With\n\nCells.Select\nCells.EntireColumn.AutoFit\nCells.EntireRow.AutoFit\n\nRange(\"A1\").Select\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"A1\"), _\n    SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n    .SetRange Range(\"A2:U500\")\n    .Header = xlNo\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1452717440, "post_id": 34776507, "comment_id": 57298302, "body": "<code>CreateXLSXFiles</code> takes a string argument but <code>Call CreateXLSXFiles</code> passes no argument. What do you expect to happen?"}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452717593, "post_id": 34776591, "comment_id": 57298397, "body": "That is probably OP&#39;s intention -- but in this case it should be moved into the body of the loop. On the other hand -- it already <i>is</i> in the body of the loop, so it really isn&#39;t clear what, if anything, is intended here."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452717869, "post_id": 34776591, "comment_id": 57298546, "body": "@JohnColeman ah right, didn&#39;t notice that. Well now that I see the code properly, I neither understand what the OP means. Let&#39;s wait for some clarifications."}, {"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 0, "creation_date": 1452718956, "post_id": 34776591, "comment_id": 57299100, "body": "I am sorry, still learning <code>vba</code>. The <code>loop</code> ensures that all the text files in the directory are used.  Then the call is made.  So in stead of <code>Loop Call CreateXLSXFiles (call made outside loop)</code> should it be <code>Call CreatXLSXFiles(fn) Loop (call made inside loop)</code>?  The intention is that all the text files are passed to the module.  Thank you :)."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 1, "creation_date": 1452719272, "post_id": 34776591, "comment_id": 57299249, "body": "@Chris You <i>already</i> have a syntactically proper call to <code>CreateXLSXFiles</code> inside the loop -- so I wouldn&#39;t think that there is anything else to process. Why not just drop the offending line entirely? It seems to have no purpose."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 1, "creation_date": 1452719628, "post_id": 34776591, "comment_id": 57299397, "body": "@Chris I agree with John, that line of code which is raising the exception does nothing, you can simply drop it."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1452717528, "creation_date": 1452717528, "answer_id": 34776591, "question_id": 34776507, "link": "https://stackoverflow.com/questions/34776507/excel-2010-vba-error-calling-module/34776591#34776591", "title": "excel 2010 vba error calling module", "body": "<p>The method <code>CreateXLSXFiles</code> takes a <code>String</code> as input : </p>\n\n<pre><code>Sub CreateXLSXFiles(fn As String)\n</code></pre>\n\n<p>However, you're calling it without passing any string: </p>\n\n<pre><code>Call CreateXLSXFiles\n</code></pre>\n\n<p>In order to make it work, you need to pass the needed <code>fn</code> (that I guess it means \"file name\") :</p>\n\n<pre><code>Call CreateXLSXFiles(fn)\n</code></pre>\n\n<p>or with the newest syntax,  simply: </p>\n\n<pre><code>CreateXLSXFiles fn\n</code></pre>\n"}], "owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452717528, "creation_date": 1452717184, "last_edit_date": 1531164843, "question_id": 34776507, "link": "https://stackoverflow.com/questions/34776507/excel-2010-vba-error-calling-module", "title": "excel 2010 vba error calling module", "body": "<p>In the below <code>excel 2010 vba</code> all the text files are opened and read by the <code>loop</code> and then a <code>call to a module</code> that is in the same sheet is made.  However I am getting an <code>Argument not optional' error on that line (</code>Call CreateXLSXFiles`).  I need some expert help in fixing this as I can not figure it out.  Thank you :)</p>\n\n<p><strong>VBA</strong></p>\n\n<pre><code>'CREATE REPORT '\nMsgBox (\"Please click ok to generate analysis reports, vbOKOnly\")\n\nDim myDir As String, fn As String\nmyDir = \"C:\\Users\\cmccabe\\Desktop\\EmArray\\\"\nfn = Dir(myDir &amp; \"*.txt\")\nDo While fn &lt;&gt; \"\"\n   CreateXLSXFiles myDir &amp; fn\n   fn = Dir\nLoop\n\nCall CreateXLSXFiles\n</code></pre>\n\n<p><strong>Module</strong></p>\n\n<pre><code>Sub CreateXLSXFiles(fn As String)\n' PARSE TEXT FILE AND CREATE XLSX REPORT '\nDim txt As String, m As Object, n As Long, fp As String\nDim i As Long, x, temp, ub As Long, myList\n\n myList = Array(\"Display Name\", \"Medical Record\", \"Date of Birth\", _\n                \"Order Date\", \"Gender\", \"Barcode\", \"Sample\", \"Build\", _\n                \"SpikeIn\", \"Location\", \"Control Gender\", \"Quality\")\n\nfp = \"C:\\Users\\cmccabe\\Desktop\\EmArray\\\"\n\nWith Worksheets(1)\n    .Cells.Clear\n    .Name = CreateObject(\"Scripting.FileSystemObject\").GetBaseName(fn)\nOn Error Resume Next\nn = FileLen(fn)\nIf Err Then\n    MsgBox \"Something wrong with \" &amp; fn\n    Exit Sub\nEnd If\nOn Error GoTo 0\nn = 0\ntxt = CreateObject(\"Scripting.FileSystemObject\").OpenTextFile(fn).ReadAll\nWith CreateObject(\"VBScript.RegExp\")\n    .Global = True: .MultiLine = True\n    For i = 0 To UBound(myList)\n        .Pattern = \"^#(\" &amp; myList(i) &amp; \" = (.*))\"\n        If .Test(txt) Then\n            n = n + 1\n            Sheets(1).Cells(n, 1).Resize(, 2).Value = _\n            Array(.Execute(txt)(0).submatches(0), .Execute(txt)(0).submatches(1))\n        End If\n    Next\n    .Pattern = \"^[^#\\r\\n](.*[\\r\\n]+.+)+\"\n    x = Split(.Execute(txt)(0), vbCrLf)\n    .Pattern = \"(\\t| {2,})\"\n    temp = Split(.Replace(x(0), Chr(2)), Chr(2))\n    n = n + 1\n    For i = 0 To UBound(temp)\n        Sheets(1).Cells(n, i + 1).Value = temp(i)\n    Next\n    ub = UBound(temp)\n    .Pattern = \"((\\t| {2,})| (?=(\\d|\"\")))\"\n    For i = 1 To UBound(x)\n        temp = Split(.Replace(x(i), Chr(2)), Chr(2))\n        n = n + 1\n        Sheets(1).Cells(n, 1).Resize(, ub).Value = temp\n    Next\nEnd With\n.Copy\n    Application.DisplayAlerts = False\n    With ActiveSheet\n         .Columns.AutoFit\n         .Range(\"B1:B12\").ClearContents\n    End With\n    ActiveWorkbook.SaveAs Filename:=fp &amp; .Name, _\n                          FileFormat:=xlOpenXMLWorkbook\n    ActiveWorkbook.Close False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452717231, "post_id": 34776327, "comment_id": 57298189, "body": "You are applying the formatting bit on the same range each time."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452720641, "post_id": 34776327, "comment_id": 57299905, "body": "I think a large part of this could be solved by making sure you qualify the ranges, and make sure you are activating/using the right sheets.  See Scott&#39;s short and concise answer <a href=\"http://stackoverflow.com/a/34777065/4650297\">here</a> for an idea on how to remove <code>.Select</code> and work directly with the ranges."}], "answers": [{"comments": [{"owner": {"reputation": 444, "user_id": 5776000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab7ccf2ff7539f836ababa39966c913f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan Pinnow", "link": "https://stackoverflow.com/users/5776000/stefan-pinnow"}, "edited": false, "score": 0, "creation_date": 1452811619, "post_id": 34777416, "comment_id": 57345654, "body": "<code>.Value = .Value</code> <i>does</i> something: if there were formulas in the cells, they will be replaced by their values."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 1, "last_activity_date": 1452720678, "creation_date": 1452720678, "answer_id": 34777416, "question_id": 34776327, "link": "https://stackoverflow.com/questions/34776327/i-have-to-run-my-macro-twice-for-it-to-be-correct/34777416#34777416", "title": "I have to run my macro twice for it to be correct", "body": "<p>I took the freedom to clean a bit your code, you might want to try this one (it should work at first time): </p>\n\n<pre><code>Sub UCS_Inventory_Mac1()\n\nDim I As Integer\nDim WS_Count As Integer\n\nWS_Count = ActiveWorkbook.Worksheets.Count + 1 '&lt;-- please note: the sheets are always 7, why do you set them to 8?\n\nDim ranges(1 To 7) '&lt;-- this is the only not-indexable part of your code, store it in an array to make the code more readable\nranges(1) = \"$A$1:$E$4\"\nranges(2) = \"$A$1:$B$11\"\nranges(3) = \"$A$1:$D$11\"\nranges(4) = \"$A$1:$D$11\"\nranges(5) = \"$A$1:$D$11\"\nranges(6) = \"$A$1:$C$11\"\nranges(7) = \"$A$1:$B$11\"\n\nFor I = 1 To WS_Count\n\n    With Worksheets(\"Sheet\" &amp; I) '&lt;-- no need to activate the sheet\n\n        With .Range(\"B2:H15\") '&lt;-- even here, no need to select\n        .NumberFormat = \"General\"\n        .Value = .Value '&lt;-- this instruction does nothing\n        End With\n\n        .Range(\"B2\").Select '&lt;-- do you really need to select the range? This will just make your code flashing through sheets\n        With .Shapes.AddChart2(201, xlColumnClustered)\n            .SetSourceData Source:=Range(\"Sheet\" &amp; I &amp; \"!\" &amp; ranges(I))\n            .SetElement (msoElementDataLabelOutSideEnd)\n            .SetElement (msoElementLegendBottom)\n            .SetElement (msoElementLegendTop)\n            .ChartTitle.Text = \"Chart \" &amp; I\n        End With\n\n    End With\n\nNext I\n\nEnd Sub\n</code></pre>\n\n<p>You will find my comments in the code itself, but I'm pretty sure the problem comes from your misuse of <code>Select</code> / <code>Activate</code> statements that probably lead you to a wrongly qualified range.</p>\n"}], "owner": {"reputation": 1, "user_id": 5786379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0024cd8c2b1fa78a869525489d0a8c3?s=128&d=identicon&r=PG&f=1", "display_name": "ATsay", "link": "https://stackoverflow.com/users/5786379/atsay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1262, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455974430, "creation_date": 1452716559, "last_edit_date": 1455974430, "question_id": 34776327, "link": "https://stackoverflow.com/questions/34776327/i-have-to-run-my-macro-twice-for-it-to-be-correct", "title": "I have to run my macro twice for it to be correct", "body": "<p>I created a macro in Excel which iterates through every worksheet - converting text into numbers and then creating a graph from the data. I need to run my macro twice for it to work. </p>\n\n<p>The 1st time, only the graph for the 1st sheet is correct. For the other tabs, all the text is converted to numbers, but the graphs are not mapping to the right data.</p>\n\n<p>The 2nd time I run the macro, everything is as it should be.</p>\n\n<pre><code>Sub UCS_Inventory_Mac1()\n\nDim I As Integer\nDim WS_Count As Integer\n\nWS_Count = ActiveWorkbook.Worksheets.Count + 1\n\nFor I = 1 To WS_Count\n\n    Range(\"B2:H15\").Select\n        With Selection\n        Selection.NumberFormat = \"General\"\n        .Value = .Value\n    End With\n\n    If I = 1 Then\n        Range(\"B2\").Select\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.SetSourceData Source:=Range(\"Sheet1!$A$1:$E$4\")\n        ActiveChart.SetElement (msoElementDataLabelOutSideEnd)\n        ActiveChart.SetElement (msoElementLegendBottom)\n        ActiveChart.SetElement (msoElementLegendTop)\n        ActiveChart.ChartTitle.Text = \"Chart 1\"\n\n    ElseIf I = 2 Then\n        Worksheets(\"Sheet2\").Activate\n        Range(\"B2\").Select\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.SetSourceData Source:=Range(\"Sheet2!$A$1:$B$11\")\n        ActiveChart.SetElement (msoElementDataLabelOutSideEnd)\n        ActiveChart.SetElement (msoElementLegendBottom)\n        ActiveChart.SetElement (msoElementLegendTop)\n        ActiveChart.ChartTitle.Text = \"Chart 2\"\n\n    ElseIf I = 3 Then\n        Worksheets(\"Sheet3\").Activate\n        Range(\"B2\").Select\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.SetSourceData Source:=Range(\"Sheet3!$A$1:$D$11\")\n        ActiveChart.SetElement (msoElementDataLabelOutSideEnd)\n        ActiveChart.SetElement (msoElementLegendBottom)\n        ActiveChart.SetElement (msoElementLegendTop)\n        ActiveChart.ChartTitle.Text = \"Chart 3\"\n\n    ElseIf I = 4 Then\n        Worksheets(\"Sheet4\").Activate\n        Range(\"B2\").Select\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.SetSourceData Source:=Range(\"Sheet4!$A$1:$D$11\")\n        ActiveChart.SetElement (msoElementDataLabelOutSideEnd)\n        ActiveChart.SetElement (msoElementLegendBottom)\n        ActiveChart.SetElement (msoElementLegendTop)\n        ActiveChart.ChartTitle.Text = \"Chart 4\"\n\n    ElseIf I = 5 Then\n        Worksheets(\"Sheet5\").Activate\n        Range(\"B2\").Select\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.SetSourceData Source:=Range(\"Sheet5!$A$1:$D$11\")\n        ActiveChart.SetElement (msoElementDataLabelOutSideEnd)\n        ActiveChart.SetElement (msoElementLegendBottom)\n        ActiveChart.SetElement (msoElementLegendTop)\n        ActiveChart.ChartTitle.Text = \"Chart 5\"\n\n    ElseIf I = 6 Then\n        Worksheets(\"Sheet6\").Activate\n        Range(\"B2\").Select\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.SetSourceData Source:=Range(\"Sheet6!$A$1:$C$11\")\n        ActiveChart.SetElement (msoElementDataLabelOutSideEnd)\n        ActiveChart.SetElement (msoElementLegendBottom)\n        ActiveChart.SetElement (msoElementLegendTop)\n        ActiveChart.ChartTitle.Text = \"Chart 6\"\n\n    ElseIf I = 7 Then\n        Worksheets(\"Sheet7\").Activate\n        Range(\"B2\").Select\n        ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n        ActiveChart.SetSourceData Source:=Range(\"Sheet7!$A$1:$B$11\")\n        ActiveChart.SetElement (msoElementDataLabelOutSideEnd)\n        ActiveChart.SetElement (msoElementLegendBottom)\n        ActiveChart.SetElement (msoElementLegendTop)\n        ActiveChart.ChartTitle.Text = \"Chart 7\"\n\nEnd If\n\nNext I\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452718348, "post_id": 34776110, "comment_id": 57298810, "body": "the first part of the last line <code>transalte_using_vba</code> must be the same as your function name. for example if you change the function name to <code>somefunction</code> then you must change the last line to <code>somefunction = result_data</code>."}, {"owner": {"reputation": 127, "user_id": 5703564, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/315cdd980f17de8c45198f6871297bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Deve", "link": "https://stackoverflow.com/users/5703564/deve"}, "reply_to_user": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452760904, "post_id": 34776110, "comment_id": 57313890, "body": "I tried this but still not working.... I am opening the editor inserting a new module that saving it as an add-in.xlam and then I&#39;m adding it...but still not working"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452776786, "post_id": 34776110, "comment_id": 57323913, "body": "see my answer. this will work in your workbook , but note this function is very slow."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1452718129, "post_id": 34776356, "comment_id": 57298692, "body": "psssst. you misspelled <code>mispeeled</code>"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1452784935, "post_id": 34776356, "comment_id": 57329830, "body": "What is it that isn&#39;t working. Are you getting an error pop up? Is the result of the formula <code>#NAME</code> or <code>#REF</code> or <code>#N&#47;A</code> or NULL. Is the UDF just not running? I tried your function as-is (after correcting the spelling) by placing the function in a new module, saving the worksheet, and then entering <code>=Translate_To_Arabic(&quot;Test&quot;)</code> into a cell and it came back as Arabic. I can&#39;t read Arabic, but I assume it said &quot;Test&quot;."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1452716701, "creation_date": 1452716701, "answer_id": 34776356, "question_id": 34776110, "link": "https://stackoverflow.com/questions/34776110/excel-function-to-convert-english-names-to-arabic/34776356#34776356", "title": "Excel Function To Convert English Names To Arabic", "body": "<p>The problem is that your last line of the code should be:</p>\n\n<pre><code>Translate_To_Arabic = result_data\n</code></pre>\n\n<p>You have mispeeled \"Translate\"</p>\n\n<p>Also make sure you added the Reference to the Microsoft Internet Controls</p>\n"}, {"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1452776573, "creation_date": 1452776573, "answer_id": 34790361, "question_id": 34776110, "link": "https://stackoverflow.com/questions/34776110/excel-function-to-convert-english-names-to-arabic/34790361#34790361", "title": "Excel Function To Convert English Names To Arabic", "body": "<p>If You want to use this function as UDF use this code:</p>\n\n<pre><code>Function Translate_To_Arabic(Rng As Range) As String\n' Tools Refrence Select Microsoft internet Control\n\n\n    Dim IE As Object, i As Long\n    Dim inputstring As String, outputstring As String, text_to_convert As String, result_data As String, CLEAN_DATA\n\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    '   TO CHOOSE INPUT LANGUAGE\n\n    inputstring = \"auto\"\n\n    '   TO CHOOSE OUTPUT LANGUAGE\n\n    outputstring = \"ar\"\n\n    text_to_convert = Rng.Text\n\n    'open website\n\n    IE.Visible = False\n    IE.navigate \"http://translate.google.com/#\" &amp; inputstring &amp; \"/\" &amp; outputstring &amp; \"/\" &amp; text_to_convert\n\n    Do Until IE.ReadyState = 4\n        DoEvents\n    Loop\n\n    Application.Wait (Now + TimeValue(\"0:00:5\"))\n\n    Do Until IE.ReadyState = 4\n        DoEvents\n    Loop\n\n    CLEAN_DATA = Split(Application.WorksheetFunction.Substitute(IE.Document.getElementById(\"result_box\").innerHTML, \"&lt;/SPAN&gt;\", \"\"), \"&lt;\")\n\n    For j = LBound(CLEAN_DATA) To UBound(CLEAN_DATA)\n        result_data = result_data &amp; Right(CLEAN_DATA(j), Len(CLEAN_DATA(j)) - InStr(CLEAN_DATA(j), \"&gt;\"))\n    Next\n\n\n    IE.Quit\n    Translate_To_Arabic = result_data\n\n\nEnd Function\n</code></pre>\n\n<p>you can use this function in your workbook using this formula in B1: <code>=Translate_To_Arabic(A1)</code>. now if you type <code>book</code> in cell A1 you will see <code>\u0643\u062a\u0627\u0628</code> in cell B1.\nif you want to use this function as add-in see <a href=\"http://www.fontstuff.com/vba/vbatut03.htm\" rel=\"nofollow\">this link</a></p>\n"}], "owner": {"reputation": 127, "user_id": 5703564, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/315cdd980f17de8c45198f6871297bc0?s=128&d=identicon&r=PG&f=1", "display_name": "Deve", "link": "https://stackoverflow.com/users/5703564/deve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5998, "favorite_count": 0, "accepted_answer_id": 34776356, "answer_count": 2, "score": 1, "last_activity_date": 1483947701, "creation_date": 1452715863, "last_edit_date": 1531161705, "question_id": 34776110, "link": "https://stackoverflow.com/questions/34776110/excel-function-to-convert-english-names-to-arabic", "title": "Excel Function To Convert English Names To Arabic", "body": "<p>I am trying to add a VBA function to my excel sheet were I can translate or convert the names to arabic to stop them in my database. I added the developer tab and open editor and I added the following function but it is not working...Any help please</p>\n\n<pre><code>Function Translate_To_Arabic(str) As String\n' Tools Refrence Select Microsoft internet Control\n\n\n    Dim IE As Object, i As Long\n    Dim inputstring As String, outputstring As String, text_to_convert As String, result_data As String, CLEAN_DATA\n\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    '   TO CHOOSE INPUT LANGUAGE\n\n    inputstring = \"auto\"\n\n    '   TO CHOOSE OUTPUT LANGUAGE\n\n    outputstring = \"ar\"\n\n    text_to_convert = str\n\n    'open website\n\n    IE.Visible = False\n    IE.navigate \"http://translate.google.com/#\" &amp; inputstring &amp; \"/\" &amp; outputstring &amp; \"/\" &amp; text_to_convert\n\n    Do Until IE.ReadyState = 4\n        DoEvents\n    Loop\n\n    Application.Wait (Now + TimeValue(\"0:00:5\"))\n\n    Do Until IE.ReadyState = 4\n        DoEvents\n    Loop\n\n    CLEAN_DATA = Split(Application.WorksheetFunction.Substitute(IE.Document.getElementById(\"result_box\").innerHTML, \"&lt;/SPAN&gt;\", \"\"), \"&lt;\")\n\n    For j = LBound(CLEAN_DATA) To UBound(CLEAN_DATA)\n        result_data = result_data &amp; Right(CLEAN_DATA(j), Len(CLEAN_DATA(j)) - InStr(CLEAN_DATA(j), \"&gt;\"))\n    Next\n\n\n    IE.Quit\n    transalte_using_vba = result_data\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452714482, "post_id": 34775475, "comment_id": 57296629, "body": "Do you mean add a control, say a listbox, to a search form, which is populated with the options available in multi value?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452714602, "post_id": 34775475, "comment_id": 57296708, "body": "Does this help? <a href=\"https://support.office.com/en-us/article/Using-multivalued-fields-in-queries-6f64f92d-659f-411c-9503-b6624e1e323a\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452716972, "post_id": 34775475, "comment_id": 57298039, "body": "TblFlower.color.value you&#39;ll need to use I believe"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5678702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e27fe012862c17c109a7a6d297f0eee?s=128&d=identicon&r=PG&f=1", "display_name": "John Snow", "link": "https://stackoverflow.com/users/5678702/john-snow"}, "edited": false, "score": 0, "creation_date": 1453144319, "post_id": 34805787, "comment_id": 57463792, "body": "Its actually a combobox not a listbox. It is essentially a multiple select combo box: for example i have a tblFlower and a tblColor. tblColor has a list of the different colors red blue... tblFlower has a field called color and i linked that field to the tblcolor it created a dropdown and in the loup options i said Allow multiple selection"}, {"owner": {"reputation": 327, "user_id": 4510359, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcrE5.jpg?s=128&g=1", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/4510359/guillaume"}, "reply_to_user": {"reputation": 11, "user_id": 5678702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e27fe012862c17c109a7a6d297f0eee?s=128&d=identicon&r=PG&f=1", "display_name": "John Snow", "link": "https://stackoverflow.com/users/5678702/john-snow"}, "edited": false, "score": 0, "creation_date": 1453169882, "post_id": 34805787, "comment_id": 57474117, "body": "I&#39;ve never used this feature before. I edited my answer with a piece of code for dealing with multi select combo boxes."}, {"owner": {"reputation": 11, "user_id": 5678702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e27fe012862c17c109a7a6d297f0eee?s=128&d=identicon&r=PG&f=1", "display_name": "John Snow", "link": "https://stackoverflow.com/users/5678702/john-snow"}, "edited": false, "score": 1, "creation_date": 1453216850, "post_id": 34805787, "comment_id": 57498865, "body": "seems to not be working i don&#39;t know what i am doing wrong this is the type of field i have <a href=\"https://support.office.com/en-us/article/Guide-to-multivalued-fields-7c2fd644-3771-48e4-b6dc-6de9bebbec31?CorrelationId=864bb826-b28b-40fb-8b74-2e45d38d40fd&amp;ui=en-US&amp;rs=en-US&amp;ad=US#BM7\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a> the problem is i dont know how to get access or reference these fields in an if statments. I also posted a previous question on mandatory fields but stilll no solution. These Multi valued fields are really giving me a hard time."}], "tags": [], "owner": {"reputation": 327, "user_id": 4510359, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kcrE5.jpg?s=128&g=1", "display_name": "Guillaume", "link": "https://stackoverflow.com/users/4510359/guillaume"}, "is_accepted": false, "score": 0, "last_activity_date": 1453169782, "last_edit_date": 1453169782, "creation_date": 1452841256, "answer_id": 34805787, "question_id": 34775475, "link": "https://stackoverflow.com/questions/34775475/multi-value-fields-search-filter-access/34805787#34805787", "title": "Multi-Value Fields - Search Filter access", "body": "<p>If I understand well, you're talking about a listbox, not a combobox.</p>\n\n<p>You need to iterate through selected items and add them to your where clause:</p>\n\n<pre><code>Dim ctl     As ListBox\nDim varItem As Variant\n\nSet ctl = Me.Color\n\nIf ctl.ItemsSelected.Count &gt;= 1 Then\n    'write begining of strWhere clause\n    strWhere = strWhere &amp; \" AND tblFlower.Color IN(\"\n\n    'iterate throught selected items to add them to the list)\n    For Each varItem In ctl.ItemsSelected\n        strWhere = strWhere &amp; \"'\" &amp; ctl.ItemData(varItem) &amp; \"',\"\n    Next varItem\n\n    'remove last comma and close parentheses\n    strWhere = Left(strWhere, Len(strWhere) - 1)\n    strWhere = strWhere &amp; \")\"\nEnd If\n</code></pre>\n\n<p>this should add \" AND tblFlower.Color IN('red','yellow')\" to your strWhere string if you selected those 2 colors.</p>\n\n<p>EDIT: for multiselect combobox</p>\n\n<p>The value of the combobox is stored in an array. You need to iterate through this array:</p>\n\n<pre><code>Dim strWhere    As String\nDim i           As Integer\n\n'first control if values have been selected\n'then loop through array\nIf IsArray(Me.Color.Value) Then\n\n    'write begining of strWhere clause\n    strWhere = strWhere &amp; \" AND tblFlower.Color IN(\"\n\n    For i = 0 To UBound(Me.Color.Value)\n        strWhere = strWhere &amp; \"'\" &amp; Me.Color.Value(i) &amp; \"',\"\n    Next i\n\n    'remove last comma and close parentheses\n    strWhere = Left(strWhere, Len(strWhere) - 1) &amp; \")\"\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5678702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e27fe012862c17c109a7a6d297f0eee?s=128&d=identicon&r=PG&f=1", "display_name": "John Snow", "link": "https://stackoverflow.com/users/5678702/john-snow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1004, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1453169782, "creation_date": 1452713624, "question_id": 34775475, "link": "https://stackoverflow.com/questions/34775475/multi-value-fields-search-filter-access", "title": "Multi-Value Fields - Search Filter access", "body": "<p>After extensive research i have yet to find the an answer to my problem. I am having a hard time with \"Multi-Value\" combobox field. I would like to be able to add this multi value combo box into my search form. But my code seems to not be working. My research tells me that the data of multivalue fields are stored somewhere else. Here is my code i hope i can get steered into the right direction.</p>\n\n<p>For example the Color field is Multi-value dropdown :Red, blue, yellow\nYou can select more than one option so this field is different from my other fields. This code works perfect for all of my other fields. Please let me know what you think. Thanks </p>\n\n<pre><code>If Nz(Me.Color) &lt;&gt; \"\" Then\nstrWhere = strWhere &amp; \" AND \" &amp; \"tblFlower.Color = '\" &amp; Me.Color &amp; \"'\"\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5539749, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh3.googleusercontent.com/-pM4r4eFw5wM/AAAAAAAAAAI/AAAAAAAACVc/lJkoq1jexUs/photo.jpg?sz=128", "display_name": "Charlie", "link": "https://stackoverflow.com/users/5539749/charlie"}, "edited": false, "score": 1, "creation_date": 1452718134, "post_id": 34775564, "comment_id": 57298696, "body": "Pretty Clever solution! Simple, faster and way more clear. I use a lot the &amp; &quot;&quot;&amp; syntax when loading/opening files but didn&#39;t think about it now... :S I really appreciate your help! it has solved my problem and fit perfectly with what I intended to do with the code :D"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1452713920, "creation_date": 1452713920, "answer_id": 34775564, "question_id": 34775416, "link": "https://stackoverflow.com/questions/34775416/excel-vba-worksheet-function-with-dynamic-worksheet-reference/34775564#34775564", "title": "Excel VBA Worksheet.Function with Dynamic Worksheet Reference", "body": "<p>Use the <code>Range.Find</code> method to search if the country exists, instead of <code>vlookup</code> (the way you have it written will not work, anyway). Also, see how I included the variable in the formula inside the <code>If</code> block.</p>\n\n<pre><code>Dim rngC as Range\nSet rngC = rngTable.Find(What:=s,lookat:=xlWhole)\n\nIf rngC Is Nothing Then\n\n    wsInsTL.Cells(lrowTable + 1, 3).Value = s \n    wsInsTL.Cells(lrowTable + 1, 4).Formula = \"=Counta(\" &amp; s &amp; \"!A:A) - 1\"\n    wsInsTL.Cells(lrowTable + 1, 7).Formula = \"=Countif(\" &amp; s &amp; \"!$H:$H,Vlookup(G$5,OTHER!$N$1:$O$10,2,false))\"\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5539749, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh3.googleusercontent.com/-pM4r4eFw5wM/AAAAAAAAAAI/AAAAAAAACVc/lJkoq1jexUs/photo.jpg?sz=128", "display_name": "Charlie", "link": "https://stackoverflow.com/users/5539749/charlie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 0, "accepted_answer_id": 34775564, "answer_count": 1, "score": 2, "last_activity_date": 1452713920, "creation_date": 1452713420, "last_edit_date": 1452713529, "question_id": 34775416, "link": "https://stackoverflow.com/questions/34775416/excel-vba-worksheet-function-with-dynamic-worksheet-reference", "title": "Excel VBA Worksheet.Function with Dynamic Worksheet Reference", "body": "<p>I have an Excel file (wbTL) with the Main WS(INSTRUCTIONS) for analysis and many other WS with data for each Country (that will be analyse in the Main Sheet)\nMain sheet has a Table with all the Countries and displays critical information for each country using Functions with References to the Country Sheet in question.</p>\n\n<p>The information in the Countries WS is sent from Other Excel (wb).</p>\n\n<p>My Problem :</p>\n\n<p>Let's say there is a new country. \nUser will report the Information from (wb) and in the (wbTL) a new Worksheet will be created with a specific name.</p>\n\n<p>Now I want to update the Table with the new Country Name and the functions should make reference to the new Worksheet Generate.</p>\n\n<pre><code>Sub Test()\n\nDim wb As Workbook, wbTL As Workbook\nDim wsRep As Worksheet, wsIns As Worksheet, wsInsTL As Worksheet\nDim lrowTable As Long, lcolTable As Long\nDim rngTLPath As Range\nDim CountryInList As Single\nDim s As String, j As String\nDim rngTable As Range\n\nSet wb = ThisWorkbook\nSet wsIns = wb.Worksheets(\"INSTRUCTIONS\")\nSet rngTLPath = wsIns.Range(\"TLPATH\")\nSet wbTL = Workbooks.Open(rngTLPath)\nSet wsRep = wb.Worksheets(\"REPORT\")\nSet wsInsTL = wbTL.Worksheets(\"INSTRUCTIONS\")\n\nlrowTable = wbTL.Worksheets(\"INSTRUCTIONS\").Cells(Rows.Count, 3).End(xlUp).Row\nlcolTable = wbTL.Worksheets(\"INSTRUCTIONS\").Cells(6, Columns.Count).End(xlToLeft).Column\n\nSet rngTable = wsInsTL.Range(Cells(5, 3), Cells(lrowTable, lcolTable))\n'What I pretend is to storage the variable S as string with the Worksheet for the country.\ns = wsIns.Range(\"A1\") 'I make a reference to a cell, lets say it says DENMARK\n</code></pre>\n\n<p>'Here I still working it out. I want the code to check if the country is already in the table.\n'If the country is missing then Add a New Line with the Country/Functions.</p>\n\n<pre><code>On Error Resume Next\nCountryInList = Application.WorksheetFunction.VLookup(s, rngTable, 1, False)\nOn Error GoTo 0\n\nIf CountryInList = 0 Then\n    wsInsTL.Cells(lrowTable + 1, 3).Value = s 'This does not work, leaves cell as Empty\n</code></pre>\n\n<p>'Here is my Main Issue :\n'What I want to do get is Reference to the new WS generated according to the country Name\n'What I was expecting is it to take \"s\" as string and generate :\n=COUNTA('DENMARK'!A:A) - 1</p>\n\n<pre><code>    wsInsTL.Cells(lrowTable + 1, 4).Formula = \"=Counta('s'!A:A) - 1\"\n    wsInsTL.Cells(lrowTable + 1, 7).Formula = \"=Countif('s'!$H:$H,Vlookup(G$5,OTHER!$N$1:$O$10,2,false))\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I have tried (adding \"s\" or double \"\"s\"\", deleting '', creating the variable string with \"\" or '' and ''\"\")</p>\n\n<p>Is it possible to do it? or is there any workaround?</p>\n\n<p>Many thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "batch-file"], "comments": [{"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1452714690, "post_id": 34775356, "comment_id": 57296757, "body": "I guess the <i>space</i> in <code>C:\\New folder\\new.bat</code> makes trouble; try the same with a folder that does not include any spaces..."}, {"owner": {"reputation": 49, "user_id": 1854735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7976f623cbea08041c73b275147156?s=128&d=identicon&r=PG", "display_name": "jdbodine", "link": "https://stackoverflow.com/users/1854735/jdbodine"}, "reply_to_user": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1452720370, "post_id": 34775356, "comment_id": 57299767, "body": "Space in New folder is not an issue. I can run it as you have it typed, but not when trying to add info from the cells (i.e. new.bat 2015 folder 001). Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1452714773, "last_edit_date": 1452714773, "creation_date": 1452714049, "answer_id": 34775613, "question_id": 34775356, "link": "https://stackoverflow.com/questions/34775356/open-folder-from-cell-in-excel-create-folder-if-it-does-not-exist/34775613#34775613", "title": "Open Folder from Cell in Excel, Create Folder if it Does Not Exist", "body": "<p>I'm not sure what is in your cells. But you can <strong>build a path</strong> from the values like this.</p>\n\n<pre><code>Dim ws As Excel.Worksheet\nSet ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\nDim szPath as string\nszPath = ws.Range(\"B1\").Value &amp; \"\\\" &amp; ws.Range(\"C1\").Value\n</code></pre>\n\n<p><strong>Open a folder</strong><br>\nTo open a folder you can use shellexecute. Declare this at the top of all you code. Above all subs and functions.</p>\n\n<pre><code>Private Declare Function ShellExecute Lib \"Shell32.dll\" Alias \"ShellExecuteA\" _\n  (ByVal hwnd As Long, _\n   ByVal lpOperation As String, _\n   ByVal lpFile As String, _\n   ByVal lpParameters As String, _\n   ByVal lpDirectory As String, _\n   ByVal nShowCmd As Long) As Long\n</code></pre>\n\n<p>Then you can send it a path</p>\n\n<pre><code>    ShellExecute 0, \"open\", \"C:\\Temp\", 0, 0, 1\n    'or send it the value build from the cells\n    ShellExecute 0, \"open\", szPath , 0, 0, 1\n</code></pre>\n\n<p>You can also open files this way</p>\n\n<p><strong>Create files</strong><br>\nIf you want to create files it can be done like this.</p>\n\n<pre><code>Dim fs As FileSystemObject\nSet fs = New FileSystemObject\n\n'Create a text file\nSet ts = fs.CreateTextFile(\"C:\\Temp\\test.txt\", True, False)\n'or using the path from the cells\nSet ts = fs.CreateTextFile(szPath &amp; \"\\text.txt\", True, False)\n</code></pre>\n\n<p><strong>Create folders</strong><br>\nAnd lastly you can create folders.</p>\n\n<pre><code>fs.CreateFolder (\"C:\\Temp\\SomeNewDir\")\n'or using the path from the cells\nfs.CreateFolder (szPath &amp; \"\\SomeNewDir\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2788, "user_id": 4139024, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/qOcL9.jpg?s=128&g=1", "display_name": "blckbird", "link": "https://stackoverflow.com/users/4139024/blckbird"}, "is_accepted": false, "score": 0, "last_activity_date": 1452714433, "creation_date": 1452714433, "answer_id": 34775714, "question_id": 34775356, "link": "https://stackoverflow.com/questions/34775356/open-folder-from-cell-in-excel-create-folder-if-it-does-not-exist/34775714#34775714", "title": "Open Folder from Cell in Excel, Create Folder if it Does Not Exist", "body": "<p>Best way to approach this is probably with VBA and without shell script. \nAssuming your three cells are A1, A2 and A3. You can add a button to you sheet and assign a macro like this:</p>\n\n<pre><code>Sub btn1_click()\nDim dir as String\nDim fso As Object\ndir = Range(\"A1\").Value &amp; \"\\\" &amp; Range(\"A2\").Value &amp; Range(\"A3\").Value\nSet fso = CreateObject(\"scripting.filesystemobject\")\nIf Not fso.folderexists(dir) Then\n    fso.createfolder (dir)\nEnd If\n    Call Shell(\"explorer.exe\" &amp; \" \" &amp; dir, vbNormalFocus)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 1854735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e7976f623cbea08041c73b275147156?s=128&d=identicon&r=PG", "display_name": "jdbodine", "link": "https://stackoverflow.com/users/1854735/jdbodine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2269, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1452725430, "creation_date": 1452713169, "last_edit_date": 1452725430, "question_id": 34775356, "link": "https://stackoverflow.com/questions/34775356/open-folder-from-cell-in-excel-create-folder-if-it-does-not-exist", "title": "Open Folder from Cell in Excel, Create Folder if it Does Not Exist", "body": "<p>I am trying to create a cell in my spreadsheet that will do a few things:</p>\n\n<ol>\n<li>Open a folder based on values from two cells in a row</li>\n<li>Create the folder from above two cells if it does not exist</li>\n<li>Only work when I click on it for that row</li>\n</ol>\n\n<p>Currently, I am using the Hyperlink formula to link to the folder that I manually create. I had the bright idea of linking to a batch file that opens/creates the folder from parsed data. I tried that for a good while, but have not been able to get the data from excel to the batch file.</p>\n\n<p>Anyway to do this? Either in the way I described or with VBA?</p>\n\n<p>My actual spread sheet has many more columns and rows, but hopefully the image below illustrates how I would like the link to the folder laid out.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Usvu7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Usvu7.png\" alt=\"enter image description here\"></a></p>\n\n<p>Basically, I want to click \"Open\" in that row and it take the data from B2 and C2 and open/create a folder in C:\\New Folder\\B2\\C2 (ex. C:\\New Folder\\2015\\Folder 0001).</p>\n\n<p>Below is the hyperlink formula I am using in Excel currently to try and accomplish this:</p>\n\n<pre><code>=HYPERLINK(\"C:\\New folder\\new.bat \"&amp;B2&amp;\" \"&amp;C2,\"Open\")\n</code></pre>\n\n<p>I get an \"Cannot open the specified file\" error. If I remove the cell data, it will open the program, but without the data, I have no way to create the necessary folders.</p>\n\n<p>Below is the batch file I wrote to open/create the folder:</p>\n\n<pre><code>@echo off\n\nset dir=\"C:\\New folder\\%1\\%2\"\n\nif not exist %dir% mkdir %dir%\n\nstart \"\" %dir%\n</code></pre>\n\n<p>This works fine on it's own when run from the command line with the following:</p>\n\n<pre><code>new.bat 2015 Folder 0001\n</code></pre>\n\n<p>Any direction or help will be greatly appreciated. Thank in advance.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452714801, "post_id": 34775305, "comment_id": 57296820, "body": "Use the help on collections, but I&#39;d use a scripting dictionary with the key as the date and the value as the rate. Google scripting.dictionary vba"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1452717425, "post_id": 34775305, "comment_id": 57298297, "body": "You can easily use Collections.  Two approaches:  Store each date/rate pair in a variant array, and add the array to the collection;  or create a user defined object (Class), and add the object to the Collection.  I find the latter easier to debug and maintain, but you can start with the array approach."}, {"owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "edited": false, "score": 0, "creation_date": 1452718389, "post_id": 34775305, "comment_id": 57298833, "body": "Thanks for replying. For the array approach, I can create a new variable and dimension it as Variant and set it equal to the date/rate pair, then add it to the collection. I can put this within the loop so that it does it for each I. Is this what you mean or am I misunderstanding?"}], "answers": [{"tags": [], "owner": {"reputation": 321, "user_id": 4681802, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d9c5fa76217ee830a60e2a639b909917?s=128&d=identicon&r=PG&f=1", "display_name": "NLMDEJ", "link": "https://stackoverflow.com/users/4681802/nlmdej"}, "is_accepted": false, "score": 1, "last_activity_date": 1466689212, "creation_date": 1466689212, "answer_id": 37993355, "question_id": 34775305, "link": "https://stackoverflow.com/questions/34775305/using-collections-in-access-vba/37993355#37993355", "title": "Using Collections in Access VBA", "body": "<p>I agree with comments that a data dictionary is probably the way to go. The reason is that with a dictionary you can actually loop through the keys if needed. You will need to add a reference to the Microsoft Scripting Runtime. Here is a brief example:</p>\n\n<pre><code>Public Function a()\n\n    Dim dRates As New Scripting.Dictionary\n    Dim key As Variant\n\n    dRates.Add #1/1/2016#, 1\n    dRates.Add #2/1/2016#, 1.5\n    dRates.Add #3/1/2016#, 2\n\n    'You can either access the rate directly with the key:\n    Debug.Print dRates(#2/1/2016#)\n\n    'Or you can loop through the keys/values\n    For Each key in dRates.Keys\n        Debug.Print key &amp; \" - \" &amp; dRates(key)\n    Next\n\n    'Or, you can pass the entire collection to a function\n     Call b(dRates)\n\nEnd Function\n\nPublic Function b(d As Scripting.Dictionary)\n\n    For Each key In d.Keys\n        Debug.Print key &amp; \" - \" &amp; d(key)\n    Next\n\nEnd Function\n</code></pre>\n\n<p>This will provide the following output:</p>\n\n<pre><code>1.5\n1/1/2016 - 1\n2/1/2016 - 1.5\n3/1/2016 - 2\n1/1/2016 - 1\n2/1/2016 - 1.5\n3/1/2016 - 2\n</code></pre>\n"}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466689212, "creation_date": 1452712997, "question_id": 34775305, "link": "https://stackoverflow.com/questions/34775305/using-collections-in-access-vba", "title": "Using Collections in Access VBA", "body": "<p>I have this following subroutine In Access VBA:</p>\n\n<pre><code>   Sub SampleReadCurve()\n\nDim rs As Recordset\nDim iRow As Long, iField As Long\nDim strSQL As String\nDim CurveID As Long\nDim MarkRunID As Long\nDim MaxOfMarkAsofDate As Date\nDim userdate As String\n\nCurveID = 15\n\nDim I As Integer\nDim x As Date\n\nuserdate = InputBox(\"Please Enter the Date (mm/dd/yyyy)\")\n\nx = userdate\n\nFor I = 0 To 150\n\nMaxOfMarkAsofDate = x - I\n\n\nstrSQL = \"SELECT * FROM VolatilityOutput WHERE CurveID=\" &amp; CurveID &amp; \" AND MaxOfMarkAsofDate=#\" &amp; MaxOfMarkAsofDate &amp; \"# ORDER BY MaxOfMarkasOfDate, MaturityDate\"\n\nSet rs = CurrentDb.OpenRecordset(strSQL, Type:=dbOpenDynaset, Options:=dbSeeChanges)\nIf rs.RecordCount &lt;&gt; 0 Then\n\n    rs.MoveFirst\n\n    rs.MoveLast\n\n    Dim BucketTermAmt As Long\n    Dim BucketTermUnit As String\n    Dim BucketDate As Date\n    Dim MarkAsOfDate As Date\n    Dim InterpRate As Double\n\n    BucketTermAmt = 3\n    BucketTermUnit = \"m\"\n    BucketDate = DateAdd(BucketTermUnit, BucketTermAmt, MaxOfMarkAsofDate)\n    InterpRate = CurveInterpolateRecordset(rs, BucketDate)\n    Debug.Print BucketDate, InterpRate\n\nEnd If\n\nNext I\n\n\nEnd Function\n</code></pre>\n\n<p>This subroutine put outs a 2x2 list of 76 numbers, consisting of a date and an associated rate. I want to store this list of values as a Collection, so that I can use it as an input in another function. Is it possible to use collections to do this? What would be the appropriate syntax?</p>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1452712981, "post_id": 34775114, "comment_id": 57295693, "body": "When you say on load, is it when the workbook is opening? Or is it a form load?"}, {"owner": {"reputation": 351, "user_id": 4713570, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10200260470471523/picture?type=large", "display_name": "ImNotLeet", "link": "https://stackoverflow.com/users/4713570/imnotleet"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1452713037, "post_id": 34775114, "comment_id": 57295716, "body": "@MatthewD Workbook opening only, the above code works if you ignore the error or click past it. The code basically pulls a named range from another sheet and if/when a user clicks a line item it populates a textbox with additional details."}], "answers": [{"comments": [{"owner": {"reputation": 351, "user_id": 4713570, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10200260470471523/picture?type=large", "display_name": "ImNotLeet", "link": "https://stackoverflow.com/users/4713570/imnotleet"}, "edited": false, "score": 0, "creation_date": 1452713379, "post_id": 34775349, "comment_id": 57295925, "body": "Thank you! One follow-on does it matter where I declare the global variable?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 351, "user_id": 4713570, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10200260470471523/picture?type=large", "display_name": "ImNotLeet", "link": "https://stackoverflow.com/users/4713570/imnotleet"}, "edited": false, "score": 0, "creation_date": 1452713414, "post_id": 34775349, "comment_id": 57295949, "body": "Yes, they have to be declared at the top of the code. Above any other subs or functions."}, {"owner": {"reputation": 351, "user_id": 4713570, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10200260470471523/picture?type=large", "display_name": "ImNotLeet", "link": "https://stackoverflow.com/users/4713570/imnotleet"}, "edited": false, "score": 0, "creation_date": 1452713521, "post_id": 34775349, "comment_id": 57296034, "body": "Ty sir for the assistance, easy solution to a huge headache."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1452713152, "creation_date": 1452713152, "answer_id": 34775349, "question_id": 34775114, "link": "https://stackoverflow.com/questions/34775114/excel-vba-compile-error-listbox/34775349#34775349", "title": "Excel VBA Compile error Listbox", "body": "<p>It is probably due to the loading of the values into the list.  Try something like this.</p>\n\n<p>Create a global boolean variable</p>\n\n<pre><code>Private bDoneLoading as Boolean\n</code></pre>\n\n<p>Set it to true in the workbook open function after anything else you may have i this function</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    'Any other code\n\n    bDoneLoading = True\nEnd Sub\n</code></pre>\n\n<p>Add a check to make sure the workbook has loaded.</p>\n\n<pre><code>Private Sub ListBox1_Click()\n\n    If bDoneLoading = false Then\n        Exit sub\n    End If\n\n    Sheet2.TextBox1.Value = \" \"\n    Dim i As Long\n    i = Sheet2.ListBox1.ListIndex\n    If i &lt; -1 Then Exit Sub\n    Sheet2.TextBox1.Value = Sheet1.Range(\"C\" &amp; (i + 4))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 4713570, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10200260470471523/picture?type=large", "display_name": "ImNotLeet", "link": "https://stackoverflow.com/users/4713570/imnotleet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 34775349, "answer_count": 1, "score": 1, "last_activity_date": 1452713152, "creation_date": 1452712331, "question_id": 34775114, "link": "https://stackoverflow.com/questions/34775114/excel-vba-compile-error-listbox", "title": "Excel VBA Compile error Listbox", "body": "<p>I'm nearing completion on a custom excel workbook. I'm having a irritating issue where the below code works but gives a compile error on load. I've tried searching for the solution but being so new to VBA I'm not even sure what could be causing the issue. It highlights listbox1 but I have listbox1 in the sheet noted.</p>\n\n<p>(Compile Error \"Method or Data member not found\")   </p>\n\n<pre><code>Private Sub ListBox1_Click()\nSheet2.TextBox1.Value = \" \"\nDim i As Long\ni = Sheet2.ListBox1.ListIndex\nIf i &lt; -1 Then Exit Sub\nSheet2.TextBox1.Value = Sheet1.Range(\"C\" &amp; (i + 4))\nEnd Sub\n</code></pre>\n\n<p>Thank You</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452712187, "post_id": 34774931, "comment_id": 57295202, "body": "the issue is this <code>End(x1Down)</code>.  The <code>1</code> should be a lowercase <code>L</code>, <code>End(xlDown)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5786089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab210fede2145882f79fdfb686ce87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Senstrek", "link": "https://stackoverflow.com/users/5786089/senstrek"}, "edited": false, "score": 0, "creation_date": 1452713311, "post_id": 34775249, "comment_id": 57295866, "body": "thank you for the quick response - works perfectly now.  The simpler code and link is also very much appreciated!!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5786089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab210fede2145882f79fdfb686ce87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Senstrek", "link": "https://stackoverflow.com/users/5786089/senstrek"}, "edited": false, "score": 0, "creation_date": 1452998543, "post_id": 34775249, "comment_id": 57410468, "body": "@Senstrek if this was the correct answer please consider marking as correct by clicking the green check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1452712821, "last_edit_date": 1495540322, "creation_date": 1452712821, "answer_id": 34775249, "question_id": 34774931, "link": "https://stackoverflow.com/questions/34774931/excel-transfer-data-from-one-sheet-to-next-empty-row-on-another-sheet-error/34775249#34775249", "title": "Excel: transfer data from one sheet to next empty row on another sheet error", "body": "<p>Also in Addition to the comment above, the code can be simplfied greatly:</p>\n\n<pre><code>Sub hhhhh()\nDim ows as Worksheet\nDim tws As Worksheet\nDim rw as long\n\nSet ows = Worksheets(\"Summary Document\")\nSet tws = Worksheets(\"Worker 1\")\n\nIf tws.Range(\"B10\") &lt;&gt; \"\" Then\n    rw = 10\nElse\n    rw = tws.Range(\"B9\").End(xlDown).Row + 1\nEnd If\n\ntws.Range(\"B\" &amp; rw &amp; \":G\" &amp; rw).Value = ows.Range(\"C4:H4\").Value\ntws.Range(\"I\" &amp; rw &amp; \":N\" &amp; rw).Value = ows.Range(\"J4:O4\").Value\n\n\nEnd Sub\n</code></pre>\n\n<p>One should always avoid using the <code>.Select</code> when possible.  See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">This Link</a> for great options.</p>\n"}], "owner": {"reputation": 3, "user_id": 5786089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab210fede2145882f79fdfb686ce87e3?s=128&d=identicon&r=PG&f=1", "display_name": "Senstrek", "link": "https://stackoverflow.com/users/5786089/senstrek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 34775249, "answer_count": 1, "score": 0, "last_activity_date": 1452712821, "creation_date": 1452711701, "last_edit_date": 1531161705, "question_id": 34774931, "link": "https://stackoverflow.com/questions/34774931/excel-transfer-data-from-one-sheet-to-next-empty-row-on-another-sheet-error", "title": "Excel: transfer data from one sheet to next empty row on another sheet error", "body": "<p>I'm trying to copy cells (strings) from one sheet ('Summary Document' all on row 4) to a table in the second sheet ('Worker 1', starting at B10).  I believe I have defined all elements correctly.  When I run the first time, it works.  however, it gives me a 1004 error on the second run.  I'm pretty sure it is my if/then statement that looks for the next empty line, but not sure what the issue is.</p>\n\n<pre><code>Dim FileName As String, FileNumber As String, RecordingPeriod As String, RecordingType As String, Auditor As String, ReviewDate As String`\nDim A1 As String, A2 As String, A3 As String, A4 As String, A5 As String, A6 As String\nWorksheets(\"Summary Document\").Select\nFileName = Range(\"C4\")\nFileNumber = Range(\"D4\")\nRecordingPeriod = Range(\"E4\")\nRecordingType = Range(\"F4\")\nAuditor = Range(\"G4\")\nReviewDate = Range(\"H4\")\nA1 = Range(\"J4\")\nA2 = Range(\"K4\")\nA3 = Range(\"L4\")\nA4 = Range(\"M4\")\nA5 = Range(\"N4\")\nA6 = Range(\"O4\")\nWorksheets(\"Worker 1\").Select\nWorksheets(\"Worker 1\").Range(\"B9\").Select\nIf Worksheets(\"Worker 1\").Range(\"B9\").Offset(1, 0) &lt;&gt; \"\" Then\nWorksheets(\"Worker 1\").Range(\"B9\").End(x1Down).Select\nEnd If\nActiveCell.Offset(1, 0).Select\nActiveCell.Value = FileName\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = FileNumber\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = RecordingPeriod\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = RecordingType\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = Auditor\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = ReviewDate\nActiveCell.Offset(0, 2).Select\nActiveCell.Value = A1\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = A2\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = A3\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = A4\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = A5\nActiveCell.Offset(0, 1).Select\nActiveCell.Value = A6\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1452711310, "post_id": 34774782, "comment_id": 57294702, "body": "<code>BigList(i)(j)</code> would be item <code>j</code> of array <code>i</code>. Also -- if you want dynamic arrays -- just use variants rather than variants()"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1452711341, "post_id": 34774782, "comment_id": 57294725, "body": "What determines N? You are implying that you don&#39;t know what N will be until you get there, but perhaps you could do an initial loop to check the size of the first dimension, and then knowing that, redim to the appropriate size?"}, {"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1452711627, "post_id": 34774782, "comment_id": 57294880, "body": "Thanks Grade &#39;Eh&#39; Bacon. I meant &quot;I wouldn&#39;t know what N will be&quot;. So, in advance, I don&#39;t know either the number of lists or the length of each list. &quot;listNum&quot; and &quot;listLength&quot; are external variables for me to take in. But there are subs in which I need to work on each list individually. Hence, the need to call &quot;BigList(1)&quot;, &quot;BigList(2)&quot;."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1452711745, "post_id": 34774782, "comment_id": 57294931, "body": "You want <code>BigList</code> as an array of one-dimensional arrays? Or as an array of Multi-dimensional arrays?"}, {"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1452711756, "post_id": 34774782, "comment_id": 57294940, "body": "Thanks, John Coleman. But how do I pass each individual list as an argument into a sub. As you pointed out, I have to access BigList elements by providing two indices &quot;i&quot; and &quot;j&quot;. Is it possible to access the 2-dimensional array with just the front index &quot;i&quot;?"}, {"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1452711875, "post_id": 34774782, "comment_id": 57295026, "body": "Hi David Zemens. I would like BigList to be 2-dimensional array. The first index &quot;listNum&quot; corresponds to the &quot;N&quot;. The second index &quot;listLength&quot; is the size of each list, such as list1(), list2()...Neither of the indices is known to me."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1452711957, "post_id": 34774782, "comment_id": 57295075, "body": "the second index is the <i>size</i>? Or do you actually want the <code>list1()</code> and <code>list2()</code> contained <i>within</i> <code>BigList</code>?  It is not very clear what you&#39;re attempting to do here. Are you just creating <code>BigList</code> to capture the number and size of the other array/lists?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1452712012, "post_id": 34774782, "comment_id": 57295104, "body": "This seems like a good time to use collections or dictionary, if your <code>listNum</code> is unique."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1452712793, "post_id": 34775178, "comment_id": 57295583, "body": "Thank you, David Zemens. This Dictionary thing seems to solve my problem. I will dig more on this."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "edited": false, "score": 0, "creation_date": 1452712890, "post_id": 34775178, "comment_id": 57295637, "body": "Cheers @user5700405 I added a brief note explaining what I think was your original problem, based on your edited Q and code samples."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1452712862, "last_edit_date": 1452712862, "creation_date": 1452712558, "answer_id": 34775178, "question_id": 34774782, "link": "https://stackoverflow.com/questions/34774782/dynamic-array-of-dynamic-arrays/34775178#34775178", "title": "Dynamic Array of dynamic arrays", "body": "<p>Here is one example of creating a <code>Dictionary</code> which is keyed to integer values (i.e., the <code>N</code>) and each value is initially an empty array.</p>\n\n<p>You can then use something like the <code>ExtendList</code> function to resize those empty arrays as needed.</p>\n\n<pre><code>Sub foo()\nDim BigList As Object\nDim N As Long\nDim v as Variant\n\n'Create an empty dictionary object\nSet BigList = CreateObject(\"Scripting.Dictionary\")\n\n'Add N empty array to the dictionary:\nN = 3\nFor i = 1 To N\n    BigList(i) = Array()\nNext\n\n'Resize one of the items in your BigList\nBigList(2) = ExtendList(BigList(2), 1, 10)\n\nv = BigList(2)  'Here you can examine v in the Locals window and see it is an array, of dimensions 1 x 10\nEnd Sub\nFunction ExtendList(lst, a As Long, b As Long)\n\n    ReDim lst(a, b)\n    ExtendList = lst\n\nEnd Function\n</code></pre>\n\n<p>On review of your edited question, I think you merely misunderstood how the <code>ReDim</code> statement works:</p>\n\n<pre><code>Redim BigList(listNum, listLength)\n</code></pre>\n\n<p>This re-dimensions the <code>BigList</code> based on the parameters <code>listNum</code> and <code>listLength</code>. It does <strong>not</strong> (as it seems you may have expected) create a list of arrays <em>within</em> <code>BigList</code>.</p>\n\n<p>I think this might also work (untested, and remember arrays are zero-index):</p>\n\n<pre><code>ReDim Preserve BigList(listNum)\nBigList(listNum) = Array()\nReDim BigList(listNum)(listSize)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5700405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3459314635bff66d65eae495292a58f3?s=128&d=identicon&r=PG&f=1", "display_name": "user5700405", "link": "https://stackoverflow.com/users/5700405/user5700405"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 34775178, "answer_count": 1, "score": 2, "last_activity_date": 1452712862, "creation_date": 1452711120, "last_edit_date": 1452712763, "question_id": 34774782, "link": "https://stackoverflow.com/questions/34774782/dynamic-array-of-dynamic-arrays", "title": "Dynamic Array of dynamic arrays", "body": "<p>I can't seem to find this problem addressed anywhere. </p>\n\n<p>I need to declare a bunch of dynamic arrays as follow:</p>\n\n<pre><code>Dim list1 () as variant\nDim list2() as variant\nDim list3() as variant\n...\nDim listN() as Variant\n</code></pre>\n\n<p>Each list is a one-dimensional dynamic array. However, I wouldn't know what \"N\" will be during the program. I want to make these \"N\" lists dynamic as well. I have tried two-dimensional dynamic arrays. But the \"redim\" statement requires both dimensions to be declared at the same time. In particular, I do this:</p>\n\n<pre><code>Dim BigList() as variant\n...\nRedim BigList(listNum, listLength)\n</code></pre>\n\n<p>To access/pass into a sub \"list1\", \"list2\" , \"list3\"..., calling \"BigList(1)\", \"BigList(2)\" gives me error. In particular, somewhere in my code, there is this portion:</p>\n\n<pre><code>sub ProcessList(byref listToProcess() as variant)\n...\nend sub\n\nsub main()\n...\ncall ProcessList(list1)\ncall ProcessList(list2)\n...\ncall ProcessList(listN)\n\nend sub\n\nNow I can do a loop:\n\nfor i = 1 to N\n    Call ProcessList(list\"i\")\nnext i\n</code></pre>\n\n<p>This requires list\"i\" to be a one-dimensional dynamic array. So, after a redim BigList(listNum,listLength) and I do this:</p>\n\n<pre><code>for i = 1 to N\n    Call ProcessList(BigList(i))    'i refers to listNum\nnext i\n</code></pre>\n\n<p>This gives me error \"Incompatible type\".</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1452710679, "post_id": 34774565, "comment_id": 57294273, "body": "Use Conditional Formatting, no VBA required."}], "answers": [{"tags": [], "owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "is_accepted": false, "score": 0, "last_activity_date": 1452710931, "creation_date": 1452710931, "answer_id": 34774722, "question_id": 34774565, "link": "https://stackoverflow.com/questions/34774565/changing-excel-cell-colors-based-in-values/34774722#34774722", "title": "Changing Excel cell colors based in values", "body": "<p>You can use Conditional Formatting when you edit the contents of the worksheet. If you want to use VBA, and there are good reasons to do so, simply turn on the macro recorder, edit the contents of the worksheet, then look at the macro for the VBA code. Excel will write the code for you: it's a great way to learn VBA and get what you need in an efficient manner.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 2707722, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0e5bbd8229bba5f1d49de3100554f26f?s=128&d=identicon&r=PG&f=1", "display_name": "user2707722", "link": "https://stackoverflow.com/users/2707722/user2707722"}, "edited": false, "score": 0, "creation_date": 1452772920, "post_id": 34774745, "comment_id": 57321474, "body": "Unfortunately this command aren&#39;t working. Cell colors doesn&#39;t change."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1452780260, "last_edit_date": 1452780260, "creation_date": 1452711002, "answer_id": 34774745, "question_id": 34774565, "link": "https://stackoverflow.com/questions/34774565/changing-excel-cell-colors-based-in-values/34774745#34774745", "title": "Changing Excel cell colors based in values", "body": "<p>Use the .Interior.Color property of the range.</p>\n\n<pre><code>Dim ws As Excel.Worksheet\nSet ws = Application.ActiveSheet\n\nIf ws.Range(\"A1\").Value = \"OK\" Then\n    ws.Range(\"A1\").Interior.Color = 5287936\nElseif ws.Range(\"A1\").Value = \"NOTOK\" Then \n    ws.Range(\"A1\").Interior.Color = 255\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 2707722, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/0e5bbd8229bba5f1d49de3100554f26f?s=128&d=identicon&r=PG&f=1", "display_name": "user2707722", "link": "https://stackoverflow.com/users/2707722/user2707722"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1452780260, "creation_date": 1452710453, "question_id": 34774565, "link": "https://stackoverflow.com/questions/34774565/changing-excel-cell-colors-based-in-values", "title": "Changing Excel cell colors based in values", "body": "<p>Can you tell me how change Excel cell colors using VBA ?\nWhen a value is OK -> cell color is green.\nWhen a value is NOTOK -> cell color is red.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5753224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a0716fe25a912ff3657d08c9bf0cd5?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Manville", "link": "https://stackoverflow.com/users/5753224/jeff-manville"}, "edited": false, "score": 0, "creation_date": 1452711212, "post_id": 34774538, "comment_id": 57294636, "body": "When I use that, It returns the cell value and not the cell address"}, {"owner": {"reputation": 47, "user_id": 5753224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a0716fe25a912ff3657d08c9bf0cd5?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Manville", "link": "https://stackoverflow.com/users/5753224/jeff-manville"}, "edited": false, "score": 1, "creation_date": 1452711252, "post_id": 34774538, "comment_id": 57294665, "body": "Wait MsgBox should contain Loc not minLoc"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 47, "user_id": 5753224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a0716fe25a912ff3657d08c9bf0cd5?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Manville", "link": "https://stackoverflow.com/users/5753224/jeff-manville"}, "edited": false, "score": 0, "creation_date": 1452711355, "post_id": 34774538, "comment_id": 57294734, "body": "I made the change to your question and reflected it in the answer."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 3, "last_activity_date": 1452711312, "last_edit_date": 1452711312, "creation_date": 1452710371, "answer_id": 34774538, "question_id": 34774457, "link": "https://stackoverflow.com/questions/34774457/run-time-error-424-when-trying-to-msgbox-cell-reference-address/34774538#34774538", "title": "Run-time error &#39;424&#39; when trying to MsgBox cell reference address", "body": "<p>Change minLoc to a range and set it.  As you have it written, VBA is using it as a string.  The string will have no .Address property.</p>\n\n<pre><code>Sub Test()\n    Dim minLoc As Range\n    Set minLoc = Worksheets(\"Skills\").Range(\"C2\")\n    Dim Loc As String\n    Loc = minLoc.Address(RowAbsolute:=False, ColumnAbsolute:=False)\n    MsgBox (Loc)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5753224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a0716fe25a912ff3657d08c9bf0cd5?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Manville", "link": "https://stackoverflow.com/users/5753224/jeff-manville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 34774538, "answer_count": 1, "score": 1, "last_activity_date": 1455919167, "creation_date": 1452710174, "last_edit_date": 1455919167, "question_id": 34774457, "link": "https://stackoverflow.com/questions/34774457/run-time-error-424-when-trying-to-msgbox-cell-reference-address", "title": "Run-time error &#39;424&#39; when trying to MsgBox cell reference address", "body": "<p>I am trying to return the cell reference address as a string.</p>\n\n<pre><code>1   Sub Test()\n2       minLoc = Worksheets(\"Skills\").Range(\"C2\")\n3       Dim Loc As String\n4       Loc = minLoc.Address(RowAbsolute:=False, ColumnAbsolute:=False)\n5       MsgBox (Loc)\n6   End Sub\n</code></pre>\n\n<p>The error, \"Run-time error '424':,\" occurs at line 4.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452711073, "post_id": 34774431, "comment_id": 57294547, "body": "You could just check <code>If Rows(Cell.Row).EntireRow.Hidden = True Then ...</code>?  Not quite sure what the question is, can you clarify a little?"}, {"owner": {"reputation": 661, "user_id": 5361817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/875202c580fe1ff6be6ac047c6aaf32d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Romano", "link": "https://stackoverflow.com/users/5361817/mark-romano"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1452712734, "post_id": 34774431, "comment_id": 57295545, "body": "So I have values in A1:A5. If any of those values are equal to &quot;-&quot; the VBA code hides the corresponding row. If they are all equal to &quot;-&quot;, I want cell row 6 to unhide. If even one of row 1-5 is NOT hidden (meaning there is a value in A1,A2,A3,A4, or A5 that is not equal to &quot;-&quot;), I want row 6 to be hidden."}], "answers": [{"comments": [{"owner": {"reputation": 661, "user_id": 5361817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/875202c580fe1ff6be6ac047c6aaf32d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Romano", "link": "https://stackoverflow.com/users/5361817/mark-romano"}, "edited": false, "score": 0, "creation_date": 1452722101, "post_id": 34776243, "comment_id": 57300594, "body": "Awesome, Wayne! The only tweak I made was an <code>Else</code> statement for the first <code>If</code> statement with the line <code>Rows(cel.Row).EntireRow.Hidden = False</code>. In my real excel doc, those values A1:A5 change based on the value in a cell in another sheet. Furthermore, this method is triggered only when a change in that cell occurs. This is probably why I had to add the <code>Else</code>. Thanks again!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 661, "user_id": 5361817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/875202c580fe1ff6be6ac047c6aaf32d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Romano", "link": "https://stackoverflow.com/users/5361817/mark-romano"}, "edited": false, "score": 0, "creation_date": 1452722574, "post_id": 34776243, "comment_id": 57300843, "body": "@MarkRomano - So, this macro will run only when the value in A1:A5 changes?  You can make that a <code>Worksheet_Change</code> event to trigger automatically, and not have to guess/know if a cell has changed or not."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 661, "user_id": 5361817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/875202c580fe1ff6be6ac047c6aaf32d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Romano", "link": "https://stackoverflow.com/users/5361817/mark-romano"}, "edited": false, "score": 0, "creation_date": 1452724937, "post_id": 34776243, "comment_id": 57301906, "body": "@MarkRomano - I just updated with an edit, perhaps it is a little quicker with the second method."}, {"owner": {"reputation": 661, "user_id": 5361817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/875202c580fe1ff6be6ac047c6aaf32d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Romano", "link": "https://stackoverflow.com/users/5361817/mark-romano"}, "edited": false, "score": 0, "creation_date": 1452734449, "post_id": 34776243, "comment_id": 57305204, "body": "Thanks Bruce! I&#39;ll try it out later."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1452724904, "last_edit_date": 1452724904, "creation_date": 1452716276, "answer_id": 34776243, "question_id": 34774431, "link": "https://stackoverflow.com/questions/34774431/hide-unhide-a-row-based-on-the-hidden-unhidden-status-of-a-range-of-cells/34776243#34776243", "title": "Hide/Unhide a row based on the hidden/unhidden status of a range of cells", "body": "<p>I think I understand.  How's this:</p>\n\n<pre><code>Sub test()\nDim cel As Range, rng As Range\nDim hideRow&amp;, numDashes&amp;\n\nSet rng = Range(\"A1:A5\")\nhideRow = rng.Count + 1\n\nFor Each cel In rng\n    If cel.Value = \"-\" Then\n        numDashes = numDashes + 1\n        Rows(cel.Row).EntireRow.Hidden = True\n    End If\nNext cel\nIf numDashes = rng.Count Then\n    ' If all cells in the range are '-'\n    Rows(hideRow).EntireRow.Hidden = False\nElse\n    Rows(hideRow).EntireRow.Hidden = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I'm kind of assuming that you want to hide/unhide Row 6, since it's one below your range's last row.  Therefore, I created a variable to hold this.  This way, if you want to change your range to say <code>A1:A100</code>, all you have to do is adjust the <code>rng</code>, and it'll look to hide/unhide row 101.  Of course, if you just need it to be <code>6</code>, then just do <code>hideRow = 6</code>.</p>\n\n<p>Edit: For fun, I tried to reduce the use of the counting variable <code>numDashes</code> and tried to the part where you check your range for all <code>-</code> to be more concise.  The below should work too, but might need a tweak or two:</p>\n\n<pre><code>Sub test2()\nDim cel As Range, rng As Range\nDim hideRow&amp;\n\nSet rng = Range(\"A1:A5\")\nhideRow = rng.Count + 1\n'Check to see if your range is entirely made up of `-`\nIf WorksheetFunction.CountIf(rng, \"-\") = rng.Count Then\n    Rows(hideRow).EntireRow.Hidden = False\n    ' If you want to stop your macro if ALL range values are \"-\", then uncomment the next line:\n    'Exit Sub\nElse\n    Rows(hideRow).EntireRow.Hidden = True\nEnd If\n\nFor Each cel In rng\n    If cel.Value = \"-\" Then\n        Rows(cel.Row).EntireRow.Hidden = True\n    End If\nNext cel\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 86, "user_id": 5749709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8647f5aace4f9e2cfb01a267bf9d1fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Clayton Morris", "link": "https://stackoverflow.com/users/5749709/clayton-morris"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1452796895, "post_id": 34776738, "comment_id": 57337658, "body": "@BruceWayne thanks for editing the post. I&#39;m new to this. How do you get the formula in a scroll? Looks like you didn&#39;t change it."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452797368, "post_id": 34776738, "comment_id": 57337937, "body": "I just highlighted the formula, and clicked the code tags button (<code>{}</code>)."}], "tags": [], "owner": {"reputation": 86, "user_id": 5749709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8647f5aace4f9e2cfb01a267bf9d1fb1?s=128&d=identicon&r=PG&f=1", "display_name": "Clayton Morris", "link": "https://stackoverflow.com/users/5749709/clayton-morris"}, "is_accepted": false, "score": 0, "last_activity_date": 1452722583, "last_edit_date": 1452722583, "creation_date": 1452718129, "answer_id": 34776738, "question_id": 34774431, "link": "https://stackoverflow.com/questions/34774431/hide-unhide-a-row-based-on-the-hidden-unhidden-status-of-a-range-of-cells/34776738#34776738", "title": "Hide/Unhide a row based on the hidden/unhidden status of a range of cells", "body": "<p>You can do this with a formula in a helper column. I used this one for financial statements to suppress rows where multiple column are all zero to shorten up the report.</p>\n\n<pre><code> =IF(AND(SUM(A7:R7)&lt;1,SUM(A7:R7)&gt;-1),IF(OR(ISNUMBER(LEFT(H7,4)),ISBLANK(H7),ISERR(VALUE(LEFT(H7,4)))),\"Show\",\"Hide\"),\"Show\"). \n</code></pre>\n\n<p>Then filter the rows by that column.</p>\n"}], "owner": {"reputation": 661, "user_id": 5361817, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/875202c580fe1ff6be6ac047c6aaf32d?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Romano", "link": "https://stackoverflow.com/users/5361817/mark-romano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 34776243, "answer_count": 2, "score": 0, "last_activity_date": 1452724904, "creation_date": 1452710065, "question_id": 34774431, "link": "https://stackoverflow.com/questions/34774431/hide-unhide-a-row-based-on-the-hidden-unhidden-status-of-a-range-of-cells", "title": "Hide/Unhide a row based on the hidden/unhidden status of a range of cells", "body": "<p>I want to unhide a single row if an ENTIRE range of rows is hidden. I want to hide this row if even a SINGLE row within the range is unhidden. What is the syntax for this? My current code is as follows:</p>\n\n<pre><code>Public Sub MySub()\n\nApplication.ScreenUpdating = False\n\nWith Range(\"A1:A5\")\n.EntireRow.Hidden = False\n\n For Each cell In Range(\"A1:A5\")\n     Select Case cell.Value\n         Case Is = \"-\"\n         cell.EntireRow.Hidden = True\n     End Select\n Next cell\n\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 5, "creation_date": 1452707897, "post_id": 34773735, "comment_id": 57292536, "body": "Always best to show your code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 5, "creation_date": 1452708174, "post_id": 34773735, "comment_id": 57292681, "body": "I suspect the problem is in the code."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1452710012, "post_id": 34773735, "comment_id": 57293819, "body": "Can you show the code you&#39;re using please? I have a feeling the issue is therein."}], "answers": [{"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1452710638, "creation_date": 1452710638, "answer_id": 34774636, "question_id": 34773735, "link": "https://stackoverflow.com/questions/34773735/udf-calculations-stop-when-i-scroll-or-move-excel/34774636#34774636", "title": "UDF Calculations Stop when i scroll or move Excel", "body": "<p>User interaction with Excel whilst its calculating is supposed to interrupt calculation and restart it later (but the restart can be a bit problematic in my experience). You could try setting <br><code>Application.CalculationInterruptKey=xlNoKey</code> <br>but it probably won't work from within a VBA UDF.<br>\nReally you need to rewrite the UDFs as asynchronous, but you can't do this with VBA - you need to be using the XLL interface either from C++ or .NET using XLDNA or Addin Express.</p>\n"}, {"tags": [], "owner": {"reputation": 333, "user_id": 454195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30723c3ee6848108ef9bd01a46effda?s=128&d=identicon&r=PG", "display_name": "osullivj", "link": "https://stackoverflow.com/users/454195/osullivj"}, "is_accepted": false, "score": 1, "last_activity_date": 1452778338, "creation_date": 1452778338, "answer_id": 34790954, "question_id": 34773735, "link": "https://stackoverflow.com/questions/34773735/udf-calculations-stop-when-i-scroll-or-move-excel/34790954#34790954", "title": "UDF Calculations Stop when i scroll or move Excel", "body": "<p>The calculation stops when you grab the scrollbar because Excel does most of its processing on a single thread. That thread can't be scrolling the GUI and calculating formula results at the same time. Charles Williams is right on asynchronous UDFs. Support for asynchronous UDFs were introduced in the XLL SDK in Excel 2010. There's more detail on async UDFs here: <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff475859.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/EN-US/library/office/ff475859.aspx</a></p>\n"}], "owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "accepted_answer_id": 34774636, "answer_count": 2, "score": -2, "last_activity_date": 1452778338, "creation_date": 1452707843, "last_edit_date": 1452708150, "question_id": 34773735, "link": "https://stackoverflow.com/questions/34773735/udf-calculations-stop-when-i-scroll-or-move-excel", "title": "UDF Calculations Stop when i scroll or move Excel", "body": "<p>I have an excel workbook that has around 500 cells each calling 1 of 3 functions that send data to a web API then outputs it to the cell.</p>\n\n<p>When i use my workbook in automatic calculations, they run when i press F9 But If i move the workbook/scroll down is stops all calculations without warning. Some of the cells may have finished. </p>\n\n<p><strong>Is there a way of locking the screen or a way of keeping the functions running in the background while i move around excel?</strong></p>\n\n<p>It also stops when i click onto another workbook. </p>\n\n<p>Does anyone know what might be causing this?</p>\n\n<p>Even in automatic calculations, it will stop the calculation util i leave it idle then it starts them up again without prompt.</p>\n"}, {"tags": ["excel", "vba", "dynamic", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452708202, "post_id": 34773709, "comment_id": 57292701, "body": "This would need to be in vba, in Worksheet_SelectionChange event."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1452709293, "post_id": 34774159, "comment_id": 57293351, "body": "You may want to put in an intersect to make this only fire when it is column A that is selected."}, {"owner": {"reputation": 437, "user_id": 5785719, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mEbo9.jpg?s=128&g=1", "display_name": "CoderScissorhands", "link": "https://stackoverflow.com/users/5785719/coderscissorhands"}, "edited": false, "score": 0, "creation_date": 1452714024, "post_id": 34774159, "comment_id": 57296335, "body": "I want this to fire whenever i activate ANY cell a particular row- but thank you. That was a thoughtful question. :)"}, {"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1452714200, "post_id": 34774159, "comment_id": 57296455, "body": "In that case, you should remove the 2nd and 4th line in the code I suggestes"}, {"owner": {"reputation": 437, "user_id": 5785719, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mEbo9.jpg?s=128&g=1", "display_name": "CoderScissorhands", "link": "https://stackoverflow.com/users/5785719/coderscissorhands"}, "edited": false, "score": 0, "creation_date": 1452715196, "post_id": 34774159, "comment_id": 57297047, "body": "Sorry, I don&#39;t see any place in this code that allows me to specify the fixed column that will always be used to fill the dynamic cell regardless of row.  Where would that be entered in this code? For example, the source text in my example comes from column B always. After looking at your code, I think it is the 2, but that is strange to me, since excel uses letters to refer to columns."}, {"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1452715361, "post_id": 34774159, "comment_id": 57297134, "body": "Cells(Selection.Row, 2) is a reference to the 2nd column (i.e. column B) of the row on which a cell is selected"}, {"owner": {"reputation": 437, "user_id": 5785719, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mEbo9.jpg?s=128&g=1", "display_name": "CoderScissorhands", "link": "https://stackoverflow.com/users/5785719/coderscissorhands"}, "edited": false, "score": 0, "creation_date": 1452716305, "post_id": 34774159, "comment_id": 57297655, "body": "That worked like a charm!!! thank you so much to both of you NIH and Scott. I love this, it is magic!!!!  <b>A note to any other VBA clueless folks who might be reading this:</b> you need to save the excel file as macro-enabled. :)"}], "tags": [], "owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "is_accepted": true, "score": 1, "last_activity_date": 1452711566, "last_edit_date": 1452711566, "creation_date": 1452709147, "answer_id": 34774159, "question_id": 34773709, "link": "https://stackoverflow.com/questions/34773709/dynamically-update-a-single-cell-with-contents-from-a-fixed-column-reference-bu/34774159#34774159", "title": "Dynamically update a single cell with contents from a fixed column reference, but from the current, active row", "body": "<p>As Scott Craner suggests, you'll need the \"Worksheet_SelectionChange\" event in VBA. Since you indicate not being familiar with VBA, I'll talk you through it. First, open the VBA editor by entering Alt+F11. In the VBA editor, enter Ctrl+R to open or jump to the project explorer (it's usually a pane on the left side of the window) and double-click the name of the sheet where you want your function. Now enter the following code:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Not(Intersect(ActiveCell, Range(\"A:A\")) Is Nothing) Then\n        Cells(1, 1).Value = Cells(Selection.Row, 2)\n    End If\nEnd Sub\n</code></pre>\n\n<p>The first line tells VBA it should execute the code whenever the selection changes. The second line checks if your selection is in column A. The third line actually does the trick: it takes the value from the second column of the selected row and puts this value in A1.</p>\n"}], "owner": {"reputation": 437, "user_id": 5785719, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mEbo9.jpg?s=128&g=1", "display_name": "CoderScissorhands", "link": "https://stackoverflow.com/users/5785719/coderscissorhands"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 34774159, "answer_count": 1, "score": 2, "last_activity_date": 1452717954, "creation_date": 1452707776, "last_edit_date": 1452717954, "question_id": 34773709, "link": "https://stackoverflow.com/questions/34773709/dynamically-update-a-single-cell-with-contents-from-a-fixed-column-reference-bu", "title": "Dynamically update a single cell with contents from a fixed column reference, but from the current, active row", "body": "<p>I am trying to have a certain header cell in excel dynamically update its contents depend on which row I am currently using, but with an address that has a fixed column. So the column reference for the header's contents will always be the same, however, I would like to have the row address change depending on the cell I am editing (i.e. the active cell).  </p>\n\n<pre><code>  A                     B  \n1 (dynamic header cell)\n2  John                 likes to eat apples\n3  Mary                 never smokes\n4  Peter                tries too hard to be cool\n5  David                loves madonna\n</code></pre>\n\n<p>So, If I click on cell A2 (\"John\"), I want the header cell (A1) to update with the contents of B2 (\"likes to eat apples\"), and similarly if I click on cell A4 (\"Peter\"), I want the same header cell (A1) to update with the contents of B4 (\"tries too hard to be cool\").</p>\n\n<p>I have done some research, and I think perhaps I might use some combination of the cell function or the indirect function, but I cannot manage to get this to work.  I would prefer to use a simple formula, but if I need to do VBA, that is fine.  </p>\n\n<p>(If you suggest VBA, please include the whole function, because I don't know the language).</p>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["windows", "vba", "excel", "windows-update"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1452708182, "post_id": 34773576, "comment_id": 57292687, "body": "What do you mean it crashes? Is there an error or does it just close?"}, {"owner": {"reputation": 675, "user_id": 3431121, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1365436515/picture?type=large", "display_name": "jaysoncopes", "link": "https://stackoverflow.com/users/3431121/jaysoncopes"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1452708636, "post_id": 34773576, "comment_id": 57292931, "body": "@MatthewD as is the norm with &quot;crashes&quot;, I press debug, all Excel windows haze up and the message &quot;Microsoft Excel has stopped running - Windows is checking for a solution to the problem.&quot;"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1452881339, "post_id": 34773576, "comment_id": 57376477, "body": "try reinstall a fresh excell from scratch (first uninstall it), it will be faster than waiting on microsoft to wake up."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5839303, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1fa1e633d7e532118b87ba8b0b55d654?s=128&d=identicon&r=PG", "display_name": "skippy-jon-jon", "link": "https://stackoverflow.com/users/5839303/skippy-jon-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1453759933, "creation_date": 1453759933, "answer_id": 35003420, "question_id": 34773576, "link": "https://stackoverflow.com/questions/34773576/excel-crashes-on-debug-and-others/35003420#35003420", "title": "Excel Crashes on Debug (and others)", "body": "<p>Tried several things, not sure which attempt fixed this.\nI first  unregistered and registerd mscomctl.ocx and mscomct2.ocx in windows\\syswow64\nStill had a problem;  next I unchecked solver add-in in excel options.\nthis seemed to work.\nI then checked recent KB updates and uninstalled KB3114564, re-added solver add-in and problem was resolved.\nThis does not keep KB3114564 from showing up again, but good enough for immediate emergency.</p>\n"}], "owner": {"reputation": 675, "user_id": 3431121, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1365436515/picture?type=large", "display_name": "jaysoncopes", "link": "https://stackoverflow.com/users/3431121/jaysoncopes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1453759933, "creation_date": 1452707388, "last_edit_date": 1452710889, "question_id": 34773576, "link": "https://stackoverflow.com/questions/34773576/excel-crashes-on-debug-and-others", "title": "Excel Crashes on Debug (and others)", "body": "<p>I'm currently having a problem where Excel will crash on multiple occasions. The ones I've noticed so far are as follows:</p>\n\n<ul>\n<li><strike>Debugging an error</strike></li>\n<li>Deleting an entire function (Note: does not occur when only deleting contents)</li>\n<li>Other random developer type problems</li>\n</ul>\n\n<p>My current analysis is that it was caused by the automatic Windows update <strong><em>KB3114564</em></strong> issued this morning. I have not been able to securely link the problem to this update, however.</p>\n\n<p><strike>I am going to try moving all my code to a new workbook, which will be a pain since it's a multi-module, multi-form project.</strike></p>\n\n<p>Please let me know if you have experienced any problems of the type today/before.</p>\n\n<h2>Update 1:</h2>\n\n<p>Moving code to new workbook does not effect performance of Excel</p>\n\n<h2>Update 2:</h2>\n\n<p>It appears that the problem I had with the debugger crashing had to do with trying to multiply a string by a double. This still shouldn't have caused the DEBUGGER to crash, but at least that problem is diagnosed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452708172, "post_id": 34773471, "comment_id": 57292679, "body": "stay <b>away</b> from <code>Select</code> and <code>ActiveSheet</code> in your code as much as possible (see <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this</a>). Qualify all your <code>Workbooks &#47; Sheets &#47; Ranges</code> and your code will most likely run as smooth as you desire. This line, in particular, is a real problem: <code>ThisWorkbook.ActiveSheet.Range(&quot;A&quot; &amp; ActiveSheet.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row + 1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1452708810, "creation_date": 1452708810, "answer_id": 34774062, "question_id": 34773471, "link": "https://stackoverflow.com/questions/34773471/coping-values-to-another-workbook-if-matching-text-is-found/34774062#34774062", "title": "Coping values to another workbook if matching text is found", "body": "<p>Read my comment above and review the link I sent. </p>\n\n<p>I have edited your code to qualify all your objects and work directly with each <em>intended</em> object. In this way you can be sure that your code will act on the <strong>exact</strong> object you desire every-time.</p>\n\n<p>You can define the lines I edited, by the <code>'***</code> at the line's end.</p>\n\n<pre><code>Const delim = vbTab  'for TAB delimited text files\n\nSub ImportMultipleTextFiles()\n\nDim wb As Workbook, wbThis As Workbook '***\nDim wsCopy As Worksheet, wsPaste As Worksheet '***\nDim sFile As Variant\nDim LastRow As Long\nDim rngCell As Range\nDim varMyItem As String\n\nSet wbThis = ThisWorkbook '***\nSet wsPaste = wbThis.Sheets(\"Sheet1\") 'change name as needed '***\n\nvarMyItem = \"NC\"\n\nsFile = Application.GetOpenFilename(\"Text Files (*.csv),*.csv\", , \"Please select text file...\")\n\nSet wb = Workbooks.Open(Filename:=sFile)\nSet wsCopy = wb.Sheets(1) '***\n\nApplication.ScreenUpdating = False\n\nLastRow = wsCopy.Range(\"B\" &amp; Rows.Count).End(xlUp).Row '***\nDebug.Print \"LastRow = \" &amp; LastRow\n\nSet aCell = wsCopy.Range(\"B1:B\" &amp; LastRow).Find(What:=\"Trimmed Mean\", LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False) '***\n\nDebug.Print \"Trimmed Mean can be found in Row # \" &amp; aCell.Row\n'wb.Sheets(1).Select '***\n\nFor Each rngCell In wsCopy.Range(\"B\" &amp; aCell.Row &amp; \":B\" &amp; LastRow) '***\n' Debug.Print ActiveSheet.Range(\"B\" &amp; aCell.Row &amp; \":B\" &amp; LastRow)\n    If InStr(rngCell, \"NC\") &gt; 0 Then\n        Debug.Print rngCell.Row\n'\n        rngCell.Offset(0, 1).Copy Destination:=wsPaste.Range(\"A\" &amp; wsPaste.Range(\"A\" &amp; wsPaste.Rows.Count).End(xlUp).Row + 1) '***\n\n        Exit For\n    End If\nNext rngCell\n\n\nwb.Close SaveChanges:=False\n\nSet wb = Nothing\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16, "favorite_count": 0, "accepted_answer_id": 34774062, "answer_count": 1, "score": 0, "last_activity_date": 1452708810, "creation_date": 1452707019, "last_edit_date": 1531164843, "question_id": 34773471, "link": "https://stackoverflow.com/questions/34773471/coping-values-to-another-workbook-if-matching-text-is-found", "title": "Coping values to another workbook if matching text is found", "body": "<p>The following code opens a .csv file, finds \u201cTrimmed Mean\u201d in col B, uses the row of \u201cTrimmed Mean\u201d as the starting point  to find the next \u201cNC\u201d value in column B and copies value one cell to the right of \u201cNC\u201d to the Workbook from which the code is executed (Sheet 1 col A).  </p>\n\n<p>The problem is that the code runs but the value is not copied to the sheet1.  It\u2019s probably just a minor thing but I can\u2019t figure out what that is. Thanks for your help.</p>\n\n<pre><code>Const delim = vbTab  'for TAB delimited text files\n\n\nSub ImportMultipleTextFiles()\n\nDim wb As Workbook\nDim sFile As Variant\nDim LastRow As Long\nDim rngCell As Range\nDim varMyItem As String\n\nvarMyItem = \"NC\"\n\nsFile = Application.GetOpenFilename(\"Text Files (*.csv),*.csv\", , \"Please select text file...\")\n\nSet wb = Workbooks.Open(Filename:=sFile)\n\nApplication.ScreenUpdating = False\n\nwb.Sheets(1).Select\n\nLastRow = ActiveSheet.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nDebug.Print \"LastRow = \" &amp; LastRow\n\nSet aCell = ActiveSheet.Range(\"B1:B\" &amp; LastRow).Find(What:=\"Trimmed Mean\", LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n\nDebug.Print \"Trimmed Mean can be found in Row # \" &amp; aCell.Row\n'wb.Sheets(1).Select\n\nFor Each rngCell In ActiveSheet.Range(\"B\" &amp; aCell.Row &amp; \":B\" &amp; LastRow)\n' Debug.Print ActiveSheet.Range(\"B\" &amp; aCell.Row &amp; \":B\" &amp; LastRow)\n    If InStr(rngCell, \"NC\") &gt; 0 Then\n        Debug.Print rngCell.Row\n'\n        rngCell.Offset(0, 1).Copy Destination:=ThisWorkbook.ActiveSheet.Range(\"A\" &amp; ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1)\n\n        Exit For\n    End If\nNext rngCell\n\n\nwb.Close SaveChanges:=False\n\nSet wb = Nothing\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452707826, "post_id": 34773433, "comment_id": 57292480, "body": "<code>objTitleTag.getAttribute(&quot;contentTitle&quot;)</code>"}, {"owner": {"reputation": 825, "user_id": 1217202, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2898071213663d91ea70ecf8e6ac6bbb?s=128&d=identicon&r=PG", "display_name": "capm", "link": "https://stackoverflow.com/users/1217202/capm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452707893, "post_id": 34773433, "comment_id": 57292533, "body": "How should <code>objTitleTag</code> be defined?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452707966, "post_id": 34773433, "comment_id": 57292572, "body": "It&#39;s whatever you called <code>innerText</code> on.  It&#39;s always best to show your actual code: makes it easier to make suggestions on what to add."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452718767, "post_id": 34773433, "comment_id": 57299010, "body": "Just <code>MsgBox objTitleTag.getAttribute(&quot;contentTitle&quot;)</code> - attributes have values but no <code>innerText</code> property"}, {"owner": {"reputation": 825, "user_id": 1217202, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2898071213663d91ea70ecf8e6ac6bbb?s=128&d=identicon&r=PG", "display_name": "capm", "link": "https://stackoverflow.com/users/1217202/capm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452719688, "post_id": 34773433, "comment_id": 57299424, "body": "I get <code>Invalid use of Null (Error 94)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 825, "user_id": 1217202, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2898071213663d91ea70ecf8e6ac6bbb?s=128&d=identicon&r=PG", "display_name": "capm", "link": "https://stackoverflow.com/users/1217202/capm"}, "edited": false, "score": 0, "creation_date": 1452804081, "post_id": 34778022, "comment_id": 57341793, "body": "I get it, when I extract the elements by class <code>index-detail</code> and then I isolate the heading <code>&lt;h5&gt;</code>, the attributes doesn&#39;t belong to the heading but to another section that start with <code>&lt;a...</code>. Worked fine, thanks!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1452727392, "last_edit_date": 1452727392, "creation_date": 1452722858, "answer_id": 34778022, "question_id": 34773433, "link": "https://stackoverflow.com/questions/34773433/excel-query-attributes-from-a-html-headings/34778022#34778022", "title": "Excel: Query attributes from a HTML headings", "body": "<p>The attribute is attached to <code>&lt;a&gt;</code>, not <code>&lt;h5&gt;</code> (sorry that was my mistake in the comments above):</p>\n\n<pre><code>Sub TT()\n\n    Dim html As String, d As New HTMLDocument, el\n\n    html = \"&lt;div class='index-detail'&gt;\" &amp; _\n    \"&lt;h5&gt;&lt;a href='/indices/equity/dow-jones-sustainability-chile-index-clp' \" &amp; _\n    \"title='DJSI Chile' contentIdentifier='2e9cb165-0cbf-4070-a5ef-dc20bf6219ba' \" &amp; _\n    \"contentType = 'web-page' \" &amp; _\n    \"contentTitle='Dow Jones Sustainability\u2122 Chile Index (CLP)'&gt;DJSI Chile&lt;/a&gt;&lt;/h5&gt; \" &amp; _\n    \"&lt;span class='return-value'&gt;917.08 &lt;/span&gt; \" &amp; _\n    \"&lt;span class='daily-change  down '&gt;-0.1% ? &lt;/span&gt;&lt;/div&gt;\"\n\n    d.body.innerHTML = html\n\n    Set el = d.getElementsByClassName(\"index-detail\")(0).getElementsByTagName(\"a\")(0)\n\n    Debug.Print el.getAttribute(\"contentTitle\")\n      ' &gt;&gt;&gt; Dow Jones Sustainability\u2122 Chile Index (CLP)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1530392192, "creation_date": 1530392192, "answer_id": 51118431, "question_id": 34773433, "link": "https://stackoverflow.com/questions/34773433/excel-query-attributes-from-a-html-headings/51118431#51118431", "title": "Excel: Query attributes from a HTML headings", "body": "<p><strong>CSS selector:</strong></p>\n\n<p>You could use a css selector of a[contentTitle] to get the element(s) with an <code>a</code> tag and a <code>contenttitle</code> attribute. You then access the contenttitle attribute.</p>\n\n<hr>\n\n<p><strong>CSS query:</strong></p>\n\n<p>Selecting the appropriate element</p>\n\n<p><a href=\"https://i.stack.imgur.com/hVJ2V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hVJ2V.png\" alt=\"CSS query\"></a></p>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<p>You apply the selector to get a single node with <code>querySelector</code>; all matching nodes would be <code>querySelectorAll</code>.  You use getAttribute to access the required information.</p>\n\n<pre><code>oHtmlSP.querySelector(\"a[contentTitle]\").getAttribute(\"contentTitle\")\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 1217202, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/2898071213663d91ea70ecf8e6ac6bbb?s=128&d=identicon&r=PG", "display_name": "capm", "link": "https://stackoverflow.com/users/1217202/capm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 34778022, "answer_count": 2, "score": 0, "last_activity_date": 1530392192, "creation_date": 1452706901, "last_edit_date": 1452712347, "question_id": 34773433, "link": "https://stackoverflow.com/questions/34773433/excel-query-attributes-from-a-html-headings", "title": "Excel: Query attributes from a HTML headings", "body": "<p>I want to extract the attributes values from a heading type in a web page using excel vba. The data I want to scrape from the <a href=\"http://www.espanol.spindices.com/\" rel=\"nofollow\">webpage</a> has the following structure:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"index-detail\"&gt;\r\n  &lt;h5&gt;&lt;a href=\"/indices/equity/dow-jones-sustainability-chile-index-clp\" title=\"DJSI Chile\" contentIdentifier=\"2e9cb165-0cbf-4070-a5ef-dc20bf6219ba\" contentType=\"web-page\" contentTitle=\"Dow Jones Sustainability\u2122 Chile Index (CLP)\"&gt;DJSI Chile&lt;/a&gt;&lt;/h5&gt;\r\n  &lt;span class=\"return-value\"&gt;917.08 &lt;/span&gt;\r\n  &lt;span class=\"daily-change  down \"&gt;-0.1% \u25bc &lt;/span&gt;\r\n&lt;/div&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Using <code>getElementsByClassName</code> and <code>getElementsByTagName</code> I've already extracted the heading <code>&lt;h5&gt;</code>, however when I print the <code>innerText</code> of the heading I get <code>DJSI Chile</code>, but I want to get the text inside the attribute <code>contentTitle</code> which is <code>Dow Jones Sustainability\u2122 Chile Index (CLP)</code>.</p>\n\n<p>How can I do this?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>The code is I'm using is as follows:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Sub myConSP()\r\n    \r\n    ' Declare variables\r\n    Dim oHtmlSP As HTMLDocument\r\n    Dim tSPIndex As HTMLDivElement\r\n    Dim tSPIdx As HTMLDivElement\r\n\r\n    ' Load page inside HTMLDocument\r\n    Set oHtmlSP = New HTMLDocument\r\n    With CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\r\n        .Open \"GET\", \"http://www.espanol.spindices.com\", False\r\n        .send\r\n        oHtmlSP.body.innerHTML = .responseText\r\n    End With\r\n\r\n    ' Get indices\r\n    Set tSPIndex = oHtmlSP.getElementById(\"all-indices-slider\")\r\n\r\n    Set objTitleTag = tSPIndex.getElementsByClassName(\"index-detail\")(0).getElementsByTagName(\"h5\")(0)\r\n    MsgBox objTitleTag.getAttribute(\"contentTitle\").innerText\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel", "charts", "fonts", "axes"], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 0, "last_activity_date": 1452754138, "creation_date": 1452754138, "answer_id": 34783295, "question_id": 34773273, "link": "https://stackoverflow.com/questions/34773273/when-utilizing-chart-chartstyle-248-how-do-i-turn-off-all-caps-in-the-axes-tit/34783295#34783295", "title": "When utilizing chart.chartstyle = 248 how do I turn off all caps in the axes title?", "body": "<p><code>Chart</code>s are not <code>Excel</code> alone but across all office applications. So their objects are also not native <code>Excel</code> objects. <code>Allcaps</code>, <code>Smallcaps</code>, ... are members of the <code>Font2</code> object. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863038%28v=office.14%29.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff863038%28v=office.14%29.aspx</a></p>\n\n<p>To get the <code>Font2</code> object is sometimes a little bit tricky.</p>\n\n<p>Assuming we have the following chart sheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kk0sT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kk0sT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then the following <code>VBA</code> should do: </p>\n\n<pre><code>Sub test()\n\n Dim oChart As Chart\n Dim oFont2 As Font2\n\n Set oChart = ActiveChart\n\n With oChart\n  Set oFont2 = .Axes(xlCategory, xlPrimary).AxisTitle.Format.TextFrame2.TextRange.Font\n  oFont2.Allcaps = msoTrue\n  oFont2.Allcaps = msoFalse\n  oFont2.Smallcaps = msoTrue\n  oFont2.Smallcaps = msoFalse\n\n End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5785705, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5gS9bcG4mWc/AAAAAAAAAAI/AAAAAAAAKlo/1rPlXhOWLPI/photo.jpg?sz=128", "display_name": "Braveheart", "link": "https://stackoverflow.com/users/5785705/braveheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 824, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1452754138, "creation_date": 1452706398, "question_id": 34773273, "link": "https://stackoverflow.com/questions/34773273/when-utilizing-chart-chartstyle-248-how-do-i-turn-off-all-caps-in-the-axes-tit", "title": "When utilizing chart.chartstyle = 248 how do I turn off all caps in the axes title?", "body": "<h2>Problem</h2>\n\n<p>I want to be able to effectively uncheck the box for all caps <a href=\"http://i.stack.imgur.com/lNevC.jpg\" rel=\"nofollow\">Font Properties Dialog Box</a> in VBA on an excel chart axis label / title.</p>\n\n<hr>\n\n<h2>What I have tried</h2>\n\n<p>For excel, the option for all caps as a member of characters or font does not seem to be available within charts.</p>\n\n<p>Furthermore, changing only the text using something like Upper, Ucase, or LCase does not work. </p>\n\n<hr>\n\n<h2>Some Code</h2>\n\n<p>I have included my code where I am building the chart. You can see in the comments some of my attempts to change the property of allcaps. Using vba in excel with some thing similar to:</p>\n\n<pre><code> With newChart\n    'If put an if statement to see if name already exists, try catch case would be good too\n    .Name = UsrFrm2.titleTxt.Text\n    .ChartType = xlXYScatterSmoothNoMarkers\n    '.CategoryLabelLevel = xlCategoryLabelLevelCustom\n\n    'using preselected formatting for chart\n    .ChartStyle = 248\n    .ChartColor = 10\n\n    'Labeling\n    .HasTitle = True\n    .ChartTitle.Text = Me.titleTxt.Text\n    .HasAxis(xlCategory, xlPrimary) = True\n    .HasAxis(xlCategory, xlSecondary) = True\n    .HasAxis(xlValue, xlPrimary) = True\n    .HasAxis(xlValue, xlSecondary) = True\n    .Axes(xlCategory, xlPrimary).CategoryType = xlAutomatic\n    '.Axes(xlCategory, xlSecondary).CategoryType = xlAutomatic\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    '.Axes(xlCategory, xlSecondary).HasTitle = True\n    '.Axes(xlValue, xlSecondary).AxisTitle.Characters.Text = \"Loss Tangent (tand)\"\n    .HasLegend = True\n    '.Axes(xlCategory, xlPrimary).MinimumScale = 1000000\n   ' .Axes(xlCategory, xlPrimary).MaxiumScale = 1800000000\nEnd With\n</code></pre>\n\n<p>or something such as this:</p>\n\n<pre><code>With newChart\n    'trying to change the axis titles to turn off all caps. I cannot figure out how at the moment, will have to do by hand.\n        'Plotyy format\n        .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = UsrFrm2.XALabel.Value\n        '.Axes(xlCategory, xlPrimary).AxisTitle.Characters.Font.Bold = False\n        .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Font.FontStyle = \"Normal\"\n        '.Axes(xlCategory, xlPrimary).AxisTitle.Characters.Font.Allcaps = False\n        '.Axes(xlCategory, xlPrimary).AxisTitle.Font.Allcaps = False\n        .Axes(xlCategory, xlPrimary).MinimumScale = UsrFrm2.XSMin.Value\n        .Axes(xlCategory, xlPrimary).MaximumScale = UsrFrm2.XSMax.Value\n        .Axes(xlCategory, xlPrimary).MajorUnitIsAuto = True\n        .Axes(xlCategory, xlPrimary).MinorUnitIsAuto = True\n        If Me.X_MHz.Value = True Then\n            .Axes(xlCategory, xlPrimary).DisplayUnit = xlCustom\n            .Axes(xlCategory, xlPrimary).DisplayUnitCustom = 1000000#\n            .Axes(xlCategory, xlPrimary).HasDisplayUnitLabel = True\n            .Axes(xlCategory, xlPrimary).DisplayUnitLabel.Caption = \"MHz\"\n        ElseIf Me.X_GHz.Value = True Then\n            .Axes(xlCategory, xlPrimary).DisplayUnit = xlCustom\n            .Axes(xlCategory, xlPrimary).DisplayUnitCustom = 1000000000#\n            .Axes(xlCategory, xlPrimary).HasDisplayUnitLabel = True\n            .Axes(xlCategory, xlPrimary).DisplayUnitLabel.Caption = \"GHz\"\n        Else\n            .Axes(xlCategory, xlPrimary).DisplayUnit = xlNone\n        End If\n        .Axes(xlValue, xlPrimary).MinimumScale = UsrFrm2.YSMin.Value\n        .Axes(xlValue, xlPrimary).MaximumScale = UsrFrm2.YSMax.Value\n        .Axes(xlValue, xlPrimary).MajorUnitIsAuto = True\n        .Axes(xlValue, xlPrimary).MinorUnitIsAuto = True\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).TickLabels.NumberFormat = \"General\"\n        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Font.FontStyle = \"Normal\"\nEnd With\n</code></pre>\n\n<p>Suggestions Please.</p>\n\n<hr>\n\n<hr>\n\n<p>Do or Do Not, There is no Try --Yoda, Jedi Master</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452704882, "post_id": 34772623, "comment_id": 57290592, "body": "When you&#39;re transposing values from a range you&#39;re not working with Ranges but with arrays. So you declare (eg) <code>periodcol</code> as Variant and don&#39;t use <code>Set</code> to assign the return value from <code>Transpose</code>"}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452705116, "post_id": 34772623, "comment_id": 57290767, "body": "See edit, making them variants yields different result (no crash) but still doesn&#39;t work"}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452705262, "post_id": 34772623, "comment_id": 57290859, "body": "edited my post, those are inputs into the function, if function detects more columns then one, it needs to transpose it."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1452705270, "post_id": 34772623, "comment_id": 57290863, "body": "How exactly are you testing <code>periodcol</code>? Check the Locals window as a tooltip can&#39;t show you the values of an array."}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1452705335, "post_id": 34772623, "comment_id": 57290901, "body": "it actually says periodcol=Empty in the yellow excel tooltip, also <code>periodcol.Rows.Count</code> returns 0"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452705364, "post_id": 34772623, "comment_id": 57290926, "body": "You should set <code>periodcol</code> to a range of the proper size to hold the result of the transpose operation before you try to assign a value to it. As it is, it is an unitialized variable."}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1452705481, "post_id": 34772623, "comment_id": 57290993, "body": "can I set <code>periodcol</code> to the size of periodcol2 (just opposite row and col?)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1452705551, "post_id": 34772623, "comment_id": 57291049, "body": "&quot;Note: I don&#39;t want to paste the values anywhere, just keep them in the code&quot; - variants don&#39;t have &quot;rows&quot; or &quot;columns&quot;, so if you want to work with data in-memory you need to think in terms of arrays and not ranges."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452705578, "post_id": 34772623, "comment_id": 57291069, "body": "Decide what <i>location</i> you want the transposed values to be in. If you don&#39;t want the values to be in the spreadsheet -- follow Tim William&#39;s advice and assign it to a variant."}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1452705992, "post_id": 34772623, "comment_id": 57291348, "body": "assigning to a Variant does not work - see the edit"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452706345, "post_id": 34772623, "comment_id": 57291557, "body": "Are you sure that <code>ratecol2</code> isn&#39;t empty? I just tested it and it is completely non-problematic to assign the transpose of a non-empty range to a variant variable, the result being an array stored in the variant."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452706457, "post_id": 34772623, "comment_id": 57291630, "body": "There is, however, a limit to the <i>size</i> of the array that can be transposed (at least in some versions of Excel) -- perhaps that is what you are running into."}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1452706512, "post_id": 34772623, "comment_id": 57291666, "body": "no, the input ranges I&#39;m testing are 1x4 and 4x1. 100% sure they are not empty. I&#39;m trying to transpose 4 cols, 1 row to 4 rows"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452706878, "post_id": 34772623, "comment_id": 57291908, "body": "When you step through code in the debugger, <code>ratecol2</code> will still display as <code>Empty</code> on mouse hover when that line is the highlighted line. -- you have to go to the next step to see how executing that line changes the contents of the variables. Also -- you should probably use the Locals Window rather than mouse hover if you really want to see what&#39;s going on."}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1452707084, "post_id": 34772623, "comment_id": 57292027, "body": "See edit2, <code>rate_count</code> and <code>period_count</code> are equal to 0 at the end of the code."}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "edited": false, "score": 0, "creation_date": 1452707377, "post_id": 34772623, "comment_id": 57292220, "body": "<code>Ubound</code> works but then I lose the ability to refer to elements as ratecol(1) and need to do ratecol(1,1) instead ?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1452708172, "post_id": 34772623, "comment_id": 57292678, "body": "Yes -- you need to use <code>ratecol(1,1)</code> -- one of the great annoyances of Excel VBA is that <code>nx1</code> ranges become <code>1 to n, 1 to 1</code> arrays when you assign them to a variant"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452716454, "post_id": 34772623, "comment_id": 57297741, "body": "See the edit in my answer for getting a 1-D array."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1452716436, "last_edit_date": 1452716436, "creation_date": 1452706403, "answer_id": 34773277, "question_id": 34772623, "link": "https://stackoverflow.com/questions/34772623/transpose-range-variable/34773277#34773277", "title": "Transpose Range Variable", "body": "<pre><code>Sub Tester()\n\n    Dim rng As Range, arr, arr2\n\n    Set rng = Range(\"A1:D1\") 'contents 1,2,3,4\n\n    If rng.Columns.Count &gt; 1 Then\n        arr = Application.Transpose(rng.Value)\n        'arr is now a 2-d array (1 to 4, 1 to 1)\n        Debug.Print arr(1, 1), arr(2, 1), arr(3, 1), arr(4, 1)\n         ' &gt;&gt;&gt;   1 2 3 4\n\n        'EDIT: if you want a 1-D array\n        arr2 = Application.Transpose(arr)\n        Debug.Print arr2(1), arr2(2), arr2(3), arr2(4)\n\n    End If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 990, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452716436, "creation_date": 1452704377, "last_edit_date": 1531164843, "question_id": 34772623, "link": "https://stackoverflow.com/questions/34772623/transpose-range-variable", "title": "Transpose Range Variable", "body": "<p>I am having issues with transposing a Range variable from a 4x1 format to 1x4 format (4 rows)</p>\n\n<p>I searched everywhere yet I can't seem to find anything that works.</p>\n\n<p>Here is what I tried:</p>\n\n<pre><code>Function test(periodcol2 As Range, ratecol2 As Range, X As Range)\n    Dim periodcol As Range\n    Dim ratecol As Range\n\nIf periodcol2.Columns.Count &gt; 1 Then\n    periodcol.Value = Application.WorksheetFunction.Transpose(periodcol2)\n    ratecol.Value = Application.WorksheetFunction.Transpose(ratecol2)\nEnd If\n</code></pre>\n\n<p>Crashes on the Value assignment.</p>\n\n<pre><code>If periodcol2.Columns.Count &gt; 1 Then\n    Set periodcol = Application.WorksheetFunction.Transpose(periodcol2)\n    Set ratecol = Application.WorksheetFunction.Transpose(ratecol2)\n\nEnd If\n</code></pre>\n\n<p>Same result.</p>\n\n<p>EDIT: This doesn't work either, instead it makes periodcol content 'empty' as shown by excel tooltip</p>\n\n<pre><code>Dim periodcol As Variant\nDim ratecol As Variant\n\nIf periodcol2.Columns.Count &gt; 1 Then\n    periodcol = Application.WorksheetFunction.Transpose(periodcol2)\n    ratecol = Application.WorksheetFunction.Transpose(ratecol2)\nElse\n</code></pre>\n\n<p>EDIT2: rate_count &amp; period_count are equal to 0 at the end of this code.</p>\n\n<pre><code>Function TEST(periodcol2 As Range, ratecol2 As Range, X As Range)\nDim periodcol As Variant\nDim ratecol As Variant\n\nIf periodcol2.Columns.Count &gt; 1 Then\n    periodcol = Application.Transpose(periodcol2)\n    ratecol = Application.Transpose(ratecol2)\nElse\n\n    Set periodcol = periodcol2\n    Set ratecol = ratecol2\nEnd If\n\n\n\nDim period_count As Integer\nDim rate_count As Integer\nperiod_count = periodcol.Rows.Count\nrate_count = ratecol.Rows.Count\n</code></pre>\n\n<p>Note: I don't want to paste the values anywhere, just keep them in the code.</p>\n"}, {"tags": ["excel", "vlookup", "vba"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1452704372, "post_id": 34772294, "comment_id": 57290256, "body": "The first works fine. <code>Error 2042</code> is exactly <code>#N&#47;A</code>. <a href=\"https://msdn.microsoft.com/en-us/library/bb211091%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb211091%28v=office.12%29.a&zwnj;&#8203;spx</a>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1452704891, "post_id": 34772294, "comment_id": 57290598, "body": "@AxelRichter  ........Thank you for the reference!!"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 4, "last_activity_date": 1452704610, "last_edit_date": 1452704610, "creation_date": 1452704175, "answer_id": 34772540, "question_id": 34772294, "link": "https://stackoverflow.com/questions/34772294/getting-n-a-in-excel-vba/34772540#34772540", "title": "Getting #N/A in Excel VBA", "body": "<p>I think you'd need to explicitly check for that error:</p>\n\n<pre><code>   If v = CVErr(xlErrNA) Then MsgBox \"#N/A\"\n</code></pre>\n\n<p>BTW, the reason you get Error 2029 with your <code>Evaluate</code> version is that it should be:</p>\n\n<pre><code>v = Evaluate(\"VLookup(11, A1:B10, 2, False)\")\n</code></pre>\n\n<p>You could also adjust the formula you pass to <code>Evaluate</code>:</p>\n\n<pre><code>   Dim v As Variant\n   v = Evaluate(\"IFERROR(VLookup(11, A1:B10, 2, False),\"\"#N/A\"\")\")\n   MsgBox v\n</code></pre>\n\n<p>(if you might have error values in the second column, use an IF(ISNA(...) formula instead)</p>\n"}], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3381, "favorite_count": 0, "accepted_answer_id": 34772540, "answer_count": 1, "score": 2, "last_activity_date": 1452704610, "creation_date": 1452703479, "last_edit_date": 1531161705, "question_id": 34772294, "link": "https://stackoverflow.com/questions/34772294/getting-n-a-in-excel-vba", "title": "Getting #N/A in Excel VBA", "body": "<p>If I use <em>VLOOKUP()</em> in a worksheet cell and the lookup value cannot be found, <em>VLOOKUP()</em> will return <strong>#N/A</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LlsjB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LlsjB.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to do the same thing in <strong>VBA</strong> without putting the formula in a cell.  What I have tried so far:</p>\n\n<pre><code>Sub FailedLookup()\n   Dim v As Variant\n   v = Application.VLookup(11, Range(\"A1:B10\"), 2, False)\n   MsgBox CStr(v)\nEnd Sub\n</code></pre>\n\n<p>The above returns <em>\"Error 2042\"</em></p>\n\n<pre><code>Sub FailedLookup2()\n   Dim v As Variant\n   v = WorksheetFunction.VLookup(11, Range(\"A1:B10\"), 2, False)\n   MsgBox CStr(v)\nEnd Sub\n</code></pre>\n\n<p>The above throws a <em>1004</em> error</p>\n\n<pre><code>Sub FailedLookup3()\n   Dim v As Variant\n   v = Application.WorksheetFunction.VLookup(11, Range(\"A1:B10\"), 2, False)\n   MsgBox CStr(v)\nEnd Sub\n</code></pre>\n\n<p>The above also throws a <em>1004</em> error</p>\n\n<pre><code>Sub FailedLookup4()\n   Dim v As Variant\n   v = Evaluate(\"VLookup(11, Range(\"\"A1:B10\"\"), 2, False)\")\n   MsgBox CStr(v)\nEnd Sub\n</code></pre>\n\n<p>The above returns <em>\"Error 2029\"</em>.</p>\n\n<p>I can get <strong>#N/A</strong> with:</p>\n\n<pre><code>Sub IsThisReallyNecessary()\n   With Range(\"Z100\")\n      .Formula = \"=VLookup(11,A1:B10, 2, False)\"\n      MsgBox .Text\n   End With\nEnd Sub\n</code></pre>\n\n<p>But this also uses a cell.  Is there a simple way to get <strong>#N/A</strong> ??</p>\n"}, {"tags": ["excel", "vba", "ms-access", "recordset"], "comments": [{"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 1, "creation_date": 1452702518, "post_id": 34771884, "comment_id": 57288736, "body": "What kind of control is <code>rtvList</code>?"}, {"owner": {"reputation": 1982, "user_id": 2664815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mmDaY.jpg?s=128&g=1", "display_name": "aCarella", "link": "https://stackoverflow.com/users/2664815/acarella"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1452702636, "post_id": 34771884, "comment_id": 57288847, "body": "<code>rtvList</code> is a list box. Updated my original post."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452703216, "post_id": 34771884, "comment_id": 57289341, "body": "i dont believe there is, but you can do for f=0 to rs.fields.count-1:strToAdd =strToAdd &amp; rs.fields(f).value &amp; &quot;,&quot;:next f:cbo.AddItem strToAdd"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1452707544, "post_id": 34771884, "comment_id": 57292306, "body": "Oh wait....is the listbox an ActiveX listbox on an Excel sheet or is in on an Access form?"}], "answers": [{"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": true, "score": 1, "last_activity_date": 1452705995, "last_edit_date": 1495539901, "creation_date": 1452705585, "answer_id": 34773028, "question_id": 34771884, "link": "https://stackoverflow.com/questions/34771884/vba-how-to-add-entire-row-of-recordset-into-form-list/34773028#34773028", "title": "VBA: How to add entire row of recordset into form list", "body": "<p>No need to do any looping. A listbox has a recordset property which can be <a href=\"https://stackoverflow.com/questions/20429921/vba-in-access-2010-run-time-error-430\">bound to an ADO recordset</a>.</p>\n\n<pre><code>Dim cn As ADODB.Connection\nDim rs As ADODB.Recordset\n\nSet cn = New ADODB.Connection\n\nSet cn = CurrentProject.Connection\n\nSet rs = New ADODB.Recordset\n\nWith rs\n    Set .ActiveConnection = cn\n    .Source = sql\n    .LockType = adLockOptimistic\n    .CursorType = adOpenKeyset\n    .Open\nEnd With\n\nSet Me.rtvList.Recordset = rs\nrtvList.ColumnCount = rs.Fields.Count\n</code></pre>\n"}], "owner": {"reputation": 1982, "user_id": 2664815, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mmDaY.jpg?s=128&g=1", "display_name": "aCarella", "link": "https://stackoverflow.com/users/2664815/acarella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 0, "accepted_answer_id": 34773028, "answer_count": 1, "score": 0, "last_activity_date": 1452705995, "creation_date": 1452702387, "last_edit_date": 1452702594, "question_id": 34771884, "link": "https://stackoverflow.com/questions/34771884/vba-how-to-add-entire-row-of-recordset-into-form-list", "title": "VBA: How to add entire row of recordset into form list", "body": "<p>I have Excel VBA code that runs a select query on an access database and returns a recordset. The connection works fine. When I get the recordset, I can access each field in each row fine. Here is what I am currently using:</p>\n\n<pre><code>Sub accessSelect(sql)\nSet rs = New ADODB.Recordset\nCall accessConnection\n\nWith rs\n    .Open sql, conn\nEnd With\n\nDo While Not rs.EOF\n    'rtvEditForm.rtvList is a list box.\n    rtvEditForm.rtvList.AddItem rs(1) &amp; \" - \" &amp; rs(2)\n    rs.MoveNext\nLoop\nEnd Sub\n</code></pre>\n\n<p>I want to be able to throw the whole <code>rs</code> in the <code>rtvEditForm.rtvList</code> without having to refer to each field. I've tried <code>rtvEditForm.rtvList.AddItem rs</code>, but that does not work because I get a \"Type Mismatch\" error.</p>\n\n<p>Seems simple but I just can't figure this out. How would I do that with my current code?</p>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 0, "creation_date": 1452700511, "post_id": 34770955, "comment_id": 57287227, "body": "maybe you should post your error and we could start with that"}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 0, "creation_date": 1452701076, "post_id": 34770955, "comment_id": 57287644, "body": "@TylerCowan I&#39;ve put a pic of the error that happens."}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452701158, "post_id": 34770955, "comment_id": 57287715, "body": "@Nathan_Sav I know how to reference HTML and do web scraping just fine - it&#39;s just the looping through the list of URLs and referencing the specific element for each that I&#39;m not sure about."}, {"owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 1, "creation_date": 1452701350, "post_id": 34770955, "comment_id": 57287855, "body": "@Tak and what gets highlighted for the object defined error"}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 0, "creation_date": 1452701507, "post_id": 34770955, "comment_id": 57287971, "body": "@TylerCowan For Each rngURL In Range(&quot;C2:C&quot; &amp; lastRow)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1452701524, "post_id": 34770955, "comment_id": 57287984, "body": "If I am reading this right how about <code>If Instr(1,URL.Value,&quot;fedex&quot;) Then sID = &quot;status&quot;</code>. Then follow suit for UPS and USPS cases. Then search or reference the correct element using the <code>sID</code> variable. You may need to define which element you use by the type for each page as well. Also, for your error, you need to qualify the <code>Range ...</code> with a Worksheet. So <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;C2:C &amp; lastRow)</code> ... change <code>Sheet1</code> to your sheet name. Because of your <code>With</code> block, VBA is trying to assign the <code>Range</code> property to the IE object, which is not possible."}, {"owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 0, "creation_date": 1452701675, "post_id": 34770955, "comment_id": 57288091, "body": "@Tak I would start with properly referencing your range in this case it is ws1.Range(&quot;C2:C&quot; &amp; LastRow) also assigning the range to variant might be useful"}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452702984, "post_id": 34770955, "comment_id": 57289133, "body": "@ScottHoltzman Thank you. I&#39;ll reconstruct the code and get back to you on it. Would there be some way of referencing the address bar in the IE object? Or would I have to open up a new page every single time it goes through in the loop? D:"}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 0, "creation_date": 1452703050, "post_id": 34770955, "comment_id": 57289208, "body": "@TylerCowan I haven&#39;t needed to implement the range as variant, but I&#39;ll read up on it for a refresher and definitely give it a try."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1452703462, "post_id": 34770955, "comment_id": 57289525, "body": "@Tak - You can just navigate to the new page in the same IE instance once you are done with the previous URL."}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "edited": false, "score": 0, "creation_date": 1452890550, "post_id": 34770955, "comment_id": 57381299, "body": "@TylerCowan I don&#39;t think I&#39;m naming it right. I have this right now:   <code>Set rngURL = ws1.Range(&quot;C2:C&quot; &amp; lastRow)</code>       <code>Arr = rngURL</code>    And I&#39;ve done this:   <code>Dim rngURL As Range</code>   <code>Dim Arr() As Variant</code>"}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453739268, "post_id": 34770955, "comment_id": 57722865, "body": "@ScottHoltzman I&#39;ve been having a spot of trouble with identifying the variables for sID. I&#39;ve done <code>Dim sID As IHTMLElementCollection</code> and   <code>For Each TDelement In sID                       If InStr(1, rngURL.Value, &quot;ups&quot;) Then sID = &quot;tt_spStatus&quot;</code> but it still seems that I&#39;m getting a type mismatch error.  Sorry to bring this up again, but this is one of the bigger projects I&#39;m working on, and I don&#39;t put this in focus since a lot of smaller projects are easier to complete."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1453739695, "post_id": 34770955, "comment_id": 57723153, "body": "@Tak - please post a new question with your issue and SO can assist you better in that way."}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1453741810, "post_id": 34770955, "comment_id": 57724526, "body": "@ScottHoltzman I&#39;ve posted a new question. The code has been updated to reflect my tweaks."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 0, "creation_date": 1453312042, "post_id": 34820198, "comment_id": 57549952, "body": "Thanks for helping out with getting the loop to start up. All I have to configure now are the If statements in order to pull the right information to go into column D. The looping is working out great - it just gets slightly annoying when you&#39;re trying to break out of the macro since there&#39;s so much information flying through the message boxes haha"}, {"owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "reply_to_user": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 1, "creation_date": 1453312796, "post_id": 34820198, "comment_id": 57550438, "body": "No Problem! try adding an iterable integer such as i outside the loop set to zero and go i = i + 1 and then set wsSheet.Range(&quot;B&quot; &amp; i).Value = .Document.body.innerText instead of msgbox and you can just look at it in an excel column or just press ESC"}, {"owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "edited": false, "score": 0, "creation_date": 1453315496, "post_id": 34820198, "comment_id": 57552002, "body": "I did and tweaked it so that it will display the information I need from each order number. It works like a charm.  @Scott Holtzman Thank you for the tip on the loops! I only had the basic <code>For Each TDelement In elems                 If TDelement.className = &quot;s-result-item celwidget&quot; And InStr(TDelement.innerHTML, AAws.Range(&quot;B&quot; &amp; x).Value) Then                     AAws.Range(&quot;J&quot; &amp; x).Value = TDelement.ID                     i = i + 1                 End If             Next</code> in my code, but I didn&#39;t realise I had to specify it to that degree haha."}], "tags": [], "owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "is_accepted": true, "score": 1, "last_activity_date": 1452893553, "creation_date": 1452893553, "answer_id": 34820198, "question_id": 34770955, "link": "https://stackoverflow.com/questions/34770955/cycling-through-list-of-urls-using-excel-vba/34820198#34820198", "title": "Cycling Through List of URLs Using Excel VBA", "body": "<p>OK Ill start with the proper syntax for you to get your code going and I will edit this answer for further code</p>\n\n<pre><code>Sub Sample()\n\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\nApplication.EnableEvents = True\n\nDim wsSheet As Worksheet, Rows As Long, links As Variant, IE As Object, link As Variant\nSet wb = ThisWorkbook\nSet wsSheet = wb.Sheets(\"Sheet1\")\n\nSet IE = New InternetExplorer\n\nRows = wsSheet.Cells(wsSheet.Rows.Count, \"A\").End(xlUp).Row\nlinks = wsSheet.Range(\"A1:A\" &amp; Rows)\n\nWith IE\n    .Visible = True\n    For Each link In links\n        .navigate (link)\n        While .Busy Or .ReadyState &lt;&gt; 4: DoEvents: Wend\n        MsgBox .Document.body.innerText\n    Next link\nEnd With\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>This will get you looping I think you had some general syntax issues which you can see the difference in my code in order to loop through in the for each the link has to be of type object or variant and links I set to variant assuming it will default to a string</p>\n"}], "owner": {"reputation": 71, "user_id": 5464388, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7128c2ae07f9473e89a2682142c28eca?s=128&d=identicon&r=PG&f=1", "display_name": "Tak", "link": "https://stackoverflow.com/users/5464388/tak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2380, "favorite_count": 0, "accepted_answer_id": 34820198, "answer_count": 1, "score": 1, "last_activity_date": 1452893553, "creation_date": 1452699910, "last_edit_date": 1452701020, "question_id": 34770955, "link": "https://stackoverflow.com/questions/34770955/cycling-through-list-of-urls-using-excel-vba", "title": "Cycling Through List of URLs Using Excel VBA", "body": "<p>I am much more familiar with Excel now, but one thing is still baffling me - how to cycle through URLs in a loop. My current conundrum is that I have this list of URLs of packages, and need to obtain the status of each package on each page using its HTML. What I currently have to cycle through the list is:</p>\n\n<pre><code>Sub TrackingDeliveryStatusResults()\n\nDim IE As Object\nDim URL As Range\nDim wb1 As Workbook, ws1 As Worksheet\n\nDim filterRange As Range\nDim copyRange As Range\nDim lastRow As Long\n\nSet wb1 = Application.Workbooks.Open(\"\\\\S51\\******\\Folders\\******\\TrackingDeliveryStatus.xls\")\nSet ws1 = wb1.Worksheets(\"TrackingDeliveryStatusResults\")\n\nSet IE = New InternetExplorer\n\nWith IE\n    .Visible = True\n    For Each URL In Range(\"C2:C &amp; lastRow\")\n        .Navigate URL.Value\n        While .Busy Or .ReadyState &lt;&gt; 4: DoEvents: Wend\n        MsgBox .Document.body.innerText\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>And the list of URLs <a href=\"https://i.stack.imgur.com/Pd4yK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pd4yK.png\" alt=\"enter image description here\"></a></p>\n\n<p>My goal here is:</p>\n\n<ul>\n<li>Cycle through each URL (inserts URL in IE and keeps going without opening new tabs)</li>\n<li>Obtain the status of the item for each URL from the HTML element</li>\n<li>FedEx: Delivered (td class=\"status\")</li>\n<li>UPS:  Delivered (id=\"tt_spStatus\")</li>\n<li>USPS: Arrived at USPS Facility (class= \"info-text first)</li>\n<li>Finish the loop and save as a csv if at all possible (I've already done that, so I'm just posting the code portion I'm having a problem with).</li>\n</ul>\n\n<p>My understanding is that I have to code a different if statement for each different url, since all of them have different HTML tags for their delivery status. Loops are simple, but to loop through webpages is new to me. The code has been throwing me errors no matter what changes I make. </p>\n\n<p>The IE object opens up but then Excel hits an error and the code stops running.\n<a href=\"https://i.stack.imgur.com/MDjXR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MDjXR.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1452700309, "post_id": 34770811, "comment_id": 57287070, "body": "Where&#39;s your <code>SortFields.Clear</code> and <code>Sort.Apply</code>?"}, {"owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "reply_to_user": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1452700730, "post_id": 34770811, "comment_id": 57287406, "body": "I dont think either of those things are relevant the sort happens just moves the header and does not do a ascending sort"}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1452701290, "post_id": 34770811, "comment_id": 57287816, "body": "What&#39;s the value of SG2Count before doing the sort?"}], "owner": {"reputation": 732, "user_id": 4854766, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/da0d92a989793b4a9f7fa9fd56b2cbb7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cowan", "link": "https://stackoverflow.com/users/4854766/tyler-cowan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452702372, "creation_date": 1452699565, "last_edit_date": 1452702372, "question_id": 34770811, "link": "https://stackoverflow.com/questions/34770811/vba-sort-method", "title": "VBA Sort Method", "body": "<p>This method used to work and now does not.</p>\n\n<pre><code>Dim wb As Workbook\nSet wb = ThisWorkbook\nDim calledSheet As String\ncalledSheet = wb.ActiveSheet.Name\n\nDim wsDataLoad As Worksheet, wsCheck As Worksheet\n\nSet wsDataLoad = wb.Sheets(\"DataLoad\")\nSet wsCheck = wb.Sheets(\"Curve Check\")\n\nDim i As Long, Rows As Long\nRows = wsDataLoad.Cells(wsDataLoad.Rows.Count, \"A\").End(xlUp).Row\n\nwsCheck.Range(\"XEI1:XEO10000\").Clear\n\n'Find Unique Sub group 2 Entries\nDim dicSG2 As Object, SG2 As Variant\nSet dicSG2 = CreateObject(\"Scripting.Dictionary\")\nSG2 = wsDataLoad.Range(\"AD2:AD\" &amp; Rows)\nFor i = 1 To UBound(SG2, 1)\n  dicSG2(SG2(i, 1)) = 1\nNext i\n\n'Unique Sub Group 2\nDim SG2Count As Long\nwsCheck.Range(\"XEK1\").Value = \"SubGroup 2\"\nwsCheck.Range(\"XEK2\").Resize(dicSG2.Count) = Application.Transpose(dicSG2.Keys)\nSG2Count = dicSG2.Count + 1\nwb.Names(\"SubGroup2\").RefersTo = \"='Curve Check'!$XEK$2:$XEK$\" &amp; SG2Count\nwsCheck.Range(\"XEK2:XEK\" &amp; SG2Count).Sort Key1:=wsCheck.Columns(\"XEK\"), Order1:=xlAscending, Header:=xlNo, Orientation:=xlTopToBottom, MatchCase:=False, SortMethod:=xlPinYin\n</code></pre>\n\n<p>For the life of me I cannot sort data properly anymore, my header always gets sorted in xlYes xlNo or xlGuess for header and even if I drop my header and paste the data into row 1 instead of 2 I cant get a sort. sometimes using numbers this will work but seems very unreliable</p>\n\n<p>I am using excel 2013 was previously running excel 2010</p>\n\n<p>I should also mention when the range in question is full of numbers this works and that this method does not seem to work on text</p>\n"}, {"tags": ["excel", "excel-formula", "vlookup", "vba"], "comments": [{"owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "edited": false, "score": 0, "creation_date": 1452698404, "post_id": 34770226, "comment_id": 57285552, "body": "@ScottCraner I created another post as suggested. thank you Scott"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1452698565, "post_id": 34770226, "comment_id": 57285667, "body": "You question es vague, please can you explain in more detail what you did, and you want, and if you want a formula or VBA code."}, {"owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "reply_to_user": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1452699990, "post_id": 34770226, "comment_id": 57286808, "body": "whenever a &quot;means of transport&quot; is selected from a drop down list under L:19 to L:24, I want the related hours to be added to each trip number. For instance, trip number 1 on raw 19 &amp; 20 has &quot;train - standard premium, semi flexible&quot; twice which is 2 x 0.5hour according to the table above so D48=1. I hope this makes sense"}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "edited": false, "score": 0, "creation_date": 1452705948, "post_id": 34770226, "comment_id": 57291309, "body": "And how you relate the contries and cities??? In a hidden cells??? Which city is the reference? Column B or column F?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1452711443, "post_id": 34770226, "comment_id": 57294783, "body": "I assume you have the above list of means of transport somewhere in the workbook.  Could you give that reference?  We will need that reference to build any type of formula."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1452714438, "last_edit_date": 1452714438, "creation_date": 1452711978, "answer_id": 34775009, "question_id": 34770226, "link": "https://stackoverflow.com/questions/34770226/complicated-formula-for-a-user-form-2/34775009#34775009", "title": "Complicated formula for a user form (2)", "body": "<p>The easiest way is to put a helper column in P, this can be hidden.  In this column you would use a vlookup to your table of \"Means of Transportation\".  So if your lookup table is on sheet2 in A1:B11 then in P19 on your user form put</p>\n\n<pre><code>=VLOOKUP(L19,'Sheet2'!$A$1:$B$11,2,False)\n</code></pre>\n\n<p>And copy down.</p>\n\n<p>Then in D48 use A simple SumIf() function:</p>\n\n<pre><code>=SUMIF($A$19:$A$24,A48,$P$19:$P$24)\n</code></pre>\n\n<p>And copy down</p>\n\n<p>This should give you the results you are looking for.</p>\n\n<p>Or If you want one formula to do it all then use the following Array Formula:</p>\n\n<pre><code>=SUMPRODUCT(SUMIFS('Sheet2'!$B$1:$B$11,'Sheet2'!$A$1:$A$11,$L$19:$L$24)*($A$19:$A$24=A48))\n</code></pre>\n\n<p>Put in D48, Hit Ctrl-Shift-Enter.  Then copy down.</p>\n"}], "owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 34775009, "answer_count": 1, "score": 0, "last_activity_date": 1452714438, "creation_date": 1452697996, "last_edit_date": 1531161705, "question_id": 34770226, "link": "https://stackoverflow.com/questions/34770226/complicated-formula-for-a-user-form-2", "title": "Complicated formula for a user form (2)", "body": "<p>I am working on a user form where I need to find a way to add a certain amount of \"additional hours\" (<code>D:48 to D:51</code>) based on the \"means of transport\" (<code>L:19 to L:24</code>) selected by the user. </p>\n\n<p><a href=\"https://i.stack.imgur.com/AhmGT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AhmGT.png\" alt=\"enter image description here\"></a></p>\n\n<p>please note that <code>L:19</code> to <code>L:24</code> has a drop down list of type of transport as listed below. Each trip number (1 to 4) has to have its own time added (<code>D:48</code> to <code>D:51</code>). The amount of time to be added per \"means of transport\" type is as follows: </p>\n\n<p><a href=\"https://i.stack.imgur.com/7GXTv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7GXTv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Many thanks in advance\nAbe</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452697814, "post_id": 34770041, "comment_id": 57285075, "body": "The error you&#39;re getting &quot;runtime error 9 - subscript out of range&quot; on line <code>LastRow1 = Sheets(&quot;PrevSheet&quot;).Range(&quot;PrevMonth&quot;).Rows.Count</code> means that your workbook doesn&#39;t have a sheet named &quot;PrevSheet&quot; or that that sheet doesn&#39;t have a named range named &quot;PrevMonth&quot;.  Double check your sheet name and named range."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452697896, "post_id": 34770041, "comment_id": 57285138, "body": "It looks like instead of <code>Sheets(&quot;PrevSheet&quot;).Range(&quot;PrevMonth&quot;)</code> you might actually just want <code>PrevMonth</code>"}, {"owner": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452697936, "post_id": 34770041, "comment_id": 57285172, "body": "Thanks tigeravatar, I&#39;ve defined PrevSheet further up in the code as follows; &quot;PrevSheet = ActiveSheet.Name"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452698020, "post_id": 34770041, "comment_id": 57285236, "body": "Right, you&#39;ve defined <code>the worksheet variable PrevSheet</code> but then you simply use a string with <code>Sheets(&quot;PrevSheet&quot;)</code>.  When it&#39;s a literal string like that, you&#39;re not referencing a predefined variable, you&#39;re telling Excel to look for a worksheet <i>actually named</i> &quot;PrevSheet&quot;"}, {"owner": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452698101, "post_id": 34770041, "comment_id": 57285300, "body": "so should i drop the &quot;Sheets(&quot;PrevSheet&quot;) entry and just use LastRow1 = Range(&quot;PrevMonth&quot;).Rows.Count?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452698192, "post_id": 34770041, "comment_id": 57285361, "body": "You should drop all of that and simply use <code>PrevMonth.Rows.Count</code> so that you&#39;re using the defined range variable <code>PrevMonth</code>.  Using <code>Range(&quot;PrevMonth&quot;)</code> is telling Excel to look for a <b>named range</b> <i>actually named</i> &quot;PrevMonth&quot; instead of using the defined variable."}, {"owner": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452763064, "post_id": 34770041, "comment_id": 57315258, "body": "Thanks again @tigeravatar. Sorry but its now failing on the &#39;If Sheets(CurSheet).Range(&quot;A&quot; &amp; sRow).Value = Sheets(PrevSheet).Cells(&quot;A&quot; &amp; sRow).Value Then&#39; statement with the error &quot;Runtime error 5 - Invalid procedure call or argument&quot;"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452783342, "post_id": 34770041, "comment_id": 57328625, "body": "That&#39;s because you use <code>Range(&quot;A&quot; &amp; sRow)</code> for one and <code>Cells(&quot;A&quot; &amp; sRow)</code> for the other.  They both need to be <code>Range</code> with that syntax."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "edited": false, "score": 0, "creation_date": 1452699396, "post_id": 34770470, "comment_id": 57286294, "body": "Thanks Jordan but it bombs out with &quot;Run-time error 91 - Object variable or With block variable not set&quot; on the line &quot;TempVal = Sheets(PrevSheet).Range(&quot;H&quot; &amp; sRow &amp; &quot;:N&quot; &amp; sRow)&quot; when I use the F8 button to step through the code"}, {"owner": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "edited": false, "score": 0, "creation_date": 1452701782, "post_id": 34770470, "comment_id": 57288182, "body": "Apologies Jordan. I&#39;ve now set the Tempval as a Variant and it now fails with &quot;Run-time error 5 - Invalid procedure call or argument on the &quot;If Sheets(CurSheet).Range(&quot;A&quot; &amp; sRow).Value = Sheets(PrevSheet).Cells(&quot;A&quot; &amp; sRow).Value Then&quot; statement"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "edited": false, "score": 0, "creation_date": 1452768886, "post_id": 34770470, "comment_id": 57318976, "body": "Sorry, the line should have been <code>If Sheets(CurSheet).Range(&quot;A&quot; &amp; sRow).Value = Sheets(PrevSheet).Range(&quot;A&quot; &amp; sRow).Value Then</code> - this has been amended in the answer now. It previously referred to <code>Cells(&quot;A&quot; &amp; sRow).Value</code> instead of <code>Range(&quot;A&quot; &amp; sRow).Value</code>"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "edited": false, "score": 0, "creation_date": 1452769073, "post_id": 34770470, "comment_id": 57319107, "body": "Also, this code will only work if <code>PrevSheet</code> and <code>CurSheet</code> are formatted in the same way e.g. the &quot;Account Numbers&quot; referred to in your question are all in the same rows on both worksheets."}, {"owner": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "edited": false, "score": 0, "creation_date": 1452770891, "post_id": 34770470, "comment_id": 57320187, "body": "Thanks Jordan, the macro now runs through without errors but nothing is copied from PrevSheet to CurSheet. Sorry to be such a pain."}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "edited": false, "score": 0, "creation_date": 1452773306, "post_id": 34770470, "comment_id": 57321718, "body": "It seems to be working for me, I&#39;ve added in <code>.End(xlup)</code> to the <code>LastRow1</code> line; maybe try it now? It&#39;s a lot slower to copy and paste the values so in an attempt to avoid this it would be better to set the data as is done in this function."}, {"owner": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "edited": false, "score": 0, "creation_date": 1452782312, "post_id": 34770470, "comment_id": 57327807, "body": "Hi Jordan, your comment &quot;this code will only work if PrevSheet and CurSheet are formatted in the same way e.g. the &quot;Account Numbers&quot; referred to in your question are all in the same rows on both worksheets&quot;. This will never be true for me as new accounts can appear in next months data and some accounts will be deleted from next months data. Since my first loop works can an ElseIf statement be put in to copy the H:N rows?"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "edited": false, "score": 0, "creation_date": 1452790200, "post_id": 34770470, "comment_id": 57333620, "body": "I&#39;ll update the answer if they&#39;re going to be differently formatted; try the code now."}], "tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": false, "score": 0, "last_activity_date": 1452790340, "last_edit_date": 1452790340, "creation_date": 1452698654, "answer_id": 34770470, "question_id": 34770041, "link": "https://stackoverflow.com/questions/34770041/compare-two-ranges-on-different-sheets-and-if-the-values-match-copy-range/34770470#34770470", "title": "Compare two ranges on different sheets and if the values match copy range", "body": "<p>Updated in order to look up the Account Numbers using <code>INDEX/MATCH</code> within VBA as the names of the worksheet names will be changing (I assume):</p>\n\n<pre><code>Dim PrevSheet, CurSheet As String\n\nPrevSheet = \"PrevSheet\"\nCurSheet = \"CurSheet\"\n\nCurEnd = Sheets(CurSheet).Cells(Rows.Count, 1).End(xlUp).Row\nPrevEnd = Sheets(PrevSheet).Cells(Rows.Count, 1).End(xlUp).Row\n\nFor sRow = 2 To CurEnd\nSheets(CurSheet).Range(\"H\" &amp; sRow).value = WorksheetFunction.Index(Sheets(PrevSheet).Range(\"H2:H\" &amp; PrevEnd), WorksheetFunction.Match(Sheets(CurSheet).Range(\"A\" &amp; sRow), Sheets(PrevSheet).Range(\"A2:A\" &amp; PrevEnd), 0))\nSheets(CurSheet).Range(\"I\" &amp; sRow).value = WorksheetFunction.Index(Sheets(PrevSheet).Range(\"I2:I\" &amp; PrevEnd), WorksheetFunction.Match(Sheets(CurSheet).Range(\"A\" &amp; sRow), Sheets(PrevSheet).Range(\"A2:A\" &amp; PrevEnd), 0))\nSheets(CurSheet).Range(\"J\" &amp; sRow).value = WorksheetFunction.Index(Sheets(PrevSheet).Range(\"J2:J\" &amp; PrevEnd), WorksheetFunction.Match(Sheets(CurSheet).Range(\"A\" &amp; sRow), Sheets(PrevSheet).Range(\"A2:A\" &amp; PrevEnd), 0))\nSheets(CurSheet).Range(\"K\" &amp; sRow).value = WorksheetFunction.Index(Sheets(PrevSheet).Range(\"K2:K\" &amp; PrevEnd), WorksheetFunction.Match(Sheets(CurSheet).Range(\"A\" &amp; sRow), Sheets(PrevSheet).Range(\"A2:A\" &amp; PrevEnd), 0))\nSheets(CurSheet).Range(\"L\" &amp; sRow).value = WorksheetFunction.Index(Sheets(PrevSheet).Range(\"L2:L\" &amp; PrevEnd), WorksheetFunction.Match(Sheets(CurSheet).Range(\"A\" &amp; sRow), Sheets(PrevSheet).Range(\"A2:A\" &amp; PrevEnd), 0))\nSheets(CurSheet).Range(\"M\" &amp; sRow).value = WorksheetFunction.Index(Sheets(PrevSheet).Range(\"M2:M\" &amp; PrevEnd), WorksheetFunction.Match(Sheets(CurSheet).Range(\"A\" &amp; sRow), Sheets(PrevSheet).Range(\"A2:A\" &amp; PrevEnd), 0))\nSheets(CurSheet).Range(\"N\" &amp; sRow).value = WorksheetFunction.Index(Sheets(PrevSheet).Range(\"N2:N\" &amp; PrevEnd), WorksheetFunction.Match(Sheets(CurSheet).Range(\"A\" &amp; sRow), Sheets(PrevSheet).Range(\"A2:A\" &amp; PrevEnd), 0))\nNext sRow\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5784908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d20fbf7ef9c30dacc44358fda7b4550?s=128&d=identicon&r=PG&f=1", "display_name": "djk035", "link": "https://stackoverflow.com/users/5784908/djk035"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1021, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452952138, "creation_date": 1452697500, "last_edit_date": 1531161705, "question_id": 34770041, "link": "https://stackoverflow.com/questions/34770041/compare-two-ranges-on-different-sheets-and-if-the-values-match-copy-range", "title": "Compare two ranges on different sheets and if the values match copy range", "body": "<p>I have two sheets (Current Month and Previous Month) with approx 4000 different account numbers and details in each row. The account numbers are compared and if an account number in the Current Month sheet is not in the Previous Months sheet it is highlighted in yellow. THIS PART WORKS FOR ME IN THE CODE BELOW. </p>\n\n<p>The part that I cannot get to work. If the account numbers match, copy columns H to N for that matching account number from the Previous Month sheet to columns H to N in the current months sheet. I'm getting Runtime error 9 - subscript out of range, when I'm trying to define the LastRow variable but I'm also not sure if the loop below that error will work either. </p>\n\n<p>Here is the code;</p>\n\n<pre><code>Sub RangeCompare()\n'   The range Previous Month is the baseline so if the range Current Month has a value that is not in the Previous Month it is highlighted\n'   If the Previous Month range has a value that is in Current Month then copy Previous Months columns H to N to Current Month columns H to N\n'   ACCOUNT NUMBERS SELECTED MUST BE IN COLUMN A, IF NOT THE COPY/PASTE WILL NOT WORK!\n\n'   Warning to the end user that column A must contain the Account Numbers or this will cause the copy part of the macro to fail\n    MsgBox \"!! Column A must contain the Account Numbers !!\"\n\n    Dim PrevMonth As Range, CurMonth As Range, c As Range, TempVal As Range\n    Dim CurSheet As String, PrevSheet As String\n    Dim LastRow1 As Long\n\n    Set PrevMonth = Application.InputBox(\"Select appropriate sheet and all accounts:\", Title:=\"Select Previous Months Accounts\", Type:=8)\n'    next variable needed so VBA knows what the Previous worksheet name is, this is needed for the copying section of the macro\n    PrevSheet = ActiveSheet.Name\n    If PrevMonth Is Nothing Then\n        MsgBox \"No range selected. Ending program...\"\n        Exit Sub\n    End If\n\n    Set CurMonth = Application.InputBox(\"Select appropriate sheet and all accounts:\", Title:=\"Select Current Months Accounts\", Type:=8)\n    ' next variable needed so VBA knows what the Current worksheet name is, this is needed for the copying section of the macro\n    CurSheet = ActiveSheet.Name\n    LastRow2 = Selection.Rows.Count\n    If CurMonth Is Nothing Then\n        MsgBox \"No range selected. Ending program...\"\n        Exit Sub\n    End If\n\n\n'   Highlight cells not in PrevMonth to yellow Colorindex = 6\n'   This loop works :-)\n    For Each c In CurMonth.Cells\n        If Application.WorksheetFunction.CountIf(PrevMonth, c.Value) = 0 Then\n            c.Interior.ColorIndex = 6\n        End If\n    Next c\n\n'    Copy columns H:N from previous month sheet to H:N in current months sheet if Account numbers match\n\n   LastRow1 = Sheets(\"PrevSheet\").Range(\"PrevMonth\").Rows.Count\n'  The above gives runtime error 9 - subscript out of range\n'  I don't know if the loop below will work as I can't define LastRow1 due to the error above.\n    For sRow = 2 To LastRow1\n        TempVal = Sheets(PrevSheet).Range(sRow, \"H\").Range(sRow, \"N\")\n             If Sheets(\"CurSheet\").Cells(sRow, 1).Text = Sheets(\"PrevSheet\").Cells(sRow, 1).Text Then\n                    Sheets(CurSheet).Range(sRow, \"H\").Range(sRow, \"N\") = TempVal\n             End If\n    Next sRow\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 5, "user_id": 5784786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4f37b426774668ce2ed6564f5db224?s=128&d=identicon&r=PG&f=1", "display_name": "gde211", "link": "https://stackoverflow.com/users/5784786/gde211"}, "edited": false, "score": 0, "creation_date": 1452697259, "post_id": 34769841, "comment_id": 57284646, "body": "Appologies, I left out a critical part. I am getting &#39;Type Mismatch&#39; error at &quot;Call move(lbINDX, lbSource, lbDest)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452700275, "post_id": 34769841, "comment_id": 57287037, "body": "The 1st var, itm needs to be long <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193579.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff193579.aspx</a> itm also needs to be like Index:=itm"}, {"owner": {"reputation": 5, "user_id": 5784786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4f37b426774668ce2ed6564f5db224?s=128&d=identicon&r=PG&f=1", "display_name": "gde211", "link": "https://stackoverflow.com/users/5784786/gde211"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452701134, "post_id": 34769841, "comment_id": 57287690, "body": "@Nathan_Sav got the &#39;long&#39; part although im not sure why, but the &#39;like Index:=itm&#39; is throwing me off. Where would this go? in the module or userform sub?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452701275, "post_id": 34769841, "comment_id": 57287803, "body": "No, where you have removeitem item=itm, should be removeitem index=itm, i believe <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194439.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff194439.aspx</a>"}, {"owner": {"reputation": 5, "user_id": 5784786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4f37b426774668ce2ed6564f5db224?s=128&d=identicon&r=PG&f=1", "display_name": "gde211", "link": "https://stackoverflow.com/users/5784786/gde211"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452702360, "post_id": 34769841, "comment_id": 57288633, "body": "just saw your item vs index comment. changed that but same error... its not even getting that far. (type mismatch @ Call move(blah, blah,blah). Also, to be noted that when i hover over me.listbox# its returning a string for the selected value in the listbox not the listbox itself."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452702561, "post_id": 34769841, "comment_id": 57288781, "body": "Can you try renaming the function to something else, like MoveEntry"}, {"owner": {"reputation": 5, "user_id": 5784786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4f37b426774668ce2ed6564f5db224?s=128&d=identicon&r=PG&f=1", "display_name": "gde211", "link": "https://stackoverflow.com/users/5784786/gde211"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452702952, "post_id": 34769841, "comment_id": 57289097, "body": "sub or function not defined.... had to include module1.MoveEntry(). after that it actually made it to the module!!!!!!!!!!  small step for code... giant step for hair regrowth on my scalp. highlighting &quot;Index:=&quot; &#39;Named arguement not found&#39; trying item:="}, {"owner": {"reputation": 5, "user_id": 5784786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4f37b426774668ce2ed6564f5db224?s=128&d=identicon&r=PG&f=1", "display_name": "gde211", "link": "https://stackoverflow.com/users/5784786/gde211"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452702984, "post_id": 34769841, "comment_id": 57289132, "body": "that didnt work either"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 0, "last_activity_date": 1452701200, "creation_date": 1452701200, "answer_id": 34771447, "question_id": 34769841, "link": "https://stackoverflow.com/questions/34769841/excel-vba-listbox-variable-type-miss-match/34771447#34771447", "title": "excel vba listbox variable type miss match", "body": "<p>I would do like this, not tested</p>\n\n<pre><code>Public Sub MoveEntry(cboSource As MSForms.ComboBox, cboDestination As MSForms.ComboBox, lngIndex As Long)\n    cboDestination.AddItem cboSource.ListIndex(lngIndex).Text\n    cboSource.RemoveItem Index:=lngIndex\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 5784786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4f37b426774668ce2ed6564f5db224?s=128&d=identicon&r=PG&f=1", "display_name": "gde211", "link": "https://stackoverflow.com/users/5784786/gde211"}, "is_accepted": false, "score": 0, "last_activity_date": 1452707745, "creation_date": 1452707745, "answer_id": 34773698, "question_id": 34769841, "link": "https://stackoverflow.com/questions/34769841/excel-vba-listbox-variable-type-miss-match/34773698#34773698", "title": "excel vba listbox variable type miss match", "body": "<p>After some help from Nathan_Sav and some further tinkering I have arrived at the following. Although it does what I needed, it's not quite finished as it adds the value to the bottom of the destination listbox, regardless of how many blank (\"\" or null or whatever) values there are.</p>\n\n<p>In Userform</p>\n\n<pre><code>Private Sub CommandButton7_Click()\nDim lbINDX As Long\nDim lbSource As MSForms.ListBox, lbDest As MSForms.ListBox\n\nlbINDX = ListBox3.ListIndex\nSet lbSource = Me.ListBox3\nSet lbDest = Me.ListBox1\nCall Module1.MoveEntry(lbINDX, lbSource, lbDest)\n\nEnd Sub\n</code></pre>\n\n<p>In Module\n    Sub MoveEntry(lngIndex As Long, objSource As MSForms.ListBox, objDest As MSForms.ListBox)\nDim txt As String</p>\n\n<pre><code>MsgBox objSource.Name\ntxt = objSource.Value\nobjDest.AddItem txt\nobjSource.RemoveItem lngIndex\n\nEnd Sub\n</code></pre>\n\n<p>As it stands I am only allowing one value to be transferred at the time. I suspect that if the listbox were multiselect, there would need to be further modifications.</p>\n\n<p>Thank you very much Nathan for your help.</p>\n\n<p>If someone can please explain why this worked but the other attempts did not please post an answer so I may make it as answered.</p>\n"}], "owner": {"reputation": 5, "user_id": 5784786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be4f37b426774668ce2ed6564f5db224?s=128&d=identicon&r=PG&f=1", "display_name": "gde211", "link": "https://stackoverflow.com/users/5784786/gde211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "accepted_answer_id": 34771447, "answer_count": 2, "score": 0, "last_activity_date": 1452707745, "creation_date": 1452696979, "last_edit_date": 1452702161, "question_id": 34769841, "link": "https://stackoverflow.com/questions/34769841/excel-vba-listbox-variable-type-miss-match", "title": "excel vba listbox variable type miss match", "body": "<p>I've been struggling for a while now with passing a listbox to a sub. After 3 days of searching... i need help. My ultimate goal is to select item in one listbox then click button and have it move to another listbox. Here's what I've tried so far.</p>\n\n<p>In UserForm:</p>\n\n<pre><code>Private Sub CommandButton7_Click()\nDim lbINDX As Integer\nDim lbSource As String, lbDest As String\n\nlbINDX = ListBox3.ListIndex\nlbSource = Me.ListBox3.Name\nlbDest = Me.ListBox1.Name\nCall move(lbINDX, lbSource, lbDest)\n\nEnd Sub\n</code></pre>\n\n<p>In Userform sub I've also tried: (without .name) lbSource &amp; lbDest as object, control, listbox, and msforms.listbox</p>\n\n<p>In Module:</p>\n\n<pre><code>Private Sub move(itm As Integer, objTarget As String, objDest As String)\n\ntxt = objTarget.ListIndex(itm).Text\nUserForm10.Controls(objTarget).RemoveItem Item:=itm\nUserForm10.Controls(objDest).AddItem txt\n\nEnd Sub\n</code></pre>\n\n<p>In Module sub I've also tried: (with and without Userform10.Controls()) objTarget &amp; objDest as object, control, listbox, and msforms.listbox</p>\n\n<p>How do I pass the listbox as a whole through a variable? Or is there an easier way?</p>\n\n<p>Revision 1 in response to Nathan_Sav:</p>\n\n<pre><code>Private Sub CommandButton7_Click()\nDim lbINDX As Long\nDim lbSource As MSForms.ListBox, lbDest As MSForms.ListBox\n\nlbINDX = ListBox3.ListIndex\nSet lbSource = Me.ListBox3\nSet lbDest = Me.ListBox1\nCall move(lbINDX, lbSource, lbDest)\n\nEnd Sub\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Private Sub move(lngIndex As Long, objSource As MSForms.ListBox, objDest As MSForms.ListBox)\n\nobjDest.AddItem objSource.ListIndex(lngIndex).Text\nobjSource.RemoveItem Item:=lngIndex\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1452704327, "post_id": 34769763, "comment_id": 57290216, "body": "Well, in each instance the cells have to contain one of those values. @A.S.H Pray tell, no need to be snide about it."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1452704424, "post_id": 34769763, "comment_id": 57290296, "body": "But do all three have to contain the <b>same</b> one, or is it ok if say M44 and N44 have &quot;MDO&quot; and O44 has &quot;MDO M/E&quot;?"}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1452705364, "post_id": 34769763, "comment_id": 57290927, "body": "The cells must contain any of the stipulated arguments, your example is exactly what I want. Thank you for the <code>WorksheetFunction.Sum</code> I have updated that part."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1452707092, "post_id": 34769763, "comment_id": 57292035, "body": "@BOB I did not mean to offend at all, but to notify Rory so probably he could complete his answer. Anyway, what puzzled me most in your OP was the sentence <i>&quot;So, the cells that are expected to contain the sum are simply blank&quot;</i>. In fact, your code should not compile in the first place, and that left me wondering with the &quot;too many&quot; feeling :)"}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1452708263, "post_id": 34769763, "comment_id": 57292754, "body": "@A.S.H Funnily enough, it did compile. However, it did not do anything that I could discern."}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1452710157, "post_id": 34769763, "comment_id": 57293908, "body": "@Rory I have integrated the new If formulation you suggested. However, the values returned remain blank. I also put a watch on both <code>MDOConsumed</code> and <code>HFOConsumed</code> they both indicate that they are Empty, so the code isn&#39;t even running throw otherwise it would be <code>&quot;0&quot;</code>...?"}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1452788761, "post_id": 34769763, "comment_id": 57332611, "body": "@Rory I have updated the question to reflect the current situation and results I am getting."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1452789180, "post_id": 34769763, "comment_id": 57332905, "body": "Syntax still wrong. <code>If .Cells(&quot;M44&quot;) = &quot;HFO 380&quot; Or &quot;HFO 180&quot; Or &quot;HFO 60&quot; Then</code> must be <code>If .Cells(&quot;M44&quot;) = &quot;HFO 380&quot; Or .Cells(&quot;M44&quot;) = &quot;HFO 180&quot; Or .Cells(&quot;M44&quot;) = &quot;HFO 60&quot; Then</code> and so on."}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1452791484, "post_id": 34769763, "comment_id": 57334535, "body": "I have updated the question with your suggestion the code still executes and returns the wrong values. It seems as if the if statement doesn&#39;t even check the real value of <code>cells(&quot;M44&quot;)</code>. Because it always returns that segment as <code>True</code>."}, {"owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "edited": false, "score": 0, "creation_date": 1452801163, "post_id": 34769763, "comment_id": 57340080, "body": "I ended changing for a <code>select case</code> function, thanks all the same!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1452697960, "last_edit_date": 1452697960, "creation_date": 1452696804, "answer_id": 34769763, "question_id": 34769478, "link": "https://stackoverflow.com/questions/34769478/excel-vba-if-statement-runs-without-checking-and-validating-the-right-values/34769763#34769763", "title": "Excel-VBA if statement runs without checking and validating the right values", "body": "<p>Your syntax is wrong, I'm afraid. This:</p>\n\n<pre><code>If .Range(\"M44\") And .Range(\"N44\") And .Range(\"O44\") = \"MDO\" Or \"MDO M/E\" Then\n</code></pre>\n\n<p>has to be broken out specifically - something like:</p>\n\n<pre><code>If (.Range(\"M44\").Value = \"MDO\" Or .Range(\"M44\").Value = \"MDO M/E\") And (.Range(\"N44\").Value = \"MDO\" Or .Range(\"N44\").Value = \"MDO M/E\") And (.Range(\"O44\").Value = \"MDO\" Or .Range(\"O44\").Value = \"MDO M/E\") Then\n</code></pre>\n\n<p>depending on whether all three cells have to contain the same one of those two values, or they just have to all contain one of the two values.</p>\n\n<p>Also, note that it's <code>WorksheetFunction.Sum</code> and not <code>Worksheet.Function.Sum</code> so your <code>.Function.Sum</code> won't work.</p>\n"}], "owner": {"reputation": 131, "user_id": 4474426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bb708eb36e9a1011f5bda82ca4277f02?s=128&d=identicon&r=PG&f=1", "display_name": "BOB", "link": "https://stackoverflow.com/users/4474426/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452791344, "creation_date": 1452696064, "last_edit_date": 1531164843, "question_id": 34769478, "link": "https://stackoverflow.com/questions/34769478/excel-vba-if-statement-runs-without-checking-and-validating-the-right-values", "title": "Excel-VBA if statement runs without checking and validating the right values", "body": "<p>I have little snippet of code which is supposed to extract the value of a few cells if their headers correspond to certain categories. The variables are private. However, the code runs and selects the first if statement and sets it to true EVEN IF the header is not \"HFO 360\" or \"HFO 180\" or \"HFO 60\".</p>\n\n<pre><code>Option Explicit\nOption Base 1\n\nSub_Consumption()    \nDim HFOConsumed, HFORemaining, MDOConsumed, MDORemaining As Double\n\nWith Activesheet\n\nHFOConsumed = 0\nHFORemaining = 0\nMDOConsumed = 0\nMDORemaining = 0\n\nIf .Cells(\"M44\") = \"HFO 380\" Or .Cells(\"M44\") = \"HFO 180\" Or .Cells(\"M44\") = \"HFO 60\" Then\n    HFOConsumed = .Range(\"M45\").Value\n    HFORemaining = .Range(\"M46\").Value\nElseIf .Cells(\"N44\") = \"HFO 380\" Or .Cells(\"N44\") = \"HFO 180\" Or .Cells(\"N44\") = \"HFO 60\" Then\n    HFOConsumed = .Range(\"N45\").Value\n    HFORemaining = .Range(\"N46\").Value\nElseIf .Cells(\"O44\") = \"HFO 380\" Or .Cells(\"O44\") = \"HFO 180\" Or .Cells(\"O44\") = \"HFO 60\" Then\n    HFOConsumed = .Range(\"O45\").Value\n    HFORemaining = .Range(\"O46\").Value\nElse\n    HFOConsumed = 0\n    HFORemaining = 0\nEnd If\n\n.Range(\"P45\") = HFOConsumed\n.Range(\"P46\") = HFORemaining\n\n\nIf .Cells(\"M44\") = \"MDO\" Or .Cells(\"M44\") = \"MDO M/E\" Then\n    MDOConsumed = .Range(\"M45\").Value\n    MDORemaining = .Range(\"M46\").Value\nElseIf .Cells(\"M44\") = \"MDO\" Or .Cells(\"M44\") = \"MDO M/E\" Then\n    MDOConsumed = .Range(\"N45\").Value\n    MDORemaining = .Range(\"N46\").Value\nElseIf .Cells(\"M44\") = \"MDO\" Or .Cells(\"M44\") = \"MDO M/E\" Then\n    MDOConsumed = .Range(\"O45\").Value\n    MDORemaining = .Range(\"O46\").Value\nElse\n    MDOConsumed = 0\n    MDORemaining = 0\nEnd If\n\n.Range(\"Q45\") = MDOConsumed\n.Range(\"Q46\") = MDORemaining\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1452695116, "post_id": 34769047, "comment_id": 57283123, "body": "Record a macro: sort the data based on column G, then use the remove duplicates. The remove duplicates function will leave the highest value only, if you sort correctly."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1452695123, "post_id": 34769047, "comment_id": 57283128, "body": "Sort Descending on column G.  Then highlight the entire data set and go to Data &gt; Remove Duplicates.  Choose only column B. It will remove all the duplicates in column B leaving the highest value for each in column G"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1452695154, "post_id": 34769047, "comment_id": 57283154, "body": "@vacip beat me by 6 seconds"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1452695209, "post_id": 34769047, "comment_id": 57283193, "body": "@ScottCraner You are more thorough though :)"}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": false, "score": 0, "last_activity_date": 1452698293, "last_edit_date": 1452698293, "creation_date": 1452697283, "answer_id": 34769958, "question_id": 34769047, "link": "https://stackoverflow.com/questions/34769047/removing-duplicates-given-rows-value-vba/34769958#34769958", "title": "Removing duplicates given row&#39;s value VBA", "body": "<p>You can try this:</p>\n\n<pre><code>Sub test()\n\nDim i As Long, j As Long\nDim wb As Workbook, ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Sheet1\") ' Change the name of your sheet\n\nWith ws\n\ni = 1 ' Start at Row 1\n\n Do While Not IsEmpty(.Cells(i, 2))\n\nj = 1 ' Start at Row 1\n    Do While Not IsEmpty(.Cells(j, 2))\n\n    If i &lt;&gt; j Then\n\n        If .Cells(i, 2).Value = Cells(j, 2).Value Then\n\n                If .Cells(i, 7).Value &gt; Cells(j, 7) Then\n\n                    Rows(j).EntireRow.Delete\n                    j = j - 1\n                Else\n                    Rows(i).EntireRow.Delete\n                    If i &gt; 1 Then i = i - 1\n                    j = 1\n                End If\n        End If\n\n    End If\n\n    j = j + 1\n    Loop\n\ni = i + 1\nLoop\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5362017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t1SwB.jpg?s=128&g=1", "display_name": "Tom Pinder", "link": "https://stackoverflow.com/users/5362017/tom-pinder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452698293, "creation_date": 1452694778, "question_id": 34769047, "link": "https://stackoverflow.com/questions/34769047/removing-duplicates-given-rows-value-vba", "title": "Removing duplicates given row&#39;s value VBA", "body": "<p>I have a spreadsheet with thousands of rows and in column B there are numerous duplicates and then in column G there is that row's respective value. I need to remove the duplicates from column B, but leave in the row that has the highest value (i.e max column G). Is there a way to automate this via VBA as it'll need to be done on numerous occasions?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1452693075, "post_id": 34768355, "comment_id": 57281614, "body": "As far as I know, there is nowhere that lists all the many differences between Mac and Windows VBA for Excel, especially as it varies by version too."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 3706933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac293ec83c8afd50e3c17f733ef5e40f?s=128&d=identicon&r=PG&f=1", "display_name": "user3706933", "link": "https://stackoverflow.com/users/3706933/user3706933"}, "edited": false, "score": 0, "creation_date": 1452693946, "post_id": 34768597, "comment_id": 57282261, "body": "Thanks for the tip.  I had already seen that link.  The connection actually works (in Excel windows) and if I change .Name = &quot;Yahoo analyst estimates&quot; to .Name = False, the Macro continues but it stops again when it reaches the &quot;.web&quot; commands.  It appears that those are lines that need to be replaced with the right command for Excel for Mac."}, {"owner": {"reputation": 131, "user_id": 5707527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/048a713779556c4fbe54517afaf47c2f?s=128&d=identicon&r=PG&f=1", "display_name": "Joana Brand&#227;o", "link": "https://stackoverflow.com/users/5707527/joana-brand%c3%a3o"}, "reply_to_user": {"reputation": 21, "user_id": 3706933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac293ec83c8afd50e3c17f733ef5e40f?s=128&d=identicon&r=PG&f=1", "display_name": "user3706933", "link": "https://stackoverflow.com/users/3706933/user3706933"}, "edited": false, "score": 0, "creation_date": 1452695846, "post_id": 34768597, "comment_id": 57283620, "body": "Do you Already tried to make a macro to use QueryTables in Excel 2011 because it depends on versions . Try doing the same code with ListObject and see if work that way.  I make some code in vba on my computer that other do not work QueryTables, just ListObject."}, {"owner": {"reputation": 21, "user_id": 3706933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac293ec83c8afd50e3c17f733ef5e40f?s=128&d=identicon&r=PG&f=1", "display_name": "user3706933", "link": "https://stackoverflow.com/users/3706933/user3706933"}, "edited": false, "score": 0, "creation_date": 1452696865, "post_id": 34768597, "comment_id": 57284374, "body": "Not sure what ListObject command is but I&#39;ve made macros that use Query tables and they worked.  I just can&#39;t figure out this one.  Thanks for the tip."}, {"owner": {"reputation": 131, "user_id": 5707527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/048a713779556c4fbe54517afaf47c2f?s=128&d=identicon&r=PG&f=1", "display_name": "Joana Brand&#227;o", "link": "https://stackoverflow.com/users/5707527/joana-brand%c3%a3o"}, "reply_to_user": {"reputation": 21, "user_id": 3706933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac293ec83c8afd50e3c17f733ef5e40f?s=128&d=identicon&r=PG&f=1", "display_name": "user3706933", "link": "https://stackoverflow.com/users/3706933/user3706933"}, "edited": false, "score": 0, "creation_date": 1452698755, "post_id": 34768597, "comment_id": 57285793, "body": "ListObjet it&#39;s the same of QueryTables but don&#39;t have design, you can put after the make a table. The ListObject is compatible with all versions of Excel until now."}], "tags": [], "owner": {"reputation": 131, "user_id": 5707527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/048a713779556c4fbe54517afaf47c2f?s=128&d=identicon&r=PG&f=1", "display_name": "Joana Brand&#227;o", "link": "https://stackoverflow.com/users/5707527/joana-brand%c3%a3o"}, "is_accepted": false, "score": 0, "last_activity_date": 1452693457, "creation_date": 1452693457, "answer_id": 34768597, "question_id": 34768355, "link": "https://stackoverflow.com/questions/34768355/converting-a-macro-created-in-excel-2010-to-excel-mac-2011/34768597#34768597", "title": "Converting a Macro created in Excel 2010 to Excel Mac 2011", "body": "<p>The problem must be the connection and not the name of the QueryTable .\nTries to delete the connection and only then make the table .\nHere you have a link that can help you: \n<a href=\"http://www.dummies.com/how-to/content/using-a-web-query-to-load-tables-in-excel-2011-for.html\" rel=\"nofollow\">http://www.dummies.com/how-to/content/using-a-web-query-to-load-tables-in-excel-2011-for.html</a></p>\n"}], "owner": {"reputation": 21, "user_id": 3706933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac293ec83c8afd50e3c17f733ef5e40f?s=128&d=identicon&r=PG&f=1", "display_name": "user3706933", "link": "https://stackoverflow.com/users/3706933/user3706933"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452738752, "creation_date": 1452692806, "last_edit_date": 1531164843, "question_id": 34768355, "link": "https://stackoverflow.com/questions/34768355/converting-a-macro-created-in-excel-2010-to-excel-mac-2011", "title": "Converting a Macro created in Excel 2010 to Excel Mac 2011", "body": "<p>The macro below runs in Excel 2010, but in Excel for Mac 2011 I get an error on the .Web commands. Is there a list of commands for both the Windows version and the Mac version?</p>\n\n<p>The macro downloads financial data from stocks, which symbols listed in column H. The data of interest is in certain tables only, not all of them, so the command \".webtables\". This data is copied to another section of the spreadsheet, the data is cleared and it continues until the list of symbols is exhausted.</p>\n\n<p>Errors encountered:</p>\n\n<p>At the following line, the macro stops and Excel closes the workbook:</p>\n\n<pre><code>.Name = \"Yahoo analyst estimates\"\n</code></pre>\n\n<p>Changing above line to:</p>\n\n<pre><code>.Name = False\n</code></pre>\n\n<p>allows the macro to continue, but none of the \".web\" commands are interpreted.</p>\n\n<p>So my key issue is to find the list of \".web\" like commands for Excel for Mac 2011.</p>\n\n<pre><code>' Download_Yahoo_Metrics Macro\n' Downloads Tables for Analyst Estimates, Analyst Opinion and Key Statistics\n'\nDim ScrURL As String\n    lr = ActiveSheet.Cells(Rows.Count, \"H\").End(xlUp).Row 'delimits the last row\n    fr = ActiveSheet.Cells(1, \"C\") 'delimits the first row\n    For r = fr To lr\n    Range(\"B5:F53\").ClearContents 'clear previous\n    ScrURL = \"URL;http://finance.yahoo.com/q/ae?s=\" &amp; ActiveSheet.Cells(r, \"H\")\n'\n    With ActiveSheet.QueryTables.Add(Connection:=ScrURL, Destination:=Range(\"B5\"))\n    .Name = \"Yahoo analyst estimates\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = False\n    .RefreshPeriod = 0\n    .WebSelectionType = xlSpecifiedTables\n    .WebFormatting = xlWebFormattingNone\n    .WebTables = \"8,11,14,17,20,23\"\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = True\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\n  End With\n    With ActiveSheet\n      .Cells(r, \"i\") = .Range(\"C47\")\n      .Cells(r, \"j\") = .Range(\"D47\")\n      .Cells(r, \"k\") = .Range(\"F47\")\n      .Cells(r, \"l\") = .Range(\"C48\")\n      .Cells(r, \"m\") = .Range(\"C49\")\n      .Cells(r, \"n\") = .Range(\"D49\")\n      .Cells(r, \"o\") = .Range(\"F49\")\n    End With\n  Next\n    Range(\"A1\").Select\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error", "global"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1452692746, "post_id": 34768313, "comment_id": 57281395, "body": "Please format your code."}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1452692797, "post_id": 34768313, "comment_id": 57281433, "body": "What is the error message?"}, {"owner": {"reputation": 1, "user_id": 5784596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a3f084baff5d06aa8cae644d508443?s=128&d=identicon&r=PG&f=1", "display_name": "user5784596", "link": "https://stackoverflow.com/users/5784596/user5784596"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1452692917, "post_id": 34768313, "comment_id": 57281510, "body": "Might not have pasted right. This was my first post.."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 1, "creation_date": 1452693123, "post_id": 34768313, "comment_id": 57281652, "body": "Do you have a <code>UserForm_Initialize</code> sub-procedure, or any classes which use the events of this UserForm?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1452693188, "post_id": 34768313, "comment_id": 57281702, "body": "Please either add the code from the <code>Userform_Initialize</code> and/or <code>Userform_Activate</code> events from UF2, or change your VBE options to break in class modules, run the code again and then tell us the actual error line."}, {"owner": {"reputation": 1, "user_id": 5784596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a3f084baff5d06aa8cae644d508443?s=128&d=identicon&r=PG&f=1", "display_name": "user5784596", "link": "https://stackoverflow.com/users/5784596/user5784596"}, "edited": false, "score": 0, "creation_date": 1452695980, "post_id": 34768313, "comment_id": 57283717, "body": "Error line is UserForm2.Show, as provided in the first paragraph."}, {"owner": {"reputation": 1, "user_id": 5784596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a3f084baff5d06aa8cae644d508443?s=128&d=identicon&r=PG&f=1", "display_name": "user5784596", "link": "https://stackoverflow.com/users/5784596/user5784596"}, "edited": false, "score": 0, "creation_date": 1452704324, "post_id": 34768313, "comment_id": 57290214, "body": "Strangely, UserForm_Initialize is now failing with the same error."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5784596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a3f084baff5d06aa8cae644d508443?s=128&d=identicon&r=PG&f=1", "display_name": "user5784596", "link": "https://stackoverflow.com/users/5784596/user5784596"}, "is_accepted": false, "score": 0, "last_activity_date": 1452704618, "creation_date": 1452704618, "answer_id": 34772707, "question_id": 34768313, "link": "https://stackoverflow.com/questions/34768313/1004-error-on-simple-sub/34772707#34772707", "title": "1004 Error on simple Sub", "body": "<p>Found it. I had copied the code from UserForm1, and hadn't changed a reference to UserForm1 to UserForm2. My error went away.</p>\n"}], "owner": {"reputation": 1, "user_id": 5784596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a3f084baff5d06aa8cae644d508443?s=128&d=identicon&r=PG&f=1", "display_name": "user5784596", "link": "https://stackoverflow.com/users/5784596/user5784596"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452704618, "creation_date": 1452692695, "last_edit_date": 1531164843, "question_id": 34768313, "link": "https://stackoverflow.com/questions/34768313/1004-error-on-simple-sub", "title": "1004 Error on simple Sub", "body": "<p>I'm having a 1004 error in the code below. Its such as simple routine, I can't figure out what's wrong. This is only one sub of many in Module 1. Note that UserForm2's code works fine when I run it from the forms Sub's. But when I call it from here, I get the 1004 error. I don't really understand what causes that error. Help appreciated. Note that ChosenString and Report is a Public variable. You have several 1004 error entries, but I can't find one that fits this problem. Error is on UserForm2.Show.</p>\n\n<pre><code>Sub ChooseReport()\n' Display a selection box of reports and run the report\n'\n        ChoseCancel = 0\n        Sheets(\"Codes\").Activate\n        UserForm2.Show       ' Displays selection box of reports\n'\n' If the Cancel button was selected, exit the sub\n        If ChoseCancel = 1 Then\n            Sheets(\"Reports\").Activate\n            Exit Sub\n        End If\n'\n' Trim returned value of the comma\n    StringLength = Len(ChosenString)\n    Report = Left(ChosenString, StringLength - 2)\n'\nEnd Sub\n</code></pre>\n\n<p>This is my UserForm2 Code. It works fine.</p>\n\n<pre><code>Sub UserForm_Initialize()\n' Fill the list box with appropriate values\n'\n    UserForm1.ListBox1.ListStyle = fmListStylePlain\n    Sheets(\"Codes\").Activate\n    Range(\"O4\").Select\n'\n' Fill List box with appropriate cells entries for Reports\n     With ListBox1\n         Do While ActiveCell.Value &lt;&gt; Empty\n              .AddItem ActiveCell.Value\n              ActiveCell.Offset(1, 0).Select\n         Loop\n     End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "listbox", "vba", "sql-update"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1452692958, "post_id": 34768247, "comment_id": 57281545, "body": "Store your <code>UPDATE</code> statement text in a string variable, <i>strUpdate</i>.  Then add <code>Debug.Print strUpdate</code> and execute it like this: <code>CurrentDb.Execute strUpdate, dbFailOnError</code>  Does Access then give you more information about the failed updates?"}, {"owner": {"reputation": 253, "user_id": 4344039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/acb49c2644939a41a31aed4b05791c0a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4344039/alex"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1452693592, "post_id": 34768247, "comment_id": 57282004, "body": "I&#39;ve found the error.. Some documents don&#39;t have anything stored in the last field &#39;Consultation Notes&#39;. Those documents are the ones I&#39;m unable to update. However, if I put a value into that table field directly, then try to update them from the form it works..   What I don&#39;t understand is; I can then set that value back to nothing, but can continue to update it as normal"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1452694586, "post_id": 34768247, "comment_id": 57282722, "body": "When <code>[Consultation Notes]</code> is Null, it is not equal to <code>&quot;&#39;&quot; &amp; DocumentList.Column(3) &amp; &quot;&#39;&quot;</code>  I think your task would be simpler if you add an autonumber primary key, <i>ID</i>, to the <code>[Documents]</code> table.  Then include <i>ID</i> in the list box (doesn&#39;t have to be visible), and use that value in the <code>WHERE</code> clause to target the row you want to update.  That should be simpler than the <code>WHERE</code> clause you have now, and avoid the complication of &quot;Null is never equal to anything, not even another Null&quot;.  Also consider a parameter query for the <code>UPDATE</code>"}, {"owner": {"reputation": 253, "user_id": 4344039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/acb49c2644939a41a31aed4b05791c0a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4344039/alex"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1452698036, "post_id": 34768247, "comment_id": 57285252, "body": "@HansUp Thank you very much for informing me; I thought an empty field would be the same value as an empty string, e.g. &quot;&quot;; I guess that&#39;s where the problem lied. Your alternative solution helped a lot, simplified my code too as I didn&#39;t need all of those WHERE clause, only one.  If you&#39;d like to put it as an answer so I can accept it feel free"}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 0, "last_activity_date": 1452698868, "creation_date": 1452698868, "answer_id": 34770543, "question_id": 34768247, "link": "https://stackoverflow.com/questions/34768247/update-set-where-partially-working-on-listbox-microsoft-access-vba/34770543#34770543", "title": "UPDATE SET WHERE Partially working on listbox - Microsoft Access VBA", "body": "<p>Nothing is updated when <code>[Documents].[Consultation Notes]</code> is Null, because the <code>WHERE</code> clause targets an empty string instead ... <code>\"'\" &amp; DocumentList.Column(3) &amp; \"'\"</code> ... so no matching row is found.</p>\n\n<p>The task would be simpler if you add an autonumber primary key, <em>ID</em>, to the <code>[Documents]</code> table. Then include <em>ID</em> in the list box <em>Row Source</em>, and use that value in the <code>WHERE</code> clause to target the row you want to update. (The <em>ID</em> column doesn't have to be visible in the list box; you can set its column width property to zero.)</p>\n\n<p>Then your <code>WHERE</code> clause can be much simpler: just target the record whose <em>ID</em> matches the <em>ID</em> column value of the selected list box row.  That strategy would also avoid the complication of <em>\"Null is never equal to anything, not even another Null\"</em>. </p>\n\n<p>Finally, consider a parameter query for the <code>UPDATE</code> instead of concatenating values into a string variable.</p>\n"}], "owner": {"reputation": 253, "user_id": 4344039, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/acb49c2644939a41a31aed4b05791c0a?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4344039/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 34770543, "answer_count": 1, "score": 2, "last_activity_date": 1452698934, "creation_date": 1452692510, "last_edit_date": 1452698934, "question_id": 34768247, "link": "https://stackoverflow.com/questions/34768247/update-set-where-partially-working-on-listbox-microsoft-access-vba", "title": "UPDATE SET WHERE Partially working on listbox - Microsoft Access VBA", "body": "<p>I'm totally stumped at this one.. Skip to bottom to read problem</p>\n\n<p>Here's my listbox (<strong>DocumentList</strong>) that takes the fields from the '<strong>Documents</strong>' Table:</p>\n\n<pre><code>Document Name   Status         Notes                  Consultation Notes\nDoc A           Started        Document Started       Aim to process on 05/05/16\nDoc B           Processing     Document Processing    Aim to complete on 05/05/16\nDoc C           Complete       Complete on 01/01/16   N/A\n</code></pre>\n\n<p>I have the onclick event set so that when you select a row from the listbox, it assigns each field to a text box/Combobox.</p>\n\n<p>textboxes/Combobox names:</p>\n\n<pre><code>txtDocument\nStatusCombo\ntxtNotes\ntxtConNotes\n</code></pre>\n\n<p>code for each one in 'DocumentList' click event:</p>\n\n<pre><code>Private Sub DocumentList_Click()\n\ntxtDocument = DocumentList.Column(0)\nStatusCombo = DocumentList.Column(1)\ntxtNotes = DocumentList.Column(2)\ntxtConNotes = DocumentList.Column(3)\n</code></pre>\n\n<p>After the data is assigned to them from the listbox, you can edit it. I have an update button, which when pressed will replace everything in the database with everything in the textboxes/Combobox. The listbox is then re-queried and displays the updated data.</p>\n\n<p>Heres the code for my update button:</p>\n\n<pre><code>Private Sub UpdateButton_Click()\n\nCurrentDb.Execute \"UPDATE [Documents] \" &amp; _\n\"SET [Document Name] = '\" &amp; Me.txtDocument &amp; \"'\" &amp; _\n\", [Status] = '\" &amp; StatusCombo.Value &amp; \"'\" &amp; _\n\", [Notes] = '\" &amp; Me.txtNotes &amp; \"'\" &amp; _\n\", [Consultation Notes] = '\" &amp; Me.txtConNotes &amp; \"'\" &amp; _\n\"WHERE [Document Name] =  '\" &amp; DocumentList.Column(0) &amp; \"'\" &amp; _\n\"AND [Status] =  '\" &amp; DocumentList.Column(1) &amp; \"'\" &amp; _\n\"AND [Notes] =  '\" &amp; DocumentList.Column(2) &amp; \"'\" &amp; _\n\"AND [Consultation Notes] =  '\" &amp; DocumentList.Column(3) &amp; \"'\"\n\n\nDocumentList.Requery\nEnd Sub\n</code></pre>\n\n<p>My problem is the code only works on 2 out of 3 of the documents. All aspects of the code work, but only on some of the documents. This doesn't make any sense to me. At first I thought it may be a spelling error, but even if it was, none of the documents should get updated.. But some of them do, 1 doesn't..</p>\n\n<p>Any ideas why this code updates some documents, but doesn't update others?</p>\n"}, {"tags": ["vba", "excel", "email", "variables"], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 6, "last_activity_date": 1452692225, "creation_date": 1452692225, "answer_id": 34768161, "question_id": 34768068, "link": "https://stackoverflow.com/questions/34768068/how-do-i-insert-the-value-of-a-string-variable-into-some-text-that-will-end-up-i/34768161#34768161", "title": "How do I insert the value of a String variable into some text that will end up in the body of an email?", "body": "<pre><code>strbody = \"Hi guys,\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"Please can you issue the following:\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"Part number: \" &amp; PartNumber &amp; vbNewLine &amp; _\n          \"Qty: \" &amp; Qty &amp; vbNewLine &amp; _\n          \"This is line 4\"\n</code></pre>\n\n<p>Just include the <code>PartNumber</code> and <code>Qty</code> variable names inside the part of code where you're creating the e-mail body string; remember to use the <code>&amp;</code> operator to join string variables together.</p>\n"}], "owner": {"reputation": 11, "user_id": 5784518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c04fe535591bbc6a851bd040456d4cf?s=128&d=identicon&r=PG&f=1", "display_name": "Baz", "link": "https://stackoverflow.com/users/5784518/baz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34791, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1529674233, "creation_date": 1452691944, "last_edit_date": 1531164843, "question_id": 34768068, "link": "https://stackoverflow.com/questions/34768068/how-do-i-insert-the-value-of-a-string-variable-into-some-text-that-will-end-up-i", "title": "How do I insert the value of a String variable into some text that will end up in the body of an email?", "body": "<p>I have a spreadsheet that is going to be used to track requests made to another department.  I would like a Macro to generate and send an email the contains some predefined text and the value of some variables.  I already have some working code that scans the relevant cells and stores their values.</p>\n\n<p>I can generate the email, I can print lines of text including inserting one variable into the subject, but I can't seem to insert the value of any of the variables in the middle of the body of the email.  I have the following:</p>\n\n<pre><code>Sub IssueRequest()\n\nDim OutApp As Object\nDim OutMail As Object\nDim strbody As String\n\n' Selecting the last entry in column \"B\"\n\nRange(\"B7\").Select\nActiveCell.Offset(1, 0).Select\n   Do While Not IsEmpty(ActiveCell)\n   ActiveCell.Offset(1, 0).Select\n   Loop\nActiveCell.Offset(-1, 0).Select\n\n\n' Collect the unique value to insert into the subject field\n\nDim Subject As String\nSubject = ActiveCell.Value\n\nActiveCell.Offset(0, 2).Select\n\n' Collect the Part Number for use in the body of the email\n\nDim PartNumber As String\nPartNumber = ActiveCell.Value\n\n' Collect the Quantity for use in the body of the email\n\nActiveCell.Offset(0, 1).Select\nDim Qty As String\nQty = ActiveCell.Value\n\n'Create the email\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\nstrbody = \"Hi guys,\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"Please can you issue the following:\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"Part number:  \" &amp; vbNewLine &amp; _\n          \"Qty:   \" &amp; vbNewLine &amp; _\n          \"This is line 4\"\nOn Error Resume Next\n\nWith OutMail\n    .To = \"xxxxx.xxxxx@xxxxx-xxxxx.com\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = Subject\n    .Body = strbody\n    .Send\nEnd With\n\nOn Error GoTo 0\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nEnd Sub*\n</code></pre>\n\n<p>I really need to be able to insert the values of PartNumber and Qty in the middle of the String strbody.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1665, "user_id": 1387077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eBuUZ.jpg?s=128&g=1", "display_name": "Thorarins", "link": "https://stackoverflow.com/users/1387077/thorarins"}, "edited": false, "score": 0, "creation_date": 1452696775, "post_id": 34767787, "comment_id": 57284308, "body": "have you tried to wait for ready state after the click?"}, {"owner": {"reputation": 1, "user_id": 5784304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35465594b30757da514c701c8ba19026?s=128&d=identicon&r=PG&f=1", "display_name": "Jon777", "link": "https://stackoverflow.com/users/5784304/jon777"}, "reply_to_user": {"reputation": 1665, "user_id": 1387077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eBuUZ.jpg?s=128&g=1", "display_name": "Thorarins", "link": "https://stackoverflow.com/users/1387077/thorarins"}, "edited": false, "score": 0, "creation_date": 1452702336, "post_id": 34767787, "comment_id": 57288609, "body": "yes, I tried this later, but nothing happened"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5784304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35465594b30757da514c701c8ba19026?s=128&d=identicon&r=PG&f=1", "display_name": "Jon777", "link": "https://stackoverflow.com/users/5784304/jon777"}, "edited": false, "score": 0, "creation_date": 1452702688, "post_id": 34770275, "comment_id": 57288895, "body": "I added this code, but it runs non-stop, when I do this manually the page and the title changes instantly."}, {"owner": {"reputation": 181, "user_id": 4375028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e83219228a0000afcfffd06aefcada1?s=128&d=identicon&r=PG&f=1", "display_name": "AMC08", "link": "https://stackoverflow.com/users/4375028/amc08"}, "reply_to_user": {"reputation": 1, "user_id": 5784304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35465594b30757da514c701c8ba19026?s=128&d=identicon&r=PG&f=1", "display_name": "Jon777", "link": "https://stackoverflow.com/users/5784304/jon777"}, "edited": false, "score": 0, "creation_date": 1452709043, "post_id": 34770275, "comment_id": 57293173, "body": "I edited the answer and put in my full code which is working.  I am manually shutting down IE between runs so a fresh instance is created each time.  Putting in the proper pauses is key.  Many times I use the Wait command for a few seconds instead of IE state."}, {"owner": {"reputation": 1, "user_id": 5784304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35465594b30757da514c701c8ba19026?s=128&d=identicon&r=PG&f=1", "display_name": "Jon777", "link": "https://stackoverflow.com/users/5784304/jon777"}, "edited": false, "score": 0, "creation_date": 1452717819, "post_id": 34770275, "comment_id": 57298518, "body": "have you tried to run it? when I tried it didn&#39;t work, I also added Application.wait as you said, but didn&#39;t help. maybe it depends on the IE version? I&#39;m using IE 11"}], "tags": [], "owner": {"reputation": 181, "user_id": 4375028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e83219228a0000afcfffd06aefcada1?s=128&d=identicon&r=PG&f=1", "display_name": "AMC08", "link": "https://stackoverflow.com/users/4375028/amc08"}, "is_accepted": false, "score": 0, "last_activity_date": 1452708944, "last_edit_date": 1452708944, "creation_date": 1452698150, "answer_id": 34770275, "question_id": 34767787, "link": "https://stackoverflow.com/questions/34767787/ie-innerhtml-after-clicking-on-link/34770275#34770275", "title": "IE innerHTML after clicking on link", "body": "<p>It looks likes a timing issue which I find is a very common problem in automating IE. The code is not waiting for the following page to load before executing hd.Links(0).Click so it is actually clicking a link on the old page.  I tested the following code and it seems to run fine. It is using the page title as a check if it is loaded instead of ie.ReadyState which doesn't seem to be working.</p>\n\n<pre><code>Sub test()\n\nDim ie As InternetExplorer\nDim hd As HTMLDocument\nSet ie = New InternetExplorer\n\nie.Navigate \"http://www.stormchaser.niu.edu/machine/textfcstsound.html\"\nie.Visible = True\n\nDo While ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nLoop\n\nSet hd = ie.Document\n\nhd.all.Item(\"mo\")(4).Checked = True\nhd.all.Item(\"ft\")(11).Checked = True\n\nSet objInputs = ie.Document.getElementsByTagName(\"input\")\n\nFor Each ele In objInputs\n    If ele.Type = \"submit\" Then\n        ele.Click\n        'Debug.Print ele.outerHTML\n    End If\nNext\n\nDo While hd.Title &lt;&gt; \"Forecast Sounding Text Output for KOKC\" ' ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    'Debug.Print hd.Title, hd.Links(0)\n    'DoEvents\nLoop\n\n'While ie.ReadyState &lt;&gt; READYSTATE_COMPLETE: Wend\nSet hd = ie.Document\nDebug.Print hd.Title, hd.Links(0)\nhd.Links(0).Click\n\n'Do While ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\n'    DoEvents\n'Loop\nWhile ie.ReadyState &lt;&gt; READYSTATE_COMPLETE: Wend\nDo While hd.Title &lt;&gt; \"\" ' ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\nLoop\n\nDebug.Print hd.Title, hd.body.innerHTML\nRange(\"K4\") = hd.body.innerHTML\nEnd Sub\n</code></pre>\n\n<p>I would also suggest ie.Visible for debugging. Hope that helps.</p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 4375028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e83219228a0000afcfffd06aefcada1?s=128&d=identicon&r=PG&f=1", "display_name": "AMC08", "link": "https://stackoverflow.com/users/4375028/amc08"}, "edited": false, "score": 0, "creation_date": 1452784721, "post_id": 34791279, "comment_id": 57329679, "body": "Great.  Every time I write one of these IE scripts I think.... there&#39;s got to be a better way... but there doesn&#39;t seem to be."}], "tags": [], "owner": {"reputation": 1, "user_id": 5784304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35465594b30757da514c701c8ba19026?s=128&d=identicon&r=PG&f=1", "display_name": "Jon777", "link": "https://stackoverflow.com/users/5784304/jon777"}, "is_accepted": false, "score": 0, "last_activity_date": 1452779275, "creation_date": 1452779275, "answer_id": 34791279, "question_id": 34767787, "link": "https://stackoverflow.com/questions/34767787/ie-innerhtml-after-clicking-on-link/34791279#34791279", "title": "IE innerHTML after clicking on link", "body": "<p>I got it, you're right that it's a timing issue, I found out how to catch the right second for calling the innerHTML method without freezing Excel, it gives Excel a timeout of 20 seconds waiting for the new window, otherwise it returns \"failed\".</p>\n\n<p>here is the full code:</p>\n\n<pre><code>Set ie = New InternetExplorer\n\nie.navigate \"http://www.stormchaser.niu.edu/machine/textfcstsound.html\"\n\nDo While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nLoop\n\nSet hd = ie.document\n\nT1 = ie.document.Title\n\nhd.all.Item(\"mo\")(4).Checked = True\nhd.all.Item(\"ft\")(10).Checked = True\nhd.getElementById(\"stn\").Value = \"LLBG\"\n\nSet objInputs = ie.document.getElementsByTagName(\"input\")\n\nFor Each ele In objInputs\n    If ele.Type = \"submit\" Then\n        ele.Click\n    End If\nNext\n\nDo While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nLoop\n\nT2 = Now\nDo While (Now &lt; T2 + TimeValue(\"0:00:20\")) And ie.document.Title = T1\n    DoEvents\nLoop\n\nIf ie.document.Title = T1 Then\n    Debug.Print \"failed\"\n    GoTo end_ext\nEnd If\n\nT1 = ie.document.Title\n\nie.document.Links(0).Click\n\nDo While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nLoop\n\nT2 = Now\nDo While (Now &lt; T2 + TimeValue(\"0:00:20\")) And ie.document.Title = T1\n    DoEvents\nLoop\n\nIf ie.document.Title = T1 Then\n    Debug.Print \"failed\"\n    GoTo end_ext\nElse\n    'Debug.Print \"succeeded\"\nEnd If\n\nDebug.Print ie.document.body.innerText\n\nend_ext:\nie.Quit\nSet hd = Nothing\nSet ie = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5784304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35465594b30757da514c701c8ba19026?s=128&d=identicon&r=PG&f=1", "display_name": "Jon777", "link": "https://stackoverflow.com/users/5784304/jon777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1135, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1452779275, "creation_date": 1452691144, "question_id": 34767787, "link": "https://stackoverflow.com/questions/34767787/ie-innerhtml-after-clicking-on-link", "title": "IE innerHTML after clicking on link", "body": "<p>I'm using Excel-vba, and trying to get the innerHTML of an InternetExplorer Object, my problem is that after clicking on a link, the innerHTML doesn't change and stays as the first navigation.</p>\n\n<p>is there a way to get the innerHTML of the next page after clicking the link?\nHere is the code:</p>\n\n<pre><code>Dim ie As InternetExplorer\nDim hd As HTMLDocument\n\nSet ie = New InternetExplorer\n\nie.navigate \"http://www.stormchaser.niu.edu/machine/textfcstsound.html\"\n\nDo While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nLoop\n\nSet hd = ie.document\n\nhd.all.Item(\"mo\")(4).Checked = True\nhd.all.Item(\"ft\")(11).Checked = True\n\nSet objInputs = ie.document.getElementsByTagName(\"input\")\n\nFor Each ele In objInputs\n    If ele.Type = \"submit\" Then\n        ele.Click\n    End If\nNext\n\nDo While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nLoop\n\nhd.Links(0).Click\n\nRange(\"K4\") = ie.document.body.innerHTML\n</code></pre>\n\n<p>I'd really thank for any help.</p>\n\n<p>Jon</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1452690776, "post_id": 34767312, "comment_id": 57280068, "body": "Try the <code>enabled=false</code> instead of <code>locked</code>."}, {"owner": {"reputation": 57, "user_id": 5652963, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/606a806b580e313cff4be24b6802bf6f?s=128&d=identicon&r=PG&f=1", "display_name": "r.sa", "link": "https://stackoverflow.com/users/5652963/r-sa"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1452691937, "post_id": 34767312, "comment_id": 57280840, "body": "Hi vacip ...tried it already...not working .. i hope the code that i hav mentioned above is correct"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1452692240, "post_id": 34767312, "comment_id": 57281040, "body": "Well, then you can try disabling both buttons separately..."}], "answers": [{"comments": [{"owner": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "edited": false, "score": 0, "creation_date": 1452702152, "post_id": 34768674, "comment_id": 57288477, "body": "There is no Locked property for a button. <code>Enabled=False</code> will grey the button out and render it inoperable. Locking a subform on it&#39;s own does not lock or prevent any controls being used afaik?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 619, "user_id": 4091300, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dd580ce66c4208f1484bcc51b33c815d?s=128&d=identicon&r=PG&f=1", "display_name": "GavinP", "link": "https://stackoverflow.com/users/4091300/gavinp"}, "edited": false, "score": 0, "creation_date": 1452702932, "post_id": 34768674, "comment_id": 57289082, "body": "I was so busy explaining how to reference the forms that I ignored the fact it was buttons and not any other kind of control.  I&#39;ll update my answer."}, {"owner": {"reputation": 57, "user_id": 5652963, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/606a806b580e313cff4be24b6802bf6f?s=128&d=identicon&r=PG&f=1", "display_name": "r.sa", "link": "https://stackoverflow.com/users/5652963/r-sa"}, "edited": false, "score": 0, "creation_date": 1452761279, "post_id": 34768674, "comment_id": 57314092, "body": "thank u darren...it worked ...the link u have provided was very helpful too..the code that i was using to refer to the button was wrong...thanks for rectifying it ..cheers"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1452703405, "last_edit_date": 1452703405, "creation_date": 1452693681, "answer_id": 34768674, "question_id": 34767312, "link": "https://stackoverflow.com/questions/34767312/need-to-lock-disable-button-in-access/34768674#34768674", "title": "Need to lock/disable button in access", "body": "<p>I find this site the best reference:  <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow\">http://access.mvps.org/access/forms/frm0031.htm</a></p>\n\n<p>If your code is in the main form then:</p>\n\n<pre><code>Private Sub btnOnMainForm_Click()\n    Me.btnToDisableOnMainForm.Enabled = False\n    Me.SubForm1.Form.btnToDisableOnSubForm1.Enabled = False\n    Me.SubForm1.Form.SubForm2.Form.btnToDisableOnSubForm2.Enabled = False\nEnd Sub\n</code></pre>\n\n<p>If it's in the first subform then:</p>\n\n<pre><code>Private Sub btnOnSubForm1_Click()\n    Me.btnToDisableOnSubForm1.Enabled = False\n    Me.Parent.btnToDisableOnMainForm.Enabled = False\n    Me.SubForm2.Form.btnToDisableOnSubForm2.Enabled = False\nEnd Sub\n</code></pre>\n\n<p>If it's in the second subform then:</p>\n\n<pre><code>Private Sub btnOnSubForm2_Click()\n    Me.Parent.Parent.btnToDisableOnMainForm.Enabled = False\n    Me.Parent.btnToDisableOnSubForm1.Enabled = False\n    Me.btnToDisableOnSubForm2.Enabled = False\nEnd Sub\n</code></pre>\n\n<p>If it's not on the form then:</p>\n\n<pre><code>Sub LockControlsFromNormalModule()\n    Forms.MainForm.btnToDisableOnMainForm.Enabled = False\n    Forms.MainForm.SubForm1.Form.btnToDisableOnSubForm1.Enabled = False\n    Forms.MainForm.SubForm1.Form.SubForm2.Form.btnToDisableOnSubForm2.Enabled = False\nEnd Sub\n</code></pre>\n\n<p>To turn the enabled property on and off with the same code you can use:</p>\n\n<pre><code>Private Sub btnOnMainForm_Click()\n    With Me\n        With .btnToDisableOnMainForm\n            .Enabled = Not .Enabled\n        End With\n        With .SubForm1.Form\n            With .btnToDisableOnSubForm1\n                .Enabled = Not .Enabled\n            End With\n            With .SubForm2.Form.btnToDisableOnSubForm2\n                .Enabled = Not .Enabled\n            End With\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>Use the <code>WITH</code> command here is the same as writing:</p>\n\n<pre><code>Private Sub btnOnMainForm_Click()\n    Me.btnToDisableOnMainForm.Enabled = Not Me.btnToDisableOnMainForm.Enabled\n    Me.SubForm1.Form.btnToDisableOnSubForm1.Enabled = Not Me.SubForm1.Form.btnToDisableOnSubForm1.Enabled\n    Me.SubForm1.Form.SubForm2.Form.btnToDisableOnSubForm2.Enabled = Not Me.SubForm1.Form.SubForm2.Form.btnToDisableOnSubForm2.Enabled\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong> - MainForm, SubForm1 and SubForm2 are the names I saved the forms as.<br>\ntxtboxOnMainForm, txtboxOnSubForm1 and txtboxOnSubForm2 are the names I gave to the controls on the forms.</p>\n"}], "owner": {"reputation": 57, "user_id": 5652963, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/606a806b580e313cff4be24b6802bf6f?s=128&d=identicon&r=PG&f=1", "display_name": "r.sa", "link": "https://stackoverflow.com/users/5652963/r-sa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10991, "favorite_count": 0, "accepted_answer_id": 34768674, "answer_count": 1, "score": 1, "last_activity_date": 1552456043, "creation_date": 1452689683, "last_edit_date": 1552456043, "question_id": 34767312, "link": "https://stackoverflow.com/questions/34767312/need-to-lock-disable-button-in-access", "title": "Need to lock/disable button in access", "body": "<p>I need to disable/lock two buttons. I have a form which has a subform which in turn has another subform. Two buttons in the third subform that I need to disable/lock depending on a condition in the <code>OnCurrent()</code> of the second subform. The third subform is locked <code>subform3.locked=true</code>. Everything in the third subform gets locked (txtboxes,comboboxes) except the two buttons i have added.</p>\n\n<p>I have tried to place this code right below the code where the third subform is locked:<br>\n<code>.subform.locked=true</code></p>\n\n<p><code>Forms![subform2]![subform3].Form![buttonname].visible=false</code></p>\n\n<p>But this has not worked.\nAlso, in the <code>OnLoad</code> of subform3 tried to run an if condition that checks if subform3 is locked and if true make <code>button.visible=false</code>. This has not worked either.</p>\n\n<p>Very new to access.\nAppreciate the help.</p>\n"}, {"tags": ["vba", "excel", "excel-charts"], "answers": [{"comments": [{"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1452689768, "post_id": 34767260, "comment_id": 57279395, "body": "Thanks for that. What I forgot to mention is that the original data set is merged so for the first 2015/08/01 it is actually taking 8 Cells.  Which you answer then make 8 individual  entries. I did forget to mention the merge in the Question. I will add it now"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1452690538, "post_id": 34767260, "comment_id": 57279915, "body": "what I found is that if I Hide all the rows, except the first row,  of a specific day (say 2015/08/91) the Chart will then only display the data from the rows which are not hidden on the Sheet."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1452692086, "post_id": 34767260, "comment_id": 57280922, "body": "How do you expect them to be displayed if not adjacent to each other? If you want them added up, you need a pivot chart not a regular chart."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1452692450, "post_id": 34767260, "comment_id": 57281191, "body": "What I want is for there to be data in the chart for every Value in the time column with its asociated date reference. Regardless if there is two values on the same day. Not sure how pivot charts work, but definitely don&#39;t want to tally the times up"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1452692908, "post_id": 34767260, "comment_id": 57281502, "body": "Then I suggest you don&#39;t use a column chart since a larger value ocurring after a smaller one for the same day will naturally obscure it from view. Otherwise you&#39;ll have to use a combination of transparent fill and varying colours by point."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1452689525, "creation_date": 1452689525, "answer_id": 34767260, "question_id": 34766946, "link": "https://stackoverflow.com/questions/34766946/excel-chart-omitting-additional-data-values-on-specific-date/34767260#34767260", "title": "Excel Chart Omitting Additional Data Values on Specific Date", "body": "<p>If you want to repeat the day on the X axis, you need to add:</p>\n\n<pre><code>.Axes(xlCategory).CategoryType = xlCategoryScale\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 0, "last_activity_date": 1452694107, "creation_date": 1452694107, "answer_id": 34768808, "question_id": 34766946, "link": "https://stackoverflow.com/questions/34766946/excel-chart-omitting-additional-data-values-on-specific-date/34768808#34768808", "title": "Excel Chart Omitting Additional Data Values on Specific Date", "body": "<p>Using the answer from  @Rory I saw that all the rows were displayed. </p>\n\n<p>After doing some searching I saw that in the <code>Chart</code>, by default, only the data in displayed cells(ie not hidden) will be visible in the <code>Chart</code>.</p>\n\n<p>I then just incorporated a <code>Range(Rows(x), Rows(y)).Hidden = True</code> into the script which gave me the Merged Cells for a specific time period.</p>\n\n<p>Image below represents the final product.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8M938.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8M938.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can see the dual entries for 2015/08/01 in the Chart</p>\n\n<p>The <code>.Axes(xlCategory).CategoryType = xlCategoryScale</code> basically set the Hosrizontal Axis Type to \"Text axis\" as referred to in the Excel Pop up Menu when right clicking the axis</p>\n\n<p>Any other suggestions as to using a different type of Chart as Rory mentioned in his answer is welcomed.</p>\n\n<p>Will leave this Question unanswered for the time being.</p>\n"}], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 34768808, "answer_count": 2, "score": 0, "last_activity_date": 1452694107, "creation_date": 1452688619, "last_edit_date": 1452689942, "question_id": 34766946, "link": "https://stackoverflow.com/questions/34766946/excel-chart-omitting-additional-data-values-on-specific-date", "title": "Excel Chart Omitting Additional Data Values on Specific Date", "body": "<p>I have a macro which generates a <code>Chart</code> from a range of data. See data below:</p>\n\n<blockquote>\n  <p>2015/08/01 12:49.002</p>\n  \n  <p>2015/08/01 00:41.600</p>\n  \n  <p>2015/08/02 00:27.198</p>\n  \n  <p>2015/08/03 01:05.600</p>\n  \n  <p>2015/08/03 01:30.599</p>\n  \n  <p>2015/08/04 02:29.799</p>\n  \n  <p>2015/08/05 01:40.199</p>\n  \n  <p>2015/08/06 01:36.199</p>\n  \n  <p>2015/08/07 02:16.998</p>\n  \n  <p>2015/08/07 00:43.401</p>\n</blockquote>\n\n<p>The first Column represents the date and then second is a time frame from that date.</p>\n\n<p><strong>NOTE</strong> the original data i found in the sheet is cells which have been merged. See screen shot below for more info.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kcx8u.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kcx8u.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The problem is that the Chart only displays the greater number allocated for that date.</p>\n\n<p>See code below.</p>\n\n<pre><code>Option Explicit\nPublic Declare Function GetTickCount Lib \"kernel32.dll\" () As Long\n\nSub CreateChart()\n\n    Dim DateRange, TimeRange As Range\n    Dim lastRow As Long\n    Dim StartRow As Long, columnIndex As Long\n    Dim DataWorkSheet As Worksheet\n    Dim DataFileFullPath As String, DataFileName As String, SheetName As String\n    Dim Index As Long, Index2 As Long\n    Dim t As Long\n    Dim tt As Long\n    Dim Chart1 As Chart\n\n\n'    'Disable Screen Updating\n'    Application.ScreenUpdating = False\n'    Application.Calculation = xlCalculationManual\n\n\n    StartRow = 20\n    columnIndex = 3\n\n    'Put Full File Path for your demo/test file here\n    DataFileFullPath = \"C:\\Users\\.................\"\n\n    Index = InStrRev(DataFileFullPath, \"\\\")\n    DataFileName = Right(DataFileFullPath, Len(DataFileFullPath) - Index)\n\n    Index2 = InStrRev(DataFileName, \".\")\n    SheetName = Left(DataFileName, Index2 - 1)\n\n    Set DataWorkSheet = Workbooks(DataFileName).Sheets(SheetName)\n\n\n\n    t = GetTickCount\n\n    With DataWorkSheet\n\n        With .UsedRange\n            'Getting the last Row\n            lastRow = .Rows(.Rows.Count).row - 1\n        End With\n\n        'The DataStartRow is set to the ORiginal Time from the T3000\n        Set DateRange = .Range(.Cells(StartRow, columnIndex + 1), .Cells(lastRow, columnIndex + 1))\n        Set TimeRange = .Range(.Cells(StartRow, columnIndex + 2), .Cells(lastRow, columnIndex + 2))\n\n    End With\n\n    Set Chart1 = Charts.Add\n\n    With Chart1\n\n        .ChartType = xlColumnClustered\n        .SeriesCollection.NewSeries\n\n        With .SeriesCollection(1)\n            .Values = TimeRange\n            .Name = SheetName &amp; \" \" &amp; \"Synch Time\"\n            .XValues = DateRange\n        End With\n\n        .Name = SheetName &amp; \" \" &amp; \"Synch Time Chart\"\n        .Axes(xlValue).MaximumScale = 0.0104166667 ' 15 mins / 50 / 24\n        .Axes(xlValue).MajorUnit = 0.0006944444 ' 1 mins /60 / 24\n        .Move After:=Sheets(2)\n\n    End With\n    tt = GetTickCount - t\n'    'Enable Screen Updating\n'    Application.ScreenUpdating = True\n'    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Is there an element of <code>Chart1</code>that I need to include to not omit a second data value from a specific date?</p>\n"}, {"tags": ["java", "excel", "jacob", "vba"], "comments": [{"owner": {"reputation": 1811, "user_id": 4572590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh5.googleusercontent.com/-AdTOTTXucYE/AAAAAAAAAAI/AAAAAAAAADo/0jguQ7fG9SY/photo.jpg?sz=128", "display_name": "griFlo", "link": "https://stackoverflow.com/users/4572590/griflo"}, "edited": false, "score": 0, "creation_date": 1455279023, "post_id": 34766840, "comment_id": 58430369, "body": "the macro is really called  &#39;TestExcel_copy.xlsmTestMacro&#39; (and not just &#39;TestMacro&#39;?)"}], "answers": [{"tags": [], "owner": {"reputation": 542, "user_id": 3859828, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ef2420c652121e723f76c05181cb638c?s=128&d=identicon&r=PG&f=1", "display_name": "Alann", "link": "https://stackoverflow.com/users/3859828/alann"}, "is_accepted": false, "score": 3, "last_activity_date": 1461338828, "creation_date": 1461338828, "answer_id": 36797791, "question_id": 34766840, "link": "https://stackoverflow.com/questions/34766840/call-macro-from-java-using-jacob-1-18/36797791#36797791", "title": "Call macro from Java using Jacob 1.18", "body": "<p>u need to change your macro call to </p>\n\n<pre><code>Variant result = Dispatch.call(excel, \"Run\", new Variant(\"\\'\"+file.getName()+\"\\'\"+ macroName));\n</code></pre>\n\n<p>because inside excel the name of the file is between quote, so it doesn't find your macro name without \"\\'\"</p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 4628499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/299ede06eccf7264f76c652aed434af7?s=128&d=identicon&r=PG&f=1", "display_name": "kamal pamnani", "link": "https://stackoverflow.com/users/4628499/kamal-pamnani"}, "is_accepted": false, "score": 0, "last_activity_date": 1487738948, "last_edit_date": 1487738948, "creation_date": 1487062844, "answer_id": 42221757, "question_id": 34766840, "link": "https://stackoverflow.com/questions/34766840/call-macro-from-java-using-jacob-1-18/42221757#42221757", "title": "Call macro from Java using Jacob 1.18", "body": "<p>No need to add file.getname() while calling the macro. Only the macroname is sufficient. </p>\n\n<p>Use </p>\n\n<pre><code>Variant result = Dispatch.call(excel, \"Run\", new Variant(macroName));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3052963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb24dba2497d4d70dc4c9a72ba0b5d45?s=128&d=identicon&r=PG&f=1", "display_name": "user3052963", "link": "https://stackoverflow.com/users/3052963/user3052963"}, "is_accepted": false, "score": 1, "last_activity_date": 1514065447, "last_edit_date": 1514065447, "creation_date": 1514064476, "answer_id": 47956165, "question_id": 34766840, "link": "https://stackoverflow.com/questions/34766840/call-macro-from-java-using-jacob-1-18/47956165#47956165", "title": "Call macro from Java using Jacob 1.18", "body": "<p>To be exact :</p>\n\n<pre><code>Dispatch.call(excel, \"Run\", new Variant(\"\\'\"+file.getName()+\"\\'!\" + macroName));\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 5350618, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IDdw5RpOe2I/AAAAAAAAAAI/AAAAAAAAABI/-iLBVEanbdc/photo.jpg?sz=128", "display_name": "Priyambada Madala", "link": "https://stackoverflow.com/users/5350618/priyambada-madala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4233, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1514065447, "creation_date": 1452688327, "last_edit_date": 1531164843, "question_id": 34766840, "link": "https://stackoverflow.com/questions/34766840/call-macro-from-java-using-jacob-1-18", "title": "Call macro from Java using Jacob 1.18", "body": "<p>I have a macro defined in an Excel file and I want invoke it from a Java program using Jacob 1.18 jar and dll. </p>\n\n<p>The following is the code segment I am currently using. </p>\n\n<pre><code>import java.io.File;\n\nimport com.jacob.activeX.ActiveXComponent;\nimport com.jacob.com.ComThread;\nimport com.jacob.com.Dispatch;\nimport com.jacob.com.Variant;\n\n\npublic class TestJacob {\n\n    public static void main(String[] args) {\n        // TODO Auto-generated method stub\n\n        File file = new File(\"C:\\\\TestJacob\\\\TestExcel_copy.xlsm\");\n        String macroName = \"TestMacro\";\n        callExcelMacro(file, macroName);\n\n    }\n\n    private static void callExcelMacro(File file, String macroName) {\n        ComThread.InitSTA(true);\n        final ActiveXComponent excel = new ActiveXComponent(\"Excel.Application\");\n        try{\n            excel.setProperty(\"EnableEvents\", new Variant(false));\n\n            Dispatch workbooks = excel.getProperty(\"Workbooks\")\n                    .toDispatch();\n\n            Dispatch workBook = Dispatch.call(workbooks, \"Open\",\n                    file.getAbsolutePath()).toDispatch();\n\n            // Calls the macro\n            Variant V1 = new Variant( file.getName() + macroName);\n            Variant result = Dispatch.call(excel, \"Run\", V1);\n\n            // Saves and closes\n            Dispatch.call(workBook, \"Save\");\n\n            com.jacob.com.Variant f = new com.jacob.com.Variant(true);\n            Dispatch.call(workBook, \"Close\", f);\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            excel.invoke(\"Quit\", new Variant[0]);\n            ComThread.Release();\n        }\n    }\n}\n</code></pre>\n\n<p>The following is the exception I am getting while calling the macro . </p>\n\n<pre><code>com.jacob.com.ComFailException: Invoke of: Run\nSource: Microsoft Excel\nDescription: Cannot run the macro 'TestExcel_copy.xlsmTestMacro'. The macro may not be available in this workbook or all macros may be disabled.\n\n    at com.jacob.com.Dispatch.invokev(Native Method)\n    at com.jacob.com.Dispatch.invokev(Dispatch.java:625)\n    at com.jacob.com.Dispatch.callN(Dispatch.java:453)\n    at com.jacob.com.Dispatch.call(Dispatch.java:541)\n    at TestJacob.callExcelMacro(TestJacob.java:38)\n    at TestJacob.main(TestJacob.java:16)\n</code></pre>\n\n<p>I have also enabled the macros in Excel file by following steps . </p>\n\n<ol>\n<li>File->Options</li>\n<li>Trust Center-> Trust Center Settings</li>\n<li>Macro Settings</li>\n<li>Enabled \"Enable all macros\" and \"trust access to the VBA project object model </li>\n<li>press \"OK\"</li>\n</ol>\n"}, {"tags": ["c#", "c++", "vba", "excel"], "comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1452718365, "post_id": 34766223, "comment_id": 57298823, "body": "What specific functionality are you trying to add?  I realize yours is a more general question, but if you could detail specifically what you are trying to do then maybe there is a &quot;stop-gap&quot; that could be done."}], "answers": [{"tags": [], "owner": {"reputation": 160, "user_id": 2050035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97918fbaadd9e2c6cb57bcc1b14eace7?s=128&d=identicon&r=PG", "display_name": "Mokuyobi", "link": "https://stackoverflow.com/users/2050035/mokuyobi"}, "is_accepted": false, "score": -1, "last_activity_date": 1452772276, "last_edit_date": 1495542682, "creation_date": 1452772276, "answer_id": 34788932, "question_id": 34766223, "link": "https://stackoverflow.com/questions/34766223/add-functionality-to-access-vba-with-c-or-c-cli/34788932#34788932", "title": "Add functionality to access vba with c# (or c++/cli)", "body": "<p>Okay so I finally found a way myself.</p>\n\n<p>In this post <a href=\"https://stackoverflow.com/questions/2719985/calling-managed-c-sharp-functions-from-unmanaged-c\">calling managed c# functions from unmanaged c++</a> there is the NuGet Package Unmanaged Exports linked. \nSo I created a new C# DLL Project, inserted for testing purpose following code:</p>\n\n<pre><code>using RGiesecke.DllExport;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\n\nnamespace ClassLibrary1\n{\n    internal static class Class1\n    {\n        [DllExport(\"square\", CallingConvention = System.Runtime.InteropServices.CallingConvention.StdCall)]\n        static Double Square(Double dateValue)\n        {\n            return dateValue * dateValue;\n        }\n\n        [DllExport(\"test\", CallingConvention = System.Runtime.InteropServices.CallingConvention.StdCall)]\n        static String Test()\n        {\n            return \" ok\";\n        }\n\n        [DllExport(\"mytest2\", CallingConvention = System.Runtime.InteropServices.CallingConvention.StdCall)]\n        static void Test4(String doSomething)\n        {\n            // Manipulate (and obisously create new) String\n            doSomething += \" ok\";\n        }\n    }\n}\n</code></pre>\n\n<p>Compiled this with x64 switch on, and created an VBA Sheet in excel with:</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare PtrSafe Function square Lib \"C:\\Users\\&lt;Name&gt;\\documents\\visual studio 2013\\Projects\\ClassLibrary1\\ClassLibrary1\\bin\\x64\\Release\\ClassLibrary1.dll\" (ByVal dateValue As Double) As Double\nPrivate Declare PtrSafe Function test Lib \"C:\\Users\\&lt;Name&gt;\\documents\\visual studio 2013\\Projects\\ClassLibrary1\\ClassLibrary1\\bin\\x64\\Release\\ClassLibrary1.dll\" () As String\nPrivate Declare PtrSafe Function mytest2 Lib \"C:\\Users\\&lt;Name&gt;\\documents\\visual studio 2013\\Projects\\ClassLibrary1\\ClassLibrary1\\bin\\x64\\Release\\ClassLibrary1.dll\" (ByRef dateValue As String)\n\nPrivate Sub CommandButton1_Click()\n    Dim zahl As Double\n    zahl = CInt(TextBox1.text)\n    zahl = square(zahl)\n    Label1.Caption = CStr(zahl)\n\n    Dim text As String\n    text = \"This is\"\n    mytest2 (text)\n    MsgBox text\nEnd Sub\n</code></pre>\n\n<p>The only error I still get is when calling the test function. Returning an string seems to break excel. (Program instantly quits) But I think that should be solved in another question.</p>\n"}], "owner": {"reputation": 160, "user_id": 2050035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97918fbaadd9e2c6cb57bcc1b14eace7?s=128&d=identicon&r=PG", "display_name": "Mokuyobi", "link": "https://stackoverflow.com/users/2050035/mokuyobi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1452772276, "creation_date": 1452686554, "question_id": 34766223, "link": "https://stackoverflow.com/questions/34766223/add-functionality-to-access-vba-with-c-or-c-cli", "title": "Add functionality to access vba with c# (or c++/cli)", "body": "<p>I need to add new functionality to vba in access. I already tried a lot of tutorials:\n<a href=\"http://www.office-loesung.de/ftopic268792_0_0_asc.php\" rel=\"nofollow\">http://www.office-loesung.de/ftopic268792_0_0_asc.php</a> (german) and \n<a href=\"http://www.codeproject.com/Articles/555660/Extend-your-VBA-code-with-Csharp-VB-NET-or-Cpluspl\" rel=\"nofollow\">http://www.codeproject.com/Articles/555660/Extend-your-VBA-code-with-Csharp-VB-NET-or-Cpluspl</a> (cant post more cause of rep)</p>\n\n<p>but none of them works for me. The customer has office 2013 and i am using .net 4.5.</p>\n\n<p>We want to provide the customer a rest api which is already written in c#/.net and which needs some encryption dlls of the .net world.</p>\n\n<p>I tried to create an dll with \"Interop COM\" switch on and could add a reference of the dll to my VBA test Sheet BUT neither objects nor static test functions have been working. There even is no intelisense in VBA. A restart of the program did not solve the problem either. (though somehting went wrong before)</p>\n\n<p>The error message i retrieve is \"Runtime Error 429 - ActiveX Component Can't Create Object\" (for my own code as well as for the code from codeplex (with all modules, C#, VBA, C++/Cli))</p>\n\n<p>Is there any other way to go, adding new functionality to VBA / extending it with own functions?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "is_accepted": false, "score": 0, "last_activity_date": 1452693365, "last_edit_date": 1452693365, "creation_date": 1452690211, "answer_id": 34767492, "question_id": 34766211, "link": "https://stackoverflow.com/questions/34766211/delete-entire-rows-from-multiple-sheets/34767492#34767492", "title": "Delete Entire Rows from multiple Sheets", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub ScrapButton_Click()\n\n  Dim RTCNumber As Double\n  Dim Row2 As Variant\n  Dim Row1 As Variant\n  Dim wb As Workbook\n  Dim ws1 As Worksheet\n  Dim ws6 As Worksheet\n\n  Set wb = ThisWorkbook\n  Set ws1 = wb.Sheets(\"Sheet1\")\n  Set ws6 = wb.Sheets(\"Sheet6\")\n\nRTCNumber = RTCTextBox\n\nMSG1 = MsgBox(\"Remove \" &amp; RTCNumber &amp; \" from Lab Stock?\", vbYesNo)\n\nIf MSG1 = vbNo Then\n    Exit Sub\nElse\n\n    Row1 = ws6.Application.WorksheetFunction.Match(RTCNumber, ws6.Range(\"A:A\"), 0)\n    ws6.Rows(Row1).EntireRow.Delete\n\n\n    Row2 = ws1.Application.WorksheetFunction.Match(RTCNumber, ws1.Range(\"A:A\"), 0)\n    ws1.Rows(Row2).EntireRow.Delete\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "is_accepted": false, "score": 0, "last_activity_date": 1452693194, "creation_date": 1452693194, "answer_id": 34768500, "question_id": 34766211, "link": "https://stackoverflow.com/questions/34766211/delete-entire-rows-from-multiple-sheets/34768500#34768500", "title": "Delete Entire Rows from multiple Sheets", "body": "<p>Try to CLng the first argument of your match function. That works for me.</p>\n\n<p>Had to remove WorksheetFunction on my version of Excel, but I don't know if that's the case on your machine, so I left it in.</p>\n\n<p>And then, as manu stated in his answer, I added Sheet references.</p>\n\n<pre><code>Private Sub ScrapButton_Click()\n\nDim RTCNumber As String\nRTCNumber = RTCTextBox\n\nMSG1 = MsgBox(\"Remove \" + RTCTextBox + \" from Lab Stock?\", vbYesNo)\n\nIf MSG1 = vbNo Then\n    Exit Sub\nElse\n    Dim Row As Integer\n    Row = Application.WorksheetFunction.Match(Clng(RTCNumber), Sheets(\"Sheet6\").Range(\"A:A\"), 0)\n    Rows(Row).EntireRow.Delete\n    Dim Row2 As Integer\n    Row2 = Application.WorksheetFunction.Match(Clng(RTCNumber), Sheets(\"Sheets1\").Range(\"A:A\"), 0)\n    Sheets(\"Sheet1\").Rows(Row2).EntireRow.Delete\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1452695636, "last_edit_date": 1452695636, "creation_date": 1452695152, "answer_id": 34769185, "question_id": 34766211, "link": "https://stackoverflow.com/questions/34766211/delete-entire-rows-from-multiple-sheets/34769185#34769185", "title": "Delete Entire Rows from multiple Sheets", "body": "<p>You can use more simple way to achieve required results using <code>range.find</code> method.<br>\nSo, your code can looks like this:</p>\n\n<pre><code>Private Sub ScrapButton_Click()\n    Dim RTCNumber As String\n    Dim Cl As Range\n    RTCNumber = RTCTextBox\n\n    msg1 = MsgBox(\"Remove \" + RTCTextBox + \" from Lab Stock?\", vbYesNo)\n\n    If msg1 = vbNo Then\n        Exit Sub\n    Else\n        With Sheets(\"Sheet1\")\n           Set Cl = .[A:A].Find(RTCNumber, , xlValues, xlWhole)\n           If Not Cl Is Nothing Then Cl.EntireRow.Delete\n        End With\n        With Sheets(\"Sheet6\")\n           Set Cl = .[A:A].Find(RTCNumber, , xlValues, xlWhole)\n           If Not Cl Is Nothing Then Cl.EntireRow.Delete\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>If you still prefer usage of <code>worksheetfunction</code> then you shall know that if <code>worksheetfunction.match</code> couldn't find the search value then it will return error, <code>worksheetfunction</code>s shall be used only with error handling.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5222435, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153061638371824/picture?type=large", "display_name": "James Pritchard", "link": "https://stackoverflow.com/users/5222435/james-pritchard"}, "is_accepted": false, "score": 0, "last_activity_date": 1452695312, "creation_date": 1452695312, "answer_id": 34769250, "question_id": 34766211, "link": "https://stackoverflow.com/questions/34766211/delete-entire-rows-from-multiple-sheets/34769250#34769250", "title": "Delete Entire Rows from multiple Sheets", "body": "<p>Brilliant, thanks for the help! </p>\n\n<p>Managed to get it working with Manu's answer with a couple tiny tweaks. It ended up like this: </p>\n\n<pre><code>Private Sub ScrapButton_Click()\n\n  Dim RTCNumber As String\n  Dim Row2 As Variant\n  Dim Row1 As Variant\n  Dim wb As Workbook\n  Dim ws1 As Worksheet\n  Dim ws6 As Worksheet\n\n  Set wb = ActiveWorkbook\n  Set ws1 = wb.Worksheets(\"Lab Stock\")\n  Set ws6 = wb.Worksheets(\"Scrap\")\n\nRTCNumber = RTCTextBox\n\nMSG1 = MsgBox(\"Remove \" &amp; RTCNumber &amp; \" from Lab Stock?\", vbYesNo)\n\nIf MSG1 = vbNo Then\n    Exit Sub\nElse\n\n    Row1 = ws6.Application.WorksheetFunction.Match(RTCNumber, ws6.Range(\"A:A\"), 0)\n    ws6.Rows(Row1).EntireRow.Delete\n\n\n    Row2 = ws1.Application.WorksheetFunction.Match(RTCNumber, ws1.Range(\"A:A\"), 0)\nws1.Rows(Row2).EntireRow.Delete\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Much, much appreciated!</p>\n"}], "owner": {"reputation": 1, "user_id": 5222435, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153061638371824/picture?type=large", "display_name": "James Pritchard", "link": "https://stackoverflow.com/users/5222435/james-pritchard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1488830429, "creation_date": 1452686533, "question_id": 34766211, "link": "https://stackoverflow.com/questions/34766211/delete-entire-rows-from-multiple-sheets", "title": "Delete Entire Rows from multiple Sheets", "body": "<p>I need some help with a vba code that will delete and entire row from a different sheet from the currently active one. </p>\n\n<p>The code uses a userform to delete a row based upon a serial number entered into a text box. The rows to delete are duplicated on the sheet the userform is activated from as well as another. Below is an example I have tried which will delete the row of the current sheet but sends back an error for the second portion of code in the Else command.</p>\n\n<pre><code>Private Sub ScrapButton_Click()\n\nDim RTCNumber As String\nRTCNumber = RTCTextBox\n\nMSG1 = MsgBox(\"Remove \" + RTCTextBox + \" from Lab Stock?\", vbYesNo)\n\nIf MSG1 = vbNo Then\n    Exit Sub\nElse\n    Dim Row As Integer\n    Row = Application.WorksheetFunction.Match(RTCNumber, Sheet6.Range(\"A:A\"), 0)\n    Rows(Row).EntireRow.Delete\n    Dim Row2 As Integer\n    Row2 = Application.WorksheetFunction.Match(RTCNumber, Sheet1.Range(\"A:A\"), 0)\n    Sheets(\"Sheet1\").Rows(Row2).EntireRow.Delete\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be much appreciated, I am probably missing something obvious but I am fairly new to vba. I have tried several options and can't get it to work using a Worksheet.Activate function.</p>\n\n<p>Thanks in advance.</p>\n\n<p>James</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1452690924, "creation_date": 1452690924, "answer_id": 34767703, "question_id": 34766117, "link": "https://stackoverflow.com/questions/34766117/insert-word-document-in-email-body/34767703#34767703", "title": "Insert Word.Document in email body?", "body": "<p>The Word object model provides the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837718.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Copy</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840284.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Paste</a> methods. See <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a> for more information. </p>\n"}], "owner": {"reputation": 27294, "user_id": 535967, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/02c46fb58177c19c7a1b57f670bddbd1?s=128&d=identicon&r=PG", "display_name": "lisovaccaro", "link": "https://stackoverflow.com/users/535967/lisovaccaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 34767703, "answer_count": 1, "score": 0, "last_activity_date": 1452690924, "creation_date": 1452686276, "last_edit_date": 1452689808, "question_id": 34766117, "link": "https://stackoverflow.com/questions/34766117/insert-word-document-in-email-body", "title": "Insert Word.Document in email body?", "body": "<p>I'm trying to create a procedure that is passed an email body (with text and tables) as a Word.Document and then sends it in an email. However I can't figure out how to insert the Word.Document to the email body.</p>\n\n<p>This is what I'm trying now:</p>\n\n<pre><code>Sub CreateDraft(Destinatary As String, CC As String, Subject As String, Body As Word.Document)\n    Dim OutApp As New Outlook.Application\n    Dim OutMail As Outlook.MailItem\n    Dim OutInspector As Outlook.Inspector\n    Dim WordDoc As Word.Document\n    Set OutMail = OutApp.CreateItem(olMailItem)\n    With OutMail\n        .To = Destinatary\n        .CC = CC\n        .Subject = Subject\n        .Display\n        Set OutInspector = OutMail.GetInspector\n        Set WordDoc = OutInspector.WordEditor ' How do I insert the Body object to the email?\n        Call .Save\n        Call .Close(False)\n    End With\nEnd Sub\n\nSub SendButton_Click()\n    Dim WordApp As New Word.Application\n    Dim WordDoc As Word.Document\n    Set WordDoc = WordApp.Documents.Add\n    WordApp.Visible = False\n    ThisWorkbook.Sheets(1).Range(\"A1:E10\").Copy\n    WordApp.Selection.PasteExcelTable False, False, False\n    Call CreateDraft(\"abc@example.com\", \"\", \"Test\", WordDoc)\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1452685511, "post_id": 34765676, "comment_id": 57276594, "body": "How is <code>pDtTemp</code> declared and assigned?"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1452685717, "post_id": 34765676, "comment_id": 57276722, "body": "@Rory I&#39;ve just added some extra code which shows pDtTemp being declared and assigned"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "edited": false, "score": 0, "creation_date": 1452685821, "post_id": 34765676, "comment_id": 57276785, "body": "in MS Access I use <code>CLng(Date)</code> instead of  <code>DateTime.Date</code>."}, {"owner": {"reputation": 2504, "user_id": 4747123, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UaHnqotY9dU/AAAAAAAAAAI/AAAAAAAAAAw/M7E4DBnMnuc/photo.jpg?sz=128", "display_name": "bri", "link": "https://stackoverflow.com/users/4747123/bri"}, "edited": false, "score": 0, "creation_date": 1452688032, "post_id": 34765676, "comment_id": 57278260, "body": "pDtTemp is declared in this method or passed in from elsewhere? If the latter, are you passing as a string or as a date? In other words -- when you debug, what is the literal value of pDtTemp?"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "edited": false, "score": 0, "creation_date": 1452688918, "post_id": 34765676, "comment_id": 57278848, "body": "when debugging pDtTemp is a date and it has the value 12/01/2016"}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1452745022, "post_id": 34765676, "comment_id": 57307968, "body": "Usually I use &quot;dd mmm yyyy&quot; to remove any ambiguity."}], "owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452692092, "creation_date": 1452684989, "last_edit_date": 1531164843, "question_id": 34765676, "link": "https://stackoverflow.com/questions/34765676/uploading-date-to-sql-server-database-issues-with-uk-date-format", "title": "uploading date to sql server database - issues with UK date format", "body": "<p>I have an excel workbook that contains some vba code. The code uploads some data to a SQL Server database.</p>\n\n<p>The code runs on my computer but not on another users. My computer is set to US date time format the other users computer is set to UK date time format.</p>\n\n<p>The error message is the following,</p>\n\n<pre><code>Conversion failed when converting date and/or time from character string\n</code></pre>\n\n<p>Below is a code snippet.</p>\n\n<p>DateEntry &amp; DateTemp are both columns of type \"Date\". </p>\n\n<p>How do I fix this? Also I don't understand why there is an error as I though a date variable was actually treated as a number.</p>\n\n<pre><code>rs.Open SQLUPLOADTABLENAME, pCn, adOpenKeyset, adLockOptimistic\n\niCol = 1\niRow = 2\n\nDo Until IsEmpty(ws.Cells(iRow, iCol))\n    rs.AddNew\n    rs(\"DateEntry\") = DateTime.Date\n    rs(\"DateTemp\") = pDtTemp\n    rs(\"Temperature\") = ws.cells(iRow, iCol)        \n    rs.Update\n    iRow = iRow + 1\nLoop\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>More info on pDtTemp. strDate is a string supplied in the format yyyymmdd</p>\n\n<pre><code>Private pDtTemp As Date\n\npDtTemp = DateTime.DateSerial(CInt(Strings.Left(strDate, 4)), CInt(Strings.Mid(strDate, 5, 2)), CInt(Strings.Right(strDate, 2)))\n</code></pre>\n\n<p><strong>Fixed</strong></p>\n\n<p>I just changed the two line to the below lines &amp; it now works. Can't say I understand completely what is going on in the background</p>\n\n<pre><code>    rs(\"DateEntry\") = Format(DateTime.Date, \"mm/dd/yyyy\")\n    rs(\"DatePrice\") = Format(pDtPrice, \"mm/dd/yyyy\")\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5781370, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7KrEAIEBhW0/AAAAAAAAAAI/AAAAAAAAAB8/avdWywnRcq4/photo.jpg?sz=128", "display_name": "Venkat Kodari", "link": "https://stackoverflow.com/users/5781370/venkat-kodari"}, "edited": false, "score": 0, "creation_date": 1452709981, "post_id": 34767970, "comment_id": 57293800, "body": "Hi Eugene,  Really thanks for your explanation and links. Is there any property that can search body for Hyperlinks. If poossible could you please give me a sample line of code for that..  Thanks"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1452691674, "creation_date": 1452691674, "answer_id": 34767970, "question_id": 34765396, "link": "https://stackoverflow.com/questions/34765396/how-to-search-unread-mail-in-outlook-with-vbscript/34767970#34767970", "title": "How to search unread mail in Outlook with VBScript?", "body": "<p>You need to use the <a href=\"http://msdn.microsoft.com/en-us/library/ff869597.aspx\" rel=\"nofollow\">Restrict</a> or <a href=\"http://msdn.microsoft.com/en-us/library/ff869662.aspx\" rel=\"nofollow\">Find</a>/<a href=\"http://msdn.microsoft.com/en-us/library/ff862482.aspx\" rel=\"nofollow\">FindNext</a> methods of the Items class. Take a look at the following articles for the sample code and more information about them:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/20/outlook-find-findnext-retrieve-mail/\" rel=\"nofollow\">How To: Use Find and FindNext methods to retrieve Outlook mail items from a folder (C#, VB.NET)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/23/outlook-restrict-method-retrieve-mail/\" rel=\"nofollow\">How To: Use Restrict method to retrieve Outlook mail items from a folder</a></li>\n</ul>\n\n<p>For example, to find all unread emails in the folder you can use the following search criteria:</p>\n\n<pre><code>  [UnRead] = true\n</code></pre>\n\n<p>Also you may find the <a href=\"http://msdn.microsoft.com/en-us/library/bb219884.aspx\" rel=\"nofollow\">AdvancedSearch</a> method of the Application class helpful. The key benefits of using the AdvancedSearch method in Outlook are:</p>\n\n<ul>\n<li>The search is performed in another thread. You don\u2019t need to run another thread manually since the AdvancedSearch method runs it automatically in the background.</li>\n<li>Possibility to search for any item types: mail, appointment, calendar, notes etc. in any location, i.e. beyond the scope of a certain folder. The Restrict and Find/FindNext methods can be applied to a particular Items collection (see the Items property of the Folder class in Outlook).</li>\n<li>Full support for DASL queries (custom properties can be used for searching too). You can read more about this in the Filtering article in MSDN. To improve the search performance, Instant Search keywords can be used if Instant Search is enabled for the store (see the IsInstantSearchEnabled property of the Store class).</li>\n<li>Finally, you can stop the search process at any moment using the Stop method of the Search class.</li>\n</ul>\n\n<p>The Outlook object model provides three main ways for working with item bodies:</p>\n\n<ul>\n<li>Body - a string representing the clear-text body of the Outlook item.</li>\n<li>HTMLBody - a string representing the HTML body of the specified item.</li>\n<li>Word editor - the Microsoft Word Document Object Model of the message being displayed. The WordEditor property of the Inspector class returns an instance of the Document class from the Word object model which you can use to set up the message body.</li>\n</ul>\n\n<p>You can read more about all these ways in the <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a>. It us up to you which way is to choose to customize the message body.</p>\n"}], "owner": {"reputation": 11, "user_id": 5781370, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7KrEAIEBhW0/AAAAAAAAAAI/AAAAAAAAAB8/avdWywnRcq4/photo.jpg?sz=128", "display_name": "Venkat Kodari", "link": "https://stackoverflow.com/users/5781370/venkat-kodari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2070, "favorite_count": 0, "closed_date": 1510302950, "accepted_answer_id": 34767970, "answer_count": 1, "score": -1, "last_activity_date": 1593517714, "creation_date": 1452684281, "last_edit_date": 1593517714, "question_id": 34765396, "link": "https://stackoverflow.com/questions/34765396/how-to-search-unread-mail-in-outlook-with-vbscript", "closed_reason": "Needs more focus", "title": "How to search unread mail in Outlook with VBScript?", "body": "<p>I am able to open Outlook, focus it to the inbox folder, and count unread mails with .Unread.</p>\n\n<p>I would like to be able to search unread email for a particular email address in the body of the emails.</p>\n\n<p>I am using Windows 7 with Outlook 2007.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1452756331, "post_id": 34766137, "comment_id": 57311658, "body": "Good answer. Suggest add the other file types as well"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1452768883, "post_id": 34766137, "comment_id": 57318974, "body": "Thanks, I was hoping to use the extension array in case I wanted to add more extensions."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 7, "last_activity_date": 1452686721, "last_edit_date": 1452686721, "creation_date": 1452686322, "answer_id": 34766137, "question_id": 34764765, "link": "https://stackoverflow.com/questions/34764765/looping-through-file-extensions-excel-vba/34766137#34766137", "title": "Looping through file extensions, excel vba", "body": "<p>The legacy short (8.3) file name for <code>HELLO.ABCD</code> would look something like <code>ABCDEF~1.ABC</code> - see the extension is truncated to 3 characters.</p>\n\n<p>In your case <code>GET.XLSM</code> would be <code>ABCDEF~1.XLS</code> and this <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20050720-16/?p=34883\">8.3 form is also matched</a> by the Win32 API <code>FindFirstFile</code> (which is what <code>Dir()</code> calls under the hood) when you specify <code>*.XLS</code></p>\n\n<p>Just filter out the exceptions in you loop with </p>\n\n<pre><code>If Not UCase$(MyFile) Like \"*.XLSM\" Then \n    ....\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1452769045, "post_id": 34784058, "comment_id": 57319088, "body": "Thank you, I was hoping to use the extension array in case I wanted to add more extensions.---Using your example: When I add <code>Like &quot;*.csv&quot;</code> and step through the code, it opens the file and names the worksheet, but does not save it. Could be a .csv issue though"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1452775238, "post_id": 34784058, "comment_id": 57322910, "body": "Davesexcel it doesn&#39;t  save but it closes?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1452775651, "post_id": 34784058, "comment_id": 57323167, "body": "Yes, when I step through the code the .csv file will open, change the sheet name, it does pass over the <code>.save</code> line then closes the workbook. When I open the CSV workbook, the sheet has not changed, indicating it did not save."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1452815451, "post_id": 34784058, "comment_id": 57347143, "body": "@Davesexcel interesting, I can duplicate this with a CSV although it works fine as I tested on xlsx etc. will investigate further."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1453640565, "post_id": 34784058, "comment_id": 57681602, "body": "That&#39;s okay the question has been answered. The .csv was just an observation. I am sure it has something to do with saving a .csv. When you do it manually, you are asked if you want to save it in that format. Possibly that dialog defaults to &quot;No&quot;, so when we <code>displayalerts=0</code> then it won&#39;t save.--Thanks"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 3, "last_activity_date": 1452757356, "creation_date": 1452757356, "answer_id": 34784058, "question_id": 34764765, "link": "https://stackoverflow.com/questions/34764765/looping-through-file-extensions-excel-vba/34784058#34784058", "title": "Looping through file extensions, excel vba", "body": "<p>While Alex has solved your query, I have updated your code below to</p>\n\n<ul>\n<li>ensure it handles all excel file types</li>\n<li>handle the sheet name already existing (else your code will error out)</li>\n<li>cleanup and properly use variables</li>\n<li><p>restore events at close</p>\n\n<pre><code>Sub LoopThroughFolder()\n\nDim Wb As Workbook\nDim MyFile As String\nDim MyDir As String\nDim StrFile As String\n\n\nMyDir = \"C:\\temp\\\"\nChDir MyDir\n\nWith Application\n    .ScreenUpdating = False\n    .DisplayAlerts = False\nEnd With\n\nStrFile = \"*.xls*\"\n\nMyFile = Dir(MyDir &amp; StrFile)\n    Do While Len(MyFile) &gt; 0\n        If MyFile Like \"*.xlsx\" Or MyFile Like \"*.xlx\" Then\n            Set Wb = Workbooks.Open(MyFile)\n            On Error Resume Next\n            Wb.Sheets(1).Name = \"MySheet\"\n            On Error GoTo 0\n\n            Wb.Save\n            Wb.Close False\n        End If\n        MyFile = Dir()\n    Loop\n\nWith Application\n    .ScreenUpdating = True\n    .DisplayAlerts = True\nEnd With\n\nEnd Sub\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "accepted_answer_id": 34766137, "answer_count": 2, "score": 2, "last_activity_date": 1453644203, "creation_date": 1452682405, "last_edit_date": 1531164843, "question_id": 34764765, "link": "https://stackoverflow.com/questions/34764765/looping-through-file-extensions-excel-vba", "title": "Looping through file extensions, excel vba", "body": "<p>I am using an Array of File extensions and looping through a folder of workbooks. The code is naming Sheet(1).name=\"MyName\"</p>\n\n<p>I notice that even though <code>\"*.xlsm\"</code> is not in the array, it is still opening and naming the sheet.</p>\n\n<h2><a href=\"https://i.stack.imgur.com/U6dxx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U6dxx.jpg\" alt=\"enter image description here\"></a></h2>\n\n<p>Here's the code. Can anybody see if they get the same problem and are able to solve it.</p>\n\n<pre><code>Sub LoopThroughFolder()\n\n    Dim MyFile As String, Str As String, MyDir As String, Wb As Workbook\n    Dim Rws As Long, Rng As Range\n    Dim fExt, ext\n    Set Wb = ThisWorkbook\n    'change the address to suite\n    MyDir = \"C:\\TestWorkBookLoop\\\"\n    ChDir MyDir\n    Application.ScreenUpdating = 0\n    Application.DisplayAlerts = 0\n    fExt = Array(\"*.xlsx\", \"*.xls\")    'file extensions, set the file extensions of the files to move\n\n    For Each ext In fExt    'loop through file extensions\n        MyFile = Dir(MyDir &amp; ext)\n\n\n        Do While MyFile &lt;&gt; \"\"\n            Workbooks.Open (MyFile)\n            Sheets(1).Name = \"MySheet\"\n\n            With ActiveWorkbook\n                .Save\n                .Close\n            End With\n\n            MyFile = Dir()\n        Loop\n    Next ext\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "vba"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 4701094, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e4fe838bff2992781ced4fb0e990b43c?s=128&d=identicon&r=PG&f=1", "display_name": "nescionomen93", "link": "https://stackoverflow.com/users/4701094/nescionomen93"}, "edited": false, "score": 0, "creation_date": 1452681160, "post_id": 34764142, "comment_id": 57273551, "body": "Pasted your code but tells me syntax error on the WHERE line"}, {"owner": {"reputation": 5011, "user_id": 2153834, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b193703d258faf436d6e13e0a756ff1d?s=128&d=identicon&r=PG", "display_name": "Vipin Jain", "link": "https://stackoverflow.com/users/2153834/vipin-jain"}, "reply_to_user": {"reputation": 57, "user_id": 4701094, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e4fe838bff2992781ced4fb0e990b43c?s=128&d=identicon&r=PG&f=1", "display_name": "nescionomen93", "link": "https://stackoverflow.com/users/4701094/nescionomen93"}, "edited": false, "score": 0, "creation_date": 1452681656, "post_id": 34764142, "comment_id": 57273913, "body": "two changes i have done in your query first remove the <code>VALUES</code> and second is single quate <code>&#39;</code> in the last."}, {"owner": {"reputation": 5011, "user_id": 2153834, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b193703d258faf436d6e13e0a756ff1d?s=128&d=identicon&r=PG", "display_name": "Vipin Jain", "link": "https://stackoverflow.com/users/2153834/vipin-jain"}, "reply_to_user": {"reputation": 57, "user_id": 4701094, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e4fe838bff2992781ced4fb0e990b43c?s=128&d=identicon&r=PG&f=1", "display_name": "nescionomen93", "link": "https://stackoverflow.com/users/4701094/nescionomen93"}, "edited": false, "score": 0, "creation_date": 1452681837, "post_id": 34764142, "comment_id": 57274036, "body": "for more helo accept my answer so i can do help for other. its point appreciate me for help other"}], "tags": [], "owner": {"reputation": 5011, "user_id": 2153834, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b193703d258faf436d6e13e0a756ff1d?s=128&d=identicon&r=PG", "display_name": "Vipin Jain", "link": "https://stackoverflow.com/users/2153834/vipin-jain"}, "is_accepted": true, "score": 2, "last_activity_date": 1452681186, "last_edit_date": 1495541046, "creation_date": 1452680683, "answer_id": 34764142, "question_id": 34763985, "link": "https://stackoverflow.com/questions/34763985/insert-into-select-doesnt-work-properly/34764142#34764142", "title": "INSERT INTO SELECT doesnt work properly", "body": "<p>I dont know about the vba but as i checked your query you write VALUES. remove this according to mysql \ntry this </p>\n\n<pre><code>INSERT INTO [Temp2]  ([Prodotto pulizie],Materiale,Compatibility)  \nSELECT CD.[Prodotto pulizie],CD.Materiale,CD.Risultato \nFROM [Compatibilit\u00e0_detergenti] as CD \nWHERE CD.[Prodotto pulizie] = 'P1' and CD.Fonte = 'INTERNA' and CD.Materiale = 'ABS';\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/5253302/insert-into-select-for-all-mysql-columns\">INSERT INTO...SELECT for all MySQL columns</a></p>\n"}], "owner": {"reputation": 57, "user_id": 4701094, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/e4fe838bff2992781ced4fb0e990b43c?s=128&d=identicon&r=PG&f=1", "display_name": "nescionomen93", "link": "https://stackoverflow.com/users/4701094/nescionomen93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 34764142, "answer_count": 1, "score": 1, "last_activity_date": 1452681186, "creation_date": 1452680287, "question_id": 34763985, "link": "https://stackoverflow.com/questions/34763985/insert-into-select-doesnt-work-properly", "title": "INSERT INTO SELECT doesnt work properly", "body": "<p>I'm using VBA on ACCESS.I have a weird problem. Here's is the main query</p>\n\n<pre><code>INSERT INTO [Temp2]  ([Prodotto pulizie],Materiale,Compatibility) VALUES \n(SELECT CD.[Prodotto pulizie],CD.Materiale,CD.Risultato \nFROM [Compatibilit\u00e0_detergenti] as CD \nWHERE CD.[Prodotto pulizie] = 'P1' and CD.Fonte = 'INTERNA' and CD.Materiale = 'ABS;);\n</code></pre>\n\n<p>It tells me that there is a sintax error but if i try the insert and the select separatley they work , in fact</p>\n\n<p><code>INSERT INTO [Temp2]  ([Prodotto pulizie],Materiale,Compatibility) VALUES ('P1','INTERNA','ABS')</code> <strong>works!</strong></p>\n\n<pre><code>SELECT CD.[Prodotto pulizie],CD.Materiale,CD.Risultato \nFROM [Compatibilit\u00e0_detergenti] as CD \nWHERE CD.[Prodotto pulizie] = 'P1' and CD.Fonte = 'INTERNA' and CD.Materiale = 'ABS;\n</code></pre>\n\n<p><strong>works!</strong>\nThe SELECT returns exactley the record i manually inserted in INSERT.\nSo basically the problem only appears when i merge insert and select, is there any sintax error you can see? </p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1919238"}, "edited": false, "score": 1, "creation_date": 1452678521, "post_id": 34762993, "comment_id": 57271678, "body": "The code you have posted looks fine.  The problem is likely somewhere else.  Have you tried using the debugger to step through and see what happens and check that every variable is as you expect?  Alternatively, add some more code to your question to make it a complete working example that demonstrates the problem."}, {"owner": {"reputation": 712, "user_id": 1849175, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2b295e72ee5a1bfdb45d1f3c9120afad?s=128&d=identicon&r=PG", "display_name": "Combinu", "link": "https://stackoverflow.com/users/1849175/combinu"}, "edited": false, "score": 0, "creation_date": 1452678672, "post_id": 34762993, "comment_id": 57271802, "body": "I debugged through it and seems that everything is ok. The problem i cannot post the declarations is that the vbcode here is part of another Development Kit and this is just an extension forexample with excel in this case its MOVICON (an engineering SCADA program)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1919238"}, "edited": false, "score": 0, "creation_date": 1452678759, "post_id": 34762993, "comment_id": 57271854, "body": "What is the behavior when debugging?  Does it go through the for loop only once?  What is the value of <code>UBound(arrLowThresholds)</code> when you debug?"}, {"owner": {"reputation": 712, "user_id": 1849175, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2b295e72ee5a1bfdb45d1f3c9120afad?s=128&d=identicon&r=PG", "display_name": "Combinu", "link": "https://stackoverflow.com/users/1849175/combinu"}, "edited": false, "score": 0, "creation_date": 1452678796, "post_id": 34762993, "comment_id": 57271881, "body": "Yes it goes once and the value is 299"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1919238"}, "edited": false, "score": 0, "creation_date": 1452678841, "post_id": 34762993, "comment_id": 57271910, "body": "Is this the actual code copied and pasted here, or did you type it in to the question?"}, {"owner": {"reputation": 712, "user_id": 1849175, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2b295e72ee5a1bfdb45d1f3c9120afad?s=128&d=identicon&r=PG", "display_name": "Combinu", "link": "https://stackoverflow.com/users/1849175/combinu"}, "edited": false, "score": 0, "creation_date": 1452678885, "post_id": 34762993, "comment_id": 57271956, "body": "No that is the actual code"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1452682028, "post_id": 34762993, "comment_id": 57274196, "body": "The code obviously isn&#39;t VBScript. Is it VBA? VB6? VB.net? What is the actual value of <code>LBound</code> and <code>UBound</code> for both arrays?"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1452686491, "post_id": 34762993, "comment_id": 57277218, "body": "@AnsgarWiechers Glad someone decided to ask this, how come it takes six comments before the actual language the OP is using versus the tagged language in the question is questioned?"}, {"owner": {"reputation": 339, "user_id": 5626469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZonuZ.jpg?s=128&g=1", "display_name": "gazzz0x2z", "link": "https://stackoverflow.com/users/5626469/gazzz0x2z"}, "edited": false, "score": 0, "creation_date": 1452696195, "post_id": 34762993, "comment_id": 57283880, "body": "And are the bounds of arrHighThresholds the same than those from arrLowThresholds?"}], "answers": [{"tags": [], "owner": {"reputation": 712, "user_id": 1849175, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2b295e72ee5a1bfdb45d1f3c9120afad?s=128&d=identicon&r=PG", "display_name": "Combinu", "link": "https://stackoverflow.com/users/1849175/combinu"}, "is_accepted": true, "score": 0, "last_activity_date": 1452779570, "last_edit_date": 1452779570, "creation_date": 1452755631, "answer_id": 34783653, "question_id": 34762993, "link": "https://stackoverflow.com/questions/34762993/array-fill-not-working-as-expected/34783653#34783653", "title": "Array fill not working as expected", "body": "<p>I solved the problem by making a local array to use with the for loop.  Then I copied the contents to the array I am actually using. </p>\n"}], "owner": {"reputation": 712, "user_id": 1849175, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/2b295e72ee5a1bfdb45d1f3c9120afad?s=128&d=identicon&r=PG", "display_name": "Combinu", "link": "https://stackoverflow.com/users/1849175/combinu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 34783653, "answer_count": 1, "score": 0, "last_activity_date": 1452779570, "creation_date": 1452677730, "last_edit_date": 1452756080, "question_id": 34762993, "link": "https://stackoverflow.com/questions/34762993/array-fill-not-working-as-expected", "title": "Array fill not working as expected", "body": "<p>I am trying to fill an array of length 300 with the same value using VB here is my code:</p>\n\n<pre><code>Dim counter As Integer\nIf (value = True) Then\n    For counter = LBound(arrLowThresholds) To UBound(arrLowThresholds) Step 1\n        arrLowThresholds(counter) = LOG_TEST_LOW_THRESHOLD\n        arrHighThresholds(counter) = LOG_TEST_HIGH_THRESHOLD\n    Next\nEnd If\n</code></pre>\n\n<p>The problem with this is that only the first element of the arrays is being filled.\nNote that some of the variables are declared elsewhere that is the reason that the declaration is not visible.</p>\n\n<p><code>arrLowThresholds</code> and <code>arrHighThresholds</code> are the arrays while <code>LOG_TEST_LOW_THRESHOLD</code> and <code>LOG_TEST_HIGH_THRESHOLD</code> are the variables</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1452704199, "post_id": 34762631, "comment_id": 57290128, "body": "Yes, that should be possible. What have you tried and how did it not work?"}, {"owner": {"reputation": 159, "user_id": 5584590, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d078ac7989871b5fd3923091b7b2021c?s=128&d=identicon&r=PG&f=1", "display_name": "codiplex", "link": "https://stackoverflow.com/users/5584590/codiplex"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1452732612, "post_id": 34762631, "comment_id": 57304640, "body": "Nope, I tried to use <code>.MoveUntil cset:=&quot;?&quot;, count:=wdBackward</code> since that in wildcard, <code>?</code> is considered as any single character but it only move backward until it find the <code>?</code> character. If it is possible, how can I do it?"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1452790825, "creation_date": 1452790825, "answer_id": 34795390, "question_id": 34762631, "link": "https://stackoverflow.com/questions/34762631/vba-ms-word-is-it-possible-to-use-moveuntil-cset-is-equal-to-any-character/34795390#34795390", "title": "VBA MS-WORD: Is it possible to use .MoveUntil Cset is equal to any character?", "body": "<p>These \"Move\" methods don't support wild cards. The value you hand to CSet has to contain the literal string characters. There are (at least) two ways you can accomplish what you postulate:</p>\n\n<pre><code>Range.MoveStartUntil Cset:=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\", Count:=wdBackward\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>Range.MoveStartWhile cSet:=vbCr, count:=wdbackward\n</code></pre>\n\n<p>Note: also works with the Selection object.</p>\n"}], "owner": {"reputation": 159, "user_id": 5584590, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/d078ac7989871b5fd3923091b7b2021c?s=128&d=identicon&r=PG&f=1", "display_name": "codiplex", "link": "https://stackoverflow.com/users/5584590/codiplex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 667, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1452790825, "creation_date": 1452676647, "last_edit_date": 1452790227, "question_id": 34762631, "link": "https://stackoverflow.com/questions/34762631/vba-ms-word-is-it-possible-to-use-moveuntil-cset-is-equal-to-any-character", "title": "VBA MS-WORD: Is it possible to use .MoveUntil Cset is equal to any character?", "body": "<p>Like for example <code>\"sampletext^p^p^p\"</code> where <code>\"^p\"</code> is the carriage return. I want to move from the last <code>\"^p\"</code> to the left until it reach any character from A to Z like for the example above is <code>\"t\"</code>. Is it possible? And I also want it be extend so it would select from the last <code>\"^p\"</code> to <code>\"t\"</code>.</p>\n\n<p>I tried to use <code>.MoveUntil cset:=\"?\", count:=wdBackward</code> since that in wildcard, <code>?</code> is considered as any single character but it only move backward until it find the ? character.</p>\n"}, {"tags": ["vba", "excel", "combinations"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1452677954, "creation_date": 1452677954, "answer_id": 34763065, "question_id": 34762571, "link": "https://stackoverflow.com/questions/34762571/possible-combination-of-data-with-constraints/34763065#34763065", "title": "Possible combination of data with constraints", "body": "<p>First of all, you might define two private boolean functions representing the constraints, here is an example of the first constraint:  </p>\n\n<pre><code>Private Function constraint1(ByVal s As Integer, ByVal p As Integer, ByVal r As Integer) As Boolean\n    If (s+r)/4 &gt; 0 Then\n        constraint1 = True\n    Else\n        constraint1 = True\n    End If\nEnd Function\n</code></pre>\n\n<p>Then, you could define a loop for all the numbers going from <code>20</code> to <code>40</code> both for <code>s</code> and <code>r</code> and verify if the three constraints are respected: if so, then you print the values on the sheet: </p>\n\n<pre><code>For s = 20 To 40\n    For p = 20 To 40\n        r = s + 2*p\n        If constraint1(s,p,r) And constraint2(s,p,r) Then\n            'it's a valid trio of (s,p,r), so you can print it on the sheet\n        End If\n    Next p \nNext s\n</code></pre>\n\n<p>P.s. I'm not sure to have understood the \"all the even numbers\", but if you really want <code>s</code> and <code>p</code> to be only even, then you can add the <code>Step</code> operator the <code>For</code> cycle in order to make it be always even: </p>\n\n<pre><code>For s = 20 To 40 Step 2\n</code></pre>\n\n<p>Like above, <code>s</code> will be <code>20</code>, then <code>22</code>, then <code>24</code> (it will basically step of 2 each loop). </p>\n"}], "owner": {"reputation": 1, "user_id": 3479570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2954f3dc9437b53bf7ef6add84c7e1b9?s=128&d=identicon&r=PG&f=1", "display_name": "Nesloais", "link": "https://stackoverflow.com/users/3479570/nesloais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1452680457, "creation_date": 1452676491, "last_edit_date": 1452680457, "question_id": 34762571, "link": "https://stackoverflow.com/questions/34762571/possible-combination-of-data-with-constraints", "title": "Possible combination of data with constraints", "body": "<p>I am working with planetary gear combination.<br>\nThe value conditions is as below:</p>\n\n<pre><code>s: min(20), max(40)  \np: min(20), max(40)  \nr: s + 2*p\n\nconstraint:  \n(s + r)/4&gt;0 : true  \np + 2 &lt; (s + p)*sin(180/4) : true\n</code></pre>\n\n<p>I would like to calculate all the possible even number combinations of s, p, and r.<br>\nThe example of output:</p>\n\n<pre><code>s       p      r  \n20     30     80  \n40     20     80  \n.  \n.  \n</code></pre>\n\n<p>Can anyone help me?<br>\nI have been looking around but have not found solution yet.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1452677032, "post_id": 34762441, "comment_id": 57270588, "body": "Can you try running <code>Application.EnableEvents = True</code> and then see if your events get fired after that?"}, {"owner": {"reputation": 17, "user_id": 5412462, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7a8aff538712b8d9b31715345ff580a3?s=128&d=identicon&r=PG&f=1", "display_name": "Daryl", "link": "https://stackoverflow.com/users/5412462/daryl"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1452678013, "post_id": 34762441, "comment_id": 57271282, "body": "I tried it but in vain, The onChange event still does not executes."}], "answers": [{"tags": [], "owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "is_accepted": false, "score": 0, "last_activity_date": 1452680165, "last_edit_date": 1452680165, "creation_date": 1452679530, "answer_id": 34763688, "question_id": 34762441, "link": "https://stackoverflow.com/questions/34762441/events-not-getting-fired-executed-in-combobox-in-excel-ribbon/34763688#34763688", "title": "Events not getting fired/executed in combobox in Excel Ribbon", "body": "<p>Hhhmmm, sorry but I'm not fully understanding what you've done.\nYou can't create a Ribbon with VBA. There are different rules with VSTO... but that's a different issue. I assume you are trying VBA development.</p>\n\n<p>So if this is the case, it looks to me that within the ribbon XML string, which is used to build the ribbon, and define the events isn't defining the OnChange event.</p>\n\n<p>So basically, again assuming this is VBA, this is what I would do.... (there's lot of tutorials on Ribbon building on the web, so I'll not define the exact  specifics here..)</p>\n\n<ol>\n<li>Save your XL file as a Zip file.</li>\n<li>Save your ribbon XML, which includes the OnChanged event in the zip archive.</li>\n<li>Put your event handlers in the Excel file.</li>\n<li>Resave as a XL file.</li>\n<li><strong>Make sure you get a reference to the Ribbon in the VBA. If you don't do this, no events will fire.</strong></li>\n<li><strong>Make sure you have the callback function for the OnChanged event.</strong></li>\n</ol>\n\n<p>If you've done steps 1 to 4 and the XML is correct, you're probably failing with steps 5. and/or 6.</p>\n\n<p>Hope that helps....</p>\n"}], "owner": {"reputation": 17, "user_id": 5412462, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/7a8aff538712b8d9b31715345ff580a3?s=128&d=identicon&r=PG&f=1", "display_name": "Daryl", "link": "https://stackoverflow.com/users/5412462/daryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452680165, "creation_date": 1452676102, "last_edit_date": 1531161705, "question_id": 34762441, "link": "https://stackoverflow.com/questions/34762441/events-not-getting-fired-executed-in-combobox-in-excel-ribbon", "title": "Events not getting fired/executed in combobox in Excel Ribbon", "body": "<p>I have created a ribbon in Excel VBA and below is the snapshot of the code to create a combo box and add some items. The combo box gets created successfully, however the onChange event is not getting fired when I select any item.</p>\n\n<pre><code>ribbonXML = ribbonXML + \"       &lt;mso:group  id='StyleGruop'  label='Styles'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"           &lt;mso:button  id='btnDeleteStyle'    imageMso='PictureStylesGallery' screentip='Delete Styles' size='large' onAction='About_onAction'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"           &lt;mso:separator  id='Separator4'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"           &lt;mso:dropDown id='ddlStyles' label='Style:' onAction='rxddSelectSheet_Click' getItemID='rxitemddSelectSheet_getItemId' getItemCount='rxitemddSelectSheet_getItemCount' getItemLabel='rxitemddSelectSheet_getItemLabel' /&gt;\" &amp; vbNewLine\n'ribbonXML = ribbonXML + \"           &lt;mso:dropDown id='ddlFreqStyles' label='Frequent Style:' getItemCount='Length1ItemCount' getItemLabel='Length1ListItem' onAction='Length1OnAction' getSelectedItemIndex='Length1ItemSelectedIndex' sizeString='centimeters' /&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"           &lt;mso:comboBox id='MyMonth' label='Month:' showLabel='true' onChange='cbMonth_onChange' getItemID='cbMonth_getItemID' getItemCount='cbMonth_getItemCount' getItemLabel='cbMonth_getItemLabel' &gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"               &lt;mso:item id='Month1' label='Jan'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"               &lt;mso:item id='Month2' label='Feb'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"               &lt;mso:item id='Month3' label='Mar'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"           &lt;/mso:comboBox&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"       &lt;/mso:group&gt;\" &amp; vbNewLine\n</code></pre>\n\n<p><strong>Below are the functions:</strong></p>\n\n<pre><code>Public Sub cbMonth_getItemID(control As IRibbonControl, index As Integer, ByRef id)\n     '\n     ' Code for getItemID callback. Ribbon control comboBox\n     '\n    returnedVal = \"Month\" &amp; index\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub cbMonth_getItemCount(control As IRibbonControl, ByRef returnedVal)\n     '\n     ' Code for getItemCount callback. Ribbon control comboBox\n     '\n    returnedVal = 12\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub cbMonth_getItemLabel(control As IRibbonControl, index As Integer, ByRef returnedVal)\n     '\n     ' Code for getItemLabel callback. Ribbon control comboBox\n     '\n\n\n    returnedVal = Format(DateSerial(2011, 7 + index, 1), \"mmm-yyyy\") 'myMonth\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub cbMonth_onChange(control As IRibbonControl, Text As String)\n     '\n     ' Code for onChange callback. Ribbon control comboBox\n     '\n    myMonth = Text\n    VBA.MsgBox myMonth\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated. Thanks in advance.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "edited": false, "score": 0, "creation_date": 1452676306, "post_id": 34762238, "comment_id": 57270072, "body": "With your date (12/01/2016) you want to retreive the 1th day in the some month, then substract one month and add one day, this loop for 6 time?!?!?!"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5750344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85ee053367b381193abba243f91c870b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wong", "link": "https://stackoverflow.com/users/5750344/lucas-wong"}, "edited": false, "score": 0, "creation_date": 1452676530, "post_id": 34762547, "comment_id": 57270232, "body": "Apologies for the confusion, I meant to say I need Jan 2016 in cell A1, instead of 1 Jan 2016 in cell A1"}, {"owner": {"reputation": 37, "user_id": 5750344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85ee053367b381193abba243f91c870b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wong", "link": "https://stackoverflow.com/users/5750344/lucas-wong"}, "edited": false, "score": 0, "creation_date": 1452676810, "post_id": 34762547, "comment_id": 57270438, "body": "Hi, I have managed to solve my problem with your solution, thank you for your help! have a great day!"}], "tags": [], "owner": {"reputation": 4203, "user_id": 2119523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fkQjy.jpg?s=128&g=1", "display_name": "Netloh", "link": "https://stackoverflow.com/users/2119523/netloh"}, "is_accepted": true, "score": 1, "last_activity_date": 1452676756, "last_edit_date": 1452676756, "creation_date": 1452676424, "answer_id": 34762547, "question_id": 34762238, "link": "https://stackoverflow.com/questions/34762238/creating-a-list-of-historical-dates-starting-today-monthly-jumps/34762547#34762547", "title": "Creating a list of historical dates starting today - monthly jumps", "body": "<p>If you got <code>12 Jan 2016</code> in cell <code>A1</code> you could then use the following formula in cell <code>A2</code> and drag down the formula down for as long as needed.</p>\n\n<pre><code>=EDATE(A1,-1)\n</code></pre>\n\n<p>This continues to give you the previous date minus 1 month.</p>\n\n<p>You could then format the cell values as <code>mmmm yyyy</code> which will give you the date format that you are looking for.</p>\n"}, {"tags": [], "owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "is_accepted": false, "score": 1, "last_activity_date": 1452676830, "creation_date": 1452676830, "answer_id": 34762685, "question_id": 34762238, "link": "https://stackoverflow.com/questions/34762238/creating-a-list-of-historical-dates-starting-today-monthly-jumps/34762685#34762685", "title": "Creating a list of historical dates starting today - monthly jumps", "body": "<p>This code will iterate over the cells from A1 to A100, and fill them with the current month and year, and for each cell, it will subtract one month:</p>\n\n<pre><code>Sub test()\n\n\nMyMonth = Date\n\n\nFor i = 1 To 100\n\n    Range(\"A\" &amp; i).Value = MyMonth\n    Range(\"A\" &amp; i).NumberFormat = \"[$-406]mmmm yyyy;@\"\n    MyMonth = DateAdd(\"m\", -1, MyMonth)\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27, "user_id": 5412691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80bcbbb2e73986931de549c85e7ff5e9?s=128&d=identicon&r=PG&f=1", "display_name": "pranav012", "link": "https://stackoverflow.com/users/5412691/pranav012"}, "is_accepted": false, "score": 0, "last_activity_date": 1452676969, "creation_date": 1452676969, "answer_id": 34762724, "question_id": 34762238, "link": "https://stackoverflow.com/questions/34762238/creating-a-list-of-historical-dates-starting-today-monthly-jumps/34762724#34762724", "title": "Creating a list of historical dates starting today - monthly jumps", "body": "<p>Write Jan 2016 in A10. Drag the cell A10 upwards. Fill series with months (Auto Fill option). Copy paste this result in other cell with values. </p>\n"}], "owner": {"reputation": 37, "user_id": 5750344, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85ee053367b381193abba243f91c870b?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas Wong", "link": "https://stackoverflow.com/users/5750344/lucas-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 34762547, "answer_count": 3, "score": 0, "last_activity_date": 1452676969, "creation_date": 1452675465, "last_edit_date": 1531161705, "question_id": 34762238, "link": "https://stackoverflow.com/questions/34762238/creating-a-list-of-historical-dates-starting-today-monthly-jumps", "title": "Creating a list of historical dates starting today - monthly jumps", "body": "<p>I am looking to create a set of dates as follows.</p>\n\n<p>For example, if today's date is 12/01/2016. </p>\n\n<p>I need:</p>\n\n<pre><code> A\n</code></pre>\n\n<p>1 Jan 2016</p>\n\n<p>2 Dec 2015</p>\n\n<p>3 Nov 2015</p>\n\n<p>4 Oct 2015</p>\n\n<p>5 Sep 2015</p>\n\n<p>6 August 2015</p>\n\n<p>and so on. </p>\n\n<p>I would appreciate all the help I can get on this matter. Thank you.</p>\n"}, {"tags": ["function", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1452674480, "post_id": 34761814, "comment_id": 57268922, "body": "I have serious problems reading what looks like obfuscated symbols. Or probably non-english naming conventions. Also, please do not include links to images (rather add them in markdown)."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5783075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc02b50650c62739838fa3791008ad0?s=128&d=identicon&r=PG", "display_name": "buri87", "link": "https://stackoverflow.com/users/5783075/buri87"}, "edited": false, "score": 0, "creation_date": 1452693676, "post_id": 34763762, "comment_id": 57282060, "body": "I don&#39;t open the form for every record. There is a button on the form which should open a Report that lists users based on the choices made in the checkboxes. Every user has a status (ie.: 1=Active, 2= Inactive, 6 = VIP, etc.) If you click on a checkbox that says Active - I wan&#39;t the report display only a list of users with status Active. If you have checkboxes at Active and VIP - I want a list in the report with both those groups of users. I only call this function in the Query that is being used by this Report. SELECT [COLUMNS] WHERE ClanT.StatusClana=SeznamClanov()"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 5783075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc02b50650c62739838fa3791008ad0?s=128&d=identicon&r=PG", "display_name": "buri87", "link": "https://stackoverflow.com/users/5783075/buri87"}, "edited": false, "score": 0, "creation_date": 1452698813, "post_id": 34763762, "comment_id": 57285840, "body": "You wrote: <i>The problem is when I use this function in a Query ...</i>  That&#39;s a no-no ... you don&#39;t open forms from running queries."}, {"owner": {"reputation": 1, "user_id": 5783075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc02b50650c62739838fa3791008ad0?s=128&d=identicon&r=PG", "display_name": "buri87", "link": "https://stackoverflow.com/users/5783075/buri87"}, "edited": false, "score": 0, "creation_date": 1452699602, "post_id": 34763762, "comment_id": 57286495, "body": "The Form is already open. When I press a button, this opens a Report. Report gets it&#39;s data from a query, which uses the function SeznamClanov() as Criteria (filter). The function gets it&#39;s data from the checkboxes on the Form and should return a string, whichs is used in the query."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 5783075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc02b50650c62739838fa3791008ad0?s=128&d=identicon&r=PG", "display_name": "buri87", "link": "https://stackoverflow.com/users/5783075/buri87"}, "edited": false, "score": 0, "creation_date": 1452700492, "post_id": 34763762, "comment_id": 57287209, "body": "If the form is open, there is no reason to try opening it again, so remove that line and you should be done."}, {"owner": {"reputation": 1, "user_id": 5783075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc02b50650c62739838fa3791008ad0?s=128&d=identicon&r=PG", "display_name": "buri87", "link": "https://stackoverflow.com/users/5783075/buri87"}, "edited": false, "score": 0, "creation_date": 1452704276, "post_id": 34763762, "comment_id": 57290176, "body": "If I comment out that line I get an error 2450 (Cannot find the refferenced Form). EDIT: I&#39;ve found out that this does not happen if this form is opened directly, only when it is open as part of another form (as a subform). I have a navigation bar in a form that opens different subforms. This subform is in the navigation pane of two different forms. Is there a way to make a relative refference to a subform? I can&#39;t use Forms!NameOfParentForm!IzpisClanovSubF!CheckAktivni because there are different parent forms. Me.IzpisClanovSubF!CheckAktivni returns an error &quot;Invalid use of Me keyword&quot;"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 5783075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc02b50650c62739838fa3791008ad0?s=128&d=identicon&r=PG", "display_name": "buri87", "link": "https://stackoverflow.com/users/5783075/buri87"}, "edited": false, "score": 0, "creation_date": 1452708738, "post_id": 34763762, "comment_id": 57292990, "body": "If you wish to refer to a specific subform not knowing the name of the parent form, you will have to loop through the subform controls (if any) of each form in the Forms collection (the forms currently open) and check the name of the form (sourceobject) that each subform control holds until a match."}, {"owner": {"reputation": 1, "user_id": 5783075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc02b50650c62739838fa3791008ad0?s=128&d=identicon&r=PG", "display_name": "buri87", "link": "https://stackoverflow.com/users/5783075/buri87"}, "edited": false, "score": 0, "creation_date": 1452709978, "post_id": 34763762, "comment_id": 57293799, "body": "Thanks for all your help. I think I&#39;m gonna ditch the submenu option and open it in the main form ..."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1452679677, "creation_date": 1452679677, "answer_id": 34763762, "question_id": 34761814, "link": "https://stackoverflow.com/questions/34761814/function-used-in-query-criteria-run-time-error-2486/34763762#34763762", "title": "Function used in query criteria - run-time error 2486", "body": "<p>You can't do that - open the form for each and every record.</p>\n\n<p>Remove this command from the function:</p>\n\n<pre><code>DoCmd.OpenForm \"IzpisClanovSubF\"\n</code></pre>\n\n<p>and run it before you open the query.</p>\n"}], "owner": {"reputation": 1, "user_id": 5783075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc02b50650c62739838fa3791008ad0?s=128&d=identicon&r=PG", "display_name": "buri87", "link": "https://stackoverflow.com/users/5783075/buri87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459413481, "creation_date": 1452674083, "last_edit_date": 1459413481, "question_id": 34761814, "link": "https://stackoverflow.com/questions/34761814/function-used-in-query-criteria-run-time-error-2486", "title": "Function used in query criteria - run-time error 2486", "body": "<p>I'm quite new to Access and programming in general.</p>\n\n<p>I have a database of users which have different statuses ie. Active, Inactive, VIP. I'm making a report that gets it's data from a query. One of the query's criteria should match the checkboxes.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tvb7A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tvb7A.png\" alt=\"Checkboxes\"></a></p>\n\n<p>I created a function SeznamClanov() which returns a string that I use as Criteria in my Query.</p>\n\n<pre><code>Public Function SeznamClanov() As String\n\nDim Predhodnik As Boolean\n\nDoCmd.OpenForm \"IzpisClanovSubF\"\n\nPredhodnik = False\n\nIf Forms!IzpisClanovSubF!CheckAktivni.Value &lt;&gt; 0 Then\n    SeznamClanov = \"1\"\n    Predhodnik = True\nEnd If\n\nIf Forms!IzpisClanovSubF!CheckNeaktivni.Value &lt;&gt; 0 Then\n    If Predhodnik = True Then\n    SeznamClanov = SeznamClanov &amp; \"&amp; 2\"\n    Else\n    SeznamClanov = SeznamClanov &amp; \"2\"\n    End If\n\n    Predhodnik = True\nEnd If\n\nIf Forms!IzpisClanovSubF!CheckIzpisani.Value &lt;&gt; 0 Then\n    If Predhodnik = True Then\n    SeznamClanov = SeznamClanov &amp; \" &amp; 4\"\n    Else\n    SeznamClanov = SeznamClanov &amp; \"4\"\n    End If\n\n    Predhodnik = True\nEnd If\n\nIf Forms!IzpisClanovSubF!CheckPokojni.Value &lt;&gt; 0 Then\n    If Predhodnik = True Then\n    SeznamClanov = SeznamClanov &amp; \" &amp; 5\"\n    Else\n    SeznamClanov = SeznamClanov &amp; \"5\"\n    End If\n\n    Predhodnik = True\nEnd If\n\nIf Forms!IzpisClanovSubF!CheckVIP.Value &lt;&gt; 0 Then\n    If Predhodnik = True Then\n    SeznamClanov = SeznamClanov &amp; \" &amp; 6\"\n    Else\n    SeznamClanov = SeznamClanov &amp; \"6\"\n    End If\n\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>When I go through this function step by step, everything works fine. The problem is when I use this function in a Query - I get an error: Run-time error '2486': You can't carry out this action at present time.</p>\n\n<p>When I run the debug tool it stops at the line </p>\n\n<pre><code>DoCmd.OpenForm \"IzpisClanovSubF\"\n</code></pre>\n\n<p>Why am I getting this error? Is there an easier way of approaching this problem?</p>\n\n<p>Thanks for your help in advance.</p>\n\n<p>Best regards!</p>\n"}, {"tags": ["vba", "catia"], "comments": [{"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1452692339, "post_id": 34761639, "comment_id": 57281104, "body": "You can move parts with the API via a manipulation/position matrix, but not necessarily with respect to constraints(I will have to dig deeper). I haven&#39;t tried clash, but I suspect it&#39;s not exposed in VBA API(only CAA) What exactly is the purpose of your script?"}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 1927287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ac9903697ec82de0aad08c10badf4c?s=128&d=identicon&r=PG", "display_name": "ferdo", "link": "https://stackoverflow.com/users/1927287/ferdo"}, "is_accepted": true, "score": 0, "last_activity_date": 1452801202, "last_edit_date": 1452801202, "creation_date": 1452710006, "answer_id": 34774408, "question_id": 34761639, "link": "https://stackoverflow.com/questions/34761639/is-it-possible-to-move-a-part-with-repect-to-constraints-in-product-using-catia/34774408#34774408", "title": "Is it possible to move a part with repect to constraints in Product using Catia vba?", "body": "<p><a href=\"http://www.eng-tips.com/search.cfm?pid=560&amp;action=Search&amp;q=clash&amp;t=&amp;h=&amp;searchSite=1&amp;searchArea=1&amp;d=1&amp;s=1\" rel=\"nofollow\">Here</a> is a link where you can find a solution for clash.</p>\n\n<p>OK, I got the idea, you want to see the code here :-)</p>\n\n<p>To compute clash in a CATScript:</p>\n\n<pre><code>    Sub CATMain()\n\n    ' get root product of document\n    Dim RootProd As Product\n    Set RootProd = CATIA.ActiveDocument.Product\n\n    ' retrieve selection object of active document\n    Dim objSelection As Selection\n    Set objSelection = CATIA.ActiveDocument.Selection\n\n    ' get two selected objects\n    If (objSelection.Count2 &lt;&gt; 2) Then\n    MsgBox \"Before running the script you must select two products to compute clash for\", vbOKOnly, \"No products selected\"\n    Exit Sub\n    End If\n\n    Dim FirstProd As Product\n    Dim SecondProd As Product\n\n    Set FirstProd = objSelection.Item2(1).Value\n    Set SecondProd = objSelection.Item2(2).Value\n\n    ' create groups for clash computation\n    Dim objGroups As Groups\n    Set objGroups = RootProd.GetTechnologicalObject(\"Groups\")\n\n    Dim grpFirst As Group\n    Dim grpSecond As Group\n\n    Set grpFirst = objGroups.Add()\n    Set grpSecond = objGroups.Add()\n\n    ' add selected products to groups\n    grpFirst.AddExplicit FirstProd\n    grpSecond.AddExplicit SecondProd\n\n\n    ' get access to Clashes collection\n    Dim objClashes As Clashes\n    Set objClashes = RootProd.GetTechnologicalObject(\"Clashes\")\n\n    ' create new clash\n    Dim newClash As Clash\n    Set newClash = objClashes.Add()\n\n    ' set new clash to be computed between two groups (two selected products)\n    newClash.FirstGroup = grpFirst\n    newClash.SecondGroup = grpSecond\n\n    newClash.ComputationType = catClashComputationTypeBetweenTwo\n\n    ' compute clash\n    newClash.Compute\n\n    End Sub \n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 3714887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/89a942d05ae795b90703e6b6e985b8b9?s=128&d=identicon&r=PG&f=1", "display_name": "user3714887", "link": "https://stackoverflow.com/users/3714887/user3714887"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 950, "favorite_count": 0, "accepted_answer_id": 34774408, "answer_count": 1, "score": -2, "last_activity_date": 1453108099, "creation_date": 1452673526, "last_edit_date": 1453108099, "question_id": 34761639, "link": "https://stackoverflow.com/questions/34761639/is-it-possible-to-move-a-part-with-repect-to-constraints-in-product-using-catia", "title": "Is it possible to move a part with repect to constraints in Product using Catia vba?", "body": "<p>I have to move a probe like sphere between two parts such that the probe is in contact with both the parts. And I have to find the point of contact of the parts, measure their distance and make a fillet on the parts based on this distance. I have achieved in moving the sphere between the parts but the sphere is moving through the parts. So trying to move with respect to constraints </p>\n\n<p>I am trying to automate the manipulate tool in Catia Product.\nIs there any command or method exist to move a part with respect to contraints  in Catia using vba ?</p>\n\n<p>Or </p>\n\n<p>Is there any way to find the clash between two parts using vba ?</p>\n\n<p>Looking Forward for a solution.</p>\n\n<p>Thank you!!!</p>\n"}, {"tags": ["vba", "excel", "listboxitem"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452674011, "post_id": 34761618, "comment_id": 57268660, "body": "Tempsheet.Range(&quot;A2:A&quot; &amp; Last_Row).Address should be &quot;tempsheet!A2:A&quot; &amp; last_row"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452674508, "post_id": 34761618, "comment_id": 57268940, "body": "Which line does the error occur on?"}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452674660, "post_id": 34761618, "comment_id": 57269032, "body": "@Nathan_Sav - I changed it but still the same error"}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452674665, "post_id": 34761618, "comment_id": 57269037, "body": "@Gareth - The error is occurring in --&gt; .RowSource = Tempsheet.Range(&quot;A2:A&quot; &amp; Last_Row).Address"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452674764, "post_id": 34761618, "comment_id": 57269108, "body": "have you done .RowSource=&quot;tempsheet!A2:A&quot; &amp; last_row ?"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452674894, "post_id": 34761618, "comment_id": 57269183, "body": "@Nathan_Sav that&#39;s not the issue as <code>Tempsheet</code> is assigned a worksheet earlier"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452674940, "post_id": 34761618, "comment_id": 57269211, "body": "@KarthikPB What&#39;s the value of <code>Last_Row</code> when the error occurs?"}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "edited": false, "score": 0, "creation_date": 1452674998, "post_id": 34761618, "comment_id": 57269244, "body": "@Nathan_Savn - Yes Exactly, .RowSource = &quot;Tempsheet!A2:A&quot; &amp; Last_Row"}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452675050, "post_id": 34761618, "comment_id": 57269283, "body": "@Gareth - Last_Row has the value 23"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452675177, "post_id": 34761618, "comment_id": 57269358, "body": "Sorry, tempsheet.name &amp; &quot;!A2:A&quot; &amp; last_row&quot; ?"}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452675317, "post_id": 34761618, "comment_id": 57269457, "body": "@Nathan_Sav - Hard luck buddy! Still the same error"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1452675976, "post_id": 34761618, "comment_id": 57269870, "body": "Have you tried the list property like ListBox1.List = Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:A5&quot;).Value"}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452676804, "post_id": 34761618, "comment_id": 57270434, "body": "@Nathan_Sav - YES!!! this is worked like a charm. Thanks a ton!"}, {"owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 0, "creation_date": 1452676903, "post_id": 34761618, "comment_id": 57270502, "body": "What is the result of <code>Tempsheet.Range(&quot;A2:A&quot; &amp; Last_Row).Address</code>. checked with <code>Debug.Print</code> or <code>MsgBox</code> etc."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452677754, "post_id": 34761618, "comment_id": 57271109, "body": "No probs, but there is an issue with the other way that you should try to get to the bottom of.  Good luck."}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "reply_to_user": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 0, "creation_date": 1452702543, "post_id": 34761618, "comment_id": 57288762, "body": "@PankajR - it contains all the data&#39;s which I have I have posted in the screen shot."}, {"owner": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 0, "creation_date": 1452702837, "post_id": 34761618, "comment_id": 57289009, "body": "@KarthikPB may be I was not clear. Let me put it this way: What you get in a Msg box if you execute <code>MsgBox Tempsheet.Range(&quot;A2:A&quot; &amp; Last_Row).Address</code> at that point."}, {"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "reply_to_user": {"reputation": 392, "user_id": 3099567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/938d9baf6e29eda581cd3d99ee9b45a2?s=128&d=identicon&r=PG&f=1", "display_name": "PankajR", "link": "https://stackoverflow.com/users/3099567/pankajr"}, "edited": false, "score": 0, "creation_date": 1453091033, "post_id": 34761618, "comment_id": 57434679, "body": "@PankajR I got $A$2:$A$32 - this is because I have data from A2 till A32 in the Column &#39;A&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "edited": false, "score": 0, "creation_date": 1452702677, "post_id": 34762762, "comment_id": 57288882, "body": "Thanks a lot I&#39;ll definitely try this approach."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1452677081, "creation_date": 1452677081, "answer_id": 34762762, "question_id": 34761618, "link": "https://stackoverflow.com/questions/34761618/could-not-set-the-rowsource-property-invalid-property-value/34762762#34762762", "title": "Could not set the RowSource Property. Invalid Property Value", "body": "<p>The code works for me, when you are in the Userform Module, step through the code by pressing F8, this will step through each line of the code. See if these variables are collecting values.</p>\n\n<h2><a href=\"https://i.stack.imgur.com/4iSCa.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4iSCa.jpg\" alt=\"Variables\"></a></h2>\n\n<p>If there are no values when you step through the lines, then something could be wrong with the \"TempFile\", such as the wrong sheet or something.</p>\n\n<p>Also make sure your Rowsource is blank in the Listbox properties.</p>\n\n<h2><a href=\"https://i.stack.imgur.com/nT1wI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nT1wI.jpg\" alt=\"enter image description here\"></a></h2>\n\n<p>You can also use the List Properties instead of rowsource, for example:</p>\n\n<pre><code>    Private Sub ComboBox1_Change()\n\n    Dim wb123 As Workbook, TempFile As Workbook\n    Dim Tempsheet As Worksheet\n    Dim Last_Row As Long, rng As Range\n\n\n    Set wb123 = ThisWorkbook\n    Set TempFile = Workbooks.Open(\"C:\\Users\\Dave\\Downloads\\\" &amp; ComboBox1)\n\n    Set Tempsheet = TempFile.Worksheets(\"Sheet2\")\n\n    With Tempsheet\n        Last_Row = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Set rng = .Range(\"A2:A\" &amp; Last_Row)\n    End With\n\n\n    With ListBox1\n        .ColumnCount = 1\n        .ColumnWidths = \"50\"\n        .List = rng.Value\n    End With\n\n    TempFile.Close True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "edited": false, "score": 0, "creation_date": 1452702744, "post_id": 34763040, "comment_id": 57288938, "body": "Yes it&#39;s working fine with this particular for loop approach too. Thanks a ton! Now I have couple of more ways to achieve the end result :)"}], "tags": [], "owner": {"reputation": 345, "user_id": 5751405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10313ce426cd7ad6ac43784d6f6bc963?s=128&d=identicon&r=PG&f=1", "display_name": "Genie", "link": "https://stackoverflow.com/users/5751405/genie"}, "is_accepted": false, "score": 2, "last_activity_date": 1452677872, "creation_date": 1452677872, "answer_id": 34763040, "question_id": 34761618, "link": "https://stackoverflow.com/questions/34761618/could-not-set-the-rowsource-property-invalid-property-value/34763040#34763040", "title": "Could not set the RowSource Property. Invalid Property Value", "body": "<p>As a quick fix you could substitute</p>\n\n<p><code>.RowSource = Tempsheet.Range(\"A2:A\" &amp; Last_Row).Address</code> </p>\n\n<p>with </p>\n\n<p><code>.RowSource = \"=Sheet2!A2:A\" &amp; Last_Row</code></p>\n\n<p>Another way to do it is to use a <code>For</code> loop to got through the cells and add them one at a time. I usually use the way below if I want to do some additional actions before adding an item to my combo box e.g. have an <code>If</code> statement to judge if I want that cell value to be added.</p>\n\n<pre><code>For i = 2 to Last_Row 'Start from row 2 to Last_Row\n     .AddItem Tempsheet.Cells(i,1).Value 'Add the item in the first column\nNext i\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 3814879, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/543012cc84fa98f7da7493ebf9ce3c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Karthik P B", "link": "https://stackoverflow.com/users/3814879/karthik-p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14155, "favorite_count": 0, "accepted_answer_id": 34762762, "answer_count": 2, "score": 1, "last_activity_date": 1452677872, "creation_date": 1452673449, "question_id": 34761618, "link": "https://stackoverflow.com/questions/34761618/could-not-set-the-rowsource-property-invalid-property-value", "title": "Could not set the RowSource Property. Invalid Property Value", "body": "<p>I have an excel where I have populated few data in column 'A', I want the data to appear in the List box which is in my User Form. But I'm repeatedly getting the Run-time Error 380 stating \"Could not set the RowSource Property. Invalid property value\" \nBelow is the code.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\nDim wb123 As Workbook, TempFile As Workbook\nDim Tempsheet As Worksheet\nDim Last_Row As Integer\n\n\n Set wb123 = ThisWorkbook\nSet TempFile = Workbooks.Open(\"C:\\Users\\inkapb\\AppData\\Local\\Temp\\EPC AutoTool\\Projects\\\" &amp; Me.ComboBox1.Text &amp; \"\\Template.xlsm\")\n\n Set Tempsheet = TempFile.Worksheets(\"Sheet2\")\nLast_Row = Tempsheet.Cells(Tempsheet.Rows.count, \"A\").End(xlUp).Row\n\n     With ListBox1\n\n    .ColumnCount = 1\n    .ColumnWidths = \"50\"\n    .RowSource = Tempsheet.Range(\"A2:A\" &amp; Last_Row).Address\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>And here is my excel sheet which contains the data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/P4ZgA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P4ZgA.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452673160, "post_id": 34761491, "comment_id": 57268107, "body": "Just to clarify, when you say <code>8781341</code>, are they individual numbers in separate columns?"}, {"owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452673219, "post_id": 34761491, "comment_id": 57268146, "body": "Nope, as u can see the selection is trough 1 column only <code>&quot;A14:A&quot;</code>"}, {"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452673303, "post_id": 34761491, "comment_id": 57268200, "body": "So they&#39;re in individual rows?"}, {"owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452673396, "post_id": 34761491, "comment_id": 57268260, "body": "I clarified in the first post. Yes, each cell in the range from <code>A14</code> trough <code>A lastrow+13</code> is filled with integer numbers like <code>&quot;629984&quot;</code> as you can see from the figure above"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1452673580, "post_id": 34761491, "comment_id": 57268369, "body": "AFAIK you can&#39;t avoid <code>Varaint</code> and a loop in this case.  It&#39;s one of the few cases where Variants <i>should</i> be used.  And BTW <code>8781341</code> doesn&#39;t fit in an Interger, you would need a Long"}, {"owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452673700, "post_id": 34761491, "comment_id": 57268446, "body": "@chrisneilsen Thanks for the answer. Since a read that best practice (for speed) is avoid Variants I was trying to avoid them."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452675001, "post_id": 34761491, "comment_id": 57269247, "body": "@gmeroni yes, it&#39;s best to avoid them when you can.  In this can I don&#39;t think you can (except by a loop, but that would be counter-productive)"}, {"owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452675103, "post_id": 34761491, "comment_id": 57269312, "body": "@chrisneilsen Yup. I&#39;m just new to VBA so I&#39;m learing all the best practices and the workarounds :) Thanks again"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452675303, "post_id": 34761491, "comment_id": 57269449, "body": "@gmeroni I&#39;ll add it as an answer so Q can be closed"}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1452675367, "creation_date": 1452675367, "answer_id": 34762203, "question_id": 34761491, "link": "https://stackoverflow.com/questions/34761491/vba-populate-array-in-1-row/34762203#34762203", "title": "VBA Populate array in 1 row", "body": "<p>AFAIK you can't avoid <code>Varaint</code> and a loop in this case. It's one of the few cases where Variants should be used. </p>\n\n<p>It is best to avoid <code>Variant</code>s when you can. In this can I don't think you can (except by a loop, but that would be counter-productive)</p>\n\n<p>And BTW <code>8781341</code> doesn't fit in an Interger, you would need a Long</p>\n"}], "owner": {"reputation": 571, "user_id": 2349516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9e981a07089b3ec832c6dc3d8dd5f84a?s=128&d=identicon&r=PG", "display_name": "gmeroni", "link": "https://stackoverflow.com/users/2349516/gmeroni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 34762203, "answer_count": 1, "score": 0, "last_activity_date": 1452675367, "creation_date": 1452673028, "last_edit_date": 1531164843, "question_id": 34761491, "link": "https://stackoverflow.com/questions/34761491/vba-populate-array-in-1-row", "title": "VBA Populate array in 1 row", "body": "<p>I'm struggling with arrays and their type. I've a single Worksheet column A (type General) filled with integer numbers like \"629984\". When, in VBA, I declare an array and try to populate it directly based on a range selection from row <code>14</code> to <code>lastrow + 13</code> like this:</p>\n\n<pre><code>ReDim TempID(1 To lastrow + 13, 1 To 1) As Integer\nTempID = OppsClosed.Range(\"A14:A\" &amp; lastrow + 13).Value\n</code></pre>\n\n<p>I get a Type Mismatch error. Putting and Ad-watch on <code>OppsClosed.Range(\"A14:A\" &amp; lastrow + 13).Value</code> I understand that the type is <code>Variant/Double</code>.\n<em>Each cell in the range from <code>A14</code> trough <code>A13955</code> is filled with integer numbers like \"629984\" as you can see from the figure below</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/J17bJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J17bJ.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>My question is</strong>: How can I avoid using <code>variant</code>? Is the loop the only way? </p>\n"}, {"tags": ["excel", "vba", "if-statement", "for-loop", "do-while"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452671670, "post_id": 34760722, "comment_id": 57267310, "body": "What is your question?"}, {"owner": {"reputation": 35, "user_id": 5649732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294effda5a1a1c8f6bb5c9b496f88448?s=128&d=identicon&r=PG&f=1", "display_name": "Maverick27", "link": "https://stackoverflow.com/users/5649732/maverick27"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452671932, "post_id": 34760722, "comment_id": 57267421, "body": "@Gareth I have Edited it"}], "answers": [{"tags": [], "owner": {"reputation": 926, "user_id": 5621032, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/zG42x.jpg?s=128&g=1", "display_name": "Kathara", "link": "https://stackoverflow.com/users/5621032/kathara"}, "is_accepted": true, "score": 0, "last_activity_date": 1453196560, "last_edit_date": 1453196560, "creation_date": 1452673287, "answer_id": 34761575, "question_id": 34760722, "link": "https://stackoverflow.com/questions/34760722/vba-excel-do-while-statement/34761575#34761575", "title": "VBA Excel Do While Statement", "body": "<p>Hi I am not too good in this, so I will just adapt the things I saw right away. But first: in which column is the start-date/time, in which is the end-date/time? Is it all in the same column?</p>\n\n<pre><code>Sub EX01()\n\nDim ColCount As Long    \nDim startrow As Long\nDim endrow As Long\nDim i As Long\nDim j As Long\nDim nextRow As Long\nDim Cumm As Double\n</code></pre>\n\n<p>I believe it's an old practice to declare variables on 1 line only. Also I think it's not a good habbit. If I am correct this is just the better way to keep track of all the variables that are used.</p>\n\n<pre><code>Set wb = ThisWorkbook\nSet ws = wb.Sheets(\"XACT RE\")\nSet ws3 = wb.Sheets(\"RE_EX 01\")\n\nws.Activate\n</code></pre>\n\n<p>I recently learned that .select is never a good idea, try workaround!</p>\n\n<pre><code>'startrow = Cells(1, 2).Value\n'endrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row - 1\n'Cells(1, 28) = startrow\n</code></pre>\n\n<p>Is it correct, that you want to enter the value of Cell(B1) into Cell(AB1)?? if yes try this instead:</p>\n\n<pre><code>ws.Cells(1,28).Value = ws.Cells(1,2).Value\n'Cells(1, 29) = endrow\n\nstartrow = ws.Rows(1)\nendrow = ws.Cells(ws.Rows.count, \"a\").End(xlUp).Row  'this will give you the last entry on this worksheet\n\n'nextRow = 2\n</code></pre>\n\n<p>This will always stay 2 I believe what you want is this:</p>\n\n<pre><code>nextRow = (ws3.Cells(ws3.Rows.Count, \"a\").End(xlUp).Row) + 1\n\nFor j = 3 To 6\n    For i = startrow To endrow\n        ws3.Cells(nextRow, 1) = ws.Cells(i + 1, 2) - (ws.Cells(i, j).Value / 24) 'get next row time and subtract the hours in this cell\n        ws3.Cells(nextRow, 3) = ws.Cells(3, j)\n        Cumm = Cumm + ws.Cells(i, j).Value\n</code></pre>\n\n<p>Do you want to print Cumm somewhere? otherwise this will just run through...\nAlso you're already doing this 1 line in code up!</p>\n\n<pre><code>        Do While ws.Cells(i + 1, j).Value &gt;= 12\n            i = i + 1\n            Cumm = Cumm + ws.Cells(i, j).Value\n        Loop\n</code></pre>\n\n<p>The loop will exit, as soon as in the next row of the searched cell there is a value of \"12\"</p>\n\n<pre><code>        ws3.Cells(nextRow, 2) = ws.Cells(i, 2).Value + ((ws.Cells(i, j).Value) * (0.5 / 12))\n        ws3.Cells(nextRow, 8) = Cumm\n        nextRow = nextRow + 1\n\n    Next i\nNext j\n\nEnd Sub\n</code></pre>\n\n<p>Also ALWAYS be very specific from which worksheet you're adressing the cells. With a little more info I might help you a little better :)</p>\n"}], "owner": {"reputation": 35, "user_id": 5649732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/294effda5a1a1c8f6bb5c9b496f88448?s=128&d=identicon&r=PG&f=1", "display_name": "Maverick27", "link": "https://stackoverflow.com/users/5649732/maverick27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 34761575, "answer_count": 1, "score": 0, "last_activity_date": 1453196560, "creation_date": 1452670044, "last_edit_date": 1452671895, "question_id": 34760722, "link": "https://stackoverflow.com/questions/34760722/vba-excel-do-while-statement", "title": "VBA Excel Do While Statement", "body": "<p>I am trying to determine run time of equipment in a shift which is output in the following form;</p>\n\n<pre><code>    27/01/2016 18:00:00         4\n    28/01/2016 6:00:00         12\n    28/01/2016 18:00:00         4\n    29/01/2016 6:00:00          0\n</code></pre>\n\n<p>The Macro aims to loop down columns and recording the start time and end time of shifts i.e</p>\n\n<pre><code>    28/01/2016 02:00 to 28/01/2016 22:00:00. \n</code></pre>\n\n<p>If there is a zero after the block is composed of the consecutive hours.</p>\n\n<p>However if there is a gap in time like below the second 4 hour becomes an individual block:</p>\n\n<pre><code>    27/01/2016 18:00:00         4\n    28/01/2016 6:00:00         12\n    28/01/2016 18:00:00         0\n    29/01/2016 6:00:00          4\n</code></pre>\n\n<p>My current code looks like the following</p>\n\n<pre><code>  Sub EX01()\n\nDim ColCount As Long\nDim startrow, endrow As Long\nDim i, j As Long\nDim nextRow As Long\nDim Cumm As Double\n\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"XACT RE\")\nSet ws3 = wb.Sheets(\"RE_EX 01\")\n\nws.Select\n\n\n\n\nstartrow = Cells(1, 2).Value\nendrow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row - 1\nCells(1, 28) = startrow\nCells(1, 29) = endrow\n\nnextRow = 2 'this is the row to put info on RE sheet\n\nFor j = 3 To 6\nFor i = startrow To endrow\n\n    Cumm = 0\n    If Cells(i, j) &lt;&gt; 0 Then\n\n        'this is the inital pickup row\n            ws3.Cells(nextRow, 1) = ws.Cells(i + 1, 2) - (ws.Cells(i, j).Value / 24) 'get next row time and subtract the hours in this cell\n            ws3.Cells(nextRow, 3) = ws.Cells(3, j)\n            Cumm = Cumm + ws.Cells(i, j).Value\n\n            'now check how long the run goes for and add the delay data to Cumm\n        Do While Cells(i + 1, j).Value &gt;= 12\n                        i = i + 1\n            Cumm = Cumm + ws.Cells(i, j).Value\n\n\n        Loop\n\n        'this exits loop if less than 10\n        ws3.Cells(nextRow, 2) = ws.Cells(i, 2).Value + ((ws.Cells(i, j).Value) * (0.5 / 12))\n        ws3.Cells(nextRow, 8) = Cumm\n        nextRow = nextRow + 1\n\n\n    End If\n\n\n\n  Next i\n Next j\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>So My Question is how do I account for single shifts less than 12 hours and how do I account for small shifts (less than 12) that occur following a 12 hour shift....</p>\n"}, {"tags": ["vba", "autocad", "autocad-plugin"], "comments": [{"owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452672198, "post_id": 34760523, "comment_id": 57267569, "body": "Without the code, any answer is a stab in the dark."}, {"owner": {"reputation": 89, "user_id": 5637841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fb08ebaa070580b841dfe1d061775e8?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu", "link": "https://stackoverflow.com/users/5637841/divyanshu"}, "reply_to_user": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "edited": false, "score": 0, "creation_date": 1452675649, "post_id": 34760523, "comment_id": 57269662, "body": "@Gareth Hey, my main problem is to debug, as i am unable to get the exact line, where it shows the error. may be because of plugin. don&#39;t know!"}, {"owner": {"reputation": 8051, "user_id": 4838205, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RBf0X.jpg?s=128&g=1", "display_name": "Augusto Goncalves", "link": "https://stackoverflow.com/users/4838205/augusto-goncalves"}, "edited": false, "score": 0, "creation_date": 1452714056, "post_id": 34760523, "comment_id": 57296361, "body": "this happens because the VBA engine cannot find the object &amp; method on the library, so when it tries to run the method, it throws the error. That&#39;s why you cannot see the line where it happens. For instance, you may create another sub and call you test() routine."}, {"owner": {"reputation": 12144, "user_id": 200443, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ecab68fc9d47b9b52459cca80773aa89?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/200443/maxence"}, "edited": false, "score": 0, "creation_date": 1452846126, "post_id": 34760523, "comment_id": 57355933, "body": "&gt; scroll doesn&#39;t work. The VBA IDE has not changed since 1998. At this time, scroll wheel just began to gain some traction."}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 0, "creation_date": 1452846799, "post_id": 34760523, "comment_id": 57356272, "body": "You could set a breakpoint at your very first line, and then traverse your code step by step."}, {"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1458055949, "post_id": 34760523, "comment_id": 59682709, "body": "Can you load the code into a module, instead of &quot;ThisDrawing&quot;, then debug?"}], "answers": [{"comments": [{"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 0, "creation_date": 1452846689, "post_id": 34806937, "comment_id": 57356203, "body": "What IDE should he use instead?"}, {"owner": {"reputation": 12144, "user_id": 200443, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ecab68fc9d47b9b52459cca80773aa89?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/200443/maxence"}, "reply_to_user": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 0, "creation_date": 1452846947, "post_id": 34806937, "comment_id": 57356339, "body": "<a href=\"https://www.visualstudio.com/post-download-vs?sku=community&amp;clcid=0x40c\" rel=\"nofollow noreferrer\">Visual Studio</a>. The Community Edition is free for individuals, small organizations, learning environment, academic research and open source projects. Please read the <a href=\"https://www.visualstudio.com/support/legal/dn877550\" rel=\"nofollow noreferrer\">license terms</a> to see if it fits to your usage. You can read this <a href=\"http://usa.autodesk.com/adsk/servlet/index?id=18162650&amp;siteID=123112\" rel=\"nofollow noreferrer\">tutorial</a> to start."}], "tags": [], "owner": {"reputation": 12144, "user_id": 200443, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ecab68fc9d47b9b52459cca80773aa89?s=128&d=identicon&r=PG", "display_name": "Maxence", "link": "https://stackoverflow.com/users/200443/maxence"}, "is_accepted": true, "score": 1, "last_activity_date": 1452846980, "last_edit_date": 1452846980, "creation_date": 1452846443, "answer_id": 34806937, "question_id": 34760523, "link": "https://stackoverflow.com/questions/34760523/debugging-in-autocad-vba-ide-is-not-displaying-where-the-error-is/34806937#34806937", "title": "Debugging in autocad VBA ide is not displaying where the error is", "body": "<p>The VBA IDE is pretty old (1998) and it has limited debugging abilities. You should stop using this, it's an obsolete technology, not actively supported by Microsoft/Autodesk anymore.</p>\n\n<p>For some errors, it is not able to locate the line where the error occurred, and you're left with obscure error codes and useless messages.</p>\n"}, {"tags": [], "owner": {"reputation": 707, "user_id": 100979, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/062f4b89c9acfb6c577923ecdf888f3d?s=128&d=identicon&r=PG", "display_name": "mohnston", "link": "https://stackoverflow.com/users/100979/mohnston"}, "is_accepted": false, "score": 0, "last_activity_date": 1454438313, "creation_date": 1454438313, "answer_id": 35161347, "question_id": 34760523, "link": "https://stackoverflow.com/questions/34760523/debugging-in-autocad-vba-ide-is-not-displaying-where-the-error-is/35161347#35161347", "title": "Debugging in autocad VBA ide is not displaying where the error is", "body": "<p>Have you tried setting a breakpoint at the first possible line? (Set acDocu = ThisDrawing.Application.ActiveDocument)\nThen step through to see the offending object/property/method.\nIt doesn't always work.</p>\n"}, {"comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1458055967, "post_id": 36015540, "comment_id": 59682724, "body": "I have added the comment for you. You can delete the post."}, {"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1458056083, "post_id": 36015540, "comment_id": 59682823, "body": "Answers are used for complete answers only! It is better to comment. Sadly, you don&#39;t have rep."}, {"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 1, "creation_date": 1458056605, "post_id": 36015540, "comment_id": 59683202, "body": "Nice that you understood. Answer some good questions, you&#39;ll get to 50 in no time :)"}], "tags": [], "owner": {"reputation": 85, "user_id": 557167, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a63be38501a446613975ace3d9bbf8f?s=128&d=identicon&r=PG", "display_name": "tmccar", "link": "https://stackoverflow.com/users/557167/tmccar"}, "is_accepted": false, "score": 0, "last_activity_date": 1458055694, "creation_date": 1458055694, "answer_id": 36015540, "question_id": 34760523, "link": "https://stackoverflow.com/questions/34760523/debugging-in-autocad-vba-ide-is-not-displaying-where-the-error-is/36015540#36015540", "title": "Debugging in autocad VBA ide is not displaying where the error is", "body": "<p>Can you load the code into a module, instead of \"ThisDrawing\", then debug?</p>\n"}], "owner": {"reputation": 89, "user_id": 5637841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fb08ebaa070580b841dfe1d061775e8?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu", "link": "https://stackoverflow.com/users/5637841/divyanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 0, "accepted_answer_id": 34806937, "answer_count": 3, "score": 0, "last_activity_date": 1458055694, "creation_date": 1452669325, "last_edit_date": 1452675575, "question_id": 34760523, "link": "https://stackoverflow.com/questions/34760523/debugging-in-autocad-vba-ide-is-not-displaying-where-the-error-is", "title": "Debugging in autocad VBA ide is not displaying where the error is", "body": "<p>Whenever i am trying to debug or run the program and if it encounters error, the VBE (Autocad) doesn't display the line where the error is, unlike in other IDEs, it used to come at that line and highlight with yellow color. Also, the scroll doesn't work. I know i should install plugins but i am unable to help myself.\n<a href=\"https://i.stack.imgur.com/ZPVp0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZPVp0.jpg\" alt=\"enter image description here\"></a> </p>\n\n<pre><code>Option Explicit\n    Sub Test()\n    'Declarations\n    'Opened Document\n    Dim acDocu As AcadDocument\n    Set acDocu = ThisDrawing.Application.ActiveDocument\n\n    'Select on screen\n    Dim acSelectionSet As AcadSelectionSet\n    Set acSelectionSet = ThisDrawing.SelectionSets.Add(\"SjjEffffT\")\n    acSelectionSet.SelectOnScreen\n\n    'Manipulating in loops for finding group names having objects selected\n    Dim entity As AcadEntity\n    Dim entityhandle() As String\n    Dim Grp As AcadGroup\n    Dim groupname() As String\n    Dim i As Integer\n    i = 0\n    Dim j As Integer\n    j = 0\n    Dim temp As Integer\n    temp = 0\n    Dim GrpEnt As AcadEntity\n    Dim grpenthandle As String\n    Dim entity_count As Integer\n    'Dim entity_array As Variant\n    entity_count = acSelectionSet.Count\n    ReDim entityhandle(entity_count)\n    ReDim groupname(entity_count)\n    For Each entity In acSelectionSet\n    'entity_array = entity\n            entityhandle(i) = entity.Handle\n            For Each Grp In ThisDrawing.groups\n                   For Each GrpEnt In Grp\n                   grpenthandle = GrpEnt.Handle\n                   If entityhandle(i) = grpenthandle Then\n                        If temp = 0 Then\n                            groupname(j) = Grp.Name\n                            Debug.Print \"Group in selection:\" &amp; groupname(j)\n                            j = j + 1\n                        End If\n\n                   End If\n              temp = temp + 1\n            Next\n            temp = 0\n        Next\n        i = i + 1\n    Next\n\n   'Copying the objects and pasting into new drawing\n   Dim acDocto As AcadDocument\n   Dim file_name As String\n   'file_name = InputBox(\"Enter the file name along with full path and extension\")\n   file_name = \"D:\\PI_Tool_files_3223\\D00440023new.DWG\"\n   Set acDocto = Documents.Open(file_name)\n   Dim acObject As AcadObject\n   Dim retvalue As Variant\n   retvalue = acDocu.CopyObjects(entityhandle, acDocto.ModelSpace)\n\n   acSelectionSet.Delete\n   End Sub\n</code></pre>\n\n<p>The code is written above. But i think the problem is with the add-in as i can't debug.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1452680494, "post_id": 34760458, "comment_id": 57273093, "body": "Hi @Alex4336, no, I have not tried anything yet. I do not know how to write code from scratch..."}, {"owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "reply_to_user": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1452692706, "post_id": 34760458, "comment_id": 57281362, "body": "Please someone help... Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "edited": false, "score": 0, "creation_date": 1452776717, "post_id": 34769589, "comment_id": 57323859, "body": "Hi thank you for this. This is something that I can work with. What if instead of different worksheets, make it different workbooks? Is this a big change in code? Thank you so much @Alex4336"}, {"owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "edited": false, "score": 0, "creation_date": 1452778096, "post_id": 34769589, "comment_id": 57324773, "body": "This is working! Just a few edits and I guess this will be perfect! Thank you for this! I have a follow up question though, what if instead of different worksheets, make it different workbooks? Is this a big change in code? Thank you so much @Alex4336"}, {"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "reply_to_user": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "edited": false, "score": 0, "creation_date": 1452778728, "post_id": 34769589, "comment_id": 57325180, "body": "It is certainly possible to make it for different workbooks, but I think that it will require opening the specific workbook, if it exist, or otherwise create one, at a folder of your choice ofc."}], "tags": [], "owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "is_accepted": true, "score": 0, "last_activity_date": 1452696349, "creation_date": 1452696349, "answer_id": 34769589, "question_id": 34760458, "link": "https://stackoverflow.com/questions/34760458/central-worksheet-that-distributes-content-to-other-worksheets-based-on-certain/34769589#34769589", "title": "Central worksheet that distributes content to other worksheets based on certain criteria", "body": "<p>This code will do the trick of copying the data to the appropriate sheet. It doesn't clear the sheets beforehand, meaning that if you run the macro multiple times, it will add the same entries after the entries already there, but it should give you a palce to start.</p>\n\n<pre><code>Option Explicit\nSub test()\n\nDim col As New Collection, cell As Range, ChkRng As Range, entry As Variant, lstRw As Long, i As Long\n\nWith Sheets(\"Masterlog\")\n    Set ChkRng = .Range(\"A4:A\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row)\nEnd With\n\nOn Error Resume Next\n\nFor Each cell In ChkRng\n    If col.Count = 0 Then GoTo Add\n        For i = 1 To col.Count\n            If cell.Value Like \"*\" &amp; col.Item(i) Then\n                GoTo continue\n            End If\n        Next i\nAdd:\n            col.Add cell.Value, cell.Value\n\n\n\ncontinue:\n\nNext cell\nOn Error GoTo 0\n\nFor Each cell In ChkRng\n    For i = 1 To col.Count\n\n\n\n            If cell.Value = col.Item(i) Then\n                If WorksheetExists(col.Item(i)) = False Then\n                    Worksheets.Add , Sheets(\"Masterlog\")\n                    ActiveSheet.Name = col.Item(i)\n                    With Sheets(col.Item(i))\n                        lstRw = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n                        .Range(\"A\" &amp; lstRw) = cell.Value\n                        .Range(\"A\" &amp; lstRw).Offset(0, 1) = cell.Offset(0, 1).Value\n                    End With\n                Else\n                    With Sheets(col.Item(i))\n                        lstRw = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row + 1\n                        .Range(\"A\" &amp; lstRw) = cell.Value\n                        .Range(\"A\" &amp; lstRw).Offset(0, 1) = cell.Offset(0, 1).Value\n                    End With\n                End If\n                GoTo onwards\n            ElseIf cell.Value Like \"*\" &amp; col.Item(i) = True Then\n                If WorksheetExists(col.Item(i)) = False Then\n                        Worksheets.Add , Sheets(\"Masterlog\")\n                        ActiveSheet.Name = col.Item(i)\n                    With Sheets(col.Item(i))\n                        lstRw = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n                        .Range(\"A\" &amp; lstRw) = cell.Value\n                        .Range(\"A\" &amp; lstRw).Offset(0, 1) = cell.Offset(0, 1).Value\n                    End With\n                Else\n                    With Sheets(col.Item(i))\n                        lstRw = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row + 1\n                        .Range(\"A\" &amp; lstRw) = cell.Value\n                        .Range(\"A\" &amp; lstRw).Offset(0, 1) = cell.Offset(0, 1).Value\n                    End With\n                End If\n                GoTo onwards\n            End If\n\n\n    Next i\nonwards:\nNext cell\n\nEnd Sub\n\nPublic Function WorksheetExists(ByVal WorksheetName As String) As Boolean\n\nOn Error Resume Next\nWorksheetExists = (Sheets(WorksheetName).Name &lt;&gt; \"\")\nOn Error GoTo 0\n\nEnd Function\n</code></pre>\n\n<p>Currently it transfers both the value in Column A and the value in Column B, but you should change that to your needs.</p>\n\n<p>It works for your example. I don't know about more complicated patterns.</p>\n"}], "owner": {"reputation": 31, "user_id": 5211201, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0fbaae6c2f81617292598d64bd3815ae?s=128&d=identicon&r=PG&f=1", "display_name": "VeeEss", "link": "https://stackoverflow.com/users/5211201/veeess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 34769589, "answer_count": 1, "score": 0, "last_activity_date": 1452698143, "creation_date": 1452669106, "last_edit_date": 1531161705, "question_id": 34760458, "link": "https://stackoverflow.com/questions/34760458/central-worksheet-that-distributes-content-to-other-worksheets-based-on-certain", "title": "Central worksheet that distributes content to other worksheets based on certain criteria", "body": "<p>Is there a macro that can transfer rows of data to a different worksheet depending on a certain value from that row. For example, I have the following data in a central worksheet, Masterlog.xls:</p>\n\n<p>(a hyphen denotes a column)</p>\n\n<p><li>Apples - 12312312\n<li>Green Apples - 32132132\n<li>Mangoes - 00000000\n<li>Green Mangoes - 11111111\n<li>Bananas - 22222222</p>\n\n<p>The masterlog data is updated daily and manually by 2 people. Sometimes the data is a duplicate of yesterday's and I was also hoping for a macro that ignores duplicates and remembers data from 2 days ago but clears data that is older.</p>\n\n<p>Column A's value will determine which worksheet the row of data will go to.</p>\n\n<p><li>Apples - 12312312 should be transferred to the Worksheet Apples.xls\n<li>Green Apples - 32132132 is also transferred to Apples.xls on the next row.\n<li>Mangoes - 00000000 goes to Mangoes.xls and so on.</p>\n\n<p>The macro should always write on the first empty row after the last one with content.\n<p>The Apples.xls, Mangoes.xls and Bananas.xls are shared worksheets with 22 users.</p>\n"}, {"tags": ["excel", "excel-2010", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1452670253, "post_id": 34760446, "comment_id": 57266550, "body": "Can you give more details? Like perhaps the code behind the buttons actions?"}, {"owner": {"reputation": 176, "user_id": 3132381, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/UKY1D.jpg?s=128&g=1", "display_name": "Umer Farooq", "link": "https://stackoverflow.com/users/3132381/umer-farooq"}, "reply_to_user": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1452670830, "post_id": 34760446, "comment_id": 57266869, "body": "Sub Macro1()      Range(&quot;M23&quot;).Select     Application.CommandBars(&quot;Stop Recording&quot;).Visible = False     ActiveSheet.Shapes(&quot;Calendar1&quot;).Select End Sub"}, {"owner": {"reputation": 498, "user_id": 4919504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-Ht1sZuZpObg/AAAAAAAAAAI/AAAAAAAAAHM/SM_BUUtKxwQ/photo.jpg?sz=128", "display_name": "Amandine FAURILLOU", "link": "https://stackoverflow.com/users/4919504/amandine-faurillou"}, "edited": false, "score": 0, "creation_date": 1452671988, "post_id": 34760446, "comment_id": 57267443, "body": "This code just set the macro recording toolbar to not be seen. Is it what you want it to do? And did you set Macro1 to the action of the button? ie private sub commandbutton1_click() Macro1 end sub?"}], "answers": [{"comments": [{"owner": {"reputation": 176, "user_id": 3132381, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/UKY1D.jpg?s=128&g=1", "display_name": "Umer Farooq", "link": "https://stackoverflow.com/users/3132381/umer-farooq"}, "edited": false, "score": 0, "creation_date": 1452670591, "post_id": 34760772, "comment_id": 57266746, "body": "Macro is there. and it&#39;s not in Design Mode. I am unable to change date and click button."}, {"owner": {"reputation": 27, "user_id": 5412691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80bcbbb2e73986931de549c85e7ff5e9?s=128&d=identicon&r=PG&f=1", "display_name": "pranav012", "link": "https://stackoverflow.com/users/5412691/pranav012"}, "reply_to_user": {"reputation": 176, "user_id": 3132381, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/UKY1D.jpg?s=128&g=1", "display_name": "Umer Farooq", "link": "https://stackoverflow.com/users/3132381/umer-farooq"}, "edited": false, "score": 0, "creation_date": 1452670660, "post_id": 34760772, "comment_id": 57266792, "body": "is the file macro enabled file ?"}, {"owner": {"reputation": 27, "user_id": 5412691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80bcbbb2e73986931de549c85e7ff5e9?s=128&d=identicon&r=PG&f=1", "display_name": "pranav012", "link": "https://stackoverflow.com/users/5412691/pranav012"}, "reply_to_user": {"reputation": 176, "user_id": 3132381, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/UKY1D.jpg?s=128&g=1", "display_name": "Umer Farooq", "link": "https://stackoverflow.com/users/3132381/umer-farooq"}, "edited": false, "score": 0, "creation_date": 1452670862, "post_id": 34760772, "comment_id": 57266891, "body": "Macro might not be functional. You need to provide more details, cant solve just by looking at screenshot"}, {"owner": {"reputation": 176, "user_id": 3132381, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/UKY1D.jpg?s=128&g=1", "display_name": "Umer Farooq", "link": "https://stackoverflow.com/users/3132381/umer-farooq"}, "edited": false, "score": 0, "creation_date": 1452671052, "post_id": 34760772, "comment_id": 57267013, "body": "I can share the file. please provide your email address."}, {"owner": {"reputation": 27, "user_id": 5412691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80bcbbb2e73986931de549c85e7ff5e9?s=128&d=identicon&r=PG&f=1", "display_name": "pranav012", "link": "https://stackoverflow.com/users/5412691/pranav012"}, "reply_to_user": {"reputation": 176, "user_id": 3132381, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/UKY1D.jpg?s=128&g=1", "display_name": "Umer Farooq", "link": "https://stackoverflow.com/users/3132381/umer-farooq"}, "edited": false, "score": 0, "creation_date": 1452677242, "post_id": 34760772, "comment_id": 57270736, "body": "not sure if we can share email id&#39;s. Cant you attach your file somewhere on StackOverflow or some other website? I will download it."}], "tags": [], "owner": {"reputation": 27, "user_id": 5412691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80bcbbb2e73986931de549c85e7ff5e9?s=128&d=identicon&r=PG&f=1", "display_name": "pranav012", "link": "https://stackoverflow.com/users/5412691/pranav012"}, "is_accepted": false, "score": 0, "last_activity_date": 1452670220, "creation_date": 1452670220, "answer_id": 34760772, "question_id": 34760446, "link": "https://stackoverflow.com/questions/34760446/button-in-excel-not-being-clicked/34760772#34760772", "title": "Button in excel not being clicked", "body": "<p>Either no macro is being assigned to your buttons or you are in design mode. </p>\n\n<ol>\n<li>Right click on button and click on Assign Macro's and check if any macro is assigned</li>\n<li>Go to Developer tab and check if you are in Design Mode</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "is_accepted": false, "score": 1, "last_activity_date": 1452681028, "creation_date": 1452681028, "answer_id": 34764272, "question_id": 34760446, "link": "https://stackoverflow.com/questions/34760446/button-in-excel-not-being-clicked/34764272#34764272", "title": "Button in excel not being clicked", "body": "<p>Ok... Assuming you've enabled macros on your workbook correctly etc...</p>\n\n<ol>\n<li>The Button.</li>\n</ol>\n\n<p>There are 2 types of button. A form and a Active-x.\nIf this is a Forms type button - right click and assign the macro. Have your macro in a modules and not in a worksheet class.</p>\n\n<ol>\n<li><p>The Button.\nIf this is an active-x button, on the Developer tab press the Design Mode icon, which funny enough, will put it in Design Mode :)\nDouble click the button, this will generate an event handler in the worksheet class.</p>\n\n<ol start=\"2\">\n<li>The Calendar Control.\nThis is also an active-x so I would follow the steps for the active-x button. Enter design mode and double click. I think this will create a Click event handler where you can trap the event.</li>\n</ol></li>\n</ol>\n\n<p>Hope that helps...</p>\n"}], "owner": {"reputation": 176, "user_id": 3132381, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/UKY1D.jpg?s=128&g=1", "display_name": "Umer Farooq", "link": "https://stackoverflow.com/users/3132381/umer-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13845, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1452681028, "creation_date": 1452669061, "last_edit_date": 1531161705, "question_id": 34760446, "link": "https://stackoverflow.com/questions/34760446/button-in-excel-not-being-clicked", "title": "Button in excel not being clicked", "body": "<p><a href=\"https://i.stack.imgur.com/t9zMX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t9zMX.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I click on 'Calendar' or 'Generate Report' button. It doesn't do anything. what could be the problem. Please help me out. thank you.</p>\n"}, {"tags": ["vba", "function", "excel"], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 4, "last_activity_date": 1588750460, "last_edit_date": 1588750460, "creation_date": 1452673185, "answer_id": 34761541, "question_id": 34760237, "link": "https://stackoverflow.com/questions/34760237/remove-zeros-from-the-beginning-of-string-vba-or-function/34761541#34761541", "title": "Remove zeros from the beginning of string VBA or Function", "body": "<p>As a UDF (User Define Function)</p>\n\n<pre><code>Function Strip0(r As Range) As Variant\n    Dim i As Long\n    Dim s As String\n    s = CStr(r.Value)\n    If s &lt;&gt; \"0\" Then\n        Do While Left$(s, 1) = \"0\"\n            s = Mid$(s, 2)\n        Loop\n    End If\n    Strip0 = s\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1452779953, "last_edit_date": 1452779953, "creation_date": 1452675592, "answer_id": 34762278, "question_id": 34760237, "link": "https://stackoverflow.com/questions/34760237/remove-zeros-from-the-beginning-of-string-vba-or-function/34762278#34762278", "title": "Remove zeros from the beginning of string VBA or Function", "body": "<p>The following should work if a space always follows the first number:</p>\n\n<pre><code>=TEXT(LEFT(A1, FIND(\" \", A1)), \"#\")\n</code></pre>\n\n<p>In case the <em>space</em> condition is not guaranteed, a UDF would be needed.</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 2, "last_activity_date": 1452681885, "creation_date": 1452681885, "answer_id": 34764582, "question_id": 34760237, "link": "https://stackoverflow.com/questions/34760237/remove-zeros-from-the-beginning-of-string-vba-or-function/34764582#34764582", "title": "Remove zeros from the beginning of string VBA or Function", "body": "<p>Longer code but runs quickly over a range of values (permanently changing them) rather than use UDFs on an ongoing basis.</p>\n\n<p>Uses variant arrays and regexp for efficiency.</p>\n\n<pre><code>Sub KillLeadingZeroes()\n    Dim rng1 As Range\n    Dim rngArea As Range\n    Dim lngRow As Long\n    Dim lngCol As Long\n    Dim lngCalc As Long\n    Dim objReg As Object\n    Dim X()\n\n\n    On Error Resume Next\n    Set rng1 = Application.InputBox(\"Select range for the replacement of leadoimg zeroes\", \"User select\", Selection.Address, , , , , 8)\n    If rng1 Is Nothing Then Exit Sub\n    On Error GoTo 0\n\n    'See Patrick Matthews excellent article on using Regular Expressions with VBA\n    Set objReg = CreateObject(\"vbscript.regexp\")\n    objReg.Pattern = \"^0+\"\n    objReg.Global = False\n\n   'Speed up the code by turning off screenupdating and setting calculation to manual\n   'Disable any code events that may occur when writing to cells\n    With Application\n        lngCalc = .Calculation\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n    End With\n\n    'Test each area in the user selected range\n\n    'Non contiguous range areas are common when using SpecialCells to define specific cell types to work on\n    For Each rngArea In rng1.Areas\n        'The most common outcome is used for the True outcome to optimise code speed\n        If rngArea.Cells.Count &gt; 1 Then\n           'If there is more than once cell then set the variant array to the dimensions of the range area\n           'Using Value2 provides a useful speed improvement over Value. On my testing it was 2% on blank cells, up to 10% on non-blanks\n            X = rngArea.Value2\n            For lngRow = 1 To rngArea.Rows.Count\n                For lngCol = 1 To rngArea.Columns.Count\n                    'replace the leading zeroes\n                    X(lngRow, lngCol) = objReg.Replace(X(lngRow, lngCol), vbNullString)\n                Next lngCol\n            Next lngRow\n            'Dump the updated array sans leading zeroes back over the initial range\n            rngArea.Value2 = X\n        Else\n            'caters for a single cell range area. No variant array required\n            rngArea.Value = objReg.Replace(rngArea.Value, vbNullString)\n        End If\n    Next rngArea\n\n    'cleanup the Application settings\n    With Application\n        .ScreenUpdating = True\n        .Calculation = lngCalc\n        .EnableEvents = True\n    End With\n\n    Set objReg = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 626, "user_id": 5041561, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c5873d78bb33067165b902ef5470c9a?s=128&d=identicon&r=PG&f=1", "display_name": "HeadOverFeet", "link": "https://stackoverflow.com/users/5041561/headoverfeet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2420, "favorite_count": 0, "accepted_answer_id": 34761541, "answer_count": 3, "score": 2, "last_activity_date": 1588750460, "creation_date": 1452668283, "last_edit_date": 1452672371, "question_id": 34760237, "link": "https://stackoverflow.com/questions/34760237/remove-zeros-from-the-beginning-of-string-vba-or-function", "title": "Remove zeros from the beginning of string VBA or Function", "body": "<p>I have an issue about removing zeros from the beginning of  a string. \nI have used </p>\n\n<pre><code>=trim(left(substitute(A1,\"0\",\" \"),3))\n</code></pre>\n\n<p>in string = <strong><code>'0060'</code></strong> PPC mobile phone\nI want to have result equals to <strong><code>60</code></strong>. But this function gives me 6. </p>\n\n<p>Not all my records start with double zeros. There can be one, two or three zeros.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 668, "user_id": 5376180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dbbcf86576c59034abee94863876812?s=128&d=identicon&r=PG&f=1", "display_name": "Vulthil", "link": "https://stackoverflow.com/users/5376180/vulthil"}, "edited": false, "score": 0, "creation_date": 1452668576, "post_id": 34760114, "comment_id": 57265730, "body": "Have you tried using the index of the sheets ? Like Sheets(1) or Sheets(2) or in your case Sheets(i + 1), if i = 1 to begin with and you want data in sheet 2."}], "answers": [{"tags": [], "owner": {"reputation": 4742, "user_id": 2075402, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ErAC5.jpg?s=128&g=1", "display_name": "Gareth", "link": "https://stackoverflow.com/users/2075402/gareth"}, "is_accepted": true, "score": 1, "last_activity_date": 1452673974, "last_edit_date": 1452673974, "creation_date": 1452672925, "answer_id": 34761456, "question_id": 34760114, "link": "https://stackoverflow.com/questions/34760114/adding-data-into-consecutive-excel-sheets-with-vba/34761456#34761456", "title": "Adding data into consecutive excel sheets with VBA", "body": "<p>It's because <code>SheetId</code> is a string not a worksheet in your loop and therefore does not have a method or property <code>Cells</code>.</p>\n\n<p>Change this line:</p>\n\n<pre><code>sheetID.Cells(Row, Column) = GetData(FilePath, fileTitle, SheetName, Address)\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>ThisWorkbook.Worksheets(sheetID).Cells(Row, Column) = GetData(FilePath, fileTitle, SheetName, Address)\n</code></pre>\n\n<p>As a side note, I'd suggest adding <code>Option Explicit</code> to the very top of your code and declare all of your variables which will help in future avoid issues like this.</p>\n"}], "owner": {"reputation": 649, "user_id": 5755192, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1d173121fbb4d9f031efb48c668832ce?s=128&d=identicon&r=PG&f=1", "display_name": "KayBay", "link": "https://stackoverflow.com/users/5755192/kaybay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 34761456, "answer_count": 1, "score": 0, "last_activity_date": 1452673974, "creation_date": 1452667805, "question_id": 34760114, "link": "https://stackoverflow.com/questions/34760114/adding-data-into-consecutive-excel-sheets-with-vba", "title": "Adding data into consecutive excel sheets with VBA", "body": "<p>I am trying to copy data from external workbooks titled Field_1, Field_2, ..., all the way up to Field_10 without having to open them first. I want to add this data into sheets 2 all the way up to sheet 11 of my main workbook. I already have code that successfully adds new empty sheets and renames them to Field_1 and so on (ie. Sheet2 becomes Field_1). The problem I am having is copying the data into each of the sheets.</p>\n\n<p>So far, I've successfully written code to retrieve the data and I can make all the data get pasted into just Sheet2 (as shown in the code below the first line of asterisks) but the data overrides each other on each loop. Chaning the <code>sheetID</code> each loop doesn't paste anything into any of the cells. I have included my entire code incase useful. The important parts are encompassed in the asterisks.</p>\n\n<pre><code>Sub ADDCLM7()\nOn Error Resume Next\nDim Dept_Row As Long\nDim Dept_Clm As Long\nDim Lookup_Row As Long\nDim Lookup_Clm As Long\nDim wbPath As String, wbName As String\nDim wsName As String, cellRef As String\nDim Ret As String\nDim FilePath$, Row&amp;, Column&amp;, Address$\n\nRange(\"AA2\").Activate\ni = 1\nWhile i &lt; 11\n    Table1 = Sheet1.Range(\"AB2:AB28471\")\n\n    fileTitle = \"Field_\"\n    fileTitle = fileTitle &amp; CStr(i) &amp; \".xls\"\n    SheetName = \"Sheet1\"\n    NumRows = 77 \n    NumColumns = 2\n    FilePath = ActiveWorkbook.Path &amp; \"\\\"\n\n    DoEvents\n    Application.ScreenUpdating = False\n    If Dir(FilePath &amp; fileTitle) = Empty Then\n        MsgBox \"The file \" &amp; fileTitle &amp; \" was not found\", , \"File Doesn't Exist\"\n        Exit Sub\n    End If\n    For Row = 1 To NumRows\n        For Column = 1 To NumColumns\n            Address = Cells(Row, Column).Address\n'*************************************************************************************************\n             Sheet2.Cells(Row, Column) = GetData(FilePath, fileTitle, SheetName, Address) ' THIS ONLY PASTES INTO SHEET2\n\n            'sheetID = \"Sheet\"\n            'sheetID = sheetID &amp; CStr(i)\n            'sheetID.Cells(Row, Column) = GetData(FilePath, fileTitle, SheetName, Address) ' THIS DOESNT PASTE ANYTHING\n'*************************************************************************************************\n        Next Column\n    Next Row\n    ActiveWindow.DisplayZeros = False\n\nTable2 = Sheet2.Range(\"A2:B77\")\nDept_Row = Sheet1.Range(\"AB2\").Row \nDept_Clm = Sheet1.Range(\"AB2\").Column\nLookup_Row = Sheet1.Range(\"AA2\").Row\nLookup_Clm = Sheet1.Range(\"AA2\").Column\n\ni = i + 1\nFor Each cl In Table1\n    lookupCode = Sheet1.Cells(Lookup_Row, Lookup_Clm).Value\n    Sheet1.Cells(Dept_Row, Dept_Clm) = Application.WorksheetFunction.VLookup(lookupCode, Table2, 2, False)\n  Dept_Row = Dept_Row + 1\n  Lookup_Row = Lookup_Row + 1\nNext cl\nWend\nEnd Sub\n</code></pre>\n\n<p>Any help is greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1452663738, "post_id": 34758970, "comment_id": 57263789, "body": "You are asking only for matching here. Where do you want to sort or align in the above flow ?"}, {"owner": {"reputation": 1, "user_id": 5726087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a972e5336b08fd31b15e672ba4243b7?s=128&d=identicon&r=PG&f=1", "display_name": "user5726087", "link": "https://stackoverflow.com/users/5726087/user5726087"}, "reply_to_user": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1452664278, "post_id": 34758970, "comment_id": 57263972, "body": "@KanikeVamshiKrishna Thanks, All i want is to change the description in sheet 1 if Item ID in Sheet 1 and Sheet2 matches"}, {"owner": {"reputation": 197, "user_id": 2237769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7SvdY.jpg?s=128&g=1", "display_name": "Kanike Vamshi Krishna", "link": "https://stackoverflow.com/users/2237769/kanike-vamshi-krishna"}, "edited": false, "score": 0, "creation_date": 1452666000, "post_id": 34758970, "comment_id": 57264594, "body": "If the second sheet has unique values for <code>Item ID</code>, then you can you use <code>vlookup</code> in sheets 3. Look up values for Col B,C &amp; D from sheet 2 and for other fields just copy values from sheet 1.  This should do the job. If you want a VBA code then do let know"}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1452668133, "creation_date": 1452668133, "answer_id": 34760198, "question_id": 34758970, "link": "https://stackoverflow.com/questions/34758970/how-to-match-values-in-excel/34760198#34760198", "title": "How to Match values in Excel", "body": "<p>This would be a LOT easier if you decided to use punctuation, so we can tell where one sentence ends and the next one starts.</p>\n\n<p>As I understand it, you are only looking for a formula or solution for Sheet3.</p>\n\n<p>Try this formula in Sheet3, cell B2:</p>\n\n<p>=vlookup($A2,Sheet2!$A$1:$D$1000,column(B1),false)</p>\n\n<p>Copy across to Sheet3 cell C2 and D2, then copy down. Adjust the lookup range rows as per your data on sheet 2.</p>\n"}], "owner": {"reputation": 1, "user_id": 5726087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a972e5336b08fd31b15e672ba4243b7?s=128&d=identicon&r=PG&f=1", "display_name": "user5726087", "link": "https://stackoverflow.com/users/5726087/user5726087"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1452668557, "creation_date": 1452662614, "last_edit_date": 1452668557, "question_id": 34758970, "link": "https://stackoverflow.com/questions/34758970/how-to-match-values-in-excel", "title": "How to Match values in Excel", "body": "<p>I have the following type of data I want to update the description field in <code>sheet 1</code> which are in <code>Col B</code>, <code>col C</code> and <code>Col D</code> if the <code>ItemID</code> Matches for the records in sheet 2 </p>\n\n<p>Sheet 1</p>\n\n<pre><code>   Col A     Col B       Col C          Col D      COL E    COL F\n   Item ID   Item Desc   Purchase D     Sales Des   STOCK    Rev\n   600111     xxxx        yyyy          zzzz         15      1\n   600111     xxxx        yyyy          zzzz         15      1\n   600111     xxxx        yyyy          zzzz         15      1\n   600255     mmmm        nnnn          yyyy          5      2\n   600224     aaaa        bbbb          cccc          5      5\n   600224     aaaa        bbbb          cccc          5      5\n</code></pre>\n\n<p>Note: ColA data is copied from another Excel File. The Idea is to Update The description field</p>\n\n<p>Sheet 2</p>\n\n<pre><code> Col A     Col B       Col C         Col D\nItem ID   Item Desc   Purchase C    Sales Des\n600255      mmmm        xxxx          yyyy\n600224      rrrr        sss           tttt\n600111      LLLL        MMMM            nnn\n</code></pre>\n\n<p>In <code>Sheet 3</code> i want to display updated <code>Sheet 1</code> with Descriptions from <code>Sheet 2</code></p>\n\n<pre><code>   Col A     Col B       Col C          Col D      COL E    COL F\n   Item ID   Item Desc   Purchase D     Sales Des   STOCK    Rev\n   600111     LLLL        MMMM             nnn         15      1\n   600111     LLLL        MMMM             nnn         15      1\n   600111     LLLL        MMMM             nnn         15      1\n   600255     mmmm        xxxx             yyyy        5       2\n   600224     rrrr        ssss             ttt         5       5\n   600224     rrrr        ssss             ttt         5       5\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1452673097, "creation_date": 1452673097, "answer_id": 34761516, "question_id": 34758105, "link": "https://stackoverflow.com/questions/34758105/search-sub-form-from-text-box-in-form/34761516#34761516", "title": "search sub form from text box in form", "body": "<p>It should read:</p>\n\n<pre><code>Dim wlog As DAO.Recordset\nDim Criteria As String\n\nSet wlog = Me!&lt;NameOfTheSubformCONTROL&gt;.RecordsetClone\nIf wlog.RecordCount &gt; 0 Then\n    Criteria = \"[weblog_number]='\" &amp; [weblogSearch] &amp; \"'\"\n    wlog.FindFirst Criteria\n    If wlog.NoMatch = False\n        ' Found.\n    Else\n        ' Not found.\n    End If\nEnd If\nwlog.Close\n</code></pre>\n\n<p>Replace <code>&lt;NameOfTheSubformCONTROL&gt;</code> with that, not the name of the subform.</p>\n"}], "owner": {"reputation": 101, "user_id": 4889799, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Ags4I.jpg?s=128&g=1", "display_name": "Ethan Bradberry", "link": "https://stackoverflow.com/users/4889799/ethan-bradberry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 34761516, "answer_count": 1, "score": 0, "last_activity_date": 1452674280, "creation_date": 1452657032, "last_edit_date": 1452674280, "question_id": 34758105, "link": "https://stackoverflow.com/questions/34758105/search-sub-form-from-text-box-in-form", "title": "search sub form from text box in form", "body": "<p>I have a form (frm_main)</p>\n\n<p>and i have a subform on this form (frm_weblogs_subform)</p>\n\n<p>I am trying to search the subform using a text box.</p>\n\n<p>the code i've found and have been playing with to no avail is:</p>\n\n<pre><code>Private Sub find_weblog_button_Click()\n\nDim D As Database\nDim wlog As DAO.Recordset\nDim Criteria As String\n\nSet D = CurrentDb\nSet wlog = D.OpenRecordset(\"form_frm_weblogs_subform\", dbOpenDynaset)\n\nCriteria = \"[weblog_number]='\" &amp; [weblogSearch] &amp; \"'\"\n\nwlog.FindFirst Criteria\n\nwlog.Close\n\nEnd Sub\n</code></pre>\n\n<p>It doesn't seem to register the form at all it keeps saying it can't be found.</p>\n\n<p>can anyone help point me in the right direction?</p>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452671411, "post_id": 34758020, "comment_id": 57267190, "body": "Are you sure <code>crntassone</code> is not <code>Nothing</code>? If it is, the calls to <code>Range(crntassone, ...</code> will fail"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452671574, "post_id": 34758020, "comment_id": 57267266, "body": "Another issue: your calls to <code>Find</code>, whatever parameters you don&#39;t specify will use whatever was last used, either by code or the user.  Almost certainly not what you want."}, {"owner": {"reputation": 47, "user_id": 5722044, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208220368769003/picture?type=large", "display_name": "Davis Owen", "link": "https://stackoverflow.com/users/5722044/davis-owen"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452715742, "post_id": 34758020, "comment_id": 57297344, "body": "@chrisneilsen It could be nothing... which means I should set up an if statement for if it is &#39;Nothing&#39;. But I know that there is a cell in this sheet that contains the &quot;Current Assets:&quot; string, so it shouln&#39;t be &#39;Nothing&#39;. Unless I am formatting my parameters in &#39;Find&#39; incorrectly. Are you saying I should specify the optional parameters in my calls to Find, i.e. after, lookin, lookat, etc.?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452730625, "post_id": 34758020, "comment_id": 57304069, "body": "Regarding Find, yes I am saying you should specify all optional parameters.  Unlike most other functions, unspecified Find parameters take their value from the last use of Find, either by the user or code.  You really have no idea what you will get if you don&#39;t specify."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452730856, "post_id": 34758020, "comment_id": 57304133, "body": "Regarding <code>crntassone</code> and the possibility of <code>Nothing</code>, try putting a break on the <code>Set range1 = </code> lines and check what ranges the two parameters point to in the Watch window."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452730924, "post_id": 34758020, "comment_id": 57304153, "body": "Another point: <code>Set crntasstwo = ...</code> uses a mixture of  <code>Worksheets(&quot;Sheet1&quot;)</code> and <code>ActiveSheet</code>.  Not a good idea, use one or the other"}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452671226, "post_id": 34758856, "comment_id": 57267096, "body": "Wrong on two counts: if <code>Sheet1</code> is not active this will error.  And <code>Range</code> <i>will</i> take other ranges as parameters."}, {"owner": {"reputation": 27, "user_id": 5412691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80bcbbb2e73986931de549c85e7ff5e9?s=128&d=identicon&r=PG&f=1", "display_name": "pranav012", "link": "https://stackoverflow.com/users/5412691/pranav012"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1452674530, "post_id": 34758856, "comment_id": 57268955, "body": "My sheet2 was active and i tried setting range of Sheet1, encountered no error. Below code works fine..Sheets(2).Activate   Set range1 = Sheets(3).Range(&quot;A:A&quot;)"}, {"owner": {"reputation": 47, "user_id": 5722044, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208220368769003/picture?type=large", "display_name": "Davis Owen", "link": "https://stackoverflow.com/users/5722044/davis-owen"}, "edited": false, "score": 0, "creation_date": 1452716385, "post_id": 34758856, "comment_id": 57297695, "body": "@pranav012 unfortunately I do not know the specific numeric values of the cells because that will change from document to document. I am writing this for multiple documents and trying to automate it as much as possible, hence me using &#39;Find&#39;. Also I tried using &#39;range.address&#39; on both and seeing if it was because .range wouldnt accept other ranges but it still threw the same error, so I believe it will accept ranges as parameters."}], "tags": [], "owner": {"reputation": 27, "user_id": 5412691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80bcbbb2e73986931de549c85e7ff5e9?s=128&d=identicon&r=PG&f=1", "display_name": "pranav012", "link": "https://stackoverflow.com/users/5412691/pranav012"}, "is_accepted": false, "score": 0, "last_activity_date": 1452662058, "creation_date": 1452662058, "answer_id": 34758856, "question_id": 34758020, "link": "https://stackoverflow.com/questions/34758020/application-defined-or-object-defined-error-3/34758856#34758856", "title": "Application Defined or object-defined error 3", "body": "<p>Range Object of Sheets wont take parameters as you have defined. You should write parameters like this</p>\n\n<pre><code>Sheets(\"Sheet1\").Range(cells(1,2),cells(3,4))\n</code></pre>\n\n<p>Note : 1,2,3,4 are just for eg. Figure out this values as i cant see your excel</p>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 5722044, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208220368769003/picture?type=large", "display_name": "Davis Owen", "link": "https://stackoverflow.com/users/5722044/davis-owen"}, "is_accepted": true, "score": 0, "last_activity_date": 1453344023, "creation_date": 1453344023, "answer_id": 34914460, "question_id": 34758020, "link": "https://stackoverflow.com/questions/34758020/application-defined-or-object-defined-error-3/34914460#34914460", "title": "Application Defined or object-defined error 3", "body": "<p>It turns out that my range for 'Find' wasn't actually spanning my whole sheet. Due to the formatting of my charts in excel, 'xlToRight' and 'xlUp' were not spanning the entirety of all the rows and columns that were being used (hard to explain in words). In addition to specifying certain extra parameters for 'Find', I also used 'SpecialCells(xlCellTypeLastCell)' to locate the last cell in my sheet. Here are the changes I made</p>\n\n<pre><code>Dim LastRow As Long\n    LastRow = Worksheets(\"Sheet1\").Range(\"A1\").SpecialCells(xlCellTypeLastCell).Row\n\nDim LastColumn As Long\n    LastColumn = Worksheets(\"Sheet1\").Range(\"A1\").SpecialCells(xlCellTypeLastCell).Column\n\nSet crntassone = Worksheets(\"Sheet1\").Range(\"A1\", Cells(LastRow,  LastColumn)).Find(What:=\"Current assets:\", After:=Worksheets(\"Sheet1\").Range(\"A1\"), LookIn:=xlValues, LookAt:=xlPart, SearchDirection:=xlNext, MatchCase:=False)\n If Worksheets(\"Sheet1\").Range(\"A1\", Cells(LastRow, LastColumn)).Find(\"Total Current Assets\") Is Nothing Then\n     Set ttlass = Worksheets(\"Sheet1\").Range(\"A1\", Cells(LastRow, LastColumn)).Find(\"Total Assets\")\n     Set range1 = Worksheets(\"Sheet1\").Range(crntassone, ttlass)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5722044, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208220368769003/picture?type=large", "display_name": "Davis Owen", "link": "https://stackoverflow.com/users/5722044/davis-owen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 34914460, "answer_count": 2, "score": 1, "last_activity_date": 1454856981, "creation_date": 1452656533, "last_edit_date": 1454856981, "question_id": 34758020, "link": "https://stackoverflow.com/questions/34758020/application-defined-or-object-defined-error-3", "title": "Application Defined or object-defined error 3", "body": "<p>I am trying to take specific data from <strong><code>\"sheet1\"</code></strong> and put it in another sheet in specific places (specifically financial data). </p>\n\n<p>In this code I am trying to create a range that will only include data from the part of financial data going from current assets to total current assets (or total assets if there are no non current assets). </p>\n\n<p>Its thrown Error on the <strong><code>\"Set range1\"</code></strong> lines. </p>\n\n<p>I am trying to create a range from the current asset sell to the total asset cell to use later in the code.</p>\n\n<pre><code>lastCol = Worksheets(\"Sheet1\").Range(\"a1\").End(xlToRight).Column\nlastRow = Worksheets(\"Sheet1\").Cells(65536, lastCol).End(xlUp).Row\nSet crntassone = Worksheets(\"Sheet1\").Range(\"a1\", Worksheets(\"Sheet1\").Cells(lastRow, lastCol)).Find(\"Current Assets:\")\n\n If Worksheets(\"Sheet1\").Range(\"a1\", Worksheets(\"Sheet1\").Cells(lastRow, lastCol)).Find(\"Total Current Assets\") Is Nothing Then\n     Set ttlass = Worksheets(\"Sheet1\").Range(\"a1\", Worksheets(\"Sheet1\").Cells(lastRow, lastCol)).Find(\"Total Assets\")\n     Set range1 = Worksheets(\"Sheet1\").Range(crntassone, ttlass)\n Else\n     Set crntasstwo = Worksheets(\"Sheet1\").Range(\"a1\", ActiveSheet.Cells(lastRow, lastCol)).Find(\"Total Current Assets\")\n     Set range1 = Range(crntassone, crntasstwo)\n End If\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv", "import"], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 4027876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e2a711ed6493b05b5b2d4e4388f02ccf?s=128&d=identicon&r=PG&f=1", "display_name": "lukayl", "link": "https://stackoverflow.com/users/4027876/lukayl"}, "is_accepted": false, "score": 0, "last_activity_date": 1452656572, "last_edit_date": 1452656572, "creation_date": 1452654536, "answer_id": 34757749, "question_id": 34757003, "link": "https://stackoverflow.com/questions/34757003/import-multiple-text-csv-files-into-single-excel-worksheet/34757749#34757749", "title": "Import multiple text/csv files into single excel worksheet", "body": "<p>I used this one to get the files.  The downside is it gets to pull all data into this workbook.  </p>\n\n<pre><code>Sub getallbooks()\n\nDim firstRowHeaders As Boolean\nDim fso As Object\nDim dir As Object\nDim filename As Variant\nDim wb As Workbook\nDim s As Sheet1\nDim thisSheet As Sheet1\nDim lastUsedRow As Range\nDim file As String\nDim fpath As String\n\nOn Error GoTo ErrMsg\n\nApplication.ScreenUpdating = False\nfirstRowHeaders = True 'Change from True to False if there are no headers in the first row\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\n'PLEASE NOTE: Change &lt;&lt;Full path to your Excel files folder&gt;&gt; to the path to the folder containing your Excel files to merge\nfpath = Application.InputBox(\"Enter the file folder\")\nSet dir = fso.Getfolder(fpath)\n\nSet thisSheet = ThisWorkbook.ActiveSheet\n\nFor Each filename In dir.Files\n'Open the spreadsheet in ReadOnly mode\nSet wb = Application.Workbooks.Open(filename, ReadOnly:=True)\n\n'Copy the used range (i.e. cells with data) from the opened spreadsheet\nIf firstRowHeaders And i &gt; 0 Then 'Only include headers from the first spreadsheet\n    Dim mr As Integer\n    mr = wb.ActiveSheet.UsedRange.Rows.Count\n    wb.ActiveSheet.UsedRange.Offset(1, 0).Resize(mr - 1).Copy\nElse\n    wb.ActiveSheet.UsedRange.Copy\nEnd If\n\n 'Paste after the last used cell in the master spreadsheet\nIf Application.Version &lt; \"12.0\" Then 'Excel 2007 introduced more rows\n    Set lastUsedRow = thisSheet.Range(\"A65536\").End(xlUp)\nElse\n    Set lastUsedRow = thisSheet.Range(\"A1048576\").End(xlUp)\nEnd If\n\n'Only offset by 1 if there are current rows with data in them\nIf thisSheet.UsedRange.Rows.Count &gt; 1 Or Application.CountA(thisSheet.Rows(1)) Then\n    Set lastUsedRow = lastUsedRow.Offset(1, 0)\nEnd If\nlastUsedRow.PasteSpecial\nApplication.CutCopyMode = False\nNext filename\n\nThisWorkbook.Save\nSet wb = Nothing\n\n#If Mac Then\n'Do nothing. Closing workbooks fails on Mac for some reason\n#Else\n'Close the workbooks except this one\nFor Each filename In dir.Files\n    file = Right(filename, Len(filename) - InStrRev(filename, Application.PathSeparator, , 1))\n    Workbooks(file).Close SaveChanges:=False\nNext filename\n#End If\n\nApplication.ScreenUpdating = True\nErrMsg:\nIf Err.Number &lt;&gt; 0 Then\nMsgBox \"There was an error. Please try again. [\" &amp; Err.Description &amp; \"]\"\nEnd If\n\nEnd Sub  \n</code></pre>\n\n<p>Here is another way which creates a new workbook to store the data:  </p>\n\n<pre><code>Sub MergeAllWorkbooks()\nDim MyPath As String, FilesInPath As String\nDim MyFiles() As String\nDim SourceRcount As Long, FNum As Long\nDim mybook As Workbook, BaseWks As Worksheet\nDim sourceRange As Range, destrange As Range\nDim rnum As Long, CalcMode As Long\nDim LastRow As Long, LastCol As Long\n\n' Change this to the path\\folder location of your files.\nMyPath = InputBox(\"Enter the address here\")\n\n' Add a slash at the end of the path if needed.\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then\n    MyPath = MyPath &amp; \"\\\"\nEnd If\n\n' If there are no Excel files in the folder, exit.\nFilesInPath = Dir(MyPath &amp; \"*.csv*\") 'You can change the file type to suit your need here\nIf FilesInPath = \"\" Then\n    MsgBox \"No files found\"\n    Exit Sub\nEnd If\n\n' Fill the myFiles array with the list of Excel files\n' in the search folder.\nFNum = 0\nDo While FilesInPath &lt;&gt; \"\"\n    FNum = FNum + 1\n    ReDim Preserve MyFiles(1 To FNum)\n    MyFiles(FNum) = FilesInPath\n    FilesInPath = Dir()\nLoop\n\n' Set various application properties.\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n' Add a new workbook with one sheet.\nSet BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\nrnum = 1\n\n' Loop through all files in the myFiles array.\nIf FNum &gt; 0 Then\n    For FNum = LBound(MyFiles) To UBound(MyFiles)\n        Set mybook = Nothing\n        On Error Resume Next\n        Set mybook = Workbooks.Open(MyPath &amp; MyFiles(FNum))\n        On Error GoTo 0\n\n        If Not mybook Is Nothing Then\n            On Error Resume Next\n\n            ' Change this range to fit your own needs.\n            With mybook.Worksheets(1)\n                LastRow = .Cells(Rows.Count, 1).End(xlUp).Row 'choose which column has data all the way down the last row\n                LastCol = .Cells(1, Columns.Count).End(xlToLeft).Column\n\n                Set sourceRange = .Range(.Cells(1, 1), .Cells(LastRow, LastCol))\n\n            End With\n\n            If Err.Number &gt; 0 Then\n                Err.Clear\n                Set sourceRange = Nothing\n            Else\n                ' If source range uses all columns then\n                ' skip this file.\n                If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                    Set sourceRange = Nothing\n                End If\n            End If\n            On Error GoTo 0\n\n            If Not sourceRange Is Nothing Then\n\n                SourceRcount = sourceRange.Rows.Count\n\n                If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                    MsgBox \"There are not enough rows in the target worksheet.\"\n                    BaseWks.Columns.AutoFit\n                    mybook.Close savechanges:=False\n                    GoTo ExitTheSub\n                Else\n\n                    ' Copy the file name in column A, if you want; Here I choose not.\n                    ' With sourceRange\n                        ' BaseWks.Cells(rnum, \"A\"). _\n                                ' Resize(.Rows.Count).Value = MyFiles(FNum)\n                    ' End With\n\n                    ' Set the destination range.\n                    Set destrange = BaseWks.Range(\"A\" &amp; rnum)\n\n                    ' Copy the values from the source range\n                    ' to the destination range.\n                    With sourceRange\n                        Set destrange = destrange. _\n                                        Resize(.Rows.Count, .Columns.Count)\n                    End With\n                    destrange.Value = sourceRange.Value\n\n                    rnum = rnum + SourceRcount\n                End If\n            End If\n            mybook.Close savechanges:=False\n        End If\n\n    Next FNum\n    BaseWks.Columns.AutoFit\nEnd If\n\nExitTheSub:\n' Restore the application properties.\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .Calculation = CalcMode\nEnd With\nEnd Sub  \n</code></pre>\n\n<p>Both of them get the header from each files.  So You may want to remove them with only the top one left alone.</p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1452655492, "creation_date": 1452655492, "answer_id": 34757880, "question_id": 34757003, "link": "https://stackoverflow.com/questions/34757003/import-multiple-text-csv-files-into-single-excel-worksheet/34757880#34757880", "title": "Import multiple text/csv files into single excel worksheet", "body": "<p>Consider using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837764.aspx\" rel=\"nofollow\">QueryTables</a> that connect to your text files and wrap in a loop of your multiple selected csv files from the array, <code>filesToOpen</code>:</p>\n\n<pre><code>Sub ImportCSVFiles()\n\n    Dim filesToOpen As Variant, file As Variant, LastRow As Long, fso As Object\n\n    filesToOpen = Application.GetOpenFilename _\n      (FileFilter:=\"CSV Files (*.csv), *.csv\", _\n      MultiSelect:=True, Title:=\"Text Files to Open\")\n\n    For Each file In filesToOpen\n\n        LastRow = Cells(Rows.Count, 1).End(xlUp).Row\n        Set fso = CreateObject(\"Scripting.FileSystemObject\")\n        fileName = fso.GetFilename(i)\n\n        If file = \"False\" Then Exit Sub\n\n        'IMPORT DATA FROM CSV FILES\n        With ActiveSheet.QueryTables.Add(Connection:=\"TEXT;\" &amp; file, _\n            Destination:=Cells(LastRow + 2, 1))\n                .TextFileStartRow = 30\n                .TextFileParseType = xlDelimited\n                .TextFileConsecutiveDelimiter = False\n                .TextFileTabDelimiter = False\n                .TextFileSemicolonDelimiter = False\n                .TextFileCommaDelimiter = True\n                .TextFileSpaceDelimiter = False\n\n                .Refresh BackgroundQuery:=False\n        End With\n\n    Next file\n\n    ' REMOVING SOURCE CONNECTIONS\n    For Each qt In ActiveSheet.QueryTables\n        qt.Delete\n    Next qt\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 273, "user_id": 558085, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/233030f96f9da57d0844f9ff588815d1?s=128&d=identicon&r=PG", "display_name": "Spiral1ng", "link": "https://stackoverflow.com/users/558085/spiral1ng"}, "is_accepted": false, "score": 0, "last_activity_date": 1452660521, "last_edit_date": 1452660521, "creation_date": 1452657902, "answer_id": 34758227, "question_id": 34757003, "link": "https://stackoverflow.com/questions/34757003/import-multiple-text-csv-files-into-single-excel-worksheet/34758227#34758227", "title": "Import multiple text/csv files into single excel worksheet", "body": "<p>Thanks for the replies. Instead of using the code that i have shared above, I re-used connection which was my original code. To counter the connection error prompt (Excel cannot find the text file to refresh this external data range) when he/she clicks on \"Enable Content\", I added a code which removes all connections after the data is imported into the excel file. Hope this is helpful to someone who encountered the same issue as me. :)</p>\n\n<pre><code>Sub ImportMultipleCSV()\n\nDim myfiles\nDim i As Integer\n\nmyfiles = Application.GetOpenFilename(filefilter:=\"CSV Files (*.csv), *.csv\", MultiSelect:=True)\n\nIf IsArray(myfiles) Then\n    For i = LBound(myfiles) To UBound(myfiles)\n         With ActiveSheet.QueryTables.Add(Connection:= _\n            \"TEXT;\" &amp; myfiles(i), Destination:=Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0))\n            .Name = \"Sample\"\n            .FieldNames = False\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .TextFilePromptOnRefresh = False\n            .TextFilePlatform = 437\n            .TextFileStartRow = 2\n            .TextFileParseType = xlDelimited\n            .TextFileTextQualifier = xlTextQualifierDoubleQuote\n            .TextFileConsecutiveDelimiter = True\n            .TextFileTabDelimiter = False\n            .TextFileSemicolonDelimiter = False\n            .TextFileCommaDelimiter = False\n            .TextFileSpaceDelimiter = False\n            .TextFileOtherDelimiter = \"|\"\n            .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n            .TextFileTrailingMinusNumbers = True\n            .Refresh BackgroundQuery:=False\n        End With\n    Next i\nElse\n    MsgBox \"No File Selected\"\nEnd If\n\nDim xConnect As Object\n    For Each xConnect In ActiveWorkbook.Connections\n        If xConnect.Name &lt;&gt; \"ThisWorkbookDataModel\" Then xConnect.Delete\n    Next xConnect\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 558085, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/233030f96f9da57d0844f9ff588815d1?s=128&d=identicon&r=PG", "display_name": "Spiral1ng", "link": "https://stackoverflow.com/users/558085/spiral1ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6057, "favorite_count": 2, "answer_count": 3, "score": -1, "last_activity_date": 1500489210, "creation_date": 1452649174, "question_id": 34757003, "link": "https://stackoverflow.com/questions/34757003/import-multiple-text-csv-files-into-single-excel-worksheet", "title": "Import multiple text/csv files into single excel worksheet", "body": "<p>I found this code to get the data from  multiple csv/text files into an excel workbook. However, I would like the data to be appended to a single worksheet rather than each csv/text file having its own worksheet.</p>\n\n<p>I have tried using Connection to get the data but when the file is being emailed to another user, there is an error prompt (Excel cannot find the text file to refresh this external data range) when he/she clicks on \"Enable Content\".</p>\n\n<pre><code>Sub CombineTextFiles()\n    Dim FilesToOpen\n    Dim x As Integer\n    Dim wkbAll As Workbook\n    Dim wkbTemp As Workbook\n    Dim sDelimiter As String\n\n    On Error GoTo ErrHandler\n    Application.ScreenUpdating = False\n\n    sDelimiter = \"|\"\n\n    FilesToOpen = Application.GetOpenFilename _\n      (FileFilter:=\"CSV Files (*.csv), *.csv\", _\n      MultiSelect:=True, Title:=\"Text Files to Open\")\n\n    If TypeName(FilesToOpen) = \"Boolean\" Then\n       MsgBox \"No Files were selected\"\n        GoTo ExitHandler\n    End If\n\n    x = 1\n    Set wkbTemp = Workbooks.Open(Filename:=FilesToOpen(x))\n    wkbTemp.Sheets(1).Copy\n    Set wkbAll = ActiveWorkbook\n    wkbTemp.Close (False)\n    wkbAll.Worksheets(x).Columns(\"A:A\").TextToColumns _\n      Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n      TextQualifier:=xlDoubleQuote, _\n      ConsecutiveDelimiter:=False, _\n      Tab:=False, Semicolon:=False, _\n      Comma:=False, Space:=False, _\n      Other:=True, OtherChar:=\"|\"\n      x = x + 1\n\n     While x &lt;= UBound(FilesToOpen)\n         Set wkbTemp = Workbooks.Open(Filename:=FilesToOpen(x))\n         With wkbAll\n             wkbTemp.Sheets(1).Move After:=.Sheets(.Sheets.Count)\n             .Worksheets(x).Columns(\"A:A\").TextToColumns _\n              Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n              TextQualifier:=xlDoubleQuote, _\n              ConsecutiveDelimiter:=False, _\n              Tab:=False, Semicolon:=False, _\n              Comma:=False, Space:=False, _\n              Other:=True, OtherChar:=sDelimiter\n        End With\n        x = x + 1\n    Wend\n\nExitHandler:\n    Application.ScreenUpdating = True\n    Set wkbAll = Nothing\n    Set wkbTemp = Nothing\n    Exit Sub\n\nErrHandler:\n    MsgBox Err.Description\n    Resume ExitHandler\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452648429, "post_id": 34756790, "comment_id": 57259581, "body": "Where is the code where you define the dataSchedule object? I do not see it as part of the Excel VBA object model so I assume you have a Class module or similar.  The problem may be in how you define the Get and Let procedures for that."}, {"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452648822, "post_id": 34756790, "comment_id": 57259688, "body": "Hi than you very much, for the response, I always define types this way, is easier for me to use later in the routines/functions"}, {"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452648828, "post_id": 34756790, "comment_id": 57259691, "body": "Type dataSchedule     day As String     week As String     date As Date     staffName As String     staffRole As String     startShift As Date     endShift As Date     hoursWorked As Double     wage As Double End Type"}, {"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452649117, "post_id": 34756790, "comment_id": 57259784, "body": "Every other variable in the array get theirs respective cell value correctly, even wekk was before no idea what happened."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452649447, "post_id": 34756790, "comment_id": 57259884, "body": "If you are absolutely certain, perhaps by setting a watch on the expression and a breakpoint, that <code>Sheets(nSheet).Cells(inRow + n, weekCol)</code> is evaluating to something like <code>Week 1</code>, then I would have to look at a workbook demonstrating the problem to figure out what is wrong.  It&#39;s a simple assignment statement.  If the data is correct, there must be something else interefering."}, {"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452650080, "post_id": 34756790, "comment_id": 57260070, "body": "Yeah, the printscreen is  in the next instruction of that line, and you can see in the inspection that the cell has &quot;the Week 1&quot; value and the array vaue stays &quot;&quot;, this is really driven my crazy, thx for answering."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452650217, "post_id": 34756790, "comment_id": 57260112, "body": "Yes, I examined your image and see what you mean.  If you cannot post a copy of the workbook, or one that exhibits the same problem, try starting Excel in safe mode, then opening just this file so that there are no add-ins and see if that makes a difference."}, {"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452650838, "post_id": 34756790, "comment_id": 57260292, "body": "Just try it is safe mode didn&#39;t work either, how I upload the book?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452650958, "post_id": 34756790, "comment_id": 57260320, "body": "Put it on a sharing site, such as OneDrive, DropBox, etc, and post a link here."}, {"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452651375, "post_id": 34756790, "comment_id": 57260419, "body": "<a href=\"https://www.dropbox.com/s/gnbsyrgpexyeun2/coffeSchedule.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/gnbsyrgpexyeun2/coffeSchedule.xlsm?dl=0</a> thank you for your help the function is on the &quot;summarie&quot; sheet from cell C16 and so on, it should give me amounts based on the hours of sheet &quot;input schedule&quot; as I said before, it worked perfectly a earlier today, no idea what hapened"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "edited": false, "score": 0, "creation_date": 1452654551, "post_id": 34757628, "comment_id": 57261123, "body": "yeah! thank you solving that problem made me realize I had another one later in the code, wrong variable names is now working thank you very much!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "edited": false, "score": 0, "creation_date": 1452689300, "post_id": 34757628, "comment_id": 57279076, "body": "@JoseAntonio Please see the Edit to my answer for a different solution, and possible explanation."}, {"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "edited": false, "score": 0, "creation_date": 1452722866, "post_id": 34757628, "comment_id": 57300984, "body": "Thank you very much, it was was a combination of 2 thing I guess, fi you look closely in the huge &quot;if &quot;conditional at the end, I made a mistake with variables eHOUR sHOUR, I changed those names in the parameters and forgot to change in the conditional, now I thought everything was wrong because of the week never got the correct value, once I added .text I could go forward and see the REAL mistake; is now working correctly without the &quot;.text&quot;; I have no idea why variables several lines below could cause that odd behavior"}, {"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "edited": false, "score": 0, "creation_date": 1452722970, "post_id": 34757628, "comment_id": 57301041, "body": "if you change that eHOUR for TEHOR and sHOUR with STHOUR, everything will work"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "edited": false, "score": 0, "creation_date": 1453069442, "post_id": 34757628, "comment_id": 57429601, "body": "@JoseAntonio mistakes like this can be avoided by adding <code>Option Explicit</code> to the top of your code module.  This forces you to declare all variables, and will expose spelling mistakes and miss-matched variables/declarations"}, {"owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "edited": false, "score": 0, "creation_date": 1453215562, "post_id": 34757628, "comment_id": 57497878, "body": "Thank I&#39;ll try that from now on"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1452689215, "last_edit_date": 1452689215, "creation_date": 1452653671, "answer_id": 34757628, "question_id": 34756790, "link": "https://stackoverflow.com/questions/34756790/variable-in-excel-vba-not-loading-the-value-of-a-cell/34757628#34757628", "title": "Variable in excel vba not loading the value of a cell", "body": "<p>I do not understand the reason, but somehow, in the <code>tableWages(n).week = Sheets(nSheet).Cells(inRow + n, weekCol)</code> line, the range object is not returning the <code>Value</code> property as it should.</p>\n\n<p>I can get that line to work, by returning the <code>Text</code> property.  The proper week is then returned to the array.  But I do not understand why.</p>\n\n<pre><code>tableWages(n).week = Sheets(nSheet).Cells(inRow + n, weekCol).Text\n</code></pre>\n\n<p>I don't have time to research this further this evening, but the above change seems to eliminate the issue you had with <code>week 1</code> not populating.</p>\n\n<p>Of interest, I think, is this screen shot of the Watch Window taken after the first iteration of assignments to tableWages(0)</p>\n\n<p><a href=\"https://i.stack.imgur.com/ireUw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ireUw.png\" alt=\"enter image description here\"></a></p>\n\n<p>It shows that there is no Value being returned, even though the Text property is Week 1.</p>\n\n<p><strong>EDIT/ADD:</strong>\nFurther investigation suggests corruption in the <code>Table</code> on <code>input schedule</code> worksheet.</p>\n\n<p>Another fix for your problem,  <strong>NOT</strong> involving altering the code, would be to redo the formulas for the <code>Week</code> column.</p>\n\n<p>On <code>input schedule</code>:</p>\n\n<ul>\n<li>Select B6:B100</li>\n<li>Delete</li>\n<li>Select B5</li>\n<li>Place cursor in formula bar at the end of the formula</li>\n<li><code>Enter</code></li>\n<li>Since this is a table, the formula in B5 will be filled down to B500.</li>\n<li>Macro now works filling in <code>.week</code> as it should.</li>\n</ul>\n\n<p>A problem here would also explain why this was not a problem until recently.  Possibly a formula was altered somewhere in that column, and did not propagate properly to the entire column.</p>\n"}], "owner": {"reputation": 15, "user_id": 5781717, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-18JZxSzu_C8/AAAAAAAAAAI/AAAAAAAAPnU/H1YKUGsdvtY/photo.jpg?sz=128", "display_name": "Jose Antonio", "link": "https://stackoverflow.com/users/5781717/jose-antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1561, "favorite_count": 0, "accepted_answer_id": 34757628, "answer_count": 1, "score": 0, "last_activity_date": 1453067984, "creation_date": 1452647663, "last_edit_date": 1453067984, "question_id": 34756790, "link": "https://stackoverflow.com/questions/34756790/variable-in-excel-vba-not-loading-the-value-of-a-cell", "title": "Variable in excel vba not loading the value of a cell", "body": "<p>I've been using this forum more times that I can count, this is my first time asking a question here, currently my work makes me use excel and excel vba even for breakfast, so even thought that I'm nowhere near to be called a pro, I've made various rudimentary projects in my time.</p>\n\n<p>This problem is driving my crazy even to the point of despair, just can't see why, Don't know how to highlight the problem happens in the <strong>* part *</strong></p>\n\n<pre><code>Function WAGESPERHOUR(TSHOUR As Date, TEHOUR As Date, _\n     Optional TDAY, Optional TWEEK)\n\nDim tableWages(10000) As dataSchedule\nDim nSheet As String, inRow As Integer, inCol As Integer, _\nweekCol As Integer, dayCol As Integer, dateCol As Integer, _\nsShiftCol As Integer, eShiftCol As Integer, hoursWCol As Integer, _\nwageTCol As Integer, itemsCount As Integer, n As Integer\n\nApplication.Volatile\n\nErase tableWages\nWAGESPERHOUR = 0\nnSheet = \"input schedule\"\ninRow = 5\ninCol = 1\nweekCol = 2\ndayCol = 1\ndateCol = 3\nsShiftCol = 6\neShiftCol = 7\nhoursWCol = 10\nwageCol = 11\nitemsCount = 0\n\nFor n = 0 To 9999\n    If Sheets(nSheet).Cells(inRow + n, dateCol) = \"\" Then\n        itemsCount = n - 1\n        Exit For\n    End If\n    tableWages(n).day = Sheets(nSheet).Cells(inRow + n, dayCol)\n    *****tableWages(n).week = Sheets(nSheet).Cells(inRow + n, weekCol)*****\n    tableWages(n).startShift = Sheets(nSheet).Cells(inRow + n, sShiftCol)\n    tableWages(n).endShift = Sheets(nSheet).Cells(inRow + n, eShiftCol)\n    tableWages(n).hoursWorked = Sheets(nSheet).Cells(inRow + n, hoursWCol)\n    tableWages(n).wage = (Sheets(nSheet).Cells(inRow + n, wageCol) / 2)\n\nNext\n\nFor n = 0 To itemsCount\n    If TDAY = \"\" Then\n        tableWages(n).day = TDAY\n    End If\n    If TWEEK = \"\" Then\n        tableWages(n).week = TWEEK\n    End If\n    If ((tableWages(n).startShift &gt;= sHOUR And tableWages(n).startShift &lt; eHOUR) _\n     Or (tableWages(n).endShift &gt; sHOUR And tableWages(n).endShift &lt; sHOUR) _\n     Or (eHOUR &gt; tableWages(n).startShift And eHOUR &lt; tableWages(n).endShift) _\n     Or (sHOUR &gt;= tableWages(n).startShift And sHOUR &lt; tableWages(n).endShift)) _\n    And tableWages(n).day = TDAY _\n    And tableWages(n).week = TWEEK Then\n         WAGESPERHOUR = WAGESPERHOUR + tableWages(n).wage\n     End If\nNext\n\nEnd Function\n</code></pre>\n\n<p>The tableWages(n).week is supposed to get \"week 1\" from the cell (n,2); but it just doesn't; I use inspection and the cell values is correct but when is time to assign the value it stays in (\"\"); the worse part is that it worked before, I close the book open it again and stopped working. </p>\n\n<p><img src=\"https://i.stack.imgur.com/q5AAh.jpg\" alt=\"enter image description here\">\nI'm also attaching a printscreen, with the inspector showing that the cell does have \"Week 1\" but for some reason it can't save in the array. Every other variable works.</p>\n\n<p>Thanks for the help</p>\n\n<p>EDIT\nPrint Screen of the cells where it need to get the value.\n<img src=\"https://i.stack.imgur.com/0uBHy.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "autocad"], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1452698598, "creation_date": 1452698598, "answer_id": 34770448, "question_id": 34756685, "link": "https://stackoverflow.com/questions/34756685/find-groups-in-when-selected-on-screen/34770448#34770448", "title": "Find Groups in when selected on screen", "body": "<p>VBA's SelectionSet object can only select graphic elements\nand groups are not graphic elements, they're (named) selectionset themselves!</p>\n\n<p>to get possibly selected groups you must iterate through each element of the selectionset and check whether it belongs to a Group. then, if you need to make sure the whole group is selected you must check whether all elements of that group belongs to selectionset.</p>\n\n<p>it's quite a bunch of multiple iterations: if your drawing has many groups and/or many elements in groups then you'd better investigate the best suitable searching technique (arrays to store groups elements?) </p>\n"}], "owner": {"reputation": 89, "user_id": 5637841, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2fb08ebaa070580b841dfe1d061775e8?s=128&d=identicon&r=PG&f=1", "display_name": "Divyanshu", "link": "https://stackoverflow.com/users/5637841/divyanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 34770448, "answer_count": 1, "score": 0, "last_activity_date": 1452698598, "creation_date": 1452646989, "question_id": 34756685, "link": "https://stackoverflow.com/questions/34756685/find-groups-in-when-selected-on-screen", "title": "Find Groups in when selected on screen", "body": "<p>While i was running my code, i found that the number of groups present in the selection rectangle in mechanical drawings, are shown below in autocad drafting. But when i try to find using VBA, i couldn't because of unavailability of API. </p>\n\n<p><code>Option Explicit\nSub Group()\n'Declaration\nDim acApp As AcadDocument\nDim acSeSet As AcadSelectionSet\nSet acApp = ThisDrawing.Application.ActiveDocument\n'Selection Set Creation\nSet acSeSet = acApp.SelectionSets.Add(\"ShelSde4htd1\")\nacSeSet.SelectOnScreen</code> </p>\n\n<p>When i am running this part of code it goes to screen, and ask me to select the part on the screen. I am able to get entities from this selection but not the groups. I know group is also a collection, but can i then get the group selection from the selection on the screen? <a href=\"https://i.stack.imgur.com/uvbdy.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uvbdy.jpg\" alt=\"Test Drawing\"></a>  </p>\n\n<pre><code>    Dim acEnt As AcadEntity\n    Dim entity_handle() As String\n    Dim i As Integer\n    i = 0\n    Dim entity_count As Integer\n    entity_count = acSeSet.Count()          'Selection Set Count\n    ReDim entity_handle(entity_count)       'Resizing the entity handle array\n    For Each acEnt In acSeSet               'Iterating through selected entities and storing in one array, the handles\n        entity_handle(i) = acEnt.Handle\n         i = i + 1\n    Next\n</code></pre>\n\n<p>Here i can get the entities, but apart from it i also want to get the groups selected in that region.</p>\n"}, {"tags": ["vba", "excel", "row"], "comments": [{"owner": {"reputation": 108986, "user_id": 511529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YNRmY.jpg?s=128&g=1", "display_name": "GolezTrol", "link": "https://stackoverflow.com/users/511529/goleztrol"}, "edited": false, "score": 0, "creation_date": 1452645129, "post_id": 34756365, "comment_id": 57258728, "body": "<i>&quot;All the solutions out there&quot;</i> - Can you include such a solution?"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1452652978, "creation_date": 1452652978, "answer_id": 34757514, "question_id": 34756365, "link": "https://stackoverflow.com/questions/34756365/delete-entirerow-only-if-row-is-blank-otherwise-if-any-row-contains-any-data-rem/34757514#34757514", "title": "Delete Entirerow only if row is blank otherwise if any row contains any data remains", "body": "<p>Try the following-</p>\n\n<pre><code>Option Explicit\nSub DeleteBlankRow()\n    Dim i As Long\n\n    ActiveSheet.UsedRange.Select\n    '//- Turn off calculation and screenupdating.\n    With Application\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n            '//- Work backwards because we are deleting rows.\n            For i = Selection.Rows.Count To 1 Step -1\n                If WorksheetFunction.CountA(Selection.Rows(i)) = 0 Then\n                    Selection.Rows(i).EntireRow.Delete\n                End If\n            Next i\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1452657645, "creation_date": 1452657645, "answer_id": 34758191, "question_id": 34756365, "link": "https://stackoverflow.com/questions/34756365/delete-entirerow-only-if-row-is-blank-otherwise-if-any-row-contains-any-data-rem/34758191#34758191", "title": "Delete Entirerow only if row is blank otherwise if any row contains any data remains", "body": "<p>You can use this algorithm:<br>\n1) find the last row which is contains any value;<br>\n2) execute the loop through the rows with counting of the values in row and delete row in case when count of values in row is equal to zero, it can looks like the example below:</p>\n\n<pre><code>Sub DeleteBlankRows()\n    Dim i&amp;: i = Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n    While i &lt;&gt; 0\n        If WorksheetFunction.CountA(Rows(i)) = 0 Then Rows(i).Delete\n        i = i - 1\n    Wend\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5429103, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/223f5eac4d95f026d38a37abe43d58a6?s=128&d=identicon&r=PG&f=1", "display_name": "exlover", "link": "https://stackoverflow.com/users/5429103/exlover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1452657645, "creation_date": 1452644824, "last_edit_date": 1531164843, "question_id": 34756365, "link": "https://stackoverflow.com/questions/34756365/delete-entirerow-only-if-row-is-blank-otherwise-if-any-row-contains-any-data-rem", "title": "Delete Entirerow only if row is blank otherwise if any row contains any data remains", "body": "<p>Hi I am working on VBA Code that goes through all my data and only deletes an entire row if it is blank.  Therefore once the blank row is deleted, the row shift up.</p>\n\n<p>However, in case I have one row that contains some data. I want that row to remain unchanged. </p>\n\n<p>All the examples i have seen out there delete an entire row even if it has some data in the row. and Some of them delete the row but does not remove the row so that cells shift up.</p>\n\n<p>Please help me out.</p>\n"}, {"tags": ["vba", "excel", "concatenation"], "answers": [{"tags": [], "owner": {"reputation": 14954, "user_id": 14149, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cf140e210335908720b26b01b7bff6c1?s=128&d=identicon&r=PG", "display_name": "xpda", "link": "https://stackoverflow.com/users/14149/xpda"}, "is_accepted": false, "score": 0, "last_activity_date": 1452645269, "creation_date": 1452645269, "answer_id": 34756426, "question_id": 34756363, "link": "https://stackoverflow.com/questions/34756363/vba-concatenate-via-if-statement-error/34756426#34756426", "title": "VBA Concatenate via If Statement Error", "body": "<p>Set smsaddy to \"\" at the beginning, or in an <code>else</code>. Whenever phone1.value is not 7, smaddy is not currently initialized.</p>\n\n<p>Move <code>smsaddy = \"1813\" &amp; phone1 &amp; \"-18136896527@xx.com\"</code> to the following line.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 3381297, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7bdc15afa2d68cd2b92e35456e597192?s=128&d=identicon&r=PG&f=1", "display_name": "user3381297", "link": "https://stackoverflow.com/users/3381297/user3381297"}, "edited": false, "score": 0, "creation_date": 1452650874, "post_id": 34756435, "comment_id": 57260297, "body": "Thank you!!!  I had to add a If Len(phone1) = 7 Then but that did the trick!  Thanks so much!"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1452645314, "creation_date": 1452645314, "answer_id": 34756435, "question_id": 34756363, "link": "https://stackoverflow.com/questions/34756363/vba-concatenate-via-if-statement-error/34756435#34756435", "title": "VBA Concatenate via If Statement Error", "body": "<p>Three things:</p>\n\n<ul>\n<li>You need to declare the <code>lastrow</code> variable. </li>\n<li>with a multi-line If statement, you need a new line after the <code>then</code></li>\n<li><code>phone1</code>is a string, so you cant use <code>phone1.value</code>, just use <code>phone1</code> since you've already assigned the value to that variable.</li>\n</ul>\n\n<p>The code works fine when written like this</p>\n\n<pre><code>Option Explicit\nSub SMSemail()\n\nDim phone1 As String\nDim smsaddy As String\nDim lastrow As Long\n\nDim x As Long\nlastrow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\nFor x = 1 To lastrow\n\nphone1 = Cells(x, 4).Value\n\nIf phone1 = 7 Then\n\n    smsaddy = \"1813\" &amp; phone1 &amp; \"-18136896527@xx.com\"\n\n    Cells(x, 5).Value = smsaddy\n\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 3381297, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7bdc15afa2d68cd2b92e35456e597192?s=128&d=identicon&r=PG&f=1", "display_name": "user3381297", "link": "https://stackoverflow.com/users/3381297/user3381297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 34756435, "answer_count": 2, "score": 0, "last_activity_date": 1452645314, "creation_date": 1452644802, "question_id": 34756363, "link": "https://stackoverflow.com/questions/34756363/vba-concatenate-via-if-statement-error", "title": "VBA Concatenate via If Statement Error", "body": "<p>I'm working with a phone company that is allowing me to send SMS messages via an e-mail routing system.  So, I'll email the message to their server and it will be sent via sms to the end number. The thing is, I need to convert hundreds of phone numbers of various formats into an e-mail address using the to-from@... format (to/from including 1 + area code).  </p>\n\n<p>I wrote a formula that works great: =IF(LEN(a1)=5,CONCATENATE(\"1813\",a1,\"00\",\"-1813xxxxxxx@sms.xx.com\"),IF(LEN(a1)=6,CONCATENATE(\"1813\",a1,\"0\",\"-1813xxxxxxx@sms.xx.com\"),IF(LEN(a1)=10,CONCATENATE(\"1\",a1,\"-1813xxxxxxx@sms.xx.com\"),(IF(LEN(a1)=7,CONCATENATE(\"1813\",a1,\"-1813xxxxxxx@sms.xx.com\"),a1)))))</p>\n\n<p>It adds the required text, but I'd like to make this into a VBA.  </p>\n\n<p>I'm new to VBA (forgive me if this is a rookie mistake), but this is what I have so far:</p>\n\n<pre><code>Option Explicit\n\nSub SMSemail()\n\nDim phone1 As String\nDim smsaddy As String\n\nDim x As Long\nlastrow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\nFor x = 1 To lastrow\n\nphone1 = Cells(x, 4).Value\n\nIf phone1.Value = 7 Then smsaddy = \"1813\" &amp; phone1 &amp; \"-18136896527@xx.com\"\n\nCells(x, 5).Value = smsaddy\n\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Right now I'm getting a compile error but I've tweaked it a few times and sometimes its a \"variable undefined\" on the lastrow line...  I don't understand it though since it seems like I'm defining everything up above; I'm lost and hoping you can help!  Thanks in advance!!!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5688707"}, "edited": false, "score": 0, "creation_date": 1452645244, "post_id": 34755985, "comment_id": 57258760, "body": "Is it a control array? if so then you can use the .index method for the object, otherwise if i&#39;s all separate images then that complicates matters a lot more."}, {"owner": {"reputation": 139, "user_id": 3330307, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57bd3d4786025304914aadae2115e1de?s=128&d=identicon&r=PG&f=1", "display_name": "xDeathwing", "link": "https://stackoverflow.com/users/3330307/xdeathwing"}, "edited": false, "score": 0, "creation_date": 1452647454, "post_id": 34755985, "comment_id": 57259316, "body": "Well it is all seperate images, think of em as seats in a theater that are configurable :)"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 3330307, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57bd3d4786025304914aadae2115e1de?s=128&d=identicon&r=PG&f=1", "display_name": "xDeathwing", "link": "https://stackoverflow.com/users/3330307/xdeathwing"}, "edited": false, "score": 0, "creation_date": 1452647404, "post_id": 34756380, "comment_id": 57259308, "body": "Thanks a lot.. Ive been trying to overcome this for a great +6 hours Now with this.. I can complete my little project of making a movie program with configurable theater sizes :)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1452644935, "creation_date": 1452644935, "answer_id": 34756380, "question_id": 34755985, "link": "https://stackoverflow.com/questions/34755985/word-getting-image-clicked-by-mouse-visual-basic/34756380#34756380", "title": "Word getting image clicked by mouse [Visual Basic]", "body": "<p>Class module clsImg:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents img As MSForms.Image\n\nPrivate Sub img_Click()\n    Debug.Print \"single - \" &amp; img.Name\nEnd Sub\n\nPrivate Sub img_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    Debug.Print \"double - \" &amp; img.Name\nEnd Sub\n</code></pre>\n\n<p>Your Form module:</p>\n\n<pre><code>Private col As New Collection\n\nPrivate Sub UserForm_Activate()\n    Dim o As clsImg, c As Object\n\n    For Each c In Me.Controls\n        If TypeName(c) = \"Image\" Then\n            Set o = New clsImg\n            Set o.img = c\n            col.Add o\n        End If\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 3330307, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57bd3d4786025304914aadae2115e1de?s=128&d=identicon&r=PG&f=1", "display_name": "xDeathwing", "link": "https://stackoverflow.com/users/3330307/xdeathwing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 34756380, "answer_count": 1, "score": 0, "last_activity_date": 1503234692, "creation_date": 1452642719, "last_edit_date": 1503234692, "question_id": 34755985, "link": "https://stackoverflow.com/questions/34755985/word-getting-image-clicked-by-mouse-visual-basic", "title": "Word getting image clicked by mouse [Visual Basic]", "body": "<p>I have a basic user form with 100 images (10x10) inside a multipage frame,\nall images are renamed after their positions (top left 00 and bottom right 99)</p>\n\n<p>so instead of making imagexx_click() function for each image I want a way to detect which image (or an object) is clicked</p>\n\n<p>Whats tried;</p>\n\n<p>I tried to use MultiPage1_Click() to detect but that only detects for the multipage, if user clicks an image inside it, it doesn't detect</p>\n\n<p>I tried to use eventhandler with application as documented <a href=\"http://www.xtremevbtalk.com/word-powerpoint-outlook-and-other-office-products/23313-capture-mouse-click-event-paragraph-ms-word.html\" rel=\"nofollow\">here</a>\nbut I had no luck with both <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.word.document.beforedoubleclick.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">BeforeDoubleClick</a> event and <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.word.document.selectionchange.aspx\" rel=\"nofollow\">SelectionChange</a> event</p>\n\n<p>I even tried to reference system and implement a mouse click event </p>\n\n<p>So what would be an easy solution for this</p>\n"}, {"tags": ["arrays", "vba", "excel", "for-loop", "nested"], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452644368, "post_id": 34756167, "comment_id": 57258508, "body": "Yea that&#39;s exactly what I was going for. I should&#39;ve tried a Boolean before posting. Thanks for your time. The issue with my way though, even with a=0 outside of the for loop, was the error that the array is locked with the goto. I don&#39;t quite understand the error but it&#39;s nice to have another way to do it. Thanks."}, {"owner": {"reputation": 329, "user_id": 4975934, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZhKlTGe3V2A/AAAAAAAAAAI/AAAAAAAAAGY/XcZuW3Jr27A/photo.jpg?sz=128", "display_name": "charliefox2", "link": "https://stackoverflow.com/users/4975934/charliefox2"}, "reply_to_user": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452644541, "post_id": 34756167, "comment_id": 57258558, "body": "No problem. Do you get the &quot;array is fixed&quot; error using <code>Exit For</code>? You shouldn&#39;t - and then, with the <code>a = 0</code> outside the first For Each, it should work exactly the same as my answer."}, {"owner": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452645107, "post_id": 34756167, "comment_id": 57258723, "body": "Using an Exit For with your solution gives a compile error. I&#39;m not quite sure what you&#39;re asking :)"}, {"owner": {"reputation": 329, "user_id": 4975934, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZhKlTGe3V2A/AAAAAAAAAAI/AAAAAAAAAGY/XcZuW3Jr27A/photo.jpg?sz=128", "display_name": "charliefox2", "link": "https://stackoverflow.com/users/4975934/charliefox2"}, "reply_to_user": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452645318, "post_id": 34756167, "comment_id": 57258778, "body": "Will update when I get a chance. That said, if it ain&#39;t broke, don&#39;t fix it ;)"}, {"owner": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452645379, "post_id": 34756167, "comment_id": 57258796, "body": "Yea I wouldn&#39;t worry about it haha"}], "tags": [], "owner": {"reputation": 329, "user_id": 4975934, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZhKlTGe3V2A/AAAAAAAAAAI/AAAAAAAAAGY/XcZuW3Jr27A/photo.jpg?sz=128", "display_name": "charliefox2", "link": "https://stackoverflow.com/users/4975934/charliefox2"}, "is_accepted": true, "score": 2, "last_activity_date": 1452643730, "creation_date": 1452643730, "answer_id": 34756167, "question_id": 34755897, "link": "https://stackoverflow.com/questions/34755897/exiting-nested-for-loop-vba-and-re-looping/34756167#34756167", "title": "Exiting Nested For loop VBA and re-looping", "body": "<p>You could use a boolean flag - I don't know that it's the accepted method, but I use it from time to time.</p>\n\n<pre><code>Dim skipBool as Boolean = False    \n\nFor Each vN In Array(dAFLcell, dSFcell, dSOcell, dFIGcell, dIBAcell, dIBXcell)\n    a = 0 'I think you want this out here, otherwise a will always equal 0\n    For Each vN2 In Array(AFLcell, SFcell, SOcell, FIGcell, IBAcell, IBXcell)    \n        If Not skipBool Then 'run this stuff only if we don't want to skip it (duh!)       \n\n            If i = a Then\n                MsgBox a\n                skipBool = True 'set skipBool to be True (we want to skip it!)\n            End If\n            a = a + 1\n        End If\n    Next vN2\n    i = i + 1\n    skipBool = False 'reset skipBool for the next go around\nNext vN\n</code></pre>\n\n<p>I'm sure this code can be optimized a bit further (and to be honest, I haven't tested it), but it looks like this is what you're going for.</p>\n\n<p>To be honest, the only problem might be that <code>a = 0</code> was inside the second for loop, and that's why you weren't getting the results you expected. It's been a while since I've used VBA (I've only been using VB.NET), so I don't remember the exact syntax there. I'd try fixing that, and going back to the exit for method. If it still doesn't work, my code should.</p>\n"}, {"comments": [{"owner": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452644984, "post_id": 34756337, "comment_id": 57258675, "body": "would this solution be more robust with 3 for loops?"}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452645126, "post_id": 34756337, "comment_id": 57258727, "body": "Loops within loops mean x * y iterations...  fewer should be more efficient; not necessarily more robust, depending on what you want.  The way I read your question, you wanted to compare arrayA(1) to arrayB(1), arrayA(2) to arrayB(2).  If so, a single loop <b>should</b> do the trick.  Granted, we&#39;re talking a few records, not millions, so &quot;efficient&quot; is not that critical."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452645238, "post_id": 34756337, "comment_id": 57258757, "body": "And I should mention it&#39;s possible I misread your requirement!"}, {"owner": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452645286, "post_id": 34756337, "comment_id": 57258771, "body": "Yes in terms of my immediate problem it&#39;s only 2 arrays. However I had a thought at some point I might need a 3rd array to compare arrayA(1) to arrayB(1) to arrayC(1), and wondered if this would be a better way."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "reply_to_user": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452653799, "post_id": 34756337, "comment_id": 57260986, "body": "I see -- in that case, I think if you <i>can</i> get away with doing a single loop, I still think that might be most efficient.  If, for example, you had 100 elements in each array, the single loop iterates 100 times, whereas you would potentially have 100 x 100 x 100 iterations if you had three loops.  Of course, with short-circuiting it would end up being less than that, but you get the idea.  I did like the @charliefox2 solution and +1&#39;ed it.  It was the most direct answer to your question/code."}, {"owner": {"reputation": 329, "user_id": 4975934, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZhKlTGe3V2A/AAAAAAAAAAI/AAAAAAAAAGY/XcZuW3Jr27A/photo.jpg?sz=128", "display_name": "charliefox2", "link": "https://stackoverflow.com/users/4975934/charliefox2"}, "reply_to_user": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452661858, "post_id": 34756337, "comment_id": 57263170, "body": "@FancyDolphin I guess I didn&#39;t look at the code closely enough, but if the end goal was to compare elements of the same index in each array, then I feel that Hambone&#39;s solution is the better choice. However, with this solution, I would set <code>max</code> equal to the shorter of the two arrays, or you would get an out of bounds error if they were not of equal length. In terms of efficiency, this solution is also the better choice - 30 times out of 36, my solution simply skips the code. Hambone&#39;s runs exactly what you need."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1452689800, "post_id": 34756337, "comment_id": 57279416, "body": "Oh my gosh, I zigged when I should have zagged...  you are right; my <code>max</code> should be a <code>min</code>.  I&#39;ll fix that.  Good catch."}, {"owner": {"reputation": 329, "user_id": 4975934, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZhKlTGe3V2A/AAAAAAAAAAI/AAAAAAAAAGY/XcZuW3Jr27A/photo.jpg?sz=128", "display_name": "charliefox2", "link": "https://stackoverflow.com/users/4975934/charliefox2"}, "reply_to_user": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "edited": false, "score": 0, "creation_date": 1452703915, "post_id": 34756337, "comment_id": 57289898, "body": "@FancyDolphin I would go with Hambone&#39;s answer on this one over mine - for what you are trying to do, this is the solution."}, {"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1452704130, "post_id": 34756337, "comment_id": 57290065, "body": "Don&#39;t &quot;officially&quot; change your choice.  That&#39;s hardly necessary -- a correct answer is still a correct answer."}], "tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": false, "score": 2, "last_activity_date": 1452689877, "last_edit_date": 1452689877, "creation_date": 1452644666, "answer_id": 34756337, "question_id": 34755897, "link": "https://stackoverflow.com/questions/34755897/exiting-nested-for-loop-vba-and-re-looping/34756337#34756337", "title": "Exiting Nested For loop VBA and re-looping", "body": "<p>Here's another possible approach:</p>\n\n<pre><code>  Dim vn, Vn2 As Variant\n  Dim i, min As Integer\n\n  vn = Array(dAFLcell, dSFcell, dSOcell, dFIGcell, dIBAcell, dIBXcell)\n  Vn2 = Array(AFLcell, SFcell, SOcell, FIGcell, IBAcell, IBXcell)\n\n  If UBound(vn) &lt;= UBound(Vn2) Then\n    min = UBound(vn)\n  Else\n    min = UBound(Vn2)\n  End If\n\n  For i = LBound(vn) To min\n    If vn(i) = Vn2(i) Then\n      MsgBox vn(i)\n      Exit For\n    End If\n  Next i\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 1406609, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0c20387b206378db5b52532238478a34?s=128&d=identicon&r=PG", "display_name": "FancyDolphin", "link": "https://stackoverflow.com/users/1406609/fancydolphin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "accepted_answer_id": 34756167, "answer_count": 2, "score": 1, "last_activity_date": 1452689877, "creation_date": 1452642249, "last_edit_date": 1452643962, "question_id": 34755897, "link": "https://stackoverflow.com/questions/34755897/exiting-nested-for-loop-vba-and-re-looping", "title": "Exiting Nested For loop VBA and re-looping", "body": "<p>I'm trying to work with a nested For loop. I essentially have 2 arrays and I want to use the 1st variable in array1 with the 1st variable in array2 to do some operation, and so on until the array is exhausted. Unfortunately, the Exit For, doesn't exit for the For levels. So I've tried to use a goTo command, however then I get an error of  \"This array is fixed or temporarily locked\" clearly because I'm trying to re-access the array. I'm stuck how to get around this in VBA. Below is my code where at MsgBox some operation (that will need the pairs (dAFL,AFL),(dSF,SF), etc) will take place:    </p>\n\n<pre><code>For Each vN In Array(dAFLcell, dSFcell, dSOcell, dFIGcell, dIBAcell, dIBXcell)\na = 0\nFor Each vN2 In Array(AFLcell, SFcell, SOcell, FIGcell, IBAcell, IBXcell)\n\n\nIf i = a Then\n    MsgBox a\n    GoTo end_of_for\nEnd If\na = a + 1\nNext vN2\nend_of_for:\ni = i + 1\nNext vN\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2309, "user_id": 1411000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRPK5.jpg?s=128&g=1", "display_name": "Hiten004", "link": "https://stackoverflow.com/users/1411000/hiten004"}, "edited": false, "score": 0, "creation_date": 1452639605, "post_id": 34755339, "comment_id": 57256910, "body": "what is your degug statement? try <code>debug.print Rec(0, 0)</code>"}, {"owner": {"reputation": 635, "user_id": 3839756, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a3a56e8fcc41ebeca5b764f16ba4580f?s=128&d=identicon&r=PG&f=1", "display_name": "user3839756", "link": "https://stackoverflow.com/users/3839756/user3839756"}, "reply_to_user": {"reputation": 2309, "user_id": 1411000, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gRPK5.jpg?s=128&g=1", "display_name": "Hiten004", "link": "https://stackoverflow.com/users/1411000/hiten004"}, "edited": false, "score": 0, "creation_date": 1452639891, "post_id": 34755339, "comment_id": 57257003, "body": "10, which is my expected output. However when I pause and hover it shows Rec ="}, {"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1452658352, "post_id": 34755339, "comment_id": 57262036, "body": "blank is the default value you specified when the section-key not found.  Did you pause on show message or on NC = ...?"}], "owner": {"reputation": 635, "user_id": 3839756, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a3a56e8fcc41ebeca5b764f16ba4580f?s=128&d=identicon&r=PG&f=1", "display_name": "user3839756", "link": "https://stackoverflow.com/users/3839756/user3839756"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1452639325, "creation_date": 1452639325, "question_id": 34755339, "link": "https://stackoverflow.com/questions/34755339/getprivateprofilestring-return-string-variable-not-set", "title": "GetPrivateProfileString Return String Variable not set", "body": "<p>Im using getPrivateProfileString to read from an API. Here I call the method and get a store number</p>\n\n<pre><code>Rec = String(255, 0)\nNC = GetPrivateProfileString(\"ConfigInfo\", \"store\", \"\", Rec, 255, \"C:\\MyPath\")\n</code></pre>\n\n<p>Now when I debug Rec has no value</p>\n\n<p>However when I use Rec in a message box it shows its value as expected.</p>\n\n<p>Why is the variable Rec an empty variable instead of holding my store number as expected? Why does Rec's value seem to be as expected in a message box?</p>\n"}, {"tags": ["vba", "excel", "data-connections"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1452639433, "post_id": 34755288, "comment_id": 57256848, "body": "Workbook A would have to be closed for it to not open in read-only mode. As long as nothing in Workbook A needs to be changed, it will still refresh the data in Workbook B whether it&#39;s in read-only mode or not."}, {"owner": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 1, "creation_date": 1452640097, "post_id": 34755288, "comment_id": 57257080, "body": "I don&#39;t want workbook A to open at all when someone else has it opened. The update needs to happen in the background."}, {"owner": {"reputation": 165, "user_id": 1194396, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4b8813689b4a973e952074f08529dacc?s=128&d=identicon&r=PG&f=1", "display_name": "ositra", "link": "https://stackoverflow.com/users/1194396/ositra"}, "edited": false, "score": 0, "creation_date": 1526375361, "post_id": 34755288, "comment_id": 87708324, "body": "Looking forward to somebody helping with this problem! I have the same situation. My two workbooks are connected with a MS Query connection."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "edited": false, "score": 0, "creation_date": 1452641125, "post_id": 34755580, "comment_id": 57257468, "body": "Already tried that and the same thing happens. The only way around this I see is &quot;If workbook A is open, Exit Sub Else thisworkbook.refreshall.&quot;"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "reply_to_user": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "edited": false, "score": 0, "creation_date": 1452642320, "post_id": 34755580, "comment_id": 57257899, "body": "Yes, maybe myBoolean = IsWorkBookOpen(&quot;C:\\myWorkbook.xlsm&quot;) If myBoolean Then Exit Sub Else refreshall"}], "tags": [], "owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "is_accepted": false, "score": 0, "last_activity_date": 1452640495, "creation_date": 1452640495, "answer_id": 34755580, "question_id": 34755288, "link": "https://stackoverflow.com/questions/34755288/excel-automatically-opens-data-source-when-i-refresh-connection/34755580#34755580", "title": "Excel automatically opens data source when I refresh connection", "body": "<pre><code>Application.Screenupdating = False\n 'your code here\nApplication.Screenupdating = True\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 2898478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/0bd93104ed087aecac701ad3fc80c268?s=128&d=identicon&r=PG&f=1", "display_name": "DigitalSea", "link": "https://stackoverflow.com/users/2898478/digitalsea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1104, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1526456462, "creation_date": 1452639071, "last_edit_date": 1452659803, "question_id": 34755288, "link": "https://stackoverflow.com/questions/34755288/excel-automatically-opens-data-source-when-i-refresh-connection", "title": "Excel automatically opens data source when I refresh connection", "body": "<p>I have two workbooks on a shared network drive:</p>\n\n<ul>\n<li><code>Workbook A (source: Table with data)</code></li>\n<li><code>Workbook B (Pivot Table -Connected to Table in Workbook A)</code></li>\n</ul>\n\n<p>When a user has workbook A open and another user tries to open workbook B and refreshes the data, it automatically opens workbook A in read-only mode to refresh data. This seems to only happen when workbook A(source) is opened for editing. </p>\n\n<p>How can I prevent this from happening? Would a macro solve this?</p>\n"}, {"tags": ["ms-access", "vba", "doevents"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1452641286, "post_id": 34754995, "comment_id": 57257529, "body": "Macro running for hours... Access has a limit of 2GB DB size, unless you link many databases together... Maybe your macro needs some optimization. Or you database does. Do you use proper indexes? Use SQL wherever you can instead of macros."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 3, "last_activity_date": 1452640233, "creation_date": 1452640233, "answer_id": 34755525, "question_id": 34754995, "link": "https://stackoverflow.com/questions/34754995/vba-doevents-in-access-or-an-alternative/34755525#34755525", "title": "VBA DoEvents() in Access or an alternative", "body": "<p><code>DoEvents</code> has its uses, e.g. if you have a long running loop and want to give the user a \"Cancel\" button that he can actually click.</p>\n\n<p>But in your use case the best option is: </p>\n\n<ul>\n<li>Make a copy of your frontend database</li>\n<li>Run your VBA code in one instance of Access with the first frontend</li>\n<li>Start a second instance of Access, open the second frontend, do whatever you want (well, you shouldn't do something that locks tables used by the first instance).</li>\n</ul>\n"}], "owner": {"reputation": 5422, "user_id": 3123109, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/95c33442a31305c50683b2db05d49106?s=128&d=identicon&r=PG&f=1", "display_name": "cjones", "link": "https://stackoverflow.com/users/3123109/cjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1609, "favorite_count": 0, "accepted_answer_id": 34755525, "answer_count": 1, "score": 0, "last_activity_date": 1452640233, "creation_date": 1452637838, "question_id": 34754995, "link": "https://stackoverflow.com/questions/34754995/vba-doevents-in-access-or-an-alternative", "title": "VBA DoEvents() in Access or an alternative", "body": "<p>I am reading about options that will allow me to run a macro without locking down my session of Access until it is done running. I have some VBA macros for Access that execute SQL SELECT and UPDATE statements and can take almost an hour to run. This currently locks down Access for me until it is done running.</p>\n\n<p>I am seeing what options there are so that I can the macro and and still use Access while it finishes running the report in the background. I came across DoEvents() as an option, but just about everything says not to us it. So what are some good alternatives?</p>\n"}, {"tags": ["vba", "batch-file", "vbscript", "windows-7", "explorer"], "comments": [{"owner": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 0, "creation_date": 1452640788, "post_id": 34754556, "comment_id": 57257329, "body": "Can&#39;t say I&#39;ve ever seen an explorer window that had a title, third-party application or not."}, {"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1452641311, "post_id": 34754556, "comment_id": 57257540, "body": "You might be interested in <a href=\"https://stackoverflow.com/questions/tagged/autohotkey\">autohotkey</a>..."}, {"owner": {"reputation": 11, "user_id": 5781240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980b90624608f5b26e5a5d79bafb17ce?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Hmm", "link": "https://stackoverflow.com/users/5781240/jacob-hmm"}, "edited": false, "score": 0, "creation_date": 1452668390, "post_id": 34754556, "comment_id": 57265624, "body": "auto hotkey is a scripting language that has to be compiled as far as i know, so wouldnt help me out here unfortunately  as for 3rd party apps, Window Title Changer can apparently change titles of any windows, but its an app, and therefore wont be able to use it"}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1452673528, "post_id": 34754556, "comment_id": 57268342, "body": "Windows Explorer can be configured to display the full path in the title bar. That&#39;s about it."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1452686791, "post_id": 34754556, "comment_id": 57277408, "body": "@AnsgarWiechers Possibly can through the Windows API but you can&#39;t call the Windows API through VBScript unless it&#39;s wrapped in a COM component. Think you would use the API call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms633546(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>SetWindowText()</code></a>. If they are using VBA you can declare Windows API functions so should be possible."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1452687002, "post_id": 34754556, "comment_id": 57277539, "body": "What are you using VBA, VBScript, Batch make your mind up."}, {"owner": {"reputation": 11, "user_id": 5781240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980b90624608f5b26e5a5d79bafb17ce?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Hmm", "link": "https://stackoverflow.com/users/5781240/jacob-hmm"}, "edited": false, "score": 0, "creation_date": 1452712916, "post_id": 34754556, "comment_id": 57295652, "body": "would be great if it is - i was also checking the setwindowtext() command, but could only find it being used in c or c++. If there is a way to make a vba that would refer to it, would be perfect. I could even go cazy and incorporate it in excel and make button macros to run the script to open any titled windows i want. If there is anyone who is able to write a script that uses SetWindowText() in VBA, please assist."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1452715157, "post_id": 34754556, "comment_id": 57297023, "body": "@JacobHmm <a href=\"http://www.pinvoke.net/default.aspx/user32.setwindowtext\" rel=\"nofollow noreferrer\">this link</a> shows the VB signature for the declare to allow yo use it in VBA."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5781240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980b90624608f5b26e5a5d79bafb17ce?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Hmm", "link": "https://stackoverflow.com/users/5781240/jacob-hmm"}, "edited": false, "score": 2, "creation_date": 1452668526, "post_id": 34756260, "comment_id": 57265695, "body": "unfortunately im not really looking to change the internet explorer window name, but windows explorer, so this doesnt help me out"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1452686672, "post_id": 34756260, "comment_id": 57277339, "body": "Plus &quot;iexplorer&quot; is incorrect if your talking about the EXE for Internet Explorer it&#39;s <code>iexplore.exe</code>, drop the <code>r</code>."}, {"owner": {"reputation": 139, "user_id": 3330307, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57bd3d4786025304914aadae2115e1de?s=128&d=identicon&r=PG&f=1", "display_name": "xDeathwing", "link": "https://stackoverflow.com/users/3330307/xdeathwing"}, "edited": false, "score": 0, "creation_date": 1452695734, "post_id": 34756260, "comment_id": 57283543, "body": "I do know infact that iexplore.exe is correct but I tried to shorten internet explorer as iexplorer (so no kudos there for you my friend :/)  also while the topic linked tells you about internet explorer.. I wrote 2 different ways (2nd one that works) which tell seperate things.. so please before giving negative votes, read my full answer my friend :)"}, {"owner": {"reputation": 11, "user_id": 5781240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980b90624608f5b26e5a5d79bafb17ce?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Hmm", "link": "https://stackoverflow.com/users/5781240/jacob-hmm"}, "edited": false, "score": 1, "creation_date": 1452712605, "post_id": 34756260, "comment_id": 57295460, "body": "sorry to say, but as much as the statement might be true about internet explorer and how to set the tite for it - it is not what my question is about at all  and changing window title isnt as easy as changing theme options at all either - deffinitely not for Windows Explorer windows.   explorer.exe =/= iexplore (internet explorer)"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1452772947, "post_id": 34756260, "comment_id": 57321499, "body": "Not after <i>&quot;kudos&quot;</i> just don&#39;t see the point in using <i>&quot;iexplorer&quot;</i> it&#39;s unnecessary <i>(not a well known shortened description of Internet Explorer)</i>, what&#39;s wrong with IE?"}, {"owner": {"reputation": 139, "user_id": 3330307, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57bd3d4786025304914aadae2115e1de?s=128&d=identicon&r=PG&f=1", "display_name": "xDeathwing", "link": "https://stackoverflow.com/users/3330307/xdeathwing"}, "edited": false, "score": 0, "creation_date": 1452800052, "post_id": 34756260, "comment_id": 57339403, "body": "Well, its beacuse of the rythm that feels nice to me when red by my language&#39;s accent. IE otherwise sounds something like disgusting (especially e ending sometimes sounds like eww) so thats why I tried to use iexplorer.. also it fits apple&#39;s naming conventions.. i+stuff :)"}], "tags": [], "owner": {"reputation": 139, "user_id": 3330307, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57bd3d4786025304914aadae2115e1de?s=128&d=identicon&r=PG&f=1", "display_name": "xDeathwing", "link": "https://stackoverflow.com/users/3330307/xdeathwing"}, "is_accepted": false, "score": -2, "last_activity_date": 1452644174, "last_edit_date": 1490005093, "creation_date": 1452644174, "answer_id": 34756260, "question_id": 34754556, "link": "https://stackoverflow.com/questions/34754556/set-windows-explorer-window-title/34756260#34756260", "title": "Set Windows Explorer window title", "body": "<p>According to <a href=\"http://www.theeldergeek.com/change_ie_title_bar_text.htm\" rel=\"nofollow noreferrer\">here</a> its possible to do it for iexplorer (internet explorer)\nso by a blind guess it might be possible to do it the same way for explorer\nwindows>run>regedit.exe\nHKEY_CURRENT_USER > Software > Microsoft > Windows > CurrentVersion > Explorer and a new data with string as value type and window title as value name</p>\n\n<p>And by changing theme it is possible to achieve a same or maybe similar objective, everything explained <a href=\"https://superuser.com/questions/594705/change-window-title-text-on-windows-8\">here</a> could be done with a batch script</p>\n"}], "owner": {"reputation": 11, "user_id": 5781240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980b90624608f5b26e5a5d79bafb17ce?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Hmm", "link": "https://stackoverflow.com/users/5781240/jacob-hmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1430, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452673699, "creation_date": 1452635948, "last_edit_date": 1452673699, "question_id": 34754556, "link": "https://stackoverflow.com/questions/34754556/set-windows-explorer-window-title", "title": "Set Windows Explorer window title", "body": "<p>I work with multiple Explorer windows that use different user credentials and I was wondering if there is a way to set a static title for each window to be able to determine which one uses which user credentials, like window A title set to \"user abc\" - since the titles change to the currently opened directory which is rather confusing sometimes with multiple windows open</p>\n\n<p>I'm looking for as simple solution as possible, batch, VBScript, etc., something that can be easily ran from either a command line or a script file that doesnt need any compilation, conversion or specific software installed, for example:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>open explorer.exe title=\"custom title\"\n</code></pre>\n\n<p>So far I wasn't able to find any scripts that could handle that - 3rd party applications are out of the question.</p>\n\n<p>Not sure if it's even possible, tried to find anything for few days now to no avail.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1452635577, "post_id": 34754129, "comment_id": 57255050, "body": "Just need to use the Range.Replace method with wildcards: <code>AdjacencyData.Cells.Replace &quot;*NOT FOUND IN MASTER CAT LIST*&quot;, &quot;LOCATION UNSURE&quot;, xlWhole</code>"}], "answers": [{"comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452635628, "post_id": 34754449, "comment_id": 57255079, "body": "Range.FindNext isn&#39;t really necessary.  Can be done with a single <code>Range.Replace</code>"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452635685, "post_id": 34754449, "comment_id": 57255106, "body": "@tigeravatar True.  Suggest it as an answer and I&#39;ll upvote.  However, this method works as well."}, {"owner": {"reputation": 41, "user_id": 5669576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbd7b7744384809b1244b311c6ddac7?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Kat", "link": "https://stackoverflow.com/users/5669576/holly-kat"}, "edited": false, "score": 0, "creation_date": 1452714980, "post_id": 34754449, "comment_id": 57296930, "body": "What would it look like to do with a simple Range.Replace? Would that search the cell to see if it contains the phrase, but then change the entire cell value?"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1452635661, "last_edit_date": 1452635661, "creation_date": 1452635590, "answer_id": 34754449, "question_id": 34754129, "link": "https://stackoverflow.com/questions/34754129/search-cell-value-by-part-replace-entire-cell-value/34754449#34754449", "title": "Search Cell Value by Part, Replace Entire Cell Value", "body": "<p>You will want to invest in the <code>.Range.FindNext</code> function:</p>\n\n<pre><code>FindMe = \"NOT FOUND IN MASTER CAT LIST\"\nWith Sheets(\"AdjacencyData\").Range(\"Defined Range\") \n    Set f = .Find(What:=FindMe, lookin:=xlValues) \n    If Not f Is Nothing Then \n        firstAddress = f.Address \n        Do \n            f.Value = \"LOCATION UNSURE\" \n            Set f = .FindNext(f) \n        Loop While Not f Is Nothing And f.Address &lt;&gt; firstAddress \n    End If \nEnd With\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5669576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbd7b7744384809b1244b311c6ddac7?s=128&d=identicon&r=PG&f=1", "display_name": "Holly Kat", "link": "https://stackoverflow.com/users/5669576/holly-kat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1452635661, "creation_date": 1452634206, "last_edit_date": 1452635446, "question_id": 34754129, "link": "https://stackoverflow.com/questions/34754129/search-cell-value-by-part-replace-entire-cell-value", "title": "Search Cell Value by Part, Replace Entire Cell Value", "body": "<p>I would like to search all cells on my named worksheet (AdjacencyData) to see if they contain the value \"NOT FOUND IN MASTER CATEGORY LIST.\" My cells contain long strings, and hidden somewhere with in them could be the phrase. I want to search the entire cell to see if that phrase is anywhere within, and then if the cell contains that phrase anywhere within, replace the entire value with the cell with a new phrase \"LOCATION UNSURE\" Is there any way to do this? I have some guesses, but I am not very good with the find and replace option.</p>\n\n<pre><code>find = \"NOT FOUND IN MASTER CAT LIST\"\nf = AdjacencyData.Cells.find(What:=find, lookat:=xlPart)\nIf f Is Nothing Then\n    Else\n</code></pre>\n\n<p>Don't know what to do next, this partial code is my only idea!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23, "user_id": 5780788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc43965306892561a5e6a410693f25e?s=128&d=identicon&r=PG&f=1", "display_name": "t0ucansam", "link": "https://stackoverflow.com/users/5780788/t0ucansam"}, "edited": false, "score": 0, "creation_date": 1452634622, "post_id": 34753817, "comment_id": 57254566, "body": "Just to clarify, the solution does not have to be VBA. In fact it would be better if it weren&#39;t."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1452635884, "post_id": 34753817, "comment_id": 57255236, "body": "A <a href=\"http://stackoverflow.com/questions/14189085/excel-reverse-match\">reverse match</a> might help. With that, you will have the row number, which can be used in an index formula to get the desired result. Give me a minute..."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5780788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc43965306892561a5e6a410693f25e?s=128&d=identicon&r=PG&f=1", "display_name": "t0ucansam", "link": "https://stackoverflow.com/users/5780788/t0ucansam"}, "edited": false, "score": 0, "creation_date": 1452637048, "post_id": 34754699, "comment_id": 57255811, "body": "Thanks so much for your solution and thorough explanation!"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 2, "last_activity_date": 1452636612, "creation_date": 1452636612, "answer_id": 34754699, "question_id": 34753817, "link": "https://stackoverflow.com/questions/34753817/how-to-find-parent-in-an-indented-hierarchy/34754699#34754699", "title": "How to find parent in an indented hierarchy?", "body": "<p>OK, assuming the above table starts in cell A1, useful data starts in row 2. This formula will do the trick:</p>\n\n<pre><code>=INDEX($A$1:$A$7,MAX(IF($B$2:$B2=B2-1,ROW($B$2:$B2),\"\")))\n</code></pre>\n\n<p>Enter this in cell <code>C2</code> as an array formula (Ctrl+Shift+Enter), then pull it down. The first one will obviously be an error (not <code>#NA</code> but <code>#VALUE</code>).</p>\n\n<p><strong>How it works:</strong></p>\n\n<pre><code>IF($B$2:$B2=B2-1,ROW($B$2:$B2),\"\")\n</code></pre>\n\n<p>This creates an array with the row numbers for values with one level lower than the actual value. To examine only the values <strong>above</strong> the current row, you need to use expanding ranges, hence the <code>$B$2:$B2</code> style references.</p>\n\n<p>The <code>MAX</code> function gets the maximum of these rows, which is the closest to our current cell. Now we have the row number. All we need now is a formula to extract the data from column <code>A</code> from the indicated row. This is what <code>INDEX</code> does.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6253093, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1GbDUW7-0js/AAAAAAAAAAI/AAAAAAAAAA0/X74KdA1sy0g/photo.jpg?sz=128", "display_name": "Maciej Maliszewski", "link": "https://stackoverflow.com/users/6253093/maciej-maliszewski"}, "is_accepted": false, "score": 0, "last_activity_date": 1461621971, "last_edit_date": 1592644375, "creation_date": 1461614277, "answer_id": 36849927, "question_id": 34753817, "link": "https://stackoverflow.com/questions/34753817/how-to-find-parent-in-an-indented-hierarchy/36849927#36849927", "title": "How to find parent in an indented hierarchy?", "body": "<p>It took me a while to understand how this formula works, so after figuring it out (ok, my wife helped me a bit) I'd like to share an idiot-proof explanations for other Excel-dummies like me. Here we go:</p>\n<pre><code>=INDEX($A$1:$A$7,MAX(IF($B$2:$B2=B2-1,ROW($B$2:$B2),&quot;&quot;)))\n</code></pre>\n<p>means:</p>\n<ol>\n<li><p>Among values in range <code>$B$2:$B2</code> find all values that equal to\n<code>B2-1</code>.</p>\n</li>\n<li><p>If you find them, list the row numbers with value equal to\n<code>B2-1</code>. (ROW)</p>\n</li>\n<li><p>From the list of the row numbers, pick the highest\nrow number (lets call it number <code>X</code>). (MAX)</p>\n</li>\n<li><p>Return the value which is in the line number <code>X</code> in the range <code>$A$1:$A$7</code></p>\n<p>(Warning! Your range has to start in the row no. 1, so that the row number is the same as the line number in your range. Otherwise - you have to adapt the formula.)</p>\n</li>\n</ol>\n"}], "owner": {"reputation": 23, "user_id": 5780788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc43965306892561a5e6a410693f25e?s=128&d=identicon&r=PG&f=1", "display_name": "t0ucansam", "link": "https://stackoverflow.com/users/5780788/t0ucansam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4386, "favorite_count": 2, "accepted_answer_id": 34754699, "answer_count": 2, "score": 2, "last_activity_date": 1461621971, "creation_date": 1452632856, "last_edit_date": 1452641543, "question_id": 34753817, "link": "https://stackoverflow.com/questions/34753817/how-to-find-parent-in-an-indented-hierarchy", "title": "How to find parent in an indented hierarchy?", "body": "<p>I currently have a sheet in excel with an indented hierarchy of items as shown below. <br>Each item is indented (four spaces per indent) to show how it fits into the overall hierarchy. <br>I have been able to create a \"Level\" column that translates the indentation level into a number.</p>\n\n<pre><code>    +------------+-------+--------+\n    |    Item    | Level | Parent |\n    +------------+-------+--------+\n    | P1         |     1 | N/A    |\n    |     P2     |     2 | P1     |\n    |     P3     |     2 | P1     |\n    |         P4 |     3 | P3     |\n    |     P5     |     2 | P1     |\n    |         P6 |     3 | P5     |\n    +------------+-------+--------+\n</code></pre>\n\n<p>What I want to do is generate the \"Parent\" column above, which uses the \"level\" information to display each item's parent.<br>I think that this would need to be done with a loop that would do this for each item X :</p>\n\n<pre><code>    -Find level info for X\n    -Find (levelx-1) which would equal the parent item's level\n    -Search upward for the first row with a level equal to (levelx-1)\n    -Find the item number in that row\n    -Write item number in adjacent cell to X\n</code></pre>\n\n<p>Unfortunately, I'm not sure how to translate this idea into VBA.<br>Thanks in advance for any assistance.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1452632662, "creation_date": 1452632662, "answer_id": 34753770, "question_id": 34753467, "link": "https://stackoverflow.com/questions/34753467/isinarray-excel-vba-out-of-range/34753770#34753770", "title": "IsInArray Excel VBA ...out of range", "body": "<p>Use a <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251825.aspx\" rel=\"nofollow\">Scripting.Dictionary</a>. A dictionary object consists of pairs of data; a unique <a href=\"https://msdn.microsoft.com/en-us/library/1ex01tte.aspx\" rel=\"nofollow\">key</a> and an associated <a href=\"https://msdn.microsoft.com/en-us/library/84k9x471.aspx\" rel=\"nofollow\">item</a>.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251562.aspx\" rel=\"nofollow\">Exists.Method</a> can test to see if a product already exists in the dictionary's unique keys.</p>\n\n<pre><code>Sub productKey()\n\n    ' productKey Macro\n    Dim a As Long, dPRODs As Object, arr As Variant\n\n    Set dPRODs = CreateObject(\"Scripting.Dictionary\")\n\n    With Worksheets(\"Sheet1\")\n        'all of columns A &amp; B into an array\n        arr = .Range(.Cells(1, 1), .Cells(Rows.Count, 2).End(xlUp)).Value2\n    End With\n\n    'populate the dictionary\n    For a = LBound(arr, 1) To UBound(arr, 1)\n        If Not dPRODs.exists(arr(a, 1)) Then _\n            dPRODs.Add Key:=arr(a, 1), Item:=arr(a, 2)\n    Next a\n\n    'get then out of the dictionary\n    For Each arr In dPRODs.Keys\n        Debug.Print arr &amp; \" - \" &amp; dPRODs.Item(arr)\n    Next arr\n\n    'transfer then to an array\n    arr = dPRODs.Keys\n    For a = LBound(arr) To UBound(arr)\n        Debug.Print arr(a)\n    Next a\n\n    arr = dPRODs.Items\n    For a = LBound(arr) To UBound(arr)\n        Debug.Print arr(a)\n    Next a\n\nEnd Sub\n</code></pre>\n\n<p>Testing for Exists means that you will end up with the Item from the first occurrence of the Key. The code can be adjusted to accept the text from the last occurrence of the Key.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1452634148, "creation_date": 1452634148, "answer_id": 34754113, "question_id": 34753467, "link": "https://stackoverflow.com/questions/34753467/isinarray-excel-vba-out-of-range/34754113#34754113", "title": "IsInArray Excel VBA ...out of range", "body": "<p>Your original code was attempting to use the string array immediately upon declaration without assigning it any substance.</p>\n\n<pre><code>Sub productKey2()\n    ' productKey Macro\n    Dim celltxt As String, i As Long, productIndex As Variant\n\n    'declaration and instantiation of array\n    Dim ListofProducts() As String\n    ReDim ListofProducts(i)  '&lt;~~ give it something to work with\n\n    For i = 1 To 6\n        celltxt = ActiveSheet.Range(\"A\" &amp; i)\n\n        'grabs cell from column A\n        If IsInArray(celltxt, ListofProducts) Then\n             GoTo NextIteration\n        Else\n            ReDim Preserve ListofProducts(i)\n\n            'expands the array while preserving existing elements\n            ListofProducts(i) = celltxt\n            'assigns elements that aren't in the array to the array\n        End If\n\n        productIndex = Application.Match(celltxt, ListofProducts, False)\n\n        'gives the location of the cell in the array\n        ActiveSheet.Range(\"B\" &amp; i) = productIndex\n        'then assigns it to column B\n\nNextIteration:\n\n    Next i\n\nEnd Sub\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n  IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2780563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb8b17886d2ef103b89c404269184b4f?s=128&d=identicon&r=PG&f=1", "display_name": "user2780563", "link": "https://stackoverflow.com/users/2780563/user2780563"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1452634148, "creation_date": 1452631638, "last_edit_date": 1452633438, "question_id": 34753467, "link": "https://stackoverflow.com/questions/34753467/isinarray-excel-vba-out-of-range", "title": "IsInArray Excel VBA ...out of range", "body": "<p>I'm trying to create an array by looping through a column in excel.  If an item is already in the array, then I want the code to skip to the next element of the column.  </p>\n\n<p>So for instance, when item1 is reached in the array for the second time, it would be skipped since it's already there</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/68akv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/68akv.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the code I have so far:</p>\n\n<pre><code>Sub productKey()\n    '\n    ' productKey Macro\n    Dim celltxt As String\n\n    'each column element\n\n    Dim ListofProducts() As String\n\n    'declaration of array\n\n    For i = 1 To 6\n\n    celltxt = ActiveSheet.Range(\"A\" &amp; i)\n\n    'grabs cell from column A\n\n    If IsInArray(celltxt, ListofProducts) Then\n\n         GoTo NextIteration\n\n    Else\n\n    ReDim Preserve ListofProducts(i)\n\n    'expands the array while preserving existing elements\n\n    ListofProducts(i) = celltxt\n\n    'assigns elements that aren't in the array to the array\n\n    End If\n\n    productIndex = Application.Match(celltxt, ListofProducts, False)\n\n    'gives the location of the cell in the array\n\n    ActiveSheet.Range(\"B\" &amp; i) = productIndex\n\n    'then assigns it to column B\n\n    NextIteration:\n\n    Next i\n\nEnd Sub\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n  IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\n</code></pre>\n\n<p>I get the following: subscript out of range and then with debugging error is localized to the <code>isinarray</code> function.</p>\n"}, {"tags": ["vba", "excel", "loops"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "edited": false, "score": 0, "creation_date": 1452633538, "post_id": 34753428, "comment_id": 57254048, "body": "Can i i still use the For each Cell with this said code?"}, {"owner": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "reply_to_user": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "edited": false, "score": 0, "creation_date": 1452633763, "post_id": 34753428, "comment_id": 57254166, "body": "@AsimAhmed No. Since you are not using the For Each loop. You would need to use indices from the nested for loops to get a specific range."}], "tags": [], "owner": {"reputation": 9353, "user_id": 1887101, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6840488291a0b81df1e6fd0f91f7929?s=128&d=identicon&r=PG&f=1", "display_name": "Adjit", "link": "https://stackoverflow.com/users/1887101/adjit"}, "is_accepted": false, "score": 0, "last_activity_date": 1452631485, "creation_date": 1452631485, "answer_id": 34753428, "question_id": 34753383, "link": "https://stackoverflow.com/questions/34753383/nesting-if-statement-into-double-loop/34753428#34753428", "title": "Nesting If statement into double loop", "body": "<p>I think this might be what you are looking for. You need to explicitly increment the for loops. But your question is a little bit unclear</p>\n\n<pre><code>Sub AlternateRowColors()\n    Dim I As Integer\n    Dim P As Integer\n    Dim lastRow As Long\n\n    For I = 1 To 2\n        For P = 1 To 1\n            lastRow = Range(P).End(xlDown).Row\n            For Each Column In Range(I, lastRow)\n        Next P\n    Next I\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 405, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452636477, "creation_date": 1452631297, "last_edit_date": 1531164843, "question_id": 34753383, "link": "https://stackoverflow.com/questions/34753383/nesting-if-statement-into-double-loop", "title": "Nesting If statement into double loop", "body": "<p>I am having trouble with double looping a function which alternates the formatting of my rows. </p>\n\n<p>I know I can do this with a conditional formatting to a range script but, as I am learning to use VBA more and more I figured it'd be good to attempt to use a double loop.</p>\n\n<p>I'm failing to get further.</p>\n\n<pre><code>Sub AlternateRowColor2()\nDim lastRow As Long\n\nlastRow = Range(\"A1\").End(xlDown).Row\n\nFor Each Cell In Range(\"A1:A\" &amp; lastRow) \n    If Cell.Row Mod 2 = 1 Then \n        Cell.Interior.ColorIndex = 43 \n    remove\n    End If\nNext Cell\n\nEnd Sub\n</code></pre>\n\n<p>I can get to defining the loops but get lost in the <code>for</code> function to use next </p>\n\n<pre><code>Sub AlternateRowColors()\nDim I As Integer\nDim P As Integer\nDim lastRow As Long\n\nFor I = 1 To 2\nFor P = 1 To 1\nlastRow = Range(P).End(xlDown).Row\nFor Each Column In Range(I, lastRow)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 35, "user_id": 5775599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/332d60e123ba909b71cf8b1295562022?s=128&d=identicon&r=PG&f=1", "display_name": "AdministrativeAssistantMike", "link": "https://stackoverflow.com/users/5775599/administrativeassistantmike"}, "edited": false, "score": 0, "creation_date": 1452631270, "post_id": 34753298, "comment_id": 57252839, "body": "I&#39;m sorry I forgot to say that I&#39;ve tried to put in a Range such as Range(&quot;R&quot;i,&quot;T&quot;i) inside the 2nd If statement so I could utilize the integer &quot;i&quot; in it making it the current row, but then it wont take it. What am I doing wrong? Or is there an easier way to do what I&#39;m trying to accomplish?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5775599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/332d60e123ba909b71cf8b1295562022?s=128&d=identicon&r=PG&f=1", "display_name": "AdministrativeAssistantMike", "link": "https://stackoverflow.com/users/5775599/administrativeassistantmike"}, "edited": false, "score": 0, "creation_date": 1452704921, "post_id": 34753389, "comment_id": 57290620, "body": "Thanks a lot. I&#39;m using the first line of code you provide. I just don&#39;t understand where&#39;s the code to paste it? It works perfectly though."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 35, "user_id": 5775599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/332d60e123ba909b71cf8b1295562022?s=128&d=identicon&r=PG&f=1", "display_name": "AdministrativeAssistantMike", "link": "https://stackoverflow.com/users/5775599/administrativeassistantmike"}, "edited": false, "score": 0, "creation_date": 1452705598, "post_id": 34753389, "comment_id": 57291087, "body": "@AdministrativeAssistantMike With the <code>.Copy</code> function, the destination is an optional criteria.  So the paste part is everything after the <code>.Copy</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1452631329, "creation_date": 1452631329, "answer_id": 34753389, "question_id": 34753298, "link": "https://stackoverflow.com/questions/34753298/how-do-i-put-a-variable-in-a-range/34753389#34753389", "title": "How do I put a variable in a range?", "body": "<p>Instead of the four lines use this one instead:</p>\n\n<pre><code>Worksheets(\"Sheet2\").Range(Worksheets(\"Sheet2\").Cells(ii, 18),Worksheets(\"Sheet2\").Cells(ii, 21)).copy Worksheets(\"Sheet1\").Range(Worksheets(\"Sheet1\").Cells(i, 18),Worksheets(\"Sheet1\").Cells(i, 21))\n</code></pre>\n\n<p>or you could put them in a <code>With</code> block:</p>\n\n<pre><code>With Worksheets(\"Sheet2\")\n    .Range(.Cells(ii,18),.cells(ii,21)).copy Worksheets(\"Sheet1\").Range(Worksheets(\"Sheet1\").Cells(i, 18),Worksheets(\"Sheet1\").Cells(i, 21))\nEnd With\n</code></pre>\n\n<p>Or to make it even shorter; Declare the worksheets as variables:</p>\n\n<pre><code>Dim ows as worksheet\nDim tws as worksheet\n\nSet ows = Worksheets(\"Sheet2\")\nSet tws = Worksheets(\"Sheet1\")\n\nWith ows\n    .Range(.Cells(ii,18),.cells(ii,21)).copy tws.Range(tws.Cells(i, 18),tws.Cells(i, 21))\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5775599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/332d60e123ba909b71cf8b1295562022?s=128&d=identicon&r=PG&f=1", "display_name": "AdministrativeAssistantMike", "link": "https://stackoverflow.com/users/5775599/administrativeassistantmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 34753389, "answer_count": 1, "score": 0, "last_activity_date": 1452631329, "creation_date": 1452630979, "last_edit_date": 1531164843, "question_id": 34753298, "link": "https://stackoverflow.com/questions/34753298/how-do-i-put-a-variable-in-a-range", "title": "How do I put a variable in a range?", "body": "<p>How do I copy and paste certain cells from Sheet2 to Sheet1 and have them keep the same properties such as colored text and background color? What I'm trying to do is find the same Serial Number in column F from both worksheets (Worksheet1 being the new one without any comments and Worksheet2 being the old one with comments), then making sure it's the right item by matching it's Assembly Number in column E (because there's many duplicate serial numbers with different assembly numbers), and lastly, copy the comments in columns R,S,T from Worksheet2 to Worksheet1. This seems to work but it only copies the text, not the certain words that are colored and the background color. This is what I have currently. Any help will be appreciated.</p>\n\n<pre><code>Dim i As Integer\nDim ii As Integer\n\ni = 2\nii = 2\n\nFor i = 2 To a\n    For ii = 2 To a            \n\n        If Worksheets(\"Sheet1\").Cells(i, 6) = Worksheets(\"Sheet2\").Cells(ii, 6) Then\n            If Worksheets(\"Sheet1\").Cells(i, 5) = Worksheets(\"Sheet2\").Cells(ii, 5) Then\n                Worksheets(\"Sheet1\").Cells(i, 18) = Worksheets(\"Sheet2\").Cells(ii, 18)\n                Worksheets(\"Sheet1\").Cells(i, 19) = Worksheets(\"Sheet2\").Cells(ii, 19)\n                Worksheets(\"Sheet1\").Cells(i, 20) = Worksheets(\"Sheet2\").Cells(ii, 20)\n                Worksheets(\"Sheet1\").Cells(i, 21) = Worksheets(\"Sheet2\").Cells(ii, 21)\n            End If\n        End If\n    Next ii\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 53495, "user_id": 5090771, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2EOZG.png?s=128&g=1", "display_name": "WhiteHat", "link": "https://stackoverflow.com/users/5090771/whitehat"}, "edited": false, "score": 0, "creation_date": 1452630767, "post_id": 34753140, "comment_id": 57252556, "body": "could it be access privileges? can the users write to <code>C:&#47;Users&#47;</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452631828, "post_id": 34753140, "comment_id": 57253156, "body": "If you comment out the <code>Export</code> line do the other lines work?"}, {"owner": {"reputation": 31, "user_id": 5166154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31e70006d6eed96f881e822bfff0152?s=128&d=identicon&r=PG&f=1", "display_name": "GrouchySmurf", "link": "https://stackoverflow.com/users/5166154/grouchysmurf"}, "edited": false, "score": 0, "creation_date": 1452633421, "post_id": 34753140, "comment_id": 57253973, "body": "WhiteHate - It actually defaults to their desktop, and they have write access. I&#39;ve also built custom access to a specific folder on their computer and it still fails."}, {"owner": {"reputation": 31, "user_id": 5166154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31e70006d6eed96f881e822bfff0152?s=128&d=identicon&r=PG&f=1", "display_name": "GrouchySmurf", "link": "https://stackoverflow.com/users/5166154/grouchysmurf"}, "edited": false, "score": 0, "creation_date": 1452633466, "post_id": 34753140, "comment_id": 57254002, "body": "Tim - If I comment out the export line the import line fails. The user form code works though, which is completely confusing. I would have thought the userform move would fail too, but it doesn&#39;t."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452635502, "post_id": 34753140, "comment_id": 57255000, "body": "&quot;I have enabled Visual Basic Object Project Mode&quot; - this terminology is odd do you mean you checked the &quot;Trust Access to the VBA Project Object model&quot; checkbox in the Excel Options?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1452635602, "post_id": 34753140, "comment_id": 57255063, "body": "What is the exact value returned by (eg) <code>Module4.GetBook3</code> and does that differ on the &quot;problem&quot; PC&#39;s ?  Something to do with Explorer folder options &gt;&gt; &quot;hide extensions for known file types&quot;.  I recall something along those lines."}, {"owner": {"reputation": 31, "user_id": 5166154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31e70006d6eed96f881e822bfff0152?s=128&d=identicon&r=PG&f=1", "display_name": "GrouchySmurf", "link": "https://stackoverflow.com/users/5166154/grouchysmurf"}, "edited": false, "score": 0, "creation_date": 1452692887, "post_id": 34753140, "comment_id": 57281487, "body": "Tim - #1 You are correct. Sorry for the confusion. I was giving a training for the package this code is a part of and hurriedly typed a response. #2 It&#39;s a variable that has the source workbook name. I&#39;ve validated that is has a valid value."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5166154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31e70006d6eed96f881e822bfff0152?s=128&d=identicon&r=PG&f=1", "display_name": "GrouchySmurf", "link": "https://stackoverflow.com/users/5166154/grouchysmurf"}, "is_accepted": true, "score": 2, "last_activity_date": 1452715747, "creation_date": 1452715747, "answer_id": 34776082, "question_id": 34753140, "link": "https://stackoverflow.com/questions/34753140/run-time-error-50012-method-export-of-object-vbcomponent-failed-error/34776082#34776082", "title": "run-time error 50012 - Method &quot;Export&quot; of object &#39;VBComponent&#39; failed error", "body": "<p>It turns out that the two users in question have different ID's for their login than the location where their desktop lives. I'm unsure why IT did this, but it turns out this was a location issue within the TEMPFILE path. I don't know why I didn't catch that it let me use the default path on the UserForm transfer, as if I had of looked deeper I would have seen that was the solution.</p>\n"}], "owner": {"reputation": 31, "user_id": 5166154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31e70006d6eed96f881e822bfff0152?s=128&d=identicon&r=PG&f=1", "display_name": "GrouchySmurf", "link": "https://stackoverflow.com/users/5166154/grouchysmurf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1290, "favorite_count": 0, "accepted_answer_id": 34776082, "answer_count": 1, "score": 1, "last_activity_date": 1452715747, "creation_date": 1452630362, "question_id": 34753140, "link": "https://stackoverflow.com/questions/34753140/run-time-error-50012-method-export-of-object-vbcomponent-failed-error", "title": "run-time error 50012 - Method &quot;Export&quot; of object &#39;VBComponent&#39; failed error", "body": "<p>I have a piece of code to transfer a module and a user form from one workbook to another that works on multiple systems. However, I have 2 users that it fails with the error </p>\n\n<p>\"Run-Time error '50012' - Method 'Export' of object 'VBComponent' failed\"</p>\n\n<p>The code is as follows:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Public Sub TransferModule2()\r\nConst MODULE_NAME    As String = \"Module5\"         ' Name of the module to transfer\r\nConst UserForm As String = \"UserForm1\"\r\nDim ID As String\r\nID = Environ(\"USERNAME\")\r\n\r\nDim TEMPFILE As String\r\nTEMPFILE = \"C:/Users/\" &amp; ID &amp; \"/Desktop/Modul.bas\" ' temp textfile\r\nTEMPFILE2 = \"UserForm.frm\"\r\n   \r\n   ' On Error Resume Next\r\n   '**Create new workbook\r\n   \r\n   '** export the module to a textfile\r\n   Workbooks(Module4.GetBook3).VBProject.VBComponents(MODULE_NAME).Export fileName:=TEMPFILE\r\n  \r\n   'import the module to the new workbook\r\n   Workbooks(TemplateBook).VBProject.VBComponents.Import fileName:=TEMPFILE\r\n   \r\n   Workbooks(Module4.GetBook3).VBProject.VBComponents(UserForm).Export fileName:=TEMPFILE2\r\n    Workbooks(TemplateBook).VBProject.VBComponents.Import fileName:=TEMPFILE2\r\n  \r\n   'kill the textfile\r\n   Kill TEMPFILE\r\n   Kill TEMPFILE2\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The error occurs on the first export code. I have enabled Visual Basic Object Project Mode on these computers and it still fails, but has no issues on any other computer. The computers were imaged at the exact same time as mine, and the file is in a single location so there are no code modifications. We are running the exact same version of Office with the exact same updates.</p>\n\n<p>What could be conflicting with this export object statement that isn't a reference library or a versioning issue?</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5780658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d34d17cc42ff9da8c17416696f595fb?s=128&d=identicon&r=PG&f=1", "display_name": "SFhelp", "link": "https://stackoverflow.com/users/5780658/sfhelp"}, "edited": false, "score": 0, "creation_date": 1452802907, "post_id": 34770256, "comment_id": 57341086, "body": "Hi Steve. Yes, that would be simpler if the &lt;Name&gt; never changed, but that&#39;s not the case...so each time a change is made to the master deck the end users receiving the updated version would need to go and search to see what &lt;Name&gt; was changed to [e.g. - &lt;Full Name&gt;]. Whereas with the macro, the person updating &lt;Name&gt; to &lt;Full Name&gt; on each slide of the master could just quickly edit one line in the Marco and then redistribute the updated master deck."}, {"owner": {"reputation": 1, "user_id": 5780658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d34d17cc42ff9da8c17416696f595fb?s=128&d=identicon&r=PG&f=1", "display_name": "SFhelp", "link": "https://stackoverflow.com/users/5780658/sfhelp"}, "edited": false, "score": 0, "creation_date": 1452802936, "post_id": 34770256, "comment_id": 57341109, "body": "Also, the macro would allow another option to &quot;skin the cat&quot; -- for those end users who are not very savvy with Powerpoint (yes, the still exist, lol) it would prevent them from having to look for the find/replace all functionality in the menu."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 1, "user_id": 5780658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d34d17cc42ff9da8c17416696f595fb?s=128&d=identicon&r=PG&f=1", "display_name": "SFhelp", "link": "https://stackoverflow.com/users/5780658/sfhelp"}, "edited": false, "score": 0, "creation_date": 1452873673, "post_id": 34770256, "comment_id": 57372143, "body": "There&#39;s example code on my PPT FAQ site that&#39;ll get you started doing something to every shape/text box in a presentation:  <a href=\"http://www.pptfaq.com/FAQ00594_Do_something_to_--_every_shape_on_a_slide-_every_slide_in_a_presentation-_every_presentation_in_a_folder.htm\" rel=\"nofollow noreferrer\">pptfaq.com/&hellip;</a>  In most cases, you&#39;d use the Replace function to do the replacement.  However, once you replace &lt;Insert Name Here&gt; with some other text once, the search string will no longer exist, so it&#39;ll no longer work.  There are ways around this that would involve tagging the original shape, but it gets tricky."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 1, "user_id": 5780658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d34d17cc42ff9da8c17416696f595fb?s=128&d=identicon&r=PG&f=1", "display_name": "SFhelp", "link": "https://stackoverflow.com/users/5780658/sfhelp"}, "edited": false, "score": 0, "creation_date": 1452873719, "post_id": 34770256, "comment_id": 57372174, "body": "&quot; for those end users who are not very savvy with Powerpoint it would prevent them from having to look for the find/replace all functionality in the menu.&quot;  But they&#39;d still have to find YOUR macro.  ;-)"}, {"owner": {"reputation": 1, "user_id": 5780658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d34d17cc42ff9da8c17416696f595fb?s=128&d=identicon&r=PG&f=1", "display_name": "SFhelp", "link": "https://stackoverflow.com/users/5780658/sfhelp"}, "edited": false, "score": 0, "creation_date": 1453163453, "post_id": 34770256, "comment_id": 57472406, "body": "Thanks again Steve. So perhaps this is a naive question but...isn&#39;t there a way to have the marco to auto-play when the user 1st opens powerpoint, or no?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 1, "user_id": 5780658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d34d17cc42ff9da8c17416696f595fb?s=128&d=identicon&r=PG&f=1", "display_name": "SFhelp", "link": "https://stackoverflow.com/users/5780658/sfhelp"}, "edited": false, "score": 0, "creation_date": 1453223140, "post_id": 34770256, "comment_id": 57503296, "body": "Assuming macros haven&#39;t been disabled, any code in Sub Auto_Open will run when an add-in loads (ie, when PPT opens).  PPT won&#39;t run code automatically when opening a presentation/template though."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1452698094, "creation_date": 1452698094, "answer_id": 34770256, "question_id": 34752974, "link": "https://stackoverflow.com/questions/34752974/macro-code-for-powerpoint-that-prompts-the-user-to-enter-text-then-does-a-fin/34770256#34770256", "title": "Macro code (for PowerPoint) that prompts the user to enter text, then does a find/replace?", "body": "<p>Mightn't it be simpler to use Edit | Find | Replace and let PowerPoint do the heavy lifting for you?  </p>\n"}], "owner": {"reputation": 1, "user_id": 5780658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d34d17cc42ff9da8c17416696f595fb?s=128&d=identicon&r=PG&f=1", "display_name": "SFhelp", "link": "https://stackoverflow.com/users/5780658/sfhelp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452698094, "creation_date": 1452629752, "last_edit_date": 1452629802, "question_id": 34752974, "link": "https://stackoverflow.com/questions/34752974/macro-code-for-powerpoint-that-prompts-the-user-to-enter-text-then-does-a-fin", "title": "Macro code (for PowerPoint) that prompts the user to enter text, then does a find/replace?", "body": "<p>My Vb skills are beyond rusty so thank you very much in advance for the help. Can someone please share the code for a macro that will:</p>\n\n<p>1) Prompt a user who opens an existing PPT to enter a value, let's say name. E.g. - \"Please enter a name\". Then the user clicks ok or enter.</p>\n\n<p>2) Searches through every slide in the deck and where ever (literally) &lt;<em>Insert Name here</em>> is found, it replaces that with the name the user entered. </p>\n\n<p>Hopefully that makes sense. If someone can share that code with me, I would be extremely grateful! Many thanks again!</p>\n\n<p>P.S. - in case it matters, I'm using MS office 2011 (version 14.1.3)</p>\n"}, {"tags": ["vba", "excel", "merge"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5780717, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102683522207084/picture?type=large", "display_name": "David Papajcik", "link": "https://stackoverflow.com/users/5780717/david-papajcik"}, "edited": false, "score": 0, "creation_date": 1452630777, "post_id": 34752994, "comment_id": 57252562, "body": "Thanks for finding that source. I was looking for basically exactly that. I figured none of the events triggered despite a firm belief that merging shouldn&#39;t be considered a formatting thing and should definitely register on the change event. I guess I was just hoping someone had found some sort of crazy workaround to this."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1452629828, "creation_date": 1452629828, "answer_id": 34752994, "question_id": 34752437, "link": "https://stackoverflow.com/questions/34752437/using-excel-vba-events-to-detect-merging-unmerging-of-cells/34752994#34752994", "title": "Using Excel VBA Events to detect merging/unmerging of cells?", "body": "<p>As far as I know, there is no way to detect formatting changes on a cell.  Merging is considered a format change and is therefore undetectable via VBA events.  However, I did some digging, and found this interesting list:</p>\n\n<blockquote>\n  <ul>\n  <li>Changing the formatting of a cell doesn't trigger the Change event (as expected). But copying and pasting formatting does trigger the\n  Change event.  Choosing the Home=>Editing=>Clear=>Clear Formats\n  command also triggers the event.</li>\n  <li>Merging cells doesn't trigger the Change event, even if the contents of some of the merged cells are deleted in the process.</li>\n  <li>Adding, editing or deleting a cell comment doesn't trigger the Change event.</li>\n  <li>Pressing Delete generates an event even if the cell is empty to start with.</li>\n  <li>Cells that are changed by using Excel commands may or may not trigger the Change event. For example, sorting a range or using Goal\n  Seeker to change a cell does not trigger the event. But using the\n  spell checker does.</li>\n  <li>If your VBA procedure changes the contents of a cell, it <em>does</em> trigger the Change event.</li>\n  </ul>\n</blockquote>\n\n<p>From <em>Excel 2013 Power Programming with VBA</em> by John Walkenbach <a href=\"https://books.google.com/books?id=xuMPqFkSoyAC&amp;pg=PT733&amp;lpg=PT733&amp;dq=excel+vba+event+for+merging+cells&amp;source=bl&amp;ots=QHjIa-yVI_&amp;sig=3-DNGtC5z20_p4pLN7xWPBsXqBY&amp;hl=en&amp;sa=X&amp;ved=0ahUKEwjvrpqBiqXKAhWhj3IKHQJADGUQ6AEIRTAF#v=onepage&amp;q=excel%20vba%20event%20for%20merging%20cells&amp;f=false\" rel=\"nofollow\">Source</a></p>\n\n<p>So basically, if someone is just merging or unmerging cells, there is no way to detect that through a VBA event.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5780717, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102683522207084/picture?type=large", "display_name": "David Papajcik", "link": "https://stackoverflow.com/users/5780717/david-papajcik"}, "is_accepted": false, "score": 0, "last_activity_date": 1452701669, "last_edit_date": 1452701669, "creation_date": 1452699936, "answer_id": 34770966, "question_id": 34752437, "link": "https://stackoverflow.com/questions/34752437/using-excel-vba-events-to-detect-merging-unmerging-of-cells/34770966#34770966", "title": "Using Excel VBA Events to detect merging/unmerging of cells?", "body": "<p>I found my own kind of sort of work around to make the things happen that I wanted. Not sure if there is a more efficient/speedier way to do it, but it does at least work without any errors thus far. It triggers after the selection is changed which is slower than what I wanted but VBA is what it is.</p>\n\n<p>For the worksheet:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Call EnforceFormatting(Target)\nEnd Sub\n</code></pre>\n\n<p>In a module:</p>\n\n<pre><code>Public oldR As Range\nPublic newR As Range\n\nSub EnforceFormatting(ByVal Target As Range)\n    Set newR = Target\n    If oldR Is Nothing Then\n        Set oldR = newR\n        Exit Sub\n    End If\n\n    If oldR.Column &lt; 3 Then\n        Set oldR = newR\n        Exit Sub\n    End If\n    If oldR.Row &lt;&gt; 3 And oldR.Row &lt;&gt; 7 And oldR.Row &lt;&gt; 11 Then\n        Set oldR = newR\n        Exit Sub\n    End If\n    If oldR.Rows.Count &gt; 1 Then\n        Set oldR = newR\n        Exit Sub\n    End If\n    If oldR.Count &gt; 1 Then\n        Application.ScreenUpdating = False\n        Dim c As Range\n        For Each c In oldR\n            c.Value = c.Text\n        Next c\n        Application.ScreenUpdating = True\n    End If\n\n    Set oldR = newR\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5780717, "user_type": "registered", "profile_image": "https://graph.facebook.com/10102683522207084/picture?type=large", "display_name": "David Papajcik", "link": "https://stackoverflow.com/users/5780717/david-papajcik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 34752994, "answer_count": 2, "score": 1, "last_activity_date": 1452701669, "creation_date": 1452627716, "question_id": 34752437, "link": "https://stackoverflow.com/questions/34752437/using-excel-vba-events-to-detect-merging-unmerging-of-cells", "title": "Using Excel VBA Events to detect merging/unmerging of cells?", "body": "<p>I am trying to find a way to detect the immediate use of merging (or unmerging) cells. The change event triggers nor does the selectionchange. I've tried some of the other, but it seems no events trigger upon the merge - which I find odd. My code in the change event currently changes Interior.Color based off the contents of the cell. If the cell is merged and then unmerged, the color stays across the selection. But I would like it to keep the color only in the cell with the text and go back to xlNone on the rest. Anyway to pull this off?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column &lt; 3 Then Exit Sub\nIf Target.Row &lt;&gt; 3 Then Exit Sub\nSelect Case Target.Text\n    Case \"Blackberry Serrano\", \"BS\"\n        Target.Interior.Color = RGB(120, 33, 111)\n    [...more of the same...]\n    Case \"\"\n        Target.Interior.Color = xlNone\nEnd Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "libreoffice", "libreoffice-calc", "libreoffice-basic"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1452627249, "post_id": 34751858, "comment_id": 57250519, "body": "I would humbly suggest you make an attempt at converting the code yourself and return to edit your question with your original effort if you run into problems."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1452627591, "post_id": 34751858, "comment_id": 57250736, "body": "This is not a code porting service, where you dump code and the new language desired and someone does the work for you. Make an effort to port it yourself. If you run into problems, you can then post a question asking about the problem you&#39;ve encountered, include your code, and ask a <b>specific</b> question about that problem. Good luck."}, {"owner": {"reputation": 54, "user_id": 3777302, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df0f7931e3f4457b1cf1c6ecd824b46e?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Friedman", "link": "https://stackoverflow.com/users/3777302/jon-friedman"}, "edited": false, "score": 0, "creation_date": 1452633475, "post_id": 34751858, "comment_id": 57254008, "body": "I would ordinarily never ask someone to convert code for me, but since this is a one-off task utilizing a skill set (LO Basic) I&#39;m not really interested in learning in-depth, and a whopping 10 lines of code, I thought I could pose it to the community. If I go down the rabbit hole of learning the same exact skill set I have in VBA for this one-off task i&#39;m wasting time. If someone already has this skill set and can convert 10 lines of code I wrote or accomplish the same for a best answer, then both of us will benefit. Otherwise my next q will be &quot;How do I turn the selection into a variable&quot;Yawn"}, {"owner": {"reputation": 54, "user_id": 3777302, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df0f7931e3f4457b1cf1c6ecd824b46e?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Friedman", "link": "https://stackoverflow.com/users/3777302/jon-friedman"}, "edited": false, "score": 0, "creation_date": 1452795687, "post_id": 34751858, "comment_id": 57336944, "body": "@steve-zhan I saw that you answered a similar question about looping in <a href=\"http://stackoverflow.com/questions/14724193\">stackoverflow.com/questions/14724193</a>"}], "answers": [{"comments": [{"owner": {"reputation": 54, "user_id": 3777302, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df0f7931e3f4457b1cf1c6ecd824b46e?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Friedman", "link": "https://stackoverflow.com/users/3777302/jon-friedman"}, "edited": false, "score": 0, "creation_date": 1452633636, "post_id": 34753215, "comment_id": 57254107, "body": "Thank you very much for the link. I&#39;m browsing the document and I&#39;m going to try to piece something together from these snippets."}], "tags": [], "owner": {"reputation": 10032, "user_id": 5100564, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZZ7Z5.png?s=128&g=1", "display_name": "Jim K", "link": "https://stackoverflow.com/users/5100564/jim-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1452630635, "creation_date": 1452630635, "answer_id": 34753215, "question_id": 34751858, "link": "https://stackoverflow.com/questions/34751858/convert-vba-simple-macro-to-libreoffice-macro/34753215#34753215", "title": "Convert VBA Simple Macro to LibreOffice Macro", "body": "<p>Have a look at <a href=\"http://www.pitonyak.org/AndrewMacro.odt\" rel=\"nofollow\">Andrew Pitonyak's macro document</a>.  Section 6 is the area that deals with Calc macros.</p>\n\n<ul>\n<li>Get the selected rows with code similar to section 6.9 <code>Fill selected range with text</code>.</li>\n<li>Also use code similar to section 6.14 <code>Display all data in a column</code>.</li>\n</ul>\n"}], "owner": {"reputation": 54, "user_id": 3777302, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/df0f7931e3f4457b1cf1c6ecd824b46e?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Friedman", "link": "https://stackoverflow.com/users/3777302/jon-friedman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2634, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1452789621, "creation_date": 1452625665, "last_edit_date": 1452789621, "question_id": 34751858, "link": "https://stackoverflow.com/questions/34751858/convert-vba-simple-macro-to-libreoffice-macro", "title": "Convert VBA Simple Macro to LibreOffice Macro", "body": "<p>I have the following macro, which takes a sparse set of data and copies the only entry from each row into the left-most column. <a href=\"https://i.stack.imgur.com/vwtzo.jpg\" rel=\"nofollow noreferrer\">Example of data</a></p>\n\n<p>I am hoping someone could rewrite this macro into one that will work with the same data in LibreOffice.</p>\n\n<pre><code>Sub Macro1()\n\n    Dim rng As Range\n\n    Set rng = Selection\n\n\n    For Each row In rng.Rows\n        For Each cell In row.Cells\n            If cell &lt;&gt; \"\" Then\n                Debug.Print cell\n                row.Cells(1) = cell\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Example of data</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/vwtzo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vwtzo.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "for-loop", "foreach"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452624804, "post_id": 34751515, "comment_id": 57249046, "body": "What&#39;s your code look like?  You can use <code>F8</code> to step through your macro, to see what order it is (can you use something like <code>checkBox.Select</code>?). I think by default it&#39;ll be in the order added to the workbook."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1452625156, "post_id": 34751515, "comment_id": 57249275, "body": "You can look at the tab index in design mode"}, {"owner": {"reputation": 45, "user_id": 5780567, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46938bb9130e08c1484695816dede406?s=128&d=identicon&r=PG&f=1", "display_name": "M. Daly", "link": "https://stackoverflow.com/users/5780567/m-daly"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1452625823, "post_id": 34751515, "comment_id": 57249672, "body": "I can see what order it&#39;s going in I just don&#39;t know what property is driving that. @BruceWayne, any idea on how I can change the order if it is in the order they were added?"}], "answers": [{"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1452636703, "post_id": 34752097, "comment_id": 57255624, "body": "Wow! How did you know that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1452638378, "post_id": 34752097, "comment_id": 57256436, "body": "Any form controls I use are typically laid out directly on the worksheet. I remember this oddity (reversed direction) when I was trying to set up a cascade of checkboxes where each depended on the state of the previous. There were a lot of checkboxes and I had to figure out how to do it in a loop. I actually spent a fair bit of time working on an &#39;end one&#39; wondering &#39;why doesn&#39;t this work&#39; until I tried a middle one and figured out that they were reversing the instructions. The ZOrder direction they take probably makes sense to someone but not me."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1452627545, "last_edit_date": 1452627545, "creation_date": 1452626543, "answer_id": 34752097, "question_id": 34751515, "link": "https://stackoverflow.com/questions/34751515/what-order-does-a-for-each-next-loop-through-my-checkboxes/34752097#34752097", "title": "What order does a For Each Next loop through my checkboxes", "body": "<p>For ActiveX checkbox controls laid out on the worksheet, the <em>&lt;right-click&gt;</em>, Order command sets the order they are retrieved in a For ... Each loop. The caveat is that the commands seem to be backwards.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/qcrs3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qcrs3.png\" alt=\"checkbox_order\"></a></p>\n\n<ol>\n<li><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff861432.aspx\" rel=\"nofollow noreferrer\">Bring to Front</a></strong> will place the shape object at the tail end of the For Each queue.</li>\n<li><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff861432.aspx\" rel=\"nofollow noreferrer\">Send to Back</a></strong> will bring the shape object to the front of the For Each queue.</li>\n<li><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff861432.aspx\" rel=\"nofollow noreferrer\">Bring Forward</a></strong> will shuffle the shape object back one place in the queue.</li>\n<li><strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff861432.aspx\" rel=\"nofollow noreferrer\">Send Backward</a></strong> will push the shape object forward one place in the queue.</li>\n</ol>\n\n<p>The VBA for this is in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840191.aspx\" rel=\"nofollow noreferrer\">Shape.ZOrder method</a>.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    .Shapes(\"CheckBox2\").ZOrder msoBringForward  '&lt;~~ send back one place in the queue\n    .Shapes(\"CheckBox2\").ZOrder msoSendToBack  '&lt;~~ place at the beginning of the queue\nEnd With\n</code></pre>\n\n<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837628.aspx\" rel=\"nofollow noreferrer\">Shape.ZOrderPosition property</a> to determine the current position.</p>\n"}], "owner": {"reputation": 45, "user_id": 5780567, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/46938bb9130e08c1484695816dede406?s=128&d=identicon&r=PG&f=1", "display_name": "M. Daly", "link": "https://stackoverflow.com/users/5780567/m-daly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 34752097, "answer_count": 1, "score": 1, "last_activity_date": 1452627545, "creation_date": 1452624415, "last_edit_date": 1452626793, "question_id": 34751515, "link": "https://stackoverflow.com/questions/34751515/what-order-does-a-for-each-next-loop-through-my-checkboxes", "title": "What order does a For Each Next loop through my checkboxes", "body": "<p>I have about 20 Check Boxes laid out in a rectangle. How do I know what order my code loops through them with a For Each loop? </p>\n\n<p>I've already confirmed it is not in the order of CheckBox1, CheckBox2, CheckBox3 etc. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1452626106, "post_id": 34751449, "comment_id": 57249826, "body": "Just Delete Column A; then copy Column B to column A and sort the entire table descending by Column A (or B)."}, {"owner": {"reputation": 43, "user_id": 5224668, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d1793706ca0a2325efd39f0d4ea6618f?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/5224668/kinfe"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1452626265, "post_id": 34751449, "comment_id": 57249897, "body": "@RonRosenfeld ColA data  is coming from another Excel file that is why i copy Col A value from another Excel to sort the records. my goal is to update the description field from another excel file"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1452626401, "post_id": 34751449, "comment_id": 57249976, "body": "Unless there is information you have not provided, the source of Col A data should not make any difference.  Your relevant data is in Columns B:E and Col A is superfluous.  Please read the HELP pages for information as to <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask a Good Question</a>; and also <a href=\"http://stackoverflow.com/help/mcve\">How to Provide an Example</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1452628500, "post_id": 34751449, "comment_id": 57251293, "body": "Try <code>=VLOOKUP(A2, A:B, 2, FALSE)</code> in a <i>&#39;Column between A and C&#39;</i>."}], "answers": [{"tags": [], "owner": {"reputation": 409, "user_id": 5604652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73bf206d862d877d6c866e97cbaf0184?s=128&d=identicon&r=PG&f=1", "display_name": "B540Glenn", "link": "https://stackoverflow.com/users/5604652/b540glenn"}, "is_accepted": false, "score": 1, "last_activity_date": 1452630199, "creation_date": 1452630199, "answer_id": 34753093, "question_id": 34751449, "link": "https://stackoverflow.com/questions/34751449/how-can-i-find-duplicate-and-align-a-martching-value-in-excel/34753093#34753093", "title": "How can i find duplicate and align a martching value in excel", "body": "<p>Try using the OFFSET() function.</p>\n\n<p>In the file where you want to update the descriptions enter the following array formula to the cells you want to hold the description fields.  This will take the offset of rows and columns from your source to match to your ItemID.</p>\n\n<pre><code>{=OFFSET(Sheet1!A1:D1,(MATCH(Sheet2!A2,Sheet1!A1:A5,0)-1), 0, 1, 4)}\nHighlight 4 contiguous cells in the row then     \nPress Ctrl+Shift+Enter to create the array formula\n</code></pre>\n\n<p>Of course you will have to correct for the workbook and worksheet names, along with the cell locations. </p>\n\n<p>Sheet1 A1:D5 is the location of your Item Description data.</p>\n\n<p>Sheet2 A2 is the ItemID that needs more data.</p>\n\n<p>Sheet1 A1:A5 is the list of ItemIDs that have descriptions</p>\n\n<p>(MATCH(Sheet2!A2,Sheet1!A1:A5,0)-1) will get the row of the description data relative to zero (important for the offset).</p>\n\n<p>0, tells the offset function to stay on that row.</p>\n\n<p>1, tells the offset function to select 1 row.</p>\n\n<p>4 tells the Offset function to select 4 columns.</p>\n"}], "owner": {"reputation": 43, "user_id": 5224668, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d1793706ca0a2325efd39f0d4ea6618f?s=128&d=identicon&r=PG&f=1", "display_name": "Kinfe", "link": "https://stackoverflow.com/users/5224668/kinfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452631520, "creation_date": 1452624202, "last_edit_date": 1452631520, "question_id": 34751449, "link": "https://stackoverflow.com/questions/34751449/how-can-i-find-duplicate-and-align-a-martching-value-in-excel", "title": "How can i find duplicate and align a martching value in excel", "body": "<p>I am trying to search a duplicate value in excel and sort the whole row by the matching records in B</p>\n\n<p>I added Column between A and C, and added this code\n<code>=VLOOKUP(A:A,B:B,1)</code> but that find the duplicate it doesn't rearrange other records from column B forward </p>\n\n<p>I want to find the duplicate and align the whole row </p>\n\n<p>//here is the records looks like right now </p>\n\n<pre><code> Col A    Col B     Col C       Col D          Col E\n Item ID  Item ID   Item Desc   Purchase D     Sales Des\n 600255   600111     xxxx        yyyy          zzzz\n 600224   600255     mmmm        nnnn          yyyy\n 600111   600224     aaaa        bbbb          cccc\n</code></pre>\n\n<p>Note: ColA data is copied from another Excel File. The Idea is to Update The description field</p>\n\n<p>I want to see</p>\n\n<pre><code> Col A    Col B     Col C       Col D         Col E\n Item ID  Item ID   Item Desc   Purchase D    Sales Des\n 600255    600255   mmmm        nnnn          yyyy\n 600224    600224   aaaa        bbbb          ccc\n 600111    600111   xxxx        yyyy          zzzz\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452623838, "post_id": 34751150, "comment_id": 57248484, "body": "Is there any criteria for the split?"}], "answers": [{"tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1452626749, "creation_date": 1452626749, "answer_id": 34752156, "question_id": 34751150, "link": "https://stackoverflow.com/questions/34751150/how-to-split-array-into-two-array-in-vba/34752156#34752156", "title": "How to split array into two array in VBA", "body": "<p>Try this code:</p>\n\n<pre><code>Sub Test()\n  Dim strInput As String\n  Dim IC As Long\n  IC = 5 ' Items Count in first array ar1\n  Dim ar2()\n  Dim ar3()\n  strInput = \"10,20,30,40,50,60,70\"\n  ar1 = Split(strInput, \",\")\n\n  ReDim ar2(IC - 1)\n  ReDim ar3(UBound(ar1) - IC)\n\n  For i = 0 To IC - 1\n   ar2(i) = ar1(i)\n  Next\n\n  For i = 0 To UBound(ar1) - IC\n   ar3(i) = ar1(i + IC - 1)\n  Next\n\n'Test:\n  Debug.Print \"ar2:\"\n  For i = LBound(ar2) To UBound(ar2)\n   Debug.Print ar2(i)\n  Next\n\n  Debug.Print \"======\" &amp; Chr(13) &amp; \"ar3:\"\n\n  For i = LBound(ar3) To UBound(ar3)\n   Debug.Print ar3(i)\n  Next\n\n\nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5775130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dOEwxjGXzXM/AAAAAAAAAAI/AAAAAAAAAAA/H2WoehgwbJg/photo.jpg?sz=128", "display_name": "Mike Wu", "link": "https://stackoverflow.com/users/5775130/mike-wu"}, "is_accepted": false, "score": 0, "last_activity_date": 1452632639, "creation_date": 1452632639, "answer_id": 34753764, "question_id": 34751150, "link": "https://stackoverflow.com/questions/34751150/how-to-split-array-into-two-array-in-vba/34753764#34753764", "title": "How to split array into two array in VBA", "body": "<p>If you want to do it by a division point (like say 55 in this case), you can do so like the following (I'm assuming everything below is an integer. You can do the same with floats or doubles, but strings will be a little more difficult if you don't convert them to integers first). To convert a string that really is an integer to an integer, just do <code>CInt(\"10\")</code>.</p>\n\n<p>The way I set this up, you have to pass in 2 empty arrays A1 and A2, and this will fill them out:</p>\n\n<pre><code>Sub Split(A() As Integer, A1() As Integer, _\n    A2() As Integer, Mid As Integer)\n\n    ' Grab the length of array A.\n    Dim Alen As Integer\n    Alen = UBound(A)\n\n    Dim I As Integer\n    Dim SplitIdx As Integer\n    SplitIdx = Alen\n    ' Loop through A to find out where to split it.\n    For I = 1 To Alen\n        If A(I) &gt; Mid Then\n            SplitIdx = I - 1\n            Exit For\n        End If\n    Next I\n\n    ' Make sure we aren't doing anything ridiculous.\n    If SplitIdx = 0 Or SplitIdx = Alen Then\n        Exit Sub\n    End If\n\n    ' Now we can basically do the same thing that Fadi did.\n    ReDim A1(SplitIdx)\n    ReDim A2(Alen - SplitIdx)\n\n    ' Now we can just fill it out!\n    For I = 1 To Alen\n        If I &lt;= SplitIdx Then\n            A1(I) = A(I)\n        Else\n            A2(I - SplitIdx) = A(I)\n        End If\n    Next I\nEnd Sub\n</code></pre>\n\n<p>So for example, to use this, you can do something like the following:</p>\n\n<pre><code>' Recreate the array as an integer\nDim ar1int() As Integer\nFor I = 1 To 7\n  ar1int = I * 10\nNext I\n\nDim ar2() As Integer\nDim ar3() As Integer\nCall Split(ar1int, ar2, ar3, 55)\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4111026, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ac1746556d1e7613126a502af60e2122?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/4111026/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5865, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1452633411, "creation_date": 1452623105, "question_id": 34751150, "link": "https://stackoverflow.com/questions/34751150/how-to-split-array-into-two-array-in-vba", "title": "How to split array into two array in VBA", "body": "<pre><code>Sub test()\nDim strInput as String\nDim ar2()\nDim ar3()\nstrInput = \"10,20,30,40,50,60,70\"\nar1 = Split(strInput, \",\")\nEnd Sub\n</code></pre>\n\n<p>How i can Split ar1 array (10,20,30,40,50,60,70) into two array , ar2 = (10,20,30,40,50) and ar3 = (60,70).</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "is_accepted": false, "score": 0, "last_activity_date": 1452623637, "last_edit_date": 1452623637, "creation_date": 1452623319, "answer_id": 34751210, "question_id": 34751007, "link": "https://stackoverflow.com/questions/34751007/merge-one-column-based-on-matches-of-another-in-excel/34751210#34751210", "title": "Merge one column based on matches of another in excel", "body": "<p>Maybe use VBA and loop through all the cells in column b when there is a match until there is no match then concatenate the values with a slash in between.</p>\n\n<p>Ex.</p>\n\n<pre><code>   Dim tempHolder as String\n   For Each cell In yourWorkbook.Sheets(1).Range(\"B1:B6\")\n       If tempHolder == cell.Value Then\n              'write your value and a \"/\" to the adjacent cell if there is a match to previous\n       Else if tempHolder == \"\"\n              'write singular values to adjacent cell\n       End If\n       tempHolder = cell.Value\n   Next cell\n</code></pre>\n\n<p>This is just a sample.  If you use it you'll have to tweak it a bit for your application and write the code that inserts your concatenated values in the adjacent cells.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 1771351, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/f18dbd4e13a499581d0b93bfd3208804?s=128&d=identicon&r=PG", "display_name": "user1771351", "link": "https://stackoverflow.com/users/1771351/user1771351"}, "edited": false, "score": 0, "creation_date": 1452625008, "post_id": 34751415, "comment_id": 57249176, "body": "Thanks so much for your help, the thing is I ideally would want to do this without sorting since I know this is a step that someone who doesn&#39;t understand excel would overlook. Ideally i&#39;d have the grouped and / list in sheet 2 so that the person can just copy and paste sheet into new excel file save and import it into our system, and use this as a template file."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 103, "user_id": 1771351, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/f18dbd4e13a499581d0b93bfd3208804?s=128&d=identicon&r=PG", "display_name": "user1771351", "link": "https://stackoverflow.com/users/1771351/user1771351"}, "edited": false, "score": 0, "creation_date": 1452626621, "post_id": 34751415, "comment_id": 57250124, "body": "@user1771351 - is sorting really that difficult to do as 1 step in the process? I.E. - 1) Copy Data In 2) sort 3) fill down formulas. If you instruct them clearly, they can do it :)"}, {"owner": {"reputation": 595, "user_id": 5543175, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/77c8155e884ca29020ca1b8817c45431?s=128&d=identicon&r=PG&f=1", "display_name": "VinnyGuitara", "link": "https://stackoverflow.com/users/5543175/vinnyguitara"}, "edited": false, "score": 0, "creation_date": 1452627743, "post_id": 34751415, "comment_id": 57250825, "body": "Do it in VBA if you have users you are worried about following instructions.  My answer above shows how.  @Scott Holtzmans answer is excellent but you can further automate it on workbook load to sort and provide the concatenated values automatically.  If the data gets inserted after the sheet is opened you can put a trigger in your code that will fire when someone pastes values to the sheet. Or just add a button to the sheet to process once the user has satisfactorily copied all data to it.   VBA is excellent to automate tasks within Office products so it may work very will for your situation."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1452624086, "creation_date": 1452624086, "answer_id": 34751415, "question_id": 34751007, "link": "https://stackoverflow.com/questions/34751007/merge-one-column-based-on-matches-of-another-in-excel/34751415#34751415", "title": "Merge one column based on matches of another in excel", "body": "<p>With some ingenuity, you can use built-in Excel formulas to accomplish this. </p>\n\n<p>Here is the worksheet with each step broken out:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EJv69.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EJv69.png\" alt=\"enter image description here\"></a></p>\n\n<ol>\n<li>Make sure you data is sorted by <code>ProductID</code></li>\n<li>Create Full List formula: <code>=IF(B1=B2,E1&amp;\"/\"&amp;D2,D2)</code></li>\n<li>Count Instances formula: <code>=COUNTIF($B$2:$B$11,B2)</code></li>\n<li>Find First Instance formula: <code>=MATCH(B2,$B$2:$B$11,0)</code></li>\n<li>Full List with Slash formula: <code>=OFFSET($B$1,G2+F2-1,3)</code></li>\n</ol>\n\n<p>Drag all these formulas down from row 2 to the end of your dataset.</p>\n\n<p>I broke the steps out so you can understand more easily. However, you can write this all in two columns as well. The Create Full List Column and another column with the following formula (which joins the last four columns in my example together): <code>=OFFSET($B$1,MATCH(B2,$B$2:$B$11,0)+COUNTIF($B$2:$B$11,B2)-1,3)</code></p>\n"}], "owner": {"reputation": 103, "user_id": 1771351, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/f18dbd4e13a499581d0b93bfd3208804?s=128&d=identicon&r=PG", "display_name": "user1771351", "link": "https://stackoverflow.com/users/1771351/user1771351"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1452624086, "creation_date": 1452622601, "last_edit_date": 1531161705, "question_id": 34751007, "link": "https://stackoverflow.com/questions/34751007/merge-one-column-based-on-matches-of-another-in-excel", "title": "Merge one column based on matches of another in excel", "body": "<p>In column E I am trying to merge column D into one the next cell E with a \"/\" in between each new cells value if column B contains a match. If there is no match then just take the value from column D. If you look at end goal it will explain a bit better. I tried if(Match( but that doesn't seem to work.  Thanks all!</p>\n\n<pre><code>Explanation ProductID   Qty Location Notes  (END GOAL)\nRMA-1234    SKU1         1      A1A1         A1A1\nRMA-7444    SKU2         1      A1A2         A1A2\nRMA-9837    KSC U        1      A1A6         A1A6/A1A7/A1A8\nRMA-5837    KSC U        1      A1A7         A1A6/A1A7/A1A8\nRMA-6342    KSC U        1      A1A8         A1A6/A1A7/A1A8\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 1, "creation_date": 1452622356, "post_id": 34750917, "comment_id": 57247626, "body": "This may help: <a href=\"http://stackoverflow.com/questions/579797/open-excel-file-for-reading-with-vba-without-display\" title=\"open excel file for reading with vba without display\">stackoverflow.com/questions/579797/&hellip;</a>"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 1, "creation_date": 1452622718, "post_id": 34750917, "comment_id": 57247842, "body": "Application.ScreenUpdating = False did the trick. Geez im dumb"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1452622806, "post_id": 34750917, "comment_id": 57247897, "body": "though it doesn&#39;t make it faster, which Im curious as to whether or not there are more efficient ways to go about it."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1452623100, "post_id": 34750917, "comment_id": 57248076, "body": "Per <a href=\"https://msdn.microsoft.com/en-us/library/2s1c774y(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/2s1c774y(v=vs.90).aspx</a> using the <code>My.Computer.FileSystem Object</code> should provide better performance."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1452623279, "post_id": 34750917, "comment_id": 57248189, "body": "Ooo more reading yay. I will investigate this further. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 1, "last_activity_date": 1452622749, "creation_date": 1452622749, "answer_id": 34751052, "question_id": 34750917, "link": "https://stackoverflow.com/questions/34750917/creating-new-workbooks-and-copy-paste-faster-possible-solution/34751052#34751052", "title": "Creating New Workbooks and copy/paste. Faster possible solution?", "body": "<p>Application.ScreenUpdating = False</p>\n"}], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1452624518, "creation_date": 1452622223, "last_edit_date": 1452624518, "question_id": 34750917, "link": "https://stackoverflow.com/questions/34750917/creating-new-workbooks-and-copy-paste-faster-possible-solution", "title": "Creating New Workbooks and copy/paste. Faster possible solution?", "body": "<p>Currently the code below works fine, but however the original \"filelocation1\" opens temporarily and its noticeable to the end user for a split second. Is there a way to do the same thing but it run faster and/or possibly never have the original workbook open in the first place?</p>\n\n<p>vba :</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim wbI As Workbook, wbO As Workbook\nDim wsI As Worksheet, wsO As Worksheet\n\nDim filelocation1 As String\nDim filelocation2 As String\n\nfilelocation1 = Environ(\"USERPROFILE\") &amp; \"\\Desktop\" &amp; \"\\\" &amp; Format(Date, \"ddmmyyyy\") &amp; \".xls\"\nfilelocation2 = \"\\\\file\\nextfile\\fileafterthat\\etc\" &amp; \"\\\" &amp; Format(Date, \"ddmmyyyy\") &amp; Application.UserName &amp; \".xls\"\n\nSet wbI = ThisWorkbook\nSet wsI = wbI.Sheets(\"Production\")\nSet wbO = Workbooks.Add \n\nApplication.DisplayAlerts = False\n\nWith wbO\n    Set wsO = wbO.Sheets(\"Sheet1\")\n    ActiveWorkbook.SaveAs Filename:=filelocation1, FileFormat:=56\n    wsI.Range(\"A1:C100\").Copy\n    wsO.Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    ActiveWorkbook.Save\n    ActiveWorkbook.Close\nEnd With\n\nFileCopy Source:=filelocation1, Destination:=filelocation2\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452623484, "post_id": 34750701, "comment_id": 57248298, "body": "To get multiple matches and not have duplicates, do you need the result in a single cell? If so this will require VBA.  If you are ok with the results being in multiple cells, this can be done with formulas."}, {"owner": {"reputation": 57, "user_id": 5780314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bce5a0e4b05d69a20b4c9c3d5c6453?s=128&d=identicon&r=PG&f=1", "display_name": "dod", "link": "https://stackoverflow.com/users/5780314/dod"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1452623729, "post_id": 34750701, "comment_id": 57248426, "body": "The result has to be in one cell."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1452653122, "last_edit_date": 1452653122, "creation_date": 1452623976, "answer_id": 34751380, "question_id": 34750701, "link": "https://stackoverflow.com/questions/34750701/get-the-value-between-the-parentheses-multiple-matches-in-one-string/34751380#34751380", "title": "Get the value between the parentheses, multiple matches in one string", "body": "<p>It seems unwieldy to have one User Defined Function for individual entries and another for a collective result of all entries.</p>\n\n<p>Paste the following into a standard module code sheet.</p>\n\n<pre><code>Function getBracketedText(str As String, _\n                 Optional pos As Integer = 0, _\n                 Optional delim As String = \", \", _\n                 Optional dupes As Boolean = False)\n    Dim tmp As String, txt As String, a As Long, b As Long, p As Long, arr() As Variant\n\n    tmp = str\n    ReDim arr(1 To 1)\n\n    For b = 1 To (Len(tmp) - Len(Replace(tmp, Chr(40), vbNullString)))\n        p = InStr(p + 1, tmp, Chr(40))\n        txt = Trim(Mid(tmp, p + 1, InStr(p + 1, tmp, Chr(41)) - (p + 1)))\n        If UBound(Filter(arr, txt, True)) &lt; 0 Or dupes Then   '&lt;~~ check for duplicates within the array\n            a = a + 1\n            ReDim Preserve arr(1 To a)\n            arr(UBound(arr)) = txt\n        End If\n    Next b\n\n    If CBool(pos) Then\n        getBracketedText = arr(pos)\n    Else\n        getBracketedText = Join(arr, delim)\n    End If\nEnd Function\n</code></pre>\n\n<p>Use like any other native worksheet function. There are optional parameters to retrieve an individual element or a collection as well as changing the default <em>&lt;comma&gt;&lt;space&gt;</em> delimiter.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/UXwQz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UXwQz.png\" alt=\"bracket_text_no_duplicates\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 5780314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bce5a0e4b05d69a20b4c9c3d5c6453?s=128&d=identicon&r=PG&f=1", "display_name": "dod", "link": "https://stackoverflow.com/users/5780314/dod"}, "edited": false, "score": 0, "creation_date": 1452627567, "post_id": 34751484, "comment_id": 57250711, "body": "ElbertV, please excuse my ignorance but i can&#39;t run the Sub you created. I  created a module with the Sub, when i type in the cell &quot;=takingTheText(K7)&quot; it returns an error: &quot;The name you entered is not valid&quot;."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 57, "user_id": 5780314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bce5a0e4b05d69a20b4c9c3d5c6453?s=128&d=identicon&r=PG&f=1", "display_name": "dod", "link": "https://stackoverflow.com/users/5780314/dod"}, "edited": false, "score": 0, "creation_date": 1452627981, "post_id": 34751484, "comment_id": 57250960, "body": "You need to run the code inside a Module, this is not a function, thats why you get an error. Inside the code you can change the the cell with the text, or if is a range of cell, you can take them and create a loop (do, for) to go across the cell."}, {"owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "reply_to_user": {"reputation": 57, "user_id": 5780314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bce5a0e4b05d69a20b4c9c3d5c6453?s=128&d=identicon&r=PG&f=1", "display_name": "dod", "link": "https://stackoverflow.com/users/5780314/dod"}, "edited": false, "score": 0, "creation_date": 1452628013, "post_id": 34751484, "comment_id": 57250981, "body": "May be, i can change the code to do a function for you... but i would need some time..."}, {"owner": {"reputation": 57, "user_id": 5780314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bce5a0e4b05d69a20b4c9c3d5c6453?s=128&d=identicon&r=PG&f=1", "display_name": "dod", "link": "https://stackoverflow.com/users/5780314/dod"}, "edited": false, "score": 0, "creation_date": 1452629193, "post_id": 34751484, "comment_id": 57251677, "body": "Thank you ElbertV, i appreciate it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1452658973, "post_id": 34751484, "comment_id": 57262210, "body": "Good procedure. I might have made it responsive to the current selection. See <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/28700020?s=2|1.1545#28700020\">my take on the subject</a>."}], "tags": [], "owner": {"reputation": 1515, "user_id": 3212973, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/CDTNO.jpg?s=128&g=1", "display_name": "Elbert Villarreal", "link": "https://stackoverflow.com/users/3212973/elbert-villarreal"}, "is_accepted": false, "score": 1, "last_activity_date": 1452624798, "last_edit_date": 1452624798, "creation_date": 1452624323, "answer_id": 34751484, "question_id": 34750701, "link": "https://stackoverflow.com/questions/34750701/get-the-value-between-the-parentheses-multiple-matches-in-one-string/34751484#34751484", "title": "Get the value between the parentheses, multiple matches in one string", "body": "<p>This code works for me:</p>\n\n<pre><code>Sub takingTheText()\nDim iniP 'first parenthesis\nDim endP 'last parentehis\nDim myText 'the text\nDim txtLen\nDim i\nDim tmp\nDim j\nmyText = Range(\"A1\").Value\n\ntxtLen = Len(myText)\nj = 0\nDo 'Loop in the text\n    i = i + 1 'a counter\n    iniP = InStr(1, myText, \"(\", 1) 'found the first occurence of the (\n    endP = InStr(1, myText, \")\", 1) 'same as above\n\n    tmp = tmp &amp; Right(Left(myText, i), 1) 'take the text garbage text\n\n    If i = iniP Then 'here comes the work\n        j = j + 1 'here take the cell index\n        myText = Replace(myText, tmp, \"\") 'remove the garbage text in front the first (\n        tmp = Left(myText, endP - iniP - 1) 'reuse the var to store the usefull text\n        Cells(1, 2).Value = Cells(1, 2).Value &amp; Chr(10) &amp; tmp 'store in the cell B1\n        'If you want to stored in separated cells use the below code\n        'Cells(j, 2).Value = tmp\n        myText = Replace(myText, tmp &amp; \")\", \"\", 1, 1) ' remove the garbage text from the main text\n        tmp = Empty 'empty the var\n        i = 0 'reset the main counter\n    End If\nLoop While endP &lt;&gt; 0\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Result: </p>\n\n<p><a href=\"https://i.stack.imgur.com/wJeTq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wJeTq.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Please check and tellme if is ok. </p>\n\n<p>Edit#1 </p>\n\n<p><code>Cells(1, 2).Value = Cells(1, 2).Value &amp; Chr(10) &amp; tmp</code> this code store the text in separated lines inside the same cell, may be you want to use spaces between the resulting text because of <code>chr(10)</code> (also you can use <code>chr(13)</code>), then you can use <code>Cells(1, 2).Value = Cells(1, 2).Value &amp; \" \" &amp; tmp</code>, or use any other character instead the string inside the <code>&amp;</code> symbols</p>\n"}], "owner": {"reputation": 57, "user_id": 5780314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8bce5a0e4b05d69a20b4c9c3d5c6453?s=128&d=identicon&r=PG&f=1", "display_name": "dod", "link": "https://stackoverflow.com/users/5780314/dod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1694, "favorite_count": 0, "accepted_answer_id": 34751380, "answer_count": 2, "score": 1, "last_activity_date": 1606171065, "creation_date": 1452621551, "last_edit_date": 1495535280, "question_id": 34750701, "link": "https://stackoverflow.com/questions/34750701/get-the-value-between-the-parentheses-multiple-matches-in-one-string", "title": "Get the value between the parentheses, multiple matches in one string", "body": "<p>My spreadsheet has a column with value like this string:</p>\n\n<pre><code>some text (text1) some test (text2) (text1)\n</code></pre>\n\n<p>How do I get all values between parentheses? The result I am looking for is:</p>\n\n<pre><code>text1, text2\n</code></pre>\n\n<p>Even if <code>text1, text2... testn</code> is present in the cell multiple times, I need it in the result only once.</p>\n\n<p>I found a function <code>GetParen</code> here: <a href=\"https://stackoverflow.com/questions/8058032/get-the-value-between-the-brackets\">Get the value between the brackets</a></p>\n\n<p>It is helpful, but it gives the fist available value in the parentheses and ignores the rest.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452621006, "post_id": 34750085, "comment_id": 57246811, "body": "I cant open the link, so not sure of the method, can it be done via linking the webpage in data --&gt; from web, then you can refresh the query."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 0, "creation_date": 1452623141, "post_id": 34750711, "comment_id": 57248101, "body": "It worked :) But it didnt help. Seems like the function on itself is what takes time running.. But thanks for taking the time."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "edited": false, "score": 1, "creation_date": 1452623732, "post_id": 34750711, "comment_id": 57248430, "body": "@OyvPet, You are welcome, and yes you are right, I notice that but I think it is normal to be slow because the UDF use internet connection."}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 2, "last_activity_date": 1452621568, "creation_date": 1452621568, "answer_id": 34750711, "question_id": 34750085, "link": "https://stackoverflow.com/questions/34750085/excel-vba-application-calculatefull-only-on-defined-range/34750711#34750711", "title": "Excel vba Application.CalculateFull only on defined range", "body": "<p>Try this:</p>\n\n<pre><code>Sub Test()\n 'Application.CalculateFull\n With ActiveWorkbook.Sheets(\"Sh1\").Range(\"A2:D6\") ' change this line as you need\n  .Formula = .Formula\n End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2568665, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf8d5b6186899e3540e3e6f0bea92e47?s=128&d=identicon&r=PG", "display_name": "OyvPet", "link": "https://stackoverflow.com/users/2568665/oyvpet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 1, "accepted_answer_id": 34750711, "answer_count": 1, "score": 2, "last_activity_date": 1452621568, "creation_date": 1452619626, "question_id": 34750085, "link": "https://stackoverflow.com/questions/34750085/excel-vba-application-calculatefull-only-on-defined-range", "title": "Excel vba Application.CalculateFull only on defined range", "body": "<p>Im using code in this link to get exchangerates from yahoo:\n<a href=\"https://desmondoshiwambo.wordpress.com/2014/06/27/how-to-get-the-current-exchange-rateconvert-currency-in-access-excel-and-vba-using-yahoo-finance/\" rel=\"nofollow\">https://desmondoshiwambo.wordpress.com/2014/06/27/how-to-get-the-current-exchange-rateconvert-currency-in-access-excel-and-vba-using-yahoo-finance/</a></p>\n\n<p>And this works great. My only challenge now is to update exchangerates without using Application.CalculateFull. Since i only need the range (A2:D6) to refresh.</p>\n\n<p>I have tried with .calculate but that does not refresh the data. Only entering into the formula and push enter, and also calculatefull works.</p>\n\n<p>Any Ideas?</p>\n"}, {"tags": ["vba", "validation"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452619011, "post_id": 34749514, "comment_id": 57245434, "body": "Would the validation not disallow the entry?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1452619046, "post_id": 34749514, "comment_id": 57245454, "body": "Would help to expand your question with some concrete examples of what you want to check for."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1452620978, "post_id": 34749514, "comment_id": 57246799, "body": "@Nathan_Sav - I believe you bypass the validation process by programatically setting values to a cell."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 2, "last_activity_date": 1452621322, "creation_date": 1452621322, "answer_id": 34750621, "question_id": 34749514, "link": "https://stackoverflow.com/questions/34749514/check-if-there-is-invalid-data-in-a-sheet/34750621#34750621", "title": "Check if there is invalid data in a sheet?", "body": "<p>Something like.  F9 has validation of any number between 1 and 10</p>\n\n<pre><code>Option Explicit\n\nSub t()\n\nRange(\"f9\").Value = 100\n\nDim r As Excel.Range\n\nSet r = ActiveSheet.UsedRange\nSet r = r.SpecialCells(xlCellTypeAllValidation)\n\nDim c As Excel.Range\n\nFor Each c In r.Cells\n\n    If Not c.Validation.Value Then\n        Debug.Print c.Address &amp; \" is not validated\"\n    End If\n\nNext c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27294, "user_id": 535967, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/02c46fb58177c19c7a1b57f670bddbd1?s=128&d=identicon&r=PG", "display_name": "lisovaccaro", "link": "https://stackoverflow.com/users/535967/lisovaccaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 34750621, "answer_count": 1, "score": 0, "last_activity_date": 1452621322, "creation_date": 1452617832, "question_id": 34749514, "link": "https://stackoverflow.com/questions/34749514/check-if-there-is-invalid-data-in-a-sheet", "title": "Check if there is invalid data in a sheet?", "body": "<p>How can I know with VBA if there if there are validations errors in a sheet? I've been looking into the range.validation object but I didn't find any methods or properties to do this.</p>\n"}]