[{"tags": ["excel", "vba", "foreach", "do-while"], "comments": [{"owner": {"reputation": 1, "user_id": 12578656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225dea58b4afef893998778b2b901ffd?s=128&d=identicon&r=PG&f=1", "display_name": "sundar", "link": "https://stackoverflow.com/users/12578656/sundar"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577299511, "post_id": 59480927, "comment_id": 105138737, "body": "ListEmployeeName.Clear Worksheets(&quot;SunEmployeeDetails&quot;).Select Range(&quot;A1&quot;).Select Do While ActiveCell.Value &lt;&gt; &quot;&quot;     ListEmployeeName.AddItem (cell.Value)     ActiveCell.Offset(1, 0).Select Loop     ListEmployeeName.Value = Worksheets(&quot;SunEmployeeDetails&quot;).Range(&quot;A1&quot;) End Sub   This do while approach is also not working"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577300026, "post_id": 59480927, "comment_id": 105138843, "body": "Avoid the use of <code>.Select&#47;Activecell</code> etc... you may want to see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. I have posted an answer. you may have to refresh the page to see it"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577306262, "post_id": 59480927, "comment_id": 105139855, "body": "<a href=\"https://stackoverflow.com/q/59390356/9758194\">This</a> could be a cool alternative in your case to get some uniques"}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577306398, "post_id": 59481088, "comment_id": 105139874, "body": "Pretty sure you can get a 1D array assigned to a listbox in one go right? Using .List property..... Btw, not used to see untested codes from your end =)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1577336354, "post_id": 59481088, "comment_id": 105143737, "body": "@JvdV: Oh yes. I have shown that <a href=\"https://stackoverflow.com/questions/59316810/vba-close-unwrap-retract-a-combobox-list\">Here</a> as well but did not mention here becuase it would be an overkill after trying to get a unique collection."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577348074, "post_id": 59481088, "comment_id": 105146424, "body": "Nice linked post. Didn&#39;t know about a bug. I&#39;ll have a bash with that combined with what I linked to earlier"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1577299963, "creation_date": 1577299963, "answer_id": 59481088, "question_id": 59480927, "link": "https://stackoverflow.com/questions/59480927/in-vba-code-how-to-add-values-to-a-listbox-using-for-each-cell-approach-with-def/59481088#59481088", "title": "In VBA code,how to add values to a listbox using for each cell approach with defining a range End(XlDown)?", "body": "<p>Find <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba/11169920#11169920\">Last Row</a> and then define your range <code>Range(\"A1:A\" &amp; LastRow)</code></p>\n\n<p>You can also find the last row and loop through the range using a <code>For</code> loop. Also to get unique Employee Name, you can use <code>On Error Resume Next</code> with a <code>Collection</code> as shown below. I have commented the code below so you should not have a problem understanding it. But if you do then simply ask.</p>\n\n<p>Is this what you are trying? (<strong>Untested</strong>).</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim ws As Worksheet\n    Dim lRow As Long, i As Long\n    Dim col As New Collection\n    Dim itm As Variant\n\n    Set ws = Worksheets(\"SunEmployeeDetails\")\n\n    With ws\n        '~~&gt; Find Last row\n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        '~~&gt; Loop through the range and add it to the unique\n        '~~&gt; collection using \"On Error Resume Next\"\n        For i = 1 To lRow\n            On Error Resume Next\n            col.Add .Range(\"A\" &amp; i).Value, CStr(.Range(\"A\" &amp; i).Value)\n            On Error GoTo 0\n        Next i\n    End With\n\n    ListEmployeeName.Clear\n\n    '~~&gt; add the itme from collection to the listbox\n    For Each itm In col\n        ListEmployeeName.AddItem itm\n    Next itm\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1577351002, "creation_date": 1577351002, "answer_id": 59486101, "question_id": 59480927, "link": "https://stackoverflow.com/questions/59480927/in-vba-code-how-to-add-values-to-a-listbox-using-for-each-cell-approach-with-def/59486101#59486101", "title": "In VBA code,how to add values to a listbox using for each cell approach with defining a range End(XlDown)?", "body": "<p>Here is my take on it, techniques taken from <a href=\"https://stackoverflow.com/q/59390356/9758194\">here</a>:</p>\n\n<hr>\n\n<p><strong><em><sub>Methode 1: Using a dictionary</sub></em></strong></p>\n\n<pre><code>Dim lr As Long, x As Long\nDim arr As Variant\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n\nWith Sheet1 'Change accordingly\n\n    'Find the last used row\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    arr = .Range(\"A1:A\" &amp; lr).Value\n\nEnd With\n\n'Loop through memory and fill dictionary\nFor x = LBound(arr) To UBound(arr)\n    dict(arr(x, 1)) = 1\nNext x\n\n'Add array to Listbox\nMe.ListEmployeeName.List = dict.Keys\n</code></pre>\n\n<hr>\n\n<p><strong><em><sub>Methode 2: Using Evaluation</sub></em></strong></p>\n\n<pre><code>Dim lr As Long\nDim arr As Variant\n\nWith Sheet1 'Change accordingly\n\n    'Find the last used row\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n    'Get array of unique values\n    arr = Filter(.Evaluate(\"TRANSPOSE(If(Row(A1:A\" &amp; lr &amp; \")&lt;&gt;MATCH(A1:A\" &amp; lr &amp; \",A1:A\" &amp; lr &amp; \",0),\"\"|\"\",A1:A\" &amp; lr &amp; \"))\"), \"|\", False)\n\n    'Add array to Listbox\n    Me.ListEmployeeName.List = arr\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12578656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225dea58b4afef893998778b2b901ffd?s=128&d=identicon&r=PG&f=1", "display_name": "sundar", "link": "https://stackoverflow.com/users/12578656/sundar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1577351002, "creation_date": 1577298418, "question_id": 59480927, "link": "https://stackoverflow.com/questions/59480927/in-vba-code-how-to-add-values-to-a-listbox-using-for-each-cell-approach-with-def", "title": "In VBA code,how to add values to a listbox using for each cell approach with defining a range End(XlDown)?", "body": "<p>I have created a macro file with Forms and Word to Excel.</p>\n\n<p>In this coding fewthings are not working as per my expectation.</p>\n\n<ol>\n<li>Get unique Employee Name from Excel data base. \nI want to add unique employee names from excel database and get is saved in a sheet. After that those values to be added to list box. Here i cannot define a range like \"A1:A10\".. I want to choose the data from A1 to end data.</li>\n</ol>\n\n<p>If for each cell approach will not work, please help in do while approach </p>\n\n<p>I need help in defining the range and code given below</p>\n\n<pre><code>ListEmployeeName.Clear\nFor Each cell In Worksheets(\"SunEmployeeDetails\").Range(\"A1\").End(xlDown)\n    ListEmployeeName.AddItem (cell.Value)\nNext\n    ListEmployeeName.Value = Worksheets(\"SunEmployeeDetails\").Range(\"A1\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "textbox", "keydown", "ctrl"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577293609, "post_id": 59480381, "comment_id": 105137545, "body": "If you are going to do it that way, then include the textbox control as an argument to the function in the module too, then reference that variable instead of the way you are doing it now."}, {"owner": {"reputation": 103, "user_id": 7668074, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cFGvaqUMPfQ/AAAAAAAAAAI/AAAAAAAAB24/22AZuGuFM8E/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/7668074/alex"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577293763, "post_id": 59480381, "comment_id": 105137577, "body": "can you show me how?!"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577294305, "post_id": 59480381, "comment_id": 105137709, "body": "<code>Public Sub CtrlA(txt As TextBox, KeyCode As Integer, Shift As Integer)</code>"}, {"owner": {"reputation": 103, "user_id": 7668074, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cFGvaqUMPfQ/AAAAAAAAAAI/AAAAAAAAB24/22AZuGuFM8E/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/7668074/alex"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577296084, "post_id": 59480381, "comment_id": 105138031, "body": "i tried with your textbox argument but now it tells me &quot;ByRef argument type mismatch&quot; regard Keycode on the <code>Call CtrlA(KeyCode, Shift)</code> line.."}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1577308088, "post_id": 59480840, "comment_id": 105140152, "body": "To make this work with multiple controls, it would be better to pass the form (<code>Me</code>) as parameter, and use <code>F.ActiveControl</code> in the module. Hmm, or use <code>Screen.ActiveControl</code>."}], "tags": [], "owner": {"reputation": 2906, "user_id": 7658533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NT8m2.png?s=128&g=1", "display_name": "Unhandled Exception", "link": "https://stackoverflow.com/users/7658533/unhandled-exception"}, "is_accepted": true, "score": 3, "last_activity_date": 1577352598, "last_edit_date": 1577352598, "creation_date": 1577297538, "answer_id": 59480840, "question_id": 59480381, "link": "https://stackoverflow.com/questions/59480381/how-to-use-ctrla-in-a-ms-access-textbox-in-order-to-select-all-the-text-stand/59480840#59480840", "title": "How to use Ctrl+A in a MS-Access textbox in order to select all the text - standard module option", "body": "<p>Following your code sample this is what you want:</p>\n\n<p>You have to forward the control (here it is named <code>text0</code>) to your procedure.</p>\n\n<p>The argument <code>KeyCode</code> must be defined <code>ByRef</code> to be able to return the value <code>0</code> to the calling procedure.</p>\n\n<blockquote>\n  <p>Call it like this from in a form:</p>\n</blockquote>\n\n<pre><code>Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)\n    Call CtrlA(Text0, KeyCode, Shift)\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>In a module:</p>\n</blockquote>\n\n<pre><code>Public Sub CtrlA(ByVal contextControl As Control, ByRef KeyCode As Integer, ByVal Shift As Integer)\n    If KeyCode = vbKeyA And Shift = acCtrlMask Then 'Catch Ctrl+A\n        KeyCode = 0 'Suppress normal effect\n        On Error GoTo ExitSub 'ActiveControl causes a runtime error if none is active\n        If TypeOf contextControl Is TextBox Then\n            With contextControl\n                .SelStart = 0\n                .SelLength = Len(.Text)\n            End With\n        End If\n    End If\n\nExitSub:\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Following Andres suggestion (thx to him) to pass the form itself, you can do it like this:</p>\n\n<blockquote>\n  <p>Call it like this from in a form:</p>\n</blockquote>\n\n<pre><code>Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)\n    Call CtrlA(Me, KeyCode, Shift)\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>In a module:</p>\n</blockquote>\n\n<pre><code>Public Sub CtrlA(ByVal contextForm As Form, ByRef KeyCode As Integer, ByVal Shift As Integer)\n    If KeyCode = vbKeyA And Shift = acCtrlMask Then 'Catch Ctrl+A\n        KeyCode = 0 'Suppress normal effect\n        On Error GoTo ExitSub 'ActiveControl causes a runtime error if none is active\n        If TypeOf contextForm.ActiveControl Is TextBox Then\n            With contextForm.ActiveControl\n                .SelStart = 0\n                .SelLength = Len(.Text)\n            End With\n        End If\n    End If\n\nExitSub:\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 7668074, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cFGvaqUMPfQ/AAAAAAAAAAI/AAAAAAAAB24/22AZuGuFM8E/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/7668074/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 59480840, "answer_count": 1, "score": 0, "last_activity_date": 1590627774, "creation_date": 1577293391, "last_edit_date": 1590627774, "question_id": 59480381, "link": "https://stackoverflow.com/questions/59480381/how-to-use-ctrla-in-a-ms-access-textbox-in-order-to-select-all-the-text-stand", "title": "How to use Ctrl+A in a MS-Access textbox in order to select all the text - standard module option", "body": "<p>I found a <a href=\"https://stackoverflow.com/questions/47735162/ms-access-multi-control-keypress-ctrla-handler\">solution</a> that will allow me to use <kbd>Ctrl</kbd>+<kbd>A</kbd> combo in an Access textbox in order to select all of the text inside it.</p>\n\n<p>This solution needs:</p>\n\n<ol>\n<li>Set the<code>Form.KeyPreview</code> property to <code>True</code></li>\n<li>Add the following code to the <code>Form.Keydown</code>:</li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)\n    If KeyCode = vbKeyA And Shift = acCtrlMask Then 'Catch Ctrl+A\n        KeyCode = 0 'Suppress normal effect\n        On Error GoTo ExitSub 'ActiveControl causes a runtime error if none is active\n        If TypeOf Me.ActiveControl Is TextBox Then\n            With Me.ActiveControl\n                .SelStart = 0\n                .SelLength = Len(.Text)\n            End With\n        End If\n    End If\nExitSub:\nEnd Sub\n</code></pre>\n\n<p>I tried to put this code in a module like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub CtrlA(KeyCode As Integer, Shift As Integer)\n    If KeyCode = vbKeyA And Shift = acCtrlMask Then 'Catch Ctrl+A\n        KeyCode = 0 'Suppress normal effect\n        On Error GoTo ExitSub 'ActiveControl causes a runtime error if none is active\n        If TypeOf Me.ActiveControl Is TextBox Then\n            With Me.ActiveControl\n                .SelStart = 0\n                .SelLength = Len(.Text)\n            End With\n        End If\n    End If\nExitSub:\nEnd Sub\n</code></pre>\n\n<p>In order to call it wherever I want like this:</p>\n\n<pre><code>Private Sub Form_KeyDown(KeyCode As Integer, Shift As Integer)\n    Call CtrlA(KeyCode, Shift)\nEnd Sub\n</code></pre>\n\n<p>But the <code>Me</code> keyword isn't allowed in a standard module.</p>\n\n<p>How can I achive this goal?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 10450858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f156a55390caa505e5d2565905d830e?s=128&d=identicon&r=PG&f=1", "display_name": "Repairer", "link": "https://stackoverflow.com/users/10450858/repairer"}, "edited": false, "score": 0, "creation_date": 1577277397, "post_id": 59478233, "comment_id": 105133919, "body": "Thanks Vityata for showing the solution with a dictionary...have not yet tried it with my code but perhaps it will surely work, just a question, with ReDim also the filling of the array has to fall after we have Redimmed, I mean first Dim, then a loop to count all errors, then ReDim and then a loop to fill array. The ReDim has to come before filling the array. So ReDim won&#39;t help. Please correct me if wrong. Of course, none of this will be needed with the approach you showed."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 71, "user_id": 10450858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f156a55390caa505e5d2565905d830e?s=128&d=identicon&r=PG&f=1", "display_name": "Repairer", "link": "https://stackoverflow.com/users/10450858/repairer"}, "edited": false, "score": 1, "creation_date": 1577278242, "post_id": 59478233, "comment_id": 105134071, "body": "@Repairer - you are welcome. Considering redim, it should be in a loop (but this is in general non-optimal). <a href=\"https://stackoverflow.com/questions/39827849/redim-preserve-in-for-loop\" title=\"redim preserve in for loop\">stackoverflow.com/questions/39827849/redim-preserve-in-for-l&zwnj;&#8203;oop</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1577279243, "post_id": 59478233, "comment_id": 105134300, "body": "Another suggestion is to go through specialcells and avoid a loop over cells that might not hold an error. Nice answer though"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1577275531, "creation_date": 1577275531, "answer_id": 59478233, "question_id": 59477900, "link": "https://stackoverflow.com/questions/59477900/search-errors-populate-an-array-and-present-a-pivot-like-view/59478233#59478233", "title": "Search errors, populate an array and present a pivot like view", "body": "<p>For the initialization of array, which you do not know the number of items in, <code>Redim</code> is used. <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/redim-statement\" rel=\"nofollow noreferrer\">Redim MS Documentation</a>.</p>\n\n<p>However, reading the problem it seems that the goal is to make some kind of a summary of the numbers of the errors. Let's consider the following errors:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fOYBu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fOYBu.png\" alt=\"enter image description here\"></a></p>\n\n<p>Which comes from the following code:</p>\n\n<pre><code>Sub PopulateErrors()\n\n    Dim myCell As Range\n    With Worksheets(1)\n        For Each myCell In .Range(\"A1:A5\")\n            myCell.Formula = \"=0 / 0\"\n        Next myCell\n\n        For Each myCell In .Range(\"B1:B2\")\n            myCell.Formula = \"=nonexistingformula()\"\n        Next myCell\n\n        For Each myCell In .Range(\"C1:C3\")\n            myCell.Formula = \"=4+\"\"ky\"\"\"\n        Next myCell\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>These could be summarized with a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dictionary-object\" rel=\"nofollow noreferrer\">dictionary object</a> like this:</p>\n\n<pre><code>Sub ErrorDataSummary()\n\n    Dim myCell As Range\n    Dim myDict As Object\n\n    Set myDict = CreateObject(\"Scripting.Dictionary\")\n\n\n    For Each myCell In Worksheets(1).Range(\"A1:C5\")\n        If IsError(myCell) Then\n            If myDict.exists(myCell.Text) Then\n                myDict(myCell.Text) = myDict(myCell.Text) + 1\n            Else\n                myDict(myCell.Text) = 1\n            End If\n        End If\n    Next myCell\n\n    Dim myKey As Variant\n    For Each myKey In myDict.keys\n        Debug.Print myKey; myDict(myKey)\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Running the code, the following summary is obtained:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kCuJ1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kCuJ1.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 71, "user_id": 10450858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f156a55390caa505e5d2565905d830e?s=128&d=identicon&r=PG&f=1", "display_name": "Repairer", "link": "https://stackoverflow.com/users/10450858/repairer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 59478233, "answer_count": 1, "score": 2, "last_activity_date": 1577295221, "creation_date": 1577272836, "last_edit_date": 1577295221, "question_id": 59477900, "link": "https://stackoverflow.com/questions/59477900/search-errors-populate-an-array-and-present-a-pivot-like-view", "title": "Search errors, populate an array and present a pivot like view", "body": "<p>I have code that searches a worksheet for errors and puts the cell address and the error on a separate sheet.</p>\n\n<pre><code>Set RErrors = Nothing\nOn Error Resume Next\nSet RErrors = Sheets(\"Sheet1\").ListObjects(\"Table\").Range.SpecialCells(xlCellTypeFormulas, 16)\nOn Error GoTo 0\nCounter = 0\nIf Not RErrors Is Nothing Then\n    Workbooks(Different_Workbook).Sheets(Different_Sheet).Activate\n    For Each x In RErrors\n        ActiveSheet.Range(\"A1\").Offset(Counter, 0).Formula = x.Address\n        ActiveSheet.Range(\"B1\").Offset(Counter, 0) = x\n        x.ClearContents\n        Counter = Counter + 1\n    Next x\nEnd If\n</code></pre>\n\n<p>The code is working but I am planning to fill all the error cell address and corresponding errors in a 2D array, and present a pivoted view for each type of error and the number of cells.</p>\n\n<p>I am facing two problems--</p>\n\n<ol>\n<li><p>How do I initialize the array when I don't know the number of errors (and without Dim, I can't fill)? Perhaps it would mean to run a loop to first find all errors then get the sum of errors and then Dim and then again a loop to fill the error array, so two loops for one thing?</p></li>\n<li><p>How do I manipulate the error (and position) filled array to get a result which shows how many cells each type of error has (like a pivot)?</p></li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1577269712, "post_id": 59477404, "comment_id": 105132143, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/39581487/loop-through-all-worksheets-in-workbook\">Loop through all worksheets in workbook</a>"}, {"owner": {"reputation": 15, "user_id": 12594964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb861ee59a7a45536409b77eed55aada?s=128&d=identicon&r=PG&f=1", "display_name": "kopsy", "link": "https://stackoverflow.com/users/12594964/kopsy"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577424992, "post_id": 59477404, "comment_id": 105166358, "body": "Thanks for responding. There were no sheet names assigned, so i cant take the help of it. if the sheet names were assigned as a list then it would have been easier to modify it. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12594964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb861ee59a7a45536409b77eed55aada?s=128&d=identicon&r=PG&f=1", "display_name": "kopsy", "link": "https://stackoverflow.com/users/12594964/kopsy"}, "edited": false, "score": 0, "creation_date": 1577427018, "post_id": 59483050, "comment_id": 105166798, "body": "Thanks for responding! Was a bit in celebration mood didn&#39;t have time to test the code immediately. when i initially test to run this code manually it worked flawlessly, but later it gave a me a peculiar problem when it tried to run on its own automatically for every 2minutes. It is pasting multiple times, increasing the number of pastes for every run, soon it pastes innumerous times in rows and thus the excel gets to a freezing point, where i have to close the excel from the task manager. I just added sheet names to the code, please check"}, {"owner": {"reputation": 15, "user_id": 12594964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb861ee59a7a45536409b77eed55aada?s=128&d=identicon&r=PG&f=1", "display_name": "kopsy", "link": "https://stackoverflow.com/users/12594964/kopsy"}, "edited": false, "score": 0, "creation_date": 1577427034, "post_id": 59483050, "comment_id": 105166802, "body": "If WS.Name = &quot;Adata&quot; Or WS.Name = &quot;Bdata&quot; Or WS.Name = &quot;Cdata&quot; Or WS.Name = &quot;Ddata&quot; Or WS.Name = &quot;Edata&quot; Then"}, {"owner": {"reputation": 15, "user_id": 12594964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb861ee59a7a45536409b77eed55aada?s=128&d=identicon&r=PG&f=1", "display_name": "kopsy", "link": "https://stackoverflow.com/users/12594964/kopsy"}, "edited": false, "score": 0, "creation_date": 1577427996, "post_id": 59483050, "comment_id": 105167054, "body": ", This is the only change i have made, infact i wanted to add some more sheets too in the future. I&#39;m using MSO365, running with i7,32gb ram, just mentioning for a better clarity of why it freezes.  Kindly help, Thank you."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 15, "user_id": 12594964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb861ee59a7a45536409b77eed55aada?s=128&d=identicon&r=PG&f=1", "display_name": "kopsy", "link": "https://stackoverflow.com/users/12594964/kopsy"}, "edited": false, "score": 0, "creation_date": 1577465005, "post_id": 59483050, "comment_id": 105179655, "body": "Technically your question is how to loop through sheets, which the above answer does explain, so I&#39;d appreciate it if you click <code>accept</code> on. Why it&#39;s expanding, is almost certainly due to the fact that you&#39;re running it every two minutes (why would you do that?). You might want to set that to run outside of the worksheets loop... not sure."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 1, "last_activity_date": 1610289843, "last_edit_date": 1610289843, "creation_date": 1577323898, "answer_id": 59483050, "question_id": 59477404, "link": "https://stackoverflow.com/questions/59477404/how-to-make-a-macro-work-for-multiple-sheets/59483050#59483050", "title": "How to make a macro work for multiple sheets?", "body": "<p>The comments <a href=\"https://stackoverflow.com/questions/39581487/loop-through-all-worksheets-in-workbook\">correctly point to this answer</a> as a solution.</p>\n<p>You can loop through worksheets in a workbook. I included some ideas that might help you organize your code so that if something changes (i.e. the range of columns or the 2 minute time) you can update.</p>\n<p>I also included a condition in case you don't want to apply code to all worksheets.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub GetMyData1()\n    Const timerAmount As String = &quot;00:02:00&quot;\n    Const rng1Address As String = &quot;A2:P2&quot;\n    \n    Dim WS As Worksheet, lastrow As Long, nextblankrow As Long, myTimer As Double\n    Dim rng1 As Range\n    \n    For Each WS In ThisWorkbook.Worksheets\n    \n        'if you don't want to apply to ALL sheets, use some kind of if-statement to hold it.\n        If WS.Name = &quot;Adata&quot; Or WS.Name = &quot;something else&quot; Then\n            Application.ScreenUpdating = False\n            \n            Application.OnTime Now + TimeValue(timerAmount), &quot;GetMyData1&quot;\n            \n            Set rng1 = WS.Range(rng1Address)\n            rng1.Copy\n            lastrow = WS.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row\n            nextblankrow = lastrow + 1\n            WS.Range(&quot;A&quot; &amp; nextblankrow).PasteSpecial xlPasteValues\n                \n            ActiveWorkbook.RefreshAll\n            Application.ScreenUpdating = True\n        End If\n    Next WS\n    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12594964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb861ee59a7a45536409b77eed55aada?s=128&d=identicon&r=PG&f=1", "display_name": "kopsy", "link": "https://stackoverflow.com/users/12594964/kopsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 59483050, "answer_count": 1, "score": -1, "last_activity_date": 1610289843, "creation_date": 1577269329, "last_edit_date": 1609939324, "question_id": 59477404, "link": "https://stackoverflow.com/questions/59477404/how-to-make-a-macro-work-for-multiple-sheets", "title": "How to make a macro work for multiple sheets?", "body": "<p>I have code which copies a range and transfers the values in a next blank row continuously, for a single sheet.</p>\n<p>I want the same done in multiple worksheets in a single go.</p>\n<p>How to assign multiple sheet names?</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nDim myTimer As Date\n\nSub GetMyData1()\n    Application.ScreenUpdating = False\n    Dim lastrow As Long, nextblankrow As Long\n    myTimer = Now + TimeValue(&quot;00:02:00&quot;)\n    Application.OnTime myTimer, &quot;GetMyData1&quot;\n    Dim rng1 As Range\n    Set rng1 = Worksheets(&quot;Adata&quot;).Range(&quot;A2:P2&quot;)\n    rng1.Copy\n    lastrow = Sheets(&quot;Adata&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row\n    nextblankrow = lastrow + 1\n    Sheets(&quot;Adata&quot;).Range(&quot;A&quot; &amp; nextblankrow).PasteSpecial xlPasteValues\n    ActiveWorkbook.RefreshAll\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "xml", "vba"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1577301941, "creation_date": 1577301941, "answer_id": 59481270, "question_id": 59477295, "link": "https://stackoverflow.com/questions/59477295/edit-xml-rootelement-using-vba/59481270#59481270", "title": "edit XML rootelement using VBA", "body": "<p>Simply use the <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms754616(v%3Dvs.85)\" rel=\"nofollow noreferrer\"><code>setAttribute</code></a> property after creating root element. Fill in <code>...</code> accordingly in below example.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>...\n' ROOT ELEMENT\nSet objRootElem = objDom.createElement(\"_XPXML\") \n\nWith objRootElem \n  .setAttribute \"Desc\", \"\"\n  .setAttribute \"AppId\", \"1\" \n  .setAttribute \"Ver\", \"802\" \n  .setAttribute \"Srv\", \"SHN_ACCSERVER\" \n  .setAttribute \"DBN\", \"_AccXP_SHN98\" \nEnd With\n\nobjDom.appendChild objRootElem\n\n\n' ROOT CHILD NODES\nSet childNode = objDom.createElement(\"_FTrans\")\n\nWith childNode \n  .setAttribute \"Unit\", \"2\"\n  .setAttribute \"UnitAmount\", \"54.6\" \n  .setAttribute \"RefN\", \"645000\" \n  ...\nEnd With\n\nobjRootElem.appendChild\n...\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11125316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fea6adcd370a59cd752a6e95949827ae?s=128&d=identicon&r=PG&f=1", "display_name": "AmoExcel", "link": "https://stackoverflow.com/users/11125316/amoexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 59481270, "answer_count": 1, "score": 0, "last_activity_date": 1577301941, "creation_date": 1577268473, "last_edit_date": 1577269531, "question_id": 59477295, "link": "https://stackoverflow.com/questions/59477295/edit-xml-rootelement-using-vba", "title": "edit XML rootelement using VBA", "body": "<p>I am new to XML. I use the following function to create an xml file.\nI want change the code to add some more details to its root element.\nyou can refer to the attached picture for my purpose. </p>\n\n<pre><code>Function fnCreateXmlNew()\n\n\n   Dim objDom As DOMDocument\n   Dim objRootElem As IXMLDOMElement\n   Dim objMemberElem As IXMLDOMElement\n   Dim objMemberRel As IXMLDOMAttribute\n   Dim objMemberName As IXMLDOMElement\n\n   Set objDom = New DOMDocument\n\n   objDom.appendChild objDom.createProcessingInstruction(\"xml\", \"version='1.0' encoding='UTF-8' standalone=\"\"yes\"\"\")\n      Set objRootElem = objDom.createElement(\"_XPXML\")\n   objDom.appendChild objRootElem\n\n\n\n\n    XMLFileName = \"C:\\Users\\SHIVAMAIN\\Documents\\xml\\TEST.xml\"\n\n\n    Set ParentNode = objDom.SelectSingleNode(\"_XPXML\")\n\n\n    Set childNode = objDom.createElement(\"_FTrans\")\n    ParentNode.appendChild childNode\n\n    Set nodeAttribute = objDom.createAttribute(\"Unit\")\n    nodeAttribute.NodeValue = 2\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"UnitAmount\")\n    nodeAttribute.NodeValue = 525.3\n    childNode.setAttributeNode nodeAttribute\n\n\n    Set nodeAttribute = objDom.createAttribute(\"RefN\")\n    nodeAttribute.NodeValue = 0\n    childNode.setAttributeNode nodeAttribute\n\n\n    Set nodeAttribute = objDom.createAttribute(\"Desc\")\n    nodeAttribute.NodeValue = \"\u00c8\u00c7\u00c8\u00ca \u00dd\u00c7\u02dc\u00ca\u00e6\u00d1 \u00dd\u00d1\u00e6\u00d41\"\n    childNode.setAttributeNode nodeAttribute\n\n\n    Set nodeAttribute = objDom.createAttribute(\"Cre\")\n    nodeAttribute.NodeValue = 0\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"Deb\")\n    nodeAttribute.NodeValue = 3798385\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"Det2\")\n    nodeAttribute.NodeValue = \"16/0002\"\n    childNode.setAttributeNode nodeAttribute\n\n\n    Set nodeAttribute = objDom.createAttribute(\"Det1\")\n    nodeAttribute.NodeValue = \"03/0654\"\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"Acc\")\n    nodeAttribute.NodeValue = \"1/0/01/02\"\n    childNode.setAttributeNode nodeAttribute\n\n    Set childNode = objDom.createElement(\"_FTrans\")\n    ParentNode.appendChild childNode\n\n\n    Set nodeAttribute = objDom.createAttribute(\"Unit\")\n    nodeAttribute.NodeValue = 2\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"UnitAmount\")\n    nodeAttribute.NodeValue = 54.6\n    childNode.setAttributeNode nodeAttribute\n\n\n    Set nodeAttribute = objDom.createAttribute(\"RefN\")\n    nodeAttribute.NodeValue = 645000\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"ODesc\")\n    nodeAttribute.NodeValue = 41970130298#\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"Desc\")\n    nodeAttribute.NodeValue = \"\u00c8\u00c7\u00c8\u00ca \u00dd\u00c7\u02dc\u00ca\u00e6\u00d1 \u00dd\u00d1\u00e6\u00d4\"\n    childNode.setAttributeNode nodeAttribute\n\n\n    Set nodeAttribute = objDom.createAttribute(\"Cre\")\n    nodeAttribute.NodeValue = 352170\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"Deb\")\n    nodeAttribute.NodeValue = 0\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"Det2\")\n    nodeAttribute.NodeValue = \"03/0654\"\n    childNode.setAttributeNode nodeAttribute\n\n\n    Set nodeAttribute = objDom.createAttribute(\"Det1\")\n    nodeAttribute.NodeValue = \"09/1571\"\n    childNode.setAttributeNode nodeAttribute\n\n    Set nodeAttribute = objDom.createAttribute(\"Acc\")\n    nodeAttribute.NodeValue = \"4/0/00/01\"\n    childNode.setAttributeNode nodeAttribute\n\n\n\n\n\n\nobjDom.Save (XMLFileName)\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/SQ4sJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SQ4sJ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577256041, "post_id": 59475861, "comment_id": 105129465, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/59473466/error-on-the-s-of-clearcontents-on-the-same-line\">Error on the s of clearcontents on the same line</a>"}, {"owner": {"reputation": 13, "user_id": 11542775, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GqEvqLMfqBw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoeiPSKK9wfSpGPXaxW8Lg79KLbw/mo/photo.jpg?sz=128", "display_name": "Chatrapal Singh Rathore", "link": "https://stackoverflow.com/users/11542775/chatrapal-singh-rathore"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577256674, "post_id": 59475861, "comment_id": 105129553, "body": "No, it didn&#39;t solve the problem and further the question itself wasn&#39;t complete."}, {"owner": {"reputation": 13, "user_id": 11542775, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GqEvqLMfqBw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoeiPSKK9wfSpGPXaxW8Lg79KLbw/mo/photo.jpg?sz=128", "display_name": "Chatrapal Singh Rathore", "link": "https://stackoverflow.com/users/11542775/chatrapal-singh-rathore"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577258077, "post_id": 59475861, "comment_id": 105129804, "body": "Sorry din;t get what to put in Value=&quot; &quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577258177, "post_id": 59475861, "comment_id": 105129816, "body": "no do not use <code>&quot; &quot;</code>. Use <code>&quot;&quot;</code>. No space between the double quotes. I have posted an answer. You may have to refresh the page to see it."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1577258372, "last_edit_date": 1577258372, "creation_date": 1577258019, "answer_id": 59476074, "question_id": 59475861, "link": "https://stackoverflow.com/questions/59475861/how-to-apply-code-to-merged-cells-that-produces-runtime-error-we-cant-do-th/59476074#59476074", "title": "How to apply code, to merged cells, that produces Runtime-Error :&quot;We can&#39;t do that to merged cells.&quot;", "body": "<p>Since it is a <strong>MIX</strong> of both kind of cells, either use </p>\n\n<pre><code>Range(\"D7,D9,D11,D13,D15,D17,D19,D27\").Value=\"\"\n'OR\nRange(\"D7,D9,D11,D13,D15,D17,D19,D27\").Value = vbNullString\n</code></pre>\n\n<p>OR loop though the range and check if the cell is merged. If it is merged then use <code>.MergeArea.ClearContents</code> else use <code>.ClearContents</code> as shown below.</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim rng As Range\n    Dim aCell As Range\n\n    Set rng = Sheet1.Range(\"D7,D9,D11,D13,D15,D17,D19,D27\")\n\n    For Each aCell In rng\n        If aCell.MergeCells Then\n            aCell.MergeArea.ClearContents\n        Else\n            aCell.ClearContents\n        End If\n    Next aCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11542775, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GqEvqLMfqBw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoeiPSKK9wfSpGPXaxW8Lg79KLbw/mo/photo.jpg?sz=128", "display_name": "Chatrapal Singh Rathore", "link": "https://stackoverflow.com/users/11542775/chatrapal-singh-rathore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 59476074, "answer_count": 1, "score": 1, "last_activity_date": 1580509646, "creation_date": 1577255986, "last_edit_date": 1580509646, "question_id": 59475861, "link": "https://stackoverflow.com/questions/59475861/how-to-apply-code-to-merged-cells-that-produces-runtime-error-we-cant-do-th", "title": "How to apply code, to merged cells, that produces Runtime-Error :&quot;We can&#39;t do that to merged cells.&quot;", "body": "<p>This is the design I want to use to provide data to a table below and vice-versa.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eXnfo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eXnfo.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Cont_New()\nWith Sheet1\n .Range(\"R33\").Value = True 'Contact Load\n .Range(\"R32\").Value = True 'New Contact to True\n .Range(\"D7,D9,D11,D13,D15,D17,D19,D27\").ClearContents\n .Shapes(\"ExistContGrp\").Visible = msoFalse\n .Shapes(\"NewContGrp\").Visible = msoTrue\n .Range(\"R33\").Value = False 'COntact Load to False\nEnd With\nEnd Sub\n</code></pre>\n\n<p>How can I solve this issue with the merged cells?</p>\n\n<blockquote>\n  <p>Runtime-Error :\"We can't do that to merged cells.\"</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577254598, "post_id": 59475636, "comment_id": 105129268, "body": "What is the value of Cell in say D2?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577254919, "post_id": 59475636, "comment_id": 105129321, "body": "BTW you can also use <code>Dateserial(2019,5,1)</code> instead of  <code>DateValue(&quot;1 &#47; 5 &#47; 2019&quot;)</code> which is of course is equal to <code>43586</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577255009, "post_id": 59475636, "comment_id": 105129336, "body": "If you can share a screenshot of your data then it may help with a speedy solution :)"}, {"owner": {"reputation": 95, "user_id": 760946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae15fa6514568f602239ba5c3e8995e?s=128&d=identicon&r=PG", "display_name": "user760946", "link": "https://stackoverflow.com/users/760946/user760946"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577255873, "post_id": 59475636, "comment_id": 105129444, "body": "Kindly take a look at my table. <a href=\"https://imgur.com/4OBC95h\" rel=\"nofollow noreferrer\">imgur.com/4OBC95h</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577257233, "post_id": 59475636, "comment_id": 105129655, "body": "<code>43599</code>? BTW is there seems to be a type in <code>ElseIf (Cell.Value &gt;= 43599) And (Cell.Value &lt;= 43599) Then</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577257424, "post_id": 59475636, "comment_id": 105129689, "body": "Once you answer the above, I have another question for you..."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1577257635, "post_id": 59475636, "comment_id": 105129724, "body": "Looks for me you could solve this with a formula (SUMIF, ...)"}, {"owner": {"reputation": 95, "user_id": 760946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae15fa6514568f602239ba5c3e8995e?s=128&d=identicon&r=PG", "display_name": "user760946", "link": "https://stackoverflow.com/users/760946/user760946"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577260374, "post_id": 59475636, "comment_id": 105130204, "body": "@Siddharth Rout . Sorry,I didn&#39;t understand, Are you saying there is problem in my elseif statement. Kindly explain."}, {"owner": {"reputation": 95, "user_id": 760946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae15fa6514568f602239ba5c3e8995e?s=128&d=identicon&r=PG", "display_name": "user760946", "link": "https://stackoverflow.com/users/760946/user760946"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1577260479, "post_id": 59475636, "comment_id": 105130227, "body": "@Storax . Yes you are right. But I want to achieve it by writing a macro code."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577260731, "post_id": 59475636, "comment_id": 105130270, "body": "Why do you have <code>43599</code> two times in the that line?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1577261385, "post_id": 59475636, "comment_id": 105130401, "body": "Or in other words <code>(Cell.Value &gt;= 43599) And (Cell.Value &lt;= 43599)</code> is the same as <code>Cell.Value = 43599</code>."}, {"owner": {"reputation": 95, "user_id": 760946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae15fa6514568f602239ba5c3e8995e?s=128&d=identicon&r=PG", "display_name": "user760946", "link": "https://stackoverflow.com/users/760946/user760946"}, "edited": false, "score": 0, "creation_date": 1577261548, "post_id": 59475636, "comment_id": 105130440, "body": "Oh! That I have written it just to complete the ifelse statement. Actually, my first part of the code is not working, if it works then I will change the rest accordingly. According to my code, I am supposed to get 2400 in cell J3 and 3000 in cell J4.  Instead of these values, I am getting 4800 and 6000 in cell J3 and J4 respectively. I dont know why I am getting double values."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1577261643, "post_id": 59475636, "comment_id": 105130464, "body": "You can simply create a sumifs through code. No need to loop all cells in a range (it&#39;s not so fast either). Have you also considered AutoFilter as an option?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577261882, "post_id": 59475636, "comment_id": 105130519, "body": "Another thing is to start using explicit range references. Currency your references refer to the implicit ActiveSheet (which might become problematic)."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577261988, "post_id": 59475636, "comment_id": 105130536, "body": "And btw, currently, you starting a new loop over column c, each time column d fits your criteria (which probably explain your incorrect values). You most likely just interested in the cells Offset instead of a full iteration each time."}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577268936, "post_id": 59476891, "comment_id": 105131974, "body": "Whether or not it&#39;s the easiest to use, it&#39;s certainly a demonstration of some great VBA possibilities! Kudos to you Storax. I can never get my head around these methods."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1577269211, "post_id": 59476891, "comment_id": 105132038, "body": "Thanks. OP wanted to have VBA instead of a probably much easier SUMIF formula. He got what he asked for :-)"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1577267147, "last_edit_date": 1577267147, "creation_date": 1577265509, "answer_id": 59476891, "question_id": 59475636, "link": "https://stackoverflow.com/questions/59475636/extracting-data-between-two-given-dates/59476891#59476891", "title": "Extracting data between two given dates", "body": "<p>If you want to do it with VAB I'd suggest to use ADODB for example like that</p>\n\n<pre><code>Sub ReadFromWorksheetADO()\n    ' Goto Tools/Reference\n    ' Add a reference to Microsoft ActiveX Data Objects\n    Dim conn As New ADODB.Connection\n\n    conn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" _\n        &amp; ThisWorkbook.FullName &amp; \";Extended Properties=\"\"Excel 12.0;HDR=YES;\"\";\"\n\n    Dim query As String\n    query = \"SELECT SUM([Total Fee]) FROM (SELECT * from [data$] \" &amp; _\n        \" WHERE [Date of Deposit] BETWEEN #04/30/2018# AND #05/01/2020# And [Year]='2020-21')\"\n\n    Dim rs As New ADODB.Recordset\n\n    With rs\n        .Open query, conn\n        Debug.Print \"Sum: \" &amp; .Fields(0)\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Assumption is that you have your data in a sheet named <code>data</code></p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 760946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae15fa6514568f602239ba5c3e8995e?s=128&d=identicon&r=PG", "display_name": "user760946", "link": "https://stackoverflow.com/users/760946/user760946"}, "edited": false, "score": 0, "creation_date": 1577515595, "post_id": 59478619, "comment_id": 105189868, "body": "Thank a lot everyone for your valuable advice."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1577278656, "creation_date": 1577278656, "answer_id": 59478619, "question_id": 59475636, "link": "https://stackoverflow.com/questions/59475636/extracting-data-between-two-given-dates/59478619#59478619", "title": "Extracting data between two given dates", "body": "<p>You don't show what you want for results, but you can use the <code>Range.Autofilter</code> method to extract the lines that meet your requirements.  You could easily build in a method to extract just the fees.</p>\n\n<p>eg:</p>\n\n<pre><code>Option Explicit\nSub getFees()\n    Dim myData As Range\n    Dim WS As Worksheet\n    Dim ldtCol As Long, lyrCol As Long\n    Dim lFeeCol As Long, lFee1Col As Long\n    Dim dFees As Double\n    Dim vFees As Variant, v As Variant\n\n\n    Dim rFilteredData As Range, rDest As Range\n\n    '\"1 / 5 / 2019\")) And (Cell.Value &lt;= DateValue(\"30 / 4 / 2020\n    'note these dates below are in MDY format\n    Const startDt As Date = #5/1/2019#\n    Const endDt As Date = #4/30/2020#\n    Const applYr As String = \"2020-21\"\n\nSet WS = ThisWorkbook.Worksheets(\"sheet1\")\nWith WS.Cells\n    Set myData = .Find(what:=\"S.No.\", after:=.Item(.Rows.Count, .Columns.Count), _\n            LookIn:=xlValues, lookat:=xlPart, searchorder:=xlByRows, searchdirection:=xlNext, _\n            MatchCase:=False)\n    If myData Is Nothing Then\n        MsgBox \"Data table not found\"\n    Else\n        Set myData = myData.CurrentRegion\n    End If\nEnd With\n\nWith myData.Rows(1)\n    ldtCol = .Find(what:=\"Date of Deposit\").Column - myData.Column + 1\n    lyrCol = .Find(what:=\"Year\").Column - myData.Column + 1\n    lFeeCol = .Find(what:=\"Base Fee\", lookat:=xlWhole).Column - myData.Column + 1\n    lFee1Col = .Find(what:=\"Base Fee2\").Column - myData.Column + 1\nEnd With\n\n\nApplication.ScreenUpdating = False\nIf WS.AutoFilterMode = True Then WS.AutoFilter.ShowAllData\n\nWith myData\n\n    Set rDest = .Cells(1, 1).Offset(0, 10)\n    rDest.Resize(columnsize:=.Columns.Count).EntireColumn.Clear\n\n    .AutoFilter field:=lyrCol, Criteria1:=applYr\n    .AutoFilter field:=ldtCol, Criteria1:=\"&gt;=\" &amp; CDbl(startDt), _\n        Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; CDbl(endDt)\n\n    Set rFilteredData = myData.SpecialCells(xlCellTypeVisible)\n    Set rDest = .Cells(1, 1).Offset(0, 10)\n    rDest.Resize(columnsize:=.Columns.Count).EntireColumn.Clear\n    rFilteredData.Copy rDest\n    .AutoFilter 'turn off filter\n    rDest.EntireColumn.AutoFit\n\n    With rDest.CurrentRegion\n        vFees = Union(.Columns(lFeeCol), .Columns(lFee1Col))\n    End With\n        For Each v In vFees\n            If IsNumeric(v) Then dFees = dFees + v\n        Next v\n    Application.ScreenUpdating = True\n\n    MsgBox \"Total Fees for period: \" &amp; dFees\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2lNdB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2lNdB.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 95, "user_id": 760946, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ae15fa6514568f602239ba5c3e8995e?s=128&d=identicon&r=PG", "display_name": "user760946", "link": "https://stackoverflow.com/users/760946/user760946"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 59478619, "answer_count": 2, "score": 0, "last_activity_date": 1577278656, "creation_date": 1577253625, "last_edit_date": 1577256498, "question_id": 59475636, "link": "https://stackoverflow.com/questions/59475636/extracting-data-between-two-given-dates", "title": "Extracting data between two given dates", "body": "<p>I have a table in excel having eight columns which includes year, date of deposit and total fees. </p>\n\n<p>Now, if date of deposit is between two given dates and it pertains to year <code>2019-20</code> then I am trying to extract value from corresponding fee column. I am trying to get total fees deposited between two given dates for a particular year. But I am not getting desired result. Kindly help.</p>\n\n<p>I am using <code>If and Else</code> statement and <code>For Each</code> loop.</p>\n\n<pre><code>Sub Macro12()\n    Dim Cell As Range\n    Dim Cell2 As Range\n\n    For Each Cell In Range(\"D2:D25\")\n        ' If (Cell.Value &gt;= DateValue(\"1 / 5 / 2019\")) And (Cell.Value &lt;= DateValue(\"30 / 4 / 2020\")) Then\n        If (Cell.Value &gt;= 43586) And (Cell.Value &lt;= 43951) Then\n            For Each Cell2 In Range(\"C2:C25\")\n                If Cell2.Value = \"2020-21\" Then\n                    Range(\"I3\").Value = Cell2.Value\n                    Range(\"J3\").Value = Range(\"J3\").Value + Cell2.Offset(0, 5).Value\n                Else\n                    Range(\"I4\").Value = \"other years\"\n                    Range(\"J4\").Value = Range(\"J4\").Value + Cell2.Offset(0, 5).Value\n                End If\n            Next Cell2\n            ' ElseIf (Cell.Value &gt;= DateValue(\"1 / 5 / 2021\")) And (Cell.Value &lt;= DateValue(\"30 / 4 / 2022\")) Then\n        ElseIf (Cell.Value &gt;= 43599) And (Cell.Value &lt;= 43599) Then\n            Range(\"M3\").Value = \"step 1 clear\"\n        End If\n    Next Cell\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/k6Z2v.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k6Z2v.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "excel", "vba", "random", "uniqueidentifier"], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1577386502, "creation_date": 1577386502, "answer_id": 59492351, "question_id": 59475337, "link": "https://stackoverflow.com/questions/59475337/unique-id-generator-and-randomizer/59492351#59492351", "title": "Unique Id Generator and Randomizer", "body": "<p>If I'm reading correctly, you basically just want to shuffle the array whilst also imposing the constraint that no <code>user ID</code> cannot end up corresponding to itself.</p>\n\n<p>There are a number of ways you can implement this. The approach below is not very generalised, can be refactored (to use more functions/subroutines) and a bit clunky. Nonetheless, it might be okay and may give you some ideas regarding implementation:</p>\n\n<pre><code>Option Explicit\n\nPrivate Function GetArrayOfNames(ByVal someRange As Range) As Variant\n    ' someRange should be a single-column, vertical range.\n    Debug.Assert someRange.Columns.Count = 1\n    Debug.Assert someRange.Areas.Count = 1\n    Debug.Assert someRange.Rows.Count &gt; 1\n\n    GetArrayOfNames = someRange.Value\nEnd Function\n\nPrivate Sub SecretSantaShuffle()\n    ' This procedure will overwrite the contents of the initial range,\n    ' and the three columns to its right.\n    Dim rangeContainingNames As Range\n    Set rangeContainingNames = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A2:A7\")\n\n    Dim inputArray() As Variant\n    inputArray = GetArrayOfNames(rangeContainingNames)\n\n    Dim rowCount As Long\n    rowCount = UBound(inputArray, 1)\n\n    ReDim Preserve inputArray(1 To rowCount, 1 To 4)\n\n    Const NAME_COLUMN_INDEX As Long = 1\n    Const UID_COLUMN_INDEX As Long = 2\n    Const RANDOM_NAME_COLUMN_INDEX As Long = 3\n    Const RANDOM_UID_COLUMN_INDEX As Long = 4\n\n    Do\n        Dim userIdPool As Collection\n        Set userIdPool = New Collection\n\n        Dim rowIndex As Long\n        For rowIndex = LBound(inputArray, 1) To UBound(inputArray, 1)\n            inputArray(rowIndex, UID_COLUMN_INDEX) = rowIndex\n            userIdPool.Add rowIndex, Key:=CStr(rowIndex)\n        Next rowIndex\n\n        For rowIndex = LBound(inputArray, 1) To UBound(inputArray, 1)\n            Dim randomRowIndex As Long\n\n            Do While True\n                randomRowIndex = userIdPool.Item(Application.RandBetween(1, userIdPool.Count))\n                If randomRowIndex &lt;&gt; rowIndex Then Exit Do\n                If userIdPool.Count = 1 Then Exit Do\n                DoEvents\n            Loop\n\n            userIdPool.Remove CStr(randomRowIndex)\n\n            inputArray(rowIndex, RANDOM_NAME_COLUMN_INDEX) = inputArray(randomRowIndex, NAME_COLUMN_INDEX)\n            inputArray(rowIndex, RANDOM_UID_COLUMN_INDEX) = inputArray(randomRowIndex, UID_COLUMN_INDEX)\n        Next rowIndex\n    Loop While userIdPool.Count &gt; 0\n\n    rangeContainingNames.Resize(UBound(inputArray, 1), UBound(inputArray, 2)).Value = inputArray\nEnd Sub\n</code></pre>\n\n<p>You will likely need to change what gets assigned to <code>rangeContainingNames</code>. My list of names was in range <code>A2:A7</code> of worksheet <code>Sheet1</code> but you should change the sheet name and range address to reflect the location of your names.</p>\n"}], "owner": {"reputation": 43, "user_id": 9438708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f5764b5f3523ad4929880d2413afdc?s=128&d=identicon&r=PG&f=1", "display_name": "Ekko", "link": "https://stackoverflow.com/users/9438708/ekko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1610000283, "creation_date": 1577249515, "last_edit_date": 1610000283, "question_id": 59475337, "link": "https://stackoverflow.com/questions/59475337/unique-id-generator-and-randomizer", "title": "Unique Id Generator and Randomizer", "body": "<p>I am trying a few items for a Secret Santa spreadsheet.</p>\n<ol>\n<li><p>A Unique ID generator to print the UID in Column B for a list of names in Column A.</p>\n</li>\n<li><p>A randomizer to print the ID numbers in a random order in Column C with the restraint that Column B UID cannot equal Column C UID, ensuring no one gets themselves.</p>\n</li>\n<li><p>List Name for the random UID in Column C in Column D.</p>\n</li>\n</ol>\n<p>The UIDs are to start at 1 and then count until the last name receives an ID. I also want the generator to handle creating an ID for a name that is added anywhere in the list (beginning, middle, end).</p>\n<p>I found some answers here and on other websites.<br />\nSome use complicated looping others the GUID function that I do not understand.<br />\nIn general, the answers are for existing lists and not a new list with no UIDs.</p>\n<p>I assume I would:</p>\n<ol>\n<li>Create the UIDs and print them to Column B.</li>\n<li>Save Column A and B into an array.</li>\n<li>Randomize and Print the UID's into Column C.</li>\n<li>Use the array to get the name for the randomized UID's in Column C and print the corresponding name in Column D.</li>\n</ol>\n<p>I am unsure if this methodology is a &quot;good&quot; approach for this type of problem, but I would be interested in hearing other methodologies.</p>\n<p>The only code I have so far is the row counter.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub secret_santa()\n    \n    Dim person_count As Integer\n    Dim uid As Integer\n       \n    'Count Number of Used Rows\n    person_count = ActiveSheet.UsedRange.Rows.Count\n        \n    'Subtract Header from person_count\n    person_count = person_count - 1\n       \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1577269712, "post_id": 59474793, "comment_id": 105132141, "body": "What is exact error? <code>Runtime error 1004</code> has different definitions. What is an error message?"}], "answers": [{"tags": [], "owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "is_accepted": false, "score": 0, "last_activity_date": 1577282671, "last_edit_date": 1577282671, "creation_date": 1577282322, "answer_id": 59479095, "question_id": 59474793, "link": "https://stackoverflow.com/questions/59474793/run-time-error-1004-on-my-vba-excel-code-transfer-data-from-one-worksheet-to-a/59479095#59479095", "title": "Run-time Error 1004 on my VBA Excel code - transfer data from one worksheet to another", "body": "<p>First of all you have to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">read this</a> article carefully. </p>\n\n<p>The reason because your error is raised only on the 2nd run is because:</p>\n\n<ol>\n<li>On the first run, you have an empty range <code>Worksheets(\"Job Order\nRecord\").Range(\"E5\").Offset(1, 0)</code>;</li>\n<li>That range is filled with <code>ActiveCell.Value = Description</code> line;</li>\n<li>On the second run, you match the <code>If</code> condition and try to perform the line <code>Worksheets(\"Job Order\nRecord\").Range(\"E5\").End(x1Down).Select</code>;</li>\n<li>You get an error.</li>\n</ol>\n\n<p>So what do you need to do? The solution is very easy:</p>\n\n<ol>\n<li><p>In your editor, go to <em>Tools \u2192 Options \u2192</em> tick the <em>\"Require Variable Declaration\"</em>:\n<a href=\"https://i.stack.imgur.com/zWY7U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zWY7U.png\" alt=\"enter image description here\"></a> </p></li>\n<li><p>Then go to <em>Debug \u2192 Compile VBAProject</em>:\n<a href=\"https://i.stack.imgur.com/WO8WQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WO8WQ.png\" alt=\"enter image description here\"></a> </p></li>\n<li><p>You see the reason of error at once - it is misprint of direction <code>.End(*x1Down*)</code> variable (you have number 1 instead of l letter):\n<a href=\"https://i.stack.imgur.com/WUQYq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WUQYq.png\" alt=\"enter image description here\"></a></p></li>\n</ol>\n\n<p>As far as you have the <em>\"Require Variable Declaration\"</em> switched off -compiler doesn't check the code before run, but when code reaches the line with error - it can't understand what to do and throws an exception.</p>\n\n<p>The other thing is that if you do read the article - you would likely replace 12 lines of your code with only 6, a bit faster code, something like this:</p>\n\n<pre><code>Sub Button4_Click()\n\nDim Description As String\nDim OrderFormatSht As Worksheet, OrderRecordSht As Worksheet\n\nSet OrderFormatSht = ThisWorkbook.Sheets(\"Job Order Format\")\nSet OrderRecordSht = ThisWorkbook.Sheets(\"Job Order Record\")\n\nDescription = OrderFormatSht.Range(\"C20\")\n\nIf Not Description = \"\" Then OrderRecordSht.Cells(Rows.Count, 3).End(xlUp).Offset(1, 0) = Description\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9810243, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "nicolo orcine", "link": "https://stackoverflow.com/users/9810243/nicolo-orcine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1577282671, "creation_date": 1577241855, "last_edit_date": 1577254637, "question_id": 59474793, "link": "https://stackoverflow.com/questions/59474793/run-time-error-1004-on-my-vba-excel-code-transfer-data-from-one-worksheet-to-a", "title": "Run-time Error 1004 on my VBA Excel code - transfer data from one worksheet to another", "body": "<p>VBA Code to transfer value of one cell to another worksheet</p>\n\n<pre><code>Sub Button4_Click()\n\nDim Description As String\n\nWorksheets(\"Job Order Format\").Select\n\nDescription = Range(\"C20\")\n\nWorksheets(\"Job Order Record\").Select\n\nWorksheets(\"Job Order Record\").Range(\"E5\").Select\n\nIf Worksheets(\"Job Order Record\").Range(\"E5\").Offset(1, 0) &lt;&gt; \"\" Then\n\nWorksheets(\"Job Order Record\").Range(\"E5\").End(x1Down).Select\n\nEnd If\n\nActiveCell.Offset(1, 0).Select\n\nActiveCell.Value = Description\n\nWorksheets(\"Job Order Format\").Select\n\nWorksheets(\"Job Order Format\").Range(\"C20\").Select\n\nEnd Sub\n</code></pre>\n\n<p>The code works for the 1st attempt with no error but for the 2nd attempt I get an error of Run-time Error 1004.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mpzyb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mpzyb.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/RkA8T.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RkA8T.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/cIGoR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cIGoR.jpg\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "edited": false, "score": 0, "creation_date": 1577231192, "post_id": 59474175, "comment_id": 105126654, "body": "Here&#39;s a good solution from Microsoft (step 1 worked for me): <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/all/missing-delete-function-in-excel-2016-row-column/38a98ac2-0d79-4808-8815-f5641da16c28\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/msoffice/forum/all/&hellip;</a>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "edited": false, "score": 0, "creation_date": 1577231195, "post_id": 59474175, "comment_id": 105126655, "body": "Just paste it into your debug window and press enter. I tried it myself (removing it and resetting it) and it worked just fine. You are doing it wrong."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "edited": false, "score": 0, "creation_date": 1577231749, "post_id": 59474175, "comment_id": 105126724, "body": "Your link seems like a lot of work compared to my solution."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1577230891, "creation_date": 1577230891, "answer_id": 59474175, "question_id": 59474076, "link": "https://stackoverflow.com/questions/59474076/delete-button-missing-on-pop-up-menu-on-row-bar-how-to-get-it-back/59474175#59474175", "title": "&quot;Delete&quot; button missing on pop up menu on row bar. How to get it back?", "body": "<p>You can reset the row command bar using this:</p>\n\n<pre><code>Application.CommandBars(\"Row\").Reset\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577230891, "creation_date": 1577229356, "last_edit_date": 1577230556, "question_id": 59474076, "link": "https://stackoverflow.com/questions/59474076/delete-button-missing-on-pop-up-menu-on-row-bar-how-to-get-it-back", "title": "&quot;Delete&quot; button missing on pop up menu on row bar. How to get it back?", "body": "<p>I carelessly run this macro:</p>\n\n<pre><code>Application.CommandBars(\"Row\").FindControl(ID:=293).Delete\n</code></pre>\n\n<p>where ID:=293 is \"Delete\" button when right click on row bar. Then, I find \"Delete\" is missing from Row Bar:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kd570.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kd570.png\" alt=\"enter image description here\"></a></p>\n\n<p>How do I get \"Delete\" visible again?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1577233888, "post_id": 59473718, "comment_id": 105126980, "body": "Do you have a <code>ListObject</code> (<b>Table</b>) on the worksheet being referenced?"}], "answers": [{"tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 0, "last_activity_date": 1577238899, "creation_date": 1577238899, "answer_id": 59474625, "question_id": 59473718, "link": "https://stackoverflow.com/questions/59473718/a-vba-code-to-transfer-data-from-a-sheet-to-another-one/59474625#59474625", "title": "A VBA code to transfer data from a sheet to another one", "body": "<p>There are a few things I don't understand (e.g. why is <code>pages</code> assigned to <code>page</code>, what is the value of <code>pages</code>, what is the value of <code>lignes</code>, why does the code read from cells <code>D13</code> and <code>F13</code> when the image and comments suggest it should read from <code>D13</code> and <code>E13</code>).</p>\n\n<p>Although you've provided a lot of detail/information in your question (which is good), it's difficult to know what exactly is causing the issue.</p>\n\n<ul>\n<li>The fifth screenshot suggests perhaps there is no <code>ListObject</code> on <code>Sheets(page)</code>, hence run-time error '9'.</li>\n<li>The second screenshot suggests this too (cell <code>F4</code> appears to be selected, is in inside your \"table\" body, but there is no <code>Outils de tableau &gt; Creation</code> AKA <code>Table Tools</code> shown in the ribbon at the top of screen. This might suggest the \"table\" on <code>Journal</code> sheet is just a regular range formatted to look like a table -- but not actually an Excel table/<code>ListObject</code>). </li>\n</ul>\n\n<p>I've basically re-written what I think your code is trying to do.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub TransferToJournalSheet()\n    Dim sourceSheet As Worksheet\n    Set sourceSheet = ThisWorkbook.Worksheets(\"Formulaire du journal\")\n\n    Dim sourceTable As ListObject\n    Debug.Assert sourceSheet.ListObjects.Count &gt; 0 ' If code pauses on this line, check if you have a table on sourceSheet\n    Set sourceTable = sourceSheet.ListObjects(1) ' If there is a name, you can specify the name instead of index.\n\n    Dim destinationSheet As Worksheet\n    Set destinationSheet = ThisWorkbook.Worksheets(\"Journal\")\n\n    Dim destinationRowIndex As Long\n    destinationRowIndex = destinationSheet.Cells(destinationSheet.Rows.CountLarge, \"E\").End(xlUp).Row + 1\n    Debug.Assert destinationRowIndex &gt; 2\n\n    Debug.Assert sourceTable.Range.Rows.Count &gt; 1 ' If code pauses on this line, check if there is any data to transfer.\n    With sourceTable.DataBodyRange\n        destinationSheet.Cells(destinationRowIndex, \"E\").Resize(.Rows.Count).FormulaLocal = sourceSheet.Range(\"D7\").Value\n        destinationSheet.Range(\"F\" &amp; destinationRowIndex, \"G\" &amp; destinationRowIndex).Resize(.Rows.Count).Value2 = .Columns(\"B:C\").Value\n        destinationSheet.Range(\"J\" &amp; destinationRowIndex, \"K\" &amp; destinationRowIndex).Resize(.Rows.Count).Value2 = .Columns(\"E:F\").Value\n        destinationSheet.Cells(destinationRowIndex, \"L\").Resize(.Rows.Count).FormulaLocal = sourceSheet.Range(\"D9\").Value\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 12513989, "user_type": "registered", "profile_image": "https://graph.facebook.com/2603080276479680/picture?type=large", "display_name": "Houceine Belhadi", "link": "https://stackoverflow.com/users/12513989/houceine-belhadi"}, "is_accepted": false, "score": 0, "last_activity_date": 1577388728, "creation_date": 1577388728, "answer_id": 59492673, "question_id": 59473718, "link": "https://stackoverflow.com/questions/59473718/a-vba-code-to-transfer-data-from-a-sheet-to-another-one/59492673#59492673", "title": "A VBA code to transfer data from a sheet to another one", "body": "<p>concerning the code I just followed a video on Youtube and tried to adapt it to my project, I tried the code you provided but it doesn't work too.</p>\n"}], "owner": {"reputation": 5, "user_id": 12513989, "user_type": "registered", "profile_image": "https://graph.facebook.com/2603080276479680/picture?type=large", "display_name": "Houceine Belhadi", "link": "https://stackoverflow.com/users/12513989/houceine-belhadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 59474625, "answer_count": 2, "score": 0, "last_activity_date": 1577388728, "creation_date": 1577225009, "last_edit_date": 1577225121, "question_id": 59473718, "link": "https://stackoverflow.com/questions/59473718/a-vba-code-to-transfer-data-from-a-sheet-to-another-one", "title": "A VBA code to transfer data from a sheet to another one", "body": "<p>Here\u2019s my problem, I\u2019ve a table in sheet named \u00ab Formulaire du journal \u00bb, in this sheet the user enter the informations and fill the table (screenshot 1), the informations of this table is trensfered to another sheet called \u00ab Journal \u00bb (screenshot 2)</p>\n\n<p>The table should be transferred (screenshot 6)</p>\n\n<p>I followed a video on youtube so I tried a VBA code but i\u2019ve a problem (screenshot 3 and 4)\nHere\u2019s the code I used :</p>\n\n<pre><code>Option Explicit\n\nSub addinfo(pages, lignes)\n\n    Dim dl As Long\n    Dim page As String\n    page = pages\n    'trouver la derni\u00e8re ligne du tableau\n    If Sheets(page).Range(\"E3\") = Empty Then\n        dl = 3\n    Else\n        Sheets(page).ListObjects(1).ListRows.Add\n        dl = Sheets(page).Range(\"E2\").End(xlDown).Row + \n    End If\n    'placer dans le journal sp\u00e9cifique\n    With Sheets(page)\n        .Range(\"E\" &amp; dl) = .Range(\"D7\") 'La date\n        .Range(\"F\" &amp; dl) = Range(\"D13\" &amp; lignes) 'N\u00b0 de compte d\u00e9bit\n        .Range(\"G\" &amp; dl) = Range(\"F13\" &amp; lignes) 'N\u00b0 de compte cr\u00e9dit\n        .Range(\"J\" &amp; dl) = Range(\"G13\" &amp; lignes) 'Montant d\u00e9bit\n        .Range(\"K\" &amp; dl) = Range(\"H13\" &amp; lignes) 'Montant cr\u00e9dit\n        .Range(\"L\" &amp; dl) = Range(\"D9\") 'libell\u00e9 d'op\u00e9ration\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ldmuJ.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Samqt.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/KUqdQ.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/amtLW.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/P6xyZ.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/0Rw7p.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1577248540, "post_id": 59473655, "comment_id": 105128525, "body": "Your worksheet names are swapped inside your If statement. Also, the first <code>DepClass</code> should be <code>Class</code>. Since you know your last row for each worksheet, you don&#39;t need variables unless the last rows are dynamic, just use<code>137</code> and <code>106</code> in the For statements. Creating worksheet variables e.g. <code>ws1</code> and <code>ws2</code> would be less confusing.  I would use <code>x</code> and <code>y</code> instead of <code>Class</code> and <code>DepClass</code>, it will make your code easier to read. See my simplified version of your code based on your question&#39;s description."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10431906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ecde9d69bb64055e3c1f4b324003060?s=128&d=identicon&r=PG&f=1", "display_name": "M. Lamb", "link": "https://stackoverflow.com/users/10431906/m-lamb"}, "edited": false, "score": 0, "creation_date": 1577372637, "post_id": 59475262, "comment_id": 105154515, "body": "Thanks GMalc - that is much &#39;cleaner&#39; to be sure! Oddly, I&#39;m still running into the issue of the value not updating correctly. I added 2 variables for the x and y cell values, just so I could see the output in the Locals window when I stepped into the code...and it&#39;s still recognizing the values as matching. I&#39;ve re-verified the format of the data in the sheets - have tried Text, General, and Numeric - and it (for some reason) still doesn&#39;t recognize them as being the same. My next step is to copy the data to a new stand-alone workbook and see if it works; maybe the workbook is funky?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 23, "user_id": 10431906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ecde9d69bb64055e3c1f4b324003060?s=128&d=identicon&r=PG&f=1", "display_name": "M. Lamb", "link": "https://stackoverflow.com/users/10431906/m-lamb"}, "edited": false, "score": 0, "creation_date": 1577378684, "post_id": 59475262, "comment_id": 105156502, "body": "@M.Lamb I used your code for the column numbers, you need to check your column numbers and ensure you have the right columns for each worksheet."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1577378432, "last_edit_date": 1577378432, "creation_date": 1577248549, "answer_id": 59475262, "question_id": 59473655, "link": "https://stackoverflow.com/questions/59473655/cross-worksheet-cell-comparison-and-update/59475262#59475262", "title": "Cross-worksheet cell comparison and update", "body": "<pre><code>Sub Profiles()\n    Dim ws1 As Worksheet, ws2 As Worksheet 'Define worksheet variables\n    Dim x As Long, y As Long 'Define last row variables\n\n    'Assign your variables\n    Set ws1 = ThisWorkbook.Sheets(\"UserProf\")\n    Set ws2 = ThisWorkbook.Sheets(\"DeptClasses\")\n\n    For x = 3 To 106 'Just use the last row numbers, unless the lastrow is dynamic\n        For y = 2 To 137 'for each x row loop in ws1 loop through all y rows \n                         'in ws2 until a match is found\n            If ws1.Cells(x, 1).Value = ws2.Cells(y, 5).Value Then\n                ws1.Cells(x, 6).Value = ws2.Cells(y, 5).Value\n            End If\n        Next y\n    Next x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10431906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ecde9d69bb64055e3c1f4b324003060?s=128&d=identicon&r=PG&f=1", "display_name": "M. Lamb", "link": "https://stackoverflow.com/users/10431906/m-lamb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580602382, "creation_date": 1577224277, "last_edit_date": 1580602382, "question_id": 59473655, "link": "https://stackoverflow.com/questions/59473655/cross-worksheet-cell-comparison-and-update", "title": "Cross-worksheet cell comparison and update", "body": "<p>I'm trying to compare the value of one worksheet (\"UserProf\") column to a value in another worksheet (\"DeptClasses\") column. If those values are the same, update a separate cell in the first worksheet with a value from another column from the second worksheet. This will also need to loop through the values in the first worksheet looking for a match. </p>\n\n<p>In essence, if the value in A1 in sheet 1 equals the value in sheet 2's cell D1, or D2, or D3, etc., set the value in cell A2 on sheet 1 to the value in sheet 2's matching row next column (i.e. if D1 in sheet 2 matches sheet 1 A1, set A2 to the value currently in sheet 2's E2 cell, etc.).</p>\n\n<p>Each sheet's column has unique values (no duplicates), and is a number but stored as a text value. I tried changing the format of the cells to Number, with no change in the results. The range of columns in each sheet is fixed (hence setting the \"To lastXxx\" as a fixed integer and not using End(xlUp).Row to set the value.  I've used this approach for other spreadsheets/cross-sheet comparison and it works as I expect. </p>\n\n<p>When troubleshooting, I did add more variables to display in the Locals window in VBA and 'stepped into' the script - that is, see the values that were being evaluated, etc.; from what I can tell the \"If\" statement never evaluates to \"True\" even when I can see in the Locals that the cell values being compared do match. </p>\n\n<p>There may be a more efficient way to set up the range, etc., but this was a way that worked for me in the past, so was trying to keep in that format - mostly because I understand it.</p>\n\n<pre><code>Sub Profiles()\n    Dim lastDepClass As Integer\n    Dim lastClass As Integer\n    Dim DepClass As Integer\n    Dim Class As Integer\n\n    lastDepClass = 137\n    lastClass = 106\n\n    For Class = 3 To lastClass\n        For DepClass = 2 To lastDepClass\n            If Sheets(\"UserProf\").Cells(Class, 1).Value = Sheets(\"DeptClasses\").Cells(DepClass, 5).Value Then\n                Sheets(\"DeptClasses\").Cells(DepClass, 6) = Sheets(\"UserProf\").Cells(DepClass, 5).Value\n            End If\n        Next DepClass\n    Next Class   \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577222419, "post_id": 59473466, "comment_id": 105125352, "body": "Which cells are merged?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577296660, "post_id": 59473466, "comment_id": 105138146, "body": "Perhaps you should delete this question, as it seems like you&#39;ve got it answered elsewhere."}], "owner": {"reputation": 13, "user_id": 11542775, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GqEvqLMfqBw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfoeiPSKK9wfSpGPXaxW8Lg79KLbw/mo/photo.jpg?sz=128", "display_name": "Chatrapal Singh Rathore", "link": "https://stackoverflow.com/users/11542775/chatrapal-singh-rathore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577223360, "creation_date": 1577222272, "last_edit_date": 1577222452, "question_id": 59473466, "link": "https://stackoverflow.com/questions/59473466/error-on-the-s-of-clearcontents-on-the-same-line", "title": "Error on the s of clearcontents on the same line", "body": "<blockquote>\n  <p>VB runtime-error 1004 : \"We can't do that to merged cells\"</p>\n</blockquote>\n\n<p>How can I solve this issue? </p>\n\n<pre><code>Sub Cont_New()\n  With Sheet1\n\n    .Range(\"R33\").Value = True 'Contact Load\n    .Range(\"R32\").Value = True 'New Contact to True\n    .Range(\"D7,D9,D11\").ClearContents\n    .Shapes(\"ExistContGrp\").Visible = msoFalse\n    .Shapes(\"NewContGrp\").Visible = msoTrue\n    .Range(\"R33\").Value = False 'COntact Load to False\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577222896, "post_id": 59473097, "comment_id": 105125422, "body": "What version of Excel? I can&#39;t reproduce this."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1577227564, "post_id": 59473097, "comment_id": 105126165, "body": "Are your cells colored using conditional formatting?  If Yes then you need to use <code>ws.Range(&quot;L&quot; &amp; k).DisplayFormat.Interior.Color</code> to get the fill color."}, {"owner": {"reputation": 11, "user_id": 12465598, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-O73YU915c5Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reibyyExmusBTRkmV7U3Bddjn1WTA/photo.jpg?sz=128", "display_name": "C.J. Miller", "link": "https://stackoverflow.com/users/12465598/c-j-miller"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1577371860, "post_id": 59473097, "comment_id": 105154227, "body": "@TimWilliams ws.Range(&quot;L&quot; &amp; k).DisplayFormat.Interior.Color worked! Thank you so much"}], "owner": {"reputation": 11, "user_id": 12465598, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-O73YU915c5Q/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reibyyExmusBTRkmV7U3Bddjn1WTA/photo.jpg?sz=128", "display_name": "C.J. Miller", "link": "https://stackoverflow.com/users/12465598/c-j-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1577219548, "creation_date": 1577218717, "last_edit_date": 1577219548, "question_id": 59473097, "link": "https://stackoverflow.com/questions/59473097/rgb-values-of-cells-do-not-update-after-color-sort", "title": "RGB Values of Cells Do Not Update after Color Sort", "body": "<p>I'm currently working on a Microsoft Excel to Word Macro and It's going good except I'm running into one small problem. In my excel sheet I execute a sorting macro that sorts by RBG values. <code>(Red to Top, Yellow to Middle, Green to Bottom)</code>. It sorts correctly and looks perfect on the excel sheet, but when I go to check the cell RGB value in Visual Basic the RGB values held in each cell is still the value before the sort. For example If:</p>\n\n<pre><code>A(1)Y                 A(1)R\nA(2)R  Is sorted to   A(2)Y\nA(3)G                 A(3)G\n</code></pre>\n\n<p>Which looks correct in excel, but the RGB values of the cells after the sort don't update.\nSo A(1) RGB value after sort would still be <code>(255,255,0) Yellow</code> instead of <code>(255,0,0) Red</code>.</p>\n\n<p>Here is my sorting macro, along with the code that checks for the RGB Values of sorted cells</p>\n\n<pre><code>    ' sorting Macro\n\n    Range(\"A7:L12\").Select\n    ActiveWorkbook.Worksheets(\"Risk Register\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Risk Register\").Sort.SortFields.Add(Range(\"L7:L12\") _\n        , xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(255, _\n        0, 0)\n    ActiveWorkbook.Worksheets(\"Risk Register\").Sort.SortFields.Add(Range(\"L7:L12\") _\n        , xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(255, _\n        255, 0)\n    ActiveWorkbook.Worksheets(\"Risk Register\").Sort.SortFields.Add(Range(\"L7:L12\") _\n        , xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(0, _\n        255, 0)\n    With ActiveWorkbook.Worksheets(\"Risk Register\").Sort\n        .SetRange Range(\"A6:L12\")\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n</code></pre>\n\n<p>Here is the code where I check the RGB Values of specified cells:</p>\n\n<blockquote>\n  <p>In this case I'm checking for red</p>\n</blockquote>\n\n<pre><code>k = 7\nWith wrdDoc\n\n    If (displayRisk = 3) Then 'Don't worry about this line (is working properly)\n\n        Do Until k = (6 + myValue) 'Don't worry about this line (is working properly)\n\n            ' Verifying that I'm Checking Correct Cell\n            Debug.Print \"L\" &amp; k &amp; \"\"\n\n            ' Here is where I check the RGB Value of specified cell\n            If ws.Range(\"L\" &amp; k).Interior.Color = RGB(255, 0, 0) Then\n\n                do something...\n\n            End If\n        k = k + 1\n        Loop\nEnd With\n</code></pre>\n\n<p>Once again in this case:</p>\n\n<pre><code>A(1)Y                 A(1)R\nA(2)R  Is sorted to   A(2)Y\nA(3)G                 A(3)G\n</code></pre>\n\n<p>The result of the macro execution would only \"do something\" for cell A(2) because that was the cell who's background color was Red before the sort.</p>\n\n<p>The macro <strong>SHOULD</strong> \"do something\" for cell A(1) (after sort) because that is where the red cell was sorted to. I've been searching awhile for a solution for this and haven't been able to find anything.</p>\n\n<p>My hopes and initial thought to fix this was to somehow create a macro that would be able to \"update\" the cells after the sort.</p>\n\n<p>By the way, I know that my code does not match with the example I gave. </p>\n\n<blockquote>\n  <p>IMPORTANT: After the sort- If I were to go to the sorted cells and \"re-update\" their color <code>(Literally pressing their fill to the same color it appears on excel)</code>, the code where I check for the cell's <code>RGB Value</code> then works perfectly.</p>\n</blockquote>\n\n<p>Hope that was clear ^</p>\n"}, {"tags": ["vba", "powershell", "methods", "parameters"], "comments": [{"owner": {"reputation": 33825, "user_id": 9898643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9f303fda4c69e9c9ce6b84a6268402?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9898643/theo"}, "edited": false, "score": 0, "creation_date": 1577204651, "post_id": 59470885, "comment_id": 105121222, "body": "If you look <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.presentation.createvideo\" rel=\"nofollow noreferrer\">here</a>, you will find that quality is the 6th parameter and that parameters 3,4,5 and 6 are all INT, and yes, <code>Quality</code> is a percentage, so 1-100"}, {"owner": {"reputation": 1, "user_id": 12591880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124adfde93550994858614a2c8edf742?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Owens", "link": "https://stackoverflow.com/users/12591880/samuel-owens"}, "reply_to_user": {"reputation": 33825, "user_id": 9898643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9f303fda4c69e9c9ce6b84a6268402?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9898643/theo"}, "edited": false, "score": 0, "creation_date": 1577222587, "post_id": 59470885, "comment_id": 105125377, "body": "Cool, I&#39;ve missed off the last parameter \ud83e\udd26\u200d\u2642\ufe0f!  Do you know if there is a way to find out what the potential values for INT parameters"}, {"owner": {"reputation": 33825, "user_id": 9898643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9f303fda4c69e9c9ce6b84a6268402?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9898643/theo"}, "edited": false, "score": 0, "creation_date": 1577226906, "post_id": 59470885, "comment_id": 105126081, "body": "I think the link I put in the comment explains the meaning of these as well"}, {"owner": {"reputation": 1, "user_id": 12591880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124adfde93550994858614a2c8edf742?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Owens", "link": "https://stackoverflow.com/users/12591880/samuel-owens"}, "reply_to_user": {"reputation": 33825, "user_id": 9898643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9f303fda4c69e9c9ce6b84a6268402?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9898643/theo"}, "edited": false, "score": 0, "creation_date": 1577436484, "post_id": 59470885, "comment_id": 105169253, "body": "Thanks, I have seen that link before and I did put it in my original post.  I just didn&#39;t know if there was a way to find out the valid parameter values for this and other methods going forward"}], "owner": {"reputation": 1, "user_id": 12591880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124adfde93550994858614a2c8edf742?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Owens", "link": "https://stackoverflow.com/users/12591880/samuel-owens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577201740, "creation_date": 1577201740, "question_id": 59470885, "link": "https://stackoverflow.com/questions/59470885/office-vba-method-parameters-powershell", "title": "Office VBA method parameters (powershell)", "body": "<p>I am creating a script to manipulate some PowerPoint presentation files.  One of the methods I need to use is the createvideo method.</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.presentation.createvideo\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/powerpoint.presentation.createvideo</a></p>\n\n<p>The above link show the parameters and their type, but I don't know what the ranges are</p>\n\n<p>e.g.</p>\n\n<p>Quality is INT, but is it 1-100?  I don't really want to find out through trial and error!</p>\n\n<p>Is there a really easy way to find out this information.</p>\n\n<p>Below is a snippet of the script I am running</p>\n\n<pre><code>$powerpoint = New-Object -comobject powerpoint.Application\n$powerpoint.visible = [Microsoft.Office.Core.MsoTriState]::msoTrue\n\n$powerpoint.Presentations.Open(\"C:\\temp\\file.ppt\")\n$SavePath = \"C:\\temp\\Presentation.mp4\"\n$powerpoint.ActivePresentation.CreateVideo($savepath,$true,\"\",1540,30)\n</code></pre>\n\n<p>The 30 is the quality parameter.</p>\n\n<p>Thoughts welcome.</p>\n\n<p>Sam</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1577200772, "post_id": 59470695, "comment_id": 105120066, "body": "What have you tried? This should be relatively easy with a loop/VBA to delete matching rows. (Or, use a filter)."}, {"owner": {"reputation": 546, "user_id": 3869484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LJ3Z0.jpg?s=128&g=1", "display_name": "Richard Crossley", "link": "https://stackoverflow.com/users/3869484/richard-crossley"}, "edited": false, "score": 1, "creation_date": 1577201445, "post_id": 59470695, "comment_id": 105120273, "body": "I don&#39;t think a filter would actually delete the rows, just remove them from the visible portion of the spreadsheet. Maybe if the visible rows could be copied to a VBA array, the filter removed and the rows replaced from the array it might work."}, {"owner": {"reputation": 6992, "user_id": 495157, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UFMPn.png?s=128&g=1", "display_name": "JGFMK", "link": "https://stackoverflow.com/users/495157/jgfmk"}, "edited": false, "score": 0, "creation_date": 1577201851, "post_id": 59470695, "comment_id": 105120401, "body": "I think closing this question was a bit harsh. Could potentially have answered this to meet needs of op. <a href=\"https://docs.google.com/spreadsheets/d/1wYis8B0ujoozEbRDBZIkhxk45cfDm8016vRzFQtH27s/edit?usp=sharing\" rel=\"nofollow noreferrer\">docs.google.com/spreadsheets/d/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 12591649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e720fc3b7df78c5a752e2c9e935bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Isabela", "link": "https://stackoverflow.com/users/12591649/isabela"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1577307115, "post_id": 59470695, "comment_id": 105139987, "body": "@BruceWayne I do think it was unfair to close this post. I am new to VBA, so what might seem easy for you, for me is not"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1577307562, "post_id": 59470695, "comment_id": 105140062, "body": "@Isabela I didn&#39;t vote to close this, IIRC. That being said, SO isn&#39;t a code-writing site. We&#39;re here to help you with existing code/formulas. Have you attempted to solve this on your end? If so, update your question with that attempt and any errors that we can help troubleshoot."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1577321465, "post_id": 59470695, "comment_id": 105141949, "body": "You need to qualify th <code>Cells()</code> in the lastRow declaration to refer to Sheet1, add <code>.</code> before <code>Cells()</code>, otherwise it&#39;ll use whatever the ActiveSheet is to set that."}, {"owner": {"reputation": 13, "user_id": 12591649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e720fc3b7df78c5a752e2c9e935bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Isabela", "link": "https://stackoverflow.com/users/12591649/isabela"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1577397176, "post_id": 59470695, "comment_id": 105161626, "body": "@BruceWayne Thank you for your suggestion. I have tried it, but I get an error message. Luckily the code shared below by hod is working"}], "answers": [{"tags": [], "owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "is_accepted": true, "score": 1, "last_activity_date": 1577342017, "last_edit_date": 1577342017, "creation_date": 1577340769, "answer_id": 59484499, "question_id": 59470695, "link": "https://stackoverflow.com/questions/59470695/how-to-remove-holidays-from-a-range-of-dates/59484499#59484499", "title": "How to remove holidays from a range of dates?", "body": "<p>Try this:</p>\n\n<pre><code>Sub RemoveDates()\n\nDim RemovalList()\n\nSheetOneLastRow = Sheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp).Row\nSheetTwoLastRow = Sheets(\"Sheet2\").Cells(Rows.Count, \"A\").End(xlUp).Row\nCount = 0\n\n'Collect all the dates that need to be removed into a list\nFor r = 1 To SheetTwoLastRow\n    ReDim Preserve RemovalList(0 To Count)\n    RemovalList(Count) = Sheets(\"Sheet2\").Range(\"A\" &amp; r).Value\n    Count = Count + 1\nNext\n\nFor r = SheetOneLastRow To 1 Step -1\n    If IsInArray(Range(\"A\" &amp; r).Value, RemovalList) Then\n        Sheets(\"Sheet1\").Range(\"A\" &amp; r).Delete\n    End If\nNext\n\nEnd Sub\n\n\nFunction IsInArray(SearchFor As String, MyArray As Variant) As Boolean\n    Dim st As String\n    st = \"$\" &amp; Join(MyArray, \"$\") &amp; \"$\"\n    IsInArray = InStr(st, \"$\" &amp; SearchFor &amp; \"$\") &gt; 0\nEnd Function\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 13, "user_id": 12591649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e720fc3b7df78c5a752e2c9e935bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Isabela", "link": "https://stackoverflow.com/users/12591649/isabela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 59484499, "answer_count": 1, "score": -3, "last_activity_date": 1580626903, "creation_date": 1577200497, "last_edit_date": 1580626903, "question_id": 59470695, "link": "https://stackoverflow.com/questions/59470695/how-to-remove-holidays-from-a-range-of-dates", "title": "How to remove holidays from a range of dates?", "body": "<p>I have a list of dates in Column A (Sheet1) and I would like to delete the entire row that matches any of the holidays dates found in Sheet2. For example:</p>\n\n<p><strong>Dates(Column A,Sheet1)</strong></p>\n\n<pre><code>23/12/2019                                \n24/12/2019                                \n25/12/2019\n26/12/2019\n27/12/2019\n28/12/2019\n29/12/2019\n</code></pre>\n\n<p><strong>Holidays(Column A,Sheet2)</strong></p>\n\n<pre><code>25/12/2019\n26/12/2019\n</code></pre>\n\n<p>The rows containing 25th and 26th of December in Sheet 1 should be deleted. Also, there may be months when there are no holidays to be deleted.</p>\n\n<p>I tried the code below. The loop seems to be working, but no rows are deleted.</p>\n\n<pre><code>With Sheets(\"Sheet1\")\n    lastrow = Cells(Rows.Count, 1).End(xlUp).Row\n For i = lastrow To 7 Step -1\n    If Not IsError(Application.Match(Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value, \n         Sheets(\"Sheet2\").Columns(\"A\"), 0)) Then \n         Sheets(\"Sheet1\").Rows(i).Delete\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": ["python", "vba", "windows"], "comments": [{"owner": {"reputation": 15007, "user_id": 389289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33eab2fa999a20910a29e4a2299bc174?s=128&d=identicon&r=PG&f=1", "display_name": "zvone", "link": "https://stackoverflow.com/users/389289/zvone"}, "edited": false, "score": 0, "creation_date": 1577201169, "post_id": 59470610, "comment_id": 105120196, "body": "If you have multiple pythons installed, no tool can guess which one you want. You have to simply know where it is."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 12565353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad0f20603c2329dea1608f10f50bbc4?s=128&d=identicon&r=PG&f=1", "display_name": "kostinalex", "link": "https://stackoverflow.com/users/12565353/kostinalex"}, "edited": false, "score": 0, "creation_date": 1577204428, "post_id": 59470794, "comment_id": 105121173, "body": "Doesn&#39;t work. Anaconda prompt says &quot;SyntaxError: invalid syntax&quot; in both cases (where python and where anaconda)"}, {"owner": {"reputation": 288, "user_id": 12532130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ODzqR.jpg?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/12532130/jason"}, "reply_to_user": {"reputation": 35, "user_id": 12565353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad0f20603c2329dea1608f10f50bbc4?s=128&d=identicon&r=PG&f=1", "display_name": "kostinalex", "link": "https://stackoverflow.com/users/12565353/kostinalex"}, "edited": false, "score": 0, "creation_date": 1577205054, "post_id": 59470794, "comment_id": 105121312, "body": "I would suggest uninstalling the Python you do not use to avoid confusion first, then try reinstalling Anaconda, or try to search for it in your files. You have to set the path in Windows first or else nothing will work."}], "tags": [], "owner": {"reputation": 288, "user_id": 12532130, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ODzqR.jpg?s=128&g=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/12532130/jason"}, "is_accepted": false, "score": 1, "last_activity_date": 1577201113, "creation_date": 1577201113, "answer_id": 59470794, "question_id": 59470610, "link": "https://stackoverflow.com/questions/59470610/how-to-get-python-exe-path-from-cmd/59470794#59470794", "title": "How to get python.exe path from cmd?", "body": "<p>In either cmd or the Anaconda prompt, You can find the location of your Python.exe using: </p>\n\n<pre><code>where python\n</code></pre>\n\n<p>You could also try:</p>\n\n<pre><code>where anaconda\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 12565353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ad0f20603c2329dea1608f10f50bbc4?s=128&d=identicon&r=PG&f=1", "display_name": "kostinalex", "link": "https://stackoverflow.com/users/12565353/kostinalex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577204710, "creation_date": 1577200072, "last_edit_date": 1577204710, "question_id": 59470610, "link": "https://stackoverflow.com/questions/59470610/how-to-get-python-exe-path-from-cmd", "title": "How to get python.exe path from cmd?", "body": "<p>I have two pythons installed to my computer. One is a separate version, another is a part of Anaconda package. I use the one which comes with Anaconda (I use Spyder to run it), because the other one doesn't have win32api and so on.</p>\n\n<p>I need to find out the location of python.exe that Spyder is using when it runs the script.</p>\n\n<p>My aim is to run the py script from excel VBA using the code:</p>\n\n<pre><code>Sub RunPython()\n\nDim objShell As Object\nDim PythonExe, PythonScript As String\n\nSet objShell = VBA.CreateObject(\"Wscript.Shell\")\n\nPythonExe = \"\"\"C:\\Users\\EEEEEEEEEEEEE\\AppData\\Local\\Continuum\\anaconda3\\lib\\os.py\"\"\"\nPythonScript = \"\"\"//fileh01/home$/EEEEEEEEEEEEE/Desktop/Python/test.py\"\"\"\n\nobjShell.Run PythonExe &amp; PythonScript\n\nEnd Sub\n</code></pre>\n\n<p>If I go to anaconda prompt and type <code>python //fileh01/home$/EEEEEEEEEEEEE/Desktop/Python/test.py</code> everything works. But when I run code from VBA, nothing happens.</p>\n"}, {"tags": ["excel", "vba", "sum", "range"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1577199804, "post_id": 59470533, "comment_id": 105119740, "body": "&quot;add sum formula if cell contains Number...&quot;  So you&#39;re saying you want to replace the number with a formula?"}, {"owner": {"reputation": 23, "user_id": 12585774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J218b.gif?s=128&g=1", "display_name": "Mr. Englander", "link": "https://stackoverflow.com/users/12585774/mr-englander"}, "reply_to_user": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1577200503, "post_id": 59470533, "comment_id": 105119964, "body": "Where I have totals (highlighted in blue), I need it to sum the numbers just above."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1577200841, "post_id": 59470533, "comment_id": 105120085, "body": "With the data, could you just use a Pivot Table?  I&#39;d venture to say that a formula to do what you want might work, but you&#39;d be better off trying to put the raw data together so you can use a Pivot Table which is much more dynamic."}, {"owner": {"reputation": 23, "user_id": 12585774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J218b.gif?s=128&g=1", "display_name": "Mr. Englander", "link": "https://stackoverflow.com/users/12585774/mr-englander"}, "edited": false, "score": 0, "creation_date": 1577201225, "post_id": 59470533, "comment_id": 105120210, "body": "I create a pivot table and then the Excel output.  Why? Because people will add comments to it, add lines, update figures etc; so I need something &quot;flexible&quot;. I could add SUM manually, but it is time-consuming and I am quite sure that people will add lines and not adjust the formula, so I would have to do this check myself."}, {"owner": {"reputation": 929, "user_id": 532962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250a89b3acecc19bb245ddfb63b29a7b?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/532962/sean"}, "edited": false, "score": 0, "creation_date": 1577205761, "post_id": 59470533, "comment_id": 105121482, "body": "If you use VBA to loop through the rows to evaluate the string in Column D, you could add the SUM formula each time you hit a line that contains &quot;Total&quot;.  The SUM formula will update to include any lines added above it - if they are within the formula&#39;s range, right?"}, {"owner": {"reputation": 23, "user_id": 12585774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J218b.gif?s=128&g=1", "display_name": "Mr. Englander", "link": "https://stackoverflow.com/users/12585774/mr-englander"}, "reply_to_user": {"reputation": 929, "user_id": 532962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250a89b3acecc19bb245ddfb63b29a7b?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/532962/sean"}, "edited": false, "score": 0, "creation_date": 1577259515, "post_id": 59470533, "comment_id": 105130078, "body": "@Sean, This is what I am thinking on doing. The issue is that I don&#39;t know how (or even if it is possible) to say &#39;add sum when line has total, stop SUM -1 line before next total)"}], "owner": {"reputation": 23, "user_id": 12585774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J218b.gif?s=128&g=1", "display_name": "Mr. Englander", "link": "https://stackoverflow.com/users/12585774/mr-englander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580483984, "creation_date": 1577199594, "last_edit_date": 1580483984, "question_id": 59470533, "link": "https://stackoverflow.com/questions/59470533/sum-for-different-ranges", "title": "SUM for different ranges", "body": "<p>I have a file where I create a Pivot Table, I copy &amp; paste, and then format it.</p>\n\n<p>The issue: Instead of Value I need the totals to be a formula (users will update figures and add lines to it). </p>\n\n<p>I did it manually in the past (added a sum on each total). </p>\n\n<p>Is there another option? I was thinking on the lines of \"add sum formula if cell contains Number and it is Blue; sum all not coloured cells above it\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/mddBY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mddBY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1577283540, "post_id": 59470431, "comment_id": 105135367, "body": "Hi, how do you implement a drop-down in column F is it through Data Validation? And is there any chance to see the screenshot of how it should look like, &#39;cos I can&#39;t understand what &quot;mirroring&quot; is?"}, {"owner": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "reply_to_user": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1577314859, "post_id": 59470431, "comment_id": 105141228, "body": "Yes, for F, I used data validation. I\u2019ll also post a picture, but when I say \u201cmirroring\u201d, I mean I need each cell in F to copy&amp;paste or replicate the items selected in F into G. So if I choose apples, bananas, oranges in F, I need apples, bananas, oranges to appear in G, just as it appears in F. A carbon copy of the cells in F, but I just need to be able to edit or comment in the cells in G for each item selected in F that appears in G. I also need to be able to add items in F after I make the comments in G, and make that newly selected item in F to appear in G. I hope that wasn\u2019t confusing."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1577389574, "post_id": 59482541, "comment_id": 105159784, "body": "Hi EMF, Thank you so much for your comment. I tried inputting your code into the macro, and the issue at hand got fixed (Thank you!) When you select an item in F, the code will not override any comments in G and only newly added items appear in G as well without any duplication/re-mirroring of the previously selected items. But the issue now is, although the column G works great, Column F can no longer select multiple drop down items. Instead of being able to select Apples, Bananas, and Oranges, one can only select one of the three. But Interestingly enough, Column G functions correctly."}, {"owner": {"reputation": 62, "user_id": 4842667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nCm6R.jpg?s=128&g=1", "display_name": "EMF", "link": "https://stackoverflow.com/users/4842667/emf"}, "reply_to_user": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1577390888, "post_id": 59482541, "comment_id": 105160154, "body": "@237Fan: Column G gets updated each time a selection is made, adding the most recent selection to the existing content, if it is not already present. Data validation lists don&#39;t allow multiple selections. Are you using something like <a href=\"https://trumpexcel.com/select-multiple-items-drop-down-list-excel/\" rel=\"nofollow noreferrer\">trumpexcel.com/select-multiple-items-drop-down-list-excel</a> to fake a multiselect dropdown list? If so, let me know and I&#39;ll add a section to my code to handle that."}, {"owner": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1577392984, "post_id": 59482541, "comment_id": 105160644, "body": "Yes! I apologize for not clarifying that part. I actually used a modified version of what I found from the site you provided (The VBA Code to allow Multiple Selections in a Drop-down List (without repetition)): I found a modified version of this code where if you select multiple dropdown items such as Apples, Bananas, and Oranges for example, and I didn&#39;t want Apples anymore, I would click Apples again in the dropdown, and it would deselect Apples from the list. This is shown in the top part of the code I posted. If you wouldn&#39;t mind, I would like this included in the code, Thank you!"}, {"owner": {"reputation": 62, "user_id": 4842667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nCm6R.jpg?s=128&g=1", "display_name": "EMF", "link": "https://stackoverflow.com/users/4842667/emf"}, "reply_to_user": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1577429063, "post_id": 59482541, "comment_id": 105167331, "body": "@237Fan: I edited my answer to accommodate the multiselect dropdown hack and to handle Excel&#39;s linefeed behavior."}, {"owner": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1577468698, "post_id": 59482541, "comment_id": 105180929, "body": "Thank you very, very much! I&#39;ve tried the code couple times and it works great. I can not thank you enough."}, {"owner": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1578507119, "post_id": 59482541, "comment_id": 105464539, "body": "Hello! Thank you so much for helping me with this post. If you have time, I actually had another question regarding this code. I now need to replicate the Column F to G &quot;Re-Mirroring&quot; with Column H and I as well. So if I choose an item in F, all three G, H, and I would also &quot;mirror&quot; the chosen item from F. I thought this would be a fairly simple change by copying &quot;  &#39;Process Mirrored Values (G)  &quot; section of the code, and just adding a new Dim instead of strOldVal and new integer instead of i for Column H and I.  (Continued...)"}, {"owner": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1578507395, "post_id": 59482541, "comment_id": 105464694, "body": "This re-copying this code section worked to a certain extent: Now if I select items in F, the item will populate in Column G, H, and I. But now every time I delete the whole list in a certain cell in column F, all items and comments are deleted in column H and I as well. Strangely enough, Column G does not get affected with the deletion in F. I was wondering if you knew a way to stop Column H and I to stop deleting if I delete out F, and get the two columns to remain like Column G."}, {"owner": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1578508034, "post_id": 59482541, "comment_id": 105464993, "body": "I have also posted the new code in the original post, please let me know if you need clarifications or if you have any questions. Thank you very very much"}, {"owner": {"reputation": 62, "user_id": 4842667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nCm6R.jpg?s=128&g=1", "display_name": "EMF", "link": "https://stackoverflow.com/users/4842667/emf"}, "reply_to_user": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1578599156, "post_id": 59482541, "comment_id": 105500983, "body": "I&#39;m not in a place when I can test this right now, but just at a glance, I see that you missed updating a couple of variables in the copies. Fix the two places where the copies still say &quot;If strOldVal &lt;&gt; &quot;&quot; Then&quot; and let me know if that changes the behavior."}, {"owner": {"reputation": 62, "user_id": 4842667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nCm6R.jpg?s=128&g=1", "display_name": "EMF", "link": "https://stackoverflow.com/users/4842667/emf"}, "reply_to_user": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1578602404, "post_id": 59482541, "comment_id": 105502276, "body": "You&#39;re welcome. BTW, unaccepting the answer because you changed the parameters of your question after the fact is not the way to inspire people to provide additional help. Something to consider if you intend to keep using StackOverflow."}, {"owner": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "edited": false, "score": 0, "creation_date": 1578602921, "post_id": 59482541, "comment_id": 105502466, "body": "Thank you for the feedback, I apologize about that, I&#39;m very new to this site, and I was not aware that if I edit the original question/code, the answer acceptance seem to not stay. Was not my intention to undermine, I apologize about that!"}], "tags": [], "owner": {"reputation": 62, "user_id": 4842667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nCm6R.jpg?s=128&g=1", "display_name": "EMF", "link": "https://stackoverflow.com/users/4842667/emf"}, "is_accepted": true, "score": 0, "last_activity_date": 1577429001, "last_edit_date": 1577429001, "creation_date": 1577316366, "answer_id": 59482541, "question_id": 59470431, "link": "https://stackoverflow.com/questions/59470431/conditional-mirroring-of-a-column-to-another-column/59482541#59482541", "title": "Conditional Mirroring of A Column to another Column", "body": "<p>Give something like this a try:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim strBreak As String\nDim strAddVal As String\nDim strOldChosen As String\nDim strNewChosen As String\nDim strOldVal As String\nDim strNewVal As String\nDim blnAddVal As Boolean\nDim arrLines() As String\n\n    If Target.Count = 1 Then\n        If Target.Column = 6 Then\n            If Target.SpecialCells(xlCellTypeSameValidation).Cells.Count &gt; 0 Then\n                If Not IsNull(Target.Value) And Target.Value &lt;&gt; \"\" Then\n                    Application.EnableEvents = False\n                    strAddVal = Target.Value\n                    strOldVal = Cells(Target.Row, Target.Column + 1).Value\n                    Application.Undo\n                    strOldChosen = Target.Value\n\n                    ' Process Chosen Values (F)\n                    strBreak = \"\"\n                    blnAddVal = True\n                    strNewChosen = \"\"\n                    If strOldChosen &lt;&gt; \"\" Then\n                        arrLines = Split(strOldChosen, vbLf, , vbTextCompare)\n                        For Each strLine In arrLines\n                            If strLine = strAddVal Then\n                                blnAddVal = False\n                            Else\n                                strNewChosen = strNewChosen &amp; strBreak &amp; strLine\n                                If strBreak = \"\" Then strBreak = vbLf\n                            End If\n                        Next\n                    End If\n                    If blnAddVal = True Then\n                        strNewChosen = strNewChosen &amp; strBreak &amp; strAddVal\n                    End If\n                    Target.Value = strNewChosen\n\n                    ' Process Mirrored Values (G)\n                    strBreak = \"\"\n                    blnAddVal = True\n                    If strOldVal &lt;&gt; \"\" Then\n                        strBreak = vbLf\n                        arrLines = Split(strOldVal, vbLf, , vbTextCompare)\n                        Dim i As Integer\n                        i = 1\n                        For Each strLine In arrLines\n                            If strLine Like (strAddVal &amp; \"*\") Then\n                                blnAddVal = False\n                            End If\n                        Next\n                    End If\n                    If blnAddVal = True Then\n                        strNewVal = strOldVal &amp; strBreak &amp; strAddVal\n                        Cells(Target.Row, Target.Column + 1).Value = strNewVal\n                    End If\n                    Application.EnableEvents = True\n                End If\n            End If\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12591605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4f333405ef14abc2d9e2592b5a2469?s=128&d=identicon&r=PG&f=1", "display_name": "237 Fan", "link": "https://stackoverflow.com/users/12591605/237-fan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 59482541, "answer_count": 1, "score": 0, "last_activity_date": 1578507986, "creation_date": 1577199023, "last_edit_date": 1578507986, "question_id": 59470431, "link": "https://stackoverflow.com/questions/59470431/conditional-mirroring-of-a-column-to-another-column", "title": "Conditional Mirroring of A Column to another Column", "body": "<p>I am stuck trying to figure out this problem. To simplify what I am trying to do, I am basically trying to make Column F an drop down list (Ex:Apples, Bananas, Oranges, Mango, etc), where the user can choose multiple items from the drop down list with a line break, and whatever drop down item chosen in Column F would \u201cmirror\u201d or replicate into Column G. So for example:</p>\n\n<p>Column F:</p>\n\n<pre><code>Apples\n\nBananas\n\nOranges\n</code></pre>\n\n<p>And in Column G:</p>\n\n<pre><code>Apples\n\nBananas\n\nOranges\n</code></pre>\n\n<p>Now, in Column G, I need to be able to write notes in for each item chosen in F. So with the example above:</p>\n\n<p>Column G:</p>\n\n<pre><code>Apples: Round and Red\n\nBananas: Long and Yellow\n\nOranges: Round and Orange\n</code></pre>\n\n<p>I do not want whatever comments I write in Column G to replicate into Column F.<br>\nWhat I'm having trouble with is when I need to add another item in to Column F, for example Mango, the mirroring effect recopies all the drop down items previously selected in Column F.\nFor example:</p>\n\n<p>Column F:</p>\n\n<pre><code>Apples\n\nBananas\n\nOranges\n\nMango (*newly added*)\n</code></pre>\n\n<p>Column G:</p>\n\n<pre><code>Apples: Round and Red\n\nBananas: Long and Yellow\n\nOranges: Round and Orange\n\nApples\n\nBananas\n\nOranges\n\nMango\n</code></pre>\n\n<p>It does this re-mirroring every time you add an item in. I basically need the VBA code to just add Mango and not re-mirror the previous drop down items into Column G. \nNote: If I take out an item in Column F, I don\u2019t need the item and the comment to disappear from Column G. I just need the additions from Column F to appear into Column G without the other items reappearing.</p>\n\n<p>Below is my code so far:</p>\n\n<pre><code>Private Sub\nWorksheet_Change(ByVal Target As  Range)\n    Dim oldVal As String, newVal     As String\n    Dim i As Long\n    Dim bMatch As Boolean\n    Dim vItems As Variant\n\n\n    If Target.Count &gt; 1 Or _\n        Target.Column &lt;&gt; 6 Then GoTo exitHandler\n\n\n    On Error Resume Next\n    If Target.SpecialCells(xlCellTypeSameValidation).Cells.Count = 0 _\n        Then Exit Sub\n    On Error GoTo exitHandler\n\n\n    Application.EnableEvents = False\n    newVal = Target.Value\n    Application.Undo\n    oldVal = Target.Value\n    Target.Value = newVal\n\n\n    If oldVal = \"\" Or newVal = \"\" Then GoTo exitHandler\n\n\n    vItems = Split(oldVal, vbNewLine)\n    For i = 0 To UBound(vItems)\n          If vItems(i) = newVal Then\n              bMatch = True\n              vItems(i) = \"~Filter Out~\"\n          End If\n    Next i\n    If bMatch Then  'remove item\n          vItems = Filter(vItems, \"~Filter Out~\", Include:=False, _\n              Compare:=vbTextCompare)\n          Target.Value = Join(vItems, vbNewLine)\n    Else   'append item\n        Target.Value = oldVal &amp; vbNewLine &amp; newVal\n    End If\n\nIf Target.Column = 6 Then 'it's a column F value that changed\nDim OnlyAddNew As Boolean\nOnlyAddNew = InStr(1, Cells(Target.Row, Target.Column + 1), Cells(Target.Row, Target.Column), vbTextCompare) &gt; 0\nIf OnlyAddNew = True Then\nSelection.clearcontent\nEnd If\nIf OnlyAddNew = False Then\nCells(Target.Row, Target.Column + 1) = Cells(Target.Row, Target.Column + 1) &amp; vbNewLine &amp; Cells(Target.Row, Target.Column)\nEnd If\nEnd If\n\n\n\nexitHandler:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>I hope I explained everything well. Please comment if you do not understand my goal/my actions.\nI sincerely appreciate your help in advance.</p>\n\n<hr>\n\n<p>Additional Question: Mirroring Column F into Column H and I as well:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim strBreak As String\nDim strAddVal As String\nDim strOldChosen As String\nDim strNewChosen As String\nDim strOldVal As String\nDim strOldOldVal As String\nDim strOldOldOldVal As String\nDim strNewVal As String\nDim blnAddVal As Boolean\nDim arrLines() As String\n\n    If Target.Count = 1 Then\n        If Target.Column = 6 Then\n            If Target.SpecialCells(xlCellTypeSameValidation).Cells.Count &gt; 0 Then\n                If Not IsNull(Target.Value) And Target.Value &lt;&gt; \"\" Then\n                    Application.EnableEvents = False\n                    strAddVal = Target.Value\n                    strOldVal = Cells(Target.Row, Target.Column + 1).Value\n                    strOldOldVal = Cells(Target.Row, Target.Column + 2).Value\n                    strOldOldOldVal = Cells(Target.Row, Target.Column + 3).Value\n                    Application.Undo\n                    strOldChosen = Target.Value\n\n                    ' Process Chosen Values (F)\n                    strBreak = \"\"\n                    blnAddVal = True\n                    strNewChosen = \"\"\n                    If strOldChosen &lt;&gt; \"\" Then\n                        arrLines = Split(strOldChosen, vbLf, , vbTextCompare)\n                        For Each strLine In arrLines\n                            If strLine = strAddVal Then\n                                blnAddVal = False\n                            Else\n                                strNewChosen = strNewChosen &amp; strBreak &amp; strLine\n                                If strBreak = \"\" Then strBreak = vbLf\n                            End If\n                        Next\n                    End If\n                    If blnAddVal = True Then\n                        strNewChosen = strNewChosen &amp; strBreak &amp; strAddVal\n                    End If\n                    Target.Value = strNewChosen\n\n                    ' Process Mirrored Values (G)\n                    strBreak = \"\"\n                    blnAddVal = True\n                    If strOldVal &lt;&gt; \"\" Then\n                        strBreak = vbLf\n                        arrLines = Split(strOldVal, vbLf, , vbTextCompare)\n                        Dim i As Integer\n                        i = 1\n                        For Each strLine In arrLines\n                            If strLine Like (strAddVal &amp; \"*\") Then\n                                blnAddVal = False\n                            End If\n                        Next\n                    End If\n                    If blnAddVal = True Then\n                        strNewVal = strOldVal &amp; strBreak &amp; strAddVal\n                        Cells(Target.Row, Target.Column + 1).Value = strNewVal\n                    End If\n                End If\n                     ' Process Mirrored Values (H)\n                    strBreak = \"\"\n                    blnAddVal = True\n                    If strOldVal &lt;&gt; \"\" Then\n                        strBreak = vbLf\n                        arrLines = Split(strOldOldVal, vbLf, , vbTextCompare)\n                        Dim y As Integer\n                        y = 1\n                        For Each strLine In arrLines\n                            If strLine Like (strAddVal &amp; \"*\") Then\n                                blnAddVal = False\n                            End If\n                        Next\n                    End If\n                    If blnAddVal = True Then\n                        strNewVal = strOldOldVal &amp; strBreak &amp; strAddVal\n                        Cells(Target.Row, Target.Column + 2).Value = strNewVal\n                    End If\n                End If\n                     ' Process Mirrored Values (i)\n                    strBreak = \"\"\n                    blnAddVal = True\n                    If strOldVal &lt;&gt; \"\" Then\n                        strBreak = vbLf\n                        arrLines = Split(strOldOldOldVal, vbLf, , vbTextCompare)\n                        Dim r As Integer\n                        r = 1\n                        For Each strLine In arrLines\n                            If strLine Like (strAddVal &amp; \"*\") Then\n                                blnAddVal = False\n                            End If\n                        Next\n                    End If\n                    If blnAddVal = True Then\n                        strNewVal = strOldOldOldVal &amp; strBreak &amp; strAddVal\n                        Cells(Target.Row, Target.Column + 3).Value = strNewVal\n                    End If\n                    Application.EnableEvents = True\n            End If\n        End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577199381, "post_id": 59470325, "comment_id": 105119596, "body": "I&#39;m not sure why you need a loop here to be honest."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12589623, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156832914696485/picture?type=large", "display_name": "Celine Low", "link": "https://stackoverflow.com/users/12589623/celine-low"}, "edited": false, "score": 0, "creation_date": 1577321293, "post_id": 59470657, "comment_id": 105141935, "body": "Thanks for the above!! Can i ask one more question? How can i paste value instead of copy without major editing the above codes ?"}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": false, "score": 0, "last_activity_date": 1577366070, "last_edit_date": 1577366070, "creation_date": 1577200329, "answer_id": 59470657, "question_id": 59470325, "link": "https://stackoverflow.com/questions/59470325/fixing-vba-copy-rows-data-from-a-column-to-another-sheet/59470657#59470657", "title": "Fixing vba copy rows data from a column to another sheet", "body": "<p>You are using Column 1 to get the last row on both sheets but are populating column 4 on <code>worksheet(\"UploadtoSun\")</code>.</p>\n\n<p>You want to change:</p>\n\n<pre><code>UploadtoSunLastRow = Worksheets(\"UploadtoSun\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>UploadtoSunLastRow = Worksheets(\"UploadtoSun\").Cells(Rows.Count, 4).End(xlUp).Offset(1, 0).Row\n</code></pre>\n\n<p>Now you are comparing the last row with the column you are adding rows to. </p>\n\n<p>Though as pointed out by BigBen if you are grabbing a contiguous range and dumping to another contiguous range you can just copy the entire range over in one shot with no need for a loop. </p>\n\n<p>This would do the same with no loop:</p>\n\n<pre><code>    Dim ConcurLastRow As Long\n    Dim UploadtoSunLastRow As Long\n    Dim concur As Worksheet\n    Set concur = ThisWorkbook.Worksheets(\"Concur\")\n\n    ConcurLastRow = concur.Cells(Rows.Count, 10).End(xlUp).Row\n    UploadtoSunLastRow = Worksheets(\"UploadtoSun\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n    With concur\n        .Range(.Cells(11, 10), .Cells(ConcurLastRow, 10)).Copy Worksheets(\"UploadtoSun\").Cells(UploadtoSunLastRow, 4)\n    End With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12589623, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156832914696485/picture?type=large", "display_name": "Celine Low", "link": "https://stackoverflow.com/users/12589623/celine-low"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577366070, "creation_date": 1577198389, "last_edit_date": 1577199089, "question_id": 59470325, "link": "https://stackoverflow.com/questions/59470325/fixing-vba-copy-rows-data-from-a-column-to-another-sheet", "title": "Fixing vba copy rows data from a column to another sheet", "body": "<p>I am trying with this code. There are numerous rows in column 10 in my sheet Concur, but when i run the codes, it only copy paste the last row in my destination. I not sure whats go wrong....    </p>\n\n<pre><code>Dim ConcurLastRow As Long\nSet Concur = ThisWorkbook.Worksheets(\"Concur\")\n\nConcurLastRow = Concur.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 11 To ConcurLastRow\nWorksheets(\"Concur\").Cells(i, 10).Copy\n\nUploadtoSunLastRow = Worksheets(\"UploadtoSun\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\nWorksheets(\"Concur\").Paste Destination:=Worksheets(\"UploadtoSun\").Cells(UploadtoSunLastRow, 4)\n\nNext i\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "runtime"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1577194989, "post_id": 59469655, "comment_id": 105118251, "body": "The form exists and is spelled exactly as <code>Machines Toevoegen</code>, and <code>me.Installaties_Id</code> exists and is spelled properly?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1577225616, "post_id": 59469655, "comment_id": 105125882, "body": "<code>OpenArgs:=</code> is not necessary but shouldn&#39;t hurt. Don&#39;t see anything wrong with command."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1577228571, "post_id": 59469655, "comment_id": 105126297, "body": "I would guess: the form or its code uses something that is installed on your computer, but not on the server. The fact that the latter uses Access runtime may be unrelated."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7457070, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5pxWnF7B40A/AAAAAAAAAAI/AAAAAAAAPso/WvebTC6S4fw/photo.jpg?sz=128", "display_name": "Jan Willem van Gurp", "link": "https://stackoverflow.com/users/7457070/jan-willem-van-gurp"}, "edited": false, "score": 0, "creation_date": 1577355799, "post_id": 59485055, "comment_id": 105148914, "body": "Awesome, this might in fact help a lot. Only problem is: I made the DB in Access 2016, server runs 2010... So the ACCDE I make with 2016 doesn&#39;t run on 2010, any thoughts on how to fix this?"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 21, "user_id": 7457070, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5pxWnF7B40A/AAAAAAAAAAI/AAAAAAAAPso/WvebTC6S4fw/photo.jpg?sz=128", "display_name": "Jan Willem van Gurp", "link": "https://stackoverflow.com/users/7457070/jan-willem-van-gurp"}, "edited": false, "score": 0, "creation_date": 1577397022, "post_id": 59485055, "comment_id": 105161593, "body": "as a general rule, you ALWAYS want to develop with the lowest common version of Access you plan to deploy to. This advice actually applies to even when using  accDB. As new features are added then you can never be sure that you can go back in time. I can&#39;t take a new Word document and open it with say Word running on old windows 3.1. Compatibility in this industry is great moving forward in time, but attempting to run a newer version of software system X with a previous version is a VERY bad idea. You have to either adopt 2010 for your development, and then can deploy to 2013, 2016, 2019 etc."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 21, "user_id": 7457070, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5pxWnF7B40A/AAAAAAAAAAI/AAAAAAAAPso/WvebTC6S4fw/photo.jpg?sz=128", "display_name": "Jan Willem van Gurp", "link": "https://stackoverflow.com/users/7457070/jan-willem-van-gurp"}, "edited": false, "score": 0, "creation_date": 1577397290, "post_id": 59485055, "comment_id": 105161658, "body": "So either you install 2016 run time on that server, or you adopt 2010 for your development cycle.  You as a general rule MUST develop with the lowest common version of Access you plan to deploy to. So if you use 2013, then your runtime will work with 2013, 2016 and 2019. You can no more run a new version of Word on a old DOS computer without a mouse then you can attempt to go backwards with Access in time. So, you have to install the newer version of the runtime, or you have to use 2010 for your development. So look at what versions of Access you will deploy to and use lowest common edition."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 0, "last_activity_date": 1578303683, "last_edit_date": 1578303683, "creation_date": 1577344168, "answer_id": 59485055, "question_id": 59469655, "link": "https://stackoverflow.com/questions/59469655/runtime-closes-when-i-use-docmd-openform/59485055#59485055", "title": "Runtime closes when I use DoCmd.OpenForm", "body": "<p>Well any un-handled error in the runtime will spit out the error message, and then as you experienced exit the application.</p>\n\n<p>there are a good number of ways to approach this:\nImprove error handling - make sure you don't encounter any un-handled error. I find this can be a LOT of work.</p>\n\n<p>Another way? Compile your application down to a accDE. When you use a accDE, not only does the runtime ignore errors, not only does it NOT shut down?</p>\n\n<p>It also means that all of your local and global variables are NEVER re-set. so global vars, and even global reocrdsets or anything else will retain their values, and do so even with errors. As a result:\nYour application runs like a un-stoppable fright train.\nYour local and even global variables retain their values. This allows use of application wide settings and variables that never re-set. And no re-sets ever occur even for un-handled errors. They remain intact for the given session (since the time the application was launched).</p>\n\n<p>So, I would try running your application as a accDE on that server. It will not only become  vastly more reliable, but it will also not shutdown on un-expected errors and even better it will retain the value of variables even when having encountered errors. </p>\n\n<p>So it looks like you have some un-handed error. You can go on a treasure hunt to find this error, or just try a accDE in the meantime, and perhaps in the new years you might eventually track down the error or issue. But until then, just compile your application as a accDE.</p>\n\n<p>To compile:\nFirst, from VBA editor (just hit <kbd>ctrl</kbd>-<kbd>g</kbd>). And from the menu bar choose debug->compile. You MUST ensure that no compile errors exist before the next step.</p>\n\n<p>If above compiles, then from UI (main ribbon), go file->Save and publish</p>\n\n<p>From that panel, choose Make ACCDE.</p>\n\n<p>Access will compile your application into a \"access executable\". Now try running this application with a accDE file extension on the other computer. </p>\n"}], "owner": {"reputation": 21, "user_id": 7457070, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5pxWnF7B40A/AAAAAAAAAAI/AAAAAAAAPso/WvebTC6S4fw/photo.jpg?sz=128", "display_name": "Jan Willem van Gurp", "link": "https://stackoverflow.com/users/7457070/jan-willem-van-gurp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582177182, "creation_date": 1577194703, "last_edit_date": 1582177182, "question_id": 59469655, "link": "https://stackoverflow.com/questions/59469655/runtime-closes-when-i-use-docmd-openform", "title": "Runtime closes when I use DoCmd.OpenForm", "body": "<p>I have a form with a button which opens a new form to add a new record to a table.</p>\n\n<p>In Access on my PC (full version), everything works.</p>\n\n<p>When I try to run it on a server with Access Runtime, I get an error saying something like:</p>\n\n<blockquote>\n  <p>this application has stopped working due to a runtime-error. The<br>\n  application will now be closed</p>\n</blockquote>\n\n<p>(I have the Dutch version, so I hope this comes close to the English dialog box message). </p>\n\n<p>I debugged the VBA, but that doesn't seem to be the problem.</p>\n\n<p>It has worked before:</p>\n\n<pre><code>Private Sub Knop62_Click()\n    DoCmd.OpenForm \"Machines Toevoegen\", , , , acFormAdd, _\n      acDialog, OpenArgs:=Me.Installaties_Id\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "for-loop", "do-while"], "answers": [{"tags": [], "owner": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "is_accepted": true, "score": 0, "last_activity_date": 1577197048, "creation_date": 1577197048, "answer_id": 59470091, "question_id": 59469418, "link": "https://stackoverflow.com/questions/59469418/copying-values-from-various-workbooks-and-worksheets-into-other-workbook/59470091#59470091", "title": "Copying values from various Workbooks and Worksheets into other Workbook", "body": "<p>Looks like the issue is with your worksheet Looping. You are copying the content from a worksheet but pasting the value after the worksheet loop. That's why you are getting values from only one sheet. The below code should work for you.</p>\n\n<pre><code>Sub RunOnAllFilesInFolder()\n\n        Dim folderName As String, eApp As Excel.Application, fileName As String\n        Dim wb As Workbook, ws As Worksheet, currWs As Worksheet, currWb As Workbook\n        Dim fDialog As Object: Set fDialog = Application.FileDialog(msoFileDialogFolderPicker)\n        Set currWb = ActiveWorkbook: Set currWs = ActiveSheet\n        Dim ID As String\n        Dim counter As Integer\n        Dim i As Integer\n\n        counter = 2\n        fDialog.Title = \"Select a folder\"\n        fDialog.InitialFileName = currWb.Path\n\n        If fDialog.Show = -1 Then\n            folderName = fDialog.SelectedItems(1)\n        End If\n\n        Set eApp = New Excel.Application: eApp.Visible = False\n        Set eApp2 = New Excel.Application: eApp.Visible = False\n        Set wb2 = eApp2.Workbooks.Add\n\n        fileName = Dir(folderName &amp; \"\\*.xls\")\n\n        Do While fileName &lt;&gt; \"\"\n\n            Application.StatusBar = \"Processing \" &amp; folderName &amp; \"\\\" &amp; fileName\n            Set wb = eApp.Workbooks.Open(folderName &amp; \"\\\" &amp; fileName)\n\n            For Each ws In wb.Worksheets\n                ws.Range(\"A1\").Copy\n                wb2.Worksheets(1).Cells(counter, 1).PasteSpecial xlPasteValues\n                counter = counter + 1\n            Next ws\n\n            wb.Close SaveChanges:=False\n            Debug.Print \"Processed\" &amp; folderName &amp; \"\\\" &amp; fileName\n            fileName = Dir()\n        Loop\n\n        wb2.SaveAs (\"Results.xlsx\")\n        eApp.Quit\n        Set eApp = Nothing\n        eApp2.Quit\n        Set eApp2 = Nothing\n        Application.StatusBar = \"\"\n        MsgBox \"Completed executing Macro\"\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12591232, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCWv_2dp2suPlfrisFwHju4CPS0jR6J1q5yectD=k-s128", "display_name": "Dino", "link": "https://stackoverflow.com/users/12591232/dino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 59470091, "answer_count": 1, "score": 0, "last_activity_date": 1577281484, "creation_date": 1577193458, "last_edit_date": 1577281484, "question_id": 59469418, "link": "https://stackoverflow.com/questions/59469418/copying-values-from-various-workbooks-and-worksheets-into-other-workbook", "title": "Copying values from various Workbooks and Worksheets into other Workbook", "body": "<p>I'm trying to loop through worksheets from various workbooks and copy values (starting with a single cell). I need to paste the copied values into a worksheet in a new workbook one below another in the first row. </p>\n\n<p>I work with three workbooks. Each workbooks has two sheets.</p>\n\n<p>I loop through all worksheets in the three workbooks. </p>\n\n<p>Following problem occurs: only the values from the second sheets are copied into the master file.</p>\n\n<pre><code>Sub RunOnAllFilesInFolder()\n\n    Dim folderName As String, eApp As Excel.Application, fileName As String\n    Dim wb As Workbook, ws As Worksheet, currWs As Worksheet, currWb As Workbook\n    Dim fDialog As Object: Set fDialog = Application.FileDialog(msoFileDialogFolderPicker)\n    Set currWb = ActiveWorkbook: Set currWs = ActiveSheet\n    Dim ID As String\n    Dim counter As Integer\n    Dim i As Integer\n\n    counter = 2\n    fDialog.Title = \"Select a folder\"\n    fDialog.InitialFileName = currWb.Path\n\n    If fDialog.Show = -1 Then\n        folderName = fDialog.SelectedItems(1)\n    End If\n\n    Set eApp = New Excel.Application: eApp.Visible = False\n    Set eApp2 = New Excel.Application: eApp.Visible = False\n    Set wb2 = eApp2.Workbooks.Add\n\n    fileName = Dir(folderName &amp; \"\\*.xls\")\n\n    Do While fileName &lt;&gt; \"\"\n\n        Application.StatusBar = \"Processing \" &amp; folderName &amp; \"\\\" &amp; fileName\n        Set wb = eApp.Workbooks.Open(folderName &amp; \"\\\" &amp; fileName)\n\n        For Each ws In wb.Worksheets\n            ws.Range(\"A1\").Copy\n        Next ws\n\n        wb2.Worksheets(1).Cells(counter, 1).PasteSpecial xlPasteValues\n\n        wb.Close SaveChanges:=False\n        Debug.Print \"Processed\" &amp; folderName &amp; \"\\\" &amp; fileName\n        fileName = Dir()\n        counter = counter + 1\n\n    Loop\n\n    wb2.SaveAs (\"Results.xlsx\")\n    eApp.Quit\n    Set eApp = Nothing\n    eApp2.Quit\n    Set eApp2 = Nothing\n\n    Application.StatusBar = \"\"\n    MsgBox \"Completed executing Macro\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577193629, "post_id": 59469393, "comment_id": 105117827, "body": "Yes it is possible. Will all the files have the same code?"}, {"owner": {"reputation": 877, "user_id": 4391692, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NrPDt.jpg?s=128&g=1", "display_name": "Leogout", "link": "https://stackoverflow.com/users/4391692/leogout"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577193895, "post_id": 59469393, "comment_id": 105117911, "body": "The code is almost identical but must contain a unique ID for each excel file, something like: <code>Public Const ID As String = &quot;TDW...LC2&quot;</code>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577194187, "post_id": 59469393, "comment_id": 105118021, "body": "I can show you an example for 1 workbook. You can use DIR to open the file in a loop and insert the code. Is that ok?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1577194402, "post_id": 59469393, "comment_id": 105118086, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/34837006/excel-vba-add-code-to-sheet-module-programmatically\">Excel vba add code to sheet module programmatically</a> And <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">Cpearson&#39;s</a> site should also show you in the right direction."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1577195021, "post_id": 59469393, "comment_id": 105118264, "body": "@Storax: Just saw your comment. Yes it should point in the right direction. That link by Chip should definitely help but this post is not a duplicate of Dave&#39;s post. It may be talking about <code>CreateEventProc</code> but it is for <code>worksheet change</code>. Further more, there is one important thing which is missing in that post. That is about <code>Trust access to the VBA project object model</code>.  It also relies on Early Binding whereas this post is not."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577196816, "post_id": 59469393, "comment_id": 105118840, "body": "@Siddharth: Yes, certainly not an excat duplicate but IMHO pretty similar. I would expect the OP to do the &quot;transfer&quot; from <code>worksheet_change</code> to <code>workbook_open</code>. But you are right, the hint regarding <i>trust access to the VBA Project</i> is missing."}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1577374237, "post_id": 59469620, "comment_id": 105155058, "body": "Further hint regarding internationalization: note that the default <i>CodeName</i> <code>ThisWorkbook</code> called via <code>VBP.VBComponents(&quot;ThisWorkbook&quot;)</code> varies due to regional settings, e.g. <code>DieseArbeitsmappe</code> in German :-)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 7, "last_activity_date": 1577194512, "creation_date": 1577194512, "answer_id": 59469620, "question_id": 59469393, "link": "https://stackoverflow.com/questions/59469393/how-to-add-vba-code-to-multiple-files-programmatically/59469620#59469620", "title": "How to add VBA code to multiple files programmatically?", "body": "<p>You do not need python for this.</p>\n\n<p><strong>Logic</strong></p>\n\n<ol>\n<li>Open the file in a loop.</li>\n<li>Use <code>.CreateEventProc</code> to write to the relevant code section. More about  <code>.CreateEventProc</code> <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/createeventproc-method-vba-add-in-object-model\" rel=\"noreferrer\">HERE</a></li>\n<li>Save and close the workbook.</li>\n</ol>\n\n<p><strong>Basic Requirements</strong></p>\n\n<p>You need to enable access to Visual Basic projects.</p>\n\n<ol>\n<li>Click the File tab.</li>\n<li>Click Options.</li>\n<li>Click Trust Center, and then click Trust Center Settings.</li>\n<li>In the Trust Center, click Macro Settings.</li>\n<li>Check <code>Trust access to the VBA project object model</code> to enable access to Visual Basic Projects.</li>\n<li>Click OK.</li>\n</ol>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim VBP As Object, VBC As Object, CM As Object\n    Dim wb As Workbook\n\n    Set wb = Workbooks.Open(\"C:\\Users\\routs\\Desktop\\Sample.xlsm\")\n\n    Set VBP = wb.VBProject\n    Set VBC = VBP.VBComponents(\"ThisWorkbook\")\n    Set CM = VBC.CodeModule\n\n    With VBC.CodeModule\n        .InsertLines Line:=.CreateEventProc(\"Open\", \"Workbook\") + 1, _\n        String:=vbCrLf &amp; _\n        \"    Debug.Print \"\"This is a sample text\"\"\"\n    End With\n\n    'wb.Close (True)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13550950, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1e052a83efe20e3c5fa65eeff4b3a509?s=128&d=identicon&r=PG", "display_name": "Dane Ernst", "link": "https://stackoverflow.com/users/13550950/dane-ernst"}, "is_accepted": false, "score": 1, "last_activity_date": 1589567956, "creation_date": 1589567956, "answer_id": 61826173, "question_id": 59469393, "link": "https://stackoverflow.com/questions/59469393/how-to-add-vba-code-to-multiple-files-programmatically/61826173#61826173", "title": "How to add VBA code to multiple files programmatically?", "body": "<p>Is there a way to programmatically copy code from one sheet except paste into a specific location of the code in the new sheet?</p>\n\n<p>Basically what I'm trying to accomplish:</p>\n\n<p>I have a couple of conditional formatting rules that I only want to be applicable after I've pressed a keyboard shortcut. I want to still be able to use the undo stack up to a certain point.</p>\n\n<p>This code allows the particular conditional formatting to work the way I want it to, and is the only code on Sheet2:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n With ThisWorkbook.Names(\"CurrentRow\")\n         .Name = \"CurrentRow\"\n         .RefersToR1C1 = \"=\" &amp; ActiveCell.Row\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This is what I have for the code to run the copy</p>\n\n<pre><code>Sub CondFormat()\n'\n' CondFormat Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+C\n'\nDim CodeCopy As VBIDE.CodeModule\nDim CodePaste As VBIDE.CodeModule\nDim numLines As Integer\n\nSet CodeCopy = ActiveWorkbook.VBProject.VBComponents(\"Sheet2\").CodeModule\nSet CodePaste = ActiveWorkbook.VBProject.VBComponents(\"Sheet4\").CodeModule\n\nnumLines = CodeCopy.CountOfLines\nIf CodePaste.CountOfLines &gt; 1 Then CodePaste.DeleteLines 1, CodePaste.CountOfLines\n\nCodePaste.AddFromString CodeCopy.Lines(1, numLines)\nEnd Sub\n</code></pre>\n\n<p>Below is the end bits of the Sheet 4 code. I don't want to delete everything on this new sheet, I would want it to appear under \"Private Sub Worksheet_SelectionChange(ByVal Target As Range)\" :</p>\n\n<p>...</p>\n\n<pre><code>SendKeys \"{TAB}\", 1\nSendKeys \"{TAB}\", 1\nSendKeys \"^{v}\", 2\n\nApplication.Wait (Now + TimeValue(\"00:00:02\"))\n\nSendKeys \"{F8}\", 1\n\nApplication.Wait (Now + TimeValue(\"00:00:02\"))\n\nLoop\n\nSendKeys \"{NUMLOCK}\", 1\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 877, "user_id": 4391692, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/NrPDt.jpg?s=128&g=1", "display_name": "Leogout", "link": "https://stackoverflow.com/users/4391692/leogout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 2, "accepted_answer_id": 59469620, "answer_count": 2, "score": 4, "last_activity_date": 1589567956, "creation_date": 1577193300, "last_edit_date": 1577198934, "question_id": 59469393, "link": "https://stackoverflow.com/questions/59469393/how-to-add-vba-code-to-multiple-files-programmatically", "title": "How to add VBA code to multiple files programmatically?", "body": "<p>I have many excel files (approx 200) in which I have to add VBA code (in the <code>Workbook_Open()</code> method).<br>\nI would like to automate that, is there a way to add VBA code to an excel sheet programmatically?  </p>\n\n<p>Maybe with python's <code>win32</code> package?</p>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1577199531, "last_edit_date": 1577199531, "creation_date": 1577198448, "answer_id": 59470331, "question_id": 59469200, "link": "https://stackoverflow.com/questions/59469200/how-can-i-know-the-previous-row-number-that-triggered-a-selectionchange-procedur/59470331#59470331", "title": "How can I know the previous row number that triggered a SelectionChange procedure?", "body": "<p>I would do it like that</p>\n\n<pre><code>Option Explicit\n\nDim PrevActiveCell As Range\nDim CurActiveCell As Range\nDim frm As New UserForm1\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Set PrevActiveCell = CurActiveCell\n    Set CurActiveCell = ActiveCell\n\n    If PrevActiveCell Is Nothing Then\n        ' Either you forget to set CurActiveCell (when opening the workbook or ...)\n        ' or you did reset the VBA project\n    Else\n\n        With frm\n            .Caption = \"Cur:\" &amp; CurActiveCell.Row &amp; \" Old: \" &amp; PrevActiveCell.Row\n            .Show\n        End With\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>And in the form I have this code</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    Hide\nEnd Sub\nPrivate Sub UserForm_QueryClose(Cancel As Integer _\n                                       , CloseMode As Integer)\n    ' Prevent the form being unloaded\n    If CloseMode = vbFormControlMenu Then Cancel = True\n\n    ' Hide the Userform\n    Hide\n\nEnd Sub\n</code></pre>\n\n<p>PS It is not a good idea to refer to the userform itself in the code of the userform. Reading material <a href=\"https://rubberduckvba.wordpress.com/tag/userforms/\" rel=\"nofollow noreferrer\">UserForm1.Show</a> and <a href=\"https://gregmaxey.com/word_tip_pages/userforms_advanced_tips.html\" rel=\"nofollow noreferrer\">Userform Default Instance vs. Userform Explicit Declaration</a></p>\n"}], "owner": {"reputation": 3, "user_id": 12372412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fa6560650584d2e119ef75c6665eaec?s=128&d=identicon&r=PG&f=1", "display_name": "chrisenn", "link": "https://stackoverflow.com/users/12372412/chrisenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 59470331, "answer_count": 1, "score": 0, "last_activity_date": 1581672700, "creation_date": 1577192339, "last_edit_date": 1581672700, "question_id": 59469200, "link": "https://stackoverflow.com/questions/59469200/how-can-i-know-the-previous-row-number-that-triggered-a-selectionchange-procedur", "title": "How can I know the previous row number that triggered a SelectionChange procedure?", "body": "<p>I have an Excel spreadsheet that calls a <code>SelectionChange</code> procedure every time I move the active cell.</p>\n\n<p>This procedure carries out a certain number of actions and displays the results in a userform. The user can validate the results or cancel via command buttons.</p>\n\n<p><code>Selection.row</code> gives me the target cell's row. </p>\n\n<p>How do I retrieve the row number of the cell I just left?</p>\n\n<p>The first block of code below is in the sheet code, and the second is the userform code. This test userform contains just a label and a single button.</p>\n\n<p>The first line of the button code works, but gives me the target row. I hoped that the second line would work, but OldRow is empty so the line crashes. How can I make OldRow visible to the userform?</p>\n\n<pre><code>Dim OldRow As Long\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Static OldRange As Range\n    If Not OldRange Is Nothing Then\n        ' do things\n    End If\n    MsgBox OldRow\n    UserForm1.Show\n    Set OldRange = Target.Cells(1, 1)\n    OldRow = OldRange.Row\nEnd Sub\n</code></pre>\n\n<pre><code>Private Sub CommandButton1_Click()\n    UserForm1.Label1.Caption = Selection.Row\n    UserForm1.Label1.Caption = OldRow\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 227, "user_id": 11480727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/naqGq.png?s=128&g=1", "display_name": "Atmira", "link": "https://stackoverflow.com/users/11480727/atmira"}, "edited": false, "score": 0, "creation_date": 1577189858, "post_id": 59468705, "comment_id": 105116541, "body": "Can you provide the data in table format instead of image? Edit post and copy data from excel to text and then mark the text and set it to code please."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1577191103, "post_id": 59468705, "comment_id": 105117001, "body": "You can treat tables in excel as database tables and do sql joins on fields with them. Each table needs to be in it&#39;s own sheet, with field names in row 1. Then the easiest way to do it is to link to them in a blank access database and use the query generator"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12589482, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l7wOUrs0EWo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNz0vj75gxP9uqX29aBIp8TSL6-g/photo.jpg?sz=128", "display_name": "SpartaN", "link": "https://stackoverflow.com/users/12589482/spartan"}, "edited": false, "score": 0, "creation_date": 1577248669, "post_id": 59468793, "comment_id": 105128538, "body": "I accept that the mentioned remove duplicates method is the best simple way to do this. But I excepting to do this by formula and to record them as macro for later use. Can you help me in This?"}], "tags": [], "owner": {"reputation": 227, "user_id": 11480727, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/naqGq.png?s=128&g=1", "display_name": "Atmira", "link": "https://stackoverflow.com/users/11480727/atmira"}, "is_accepted": false, "score": 1, "last_activity_date": 1577190098, "creation_date": 1577190098, "answer_id": 59468793, "question_id": 59468705, "link": "https://stackoverflow.com/questions/59468705/compare-two-table-and-make-a-combined-table-in-excel/59468793#59468793", "title": "Compare two table and make a combined table in Excel", "body": "<p>One way to to it is to copy all data from old table and new table to result and then remove duplicates (the built in Excel-feature). Would that do the trick or does it need to be code?</p>\n\n<p><a href=\"https://i.stack.imgur.com/3S4ME.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3S4ME.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 12589482, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l7wOUrs0EWo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNz0vj75gxP9uqX29aBIp8TSL6-g/photo.jpg?sz=128", "display_name": "SpartaN", "link": "https://stackoverflow.com/users/12589482/spartan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "closed_date": 1577964024, "answer_count": 1, "score": 0, "last_activity_date": 1577964015, "creation_date": 1577189712, "last_edit_date": 1577964015, "question_id": 59468705, "link": "https://stackoverflow.com/questions/59468705/compare-two-table-and-make-a-combined-table-in-excel", "closed_reason": "Needs details or clarity", "title": "Compare two table and make a combined table in Excel", "body": "<p>Can Anyone Please help me in this?\nThanks in Advance..</p>\n\n<p>What I need is to compare the table 'Old' with 'New' and Make the column 'person' and Product ID' by formula in Result Table. (by combing 'Old' and 'New' Table).</p>\n\n<p><a href=\"https://i.stack.imgur.com/bmrMV.jpg\" rel=\"nofollow noreferrer\">Sample Table</a></p>\n"}, {"tags": ["excel", "vba", "combobox", "null", "textbox"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577185946, "post_id": 59467875, "comment_id": 105115206, "body": "Please use the editing tool to include images - don&#39;t post links to outside sources. You might also want to include a link to the Stack Overflow discussion you reference in the question if that contains important background information. The <a href=\"https://stackoverflow.com/posts/59467875/edit\">edit</a> link below the question enables you to change its content."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "edited": false, "score": 0, "creation_date": 1577186570, "post_id": 59467997, "comment_id": 105115428, "body": "thanks for your help but It&#39;s not work, even if I choose from combobox, the textbox is still not visible"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "edited": false, "score": 0, "creation_date": 1577186641, "post_id": 59467997, "comment_id": 105115459, "body": "I assumed you would know how to put it on the right event, but ok, i updated the answer."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1577187845, "last_edit_date": 1577187845, "creation_date": 1577186187, "answer_id": 59467997, "question_id": 59467875, "link": "https://stackoverflow.com/questions/59467875/show-hide-textbox-if-comboxbox-is-null-or-not/59467997#59467997", "title": "show/hide textbox if comboxbox is null or not", "body": "<p>This is simpler than you are making it. </p>\n\n<p>Instead, test for the length of the ComboBox1's text property being greater than 0. That will give you a boolean value of True/False. You can then use that boolean result to set any other boolean value property (like the <code>Enabled</code> or <code>Visible</code> property) all in one line.</p>\n\n<p>Also, you need to put it on the <code>Change</code> event of <code>ComboBox1</code>, not <code>TextBox1</code>.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n  TextBox1.Enabled = (Len(ComboBox1.Text)&gt;0)\nEnd Sub\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n  TextBox1.Visible = (Len(ComboBox1.Text)&gt;0)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 59467997, "answer_count": 1, "score": -1, "last_activity_date": 1577187845, "creation_date": 1577185654, "last_edit_date": 1577186202, "question_id": 59467875, "link": "https://stackoverflow.com/questions/59467875/show-hide-textbox-if-comboxbox-is-null-or-not", "title": "show/hide textbox if comboxbox is null or not", "body": "<p>first of all i want to say thanks for every person who respond me for my previous quesiton,\ni have a combobox (list) and a textbox(key1), but i want to enable textbox IF combobox is not null, I tried to to this by this code</p>\n\n<pre><code>  Private Sub TextBox1_Change()\n\nIf IsNullOrEmpty(ComboBox1.Text) Then\n\nTextBox1.Visible = False\nTextBox1.Enabled = False\n\n\nElse\nTextBox1.Visible = True\nTextBox1.Enabled = True\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>but the result is always the textbox1 is disabled, even if i choose from the list or combobox&lt;>null</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577185594, "post_id": 59467255, "comment_id": 105115071, "body": "Please tell us (or better, use the <a href=\"https://stackoverflow.com/posts/59467255/edit\">edit</a> link below the question to add it directly to the question): Which line of code causes the error? My guess would be it comes from <code>ChangeSpellCheckLang</code> because the numerical equivalents of Office enumerations are of data type <code>Long</code>, not <code>Integer</code>."}, {"owner": {"reputation": 1, "user_id": 12590339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476617d600322c95d725afc6e3048dd?s=128&d=identicon&r=PG&f=1", "display_name": "vvilku", "link": "https://stackoverflow.com/users/12590339/vvilku"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577187044, "post_id": 59467255, "comment_id": 105115603, "body": "I changed the input param for <code>ChangeSpellCheckLang</code> to <code>Long</code>, but the problem still exists. When I highlight the problematic line it shows that <code>control.Tag = &quot;msoLanguageIDEnglishUK&quot;</code> so I&#39;m wondering if maybe the quotation marks could be the issue and that the constant is not resolved, but passed on as a string."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577187558, "post_id": 59467255, "comment_id": 105115769, "body": "Yes, that would be the case. The <code>tag</code> property is a string. VBA will coerce a numeric string to a number without explicit conversion. But the same will not apply to an enumeration. Why can&#39;t you write the numerical equivalent instead of the name? If you need to use the name  you&#39;d need a &quot;look up&quot; - something that provides the numerical equivalent for a language string."}, {"owner": {"reputation": 1, "user_id": 12590339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476617d600322c95d725afc6e3048dd?s=128&d=identicon&r=PG&f=1", "display_name": "vvilku", "link": "https://stackoverflow.com/users/12590339/vvilku"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577187876, "post_id": 59467255, "comment_id": 105115872, "body": "Maybe I&#39;m just over-sensitive, but I think that hardcoding a numeric ID is not the best practice, especially, when I have an in-built list <code>msoLanguageID</code>."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1577199847, "post_id": 59467255, "comment_id": 105119754, "body": "Per Cindy&#39;s suggestion, you could use something like Call Macros.ChangeSpellCheckLang(LangIDToLong(control.Tag)) and write a simple LangIDToLong function that takes the language ID constant name as input and returns the equivalent Long value."}, {"owner": {"reputation": 1, "user_id": 12590339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476617d600322c95d725afc6e3048dd?s=128&d=identicon&r=PG&f=1", "display_name": "vvilku", "link": "https://stackoverflow.com/users/12590339/vvilku"}, "edited": false, "score": 0, "creation_date": 1577280802, "post_id": 59467255, "comment_id": 105134716, "body": "Thanks Steve, I&#39;m quite new to VBA, so I&#39;m not sure if I&#39;m able to write a proper function to retrieve the constant values (it would look like a multiple case statement or some lookup) so I&#39;ll jsut stick to the numeric values. To my understanding these are global, constant, and reliable numeric representations of specific languages and they are unlikely to change for example with a next Office release, right?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1577291956, "post_id": 59467255, "comment_id": 105137196, "body": "@vvilku &quot;To my understanding ...&quot;  Yes, that&#39;s correct. A new release might add new constants (which older versions wouldn&#39;t understand) but constants and their values won&#39;t change from one version to the next.  A function to return the correct value for strings would be quite simple to write.  Let us know if you&#39;d rather go that way."}, {"owner": {"reputation": 1, "user_id": 12590339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476617d600322c95d725afc6e3048dd?s=128&d=identicon&r=PG&f=1", "display_name": "vvilku", "link": "https://stackoverflow.com/users/12590339/vvilku"}, "edited": false, "score": 0, "creation_date": 1577384293, "post_id": 59467255, "comment_id": 105158296, "body": "Thanks Steve. I have 6 languages to cover, so it&#39;s not an issue, however for study purposes, I&#39;d be interested in how to properly do that - is <code>msoLanguageID</code> structure accessible somehow?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1577457207, "post_id": 59467255, "comment_id": 105176619, "body": "Easily:  in the VBA IDE, press F2 to open the object browser, search for msoLanguageID.  That&#39;ll lead you to a list of all the possible IDs. Click on the one you want to get the value of the constant. There&#39;s a fairly recent listing of all of them here:  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Office.MsoLanguageID\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/Office.MsoLanguageID</a>"}, {"owner": {"reputation": 1, "user_id": 12590339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476617d600322c95d725afc6e3048dd?s=128&d=identicon&r=PG&f=1", "display_name": "vvilku", "link": "https://stackoverflow.com/users/12590339/vvilku"}, "edited": false, "score": 0, "creation_date": 1577788495, "post_id": 59467255, "comment_id": 105254799, "body": "I know that, I was rather interested if there is a way to write a VBA function that returns the number by reading the msoLanguageID itself, instead of me writing a function with <code>case when msoLanguageIDEnglishUK Then Return 2057</code> etc."}], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 3891180, "user_type": "registered", "profile_image": "https://graph.facebook.com/39500063/picture?type=large", "display_name": "Dean", "link": "https://stackoverflow.com/users/3891180/dean"}, "is_accepted": false, "score": 1, "last_activity_date": 1580310597, "creation_date": 1580310597, "answer_id": 59970030, "question_id": 59467255, "link": "https://stackoverflow.com/questions/59467255/how-to-correctly-pass-an-argument-from-an-inbuilt-office-enum-from-ribbon-to-vba/59970030#59970030", "title": "How to correctly pass an argument from an inbuilt Office enum from Ribbon to VBA Macro?", "body": "<p>The msoLanguage constants are part of the suite of Office applications. However, I recently was using some other enum constants between the applications like shape placeholder types in PPT. For my purposes I needed to get the constant name from the value so I used a current enum list and a little regex to quickly format a list that creates a collection. I've quickly done the same here for the languages. The first line declares the collection and the last <code>colLang(\"1130\") ' return msoLanguageIDYoruba</code> is an example of retrieving the enum name from the value.</p>\n\n<pre><code>Dim colLang As New Collection\ncolLang.Add \"msoLanguageIDAfrikaans\", \"1078\" ' The Afrikaans language\ncolLang.Add \"msoLanguageIDAlbanian\", \"1052\" ' The Albanian language\ncolLang.Add \"msoLanguageIDAmharic\", \"1118\" ' The Amharic language\ncolLang.Add \"msoLanguageIDArabic\", \"1025\" ' The Arabic language\ncolLang.Add \"msoLanguageIDArabicAlgeria\", \"5121\" ' The Arabic Algeria language\ncolLang.Add \"msoLanguageIDArabicBahrain\", \"15361\" ' The Arabic Bahrain language\ncolLang.Add \"msoLanguageIDArabicEgypt\", \"3073\" ' The Arabic Egypt language\ncolLang.Add \"msoLanguageIDArabicIraq\", \"2049\" ' The Arabic Iraq language\ncolLang.Add \"msoLanguageIDArabicJordan\", \"11265\" ' The Arabic Jordan language\ncolLang.Add \"msoLanguageIDArabicKuwait\", \"13313\" ' The Arabic Kuwait language\ncolLang.Add \"msoLanguageIDArabicLebanon\", \"12289\" ' The Arabic Lebanon language\ncolLang.Add \"msoLanguageIDArabicLibya\", \"4097\" ' The Arabic Libya language\ncolLang.Add \"msoLanguageIDArabicMorocco\", \"6145\" ' The Arabic Morocco language\ncolLang.Add \"msoLanguageIDArabicOman\", \"8193\" ' The Arabic Oman language\ncolLang.Add \"msoLanguageIDArabicQatar\", \"16385\" ' The Arabic Qatar language\ncolLang.Add \"msoLanguageIDArabicSyria\", \"10241\" ' The Arabic Syria language\ncolLang.Add \"msoLanguageIDArabicTunisia\", \"7169\" ' The Arabic Tunisia language\ncolLang.Add \"msoLanguageIDArabicUAE\", \"14337\" ' The Arabic UAE language\ncolLang.Add \"msoLanguageIDArabicYemen\", \"9217\" ' The Arabic Yemen language\ncolLang.Add \"msoLanguageIDArmenian\", \"1067\" ' The Armenian language\ncolLang.Add \"msoLanguageIDAssamese\", \"1101\" ' The Assamese language\ncolLang.Add \"msoLanguageIDAzeriCyrillic\", \"2092\" ' The Azerbaijani Cyrillic language\ncolLang.Add \"msoLanguageIDAzeriLatin\", \"1068\" ' The Azerbaijani Latin language\ncolLang.Add \"msoLanguageIDBasque\", \"1069\" ' Basque (Basque)\ncolLang.Add \"msoLanguageIDBelgianDutch\", \"2067\" ' The Belgian Dutch language\ncolLang.Add \"msoLanguageIDBelgianFrench\", \"2060\" ' The Belgian French language\ncolLang.Add \"msoLanguageIDBengali\", \"1093\" ' The Bengali language\ncolLang.Add \"msoLanguageIDBosnian\", \"4122\" ' The Bosnian language\ncolLang.Add \"msoLanguageIDBosnianBosniaHerzegovinaCyrillic\", \"8218\" ' The Bosnian Bosnia Herzegovina Cyrillic language\ncolLang.Add \"msoLanguageIDBosnianBosniaHerzegovinaLatin\", \"5146\" ' The Bosnian Bosnia Herzegovina Latin language\ncolLang.Add \"msoLanguageIDBrazilianPortuguese\", \"1046\" ' The Portuguese (Brazil) language\ncolLang.Add \"msoLanguageIDBulgarian\", \"1026\" ' The Bulgarian language\ncolLang.Add \"msoLanguageIDBurmese\", \"1109\" ' The Burmese language\ncolLang.Add \"msoLanguageIDByelorussian\", \"1059\" ' The Belarusian language\ncolLang.Add \"msoLanguageIDCatalan\", \"1027\" ' The Catalan language\ncolLang.Add \"msoLanguageIDCherokee\", \"1116\" ' The Cherokee language\ncolLang.Add \"msoLanguageIDChineseHongKongSAR\", \"3076\" ' The Chinese Hong Kong SAR language\ncolLang.Add \"msoLanguageIDChineseMacaoSAR\", \"5124\" ' The Chinese Macao SAR language\ncolLang.Add \"msoLanguageIDChineseSingapore\", \"4100\" ' The Chinese Singapore language\ncolLang.Add \"msoLanguageIDCroatian\", \"1050\" ' The Croatian language\ncolLang.Add \"msoLanguageIDCzech\", \"1029\" ' The Czech language\ncolLang.Add \"msoLanguageIDDanish\", \"1030\" ' The Danish language\ncolLang.Add \"msoLanguageIDDivehi\", \"1125\" ' The Divehi language\ncolLang.Add \"msoLanguageIDDutch\", \"1043\" ' The Dutch language\ncolLang.Add \"msoLanguageIDEdo\", \"1126\" ' The Edo language\ncolLang.Add \"msoLanguageIDEnglishAUS\", \"3081\" ' The English AUS language\ncolLang.Add \"msoLanguageIDEnglishBelize\", \"10249\" ' The English Belize language\ncolLang.Add \"msoLanguageIDEnglishCanadian\", \"4105\" ' The English Canadian language\ncolLang.Add \"msoLanguageIDEnglishCaribbean\", \"9225\" ' The English Caribbean language\ncolLang.Add \"msoLanguageIDEnglishIndonesia\", \"14345\" ' The English Indonesia language\ncolLang.Add \"msoLanguageIDEnglishIreland\", \"6153\" ' The English Ireland language\ncolLang.Add \"msoLanguageIDEnglishJamaica\", \"8201\" ' The English Jamaica language\ncolLang.Add \"msoLanguageIDEnglishNewZealand\", \"5129\" ' The English NewZealand language\ncolLang.Add \"msoLanguageIDEnglishPhilippines\", \"13321\" ' The English Philippines language\ncolLang.Add \"msoLanguageIDEnglishSouthAfrica\", \"7177\" ' The English South Africa language\ncolLang.Add \"msoLanguageIDEnglishTrinidadTobago\", \"11273\" ' The English Trinidad Tobago language\ncolLang.Add \"msoLanguageIDEnglishUK\", \"2057\" ' The English UK language\ncolLang.Add \"msoLanguageIDEnglishUS\", \"1033\" ' The English US language\ncolLang.Add \"msoLanguageIDEnglishZimbabwe\", \"12297\" ' The English Zimbabwe language\ncolLang.Add \"msoLanguageIDEstonian\", \"1061\" ' The Estonian language\ncolLang.Add \"msoLanguageIDFaeroese\", \"1080\" ' The Faeroese language\ncolLang.Add \"msoLanguageIDFarsi\", \"1065\" ' The Farsi language\ncolLang.Add \"msoLanguageIDFilipino\", \"1124\" ' The Filipino language\ncolLang.Add \"msoLanguageIDFinnish\", \"1035\" ' The Finnish language\ncolLang.Add \"msoLanguageIDFrench\", \"1036\" ' The French language\ncolLang.Add \"msoLanguageIDFrenchCameroon\", \"11276\" ' The French Cameroon language\ncolLang.Add \"msoLanguageIDFrenchCanadian\", \"3084\" ' The French Canadian language\ncolLang.Add \"msoLanguageIDFrenchCotedIvoire\", \"12300\" ' The French Coted Ivoire language\ncolLang.Add \"msoLanguageIDFrenchHaiti\", \"15372\" ' The French Haiti language\ncolLang.Add \"msoLanguageIDFrenchLuxembourg\", \"5132\" ' The French Luxembourg language\ncolLang.Add \"msoLanguageIDFrenchMali\", \"13324\" ' The French Mali language\ncolLang.Add \"msoLanguageIDFrenchMonaco\", \"6156\" ' The French Monaco language\ncolLang.Add \"msoLanguageIDFrenchMorocco\", \"14348\" ' The French Morocco language\ncolLang.Add \"msoLanguageIDFrenchReunion\", \"8204\" ' The French Reunion language\ncolLang.Add \"msoLanguageIDFrenchSenegal\", \"10252\" ' The French Senegal language\ncolLang.Add \"msoLanguageIDFrenchWestIndies\", \"7180\" ' The French West Indies language\ncolLang.Add \"msoLanguageIDFranchCongoDRC\", \"9228\" ' The French Congo DRC language\ncolLang.Add \"msoLanguageIDFrisianNetherlands\", \"1122\" ' The Frisian Netherlands language\ncolLang.Add \"msoLanguageIDFulfulde\", \"1127\" ' The Fulfulde language\ncolLang.Add \"msoLanguageIDGaelicIreland\", \"2108\" ' The Irish (Ireland) language\ncolLang.Add \"msoLanguageIDGaelicScotland\", \"1084\" ' The Scottish Gaelic language\ncolLang.Add \"msoLanguageIDGalician\", \"1110\" ' The Galician language\ncolLang.Add \"msoLanguageIDGeorgian\", \"1079\" ' The Georgian language\ncolLang.Add \"msoLanguageIDGerman\", \"1031\" ' The German language\ncolLang.Add \"msoLanguageIDGermanAustria\", \"3079\" ' The German Austria language\ncolLang.Add \"msoLanguageIDGermanLiechtenstein\", \"5127\" ' The German Liechtenstein language\ncolLang.Add \"msoLanguageIDGermanLuxembourg\", \"4103\" ' The German Luxembourg language\ncolLang.Add \"msoLanguageIDGreek\", \"1032\" ' The Greek language\ncolLang.Add \"msoLanguageIDGuarani\", \"1140\" ' The Guarani language\ncolLang.Add \"msoLanguageIDGujarati\", \"1095\" ' The Gujarati language\ncolLang.Add \"msoLanguageIDHausa\", \"1128\" ' The Hausa language\ncolLang.Add \"msoLanguageIDHawaiian\", \"1141\" ' The Hawaiian language\ncolLang.Add \"msoLanguageIDHebrew\", \"1037\" ' The Hebrew language\ncolLang.Add \"msoLanguageIDHindi\", \"1081\" ' The Hindi language\ncolLang.Add \"msoLanguageIDHungarian\", \"1038\" ' The Hungarian language\ncolLang.Add \"msoLanguageIDIbibio\", \"1129\" ' The Ibibio language\ncolLang.Add \"msoLanguageIDIcelandic\", \"1039\" ' The Icelandic language\ncolLang.Add \"msoLanguageIDIgbo\", \"1136\" ' The Igbo language\ncolLang.Add \"msoLanguageIDIndonesian\", \"1057\" ' The Indonesian language\ncolLang.Add \"msoLanguageIDInuktitut\", \"1117\" ' The Inuktitut language\ncolLang.Add \"msoLanguageIDItalian\", \"1040\" ' The Italian language\ncolLang.Add \"msoLanguageIDJapanese\", \"1041\" ' The Japanese language\ncolLang.Add \"msoLanguageIDKannada\", \"1099\" ' The Kannada language\ncolLang.Add \"msoLanguageIDKanuri\", \"1137\" ' The Kanuri language\ncolLang.Add \"msoLanguageIDKashmiri\", \"1120\" ' The Kashmiri language\ncolLang.Add \"msoLanguageIDKashmiriDevanagari\", \"2144\" ' The Kashmiri Devanagari language\ncolLang.Add \"msoLanguageIDKazakh\", \"1087\" ' The Kazakh language\ncolLang.Add \"msoLanguageIDKhmer\", \"1107\" ' The Khmer language\ncolLang.Add \"msoLanguageIDKirghiz\", \"1088\" ' The Kirghiz language\ncolLang.Add \"msoLanguageIDKonkani\", \"1111\" ' The Konkani language\ncolLang.Add \"msoLanguageIDKorean\", \"1042\" ' The Korean language\ncolLang.Add \"msoLanguageIDKyrgyz\", \"1088\" ' The Kyrgyz language\ncolLang.Add \"msoLanguageIDLao\", \"1108\" ' The Lao language\ncolLang.Add \"msoLanguageIDLatin\", \"1142\" ' The Latin language\ncolLang.Add \"msoLanguageIDLatvian\", \"1062\" ' The Latvian language\ncolLang.Add \"msoLanguageIDLithuanian\", \"1063\" ' The Lithuanian language\ncolLang.Add \"msoLanguageIDMacedoninanFYROM\", \"1071\" ' The Macedonian FYROM language\ncolLang.Add \"msoLanguageIDMalayalam\", \"1100\" ' The Malayalam language\ncolLang.Add \"msoLanguageIDMalayBruneiDarussalam\", \"2110\" ' The Malay Brunei Darussalam language\ncolLang.Add \"msoLanguageIDMalaysian\", \"1086\" ' The Malaysian language\ncolLang.Add \"msoLanguageIDMaltese\", \"1082\" ' The Maltese language\ncolLang.Add \"msoLanguageIDManipuri\", \"1112\" ' The Manipuri language\ncolLang.Add \"msoLanguageIDMaori\", \"1153\" ' The Maori language\ncolLang.Add \"msoLanguageIDMarathi\", \"1102\" ' The Marathi language\ncolLang.Add \"msoLanguageIDMexicanSpanish\", \"2058\" ' The Mexican Spanish language\ncolLang.Add \"msoLanguageIDMixed\",   \"-2\"    ' The Mixed language\ncolLang.Add \"msoLanguageIDMongolian\", \"1104\" ' The Mongolian language\ncolLang.Add \"msoLanguageIDNepali\", \"1121\" ' The Nepali language\ncolLang.Add \"msoLanguageIDNone\", \"0\" ' No language specified\ncolLang.Add \"msoLanguageIDNoProofing\", \"1024\" ' No proofing\ncolLang.Add \"msoLanguageIDNorwegianBokmol\", \"1044\" ' The Norwegian Bokmol language\ncolLang.Add \"msoLanguageIDNorwegianNynorsk\", \"2068\" ' The Norwegian Nynorsk language\ncolLang.Add \"msoLanguageIDOriya\", \"1096\" ' The Odia language\ncolLang.Add \"msoLanguageIDOromo\", \"1138\" ' The Oromo language\ncolLang.Add \"msoLanguageIDPashto\", \"1123\" ' The Pashto language\ncolLang.Add \"msoLanguageIDPolish\", \"1045\" ' The Polish language\ncolLang.Add \"msoLanguageIDPortuguese\", \"2070\" ' The Portuguese language\ncolLang.Add \"msoLanguageIDPunjabi\", \"1094\" ' The Punjabi language\ncolLang.Add \"msoLanguageIDQuechuaBolivia\", \"1131\" ' The Quechua Bolivia language\ncolLang.Add \"msoLanguageIDQuechuaEcuador\", \"2155\" ' The Quechua Ecuador language\ncolLang.Add \"msoLanguageIDQuechuaPeru\", \"3179\" ' The Quechua Peru language\ncolLang.Add \"msoLanguageIDRhaetoRomanic\", \"1047\" ' The Rhaeto Romanic language\ncolLang.Add \"msoLanguageIDRomanian\", \"1048\" ' The Romanian language\ncolLang.Add \"msoLanguageIDRomanianMoldova\", \"2072\" ' The Romanian Moldova language\ncolLang.Add \"msoLanguageIDRussian\", \"1049\" ' The Russian language\ncolLang.Add \"msoLanguageIDRussianMoldova\", \"2073\" ' The Russian Moldova language\ncolLang.Add \"msoLanguageIDSamiLappish\", \"1083\" ' The Sami Lappish language\ncolLang.Add \"msoLanguageIDSanskrit\", \"1103\" ' The Sanskrit language\ncolLang.Add \"msoLanguageIDSepedi\", \"1132\" ' The Sepedi language\ncolLang.Add \"msoLanguageIDSerbianBosniaHerzegovinaCyrillic\", \"7194\" ' The Serbian Bosnia Herzegovina Cyrillic language\ncolLang.Add \"msoLanguageIDSerbianBosniaHerzegovinaLatin\", \"6170\" ' The Serbian Bosnia Herzegovina Latin language\ncolLang.Add \"msoLanguageIDSerbianCyrillic\", \"3098\" ' The Serbian Cyrillic language\ncolLang.Add \"msoLanguageIDSerbianLatin\", \"2074\" ' The Serbian Latin language\ncolLang.Add \"msoLanguageIDSesotho\", \"1072\" ' The Sesotho language\ncolLang.Add \"msoLanguageIDSimplifiedChinese\", \"2052\" ' The Simplified Chinese language\ncolLang.Add \"msoLanguageIDSindhi\", \"1113\" ' The Sindhi language\ncolLang.Add \"msoLanguageIDSindhiPakistan\", \"2137\" ' The Sindhi Pakistan language\ncolLang.Add \"msoLanguageIDSinhalese\", \"1115\" ' The Sinhalese language\ncolLang.Add \"msoLanguageIDSlovak\", \"1051\" ' The Slovak language\ncolLang.Add \"msoLanguageIDSlovenian\", \"1060\" ' The Slovenian language\ncolLang.Add \"msoLanguageIDSomali\", \"1143\" ' The Somali language\ncolLang.Add \"msoLanguageIDSorbian\", \"1070\" ' The Sorbian language\ncolLang.Add \"msoLanguageIDSpanish\", \"1034\" ' The Spanish language\ncolLang.Add \"msoLanguageIDSpanishArgentina\", \"11274\" ' The Spanish Argentina language\ncolLang.Add \"msoLanguageIDSpanishBolivia\", \"16394\" ' The Spanish Bolivia language\ncolLang.Add \"msoLanguageIDSpanishChile\", \"13322\" ' The Spanish Chile language\ncolLang.Add \"msoLanguageIDSpanishColombia\", \"9226\" ' The Spanish Colombia language\ncolLang.Add \"msoLanguageIDSpanishCostaRica\", \"5130\" ' The Spanish Costa Rica language\ncolLang.Add \"msoLanguageIDSpanishDominicanRepublic\", \"7178\" ' The Spanish Dominican Republic language\ncolLang.Add \"msoLanguageIDSpanishEcuador\", \"12298\" ' The Spanish Ecuador language\ncolLang.Add \"msoLanguageIDSpanishElSalvador\", \"17418\" ' The Spanish El Salvador language\ncolLang.Add \"msoLanguageIDSpanishGuatemala\", \"4106\" ' The Spanish Guatemala language\ncolLang.Add \"msoLanguageIDSpanishHonduras\", \"18442\" ' The Spanish Honduras language\ncolLang.Add \"msoLanguageIDSpanishModernSort\", \"3082\" ' The Spanish Modern Sort language\ncolLang.Add \"msoLanguageIDSpanishNicaragua\", \"19466\" ' The Spanish Nicaragua language\ncolLang.Add \"msoLanguageIDSpanishPanama\", \"6154\" ' The Spanish Panama language\ncolLang.Add \"msoLanguageIDSpanishParaguay\", \"15370\" ' The Spanish Paraguay language\ncolLang.Add \"msoLanguageIDSpanishPeru\", \"10250\" ' The Spanish Peru language\ncolLang.Add \"msoLanguageIDSpanishPuertoRico\", \"20490\" ' The Spanish Puerto Rico language\ncolLang.Add \"msoLanguageIDSpanishUruguay\", \"14346\" ' The Spanish Uruguay language\ncolLang.Add \"msoLanguageIDSpanishVenezuela\", \"8202\" ' The Spanish Venezuela language\ncolLang.Add \"msoLanguageIDSutu\", \"1072\" ' The Sutu language\ncolLang.Add \"msoLanguageIDSwahili\", \"1089\" ' The Swahili language\ncolLang.Add \"msoLanguageIDSwedish\", \"1053\" ' The Swedish language\ncolLang.Add \"msoLanguageIDSwedishFinland\", \"2077\" ' The Swedish Finland language\ncolLang.Add \"msoLanguageIDSwissFrench\", \"4108\" ' The Swiss French language\ncolLang.Add \"msoLanguageIDSwissGerman\", \"2055\" ' The Swiss German language\ncolLang.Add \"msoLanguageIDSwissItalian\", \"2064\" ' The Swiss Italian language\ncolLang.Add \"msoLanguageIDSyriac\", \"1114\" ' The Syriac language\ncolLang.Add \"msoLanguageIDTajik\", \"1064\" ' The Tajik language\ncolLang.Add \"msoLanguageIDTamazight\", \"1119\" ' The Tamazight language\ncolLang.Add \"msoLanguageIDTamazightLatin\", \"2143\" ' The Tamazight Latin language\ncolLang.Add \"msoLanguageIDTamil\", \"1097\" ' The Tamil language\ncolLang.Add \"msoLanguageIDTatar\", \"1092\" ' The Tatar language\ncolLang.Add \"msoLanguageIDTelugu\", \"1098\" ' The Telugu language\ncolLang.Add \"msoLanguageIDThai\", \"1054\" ' The Thai language\ncolLang.Add \"msoLanguageIDTibetan\", \"1105\" ' The Tibetan language\ncolLang.Add \"msoLanguageIDTigrignaEritrea\", \"2163\" ' The Tigrigna Eritrea language\ncolLang.Add \"msoLanguageIDTigrignaEthiopic\", \"1139\" ' The Tigrigna Ethiopic language\ncolLang.Add \"msoLanguageIDTraditionalChinese\", \"1028\" ' The Traditional Chinese language\ncolLang.Add \"msoLanguageIDTsonga\", \"1073\" ' The Tsonga language\ncolLang.Add \"msoLanguageIDTswana\", \"1074\" ' The Tswana language\ncolLang.Add \"msoLanguageIDTurkish\", \"1055\" ' The Turkish language\ncolLang.Add \"msoLanguageIDTurkmen\", \"1090\" ' The Turkmen language\ncolLang.Add \"msoLanguageIDUkrainian\", \"1058\" ' The Ukrainian language\ncolLang.Add \"msoLanguageIDUrdu\", \"1056\" ' The Urdu language\ncolLang.Add \"msoLanguageIDUzbekCyrillic\", \"2115\" ' The Uzbek Cyrillic language\ncolLang.Add \"msoLanguageIDUzbekLatin\", \"1091\" ' The Uzbek Latin language\ncolLang.Add \"msoLanguageIDVenda\", \"1075\" ' The Venda language\ncolLang.Add \"msoLanguageIDVietnamese\", \"1066\" ' The Vietnamese language\ncolLang.Add \"msoLanguageIDWelsh\", \"1106\" ' The Welsh language\ncolLang.Add \"msoLanguageIDXhosa\", \"1076\" ' The Xhosa language\ncolLang.Add \"msoLanguageIDYi\", \"1144\" ' The Yi language\ncolLang.Add \"msoLanguageIDYiddish\", \"1085\" ' The Yiddish language\ncolLang.Add \"msoLanguageIDYoruba\", \"1130\" ' The Yoruba language\ncolLang.Add \"msoLanguageIDZulu\", \"1077\" ' The Zulu language\n\ncolLang(\"1130\") ' Would return msoLanguageIDYoruba\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12590339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476617d600322c95d725afc6e3048dd?s=128&d=identicon&r=PG&f=1", "display_name": "vvilku", "link": "https://stackoverflow.com/users/12590339/vvilku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582096268, "creation_date": 1577182745, "last_edit_date": 1582096268, "question_id": 59467255, "link": "https://stackoverflow.com/questions/59467255/how-to-correctly-pass-an-argument-from-an-inbuilt-office-enum-from-ribbon-to-vba", "title": "How to correctly pass an argument from an inbuilt Office enum from Ribbon to VBA Macro?", "body": "<p>I'm using PowerPoint extensively in multiple languages, and I have a macro that changes the language of each box across the presentation. I call the macro with an argument from the Ribbon, passing the argument as a Tag (as I haven't found any other working method, I can't just call sub(argument) in the Ribbon XML). The problem is, that it only works, when I use an explicit numeric argument (ID of a language), and can't use the name from msoLanguageID enum.</p>\n\n<p>Ribbon XML:</p>\n\n<pre><code>&lt;button \nid=\"Lang_UK\" \nlabel=\"English (UK)\" \nsize=\"normal\" \nimageMso=\"SetLanguage\"\nonAction=\"langChange\"\ntag=\"2057\"\n/&gt;\n</code></pre>\n\n<p>Control Sub:</p>\n\n<pre><code>Public Sub langChange(control As IRibbonControl)\n    Call Macros.ChangeSpellCheckLang(control.Tag)\nEnd Sub\n</code></pre>\n\n<p>And the final procedure:</p>\n\n<pre><code>Sub ChangeSpellCheckLang(lang As Integer)\n(...)\n.Text.Range.LanguageID = lang\nEnd Sub\n</code></pre>\n\n<p>This works, but if I change the tag from 2057 to msoLanguageIDEnglishUK I get an error (13) Type mismatch. I tried changing the final procedure to lang as String or Variant, but I keep getting the same error. I know that msoLanguageIDEnglishUK would work, as previously my final procedure didn't use an argument - instead I just explicitly set ...Text.Range.LanguageID = msoLanguageIDEnglishUK and it worked.</p>\n\n<p>So, how can I avoid hardcoding language IDs, while still being able to pass them as arguments for the procedure from the Ribbon?</p>\n\n<p>// EDIT:\nWhat is the most surprising part, the error is thrown in langChange Sub in</p>\n\n<pre><code>Call Macros.ChangeSpellCheckLang(control.Tag)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577181393, "post_id": 59466905, "comment_id": 105113488, "body": "The <code>Weekday()</code> function being 7 just tells you that it&#39;s a Saturday. Is that your intent? Have you looked into <code>DateDiff()</code>? It is not clear what you mean by &quot;check weekend&quot;."}, {"owner": {"reputation": 43, "user_id": 11989201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c189da83829c992b7ec497f33ce09aca?s=128&d=identicon&r=PG&f=1", "display_name": "Bimka09", "link": "https://stackoverflow.com/users/11989201/bimka09"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577181503, "post_id": 59466905, "comment_id": 105113531, "body": "Yes, I need to know if this is weekend. Then I receive the indicator (True)"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577181559, "post_id": 59466905, "comment_id": 105113553, "body": "So a Sunday doesn&#39;t count as being on the weekend?"}, {"owner": {"reputation": 43, "user_id": 11989201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c189da83829c992b7ec497f33ce09aca?s=128&d=identicon&r=PG&f=1", "display_name": "Bimka09", "link": "https://stackoverflow.com/users/11989201/bimka09"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577181616, "post_id": 59466905, "comment_id": 105113572, "body": "Why? I count that as weekend"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 11989201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c189da83829c992b7ec497f33ce09aca?s=128&d=identicon&r=PG&f=1", "display_name": "Bimka09", "link": "https://stackoverflow.com/users/11989201/bimka09"}, "edited": false, "score": 0, "creation_date": 1577182374, "post_id": 59467050, "comment_id": 105113845, "body": "Sorry, I don&#39;t understand this logic. Can you explain?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 43, "user_id": 11989201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c189da83829c992b7ec497f33ce09aca?s=128&d=identicon&r=PG&f=1", "display_name": "Bimka09", "link": "https://stackoverflow.com/users/11989201/bimka09"}, "edited": false, "score": 0, "creation_date": 1577198258, "post_id": 59467050, "comment_id": 105119280, "body": "@Bimka09 Google and learn it, it&#39;s two excel functions <code>DateDiff</code> and <code>NetworkDays</code>"}, {"owner": {"reputation": 43, "user_id": 11989201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c189da83829c992b7ec497f33ce09aca?s=128&d=identicon&r=PG&f=1", "display_name": "Bimka09", "link": "https://stackoverflow.com/users/11989201/bimka09"}, "edited": false, "score": 0, "creation_date": 1577356403, "post_id": 59467050, "comment_id": 105149153, "body": "I know about it but it isn&#39;t what i was looking for"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 43, "user_id": 11989201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c189da83829c992b7ec497f33ce09aca?s=128&d=identicon&r=PG&f=1", "display_name": "Bimka09", "link": "https://stackoverflow.com/users/11989201/bimka09"}, "edited": false, "score": 0, "creation_date": 1577534914, "post_id": 59467050, "comment_id": 105193392, "body": "It checks whether the working days <code>networkdays</code> between two dates subtracted from the actual number <code>datediff</code> of days is greater than 0 <code>&gt;0</code>"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1577181764, "creation_date": 1577181764, "answer_id": 59467050, "question_id": 59466905, "link": "https://stackoverflow.com/questions/59466905/how-to-extract-date-from-datetime-value-to-check-for-the-weekend-between-two-dat/59467050#59467050", "title": "How to extract date from datetime value to check for the weekend between two dates?", "body": "<p>You can avoid the loop with something like so.</p>\n\n<pre><code>Function check_weekend(dtStart As Date, dtEnd As Date) As Boolean\n\ncheck_weekend = DateDiff(\"d\", dtStart, dtEnd) - _\n                WorksheetFunction.NetworkDays(dtStart, dtEnd) &gt; 0\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 2, "last_activity_date": 1577186185, "last_edit_date": 1577186185, "creation_date": 1577185791, "answer_id": 59467905, "question_id": 59466905, "link": "https://stackoverflow.com/questions/59466905/how-to-extract-date-from-datetime-value-to-check-for-the-weekend-between-two-dat/59467905#59467905", "title": "How to extract date from datetime value to check for the weekend between two dates?", "body": "<p>Try:</p>\n\n<pre><code>Function Check_Weeknd(start_date As Date, end_date As Date) As Boolean\n    Dim D As Date\n    For D = Int(start_date) To Int(end_date)\n        If Weekday(D) = vbSaturday Or _\n            Weekday(D) = vbSunday Then\n                Check_Weeknd = True\n                Exit Function\n        End If\n    Next D\n End Function\n</code></pre>\n\n<p>I added the <code>Int</code> function to show how to get rid of the Time, but it's not necessary in this function, as <code>Weekday</code> only operates on the date portion.</p>\n\n<p>Perhaps, a bit better:  no <code>Int</code> function and the second date entry is optional, so you can test a single date if you need to:</p>\n\n<pre><code>Function Check_Weeknd(start_date As Date, Optional end_date As Date) As Boolean\n    Dim D As Date\n    If end_date = 0 Then end_date = start_date\n    For D = start_date To end_date\n        If Weekday(D) = vbSaturday Or _\n            Weekday(D) = vbSunday Then\n                Check_Weeknd = True\n                Exit Function\n        End If\n    Next D\n End Function\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 11989201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c189da83829c992b7ec497f33ce09aca?s=128&d=identicon&r=PG&f=1", "display_name": "Bimka09", "link": "https://stackoverflow.com/users/11989201/bimka09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 59467905, "answer_count": 2, "score": 0, "last_activity_date": 1580927494, "creation_date": 1577181066, "last_edit_date": 1580927494, "question_id": 59466905, "link": "https://stackoverflow.com/questions/59466905/how-to-extract-date-from-datetime-value-to-check-for-the-weekend-between-two-dat", "title": "How to extract date from datetime value to check for the weekend between two dates?", "body": "<p>I need to check for the weekend between two dates.</p>\n\n<p>row data:</p>\n\n<pre><code>29/11/2019  12:45:43  and 30/11/2019  12:45:43\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Function Check_Weeknd(start_date As Date, end_date As Date) As Boolean\n\nWhile start_date &lt;&gt; end_date\n    start_date = DateAdd(\"d\", 1, start_date)\n    If Weekday(start_date) = 7 Then\n         Check_Weeknd = True\n    End If\n Wend\n End Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577177051, "post_id": 59465809, "comment_id": 105111906, "body": "On which line do you get the error?"}, {"owner": {"reputation": 1, "user_id": 12589623, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156832914696485/picture?type=large", "display_name": "Celine Low", "link": "https://stackoverflow.com/users/12589623/celine-low"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577177877, "post_id": 59465809, "comment_id": 105112192, "body": "Sub cl_macro2()   cl_macro2 macro &#39;     Dim Concur As Worksheet, SunAccCode As Worksheet     Dim ConcurLastRow As Long, SunAccCodeLastRow As Long, x As Long     Dim SunAccCodeRng As Range"}, {"owner": {"reputation": 1, "user_id": 12589623, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156832914696485/picture?type=large", "display_name": "Celine Low", "link": "https://stackoverflow.com/users/12589623/celine-low"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577177931, "post_id": 59465809, "comment_id": 105112211, "body": "The yellow pointer line is at Sub cl_macro2()"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577177975, "post_id": 59465809, "comment_id": 105112228, "body": "I&#39;ll edit your question to see if I understand what you mean. Is that what it looks like? If so, remove the 2nd line. If that&#39;s not what it looks like, please edit your question to make it look like what it looks like in your code window. Do not post the code in a comment."}, {"owner": {"reputation": 1, "user_id": 12589623, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156832914696485/picture?type=large", "display_name": "Celine Low", "link": "https://stackoverflow.com/users/12589623/celine-low"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577178472, "post_id": 59465809, "comment_id": 105112393, "body": "Thanks braX!! It&#39;s successful after i delete the second line. Wondering why this happen but sometimes it can ?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1577179329, "post_id": 59465809, "comment_id": 105112713, "body": "comments should be <i>preceded</i> with a &#39; symbol"}], "answers": [{"tags": [], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "is_accepted": false, "score": 0, "last_activity_date": 1577194609, "creation_date": 1577194609, "answer_id": 59469639, "question_id": 59465809, "link": "https://stackoverflow.com/questions/59465809/vlookup-in-vba-from-different-sheets-coding-error/59469639#59469639", "title": "Vlookup in VBA from different sheets - coding error", "body": "<p>The second line of your code reads:</p>\n\n<pre><code>cl_macro2 macro '\n</code></pre>\n\n<p>This appears to be a (meaningless) comment, but without the apostrophe at the beginning of the line telling VBA not to execute it.</p>\n\n<p>What's actually happening is that VBA is trying to execute this line as if it were code. As written, it means the sub is trying to call itself - and pass an argument (variable) called \"macro\". But since the sub doesn't take any arguments, you get an error.</p>\n\n<p>For a comment, you need to insert a ' like this:</p>\n\n<pre><code>' cl_macro2 macro '\n</code></pre>\n\n<p>Otherwise, just delete the whole line.</p>\n"}], "owner": {"reputation": 1, "user_id": 12589623, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156832914696485/picture?type=large", "display_name": "Celine Low", "link": "https://stackoverflow.com/users/12589623/celine-low"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577194609, "creation_date": 1577175323, "last_edit_date": 1577178918, "question_id": 59465809, "link": "https://stackoverflow.com/questions/59465809/vlookup-in-vba-from-different-sheets-coding-error", "title": "Vlookup in VBA from different sheets - coding error", "body": "<p>i am new to VBA. I got this code but when it runs, it shows this error message :</p>\n\n<blockquote>\n  <p>Wrong number of argument or invalid property assignment.</p>\n</blockquote>\n\n<p>This is my code when i copied it from somewhere and editing myself :</p>\n\n<pre><code>Sub cl_macro2() \n    cl_macro2 macro '\n    Dim Concur As Worksheet, SunAccCode As Worksheet\n    Dim ConcurLastRow As Long, SunAccCodeLastRow As Long, x As Long\n    Dim SunAccCodeRng As Range\n\n    Set Concur = ThisWorkbook.Worksheets(\"Concur\")\n    Set SunAccCode = ThisWorkbook.Worksheets(\"SunAccCode\")\n\n    ConcurLastRow = Concur.Range(\"I\" &amp; Rows.Count).End(xlUp).Row\n    SunAccCodeLastRow = SunAccCode.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Set SunAccCodeRng = SunAccCode.Range(\"A1:C\" &amp; SunAccCodeLastRow)\n\n    For x = 2 To ConcurLastRow\n    On Error Resume Next\n    Concur.Range(\"J\" &amp; x).Value = Application.WorksheetFunction.VLookup(Concur.Range(\"I\" &amp; x).Value, SunAccCodeRng, 3, 0)\n\n    Next x\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1577174913, "post_id": 59464584, "comment_id": 105111281, "body": "For one, <code>IIF(InStr(1,[Name],&#39;Overwater&#39;,1)&lt;&gt;0,&#39;Overwater,</code> is missing a single quote causing the expression to get parsed incorrectly. Secondly, don&#39;t nest many <code>IIF</code>s, use <code>SWITCH</code> instead"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1577177812, "post_id": 59464584, "comment_id": 105112165, "body": "<code>Tower</code> is also missing second apostrophe."}], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 4, "last_activity_date": 1577185478, "creation_date": 1577185478, "answer_id": 59467834, "question_id": 59464584, "link": "https://stackoverflow.com/questions/59464584/expression-too-complex-in-query-expression-vba-access/59467834#59467834", "title": "Expression too complex in query expression vba access", "body": "<p>As noted in the comments, your current code is missing a couple of single quotes to terminate the strings that you are testing, and would be better written using a single <a href=\"https://support.office.com/en-gb/article/switch-function-d750c10d-0c8e-444c-9e63-f47504f9e379\" rel=\"nofollow noreferrer\"><code>switch</code></a> statement rather than multiple nested <a href=\"https://support.office.com/en-gb/article/iif-function-32436ecf-c629-48a3-9900-647539c764e3\" rel=\"nofollow noreferrer\"><code>iif</code></a> statements, e.g.:</p>\n\n<pre><code>update finaldata set [area] = \nswitch\n(\n    instr([name],'PoolSide')&lt;&gt;0,'PoolSide',\n    instr([name],'Mountainside')&lt;&gt;0,'Mountainside',\n    instr([name],'Garden Area')&lt;&gt;0,'Garden Area',\n    instr([name],'Ground Floor')&lt;&gt;0,'Ground Floor',\n    instr([name],'Annex Building')&lt;&gt;0,'Annex Building',\n    instr([name],'Beachside')&lt;&gt;0,'Beachside',\n    instr([name],'Beachfront')&lt;&gt;0,'Beachfront',\n    instr([name],'Mountainside')&lt;&gt;0,'Mountainside',\n    instr([name],'Executive')&lt;&gt;0,'Executive Level',\n    instr([name],'Lakeside')&lt;&gt;0,'Lakeside',\n    instr([name],'Mezzanine')&lt;&gt;0,'Mezzanine',\n    instr([name],'Oceanfront')&lt;&gt;0,'Oceanfront',\n    instr([name],'Overwater')&lt;&gt;0,'Overwater',\n    instr([name],'Slope side')&lt;&gt;0,'Slope side',\n    instr([name],'Tower')&lt;&gt;0,'Tower',\n    true,'Delete'\n)\n</code></pre>\n\n<p>Where performance is concerned, rather than repeated use of the <a href=\"https://support.office.com/en-gb/article/instr-function-85d3392c-3b1c-4232-bb18-77cd0cb8a55b\" rel=\"nofollow noreferrer\"><code>instr</code></a> function, which is returning unnecessary positional data about the substring within the string, you may find it quicker to use the <a href=\"https://support.office.com/en-gb/article/like-operator-b2f7ef03-9085-4ffb-9829-eef18358e931\" rel=\"nofollow noreferrer\"><code>like</code></a> operator, e.g.:</p>\n\n<pre><code>update finaldata set [area] = \nswitch\n(\n    [name] like '*PoolSide*','PoolSide',\n    [name] like '*Mountainside*','Mountainside',\n    [name] like '*Garden Area*','Garden Area',\n    [name] like '*Ground Floor*','Ground Floor',\n    [name] like '*Annex Building*','Annex Building',\n    [name] like '*Beachside*','Beachside',\n    [name] like '*Beachfront*','Beachfront',\n    [name] like '*Mountainside*','Mountainside',\n    [name] like '*Executive*','Executive Level',\n    [name] like '*Lakeside*','Lakeside',\n    [name] like '*Mezzanine*','Mezzanine',\n    [name] like '*Oceanfront*','Oceanfront',\n    [name] like '*Overwater*','Overwater',\n    [name] like '*Slope side*','Slope side',\n    [name] like '*Tower*','Tower',\n    true,'Delete'\n)\n</code></pre>\n\n<p>And given that this is operating on the entire dataset and could be performing up to 15 comparisons per record when executed, it may be quicker to evaluate 16 separate queries, each with the following structure:</p>\n\n<pre><code>update finaldata set [area] = 'PoolSide' where [name] like '*PoolSide*'\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7247091, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153072147051971/picture?type=large", "display_name": "Natalia Fontiveros", "link": "https://stackoverflow.com/users/7247091/natalia-fontiveros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 59467834, "answer_count": 1, "score": 0, "last_activity_date": 1593675494, "creation_date": 1577168111, "last_edit_date": 1593675494, "question_id": 59464584, "link": "https://stackoverflow.com/questions/59464584/expression-too-complex-in-query-expression-vba-access", "title": "Expression too complex in query expression vba access", "body": "<p>Hi Friends from stackoverflow</p>\n\n<p>I ran into an issue with access and sql, find below my query </p>\n\n<pre><code>update finaldata set [Area]=\nIIF(InStr(1,[Name],'PoolSide',1)&lt;&gt;0,'PoolSide',\nIIF(InStr(1,[Name],'Mountainside',1)&lt;&gt;0,'Mountainside',\nIIF(InStr(1,[Name],'Garden Area',1)&lt;&gt;0,'Garden Area',\nIIF(InStr(1,[Name],'Ground Floor',1)&lt;&gt;0,'Ground Floor',\nIIF(InStr(1,[Name],'Annex Building',1)&lt;&gt;0,'Annex Building',\nIIF(InStr(1,[Name],'Beachside',1)&lt;&gt;0,'Beachside',\nIIF(InStr(1,[Name],'Beachfront',1)&lt;&gt;0,'Beachfront',\nIIF(InStr(1,[Name],'Mountainside',1)&lt;&gt;0,'Mountainside',\nIIF(InStr(1,[Name],'Executive',1)&lt;&gt;0,'Executive Level',\nIIF(InStr(1,[Name],'Lakeside',1)&lt;&gt;0,'Lakeside',\nIIF(InStr(1,[Name],'Mezzanine',1)&lt;&gt;0,'Mezzanine',\nIIF(InStr(1,[Name],'Oceanfront',1)&lt;&gt;0,'Oceanfront',\nIIF(InStr(1,[Name],'Overwater',1)&lt;&gt;0,'Overwater,\nIIF(InStr(1,[Name],'Slope side',1)&lt;&gt;0,'Slope side',\nIIF(InStr(1,[Name],'Tower',1)&lt;&gt;0,'Tower,'Delete'\n)))))))))))))))\n</code></pre>\n\n<p>I have 100k records, I dont want to use recordset it takes too long i already tried it. I have to many inner joins and my database file it's getting larger. </p>\n\n<p>what are my options to process the strings? I have a long long string stored in [Name] with many characteristics of a room. I am trying to decipher the name.</p>\n\n<p>if my only option is a record set, what would be faster to process a nested if or select case?</p>\n\n<p>Thank you for your time and help</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 17, "user_id": 10706993, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t-Fgs6xyX8M/AAAAAAAAAAI/AAAAAAAAAWY/7Iieu5dKe7I/photo.jpg?sz=128", "display_name": "Jugal Kishor", "link": "https://stackoverflow.com/users/10706993/jugal-kishor"}, "edited": false, "score": 2, "creation_date": 1577193903, "post_id": 59464997, "comment_id": 105117917, "body": "If the problem you were facing is solved, make sure to tick the grayed out checkmark next to my answer to accept it as a solution. Thanks."}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1579081545, "post_id": 59464997, "comment_id": 105644143, "body": "Hello. When testing the code, I got Access denied. Is that related to some restrictions on the url. Although when navigating to the url, it works with no problems."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1579092490, "post_id": 59464997, "comment_id": 105649819, "body": "The requested url is different now. Try the modified one. It should work."}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 1, "last_activity_date": 1579092437, "last_edit_date": 1579092437, "creation_date": 1577170637, "answer_id": 59464997, "question_id": 59464067, "link": "https://stackoverflow.com/questions/59464067/how-to-get-inner-text-in-html-under-id/59464997#59464997", "title": "How to get inner text in html under &quot;id&quot;", "body": "<p>You can do it in different ways. Turn out that you look for the wrong key to get it's value. The right key here is <code>totalTradedVolume</code>.</p>\n\n<p>One way:</p>\n\n<pre><code>Sub GetPrice()\n    Const URL = \"https://www1.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol=PEL\"\n    Dim Html As New HTMLDocument, elem$, price$\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", URL, False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        Html.body.innerHTML = .responseText\n    End With\n\n    elem = Html.querySelector(\"#responseDiv\").innerText\n    price = Split(Split(elem, \"totalTradedVolume\"\":\"\"\")(1), \"\"\",\")(0)\n\n    MsgBox price\n\nEnd Sub\n</code></pre>\n\n<p>If you stick to the way you have tried already, bring about this small change within it:</p>\n\n<pre><code>p = \"\"\"totalTradedVolume\"\":\"\"(.*?)\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10706993, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-t-Fgs6xyX8M/AAAAAAAAAAI/AAAAAAAAAWY/7Iieu5dKe7I/photo.jpg?sz=128", "display_name": "Jugal Kishor", "link": "https://stackoverflow.com/users/10706993/jugal-kishor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 59464997, "answer_count": 1, "score": 0, "last_activity_date": 1579092437, "creation_date": 1577164016, "last_edit_date": 1577164118, "question_id": 59464067, "link": "https://stackoverflow.com/questions/59464067/how-to-get-inner-text-in-html-under-id", "title": "How to get inner text in html under &quot;id&quot;", "body": "<p>i am trying this. I am stuck for my project please help to bring this specific point under \"id\".</p>\n\n<pre><code>Option Explicit\nPublic Sub GetlastPrice()\nDim ws As Worksheet, re As Object, p As String, r As String, URL As String\n\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\np = \"\"\"tradedVolume\"\":\"\"(.*?)\"\"\"\nSet re = CreateObject(\"VBScript.RegExp\")\n\nURL = \"https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol=PEL\"\nWith CreateObject(\"MSXML2.XMLHTTP\")\n    .Open \"GET\", URL, False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        If .Status = 200 Then\n            r = GetValue(re, .responseText, p)\n        Else\n            r = \"Failed connection\"\n        End If\nEnd With\nws.Range(\"B2\").Value = r\n\n\nEnd Sub\n\nPublic Function GetValue(ByVal re As Object, ByVal inputString As String, ByVal pattern As String) As String\nWith re\n    .Global = True\n    .pattern = pattern\n    If .test(inputString) Then  ' returns True if the regex pattern can be matched agaist the provided string\n        GetValue = .Execute(inputString)(0).submatches(0)\n    Else\n        GetValue = \"Not found\"\n    End If\nEnd With\nEnd Function\n</code></pre>\n\n<p>The marked value i want in my excel sheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/x2svG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x2svG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 55, "user_id": 12478546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1f14bc3ed49a52286b18bbd30c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin.aaa2", "link": "https://stackoverflow.com/users/12478546/kelvin-aaa2"}, "edited": false, "score": 0, "creation_date": 1577161258, "post_id": 59463690, "comment_id": 105108038, "body": "I think my main problem is, using the concept of Contain, if that cell contain XXX, then return YYY. But what I need is If a cell&#39;s string starts with XXX, then return YYY"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1577162382, "post_id": 59463690, "comment_id": 105108228, "body": "You know you can achieve this using conditional formatting? <b>Use a formula to determine which cells to format</b> <code>=LEFT($A1,1)=&quot;-&quot;</code>"}, {"owner": {"reputation": 55, "user_id": 12478546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1f14bc3ed49a52286b18bbd30c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin.aaa2", "link": "https://stackoverflow.com/users/12478546/kelvin-aaa2"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577162495, "post_id": 59463690, "comment_id": 105108246, "body": "conditional formatting is not suitable for my situation as my column A is dynamic, which change from time to time. I cannot set a specific range for conditional formatting"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1577162594, "post_id": 59463690, "comment_id": 105108257, "body": "Correct me if I am wrong but isn&#39;t that what you will also do in VBA, change <code>Set SrchRng3 = ws.Range(&quot;A1&quot;, ws.Range(&quot;A65536&quot;).End(xlUp))</code> everytime A changes? Or have I misunderstood you?"}, {"owner": {"reputation": 55, "user_id": 12478546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1f14bc3ed49a52286b18bbd30c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin.aaa2", "link": "https://stackoverflow.com/users/12478546/kelvin-aaa2"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577163328, "post_id": 59463690, "comment_id": 105108402, "body": "@SiddharthRout   Basically, Column A contains ~ 600 records, from A5 to A605. Now the case is, those records are from externally database, each time I refresh, some might change/add/less.  Here is their format, CELL A5 = 150311-Surface R CELL A6 = 250311-Surface E CELL A7 = 350311-Surface K CELL A8 = -Surface ABC  My VBA code is looking for those cell in column A with &quot;-*&quot; So it return all of them to me as they all contains &quot;-Surface&quot; But all I want is simply &quot;-Surface ABC&quot;, which starts with &quot;-&quot;, instead of the others, which contains &quot;-&quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1577163796, "post_id": 59463690, "comment_id": 105108489, "body": "It doesn&#39;t matter if the data changes. the formula will highlight all the rows where &quot;-&quot; is the <b>first</b> character in Col A"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1577164244, "post_id": 59463690, "comment_id": 105108590, "body": "The answer that you have selected below works on the same principle :D <code>=LEFT($A1,1)=&quot;-&quot;</code>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577174157, "post_id": 59463690, "comment_id": 105111042, "body": "Conditional formatting seems to do just fine as per the other comments. If not, you can avoid a loop through worksheet objects/cells through an AutoFilter or Evaluate (to return an array of rows to highlight)"}], "answers": [{"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1577174533, "post_id": 59463980, "comment_id": 105111158, "body": "you have to add <code>ELSE</code> in yout <code>IF STATEMENT</code> to remove fil when the row does not start from <code>-</code>"}], "tags": [], "owner": {"reputation": 28, "user_id": 11425956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc525bc74909ff5495ce7527b5a3804?s=128&d=identicon&r=PG&f=1", "display_name": "Sergiu", "link": "https://stackoverflow.com/users/11425956/sergiu"}, "is_accepted": true, "score": 1, "last_activity_date": 1577163284, "creation_date": 1577163284, "answer_id": 59463980, "question_id": 59463690, "link": "https://stackoverflow.com/questions/59463690/change-entire-row-color-if-the-first-characters-in-a-cell-is/59463980#59463980", "title": "Change entire row color if the first characters in a cell is &quot;-&quot;", "body": "<p>its because <code>Find</code> is going to search for \"-\" inside the string as well. Not necessarily from the beginning of the string.</p>\n\n<p>see if this helps you, its a simple for loop, that will check if the First letter of the string in column A, is \"-\" , and then color that full row.</p>\n\n<pre><code>Sub color()\n\nDim lastrow As Long\nDim i As Long\n\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row    'check the last cell from A that has value\n\nFor i = 2 To lastrow                                'start to loop through column A, from second row if maybe you have a header\n    If Left(Cells(i, 1).Value, 1) = \"-\" Then        'check if first charcater is \"-\"\n       Cells(i, 1).EntireRow.Interior.color = RGB(255, 0, 0)   ' if first characther is \"-\", color entire row\n    End If\nNext i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 12478546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d1f14bc3ed49a52286b18bbd30c50a4?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin.aaa2", "link": "https://stackoverflow.com/users/12478546/kelvin-aaa2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 59463980, "answer_count": 1, "score": 0, "last_activity_date": 1577163284, "creation_date": 1577160190, "last_edit_date": 1577160346, "question_id": 59463690, "link": "https://stackoverflow.com/questions/59463690/change-entire-row-color-if-the-first-characters-in-a-cell-is", "title": "Change entire row color if the first characters in a cell is &quot;-&quot;", "body": "<p>I would like to change entire row color if the first character of the cells in column A = \"-\"</p>\n\n<p>Here is my work, I successfully color the row, but it also colored other rows, which the first character of the cells in column A &lt;> \"-\"</p>\n\n<p>CEll A1 (-ABS) ///////////////////\nCEll A2 (12345-Surface Import)  ----> I don't want this row to be colored</p>\n\n<pre><code>Dim Wb3 As Excel.Workbook\nSet Wb3 = Application.Workbooks(\"Test template.xlsm\")\n\nDim ws As Worksheet\n\nFor Each ws In Wb3.Sheets\n\n Dim SrchRng3 As Range\n Dim c3 As Range, f As String\n\n\n Set SrchRng3 = ws.Range(\"A1\", ws.Range(\"A65536\").End(xlUp))\n Set c3 = SrchRng3.Find(\"-*\", LookIn:=xlValues)\n If Not c3 Is Nothing Then\n f = c3.Address\n Do\n With ws.Range(\"C\" &amp; c3.Row &amp; \":N\" &amp; c3.Row)\n .Font.ColorIndex = 2\n .Interior.ColorIndex = 24\n End With\n Set c3 = SrchRng3.FindNext(c3)\n Loop While c3.Address &lt;&gt; f\n End If\n\n\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "edited": false, "score": 0, "creation_date": 1577162096, "post_id": 59463855, "comment_id": 105108179, "body": "I don&#39;t have excel with me to test, test it and tell me if it works, or what it outputs.."}], "tags": [], "owner": {"reputation": 1023, "user_id": 11825320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DfuV5.jpg?s=128&g=1", "display_name": "Atreyagaurav", "link": "https://stackoverflow.com/users/11825320/atreyagaurav"}, "is_accepted": false, "score": 0, "last_activity_date": 1577161996, "creation_date": 1577161996, "answer_id": 59463855, "question_id": 59463674, "link": "https://stackoverflow.com/questions/59463674/how-do-i-simplify-this/59463855#59463855", "title": "How do I simplify this", "body": "<p>You are unnecessarily using the split to get address. You could use <code>Cells(n,m).Address(False, False) instead of</code>Split(Cells(1, m).Address, \"$\")(1) &amp; n `</p>\n\n<p>then use string concat to get the whole formula,</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>stri = \"=\" &amp; Cells(52,n + first - 1).Address(False, False)\ni=5\nDo While i &lt; 48 \n   stri = stri &amp; \"+\" &amp; Cells(i,n + first).Address(False, False)\n   i=i+3\nLoop\nws1.Cells(n + first, 52).Formula = stri\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12402191, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7qtahnHJ5Nc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reXPe8LU4sC9udMle4o9rSeHsPPqQ/photo.jpg?sz=128", "display_name": "matthew wilcox", "link": "https://stackoverflow.com/users/12402191/matthew-wilcox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577174795, "creation_date": 1577160022, "last_edit_date": 1577174795, "question_id": 59463674, "link": "https://stackoverflow.com/questions/59463674/how-do-i-simplify-this", "title": "How do I simplify this", "body": "<p>I am attempting to write a code that is applied to old files stored on my hard drive. I have written the code and it works but it rather long and as sections repeat itself it could use some simplifying.</p>\n\n<p>Because the old files change slightly the location of the sum may change which is why I use variables for row references. the code in question is </p>\n\n<pre><code>ws1.Cells(n + first, 52).Formula = \"=\" &amp; Split(Cells(1, 52).Address, \"$\")(1) &amp; n + first - 1 &amp; \"+\" &amp; Split(Cells(1, 5).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 8).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 11).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 14).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 17).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 20).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 23).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 26).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 29).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 32).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 35).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 38).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 41).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 44).Address, \"$\")(1) &amp; n + first &amp; \"+\" &amp; Split(Cells(1, 47).Address, \"$\")(1) &amp; n + first\n</code></pre>\n\n<p>As you can see the split is repeated changing by 3 columns each time.</p>\n\n<p>The point of the code is a simply cell(x,y) = cell(x-1,y) + sum.... </p>\n\n<p>I believe it would be possible to pass it through a for loop that returns a string that is concatenated?</p>\n\n<p>note: this is in a for loop running through values of n. First is a variable to identify the start of the calculations</p>\n\n<p>any help would be appreciated </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4466, "user_id": 4876561, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/LrLr2.jpg?s=128&g=1", "display_name": "wundermahn", "link": "https://stackoverflow.com/users/4876561/wundermahn"}, "edited": false, "score": 0, "creation_date": 1577160346, "post_id": 59463635, "comment_id": 105107892, "body": "Do you need to use <code>VBA</code> or can you use sheet formulas?"}, {"owner": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "reply_to_user": {"reputation": 4466, "user_id": 4876561, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/LrLr2.jpg?s=128&g=1", "display_name": "wundermahn", "link": "https://stackoverflow.com/users/4876561/wundermahn"}, "edited": false, "score": 0, "creation_date": 1577160947, "post_id": 59463635, "comment_id": 105107987, "body": "I need to use vba."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1577169463, "post_id": 59463635, "comment_id": 105109709, "body": "The easiest way is probably sorting the table by date (descending) and units (descending).  If sorted, the first occurrence of a name will always have the most recent date for that user and also the highest number of units for that user on the date."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1577188893, "post_id": 59463635, "comment_id": 105116242, "body": "There are many ways to get the results you want in VBA. Please show us what you have tried, and where you have run into problems. One approach would be to loop through or filter the range to look at just &quot;Gerry&quot;; then examine the related dates to find the Max Date.  You could use an array, dictionary or collection to do this."}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1577174598, "creation_date": 1577174598, "answer_id": 59465689, "question_id": 59463635, "link": "https://stackoverflow.com/questions/59463635/find-the-row-that-met-certain-criteria-with-latest-date-vba/59465689#59465689", "title": "Find the row that met certain criteria with latest date vba", "body": "<p>If you need VBA to do it you could use ADODB like that:</p>\n\n<pre><code>Sub ReadFromWorksheetADO(selName As String)\n    Dim conn As New ADODB.Connection\n\n    conn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" _\n        &amp; ThisWorkbook.FullName &amp; \";Extended Properties=\"\"Excel 12.0;HDR=YES;\"\";\"\n\n\n    Dim query As String\n    query = \"SELECT * FROM [data$]\"\n\n    Dim rs As New ADODB.Recordset\n    With rs\n        .CursorLocation = adUseClient\n        .Open query, conn\n        .Sort = \"Meeting_Date DESC\"\n        .Filter = \"Name = '\" &amp; selName &amp; \"'\"\n    End With\n\n\n    Debug.Print rs.Fields(\"Name\").Value, rs.Fields(\"Meeting_Date\").Value, rs.Fields(\"Units\").Value\n    ' Sheet2.Range(\"A1\").CopyFromRecordset rs\n\nEnd Sub\n</code></pre>\n\n<p>And that will give you the result for <em>Gerry</em></p>\n\n<pre><code>Sub TestIt()\n    ReadFromWorksheetADO \"Gerry\"\nEnd Sub\n</code></pre>\n\n<p>I renamend the field <em>Meeting Date</em> to <strong>Meeting_Date</strong>. And I assumed the sheet with the data you posted has the name <strong>data</strong>. You need to add a reference to the ADODB Library in the VBE ( Goto Tools/References and select Microsoft Active DataObject 6.1</p>\n"}], "owner": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 59465689, "answer_count": 1, "score": -2, "last_activity_date": 1577177168, "creation_date": 1577159606, "last_edit_date": 1577177168, "question_id": 59463635, "link": "https://stackoverflow.com/questions/59463635/find-the-row-that-met-certain-criteria-with-latest-date-vba", "title": "Find the row that met certain criteria with latest date vba", "body": "<p>I have this table below. What I am trying to achieve through Excel VBA is loop through the table below to find a person's name at the latest date and give me the units she/he purchased. </p>\n\n<p><a href=\"https://i.stack.imgur.com/qx3hE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qx3hE.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>?: What is the best or simplest way to get the \"Units\" purchased on the latest \"Meeting Date\" when search by \"Name\"</p>\n\n<p>Let us say I Choose Gerry, the result will give me \"30\" as it is the units purchased on the latest \"Meeting Date\" Sorry I am new to Excel VBA. </p>\n\n<p>My challenge also is also after going through all rows that has \"gerry\", how can I get the row that has the latest date? </p>\n\n<p>I will update the question if it needs some clarification. Thanks. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1577154488, "post_id": 59463125, "comment_id": 105107046, "body": "You need to specify your program. You are probably using a 32 bit program AND writing somewhere you aren&#39;t allowed. Hence it will be virtualised. Look under <code>C:\\Users\\User\\AppData\\Local\\VirtualStore</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8210, "user_id": 12188861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf53f8af9d41e931de6d2bc25cf16000?s=128&d=identicon&r=PG&f=1", "display_name": "basic", "link": "https://stackoverflow.com/users/12188861/basic"}, "is_accepted": true, "score": 2, "last_activity_date": 1577154460, "creation_date": 1577154460, "answer_id": 59463170, "question_id": 59463125, "link": "https://stackoverflow.com/questions/59463125/receive-run-time-error-58-file-already-exists-when-it-doesnt/59463170#59463170", "title": "Receive Run-time Error 58 File Already Exists When It Doesn&#39;t", "body": "<p>You create folder 'Bname', not '..\\Master File'. Do not use quotation marks around the variable.</p>\n\n<pre><code>fso.CreateFolder Bname\n</code></pre>\n"}], "owner": {"reputation": 146, "user_id": 11904110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acff29240c543913ba2ea838f217ef1e?s=128&d=identicon&r=PG&f=1", "display_name": "Gitty", "link": "https://stackoverflow.com/users/11904110/gitty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 59463170, "answer_count": 1, "score": 1, "last_activity_date": 1577154722, "creation_date": 1577153837, "last_edit_date": 1577154722, "question_id": 59463125, "link": "https://stackoverflow.com/questions/59463125/receive-run-time-error-58-file-already-exists-when-it-doesnt", "title": "Receive Run-time Error 58 File Already Exists When It Doesn&#39;t", "body": "<p>I keep on receiving </p>\n\n<blockquote>\n  <p>\"Run-time Error 58 File Already Exists\"</p>\n</blockquote>\n\n<p>when trying to run the below code. I've double and triple checked and the file definitely doesn't exist.</p>\n\n<p>I run a different Macro first that gets me the location of the folder I want to create this new folder in. The location is displayed in <code>ActiveWorkbook.Sheets(1).Range(\"A1\")</code>. <code>Master File</code> is the name of the new folder I want to create.</p>\n\n<pre><code>Sub CreateFolder\n\nDim Bname As String\nBname = ActiveWorkbook.Sheets(1).Range(\"A1\").Text &amp; \"\\Master File\"\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nfso.CreateFolder \"Bname\"\n\nEnd Sub\n</code></pre>\n\n<p>I've also tried the following:</p>\n\n<pre><code>Sub CreateFolder\n\nDim Bname As String\nBname = ActiveWorkbook.Sheets(1).Range(\"A1\").Text &amp; \"\\Master File\"\nMkDir \"Bname\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "sql", "excel", "vba"], "comments": [{"owner": {"reputation": 546, "user_id": 3869484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LJ3Z0.jpg?s=128&g=1", "display_name": "Richard Crossley", "link": "https://stackoverflow.com/users/3869484/richard-crossley"}, "edited": false, "score": 0, "creation_date": 1577154600, "post_id": 59463090, "comment_id": 105107058, "body": "If you&#39;re wanting to do this whenever a cell changes, you need to look at the Worksheet_Change subroutine associated with the worksheet object."}, {"owner": {"reputation": 15, "user_id": 7138418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29a462643133fbe52f1cfaef3bf8e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "troy", "link": "https://stackoverflow.com/users/7138418/troy"}, "reply_to_user": {"reputation": 546, "user_id": 3869484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LJ3Z0.jpg?s=128&g=1", "display_name": "Richard Crossley", "link": "https://stackoverflow.com/users/3869484/richard-crossley"}, "edited": false, "score": 0, "creation_date": 1577155013, "post_id": 59463090, "comment_id": 105107111, "body": "Hi Richard.  There will be mulitple users any given time. So I want them to have the ability to literally type in the sCustomerID, then from there scroll across and update the field or fields with the new information and it will update the SQL table. No user will have all records, they will only know the record they want to update"}, {"owner": {"reputation": 546, "user_id": 3869484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LJ3Z0.jpg?s=128&g=1", "display_name": "Richard Crossley", "link": "https://stackoverflow.com/users/3869484/richard-crossley"}, "edited": false, "score": 0, "creation_date": 1577157373, "post_id": 59463090, "comment_id": 105107437, "body": "Hmm, Adjusting the range in Set rChangableData = Me.Range(&quot;B2:C100&quot;), allowed the same functionality to work on the 99 rows between C2 and C100. Your own range will depend on you data. Unfortunately it produces two updates as the user navigates across worksheet and enters the first and last names."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577859590, "post_id": 59463090, "comment_id": 105269683, "body": "This wouls be easy when using an Ms Access Form with bound fields- But a userform can be used too. but more effort needed."}], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577159455, "post_id": 59463414, "comment_id": 105107780, "body": "What if the person&#39;s last name is something like O&#39;Doule ?"}, {"owner": {"reputation": 546, "user_id": 3869484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LJ3Z0.jpg?s=128&g=1", "display_name": "Richard Crossley", "link": "https://stackoverflow.com/users/3869484/richard-crossley"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577163501, "post_id": 59463414, "comment_id": 105108434, "body": "The resulting SQL would need to be escaped. That&#39;s beyond the scope of the question and would be best handled by a common function that escapes all SQL submitted to the database."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577163638, "post_id": 59463414, "comment_id": 105108460, "body": "Seems it would make more sense to teach about using parameter queries that don&#39;e have SQL injection problems and other problems like this."}, {"owner": {"reputation": 546, "user_id": 3869484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LJ3Z0.jpg?s=128&g=1", "display_name": "Richard Crossley", "link": "https://stackoverflow.com/users/3869484/richard-crossley"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577163911, "post_id": 59463414, "comment_id": 105108516, "body": "TBH there are a lot of issues with the code, that don&#39;t add to the answer of OP&#39;s question. We could get into a lengthy discussion of the best ways forward, but that adds nothing to the answer. If the OP would like further information they&#39;re free to ask one or more questions."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577859367, "post_id": 59463414, "comment_id": 105269657, "body": "@RichardCrossley keep in mind that other read that too and may copy it. So you should provide code comments, but this an ugly way to do updates (at least quotes need an escape.) Can&#39;t you bind the range to a datasource with automatic updates?"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577950496, "post_id": 59463414, "comment_id": 105287509, "body": "@RichardCrossley: to fix <a href=\"https://stackoverflow.com/editing-help#syntax-highlighting\">syntax-highlighting</a> add a proper tag or  language code to the code-block. See my edit on your answer."}], "tags": [], "owner": {"reputation": 546, "user_id": 3869484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LJ3Z0.jpg?s=128&g=1", "display_name": "Richard Crossley", "link": "https://stackoverflow.com/users/3869484/richard-crossley"}, "is_accepted": true, "score": 0, "last_activity_date": 1577955764, "last_edit_date": 1577955764, "creation_date": 1577157089, "answer_id": 59463414, "question_id": 59463090, "link": "https://stackoverflow.com/questions/59463090/excel-vba-to-update-existing-record-in-sql/59463414#59463414", "title": "excel VBA to update existing record in SQL", "body": "<p>Something like this should work.</p>\n\n<p><strike>In the example only prints the SQL in the Immediate Pane of the debugger. Since the OP is already familiar with reading from the database, updating it is left to the OP.</strike></p>\n\n<p>Updated to actually update the database.</p>\n\n<p>The code presented below should be in the worksheet module for the worksheet containing the data.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim rChangableData As Range\n    Dim rUpdatedData As Range\n\n    ' Column headings A1, B1, C1\n    ' CustomerId in Column A\n\n    ' Range of data that can affect the change B2:C100\n    ' This would be better implemented as a named range,\n    ' but it is less transparent in the source code what it refers to\n    ' * Simply entering a CustomerId, does not add a row\n    Set rChangableData = Me.Range(\"B2:C100\")\n\n    ' rUpdatedData is the range of changed data (Target),\n    ' intersecting with the range of changable data (rChangeableData).\n    ' If the two ranges do not intersect, rUpdatedData is Nothing and the event can be ignored\n    Set rUpdatedData = Intersect(rChangableData, Target)\n\n    If Not rUpdatedData Is Nothing Then\n\n        ' Iterate over the range of changed data\n        ' Obtain the CustomerId, FirstName and LastName values from the worksheet\n        ' Provide to functions to perform the updates\n        ' Also added a delete function where there is a CustomerId and no values for FirstName and LastName\n\n        Dim numRows As Long\n        Dim rowcounter As Long\n        Dim firstRow As Long\n        Dim lastRow As Long\n        Dim result As Integer\n\n        ' Since the code needs to refer back to data on the worksheet,\n        ' it keeps track of the row numbers in on the worksheet, rather than the changed data\n        numRows = rUpdatedData.Rows.Count\n        firstRow = Target.Row - rChangableData.Row + 1\n        rowcounter = firstRow\n        lastRow = firstRow + numRows\n\n        While rowcounter &lt; lastRow\n            Dim CustomerId As Long\n            Dim FirstName As String\n            Dim LastName As String\n            Dim sql As String\n\n            CustomerId = rChangableData.Offset(0, -1).Cells(rowcounter, 1)\n            FirstName = rChangableData.Cells(rowcounter, 1)\n            LastName = rChangableData.Cells(rowcounter, 2)\n\n            If Trim(CustomerId) &lt;&gt; \"\" And Trim(FirstName) &lt;&gt; \"\" And Trim(LastName) &lt;&gt; \"\" Then\n                ' The data has changed and there are non-blank values for CustomerId, FirstName and LastName;\n                ' insert or update the customer\n\n                result = Customer_Update(CustomerId, FirstName, LastName)\n\n                If result = 0 Then\n                    MsgBox \"No rows were inserted or updated.\", vbExclamation, \"Customer Update\"\n                Else\n                    If result &gt; 1 Then\n                        MsgBox \"Multiple rows were updated.\", vbExclamation, \"Customer Update\"\n                    End If\n                End If\n            Else\n                If Trim(CustomerId) &lt;&gt; \"\" And Trim(FirstName) = \"\" And Trim(LastName) = \"\" Then\n                    ' The data has changed and there is a non-blank value for CustomerID and\n                    ' blank values for FirstName and LastName;\n                    ' delete the customer\n\n                    Customer_Delete CustomerId\n\n                    If result = 0 Then\n                        MsgBox \"No rows were deleted\", vbExclamation, \"Customer Delete\"\n                    End If\n                End If\n            End If\n\n            rowcounter = rowcounter + 1\n        Wend\n    End If\nEnd Sub\n</code></pre>\n\n<p>The code presented below should be in separate module in the same VBA project. This code handles connecting to and updating the customers.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate Function CreateSQLConnection() As ADODB.Connection\n\n    ' Create an ADODB Connection.\n    ' Settings depend on your own specific environment\n\n    Dim provider As String\n    Dim source As String\n    Dim database As String\n    Dim credentials As String\n    Dim connectionString As String\n    Dim sqlConn As ADODB.Connection\n\n    ' Original Connection String\n    ' \"Provider=SQLOLEDB;Data Source=AUSWIDECUSTOMERS\\SQL2012;Initial Catalog=Customers;Integrated Security=SSPI;\"\n\n    provider = \"SQLOLEDB\"\n    source = \"AUSWIDECUSTOMERS\\SQL2012\"\n    database = \"Customers\"\n    credentials = \"Integrated Security=SSPI\"\n    connectionString = \"\" &amp; _\n        \"Provider=\" &amp; provider &amp; \";\" &amp; _\n        \"Data Source=\" &amp; source &amp; \";\" &amp; _\n        \"Initial Catalogue=\" &amp; database &amp; \";\" &amp; _\n        credentials &amp; \";\"\n\n    Set sqlConn = New ADODB.Connection\n    sqlConn.Open connectionString\n    sqlConn.DefaultDatabase = database\n    Set CreateSQLConnection = sqlConn\n\nEnd Function\n\nPublic Function Customer_Update(CustomerId As Long, FirstName As String, LastName As String) As Integer\n\n    ' Update or Insert a customer.\n    ' * Creates a connection\n    ' * Performs an update to the customer\n    ' * Checks the number of rows affected\n    ' * If no rows are affected, inserts the customer instead\n\n    Dim sqlConn As ADODB.Connection\n    Dim sqlCmd As ADODB.Command\n    Dim sqlParam As ADODB.Parameter\n    Dim rowsUpdated As Long\n\n    Set sqlConn = CreateSQLConnection()\n    Set sqlCmd = New ADODB.Command\n    sqlCmd.ActiveConnection = sqlConn\n    sqlCmd.CommandType = adCmdText\n    sqlCmd.CommandText = \"update customer set FirstName = ?, LastName = ? where CustomerId = ?\"\n    sqlCmd.Parameters.Append sqlCmd.CreateParameter(\"FirstName\", adVarChar, adParamInput, Size:=255, Value:=FirstName)\n    sqlCmd.Parameters.Append sqlCmd.CreateParameter(\"LastName\", adVarChar, adParamInput, Size:=255, Value:=LastName)\n    sqlCmd.Parameters.Append sqlCmd.CreateParameter(\"CustomerId\", adInteger, adParamInput, Value:=CustomerId)\n    sqlCmd.Execute recordsAffected:=rowsUpdated\n    Set sqlCmd = Nothing\n    Customer_Update = Handle_UpdateInsertDeleteRows(rowsUpdated)\n\n    If Customer_Update = 0 Then\n        Dim rowsInserted As Long\n\n        Set sqlCmd = New ADODB.Command\n        sqlCmd.ActiveConnection = sqlConn\n        sqlCmd.CommandType = adCmdText\n        sqlCmd.CommandText = \"insert into customer ( CustomerId, FirstName, LastName ) values ( ?, ?, ? )\"\n        sqlCmd.Parameters.Append sqlCmd.CreateParameter(\"CustomerId\", adInteger, adParamInput, Value:=CustomerId)\n        sqlCmd.Parameters.Append sqlCmd.CreateParameter(\"FirstName\", adVarChar, adParamInput, Size:=255, Value:=FirstName)\n        sqlCmd.Parameters.Append sqlCmd.CreateParameter(\"LastName\", adVarChar, adParamInput, Size:=255, Value:=LastName)\n        sqlCmd.Execute recordsAffected:=rowsInserted\n        Customer_Update = Handle_UpdateInsertDeleteRows(rowsInserted)\n        Set sqlCmd = Nothing\n    End If\n\n    sqlConn.Close\n    Set sqlConn = Nothing\nEnd Function\n\nPublic Function Customer_Delete(CustomerId As Long) As Integer\n\n    ' Delete a customer.\n    ' * Creates a connection\n    ' * Performs an delete on the customer table\n\n    Dim sqlConn As ADODB.Connection\n    Dim sqlCmd As ADODB.Command\n    Dim sqlParam As ADODB.Parameter\n    Dim rowsDeleted As Long\n\n    Set sqlConn = CreateSQLConnection()\n    Set sqlCmd = New ADODB.Command\n    sqlCmd.ActiveConnection = sqlConn\n    sqlCmd.CommandType = adCmdText\n    sqlCmd.CommandText = \"delete customer where CustomerId = ?\"\n    sqlCmd.Parameters.Append sqlCmd.CreateParameter(\"CustomerId\", adInteger, adParamInput, Value:=CustomerId)\n    sqlCmd.Execute recordsAffected:=rowsDeleted\n    Set sqlCmd = Nothing\n    Customer_Delete = Handle_UpdateInsertDeleteRows(rowsDeleted)\n    sqlConn.Close\n    Set sqlConn = Nothing\nEnd Function\n\nPrivate Function Handle_UpdateInsertDeleteRows(recordsAffected As Long) As Integer\n\n    ' Returns:\n    ' * 0 for no rows\n    ' * 1 for single row\n    ' * 2 for multi row\n\n    Select Case recordsAffected\n        Case Is &lt;= 0\n            Handle_UpdateInsertDeleteRows = 0\n        Case Is = 1\n            Handle_UpdateInsertDeleteRows = 1\n        Case Is &gt; 1\n            Handle_UpdateInsertDeleteRows = 2\n    End Select\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7138418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29a462643133fbe52f1cfaef3bf8e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "troy", "link": "https://stackoverflow.com/users/7138418/troy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 59463414, "answer_count": 1, "score": 0, "last_activity_date": 1577955764, "creation_date": 1577153363, "last_edit_date": 1577157241, "question_id": 59463090, "link": "https://stackoverflow.com/questions/59463090/excel-vba-to-update-existing-record-in-sql", "title": "excel VBA to update existing record in SQL", "body": "<p>I currently have the below VBA to insert new records into my SQL Server from Excel. </p>\n\n<pre><code>Sub Button1_Click()\n\nDim conn As New ADODB.Connection\nDim iRowNo As Integer\nDim sCustomerId, sFirstName, sLastName As String\n\nWith Sheets(\"Sheet1\")\n\n    'Open a connection to SQL Server\n    conn.Open \"Provider=SQLOLEDB;Data Source=AUSWIDECUSTOMERS\\SQL2012;Initial Catalog=Customers;Integrated Security=SSPI;\"\n\n    'Skip the header row\n    iRowNo = 2\n\n    'Loop until empty cell in CustomerId\n    Do Until .Cells(iRowNo, 1) = \"\"\n        sCustomerId = .Cells(iRowNo, 1)\n        sFirstName = .Cells(iRowNo, 2)\n        sLastName = .Cells(iRowNo, 3)\n\n        'Generate and execute sql statement to import the excel rows to SQL Server table\n        conn.Execute \"insert into dbo.Customers (CustomerId, FirstName, LastName) values ('\" &amp; sCustomerId &amp; \"', '\" &amp; sFirstName &amp; \"', '\" &amp; sLastName &amp; \"')\"\n\n        iRowNo = iRowNo + 1\n    Loop\n\n    MsgBox \"Customers imported.\"\n\n    conn.Close\n    Set conn = Nothing\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>What I am wanting to do is if anything changes with the sCustomerId record I inserted that I can come back in and update it. </p>\n\n<p>So for example</p>\n\n<p>current data set:</p>\n\n<pre><code>sCustomerId = 15 sFirstName = David SLastName = Smith \n</code></pre>\n\n<p>So from excel I want it to be able type in <code>sCustomerID = 15</code> then update the record <code>SLastName = Warner</code></p>\n\n<p>Any ideas on how to make this change would be great. </p>\n"}, {"tags": ["excel", "vba", "google-cloud-platform", "adodb"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4402597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otk8qNuaLW4/AAAAAAAAAAI/AAAAAAAAAPM/Zv-X3zi_meE/photo.jpg?sz=128", "display_name": "rsremole", "link": "https://stackoverflow.com/users/4402597/rsremole"}, "edited": false, "score": 0, "creation_date": 1577396595, "post_id": 59463284, "comment_id": 105161499, "body": "Thank you! Where do I enter my proxy invocation strings?   <a href=\"https://cloud.google.com/sql/docs/sqlserver/connect-admin-proxy#start-proxy\" rel=\"nofollow noreferrer\">cloud.google.com/sql/docs/sqlserver/&hellip;</a>   I set up a service account previously. I can&#39;t seem to load that option into Cloud SDK command line."}, {"owner": {"reputation": 1999, "user_id": 12006715, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r46HJI2UV8o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcnzGLiiJSbjfLcJ-4eHsj5SRwsdg/photo.jpg?sz=128", "display_name": "Soni Sol", "link": "https://stackoverflow.com/users/12006715/soni-sol"}, "reply_to_user": {"reputation": 3, "user_id": 4402597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otk8qNuaLW4/AAAAAAAAAAI/AAAAAAAAAPM/Zv-X3zi_meE/photo.jpg?sz=128", "display_name": "rsremole", "link": "https://stackoverflow.com/users/4402597/rsremole"}, "edited": false, "score": 0, "creation_date": 1577399168, "post_id": 59463284, "comment_id": 105162101, "body": "on the command line you prefer, it can be on CMD or in Powershell"}], "tags": [], "owner": {"reputation": 1999, "user_id": 12006715, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-r46HJI2UV8o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcnzGLiiJSbjfLcJ-4eHsj5SRwsdg/photo.jpg?sz=128", "display_name": "Soni Sol", "link": "https://stackoverflow.com/users/12006715/soni-sol"}, "is_accepted": true, "score": 0, "last_activity_date": 1577155894, "creation_date": 1577155894, "answer_id": 59463284, "question_id": 59462650, "link": "https://stackoverflow.com/questions/59462650/what-is-the-method-for-making-an-adodb-connection-from-vba-to-a-google-cloud-s/59463284#59463284", "title": "What is the method for making an ADODB connection from VBA to a (Google) Cloud SQL database?", "body": "<p>I would recommend to use the <a href=\"https://cloud.google.com/sql/docs/mysql/connect-external-app\" rel=\"nofollow noreferrer\">SQL Proxy</a> and then for the connection would be like if the database was in your localhost.</p>\n\n<p>So the steps would be:</p>\n\n<ul>\n<li>Install Cloud SQL Proxy in your computer</li>\n<li>Start the cloud SQL Proxy</li>\n<li>Connect as I f you were connecting to a local database</li>\n</ul>\n\n<p>the code would be:</p>\n\n<pre><code>Dim Cnn As Object\nSet Cnn = CreateObject(\"ADODB.Connection\")\nCnn.Open (\"DRIVER={MySQL ODBC 5.3 Unicode Driver};SERVER=172.0.0.1;DATABASE=&lt;DATABASENAME&gt;;USER=&lt;USERNAME&gt;;PASSWORD=&lt;PASSWORD&gt;)\n\nIf Cnn.State = adStateOpen Then\n    Debug.Print \"Connection\"\nElse\n    Debug.Print \"No Connection\"\nEnd If\nCnn.Close\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 4402597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otk8qNuaLW4/AAAAAAAAAAI/AAAAAAAAAPM/Zv-X3zi_meE/photo.jpg?sz=128", "display_name": "rsremole", "link": "https://stackoverflow.com/users/4402597/rsremole"}, "edited": false, "score": 0, "creation_date": 1577398879, "post_id": 59469523, "comment_id": 105162013, "body": "Thanks! That is a great resource! My &#39;MySQL ODBC 5.3 Unicode Driver&#39; is installed. I have used it many times to connect to other MySQL databases, but it&#39;s not working so awesome connecting to MySQL databases on Cloud SQL!"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1577194005, "creation_date": 1577194005, "answer_id": 59469523, "question_id": 59462650, "link": "https://stackoverflow.com/questions/59462650/what-is-the-method-for-making-an-adodb-connection-from-vba-to-a-google-cloud-s/59469523#59469523", "title": "What is the method for making an ADODB connection from VBA to a (Google) Cloud SQL database?", "body": "<p>What kind of DB are you connection to?  You can find all kinds of connection strings here.</p>\n\n<p><a href=\"https://www.connectionstrings.com/\" rel=\"nofollow noreferrer\">https://www.connectionstrings.com/</a></p>\n\n<p>Also, go to your ODBC drivers and see what you have installed.  Your code has to match what you have installed.  Here is an image of what I have on my system.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ptmuG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ptmuG.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, for instance, you have to have 'MySQL ODBC 5.3 Unicode Driver' installed because that's what you are referencing in your code.  Try that and feed back with your findings and results.</p>\n"}], "owner": {"reputation": 3, "user_id": 4402597, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otk8qNuaLW4/AAAAAAAAAAI/AAAAAAAAAPM/Zv-X3zi_meE/photo.jpg?sz=128", "display_name": "rsremole", "link": "https://stackoverflow.com/users/4402597/rsremole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 0, "accepted_answer_id": 59463284, "answer_count": 2, "score": 0, "last_activity_date": 1580402591, "creation_date": 1577147960, "last_edit_date": 1580402591, "question_id": 59462650, "link": "https://stackoverflow.com/questions/59462650/what-is-the-method-for-making-an-adodb-connection-from-vba-to-a-google-cloud-s", "title": "What is the method for making an ADODB connection from VBA to a (Google) Cloud SQL database?", "body": "<p>Connecting to Cloud SQL appears to be different than connecting to normal MySQL databases.</p>\n\n<p>I have added the 'Instance connection name' after the 'Public IP address'.</p>\n\n<p>I am getting an error:</p>\n\n<blockquote>\n  <p>'Unknown MySQL server host'</p>\n</blockquote>\n\n<pre><code>Dim Cnn As Object\nSet Cnn = CreateObject(\"ADODB.Connection\")\nCnn.Open (\"DRIVER={MySQL ODBC 5.3 Unicode Driver};SERVER=xxx.xxx.xxx.xxx\\instanceConnectionName;DATABASE=databaseName\" &amp; \";USER=user;PASSWORD=abcd\")\n\nIf Cnn.State = adStateOpen Then\n    Debug.Print \"Connection\"\nElse\n    Debug.Print \"No Connection\"\nEnd If\nCnn.Close\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1577137954, "post_id": 59461613, "comment_id": 105104261, "body": "It would help to understand that these are not all located in the same module. I see 2 <code>Option Explicit</code> lines in the middle of your code and a <code>Worksheet_Change()</code> event, but it&#39;s not very clear that these are, in fact, in the proper modules - it just looks as if this was all in your class module. Quite honestly, most of this code is not needed here anyway and deflects from providing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (hence the &quot;Minimal&quot;)."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577138077, "post_id": 59461613, "comment_id": 105104288, "body": "when using a variable as a key in a scripting dictionary, set it to an actual string variable first (instead of a range as you now have it) - i know it seems weird, but this happened to me once before and that solved it."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1577138210, "post_id": 59461613, "comment_id": 105104323, "body": "<code>thisLoanNum</code> is a <code>range</code> variable... you are passing it into a <code>dictionary</code> item if you do a <code>debug.print thisLoanNum</code> does it match an item within the existing <code>dictionary</code>?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1577138210, "post_id": 59461613, "comment_id": 105104324, "body": "@K.D\u1d00\u1d20\u026as I updated the code and where it is located to hopefully clear that up for you."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577138665, "post_id": 59461613, "comment_id": 105104431, "body": "@braX I tried that, but unfortunately changing it to a string wont work in this case because my Class Module requires it to be a range."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577138816, "post_id": 59461613, "comment_id": 105104462, "body": "Just declare another variable, and set it to the range value converted to a string. dont change the definition of the existing one."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577139399, "post_id": 59461613, "comment_id": 105104591, "body": "<code>Dim sTemp as String: sTemp = thisLoanNum</code> then <code>allLoans(sTemp) = TempVal</code>"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1577139592, "post_id": 59461613, "comment_id": 105104641, "body": "Does <code>allLoans(thisLoanNum.Value)</code> or even <code>allLoans(thisLoanNum.Text)</code> not work? Explicitly calling the properties you are wanting to use instead of implicitly using an object&#39;s default method is good coding practice. Also, did you check to ensure that <code>thisLoanNum</code> is a single cell? Because if not then you are just returning an array of values to something that is expecting a simple string."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1577140113, "post_id": 59461613, "comment_id": 105104764, "body": "@alowflyingpig I get the value in the cell when i run <code>debug.print thisLoanNum</code>"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1577140973, "post_id": 59461613, "comment_id": 105104974, "body": "If your class requiresit to be a range can you simply convert it like <code>CStr(thisLoanNum)</code>"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1577141911, "post_id": 59461613, "comment_id": 105105181, "body": "@K.D\u1d00\u1d20\u026as niether <code>Does allLoans(thisLoanNum.Value)</code> or <code>allLoans(thisLoanNum.Text)</code> work.  I have to store the items of the dictionary in an Array.  Maybe I just need to rethink not using a dictionary for this and just store the values from those ranges on a hidden sheet in the workbook then compare any changes against those cell values at least until i have had more practice with using Dictionaries on simpler projects."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577142096, "post_id": 59461613, "comment_id": 105105219, "body": "Did you try my idea? After I explained it more?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577142353, "post_id": 59461613, "comment_id": 105105271, "body": "@braX I did and maybe i missed something because i couldnt get that to work either :("}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577142494, "post_id": 59461613, "comment_id": 105105296, "body": "You couldnt define a new string variable? you couldnt set the range variable to a string? my experience is that it has to be an actual string variable to work, but you can make one easily out of the range value."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1577143438, "post_id": 59461613, "comment_id": 105105459, "body": "I could define the new string but then I received a 1004 error. Maybe I just need to sleep on this one and see if it clicks tomorrow."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1577195026, "post_id": 59461613, "comment_id": 105118265, "body": "I was able to get this to work, but not in a way that is probably the correct way, but I will deal with that later.  It did open up another issue, but I will post that separate issue if i cant figure it out.  Thanks everyone"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577203127, "post_id": 59461613, "comment_id": 105120800, "body": "@braX  My understanding is the class module already converts it to a string, so I think im just going to delete the dictionary part of this project and start it from scratch."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1578089006, "post_id": 59461613, "comment_id": 105338142, "body": "@alowflyingpig unfortunately I cannot convert it to a string. Do I just need to create a new Class Module to handle updating the Dictionary?"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577138166, "creation_date": 1577137540, "last_edit_date": 1577138166, "question_id": 59461613, "link": "https://stackoverflow.com/questions/59461613/rte-438-object-doesnt-support-this-property-or-method-updating-existing-item", "title": "RTE 438: Object Doesnt Support this property or Method - Updating existing item values based on dictionary key", "body": "<p>Im at a loss on why I am getting the Run Time Error of 438 when trying to update items in a dictionary based on the key.  Please note I am still very new to using Dictionaries in VBA.  I decided to use the cell address as the key, but I think this may cause an issue later on when rows are deleted and added; I will address this later if it does cause issues. <br><br>Back to the issue at hand:  I am receiving the Run Time Error on <code>allLoans(thisLoanNum) = TempVal</code> within the <code>Public Sub UpdateLoanDictionary(ByRef thisLoanNum As Range)</code> when ever I update one of the cells within the specified ranges.  I have placed all of the functions, class modules and subs in one code block, but if I need to split them up and label them as such I will.  I have tried looping through the keys (current setup) and not looping through the keys in the <code>Worksheet_Change</code> event, but both ways cause the same error.</p>\n\n<p><strong>Data Set:</strong>  These are the columns with data the code looks at<br>\nLoan Number | Customer Name | Processor | Title Company | Closing Date | Contract Price | Loan Amount | Notes</p>\n\n<p><strong>Class Module</strong></p>\n\n<pre><code>'--Class: LoanData\nPublic LoanAmount As String\nPublic TitleCompany As String\nPublic Notes As String\nPublic closeDate As String\nPublic PurchasePrice As String\nPublic Product As String\nPublic LoanNumber As String\nPublic CustomerName As String\nPublic ProcessorName As String\nPublic Sub Populate(ByRef loanDetails As Range)\n    With loanDetails\n        LoanAmount = Trim(.Offset(0, 16).Value)\n        closeDate = Trim(.Offset(0, 10).Value)\n        Notes = Trim(.Offset(0, 19).Value)\n        LoanNumber = .Offset(0, 0).Cells.Address\n        Product = Trim(.Offset(0, 17).Value)\n        PurchasePrice = Trim(.Offset(0, 15).Value)\n        TitleCompany = Trim(.Offset(0, 4).Value)\n        If CBool(InStr(1, .Offset(0, 1), \" - \")) Then\n            CustomerName = Trim(Split(.Offset(0, 1).Value, \" - \")(0))\n        Else\n            CustomerName = Trim(.Offset(0, 1).Value)\n        End If\n        ProcessorName = Trim(.Offset(0, 2).Value)\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Worksheet Change Event</strong></p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim loanNumbers As Range\n    Set loanNumbers = Sheet1.Range(\"LoanNums,CloseDate,ContractPrice,LoanAmnt,LoanNotes,Product\")\n\n    Dim allChangedCells As Range\n    Set allChangedCells = Intersect(Target, loanNumbers)\n    If Not allChangedCells Is Nothing Then\n        Dim changedCell As Range\n        For Each changedCell In allChangedCells\n            UpdateLoanDictionary changedCell\n        Next changedCell\n        Dim uLoan As New LoanData\n        CreateEmail uLoan.CustomerName, uLoan.TitleCompany, uLoan.closeDate, uLoan.PurchasePrice, uLoan.LoanAmount, uLoan.Product, uLoan.Notes\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Standard Module named LoanDataSupport</strong></p>\n\n<pre><code>Option Explicit\nPrivate allLoans As Dictionary\nPublic Sub CreateLoanDictionary(Optional ByVal forceNewDictionary As Boolean = False)\n    '--- if the dictionary already exists, we don't have to recreate it\n    '    unless it's forced\n    If forceNewDictionary Or (allLoans Is Nothing) Then\n        Set allLoans = New Dictionary\n        Dim loanNums As Range\n        Set loanNums = ActiveSheet.Range(\"LoanNums\")\n        Dim loannum As Range\n        For Each loannum In loanNums\n            UpdateLoanDictionary loannum\n        Next loannum\n    End If\nEnd Sub\nPublic Sub UpdateLoanDictionary(ByRef thisLoanNum As Range)\n    '--- just in case this Sub is called before the dictionary is created\n    If allLoans Is Nothing Then CreateLoanDictionary\n    'If IsEmpty(thisLoanNum.Value) Then Exit Sub\n\n    Dim thisLoan As LoanData\n    Set thisLoan = New LoanData\n    thisLoan.Populate thisLoanNum\n\n    If Not allLoans.Exists(thisLoan.LoanNumber) Then\n        '--- create a new loan entry\n        allLoans.Add thisLoan.LoanNumber, thisLoan\n    Else\n        Dim loanKey As Variant\n        For Each loanKey In allLoans.Keys\n            Dim TempVal As New LoanData\n                allLoans(thisLoanNum) = TempVal\n        Next loanKey\n\n        '--- update the existing loan entry\n        'allLoans(thisLoanNum) = thisLoan  &lt;--This causes same error as the loop.\n    End If\nEnd Sub\nSub ShowLoans()\n    If allLoans Is Nothing Then\n        Debug.Print \"There is no loan dictionary!\"\n    Else\n        If allLoans.Count = 0 Then\n            Debug.Print \"There is a loan dictionary, but it's empty!\"\n        Else\n            Debug.Print \"There are \" &amp; allLoans.Count &amp; \" loans in the dictionary:\"\n            Dim loan As Variant\n            For Each loan In allLoans.Items\n                Debug.Print \"Loan Number: \" &amp; loan.LoanNumber &amp; \"Notes: \" &amp; loan.Notes\n            Next loan\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>\nForgot to give credit to the fine people that helped me on Code Review with originally helping me with this code from <a href=\"https://codereview.stackexchange.com/questions/233488/add-items-to-dictionary-from-another-dictionary-on-cell-value-change\">This Post</a></p>\n"}, {"tags": ["excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 75, "user_id": 12207157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ga8kS.jpg?s=128&g=1", "display_name": "jason-hernandez-73", "link": "https://stackoverflow.com/users/12207157/jason-hernandez-73"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 1, "creation_date": 1577146341, "post_id": 59461571, "comment_id": 105105903, "body": "No, opening of year price for each stock is the first row of that stock name (ticker), with several stock names on the worksheet. Your later reply (that I accepted) answered my question. Thank you."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1577146379, "post_id": 59461571, "comment_id": 105105914, "body": "Yea I got it. Thanks for the click. Good luck."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 12207157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ga8kS.jpg?s=128&g=1", "display_name": "jason-hernandez-73", "link": "https://stackoverflow.com/users/12207157/jason-hernandez-73"}, "edited": false, "score": 0, "creation_date": 1577143477, "post_id": 59461596, "comment_id": 105105467, "body": "Will this work for the new Opening_Price when the ticker changes?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 75, "user_id": 12207157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ga8kS.jpg?s=128&g=1", "display_name": "jason-hernandez-73", "link": "https://stackoverflow.com/users/12207157/jason-hernandez-73"}, "edited": false, "score": 0, "creation_date": 1577146029, "post_id": 59461596, "comment_id": 105105864, "body": "@jason-hernandez-73 no it doesn&#39;t, but D Stanley&#39;s answer is the answer to what your LITERAL question is. You might consider rewording question to be &quot;How to hold a value in a loop until a certain condition met&quot; since you aren&#39;t just concerned about the first price, but all future new stocks/etc."}], "tags": [], "owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "is_accepted": false, "score": 2, "last_activity_date": 1577137412, "creation_date": 1577137412, "answer_id": 59461596, "question_id": 59461571, "link": "https://stackoverflow.com/questions/59461571/how-do-i-keep-initial-value-in-a-for-loop/59461596#59461596", "title": "How do I keep initial value in a for loop?", "body": "<p>Do it outside of the for-loop:</p>\n\n<pre><code>' Set opening price\nDim Opening_Price As Double\nOpening_Price = Cells(2, 3).Value\n\n'Loop through all stock trades\nFor i = 2 To LastRow\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 0, "last_activity_date": 1577146233, "last_edit_date": 1577146233, "creation_date": 1577145486, "answer_id": 59462446, "question_id": 59461571, "link": "https://stackoverflow.com/questions/59461571/how-do-i-keep-initial-value-in-a-for-loop/59462446#59462446", "title": "How do I keep initial value in a for loop?", "body": "<p>I think I see your issue. You need to specify when the loop is on a <strong>new</strong> \"stock/ticker\" or whatnot. An <code>if</code> statement that switches this to <code>True</code> or <code>False</code> should do it (assuming I understand your issue correctly).</p>\n\n<p>See your modified code below (I removed items unrelated to your issue).</p>\n\n<pre><code>For i = 2 To LastRow\n\n'Capture price if first of year\nDim stockPriceAlreadyCaptured As Boolean\n\n    If stockPriceAlreadyCaptured = False Then\n         'Set opening price\n         Dim Opening_Price As Double\n         Opening_Price = Cells(i, 3).Value\n\n         'ensures no future prices captured until condition met.\n         stockPriceAlreadyCaptured = True\n    End If\n\n\n    'Check if we are still within the same ticker.\n    If Cells(i + 1, 1).Value &lt;&gt; Cells(i, 1).Value Then\n\n        '...unrelated code excluded\n\n        'switch your condition back to capture next price line.\n        stockPriceAlreadyCaptured = False\n\n    End If\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 12207157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ga8kS.jpg?s=128&g=1", "display_name": "jason-hernandez-73", "link": "https://stackoverflow.com/users/12207157/jason-hernandez-73"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 59462446, "answer_count": 2, "score": 0, "last_activity_date": 1577146233, "creation_date": 1577137197, "last_edit_date": 1577137269, "question_id": 59461571, "link": "https://stackoverflow.com/questions/59461571/how-do-i-keep-initial-value-in-a-for-loop", "title": "How do I keep initial value in a for loop?", "body": "<p>I am trying to write code in Excel VBA, and I need the initial numeric value to stay the same until the string value changes, so that the last numeric value will be subtracted from the initial numeric value. After the string value changes, then a new initial numeric value is needed. </p>\n\n<p>More specifically:<br>\nFor a given stock ticker, I need to keep the opening price at the beginning of the year, and subtract it from the closing price at the end of the year, to find the yearly change. When the ticker changes, I then need a new beginning of the year opening price for the new stock. Unfortunately, the for loop I have written does not keep the same beginning of the year opening price, but instead subtracts the year end closing price from that same day's opening price (because they are in the same row i). I can't hard code the opening price, because it needs to change when the ticker changes.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>'Loop through all stock trades\nFor i = 2 To LastRow\n\n    ' Set opening price\n    Dim Opening_Price As Double\n    Opening_Price = Cells(i, 3).Value\n\n\n    ' Check if we are still within the same ticker.\n    If Cells(i + 1, 1).Value &lt;&gt; Cells(i, 1).Value Then\n\n      ' Set the ticker name\n      Ticker = Cells(i, 1).Value\n\n      ' Print the ticker name in the Summary Table\n      Range(\"I\" &amp; Summary_Table_Row).Value = Ticker\n\n      ' Add or subtract closing price from first opening price\n      Yearly_Change = Cells(i, 6).Value - Opening_Price\n\n      ' Print the change in stock price in the Summary Table\n      Range(\"J\" &amp; Summary_Table_Row).Value = Yearly_Change\n\n      ' Calculate percent change from opening to closing price\n      Percent_Change = (Yearly_Change / Opening_Price) * 100\n\n      ' Print the percent change in the summary table\n      Range(\"K\" &amp; Summary_Table_Row).Value = Percent_Change\n\n      ' Add one to the summary table row\n      Summary_Table_Row = Summary_Table_Row + 1\n\n\n    End If\n\n\n\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "getelementbyid"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1577136277, "post_id": 59461362, "comment_id": 105103840, "body": "What is the object you&#39;re trying to interact with, is it a checkbox?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577141821, "post_id": 59461362, "comment_id": 105105165, "body": "Have you deliberately removed the login lines? Can you check you target element is not inside a parent frame/iframe element?"}], "answers": [{"comments": [{"owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1577278892, "post_id": 59462616, "comment_id": 105134218, "body": "Ups, @QHarr. You are right I wasn&#39;t looking closely, sorry but merry Christmas on this occasion"}], "tags": [], "owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1577147649, "creation_date": 1577147649, "answer_id": 59462616, "question_id": 59461362, "link": "https://stackoverflow.com/questions/59461362/object-required-error-on-getelementbyid/59462616#59462616", "title": "&quot;Object required&quot; error on getElementById", "body": "<p>\"chkAllrlbLocs\" is no Id, it's a name. But \"name\" is only an attribute. So try this:\n(If it wont work, you should post the url)</p>\n\n<pre><code>    Sub Website()\n\n    Dim ie_Obj As InternetExplorer\n    Dim inputTags As Object\n\n    Set ie_Obj = New InternetExplorer\n    ie_Obj.Visible = True\n\n    ie_Obj.navigate \"https://www.websitehere.omitted/\"\n    Do While ie_Obj.Busy = True Or ie_Obj.readyState &lt;&gt; 4: DoEvents: Loop\n\n    ie_Obj.Document.getElementById(\"LoginBtn\").Click ' This one works fine.  What's wrong with the next one?\n    'The following line doesn't work because \"ie_Obj.Busy = True Or ie_Obj.readyState &lt;&gt; 4: DoEvents\" is\n    'already at \"ready\" . You are saved by the following line after this: \"Application.Wait ...\"\n    'So I commented it out\n    'Do While ie_Obj.Busy = True Or ie_Obj.readyState &lt;&gt; 4: DoEvents: Loop\n    Application.Wait (Now + TimeValue(\"0:00:05\")) ' I added this to allow the page to load.\n\n    'This is the \"try this\" part\n    'But I think you must think a little by yourself\n    For Each inputTags In ie_Obj.Document.getElementsByTagName(\"input\")\n      If inputTags.getAttribute(\"name\") = \"chkAllrlbLocs\" Then\n        'Think about the following comment line\n        'Code when the right input field was be found\n        Exit For\n      End If\n    Next inputTags\n\n    '... more code follows\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11666874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74e51e71f286e27a4d5a48d28bf186cb?s=128&d=identicon&r=PG&f=1", "display_name": "frank", "link": "https://stackoverflow.com/users/11666874/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577147649, "creation_date": 1577135657, "last_edit_date": 1577136689, "question_id": 59461362, "link": "https://stackoverflow.com/questions/59461362/object-required-error-on-getelementbyid", "title": "&quot;Object required&quot; error on getElementById", "body": "<p>When I attempt getElementById, a run-time error 424 is thrown.</p>\n\n<p>Basically, my code opens and logs into a web page, then clicks a button to navigate to a new screen.  Once this new screen loads, we try to click the aforementioned button that throws an error.</p>\n\n<pre><code>Sub Website()\n\n    Dim ie_Obj As InternetExplorer\n\n    Set ie_Obj = New InternetExplorer\n    ie_Obj.Visible = True\n\n    ie_Obj.navigate \"https://www.websitehere.omitted/\"\n    Do While ie_Obj.Busy = True Or ie_Obj.readyState &lt;&gt; 4: DoEvents: Loop\n\n    ie_Obj.Document.getElementById(\"LoginBtn\").Click ' This one works fine.  What's wrong with the next one?\n    Do While ie_Obj.Busy = True Or ie_Obj.readyState &lt;&gt; 4: DoEvents: Loop\n\n    Application.Wait (Now + TimeValue(\"0:00:05\")) ' I added this to allow the page to load.\n\n    ie_Obj.Document.getElementById(\"chkAllrlbLocs\").Click' &lt;--- Code breaks here\n\n    '... more code follows\n</code></pre>\n\n<p>I am aware that one of the reasons could be because the page has not finished loading; however, if I go line-by-line with F8 and allow it to load, it will still throw the error.</p>\n\n<p>This is my HTML:</p>\n\n<pre><code>&lt;input name=\"chkAllrlbLocs\" tabindex=\"-1\" id=\"chkAllrlbLocs\" onclick=\"if (! SelectAllLBItems('rlbLocs')) return false;setTimeout('__doPostBack(\\'chkAllrlbLocs\\',\\'\\')', 0)\" type=\"checkbox\"&gt;\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577141978, "post_id": 59461325, "comment_id": 105105199, "body": "Are you getting an error? If so which?"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1577150330, "post_id": 59461325, "comment_id": 105106476, "body": "Is the table inside an iFrame?"}, {"owner": {"reputation": 13, "user_id": 10085786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f86e71635033d38ca74536e1e777c711?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/10085786/tim"}, "edited": false, "score": 0, "creation_date": 1577198873, "post_id": 59461325, "comment_id": 105119448, "body": "yes, it appears to be within an iFrame."}, {"owner": {"reputation": 13, "user_id": 10085786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f86e71635033d38ca74536e1e777c711?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/10085786/tim"}, "edited": false, "score": 0, "creation_date": 1577200462, "post_id": 59461325, "comment_id": 105119946, "body": "going to try this. ie.document.querySelector(&quot;[name=&#39;PopUpRadWindow&#39;]&quot;).content&zwnj;&#8203;Document.querySelect&zwnj;&#8203;or(&quot;span[Class=aspNe&zwnj;&#8203;tDisabled]&quot;).Click"}], "owner": {"reputation": 13, "user_id": 10085786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f86e71635033d38ca74536e1e777c711?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/10085786/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577136702, "creation_date": 1577135408, "last_edit_date": 1577136702, "question_id": 59461325, "link": "https://stackoverflow.com/questions/59461325/vba-click-check-box", "title": "VBA click check box", "body": "<p>I am trying to click a checkbox.  Nothing that I have researched has worked. Unfortunately the website is restricted so I wont be able to share the URL. So far I have been able to navigate to the website and then click a button that opens a table.  Once the table is open, I am unable to click the checkbox inside.  The goal is to click the checkbox with an ID of \"Nuts\", but I have no success in scraping or clicking anything in the table. I am relatively new with VBA.  I am not sure why the table is causing issues. I have tried the following and much more:   </p>\n\n<pre><code>ie.document.getElementByID(\"Nuts\").Click\nie.document.ALL.(\"Nuts\").Click\n\n\n\ntable class= \u201cPaddingTable2\u201d style= \u201cboarder-spacing: 1ox; width: 100%;\u201d\n&lt;tbody&gt;\n&lt;tr&gt;\u2026&lt;/tr&gt;\n&lt;tr&gt;\u2026&lt;/tr&gt;\n&lt;tr&gt;\n            &lt;td&gt;Apple:\n            &lt;/td&gt;\n            &lt;td&gt;\n                &lt;input name=\"Banana\" type=\"text\" value=\"100.000000\" maxlength=\"11\" id=\"Cherry\" \nclass=\"Date\" style=\"width:155px;\"&gt;\n                &lt;span data-val-controltovalidate=\"Elderberry\" data-val-errormessage=\"FIG\" id=\"grape\" \ndata-val=\"true\" data-val-evaluationfunction=\"honeydew\" data-val-validationexpression=\"indago\" \nstyle=\"visibility:hidden;\"&gt;*\n                &lt;/span&gt;\n             &lt;/td&gt;\n             &lt;td&gt; Jackfruit \n             &lt;/td&gt;\n            &lt;td&gt;\n                &lt;input name=\"Kiwi\" type=\"text\" maxlength=\"4\" id=\"Lemon\" class=\"Mango\" \nstyle=\"width:155px;\"&gt;\n            &lt;/td&gt;\n            &lt;td colspan=\"4\"&gt;\n                &lt;input id=\"Nuts\" type=\"checkbox\" name=\"orange\"&gt;&lt;label for=\"pear\"&gt;quinces&lt;/label&gt;\n            &lt;/td&gt;\n        &lt;/tr&gt;\n&lt;tr&gt;\u2026&lt;/tr&gt;\n&lt;tr&gt;\u2026&lt;/tr&gt;\n&lt;tr&gt;\u2026&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1577134701, "post_id": 59460917, "comment_id": 105103479, "body": "Which line is giving the error?, Just note that there was a &quot;spelling&quot; error at this line: <code>Set cmcRef = ie.document.getElementById(&quot;M_E_ctlPartField214_V&quot;)</code>"}, {"owner": {"reputation": 13, "user_id": 6300805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea611872d4f0c7757ccf9b237fc5bd54?s=128&d=identicon&r=PG&f=1", "display_name": "amir", "link": "https://stackoverflow.com/users/6300805/amir"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 1, "creation_date": 1577141974, "post_id": 59460917, "comment_id": 105105198, "body": "on the do  while... now there is an error saying, the interference is unknown..."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1577176846, "post_id": 59460917, "comment_id": 105111850, "body": "Write &#39;Do events&#39; on the line before the first &#39;Loop&#39;."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577227056, "post_id": 59460917, "comment_id": 105126095, "body": "The resource is not found when I look for it. Can you view it in a browser?"}, {"owner": {"reputation": 13, "user_id": 6300805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea611872d4f0c7757ccf9b237fc5bd54?s=128&d=identicon&r=PG&f=1", "display_name": "amir", "link": "https://stackoverflow.com/users/6300805/amir"}, "edited": false, "score": 0, "creation_date": 1577647822, "post_id": 59460917, "comment_id": 105216202, "body": "what do you mean?"}], "owner": {"reputation": 13, "user_id": 6300805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea611872d4f0c7757ccf9b237fc5bd54?s=128&d=identicon&r=PG&f=1", "display_name": "amir", "link": "https://stackoverflow.com/users/6300805/amir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577176582, "creation_date": 1577132380, "last_edit_date": 1577176582, "question_id": 59460917, "link": "https://stackoverflow.com/questions/59460917/automating-data-entry-in-a-web-form-using-vba", "title": "automating data entry in a web form using VBA", "body": "<p>I am trying to input data into excel and then populate it into a website.<br>\nI keep getting an error message saying: \"automation error, the interface is unknown\".<br>\nIs it anything to do with the settings on IE or excel?</p>\n\n<pre><code>Sub test()\nDim ie As Object\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\nWith ie\n    .Visible = True\n    .navigate \"http://charterweb.santanderuk.gs.corp/CharterServiceChain/default.aspx\"  \n\n    'Wait for loding\n    Do While .Busy\n    Loop\n\n    Do While .readyState &lt;&gt; 4\n        DoEvents\n    Loop\n\nEnd With\n\nSet cmcRef = ie.document.getElementById(\"M_E_ctlPartField214_V\")\ncmcRef.Value = \"test\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "worksheet-function"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1577129705, "post_id": 59460435, "comment_id": 105102091, "body": "Highly suggest you split the product/color/size into different columns, and then use a pivot table maybe."}, {"owner": {"reputation": 2369, "user_id": 11948610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7369157d6c65253cc08bdd8ad7d1661?s=128&d=identicon&r=PG&f=1", "display_name": "CR7SMS", "link": "https://stackoverflow.com/users/11948610/cr7sms"}, "edited": false, "score": 0, "creation_date": 1577129812, "post_id": 59460435, "comment_id": 105102144, "body": "Agree with Ben, you can do this with a couple of iterations of &quot;Text to Columns&quot; depending on your data"}, {"owner": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577131883, "post_id": 59460435, "comment_id": 105102752, "body": "@BigBen the data doesn&#39;t split cleanly into different columns by product/color/size due to varying length of the product name. Here&#39;s another product name for comparison <code>Bristol Garden 14x20 Placemat (Set of 4), Cafe</code> Any advice for this?"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "edited": false, "score": 2, "creation_date": 1577132941, "post_id": 59460435, "comment_id": 105103034, "body": "@MichelleM. start small. Text to columns and use the &quot;,&quot; to seperate it first, then maybe the &quot; symbols or the &quot;x&quot; etc."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1577176110, "post_id": 59460435, "comment_id": 105111622, "body": "Consider using the 12 leftmost characters as a key for the sort or populating a helper column."}], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "edited": false, "score": 0, "creation_date": 1579135047, "post_id": 59474305, "comment_id": 105668341, "body": "I&#39;m getting the error &quot;Ambiguous Product Name&quot; when calling ExtractProduct. Any ideas?"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "edited": false, "score": 0, "creation_date": 1579153734, "post_id": 59474305, "comment_id": 105672003, "body": "@MichelleM. Check across your VBA code (all sheet modules, <code>ThisWorkbook</code> module, custom modules) to see if there is only one variable/function named <code>ExtractProduct</code>. The error might be &quot;Ambiguous name detected&quot; (not &quot;Ambiguous Product Name&quot;) where &quot;name&quot; refers to the name of the function (<code>ExtractProduct</code>) -- and nothing to do with the fact that the function just so happens to extract a product name. If you find more than one <code>ExtractProduct</code>, delete/rename/qualify the others (depending on whether you want to keep them). That&#39;s all I can say without seeing your Excel file/code."}, {"owner": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "edited": false, "score": 0, "creation_date": 1579196998, "post_id": 59474305, "comment_id": 105694376, "body": "Ah ok, I deleted the conflicting VBA module. Now when I run ExtractProduct the result is showing #N/A for all products, despite some of them having a match."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "edited": false, "score": 0, "creation_date": 1579199977, "post_id": 59474305, "comment_id": 105695730, "body": "@MichelleM. Could you give examples of products that are returning <code>#N&#47;A</code> but should contain a match? If you could edit as many of them into your question, I&#39;ll then check if <code>PRODUCT_PATTERN</code> (in the code) can be tweaked."}, {"owner": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "edited": false, "score": 0, "creation_date": 1579200801, "post_id": 59474305, "comment_id": 105696146, "body": "I added additional examples of products. Thanks for your help :)"}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "edited": false, "score": 0, "creation_date": 1579210086, "post_id": 59474305, "comment_id": 105700198, "body": "@MichelleM. I have bad news for you, I don&#39;t think you&#39;ll be able to solve this via Excel formulas or regular expressions. The input (for example <code>Godenza Dining Table Rectangular Black Ash</code>) is so unstructured that the product (<code>Dining Table Rectangular</code>) can only be identified/extracted if you know the meaning of the words and are seeing them in context."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "edited": false, "score": 0, "creation_date": 1579210465, "post_id": 59474305, "comment_id": 105700347, "body": "@MichelleM. Some questions for you to consider. #1 Where are you getting this data from and why is it so unstructured? #2 Can you control/influence its structure to make extracting the product easier? #3 What does the data look like at the source? If it has some structure at the source, maybe it can be collected/captured in a way that preserves that structure?"}, {"owner": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "edited": false, "score": 0, "creation_date": 1579220894, "post_id": 59474305, "comment_id": 105703541, "body": "thank you for your thoughtful response. Unfortunately I can&#39;t control the structure of the data since it is being sent from different vendors. I&#39;m thinking I may need to develop a JavaScript application to perform the necessary tasks, as I&#39;m not familiar with VBA functions and there seems to be limitations on what can be accomplished within Excel. Thanks again :)"}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 1, "last_activity_date": 1577232727, "creation_date": 1577232727, "answer_id": 59474305, "question_id": 59460435, "link": "https://stackoverflow.com/questions/59460435/excel-group-and-match-by-product-name/59474305#59474305", "title": "Excel Group and Match by Product Name", "body": "<p>I've assumed that the structure of a given string is something like: <code>&lt;manufacturer&gt; &lt;dimensions&gt; &lt;product&gt;, &lt;colour&gt;</code>.</p>\n\n<p>In other words, in the string <code>Bee 22\"x36\" Table Runner, Ecru</code>:</p>\n\n<ul>\n<li><code>&lt;manufacturer&gt;</code> = <code>Bee</code></li>\n<li><code>&lt;dimensions&gt;</code> = <code>22\"x36\"</code></li>\n<li><code>&lt;product&gt;</code> = <code>Table Runner</code></li>\n<li><code>&lt;colour&gt;</code> = <code>Ecru</code></li>\n</ul>\n\n<p>I've also assumed that when you say you want to \"group by product name\", you want to group by <code>&lt;product&gt;</code> (i.e. the text between <code>&lt;dimensions&gt;</code> and <code>&lt;colour&gt;</code>).</p>\n\n<p>Lastly, I've assumed that it may be better to extract <code>&lt;product&gt;</code> first. Thereafter, you can sort/re-organise the rows however you want, since you don't describe in detail the end result you want to achieve.</p>\n\n<hr>\n\n<p><strong>Using Excel functions and helper columns</strong></p>\n\n<p>Although <code>MATCH</code> offers limited support for wildcards like <code>*</code> and <code>?</code>, I've not used it. If you have a given string in cell <code>A2</code>, try the following:</p>\n\n<ul>\n<li>in cell <code>B2</code>, paste: <code>=INDEX(SEARCH({\"0 \",\"1 \",\"2 \",\"3 \",\"4 \",\"5 \",\"6 \",\"7 \",\"8 \",\"9 \"},SUBSTITUTE(A2,\"\"\"\",\"\")),MATCH(TRUE,ISNUMBER(SEARCH({\"0 \",\"1 \",\"2 \",\"3 \",\"4 \",\"5 \",\"6 \",\"7 \",\"8 \",\"9 \"},SUBSTITUTE(A2,\"\"\"\",\"\"))),0))</code></li>\n<li>in cell <code>C2</code>, paste: <code>=SEARCH(\" \",MID(A2,1,9999),B2)+1</code></li>\n<li>in cell <code>D2</code>, paste: <code>=SEARCH(\",\",A2)</code></li>\n<li>in cell <code>E2</code>, paste: <code>=MID(A2,C2,D2-C2)</code></li>\n</ul>\n\n<p>This should give you the extracted <code>&lt;product&gt;</code> in cell <code>E2</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pHKFZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pHKFZ.png\" alt=\"Non-VBA\"></a></p>\n\n<hr>\n\n<p><strong>Using VBA and regular expressions</strong></p>\n\n<p>Instead of the approach above, you could try using VBA (which lets you use regular expressions for more sophisticated/flexible string matching).</p>\n\n<ol>\n<li>Open VB Editor (<code>Alt</code> + <code>F11</code>)</li>\n<li><code>Insert</code> > <code>Module</code></li>\n<li>Paste code below in the newly inserted module.</li>\n</ol>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\n\nPublic Function ExtractProduct(ByVal someText As String) As Variant\n\n    Const PRODUCT_PATTERN As String = \"\\d+[\"\" ]?x ?\\d+\"\"? (.+?),\"\n\n    Dim regExp As Object\n    Set regExp = CreateObject(\"VBScript.RegExp\")\n    regExp.Pattern = PRODUCT_PATTERN\n\n    Dim matchesFound As Object\n    Set matchesFound = regExp.Execute(someText)\n\n    If matchesFound.Count &gt; 0 Then\n        If matchesFound(0).SubMatches.Count &gt; 0 Then\n            ExtractProduct = matchesFound(0).SubMatches(0)\n        Else\n            ExtractProduct = CVErr(xlErrNA)\n        End If\n    Else\n        ExtractProduct = CVErr(xlErrNA)\n    End If\nEnd Function\n</code></pre>\n\n<ol start=\"4\">\n<li>Then you should be able to call <code>ExtractProduct</code> from the worksheet directly (i.e. assuming cell <code>A2</code> contains some input, enter <code>=ExtractProduct(A2)</code> in cell <code>B2</code>)</li>\n</ol>\n\n<hr>\n\n<p>Unfortunately, built-in worksheet functions in Excel do not currently appear to support regular expressions (compared to something like Google Sheets). So this can't be achieved with just a simple formula -- or at least that's my understanding.</p>\n"}], "owner": {"reputation": 405, "user_id": 2967053, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/nUNF0.jpg?s=128&g=1", "display_name": "Michelle M.", "link": "https://stackoverflow.com/users/2967053/michelle-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 59474305, "answer_count": 1, "score": 0, "last_activity_date": 1579200736, "creation_date": 1577129598, "last_edit_date": 1579200736, "question_id": 59460435, "link": "https://stackoverflow.com/questions/59460435/excel-group-and-match-by-product-name", "title": "Excel Group and Match by Product Name", "body": "<p>I have an excel spreadsheet of product data that I need to be reorganized and grouped by product name. An example of a product name looks like:</p>\n\n<p><code>Bee 22\"x36\" Table Runner, Ecru</code></p>\n\n<p>Is there a formula that can find and group all other products with the same name?</p>\n\n<p>For example, I would need the formula to also include </p>\n\n<p><code>Bee 22\"x48\" Table Runner, White</code> </p>\n\n<p>in the grouped results. It's the same product just a different color and size. I'm thinking I will need to use excel wildcards, but that's all I've got.</p>\n\n<p><strong>Additional Examples of Products:</strong></p>\n\n<p>Carillon Pendant Large Ivory <br>\nCarillon Pendant Medium Ivory <br>\nCarillon Pendant Small Ivory<br>\nCashmere Fur Pillow Cream<br>\nCashmere Fur Pillow Light Grey<br>\nFocus King Bed<br>\nFocus Nightstand<br>\nFocus Queen Bed<br>\nFocus Sideboard<br>\nGodenza Dining Table Rectangular Black Ash<br>\nGodenza Dining Table Rectangular Walnut<br>\nGodenza Dining Table Round Black Ash<br>\nGoldman Statue Large<br>\nGoldman Statue Small<br></p>\n"}, {"tags": ["excel", "vba", "concatenation"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1577129651, "post_id": 59460368, "comment_id": 105102078, "body": "VBA is typically going to be <i>slower</i> than an equivalent native function.  Of course, there might just be a much smarter way to approach it."}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1577136288, "post_id": 59460368, "comment_id": 105103842, "body": "You could use the <code>Worksheet.Change</code> event.  Set it to check if <code>Target</code> (cell/cells where the change occurred) is in the user input range/column.  If so, update the value of concatenation cell in the same row (or if <code>Target</code> is multiple cells then check and update for each cell in <code>Target</code>).  See <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">Worksheet.Change event (Excel)</a> from Microsoft."}], "owner": {"reputation": 3, "user_id": 10649400, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213121171694151/picture?type=large", "display_name": "Buddy Harrison", "link": "https://stackoverflow.com/users/10649400/buddy-harrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577129841, "creation_date": 1577129174, "last_edit_date": 1577129841, "question_id": 59460368, "link": "https://stackoverflow.com/questions/59460368/concatenate-based-off-user-input", "title": "Concatenate based off user Input", "body": "<p>I have a excel file that hase 4 Sheets. 3 Sheets for Data based off of the ORG of that Data. Then 1 Sheet for User Input. Each of the Orgs sheets have up to 20 Columns A-T of Data that I want to concatenate. So basically if a user puts a value in Col A on the Input Sheeet the 3 other Sheets in COl U would then fill in. So for Example Say Col A has a value and COL F and Col H. Those COLS would then Concatenate in COL U on the 3 Other sheets. </p>\n\n<p>I currently have a Formula that does this in Excel with a bunch of IF statements but this is very slow As the Sheets of a few of the data sets are very large. One with over 140K rows of Data. So I am hoping to find a way with VBA to check which Cols in the Input Sheet are Filled and Then concatenate in the Data Sheets based off that. I have a Search button and have automatic formulas off so the Search buttton currently then calculates all the formulas. So I can run this code off of that hopefully. but I don't know much about VBA and if it would speed this process up much more then it is currently as it can take a little while currently. I have attached some Screenshots of the Input and Data Sheets. Data being hidden though.</p>\n\n<p>I currently do some lookups after the Excel formulas run with those Concatination to return values to the User. Both ORG 1 &amp; 2 have 20 Columns A:T, Org 3 has 18 A:R. so thats the Only Differenece in the 3 Data Sheets</p>\n\n<p>Once again all i am trying to do is concatenate whatever Columns the user inputs into each Sheet which has thousands of rows on each Sheet. </p>\n\n<p>Input Sheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/ADpsx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ADpsx.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What ORG 1&amp;2 Sheet look like</p>\n\n<p><a href=\"https://i.stack.imgur.com/4Ve1C.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Ve1C.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What ORG 3 Sheet Looks like</p>\n\n<p><a href=\"https://i.stack.imgur.com/kwAEf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kwAEf.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Any help is appreciated. I have looked on here and seen VBA concatenation but nothing quite similar to this task.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1577129276, "post_id": 59460347, "comment_id": 105101976, "body": "Why not use Conditional Formatting?"}, {"owner": {"reputation": 35, "user_id": 11266504, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q1b99ayj_1Q/AAAAAAAAAAI/AAAAAAAAADM/ohLIH_Ihtu4/photo.jpg?sz=128", "display_name": "Javier Prieto", "link": "https://stackoverflow.com/users/11266504/javier-prieto"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1577129595, "post_id": 59460347, "comment_id": 105102061, "body": "No Conditional Formatting is possible for thick black borders"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1577129748, "post_id": 59460347, "comment_id": 105102115, "body": "Wrong use of <code>ActiveCell</code>"}, {"owner": {"reputation": 35, "user_id": 11266504, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q1b99ayj_1Q/AAAAAAAAAAI/AAAAAAAAADM/ohLIH_Ihtu4/photo.jpg?sz=128", "display_name": "Javier Prieto", "link": "https://stackoverflow.com/users/11266504/javier-prieto"}, "edited": false, "score": 0, "creation_date": 1577129797, "post_id": 59460347, "comment_id": 105102137, "body": "So how you fix it"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1577129841, "post_id": 59460347, "comment_id": 105102151, "body": "replace everything inside the if with <code>cell.Offset(0, -54).BorderAround ColorIndex:=1, Weight:=xlThick</code>"}, {"owner": {"reputation": 35, "user_id": 11266504, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q1b99ayj_1Q/AAAAAAAAAAI/AAAAAAAAADM/ohLIH_Ihtu4/photo.jpg?sz=128", "display_name": "Javier Prieto", "link": "https://stackoverflow.com/users/11266504/javier-prieto"}, "edited": false, "score": 0, "creation_date": 1577130608, "post_id": 59460347, "comment_id": 105102371, "body": "It did it in just one cell"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1577130719, "post_id": 59460347, "comment_id": 105102413, "body": "I would just use a different approach see <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">Range.Find method (Excel)</a>. If you want to understand what&#39;s wrong with that line then suggest reading these pages:  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.activecell\" rel=\"nofollow noreferrer\">Application.ActiveCell property (Excel)</a>, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.offset\" rel=\"nofollow noreferrer\">Range.Offset property (Excel)</a>, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.range\" rel=\"nofollow noreferrer\">Range.Range property (Excel)</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1577131926, "post_id": 59460347, "comment_id": 105102758, "body": "It did one cell becuase you are exiting the loop.  Remove the <code>Exit For</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -2, "last_activity_date": 1577132441, "creation_date": 1577132441, "answer_id": 59460928, "question_id": 59460347, "link": "https://stackoverflow.com/questions/59460347/vba-macro-for-thick-borders-on-cells-after-evaluating-if-cells-in-range-are-0/59460928#59460928", "title": "VBA Macro for Thick Borders on cells (After evaluating if cells in range are &gt;0, need offset)", "body": "<p>Turn on the Macro Recorder and click through the steps to do what you need to do.  When done, copy/paste the results code into the small script you have now.  The Recorder will give you everything you need, but you will have more than you actually need, so do a bit of editing and you're done. </p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 11266504, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q1b99ayj_1Q/AAAAAAAAAAI/AAAAAAAAADM/ohLIH_Ihtu4/photo.jpg?sz=128", "display_name": "Javier Prieto", "link": "https://stackoverflow.com/users/11266504/javier-prieto"}, "edited": false, "score": 0, "creation_date": 1577204893, "post_id": 59461109, "comment_id": 105121276, "body": "Thanks for the reply and the help. The Macro does not like this part &quot;  If rngarray(i, j) &gt; 0 Then&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 35, "user_id": 11266504, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q1b99ayj_1Q/AAAAAAAAAAI/AAAAAAAAADM/ohLIH_Ihtu4/photo.jpg?sz=128", "display_name": "Javier Prieto", "link": "https://stackoverflow.com/users/11266504/javier-prieto"}, "edited": false, "score": 0, "creation_date": 1577205981, "post_id": 59461109, "comment_id": 105121555, "body": "Then your data range has  errors in it.  You cannot compare an error.  you will need to add an If to test for errors and ignore it."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1577133753, "creation_date": 1577133753, "answer_id": 59461109, "question_id": 59460347, "link": "https://stackoverflow.com/questions/59460347/vba-macro-for-thick-borders-on-cells-after-evaluating-if-cells-in-range-are-0/59461109#59461109", "title": "VBA Macro for Thick Borders on cells (After evaluating if cells in range are &gt;0, need offset)", "body": "<p>This uses array to limit as much as possible the interaction between the code and sheet.</p>\n\n<pre><code>Sub Borders()\n\n    Dim rngarray As Variant\n    rngarray = ActiveSheet.Range(\"BO5:CL120\").Value\n\n    Dim i As Long\n    For i = LBound(rngarray, 1) To UBound(rngarray, 1)\n        Dim j As Long\n        For j = LBound(rngarray, 2) To UBound(rngarray, 2)\n            If rngarray(i, j) &gt; 0 Then\n                ActiveSheet.Range(\"L4\").Offset(i, j).BorderAround ColorIndex:=1, Weight:=xlThick\n            End If\n        Next j\n    Next i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 11266504, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-q1b99ayj_1Q/AAAAAAAAAAI/AAAAAAAAADM/ohLIH_Ihtu4/photo.jpg?sz=128", "display_name": "Javier Prieto", "link": "https://stackoverflow.com/users/11266504/javier-prieto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1577177210, "creation_date": 1577129016, "last_edit_date": 1577177210, "question_id": 59460347, "link": "https://stackoverflow.com/questions/59460347/vba-macro-for-thick-borders-on-cells-after-evaluating-if-cells-in-range-are-0", "title": "VBA Macro for Thick Borders on cells (After evaluating if cells in range are &gt;0, need offset)", "body": "<p>My VBA code is not running ,  It is stuck on ActiveCell.Offset. </p>\n\n<pre><code>Sub Borders()\nFor Each cell In Range(\"BO5:CL120\")\n\n    If cell.Value &gt; 0 Then\n            ActiveCell.Offset(0, -54).Range(\"A1\").Select\n            ActiveCell.BorderAround _\n            ColorIndex:=1, Weight:=xlThick\n        Exit For\n    End If\n\nNext cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1577138201, "post_id": 59460161, "comment_id": 105104321, "body": "you filter looks okay- can we see the rest of the code?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10047751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d691dad129fb90004405a337ac1365?s=128&d=identicon&r=PG&f=1", "display_name": "P. Armel", "link": "https://stackoverflow.com/users/10047751/p-armel"}, "edited": false, "score": 0, "creation_date": 1577385198, "post_id": 59460351, "comment_id": 105158570, "body": "I realized what the problem was.  The query is correct but I made a careless error. The statement &quot;objectitemsrestriced2.restrict(query)&quot; is wrong.  It should have been                               &quot;Set  objitemsrestricted2=objitemsrestricted.restrict(query)&quot;.  After I did that it worked correctly."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1577129047, "creation_date": 1577129047, "answer_id": 59460351, "question_id": 59460161, "link": "https://stackoverflow.com/questions/59460161/limiting-outlook-items-object-to-emails-with-attachments/59460351#59460351", "title": "Limiting Outlook.Items object to Emails with attachments", "body": "<p>In your query, use <code>True</code> instead of <code>1</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 10047751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d691dad129fb90004405a337ac1365?s=128&d=identicon&r=PG&f=1", "display_name": "P. Armel", "link": "https://stackoverflow.com/users/10047751/p-armel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1583066381, "creation_date": 1577127827, "last_edit_date": 1583066381, "question_id": 59460161, "link": "https://stackoverflow.com/questions/59460161/limiting-outlook-items-object-to-emails-with-attachments", "title": "Limiting Outlook.Items object to Emails with attachments", "body": "<p>I am trying to limit an Outlook.Items object (objitemsrestricted2) to Emails with attachments.</p>\n\n<p>I tried the following with no error messages but no filtering occurs.</p>\n\n<pre><code>query = \"@SQL=\" &amp; Chr(34) &amp; \"urn:schemas:httpmail:hasattachment\" &amp; Chr(34) &amp; \"=1\"\n\n'restrict the set to Emails that have attachments\nobjitemsrestricted2.Restrict (query)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1577128409, "post_id": 59460240, "comment_id": 105101742, "body": "You could create your own, using a concatenated string and a dictionary with the best row to use as the item, though that&#39;s probably more effort."}, {"owner": {"reputation": 60, "user_id": 9272794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wptKNuuquVA/AAAAAAAAAAI/AAAAAAAAAEU/FBFAaeWQjDg/photo.jpg?sz=128", "display_name": "nigiroux", "link": "https://stackoverflow.com/users/9272794/nigiroux"}, "edited": false, "score": 0, "creation_date": 1577128532, "post_id": 59460240, "comment_id": 105101785, "body": "Yes, and what I like about RemoveDuplicates is that its fast."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1577134235, "post_id": 59460240, "comment_id": 105103360, "body": "Just add the column, to the array, where there will be data in the row you want to keep. If the other rows have <code>no data</code> in the additional column they will be deleted and the row with data in the column will not be deleted."}], "tags": [], "owner": {"reputation": 60, "user_id": 9272794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wptKNuuquVA/AAAAAAAAAAI/AAAAAAAAAEU/FBFAaeWQjDg/photo.jpg?sz=128", "display_name": "nigiroux", "link": "https://stackoverflow.com/users/9272794/nigiroux"}, "is_accepted": true, "score": 0, "last_activity_date": 1577128302, "creation_date": 1577128302, "answer_id": 59460240, "question_id": 59460126, "link": "https://stackoverflow.com/questions/59460126/removeduplicates-selecting-the-copy-to-keep/59460240#59460240", "title": "RemoveDuplicates; selecting the copy to keep", "body": "<p>After looking on various forums, I have come to the conclusion that I have no choice but to sort my table depending on the column with the information and then use RemoveDuplicates.</p>\n"}], "owner": {"reputation": 60, "user_id": 9272794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wptKNuuquVA/AAAAAAAAAAI/AAAAAAAAAEU/FBFAaeWQjDg/photo.jpg?sz=128", "display_name": "nigiroux", "link": "https://stackoverflow.com/users/9272794/nigiroux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 59460240, "answer_count": 1, "score": 0, "last_activity_date": 1577128302, "creation_date": 1577127683, "last_edit_date": 1577127711, "question_id": 59460126, "link": "https://stackoverflow.com/questions/59460126/removeduplicates-selecting-the-copy-to-keep", "title": "RemoveDuplicates; selecting the copy to keep", "body": "<p>I am using the RemoveDuplicates function to delete rows that have the same values in column 2-4-5-6-8 and 9, using the code shown below. The problem using this function is that it deletes the last instance. I have a column that may have some information in it, and I want to keep the row that have that information. I was wondering if there is a simple way to do that using this function.   </p>\n\n<pre><code>        .Range(\"A1:M\" &amp; lastrow).RemoveDuplicates Columns:=Array(2, 4, 5, 6, 8, 9), _\n        Header:=xlYes\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1577127647, "post_id": 59460034, "comment_id": 105101493, "body": "You&#39;re afraid users won&#39;t know what the date format is on their own machines?"}, {"owner": {"reputation": 123, "user_id": 8156963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84c20bed340fd0d7e9a4b1d8614e5f7?s=128&d=identicon&r=PG&f=1", "display_name": "MiniG34", "link": "https://stackoverflow.com/users/8156963/minig34"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1577128173, "post_id": 59460034, "comment_id": 105101673, "body": "@KenWhite  I&#39;m afraid they would not be fully aware that MS Access uses the same date format as their OS."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1577128306, "post_id": 59460034, "comment_id": 105101714, "body": "Force the format - either via mask in the form or using the format function and listing as a string and label the box to make it clear what the format is - maintaing concistency for all users. <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a> Otherwise if you are dead-set on listing and using OS date format settings - see here.  Can be done by using windows API calls. <a href=\"http://www.vbforums.com/showthread.php?33984-How-to-GET-the-system-date-format-from-regional-settings\" rel=\"nofollow noreferrer\">vbforums.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 3, "last_activity_date": 1577130980, "creation_date": 1577130980, "answer_id": 59460688, "question_id": 59460034, "link": "https://stackoverflow.com/questions/59460034/finding-os-short-date-format-string-in-ms-access-vba/59460688#59460688", "title": "Finding OS short date format string in MS-Access/VBA", "body": "<p>Just pull it from the registry.</p>\n\n<p>There are many ways, the way I use:</p>\n\n<pre><code>CreateObject(\"WScript.Shell\").RegRead(\"HKCU\\Control Panel\\International\\sShortDate\")\n</code></pre>\n\n<p>Of course, one could use WinAPI to read the registry too.</p>\n\n<p>If reading the registry is really undesirable, you can always format a distinct date, for example:</p>\n\n<pre><code>Format(#2/1/3333#, \"Short Date\")\n</code></pre>\n\n<p>And then parse the result to get the format</p>\n"}], "owner": {"reputation": 123, "user_id": 8156963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e84c20bed340fd0d7e9a4b1d8614e5f7?s=128&d=identicon&r=PG&f=1", "display_name": "MiniG34", "link": "https://stackoverflow.com/users/8156963/minig34"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 59460688, "answer_count": 1, "score": 0, "last_activity_date": 1577130980, "creation_date": 1577127096, "question_id": 59460034, "link": "https://stackoverflow.com/questions/59460034/finding-os-short-date-format-string-in-ms-access-vba", "title": "Finding OS short date format string in MS-Access/VBA", "body": "<p>I am looking for a VBA function that would return the current OS Short date format (ex: <code>M/d/yyyy</code>, <code>dd-MMM-yy</code>, <code>yy/MM/dd</code>, etc.) as a string. I have found such functions for MS Excel on related posts using <code>Application.International</code>, but they do not work with MS Access.</p>\n\n<p>I want to be able to show the OS date format in my forms to avoid confusion if '08-11-11' is displayed, for example. Using <code>CDate()</code>, my dates are automatically formatted to whatever is set in Windows Date and time settings. However, users might not be aware of that.</p>\n"}, {"tags": ["excel", "vba", "ms-project"], "comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1577156811, "post_id": 59460033, "comment_id": 105107355, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.task.setfield\" rel=\"nofollow noreferrer\">SetField</a> is useful when the field to be set isn&#39;t know at run-time. Since you know the field, try setting <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.task.percentworkcomplete\" rel=\"nofollow noreferrer\">PercentWorkComplete</a> directly: <code>t.PercentWorkComplete = workCompl</code> rather than coercing it to a string."}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 7497175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1095904507202696/picture?type=large", "display_name": "viviansplatoon", "link": "https://stackoverflow.com/users/7497175/viviansplatoon"}, "edited": false, "score": 0, "creation_date": 1577130069, "post_id": 59460325, "comment_id": 105102227, "body": "Thanks for your comment. Unfortunately this still does not work and I&#39;m having the same issue as before. It seems that &#39;t.SetField FieldID:=188743713, Value:=100&#39; is buggy."}, {"owner": {"reputation": 2369, "user_id": 11948610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7369157d6c65253cc08bdd8ad7d1661?s=128&d=identicon&r=PG&f=1", "display_name": "CR7SMS", "link": "https://stackoverflow.com/users/11948610/cr7sms"}, "reply_to_user": {"reputation": 148, "user_id": 7497175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1095904507202696/picture?type=large", "display_name": "viviansplatoon", "link": "https://stackoverflow.com/users/7497175/viviansplatoon"}, "edited": false, "score": 0, "creation_date": 1577131428, "post_id": 59460325, "comment_id": 105102621, "body": "Are you sure the field id is accurate? if not, try the if statement in the answer"}, {"owner": {"reputation": 148, "user_id": 7497175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1095904507202696/picture?type=large", "display_name": "viviansplatoon", "link": "https://stackoverflow.com/users/7497175/viviansplatoon"}, "edited": false, "score": 0, "creation_date": 1577132009, "post_id": 59460325, "comment_id": 105102778, "body": "I&#39;m certain the field id is accurate because it would not work for all the other tasks. Strangely enough it seems that it is failing on three specific tasks whose % work complete fields are supposed to be 100% but they are set as 0%. I tried your if statement but I changed the field name to &quot;PercentWorkComplete&quot; and nothing has changed - same result :("}, {"owner": {"reputation": 2369, "user_id": 11948610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7369157d6c65253cc08bdd8ad7d1661?s=128&d=identicon&r=PG&f=1", "display_name": "CR7SMS", "link": "https://stackoverflow.com/users/11948610/cr7sms"}, "reply_to_user": {"reputation": 148, "user_id": 7497175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1095904507202696/picture?type=large", "display_name": "viviansplatoon", "link": "https://stackoverflow.com/users/7497175/viviansplatoon"}, "edited": false, "score": 0, "creation_date": 1577132149, "post_id": 59460325, "comment_id": 105102822, "body": "When you say it is set to 0%, is it in the excel file or the task?"}, {"owner": {"reputation": 148, "user_id": 7497175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1095904507202696/picture?type=large", "display_name": "viviansplatoon", "link": "https://stackoverflow.com/users/7497175/viviansplatoon"}, "edited": false, "score": 0, "creation_date": 1577132742, "post_id": 59460325, "comment_id": 105102983, "body": "After running my code, in MS Project the task is set to 0% but in the Excel file, the value is 100% so it failed to successfully change the % work complete field in MS Project."}], "tags": [], "owner": {"reputation": 2369, "user_id": 11948610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7369157d6c65253cc08bdd8ad7d1661?s=128&d=identicon&r=PG&f=1", "display_name": "CR7SMS", "link": "https://stackoverflow.com/users/11948610/cr7sms"}, "is_accepted": false, "score": 0, "last_activity_date": 1577131363, "last_edit_date": 1577131363, "creation_date": 1577128845, "answer_id": 59460325, "question_id": 59460033, "link": "https://stackoverflow.com/questions/59460033/set-tasks-work-complete-field-using-values-in-excel-sheet/59460325#59460325", "title": "Set Task&#39;s Work Complete Field using values in Excel sheet", "body": "<p>Your code is not setting the work complete field to 100, it is multiplying the existing value in the column F by 100. </p>\n\n<pre><code>workCompl = Val(Range(\"F\" &amp; row)) * 100 \n</code></pre>\n\n<p>Since you are using the above formula, you will get a 100 only when column F has a value of 1. If your objective is to set everything to 100 then use:</p>\n\n<pre><code>workCompl = 100 \n</code></pre>\n\n<p>Hope this helps.</p>\n\n<p>Edit1:</p>\n\n<p>Can you try this instead of the if statement you have:</p>\n\n<pre><code>If Not t.Summary Then\n    projectField = FieldNameToFieldConstant(\"PercentComplete\") \n    t.SetField FieldID:=projectField, Value:=workCompl ' Set task work complete\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 148, "user_id": 7497175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1095904507202696/picture?type=large", "display_name": "viviansplatoon", "link": "https://stackoverflow.com/users/7497175/viviansplatoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580288278, "creation_date": 1577127075, "last_edit_date": 1580288278, "question_id": 59460033, "link": "https://stackoverflow.com/questions/59460033/set-tasks-work-complete-field-using-values-in-excel-sheet", "title": "Set Task&#39;s Work Complete Field using values in Excel sheet", "body": "<p>I'm using VBA to set each Work Complete field of a Project task using values from the Work Complete column in my Excel sheet.</p>\n\n<p>When I set the Work Complete Field to 100 sometimes it sets the Project task's work complete to 0. This does not occur with any other value.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>For Each row In tasksDict.Keys\nDim t As task\n' Get unique id in this row\nUID = Range(\"A\" &amp; row)\nworkCompl = Val(Range(\"F\" &amp; row)) * 100 \nDebug.Print (\"ID: \" &amp; UID &amp; \"Work complete: \") &amp; workCompl ' This prints out the correct values\n\nSet t = prj.tasks.uniqueID(UID) ' Get task by unique ID\n\nIf Not t.Summary Then\n    t.SetField FieldID:=188743713, Value:=workCompl ' Set task work complete\nEnd If\n\nNext row\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1577126899, "post_id": 59459925, "comment_id": 105101239, "body": "These shouldn&#39;t be separate lines. Either combine them to one line, or use the line separation ` _`."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1577126962, "post_id": 59459925, "comment_id": 105101265, "body": "Try this  <code>wsCopy.Range(&quot;B4&quot;).Copy Destination:=wsDest.Range(&quot;B&quot; &amp; Rows.Count).End(xlUp)(1, 0)</code> in single line `"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577127020, "post_id": 59460006, "comment_id": 105101293, "body": "<code>Copy</code> is a single line call. Your problem was that you were putting the <code>Destination</code> parameter on a different line."}], "tags": [], "owner": {"reputation": 11, "user_id": 11678721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b5b4c23da9e30db3e5210449a73ee78?s=128&d=identicon&r=PG&f=1", "display_name": "CP22222", "link": "https://stackoverflow.com/users/11678721/cp22222"}, "is_accepted": false, "score": 0, "last_activity_date": 1577127774, "last_edit_date": 1577127774, "creation_date": 1577126945, "answer_id": 59460006, "question_id": 59459925, "link": "https://stackoverflow.com/questions/59459925/vba-trying-to-copy-and-paste-getting-a-compile-error-expected/59460006#59460006", "title": "VBA: Trying to copy and paste getting a compile error- expected: =", "body": "<pre><code>wsCopy.Range(\"B4\").Copy wsDest.Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial\n</code></pre>\n\n<p>Simple fix</p>\n"}], "owner": {"reputation": 11, "user_id": 11678721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b5b4c23da9e30db3e5210449a73ee78?s=128&d=identicon&r=PG&f=1", "display_name": "CP22222", "link": "https://stackoverflow.com/users/11678721/cp22222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577127774, "creation_date": 1577126618, "question_id": 59459925, "link": "https://stackoverflow.com/questions/59459925/vba-trying-to-copy-and-paste-getting-a-compile-error-expected", "title": "VBA: Trying to copy and paste getting a compile error- expected: =", "body": "<pre><code>wsCopy.Range(\"B4\").Copy\n    wsDest.Range(\"B\" &amp; Rows.Count).End(xlUp)(1,0)\n</code></pre>\n\n<p>Copying from one worksheet and pasting to another in a different workbook</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1577124967, "post_id": 59459627, "comment_id": 105100620, "body": "Why don&#39;t you just add <code>If sht.Name = &quot;Mapping&quot; Then</code> where you need it."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1577125667, "post_id": 59459627, "comment_id": 105100845, "body": "Or maybe you need <code>If sht.Name &lt;&gt; &quot;Mapping&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 12585774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J218b.gif?s=128&g=1", "display_name": "Mr. Englander", "link": "https://stackoverflow.com/users/12585774/mr-englander"}, "edited": false, "score": 0, "creation_date": 1577173107, "post_id": 59461573, "comment_id": 105110774, "body": "thank you for your help! I had to do one change, but it was on the file itself: the sheet &quot;Mapping&quot; was the first sheet, and had a different format from the others. Therefore I had to move the sheet to the end of the book, as otherwise, it would affect the format of my &quot;Master&quot; sheet and give me the wrong information."}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "reply_to_user": {"reputation": 23, "user_id": 12585774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J218b.gif?s=128&g=1", "display_name": "Mr. Englander", "link": "https://stackoverflow.com/users/12585774/mr-englander"}, "edited": false, "score": 0, "creation_date": 1577237436, "post_id": 59461573, "comment_id": 105127409, "body": "That\u2019s great!  Glad I could help."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1577367068, "post_id": 59461573, "comment_id": 105152662, "body": "Friendly hint: 65,536 was the maximum number of spreadsheet rows supported by Excel 97 up to Excel 2003, so replace the number by <code>sht.Rows.Count</code> if you are using more up to date versions as well."}], "tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": true, "score": 1, "last_activity_date": 1577137204, "creation_date": 1577137204, "answer_id": 59461573, "question_id": 59459627, "link": "https://stackoverflow.com/questions/59459627/vba-ignore-a-sheet-when-consolidating-other-sheets/59461573#59461573", "title": "VBA - Ignore a sheet when consolidating other sheets", "body": "<p>Update the last loop to look like this:</p>\n\n<pre><code>' We can start loop\nFor Each sht In wrk.Worksheets\n\n    ' If worksheet in loop is the last one, stop execution (it is Master worksheet)\n    If sht.Index = wrk.Worksheets.Count Then\n        Exit For\n    End If\n\n    If Not sht.Name = \"Mapping\" Then\n        ' Data range in worksheet - starts from second row as first rows are the header rows in all worksheets\n        Set rng = sht.Range(sht.Cells(2, 1), sht.Cells(65536, 1).End(xlUp).Resize(, colCount))\n        ' Put data into the Master worksheet\n        trg.Cells(65536, 1).End(xlUp).Offset(1).Resize(rng.Rows.Count, rng.Columns.Count).Value = rng.Value\n\n    End If\n\nNext sht\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<p>As this script loops through each sheet combining data, your code first checks if the sheet is the last in the workbook.  If so, it stops looping and does nothing with that last sheet.  I added code just below that point.  The line <code>If Not sht.Name = \"Mapping\" Then</code> tells VBA to only execute the code inside the <code>IF</code> block if the current sheet in the loop is not named \"Mapping\".</p>\n"}], "owner": {"reputation": 23, "user_id": 12585774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J218b.gif?s=128&g=1", "display_name": "Mr. Englander", "link": "https://stackoverflow.com/users/12585774/mr-englander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 59461573, "answer_count": 1, "score": 2, "last_activity_date": 1577137204, "creation_date": 1577124804, "last_edit_date": 1577136027, "question_id": 59459627, "link": "https://stackoverflow.com/questions/59459627/vba-ignore-a-sheet-when-consolidating-other-sheets", "title": "VBA - Ignore a sheet when consolidating other sheets", "body": "<p>I have a workbook where I need to consolidate some sheets and not others.</p>\n\n<p>The consolidate part was easy (thanks to <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=151\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/kb/getarticle.php?kb_id=151</a>).</p>\n\n<p>I am struggling to ignore a sheet called \"Mapping\".</p>\n\n<pre><code>Sub CopyFromWorksheets()\nDim wrk As Workbook 'Workbook object - Always good to work with object variables\nDim sht As Worksheet 'Object for handling worksheets in loop\nDim trg As Worksheet 'Master Worksheet\nDim rng As Range 'Range object\nDim colCount As Integer 'Column count in tables in the worksheets\n\nSet wrk = ActiveWorkbook 'Working in active workbook\n\nFor Each sht In wrk.Worksheets\n    If sht.Name = \"Master\" Then\n        MsgBox \"There is a worksheet called as 'Master'.\" &amp; vbCrLf &amp; _\n          \"Please remove or rename this worksheet since 'Master' would be\" &amp; _\n          \"the name of the result worksheet of this process.\", vbOKOnly + vbExclamation, \"Error\"\n        Exit Sub\n    End If\nNext sht\n\n 'We don't want screen updating\nApplication.ScreenUpdating = False\n\n 'Add new worksheet as the last worksheet\nSet trg = wrk.Worksheets.Add(After:=wrk.Worksheets(wrk.Worksheets.Count))\n 'Rename the new worksheet\ntrg.Name = \"Master\"\n 'Get column headers from the first worksheet\n 'Column count first\nSet sht = wrk.Worksheets(1)\ncolCount = sht.Cells(1, 255).End(xlToLeft).Column\n 'Now retrieve headers, no copy&amp;paste needed\nWith trg.Cells(1, 1).Resize(1, colCount)\n    .Value = sht.Cells(1, 1).Resize(1, colCount).Value\n     'Set font as bold\n    .Font.Bold = True\nEnd With\n\n 'We can start loop\nFor Each sht In wrk.Worksheets\n     'If worksheet in loop is the last one, stop execution (it is Master worksheet)\n    If sht.Index = wrk.Worksheets.Count Then\n        Exit For\n    End If\n     'Data range in worksheet - starts from second row as first rows are the header rows in all worksheets\n    Set rng = sht.Range(sht.Cells(2, 1), sht.Cells(65536, 1).End(xlUp).Resize(, colCount))\n     'Put data into the Master worksheet\n    trg.Cells(65536, 1).End(xlUp).Offset(1).Resize(rng.Rows.Count, rng.Columns.Count).Value = rng.Value\nNext sht\n 'Fit the columns in Master worksheet\ntrg.Columns.AutoFit\n\n 'Screen updating should be activated\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vbscript", "automation"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1577124494, "post_id": 59459526, "comment_id": 105100447, "body": "Presumably <code>ThisWorkbook.Incentive</code> should be rewritten to return a workbook object. <code>Workbooks.Open</code> returns a workbook reference that you need to capture."}, {"owner": {"reputation": 1, "user_id": 12546576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507ff48f45936f9c1dd47b0400fdc742?s=128&d=identicon&r=PG&f=1", "display_name": "BruceBalistreri1", "link": "https://stackoverflow.com/users/12546576/brucebalistreri1"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577126553, "post_id": 59459526, "comment_id": 105101131, "body": "I&#39;m a big noob. Plz forgive.      I am running this from a .vbs script I made in notepad.  I couldn&#39;t use &quot;workbooks.open&quot; because the excel file is password protected (i was having trouble with that).    So instead, I&#39;m running the &quot;INCENTIVE&quot; macro in the master book to open up the incentive report and punch the password in, read-only false, etc. etc.  Is there some way to declare a workbook explicitly from this external notepad file?  (god im such a scrub)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577126750, "post_id": 59459526, "comment_id": 105101191, "body": "Make <code>Incentive</code> a <code>Function</code> that returns a <code>Workbook</code> object."}, {"owner": {"reputation": 1, "user_id": 12546576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507ff48f45936f9c1dd47b0400fdc742?s=128&d=identicon&r=PG&f=1", "display_name": "BruceBalistreri1", "link": "https://stackoverflow.com/users/12546576/brucebalistreri1"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577126910, "post_id": 59459526, "comment_id": 105101243, "body": "Perhaps a macro that can reside the master workbook to say something like..  &quot;If this workbook is the active workbook, then make the other workbook the active workbook&quot;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577126958, "post_id": 59459526, "comment_id": 105101263, "body": "No there&#39;s no need to do that. You need <code>Function Incentive() As Workbook</code>, not <code>Sub</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1577141024, "post_id": 59459526, "comment_id": 105104990, "body": "<code>Set objSheet = GetObject(&quot;C:\\folder\\myworkbook.xlsx!Sheetname&quot;)</code> instead of <code>CreateObject</code> with the application object. To access <code>Run</code> use <code>objSheet.Application.run</code>. Doc objects follow COM rules but Excels App object doesn&#39;t quite for compatibility reasons."}, {"owner": {"reputation": 1, "user_id": 12546576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507ff48f45936f9c1dd47b0400fdc742?s=128&d=identicon&r=PG&f=1", "display_name": "BruceBalistreri1", "link": "https://stackoverflow.com/users/12546576/brucebalistreri1"}, "edited": false, "score": 0, "creation_date": 1577200268, "post_id": 59459526, "comment_id": 105119890, "body": "I&#39;m sure what you guys are saying makes sense, but I have little to no VBA experience, and I just can&#39;t get it/don&#39;t understand.  Is there a way to simply say &quot;activate workbook (filepath)&quot; prior to the &quot;activeworkbook.save // activeworkbook.close&quot; steps?  That seems like the easiest bandaid solution for me which requires the lowest amount of understanding."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12546576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507ff48f45936f9c1dd47b0400fdc742?s=128&d=identicon&r=PG&f=1", "display_name": "BruceBalistreri1", "link": "https://stackoverflow.com/users/12546576/brucebalistreri1"}, "is_accepted": true, "score": 0, "last_activity_date": 1577799771, "creation_date": 1577799771, "answer_id": 59544875, "question_id": 59459526, "link": "https://stackoverflow.com/questions/59459526/vb-script-excel-activeworkbook-getting-scrambled-how-to-declare-explicit-w/59544875#59544875", "title": "VB Script -- Excel &quot;Activeworkbook&quot; Getting Scrambled. How to declare explicit workbook?", "body": "<p>Thanks so much for your help guys, I was able to come up with a solution that worked for me.</p>\n\n<p>The original issue is that the activeworkbook was changing unexpectedly. To fix this, I declared \"activeworkbook = WBK\" and used the WBK variable instead of using \"activeworkbook\".</p>\n\n<p>EXAMPLE BELOW:</p>\n\n<pre><code>Dim objExcel\n\nSet objExcel = CreateObject(\"Excel.Application\")\n\n\n\nobjExcel.Workbooks.Open(\"S:\\Analyst_Reporting\\Automation\\DAILY AUTOMATION BOOK.xlsm\") \n\n\nobjExcel.Visible = True\n\n\n\nobjExcel.Run \"ThisWorkbook.INCENTIVE\"\nset wbk = objExcel.ActiveWorkbook 'SETTING WBK = ACTIVEWORKBOOK HERE\nobjExcel.Run \"ThisWorkbook.helloworld\"\nwbk.save                          'CALLING WBK INSTEAD OF \"ACTIVEWORKBOOK.SAVE\"\nwbk.close(0)                      'CALLING WBK INSTEAD OF \"ACTIVEWORKBOOK.CLOSE\"\nobjExcel.Run \"Thisworkbook.INCENTIVETIMESTAMP\"\nobjExcel.Run \"Thisworkbook.SAVEtest\"\n\n\nobjExcel.Run \"ThisWorkbook.ACE\"\nset wbk = objExcel.ActiveWorkbook\nobjExcel.Run \"Thisworkbook.helloworld\"\nwbk.save\nwbk.close(0)\nobjExcel.Run \"Thisworkbook.ACETIMESTAMP\"\nobjExcel.Run \"Thisworkbook.SAVEtest\"\n\nobjExcel.Run \"ThisWorkbook.CLOSINGRATIO\"\nset wbk = objExcel.ActiveWorkbook\nobjExcel.Run \"Thisworkbook.helloworld\"\nwbk.save\nwbk.close(0)\nobjExcel.Run \"Thisworkbook.CLOSINGRATIOTIMESTAMP\"\nobjExcel.Run \"Thisworkbook.SAVEtest\"\n</code></pre>\n\n<hr>\n\n<p>This worked quite well for me, although I'm sure there are more elegant solutions :)</p>\n\n<p>Thanks again!</p>\n"}], "owner": {"reputation": 1, "user_id": 12546576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507ff48f45936f9c1dd47b0400fdc742?s=128&d=identicon&r=PG&f=1", "display_name": "BruceBalistreri1", "link": "https://stackoverflow.com/users/12546576/brucebalistreri1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 59544875, "answer_count": 1, "score": 0, "last_activity_date": 1577799771, "creation_date": 1577124223, "last_edit_date": 1577188222, "question_id": 59459526, "link": "https://stackoverflow.com/questions/59459526/vb-script-excel-activeworkbook-getting-scrambled-how-to-declare-explicit-w", "title": "VB Script -- Excel &quot;Activeworkbook&quot; Getting Scrambled. How to declare explicit workbook?", "body": "<p>I'm pretty new to VBA but am trying to create an automation script that opens, refreshes, saves and closes a few excel reports.</p>\n\n<p>I currently have a vbs script, but I'm encountering an issue with <code>ACTIVEWORKBOOK</code></p>\n\n<p>My issue:  Sometimes, the vba chooses the wrong workbook as <code>activeworkbook</code> and ends up saving and closing the wrong workbook.</p>\n\n<p><strong>My Question: How can I explicitly declare the <code>INCENTIVE REPORT</code> instead of using <code>ActiveWorkBook</code>?</strong></p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Dim objExcel\n\nSet objExcel = CreateObject(\"Excel.Application\")\n\n**'THIS IS THE MASTER BOOK WHICH OPENS ALL OF THE OTHER FILES AND KEEPS TIMESTAMPS OF WHEN THEY WERE LAST SAVED**\n\nobjExcel.Workbooks.Open(\"S:\\Analyst_Reporting\\Automation\\DAILY AUTOMATION BOOK.xlsm\")  \n\n\nobjExcel.Visible = True\n\n**'THIS OPENS AN \"INCENTIVE REPORT\"**\n\nobjExcel.Run \"ThisWorkbook.INCENTIVE\"  \n\n **'THIS REFRESHES THE \"INCENTIVE REPORT\"**\n\nobjExcel.Run \"Thisworkbook.helloworld\" \n\n***'THIS IS WHERE THE PROBLEM OCCURS.  INSTEAD OF SAVING THE INCENTIVE REPORT (WHICH SHOULD BE \"ACTIVEWORKBOOK\"), IT SAVES AND CLOSES THE \"DAILY AUTOMATION BOOK\" AND CRASHES THE REPORT***\n\nobjExcel.**ActiveWorkbook**.Save   \n\nobjExcel.ActiveWorkbook.Close(0)\n\nobjExcel.Run \"Thisworkbook.INCENTIVETIMESTAMP\"\n\nobjExcel.Run \"Thisworkbook.SAVEtest\"\n\n\nobjExcel.Run \"ThisWorkbook.ACE\"\n\nobjExcel.Run \"Thisworkbook.helloworld\"\n\nobjExcel.ActiveWorkbook.Save\n\nobjExcel.ActiveWorkbook.Close(0)\n\nobjExcel.Run \"Thisworkbook.ACETIMESTAMP\"\n\nobjExcel.Run \"Thisworkbook.SAVEtest\"\n\n\n\n\nobjExcel.Wait(Now + TimeValue(\"0:00:20\"))\n\nobjExcel.ActiveWorkbook.Save\n\nobjExcel.ActiveWorkbook.Close(0)\n\nobjExcel.Quit\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1577122007, "post_id": 59458735, "comment_id": 105099532, "body": "The top snippet is implicitly making an assumption about the shape of <code>Target</code>; the bottom snippet doesn&#39;t make that assumption and will work more reliably."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1577122303, "post_id": 59458735, "comment_id": 105099643, "body": "Also <code>Call</code> is redundant, just <code>MainSub</code> is enough to invoke it... and you&#39;ll want to set <code>Application.EnableEvents = False</code> before and <code>= True</code> after, otherwise if <code>MainSub</code> decides to modify any cell, then the event handler will be re-entrant (implicit recursion).. and if it modifies cell B1 (or B3), everything bursts up in flames."}, {"owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1577450277, "post_id": 59458735, "comment_id": 105174150, "body": "@MathieuGuindon So I put <code>Application.EnableEvents = False</code> right before and after <code>MainSub</code>?   I use call because it makes the code more readable to me. With <code>Call</code>, I immediately know that another sub is being called, which to me as a beginner isn&#39;t always clear otherwise."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1577459390, "post_id": 59458735, "comment_id": 105177520, "body": "<code>Application.EnableEvents</code> controls whether or not <code>Worksheet_Change</code> gets to run when a cell is modified. You want it set to <code>False</code> if running <code>Worksheet_Change</code> is going to be modifying any cells, and you want it back to <code>True</code> when the event handler exits, so that the next time B1/B3 is modified the handler picks it up. Otherwise <code>Application.EnableEvents</code> will just remain <code>False</code> after the first invoke, and there won&#39;t be a second."}, {"owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1577463762, "post_id": 59458735, "comment_id": 105179156, "body": "@MathieuGuindon It won&#39;t be an issue in this case because those cells won&#39;t be touched by the macro, but it sounds like good practice to consider this whenever working with &#39;Worksheet_Change&#39;. Thanks for pointing it out to me!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1577464764, "post_id": 59458735, "comment_id": 105179570, "body": "Whether the specific cells are affected or not makes no difference, the event is re-entrant and you want to avoid this and not be one simple conditional statement away from completely crashing everything with uncontrolled implicit recursion... <i>especially</i> since whether or not a cell is modified depends on code that is in another procedure / another module. But sure, not an issue <i>now</i>."}, {"owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1577465359, "post_id": 59458735, "comment_id": 105179792, "body": "@MathieuGuindon I think now I got it. It should make the code slower, too, right? At least when it&#39;s longer and lots of cells get modified, the code jumps to the <code>Worksheet_Change</code> sub every time it happens?"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 5, "last_activity_date": 1577177012, "last_edit_date": 1577177012, "creation_date": 1577120128, "answer_id": 59458826, "question_id": 59458735, "link": "https://stackoverflow.com/questions/59458735/vba-worksheet-change-target-address-vs-working-with-intersect/59458826#59458826", "title": "VBA: Worksheet_Change - Target.Address vs Working with Intersect", "body": "<p>You could use:</p>\n\n<pre><code>If Not Intersect(Target, Range(\"B1,B3\")) Is Nothing Then\n</code></pre>\n\n<p><code>Intersect</code> is useful as it will react when multiple cells are changed. For example, if a user copies and pastes data into a range that happens to overlap B1 and/or B3, <code>Target.Address</code> will not be <code>$B$1</code> or <code>$B$3</code>,  but <code>Intersect</code> will still work.</p>\n"}], "owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 59458826, "answer_count": 1, "score": 1, "last_activity_date": 1577177012, "creation_date": 1577119705, "question_id": 59458735, "link": "https://stackoverflow.com/questions/59458735/vba-worksheet-change-target-address-vs-working-with-intersect", "title": "VBA: Worksheet_Change - Target.Address vs Working with Intersect", "body": "<p>I am successfully running a macro that includes the following piece of code: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$B$1\" Or Target.Address = \"$B$3\" Then\n        Call MainSub\n    End If\nEnd Sub\n</code></pre>\n\n<p>The point of this sub is to make the macro spring into action via calling <code>MainSub</code> when Cell B1 or B3 are changed. It works. </p>\n\n<p>However, when looking for a solution on how to do this, I also came across this code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Target.Worksheet.Range(\"B1\")) Is Nothing Then\n        Call MainSub\n    End If\nEnd Sub\n</code></pre>\n\n<p>It works just as well with only B1. </p>\n\n<p>Now I have two questions: </p>\n\n<p>1) How would I include another cell (B3) to check in the intersect method? Using <code>or</code> didn't work for me, so  I think another if-Statement after the first one would do the trick, but is there a more elegant solution? </p>\n\n<p>2) What's the advantage of using <code>intersect</code> vs simply looking at <code>Target.Address</code>?</p>\n"}, {"tags": ["sql", "vba", "ms-access", "subform"], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 12161466, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAGFEKVWOY5mSkGK5DFeHfKVRbQ9vNs7B3CIP-tD5c=k-s128", "display_name": "Lauren Berns III", "link": "https://stackoverflow.com/users/12161466/lauren-berns-iii"}, "is_accepted": true, "score": 0, "last_activity_date": 1577119525, "creation_date": 1577119525, "answer_id": 59458694, "question_id": 59458693, "link": "https://stackoverflow.com/questions/59458693/access-vba-how-to-filter-a-mainform-by-searching-a-subform-in-a-one-to-many-rel/59458694#59458694", "title": "Access VBA: How to filter a mainform by searching a subform in a one-to-many relationship?", "body": "<p>After typing this, I realized I did in fact have the VBA and SQL know-how to put together a solution, but I thought I'd post this anyway for posterity. </p>\n\n<pre><code>Private Sub NoteSearch_AfterUpdate()\n    Dim strSQL As String\n    If IsNull(Me.NoteSearch) Then\n        Me.Parent.RecordSource = \"people\"\n    Else\n        strSQL = \"SELECT DISTINCTROW people.* FROM people INNER JOIN notes ON people.personID = notes.people_personID WHERE notes.note LIKE '%\" &amp; Me.NoteSearch &amp; \"%'\"\n        Me.Parent.RecordSource = strSQL\n    End If\nEnd Sub\n</code></pre>\n\n<p>Please note: I have explicitly included the % wildcard on either side of the text in the code since I consider that to be a more common use-case than explicitly searching for a note whose exact text matches that in the search field. I suppose you could exclude the wildcard and teach the users how to include it themselves, which may be preferable.</p>\n"}], "owner": {"reputation": 79, "user_id": 12161466, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAGFEKVWOY5mSkGK5DFeHfKVRbQ9vNs7B3CIP-tD5c=k-s128", "display_name": "Lauren Berns III", "link": "https://stackoverflow.com/users/12161466/lauren-berns-iii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 59458694, "answer_count": 1, "score": 0, "last_activity_date": 1577119525, "creation_date": 1577119525, "question_id": 59458693, "link": "https://stackoverflow.com/questions/59458693/access-vba-how-to-filter-a-mainform-by-searching-a-subform-in-a-one-to-many-rel", "title": "Access VBA: How to filter a mainform by searching a subform in a one-to-many relationship?", "body": "<p>I've got a form for entering contacts which contains several subforms, many of which represent many-to-many relationships. I wish for users to be able to search contacts by values in their subforms.</p>\n\n<p>Ironically, I actually have a good, functional solution for searching those subforms which represent many-to-many relationships-- usually, those are the ones that give me the most trouble! The problem is, the solution I'm using uses comboboxes, and therefore allows users to only search by the exact values available in the drop-down. Here's what I mean: </p>\n\n<p><a href=\"https://i.stack.imgur.com/65sWX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/65sWX.png\" alt=\"The Subform in question\"></a></p>\n\n<pre><code>Private Sub cboSourceSearch_AfterUpdate()\n\nDim strSQL As String\nIf IsNull(Me.cboSourceSearch) Then\n    Me.Parent.RecordSource = \"people\"\nElse\n    strSQL = \"SELECT DISTINCTROW people.* FROM people \" &amp; \"INNER JOIN people_has_sourceref ON \" &amp; \"people.personID = people_has_sourceref.people_personID \" &amp; \"WHERE people_has_sourceref.sourceref_sourceID = \" &amp; Me.cboSourceSearch &amp; \";\"\n    Me.Parent.RecordSource = strSQL\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>(Adapted from <a href=\"http://allenbrowne.com/ser-28.html\" rel=\"nofollow noreferrer\">http://allenbrowne.com/ser-28.html</a>)<br>\nEssentially this VBA is setting the RecordSource of the main form from the value in the combo-box, whose row source is the \"sourceref\" table-- the third in the many-to-many relationship. This works great, but what if I want to search by a note left on a contact? The table is called \"Notes\", and is in a many-to-one relationship with People (contacts). It's a free form block of text for entering notes relating to the contact. </p>\n\n<p>I've got a general idea of how this would work, and theoretically it should be easier than the above method: Just set the RecordSource of the main form based on an SQL query which searches the Notes table with wildcard characters on either side. Yet, I can't put together a solution. This is essentially due to my lack of VBA knowledge, but I'm learning.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1577115323, "post_id": 59457788, "comment_id": 105096791, "body": "find the last row in the target range and add it there: <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\" title=\"error in finding last used cell in excel with vba\">stackoverflow.com/questions/11169445/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1577116836, "post_id": 59457788, "comment_id": 105097401, "body": "Does the <code>Actual</code> sheet also hold a <code>ListObject</code>? If so then you can just get ahold of that table and get a reference to a new row with <code>ListObject.ListRows.Add</code>, which returns the <code>ListRow</code> object for the row that&#39;s been added at the bottom of the table; pasting to that row&#39;s <code>Range</code> should &quot;just work&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "is_accepted": false, "score": 0, "last_activity_date": 1577116961, "last_edit_date": 1577116961, "creation_date": 1577115699, "answer_id": 59457910, "question_id": 59457788, "link": "https://stackoverflow.com/questions/59457788/add-data-to-another-table/59457910#59457910", "title": "Add data to another table", "body": "<p>I think you want something like this</p>\n\n<pre><code>Dim ws As Worksheet\nDim rangeToPaste As Range\nSet ws = Sheets(\"Actual\")\n'go up from the bottom to the first row populated in column 5(E) after do +1 to paste after the last row'\nSet rangeToPaste = ws.Range(\"E\" &amp; ws.Cells(ws.rows.Count, 5).End(xlUp).row + 1)\nSheets(\"Letter (P V)\").ListObjects(\"Table1\").Range.Copy Destination:=rangeToPaste\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12585687, "user_type": "registered", "profile_image": "https://graph.facebook.com/2643437122342710/picture?type=large", "display_name": "Leonid Zaydel", "link": "https://stackoverflow.com/users/12585687/leonid-zaydel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577176211, "creation_date": 1577115190, "last_edit_date": 1577176211, "question_id": 59457788, "link": "https://stackoverflow.com/questions/59457788/add-data-to-another-table", "title": "Add data to another table", "body": "<p>i have a table(\"table1\") in one sheet.i have a button that adds the data in the table to another table in another sheet(\"table\").every time its overriding the data.\ni want to add the data(\"table1\") to the table(\"table2\") instead of overriding it.\nthis is the code:</p>\n\n<pre><code> Sheets(\"Letter (P V)\").ListObjects(\"Table1\").Range.Copy _\n      Destination:=Sheets(\"Actual\").Range(\"E2\")\n</code></pre>\n\n<p>thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "is_accepted": true, "score": 2, "last_activity_date": 1577121762, "last_edit_date": 1577121762, "creation_date": 1577121095, "answer_id": 59459003, "question_id": 59457679, "link": "https://stackoverflow.com/questions/59457679/extract-text-file-data-to-worksheet/59459003#59459003", "title": "Extract Text File data to worksheet", "body": "<p>First off - fantastic job posting working code and usable example data.</p>\n\n<p>You were missing the array/field info designation for state and your final 3 columns were ~1/2 characters off.  I removed the delimiter options as they don't matter if you're using <code>xlFixedWidth</code>.</p>\n\n<p>Change</p>\n\n<pre><code>Workbooks.OpenText Filename:=vFileName, _\n    Origin:=xlMSDOS, StartRow:=1, DataType:=xlFixedWidth, _\n    FieldInfo:=Array(Array(0, 1), Array(13, 1), Array(44, 1), _\n    Array(127, 1), Array(136, 1), Array(147, 1), Array(154, 1)), _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, _\n    Other:=False, TrailingMinusNumbers:=True\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Workbooks.OpenText Filename:=vFileName, _\n    Origin:=xlMSDOS, StartRow:=1, DataType:=xlFixedWidth, _\n    FieldInfo:=Array(Array(0, 1), Array(13, 1), Array(44, 1), _\n    Array(95, 1), Array(126, 1), Array(135, 1), Array(144, 1), Array(154, 1)), _\n    TextQualifier:=xlDoubleQuote, TrailingMinusNumbers:=True\n</code></pre>\n\n<p>As a side-note Excel has a bad tendency to remember <code>Text to Columns</code> settings so if you were messing with those earlier, make sure they are set to standard settings. </p>\n"}], "owner": {"reputation": 394, "user_id": 5449796, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/LJdnz.jpg?s=128&g=1", "display_name": "Sami A", "link": "https://stackoverflow.com/users/5449796/sami-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 59459003, "answer_count": 1, "score": 2, "last_activity_date": 1584621018, "creation_date": 1577114674, "last_edit_date": 1584621018, "question_id": 59457679, "link": "https://stackoverflow.com/questions/59457679/extract-text-file-data-to-worksheet", "title": "Extract Text File data to worksheet", "body": "<p>I want to paste the columns of this text file in my workbook.</p>\n\n<pre><code>USAF-WBAN_ID STATION NAME                   COUNTRY                                            STATE                          LATITUDE LONGITUDE ELEVATION\n------------ ------------------------------ -------------------------------------------------- ------------------------------ -------- --------- ---------\n404200 99999 AL AHSA                        SAUDI ARABIA                                                                       +25.285  +049.485   +0179.2\n</code></pre>\n\n<p>I want to pull 7 variables (7 columns)</p>\n\n<p>USAF-WBAN_ID; STATION NAME; COUNTRY; STATE; LATITUDE; LONGITUDE; ELEVATION</p>\n\n<p>Below is what I've tried in several variations, and results are not reliable.</p>\n\n<pre><code>Sub A1_StationID()\n\nDim vFile As Variant\nDim wbCopyTo As Workbook\nDim wsCopyTo As Worksheet\nDim wbCopyFrom As Workbook\nDim wsCopyFrom As Worksheet\n\nSet wbCopyTo = ActiveWorkbook\nSet wsCopyTo = ActiveSheet\n\nMsgBox \"Please select weather stn.txt document\"\n\nDim vFileName\n\nvFileName = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\")\n\nApplication.ScreenUpdating = False\n\nWorkbooks.OpenText Filename:=vFileName, _\n    Origin:=xlMSDOS, StartRow:=1, DataType:=xlFixedWidth, _\n    FieldInfo:=Array(Array(0, 1), Array(13, 1), Array(44, 1), _\n    Array(127, 1), Array(136, 1), Array(147, 1), Array(154, 1)), _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, _\n    Other:=False, TrailingMinusNumbers:=True\n\nSet wbCopyFrom = Workbooks.Open(vFileName)\n\nEnd Sub\n</code></pre>\n\n<p>Some of the output I get:<br>\n<a href=\"https://i.stack.imgur.com/z6qXN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z6qXN.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I add a breakpoint on the second to last line of code, I get closer to the output I desire (with messed up columns).<br>\n<a href=\"https://i.stack.imgur.com/sNGWd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sNGWd.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577111888, "post_id": 59456373, "comment_id": 105095316, "body": "<code>FullSeriesCollection</code> includes series that are filtered out - is that the case for your chart?"}, {"owner": {"reputation": 23, "user_id": 12564548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/210881dda677d61621879c17b4c52e3d?s=128&d=identicon&r=PG&f=1", "display_name": "C Mikely", "link": "https://stackoverflow.com/users/12564548/c-mikely"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577723728, "post_id": 59456373, "comment_id": 105237643, "body": "No, so I have the top 10 filtered for the chart"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577725217, "post_id": 59456373, "comment_id": 105238250, "body": "I&#39;m not sure I understand but try <code>SeriesCollection</code> instead of <code>FullSeriesCollection</code>."}, {"owner": {"reputation": 23, "user_id": 12564548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/210881dda677d61621879c17b4c52e3d?s=128&d=identicon&r=PG&f=1", "display_name": "C Mikely", "link": "https://stackoverflow.com/users/12564548/c-mikely"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577728322, "post_id": 59456373, "comment_id": 105239364, "body": "The chart is a pivot chart and I have the chart filtered to show the top 10 values.  SeriesCollection doesn&#39;t seem to work either"}], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 7497175, "user_type": "registered", "profile_image": "https://graph.facebook.com/1095904507202696/picture?type=large", "display_name": "viviansplatoon", "link": "https://stackoverflow.com/users/7497175/viviansplatoon"}, "is_accepted": false, "score": 0, "last_activity_date": 1577126678, "creation_date": 1577126678, "answer_id": 59459945, "question_id": 59456373, "link": "https://stackoverflow.com/questions/59456373/how-to-apply-data-labels-to-a-chart-using-vba/59459945#59459945", "title": "How to Apply Data Labels to a chart using VBA?", "body": "<p>Try this:</p>\n\n<pre><code>cht.Chart.FullSeriesCollection(1).ApplyDataLabels\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 12564548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/210881dda677d61621879c17b4c52e3d?s=128&d=identicon&r=PG&f=1", "display_name": "C Mikely", "link": "https://stackoverflow.com/users/12564548/c-mikely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580307848, "creation_date": 1577108557, "last_edit_date": 1580307848, "question_id": 59456373, "link": "https://stackoverflow.com/questions/59456373/how-to-apply-data-labels-to-a-chart-using-vba", "title": "How to Apply Data Labels to a chart using VBA?", "body": "<p>I am trying to apply data labels to my chart using VBA.</p>\n\n<p>I run into</p>\n\n<blockquote>\n  <p>run-time error 'ApplyDataLabels' of object 'Series' failed.</p>\n</blockquote>\n\n<p>This is the code</p>\n\n<pre><code>cht.FullSeriesCollection(1).ApplyDataLabels\n</code></pre>\n\n<p>and cht is</p>\n\n<pre><code>cht = ChtObj.Chart\n</code></pre>\n\n<p>I also tried</p>\n\n<pre><code>ActiveSheet.Shapes(\"Chart1\").Chart.ApplyDataLabels\n</code></pre>\n\n<p>However the code skips over that line like it is not there.</p>\n"}, {"tags": ["arrays", "json", "vba"], "comments": [{"owner": {"reputation": 62, "user_id": 4842667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nCm6R.jpg?s=128&g=1", "display_name": "EMF", "link": "https://stackoverflow.com/users/4842667/emf"}, "edited": false, "score": 0, "creation_date": 1577113047, "post_id": 59455560, "comment_id": 105095824, "body": "It\u2019s difficult to answer your question without knowing how you are creating the JSON. Clarify, please?"}, {"owner": {"reputation": 43, "user_id": 12165844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499ae927cb74ccd7be6a148316613863?s=128&d=identicon&r=PG&f=1", "display_name": "nector", "link": "https://stackoverflow.com/users/12165844/nector"}, "reply_to_user": {"reputation": 62, "user_id": 4842667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nCm6R.jpg?s=128&g=1", "display_name": "EMF", "link": "https://stackoverflow.com/users/4842667/emf"}, "edited": false, "score": 0, "creation_date": 1577168813, "post_id": 59455560, "comment_id": 105109544, "body": "The record source for Json is an Ms access Parameter query, The Json module is does the conversion as parameters in VBA. Please the edit question"}], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 4842667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nCm6R.jpg?s=128&g=1", "display_name": "EMF", "link": "https://stackoverflow.com/users/4842667/emf"}, "is_accepted": true, "score": 0, "last_activity_date": 1577239692, "creation_date": 1577239692, "answer_id": 59474665, "question_id": 59455560, "link": "https://stackoverflow.com/questions/59455560/how-to-hide-controls-without-record-in-json-string/59474665#59474665", "title": "How to hide controls without record in Json string", "body": "<p>If you only want to add the value to Tax if it is not null or blank, then check for those conditions before calling Tax.Add.</p>\n\n<pre><code>Dim myvar As Variant\n\n    myvar = DLookup(\"TaxClassB\", \"QryJson\", \"InvoiceID =\" &amp; Me.InvoiceID &amp; \" AND ItemesID =\" &amp; CStr(i))\n    If Not IsNull(myvar) Then\n        If Len(myvar) &gt; 0 Then\n            Tax.Add myvar\n        End If\n    End If\n</code></pre>\n\n<p>Note: Getting a set of values from a record one by one is the slow way. You may want to look at DAO (or ADO depending on the application) which allows you to get an entire record at once.</p>\n"}], "owner": {"reputation": 43, "user_id": 12165844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499ae927cb74ccd7be6a148316613863?s=128&d=identicon&r=PG&f=1", "display_name": "nector", "link": "https://stackoverflow.com/users/12165844/nector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 59474665, "answer_count": 1, "score": 0, "last_activity_date": 1577239692, "creation_date": 1577104829, "last_edit_date": 1577169058, "question_id": 59455560, "link": "https://stackoverflow.com/questions/59455560/how-to-hide-controls-without-record-in-json-string", "title": "How to hide controls without record in Json string", "body": "<p>I need some help on how to make sure that some controls in Json string should not appear on the string if the Ms Access record source is showing blank/Empty record see below:</p>\n\n<pre><code>[\n   {\n      \"ItemNumber\": 1,\n      \"SalesDate\": \"2019-09-14\",\n      \"ProductName\": \"Pepsi (Rgb 350 ML)\",\n      \"BarCode\": \"6009803227328\",\n      \"Qty\": 165,\n      \"Price\": 53.5,\n      \"VAT\": Null\n      \"TotalPrice\": 10239.9\n   },\n</code></pre>\n\n<p>Let us assume VAT control in MS Access record source is empty/blank, then the string should look like below:</p>\n\n<pre><code>[\n   {\n      \"ItemNumber\": 1,\n      \"SalesDate\": \"2019-09-14\",\n      \"ProductName\": \"Pepsi (Rgb 350 ML)\",\n      \"BarCode\": \"6009803227328\",\n      \"Qty\": 165,\n      \"Price\": 53.5,\n      \"TotalPrice\": 10239.9\n   },\n</code></pre>\n\n<p>Kindly see if it is possible to sort out this.  </p>\n\n<p>Below is the sample actual VBA code that supply the Json string. Assuming Tax Class B is EMPTY/BLANK instead of showing null in the ARRAY I do not want it to show anything here:</p>\n\n<pre><code> Tax.Add DLookup(\"TaxClassA\", \"QryJson\", \"InvoiceID =\" &amp; Me.InvoiceID &amp; \" AND ItemesID =\" &amp; CStr(i))\n    Tax.Add DLookup(\"TaxClassB\", \"QryJson\", \"InvoiceID =\" &amp; Me.InvoiceID &amp; \" AND ItemesID =\" &amp; CStr(i))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 574, "user_id": 11815170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc45f7272557f07935e19b1b850941c8?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelS", "link": "https://stackoverflow.com/users/11815170/raphaels"}, "edited": false, "score": 1, "creation_date": 1577104851, "post_id": 59455445, "comment_id": 105092188, "body": "There isn&#39;t really a question being asked here but I&#39;ll guess that you&#39;re trying to understand the code. If so:  The conditional `If...then&#39; says &quot;if the range called &quot;search_string&quot; is not found in the target address&#39; then a box should pop up to tell you that it&#39;s working"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 574, "user_id": 11815170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc45f7272557f07935e19b1b850941c8?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelS", "link": "https://stackoverflow.com/users/11815170/raphaels"}, "edited": false, "score": 2, "creation_date": 1577105072, "post_id": 59455445, "comment_id": 105092284, "body": "@RaphaelS, I believe it&#39;s the other way around: <code>If Not ... is Nothing Then</code>. =)"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 1, "creation_date": 1577105383, "post_id": 59455445, "comment_id": 105092433, "body": "Welcome to SO. Do you mean you do not understand how the current code works? If yes, then I recommend reading about <a href=\"https://www.ozgrid.com/VBA/vba-intersect.htm\" rel=\"nofollow noreferrer\">Excel VBA Intersect Method</a>, especially the section about <code>Private Sub Worksheet_Change(ByVal Target As Range)</code>"}, {"owner": {"reputation": 574, "user_id": 11815170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc45f7272557f07935e19b1b850941c8?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelS", "link": "https://stackoverflow.com/users/11815170/raphaels"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577114979, "post_id": 59455445, "comment_id": 105096677, "body": "Lol @JvdV you&#39;re right it&#39;s a double negative (why?!)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 574, "user_id": 11815170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc45f7272557f07935e19b1b850941c8?s=128&d=identicon&r=PG&f=1", "display_name": "RaphaelS", "link": "https://stackoverflow.com/users/11815170/raphaels"}, "edited": false, "score": 0, "creation_date": 1577115832, "post_id": 59455445, "comment_id": 105097011, "body": "That&#39;s to check if <code>Intersect</code> returns a valid <code>Range</code> object to work with @RaphaelS"}, {"owner": {"reputation": 11, "user_id": 3094359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c32c50831f6328d928b57877fc49cc8?s=128&d=identicon&r=PG&f=1", "display_name": "user3094359", "link": "https://stackoverflow.com/users/3094359/user3094359"}, "edited": false, "score": 0, "creation_date": 1577118812, "post_id": 59455445, "comment_id": 105098289, "body": "use of not is confusing me and even on matching the criteria true returns is nothing"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1577128817, "post_id": 59455445, "comment_id": 105101853, "body": "@user3094359 it might be the line continuation <code>_</code> that&#39;s confusing you. The <code>Is Nothing</code> is part of the <code>If ... Then</code>.  Read the formula as &quot;If Not(the intersection of two ranges Is Nothing) Then&quot;. So it&#39;s saying &quot;If two ranges have any cells in common Then Working&quot;"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1577133427, "post_id": 59455445, "comment_id": 105103165, "body": "And FWIW <code>Range(Target.Address))</code> is equivalent to just <code>Target</code>.  And the unqualified <code>Range</code> is better to be fully qualified.   In a Sheet module that&#39;s <code>If Not Application.Intersect(Me.Range(&quot;A1&quot;), Target) Is Nothing Then</code>"}, {"owner": {"reputation": 11, "user_id": 3094359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c32c50831f6328d928b57877fc49cc8?s=128&d=identicon&r=PG&f=1", "display_name": "user3094359", "link": "https://stackoverflow.com/users/3094359/user3094359"}, "edited": false, "score": 0, "creation_date": 1577172768, "post_id": 59455445, "comment_id": 105110670, "body": "thanks all, now i understand, same as double negative These are all equivalent *** If (Not (myobject Is Nothing) = True) Then *** and *** If Not (myobject Is Nothing) Then *** and *** If Not myobject Is Nothing Then *** thanks all"}], "answers": [{"tags": [], "owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1577133818, "creation_date": 1577133818, "answer_id": 59461113, "question_id": 59455445, "link": "https://stackoverflow.com/questions/59455445/i-am-confused-on-purpose-of-using-not-also-on-matching-of-if-criteria-code/59461113#59461113", "title": "I am confused on purpose of using &quot;Not&quot;, also on matching of &quot;If&quot; criteria, code says &quot;is nothing&quot; else run code for &quot;MsgBox&quot;", "body": "<p>Explanations are in the macro</p>\n\n<pre><code>'Change-event procedure for a specific sheet\n'(The code is placed in the code module of this sheet)\n'Always called when something changes in the sheet that triggers the change event\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n  'We need the double negation in the following line because the answer of the\n  'core question \"Application.Intersect(Range(\"A1\"), Range(Target.Address))\"\n  'can have two different data types. An Object or the special type \"Nothing\"\n  'if there is no object. There is no other way to ask for **no** address.\n  'To ask only for an address will throw a runtime error if there is no one\n  'But if it's \"Not\" \"Nothing\", then there is an address.\n  'This is a bit hard to understand, but programming is like this sometimes ;-)\n  If Not Application.Intersect(Range(\"A1\"), Range(Target.Address)) Is Nothing Then\n    'Message field with the text \"Working\" is displayed\n    'when the If statement is evaluated as \"true\"\n    MsgBox \"Working\"\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3094359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c32c50831f6328d928b57877fc49cc8?s=128&d=identicon&r=PG&f=1", "display_name": "user3094359", "link": "https://stackoverflow.com/users/3094359/user3094359"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1577133818, "creation_date": 1577104342, "last_edit_date": 1577127040, "question_id": 59455445, "link": "https://stackoverflow.com/questions/59455445/i-am-confused-on-purpose-of-using-not-also-on-matching-of-if-criteria-code", "title": "I am confused on purpose of using &quot;Not&quot;, also on matching of &quot;If&quot; criteria, code says &quot;is nothing&quot; else run code for &quot;MsgBox&quot;", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Application.Intersect(Range(\"A1\"), Range(Target.Address))  _\n    Is Nothing Then\n     MsgBox \"Working\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1577104239, "post_id": 59455364, "comment_id": 105091933, "body": "I wonder if this is because of the last line -&gt; <code>ActiveWorkbook.Close SaveChanges:=True</code> It might be that <code>Close</code> is triggering <code>BeforeClose</code> event one more time. Can you try removing this line and test it again?"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1577104926, "post_id": 59455443, "comment_id": 105092217, "body": "Thanks, it fixed it. You&#39;re right, it triggered the event again. Thanks for this/active tip"}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": true, "score": 6, "last_activity_date": 1577104327, "creation_date": 1577104327, "answer_id": 59455443, "question_id": 59455364, "link": "https://stackoverflow.com/questions/59455364/vba-runs-code-twice-before-close-private-sub/59455443#59455443", "title": "VBA runs code twice before close private sub", "body": "<p>The issue is your logic flow here. The <code>BeforeClose</code> sub will run when the closing sequence of the workbook is initiated. If you do so manually (by closing it form the menu or the <code>X</code> button) then this sub will run.</p>\n\n<p>However you also have:</p>\n\n<pre><code>ActiveWorkbook.Close SaveChanges:=True\n</code></pre>\n\n<p>Which is redundant. The workbook is already being closed, and will automatically close after the sub is ran. This line will initiate another closing sequence, and run the sub again. You should replace it by:</p>\n\n<pre><code>Activeworkbook.save\n</code></pre>\n\n<p>so your changes are saved. It will then automatically close at the end of the \"before close\" sub.</p>\n\n<p>Also a tip for you, I suggest using <code>Thisworkbook.Save</code> instead of <code>Activeworkbook</code> as it is more reliable.</p>\n"}], "owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 59455443, "answer_count": 1, "score": 1, "last_activity_date": 1577104397, "creation_date": 1577103966, "question_id": 59455364, "link": "https://stackoverflow.com/questions/59455364/vba-runs-code-twice-before-close-private-sub", "title": "VBA runs code twice before close private sub", "body": "<p>have following problem: My before close sub gives me an error in the <code>Sheets(\"Country Selection\").Visible = xlSheetVisible</code>, even though it actually deletes the sheet through the loop. It seems like it pulls the code twice. Any clue why this is the case?</p>\n\n<pre><code>Private Sub workbook_BeforeClose(cancel As Boolean)\n\nDim ws As Worksheet\nApplication.DisplayAlerts = False\n\nSheets(\"Country Selection\").Visible = xlSheetVisible\n\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Visible = xlSheetVisible Then\n        If ws.Name &lt;&gt; \"Choose BU\" Then ws.Delete\n    End If\nNext ws\n\nApplication.DisplayAlerts = True\n\nActiveWorkbook.Close SaveChanges:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1577106562, "post_id": 59455350, "comment_id": 105092942, "body": "Debug through your code, and find out which exact line generates an exception."}, {"owner": {"reputation": 373, "user_id": 12046360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BVtTb.jpg?s=128&g=1", "display_name": "Plato77", "link": "https://stackoverflow.com/users/12046360/plato77"}, "edited": false, "score": 0, "creation_date": 1577108845, "post_id": 59455350, "comment_id": 105093902, "body": "Agree with what Vitaliy says, the best way to achieve this is to go into the design view and use Shift+F8 to step through the code until the error occurs.  Can you show us what the data looks like?"}, {"owner": {"reputation": 1, "user_id": 12584787, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCxxcNXLVdpX2tWIZJny4fEgbjNXeD2Oipys-g67I4=k-s128", "display_name": "mohamedation", "link": "https://stackoverflow.com/users/12584787/mohamedation"}, "edited": false, "score": 0, "creation_date": 1577111587, "post_id": 59455350, "comment_id": 105095174, "body": "I already looked at the debugger... It gets stuck at.. &#39;&#39;&#39;oNewRow.Range.Cells(1, 1).Value = Me.TextBox_ReceiptNo.Value&#39;&#39;&#39;"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1577122163, "post_id": 59455350, "comment_id": 105099597, "body": "You&#39;ve got alot of things inside a with statement that probably shouldn&#39;t be there. I&#39;m also not seeing anywhere that you&#39;re using the functionality of the With Statement."}, {"owner": {"reputation": 1, "user_id": 12584787, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCxxcNXLVdpX2tWIZJny4fEgbjNXeD2Oipys-g67I4=k-s128", "display_name": "mohamedation", "link": "https://stackoverflow.com/users/12584787/mohamedation"}, "edited": false, "score": 0, "creation_date": 1577176760, "post_id": 59455350, "comment_id": 105111815, "body": "I have tried it without with statement and still gets stuck after one posting."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12584787, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCxxcNXLVdpX2tWIZJny4fEgbjNXeD2Oipys-g67I4=k-s128", "display_name": "mohamedation", "link": "https://stackoverflow.com/users/12584787/mohamedation"}, "is_accepted": true, "score": 0, "last_activity_date": 1577198069, "last_edit_date": 1577198069, "creation_date": 1577196388, "answer_id": 59469975, "question_id": 59455350, "link": "https://stackoverflow.com/questions/59455350/userform-input-only-works-once/59469975#59469975", "title": "Userform input only works once", "body": "<p>I solved the my issue by replacing</p>\n\n<pre><code>Set oNewRow = Selection.ListObject.ListRows.Add(AlwaysInsert:=True)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Set tbl = Range(paymenttable).ListObject\n\nSet oNewRow = tbl.ListRows.Add(AlwaysInsert:=True)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12584787, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCxxcNXLVdpX2tWIZJny4fEgbjNXeD2Oipys-g67I4=k-s128", "display_name": "mohamedation", "link": "https://stackoverflow.com/users/12584787/mohamedation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 59469975, "answer_count": 1, "score": 0, "last_activity_date": 1581525773, "creation_date": 1577103937, "last_edit_date": 1581525773, "question_id": 59455350, "link": "https://stackoverflow.com/questions/59455350/userform-input-only-works-once", "title": "Userform input only works once", "body": "<p>I have this userform and VBA code to input data on different sheets within the workbook depending on one combobox value.</p>\n\n<p>Everything works for one entry. If I try to add another payment it gives me</p>\n\n<blockquote>\n  <p>\"Run-time error '1004\"</p>\n</blockquote>\n\n<p>It gets stuck at</p>\n\n<pre><code>oNewRow.Range.Cells(1, 1).Value = Me.TextBox_ReceiptNo.Value\n</code></pre>\n\n<pre><code>Private Sub ComboBox_PaymentDay_Change()\nSheets(Me.ComboBox_PaymentDay.Value).Activate\npaymenttable = \"payment\" &amp; Me.ComboBox_PaymentDay.Value\nCells(1, 1).Select\nEnd Sub\n\nPrivate Sub CommandButton_AddPayment_Click()\n    'Check for empty or False value for all checkbox and exit before submitting the form\nDim paymenttable As Variant\npaymenttable = \"payment\" &amp; Me.ComboBox_PaymentDay.Value\nDim currentsheet As Worksheet\nSheets(Me.ComboBox_PaymentDay.Value).Activate\nWith Payment_Form\n    If TextBox_ReceiptNo.Value = \"\" Then\n        MsgBox \"Receipt Number is required\"\n        Exit Sub\n    ElseIf TextBox_Name.Value = \"\" Then\n        MsgBox \"Name is required\"\n        Exit Sub\n    ElseIf OptionButton_Cheque.Value = True Then\n        If TextBox_ChequeNo.Value = \"\" Then\n            MsgBox \"Cheque Number is Required\"\n            Exit Sub\n        ElseIf ComboBox_Bank.ListIndex &lt; 0 Then\n            MsgBox \"Please Select a Bank\"\n            Exit Sub\n        End If\n\n    ElseIf ComboBox_Currency.ListIndex &lt; 0 Then\n        MsgBox \"Please select a Currency\"\n        Exit Sub\n    ElseIf TextBox_Amount.Value = \"\" Then\n        MsgBox \"Amount is required\"\n        Exit Sub\n    ElseIf OptionButton_Other.Value = True Then\n        If TextBox_Code.Value = \"\" Then\n            MsgBox \"Account Code is Required\"\n            Exit Sub\n        End If\n    End If\nEnd With\n\n    'Copy input values to sheet.\n    Cells(1, 1).Select\n    Dim oNewRow As ListRow\n\n    Dim rng As Range\n    Sheets(Me.ComboBox_PaymentDay.Value).Activate\n    Set rng = ActiveWorkbook.Worksheets(Me.ComboBox_PaymentDay.Value).Range(paymenttable)\n    rng.Select\n    Set oNewRow = Selection.ListObject.ListRows.Add(AlwaysInsert:=True)\n\n    Sheets(Me.ComboBox_PaymentDay.Value).Unprotect Password:=\"0000\"\n\n    With Sheets(Me.ComboBox_PaymentDay.Value)\n        Debug.Print Payment_Form.TextBox_ReceiptNo.Value\n        oNewRow.Range.Cells(1, 1).Value = Me.TextBox_ReceiptNo.Value\n        oNewRow.Range.Cells(1, 2).Value = Me.TextBox_Name.Value\n        oNewRow.Range.Cells(1, 3).Value = Me.TextBox_ChequeNo.Value\n        oNewRow.Range.Cells(1, 4).Value = Me.DTPicker_ChequeDate.Value\n        oNewRow.Range.Cells(1, 5).Value = Me.ComboBox_Bank.Value\n        oNewRow.Range.Cells(1, 6).Value = Me.ComboBox_Currency.Value\n        oNewRow.Range.Cells(1, 7).Value = Me.TextBox_Amount.Value\n        If OptionButton_Cheque.Value = True Then\n            oNewRow.Range.Cells(1, 10).Value = \"Cheque\"\n        Else\n            oNewRow.Range.Cells(1, 10).Value = \"Cash\"\n            oNewRow.Range.Cells(1, 4).Value = \"N/A\"\n            oNewRow.Range.Cells(1, 3).Value = \"N/A\"\n            oNewRow.Range.Cells(1, 5).Value = \"N/A\"\n        End If\n        If OptionButton_Receivables.Value = True Then\n            oNewRow.Range.Cells(1, 11).Value = \"Receivables\"\n        Else\n            oNewRow.Range.Cells(1, 11).Value = \"Other\"\n        End If\n        oNewRow.Range.Cells(1, 14).Value = Me.TextBox_Code.Value\n        Me.TextBox_ReceiptNo.Value = \"\"\n        Me.TextBox_Name.Value = \"\"\n        Me.TextBox_ChequeNo.Value = \"\"\n        'Me.DTPicker_ChequeDate.Value = \"\"\n        Me.ComboBox_Bank.Value = \"\"\n        Me.ComboBox_Currency.Value = \"\"\n        Me.TextBox_Amount.Value = \"\"\n        Set oNewRow = Nothing\n    End With\n\n    'Load Payment_Form\n    Unload Me\n    Sheets(Me.ComboBox_PaymentDay.Value).Protect Password:=\"0000\"\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nEnd Sub\n\nPrivate Sub CommandButton_CloseForm_Click()\nUnload Me\nEnd Sub\n\nPrivate Sub OptionButton_Cash_Click()\nIf OptionButton_Cash.Value = True Then\n    Frame_ChequeData.Enabled = False\n    Frame_ChequeData.Visible = False\n    Else\n    Frame_ChequeData.Enabled = True\n    Frame_ChequeData.Visible = True\nEnd If\nEnd Sub\n\nPrivate Sub OptionButton_Cheque_Click()\nIf OptionButton_Cheque.Value = True Then\n    Frame_ChequeData.Enabled = True\n    Frame_ChequeData.Visible = True\n    Else\n    Frame_ChequeData.Enabled = False\n    Frame_ChequeData.Visible = False\nEnd If\nEnd Sub\n\nPrivate Sub OptionButton_Receivables_Click()\nIf OptionButton_Receivables.Value = True Then\n    Frame_Other.Enabled = False\n    Frame_Other.Visible = False\nElse\n    Frame_Other.Enabled = True\n    Frame_Other.Visible = True\nEnd If\nEnd Sub\n\nPrivate Sub OptionButton_Other_Click()\nIf OptionButton_Other.Value = True Then\n    Frame_Other.Enabled = True\n    Frame_Other.Visible = True\n    Else\n    Frame_Other.Enabled = False\n    Frame_Other.Visible = False\nEnd If\nEnd Sub\n\nPrivate Sub UserForm_Click()\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nMe.ComboBox_PaymentDay.Value = Day(Date)\nDim BanksArray As Variant\nDim CurrencyArray As Variant\n\nCurrencyArray = Array(\"EGP E\u00a3\", \"USD $\", \"EURO \u20ac\")\nBanksArray = Array(\"Abu Dhabi Islamic Bank (ADIB)\", \"Agricultural Bank of Egypt\", \"Ahli United Bank\", \"Al Ahli Bank of Kuwait - Egypt (ABK-Egypt)\", \"Al Baraka Bank of Egypt\", \"Arab African International Bank\", \"Arab Bank Plc.\", \"Arab Banking Corporation (Bank ABC)\", \"Arab International Bank\", \"Arab Investment Bank (AIBK)\", \"Attijariwafa Bank Egypt\", \"Bank Audi\", \"Bank of Alexandria\", \"Banque du Caire\", \"Banque Misr\", \"Blom Bank\", \"Citibank\", \"Commercial International Bank (CIB)\", \"Credit Agricole Egypt\", \"Egyptian Arab Land Bank\", \"Egyptian Gulf Bank (EG BANK)\", \"Emirates NBD\", \"Export Development Bank of Egypt\", \"Faisal Islamic Bank of Egypt\", \"First Abu Dhabi Bank (FAB)\", \"Housing and Development Bank\", \"HSBC Bank Egypt\", \"Industrial Development &amp; Workers Bank of Egypt\", \"Misr Iran Development Bank\", \"National Bank of Egypt\", \"National Bank of Greece\", _\n\"National Bank of Kuwait - Egypt (NBK-Egypt)\", \"Qatar National Bank Al Ahli (QNB Alahli)\", \"Soci\u00e9t\u00e9 Arabe Internationale de Banque (SAIB)\", \"Suez Canal Bank\", \"The United Bank of Egypt\", \"Union National Bank Egypt (UNB-E)\")\n    Me.ComboBox_Bank.List = BanksArray\n    Me.ComboBox_Currency.List = CurrencyArray\n    Me.ComboBox_PaymentDay.List = Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31)\nEnd Sub\n\nPrivate Sub TextBox_ReceiptNo_Change()\n    OnlyNumbers\nEnd Sub\n\nPrivate Sub TextBox_Amount_Change()\n    OnlyNumbers\nEnd Sub\n\nPrivate Sub OnlyNumbers()\n    If TypeName(Me.ActiveControl) = \"TextBox\" Then\n        With Me.ActiveControl\n            If Not IsNumeric(.Value) And .Value &lt;&gt; vbNullString Then\n                MsgBox \"Sorry, only numbers allowed\"\n                .Value = vbNullString\n            End If\n        End With\n    End If\nEnd Sub\n</code></pre>\n\n<p>I have to clean up my code and add more functionality, however I can't get myself to do more as I can't figure this out.</p>\n"}, {"tags": ["vba", "vb.net", "visual-studio", "visual-studio-2019", "sendkeys"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12583872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d7d8c187ccf22c8108c533781cfc3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mexalim", "link": "https://stackoverflow.com/users/12583872/mexalim"}, "edited": false, "score": 0, "creation_date": 1577111819, "post_id": 59455675, "comment_id": 105095282, "body": "No, it&#39;s not the only way. But I don&#39;t know other way... Could you can describe other way or send example?"}, {"owner": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "reply_to_user": {"reputation": 3, "user_id": 12583872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d7d8c187ccf22c8108c533781cfc3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mexalim", "link": "https://stackoverflow.com/users/12583872/mexalim"}, "edited": false, "score": 0, "creation_date": 1577112162, "post_id": 59455675, "comment_id": 105095423, "body": "You can try to use AutoIt, works quite stable with send keys and simple to use. Or more complicated - if you are familiar with win API, you can try to solve your task with UIAutomationClient."}, {"owner": {"reputation": 3, "user_id": 12583872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d7d8c187ccf22c8108c533781cfc3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mexalim", "link": "https://stackoverflow.com/users/12583872/mexalim"}, "edited": false, "score": 0, "creation_date": 1577114890, "post_id": 59455675, "comment_id": 105096632, "body": "WOW I tried to use AutoItX3 end it works fine but I&#39;m not sure if this code is correct (I say about Run after click):   <a href=\"http://joxi.ru/KAxMgkzhZXX1dr\" rel=\"nofollow noreferrer\">joxi.ru/KAxMgkzhZXX1dr</a>"}, {"owner": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "reply_to_user": {"reputation": 3, "user_id": 12583872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d7d8c187ccf22c8108c533781cfc3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mexalim", "link": "https://stackoverflow.com/users/12583872/mexalim"}, "edited": false, "score": 0, "creation_date": 1577115005, "post_id": 59455675, "comment_id": 105096686, "body": "Sleep is not really neede for it. AutoIt should handle waitings. The rest looks fine."}, {"owner": {"reputation": 3, "user_id": 12583872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d7d8c187ccf22c8108c533781cfc3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mexalim", "link": "https://stackoverflow.com/users/12583872/mexalim"}, "edited": false, "score": 0, "creation_date": 1577181273, "post_id": 59455675, "comment_id": 105113443, "body": "And one more... Maby you know. This func  .Run() .WinWaitActive() of  AutoItX3 didn&#39;t work in x64 Windows and my app crashed. The path and name are correct. <a href=\"http://joxi.ru/KAxMgkzhZXXdOr\" rel=\"nofollow noreferrer\">joxi.ru/KAxMgkzhZXXdOr</a> maby you can help me last time"}, {"owner": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "reply_to_user": {"reputation": 3, "user_id": 12583872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d7d8c187ccf22c8108c533781cfc3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mexalim", "link": "https://stackoverflow.com/users/12583872/mexalim"}, "edited": false, "score": 0, "creation_date": 1577184166, "post_id": 59455675, "comment_id": 105114511, "body": "Sorry, that&#39;s not familiar to me. Good luck with investigating and debugging :)"}], "tags": [], "owner": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "is_accepted": true, "score": 0, "last_activity_date": 1577105397, "creation_date": 1577105397, "answer_id": 59455675, "question_id": 59455244, "link": "https://stackoverflow.com/questions/59455244/sendkeys-does-not-always-send-the-key-macros-to-appactivate-via-processid-to-ano/59455675#59455675", "title": "SendKeys does not always send the key macros to AppActivate via ProcessId to another process", "body": "<p>First of all, I don't believe that there exists a stable application that works with \"send keys\". But if it's the only way to do the automation here's some additional check for your code.</p>\n\n<pre><code>Dim wShell = CreateObject(\"WScript.Shell\")\n\nDim isWindowActive As Boolean = False\nDo \n    'AppActivate will return true when window is really active'\n    isWindowActive = wShell.AppActivate(Process.ProcessId) \n    WScript.Sleep 100\nLoop Until isWindowActive \nwShell.sendKeys(\"(^z)\")\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12583872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d7d8c187ccf22c8108c533781cfc3ab?s=128&d=identicon&r=PG&f=1", "display_name": "Mexalim", "link": "https://stackoverflow.com/users/12583872/mexalim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 59455675, "answer_count": 1, "score": 0, "last_activity_date": 1577105397, "creation_date": 1577103478, "question_id": 59455244, "link": "https://stackoverflow.com/questions/59455244/sendkeys-does-not-always-send-the-key-macros-to-appactivate-via-processid-to-ano", "title": "SendKeys does not always send the key macros to AppActivate via ProcessId to another process", "body": "<p><strong>Task:</strong> Write a program that simply displays 3 buttons when clicked on, which simulates pressing a key combination (macros Ctrl+Z) in another window.</p>\n\n<p><strong>What I did:</strong> My code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Class Form1\n    Dim FigmaWindowName As String\n    Dim Processes\n\n    Public Sub New()\n        'init form\n        InitializeComponent()\n\n        'set top position\n        TopMost = True\n\n\n    End Sub\n\n    Private Sub ButtonUndo_Click(sender As Object, e As EventArgs) Handles ButtonUndo.Click\n\n        Processes = GetObject(\"winmgmts:\").InstancesOf(\"Win32_Process\")\n\n        For Each Process In Processes\n            If StrComp(Process.Name, \"Figma.exe\", vbTextCompare) = 0 Then\n\n                ' Activate the window using its process ID...\n                With CreateObject(\"WScript.Shell\")\n                    .AppActivate(Process.ProcessId)\n                    .SendKeys(\"(^z)\")\n\n                End With\n\n                ' We found our process. No more iteration required...\n                Exit For\n\n            End If\n        Next\n\n        '....other buttons\n    End Sub\nEnd Class\n</code></pre>\n\n<p><strong>Problem:</strong> not stable. If it doesn\u2019t work, then both windows flicker when clicking and the key combination does not send to other app. <a href=\"https://www.loom.com/share/89c47dfa38bc4bb6b1d3ff8b97b84ac8\" rel=\"nofollow noreferrer\">https://www.loom.com/share/89c47dfa38bc4bb6b1d3ff8b97b84ac8</a></p>\n\n<p><strong>Question</strong> What I do wrong?</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "autofill"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577125936, "post_id": 59454196, "comment_id": 105100935, "body": "Is there an public url to test with?"}, {"owner": {"reputation": 1, "user_id": 12584399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d7a43b522a56f8f447f5b01dd8dda14?s=128&d=identicon&r=PG&f=1", "display_name": "JMTM", "link": "https://stackoverflow.com/users/12584399/jmtm"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577128429, "post_id": 59454196, "comment_id": 105101750, "body": "No, unfortunately the site can be accessible only from company&#39;s laptop :("}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12584399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d7a43b522a56f8f447f5b01dd8dda14?s=128&d=identicon&r=PG&f=1", "display_name": "JMTM", "link": "https://stackoverflow.com/users/12584399/jmtm"}, "edited": false, "score": 0, "creation_date": 1577120723, "post_id": 59456939, "comment_id": 105099070, "body": "Thanks for your input but it did not work. I typed the same as you did from the above, getting an error msg &#39;Run-time error&#39;-2147023170 (800706be)&#39; Automation error THe remote procedure call failed."}, {"owner": {"reputation": 1, "user_id": 12584399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d7a43b522a56f8f447f5b01dd8dda14?s=128&d=identicon&r=PG&f=1", "display_name": "JMTM", "link": "https://stackoverflow.com/users/12584399/jmtm"}, "edited": false, "score": 0, "creation_date": 1577128489, "post_id": 59456939, "comment_id": 105101775, "body": "Is there way to just copy and paste the row at the current position where cursor is positioning at? I mean I can sendkeys tab for 18 times to get to that specific search bar but do not know how to insert the entire row from my excel sheet... eg.IE.Document.all(&quot;picker&quot;).Value = ThisWorkbook.Sheets(&quot;Main_1&quot;).Range(&quot;B&quot; &amp; intRow).Value"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 1, "user_id": 12584399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d7a43b522a56f8f447f5b01dd8dda14?s=128&d=identicon&r=PG&f=1", "display_name": "JMTM", "link": "https://stackoverflow.com/users/12584399/jmtm"}, "edited": false, "score": 0, "creation_date": 1577177143, "post_id": 59456939, "comment_id": 105111935, "body": "You need to inform us, on which line you got the error. Also your logic is incorrect about passing the whole row of Excel. You need to loop through all the cells and set the value to corresponding element on the web page by looping the elements on the page. You cannot do that thing in 1 line of code. you need nested loop for this. Outer loop will loop through elements on web page. inner loop will loop through cells of the row."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1577111161, "creation_date": 1577111161, "answer_id": 59456939, "question_id": 59454196, "link": "https://stackoverflow.com/questions/59454196/filling-internet-explorer-forms-from-excel/59456939#59456939", "title": "Filling Internet Explorer Forms from Excel", "body": "<p>Try to make a test with example below may help to solve the issue.</p>\n\n<pre><code>Sub demo1()\n\n    Dim i As Long\n    Dim URL As String\n    Dim IE As Object\n    Dim HWNDSrc As Long\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    IE.Visible = True\n\n    URL = \"D:\\Backup20190913\\tests\\367.html\"\n\n    IE.Navigate URL\n\n    Do While IE.ReadyState = 4: DoEvents: Loop\n    Do Until IE.ReadyState = 4: DoEvents: Loop\n\n    IE.Document.querySelector(\"[name='picker']\").Value = \"test value\"\n\n    Stop\n    Set IE = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>HTML</p>\n\n<pre><code>&lt;input class=\"form-control ng-valid ng-isolate-scope ng-touched ng-dirty\" ng-model=\"pickerCtrl.currentpicker\" name=\"picker\" type=\"text\" typeahead=\"\" typeahead-source=\"pickerCtrl.getpickerStrings()\" ng-disabled=\"pickerCtrl.errorLoadingPickers || pickerCtrl.noPickerstrings\" ng-hide=\"pickerCtrl.disableTypeahead\" autocomplete=\"off\"&gt;\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nZgzi.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nZgzi.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 12584399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d7a43b522a56f8f447f5b01dd8dda14?s=128&d=identicon&r=PG&f=1", "display_name": "JMTM", "link": "https://stackoverflow.com/users/12584399/jmtm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580483430, "creation_date": 1577098891, "last_edit_date": 1580483430, "question_id": 59454196, "link": "https://stackoverflow.com/questions/59454196/filling-internet-explorer-forms-from-excel", "title": "Filling Internet Explorer Forms from Excel", "body": "<p>I want to fill information onto the site 'select picker' section on the left side of the picture.</p>\n\n<p>SITE<br>\n<a href=\"https://i.stack.imgur.com/dA9AZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dA9AZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>There is an element name 'picker' but it won't work.</p>\n\n<p><a href=\"https://i.stack.imgur.com/77kos.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/77kos.png\" alt=\"enter image description here\"></a></p>\n\n<p>The search bar is being completed using jQuery auto-complete which submits a form that navigates to an associate from the auto-complete box has been selected</p>\n\n<p>I tried</p>\n\n<p><code>IE.Document.All(\"picker\").Value = \"Testing\"</code></p>\n\n<p><code>IE.Document.GetElementByID(\"pickerCtrl.currentPicker\").Value = \"Testing\"</code></p>\n\n<p><code>IE.Document.GetElementsByClassName(\"input-group input-group-sm\").Item(0).Value = \"Testing\"</code></p>\n\n<p>PS.<br>\nIs there way to just copy and paste the row at the current position where cursor is positioning at? </p>\n\n<p>I can sendkeys tab 18 times to get to that specific search bar but do not know how to insert the entire row from my Excel sheet.</p>\n\n<p>eg. <code>IE.Document.all(\"picker\").Value = ThisWorkbook.Sheets(\"Main_1\").Range(\"B\" &amp; intRow).Value</code></p>\n\n<p>I am completely new to this.</p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1577098160, "post_id": 59453936, "comment_id": 105089553, "body": "<code>PriceFileName = Range(&quot;Pricing_File&quot;).Value</code> you should always specify the sheet (and the workbook if you have multiple) the range is on. For best practise use <code>Testfile.Sheets(&quot;your sheet here&quot;).Range(</code> etc. Not sure if that is the issue here, but it is likely. Otherwise it will just take the range of whichever sheet is showing, which might be incorrect."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1577098445, "post_id": 59453936, "comment_id": 105089683, "body": "The <code>workbooks</code> collection refers to the workbooks that are currently open. Is the workbook named after whatever string is stored in <code>PriceFileName </code>, open? If you want to open it you need to use the <code>workbooks.open()</code> method."}, {"owner": {"reputation": 31, "user_id": 12584322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2014f9f5b21c4d73c5539beffded253?s=128&d=identicon&r=PG&f=1", "display_name": "samm", "link": "https://stackoverflow.com/users/12584322/samm"}, "edited": false, "score": 0, "creation_date": 1577101055, "post_id": 59453936, "comment_id": 105090667, "body": "Plutian: I&#39;ve updated the code as you suggested and am getting the correct value for PriceFileName in the watch window. Still getting a run time error 9 when I try and name the workbook as PriceFile. The value is &quot;filepath.xlsx&quot; - could the &quot;&quot; around the name be impacting this?"}, {"owner": {"reputation": 31, "user_id": 12584322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2014f9f5b21c4d73c5539beffded253?s=128&d=identicon&r=PG&f=1", "display_name": "samm", "link": "https://stackoverflow.com/users/12584322/samm"}, "edited": false, "score": 0, "creation_date": 1577101153, "post_id": 59453936, "comment_id": 105090697, "body": "Stavros Jon: the workbook in PriceFileName is the workbook that gets opened in Open_Pricing_File so will definitely be open. The code is managing to open the file ok and then can&#39;t cope."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1577101682, "post_id": 59453936, "comment_id": 105090885, "body": "Why do you have a separate sub for opening the file? is there a particular reason? If the <code>Workbooks.Open</code> line was in this <code>Get_Sum_Assured</code> sub, you could <code>Set</code> it at that point."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1577102688, "post_id": 59453936, "comment_id": 105091290, "body": "I agree with CLR, best to <code>Set</code> at that point. Another suggestion would be, if through this sub your pricing file is the last to be opened, you could do <code>Set PriceFile = Workbooks(Workbooks.Count)</code>. It&#39;s unreliable if the opening fails or is done manually, but otherwise would solve your problem."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1577103102, "post_id": 59453936, "comment_id": 105091461, "body": "Alternatively, change your <code>Open_Pricing_File</code> sub into a <code>Function</code> that returns the opened workbook as an object (Workbook). If you also post the <code>Open_Pricing_File</code> we could advise how to do that."}, {"owner": {"reputation": 31, "user_id": 12584322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2014f9f5b21c4d73c5539beffded253?s=128&d=identicon&r=PG&f=1", "display_name": "samm", "link": "https://stackoverflow.com/users/12584322/samm"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1577785777, "post_id": 59453936, "comment_id": 105253821, "body": "@Plutian @CLR thanks, I&#39;ve updated <code>Open_Pricing_File</code> and still not had any luck. My code is now: <code>Set TestFile = ThisWorkbook     PriceFileName = Range(&quot;Pricing_File&quot;).Value     Workbooks.Open Filename:=PriceFileName     Set PriceFile = Workbooks(PriceFileName)</code>. The file opens but can&#39;t get past the <code>Set</code> line - I haven&#39;t really used Set before, am I doing something wrong with it?"}], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1577109150, "post_id": 59455760, "comment_id": 105094070, "body": "You don&#39;t need to do that. There is no need to use <code>ActiveWorkbook</code> at all. Instead: <code>Set wb1 = Workbooks.Open(Filename:=&quot;C:\\Data\\ExcelFile1.xlsm&quot;, Local:=True, ReadOnly:=False)</code>"}], "tags": [], "owner": {"reputation": 71, "user_id": 8839237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/534ea5a207b860b9141509deec9be533?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/8839237/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1577105704, "creation_date": 1577105704, "answer_id": 59455760, "question_id": 59453936, "link": "https://stackoverflow.com/questions/59453936/how-to-set-a-workbook-to-a-variable-name/59455760#59455760", "title": "How to set a workbook to a variable name?", "body": "<p>The following macro opens two workbooks and gives them the name \"wb1\" and \"wb2\".\nAt the end the value from cell A1 is copied from \"wb1\" to \"wb2\".</p>\n\n<pre><code>Sub copyValue_wb1wb2()\nDim wb1 As Workbook\nDim wb2 As Workbook\n\n  'wb1 (workbook1)\n  Workbooks.Open Filename:=\"C:\\Data\\ExcelFile1.xlsm\", Local:=True, ReadOnly:=False\n  Set wb1 = ActiveWorkbook\n\n  'wb2 (workbook2)\n  Workbooks.Open Filename:=\"C:\\Data\\ExcelFile2.xlsm\", Local:=True, ReadOnly:=False\n  Set wb2 = ActiveWorkbook\n\n  'Now you can jump between workbooks like:\n  wb1.Activate\n  wb2.Activate\n\n  'You can insert a value from wb1 to wb2 like:\n  wb2.Sheets(1).Range(\"A1\").Value = wb1.Sheets(1).Range(\"A1\").Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 12584322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2014f9f5b21c4d73c5539beffded253?s=128&d=identicon&r=PG&f=1", "display_name": "samm", "link": "https://stackoverflow.com/users/12584322/samm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1580308606, "creation_date": 1577097818, "last_edit_date": 1580308606, "question_id": 59453936, "link": "https://stackoverflow.com/questions/59453936/how-to-set-a-workbook-to-a-variable-name", "title": "How to set a workbook to a variable name?", "body": "<p>How do I set a workbook to a variable name to be used later on in the sub?</p>\n\n<p>I'm trying to open a workbook (PriceFile) and set values in this workbook to values in the original workbook (TestFile). I can open PriceFile but can't name the workbook. </p>\n\n<pre><code>Public Sub Get_Sum_Assured()\n    Dim TestFile As Workbook\n    Dim PriceFile As Workbook\n    Dim PriceFileName As String\n    Dim Test_Cases As Integer\n    Dim FirstTest As Integer\n    Dim CommDate As Date\n    Dim DOB As Date\n    Dim MonthPrem As Long\n    Dim SumAssured As Long\n    Dim TestCount As Integer\n\n    Set TestFile = ThisWorkbook\n    Call Open_Pricing_File\n    TestFile.Activate\n    PriceFileName = Range(\"Pricing_File\").Value\n    Set PriceFile = Workbooks(PriceFileName)\n</code></pre>\n\n<p>Open_Pricing_File opens the file named in \"Pricing_File\" and when I've stepped through this works. When I try and set PriceFile to this workbook, the code falls over on this last line.</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577104817, "post_id": 59453859, "comment_id": 105092172, "body": "Maybe something like <a href=\"https://stackoverflow.com/a/59424032/9758194\">this</a> to avoid loops or <code>on error</code> handlers."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1577099153, "post_id": 59454009, "comment_id": 105089947, "body": "Thanks it solved the initial problem! However I just tested with upper/lower case letters and then it produces an error. How can I solve this?  would a <code>str(</code> solve this?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1577099294, "post_id": 59454009, "comment_id": 105090005, "body": "I&#39;d suggest to open an new post for this as it seems to be a new problem"}, {"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1577099357, "post_id": 59454009, "comment_id": 105090032, "body": "Nevermind, your quicker code did something. Don&#39;t quite know why though. Now it doesn&#39;t present the error. Great job, thanks mate!"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 2, "last_activity_date": 1577100187, "last_edit_date": 1577100187, "creation_date": 1577098129, "answer_id": 59454009, "question_id": 59453859, "link": "https://stackoverflow.com/questions/59453859/looping-through-sheets-to-see-if-sheet-name-is-already-taken-len-left-function/59454009#59454009", "title": "Looping through sheets to see if sheet name is already taken - Len/Left function in loop", "body": "<p>I would use the following function to check if a sheet exists or not</p>\n\n<pre><code> Public Function sheetExists(SheetName As String, Optional wrkBook As Workbook) As Boolean\n\n    If wrkBook Is Nothing Then\n        Set wrkBook = ActiveWorkbook 'or ThisWorkbook - whichever appropriate\n    End If\n\n    On Error GoTo EH\n\n    sheetExists = False  ' Not really neccessary as this is the default\n\n    Dim sht As Object\n\n    For Each sht In wrkBook.Sheets\n        If UCase(sht.Name) = UCase(SheetName) Then\n            sheetExists = True\n            Exit For\n        End If\n    Next sht\n\n    Exit Function\n\nEH:\n    sheetExists = False\nEnd Function\n</code></pre>\n\n<p>Then your code would look like that</p>\n\n<pre><code>Sub OP_Code()\n\n    Dim S As Worksheet\n\n    Myvalue = ActiveCell.Value\n\n    If sheetExists(Left(Myvalue &amp; \" Case Types\", 31)) Then\n        Sheets(Left(Myvalue &amp; \" Case Types\", 31)).Select\n    Else\n        'Create New Sheet\n        Set ws = Sheets.Add(after:=Sheets(Worksheets.Count))\n        If Len(Myvalue &amp; \" Case Types\") &gt; 31 Then\n            ws.Name = Left(Myvalue &amp; \" Case Types\", 31)\n        Else: ws.Name = Myvalue &amp; \" Case Types\"\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1577098837, "creation_date": 1577098837, "answer_id": 59454178, "question_id": 59453859, "link": "https://stackoverflow.com/questions/59453859/looping-through-sheets-to-see-if-sheet-name-is-already-taken-len-left-function/59454178#59454178", "title": "Looping through sheets to see if sheet name is already taken - Len/Left function in loop", "body": "<p>Quicker version</p>\n\n<pre><code>Public Function sheetExists(SheetName As String, Optional wrkBook As Workbook) As Boolean\n    If wrkBook Is Nothing Then\n        Set wrkBook = ActiveWorkbook 'or ThisWorkbook - whichever appropriate\n    End If\n    On Error GoTo EH\n    Dim sht As Worksheet\n\n    set sht = wrkbook.worksheets(sheetname) 'will cause error if sheetname doesn't exist\n    Set sht = nothing\n    SheetExists=true\n    Exit Function\nEH:\n    sheetExists = False\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 59454009, "answer_count": 2, "score": 1, "last_activity_date": 1577100187, "creation_date": 1577097564, "question_id": 59453859, "link": "https://stackoverflow.com/questions/59453859/looping-through-sheets-to-see-if-sheet-name-is-already-taken-len-left-function", "title": "Looping through sheets to see if sheet name is already taken - Len/Left function in loop", "body": "<p>I'm having an issue with below. My code is basically a sorting function, where it pulls data from another sheet in order to give the user the correct view, however if the user selects the same product twice, my code produces an error since the information sheet is already in the workbook.</p>\n\n<p>Therefore I simply want it to select the sheet, if the sheet is already in the workbook instead of running the code once more.</p>\n\n<p>My issue is, that sometimes the sheet name will have more than 31 characters, which is why I use the left/len function. The problem is that it doesn't recognize the existing sheet name as </p>\n\n<pre><code>Left(Myvalue &amp; \" Case Types\", 31)\n</code></pre>\n\n<p>and therefore just runs the code even though sheet already exist and therefore produces an error. When tabbing through the code with F8 I can see that the name should be same. Any suggestions?</p>\n\n<pre><code>Dim S As Worksheet\n\nMyvalue = activecell.Value\n\nFor Each S In ActiveWorkbook.Worksheets\n    If S.Name = Left(Myvalue &amp; \" Case Types\", 31) Then GoTo Sheetalreadyexist\nNext S\n\n'Create New Sheet\nSet ws = Sheets.Add(after:=Sheets(Worksheets.Count))\n    If Len(Myvalue &amp; \" Case Types\") &gt; 31 Then\n    ws.Name = Left(Myvalue &amp; \" Case Types\", 31)\n    Else: ws.Name = Myvalue &amp; \" Case Types\"\n    End If\n\nSheetalreadyexist: sheets(Left(Myvalue &amp; \" Case Types\", 31).select\n</code></pre>\n"}, {"tags": ["python", "vba", "class"], "comments": [{"owner": {"reputation": 450, "user_id": 8268531, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155472776008769/picture?type=large", "display_name": "Julian Chan", "link": "https://stackoverflow.com/users/8268531/julian-chan"}, "edited": false, "score": 0, "creation_date": 1577093115, "post_id": 59452714, "comment_id": 105087460, "body": "Naming conventions of methods aside, you are roughly on the right track. You could check out online tutorials of how OOP works in Python."}, {"owner": {"reputation": 3058, "user_id": 7540911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6917a4235078edd5bfdc86b37071a108?s=128&d=identicon&r=PG&f=1", "display_name": "Nullman", "link": "https://stackoverflow.com/users/7540911/nullman"}, "edited": false, "score": 0, "creation_date": 1577093121, "post_id": 59452714, "comment_id": 105087463, "body": "this is possible if you have a class <code>Company</code> which has a method <code>Department</code> that returns an object that has the next item in the chain.... you can put all of this into one class and always return <code>self</code> but i dont think this is what you want to do. what are you trying to make? if its a database-like thing did you consider dictionaries? pandas DataFrames?"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 3308807, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000387424276/picture?type=large", "display_name": "user3308807", "link": "https://stackoverflow.com/users/3308807/user3308807"}, "is_accepted": false, "score": 0, "last_activity_date": 1577093617, "creation_date": 1577093617, "answer_id": 59452951, "question_id": 59452714, "link": "https://stackoverflow.com/questions/59452714/multiple-classes-object-chaining/59452951#59452951", "title": "Multiple classes object &quot;chaining&quot;?", "body": "<p>I really don't think that's a good use of inheritance. Good inheritance is when the child class can easily be substituted for the parent class with no difficulties. Is an employee substitutable for a department? That doesn't seem right. Wouldn't a department be able to do tons of things an employee couldn't? For every function you have for a department that an employee can't do, you would have to have a \"throw new not implemented\" in the child class. </p>\n\n<p>This is known as the Liskov Substitution Principle. Basically subclasses must be substitutable for their base classes. My favorite example is with birds and penguins. You could make a bird class and have lots of different kinds of birds inherit from this class. But what happens when you create a penguin class inheriting from bird? Penguins can't fly but birds can. So in the penguin class, you would implement this function and would have to say \"throw new not implemented.\" Its not good because if you put a penguin in where a function is expecting a bird, it will freak out and crash when you give it a penguin.</p>\n\n<p>I hope that helps. I'm not too familiar with Python specifically but I do understand inheritance.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 6652204, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6782da87900f367d6d2974be4477031b?s=128&d=identicon&r=PG&f=1", "display_name": "FlyFly Wing", "link": "https://stackoverflow.com/users/6652204/flyfly-wing"}, "edited": false, "score": 0, "creation_date": 1577108445, "post_id": 59454062, "comment_id": 105093748, "body": "Thanks for the reply.  What I am really trying to do is this. There is a <b>tree structure</b> that I need to follow. So I am trying to create a class Company that stores a few departments and departments a few Employees.  When I used VBA, I created the 3 classes that use dictionary to store the Child Object. So the final syntax will appear to be the one that I have shown above. Do you have some better suggestions to model this <b>Tree Structure</b>?"}, {"owner": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "reply_to_user": {"reputation": 79, "user_id": 6652204, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6782da87900f367d6d2974be4477031b?s=128&d=identicon&r=PG&f=1", "display_name": "FlyFly Wing", "link": "https://stackoverflow.com/users/6652204/flyfly-wing"}, "edited": false, "score": 0, "creation_date": 1577109653, "post_id": 59454062, "comment_id": 105094322, "body": "You can implement classes with dictionaries in Python, too. You just can&#39;t use the syntax you proposed. A very &quot;pythonesque&quot; way to implement a tree structure is to use nested dictionaries. You could build a tree by  manually creating and adding objects to instances of the classes. There&#39;s even a cute way to make building them automatic (via  <a href=\"https://en.wikipedia.org/wiki/Autovivification\" rel=\"nofollow noreferrer\">autovivification</a>) which has very nice syntax. See <a href=\"https://stackoverflow.com/questions/635483/what-is-the-best-way-to-implement-nested-dictionaries\">What is the best way to implement nested dictionaries?</a>"}, {"owner": {"reputation": 79, "user_id": 6652204, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6782da87900f367d6d2974be4477031b?s=128&d=identicon&r=PG&f=1", "display_name": "FlyFly Wing", "link": "https://stackoverflow.com/users/6652204/flyfly-wing"}, "edited": false, "score": 0, "creation_date": 1577254110, "post_id": 59454062, "comment_id": 105129191, "body": "Thanks for updating the post. I was about to ask you how to separate the classes in order to map into the dictionary. :D"}, {"owner": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "reply_to_user": {"reputation": 79, "user_id": 6652204, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6782da87900f367d6d2974be4477031b?s=128&d=identicon&r=PG&f=1", "display_name": "FlyFly Wing", "link": "https://stackoverflow.com/users/6652204/flyfly-wing"}, "edited": false, "score": 0, "creation_date": 1577264143, "post_id": 59454062, "comment_id": 105130970, "body": "To be honest, I wasn&#39;t sure how the <code>Vividict</code> approach would work if you want to have different classes as the various levels \u2014 so decided to give it a shot. If you liked my answer please consider accepting and possibly up-voting it. See <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}], "tags": [], "owner": {"reputation": 97835, "user_id": 355230, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VjcbL.jpg?s=128&g=1", "display_name": "martineau", "link": "https://stackoverflow.com/users/355230/martineau"}, "is_accepted": false, "score": 0, "last_activity_date": 1577115229, "last_edit_date": 1577115229, "creation_date": 1577098371, "answer_id": 59454062, "question_id": 59452714, "link": "https://stackoverflow.com/questions/59452714/multiple-classes-object-chaining/59454062#59454062", "title": "Multiple classes object &quot;chaining&quot;?", "body": "<p>You haven't really said what the syntax you want is supposed to accomplish which would be useful to know...</p>\n\n<p>Nesting classes as shown below would allow you to achieve the syntax you want, but the result is not only very \"unpythonic\" \u2014 it's also completely useless and I can't think a reasonable way to implement to change that.</p>\n\n<p>Without more information about what you're doing, at the moment I can think of an alternative to suggest. I suggest you just create a bunch of regular non-nested classes and explicitly instantiate them when needed.</p>\n\n<p>Note that I've changed the names you were to follow the <a href=\"https://www.python.org/dev/peps/pep-0008/#naming-conventions\" rel=\"nofollow noreferrer\">PEP 8 naming conventions</a>.</p>\n\n<pre><code>class Company:\n    def __init__(self, name):\n        self.name = name\n\n    class Department:\n        def __init__(self, dept_name):\n            self.dept_name = dept_name\n\n        class Employee:\n            def __init__(self, given_name):\n                self.given_name = given_name\n\n\nCompany('MS').Department('Finance').Employee('John').full_name = 'John MacDonalds'\n</code></pre>\n\n<p>Here's a way to implement your tree structure via Python \"autovivification\" using the <code>Vividict</code> dictionary defined in this <a href=\"https://stackoverflow.com/a/19829714/355230\">answer</a>.</p>\n\n<p>I've adapted it to support different <code>Vividict</code> <em>subclasses</em> at each level in the hierarchy: i.e. <code>Company</code>, <code>Department</code>, and <code>Employee</code>. Each subclass defines a class atribute named <code>subtype</code> the the <code>Vividict</code> base class' <code>__missing__()</code> will use when creating missing key values. I also added <code>__repr__()</code> method to each one to make instance print out all the items they contain.</p>\n\n<p>This is just a proof-of-concept and I really don't know if you can use it or not, but it should give you a good idea of one way of doing what you want with some fairly readable syntax.</p>\n\n<pre><code>class Vividict(dict):  # Base class.\n    subtype = dict\n    def __missing__(self, key):\n        value = self[key] = self.subtype(key)\n        return value\n\nclass Employee:  # Leaf - Regular class\n    def __init__(self, given_name):\n        self.given_name = given_name\n    def __repr__(self):\n        return f'{self.__class__.__name__}({self.given_name!r})'\n\nclass Department(Vividict):  # Branch.\n    subtype = Employee\n    def __init__(self, dept_name):\n        self.dept_name = dept_name\n    def __repr__(self):\n        return (f'{self.__class__.__name__}({self.dept_name!r})' + '\\n    '\n                + repr(list(self.values())))\n\nclass Company(Vividict):  # Root of tree.\n    subtype = Department\n    def __init__(self, co_name):\n        self.co_name = co_name\n    def __repr__(self):\n        return (f'{self.__class__.__name__}({self.co_name!r})' + '\\n  '\n                + repr(list(self.values())))\n\ncompany = Company('MS')\ncompany['Finance']['George'].full_name = 'George Brown'\ncompany['Finance']['Mary'].full_name = 'Mary Jones'\nprint(company)\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Company('MS')\n  [Department('Finance')\n    [Employee('George'), Employee('Mary')]]\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 6652204, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6782da87900f367d6d2974be4477031b?s=128&d=identicon&r=PG&f=1", "display_name": "FlyFly Wing", "link": "https://stackoverflow.com/users/6652204/flyfly-wing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1577115229, "creation_date": 1577092520, "last_edit_date": 1577098598, "question_id": 59452714, "link": "https://stackoverflow.com/questions/59452714/multiple-classes-object-chaining", "title": "Multiple classes object &quot;chaining&quot;?", "body": "<p>I am new to Python and I have prior experience in VBA.\nI wish to create Classes in Python such that I could achieve the following syntax:</p>\n\n<pre><code>Company('MS').Department('Finance').Employee('John').FullName = 'John MacDonalds'\nCompany('MS').Department('Finance').Employee('John').Wages = '5000'\n</code></pre>\n\n<p>I am beginning to realize that declaring the Class structure in Python is very different from VBA.</p>\n\n<p>Am I on the right approach? If not, will there be any other recommended approach for this Parent/Child structure?</p>\n"}, {"tags": ["sql-server", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1577092421, "post_id": 59452455, "comment_id": 105087163, "body": "Is customer name displayed in a control such as a combobx named CustName? Is CustID a column of combobox? Grab that ID by referencing that combobox column by index. Otherwise maybe the following will help  <a href=\"https://social.msdn.microsoft.com/Forums/en-US/78eeab51-f39e-423c-8afc-ebd218d658c3/how-to-make-vba-to-read-and-understand-characters-in-other-keyboard-language\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 11435430, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211780517735825/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/11435430/nick"}, "edited": false, "score": 0, "creation_date": 1577096959, "post_id": 59453511, "comment_id": 105089056, "body": "Thanks for helping out Eric. Sorry, I didn\u2019t explain clearly. My data is in Amazon RDS which I linked it to MS SQL. I tried running the queries without N prefix and nothing were found. However, with N prefix, it works just fine. Is there a workaround for this that you know of?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 81, "user_id": 11435430, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211780517735825/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/11435430/nick"}, "edited": false, "score": 0, "creation_date": 1577097378, "post_id": 59453511, "comment_id": 105089221, "body": "Of course if you write T-SQL you need the <code>N</code>. If you write Access SQL, you don&#39;t. You need to figure out what the actual reason is your <code>DLookUp</code> isn&#39;t working, because as said, it&#39;s not the <code>N</code>. Try the query in Access, not at the backend. You will notice the variant with the <code>N</code> fails because of a syntax error, and the one without it succeeds."}, {"owner": {"reputation": 81, "user_id": 11435430, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211780517735825/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/11435430/nick"}, "edited": false, "score": 0, "creation_date": 1577097949, "post_id": 59453511, "comment_id": 105089465, "body": "I, ll try and figure it out. Thanks for helping me out. Before this I used local data and everything worked perfectly until I switched my data to SQL.   May be it\u2019s worth noting that when \u201cCustName\u201d string is in English, DLookUp function is able to find the right CustID, but when the string is in Thai it couldn\u2019t find anything."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 81, "user_id": 11435430, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211780517735825/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/11435430/nick"}, "edited": false, "score": 0, "creation_date": 1577099147, "post_id": 59453511, "comment_id": 105089942, "body": "There might be collation issues, you can perform matching in VBA by using <code>StrComp(FullName,&quot; &amp; &quot;&#39;&quot; &amp; CustName &amp; &quot;&#39;&quot;, 0) = 0</code>. However, performance will suffer. You should also check capitalization/collation issues, Access is generally more permissive than SQL server"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1577096022, "creation_date": 1577096022, "answer_id": 59453511, "question_id": 59452455, "link": "https://stackoverflow.com/questions/59452455/can-you-use-dlookup-function-with-n-prefix/59453511#59453511", "title": "Can you use DLookUp function with N prefix?", "body": "<p>You don't need the <code>N'</code> in Access SQL. All strings are unicode (UTF-16) strings.</p>\n\n<p>Note, though, that the VBE doesn't support unicode strings, and <code>MsgBox</code> doesn't support it either, so it might display incorrectly when debugging. But the lookup should just work.</p>\n\n<p>However, your code should just work, and if it doesn't, it's probably not due to the unicode string.</p>\n\n<p>Also note your code is wide open to SQL injection. You probably want to <a href=\"https://stackoverflow.com/q/49509615/7296893\">use parameters</a>.</p>\n"}], "owner": {"reputation": 81, "user_id": 11435430, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211780517735825/picture?type=large", "display_name": "Nick", "link": "https://stackoverflow.com/users/11435430/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577096022, "creation_date": 1577091386, "last_edit_date": 1577091846, "question_id": 59452455, "link": "https://stackoverflow.com/questions/59452455/can-you-use-dlookup-function-with-n-prefix", "title": "Can you use DLookUp function with N prefix?", "body": "<p>I'm trying to search for a specific value on a table linked with sql using DLookUp function. However, the string that I'm searching for is in Thai language. Here's my code.</p>\n\n<pre><code>Dim cust_Id1 As Variant: cust_Id1 = DLookup(\"[CustID]\", \"dbo_TblCustomer\", _\n                                        \"FullName=\" &amp; \"'\" &amp; CustName &amp; \"'\")\nCustID.Value = cust_Id1\n</code></pre>\n\n<p>What I want to do is find a customer's id by customer's name and store it in a variable. I know that I can query the SQL like the code below.</p>\n\n<pre><code>SELECT CustID\n  FROM [aTable].[dbo].[TblCustomer]\n  WHERE FullName LIKE N'\u0e19\u0e32\u0e21\u0e2a\u0e21\u0e21\u0e38\u0e15\u0e34'\n</code></pre>\n\n<p>Is there a way to do it using DLookUp function? If not, what are other ways to get CustID value?</p>\n"}, {"tags": ["excel", "vba", "string", "letter"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1577089387, "post_id": 59452021, "comment_id": 105086152, "body": "I don&#39;t know any wildcard characters that only match text, and the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/wildcard-characters-used-in-string-comparisons\" rel=\"nofollow noreferrer\">documentation doesn&#39;t provide any either</a>. Regex is normally considered to be <a href=\"https://stackoverflow.com/a/29633694/11936678\">the easiest solution</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1577110918, "post_id": 59452021, "comment_id": 105094880, "body": "@Plutian, it&#39;s quite possible though =). Nice question as it&#39;s actually somewhat strange there is no straightforward letter wildcard."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1577395483, "post_id": 59452021, "comment_id": 105161220, "body": "@Radas - a late post for the sake of the art and in addition to the question* &quot;Can this be done without RegEx?&quot;*  demonstrating how to use the FilterXML() function as alternative :-)"}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577110712, "post_id": 59452083, "comment_id": 105094790, "body": "The <code>Like</code> operator has some tricks on it&#39;s sleeves to prevent the use of <code>RegEx</code> in this case. Nonetheless, I do also like this solution ++"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577113889, "post_id": 59452083, "comment_id": 105096182, "body": "Small remark, just noticed (I&#39;m no RegEx expert) but wouldn&#39;t you want to use <code>&quot;^[A-Za-z]{4}&quot;</code>. Do you mind giving a short explaination of  why <code>.*$</code>? I guess this is looking for any non-newline characters untill the end of the string. But why? Will delete the comment later ;)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577114755, "post_id": 59452083, "comment_id": 105096562, "body": "<code>^</code> Is an anchor, making sure the defined pattern must occur at the start of the string. Wouldn&#39;t it?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1577722408, "post_id": 59452083, "comment_id": 105237105, "body": "FYI - you might be interested my approach using the <code>FilterXML()</code> function (besides the valid solution of JvdV) as you mentioned <i>&quot;I don&#39;t know a way to do this without using regular expressions&quot;</i> :-) @TimBiegeleisen"}], "tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": true, "score": 4, "last_activity_date": 1577114812, "last_edit_date": 1577114812, "creation_date": 1577089310, "answer_id": 59452083, "question_id": 59452021, "link": "https://stackoverflow.com/questions/59452021/is-there-an-easy-way-to-check-if-the-string-starts-with-letters-any-4-letters/59452083#59452083", "title": "Is there an easy way to check if the string starts with letters (any 4 letters)?", "body": "<p>I don't know a way to do this without using regular expressions.  We can try using regex <code>Test</code> along with the pattern <code>^[A-Z]{4}.*$</code>:</p>\n\n<pre><code>Dim input As String\nDim regex As Object\nSet regex = New RegExp\n\nregex.Pattern = \"^[A-Z]{4}.*$\"\ninput = \"ABCD blah\"\n\nIf regex.Test(input) Then\n    'DO STUFF\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1577110549, "post_id": 59453552, "comment_id": 105094715, "body": "<code>If str Like &quot;[a-zA-Z][a-zA-Z][a-zA-Z][a-zA-Z]*&quot;</code> Then to account for lower case too :). Nice solution, I added another version too =). ++"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1577111182, "post_id": 59453552, "comment_id": 105094990, "body": "The big question now is whether invoking full regex performs substantially worse than your answer."}], "tags": [], "owner": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "is_accepted": false, "score": 3, "last_activity_date": 1577096234, "creation_date": 1577096234, "answer_id": 59453552, "question_id": 59452021, "link": "https://stackoverflow.com/questions/59452021/is-there-an-easy-way-to-check-if-the-string-starts-with-letters-any-4-letters/59453552#59453552", "title": "Is there an easy way to check if the string starts with letters (any 4 letters)?", "body": "<p>You can do it with <code>Like</code> almost the same as with RegEx.</p>\n\n<p>\"{#}\" - doesn't exist in Like operators, but \"[A-Z]\" absolutely valid</p>\n\n<pre><code>if string like \"[A-Z][A-Z][A-Z][A-Z]*\" then\n   'DO STUFF\nend if\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "edited": false, "score": 1, "creation_date": 1577110952, "post_id": 59456803, "comment_id": 105094891, "body": "&quot;[!0-9][!0-9][!0-9][!0-9]*&quot; won&#39;t really suit to check &quot;4 letters&quot;, any string with no numbers will match it e.g. &quot;----&quot;"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "edited": false, "score": 1, "creation_date": 1577111082, "post_id": 59456803, "comment_id": 105094951, "body": "@AlexandruHapco, very true. If there are &quot;special&quot; characters, then it won&#39;t work but then you need the solution above it."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 2, "creation_date": 1577111157, "post_id": 59456803, "comment_id": 105094979, "body": "I think I also <code>Like</code> this solution +1."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1577111731, "post_id": 59456803, "comment_id": 105095240, "body": "Interesting, however I find the line somewhat blurry as to whether what you feed the <code>like</code> operator here would be called a regular expression. It&#39;s doesn&#39;t use the VBA <code>RegExp</code> operator as Tim does, but it certainly fits the criteria of a regular expression."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1577114083, "post_id": 59456803, "comment_id": 105096255, "body": "@Plutian, I agree a 100%, however these are what MS calls a &quot;charlist in a pattern&quot;. It&#39;s build-in and probably has seen it&#39;s creators draw from RegEx patterns since they are so alike. One huge difference though is the <code>*</code> which in <code>Like</code> is used for any amount of characters. In <code>RegEx</code> it&#39;s used to check for zero or more matches of the pattern defined before it."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1577395342, "post_id": 59456803, "comment_id": 105161182, "body": "For the sake of the art and in addition to the question* &quot;Can this be done without RegEx?&quot;* I demonstrate how to use the <code>FilterXML()</code> function as alternative :-)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 3, "last_activity_date": 1577111222, "last_edit_date": 1577111222, "creation_date": 1577110509, "answer_id": 59456803, "question_id": 59452021, "link": "https://stackoverflow.com/questions/59452021/is-there-an-easy-way-to-check-if-the-string-starts-with-letters-any-4-letters/59456803#59456803", "title": "Is there an easy way to check if the string starts with letters (any 4 letters)?", "body": "<blockquote>\n  <p><em>Can this be done without regEx?</em></p>\n</blockquote>\n\n<p>Yes, there is no specific need for <code>Regular Expressions</code> since the <code>Like</code> operator is quite capable as some sort of last resort to handle the situation, just like the writer of <a href=\"https://analystcave.com/vba-like-operator/\" rel=\"nofollow noreferrer\">this</a> article explains. Also, <code>RegEx</code> is sort of slow on a larger database. Nonetheless, <code>RegEX</code> is a great tool to use!</p>\n\n<p>The solution provided by <a href=\"https://stackoverflow.com/a/59453552/9758194\">@AlexandruHapco</a> would tell you if the string starts with 4 capital letters. But to account for lower OR upper, you can extend this logic:</p>\n\n<pre><code>If str Like \"[a-zA-Z][a-zA-Z][a-zA-Z][a-zA-Z]*\" Then\n</code></pre>\n\n<p>However, to shorten this a bit we can use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/wildcard-characters-used-in-string-comparisons\" rel=\"nofollow noreferrer\"><code>[!charlist]</code></a> to tell the operator we are looking for something that is NOT in the provided range. In other words, we could use:</p>\n\n<pre><code>If str Like \"[!0-9][!0-9][!0-9][!0-9]*\" Then\n</code></pre>\n\n<p>This last solution won't work when your string has any other characters than alphanumeric ones.</p>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577117106, "post_id": 59458044, "comment_id": 105097521, "body": "<i>&quot;It&#39;s a bit more to type then when using the Like operator&quot;</i>. You have left me confused, since you are using the <code>Like</code> operator yourself. Why not use it to it&#39;s full potential? You&#39;r typing more than the other answers  =)."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577119042, "post_id": 59458044, "comment_id": 105098387, "body": "@JvdV Indeed, like I said in the answer, it&#39;s more typing. But, say, you are interested in the 3rd and the 27th characters only. This solution is easily adaptable (and twice shorter now) to this or any other &quot;few characters&quot; need. How would &quot;the full potential&quot; solution work in this case, I wonder."}], "tags": [], "owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1577120636, "last_edit_date": 1577120636, "creation_date": 1577116376, "answer_id": 59458044, "question_id": 59452021, "link": "https://stackoverflow.com/questions/59452021/is-there-an-easy-way-to-check-if-the-string-starts-with-letters-any-4-letters/59458044#59458044", "title": "Is there an easy way to check if the string starts with letters (any 4 letters)?", "body": "<p>To test a few characters -- the first 4 letters in this case -- you can always do the following:</p>\n\n<pre><code>If Not (Mid(string, 1, 1) Like \"#\" And Mid(string, 2, 1) Like \"#\" _ \n    And Mid(string, 3, 1) Like \"#\" And Mid(string, 4, 1) Like \"#\") Then  \n    ' DO STUFF\nEnd If\n</code></pre>\n\n<p>It's a bit more to type then when using the Like operator, but so what? Also, you can use <code>Select Case</code> in a loop...\nAnother option is to use <code>IsNumeric(Mid(string, i, 1))</code> instead of  <code>Mid(string, i, 1) Like \"#\"</code>, etc.</p>\n\n<p>Granted, this approach is still quite practical with 4 characters, but is not as flexible and very much not scalable like RegEx is.</p>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1577395153, "creation_date": 1577395153, "answer_id": 59493563, "question_id": 59452021, "link": "https://stackoverflow.com/questions/59452021/is-there-an-easy-way-to-check-if-the-string-starts-with-letters-any-4-letters/59493563#59493563", "title": "Is there an easy way to check if the string starts with letters (any 4 letters)?", "body": "<p><strong>Approach using the <code>FilterXML</code> function</strong></p>\n\n<p>The WorksheetFunction <code>FilterXML()</code> has been added in \u25baExcel 2013 and allows to specify any <strong>XPath</strong> search string for a given XML document, which hasn't to be a locally saved file (needing <code>WebService()</code> function), but can be a string within <em>well formed</em> opening and closing nodes, i.e. our test string with some easy node additions (partly comparable to a html structure).</p>\n\n<p><strong>Example call</strong></p>\n\n<pre><code>Sub TextXML()\nDim myString As String\nmyString = \"ABCD blah\"\nIf check(myString) Then\n   'DO STUFF\n   Debug.Print \"okay\"\nElse\n   Debug.Print \"oh no\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>Help function</strong></p>\n\n<pre><code>Function check(ByVal teststring As String) As Boolean\n    Const s As String = Chr(185)  ' unusual character, e.g. Chr(185): \"\u00b9\"\n    On Error GoTo oops\n    If Len(WorksheetFunction.FilterXML(\"&lt;all&gt;&lt;i&gt;\" &amp; teststring &amp; \"&lt;/i&gt;&lt;/all&gt;\", \"//i[substring(translate(.,'ABCDEFGHIJKLMNOPQRSTUVWXYZ','\" &amp; _\n       String(26, s) &amp; \"'),1,4)='\" &amp; String(4, s) &amp; \"']\")) &gt; 0 Then check = True\n    Exit Function\noops:\n    Err.Clear\nEnd Function\n\n</code></pre>\n\n<p><strong>tl;tr - how to use VBA in Excel versions before 2013</strong></p>\n\n<p>For the sake of the art the classic way to use XPath via XMLDOM methods:</p>\n\n<p><strong>Example call</strong></p>\n\n<pre><code>Sub TextXML2()\nDim myString As String\nmyString = \"ABCD blah\"\n\nIf check2(myString) Then\n   'DO STUFF\n   Debug.Print \"okay\"\nElse\n   Debug.Print \"oh no\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>Help functions</strong></p>\n\n<pre><code>Function check2(ByVal teststring As String) As Boolean\n' Purpose: check if first 4 characters of a test string are upper case letters A-Z\n  ' [0] late bind XML document\n    Dim xDoc As Object\n    Set xDoc = CreateObject(\"MSXML2.DOMDocument.6.0\")\n  ' [1] form XML string by adding opening and closing node names (\"tags\")\n    teststring = \"&lt;all&gt;&lt;i&gt;\" &amp; teststring &amp; \"&lt;/i&gt;&lt;/all&gt;\"\n  ' [2] load XML\n    If xDoc.LoadXML(teststring) Then\n      ' [3a] list matching item(s) via XPath\n        Dim myNodeList As Object\n        Set myNodeList = xDoc.SelectNodes(XPath())\n            'Debug.Print teststring, \" found: \" &amp; myNodeList.Length\n      ' [3b] return true if the item matches, i.e. the list length is greater than zero\n        If myNodeList.Length &gt; 0 Then check2 = True\n    End If\n\nEnd Function\n\nFunction XPath() As String\n' Purpose: create XPath string to get nodes where the first 4 characters are upper case letters A-Z\n' Result: //i[substring(translate(.,'ABCDEFGHIJKLMNOPQRSTUVWXYZ','\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9\u00b9'),1,4)=\"\u00b9\u00b9\u00b9\u00b9\"]\n  ' get UPPER case alphabet\n    Const ABC     As String = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n  ' define replacement string consisting of an unusual character repeated 26 times\n    Const UNUSUAL As String = \"\u00b9\"       ' &lt;&lt; replace by your preferenced character\n    Dim replacement As String: replacement = String(Len(ABC), UNUSUAL)\n    'return XPath string\n    XPath = \"//i[substring(translate(.,'\" &amp; ABC &amp; \"','\" &amp; replacement &amp; \"'),1,4)=\"\"\" &amp; String(4, UNUSUAL) &amp; \"\"\"]\"\nEnd Function\n\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11648535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca02ebe3870d5dd223f5d5dd07f0ce6b?s=128&d=identicon&r=PG&f=1", "display_name": "Radas", "link": "https://stackoverflow.com/users/11648535/radas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 1, "accepted_answer_id": 59452083, "answer_count": 5, "score": 1, "last_activity_date": 1577395153, "creation_date": 1577088934, "question_id": 59452021, "link": "https://stackoverflow.com/questions/59452021/is-there-an-easy-way-to-check-if-the-string-starts-with-letters-any-4-letters", "title": "Is there an easy way to check if the string starts with letters (any 4 letters)?", "body": "<p>is there a way to check if the string begins with any 4 letters. I am looking for something like this:</p>\n\n<pre><code>If string like \"####*\" then\n'DO STUFF\nend if\n</code></pre>\n\n<p>\"#\" is for digits, I need the same thing but for letters only.\nCan this be done without regEx?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "edited": false, "score": 0, "creation_date": 1577100658, "post_id": 59451938, "comment_id": 105090511, "body": "Create a new email just before this line. This will be opening along with your signature. Store that Signature in a variable and later call it in the place of .htmlbody. This is how i manage to get the signature"}, {"owner": {"reputation": 65, "user_id": 5405866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eed03ccf6e9de9d49411c1bd7045aa8?s=128&d=identicon&r=PG&f=1", "display_name": "knowledge_is_power", "link": "https://stackoverflow.com/users/5405866/knowledge-is-power"}, "reply_to_user": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "edited": false, "score": 0, "creation_date": 1577101391, "post_id": 59451938, "comment_id": 105090775, "body": "@manoj0790 would you be able to give me an example in code?"}, {"owner": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "edited": false, "score": 0, "creation_date": 1577102041, "post_id": 59451938, "comment_id": 105091003, "body": "Could you paste the full code?"}, {"owner": {"reputation": 65, "user_id": 5405866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eed03ccf6e9de9d49411c1bd7045aa8?s=128&d=identicon&r=PG&f=1", "display_name": "knowledge_is_power", "link": "https://stackoverflow.com/users/5405866/knowledge-is-power"}, "reply_to_user": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "edited": false, "score": 0, "creation_date": 1577102131, "post_id": 59451938, "comment_id": 105091035, "body": "@manoj0790 unfortunately i cant. all i know is the .htmlbody contains both the signature and the user&#39;s response and i need to discard the user&#39;s response but not the signature."}, {"owner": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "edited": false, "score": 0, "creation_date": 1577102422, "post_id": 59451938, "comment_id": 105091153, "body": "I can try to modify the existing to make it work but not to write something from scratch."}, {"owner": {"reputation": 65, "user_id": 5405866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eed03ccf6e9de9d49411c1bd7045aa8?s=128&d=identicon&r=PG&f=1", "display_name": "knowledge_is_power", "link": "https://stackoverflow.com/users/5405866/knowledge-is-power"}, "reply_to_user": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "edited": false, "score": 0, "creation_date": 1577102769, "post_id": 59451938, "comment_id": 105091327, "body": "@manoj0790 that might be good enough. thank you for trying to help."}], "answers": [{"tags": [], "owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "is_accepted": true, "score": 1, "last_activity_date": 1577115397, "creation_date": 1577115397, "answer_id": 59457853, "question_id": 59451938, "link": "https://stackoverflow.com/questions/59451938/how-to-replace-the-body-of-a-reply-to-an-email-and-keep-signature/59457853#59457853", "title": "How to replace the body of a reply to an email and keep signature?", "body": "<p>Instead of using the <code>reply</code> functionality, just create a new mailItem and transfer the details over.</p>\n\n<p>Example below uses the original email. So wherever you have <code>Set oReply = (something).Reply</code> you will replace or update that with <code>Set originalMailItem = (Something)</code>.  This <code>(something)</code> should be the original mail you are attempting to reply to.</p>\n\n<p>In order to effectively insert the signature, we have to <code>.Display</code> the mailItem. Otherwise outlook will note generate the signature. Make sure the signature settings are correct on your outlook client to default to the desired signature for new mail items.</p>\n\n<pre><code>Set newMail = outApp.CreateItem(olMailItem) 'Create a new mail instead of replying to existing\n\nWith newMail\n    .Display\n    .HTMLBody = \"&lt;HTML&gt;&lt;Body&gt;&lt;span&gt;my reply here&lt;/span&gt;&lt;Body&gt;&lt;/HTML&gt;\" _\n    &amp; \"&lt;span&gt;\" &amp; \"Additional stuff\" &amp; \"&lt;/span&gt;\" _\n    &amp; .HTMLBody 'HTMLBody already contains the signature once the email was displayed so we just tack it onto the end.\n    .To = originalMailItem.SenderEmailAddress\n    .CC = originalMailItem.CC\n    .BCC = originalMailItem.BCC\n    .Subject = originalMailItem.Subject\n    '.Send     'To send the reply\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5405866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eed03ccf6e9de9d49411c1bd7045aa8?s=128&d=identicon&r=PG&f=1", "display_name": "knowledge_is_power", "link": "https://stackoverflow.com/users/5405866/knowledge-is-power"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 59457853, "answer_count": 1, "score": 1, "last_activity_date": 1583066398, "creation_date": 1577088334, "last_edit_date": 1583066398, "question_id": 59451938, "link": "https://stackoverflow.com/questions/59451938/how-to-replace-the-body-of-a-reply-to-an-email-and-keep-signature", "title": "How to replace the body of a reply to an email and keep signature?", "body": "<p>I would like to reply to an email without including the original email, but include the sender as the recipient, the subject, and my signature.</p>\n\n<p>Currently I have <code>Set objDoc = ActiveInspector.WordEditor</code>. I tried looking for the body of the email here, so I can replace it with other text.</p>\n\n<p>I would like to retain the Subject of the email I am replying to, the Sender, and the Recipient.</p>\n\n<p>Here is the code I have for my current reply:</p>\n\n<pre><code>With oReply\n    .BCC = bccField\n    .CC = ccField\n    .HTMLBody = \"&lt;HTML&gt;&lt;Body&gt;&lt;span&gt;my reply here&lt;/span&gt;&lt;Body&gt;&lt;/HTML&gt;\" &amp; .HTMLBody &amp; \"&lt;span&gt;\" &amp; \"Additional stuff\" &amp; \"&lt;/span&gt;\"\nEnd With \n</code></pre>\n\n<p>I tried taking out the .HTMLBody in between the <code>&lt;span&gt;</code>s, which does take out the original user's message but also takes out my signature.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577084559, "post_id": 59450961, "comment_id": 105084746, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/20687810/vba-macro-that-search-for-file-in-multiple-subfolders\">VBA macro that search for file in multiple subfolders</a>"}], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 11823736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e9a00f3cd36ae939382d72af4afb17?s=128&d=identicon&r=PG&f=1", "display_name": "trytocode", "link": "https://stackoverflow.com/users/11823736/trytocode"}, "edited": false, "score": 0, "creation_date": 1577084026, "post_id": 59451123, "comment_id": 105084584, "body": "i think it makes sense, but the folderPath has only subfolders , and inside the subfolders will have .txt and .csv files , thats why if i use the folderPath &amp; &quot;<i>.csv</i>&quot; files, it wont work"}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1577086826, "last_edit_date": 1577086826, "creation_date": 1577083253, "answer_id": 59451123, "question_id": 59450961, "link": "https://stackoverflow.com/questions/59450961/how-to-get-the-filename-with-csv-extension/59451123#59451123", "title": "How to get the filename with csv extension", "body": "<p>You can use <code>Dir(folderPath &amp; \"*.csv\")</code> to find all csv files in <code>folderPath</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Right(folderPath, 1) &lt;&gt; \"\\\" Then folderPath = folderPath &amp; \"\\\"\nfileName = Dir(folderPath &amp; \"*.csv\")\n\nWhile Len(fileName) &lt;&gt; 0\n\n    If Left(fileName, 1) &lt;&gt; \".\" Then\n        fullFilePath = folderPath &amp; fileName\n        ReDim Preserve folders(0 To numFolders) As String\n        folders(numFolders) = fullFilePath\n        numFolders = numFolders + 1\n    End If\n\n    fileName = Dir()\nWend\n</code></pre>\n\n<h1>new edition: use <code>FileSystemObject</code></h1>\n\n<p>Use <code>FileSystemObject</code> to get names of subfolders then get all csv files in each subfolder</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim fso as object, mainFolder as object, subFolder as object, file\n\nset fso = createobject(\"Scripting.FileSystemObject\")\nif fso.FolderExists(\"folderPath\") Then\n    set mainFolder = fso.getfolder(\"folderPath\")\nelse\n    exit sub\nend if\n\nfor each subFolder in mainFolder.subfolders\n    for each file in subFolder.Files\n        if file.name like \"*.csv\" then\n            ReDim Preserve folders(0 To numFolders) As String\n            folders(numFolders) = file\n            numFolders = numFolders + 1\n        end if\n    next file\nnext subFolder\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12789697, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/fe23626463f34948a3b7041d08dafea8?s=128&d=identicon&r=PG", "display_name": "Zeusz", "link": "https://stackoverflow.com/users/12789697/zeusz"}, "is_accepted": false, "score": 0, "last_activity_date": 1580112002, "creation_date": 1580112002, "answer_id": 59927061, "question_id": 59450961, "link": "https://stackoverflow.com/questions/59450961/how-to-get-the-filename-with-csv-extension/59927061#59927061", "title": "How to get the filename with csv extension", "body": "<p>My suggestion:</p>\n\n<pre><code>    fullFilePath = folderPath &amp; fileName\n\n   If (GetAttr(fullFilePath) And vbDirectory) = vbDirectory Then\n        ReDim Preserve folders(0 To numFolders) As String\n        folders(numFolders) = fullFilePath\n        numFolders = numFolders + 1\n   Else\n     If Right(fileName, 4) = \".csv\" Then 'new line\n       'Insert the actions to be performed on each file\n        'This example will print the full file path to the immediate window\n        Debug.Print folderPath &amp; fileName\n    End If\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 11823736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e9a00f3cd36ae939382d72af4afb17?s=128&d=identicon&r=PG&f=1", "display_name": "trytocode", "link": "https://stackoverflow.com/users/11823736/trytocode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1580112002, "creation_date": 1577082310, "last_edit_date": 1577083133, "question_id": 59450961, "link": "https://stackoverflow.com/questions/59450961/how-to-get-the-filename-with-csv-extension", "title": "How to get the filename with csv extension", "body": "<p>im trying to get file name with csv extension , but when i try to debug.print it always print the .csv file and the .txt file </p>\n\n<p>im search the file in the folder and subfolder </p>\n\n<p>heres the code</p>\n\n<pre><code>Sub LoopAllSubFolders(ByVal folderPath As String)\n\nDim fileName As String\nDim fullFilePath As String\nDim numFolders As Long\nDim folders() As String\nDim i As Long\n\nIf Right(folderPath, 1) &lt;&gt; \"\\\" Then folderPath = folderPath &amp; \"\\\"\nfileName = Dir(folderPath &amp; \"*.*\", vbDirectory)\n\nWhile Len(fileName) &lt;&gt; 0\n\n    If Left(fileName, 1) &lt;&gt; \".\" Then\n\n        fullFilePath = folderPath &amp; fileName\n\n        If (GetAttr(fullFilePath) And vbDirectory And Not (fullFilePath Like \"*csv*\")) = vbDirectory Then\n            ReDim Preserve folders(0 To numFolders) As String\n            folders(numFolders) = fullFilePath\n            numFolders = numFolders + 1\n        Else\n            'Insert the actions to be performed on each file\n            'This example will print the full file path to the immediate window\n            Debug.Print folderPath &amp; fileName\n        End If\n\n    End If\n\n    fileName = Dir()\n\nWend\n\nFor i = 0 To numFolders - 1\n\n    LoopAllSubFolders folders(i)\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>The code i get from website and i add <code>not like \"*csv*\"</code></p>\n\n<p>perhaps someone can correcting the code,</p>\n\n<p>thankyou</p>\n"}, {"tags": ["excel", "vba", "textbox", "userform"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 12583031, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216114842531835/picture?type=large", "display_name": "Adam Rhodes", "link": "https://stackoverflow.com/users/12583031/adam-rhodes"}, "edited": false, "score": 0, "creation_date": 1577182412, "post_id": 59452400, "comment_id": 105113852, "body": "Thank you so much for your help. It worked perfectly except I did need the boolean property to trigger it. I should have explained that one option box was for money going out and the other for money coming in so if the option box was selected for money going out it would turn the number into the negative. The code was perfect though. Thank you very much for your help I was stumped."}], "tags": [], "owner": {"reputation": 612, "user_id": 10548234, "user_type": "registered", "profile_image": "https://graph.facebook.com/495896574223399/picture?type=large", "display_name": "hiichaki", "link": "https://stackoverflow.com/users/10548234/hiichaki"}, "is_accepted": true, "score": 1, "last_activity_date": 1577093493, "last_edit_date": 1577093493, "creation_date": 1577091047, "answer_id": 59452400, "question_id": 59450841, "link": "https://stackoverflow.com/questions/59450841/convert-textbox-positive-values-to-negative-based-on-option-button-selection/59452400#59452400", "title": "Convert Textbox Positive Values to Negative Based on Option Button Selection", "body": "<p>First of all, check if you trigger the event. Put a breakpoint in this sub and try to change the value.</p>\n\n<p>The <strong>AfterUpdate</strong> event is triggered when control or record is updated. Within a record, changed data in each control is updated when the <strong>control loses the focus</strong> or when the user <strong>presses Enter or Tab</strong>.</p>\n\n<p>Just checked your code and it works if the event was triggered.</p>\n\n<p>Also, I suggest to change it a bit. </p>\n\n<pre><code>Dim value As Double\nDim tryValue As String\n'remove $ sign so String value could be converted to Number format\ntryValue = Replace(GameLogUF.InsTxtBox.value, \"$\", \"\")\n\n'if user input is not numeric after removing $ sign - input incorrect\nIf Not IsNumeric(tryValue) Then\n    'do sth else\n    Exit Sub\nEnd If\nvalue = tryValue\n\n' \"= True\" part is not needed there is no need to compare boolean property '\nIf GameLogUF.InsPlyrOptnBtn.value Then\n    'if user input is negative your code will turn it back to positive, with Abs it always will be negative in this case'\n    value = Abs(value) * -1\nEnd If\n'do formatting in the end'\nGameLogUF.InsTxtBox.value = Format(value, \"$#,###\")\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 12583031, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216114842531835/picture?type=large", "display_name": "Adam Rhodes", "link": "https://stackoverflow.com/users/12583031/adam-rhodes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 59452400, "answer_count": 1, "score": 0, "last_activity_date": 1580315641, "creation_date": 1577081464, "last_edit_date": 1580315641, "question_id": 59450841, "link": "https://stackoverflow.com/questions/59450841/convert-textbox-positive-values-to-negative-based-on-option-button-selection", "title": "Convert Textbox Positive Values to Negative Based on Option Button Selection", "body": "<p>I am working on an Excel userform with a textbox for the user to enter a dollar amount that was either received or given. That number is put into a spreadsheet cell after the command button is selected. I have two radio buttons, one is for money given and the other one is for money received.</p>\n\n<p>I would like the user to enter a positive amount in the box and when the given button is selected it turns into a negative. When the received button is selected it will leave the box as positive.</p>\n\n<p>Normally I would multiply something by -1 to turn it negative. I tried <code>userform.textbox.value = userform.textbox.value * -1</code>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub InsTxtBox_AfterUpdate()\n\n    GameLogUF.InsTxtBox = Format(GameLogUF.InsTxtBox, \"$#,###\")\n\n    If GameLogUF.InsPlyrOptnBtn.Value = True Then\n        GameLogUF.InsTxtBox.Value = GameLogUF.InsTxtBox.Value * -1\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577081741, "post_id": 59450476, "comment_id": 105083955, "body": "I am not clear what the problem is. Are you saying the id changes to have spaces? You try either of the following ie.document.querySelector(&quot;input[id*=search]&quot;).value = &quot;xyz&quot; or ie.document.querySelector(&quot;#units-grid-search-filter,[id=&#39;un&zwnj;&#8203;its -grid -search -filter&#39;]&quot;).value = &quot;xyz&quot;   if either of those work I will type up an answer explaining. Though from what you show you should just be able to use ie.document.querySelector(&quot;#units-grid-search-filter&quot;).value = &quot;xyz&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577081982, "post_id": 59450476, "comment_id": 105084005, "body": "It also looks like you may need associate a key down event with the field entry. Site appears to be using knockoutjs."}], "answers": [{"comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 1, "user_id": 10606130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-US9yYJUhTbI/AAAAAAAAAAI/AAAAAAAAAH0/SPMsd6R12V4/photo.jpg?sz=128", "display_name": "Nawid ", "link": "https://stackoverflow.com/users/10606130/nawid"}, "edited": false, "score": 0, "creation_date": 1577267729, "post_id": 59452772, "comment_id": 105131703, "body": "Please try to provide a detailed information like which object it ask for? Please try to check that you are using &#39;IE&#39; as InternetExplorer object. If you are using any other name then you need to modify it in code. Let us know about the testing result."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1577092783, "creation_date": 1577092783, "answer_id": 59452772, "question_id": 59450476, "link": "https://stackoverflow.com/questions/59450476/how-to-enter-value-into-website-inputs-by-excel-vba/59452772#59452772", "title": "how to enter value into website inputs by excel vba", "body": "<p>The site you are trying to automate is using knockoutjs.</p>\n\n<p>The Textbox in which you are trying to set the value using your VBA code is set as <strong>observable</strong> in knockoutjs code.</p>\n\n<blockquote>\n  <p>If this parameter is an observable value, the binding will update the\n  element\u2019s value whenever the value changes. If the parameter isn\u2019t\n  observable, it will only set the element\u2019s value once and will not\n  update it again later.</p>\n  \n  <p>Whenever the user edits the value in the associated form control, KO\n  will update the property on your view model. KO will always attempt to\n  update your view model when the value has been modified and a user\n  transfers focus to another DOM node (i.e., on the change event), but\n  you can also trigger updates based on other events by using the\n  valueUpdate parameter described below.</p>\n</blockquote>\n\n<p>Reference:</p>\n\n<p><a href=\"https://knockoutjs.com/documentation/value-binding.html\" rel=\"nofollow noreferrer\">The \"value\" binding</a></p>\n\n<p>Which means the value is coming from the knockoutjs model. If you modify the value manually then it will also modifies the value in model. </p>\n\n<p>When you are trying to assign the value using your VBA code, no events occur and value not get updated to that model.</p>\n\n<p>I tried to fire an event from VBA code. but it is not modifying the value in model. I tested with multiple JS events and it did not worked. If you try to pass the same event from your HTML code then it will give an error in VBA.</p>\n\n<p>At last, I suggest you to make a test with <strong>Sendkeys</strong>. </p>\n\n<p>Sendkeys is essentially the same as typing with the keyboard. You need to make sure the correct windows and objects are selecting before proceeding. Sendkeys can also trigger events that run based on user interaction on the web. </p>\n\n<p>Sample code:</p>\n\n<pre><code>  Declare PtrSafe Function SetForegroundWindow Lib \"user32\" (ByVal HWND As Long) As Long\n\nSub demo()\n\n    Dim i As Long\n    Dim URL As String\n    Dim IE As Object\n    Dim HWNDSrc As Long\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    IE.Visible = True\n\n    URL = \"example.com\"\n\n    IE.Navigate URL\n\n    Do While IE.ReadyState = 4: DoEvents: Loop\n    Do Until IE.ReadyState = 4: DoEvents: Loop\n\n    HWNDSrc = IE.HWND\n    SetForegroundWindow HWNDSrc\n\n    IE.Document.getElementById(\"abc\").Focus\n    SendKeys \"123\", True\n\n    Set IE = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Further, you can try to modify the code as per your requirement.</p>\n"}], "owner": {"reputation": 1, "user_id": 10606130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-US9yYJUhTbI/AAAAAAAAAAI/AAAAAAAAAH0/SPMsd6R12V4/photo.jpg?sz=128", "display_name": "Nawid ", "link": "https://stackoverflow.com/users/10606130/nawid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 765, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577092783, "creation_date": 1577078445, "last_edit_date": 1577078534, "question_id": 59450476, "link": "https://stackoverflow.com/questions/59450476/how-to-enter-value-into-website-inputs-by-excel-vba", "title": "how to enter value into website inputs by excel vba", "body": "<p>I am trying to enter a value in a website filter, I can enter the username and password in login page by using the HTML element ID, after login I want to enter a value in filter input, the filter input id is units-grid-search-filter, but it automatically changed to units -grid -search -filter,\nI don't the problem is in wherein element id space or delay<br>\nthis is my code.</p>\n\n<pre><code>Sub Button3_Click()\n\n\n\nOn Error GoTo Err_Clear\nsURL = \"http://103.215.211.2/Web/Account/Login?ReturnUrl=%2fWeb%2f#25/-3/\"\nSet oBrowser = New InternetExplorer\noBrowser.Silent = True\noBrowser.timeout = 60\noBrowser.Navigate sURL\noBrowser.Visible = True\n\nDo\n' Wait till the Browser is loaded\nLoop Until oBrowser.readyState = READYSTATE_COMPLETE\n\nSet HTMLdoc = oBrowser.Document\n\nHTMLdoc.all.UserName.Value = \"abc\"\nHTMLdoc.all.Password.Value = \"abc123\"\n\nHTMLdoc.all.units -grid - Search - Filter.Value = \"123\"\n\nFor Each oHTML_Element In HTMLdoc.getElementsByTagName(\"input\")\nDebug.Print oHTML_Element.Name\nNext\nSet frm = HTMLdoc.forms(0)\n\nfrm.submit\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\n' oBrowser.Refresh ' Refresh If Needed\nDo Until Not IE.Busy And IE.readyState = 4\n        DoEvents\n    Loop\n\n\n\n\ne.Click\n\nErr_Clear:\nIf Err &lt;&gt; 0 Then\nErr.Clear\nResume Next\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bTml0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bTml0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1577054180, "post_id": 59448521, "comment_id": 105079668, "body": "<code>Debug.Print folderPath &amp; Filename</code> what is the result? is it a valid path?"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1577054310, "post_id": 59448521, "comment_id": 105079686, "body": "Also if you are looping over <code>workbooks</code> in the same <code>folder</code> I&#39;d be using <code>FSO</code>. so much easier and simple to use, not to mention neater.."}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1577054529, "post_id": 59448521, "comment_id": 105079721, "body": "Debug returns the proper file path and filename. FSO? I&#39;m not familiar with it unfortunately :("}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1577056440, "post_id": 59448521, "comment_id": 105080083, "body": "<code>FSO</code> = <code>FileScriptingObject</code>. In my opinion, <code>DIR</code> is old and outdated and <code>FSO</code> is the new king. You CAN nest <code>FSO</code> within an <code>FSO</code> this is one of the big draw cards as to why I like it... check it out <a href=\"https://stackoverflow.com/questions/43367671/vba-excel-iterating-through-files-in-folder-via-filesystemobject\" title=\"vba excel iterating through files in folder via filesystemobject\">stackoverflow.com/questions/43367671/&hellip;</a>"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1577057966, "post_id": 59448521, "comment_id": 105080317, "body": "Thanks @alowflyingpig ! I will check it out."}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1577055380, "post_id": 59448592, "comment_id": 105079890, "body": "Also I don&#39;t know much about AHK but maybe your screenupdating set  to False is the problem?"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1577056330, "post_id": 59448592, "comment_id": 105080061, "body": "Well, I turned screenupdating to True, and it did open the document! Now, I think you might be on to something there with the way my loop is set up. I think it might be detecting my MattsTools.xlsm document because I&#39;m getting errors from my AHK scripts that might allude to that. I&#39;ll report back with the new loop structure. Thanks!"}, {"owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "edited": false, "score": 0, "creation_date": 1577145955, "post_id": 59448592, "comment_id": 105105844, "body": "I actually found another solution with using AutoHotKey for the entire thing, but I&#39;m accepting your solution as the answer because I think you were on to something there. I had to turn screenupdating on for sure, and likely my Do While loop was structured incorrectly. Thanks for the help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1577055302, "last_edit_date": 1577055302, "creation_date": 1577054536, "answer_id": 59448592, "question_id": 59448521, "link": "https://stackoverflow.com/questions/59448521/workbooks-open-not-actually-opening-documents-until-the-end-of-my-loop/59448592#59448592", "title": "Workbooks.Open Not Actually Opening Documents Until The End of My Loop?", "body": "<p>When will this loop exit?</p>\n\n<pre><code>Do While Filename &lt;&gt; \"\" And Filename &lt;&gt; \"MattsTools.xlsm\" \n</code></pre>\n\n<p>If the first file found is MattsTools then that's the end of your looping.</p>\n\n<p>You likely want something more like this:</p>\n\n<pre><code>Do While Filename &lt;&gt; \"\" \n    If Filename &lt;&gt; ThisWorkbook.Name Then\n         'Process this file\n    End If\n    FileName = Dir()\nLoop\n</code></pre>\n"}], "owner": {"reputation": 593, "user_id": 10018602, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFE-nC2Du6A/AAAAAAAAAAI/AAAAAAAAAK8/N8OGweyD3x4/photo.jpg?sz=128", "display_name": "Matt Wilson", "link": "https://stackoverflow.com/users/10018602/matt-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59448592, "answer_count": 1, "score": 0, "last_activity_date": 1577055302, "creation_date": 1577053889, "last_edit_date": 1577054107, "question_id": 59448521, "link": "https://stackoverflow.com/questions/59448521/workbooks-open-not-actually-opening-documents-until-the-end-of-my-loop", "title": "Workbooks.Open Not Actually Opening Documents Until The End of My Loop?", "body": "<p>I have noticed a few others having this issue, but can't seem to find a solution. Windows 10 and Excel 2016.</p>\n\n<p>I'm trying to have a VBA macro loop through all <code>.xls</code> documents in a folder, by actually OPENING the document (not just \"opening in the background/invisibly\") because I have some AutoHotKey scripts that require the document to be physically open in order for them to work. As it stands right now, the VBA carries out the entirety of its code in the background and I can't have that because the AHK scripts aren't editing the document with it not being open.</p>\n\n<p>I want to physically open the first document, once opened then use the SendKeys function to trigger the AHK scripts to run (which edit the document the way I want, don't ask), then print the document, save and close it, then move on to the next document in the folder.</p>\n\n<p>The code looks like this:</p>\n\n<pre><code>Sub Button4_Click()\n\n'\n' Button2_Click Macro\n' Bulk preparation of FE pages for printing\n'\n\n' Variables\nDim folderPath As String\nDim Filename As String\nDim wb As Workbook\nDim Masterwb  As Workbook\nDim sh As Worksheet\nDim NewSht As Worksheet\nDim FindRng As Range\nDim PasteRow As Long\nDim SrchRng As Range, cel As Range\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n' set master workbook\nSet Masterwb = Workbooks(\"MattsTools.xlsm\")\n\n' Directory of where the copies of the files to be unchecked are located\nfolderPath = \"C:\\Users\\Employee\\Desktop\\...\\For_Printing\"\n\n' A conditional for finding the directory\nIf Right(folderPath, 1) &lt;&gt; \"\\\" Then folderPath = folderPath &amp; \"\\\"\n\n' Do this for each workbook in the folder, as long as it's not MattsTools.xlsm which is this workbook\nFilename = Dir(folderPath &amp; \"*.xls*\")\nDo While Filename &lt;&gt; \"\" And Filename &lt;&gt; \"MattsTools.xlsm\"\n\n    ' Open work book? WHY WON'T IT ACTUALLY OPEN!?\n    Set wb = Workbooks.Open(folderPath &amp; Filename)\n\n    ' Wait for the workbook to open?\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n\n    ' Always start on the first worksheet\n    wb.Worksheets(\"FIRE EXT.\").Activate\n\n    ' Hit the AHK Script Hotkey to upgrade the template\n    SendKeys \"^%+u\"\n\n    ' Sleep for 7 seconds to wait for upgrade to finish\n    Application.Wait (Now + TimeValue(\"0:00:07\"))\n\n...'The Rest of my VBA Omitted...\n\n    ' Now print the sheet\n    ActiveSheet.PrintOut\n\n    ' Close and save the workbook\n    wb.Close True\n\n\n\nExit_Loop:\n    Set wb = Nothing\n    Filename = Dir\n\n' Next workbook\nLoop\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas on how to open this thing? I tried setting the Editable:=True but that didn't do anything. This is for a work project, so would love to get some input. Thanks!</p>\n"}, {"tags": ["vba", "forms", "ms-word", "textbox"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2266545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ff291dc62e086e9748b71c447f2cb1?s=128&d=identicon&r=PG", "display_name": "Song Chen", "link": "https://stackoverflow.com/users/2266545/song-chen"}, "edited": false, "score": 0, "creation_date": 1577066940, "post_id": 59449435, "comment_id": 105081628, "body": "thanks, macropod. I will try it later tonight. Does this macro automatically adjust the text sizes when there are too many characters in the text box without clicking any buttons or other triggers?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 15, "user_id": 2266545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ff291dc62e086e9748b71c447f2cb1?s=128&d=identicon&r=PG", "display_name": "Song Chen", "link": "https://stackoverflow.com/users/2266545/song-chen"}, "edited": false, "score": 0, "creation_date": 1577081440, "post_id": 59449435, "comment_id": 105083892, "body": "Not of itself - it&#39;s just a code loop that would form part of a larger sub. In any event, Word has no event-trapping that would automatically adjust the text size. The nearest you might get is something based on a WindowSelectionChange event, for which see: <a href=\"https://wordmvp.com/FAQs/MacrosVBA/AppClassEvents.htm\" rel=\"nofollow noreferrer\">wordmvp.com/FAQs/MacrosVBA/AppClassEvents.htm</a> and the demo code in <a href=\"https://wordmvp.com/FAQs/Customization/ProtectWord2000PlusHeader.htm\" rel=\"nofollow noreferrer\">wordmvp.com/FAQs/Customization/ProtectWord2000PlusHeader.htm</a>"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 1, "last_activity_date": 1577066779, "last_edit_date": 1577066779, "creation_date": 1577066309, "answer_id": 59449435, "question_id": 59448422, "link": "https://stackoverflow.com/questions/59448422/how-to-change-text-box-property-to-shrink-text-on-overflow/59449435#59449435", "title": "How to change text box property to &quot;shrink text on overflow&quot;?", "body": "<p>Word has no built-in functionality for that. Word table cells have a 'fit text' option, but that forces the content to all fit on one line in the cell rather than condensing it just enough to fit the vertical height.</p>\n\n<p>I wrote a macro for condensing text to eliminate minor line-wraps, which you can get from: <a href=\"https://www.msofficeforums.com/word-vba/40613-how-resize-paragraph-range-include-single-line.html\" rel=\"nofollow noreferrer\">https://www.msofficeforums.com/word-vba/40613-how-resize-paragraph-range-include-single-line.html</a>. That macro could be adapted to do something similar for just a selected/nominated textbox. If you require more condensing than to eliminate just a short last line, further mods would be needed. For example, you might incorporate something along the lines of:</p>\n\n<pre><code>With Selection.ShapeRange.TextFrame\n  Do While .Overflowing = True\n    .TextRange.Font.Size = .TextRange.Font.Size - 0.5\n  Loop\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 2266545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ff291dc62e086e9748b71c447f2cb1?s=128&d=identicon&r=PG", "display_name": "Song Chen", "link": "https://stackoverflow.com/users/2266545/song-chen"}, "is_accepted": false, "score": 0, "last_activity_date": 1577076655, "creation_date": 1577076655, "answer_id": 59450288, "question_id": 59448422, "link": "https://stackoverflow.com/questions/59448422/how-to-change-text-box-property-to-shrink-text-on-overflow/59450288#59450288", "title": "How to change text box property to &quot;shrink text on overflow&quot;?", "body": "<p>I modified and came up with the following codes, but I don't know how to automatically trigger it when the text is changed within the textbox. Any suggestions? </p>\n\n<pre><code>With ActiveDocument.Shapes(\"Text Box 3\").TextFrame \nIf .Overflowing = msoTrue Then \nDo ActiveDocument.Shapes.Range(Array(\"Text Box 3\")).Select \nSelection.Font.Size = Selection.Font.Size - 1 \nLoop Until .Overflowing = msoFalse \nEnd If \nEnd With\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 2266545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ff291dc62e086e9748b71c447f2cb1?s=128&d=identicon&r=PG", "display_name": "Song Chen", "link": "https://stackoverflow.com/users/2266545/song-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1580602335, "creation_date": 1577053006, "last_edit_date": 1580602335, "question_id": 59448422, "link": "https://stackoverflow.com/questions/59448422/how-to-change-text-box-property-to-shrink-text-on-overflow", "title": "How to change text box property to &quot;shrink text on overflow&quot;?", "body": "<p>I am trying to automatically shrink the text in a textbox to a proper size, on overflow. </p>\n\n<p>There are similar functions for textboxes in PowerPoint and MS Publisher, but it is not in MS Word. I have searched the web and there are a lot of discussions on how to wrap text or to shrink the text to fit the width of a textbox.</p>\n\n<p>I want the text box to wrap multiple lines and shrink the text size only when it runs out of space in the text box.</p>\n"}, {"tags": ["arrays", "json", "vba", "nested"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4482523, "user_type": "registered", "profile_image": "https://graph.facebook.com/746975546/picture?type=large", "display_name": "Lynckmeister", "link": "https://stackoverflow.com/users/4482523/lynckmeister"}, "edited": false, "score": 0, "creation_date": 1577080794, "post_id": 59449332, "comment_id": 105083744, "body": "Ok that works thanks tim... But I had to use variant... anyway.. ;)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1577080895, "last_edit_date": 1577080895, "creation_date": 1577064489, "answer_id": 59449332, "question_id": 59448302, "link": "https://stackoverflow.com/questions/59448302/unable-to-loop-over-nested-array-in-json-in-excel-vba-using-jsonconverter-bas-fr/59449332#59449332", "title": "unable to loop over nested array in JSON in Excel VBA using JsonConverter.bas from Github", "body": "<pre><code>item(\"path\")\n</code></pre>\n\n<p>...is a Collection of strings, not a collection of objects</p>\n\n<pre><code>Dim itempath 'as variant\n\n'...\nFor Each itempath In item(\"path\") \n    ws.Cells(3 + i, 6) = itempath\nNext \n'...   \n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4482523, "user_type": "registered", "profile_image": "https://graph.facebook.com/746975546/picture?type=large", "display_name": "Lynckmeister", "link": "https://stackoverflow.com/users/4482523/lynckmeister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59449332, "answer_count": 1, "score": 0, "last_activity_date": 1577080895, "creation_date": 1577051663, "question_id": 59448302, "link": "https://stackoverflow.com/questions/59448302/unable-to-loop-over-nested-array-in-json-in-excel-vba-using-jsonconverter-bas-fr", "title": "unable to loop over nested array in JSON in Excel VBA using JsonConverter.bas from Github", "body": "<p>My JSON file looks like this: </p>\n\n<pre><code>    {\n   \"data\": [\n      {\n         \"id\": \"6003510075864\",\n         \"name\": \"Golf\",\n         \"audience_size\": 242637550,\n         \"path\": [\n            \"Interests\",\n            \"Sports and outdoors\",\n            \"Sports\",\n            \"Golf\"\n         ],\n         \"description\": \"\",\n         \"topic\": \"Sports and outdoors\"\n      },\n      {\n         \"id\": \"6003393973731\",\n         \"name\": \"Persian Gulf\",\n         \"audience_size\": 173453990,\n         \"path\": [\n            \"Interests\",\n            \"Additional Interests\",\n            \"Persian Gulf\"\n         ],\n         \"description\": null,\n         \"topic\": \"Hobbies and activities\"\n      },...\n</code></pre>\n\n<p>As you can see, there is a nested array \"path\" , with an unknown length. </p>\n\n<p>With this code im trying to access the section: </p>\n\n<pre><code> Dim hReq As Object, JSON As Object, item As Object, itempath As Object\n(...)\n    For Each item In JSON(\"data\")\n        ws.Cells(3 + i, 1) = item(\"id\")\n        ws.Cells(3 + i, 2) = item(\"name\")\n        ws.Cells(3 + i, 3) = item(\"audience_size\")\n        ws.Cells(3 + i, 4) = item(\"description\")\n        ws.Cells(3 + i, 5) = item(\"topic\")\n\n        For Each itempath In item(\"path\") ' &lt;&lt;&lt; in this line I get the error Object needed.. \n            ws.Cells(3 + i, 6) = itempath(\"0\")\n        Next          \n        i = i + 1    \n    Next\n</code></pre>\n\n<p>The 2nd For each statement gives me an error .. I dont know how to handle this nested array ... thanks for any ideas ....</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577051800, "post_id": 59448278, "comment_id": 105079258, "body": "Look for fuzzy match"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1577054869, "post_id": 59448278, "comment_id": 105079783, "body": "consider doing a find/replace for the common errors such as replace K413 with K4I3 etc you must know the common ones..."}, {"owner": {"reputation": 29, "user_id": 2574527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af776ba8863cfb1502173a0a0054311?s=128&d=identicon&r=PG", "display_name": "Vainucleo", "link": "https://stackoverflow.com/users/2574527/vainucleo"}, "edited": false, "score": 0, "creation_date": 1577056065, "post_id": 59448278, "comment_id": 105080012, "body": "Already tried several fuzzy match rules/formula/addons with no luck. Find/replace it&#39;s a blindspot cause there are too much combinations, it would take ages..."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1577056254, "post_id": 59448278, "comment_id": 105080050, "body": "These fuzzy match exercises are always a pain!  Check out the AddIn from the link below.  <a href=\"https://www.microsoft.com/en-ca/download/details.aspx?id=15011\" rel=\"nofollow noreferrer\">microsoft.com/en-ca/download/details.aspx?id=15011</a>  Hopefully that helps you get your stuff done!!"}, {"owner": {"reputation": 29, "user_id": 2574527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af776ba8863cfb1502173a0a0054311?s=128&d=identicon&r=PG", "display_name": "Vainucleo", "link": "https://stackoverflow.com/users/2574527/vainucleo"}, "edited": false, "score": 0, "creation_date": 1577098798, "post_id": 59448278, "comment_id": 105089812, "body": "Already tried also this addon, works great with misspelled real words, but not in my case with random characters in a code :("}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1577234917, "post_id": 59448278, "comment_id": 105127104, "body": "What rule will you use to ensure that the misspelling is acceptable?  In the examples you give, the two strings are different lengths, and, with regard to the shorter length, there are three character substitutions. But maybe some substitutions are OK ( eg <code>{i,I,1}</code>, <code>{0,O}</code>, and some are not <code>{x,A,4}</code>.  And what about the different string lengths?  You&#39;ll need to define this before you can really start to come up with a method."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 2574527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af776ba8863cfb1502173a0a0054311?s=128&d=identicon&r=PG", "display_name": "Vainucleo", "link": "https://stackoverflow.com/users/2574527/vainucleo"}, "edited": false, "score": 0, "creation_date": 1577116043, "post_id": 59456332, "comment_id": 105097104, "body": "Not helping me :( This assumes I already have found a list of apparently suitable results and &quot;calculates&quot; the accuracy. I&#39;m a step back, I need to find the results. Since the codes are grabbed from a form, people may have mistaken and mistyped, but I don&#39;t know what and where the error is in each case..."}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 0, "last_activity_date": 1577108338, "creation_date": 1577108338, "answer_id": 59456332, "question_id": 59448278, "link": "https://stackoverflow.com/questions/59448278/how-to-make-partial-match-between-two-strings-with-mispelled-characters/59456332#59456332", "title": "How to make partial match between two strings with mispelled characters", "body": "<p>Maybe this will help (array formula - <code>Ctrl+Shift+Enter</code>):</p>\n\n<pre><code>=SUMPRODUCT(--ISNUMBER(MATCH(MID($B$2,ROW($A$1:$A$12),1),MID($B$1,ROW($A$1:$A$12),1),0)))\n</code></pre>\n\n<p>The formula will check each character, one by one, and compare it against the \"original\"/\"exact\" code. In your example the result would be 7, as seven characters are matched exactly:</p>\n\n<pre><code>K 4 - 3 T 9 - T G -\n{1;1;0;1;1;1;0;1;1;0;0;0}\n</code></pre>\n\n<p>Here's the full picture:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mIwaZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mIwaZ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 29, "user_id": 2574527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af776ba8863cfb1502173a0a0054311?s=128&d=identicon&r=PG", "display_name": "Vainucleo", "link": "https://stackoverflow.com/users/2574527/vainucleo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584938722, "creation_date": 1577051353, "last_edit_date": 1584938722, "question_id": 59448278, "link": "https://stackoverflow.com/questions/59448278/how-to-make-partial-match-between-two-strings-with-mispelled-characters", "title": "How to make partial match between two strings with mispelled characters", "body": "<p>I have a list of 12 digit alphanumeric codes and I need to match against a list of entries where codes might be misspelled.</p>\n\n<p>For example, if the exact code is \"K4I3T9OTG9GZ\" the entry I have to check might be \"K413T90TGS\" (<code>1</code> instead of capital <code>I</code>, <code>0</code> instead of capital <code>O</code>, <code>S</code> instead of <code>Z</code>).</p>\n\n<p>I need to do a partial match to be able to find the right code.</p>\n\n<p>Any ideas?</p>\n\n<p>I already tried <code>VLOOKUP</code> with wildcards which worked for most entries with at least five consecutive right characters, but I still have a couple of hundred entries with no match.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577051361, "post_id": 59448229, "comment_id": 105079156, "body": "For only the first 10 rows? or all rows in the spreadsheet? And just looking at your example, maybe it would also work to delete the rows that have a date in the first cell?"}, {"owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577051525, "post_id": 59448229, "comment_id": 105079194, "body": "I have 315 rows and I want to remove every 2nd in the order: 2,,4,6,8...etc. I just put first 10 into the code for the trial."}, {"owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577051864, "post_id": 59448229, "comment_id": 105079274, "body": "Yes the query, which you have shown me solved my problem :) Thank you very much"}], "owner": {"reputation": 728, "user_id": 6694814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06da9bcbd088ee23277f2b7494ba9daa?s=128&d=identicon&r=PG&f=1", "display_name": "MKR", "link": "https://stackoverflow.com/users/6694814/mkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "closed_date": 1577051880, "answer_count": 0, "score": 0, "last_activity_date": 1577051411, "creation_date": 1577050872, "last_edit_date": 1577051411, "question_id": 59448229, "link": "https://stackoverflow.com/questions/59448229/delete-every-other-row-in-excel", "closed_reason": "Duplicate", "title": "Delete every other row in Excel", "body": "<p>I would like to get rid of the every 2nd row in Excel.</p>\n\n<p>So far my sheet looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/L0BOi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L0BOi.png\" alt=\"enter image description here\"></a></p>\n\n<p>from where I would like to remove the rows with date.</p>\n\n<p>In this event I used the following code:</p>\n\n<pre><code>   Sub DeleteRows()\n   Rows(2, 4, 6, 8, 10).EntireRow.Delete\n   End Sub\n</code></pre>\n\n<p>as a trial for the first 10, although it returns the error: </p>\n\n<blockquote>\n  <p>Wrong number of arguments or invalid property assignment</p>\n</blockquote>\n\n<p>I found sth, which might help my issue:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/35042717/excel-vba-delete-rows\">Excel VBA Delete Rows</a></p>\n\n<p>basically I don't know how to make kinda loop for this.</p>\n\n<p>The issue here:\n<a href=\"https://stackoverflow.com/questions/2237873/how-to-get-the-size-of-a-range-in-excel\">How to get the size of a range in Excel</a></p>\n\n<p>States, that according to my error I should use the <code>Rows (2:10)</code> instead, however, I am going to lose all of them then.</p>\n\n<p>Is there some simple loop for removing only every 2nd row?</p>\n"}, {"tags": ["arrays", "excel", "vba", "user-defined-functions", "excel-addins"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577049232, "post_id": 59447998, "comment_id": 105078738, "body": "If working with a worksheet, just read the data into a <code>Variant</code> array."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577051185, "post_id": 59447998, "comment_id": 105079109, "body": "Check this post <a href=\"https://codereview.stackexchange.com/a/226296/197645\">codereview.stackexchange.com/a/226296/197645</a>"}], "owner": {"reputation": 33, "user_id": 5747923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688c1248f08e877d8f966593a481b498?s=128&d=identicon&r=PG&f=1", "display_name": "JHT", "link": "https://stackoverflow.com/users/5747923/jht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577094213, "creation_date": 1577048510, "last_edit_date": 1577094213, "question_id": 59447998, "link": "https://stackoverflow.com/questions/59447998/most-efficient-method-of-importing-values-into-an-array-in-an-excel-add-in", "title": "Most efficient method of importing values into an array in an Excel Add-In", "body": "<p>I work on an Excel Add-In that has a ton of UDF functions built in and it also has a massive array that gets loaded automatically when you open Excel.  It loads over 25,000 values into a massive array.  This happens in code where we hard-code these numbers.  This has worked great for years, but the main issue is we frequently need to add new values and the only way to do it is for everyone in the company to be out of Excel while I update.  </p>\n\n<p>I would like to move all of these values into a spreadsheet, Access table, or some other option depending on suggestions given, then link to it and load the array when you first open Excel.  However, I'm very concerned that something like this would introduce much longer load times for all of our users.</p>\n\n<p>Does anyone have any suggestions on the best way to get these values loaded into the Excel Add-In and also allow me to add new values without introducing a lot of extra load time?</p>\n\n<p>I realize some people may ask for more detail, but the question has to do with loading numbers.  These are unique numbers which can't be otherwise derived, and all subsequent UDFs built into the Add-In require these numbers to function properly.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 1, "last_activity_date": 1577061845, "last_edit_date": 1577061845, "creation_date": 1577046905, "answer_id": 59447854, "question_id": 59447694, "link": "https://stackoverflow.com/questions/59447694/how-to-search-for-a-specific-number-in-a-string/59447854#59447854", "title": "How to search for a specific number in a string?", "body": "<p>There are many ways to do this, but here is one. It takes the filename and converts it to a date. What you do with that date for comparison is up to you.</p>\n\n<pre><code>Function GetDateFromFilename(sFilename As String) As Date\n  Dim sFullDate As String\n  Dim sDay As String\n  Dim sNum As String\n  Dim nDig As Integer: nDig = 1\n\n  ' get rid of the extension just in case it exists\n  sFilename = Split(sFilename, \".\")(0)\n\n  ' get just the date part for processing\n  If Instr(sFilename, \" - \") = 0 Then\n    Msgbox \"Filename not in proper format\"\n    GetDateFromFilename = CDate(\"1/1/1990\")\n    Exit Function\n  End If\n  sFullDate = Split(sFilename, \" - \")(1)\n\n  ' get the first digit of that\n  sNum = Left$(sFullDate, nDig)\n\n  ' loop thru the characters until there is an alpha character\n  Do While nDig &lt;= Len(sFullDate)\n    If IsNumeric(sNum) Then\n      sDay = sDay &amp; sNum\n    Else\n      ' found the first alpha, so we are done here\n      Exit Do\n    End If\n    ' check the next character\n    nDig = nDig + 1\n    sNum = Mid$(sFullDate, nDig, 1)\n  Loop\n\n  ' build a string that correctly resembles a date (month first)\n  sFullDate = Split(sFullDate)(1) &amp; \" \" &amp; sDay &amp; \" \" &amp; Split(sFullDate)(2)\n\n  ' or build a string that correctly resembles a date (day first)\n  ' sFullDate = sDay &amp; \" \" &amp; Split(sFullDate)(1) &amp; \" \" &amp; Split(sFullDate)(2)\n\n  ' convert it to an actual date and return it\n  GetDateFromFilename = CDate(sFullDate)\n\nEnd Function\n</code></pre>\n\n<p><strong>Usage:</strong></p>\n\n<pre><code>Dim dtFileDate As Date\ndtFileDate = GetDateFromFilename(\"Daily Operations Report - 21st December 2019\")\n' show just the day number\nMsgBox Format$(dtFileDate, \"d\")\n</code></pre>\n\n<p><sub><strong>Note:</strong> If your filename string is not in this exact format, there is a good chance it will error, but your question implies it will <strong>always</strong> be in that format.</sub></p>\n"}], "owner": {"reputation": 15, "user_id": 10916151, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v8sI2fgK3V8/AAAAAAAAAAI/AAAAAAAAAOI/Sv8oTy9yiw0/photo.jpg?sz=128", "display_name": "AlKhaldi Badr", "link": "https://stackoverflow.com/users/10916151/alkhaldi-badr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 59447854, "answer_count": 1, "score": 0, "last_activity_date": 1580312314, "creation_date": 1577045186, "last_edit_date": 1580312314, "question_id": 59447694, "link": "https://stackoverflow.com/questions/59447694/how-to-search-for-a-specific-number-in-a-string", "title": "How to search for a specific number in a string?", "body": "<p>I have a code that prompts the user to find a specific file on their computer. The files are named like this \"<strong>Daily Operations Report - DAY MONTH YEAR</strong>\".</p>\n\n<p>I need to make sure that the file chosen has the same date as today. I know how to compare two dates and find if they are equal or not.</p>\n\n<p>How do I find a number in a string?</p>\n\n<pre><code>'Previous code not relevant to the question\n\nDim strFilePath, fName As String\nDim wdDoc As Object\n\nstrFilePath = Application.GetOpenFilename\n    If strFilePath = \"False\" Then End  'Pressed cancel\n\nfName = strFilePath\n\nSet wdDoc = GetObject(fName)\n</code></pre>\n\n<p>After executing the above code, I can find the name of the file in (wdDoc), for example: </p>\n\n<pre><code> MsgBox wdDoc\n</code></pre>\n\n<p>I get:</p>\n\n<blockquote>\n  <p>Daily Operations Report - 21st December 2019</p>\n</blockquote>\n\n<p>How can I compare the file to today's date? I believe comparing the number of days would be easier and faster than comparing days, months and years for the two dates.</p>\n"}, {"tags": ["vba", "text"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577211857, "post_id": 59447054, "comment_id": 105123043, "body": "Your solution does not work. Below a snap of how my files (for example) can start:      <a href=\"https://i.stack.imgur.com/hde9s.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/hde9s.png</a>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577212748, "post_id": 59447054, "comment_id": 105123262, "body": "To be honest, saying it does not work is not really helpful. I told you you need to implement some kind of <a href=\"https://excelmacromastery.com/vba-error-handling/\" rel=\"nofollow noreferrer\">error handling</a>. Anyway, according to your image I do not see any reason that my extra loop should fail unless you have some certain white spaces at the beginning of the file which no one can see on a picture. But you should know better than me if you have for example a tabulator character or sth. like that  at the beginning of your file."}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577215843, "post_id": 59447054, "comment_id": 105124057, "body": "Sometimes it can be indeed a tabulator (or more) and spaces."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577216727, "post_id": 59447054, "comment_id": 105124224, "body": "I modified the code a little bit but this might not be the modification you need as it will also remove the white spaces from the textline you will use at the end to rename the file. This can also be fixed, of course."}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577217153, "post_id": 59447054, "comment_id": 105124310, "body": "The public function fails, it doesn&#39;t seem to recognize New RegExp. Datatype is not recognized, the system says."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577217304, "post_id": 59447054, "comment_id": 105124343, "body": "Please read the code! There is a comment what you need to do beforehand. <b><code>Add a reference to Microsoft VBScript Regular Expressions 5.5</code></b>"}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577217702, "post_id": 59447054, "comment_id": 105124426, "body": "sorry...now it works. Only as you mentioned now my titles are also without spaces. Do  you have a solution for this. Again sorry for my lack of knowledge and maybe stupid questions..."}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577263715, "post_id": 59447054, "comment_id": 105130891, "body": "You only edited the main code right? Because there i now get an error &quot;Byref arguments do not match&quot;."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577264552, "post_id": 59447054, "comment_id": 105131063, "body": "Right, sorry. Also adjusted the function."}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577264755, "post_id": 59447054, "comment_id": 105131105, "body": "Awesome, your the best!! Merry x-mas"}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577278110, "post_id": 59447054, "comment_id": 105134043, "body": "After a 198 txt files, the procedures crashes and mentions &quot;Invalid procedure call or argument (Error 5)&quot;, is there a solution to bypass this error?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577279980, "post_id": 59447054, "comment_id": 105134500, "body": "Which line? What are the values of the variables? I strongly guess it&#39;s the line <code>fil.Name = Trim(TextLine) &amp; &quot;.txt&quot;</code> and the reason is that <code>textline</code> is not a valid filename."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577280366, "post_id": 59447054, "comment_id": 105134607, "body": "I mentioned that you need to implement error handling for that."}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577280590, "post_id": 59447054, "comment_id": 105134665, "body": "Yes indeed that&#39;s where it goes wrong, but how can i handle this error?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577281043, "post_id": 59447054, "comment_id": 105134789, "body": "Either error handling or as I did add code to check for this kind of problem. The next issue now might be that a file already exists! I&#39;d suggest that you try to fix that on your own and if you get stuck create a new post. Otherwise this will end as spoon feeding. You need to try for yourself otherwise you will not learn anything."}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577284648, "post_id": 59447054, "comment_id": 105135658, "body": "Ok, but the code still seems to fail. Could it help the code with the parameter when a letter is found that is the start of the title and that it should Always cutoff after the word transcript?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577286986, "post_id": 59447054, "comment_id": 105136149, "body": "Try to implement some erro handling because I do not know what should happen in case of an error. I modified the code for that part with &quot;brutal&quot; force."}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "edited": false, "score": 0, "creation_date": 1577536348, "post_id": 59447054, "comment_id": 105193641, "body": "Hi i changed a bit of the code, but i would like the files which are seen as double to be skipped:"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1577286976, "last_edit_date": 1577286976, "creation_date": 1577039742, "answer_id": 59447054, "question_id": 59446925, "link": "https://stackoverflow.com/questions/59446925/rename-text-file-based-on-first-line-of-text/59447054#59447054", "title": "Rename text file based on first line of text", "body": "<p>You could add another loop to your code like that</p>\n\n<pre><code>Sub RenameTextFile()\n\n\n    Const ForReading = 1, ForWriting = 2, ForAppending = 8\n    Dim fso, MyFile, FileName, TextLine\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    Set fol = fso.GetFolder(\"d:\\tmp\\\")\n\n    For Each fil In fol.Files\n\n        FileName = fil\n\n        Set MyFile = fso.OpenTextFile(FileName, ForReading)\n\n        Do While MyFile.AtEndOfStream &lt;&gt; True\n\n            Do\n                Dim tmpLine As String\n                TextLine = MyFile.ReadLine\n                tmpLine = removeWhiteSpace(TextLine)\n                If Len(tmpLine) = 0 Then\n                    TextLine = tmpLine\n                End If\n            Loop Until Len(TextLine) &gt; 0\n            MyFile.Close\n\n            If isValidFilename(Trim(TextLine)) Then\n                On Error Resume Next\n                fil.Name = Trim(TextLine) &amp; \".txt\"\n                On Error Goto 0\n            Else\n                MsgBox \"Renaming: \" &amp; fil.Name &amp; \" -to- \" &amp; Trim(TextLine) &amp; \" failed\", vbCritical + vbOKOnly, \"Invalid Filename\"\n            End If\n\n            Exit Do\n\n        Loop\n\n        MyFile.Close\n    Next fil\nEnd Sub\n</code></pre>\n\n<p>On the long run you need to think about kind of error handling as a file with the same name might already exist. And my extra loop will also fail in case one of the files only contains empty lines.</p>\n\n<p><strong>Update</strong> By the OP's comment I strongly guess that some of the files contain white spaces at the beginning and the OP is not aware of that. One can use the following function (taken from <a href=\"https://stackoverflow.com/a/42306511/6600940\">here</a>) to remove these</p>\n\n<pre><code>'Add a reference to Microsoft VBScript Regular Expressions 5.5\nPublic Function RemoveWhiteSpace(ByVal target As String) As String\n    With New RegExp\n        .Pattern = \"\\s\"\n        .MultiLine = True\n        .Global = True\n        RemoveWhiteSpace = .Replace(target, vbNullString)\n    End With\nEnd Function\n</code></pre>\n\n<p>This will remove also white spaces from textline even if you want to keep them as the empty spaces in the line of your picture. </p>\n\n<p><strong>Update 2</strong>: In order to avoid invalid filename add the following function </p>\n\n<pre><code>Function isValidFilename(ByVal FileName As String) As Boolean\n'PURPOSE: Determine If A Given Excel File Name Is Valid\n'SOURCE: www.TheSpreadsheetGuru.com/the-code-vault\n\n  With New RegExp\n    .Pattern = \"[\\\\/:\\*\\?\"\"&lt;&gt;\\|\\[\\]]\"\n    ValidFileName = Not .Test(FileName)\n  End With\n\nEnd Function\n</code></pre>\n\n<p>I modified the main procedure.</p>\n"}], "owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 59447054, "answer_count": 1, "score": 0, "last_activity_date": 1580710558, "creation_date": 1577038802, "last_edit_date": 1580710558, "question_id": 59446925, "link": "https://stackoverflow.com/questions/59446925/rename-text-file-based-on-first-line-of-text", "title": "Rename text file based on first line of text", "body": "<p>I have a list of text files (all different names.txt, but small files).</p>\n\n<p>I want to rename them based on the first line of text in the file.</p>\n\n<p>Some files have a few enters before the text. So the code returns with a (blank).txt.</p>\n\n<pre><code>Sub RenameTextFile()\n\n    Const SpecialCharacters As String = \"\\,/,:,*,?,&lt;,&gt;,|,\"\",\" ' Modify this as neccesary\n    Const ForReading = 1, ForWriting = 2, ForAppending = 8\n    Dim fso, MyFile, FileName, TextLine\n    Dim char As Variant\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    Set fol = fso.GetFolder(\"C:\\Research syntheses - Meta analysis\\Txt files ECS\\out\\\")\n\n    For Each fil In fol.Files\n\n        FileName = fil\n\n        Set MyFile = fso.OpenTextFile(FileName, ForReading)\n\n        Do While MyFile.AtEndOfStream &lt;&gt; True\n\n            Do\n                Dim tmpLine As String\n                TextLine = MyFile.ReadLine\n                tmpLine = RemoveWhiteSpace(TextLine)\n                If Len(tmpLine) = 0 Then\n                    TextLine = tmpLine\n                End If\n            Loop Until Len(TextLine) &gt; 0\n            MyFile.Close\n\n            For Each char In Split(SpecialCharacters, \",\")\n                TextLine = Replace(TextLine, char, \"\")\n            Next\n\n            fil.Name = TextLine &amp; \".txt\"\n            Exit Do\n\n        Loop\n\n        MyFile.Close\n    Next fil\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 4, "creation_date": 1577030377, "post_id": 59445784, "comment_id": 105074245, "body": "Learn to use parameters.  Don&#39;t munge query strings with constant values."}, {"owner": {"reputation": 19, "user_id": 12569770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa1bf7179372850c942c26c85fcf647e?s=128&d=identicon&r=PG&f=1", "display_name": "Cam ", "link": "https://stackoverflow.com/users/12569770/cam"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1577034625, "post_id": 59445784, "comment_id": 105075457, "body": "Just starting out and will expand my knowledge base, just trying to get the thing to work at this point."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 12569770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa1bf7179372850c942c26c85fcf647e?s=128&d=identicon&r=PG&f=1", "display_name": "Cam ", "link": "https://stackoverflow.com/users/12569770/cam"}, "edited": false, "score": 0, "creation_date": 1577034657, "post_id": 59445825, "comment_id": 105075470, "body": "And that fixed it. Thank you so much.  And now time to learn about prepared statements."}], "tags": [], "owner": {"reputation": 186087, "user_id": 575376, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LnDUq.gif?s=128&g=1", "display_name": "juergen d", "link": "https://stackoverflow.com/users/575376/juergen-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1577030660, "creation_date": 1577030660, "answer_id": 59445825, "question_id": 59445784, "link": "https://stackoverflow.com/questions/59445784/insert-into-statement-not-working-error-3134/59445825#59445825", "title": "INSERT INTO statement not working error 3134", "body": "<p>Remove the comma</p>\n\n<pre><code> ... strStartTime, strStopTime, ) ...\n                              ^---------------here\n</code></pre>\n\n<p>and please look up on how to use prepared statements. Don't patch your queries together like this.</p>\n"}], "owner": {"reputation": 19, "user_id": 12569770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa1bf7179372850c942c26c85fcf647e?s=128&d=identicon&r=PG&f=1", "display_name": "Cam ", "link": "https://stackoverflow.com/users/12569770/cam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1577034352, "answer_count": 1, "score": -3, "last_activity_date": 1577030660, "creation_date": 1577030343, "question_id": 59445784, "link": "https://stackoverflow.com/questions/59445784/insert-into-statement-not-working-error-3134", "closed_reason": "Needs more focus", "title": "INSERT INTO statement not working error 3134", "body": "<p>Currently trying to get my add button to work.  I'm trying to insert into a table and I'm getting a Run-Time error '3134.  I've watched several youtube videos and searched here.  Not sure why its erroring out.  There are no prime keys associated with this table.</p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO tblMemberRecords (strLastName, strTimeType, strCrewPosition, strStartTime, strStopTime, ) \" &amp; _\n    \" VALUES ('\" &amp; Me.cboLastName &amp; \"','\" &amp; Me.cboTimeType &amp; \"','\" &amp; Me.strCrewPosition &amp; \"','\" &amp; Me.strStartTime &amp; \"','\" &amp; Me.strStopTime &amp; \"')\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "rowcount"], "comments": [{"owner": {"reputation": 5325, "user_id": 212215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9df482401604bfc6bd38dc809d3b2823?s=128&d=identicon&r=PG", "display_name": "vicatcu", "link": "https://stackoverflow.com/users/212215/vicatcu"}, "edited": false, "score": 1, "creation_date": 1577030479, "post_id": 59445773, "comment_id": 105074277, "body": "did you know you can put breakpoints in VBA? Learning to do that will pay massive dividends to you in the long run."}], "answers": [{"comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1577050704, "post_id": 59448162, "comment_id": 105079006, "body": "I made a <code>funtion</code> similiar to this with 2 input <code>parameters</code>, being, <code>worksheet</code> &amp; <code>type of row</code> which equals last used row or first blank row. Persoanlly I think it makes code a lot neater."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1577051240, "last_edit_date": 1577051240, "creation_date": 1577050102, "answer_id": 59448162, "question_id": 59445773, "link": "https://stackoverflow.com/questions/59445773/generic-function-to-get-row-count-in-worksheet/59448162#59448162", "title": "Generic function to get row count in worksheet", "body": "<p>You are getting your worksheet object and worksheet names mixed up, your function return type should be Long, and your <code>.Range</code> doesn't refer back to anything.</p>\n\n<p>Just do this:</p>\n\n<pre><code>Function getRowCount(ws As Worksheet) As Long\n  getRowCount = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p>An alternative would be this:</p>\n\n<pre><code>Function getRowCount(ws As Worksheet) As Long\n  With ws  \n    getRowCount = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n  End With\nEnd Function\n</code></pre>\n\n<p>You can also make it generic to optionally include which column you are using:</p>\n\n<pre><code>Function getRowCount(ws As Worksheet, Optional sCol as String = \"A\") As Long\n  getRowCount = ws.Range(sCol &amp; ws.Rows.Count).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p><sub>Not really sure why you would need to make such a simple one line code a function, but there you go.</sub></p>\n"}], "owner": {"reputation": 11, "user_id": 12580460, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2FX9bDW7D9w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd36VjDl7hpVlfVeL8xw1TEsPejNw/photo.jpg?sz=128", "display_name": "Pranav Gandhi", "link": "https://stackoverflow.com/users/12580460/pranav-gandhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577051240, "creation_date": 1577030235, "last_edit_date": 1577050228, "question_id": 59445773, "link": "https://stackoverflow.com/questions/59445773/generic-function-to-get-row-count-in-worksheet", "title": "Generic function to get row count in worksheet", "body": "<p>I want to write a generic function where I can pass a worksheet and it can return the row count in that worksheet. I am getting a type mismatch error</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public numberofRowsinWorksheet As Integer\n\nSub Routine1()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Sheets(\"Worksheet Name\")\n    numberofRowsinWorksheet = getRowCount(ws)\n    MsgBox (numberofRowsinWorsheet)\nEnd Sub\n\nFunction getRowCount(sheetName As Worksheet) As Integer\n        Dim getNumberofRows As Integer\n        getNumberofRows = .Range(\"A2\", Worksheets(sheetName).Range(\"A2\").End(xlDown)).Rows.Count\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "edited": false, "score": 0, "creation_date": 1577029018, "post_id": 59445508, "comment_id": 105073840, "body": "What is the data type of <code>C</code>?"}, {"owner": {"reputation": 81, "user_id": 10310153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d893e4261562850571f9b11d2b8d6115?s=128&d=identicon&r=PG&f=1", "display_name": "tryer", "link": "https://stackoverflow.com/users/10310153/tryer"}, "reply_to_user": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "edited": false, "score": 0, "creation_date": 1577029074, "post_id": 59445508, "comment_id": 105073856, "body": "Data type C is integer"}, {"owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "edited": false, "score": 2, "creation_date": 1577029159, "post_id": 59445508, "comment_id": 105073878, "body": "You should use single quotes only for strings and not for numeric data types."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 10310153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d893e4261562850571f9b11d2b8d6115?s=128&d=identicon&r=PG&f=1", "display_name": "tryer", "link": "https://stackoverflow.com/users/10310153/tryer"}, "edited": false, "score": 0, "creation_date": 1577042859, "post_id": 59446457, "comment_id": 105077377, "body": "Thank you for such a detailed response, I should of know better. Doh!. Many thanks"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 3, "last_activity_date": 1577035279, "creation_date": 1577035279, "answer_id": 59446457, "question_id": 59445508, "link": "https://stackoverflow.com/questions/59445508/back-to-basics-with-dcount/59446457#59446457", "title": "Back to basics with DCOUNT", "body": "<blockquote>\n  <p>I'd still like to know why my original method didn't work</p>\n</blockquote>\n\n<p>In your original code, you were using:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DCount(\"F\", \"tbl_1\", \"C = '\" &amp; .Acc &amp; \"'\")\n</code></pre>\n\n<p>You stated that the field <code>C</code> is of <strong>integer</strong> data type, and therefore I would assume that <code>.Acc</code> also returns an integer value.</p>\n\n<p>Therefore, if <code>.Acc</code> were to return <code>1</code>, the criteria expression would be evaluated as :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DCount(\"F\", \"tbl_1\", \"C = '1'\")\n</code></pre>\n\n<p>Which is the equivalent to the following SQL statement:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select count(F) from tbl_1 where C = '1'\n</code></pre>\n\n<p>Since the field <code>C</code> is of <strong>integer</strong> data type, and the <code>where</code> clause is being supplied with the <strong>string</strong> <code>'1'</code>, this will result in the error:</p>\n\n<blockquote>\n  <p>Data Type mismatch in criteria expression.</p>\n</blockquote>\n\n<hr>\n\n<p>In the revised code, the <code>DCount</code> expression would be evaluated as:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DCount(\"F\", \"tbl_1\", \"C = 1\")\n</code></pre>\n\n<p>Which is the equivalent to a SQL statement such as:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select count(F) from tbl_1 where C = 1\n</code></pre>\n\n<p>Correctly supplying the field <code>C</code> within the <code>where</code> clause with an <strong>integer</strong> value.</p>\n"}], "owner": {"reputation": 81, "user_id": 10310153, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d893e4261562850571f9b11d2b8d6115?s=128&d=identicon&r=PG&f=1", "display_name": "tryer", "link": "https://stackoverflow.com/users/10310153/tryer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 59446457, "answer_count": 1, "score": 1, "last_activity_date": 1593675508, "creation_date": 1577028167, "last_edit_date": 1593675508, "question_id": 59445508, "link": "https://stackoverflow.com/questions/59445508/back-to-basics-with-dcount", "title": "Back to basics with DCOUNT", "body": "<p>Trying to work out where am messing up here:</p>\n\n<pre><code>Dim Count AS string\nCount = DCount(\"F\", \"tbl_1\", \"C = '\" &amp; .Acc &amp; \"'\")\n</code></pre>\n\n<p>The problem is with the criteria part of the count, Ive tested without the criteria and it works fine.</p>\n\n<p>Anything jump out to anyone?</p>\n\n<p>The error received:</p>\n\n<blockquote>\n  <p>Data Type mismatch in criteria expression</p>\n</blockquote>\n\n<p>** UPDATE **\nI've since discovered this works fine, but id still like to know why my original method didn't work</p>\n\n<pre><code>count = DCount(\"F\", \"tbl_1\", \"C =\" &amp; .Acc)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577032787, "post_id": 59445449, "comment_id": 105074904, "body": "Use <code>Find</code> to catch which cell you need to change."}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1577035439, "last_edit_date": 1577035439, "creation_date": 1577035014, "answer_id": 59446425, "question_id": 59445449, "link": "https://stackoverflow.com/questions/59445449/how-to-click-a-button-and-pass-arguments-tied-with-no-variable/59446425#59446425", "title": "How to click a button and pass arguments tied with NO. variable", "body": "<p>As per my comment, use <code>Find</code> to catch which cells you need to update. Utilize the <code>Application.Caller</code> to see what <code>Text</code> you are looking for.</p>\n\n<p>Assign the following to all your three buttons/shapes:</p>\n\n<pre><code>Sub Test()\n\nDim ws1 As Worksheet: Set ws1 = ThisWorkbook.Worksheets(\"db1\")\nDim ws2 As Worksheet: Set ws2 = ThisWorkbook.Worksheets(\"db2\")\n\nWith ws2 'Change accordingly\n    Dim rw As Long: rw = .Range(\"B2:B4\").Find(ws1.Shapes(Application.Caller).TextFrame.Characters.Text).Row\n    .Cells(rw, 3).Value = .Cells(rw, 3).Value + 1\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 7575911, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/03df598745bc31e3f70dcb0dcbf7ea51?s=128&d=identicon&r=PG&f=1", "display_name": "changjx", "link": "https://stackoverflow.com/users/7575911/changjx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 59446425, "answer_count": 1, "score": 0, "last_activity_date": 1577035439, "creation_date": 1577027638, "last_edit_date": 1577032794, "question_id": 59445449, "link": "https://stackoverflow.com/questions/59445449/how-to-click-a-button-and-pass-arguments-tied-with-no-variable", "title": "How to click a button and pass arguments tied with NO. variable", "body": "<p>I want to create a button to my excel worksheet db1 that can add one agument (an integer value) in worksheet db2. \nthe code is like</p>\n\n<pre><code>Sub Button1_Click()\nSheets(\"db2\").Range(\"c2\").Value = Sheets(\"db2\").Range(\"c2\").Value + 1\nSheets(\"db1\").Range(\"a2\").Value = Sheets(\"db1\").Range(\"a2\").Value + 1\nEnd Sub\n</code></pre>\n\n<p>the function is \nclick  MS button in worksheet db1, then  cell c2 increase 1 in worksheet db2\n<a href=\"https://i.stack.imgur.com/0E82H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0E82H.png\" alt=\"enter image description here\"></a>\nbecause of auto sorting in worksheet db2, the MS button and cell c2 relation may change.</p>\n\n<p>if there is anyway to realize click button1_click  it will 1 value right 2 cell  if it match No.=1 \nand \n<p>\nclick button2_click  it will 1 value right 2 cell  if it match No.=2\nand\n<p>\nclick button3_click  it will 1 value right 2 cell  if it match No.=3\netc...</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1577038815, "last_edit_date": 1577038815, "creation_date": 1577035919, "answer_id": 59446544, "question_id": 59445317, "link": "https://stackoverflow.com/questions/59445317/counting-rows-upwards-from-designated-cell/59446544#59446544", "title": "Counting rows upwards from designated cell", "body": "<p>Try to work with <code>Range.Areas</code> after you use <code>SpecialCells</code>. Something along these lines:</p>\n\n<pre><code>Sub Test()\n\nDim lr As Long\nDim rng As Range\n\nWith ThisWorkbook.Sheets(\"Sheet1\")\n\n    'Get a full range of where your tables sit.\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    Set rng = .Range(\"A1:A\" &amp; lr).SpecialCells(xlCellTypeConstants)\n\n    'Loop through all different tables\n    For Each Area In rng.Areas\n        Debug.Print Area.Cells(1, 1).Value &amp; \" has \" &amp; Area.Rows.Count - 1 &amp; \" rows of data.\"\n    Next Area\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1577037651, "creation_date": 1577037651, "answer_id": 59446783, "question_id": 59445317, "link": "https://stackoverflow.com/questions/59445317/counting-rows-upwards-from-designated-cell/59446783#59446783", "title": "Counting rows upwards from designated cell", "body": "<pre><code>Sub FFF()\n    Dim rng, cell\n    Set cell = Cells(Rows.Count, 1).End(xlUp) '//Start cell\n    Do\n        Set rng = cell.CurrentRegion\n        MsgBox \"The count of cells in table \" &amp; rng.Address &amp; \" is: \" &amp; rng.Cells.Count\n        Set cell = rng(1).End(xlUp)\n    Loop Until cell.Row = 1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12579824, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user549534", "link": "https://stackoverflow.com/users/12579824/user549534"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1577050306, "creation_date": 1577026606, "last_edit_date": 1577050306, "question_id": 59445317, "link": "https://stackoverflow.com/questions/59445317/counting-rows-upwards-from-designated-cell", "title": "Counting rows upwards from designated cell", "body": "<p>I am fairly weak at VBA. \nI am trying to find the rows count of table 1 and table 2 in the pic.</p>\n\n<p><img src=\"https://i.stack.imgur.com/qbwbS.png\" alt=\"Trying to find no. of rows count in table 1 and 2\"><Br></p>\n\n<p><br>I tried to count the rows upwards(working backwards) from Cell <code>A12</code> in the following VBA code, </p>\n\n<pre><code>LastRow=sheet(\"Sheet1\").Range(\"A12\").end(xlUp).row\n</code></pre>\n\n<p>But it doesn't seem to work. <br><br><code>Cells(Rows.Count, 1).End(xlUp).Row</code> will count rows up to <code>table2</code>; hence doesn't work. \n<BR><br>Do you have a better idea/code to count Table 1 and Table 2? \nThanks!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 0, "creation_date": 1577028477, "post_id": 59445442, "comment_id": 105073691, "body": "I used collection because I need many key-value pairs created dynamically from excel data. AFAIK you can&#39;t do it with classes. I did not mention it because my answer is lenghty enough already, sorry."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 0, "creation_date": 1577029162, "post_id": 59445442, "comment_id": 105073879, "body": "But this should give you anyway a hint how to access the dictionary in the collection, right?"}, {"owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 0, "creation_date": 1577030015, "post_id": 59445442, "comment_id": 105074126, "body": "I declared the public collection within the userform and populated it from &quot;outside&quot; and it works. Not sure if I can realise more secure approach with collections. I guess it answers my question then."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 0, "creation_date": 1577030263, "post_id": 59445442, "comment_id": 105074206, "body": "You could also just return the index of the selected entry."}, {"owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 0, "creation_date": 1577030837, "post_id": 59445442, "comment_id": 105074378, "body": "Excuse me, but how can I return it (to the main module I assume) if it&#39;s initiated by a <code>_click</code> event within the form?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 1, "creation_date": 1577032434, "post_id": 59445442, "comment_id": 105074811, "body": "You could hide the form, do whatever you want to do in the main module and return to the form again. But as I do not really know what are your requirements are it&#39;s probably best to pass the collection to the form."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 2, "last_activity_date": 1577029491, "last_edit_date": 1577029491, "creation_date": 1577027589, "answer_id": 59445442, "question_id": 59445235, "link": "https://stackoverflow.com/questions/59445235/what-is-the-best-way-of-acessing-a-collection-from-userform-in-this-case/59445442#59445442", "title": "What is the best way of acessing a collection from userform in this case?", "body": "<p>Not sure if this is the best way because I do not know why you need a collection of dicitonaries. I would use a simple class instead, for your purposes you might want to  add <em>setters</em> and <em>getters</em>. I named the class <code>clsfood</code>.</p>\n\n<pre><code>Option Explicit\n\nPublic myName As String\nPublic mycolor As String\n</code></pre>\n\n<p>I changed the code in the userform like that</p>\n\n<pre><code>Option Explicit\nDim coll As Collection\nProperty Set foodColl(nCol As Collection)\n    Set coll = nCol\nEnd Property\n\nSub FillUserform() '(coll As Collection)\n    Dim Item As Variant\n\n    'erase previous items just to be sure\n    Me.CBBTest.Clear\n\n    'iterate through the collection to add names into the combobox\n    Dim i As Long\n    For i = 1 To coll.Count\n        Me.CBBTest.AddItem coll.Item(i).myName\n    Next\n\n    'Make the first item selected\n    Me.CBBTest.ListIndex = 0\n\nEnd Sub\n\nPrivate Sub btnShowColor_Click()\n    Debug.Print CBBTest.Value, CBBTest.ListIndex; coll.Item(CBBTest.ListIndex + 1).mycolor\nEnd Sub\n</code></pre>\n\n<p>And that is the code in the module</p>\n\n<pre><code>Option Explicit\n\nDim colFood As New Collection\n\nSub PopulateCollection()\n\n    Dim food As clsFood\n\n    Set food = New clsFood\n    food.myName = \"apple\"\n    food.mycolor = \"red\"\n    colFood.Add food\n\n    Set food = New clsFood\n    food.myName = \"banana\"\n    food.mycolor = \"yellow\"\n    colFood.Add food\n\n    Set food = New clsFood\n    food.myName = \"cucumber\"\n    food.mycolor = \"green\"\n    colFood.Add food\n\nEnd Sub\nSub RunUserForm()\n\n    PopulateCollection\n\n    'create an exemplar of the userform\n    Dim form1 As New UFTest\n\n    With form1\n\n        'pass the collection to the sub to populate the combobox\n        Set .foodColl = colFood\n        .FillUserform\n\n        'show the form\n        .Show\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Update</strong>: As a class is not the way you want/can follow I just changed your code like that</p>\n\n<p>Code in the module</p>\n\n<pre><code>Option Explicit\n\nDim food As New Collection\n\nSub PopulateCollection()\n\n    Dim dict1 As New Scripting.Dictionary\n    dict1.Add \"name\", \"apple\"\n    dict1.Add \"color\", \"red\"\n\n    Dim dict2 As New Scripting.Dictionary\n    dict2.Add \"name\", \"banana\"\n    dict2.Add \"color\", \"yellow\"\n\n    Dim dict3 As New Scripting.Dictionary\n    dict3.Add \"name\", \"cucumber\"\n    dict3.Add \"color\", \"green\"\n\n    food.Add dict1\n    food.Add dict2\n    food.Add dict3\n\nEnd Sub\nSub RunUserForm()\n\n    PopulateCollection\n\n    'create an exemplar of the userform\n    Dim form1 As New UFTest\n\n    With form1\n\n        'pass the collection to the sub to populate the combobox\n        Set .foodColl = food\n        .FillUserform\n\n        'show the form\n        .Show\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Code in the Userform</p>\n\n<pre><code>Option Explicit\nDim coll As Collection\nProperty Set foodColl(nCol As Collection)\n    Set coll = nCol\nEnd Property\n\nSub FillUserform() '(coll As Collection)\n    Dim Item As Variant\n\n    'erase previous items just to be sure\n    Me.CBBTest.Clear\n\n    'iterate through the collection to add names into the combobox\n    Dim i As Long\n    For i = 1 To coll.Count\n        Me.CBBTest.AddItem coll.Item(i).Item(\"name\")\n    Next\n\n    'Make the first item selected\n    Me.CBBTest.ListIndex = 0\n\nEnd Sub\n\nPrivate Sub btnShowColor_Click()\n    Debug.Print CBBTest.Value, CBBTest.ListIndex, coll.Item(CBBTest.ListIndex + 1).Item(\"color\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59445442, "answer_count": 1, "score": 0, "last_activity_date": 1581751276, "creation_date": 1577025994, "last_edit_date": 1581751276, "question_id": 59445235, "link": "https://stackoverflow.com/questions/59445235/what-is-the-best-way-of-acessing-a-collection-from-userform-in-this-case", "title": "What is the best way of acessing a collection from userform in this case?", "body": "<p>So, in my main module I have a collection <code>food</code> consisting of dictionaries. Each dictionary has <code>name</code> entry and <code>color</code> entry. The code populating the collection doesn't matter, but here it is:</p>\n\n<pre><code>Option Explicit\n\nDim food As New Collection\n\nSub PopulateCollection()\n\n    Dim dict1 As New Scripting.Dictionary\n    dict1.Add \"name\", \"apple\"\n    dict1.Add \"color\", \"red\"\n\n    Dim dict2 As New Scripting.Dictionary\n    dict2.Add \"name\", \"banana\"\n    dict2.Add \"color\", \"yellow\"\n\n    Dim dict3 As New Scripting.Dictionary\n    dict3.Add \"name\", \"cucumber\"\n    dict3.Add \"color\", \"green\"\n\n    food.Add dict1\n    food.Add dict2\n    food.Add dict3\n\nEnd Sub\n</code></pre>\n\n<p>I also have a userform <code>UFTest</code> with combobox <code>CBBTest</code> and the button <code>ButtonTest</code> like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sQfis.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sQfis.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>What I need:</strong> </p>\n\n<ol>\n<li><p>Populate the combobox with <code>name</code> entries from the collection so it\nhas the options: <code>apple</code>, <code>banana</code>, <code>cucumber</code>.</p></li>\n<li><p>Upon picking the food and clicking \"show color\" button, the userform\nshall return the corresponding color into <code>debug.print</code>.</p></li>\n</ol>\n\n<p>The code in the main module to run the userform:</p>\n\n<pre><code>Sub RunUserForm()\n\n    PopulateCollection\n\n    'create an exemplar of the userform\n    Dim form1 As New UFTest\n\n    'pass the collection to the sub to populate the combobox\n    form1.FillUserform food\n\n    'show the form\n    form1.Show\nEnd Sub\n</code></pre>\n\n<p>The <code>FillUserform</code> sub of the userform:</p>\n\n<pre><code>Option Explicit\n\nSub FillUserform(Coll As Collection)\n    Dim Item As Variant\n\n    'erase previous items just to be sure\n    Me.CBBTest.Clear\n\n    'iterate through the collection to add names into the combobox\n    For Each Item In Coll\n        Me.CBBTest.AddItem Item.Item(\"name\")\n    Next Item\n\n    'Make the first item selected\n    Me.CBBTest.ListIndex = 0\n\nEnd Sub\n</code></pre>\n\n<p>So, when <code>Sub ButtonTest_Click()</code> is fired, how do I refer back to the collection and invoke the <code>color</code> item? I could put all the code initializing the collection into the userform. It works, but it doesn't feel right. I also could declare the <code>food</code> collection as public, but people advice against the public variables and BTW the userform can't see it anyway for some reason. What am I getting wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577018042, "post_id": 59444102, "comment_id": 105071348, "body": "This can be done by array formula, i had my names in A, Skills 1 to 3 in B to D, and used Y and N for skills and used something like so.    This would be a good start  <code>=MIN(IF(($B$2:$B$6=&quot;Y&quot;)*(($C$2:$C$6=&quot;Y&quot;)*($D$2:$D$6=&quot;Y&quot;))&gt;0,&zwnj;&#8203;ROW($B$2:$B$6)))</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577018983, "post_id": 59444102, "comment_id": 105071526, "body": "Also, VBA is possible.  Have you made a start with either?"}], "owner": {"reputation": 1, "user_id": 12579509, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_Iz_houzToQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfKDgkJyaBbNcKBE3gFILKjTDpmTA/photo.jpg?sz=128", "display_name": "Alex I", "link": "https://stackoverflow.com/users/12579509/alex-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577016904, "creation_date": 1577016904, "question_id": 59444102, "link": "https://stackoverflow.com/questions/59444102/excel-skill-tracker-with-automatic-suggestion", "title": "Excel Skill Tracker with automatic suggestion?", "body": "<p>I have an excel file in order to track each skill level for each person. Example:</p>\n\n<p>George | Skill 1 | Skill 2 | Skill 3 | Skill 4</p>\n\n<p>Michael | Skill 1 | Skill 2 | Skill 3 | Skill 4</p>\n\n<p>William | Skill 1 | Skill 2 | Skill 3 | Skill 4</p>\n\n<p>The table has data validation with \u2714\ufe0f and \u274c. What I want is when a person needs someone that has knowledge in skill 1, he can press a button/search in a field skill 1 and Excel shows/suggests him the user that has \u2714\ufe0f for skill 1 and also the most \u2714\ufe0f overall. Basically, if a new person needs help with something, he can find in a second the best person with skill 1 and overall skill that can help him.</p>\n\n<p>Is this something that can be done in Excel maybe using Macros or VBA? If not, can this be done in another software but still have the big table available?</p>\n\n<p>Thanks a lot for your time and any suggestions are welcomed.</p>\n"}, {"tags": ["excel", "vba", "audio", "wav", "winmm"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1577035190, "post_id": 59443624, "comment_id": 105075619, "body": "Why not just use <code>WMPlayer.OCX</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12130216, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAu5SNZAyVg0zu0yxh8Vf-ud7P52M1h3qjmQO7S=k-s128", "display_name": "father.of.automation", "link": "https://stackoverflow.com/users/12130216/father-of-automation"}, "edited": false, "score": 0, "creation_date": 1577100623, "post_id": 59446756, "comment_id": 105090502, "body": "I also have problem with New WMPLib and your code works perfectly in setup you suggested, that is what I was looking for, thank you!"}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 1, "last_activity_date": 1577037445, "creation_date": 1577037445, "answer_id": 59446756, "question_id": 59443624, "link": "https://stackoverflow.com/questions/59443624/how-to-play-multiple-wav-files-in-excel-by-vba-asynchronously-looped-at-the-same/59446756#59446756", "title": "How to play multiple WAV files in Excel by VBA asynchronously looped at the same time?", "body": "<p>Try to use <code>WMPlayer.OCX</code>, here is the example:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim wmp1\nDim wmp2\n\nSub test()\n\n    Set wmp1 = CreateObject(\"new:6BF52A52-394A-11D3-B153-00C04F79FAA6\")\n    With wmp1\n        .url = \"C:\\Test\\sound1.wav\"\n        .controls.play\n        .settings.playCount = 5\n    End With\n    Set wmp2 = CreateObject(\"new:6BF52A52-394A-11D3-B153-00C04F79FAA6\")\n    With wmp2\n        .url = \"C:\\Test\\sound2.mp3\"\n        .controls.play\n        .settings.setMode \"loop\", True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>BTW, <code>Set wmp1 = CreateObject(\"WMPlayer.OCX\")</code> and <code>Set wmp1 = New WMPLib.WindowsMediaPlayer</code> with reference to <code>C:\\Windows\\System32\\wmp.dll</code> don't work for me, that is why I use <code>new:</code> moniker.</p>\n"}], "owner": {"reputation": 13, "user_id": 12130216, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAu5SNZAyVg0zu0yxh8Vf-ud7P52M1h3qjmQO7S=k-s128", "display_name": "father.of.automation", "link": "https://stackoverflow.com/users/12130216/father-of-automation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 59446756, "answer_count": 1, "score": 1, "last_activity_date": 1577037445, "creation_date": 1577012468, "question_id": 59443624, "link": "https://stackoverflow.com/questions/59443624/how-to-play-multiple-wav-files-in-excel-by-vba-asynchronously-looped-at-the-same", "title": "How to play multiple WAV files in Excel by VBA asynchronously looped at the same time?", "body": "<p>it is first time I am asking for help.</p>\n\n<p>I have checked a lot of websites, even through the WaybackMachine for Excel file from Vienna University and I have not found solution of this. I have checked functions from winmm.dll API such as sndPlaySoundA and mciSendStringA.</p>\n\n<p>I am able to play WAV files looped asynchronously but at the moment it is not possible to play another file looped asynchronously at the same time. As you see below it is possible to combine flags that enables loop and async. I have tried combine it with another flags, but without result I want.</p>\n\n<pre><code>Private Declare Function PlaySound Lib \"winmm\" Alias \"sndPlaySoundA\" ( _\n    ByVal lpszSoundName As String, _\n    ByVal uFlags As Long) As Long\n\nPrivate Const SND_ASYNC = &amp;H1\nPrivate Const SND_LOOP = &amp;H8\nPrivate Const SND_NODEFAULT = &amp;H2\n\nPrivate Sub LoopTrack(ByVal sTrack As String)\n    Dim lReturnValue As Long\n    lReturnValue = PlaySound(sTrack, SND_ASYNC Or SND_LOOP)\n    If lReturnValue = 0 Then MsgBox \"Can't play \" &amp; sTrack\nEnd Sub\n\nPublic Sub PlayBackStop()\n    Call PlayTrack(vbNullString)\nEnd Sub\n\nPrivate Sub PlayTrack(ByVal sTrack As String)\n    Dim lReturnValue As Long\n    lReturnValue = PlaySound(sTrack, SND_ASYNC Or SND_NODEFAULT)\n    If lReturnValue = 0 Then MsgBox \"Can't play \" &amp; sTrack\nEnd Sub\n</code></pre>\n\n<p>I have also tried code below that plays multiple files asynchronously but not looped. Any idea how to loop multiple files asychronously and control them?</p>\n\n<pre><code>Private Declare Function SendString Lib \"winmm\" Alias \"mciSendStringA\" ( _\n    ByVal lpstrCommand As String, _\n    ByVal lpstrReturnString As String, _\n    ByVal uReturnLength As Long, _\n    ByVal hwndCallback As Long) As Long\n\nPublic Sub PlayMultimedia( _\n    ByVal sAliasName As String, _\n    Optional ByVal sFirstFrame As String = vbNullString, _\n    Optional ByVal sLastFrame As String = vbNullString)\n\n    If sFirstFrame = vbNullString Then sFirstFrame = 0\n    If sLastFrame = vbNullString Then sLastFrame = GetTotalFrames(sAliasName)\n\n    Dim sToDo As String * 128\n    Dim lReturnValue As Long\n    Dim sErrorToReturn As String * 128\n\n    sToDo = \"play \" &amp; sAliasName &amp; \" from \" &amp; sFirstFrame &amp; \" to \" &amp; sLastFrame\n\n    lReturnValue = SendString(sToDo, 0&amp;, 0&amp;, 0&amp;)\n    If Not lReturnValue = 0 Then\n        GetError lReturnValue, sErrorToReturn, 128\n        MsgBox sErrorToReturn\n        End\n    End If\nEnd Sub\n\nPublic Function GetTotalFrames(ByVal sAliasX As String) As Long\n    Dim lReturnValue As Long\n    Dim sTotalFrames As String * 128\n\n    lReturnValue = SendString(\"set \" &amp; sAliasX &amp; \" time format frames\", sTotalFrames, 128, 0&amp;)\n\n    lReturnValue = SendString(\"status \" &amp; sAliasX &amp; \" length\", sTotalFrames, 128, 0&amp;)\n    If Not lReturnValue = 0 Then\n        GetTotalFrames = -1\n        Exit Function\n    End If\n\n    GetTotalFrames = Val(sTotalFrames)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577010899, "post_id": 59442898, "comment_id": 105069950, "body": "What&#39;s the max number one can input?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12535444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01166f4c13f1f2c6446000d89a2ea752?s=128&d=identicon&r=PG&f=1", "display_name": "orb", "link": "https://stackoverflow.com/users/12535444/orb"}, "is_accepted": false, "score": 0, "last_activity_date": 1577008798, "creation_date": 1577008798, "answer_id": 59443223, "question_id": 59442898, "link": "https://stackoverflow.com/questions/59442898/extracting-two-inputbox-values-separated-by-a-hyphen-and-forming-a-number-range/59443223#59443223", "title": "Extracting two Inputbox values separated by a hyphen and forming a number range with them", "body": "<p>I would recommend you to use also the split function: </p>\n\n<pre><code>input = Split(myValue, \"-\")\nFor rangeInput = input(0) To input(1)\n   ActiveSheet.Range(\"AB5\").Value = ActiveSheet.Range(\"AB5\").Value &amp; RangeInput &amp; \",\"\nNext rangeInput\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1577017899, "post_id": 59443689, "comment_id": 105071327, "body": "Excellent arr(x) definition in that specific case (&quot;-&quot;)!"}, {"owner": {"reputation": 927, "user_id": 2632165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbcdc9001a527cfc58e19d58f32f1a7e?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/2632165/simon"}, "edited": false, "score": 0, "creation_date": 1577039048, "post_id": 59443689, "comment_id": 105076576, "body": "Thank you! That&#39;s much better than I could&#39;ve hoped for."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 3, "last_activity_date": 1577012962, "creation_date": 1577012962, "answer_id": 59443689, "question_id": 59442898, "link": "https://stackoverflow.com/questions/59442898/extracting-two-inputbox-values-separated-by-a-hyphen-and-forming-a-number-range/59443689#59443689", "title": "Extracting two Inputbox values separated by a hyphen and forming a number range with them", "body": "<p>Something like this maybe:</p>\n\n<pre><code>Sub Test()\n\nDim myValue  As Variant: myValue = InputBox(\"Specify the test numbers individually by using a comma separator(1,2,3,4,5), or enter a range by using a hyphen(1-10).\")\nDim arr As Variant: arr = Split(myValue, \",\")\nDim x As Long\n\nFor x = LBound(arr) To UBound(arr)\n    If arr(x) Like \"*-*\" Then\n        arr(x) = Join(Evaluate(\"TRANSPOSE(ROW(\" &amp; Replace(arr(x), \"-\", \":\") &amp; \"))\"), \",\")\n    End If\nNext x\n\nDebug.Print Join(arr, \",\")\n\nEnd Sub\n</code></pre>\n\n<p>Testing with input <code>1,2,3,4,5,8-14</code> > <code>1,2,3,4,5,8,9,10,11,12,13,14</code></p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1577023297, "creation_date": 1577023297, "answer_id": 59444855, "question_id": 59442898, "link": "https://stackoverflow.com/questions/59442898/extracting-two-inputbox-values-separated-by-a-hyphen-and-forming-a-number-range/59444855#59444855", "title": "Extracting two Inputbox values separated by a hyphen and forming a number range with them", "body": "<p>You could fix your code by changing the line </p>\n\n<pre><code>Input2 = Right(myValue, InStr(myValue, \"-\"))\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Input2 = Right(myValue, Len(myValue) - InStr(myValue, \"-\"))\n</code></pre>\n"}], "owner": {"reputation": 927, "user_id": 2632165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbcdc9001a527cfc58e19d58f32f1a7e?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/2632165/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 59443689, "answer_count": 3, "score": 0, "last_activity_date": 1577032352, "creation_date": 1577005441, "last_edit_date": 1577032352, "question_id": 59442898, "link": "https://stackoverflow.com/questions/59442898/extracting-two-inputbox-values-separated-by-a-hyphen-and-forming-a-number-range", "title": "Extracting two Inputbox values separated by a hyphen and forming a number range with them", "body": "<p>Here's a little different one. I am not the greatest with VBA but I like to learn and mess around with it. I'm making an Inputbox where the user can put in a range (say 1-100) using a hyphen as a separator. I want the VBA to extract the two values separately from either side of the hyphen and then use those two values to create a range output that shows all the values between them (for example 1-100 would output 1,2,3,4,5,6,7 etc into the specified cell). I have made the code and it works. </p>\n\n<p>However it only works if I put the range between 1-99. If I do that it works great. If I do 1-100 it doesn't do anything. If I do 5-50 it doesnt do anything. It has to be a 1 as the first number and no higher than 99. This is where I'm stuck and don't know how to fix it.</p>\n\n<p>It also allows the person to put in individual numbers with a comma separator (eg 2,4,6,8).</p>\n\n<p>Here's my code.</p>\n\n<pre><code>Sub KeepRowsUnmodified()\n\nDim myValue As Variant, name As Variant\nmyValue = InputBox(\"Specify the test numbers individually by using a comma separator(1,2,3,4,5), or enter a range by using a hyphen(1-10).\")\nIndiTestNo = Split(myValue, \",\")\n    Application.ScreenUpdating = False\n    If IsEmpty(ActiveSheet.Range(\"AB5\").Value) Then\n    ActiveSheet.Range(\"AB5\").Value = \",\"\n    End If\n    If InStr(1, myValue, \"-\", vbTextCompare) Then\n        Input1 = Left(myValue, InStr(myValue, \"-\") - 1)\n        Input2 = Right(myValue, InStr(myValue, \"-\"))\n        For RangeInput = Input1 To Input2\n        ActiveSheet.Range(\"AB5\").Value = ActiveSheet.Range(\"AB5\").Value &amp; RangeInput &amp; \",\"\n        Next\n    Else\n    For Each name In IndiTestNo\n    ActiveSheet.Range(\"AB5\").Value = ActiveSheet.Range(\"AB5\").Value &amp; name &amp; \",\"\n    Next\n    End If\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3624187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b2ac742583f74855906f7b3ec2142c?s=128&d=identicon&r=PG&f=1", "display_name": "vipin Kumar", "link": "https://stackoverflow.com/users/3624187/vipin-kumar"}, "edited": false, "score": 0, "creation_date": 1577005307, "post_id": 59442814, "comment_id": 105068946, "body": "Thank you sir this code is working fine-  IE.document.querySelector(&quot;input[type=image][onclick]&quot;).oncl&zwnj;&#8203;ick"}], "tags": [], "owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "is_accepted": true, "score": 1, "last_activity_date": 1577004592, "creation_date": 1577004592, "answer_id": 59442814, "question_id": 59442765, "link": "https://stackoverflow.com/questions/59442765/how-can-i-click-a-button-on-web-page-using-vba/59442814#59442814", "title": "How can I click a button on web page using VBA?", "body": "<p>The selector you want is probably:</p>\n\n<pre><code>input[type=image][onclick]\n</code></pre>\n\n<p>You can invoke the <code>onclick</code> function directly:</p>\n\n<pre><code>document.querySelector(\"input[type=image][onclick]\").onclick()\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 3624187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b2ac742583f74855906f7b3ec2142c?s=128&d=identicon&r=PG&f=1", "display_name": "vipin Kumar", "link": "https://stackoverflow.com/users/3624187/vipin-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 59442814, "answer_count": 1, "score": 0, "last_activity_date": 1577159945, "creation_date": 1577004122, "last_edit_date": 1577159945, "question_id": 59442765, "link": "https://stackoverflow.com/questions/59442765/how-can-i-click-a-button-on-web-page-using-vba", "title": "How can I click a button on web page using VBA?", "body": "<p>URL-</p>\n\n<pre><code>&lt;input type=\"image\" src=\"/live_market/resources/images/gobtn.gif\" alt=\"btn\" onclick=\"goBtnClick('stock');\" style=\"cursor: pointer\"&gt;\n</code></pre>\n\n<p>I am trying to click the go button.</p>\n\n<pre><code>IE.document.getElementById(\"underlyStock\").Value = \"ACC\"\n\nIE.document.all.Iteam(stock).FireEvent (\"onclick\")    ' not working\nIE.document.querySelector(\"goBtnClick('stock')\").Click 'not working\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576995789, "post_id": 59442030, "comment_id": 105067600, "body": "It depends - Late binding is very useful if you arent sure what version the user has, or you need it to work with every version."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1576997449, "post_id": 59442030, "comment_id": 105067799, "body": "You can&#39;t use word constants if late binding. Look up the value in Object Browser and use the value. Or early bind to Word in References dialog."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576999319, "post_id": 59442030, "comment_id": 105068038, "body": "You want the value of 1 - <a href=\"https://apireference.aspose.com/net/words/aspose.words.settings/mailmergemaindocumenttype\" rel=\"nofollow noreferrer\">apireference.aspose.com/net/words/aspose.words.settings/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 12577576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875445ad2db63387d7ca8e8f3165d554?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/12577576/don"}, "edited": false, "score": 0, "creation_date": 1577029589, "post_id": 59442030, "comment_id": 105074002, "body": "Good point about the version. The word constants are working.   The bigger question is how to get the MM working? It launches but then pops up a dialog box waiting for an answer.  I want no user interaction at all. User clicks a button and the mail merge documents print."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1577056904, "creation_date": 1577056904, "answer_id": 59448773, "question_id": 59442030, "link": "https://stackoverflow.com/questions/59442030/running-a-ms-word-mail-merge-from-excel/59448773#59448773", "title": "Running a MS Word mail merge from excel", "body": "<p>How about this concept?</p>\n\n<pre><code>Sub PushToWord()\n\nDim objWord As New Word.Application\nDim doc As Word.Document\nDim bkmk As Word.Bookmark\nsWdFileName = Application.GetOpenFilename(, , , , False)\nSet doc = objWord.Documents.Open(sWdFileName)\n\nobjWord.activedocument.variables(\"FirstName\").Value = Range(\"FirstName\").Value\nobjWord.activedocument.variables(\"LastName\").Value = Range(\"LastName\").Value\n\nActiveDocument.Fields.Update\n\nobjWord.Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>Add DocVariables to your word document, and name them appropriately.  Run the code from Excel.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12577576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875445ad2db63387d7ca8e8f3165d554?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/12577576/don"}, "edited": false, "score": 0, "creation_date": 1577828304, "post_id": 59449814, "comment_id": 105266226, "body": "Thanks for the explanation."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "is_accepted": false, "score": 0, "last_activity_date": 1577071063, "creation_date": 1577071063, "answer_id": 59449814, "question_id": 59442030, "link": "https://stackoverflow.com/questions/59442030/running-a-ms-word-mail-merge-from-excel/59449814#59449814", "title": "Running a MS Word mail merge from excel", "body": "<p><a href=\"https://support.microsoft.com/en-au/help/825765/you-receive-the-opening-this-will-run-the-following-sql-command-messag\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-au/help/825765/you-receive-the-opening-this-will-run-the-following-sql-command-messag</a></p>\n\n<blockquote>\n  <p>The prompt that is described in the \"Symptoms\" section is by design. </p>\n  \n  <p>This prompt exists in all later versions of Microsoft Office and was\n  introduced in Office XP Service Pack 3. This prompt was added in the\n  products listed in the \"Applies to\" section to make mail merge more\n  secure. If you click Yes when you receive the prompt, you let code run\n  on your computer. A malicious user may be able to craft a SQL query\n  that is designed to steal or to destroy data that you have access to.\n  If you click No when you receive the prompt, you do not let code to\n  run.</p>\n  \n  <p>Note Setting DisplayAlerts=none through VBA suppresses the prompt when\n  the file is opened by using VBA, <strong>but uses the NO option to open the\n  document and no data is attached to the mail merge main document</strong>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12577576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875445ad2db63387d7ca8e8f3165d554?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/12577576/don"}, "edited": false, "score": 0, "creation_date": 1577375931, "post_id": 59450930, "comment_id": 105155668, "body": "This worked, sort of. I stepped through the code and the when the .opendatasource is executed the mail merge runs and prints the letters.  VBA execution then stops. No errors. It doesn\u2019t execute the .execute statement or proceed any further."}, {"owner": {"reputation": 3, "user_id": 12577576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875445ad2db63387d7ca8e8f3165d554?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/12577576/don"}, "edited": false, "score": 0, "creation_date": 1577828251, "post_id": 59450930, "comment_id": 105266218, "body": "This actually worked. When I tested on my home machine it worked fine. When tested at work it did not work. I believe it is not working in the office because there are different versions of Office installed.  Now I need to get the IT department to fix Office. Thanks!"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 3, "user_id": 12577576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875445ad2db63387d7ca8e8f3165d554?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/12577576/don"}, "edited": false, "score": 0, "creation_date": 1577870065, "post_id": 59450930, "comment_id": 105271169, "body": "The solution has nothing to do with the Office version - unless you&#39;re using something from the 1980s... More likely it has everything to do with restrictions imposed by your IT department. So why the downvote???"}, {"owner": {"reputation": 3, "user_id": 12577576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875445ad2db63387d7ca8e8f3165d554?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/12577576/don"}, "edited": false, "score": 0, "creation_date": 1577928124, "post_id": 59450930, "comment_id": 105283174, "body": "I didn\u2019t downvote. If I did it was by accident. I actually checked this as the solution.   On my office PC there are multiple recent versions of office installed. Something is not installed correctly because when you click on a spreadsheet 2016 version launches. Click on a word doc and 2013 launches. I don\u2019t think my problem is that there are multiple versions. I think the problem is is that something is not installed correctly."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": -1, "last_activity_date": 1577082094, "creation_date": 1577082094, "answer_id": 59450930, "question_id": 59442030, "link": "https://stackoverflow.com/questions/59442030/running-a-ms-word-mail-merge-from-excel/59450930#59450930", "title": "Running a MS Word mail merge from excel", "body": "<p>For example:</p>\n\n<pre><code>Sub MergetoPrint()\nDim wrdObj As Object, wrdDoc As Object, strFile As String\nstrFile = ThisWorkbook.FullName\nConst wdFormLetters As Long = 0\nConst wdSendToNewDocument As Long = 0\nConst wdSendToPrinter = 1\nConst wdSendToEmail As Long = 2\nConst wdMergeSubTypeAccess As Long = 1\nConst wdMailFormatHTML As Long = 1\nSet wrdObj = CreateObject(\"Word.Application\")\nWith wrdObj\n  .Visible = False\n  .DisplayAlerts = False\n  Set wrdDoc = .Documents.Open(ThisWorkbook.Path &amp; \"\\MailMergeMainDocument.docx\", False, True, False, , , , , , , , False)\n  With wrdDoc\n    With .MailMerge\n      .MainDocumentType = wdFormLetters\n      .Destination = wdSendToPrinter\n      .SuppressBlankLines = True\n      .OpenDataSource Name:=strFile, ReadOnly:=True, AddToRecentFiles:=False, LinkToSource:=False, _\n        Connection:=\"Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=strFile;Mode=Read;\" &amp; _\n        \"Extended Properties=\"\"HDR=YES;IMEX=1\"\";\", SQLStatement:=\"SELECT * FROM [Sheet1$]\", _\n        SQLStatement1:=\"\", SubType:=wdMergeSubTypeAccess\n      .Execute\n    End With\n    .Close 0\n  End With\nEnd With\nSet wrdDoc = Nothing: Set wrdObj = Nothing\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12577576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875445ad2db63387d7ca8e8f3165d554?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/12577576/don"}, "edited": false, "score": 0, "creation_date": 1577828351, "post_id": 59458871, "comment_id": 105266234, "body": "Thank you Cindy for the detailed explanation."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3, "user_id": 12577576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875445ad2db63387d7ca8e8f3165d554?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/12577576/don"}, "edited": false, "score": 0, "creation_date": 1577831646, "post_id": 59458871, "comment_id": 105266796, "body": "@Don Since you&#39;re relatively new to the site: The accepted way to &quot;thank&quot; people for contributions that aren&#39;t the answer to your question is to upvote by clicking the up-arrow next to the contribution. Upvoting is to let people know this (in your opinion) is a useful/helpful contribution to the site. It&#39;s possible for questions as well as answers. You should be able to do this everywhere (although it may be you need a bit more reputation before it&#39;s enabled). Later, you&#39;ll also be able to downvote things you consider to be poor quality."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1578311171, "last_edit_date": 1578311171, "creation_date": 1577120340, "answer_id": 59458871, "question_id": 59442030, "link": "https://stackoverflow.com/questions/59442030/running-a-ms-word-mail-merge-from-excel/59458871#59458871", "title": "Running a MS Word mail merge from excel", "body": "<p>There are two basic approaches that can be used to run a mail merge without triggering the prompt. Note that the prompt is a security measure since the SQL a mail merge runs <em>could</em> cause harm to a system. The prompt ensures that the user is aware of this and (supposedly) only runs the mail merge if the document is from a \"trusted source\".</p>\n\n<ol>\n<li><strong>Remove the data source from the main merge document, then add it explicitly using VBA every time document is opened</strong>.</li>\n</ol>\n\n<p>The advantage to this approach is that it upholds Word's security setting. If the user allows the VBA to run, then supposedly the entire project is trusted, so attaching the data source using code is allowed.</p>\n\n<p>The data source can be removed from the document by choosing the option to open the document without allowing the mail merge (the button labelled \"No\" in the version of Word I'm looking at). Save the document in that state. Add a line to your code that links in the data source before executing the mail merge.</p>\n\n<p>In order to figure out the necessary syntax, you can either record a macro while connecting to the data source (this is most certain and fastest), or you can query the data source from the document before disconnecting it. In Word, in the Immediate Window (<kbd>Ctrl</kbd>+<kbd>G</kbd>) of the VBA Editor enter the <code>?</code> lines and press Enter, one-by-one:</p>\n\n<pre><code>?ActiveDocument.MailMerge.DataSource.Name\nC:\\Users\\Cindy Meister\\Documents\\Personal\\klpFeb00.mdb\n?Document.MailMerge.DataSource.QueryString\nSELECT * FROM `Q_MailMergeInvite`\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>?ActiveDocument.MailMerge.DataSource.ConnectString\n</code></pre>\n\n<p>After pressing Enter for this one you should see something along the lines of </p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=C:\\Users\\[username]\\Documents\\Personal\\Text.mdb;Mode=Read;Extended Properties=\"\";Jet OLEDB:System database=\"\";Jet OLEDB:Registry Path=\"\";Jet OLEDB:Engine Type=5;Jet OLEDB:Database Locking Mode=0;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB:Global Bulk Transactions=1;Jet OLEDB:New Database Password=\"\";Jet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on Compact=False;Jet OLEDB:Compact Without Replica Repair=False;Jet OLEDB:SFP=False;Jet OLEDB:Support Complex Data=False;Jet OLEDB:Bypass UserInfo Validation=False\n</code></pre>\n\n<p>These, in double-quotes, are assigned to the <code>Name</code>, <code>SQLStatement</code> and <code>Connection</code> parameters of <code>Document.MailMerge.OpenDataSource</code>. </p>\n\n<ol start=\"2\">\n<li><strong>Change the Registry setting to disable the prompt</strong></li>\n</ol>\n\n<p>This is described in the <a href=\"https://support.microsoft.com/en-ph/help/825765/you-receive-the-opening-this-will-run-the-following-sql-command-messag\" rel=\"nofollow noreferrer\">Knowledge Base article about the prompt</a>. </p>\n\n<p>The exact Registry key varies, depending on the version of Word, but follows the pattern </p>\n\n<pre><code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Word\\Options \n</code></pre>\n\n<p>The above is for Word 2013, version 15. Change it to 14 for Word 2010; 16 for Word 2016, etc.</p>\n\n<p>A new Registry entry of the type <code>DWord</code> needs to be created in this location, named <code>SQLSecurityCheck</code>. Assign it the value <code>00000000</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 12577576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875445ad2db63387d7ca8e8f3165d554?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/12577576/don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1046, "favorite_count": 0, "accepted_answer_id": 59450930, "answer_count": 4, "score": 0, "last_activity_date": 1578311171, "creation_date": 1576995110, "question_id": 59442030, "link": "https://stackoverflow.com/questions/59442030/running-a-ms-word-mail-merge-from-excel", "title": "Running a MS Word mail merge from excel", "body": "<p>I know this has been asked before and I tried to update the other thread but was not allowed. </p>\n\n<p>I have a spreadsheet that has data that is used in a MS mail merge. I have a Word mail merge document that is all set up to run. The fields are already set up. When I open the word doc I get a prompt that says \"Opening this document will run the following SQL command\", etc, etc. What I want to do is have the Excel spreadsheet run the mail merge without any user intervention when I click a button. I put together the following code from examples on this forum but is not working. When run Word opens and I get the same prompt. How do I get this to work?</p>\n\n<pre><code>Public Sub RunMailMerge(MMFileName As String)\n\n    Dim wdDoc As Object\n\n'   open the mail merge layout file\n\n    Set wdDoc = GetObject(MMFileName, \"Word.document\")\n    wdDoc.Application.Visible = True\n\n    With wdDoc.MailMerge\n         .MainDocumentType = wdFormLetters\n         .Destination = wdSendToPrinter\n         .SuppressBlankLines = True\n         .Execute Pause:=False\n    End With\n\n'   cleanup\n\n    wdDoc.Close SaveChanges:=False\n    Set wdDoc = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Also all of the examples I have seen use late binding. Wouldn't it better to use early bind of the word object?</p>\n\n<p>Thanks\nDon</p>\n"}, {"tags": ["excel", "vba", "loops", "if-statement"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1576994551, "post_id": 59441711, "comment_id": 105067464, "body": "<a href=\"https://stackoverflow.com/questions/18798522/how-to-run-a-sql-query-on-an-excel-table\">Query the data-range with sql</a> to get those values by a sql-statementt (Sum(),  Count(),, Min(), Max()  grouped by stock),. Avoid using implicit references to`ActiveSheet (e.g. using Cells(), Range() without explicit defining the sheet (and workbook) ! Have a look at <a href=\"http://rubberduckvba.com/\" rel=\"nofollow noreferrer\">RubberduckVBA</a> to get hints on that."}], "answers": [{"tags": [], "owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "is_accepted": false, "score": 0, "last_activity_date": 1577010945, "creation_date": 1577010945, "answer_id": 59443473, "question_id": 59441711, "link": "https://stackoverflow.com/questions/59441711/how-to-find-the-first-and-last-values-in-a-conditional-loop-in-vba/59443473#59443473", "title": "How to find the first and last values in a conditional loop in VBA", "body": "<p>It would have been more clear if you add a screenshot of your data layout. And also, need some clarification - what are the first and last values? Are those are min and max? </p>\n\n<p>Or those are first \"open\" occurrence and last \"close\" in appropriate columns? If so, you may try doing this way:</p>\n\n<pre><code>' This will be first stock's open\nannual_open = Cells(2, 4).Value\n\nFor i = 2 To 800000\n\n    If Cells(i + 1, 1).Value &lt;&gt; Cells(i, 1).Value Then\n\n        '[Your code]\n\n        ' Here, i is the last row of the current stock, so assign it\n        annual_close = Cells(i, 5).Value\n\n        '''''''''''''''''''''''''''''''''''''''''''''''''\n        ' Handler for your \"annual_open\" and \"annual_close\"\n        ' because lines after will overwrite \"annual_open\" with new value\n\n        '   [Add code here]\n\n        '''''''''''''''''''''''''''''''''''''''''''''''''\n\n        ' Here, i + 1 is the first row of next stock\n        ' so assign it\n        annual_open = Cells(i + 1, 4).Value\n\n        '[Your code]\n\n    Else\n        ' If stock is the same do nothing to \"annual_open\" and \"annual_close\"\n        '[Your code]\n\n\n\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11308842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43268f338fffa2c994113c03af50200c?s=128&d=identicon&r=PG&f=1", "display_name": "bhylynch98", "link": "https://stackoverflow.com/users/11308842/bhylynch98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 680, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577010945, "creation_date": 1576990536, "question_id": 59441711, "link": "https://stackoverflow.com/questions/59441711/how-to-find-the-first-and-last-values-in-a-conditional-loop-in-vba", "title": "How to find the first and last values in a conditional loop in VBA", "body": "<p>I'm creating a report on a stock index where I am supposed to get the annual open to close net change in stock price for each stock in the market. I have panel data with an observation for each stock every day of the year. I'm currently using a conditional for loop to create annual total volume as well. Is there any way for me to select the first and last values in a conditional to select the annual open and close of a stock? Column 1 is the name of the stock so I am using that as the conditional for when the stock changes. Here is what I have thus far. Column 4 is daily open and column 5 is daily close for the observation.</p>\n\n<pre><code>'Establish variables\nDim ticker As String\nDim change_price As Double\nDim change_percent As Double\nDim volume As Double\nDim annual_open As Double\nDim annual_close As Double\n\n\n' Keep track of each stock the summary table\n  Dim Summary_Table_Row As Integer\n  Summary_Table_Row = 2\n\n\nFor i = 2 To 800000\n    If Cells(i + 1, 1).Value &lt;&gt; Cells(i, 1).Value Then\n        'create a list of stocks\n        ticker = ticker + Cells(i, 1).Value\n        'total volume for each stock\n        volume = volume + Cells(i, 7).Value\n        'annual_open = ?\n        'annual_close = ?\n\n         ' Print the stock in the Summary Table\n      Range(\"H\" &amp; Summary_Table_Row).Value = ticker\n\n      ' Print the stock volume to the Summary Table\n      Range(\"I\" &amp; Summary_Table_Row).Value = volume\n\n      ' Add one to the summary table row\n      Summary_Table_Row = Summary_Table_Row + 1\n\n      'reset the stock name\n      ticker = \"\"\n\n      ' Reset the Brand Total\n      volume = 0\n\n\n    ' If the cell immediately following a row is the same stock...\n    Else\n\n      ' Add to the stock total\n      volume = volume + Cells(i, 7).Value\n\n\n    End If\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1576985927, "post_id": 59441441, "comment_id": 105066590, "body": "Please include your code in your question."}, {"owner": {"reputation": 1, "user_id": 12063661, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k5raXDYk3BA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reCCo0rfPIZ8xKI7a3zqKGm3UdRbg/photo.jpg?sz=128", "display_name": "JJzlk", "link": "https://stackoverflow.com/users/12063661/jjzlk"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577105778, "post_id": 59441441, "comment_id": 105092594, "body": "Code included. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1576993763, "last_edit_date": 1576993763, "creation_date": 1576990278, "answer_id": 59441698, "question_id": 59441441, "link": "https://stackoverflow.com/questions/59441441/vba-code-to-change-font-color-based-on-adjacent-cell-value-and-cell-background/59441698#59441698", "title": "VBA code to change font color based on adjacent cell value and cell background", "body": "<p>To get you started, here is basic code that will loop through <code>Column I</code> and if a cell has the text <code>\"Total\"</code>, it will <code>resize</code> and <code>offset</code> the range and clear the interior color of the cells.</p>\n\n<pre><code>For i = 2 To Cells(Rows.Count, 9).End(xlUp).Row\n    If Cells(i, 9).Value = \"Total\" Then\n        CCells(i, 9).Resize(2).Offset(-2).Font.Color = vbYellow\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12063661, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-k5raXDYk3BA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reCCo0rfPIZ8xKI7a3zqKGm3UdRbg/photo.jpg?sz=128", "display_name": "JJzlk", "link": "https://stackoverflow.com/users/12063661/jjzlk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1577105676, "creation_date": 1576985802, "last_edit_date": 1577105676, "question_id": 59441441, "link": "https://stackoverflow.com/questions/59441441/vba-code-to-change-font-color-based-on-adjacent-cell-value-and-cell-background", "title": "VBA code to change font color based on adjacent cell value and cell background", "body": "<p>I created a macro to collapse columns, leaving just the \"Totals\" column for each month. \nFor design purposes I have to repeat the date and the name above it in the adjacent cells left and right. For example, columns G, H, and I, have the same text, but I'm hiding the values on the sides by using the same color as the background, though they're still there.\nThe problem is that when I run the macro to show only the \"Total\" column, I need to see those dates and the word above, and in order to do this I have to change the color of those two cells above the cell that contains the word \"Total\". </p>\n\n<p>I've been trying to code something that finds cells with the word \"Total\" within that row (row 10) and then changes the font color of whatever two cells are above those Total cells, but I haven't been able to make it work. Also, when I unhide the columns, I want those fonts to match the color of the background again.</p>\n\n<p>I uploaded 3 pictures so you can see a better description of what I need. Thank you very much!!!</p>\n\n<p><a href=\"https://i.stack.imgur.com/shs9O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/shs9O.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bTDcd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bTDcd.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BRc4x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BRc4x.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code. I'd have to add the part that would change the color of the font:</p>\n\n<pre><code>If ToggleButton21.Value = True Then\n\nDim z As Range\n    For Each z In Range(\"G10:DS10\").Cells\n        If z.Value = \"FB\" Then\n            z.EntireColumn.Hidden = True\n\n    End If\n    Next z\n\nDim x As Range\n    For Each x In Range(\"G10:DS10\").Cells\n        If x.Value = \"BB\" Then\n            x.EntireColumn.Hidden = True\n        End If\n    Next x\n\nElse\n\nDim d As Range\n    For Each d In Range(\"G10:DS10\").Cells\n        If d.Value = \"FB\" Then\n            d.EntireColumn.Hidden = False\n        End If\n    Next d\n\nDim y As Range\n    For Each y In Range(\"G10:DS10\").Cells\n        If y.Value = \"BB\" Then\n            y.EntireColumn.Hidden = False\n        End If\n    Next y\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576974692, "post_id": 59440812, "comment_id": 105065437, "body": "You&#39;re tying to pass a 2-dimensional array to Join - try passing the range&#39;s value through Application.Transpose to convert it to something Join can process."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 11700036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GKrY9aBjCUg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reYTLcdAw4_oyfhMtaeyOr5SB2VvA/photo.jpg?sz=128", "display_name": "gerpes8", "link": "https://stackoverflow.com/users/11700036/gerpes8"}, "edited": false, "score": 0, "creation_date": 1576976078, "post_id": 59440911, "comment_id": 105065625, "body": "This code is throwing an invalid procedure/call error. I tried to use it with WorksheetFunction.Transpose also."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 45, "user_id": 11700036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GKrY9aBjCUg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reYTLcdAw4_oyfhMtaeyOr5SB2VvA/photo.jpg?sz=128", "display_name": "gerpes8", "link": "https://stackoverflow.com/users/11700036/gerpes8"}, "edited": false, "score": 0, "creation_date": 1576976494, "post_id": 59440911, "comment_id": 105065686, "body": "@gerpes8 that&#39;s because the array needs to be transposed twice, because we&#39;re looking at a horizontal layout."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1576999168, "post_id": 59440911, "comment_id": 105068018, "body": "@MathieuGuindon your answer line <code>once to turn it into a one-dimensional array, and once more to make it vertical so that the VBA.Strings.Join function will be able to work with.</code> . I am bit confused about the portion make it vertical. should not it be horizental or vertical is correct ."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1577020805, "post_id": 59440911, "comment_id": 105071911, "body": "Another possible way: <code>Join(Application.Index(headerCells, 1, 0), &quot;,&quot;)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1577021215, "post_id": 59440911, "comment_id": 105071994, "body": "@JvdV oooh that&#39;s clever, love it!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1576976720, "last_edit_date": 1576976720, "creation_date": 1576975659, "answer_id": 59440911, "question_id": 59440812, "link": "https://stackoverflow.com/questions/59440812/how-to-concatenate-the-first-row-of-a-sheet-into-a-list-separated-by-commas/59440911#59440911", "title": "How to concatenate the first row of a sheet into a list separated by commas?", "body": "<p>You can't join a <code>Range</code>, you join a 1-dimensional array. What's implicit here, is a call to <code>Range.Value</code>, which, because the range contains multiple cells, is going to be a 2D variant array: you need to pass it to <code>Application.Transpose</code> once to turn it into a one-dimensional array, and once more to make it vertical so that the <code>VBA.Strings.Join</code> function will be able to work with.</p>\n\n<p>Also, watch out for <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">implicit ActiveSheet references</a>: unless that code is written in a worksheet module (where the implicit qualifier would be <code>Me.</code>), all these unqualified <code>Range</code> and <code>Cells</code> member calls are implicitly working off whatever the <code>ActiveSheet</code> is.</p>\n\n<pre><code>With ActiveSheet\n    lc = .Cells(1, .Columns.Count).End(xlToLeft).column\n    Dim headerCells As Variant\n    headerCells = .Range(.Cells(1, 1), .Cells(1, lc)).Value '2D variant array\nEnd With\n\nDim headers As String\nheaders = Join(Application.Transpose(Application.Transpose(headerCells)), \",\")\n\nDebug.Print headers\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11700036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GKrY9aBjCUg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reYTLcdAw4_oyfhMtaeyOr5SB2VvA/photo.jpg?sz=128", "display_name": "gerpes8", "link": "https://stackoverflow.com/users/11700036/gerpes8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 59440911, "answer_count": 1, "score": 1, "last_activity_date": 1580318881, "creation_date": 1576974207, "last_edit_date": 1580318881, "question_id": 59440812, "link": "https://stackoverflow.com/questions/59440812/how-to-concatenate-the-first-row-of-a-sheet-into-a-list-separated-by-commas", "title": "How to concatenate the first row of a sheet into a list separated by commas?", "body": "<p>I am trying to concatenate the first row of a sheet into a list separated by commas. It is throwing the type mismatch error.</p>\n\n<p>All values in the cells are strings and there is a value in every cell.</p>\n\n<p>I have tried declaring headers to a variant as well.</p>\n\n<pre><code>lc = Cells(1, Columns.Count).End(xlToLeft).column\nheaders = Join(Range(Cells(1, 1), Cells(1, lc)), \",\")\n\nDebug.Print headers\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1576969226, "post_id": 59440433, "comment_id": 105064557, "body": "What is DT.Value?"}, {"owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "reply_to_user": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1576969507, "post_id": 59440433, "comment_id": 105064624, "body": "It&#39;s a textbox DT.Text usually but i was experimenting with value"}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1576971345, "post_id": 59440433, "comment_id": 105064971, "body": "Have you tried putting a breakpoint in you VBA editor to figure out what line the error occurs on?"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "edited": false, "score": 0, "creation_date": 1577045021, "post_id": 59440790, "comment_id": 105077851, "body": "It works! Only issue is now it won&#39;t paste the date that was entered into the text box, it only pastes the 3 character month. I need it to display the entire date in the cell"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "edited": false, "score": 1, "creation_date": 1577045660, "post_id": 59440790, "comment_id": 105077999, "body": "What cell do you want to paste the date from DT?"}, {"owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "edited": false, "score": 0, "creation_date": 1577045989, "post_id": 59440790, "comment_id": 105078067, "body": "ws.Range(&quot;A&quot; &amp; newRow).Value = Format(DT.Text, &quot;Long Date&quot;) Column A :)"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 1, "last_activity_date": 1576989046, "last_edit_date": 1576989046, "creation_date": 1576973739, "answer_id": 59440790, "question_id": 59440433, "link": "https://stackoverflow.com/questions/59440433/how-to-paste-to-specific-sheet-based-on-textbox-value/59440790#59440790", "title": "How to Paste to specific sheet based on textbox value?", "body": "<p>It depends on how you have named your tabs and how your date is imputed in the textbox. \nBut if you are using <code>mar</code> and <code>MAR</code>, here is a simple code to assign the worksheet variable using the text in the userform textbox.</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(Me.DT.Text)\n</code></pre>\n\n<p>Update to basic code: </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    'Check if the textbox has a valid date\n    If IsDate(Me.DT.Text) Then\n\n        Me.DT.Text = Format(CDate(Me.DT.Text), \"mmm\") 'Format as abrivated month\n\n        'Define and Assign worksheet and newRow variables\n        Dim ws As Worksheet, newRow As Long\n        Set ws = ThisWorkbook.Worksheets(Me.DT.Text)\n        newRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n        With ws 'When writing other textbox values to the worksheet; change TextBox# as required\n            .Cells(newRow, 1).Value = Me.TextBox1.Text\n            .Cells(newRow, 2).Value = Me.TextBox2.Text\n            .Cells(newRow, 3).Value = Me.TextBox3.Text\n            .Cells(newRow, 4).Value = Me.TextBox4.Text\n        End With\n\n        Application.Goto ws.Range(\"A1\"), Scroll:=True 'Set the focus to the first cell on the worksheet\n\n    Else 'If a valid date is not entered display a message box\n        MsgBox \"Please enter a valid date\"\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 59440790, "answer_count": 1, "score": 0, "last_activity_date": 1584594347, "creation_date": 1576968723, "last_edit_date": 1584594347, "question_id": 59440433, "link": "https://stackoverflow.com/questions/59440433/how-to-paste-to-specific-sheet-based-on-textbox-value", "title": "How to Paste to specific sheet based on textbox value?", "body": "<p>I want to paste certain rows into a certain sheet if a string is entered into a textbox.</p>\n\n<p>I have is a userform that I'd like to paste entries into Month specific sheets based on the date textbox.</p>\n\n<p>I can copy to one specific sheet, but I'd like to auto sort into the appropriate Month sheet based on the value entered in <code>DT.value</code>.</p>\n\n<pre><code>Private Sub Submit_Click()\nDim ws As Worksheet\nDim LastRow As Long\n\nIf DT.Value = \"nov\" Then\n    Set ws = ThisWorkbook.Worksheets(\"NOV\")\nElse\n    If DT.Value = \"dec\" Then\n        Set ws = ThisWorkbook.Worksheets(\"DEC\")\n    Else\n        If DT.Value = \"Jan\" Then\n            Set ws = ThisWorkbook.Worksheets(\"JAN\")\n        Else\n            If DT.Value = \"Feb\" Then\n                Set ws = ThisWorkbook.Worksheets(\"FEB\")\n            Else\n                If DT.Value = \"mar\" Then\n                    Set ws = ThisWorkbook.Worksheets(\"MAR\")\n                Else\n                    If DT.Value = \"Apr\" Then\n                        Set ws = ThisWorkbook.Worksheets(\"APR\")\n                        LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n'other code that works below.\n</code></pre>\n\n<p>With this code I end up with Type Mismatch or nothing gets copied.</p>\n\n<p>I'd like the user to enter a date in the <code>dt.value</code> box and the data paste to the appropriate sheet based on that value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576971308, "post_id": 59440426, "comment_id": 105064963, "body": "The handler runs <i>before</i> a command is selected. It runs before the context menu is even displayed. You could use that to hijack the Delete command / remove it from the context menu and replace it with your own, which you can attach to any macro you like."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576971446, "post_id": 59440426, "comment_id": 105064991, "body": "If you simply want to prevent the user from deleting rows, consider configuring worksheet protection instead."}, {"owner": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576972473, "post_id": 59440426, "comment_id": 105065166, "body": "In my excel file, user is allowed to delete row. But I want to show msgbox before user delete the row. Is there any way to use other than Worksheet_BeforeRightClick?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576973599, "post_id": 59440426, "comment_id": 105065319, "body": "Like I said, hijack the command and replace it with your own &quot;Delete&quot; command, then it can do whatever you like."}, {"owner": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1577005970, "post_id": 59440426, "comment_id": 105069058, "body": "Thank you, it works after I create a new &quot;Delete&quot; command :)"}], "owner": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576968865, "creation_date": 1576968663, "last_edit_date": 1576968865, "question_id": 59440426, "link": "https://stackoverflow.com/questions/59440426/how-to-get-value-before-delete-on-pop-up-menu-right-click-is-clicked", "title": "How to get value before &quot;Delete&quot; on Pop Up menu (right click) is clicked?", "body": "<p>On excel vba, how to run a code before user click <strong>Delete</strong> from <strong>Pop Up Menu</strong> (after right click on row bar)</p>\n\n<p><img src=\"https://i.stack.imgur.com/zf88Q.png\" alt=\"Delete from Pop Up Menu\"></p>\n\n<p>Here is the logic on the code</p>\n\n<pre><code>Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean) \n\nIf delete (from right click on row) clicked Then\n\n    Msgbox \"User want to delete row\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba", "validation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1576967280, "post_id": 59440257, "comment_id": 105064214, "body": "How exactly are the expressions being evaluated in SQL server?  If you want the customer to do the validation then presumably they&#39;d need access to the same execution environment in order to perform the testing."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576967603, "post_id": 59440257, "comment_id": 105064277, "body": "^^ and for supported syntax to be the same."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576969066, "post_id": 59440257, "comment_id": 105064515, "body": "FWIW the <code>Ex</code> in <code>RegEx</code> stands for &quot;Expression&quot; - <code>RegexExpression</code> thus stands for &quot;Regular Expression Expression&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576969276, "post_id": 59440257, "comment_id": 105064571, "body": "VBScript regex and .NET regex are different, and if your expressions use named capture groups or lookbehinds, VBScript regex engine won&#39;t be able to evaluate them: one solution could be to deploy a COM-visible DLL whose TLB (COM type library) your client&#39;s VBA code can reference and call into, so that the expressions are validated using the same regex engine."}, {"owner": {"reputation": 295, "user_id": 1170667, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/66d6d31bbeb5980d18c6d32c8e36a15c?s=128&d=identicon&r=PG", "display_name": "jaczjill", "link": "https://stackoverflow.com/users/1170667/jaczjill"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576972939, "post_id": 59440257, "comment_id": 105065232, "body": "@TimWilliams we are using CLR function in SQL server to use regex and match strings in our texts. We don&#39;t want customer to do any test, just want an easy way (like a button click in Excel) for them to validate regex they are providing."}, {"owner": {"reputation": 295, "user_id": 1170667, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/66d6d31bbeb5980d18c6d32c8e36a15c?s=128&d=identicon&r=PG", "display_name": "jaczjill", "link": "https://stackoverflow.com/users/1170667/jaczjill"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576973003, "post_id": 59440257, "comment_id": 105065239, "body": "@MathieuGuindon Thank you, I know, I just wrote it for more clarity, but it backfired :)"}, {"owner": {"reputation": 295, "user_id": 1170667, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/66d6d31bbeb5980d18c6d32c8e36a15c?s=128&d=identicon&r=PG", "display_name": "jaczjill", "link": "https://stackoverflow.com/users/1170667/jaczjill"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576973189, "post_id": 59440257, "comment_id": 105065260, "body": "@MathieuGuindon: you mean the Regex eg: \\b(residen(ce|tial)|a house|a home)\\b are different in VB and .NET?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576973465, "post_id": 59440257, "comment_id": 105065298, "body": "no, that would be fine (capture groups are ok); it&#39;s <i>named</i> capture groups that aren&#39;t supported. However, if the client&#39;s regex is valid in VBScript, it&#39;s going to be valid in .NET - but the inverse isn&#39;t necessarily true."}], "owner": {"reputation": 295, "user_id": 1170667, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/66d6d31bbeb5980d18c6d32c8e36a15c?s=128&d=identicon&r=PG", "display_name": "jaczjill", "link": "https://stackoverflow.com/users/1170667/jaczjill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576968979, "creation_date": 1576966990, "last_edit_date": 1576968979, "question_id": 59440257, "link": "https://stackoverflow.com/questions/59440257/how-to-validate-regular-expressions-in-excel", "title": "How to validate regular expressions in Excel", "body": "<p>Our customer provides hundreds of regular expressions in an excel file that we need to add in our SQL Server to do pattern matching in database, but many times they send invalid or broken regular expression in their excel file.</p>\n\n<p>We validate the regular expressions in c# by instantiating Regex object with given regular expression, if it is incorrect then error is caught in catch block and we know which expression is invalid.</p>\n\n<pre><code> try\n  {\n    var test = new Regex(rule.RegexExpression);\n  }\n catch (Exception ex)\n  {\n    Errors.Add(\"Error in \" + rule.Id)\n  }\n</code></pre>\n\n<p><strong>Problem:</strong>\nIt gets too late in knowing which regular expressions are incorrect until developer validates data given by customer. </p>\n\n<p><strong>Question:</strong>\nIs there a way in which our customer can validate hundreds of regular expression with a click of a button in excel (something like VBA macro button). I tried VBA Regex, I couldn't validate the regular expression itself.</p>\n\n<p>Any help or clue is appreciated. </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 0, "creation_date": 1576956942, "post_id": 59439171, "comment_id": 105062313, "body": "you could create your own method in your userform for populating the combo and an arg for that method would be your collection. Do the set and then <code>Form1.PopulateCombo(CourtCollection)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 0, "creation_date": 1577006641, "post_id": 59439699, "comment_id": 105069137, "body": "But what if I need my combobox  entries to refer back the entries of the collection? I think it&#39;s better to put 95% of all the code into the Userform itself then, isn&#39;t it?"}, {"owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 0, "creation_date": 1577009733, "post_id": 59439699, "comment_id": 105069724, "body": "Btw, calling this sub from the main module like <code>Form1.UpdateMyBox(courtCollection)</code> doesnt solve the problem of items duplicating every time I call the userform."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "edited": false, "score": 0, "creation_date": 1577044834, "post_id": 59439699, "comment_id": 105077808, "body": "@IgorCheglakov: Comboboxes don&#39;t do anything other than list items. You missed the <code>Clear</code> command (again, not tested but the intent is to clear the box before you populate it whenever you re-use it). And you did not provide enough information in the OP to suggest you were doing anything with the ComboBox, so this answer answers the direct question as posed."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 1, "last_activity_date": 1576960980, "creation_date": 1576960980, "answer_id": 59439699, "question_id": 59439171, "link": "https://stackoverflow.com/questions/59439171/more-entries-in-combo-box-with-every-call/59439699#59439699", "title": "More entries in combo box with every call", "body": "<p>Have a method in the UserForm that accepts a collection and fills the combobox. And then use that method after creating the form, but before showing it. This will give you better control and maintainability of your code.</p>\n\n<p>And <strong>always</strong> use <code>Option Explicit</code> at the top of every module. Always.</p>\n\n<pre><code>Option Explicit\nSub RunUserForm(courtCollection as Collection) ' &lt;-- always reduce the use of globals!\nDim Form1 as UserFormTest\n    Set Form1 = New UserFormTest\n    Form1.UpdateMyBox(courtCollection)\n    ' \u2026 could also have other initialitising actions?\n    Form1.Show vbModeless\nEnd Sub\n</code></pre>\n\n<p>In the Form code itself (not tested):</p>\n\n<pre><code>Option Explicit\nSub UpDateMyBox(values as Collection) ' Assumes standard Collection - modify for a custom Collection.\nDim collectionItem as Variant 'Strongly type this depending on what is expected in the Collection.\n\n    Me.CbbCourt.Clear\n    For Each collectionItem In values\n        Me.CbbCourt.AddItem collectionItem ' I am assuming an ordinary Collection here\n    Next collectionItem \n    Me.CbbCourt.ListIndex = 1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 455, "user_id": 11437189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Cvfhc7JXJKk/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-h1mFuFK8x2_B_15roYP6g3Ey3gsQ/mo/photo.jpg?sz=128", "display_name": "Igor Cheglakov", "link": "https://stackoverflow.com/users/11437189/igor-cheglakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1576960980, "creation_date": 1576955833, "last_edit_date": 1576957431, "question_id": 59439171, "link": "https://stackoverflow.com/questions/59439171/more-entries-in-combo-box-with-every-call", "title": "More entries in combo box with every call", "body": "<p>I have a collection <code>CourtCollection</code> and a userform <code>UserFormTest</code> which includes combobox <code>CbbCourt</code>. I want to populate the combobox with data from the collection and then show the userform. Here's the code: </p>\n\n<pre><code>Sub RunUserForm()\n\n    'Create the exemplar of the form\n    Set Form1 = New UserFormTest\n\n    'Add entries to the combo box from the collection\n    For Each Item In CourtCollection\n        Form1.CbbCourt.AddItem Item.Item(\"CourtName\")\n    Next Item\n    Form1.CbbCourt.ListIndex = 1\n\n    Form1.Show vbModeless\n\nEnd Sub\n</code></pre>\n\n<p>As a result the combobox contains \"item1, item2, item3\" on the first userform call, \"item1, item2, item3 item1, item2, item3\" on the second e.t.c. I understand that it's the exemplar of the userform which persists between calls despite me using <code>New</code> keyword in <code>Set Form1 = New UserFormTest</code>. I tried to put the code into the event <code>UserFormTest_Initialize()</code> but the userform can't \"see\" my collection. What's wrong and what change should I implement?</p>\n"}, {"tags": ["excel", "vba", "autofilter"], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 12282247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NbYCC.jpg?s=128&g=1", "display_name": "Milan Pijanovic", "link": "https://stackoverflow.com/users/12282247/milan-pijanovic"}, "is_accepted": true, "score": 1, "last_activity_date": 1576953020, "creation_date": 1576953020, "answer_id": 59438814, "question_id": 59438627, "link": "https://stackoverflow.com/questions/59438627/vba-delete-rows-autofilter-not-blank/59438814#59438814", "title": "VBA Delete Rows Autofilter NOT BLANK", "body": "<p>I tried around myself and found this code to work (sorry for the filter changements, but you can easily set them according to your needs):</p>\n\n<pre><code>Sub Part2()\n\n\nCells.Select\nApplication.CutCopyMode = False\nSelection.AutoFilter\n\nSelection.AutoFilter Field:=8, Criteria1:=\"Basel\"\n\nIf ActiveSheet.UsedRange.Rows.Count &gt; 1 Then\n'If ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible).Rows.Count &gt; 1 Then\n\n    ActiveSheet.Range(\"2:\" &amp; ActiveSheet.UsedRange.Rows.Count). _\n    SpecialCells(xlCellTypeVisible).Select\n\n    Selection.Delete Shift:=xlUp\n    Selection.AutoFilter\n\nEnd If\nIf ActiveSheet.AutoFilterMode = True Then ActiveSheet.AutoFilterMode = False\n\nEnd Sub\n</code></pre>\n\n<p>Note how I simplified your first if condition (below is your original one). Please let me know, if this works for your purposes.</p>\n"}], "owner": {"reputation": 43, "user_id": 10922888, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-gpAErjpj5W4/AAAAAAAAAAI/AAAAAAAAAE4/TUE8kH9yZOw/photo.jpg?sz=128", "display_name": "TheReddsable", "link": "https://stackoverflow.com/users/10922888/thereddsable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 59438814, "answer_count": 1, "score": 2, "last_activity_date": 1576953020, "creation_date": 1576951556, "question_id": 59438627, "link": "https://stackoverflow.com/questions/59438627/vba-delete-rows-autofilter-not-blank", "title": "VBA Delete Rows Autofilter NOT BLANK", "body": "<p>I am trying to filter my data and delete the entire row if the cell CB is not empty (i want to keep only empty cells). Sometimes it can happen that all my cells are blank</p>\n\n<p>My code is:</p>\n\n<pre><code>Sub Part2()\n\n\nCells.Select\n    Application.CutCopyMode = False\n    Selection.AutoFilter\n\n Selection.AutoFilter Field:=80, Criteria1:=\"&lt;&gt;\"\n\nIf ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible).Rows.Count &gt; 1 Then\n\n        ActiveSheet.Range(\"2:\" &amp; ActiveSheet.UsedRange.Rows.Count).SpecialCells(xlCellTypeVisible).Select\n\n        Selection.Delete Shift:=xlUp\n        Selection.AutoFilter\n\nEnd If\n If ActiveSheet.AutoFilterMode = True Then ActiveSheet.AutoFilterMode = False\n\nEnd Sub\n</code></pre>\n\n<p>However, when I have cells that are not empty, it skips directly to End If and it is not deleting the rows at all. Where is the mistake?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 2410461, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576fada5e8ea85ce0972813ea2b60c14?s=128&d=identicon&r=PG", "display_name": "purpleblau", "link": "https://stackoverflow.com/users/2410461/purpleblau"}, "is_accepted": false, "score": 4, "last_activity_date": 1576953519, "creation_date": 1576953519, "answer_id": 59438879, "question_id": 59438519, "link": "https://stackoverflow.com/questions/59438519/passing-full-directory-path-plus-filename-into-string-variable-using-vba-in-exce/59438879#59438879", "title": "Passing full directory path plus filename into String variable using VBA in Excel?", "body": "<p>It's very simple. I figured it out myself. </p>\n\n<pre><code>strPath2 = \"C:\\\" &amp; Dir(\"C:\\*Hello*.xlsx\")\n</code></pre>\n"}], "owner": {"reputation": 547, "user_id": 2410461, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576fada5e8ea85ce0972813ea2b60c14?s=128&d=identicon&r=PG", "display_name": "purpleblau", "link": "https://stackoverflow.com/users/2410461/purpleblau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577020567, "creation_date": 1576950614, "last_edit_date": 1577020567, "question_id": 59438519, "link": "https://stackoverflow.com/questions/59438519/passing-full-directory-path-plus-filename-into-string-variable-using-vba-in-exce", "title": "Passing full directory path plus filename into String variable using VBA in Excel?", "body": "<p>Borrowed the code and tweaked. Everything worked fine until strPath2 only receives filename instead of the entire file path. After searching there is surprisingly no answer. </p>\n\n<p>I basically want to let Dir find any file that contain the word \"Hello\" in its filename. The start and the end of the filename varies. Is there any function/method that returns the full directory path with filename as String?</p>\n\n<pre><code>Sub TransferData()\n\n\n    Dim strPath2 As String\n    Dim wbkWorkbook1 As Workbook\n    Dim wbkWorkbook2 As Workbook\n\n    strPath2 = Dir(\"C:\\*Hello*.xlsx\")\n\n    Set wbkWorkbook1 = ThisWorkbook \n    Set wbkWorkbook2 = Workbooks.Open(strPath2)\n\n    wbkWorkbook2.Worksheets(\"Sheet1\").Range(\"A1:J20\").Copy\n    wbkWorkbook1.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial xlPasteValues\n\n\nEnd Sub\n</code></pre>\n"}]