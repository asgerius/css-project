[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "edited": false, "score": 1, "creation_date": 1514422224, "post_id": 47999592, "comment_id": 82969197, "body": "How do you mean combine? Do you want it to do both procedures on a single change event? Do you need them done in a specific order? Try to explain your exact problem, and what you have tried, then we can maybe provide a solution."}, {"owner": {"reputation": 535, "user_id": 2854647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/198e1025a309115c12c98888f46f5e88?s=128&d=identicon&r=PG&f=1", "display_name": "Maki", "link": "https://stackoverflow.com/users/2854647/maki"}, "edited": false, "score": 0, "creation_date": 1514422307, "post_id": 47999592, "comment_id": 82969213, "body": "an easy way is to re-name the variables from the second private sub. An example, rng -&gt; rng2 : r -&gt; r2."}, {"owner": {"reputation": 87, "user_id": 9143058, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c068775dc7b21ea0b8e045bb163fa4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Father Goose", "link": "https://stackoverflow.com/users/9143058/father-goose"}, "edited": false, "score": 0, "creation_date": 1514431632, "post_id": 47999592, "comment_id": 82970954, "body": "There are two different Target Ranges both returning Msgbox pendant on range values, but you cant run two Private Sub. I&#39;ve tried Maki example, rng -&gt; rng2 : r -&gt; r2, but just get a Compile error at Next r. As I&#39;m new to VBA i&#39;m a little confused."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 9143058, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c068775dc7b21ea0b8e045bb163fa4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Father Goose", "link": "https://stackoverflow.com/users/9143058/father-goose"}, "edited": false, "score": 0, "creation_date": 1514453137, "post_id": 48002305, "comment_id": 82977779, "body": "Shai your an absolute genius, It work very well, thank you so much for your help really appreciated."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1514441248, "last_edit_date": 1514441248, "creation_date": 1514440728, "answer_id": 48002305, "question_id": 47999592, "link": "https://stackoverflow.com/questions/47999592/combine-two-private-sub-worksheet-changebyval-target-as-range/48002305#48002305", "title": "Combine two Private Sub Worksheet_Change(ByVal Target As Range)", "body": "<p>The code below is a merge of your current 2 <code>Worksheet_Change</code> events.</p>\n\n<p>You can also use <code>Select Case</code> to clean-up your code a little.</p>\n\n<p><strong><em>Code</em></strong>      </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rng As Range, r As Range, rv As Long\n\n    If Not Intersect(Target, Range(\"C77:AD81\")) Is Nothing Then\n        Set rng = Intersect(Target, Range(\"C77:AD81\"))\n        For Each r In rng\n            'Peak Flow Doctor Warning and Weight Gain Warning\n            Select Case r.Value\n                Case 180\n                    MsgBox \"''PEAK FLOW CRITICAL AT 180L/MIN''\" &amp; vbCrLf &amp; \"''PREDNISONE PROBABLY REQUIRED''\" &amp; vbCrLf &amp; \"''MAKE DOCTOR'S APPOINTMENTS ASAP''\", vbInformation, \"WARNING\"    \n                Case 120\n                    MsgBox \"''PEAK FLOW CRITICAL AT 120L/MIN''\" &amp; vbCrLf &amp; \"''MAKE URGENT DOCTOR'S APPOINTMENTS''\" &amp; vbCrLf &amp; \"''OR GO TO A&amp;E IMMEDIATELY''\", vbInformation, \"CRITICAL WARNING\"\n                Case Is &gt;= 450\n                    MsgBox \"''CHECK OR TEST PEAK FLOW METER''\" &amp; vbCrLf &amp; \"''IT MAY BE FAULTY AND GIVING FALSE HIGH's''\", vbInformation, \"WARNING\"\n            End Select\n        Next r\n    End If\n\n    If Not Intersect(Target, Range(\"C93:AD93\")) Is Nothing Then\n        Set rng = Intersect(Target, Range(\"C93:AD93\"))\n        For Each r In rng\n            'Weight Gain Warning\n            Select Case r.Value\n                Case 90\n                    MsgBox \"''LIKELY TO EXACERBATE COPD SYMPTOMS''\" &amp; vbCrLf &amp; \"''CHRONIC ASTHMA OR EMPHYSEMA PROBABLE''\", vbCritical, \"WARNING\"\n                Case 95\n                    MsgBox \"''IF SWELLING IN ANKLES PROBABLE FLUID RETENTION''\" &amp; vbCrLf &amp; \"''POSSIBILITY OF HEART FAILURE IF UNATTENDED''\", vbCritical, \"CRITICAL WARNING\"\n            End Select\n        Next r\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9143058, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c068775dc7b21ea0b8e045bb163fa4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Father Goose", "link": "https://stackoverflow.com/users/9143058/father-goose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "accepted_answer_id": 48002305, "answer_count": 1, "score": 2, "last_activity_date": 1514593080, "creation_date": 1514415564, "last_edit_date": 1514593080, "question_id": 47999592, "link": "https://stackoverflow.com/questions/47999592/combine-two-private-sub-worksheet-changebyval-target-as-range", "title": "Combine two Private Sub Worksheet_Change(ByVal Target As Range)", "body": "<p>I need to combine two <code>Private Sub Worksheet_Change(ByVal Target As Range)</code>\nI'm new to Excel VBA code, how can I do this? Code below.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range, r As Range, rv As Long\n    Set rng = Intersect(Target, Range(\"C77:AD81\"))\n    If rng Is Nothing Then Exit Sub\n    For Each r In rng\n        rv = r.Value\n        'Peak Flow Doctor Warning and Weight Gain Warning\n        If rv = 180 Then\n            MsgBox \"''PEAK FLOW CRITICAL AT 180L/MIN''\" &amp; vbCrLf &amp; \"''PREDNISONE PROBABLY REQUIRED''\" &amp; vbCrLf &amp; \"''MAKE DOCTOR'S APPOINTMENTS ASAP''\", vbInformation, \"WARNING\"\n        End If\n        If rv = 120 Then\n            MsgBox \"''PEAK FLOW CRITICAL AT 120L/MIN''\" &amp; vbCrLf &amp; \"''MAKE URGENT DOCTOR'S APPOINTMENTS''\" &amp; vbCrLf &amp; \"''OR GO TO A&amp;E IMMEDIATELY''\", vbInformation, \"CRITICAL WARNING\"\n        End If\n        If rv &gt;= 450 Then\n            MsgBox \"''CHECK OR TEST PEAK FLOW METER''\" &amp; vbCrLf &amp; \"''IT MAY BE FAULTY AND GIVING FALSE HIGH's''\", vbInformation, \"WARNING\"\n        End If\n\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range, r As Range, rv As Long\n    Set rng = Intersect(Target, Range(\"C93:AD93\"))\n    If rng Is Nothing Then Exit Sub\n    For Each r In rng\n        'Weight Gain Warning\n        rv = r.Value\n        If rv = 90 Then\n            MsgBox \"''LIKELY TO EXACERBATE COPD SYMPTOMS''\" &amp; vbCrLf &amp; \"''CHRONIC ASTHMA OR EMPHYSEMA PROBABLE''\", vbCritical, \"WARNING\"\n        End If\n        If rv = 95 Then\n            MsgBox \"''IF SWELLING IN ANKLES PROBABLE FLUID RETENTION''\" &amp; vbCrLf &amp; \"''POSSIBILITY OF HEART FAILURE IF UNATTENDED''\", vbCritical, \"CRITICAL WARNING\"\n        End If\n      Next r\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1514415665, "post_id": 47999466, "comment_id": 82967725, "body": "Eample <code>[B1].Value = Split([A1], &quot; &quot;)(1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 8448774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/373c1c35bd1eb2386879f34dbc985523?s=128&d=identicon&r=PG&f=1", "display_name": "barooon gara", "link": "https://stackoverflow.com/users/8448774/barooon-gara"}, "edited": false, "score": 0, "creation_date": 1514494072, "post_id": 47999581, "comment_id": 82997225, "body": "hey the program works but since my excel sheet has lot of data points, when I click run the program says &quot;not responding&quot; is there any way I can run the program reliably if there are lot of data points? This excel sheet has 250k data points and I cant lower the amount or split it up."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 113, "user_id": 8448774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/373c1c35bd1eb2386879f34dbc985523?s=128&d=identicon&r=PG&f=1", "display_name": "barooon gara", "link": "https://stackoverflow.com/users/8448774/barooon-gara"}, "edited": false, "score": 0, "creation_date": 1514494367, "post_id": 47999581, "comment_id": 82997344, "body": "That is a question for CodeReview.  You will want to load everything into an array and iterate the array, not the sheet.  Then format the whole column at once.  Iterating a range is very costly.  The not responding means the code is running, be patient it will finish that is a lot of calls to the sheet. @barooongara"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 113, "user_id": 8448774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/373c1c35bd1eb2386879f34dbc985523?s=128&d=identicon&r=PG&f=1", "display_name": "barooon gara", "link": "https://stackoverflow.com/users/8448774/barooon-gara"}, "edited": false, "score": 0, "creation_date": 1515106179, "post_id": 47999581, "comment_id": 83185105, "body": "@barooongara Add <code>DoEvents</code> before line <code>Next Count</code> will make Excel a bit more responsive. It isn&#39;t crashing, just really busy."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1514420451, "last_edit_date": 1514420451, "creation_date": 1514415445, "answer_id": 47999581, "question_id": 47999466, "link": "https://stackoverflow.com/questions/47999466/how-to-split-date-and-time/47999581#47999581", "title": "How to split date and time", "body": "<p>Date/time is a number and not a text string so to get the date you need to plit the integer from the decimal, then format them:</p>\n\n<pre><code>Sub CompareTime()\n\nDim ws As Worksheet\n\nDim lastRow As Long\nDim Count As Long\nDim test As Double\n\nSet ws = ActiveSheet\n\n\n'Find last data point\nWith ws\n    .Columns(2).Insert\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    For Count = 5 To lastRow\n        'split date\n        test = .Cells(Count, 1).Value2\n        .Cells(Count, 1).Value2 = Int(test)\n        .Cells(Count, 1).NumberFormat = \"m/d/yyyy\"\n        .Cells(Count, 1).Offset(0, 1).Value2 = test - Int(test)\n        .Cells(Count, 1).Offset(0, 1).NumberFormat = \"hh:mm AM/PM\"\n\n    Next Count\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1514426556, "creation_date": 1514426556, "answer_id": 48000764, "question_id": 47999466, "link": "https://stackoverflow.com/questions/47999466/how-to-split-date-and-time/48000764#48000764", "title": "How to split date and time", "body": "<p>The other method.  Scott's code more simple.</p>\n\n<pre><code>Sub CompareTime()\n\nDim ws As Worksheet\n\nDim lastRow As Long\nDim arr As Long\nDim test As Double\nDim vDB, vR(), n As Long, i As Long\n\nSet ws = ActiveSheet\n\n\n\n'Find last data point\nWith ws\n    .Cells(1, 2).EntireColumn.Insert\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    vDB = .Range(\"a5\", \"a\" &amp; lastRow)\n\n    n = UBound(vDB, 1)\n    ReDim vR(1 To n, 1 To 2)\n\n    For i = 1 To n\n        vR(i, 1) = DateValue(Format(vDB(i, 1), \"yyyy/mm/dd\"))\n        vR(i, 2) = TimeValue(Format(vDB(i, 1), \"hh:mm\"))\n    Next i\n    .Range(\"a5\").Resize(n, 2) = vR\n    .Columns(1).NumberFormatLocal = \"mm/dd/yyyy\"\n    .Columns(2).NumberFormatLocal = \"hh:mm\"\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 8448774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/373c1c35bd1eb2386879f34dbc985523?s=128&d=identicon&r=PG&f=1", "display_name": "barooon gara", "link": "https://stackoverflow.com/users/8448774/barooon-gara"}, "is_accepted": false, "score": 1, "last_activity_date": 1514492309, "creation_date": 1514492309, "answer_id": 48013858, "question_id": 47999466, "link": "https://stackoverflow.com/questions/47999466/how-to-split-date-and-time/48013858#48013858", "title": "How to split date and time", "body": "<p>So I found a super easy way after messing with the split function. I just used a delimiter of space and split the date from time with AM/PM included.</p>\n\n<pre><code>Sub CompareTime()\n\nDim ws As Worksheet\nDim count As Long\nDim lastRow As Long\nDim arr As Long\nDim store As Double\n\nSet ws = ActiveSheet\n\nCells(1, 2).EntireColumn.Insert\n\n'Find last data point\nWith ws\nlastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nFor Count = 5 To lastRow\n\n'split date\nCells(Count, 1).Offset(0, 1).Value = Split(Cells(Count, 1), \" \")(1) &amp; \" \" &amp; Split(Cells(Count, 1), \" \")(2)\nCells(Count, 1).Value = Split(Cells(Count, 1), \" \")\n\n\nNext Count\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 8448774, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/373c1c35bd1eb2386879f34dbc985523?s=128&d=identicon&r=PG&f=1", "display_name": "barooon gara", "link": "https://stackoverflow.com/users/8448774/barooon-gara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1085, "favorite_count": 0, "accepted_answer_id": 47999581, "answer_count": 3, "score": 1, "last_activity_date": 1561986523, "creation_date": 1514414448, "last_edit_date": 1561986523, "question_id": 47999466, "link": "https://stackoverflow.com/questions/47999466/how-to-split-date-and-time", "title": "How to split date and time", "body": "<p>I would like to know how to split date and time into separate rows.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8kfFQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8kfFQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like Date in Column A and time in Column B with AM/PM included.</p>\n\n<p>I tried with a delimiter of space but I get errors. On the internet people were first selecting cells but I want to do it without selecting cells.</p>\n\n<pre><code>Sub CompareTime()\n\nDim ws As Worksheet\n\nDim lastRow As Long\nDim arr As Long\nDim test As Double\n\nSet ws = ActiveSheet\n\nCells(1, 2).EntireColumn.Insert\n\n'Find last data point\nWith ws\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With    \n\nFor Count = 1 To lastRow\n    'split date\n    Cells(1, Count).Offset(0, 1) = Split(Cells(1, Count).Value, \" \")\nNext Count    \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "autohotkey"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 8883144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/201eb41c52825c0b6695358f2bfb213e?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron_Geng", "link": "https://stackoverflow.com/users/8883144/aaron-geng"}, "edited": false, "score": 0, "creation_date": 1514485044, "post_id": 48004374, "comment_id": 82993376, "body": "I tried that before, but it would give me a type mismatch error at the second command"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 149, "user_id": 8883144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/201eb41c52825c0b6695358f2bfb213e?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron_Geng", "link": "https://stackoverflow.com/users/8883144/aaron-geng"}, "edited": false, "score": 0, "creation_date": 1514539564, "post_id": 48004374, "comment_id": 83009582, "body": "Try using the values of the constants. See edit please."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1514539540, "last_edit_date": 1514539540, "creation_date": 1514451064, "answer_id": 48004374, "question_id": 47999391, "link": "https://stackoverflow.com/questions/47999391/object-variable-not-set-error-91-when-using-ahk-to-close-an-access-application/48004374#48004374", "title": "Object variable not set (Error 91) when using AHK to close an Access Application", "body": "<p>How about closing the form?</p>\n\n<pre><code>acc.DoCmd.OpenForm(\"Form1\")\nacc.DoCmd.Close(acForm, \"Form1\", acSaveNo)\nacc.Quit\n</code></pre>\n\n<p>or with the numeric values for the constants:</p>\n\n<pre><code>acc.DoCmd.OpenForm(\"Form1\")\nacc.DoCmd.Close(2, \"Form1\", 2)\nacc.Quit\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 8883144, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/201eb41c52825c0b6695358f2bfb213e?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron_Geng", "link": "https://stackoverflow.com/users/8883144/aaron-geng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 48004374, "answer_count": 1, "score": 1, "last_activity_date": 1514539540, "creation_date": 1514413853, "last_edit_date": 1514464332, "question_id": 47999391, "link": "https://stackoverflow.com/questions/47999391/object-variable-not-set-error-91-when-using-ahk-to-close-an-access-application", "title": "Object variable not set (Error 91) when using AHK to close an Access Application", "body": "<p>I have an Access Form named \"Form1\", and in the form it has a couple of subs like, Form_Load, Form_Unload, etc.</p>\n\n<p>I want to use an AutoHotKey script to control the opening and closing of the form. </p>\n\n<p>Form opening code:</p>\n\n<pre><code>acc:= ComObjCreate(\"Access.Application\")\nacc.OpenCurrentDatabase(\"\\\\...\\target_database.accdb\")\nacc.Visible := True\nacc.UserControl := True\nacc.DoCmd.OpenForm(\"Form1\")\n</code></pre>\n\n<p>Form closing code:</p>\n\n<pre><code>acc.quit\n</code></pre>\n\n<blockquote>\n  <p>Error 91</p>\n</blockquote>\n\n<p>pops up when it tries to close the application. And the error seems to relate to the Form_Unload sub. It only happens when I use AutoHotKey, I am able to close the Access manually with no problem.</p>\n\n<p>Here is the Code for Form_Unload:</p>\n\n<pre><code>Private Sub Form_Unload(Cancel As Integer)\n' update the data in txt, signal and datetime\nDim fso As New FileSystemObject\n'the file we're going to write to\nDim ts As TextStream\n'open this file to write to it\nSet ts = fso.CreateTextFile(\"\\\\cp-apps01\\ExtruderDataCollector\\TESTING\\log.txt\", True)\nFor Each Key In Module1.dict_pre_Signal.Keys\n    ts.WriteLine (Key &amp; \" \" &amp; Module1.dict_pre_Signal.Item(Key) &amp; \" \" _\n        &amp; DateValue(CStr(Module1.dict_pre_Time.Item(Key))) &amp; \" \" _\n        &amp; TimeValue(CStr(Module1.dict_pre_Time.Item(Key))))\nNext Key\nts.Close\nSet fso = Nothing\nEnd Sub\n</code></pre>\n\n<p>Is there a way that I can close the form or change the form to design view before I close the access application?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1514409643, "creation_date": 1514409643, "answer_id": 47998779, "question_id": 47998724, "link": "https://stackoverflow.com/questions/47998724/access-vba-type-mismatch-on-currentdb-openrecordset/47998779#47998779", "title": "Access VBA: Type mismatch on CurrentDb.OpenRecordset", "body": "<p><code>CurrentDb.OpenRecordset</code> returns a recordset, not a value.</p>\n\n<p>If you want to access the value of a field of the recordset, you can do so by using the <code>.Value</code> property of the desired field in the fields collection:</p>\n\n<pre><code>vcount = CurrentDb.OpenRecordset(SQL).Fields(0).Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1514451439, "post_id": 48002879, "comment_id": 82977004, "body": "<i>DCount</i> is the dead-simple method."}], "tags": [], "owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "is_accepted": true, "score": 1, "last_activity_date": 1514443649, "creation_date": 1514443649, "answer_id": 48002879, "question_id": 47998724, "link": "https://stackoverflow.com/questions/47998724/access-vba-type-mismatch-on-currentdb-openrecordset/48002879#48002879", "title": "Access VBA: Type mismatch on CurrentDb.OpenRecordset", "body": "<p>Some alternative approaches.</p>\n\n<p>Use <strong>TableDefs</strong> to count the number of rows within a specific table:</p>\n\n<pre><code>Dim vcount As Integer\n\nvcount = CurrentDb.TableDefs(\"[Data Processing List]\").RecordCount\n</code></pre>\n\n<p>Use <strong>DCount</strong>:</p>\n\n<pre><code>Dim vcount As Integer\n\nvcount = DCount(\"*\", \"[Data Processing List]\")\n</code></pre>\n\n<p>There's more methods.\nHave a look at this quite interesting article that discusses several methods including performance results for small versus medium sized tables:</p>\n\n<p><a href=\"https://www.devhut.net/2016/02/24/ms-access-vba-get-record-count/\" rel=\"nofollow noreferrer\">MS Access \u2013 VBA \u2013 Get Record Count</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7867367"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 48002879, "answer_count": 2, "score": 1, "last_activity_date": 1514443649, "creation_date": 1514409374, "question_id": 47998724, "link": "https://stackoverflow.com/questions/47998724/access-vba-type-mismatch-on-currentdb-openrecordset", "title": "Access VBA: Type mismatch on CurrentDb.OpenRecordset", "body": "<p>In the following code I get the <code>compile error Type mismatch</code> when I am giving a value to vcount.</p>\n\n<p>The code I use is:</p>\n\n<pre><code>Dim SQL As String\nDim vcount As Integer\n\nSQL = \" SELECT count(*) FROM [Data Processing List];\"\n\nvcount = CurrentDb.OpenRecordset(SQL)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/GPUUm.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GPUUm.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 1875, "user_id": 193567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f442d51bf628329da464d5ecfdcf528?s=128&d=identicon&r=PG", "display_name": "Dylan Brams", "link": "https://stackoverflow.com/users/193567/dylan-brams"}, "edited": false, "score": 0, "creation_date": 1514409367, "post_id": 47998683, "comment_id": 82965812, "body": "Do you need to preserve the ID or can you just use a regular expression to parse it?"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 1875, "user_id": 193567, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f442d51bf628329da464d5ecfdcf528?s=128&d=identicon&r=PG", "display_name": "Dylan Brams", "link": "https://stackoverflow.com/users/193567/dylan-brams"}, "edited": false, "score": 0, "creation_date": 1514409700, "post_id": 47998683, "comment_id": 82965946, "body": "Only need to parse for the name under IT Lead, I do not need to preserve"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1514422994, "last_edit_date": 1514422994, "creation_date": 1514422668, "answer_id": 48000376, "question_id": 47998683, "link": "https://stackoverflow.com/questions/47998683/vba-get-html-element-info-for-changing-id/48000376#48000376", "title": "VBA Get HTML Element Info for Changing Id", "body": "<p>Regarding the supplied code, tl;dr.</p>\n\n<p>But if you are wanting the scratched out portion you supplied in your HTML snippet, the following may work <em>(I can't test something that I don't have access to :D)</em>.</p>\n\n<p>There are many different ways to grab an element, and this method you are grabbing the first instance of the class name <code>dijitReset dijitInputField dijitInputContainer</code>. Class names are not always a unique value, but due to the somewhat complexity of this class name, I feel somewhat safe that in your case it is.</p>\n\n<p>You could have used one line to <code>Set yourObj...</code> but for demonstration purposes I decided to break it up. 1-liner method to <strong>Set</strong> your obj: </p>\n\n<pre><code>Set yourObj = doc.getElementsByClassName(\"dijitReset dijitInputField dijitInputContainer\")(0).getElementsByTagName(\"input\")(1)\n</code></pre>\n\n<h2>Code Snippet:</h2>\n\n<pre><code>Sub getElementFromIE()\n\n    Dim ie As InternetExplorer\n\n    ' ... your above code pulls up webpage ...\n\n    '''''''''''''''''' Find Label ''''''''''''''''''''''''''''\n    Dim doc As HTMLDocument, yourObj As Object\n    Set doc = ie.document\n\n    ' I assume the class name is unique? If so, just append (0) as I did below\n    Set yourObj = doc.getElementsByClassName(\"dijitReset dijitInputField dijitInputContainer\")(0)\n    Set yourObj = yourObj.getElementsByTagName(\"input\")(1)\n    lead = yourObj.Value\n\nEnd Sub\n</code></pre>\n\n<p>The reason for the <code>(1)</code> on <code>Set yourObj = yourObj.getElementsByTagName(\"input\")(1)</code> is because there are 2 <code>input</code> tags after your class <code>dijitReset...</code>. You are wanting the 2nd instance of this tag, which contains your value; and as you are probably already aware, you are using <code>Base 0</code>, meaning the 2nd instance is actually the number 1.</p>\n"}], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 0, "accepted_answer_id": 48000376, "answer_count": 1, "score": 2, "last_activity_date": 1514422994, "creation_date": 1514409010, "question_id": 47998683, "link": "https://stackoverflow.com/questions/47998683/vba-get-html-element-info-for-changing-id", "title": "VBA Get HTML Element Info for Changing Id", "body": "<p>I am trying to create an excel web scraper that logs into my companies ticket tracking system and logs certain information on the sheet (Lead assigned, Desired Date for the project, etc.). I was doing fine until I had to pull a field off the website that has a changing ID. </p>\n\n<p>For example, on two pages the same field will have the IDs: </p>\n\n<ul>\n<li>\"cq_widget_CqFilteringSelect_32\"</li>\n<li>\"cq_widget_CqFilteringSelect_9\"</li>\n</ul>\n\n<p>Can somebody provide guidance to how I should search and paste the \"IT Lead\" value into excel?</p>\n\n<p><a href=\"https://i.stack.imgur.com/YFo5H.png\" rel=\"nofollow noreferrer\">HTML snippet of div</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/DNco2.png\" rel=\"nofollow noreferrer\">Snippet of actual website</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/382km.png\" rel=\"nofollow noreferrer\">Setup in excel</a></p>\n\n<p>Below is what I have so far</p>\n\n<p>I get confused in this area:</p>\n\n<blockquote>\n  <p>lead = objCollection(i).Value</p>\n</blockquote>\n\n<pre><code>Sub CQscrub()\n\nDim i As Long\nDim objElement As Object\nDim objCollection As Object\nDim objCollection2 As Object\nDim ie As InternetExplorer\nDim html As HTMLDocument\nDim numbers() As String\nDim size As Integer\nDim row As Integer\nDim objLead As Object\nDim objLead2 As Object\nDim lead As String\nDim counter As Integer\n\nsize = WorksheetFunction.CountA(Worksheets(1).Columns(1)) - 4\nReDim numbers(size)\n\nFor row = 10 To (size + 10)\n    numbers(row - 10) = Cells(row, 1).Value\n    'Cells(row, 2) = numbers(row - 10)\nNext row\n\n\nSet ie = New InternetExplorer\nie.Height = 1000\nie.Width = 1000\nie.Visible = True\nie.navigate \"http://clearquest/cqweb/\"\n\nApplication.StatusBar = \"Loading http://clearquest/cqweb\"\n\nDo While ie.Busy\n    Application.Wait DateAdd(\"s\", 1, Now)\nLoop\n\nApplication.StatusBar = \"Searching form. Please wait...\"\n'Had these below as comment\nDim WRnumber1 As String\nWRnumber1 = Range(\"A10\").Value\n'Range(\"A6\").Value = WRnumber1\n\n\nDim iLastRow As Integer\nDim Rng As Range\niLastRow = Cells(Rows.Count, \"a\").End(xlUp).row 'last row of A\n\n'Set objCollection = ie.document.getElementsByTagName(\"input\") originally here\nFor counter = 0 To size - 1\n    Set objCollection = ie.document.getElementsByTagName(\"input\")\n    i = 0\n    While i &lt; objCollection.Length\n        If objCollection(i).Name = \"cqFindRecordString\" Then\n            objCollection(i).Value = numbers(counter)\n\n        End If\n        i = i + 1\n    Wend\n    '''''''''''''''''' Find Label ''''''''''''''''''''''''''''\n    Set objCollection = ie.document.getElementsByTagName(\"label\")\n    i = 0\n    While i &lt; objCollection.Length\n        If objCollection(i).innerText = \"IT Lead/Assigned To\" Then\n            lead = objCollection(i).Value\n            'Set objLead = objCollection(i)\n        End If\n        i = i + 1\n    Wend\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n            Range(\"B\" &amp; (iLastRow - (size - counter - 1))).Value = lead\n    Set objElement = ie.document.getElementById(\"cqFindRecordButton\")\n    objElement.Click\n    Do While ie.Busy\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n    Application.Wait (Now + TimeValue(\"0:00:02\"))\nNext counter\n\nie.Quit\nSet ie = Nothing\nSet objElement = Nothing\nSet objCollection = Nothing\n\nApplication.StatusBar = \"\"\nMsgBox \"Done!\"\n\nEnd Sub\n</code></pre>\n\n<p>Note: Website is internal only</p>\n\n<p>Goal: Select Name under \"IT Lead/Assigned To\" field and paste to Excel</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514452269, "post_id": 47998300, "comment_id": 82977369, "body": "To reach the content you are after, you have to hurdle with two <code>iframes</code>."}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1514473936, "post_id": 48005361, "comment_id": 82988055, "body": "Thank you very much! The code worked perfectly. I was just reading about iFrames now and just understanded why anything I tried did not work."}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": true, "score": 0, "last_activity_date": 1514458384, "last_edit_date": 1514458384, "creation_date": 1514455216, "answer_id": 48005361, "question_id": 47998300, "link": "https://stackoverflow.com/questions/47998300/get-a-single-value-from-a-table-with-no-id-with-vba/48005361#48005361", "title": "Get a single value from a table with no ID with VBA", "body": "<p>This is how you can get the data from that page. It was needed to switch two <code>iframes</code> from that page to reach the required content.</p>\n\n<pre><code>Sub Aduanet_Info()\n    Dim IE As New InternetExplorer, html As HTMLDocument\n    Dim elem As Object, frm As Object, frm1 As Object\n\n    With IE\n        .Visible = False\n        .navigate \"http://www.aduanet.gob.pe/itarancel/arancelS01Alias\"\n        Do While .readyState &lt;&gt; READYSTATE_COMPLETE: Loop\n        Set html = .document\n    End With\n\n    html.getElementsByTagName(\"input\")(0).Value = \"3303000000\"\n    html.getElementsByTagName(\"input\")(3).Click\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n    Set frm = html.getElementsByClassName(\"autoHeight\")(0).contentWindow.document\n    Set frm1 = frm.getElementsByClassName(\"autoHeight\")(1).contentWindow.document\n\n    For Each elem In frm1.getElementsByTagName(\"td\")\n        If InStr(elem.innerText, \"Valorem\") &gt; 0 Then MsgBox elem.NextSibling.NextSibling.innerText: Exit For\n    Next elem\n\n    IE.Quit\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>6%\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 48005361, "answer_count": 1, "score": 0, "last_activity_date": 1514458384, "creation_date": 1514406739, "last_edit_date": 1514407151, "question_id": 47998300, "link": "https://stackoverflow.com/questions/47998300/get-a-single-value-from-a-table-with-no-id-with-vba", "title": "Get a single value from a table with no ID with VBA", "body": "<p>I am developing a web bot that scrapes the importation taxes from different countries customs website, and I have a problem retrieving the value I want from the following site : <a href=\"http://www.aduanet.gob.pe/itarancel/arancelS01Alias\" rel=\"nofollow noreferrer\">http://www.aduanet.gob.pe/itarancel/arancelS01Alias</a> , using the test value 3303000000 next to CODIGO. The value I want to retrieve is the 6% next to \"Ad / Valorem\", but the table it is in has no ID properties nor class or something relevant to get directly to it or at least near to it. I have been trying to use .parent and .child methods, but without success. My code so far is as follows:</p>\n\n<pre><code>Function Peru(partida As String) As String\n\n'Open IE\nSet objIE = New InternetExplorer\nobjIE.Visible = True\nobjIE.navigate \"http://www.aduanet.gob.pe/itarancel/arancelS01Alias\"\n\n'Load sub\nCargar\n\n'Navigate further into the website (Im using partida = 3303000000)\nFor Each box In objIE.document.getElementsByTagName(\"input\")\n    If box.Name = \"cod_partida\" Then\n        box.Value = partida\n        Exit For\n    End If\nNext\n\nFor Each boton In objIE.document.getElementsByTagName(\"input\")\n    If boton.Value = \"Consultar\" Then\n        boton.Click\n        Exit For\n    End If\nNext\n\n'Get the 6% value (This part is the one I cant figure out)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514405070, "post_id": 47997866, "comment_id": 82964292, "body": "Hello, will this make fruits be a wild card? So if I type in &quot;ap&quot; i would get apple apricot etc?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514405254, "post_id": 47997866, "comment_id": 82964370, "body": "yes Instr will return a number greater than <code>0</code> if that part is found."}, {"owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514405995, "post_id": 47997866, "comment_id": 82964630, "body": "Works Great! Thanks again for your help!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1514404775, "last_edit_date": 1514404775, "creation_date": 1514404294, "answer_id": 47997866, "question_id": 47997808, "link": "https://stackoverflow.com/questions/47997808/create-a-search-with-wildcard/47997866#47997866", "title": "Create a search with wildcard", "body": "<p>When only doing one you do not need the IIF from your last question.</p>\n\n<p>You do not need the Copy line.  And avoid Select.</p>\n\n<pre><code>finalrow = dsheet.Cells(Rows.Count, 1).End(xlUp).Row\n\n\nFor i = 1 To finalrow\n    If fruit = \"\" Or InStr(dsheet.Cells(i, 1),fruit) &gt; 0 Then\n        ssheet.Range(\"A100\").End(xlUp).Offset(1, 0).Resize(1, 8).Value = dsheet.Range(dsheet.Cells(i, 1), dsheet.Cells(i, 8)).Value\n    End If\nNext i\n</code></pre>\n\n<p>If you want the IIF, because you simplified it for this question:</p>\n\n<pre><code>If IIf(fruit &lt;&gt; \"\", InStr(dsheet.Cells(i, 1),fruit) &gt; 0, True) Then\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 47997866, "answer_count": 1, "score": 0, "last_activity_date": 1514407146, "creation_date": 1514403957, "last_edit_date": 1514407146, "question_id": 47997808, "link": "https://stackoverflow.com/questions/47997808/create-a-search-with-wildcard", "title": "Create a search with wildcard", "body": "<p>I want to be able to have a two search fields that are able to be searched using a wildcard.</p>\n\n<p>For example: I have a search field where I can search for fruit.  I want to be able to put in \"app\" or \"Ch\" and it pull the results out for me.  </p>\n\n<p>Most codes I have seen only work if you know what to search for, but my string will always change.  </p>\n\n<p>Here is the code below that searches for the fruit but matches it.</p>\n\n<pre><code>sheet.Select\nfinalrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n\nFor i = 1 To finalrow\n  If IIf(fruit &lt;&gt; \"\", Cells(i, 1) = fruit, True) Then\n    Range(Cells(i, 1), Cells(i, 8)).Copy\n    ssheet.Range(\"A100\").End(xlUp).Offset(1, 0).Resize(1, 8).Value = \n    Range(Cells(i, 1), Cells(i, 8)).Value\n\n    dsheet.Select\n\n  End If\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1514403187, "post_id": 47997638, "comment_id": 82963535, "body": "<a href=\"https://stackoverflow.com/questions/5181164/progress-bar-in-vba-excel\" title=\"progress bar in vba excel\">stackoverflow.com/questions/5181164/progress-bar-in-vba-exce&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1514403682, "post_id": 47997638, "comment_id": 82963730, "body": "You will need to use <code>Me.Repaint</code> within the form somewhere where the form updates the progress. You can try <code>UserForm1.Repaint</code> right after your <code>If</code> statement, but I am unsure if that will update it"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1514405125, "post_id": 47997638, "comment_id": 82964317, "body": "Wait - it takes <i>20 minutes</i> to run? I know you have a lot of sheets, but there is likely a quicker way...Perhaps filter the ranges out, delete those rows left? Perhaps take this over to <a href=\"https://codereview.stackexchange.com/\">CodeReview</a> if it works.  Adding a percent bar is secondary, IMO, to getting this tweaked for efficiency.  Currently going cell by cell is going to take, as you note, a long time."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "edited": false, "score": 0, "creation_date": 1514482864, "post_id": 47998671, "comment_id": 82992381, "body": "Holy great Scott Batman.....thank you guys. So it took less than 30 seconds. Nothing more humbling than this."}, {"owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "edited": false, "score": 0, "creation_date": 1514482972, "post_id": 47998671, "comment_id": 82992438, "body": "I do have a quick follow-up to this - The last worksheet uses a vlookup to find totals from the other worksheets. As a result of the array formulas, the last sheet pulls #NUM errors and with this upgraded code they get deleted. Is there a way to have the above skip the last worksheet in the workbook?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "edited": false, "score": 0, "creation_date": 1514485168, "post_id": 47998671, "comment_id": 82993417, "body": "@SeanPakulski - Inside the <code>For</code> loop, before the <code>With sh</code> statement create an <code>IF sh.Name &lt;&gt; &quot;LastSheetName&quot; (replace with actual name) Then</code> and close out with <code>End If</code> in appropriate place."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1514409460, "last_edit_date": 1514409460, "creation_date": 1514408936, "answer_id": 47998671, "question_id": 47997638, "link": "https://stackoverflow.com/questions/47997638/userform-vba-progress-bar-associated-with-workbook-completion/47998671#47998671", "title": "Userform VBA Progress Bar Associated with Workbook Completion", "body": "<p>In support of @BruceWayne's comment, try this approach instead and see if you run-time decreases <strong>significantly</strong>:</p>\n\n<p>Three important features in this code to save time are:</p>\n\n<ol>\n<li>Turning off calculations (each row delete statement will trigger a re-calc of the workbook)</li>\n<li>Use of SpecialCells to find all possible error cells in one shot!</li>\n<li>Deleting rows 1 time per sheet. Each delete call takes up processing time.</li>\n</ol>\n\n<p>Code below:</p>\n\n<pre><code>Option Explicit\n\nSub DelNUM()\n\n    Dim LR As Long\n    Dim i As Long\n    Dim sh As Worksheet\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    For Each sh In Worksheets\n\n        With sh\n\n            LR = .Range(\"B\" &amp; sh.Rows.Count).End(xlUp).Row\n\n            Dim formulaErrors As Range\n            On Error Resume Next 'bc there may not be any error cells\n            Set formulaErrors = .Range(\"B1:B\" &amp; LR).SpecialCells(xlCellTypeFormulas, xlErrors)\n            On Error GoTo 0 'turn error catch back on\n\n            If Not formulaErrors Is Nothing Then\n\n                formulaErrors.EntireRow.Delete 'now we delete all error rows at once\n                Set formulaErrors = Nothing 'reset for next loop\n\n            End If\n\n        End With\n\n    Next\n\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p>This way you may not need a progress bar :)</p>\n"}], "owner": {"reputation": 19, "user_id": 8053903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40f4a2714e9cde440c94ea18655cb321?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Pakulski", "link": "https://stackoverflow.com/users/8053903/sean-pakulski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 47998671, "answer_count": 1, "score": 0, "last_activity_date": 1514409460, "creation_date": 1514403030, "last_edit_date": 1514403192, "question_id": 47997638, "link": "https://stackoverflow.com/questions/47997638/userform-vba-progress-bar-associated-with-workbook-completion", "title": "Userform VBA Progress Bar Associated with Workbook Completion", "body": "<p>I have a very large spreadsheet that currently has 129 tabs. In short, the below macro gets rid of all the array formula errors(#NUM) for each worksheet. This takes about 15-20 minutes but I want to know how close the macro is to finishing. </p>\n\n<p>I designed a Userform progress bar without an issue and I have the code properly referencing the macro. It all works fine except the part that updates the actual Label in the Userform. How can I add code to define what percentage complete the macro is? I am assuming I need to use \"current worksheets completed/total worksheet\" but I'm extremely new to Userforms.</p>\n\n<pre><code>Sub DelNUM()\n  Dim LR As Long\n  Dim i As Long\n  Dim sh As Worksheet\n\n  For Each sh In Worksheets\n    LR = sh.Range(\"B\" &amp; sh.Rows.Count).End(xlUp).Row\n    For i = LR To 1 Step -1\n        If IsError(sh.Range(\"B\" &amp; i)) Then sh.Rows(i).Delete\n    Next i\n  Next\nEnd Sub\n</code></pre>\n\n<p>I already looked at the following link but it is for someone with more experience than me so I am having trouble following it: <a href=\"https://support.microsoft.com/en-us/help/211736/how-to-display-a-progress-bar-with-a-user-form-in-excel\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/211736/how-to-display-a-progress-bar-with-a-user-form-in-excel</a></p>\n\n<p>Any and all help would be appreciated.</p>\n\n<p>Thank you,</p>\n\n<p>Sean</p>\n"}, {"tags": ["excel", "vba", "function", "replace", "excel-formula"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1514403788, "post_id": 47997627, "comment_id": 82963778, "body": "also this array formula will do what you want: <code>=LEFT(B1,MIN(FIND({&quot;(&quot;,&quot;)&quot;,&quot;-&quot;,&quot;&#47;&quot;,&quot;,&quot;},B1&amp;&quot;()-&#47;,&quot;))-1)</code>  confirm with Ctrl-shift-Enter instead of Enter."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1514409048, "last_edit_date": 1514409048, "creation_date": 1514408614, "answer_id": 47998630, "question_id": 47997627, "link": "https://stackoverflow.com/questions/47997627/replace-multiple-instances-of-characters-in-vba/47998630#47998630", "title": "Replace Multiple Instances of Characters in VBA", "body": "<pre><code>Function CharacterSwap(text)\n\nDim Old As Variant\nDim Comma As Variant\n\nOld = Array(\")\", \"(\", \"-\", \"/\")\nComma = Array(\",\", \",\", \",\", \",\")\n\nFor i = LBound(Old) To UBound(Old)\n    If InStr(1, text, Old(i), vbBinaryCompare) &gt; 0 Then\n        'adjust the text in the text variable to maintain the changes\n        text = Replace(text, Old(i), Comma(i), 1, 1, vbBinaryCompare)\n    End If\nNext i\n\nCharacterSwap = text\n\nEnd Function\n\nFunction SCRUB(text)\nDim newtext As String\n'put output into a variable to avoid the multiple calls\nnewtext = CharacterSwap(text)\n\nIf InStr(1, newtext, \",\", vbBinaryCompare) &gt; 0 Then\n    SCRUB = Left(newtext, InStr(1, newtext, \",\") - 1)\nElse\n\nSCRUB = text\n\nEnd If\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>But this simple function will do all that in fewer lines:</p>\n\n<pre><code>Function Scrub(text)\nWith Application\n    Scrub = Left(text, .Min(.Find(Array(\"(\", \")\", \"-\", \"/\", \",\"), text &amp; \"()-/,\")) - 1)\nEnd With\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1514427072, "last_edit_date": 1514427072, "creation_date": 1514426531, "answer_id": 48000758, "question_id": 47997627, "link": "https://stackoverflow.com/questions/47997627/replace-multiple-instances-of-characters-in-vba/48000758#48000758", "title": "Replace Multiple Instances of Characters in VBA", "body": "<p>You can also accomplish this in VBA using Regular Expressions.\nIf I understand you correctly, you want to replace any/all characters in the set of <code>()/-</code> within a string with a comma.</p>\n\n<pre><code>Option Explicit\nFunction CharacterSwap(S As String) As String\n    Dim RE As Object\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .Pattern = \"[()/-]\"\n    .Global = True\n    CharacterSwap = .Replace(S, \",\")\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>If you should happen to add characters to the character class in <code>.Pattern</code> above, you should be aware the that dash <code>-</code> must either be the first or last character listed in the class.  </p>\n\n<p>If it is anywhere else, it will be interpreted as indicating a range of characters bounded by the preceding and following characters.  </p>\n\n<p>In other words</p>\n\n<ul>\n<li><code>[0-9]</code> would include all of the digits.  </li>\n<li><code>[-09]</code> would include only the <code>dash</code>, <code>0</code> and <code>9</code></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 9146584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c6b47139b2419fae7d1341cffba7683?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Morris", "link": "https://stackoverflow.com/users/9146584/jessica-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1293, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1514427072, "creation_date": 1514402957, "last_edit_date": 1514408365, "question_id": 47997627, "link": "https://stackoverflow.com/questions/47997627/replace-multiple-instances-of-characters-in-vba", "title": "Replace Multiple Instances of Characters in VBA", "body": "<p>I have the following formula that I want to convert to a function in VBA.</p>\n\n<pre><code>=IFERROR(LEFT(B1,(FIND(\",\",SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(B1,\"(\",\",\"),\"-\",\",\"),\"/\",\",\"))-1)),SUBSTITUTE(B1,\".\", \"\"))\n</code></pre>\n\n<p>I've tried a few things, but just can't get it to work correctly. \n<a href=\"https://i.stack.imgur.com/MG8El.jpg\" rel=\"nofollow noreferrer\">Test</a></p>\n\n<pre><code>Function CharacterSwap(text)\n\nDim Old As Variant\nDim Comma As Variant\n\nOld = Array(\")\", \"(\", \"-\", \"/\")\nComma = Array(\",\", \",\", \",\", \",\")\n\nFor i = LBound(Old) To UBound(Comma)\n\n\n    If InStr(1, text, Old(i), vbBinaryCompare) &gt; 0 Then\n\n        CharacterSwap = Replace(text, Old(i), Comma(i), 1, 1, vbBinaryCompare)\n\n    End If\n\n\nNext i\n\nEnd Function\n\nFunction SCRUB(text)\n\nIf InStr(1, CharacterSwap(text), \",\", vbBinaryCompare) &gt; 0 Then\n\n\nSCRUB = Left((CharacterSwap(text)), InStr(1, (CharacterSwap(text)), \",\") - 1)\n\nElse\n\nSCRUB = text\n\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514400310, "post_id": 47997048, "comment_id": 82962376, "body": "What have you tried? There are myriad examples of loops with VBA online."}, {"owner": {"reputation": 1, "user_id": 2108638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5a4965069afddce0f70e7a2c264a2?s=128&d=identicon&r=PG", "display_name": "redds1", "link": "https://stackoverflow.com/users/2108638/redds1"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514402789, "post_id": 47997048, "comment_id": 82963381, "body": "I have posted my code here. It works fine but I am not able to put it in a for loop. I am not able to define numbers in the range to copy the entire column"}, {"owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "edited": false, "score": 0, "creation_date": 1514403422, "post_id": 47997048, "comment_id": 82963629, "body": "If your problem is referencing a range dynamically, you might want to look into using Cells().....See <a href=\"http://excelmatters.com/referring-to-ranges-in-vba/\" rel=\"nofollow noreferrer\">excelmatters.com/referring-to-ranges-in-vba</a>"}, {"owner": {"reputation": 1, "user_id": 2108638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5a4965069afddce0f70e7a2c264a2?s=128&d=identicon&r=PG", "display_name": "redds1", "link": "https://stackoverflow.com/users/2108638/redds1"}, "edited": false, "score": 0, "creation_date": 1514404071, "post_id": 47997048, "comment_id": 82963887, "body": "I tried to replace: ws1.Range(&quot;B1&quot;).EntireColumn.Copy Destination:=ws3.Range(&quot;B1&quot;) with ws1.Range.Cells(2).EntireColumn.Copy Destination:=ws3.Range(2) ws1.Range(2, 1).EntireColumn.Copy Destination:=ws3.Range(2, 1) it does not work"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1514409756, "post_id": 47997048, "comment_id": 82965966, "body": "As Fred has mention in the comments, use <code>.Cells()</code> this will complete your task"}, {"owner": {"reputation": 1, "user_id": 2108638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5a4965069afddce0f70e7a2c264a2?s=128&d=identicon&r=PG", "display_name": "redds1", "link": "https://stackoverflow.com/users/2108638/redds1"}, "edited": false, "score": 0, "creation_date": 1514412716, "post_id": 47997048, "comment_id": 82966923, "body": "ws1.Range(Cells(1, 2), Cells(lastrow, 2)).EntireColumn.Copy Destination:=ws3.Range(Cells(1, 2), Cells(lastrow, 2)) does not work"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514413272, "post_id": 47997048, "comment_id": 82967067, "body": "you define lastrow first, yes? dim lastrow as double say STARTCol = 1 count your columns with data and do a for loop on i until colnum-1, **there are a couple ways to do this lastrow  = ws1.Cells(ws1.Rows.Count, STARTCol + i).End(xlUp).Row // then the copy should work"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514413834, "post_id": 47997048, "comment_id": 82967261, "body": "here is code to find the last column with data:<a href=\"https://stackoverflow.com/a/11927387/8716187\">stackoverflow.com/a/11927387/8716187</a>  so you want to watch out for dynamic amount of cols and rows in each col, definitely a for loop with lastrow found for each col with data, then the copies should be straight forward using the range(cells(row,col),cells(row,col)) method always put the worksheet in front of range . .  .I see some ambiguity in the code . . sure a reference is to the sheet with calling code, but never leave it open"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514414160, "post_id": 47997048, "comment_id": 82967344, "body": "you are going to have counters running on column for sure.  Sounds like once you have col 1 from first sheet and col 1 from second sheet, you will have to place them side by side, col1, col2 and then find the difference in col3, BUT . . . you can just do this all in place with no copies, you can run through col1 on A and compare to Col1 on B, if not found place in a running row counter on C in Col 1.  You will have to reverse it as well and search for col 1 B in Col 1 A and place in your running counter on C col 1.  No copying and the comparison gets done, for each column. That will be fun."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514414237, "post_id": 47997048, "comment_id": 82967365, "body": "great for loop counter exercise.  but that is what vba is for, it will chew up this project in no time.  a unique value finder between two columns, repeated for as many columns as there are in sheets A and B.  Cool.  In the end C will hold the difference in columns for sheets A and B, yes?"}, {"owner": {"reputation": 1, "user_id": 2108638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5a4965069afddce0f70e7a2c264a2?s=128&d=identicon&r=PG", "display_name": "redds1", "link": "https://stackoverflow.com/users/2108638/redds1"}, "edited": false, "score": 0, "creation_date": 1514414543, "post_id": 47997048, "comment_id": 82967424, "body": "I am defining the last row as: lastrow = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row. It is retrieving the correct value. But  ws1.Range(Cells(1, 2), Cells(lastrow, 2)).EntireColumn.Copy Destination:=ws3.Range(Cells(1, 2), Cells(lastrow, 2)) is throwing an error. I get a run time error 1004: method range failed. Even if I hard code the rows and columns, it does not work. Please help"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514472179, "post_id": 47997048, "comment_id": 82987137, "body": "Did you get what I was saying earlier?  You don&#39;t have to copy anything.  Compare ws1.cells(row y, col i) to ws2.cells(row y, col i) and build a unique list in ws3.cells(row y, col i).  be sure that after running through ws1.cells(row y, col i) against ws2.cells(row y, col i) that you reverse it and compare ws2.cells(row y, col i) to ws1.cells(row y, col i)."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514472290, "post_id": 47997048, "comment_id": 82987209, "body": "I am trying to figure out if you are trying to identify items in ws1 col i not in ws2 col i AND items in ws2 col i that are not in ws1 col i.  Or if rather you want to compare each cell and only record if they are different.  If you want to simply look for differences row by row it a different approach."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514475314, "post_id": 47997048, "comment_id": 82988698, "body": "it looks as though you are finding the mathematical difference between the two columns, that would be a different solution."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514478282, "post_id": 47997048, "comment_id": 82990218, "body": "one solution to provide the mathematical difference without the copy, one solution that copies the values and then performs the calculation.  Depends on your usage I suppose, but I hope this gets you closer to what you want."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514479031, "post_id": 47997048, "comment_id": 82990566, "body": "and I looked into your method and since you are defining a range that is not the entire column, the entire column copy is similar to selecting a column (highlighting it all) and hitting CRTL+C, it copies the whole column (actually it probably determines the last row with data) but you get the idea."}, {"owner": {"reputation": 1, "user_id": 2108638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5a4965069afddce0f70e7a2c264a2?s=128&d=identicon&r=PG", "display_name": "redds1", "link": "https://stackoverflow.com/users/2108638/redds1"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514828843, "post_id": 47997048, "comment_id": 83075655, "body": "@Wookies-Will-Code, for some reason I was not able to see these comments. Thanks a lot. I used your code below and I was able to see the difference. But I have different types of data in both sheets. It seems I would need to look up the data type. Please see below:Sheet1:\t\t\t\tSheet2:\t\t A\tTotal\tColumn1\t\tA\tTotal\tColumn1 1\t100\t10\t\t1\t300\t10 2\t200\t20\t\t4\t100\t20 3\t300\t30\t\t\t\t \t\t\t\t\t\t \t\t\t\t\t\t \tSheet3:\t\t\t\t\t A\tTotal-Sheet1\tTotal-Sheet2\tDifference\tColumn1-Sheet1\tColumn&zwnj;&#8203;1-Sheet2\tDifference 1\t100\t300\t-200\t10\t10\t0 2\t200\t0\t200\t20\t0\t20 3\t300\t0\t300\t30\t0\t30 4\t0\t100\t-100\t0\t20\t-20"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2108638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5a4965069afddce0f70e7a2c264a2?s=128&d=identicon&r=PG", "display_name": "redds1", "link": "https://stackoverflow.com/users/2108638/redds1"}, "edited": false, "score": 0, "creation_date": 1514829482, "post_id": 48010633, "comment_id": 83075821, "body": "I have edited the question to include the link to &quot;Data in the Sheets&quot;. I understand your code above and I was able to make it work with certain modifications. But my bad that I did not realize that the first column can have different items in sheet 1 and sheet 2 and I need to look up the data in the first column and then copy the values. Could you please assist? Also, please note that the data in the first column of both sheets will be always a string.Happy New Year!"}, {"owner": {"reputation": 1, "user_id": 2108638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5a4965069afddce0f70e7a2c264a2?s=128&d=identicon&r=PG", "display_name": "redds1", "link": "https://stackoverflow.com/users/2108638/redds1"}, "edited": false, "score": 0, "creation_date": 1514842921, "post_id": 48010633, "comment_id": 83079153, "body": "I have created a new question for clarity: Please see the link: <a href=\"https://stackoverflow.com/questions/48053440/how-to-search-data-from-two-different-sheets-and-copy-them-to-a-third-sheet\" title=\"how to search data from two different sheets and copy them to a third sheet\">stackoverflow.com/questions/48053440/&hellip;</a>"}], "tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": false, "score": 0, "last_activity_date": 1514477048, "creation_date": 1514477048, "answer_id": 48010633, "question_id": 47997048, "link": "https://stackoverflow.com/questions/47997048/how-to-copy-data-from-two-different-sheets-in-excel-vba-dynamically/48010633#48010633", "title": "How to copy data from two different sheets in excel VBA dynamically?", "body": "<p>Alright, to find the difference between each cell in each column respectively between sheet A and sheet B and place it in the respective cell on sheet C, no copying required, unless you really want that we can configure the answer for that if it is a requirement.  Here is a macro that operates on 3 worksheets, taking the difference of sheet 1 and sheet 2 and placing it in sheet 3, column by column, cell by cell.  It determines the number of columns with data, it determines the last row of data in the column.  Will the columns on sheet A and B always be of the same length?  Let me know if this helps you.</p>\n\n<pre><code>Sub diff_macro()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\n\nDim coli As Double\nDim rowy As Double\n\nDim numCols As Double\nDim startRow As Double\nDim lastRow As Double\n\nstartRow = 1 'assuming data starts in column 1\n\nSet ws1 = ThisWorkbook.Worksheets(\"Sheet1\")\nSet ws2 = ThisWorkbook.Worksheets(\"Sheet2\")\nSet ws3 = ThisWorkbook.Worksheets(\"Sheet3\")\n\n'Find how many columns there are in sheet1 based on data in row 1\nnumCols = ws1.Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor coli = 1 To numCols\n    'Find last Data row in the given column in sheet1\n    lastRow = ws1.Cells(ws1.Rows.Count, coli).End(xlUp).Row\n\n    For rowy = 1 To lastRow ' go through each row and perform the difference calculation\n        ws3.Cells(rowy, coli) = (ws1.Cells(rowy, coli).Value) - (ws2.Cells(rowy, coli).Value)\n\n    Next rowy ' move to the next row on ws1, ws2, ws3\n\nNext coli 'move to next column on ws1, ws2, ws3\n\n\nEnd Sub\n</code></pre>\n\n<p>Cheers, WWC</p>\n"}, {"tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": false, "score": 0, "last_activity_date": 1514478145, "creation_date": 1514478145, "answer_id": 48010883, "question_id": 47997048, "link": "https://stackoverflow.com/questions/47997048/how-to-copy-data-from-two-different-sheets-in-excel-vba-dynamically/48010883#48010883", "title": "How to copy data from two different sheets in excel VBA dynamically?", "body": "<p>If you really want (1) sheet A value then (2) sheet B value then the (3) difference, here is simple modification to the macro that copies A, copies B, then performs the Calc, there will be a a lot of columns in sheet C because you are generating 3 cols for every col in sheet A.  But this does the trick.  If you have headers for the columns then startRow should be 2.  You could run a separate for loop to put the headers on C or write an if statement based on row 1 that acts differently from the rest in the current for loop.</p>\n\n<p>Here it is, slightly modified to \"copy\" the cols over to sheet C:</p>\n\n<pre><code>Sub diff_macro()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\n\nDim coli As Double\nDim Coli3 As Double\nDim rowy As Double\n\nDim numCols As Double\nDim startRow As Double\nDim lastRow As Double\n\nstartRow = 1 'assuming data starts in column 1\nColi3 = 1 ' start the columns out on ws3 at column 1\n\nSet ws1 = ThisWorkbook.Worksheets(\"Sheet1\")\nSet ws2 = ThisWorkbook.Worksheets(\"Sheet2\")\nSet ws3 = ThisWorkbook.Worksheets(\"Sheet3\")\n\n'Find how many columns there are in sheet1 based on data in row 1\nnumCols = ws1.Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor coli = 1 To numCols\n    'Find last Data row in the given column in sheet1\n    lastRow = ws1.Cells(ws1.Rows.Count, coli).End(xlUp).Row\n\n    For rowy = 1 To lastRow\n        ws3.Cells(rowy, Coli3).Value = ws1.Cells(rowy, coli).Value ' copy sheet 1 to the right spot of sheet 3\n        ws3.Cells(rowy, Coli3 + 1).Value = ws2.Cells(rowy, coli).Value 'copy sheet 2 to the right spot of sheet 3\n        'perform calculation and place in the right spot on sheet 3\n        ws3.Cells(rowy, Coli3 + 2).Value = (ws1.Cells(rowy, coli).Value) - (ws2.Cells(rowy, coli).Value)\n\n    Next rowy ' move to the next row on ws1, ws2, ws3\n\n    'Since we are placing 3 cols at a time in sheet 3 we increment differently\n    Coli3 = Coli3 + 3 '1 becomes 4, 4 becomes 7, 7 becomes 10 and so on\n\nNext coli 'move to next column on ws1, ws2\n\nEnd Sub\n</code></pre>\n\n<p>Hopefully these get you closer to being where you want.\nCheers, WWC</p>\n"}, {"tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": false, "score": 0, "last_activity_date": 1514478917, "creation_date": 1514478917, "answer_id": 48011050, "question_id": 47997048, "link": "https://stackoverflow.com/questions/47997048/how-to-copy-data-from-two-different-sheets-in-excel-vba-dynamically/48011050#48011050", "title": "How to copy data from two different sheets in excel VBA dynamically?", "body": "<p>One more answer, this one helps you out with your attempted code.  You already define the column in a range by defining the first and last row, let go of the entirecolumn copy.  Also you don't need to specify a range (sized) for the copy, just pick the top cell or another cell in the target column.  These two lines work fine so if you want to stick with your code then modify accordingly.  This copies the contents of the column on sheet A to sheet C, easy enough to do the same for B.  But it works.  Dump the entirecolumn copy if you define the range, I am guessing the entire column copy would only require the column number and would not want a range.</p>\n\n<pre><code>'Find how many columns there are in sheet1 based on data in row 1\nnumCols = ws1.Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor coli = 1 To numCols\n    'Find last Data row in the given column in sheet1\n    lastRow = ws1.Cells(ws1.Rows.Count, coli).End(xlUp).Row\n\n    ws1.Range(Cells(1, coli), Cells(lastRow, coli)).Copy 'you defined the range you don't need anything else\n    ws3.Cells(1, coli).PasteSpecial 'you can place conditions here if you wish\n\nNext coli 'move to next column on ws1, ws2\n</code></pre>\n\n<p>There you go.\n-WWC</p>\n"}], "owner": {"reputation": 1, "user_id": 2108638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5a4965069afddce0f70e7a2c264a2?s=128&d=identicon&r=PG", "display_name": "redds1", "link": "https://stackoverflow.com/users/2108638/redds1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1514830126, "creation_date": 1514399668, "last_edit_date": 1514830126, "question_id": 47997048, "link": "https://stackoverflow.com/questions/47997048/how-to-copy-data-from-two-different-sheets-in-excel-vba-dynamically", "title": "How to copy data from two different sheets in excel VBA dynamically?", "body": "<p>I have two different worksheets. I have to copy the first column(A) from first sheet. Based upon the string in the first column, copy the data form the first column, copy the second column(B) from first sheet, copy the second column(B) from second sheet and then find out the difference between the two copied columns. All this data will be pasted into a new sheet. Repeat the process to copy the third column(C) from first sheet, copy the third column(C) from second sheet and then find out the difference. This process is repeated until the last column. </p>\n\n<p>How to make the code dynamic such that it looks up the data in the first column in bot the sheets and then copies the data from the other columns. </p>\n\n<p>I was able to make this code work with WWC's assistance, but how to look up the data in the first column and then copy values.</p>\n\n<pre><code>    Sub Macro4()\n'\n' Macro4 Macro\n'\n\n'\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\n\nDim coli As Double\nDim Coli3 As Double\nDim rowy As Double\n\nDim numCols As Double\nDim startRow As Double\nDim lastRow As Double\n\nstartRow = 6 'assuming data starts here\nColi3 = 2 ' start the columns out on ws3\n\nSet ws1 = ThisWorkbook.Worksheets(\"Sheet1\")\nSet ws2 = ThisWorkbook.Worksheets(\"Sheet2\")\nSet ws3 = ThisWorkbook.Worksheets(\"Comparison\")\n\nApplication.ScreenUpdating = False\n\nws3.Cells.Clear\n\n\nws1.Range(\"A1\").EntireColumn.Copy Destination:=ws3.Range(\"A1\")\n\n'Find how many columns there are in sheet1 based on data in row 1\nnumCols = ws1.Cells(7, Columns.Count).End(xlToLeft).Column\nFor coli = 2 To numCols\n    'Find last Data row in the given column in sheet1\n    lastRow = ws1.Cells(ws1.Rows.Count, coli).End(xlUp).Row\n\n    For rowy = 6 To lastRow\n        ws3.Cells(rowy, Coli3) = Format(ws1.Cells(rowy, coli).Value, \"#,##0\") ' copy sheet 1 to the right spot of sheet 3\n        ws3.Cells(rowy, Coli3 + 1) = Format(ws2.Cells(rowy, coli).Value, \"#,##0\") 'copy sheet 2 to the right spot of sheet 3\n        'perform calculation and place in the right spot on sheet 3\n        If rowy = \"6\" Then\n            ws3.Cells(rowy, Coli3) = ws1.Cells(rowy, coli) &amp; \"-Sheet1\" ' copy sheet 1 to the right spot of sheet 3\n            ws3.Cells(rowy, Coli3 + 1) = ws2.Cells(rowy, coli) &amp; \"-Sheet2\" 'copy sheet 2 to the right spot of sheet 3\n            ws3.Cells(rowy, Coli3 + 2) = \"Difference\"\n        Else\n            ws3.Cells(rowy, Coli3) = Format(ws1.Cells(rowy, coli).Value, \"#,##0\") ' copy sheet 1 to the right spot of sheet 3\n            'ws3.Cells(rowy, Coli3).Font.Name = \"Arial\"\n            'ws3.Cells(rowy, Coli3).Font.Size = 8\n            ws3.Cells(rowy, Coli3 + 1) = Format(ws2.Cells(rowy, coli).Value, \"#,##0\") 'copy sheet 2 to the right spot of sheet 3\n            'ws3.Cells(rowy, Coli3 + 1).Font.Name = \"Arial\"\n            'ws3.Cells(rowy, Coli3 + 1).Font.Size = 8\n            ws3.Cells(rowy, Coli3 + 2) = Format((ws1.Cells(rowy, coli).Value) - (ws2.Cells(rowy, coli).Value), \"#,##0\")\n            'ws3.Cells(rowy, Coli3 + 2).Font.Name = \"Arial\"\n            'ws3.Cells(rowy, Coli3 + 2).Font.Size = 8\n        End If\n\n    Next rowy ' move to the next row on ws1, ws2, ws3\n\n    'Since we are placing 3 cols at a time in sheet 3 we increment differently\n    Coli3 = Coli3 + 3 '1 becomes 4, 4 becomes 7, 7 becomes 10 and so on\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KRIBS.png\" rel=\"nofollow noreferrer\">Data in the Sheets</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514399604, "post_id": 47996972, "comment_id": 82962110, "body": "vbYes rather Yes, maybe? And as now mentioned below, capture response and compare."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1514427963, "post_id": 47996972, "comment_id": 82970248, "body": "Target.Address = &quot;I16&quot; is incorrect.  change to Target.Address = &quot;$I$16&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 2, "last_activity_date": 1514400153, "last_edit_date": 1514400153, "creation_date": 1514399710, "answer_id": 47997055, "question_id": 47996972, "link": "https://stackoverflow.com/questions/47996972/worksheet-change-event-based-on-message-box/47997055#47997055", "title": "Worksheet Change Event based on Message Box", "body": "<p>You do not capture the return value of <code>MsgBox</code>.</p>\n\n<pre><code>Dim result As VbMsgBoxResult\nresult = MsgBox(\"Are you sure?\", vbOKCancel)\nIf result = vbOK Then\n...\nElse\n...\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514400153, "creation_date": 1514399256, "question_id": 47996972, "link": "https://stackoverflow.com/questions/47996972/worksheet-change-event-based-on-message-box", "title": "Worksheet Change Event based on Message Box", "body": "<p>My existing code uses ActiveX check boxes to modify the title and visibility of a worksheet in the Workbook based on cell \"I16\". What I want to do, is set a change event that will modify allow the worksheet to be further modified if the user changes the contents of Cell \"I16\" (Which is the title of the worksheet).</p>\n\n<p>The code is intended to do the following:</p>\n\n<ul>\n<li>Confirm that the user intended to change the contents of cell \"I16\"</li>\n<li>If the user DID NOT intend the change, undo the change and exit the sub</li>\n<li>If the user DID intend the change, change the worksheet's name to the new name, ask the user if they want to clear the data from the previously named worksheet. (The idea here is that if we change the sheet name from Cookies to Cakes, the Cookies data will be cleared, even though the worksheet is still the same.)</li>\n<li>If the user wants to clear the data, the code will clear specific cell ranges from Column(variable) to the row above the LastRow (saving any formulas in the LastRow from accidental deletion)</li>\n<li>If the user DOES NOT WANT to clear the data, the code will leave the specified cell ranges alone, will set the new worksheet name, and then exit the sub.</li>\n</ul>\n\n<p>The problem? The code does...nothing. I change the target address, and nothing happens. I tweak the code, adjust ranges, etc. and get nowhere.</p>\n\n<p>Apologies in advance for the amateur coding you are about to witness, and my gratitude for your assistance in this.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n   Dim ws As Worksheet\n   Dim sheetName As String\n\n    If Target.Address = \"I16\" Then\n        If WorksheetExists(sheetName) Then\n            Exit Sub\n        Else\n        MsgBox \"Are you sure you want to change\" &amp; vbNewLine &amp; \"the name of this Allowance?\", vbYesNo + vbQuestion, \"Confirm Name Change\"\n\n           If Yes Then\n           Set ws = Sheet34\n           ws.Name = sheetName\n\n            MsgBox \"Would you like to clear the data from\" &amp; vbNewLine &amp; \"this Allowance?\", vbYesNo + vbQuestion, \"Confirm Data Clear\"\n                If Yes Then\n                LastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n                Worksheets.Sheet34.Rows.Range(\"C9:LastRow, -1\", D9:LastRow, -1, E9:LastRow, -1, F9:LastRow, -1, H9:LastRow, -1, J9:LastRow, -1, L9:LastRow, -1, N9:LastRow, -1, P9:LastRow, -1).Clear\n            Else\n                Exit Sub\n\n            End If\n        Else\n            Application.EnableEvents = False\n            Application.Undo\n            Exit Sub\n            Application.EnableEvents = True\n        End If\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514401012, "post_id": 47996914, "comment_id": 82962669, "body": "close your on Error Resume Next first with On Error GoTo 0 to see if any errors present then step through and watch the locals window and check variables are as expected (or use other debugging tools such as break on change of value with watches)."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514401644, "post_id": 47996914, "comment_id": 82962910, "body": "Is the first file actually present in the range you are trying to match against or is it retaining the initialised value of 0 for xrow and this is leading to the filename problem?"}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514402381, "post_id": 47996914, "comment_id": 82963205, "body": "I didn&#39;t get your first comment completely. Answering to your second question, Yes the first file is present in the range. As you have pointed, initialized value of 0 for xrow can or may be the reason, but I am not sure about that. Let me know how I can the modify the code to avoid the filename being renamed as &#39;0&#39;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514402571, "post_id": 47996914, "comment_id": 82963289, "body": "You should have On Error GoTo 0   before If xRow &gt; 0"}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514403305, "post_id": 47996914, "comment_id": 82963575, "body": "I am getting a &quot;Run time error &#39;58&#39;: File already exists&quot; error after making the code change (On Error GoTo 0). In addition to that, the &#39;0&#39; file name still appears in the folder after running the updated code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514403368, "post_id": 47996914, "comment_id": 82963605, "body": "You are trying to rename a file to one that already exists? You would need a check that rename file doesn&#39;t already exist."}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514403932, "post_id": 47996914, "comment_id": 82963836, "body": "No I am not trying to rename a file to one that already exists. Instead I am trying to rename the XYZ.pdf  filename to ABC_1100_DDMMYY.pdf filename. In the folder, I am working on not all files are XYZ.pdf files but there are also few ABC_1100_DDMMYY.pdf files. So I am keeping the ABC_1100_DDMMYY.pdf files unchanged and working only with XYZ.pdf files by using the formulas."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514404333, "post_id": 47996914, "comment_id": 82963991, "body": "Well the error message is telling you that you are so perhaps double check the value of the file name and file rename at the point the error occurs."}], "owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514435579, "creation_date": 1514398966, "last_edit_date": 1514435579, "question_id": 47996914, "link": "https://stackoverflow.com/questions/47996914/file-renaming-code-is-returning-a-single-filename-as-0-why", "title": "File renaming code is returning a single filename as &#39;0&#39;? Why?", "body": "<p>I have a excel sheet with two columns. In column A, I get file names from a specific folder. In the column B, I get new file names from different sheet using Vlook-up and few concatenations.</p>\n\n<p>Using the below code in Column B, I was able to renames the file names in a selected folder. The code is working fine, except for renaming a single file as '0', which it is not supposed to do. FYI, the first file in the excel sheet column \"A\" which it supposed to rename is being RENAMED AS '0'.</p>\n\n<pre><code>Sub RenameFiles()\n    Dim xDir As String\n    Dim xFile As String\n    Dim xRow As Long\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .AllowMultiSelect = False\n    If .Show = -1 Then\n        xDir = .SelectedItems(1)\n        xFile = Dir(xDir &amp; Application.PathSeparator &amp; \"*\")\n        Do Until xFile = \"\"\n            xRow = 0\n            On Error Resume Next\n            xRow = Application.Match(xFile, Range(\"A:A\"), 0)\n            If xRow &gt; 0 Then\n                Name xDir &amp; Application.PathSeparator &amp; xFile As _\n                xDir &amp; Application.PathSeparator &amp; Cells(xRow, \"B\").Value\n            End If\n            xFile = Dir\n        Loop\n    End If\n    End With\n\n    Dim conState As ADODB.Connection\n    Dim strSQL As String\n    Dim ObjWshNw As Object\n    Dim strUsername As String\n    Dim strComputerName As String\n\n    Set conState = New Connection\n    Set ObjWshNw = CreateObject(\"WScript.Network\")\n    strUsername = ObjWshNw.UserDomain &amp; \"\\\" &amp; ObjWshNw.UserName\n    strComputerName = ObjWshNw.ComputerName\n\n    dtEnd = Now()\n\n    With conState\n        .Provider = \"SQLOLEDB.1\"\n        .ConnectionString = \"server=xxxxxxx; Trusted_Connection=Yes\"\n        .Open\n    End With\n\n    'Inject the strSQL into the ADODB Connection and run it\n    strSQL = _\n            \"insert into ggghhh.yyyyy.yyyy(ReportName,ReportStart,ReportEnd,Username,ComputerName,RuntimeSeconds) \" &amp; _\n            \"values ('\" &amp; strReportName &amp; \"','\" &amp; dtStart &amp; \"','\" &amp; dtEnd &amp; \"','\" &amp; strUsername &amp; \"','\" &amp; strComputerName &amp; \"',\" &amp; DateDiff(\"s\", CDate(dtStart), CDate(dtEnd)) &amp; \")\"\n    conState.Execute strSQL\n\n\n    End Sub\n</code></pre>\n\n<p>Please let me know what need to be modified in the code to make sure that the single file name is not being renamed as '0'.</p>\n"}, {"tags": ["r", "excel", "rdcomclient", "vba"], "owner": {"reputation": 679, "user_id": 1389469, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a4ab0ec354cd326ed2008dc386e7655d?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Vidhani", "link": "https://stackoverflow.com/users/1389469/nikhil-vidhani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1514402782, "creation_date": 1514395152, "last_edit_date": 1531161705, "question_id": 47996164, "link": "https://stackoverflow.com/questions/47996164/how-to-fetch-data-in-r-by-executing-command-in-excel", "title": "How to fetch data in R by executing command in excel?", "body": "<p>I have to fetch data from Reuters and they provide an excel plugin for that. The problem is that my excel is crashing if I try to fetch too many variables at the same time. I was wondering whether I can do it from R via some excel connection.</p>\n\n<p>In general I want to give the command to excel (from R), fetch data and get the data back in R for analysis. The process has to be repeated a number of times.</p>\n\n<pre><code>=TR(\"SCREEN(U(IN(Equity(active,public,primary))/*UNV:Public*/))\",A1:K10,\"PERIOD:FY2015 NULL:-- curn=USD RH=In CH=Fd\",A6)\n</code></pre>\n\n<p>I get the variable name from (A1:K10) and then the output is stored from cell A6 onwards.</p>\n\n<p>The answer <a href=\"https://stackoverflow.com/a/43222477/1389469\">https://stackoverflow.com/a/43222477/1389469</a> here points to RDCOMClient library but I am not able to run the macro from R as described there.</p>\n\n<p>Another guide here <a href=\"https://cran.r-project.org/web/packages/excel.link/excel.link.pdf\" rel=\"nofollow noreferrer\">https://cran.r-project.org/web/packages/excel.link/excel.link.pdf</a> talks about how to read/write data from an open excel workbook but doesn't tell how to execute commands in excel from R.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1514396773, "post_id": 47996113, "comment_id": 82960964, "body": "I dont use 2010 version to test it, but have you tried this? <a href=\"https://support.office.com/en-us/article/Hide-or-display-scroll-bars-in-a-workbook-2101e630-fa9b-4d22-90e0-b110278bafa7\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 19, "user_id": 3979321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4e3d3dcf2a5d377d2d41c7ee4ba144b?s=128&d=identicon&r=PG&f=1", "display_name": "petermiller", "link": "https://stackoverflow.com/users/3979321/petermiller"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1514398287, "post_id": 47996113, "comment_id": 82961568, "body": "Yes the scrollbars are enabled in the options, excel 2010. They only get hidden if you switch to another simultaneously open workbook."}], "owner": {"reputation": 19, "user_id": 3979321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4e3d3dcf2a5d377d2d41c7ee4ba144b?s=128&d=identicon&r=PG&f=1", "display_name": "petermiller", "link": "https://stackoverflow.com/users/3979321/petermiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514405297, "creation_date": 1514394890, "last_edit_date": 1514405297, "question_id": 47996113, "link": "https://stackoverflow.com/questions/47996113/excel-2010-vba-keep-scrollbars-in-deactivated-inactive-workbooks-visible", "title": "Excel 2010 vba - Keep scrollbars in deactivated/inactive workbooks visible", "body": "<p>In Excel (2010 and other) the workbook standard\nscrollbars are only visible for the active\nworkbook. So if you have two or more workbooks\nopen only one shows scrollbars.</p>\n\n<p>It looks as if the DisplayHorizontalScrollBar Property\napplies only to:\n<code>ActiveWindow.DisplayHorizontalScrollBar = True</code></p>\n\n<p>Is there a way to keep the scrollbars of inactive\nworkbooks visible? Preferably with vba.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1514395088, "post_id": 47996018, "comment_id": 82960353, "body": "Are the entries in column <b>K</b> constants for formulas??"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 2, "creation_date": 1514409179, "post_id": 47996018, "comment_id": 82965747, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">Error in finding last used cell in VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1514395637, "creation_date": 1514395637, "answer_id": 47996255, "question_id": 47996018, "link": "https://stackoverflow.com/questions/47996018/how-can-i-iterate-from-a-specific-excel-cell-to-the-latest-row-having-a-value-in/47996255#47996255", "title": "How can I iterate from a specific Excel cell to the latest row having a value in this column using VBA?", "body": "<p>I've given two ways to find the last cell - using the <code>LastCell</code> function will return the very last cell on the sheet which may not be in column K.</p>\n\n<p>The second way I've shown is just finding the last cell in column K.  </p>\n\n<p>The range is then set by giving the first and last cell references separated by a comma.  </p>\n\n<pre><code>Sub AllValues()\n\n    Dim outQuantityRange As Range\n    Dim currentOutQuantity As Range\n    Dim rLastCell As Range\n\n    With ThisWorkbook\n\n        'Find last cell on sheet containing data.\n        'Set rLastCell = LastCell(.Worksheets(\"MySheetName\"))\n\n        With .Worksheets(\"MySheetName\")\n            'Find last cell in column K containing data.\n            Set rLastCell = .Cells(.Rows.Count, 11).End(xlUp)\n            Set outQuantityRange = .Range(\"K3\", rLastCell)\n        End With\n    End With\n\n    For Each currentOutQuantity In outQuantityRange\n        MsgBox currentOutQuantity, vbOKOnly + vbInformation\n    Next currentOutQuantity\n\nEnd Sub\n\nPublic Function LastCell(wrkSht As Worksheet) As Range\n\n    Dim lLastCol As Long, lLastRow As Long\n\n    On Error Resume Next\n\n    With wrkSht\n        lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n        lLastRow = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n\n        If lLastCol = 0 Then lLastCol = 1\n        If lLastRow = 0 Then lLastRow = 1\n\n        Set LastCell = wrkSht.Cells(lLastRow, lLastCol)\n    End With\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1514395790, "creation_date": 1514395790, "answer_id": 47996287, "question_id": 47996018, "link": "https://stackoverflow.com/questions/47996018/how-can-i-iterate-from-a-specific-excel-cell-to-the-latest-row-having-a-value-in/47996287#47996287", "title": "How can I iterate from a specific Excel cell to the latest row having a value in this column using VBA?", "body": "<p>If the values in column <strong>K</strong> are constants, then:</p>\n\n<pre><code>Sub qwerty()\n    Dim outQuantityRange As Range, zell As Range\n\n    Set outQuantityRange = Range(\"K3:K\" &amp; Rows.Count).SpecialCells(2)\n\n    For Each zell In outQuantityRange.Cells\n        MsgBox zell.Value\n    Next zell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1514451718, "post_id": 47996611, "comment_id": 82977112, "body": "Using <code>xlDown</code> will return <code>$K$3:$K$1048576</code> if <code>K3</code> has the only value in the column."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1514451850, "post_id": 47996611, "comment_id": 82977170, "body": "@DarrenBartrup-Cook These are all &quot;guess games&quot;."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1514451940, "post_id": 47996611, "comment_id": 82977206, "body": "I&#39;ve no idea what that means."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 1, "last_activity_date": 1514397386, "creation_date": 1514397386, "answer_id": 47996611, "question_id": 47996018, "link": "https://stackoverflow.com/questions/47996018/how-can-i-iterate-from-a-specific-excel-cell-to-the-latest-row-having-a-value-in/47996611#47996611", "title": "How can I iterate from a specific Excel cell to the latest row having a value in this column using VBA?", "body": "<p>If there are no gaps between K3 and last row, then this will do the work:</p>\n\n<pre><code>Dim rng As Range\nSet rng = Range(\"K3\", Range(\"K3\").End(xlDown))\n</code></pre>\n"}], "owner": {"reputation": 33743, "user_id": 1833945, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5108c5943fad55dcbf5849a01ce854fa?s=128&d=identicon&r=PG", "display_name": "AndreaNobili", "link": "https://stackoverflow.com/users/1833945/andreanobili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 47996611, "answer_count": 3, "score": -1, "last_activity_date": 1514397386, "creation_date": 1514394425, "question_id": 47996018, "link": "https://stackoverflow.com/questions/47996018/how-can-i-iterate-from-a-specific-excel-cell-to-the-latest-row-having-a-value-in", "title": "How can I iterate from a specific Excel cell to the latest row having a value in this column using VBA?", "body": "<p>I am absolutly new in Excel and <strong>VBA</strong> macro and I have the following problem.</p>\n\n<p>I wrote this code that print the content of the <strong>K</strong> column cell starting from the 3th row to the 5th row:</p>\n\n<pre><code>Dim outQuantityRange As Range\nSet outQuantityRange = Range(\"K3:K5\")\n\n\nFor Each currentOutQuantity In outQuantityRange.Cells\n    MsgBox (currentOutQuantity)\n</code></pre>\n\n<p>It works fine. My problem is that I want change this code to access to the content of the cell into the <strong>K</strong> column starting from the 3th row and ending to the last inserted value. For example if the last value is into the <strong>K100</strong> cell it have to print the content of: <strong>K3, K4, K5,......,K100</strong>.</p>\n\n<p>I don't want to specify <strong>K100</strong> but it have to stop to the last row having a value into the K column.</p>\n\n<p>How can I implement this behavior?\n        Next</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514395170, "post_id": 47995893, "comment_id": 82960387, "body": "The Or gives me a result for any of the two words and I want it to return the value that has only the two criteria"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1514396307, "post_id": 47995893, "comment_id": 82960805, "body": "How do you determine which criteria you need ultimately. You always want it to find only times when <code>Fruit</code> and <code>Area</code> are there regardless of whether <code>Store</code> is blank or filled in?"}, {"owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1514396428, "post_id": 47995893, "comment_id": 82960851, "body": "Hello, I would like it to find the values of Fruit and Area match  even if store is left blank."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514395663, "post_id": 47996015, "comment_id": 82960586, "body": "This did not work, is there something else I am missing?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514395728, "post_id": 47996015, "comment_id": 82960611, "body": "What do you mean by, did not work.  That could be a lot of things."}, {"owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514396273, "post_id": 47996015, "comment_id": 82960797, "body": "Hello, the last part is not working.  It is saying .Range and .Cell are invalid or unqualified references"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514396967, "post_id": 47996015, "comment_id": 82961020, "body": "The code above works for me, not sure why you are getting the error.  You may want to remove the <code>.</code> in front of those items.  I used a With Block that you are not using. @Tara"}, {"owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514396993, "post_id": 47996015, "comment_id": 82961032, "body": "hello, It still says .Cells are invalid"}, {"owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514401567, "post_id": 47996015, "comment_id": 82962876, "body": "if i wanted to search for a wildcard of the word would i just add a * after fruits?  Like Fruits &amp; &quot;*&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "edited": false, "score": 0, "creation_date": 1514401987, "post_id": 47996015, "comment_id": 82963039, "body": "No it would be different.  that is a new question, please provide a new post with what you have tried and your specific requirements. @Tara"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1514396900, "last_edit_date": 1514396900, "creation_date": 1514394419, "answer_id": 47996015, "question_id": 47995893, "link": "https://stackoverflow.com/questions/47995893/vba-search-table-exclude-blank-cells/47996015#47996015", "title": "VBA search table exclude blank cells", "body": "<p>Use IIF():</p>\n\n<pre><code>If IIF(Fruits&lt;&gt;\"\",Cells(i, 1) = Fruits,True) And _\n   IIF(Store&lt;&gt;\"\",Cells(i, 2) = Store,True) And _ \n   IIF(Area&lt;&gt;\"\",Cells(i, 3) = Area,True)  Then\n</code></pre>\n\n<p>Also avoid the use of Select.  Also when just wanting the values just assign the value and skip the clipboard:</p>\n\n<pre><code>With ActiveSheet\n    finalrow = .Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 1 To finalrow\n        If IIf(Fruits &lt;&gt; \"\", .Cells(i, 1) = Fruits, True) And _\n           IIf(Store &lt;&gt; \"\", .Cells(i, 2) = Store, True) And _\n           IIf(Area &lt;&gt; \"\", .Cells(i, 3) = Area, True) Then\n\n           ssheet.Range(\"A100\").End(xlUp).Offset(1, 0).Resize(1, 3).Value = .Range(.Cells(i, 1), .Cells(i, 3)).Value\n        End If\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9124631, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4c84575fe82f1020f389684cb610dace?s=128&d=identicon&r=PG&f=1", "display_name": "Tara", "link": "https://stackoverflow.com/users/9124631/tara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 47996015, "answer_count": 1, "score": 0, "last_activity_date": 1514396900, "creation_date": 1514393814, "last_edit_date": 1531164843, "question_id": 47995893, "link": "https://stackoverflow.com/questions/47995893/vba-search-table-exclude-blank-cells", "title": "VBA search table exclude blank cells", "body": "<p>I have created a search table in excel and I want to use a VBA code to search for specific words in the rest of the workbook. Here is an example of my table.</p>\n\n<p>Fruits\nStore\nArea</p>\n\n<p>I have set these values as a string, but I am having a trouble with having one item blank and then running the macro.  So if i want to find only fruit and area, it wont run because store is left blank.  Is there a way I can search the workbook without having each line filled in?</p>\n\n<p>Here is the code I am using to copy the data over.</p>\n\n<pre><code>finalrow = Cells(Rows.Count, 1).End(xlUp).Row\n\n\n\nFor i = 1 To finalrow\nIf Cells(i, 1) = Fruits And Cells(i, 2) = Store And Cells(i, 3) = Area  Then\nRange(Cells(i, 1), Cells(i, 3)).Copy\nssheet.Select (Workbook sheet to paste)\nRange(\"A100\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n</code></pre>\n"}, {"tags": ["vba", "excel", "amazon-web-services", "amazon-ec2"], "answers": [{"comments": [{"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 1, "creation_date": 1514393837, "post_id": 47995736, "comment_id": 82959814, "body": "If the work is known in advance, it may be preferable to put the work items on an SQS queue and have each EC2 instance pull an item from that queue."}], "tags": [], "owner": {"reputation": 3133, "user_id": 2004532, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/rHrTR.jpg?s=128&g=1", "display_name": "N-ate", "link": "https://stackoverflow.com/users/2004532/n-ate"}, "is_accepted": false, "score": 0, "last_activity_date": 1514393158, "creation_date": 1514393158, "answer_id": 47995736, "question_id": 47995702, "link": "https://stackoverflow.com/questions/47995702/can-an-ec2-instance-be-set-to-open-a-file-after-starting-up/47995736#47995736", "title": "Can an EC2 instance be set to open a file after starting up?", "body": "<p>Make an ami, that on startup calls an aws server setup as a controller. As many instances as you launch from the ami will call the controller and request work.</p>\n"}, {"tags": [], "owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "is_accepted": false, "score": 2, "last_activity_date": 1514394141, "creation_date": 1514394141, "answer_id": 47995961, "question_id": 47995702, "link": "https://stackoverflow.com/questions/47995702/can-an-ec2-instance-be-set-to-open-a-file-after-starting-up/47995961#47995961", "title": "Can an EC2 instance be set to open a file after starting up?", "body": "<p>When you launch an EC2 instance you supply <a href=\"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html\" rel=\"nofollow noreferrer\">userdata</a>. That userdata can be a script that is auto-run when the instance launches.</p>\n\n<p>Another alternative is to use <a href=\"http://docs.aws.amazon.com/systems-manager/latest/userguide/execute-remote-commands.html\" rel=\"nofollow noreferrer\">EC2 Systems Manager Run Command</a> to remotely invoke operations/scripts on EC2 instances after they're launched - you could easily automate something to launch an instance, wait till it's ready, then remotely invoke your Excel script with some dynamic parameters.</p>\n\n<p>Another alternative is to place the work items on an SQS queue, then use the userdata idea to run a script at instance launch that pulls items from the queue and does work.</p>\n\n<p>And another idea is to use AWS Lambda. Simply upload the workbook to S3, and have that trigger a Lambda function. It could either read and process the entire workbook, or if you really need parts of the workbook to be processed by different tasks then your Lambda function could invoke a number of subordinate Lambda functions and fan out the parts of the workbook to them.</p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 2093013, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9409a6fea6edb9dce7d023663d7cb8cb?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/2093013/diego"}, "is_accepted": false, "score": 0, "last_activity_date": 1514417318, "creation_date": 1514417318, "answer_id": 47999807, "question_id": 47995702, "link": "https://stackoverflow.com/questions/47995702/can-an-ec2-instance-be-set-to-open-a-file-after-starting-up/47999807#47999807", "title": "Can an EC2 instance be set to open a file after starting up?", "body": "<p>You could create a windows service/task and execute a bat file on startup.\nThe bat file would open the excel file run your script.</p>\n\n<p>I think this approach might be simpler than using AWS services.</p>\n"}], "owner": {"reputation": 527, "user_id": 2523167, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17ca2b603237786878dade33be4b7c5d?s=128&d=identicon&r=PG", "display_name": "user2523167", "link": "https://stackoverflow.com/users/2523167/user2523167"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1514417318, "creation_date": 1514392975, "question_id": 47995702, "link": "https://stackoverflow.com/questions/47995702/can-an-ec2-instance-be-set-to-open-a-file-after-starting-up", "title": "Can an EC2 instance be set to open a file after starting up?", "body": "<p>My workflow often includes starting up a set of EC2 servers and let them work on different parts of a Excel workbook. its not ideal but thats how it is. I would like to automate this process as much as possible.</p>\n\n<p>Ideally I would make an AMI that opened an Excel workbook on startup. This workbook would then autorun a script that fetched a named Excel workbook from a dropbox folder, opened that workbook and then ran its autoscript. This way all I had to do was to code the script for the second Excel workbook, give it the \"magic\" name, upload it to dropbox and start an appropriate number of instances of the AMi with the first workbook and shut them down after the work had been done and uploaded to the dropbox folder.</p>\n\n<p>I know how to do all this, except opening the \"bootstrap\" Excel file after booting up the EC2 instance. Is this possible?</p>\n"}, {"tags": ["excel", "vba", "indexing", "vlookup"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514392739, "post_id": 47995628, "comment_id": 82959283, "body": "Use countifs()."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514393005, "post_id": 47995628, "comment_id": 82959410, "body": "But a pivot table may be better suited."}, {"owner": {"reputation": 173, "user_id": 8387242, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ccee6343e90fd961cd584b1edf9e9e53?s=128&d=identicon&r=PG&f=1", "display_name": "ADF", "link": "https://stackoverflow.com/users/8387242/adf"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514393006, "post_id": 47995628, "comment_id": 82959411, "body": "@ScottCraner can you elaborate? I tried using countif with a vlookup nested within it, but could not figure out how to catch multiple matches this way."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514393086, "post_id": 47995628, "comment_id": 82959442, "body": "no vlookup, just countifs():  <code>=COUNTIFS(A:A,$D2,B:B,E$1)</code>"}, {"owner": {"reputation": 173, "user_id": 8387242, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ccee6343e90fd961cd584b1edf9e9e53?s=128&d=identicon&r=PG&f=1", "display_name": "ADF", "link": "https://stackoverflow.com/users/8387242/adf"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514393944, "post_id": 47995628, "comment_id": 82959870, "body": "@ScottCraner this solution worked once I fixed the references to =COUNTIFS($A:$A,$D2,$B:$B,E$1). Thanks for introducing me to countifs!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514393994, "post_id": 47995628, "comment_id": 82959892, "body": "Pleas consider marking the answer below as correct by clicking the check mark by the answer."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1514393268, "creation_date": 1514393268, "answer_id": 47995767, "question_id": 47995628, "link": "https://stackoverflow.com/questions/47995628/excel-mapping-with-multiple-matches/47995767#47995767", "title": "Excel Mapping with multiple matches", "body": "<p>Use COUNTIFS()</p>\n\n<pre><code>=COUNTIFS($A:$A,$D2,$B:$B,E$1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dK2O6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dK2O6.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>But a pivot table may be better suited</p>\n\n<p><a href=\"https://i.stack.imgur.com/1Ib2V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1Ib2V.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 173, "user_id": 8387242, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ccee6343e90fd961cd584b1edf9e9e53?s=128&d=identicon&r=PG&f=1", "display_name": "ADF", "link": "https://stackoverflow.com/users/8387242/adf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 47995767, "answer_count": 1, "score": 0, "last_activity_date": 1514396535, "creation_date": 1514392661, "last_edit_date": 1514396535, "question_id": 47995628, "link": "https://stackoverflow.com/questions/47995628/excel-mapping-with-multiple-matches", "title": "Excel Mapping with multiple matches", "body": "<p>my knowledge of excel extends to most types of advanced formulas. I don't know much about how to use VBA or macros. I have a problem which I'm struggling to solve using formulas. I have a sheet with two columns that looks like this:</p>\n\n<pre><code>x1  y1\nx1  y2\nx1  y3\nx1  y4\nx2  y2\nx2  y3\nx2  y4\nx3  y1\nx4  y2\n</code></pre>\n\n<p>And I'm trying to map these onto a a sheet like this:</p>\n\n<pre><code>    y1  y2  y3  y4\n x1 1   1   1   1\n x2 0   1   1   1\n x3 1   0   0   0\n x4 0   1   0   0\n</code></pre>\n\n<p>I usually try to apply a vlookup solution to such problems, but I can't figure out how to get vlookup to work given that the x values appear multiple times in the first table, and vlookup will always just stop at the first appearance. </p>\n\n<p>Please let me know how to best approach solving this problem.</p>\n\n<p>Thanks so much!</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 3621, "user_id": 6188402, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a8bdb7cbe81f5544f0ddc6ded12a23f1?s=128&d=identicon&r=PG&f=1", "display_name": "Washington Guedes", "link": "https://stackoverflow.com/users/6188402/washington-guedes"}, "edited": false, "score": 0, "creation_date": 1514392530, "post_id": 47995564, "comment_id": 82959180, "body": "Remove the space from <code>strReplace</code>, and add one to the last group of <code>strPattern</code>"}], "answers": [{"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1514394118, "creation_date": 1514394118, "answer_id": 47995956, "question_id": 47995564, "link": "https://stackoverflow.com/questions/47995564/removing-blank-space-from-a-string/47995956#47995956", "title": "Removing blank space from a string", "body": "<p>You may adjust your regex pattern to match as few non-digit symbols before optional whitespace chars as possible:</p>\n\n<pre><code>^(\\d{6} )(- )(\\D*?)\\s*(\\d{4})\n                ^^^^^^\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/V3xAlP/2\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p><strong>Details</strong></p>\n\n<ul>\n<li><code>^</code> - start of the string</li>\n<li><code>(\\d{6} )</code> - Group 1: six digits</li>\n<li><code>(- )</code> - Group 2: a hyphen and a space</li>\n<li><code>(\\D*?)</code> - Group 3: any 0+ chars other than digits, but as few as possible as the <code>*?</code> quantifier is lazy (the quantified pattern is only tried and expanded when the subsequent patterns fail to match)</li>\n<li><code>\\s*</code> - 0+ whitespace chars</li>\n<li><code>(\\d{4})</code> - Group 4: four digits. </li>\n</ul>\n"}], "owner": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 47995956, "answer_count": 1, "score": 0, "last_activity_date": 1564321819, "creation_date": 1514392383, "last_edit_date": 1564321819, "question_id": 47995564, "link": "https://stackoverflow.com/questions/47995564/removing-blank-space-from-a-string", "title": "Removing blank space from a string", "body": "<p>How do I remove a blank space in a return string?</p>\n\n<p>I am using in-cell functions in Excel. I find text in a string and move it to another place in the same string.</p>\n\n<p>My results include an extra blank space that I want to remove.</p>\n\n<p>Sample text string:</p>\n\n<pre><code>999999 - Blah Blah Blah 8888 blah blah\n</code></pre>\n\n<p>Desired result is:</p>\n\n<pre><code>999999 (8888) - Blah Blah Blah blah blah\n</code></pre>\n\n<p>My actual result is (note the extra blank space at 3rd Blah)</p>\n\n<pre><code>999999 (8888) - Blah Blah Blah  blah blah\n</code></pre>\n\n<p>Here is my current relevant code:</p>\n\n<pre><code>strPattern = \"^(\\d{6} )(\\- )(\\D+)(\\d{4})\"\nstrReplace = \"$1($4) $2$3\"\n</code></pre>\n\n<p>How do I deal with this either through my strPattern definition and/or strReplace definition?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1514388797, "post_id": 47994738, "comment_id": 82957529, "body": "<i>&quot;Getting a type mismatch error on the function call&quot;</i> It&#39;s generally best to quote it in full, too."}], "answers": [{"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1514389663, "post_id": 47994812, "comment_id": 82957891, "body": "Sorry, the example was a weak attempt to illustrate my intent without cluttering detail.  :)"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1514389700, "post_id": 47994812, "comment_id": 82957907, "body": "Erik, your suggestion &quot;AuditChanges forms![someForm]![someSubForm].Form&quot; (without quotes) works as desired.  - thank you"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1514389836, "post_id": 47994812, "comment_id": 82957969, "body": "Good. I sometimes am a bit critical, about half my points (<code>call</code>, parentheses) are probably not the cause of any errors. A minimal example is often hard, the devil&#39;s in the details :)"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 2, "last_activity_date": 1514389032, "creation_date": 1514389032, "answer_id": 47994812, "question_id": 47994738, "link": "https://stackoverflow.com/questions/47994738/access-vba-passing-form-subform-name-to-a-function/47994812#47994812", "title": "Access VBA: Passing Form/Subform name to a Function?", "body": "<p>Your sub call is all kinds of weird:</p>\n\n<p>The likely cause of your error is the quotes. You're currently passing a string to your function containing <code>\"forms![someForm]![someSubForm]\"</code></p>\n\n<p>Furthermore, you shouldn't use parentheses when you're not receiving a return value (so never when calling a sub).</p>\n\n<p>Also, the <code>Call</code> keyword has been deprecated a long time ago.</p>\n\n<p>And you likely want to pass the form object, and not the subform control object</p>\n\n<p>Try calling your sub like this:</p>\n\n<pre><code>AuditChanges forms![someForm]![someSubForm].Form\n</code></pre>\n\n<p>(Never had this many comments on one line of code before)</p>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1249, "favorite_count": 0, "accepted_answer_id": 47994812, "answer_count": 1, "score": 0, "last_activity_date": 1514389828, "creation_date": 1514388678, "last_edit_date": 1514389828, "question_id": 47994738, "link": "https://stackoverflow.com/questions/47994738/access-vba-passing-form-subform-name-to-a-function", "title": "Access VBA: Passing Form/Subform name to a Function?", "body": "<p>I am attempting to pass a form/subform name to a function without success.  The function steps thru each .Control on the subform and performs a simple set of look-ups &amp; actions.  My code works as expected with the Form/Subform name hard coded; I am looking for a more generic approach.</p>\n\n<p>Getting a type mismatch error on the function call, with and without quotes.</p>\n\n<p>Example:</p>\n\n<pre><code>'Function Call\n  call AuditChanges(\"forms![someForm]![someSubForm]\")\n\n'Audit Function\nSub AuditChanges(thisForm as form)\n    Dim ctl As Control\n    Dim strTest as string\n\n    For each ctl in thisForm.controls\n        strTest = ctl.Value\n        'do some stuff\n    Next ctl\n\nend sub\n</code></pre>\n\n<p>Any suggestions for proper syntax to pass the form/subform info?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1514387281, "post_id": 47994377, "comment_id": 82956882, "body": "When using <code>With</code> you need to append all the linked children with <code>.</code>.  so <code>.Cells(ccRow, 3).Interior...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514392401, "post_id": 47994737, "comment_id": 82959132, "body": "Didn&#39;t understand your advice about <code>InStr</code>. What&#39;s the point?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514393703, "post_id": 47994737, "comment_id": 82959743, "body": "Check out the documentation related to <a href=\"https://www.techonthenet.com/excel/formulas/instr.php\" rel=\"nofollow noreferrer\"><code>InStr()</code></a>. Essentially what it does is check within a string and will return <code>True</code> or <code>False</code> if the string is found. So it&#39;s checking the <code>wsht.Name</code> if it contains the text <code>&quot;Manual Review&quot;</code> etc."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514395678, "post_id": 47994737, "comment_id": 82960588, "body": "I&#39;m not asking how <code>InStr</code> works. OP knows sheets&#39; names beforehand, thus he can directly use them. So, why <code>InStr</code>?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514401720, "post_id": 47994737, "comment_id": 82962939, "body": "@JohnyL Just incase OP wants to search within the sheet names; if for instance he doesn&#39;t know the full names"}], "tags": [], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "is_accepted": false, "score": 2, "last_activity_date": 1514389970, "last_edit_date": 1514389970, "creation_date": 1514388675, "answer_id": 47994737, "question_id": 47994377, "link": "https://stackoverflow.com/questions/47994377/looping-through-multiple-sheets-in-excel/47994737#47994737", "title": "Looping through multiple sheets in excel", "body": "<p>To give you a full answer to Scott Craner's comment</p>\n\n<pre><code>Dim ccShipDate As Variant\nDim ccRow As Integer\nDim wsht As Worksheet\n\nccRow = 2\nccShipDate = Cells(ccRow, 6)\n\nFor Each wsht In Worksheets\n    If wsht.Name = \"ManualReview\" Or wsht.Name = \"Filter\" Or wsht.Name = \"MRF\" Or wsht.Name = \"ModStd\" Then\n         With Worksheets(wsht.Name)\n            Do Until IsEmpty(ccShipDate)\n                If DateDiff(\"d\", Date, ccShipDate) &lt;= 0 Then\n                    .Cells(ccRow, 3).Interior.ColorIndex = 3\n\n                 ElseIf DateDiff(\"d\", Date, ccShipDate) = 1 Then\n                    .Cells(ccRow, 3).Interior.ColorIndex = 6\n\n                 ElseIf DateDiff(\"d\", Date, ccShipDate) &gt; 1 Then\n                     .Cells(ccRow, 3).Interior.ColorIndex = 4\n                 End If\n                     ccRow = ccRow + 1\n                     ccShipDate = .Cells(ccRow, 6).Value\n            Loop\n         End With\n    End If\nNext wsht\n\nEnd Sub\n</code></pre>\n\n<p>I might also suggest change the <code>If Then</code> statement to...</p>\n\n<pre><code>If InStr(1, wsht.Name, \"Manual Review\") Or InStr(1, wsht.Name, \"Filter\") Or InStr(1, wsht.Name, \"MRF\") Or InStr(1, wsht.Name, \"ModStd\")\n</code></pre>\n\n<p>That way it will check to see if the string is within the sheet names</p>\n"}], "owner": {"reputation": 1, "user_id": 9073970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fe83a3d59ce19befaba255c34ac2a9?s=128&d=identicon&r=PG&f=1", "display_name": "Alison Belonzi", "link": "https://stackoverflow.com/users/9073970/alison-belonzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514389970, "creation_date": 1514387191, "last_edit_date": 1531164843, "question_id": 47994377, "link": "https://stackoverflow.com/questions/47994377/looping-through-multiple-sheets-in-excel", "title": "Looping through multiple sheets in excel", "body": "<p>I am trying to write a program that loops through every row in each table (one table per sheet) in order to color code it, similar to conditional formatting. This doesn't move on to the next sheet, so it only color codes the sheet I have open.  I would like it to move on the the next automatically. Any input is appreciated. </p>\n\n<pre><code>Dim ccShipDate As Variant\nDim ccRow As Integer\nDim wsht As Worksheet\n\nccRow = 2\nccShipDate = Cells(ccRow, 6)\n\nFor Each wsht In Worksheets\n    If wsht.Name = \"ManualReview\" Or wsht.Name = \"Filter\" Or wsht.Name = \"MRF\" Or wsht.Name = \"ModStd\" Then\n         With Worksheets(wsht.Name)\n\n                ' loops through \"Actual Ship Date\" column until empty\n                ' past or today = red\n                ' one day away = yellow\n                ' more than one day = green\n                Do Until IsEmpty(ccShipDate)\n                    If DateDiff(\"d\", Date, ccShipDate) &lt;= 0 Then\n                        Cells(ccRow, 3).Interior.ColorIndex = 3\n\n                     ElseIf DateDiff(\"d\", Date, ccShipDate) = 1 Then\n                        Cells(ccRow, 3).Interior.ColorIndex = 6\n\n                        ElseIf DateDiff(\"d\", Date, ccShipDate) &gt; 1 Then\n                            Cells(ccRow, 3).Interior.ColorIndex = 4\n\n\n                    End If\n                    ccRow = ccRow + 1\n                    ccShipDate = Cells(ccRow, 6).Value\n\n                Loop\n         End With\n    End If\nNext wsht\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["arrays", "vba", "count", "enumeration", "mode"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514387927, "post_id": 47994227, "comment_id": 82957131, "body": "Look into <a href=\"http://www.cpearson.com/excel/CollectionsAndDictionaries.htm\" rel=\"nofollow noreferrer\">sorting collections/dictionaries</a>?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1514390554, "creation_date": 1514390554, "answer_id": 47995148, "question_id": 47994227, "link": "https://stackoverflow.com/questions/47994227/vba-grabbing-minimum-repeated-memebers-in-one-dimensional-string-array/47995148#47995148", "title": "vba grabbing minimum-repeated memeber(s) in one dimensional string array", "body": "<p>You need to iterate over the Keys of the Dictionary and compare the Values.</p>\n\n<pre><code>Dim key As Variant, minKey As Variant\n\nFor Each key In dic\n    If IsEmpty(minKey) Then\n        minKey = key\n    Else\n        If dic(key) &lt; dic(minKey) Then minKey = key\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7181718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dd2edd1041f7793d5b102829297d7d67?s=128&d=identicon&r=PG&f=1", "display_name": "user7181718", "link": "https://stackoverflow.com/users/7181718/user7181718"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514390554, "creation_date": 1514386464, "question_id": 47994227, "link": "https://stackoverflow.com/questions/47994227/vba-grabbing-minimum-repeated-memebers-in-one-dimensional-string-array", "title": "vba grabbing minimum-repeated memeber(s) in one dimensional string array", "body": "<p>I used following function to gather most frequent member in array column:</p>\n\n<pre><code>Function MosFreqinsimplearr(ByRef arrin As Variant, colindx As Integer) As Variant\nDim i As Integer\n\nSet dic = CreateObject(\"scripting.dictionary\")\nOn Error Resume Next\n\nxMax = 0\nxOutValue = \"\"\nFor i = 1 To UBound(arrin)\n    xValue = arrin(i, colindx)\n    If xValue &lt;&gt; \"\" Then\n        dic(xValue) = dic(xValue) + 1\n        xCount = dic(xValue)\n        If xCount &gt; xMax Then\n            xMax = xCount\n            xOutValue = xValue\n        End If\n    End If\nNext i\n\nMosFreqinsimplearr = xOutValue\nSet dic = Nothing\nEnd Function\n</code></pre>\n\n<p>1- I need procedure for returning minimum-repeated or less frequent member(s). it seems that same procedure could not be used for getting such result, as i tried:</p>\n\n<pre><code>Dim dic As Object\nDim j As Integer\nDim xMin As Integer\nDim xOutValue As String\nDim xValue As String\nDim xCount As Integer\nDim ar(1 To 11) As Variant\n\nar(1) = \"banana\"\nar(2) = \"banana\"\nar(3) = \"banana\"\nar(4) = \"apple\"\nar(5) = \"apple\"\nar(6) = \"banana\"\nar(7) = \"cucumber\"\nar(8) = \"cucumber\"\nar(9) = \"cucumber\"\nar(10) = \"apple\"\nar(11) = \"cucumber\"\n\nSet dic = CreateObject(\"scripting.dictionary\")\n'On Error Resume Next\nxMin = 0\nxOutValue = \"\"\nFor j = 1 To UBound(ar)\n    xValue = ar(j)\n    If xValue &lt;&gt; \"\" Then\n        dic(xValue) = dic(xValue) + 1\n        xCount = dic(xValue)\n        If xCount &lt;= xMin Then\n            xMin = xCount\n            xOutValue = xValue\n            Else: xOutValue = xValue\n        End If\n\n    End If\nNext j\nMsgBox \"less repeated value is:\" &amp; vbTab &amp; xOutValue\nSet dic = Nothing\n</code></pre>\n\n<p>2-what is the code for counting number of each unique value :</p>\n\n<pre><code>banana=4\ncucumber=4\napple=3\n</code></pre>\n\n<p>Regards;</p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514386614, "post_id": 47994123, "comment_id": 82956577, "body": "I get multiple windows opening if i define link as Range and navigate to Link.Text and if i use 2048 i can have them open in new tabs of  existing window."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 3, "creation_date": 1514386885, "post_id": 47994123, "comment_id": 82956694, "body": "Try CLng(2048) instead of CLng(2049), also you might want to try a delay in the loop to allow the page to load - While IE.Busy | Do Events | Wend"}, {"owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "edited": false, "score": 0, "creation_date": 1514388345, "post_id": 47994123, "comment_id": 82957318, "body": "I tried all of the suggestions, but to no avail, still the same error. However, if I move the <code>Set IE</code> and <code>IE.Visible</code> inside the loop, I manage to open all the links in new windows, but this is not a preferred solution."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1514389081, "post_id": 47994123, "comment_id": 82957642, "body": "From my experience, I don&#39;t think you can tell IE automation (through VBA) to open each new window in a tab, unfortunately. I also think I read somewhere why that is, but I don&#39;t have that link handy. (I hope I am wrong though, as that means, you get a good answer)."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1514390891, "post_id": 47994123, "comment_id": 82958442, "body": "@ScottHoltzman You can, I have some working code that does it. Have a look at the BrowserNavContants of the Flags parameter here: <a href=\"https://msdn.microsoft.com/en-us/library/aa752093(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa752093(v=vs.85).aspx</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1514392768, "post_id": 47994123, "comment_id": 82959291, "body": "@Absinthe - that link states IE7 ... <code>navOpenInBackgroundTab Internet Explorer 7 ...</code> (doesn&#39;t say only, but also doesn&#39;t say <i>and later</i>). Maybe that is user&#39;s issue."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1514398921, "post_id": 47994123, "comment_id": 82961821, "body": "@ScottHoltzman I have it working in IE 10 &amp; 11, I guess Qharr who posted above does too. I wasn&#39;t looking to contradict, just offering one for your toolkit :) I&#39;m stumped as to why CLng(2048) doesn&#39;t work for OP. Sorry OP!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1514400313, "post_id": 47994123, "comment_id": 82962377, "body": "@Absinthe - Never thought you were contradicting :). I was just pointing out in case it helped OP. But good to know it works on later versions. Also, special thanks for pointing it out. Good to know its there if I need it again."}], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 0, "last_activity_date": 1514411565, "creation_date": 1514411565, "answer_id": 47999080, "question_id": 47994123, "link": "https://stackoverflow.com/questions/47994123/macro-to-open-multiple-links-in-new-tabs/47999080#47999080", "title": "Macro to open multiple links in new tabs", "body": "<p>I ran into this issue before and ended up just writing a routine to get the instance.   You will need to add a reference to shell controls and automation.</p>\n\n<p>you may have to adjust this to look for the sURL var in the beginning of the actual URL if there is redirection.</p>\n\n<pre><code>Sub OpenCodingForms()\n\nDim wb1 As Workbook\nDim ws1 As Worksheet\nDim CodingFormLinks As Range\nDim IE As InternetExplorerMedium\n\n    Set wb1 = Workbooks(\"New shortcut.xlsm\")\n    Set ws1 = wb1.Worksheets(\"Data\")\n    Set CodingFormLinks = ws1.Range(\"A2\", Range(\"A2\").End(xlDown))\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    IE.Visible = True\n    ws1.Activate\n\n    Dim sUrl As String\n    For Each link In CodingFormLinks.Cells\n       sUrl = link.Value\n       IE.navigate sUrl, CLng(2048)\n       Set IE = GetWebPage(sUrl)\n    Next link\n\nEnd Sub\n\n\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Desc: The Function gets the Internet Explorer window that has the current\n'   URL from the sURL Parameter.  The Function Timesout after 30 seconds\n'Input parameters:\n    'String sURL - The URL to look for\n'Output parameters:\n    'InternetExplorer ie - the Internet Explorer window holding the webpage\n'Result: returns the Internet Explorer window holding the webpage\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nFunction GetWebPage(sUrl As String) As InternetExplorer\nDim winShell As Shell\nDim dt As Date\n    'set the timeout period\n    dt = DateAdd(\"s\", 300, DateTime.Now)\n\nDim IE As InternetExplorer\n    'loop until we timeout\n    Do While dt &gt; DateTime.Now\n        Set winShell = New Shell\n        'loop through the windows and check the internet explorer windows\n        For Each IE In winShell.Windows\n            'check for the url\n            If IE.LocationURL = sUrl Then\n                'set the window visible\n                IE.Visible = True\n                IE.Silent = True\n                'set the return value\n                Set GetWebPage = IE\n                Do While IE.Busy\n                    DoEvents\n                Loop\n                Set winShell = Nothing\n                Exit Do\n            End If\n        Next IE\n        Set winShell = Nothing\n        DoEvents\n    Loop\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 1, "accepted_answer_id": 47999080, "answer_count": 1, "score": 0, "last_activity_date": 1514411565, "creation_date": 1514385918, "last_edit_date": 1514398238, "question_id": 47994123, "link": "https://stackoverflow.com/questions/47994123/macro-to-open-multiple-links-in-new-tabs", "title": "Macro to open multiple links in new tabs", "body": "<p>I want my macro to open each link stored in a spreadsheet in a separate IE tab. I am successful with opening the first link, but for some reason on the second iteration of the loop I get:</p>\n\n<blockquote>\n  <p>Automation error.The interface is unknown\n  error.</p>\n</blockquote>\n\n<p>I suspect the macro somehow loses IE object reference after first iteration, but I am not sure why.</p>\n\n<p>Range is set OK.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub OpenCodingForms()\n\nDim wb1 As Workbook\nDim ws1 As Worksheet\nDim CodingFormLinks As Range\nDim IE as InternetExplorerMedium\n\nSet wb1 = Workbooks(\"New shortcut.xlsm\")\nSet ws1 = wb1.Worksheets(\"Data\")\nSet CodingFormLinks = ws1.Range(\"A2\", Range(\"A2\").End(xlDown))\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\n\nws1.Activate\n\nFor Each link In CodingFormLinks.Cells\n   IE.Navigate link, CLng(2049)\nNext link\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "unique"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 5, "creation_date": 1514385094, "post_id": 47993717, "comment_id": 82955885, "body": "What are you expecting to get and what are you actually getting?"}, {"owner": {"reputation": 3, "user_id": 9145321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed484d1f99d4f0c5b3e670468266c4b?s=128&d=identicon&r=PG&f=1", "display_name": "Dan H", "link": "https://stackoverflow.com/users/9145321/dan-h"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514386689, "post_id": 47993717, "comment_id": 82956610, "body": "When I run the code in Excel I&#39;m getting an answer that is +1 of the actual count, and I&#39;m not sure why. Also, I was wondering if there&#39;s a more efficient way of executing the unique value search other than using a Script Dictionary, but without limiting the function to only numerical values."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1514390022, "post_id": 47993717, "comment_id": 82958064, "body": "The +1 is due to the merged cells being treated as blank, so the blanks are a new unique value and giving you an extra.  Add an if statement to check <code>Len(cell.value) &gt; 0</code> to ensure you ignore blanks."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9145321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed484d1f99d4f0c5b3e670468266c4b?s=128&d=identicon&r=PG&f=1", "display_name": "Dan H", "link": "https://stackoverflow.com/users/9145321/dan-h"}, "edited": false, "score": 0, "creation_date": 1514391763, "post_id": 47995190, "comment_id": 82958850, "body": "That solved it and gave additional functionality!     Isn&#39;t the following redudent though? Either way TotalCount = TotalCount +1 ?                                                           If Len(Trim(CheckCell.Value)) &gt; 0 Then TotalCount = TotalCount + 1                     Else                         TotalCount = TotalCount + 1"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1514390717, "creation_date": 1514390717, "answer_id": 47995190, "question_id": 47993717, "link": "https://stackoverflow.com/questions/47993717/count-unique-cell-values-by-color-in-excel-vba/47995190#47995190", "title": "Count Unique Cell Values by Color in Excel VBA", "body": "<p>And because I thought it was fun, here's a UDF I created that will ensure it only counts a merged cell once, will ignore blanks by default (doesn't have to), and will count all cells with the chosen color, but can only count unique values for those cells as an option.  To use it so that it only counts unique values for the chosen color as you intend, the formula would be: <code>=CountColor(A1:C4,A3,TRUE)</code></p>\n\n<p>Arguments:</p>\n\n<ul>\n<li><strong>CheckRange</strong>: Required.  This is the range of cells that will be looped through for color counting</li>\n<li><strong>ColorCompareCell</strong>: Required.  This is a single cell (cannot be merged) that contains the color you would like counted.</li>\n<li><em>UnqOnly</em>: Optional.  False (default) means all values will be counted, True means only unique values will be counted.</li>\n<li><em>CaseSensitive</em>: Optional.  Only relevant when <em>UnqOnly</em> is set to True. False (default) means that unique values do not take case into consideration.  For example, \"ABC\" and \"abc\" would be the same unique value and only counted once.  True means that case is taken into account to determine uniqueness.  For example, \"ABC\" and \"abc\" would be different unique values and each would be counted.</li>\n<li><em>IgnoreBlanks</em>: Optional. True (default) means that cells with blank values will not be counted even if they contain the chosen color.  False means that cells with blank values will be counted anyway.</li>\n</ul>\n\n<p>Full UDF code:</p>\n\n<pre><code>Public Function CountColor(ByVal CheckRange As Range, _\n                           ByVal ColorCompareCell As Range, _\n                           Optional ByVal UnqOnly As Boolean = False, _\n                           Optional ByVal CaseSensitive As Boolean = False, _\n                           Optional ByVal IgnoreBlanks As Boolean = True) As Variant\n\n    Dim UnqValues As Object\n    Dim NewCell As Boolean\n    Dim CheckCell As Range\n    Dim MergedCells As Range\n    Dim TotalCount As Long\n\n    If ColorCompareCell.Cells.Count &lt;&gt; 1 Then\n        CountColor = CVErr(xlErrRef)\n        Exit Function\n    End If\n\n    If UnqOnly Then Set UnqValues = CreateObject(\"Scripting.Dictionary\")\n\n    For Each CheckCell In CheckRange.Cells\n        NewCell = False\n        If CheckCell.MergeArea.Address &lt;&gt; CheckCell.Address Then\n            If MergedCells Is Nothing Then\n                Set MergedCells = CheckCell.MergeArea\n                NewCell = True\n            Else\n                If Intersect(CheckCell, MergedCells) Is Nothing Then\n                    Set MergedCells = Union(MergedCells, CheckCell.MergeArea)\n                    NewCell = True\n                End If\n            End If\n        Else\n            NewCell = True\n        End If\n\n        If NewCell Then\n            If CheckCell.Interior.Color = ColorCompareCell.Interior.Color Then\n                If UnqOnly Then\n                    If CaseSensitive Then\n                        If IgnoreBlanks Then\n                            If Len(Trim(CheckCell.Value)) &gt; 0 Then UnqValues(WorksheetFunction.Trim(CheckCell.Value)) = WorksheetFunction.Trim(CheckCell.Value)\n                        Else\n                            UnqValues(WorksheetFunction.Trim(CheckCell.Value)) = WorksheetFunction.Trim(CheckCell.Value)\n                        End If\n                    Else\n                        If IgnoreBlanks Then\n                            If Len(Trim(CheckCell.Value)) &gt; 0 Then UnqValues(LCase(WorksheetFunction.Trim(CheckCell.Value))) = LCase(WorksheetFunction.Trim(CheckCell.Value))\n                        Else\n                            UnqValues(LCase(WorksheetFunction.Trim(CheckCell.Value))) = LCase(WorksheetFunction.Trim(CheckCell.Value))\n                        End If\n                    End If\n                Else\n                    If IgnoreBlanks Then\n                        If Len(Trim(CheckCell.Value)) &gt; 0 Then TotalCount = TotalCount + 1\n                    Else\n                        TotalCount = TotalCount + 1\n                    End If\n                End If\n            End If\n        End If\n    Next CheckCell\n\n    If UnqOnly Then CountColor = UnqValues.Count Else CountColor = TotalCount\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9145321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed484d1f99d4f0c5b3e670468266c4b?s=128&d=identicon&r=PG&f=1", "display_name": "Dan H", "link": "https://stackoverflow.com/users/9145321/dan-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 1, "accepted_answer_id": 47995190, "answer_count": 1, "score": -2, "last_activity_date": 1514390717, "creation_date": 1514384244, "last_edit_date": 1514385156, "question_id": 47993717, "link": "https://stackoverflow.com/questions/47993717/count-unique-cell-values-by-color-in-excel-vba", "title": "Count Unique Cell Values by Color in Excel VBA", "body": "<p>I'm new to VBA.</p>\n\n<p>Endstate - search through a range and count instances of unique cell values for a user specified filled color counting merged cells (I know, merging ruins everything) as one whole cell.</p>\n\n<p>I've compiled the below code but it's not working quite right, any help would be greatly appreciated!</p>\n\n<pre><code>Function CountUniqueColorBlocks(SearchRange As Range, ColorRange As Range) As Long\nDim cell As Range, blocks As Range\nDim dict As Scripting.Dictionary\nSet dict = New Scripting.Dictionary\nSet blocks = SearchRange(1).MergeArea(1) ' prime union method (which requires &gt;1 value)\nFor Each cell In SearchRange\n    If cell.Interior.Color = ColorRange.Interior.Color And Not dict.Exists(cell.Value) Then\n        dict.Add cell.Value, 0\n End If\nNext\nCountUniqueColorBlocks = dict.Count\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514384048, "post_id": 47993514, "comment_id": 82955433, "body": "You will need to pass the target range into the other code.  otherwise how are the other code supposed to know which row in column D should be updated."}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514384371, "post_id": 47993514, "comment_id": 82955582, "body": "Not sure I follow. I&#39;ve inserted <b>Code</b> in each of the three sheets and the code that populates the values in a dropdown-list maner in column C and the corresponding values in column D in a Module that loops over C and D."}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "edited": false, "score": 0, "creation_date": 1514384695, "post_id": 47993800, "comment_id": 82955703, "body": "What does <code>ByVal Sh As Object</code> do?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "edited": false, "score": 0, "creation_date": 1514384932, "post_id": 47993800, "comment_id": 82955798, "body": "That&#39;s a reference to the sheet - only important if you need to know what sheet you&#39;re on.  For example, if you wanted the code to run on Sheet1 &amp; Sheet2, but not Sheet3 you could use <code>If Sh.Name = &quot;Sheet1&quot; Or Sh.Name = &quot;Sheet2&quot; Then</code>"}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "edited": false, "score": 0, "creation_date": 1514385148, "post_id": 47993800, "comment_id": 82955925, "body": "Ah, I see. But I assume your code still updates the entire range/column D instead of just updating a specific cell? Should I somehow add your code in the Module?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "edited": false, "score": 0, "creation_date": 1514385494, "post_id": 47993800, "comment_id": 82956076, "body": "The code will update only the cell to the right of the cell you changed - so change C3 will updated D3, etc.  <code>Target</code> is a reference to the cell, <code>Target.Offset(,1)</code> is a reference to the cell 1 column to the right (offset by 1 column).  The code should be pasted in the <code>ThisWorkbook</code> module."}, {"owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "edited": false, "score": 0, "creation_date": 1514453880, "post_id": 47993800, "comment_id": 82978119, "body": "Do I need to copy the code in the Module that does the data transformation from column C to D in each sheet? Or do I need to copy your code above in the Module and if so how?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "edited": false, "score": 0, "creation_date": 1514454284, "post_id": 47993800, "comment_id": 82978333, "body": "No, the code just goes in the <code>ThisWorkbook</code> module."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1514384593, "creation_date": 1514384593, "answer_id": 47993800, "question_id": 47993514, "link": "https://stackoverflow.com/questions/47993514/automatically-update-single-cell-value-not-entire-range-vba/47993800#47993800", "title": "Automatically update single cell value (not entire range) - VBA", "body": "<p>You could add code to the <code>ThisWorkbook</code> module to monitor all three sheets.</p>\n\n<p>I've no idea what the corresponding value in column D should be so this code will just copy the value in column C over to column D.  </p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    If Target.Column = 3 Then\n        'Column D is updated to show same value as col C.\n        Target.Offset(, 1) = Target.Value\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 440, "user_id": 4966912, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/99f1f7d24541b652f0e6909192fd5b6c?s=128&d=identicon&r=PG&f=1", "display_name": "Saud ", "link": "https://stackoverflow.com/users/4966912/saud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 601, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514384593, "creation_date": 1514383315, "last_edit_date": 1531164843, "question_id": 47993514, "link": "https://stackoverflow.com/questions/47993514/automatically-update-single-cell-value-not-entire-range-vba", "title": "Automatically update single cell value (not entire range) - VBA", "body": "<p><strong>Description</strong></p>\n\n<p>In my workbook there are three sheets where the user can input or change data.</p>\n\n<p>Currently, when a user chooses 1 out of 4 options in a dropdown-list manner in column C the corresponding value is outputted in column D. The user can then change the value in column D as intended.</p>\n\n<p>I've used the following code to automatically update the value in column D based on the value in column C in each of the three sheets:</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Column = 3\n    Call Macro1\nEnd If   \n\nIf Target.Column = 4\n    Call Macro2\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Problem/Desired output</strong></p>\n\n<p>When the user changes a specific/single value in column C only the corresponding value in column D should change, not the entire column in all three sheets.</p>\n\n<p>Is it possible to restrict the automatic update to a specific cell?</p>\n\n<p>(Please let me know if I need to upload the entire code for the values generated in column C and D in order to provide me with a hint/solution).</p>\n"}, {"tags": ["c++", "vba", "excel", "dll", "sqlite"], "comments": [{"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1514385286, "post_id": 47993365, "comment_id": 82955984, "body": "Is your dll tested in the C++ environment?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1514385287, "post_id": 47993365, "comment_id": 82955985, "body": "Is the location of sqlite3.dll in your PATH environment variable, if not then consider adding it.  Alternatively, if you are controlling its install location then you could load it manually with LoadLibrary from the specific place."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514392885, "post_id": 47993365, "comment_id": 82959357, "body": "Are you sure there isn&#39;t an architecture mismatch (32/64 bit) between your <i>.dll</i> and <i>sqlite3.dll</i>?"}, {"owner": {"reputation": 171, "user_id": 8079802, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/292fddeceee3f7a6f3f9ef0b34dba44b?s=128&d=identicon&r=PG&f=1", "display_name": "techie", "link": "https://stackoverflow.com/users/8079802/techie"}, "reply_to_user": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1514438133, "post_id": 47993365, "comment_id": 82972279, "body": "@TSion.D.P Yes, it is working. I debugged code using VBA(Excel) and it is working fine."}, {"owner": {"reputation": 171, "user_id": 8079802, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/292fddeceee3f7a6f3f9ef0b34dba44b?s=128&d=identicon&r=PG&f=1", "display_name": "techie", "link": "https://stackoverflow.com/users/8079802/techie"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1514438695, "post_id": 47993365, "comment_id": 82972439, "body": "@CristiFati already checked.. there is no mismatch."}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 8079802, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/292fddeceee3f7a6f3f9ef0b34dba44b?s=128&d=identicon&r=PG&f=1", "display_name": "techie", "link": "https://stackoverflow.com/users/8079802/techie"}, "is_accepted": false, "score": 0, "last_activity_date": 1514453024, "creation_date": 1514453024, "answer_id": 48004809, "question_id": 47993365, "link": "https://stackoverflow.com/questions/47993365/error-53-file-not-found-instead-all-dlls-are-present-in-path/48004809#48004809", "title": "Error 53 : File not found instead all DLL&#39;s are present in path", "body": "<p>The <code>cryptlib.lib</code> was missing on which <code>sqlite3.dll</code> was dependent. I have provided the .lib file and it worked.</p>\n"}], "owner": {"reputation": 171, "user_id": 8079802, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/292fddeceee3f7a6f3f9ef0b34dba44b?s=128&d=identicon&r=PG&f=1", "display_name": "techie", "link": "https://stackoverflow.com/users/8079802/techie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514453024, "creation_date": 1514382644, "last_edit_date": 1514382918, "question_id": 47993365, "link": "https://stackoverflow.com/questions/47993365/error-53-file-not-found-instead-all-dlls-are-present-in-path", "title": "Error 53 : File not found instead all DLL&#39;s are present in path", "body": "<p>I created a DLL(using C++) which is dependent on <code>sqlite3.dll</code>(for database access &amp; sqlcipher) and I am trying to access it using <code>VBA</code>. In <code>VBA</code> I am using following declaration  :</p>\n\n<pre><code>Declare Function GetData_VBA Lib \"xyz.dll\" (ByVal path As String, ByVal id As String, ByRef inputArr() As String, ByRef output() As String) As Boolean\n</code></pre>\n\n<p>Earlier when the DLL was not dependent on <code>sqlite3.dll</code> it was working fine, but when I introduced <code>sqlite3.dll</code> it started throwing error </p>\n\n<blockquote>\n  <p>Error 53 : xyz.dll not found</p>\n</blockquote>\n\n<p>I tried changing the declaration to </p>\n\n<pre><code> Declare Function GetData_VBA Lib \"C:\\documents\\user\\...\\projects\\xyz.dll\" (ByVal path As String, ByVal id As String, ByRef inputArr() As String, ByRef output() As String) As Boolean\n</code></pre>\n\n<p>but still its showing the same thing. I used <code>dependency walker</code> to check all the dependency on <code>xyz.dll</code>. I tried putting all <code>xyz.dll</code> &amp; <code>sqlite3.dll</code> in same location but still same error.</p>\n"}, {"tags": ["vba", "performance", "excel", "memory"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1514383106, "post_id": 47993190, "comment_id": 82955009, "body": "If your code works should be moved to another forum to be improved."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1514383708, "post_id": 47993190, "comment_id": 82955290, "body": "Any code can be made slow by repeating it often enough.  And it is not fast code.   Consider changing the argument type from Double to Long so you don&#39;t pay for two expensive floating point conversions.  Avoid Variant, use Client."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1514384058, "post_id": 47993190, "comment_id": 82955437, "body": "Hmm, Dim obj As Client = clientCopy inside the loop should always work.  Use For..To instead of For Each should always work."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1514388983, "post_id": 47993190, "comment_id": 82957613, "body": "Your comments are <i>very</i> misleading.  Please delete the inaccurate ones."}], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1514386298, "post_id": 47994007, "comment_id": 82956446, "body": "I can&#39;t use Client in loops with arrays. I can&#39;t use Collection because I tried it and it runs even slower."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1514386771, "post_id": 47994007, "comment_id": 82956650, "body": "@S Meaden You used <code>for</code> loop instead of <code>for each</code>. I&#39;ve been advised thousands of times on this very forum that <code>for each</code> loops are much much faster and must be used instead of <code>for</code> even if it requeres use of <code>Variant</code>."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1514386840, "post_id": 47994007, "comment_id": 82956676, "body": "Besides my quesion isn&#39;t about the loop. My question is about why adding that particular line of code with <code>Long</code> variable increases execution time so much. Using <code>for</code> <i>might</i> help (though I&#39;m not sure), but the question would still stand."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1514386894, "post_id": 47994007, "comment_id": 82956698, "body": "I do not believe &quot;thousands of times&quot;, your exaggeration is telling.  Just try it."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 2, "creation_date": 1514387070, "post_id": 47994007, "comment_id": 82956780, "body": "A 32-bit Long being set in a class (allocated on the heap and accessed via interfaces) is always gonna be slower than an array of Longs on the stack.  Stop using classes if you&#39;re going to be running this &quot;thousands of times&quot;."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1514387319, "post_id": 47994007, "comment_id": 82956903, "body": "@S Meaden You were right, I&#39;m sorry. The execution time did fall a lot: from <code>20 secunds</code> to <code>2 seconds</code> and from <code>2 minutes 35 seconds</code> to <code>5 seconds</code>. If you edit the question I would change the vote, I shouldn&#39;t have downvoted it (I can&#39;t change the vote unless question was edited). I&#39;m still curious of the nature behind this - now the difference between the cases is about <code>3 seconds</code>, while in my example the difference is <code>2 minutes</code>. That is insane."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 2, "creation_date": 1514387536, "post_id": 47994007, "comment_id": 82956994, "body": "I&#39;m leaving this Q&amp;A thread now.  Final advice, I really like OO but in your use case (with Monte Carlo simulations I presume) running millions of iteration then classes will add too much baggage to use code.  Just declare a bunch of module level arrays with the key data."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1514387740, "post_id": 47994007, "comment_id": 82957065, "body": "@S Meaden You mean baggage in terms of memory overhead? Because apart from that classes provide useful interface, and code-wise help to retain more structure. I&#39;ll try to follow the advice though. Thank you a lot anyways, I didn&#39;t think such execution time decrease was possible! It now will save a lot of trouble performance-wise."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 3, "last_activity_date": 1514387613, "last_edit_date": 1514387613, "creation_date": 1514385467, "answer_id": 47994007, "question_id": 47993190, "link": "https://stackoverflow.com/questions/47993190/excel-vba-setting-a-long-variable-for-each-object-class-dramatically-increases/47994007#47994007", "title": "Excel vba: setting a long variable for each object class dramatically increases execution time", "body": "<p>You have defined <code>clientCopy</code> as a <code>Variant</code>, which has to be resolved at run-time for each method invocation.  Please change to be of type <code>Client</code> and re-run your timings.</p>\n\n<p>Ok, I have re-read the question and comments, to speed up the loop change it thus</p>\n\n<pre><code>Option Explicit\n\nSub start()\n    Application.ScreenUpdating = False\n\n    Dim j As Long\n\n    Dim clientsColl() As Client\n    ReDim clientsColl(1 To 100000) As Client\n\n    For j = 1 To 100000\n        Set clientsColl(j) = New Client\n\n        clientsColl(j).setClientName = \"Client_\" &amp; j\n    Next\n\n    'Dim clientCopy As Variant\n    Dim clientCopy As Client\n\n    MsgBox (\"simulations start\")\n    Dim i As Long\n    For i = 1 To 100\n        Dim lClientLoop As Long\n        For lClientLoop = LBound(clientsColl) To UBound(clientsColl)\n        'For Each clientCopy In clientsColl\n            Set clientCopy = clientsColl(lClientLoop)\n            clientCopy.setSimulationCount = 100\n            clientCopy.generateRandom\n        Next\n    Next\n\n    Application.StatusBar = False\n    Application.ScreenUpdating = True\n\n    MsgBox (\"done\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 47994007, "answer_count": 1, "score": 2, "last_activity_date": 1514387613, "creation_date": 1514381892, "last_edit_date": 1514382611, "question_id": 47993190, "link": "https://stackoverflow.com/questions/47993190/excel-vba-setting-a-long-variable-for-each-object-class-dramatically-increases", "title": "Excel vba: setting a long variable for each object class dramatically increases execution time", "body": "<p>I have a main sub that makes use of a <code>Client</code> class: creates an array with <code>100 000</code> <code>Clients</code> and loops over the array <code>100</code> times, each time setting a different random number to each <code>Client</code>.</p>\n\n<pre><code>Sub start()\n    Application.ScreenUpdating = False\n\n    Dim j As Long\n\n    Dim clientsColl() As Client\n    ReDim clientsColl(1 To 100000) As Client\n\n    For j = 1 To 100000\n        Set clientsColl(j) = New Client\n\n        clientsColl(j).setClientName = \"Client_\" &amp; j\n    Next\n\n    Dim clientCopy As Variant\n\n    MsgBox (\"simulations start\")\n    Dim i As Long\n    For i = 1 To 100\n        For Each clientCopy In clientsColl\n            clientCopy.setSimulationCount = 100\n            clientCopy.generateRandom\n        Next\n    Next\n\n    Application.StatusBar = False\n    Application.ScreenUpdating = True\n\n    MsgBox (\"done\")\nEnd Sub\n</code></pre>\n\n<p>However, this code takes different time to run, depending whether the line <code>clientCopy.setSimulationCount = 100</code> is commented out or not. If this line is commented out the code after the <code>simulations start</code> <code>MsgBox</code> takes <code>16 seconds</code> to run. However, if that line is not commented out and is executed the second loop takes <code>2 minute 35 seconds</code> to run.</p>\n\n<p>Here's the inside of the <code>Client</code> class, the used <code>Let</code> property:</p>\n\n<pre><code>Private simulationCount As Long\n\nPublic Property Let setSimulationCount(value As Double)\n    simulationCount = value\nEnd Property\n\nPrivate randomNumber As Double\n\nPublic Sub generateRandom()\n    randomNumber = Rnd()\nEnd Sub\n</code></pre>\n\n<p>So it simply puts number <code>100</code> inside each client. Why would it increase execution time nine-fold? </p>\n"}, {"tags": ["excel", "vba", "web-scraping", "internet-explorer-11", "queryselector"], "comments": [{"owner": {"reputation": 411841, "user_id": 771848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2DTBv.jpg?s=128&g=1", "display_name": "alecxe", "link": "https://stackoverflow.com/users/771848/alecxe"}, "edited": false, "score": 0, "creation_date": 1514619472, "post_id": 47993064, "comment_id": 83034024, "body": "Quick check: does changing <code>queryselector</code> to <code>querySelector</code> make any difference in the first code sample?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 411841, "user_id": 771848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2DTBv.jpg?s=128&g=1", "display_name": "alecxe", "link": "https://stackoverflow.com/users/771848/alecxe"}, "edited": false, "score": 0, "creation_date": 1514621010, "post_id": 47993064, "comment_id": 83034346, "body": "Nope sir, no change at all. In fact, if I try to write <code>querySelector</code>, it automatically gets back to the lowercase which is <code>queryselector</code>."}, {"owner": {"reputation": 411841, "user_id": 771848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2DTBv.jpg?s=128&g=1", "display_name": "alecxe", "link": "https://stackoverflow.com/users/771848/alecxe"}, "edited": false, "score": 0, "creation_date": 1514621093, "post_id": 47993064, "comment_id": 83034356, "body": "Okay, try this: instead of executing <code>post.queryselector</code> just do the <code>post.innerText</code> directly. It is not what you wanted to do but let&#39;s experiment. Do you see the same error? Thanks."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 411841, "user_id": 771848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2DTBv.jpg?s=128&g=1", "display_name": "alecxe", "link": "https://stackoverflow.com/users/771848/alecxe"}, "edited": false, "score": 0, "creation_date": 1514621539, "post_id": 47993064, "comment_id": 83034442, "body": "Yep sir, I tried with <code>post.innerText</code>. I see the exact error. You perhaps already realized that  If I click to the <code>close program</code> command which is visible in my second (uploaded) image then i get the data. Again, It&#39;s always a pleasure to be in contact with you."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1514636111, "post_id": 47993064, "comment_id": 83037635, "body": "What line is the error on? And if it&#39;s inside the for loop, do any iterations succeed?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1523233095, "post_id": 47993064, "comment_id": 86461984, "body": "Why not to use <a href=\"https://yts.am/api#list_movies\" rel=\"nofollow noreferrer\">API</a>? Check e. g. result from the URL <a href=\"https://yts.am/api/v2/list_movies.json?page=1&amp;limit=50\" rel=\"nofollow noreferrer\">https://yts.am/api/v2/list_movies.json?page=1&amp;limit=50</a>, which actually represents 50 movies from first page of latest movies category, in JSON format."}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 5, "last_activity_date": 1515111925, "creation_date": 1515111925, "answer_id": 48105539, "question_id": 47993064, "link": "https://stackoverflow.com/questions/47993064/scraper-throws-errors-instead-of-quitting-the-browser-when-everything-is-done/48105539#48105539", "title": "Scraper throws errors instead of quitting the browser when everything is done", "body": "<p>Ok, so there is something seriously unfriendly about that webpage.  It kept crashing for me.   So I have resorted to running a javascript program within scripting engine/scripting control and it works.</p>\n\n<p>I hope you can follow it.  The logic is in the javascript added to the ScriptEngine.  I get two lists of nodes, one list of films and one list of years; then I step through each array in sync and add them as key value pair to a Microsoft Scripting Dictionary.</p>\n\n<pre><code>Option Explicit\n\n'*Tools-&gt;References\n'*    Microsoft Scripting Runtime\n'*    Microsoft Scripting Control\n'*    Microsoft Internet Controls\n'*    Microsoft HTML Object Library\n\nSub Torrent_Data()\n    Dim row As Long\n    Dim IE As New InternetExplorer, html As HTMLDocument\n    Dim post As Object\n\n    With IE\n        .Visible = True\n        .navigate \"https://yts.am/browse-movies\"\n        Do While .readyState &lt;&gt; READYSTATE_COMPLETE:\n            DoEvents\n        Loop\n        Set html = .document\n    End With\n\n    Dim dicFilms As Scripting.Dictionary\n    Set dicFilms = New Scripting.Dictionary\n\n    Call GetScriptEngine.Run(\"getMovies\", html, dicFilms)\n\n    Dim vFilms As Variant\n    vFilms = dicFilms.Keys\n\n    Dim vYears As Variant\n    vYears = dicFilms.Items\n\n    Dim lRowLoop As Long\n    For lRowLoop = 0 To dicFilms.Count - 1\n\n        Cells(lRowLoop + 1, 1) = vFilms(lRowLoop)\n        Cells(lRowLoop + 1, 2) = vYears(lRowLoop)\n\n    Next lRowLoop\n\n    Stop\n\n    IE.Quit\nEnd Sub\n\nPrivate Function GetScriptEngine() As ScriptControl\n    '* see code from this SO Q &amp; A\n    ' https://stackoverflow.com/questions/37711073/in-excel-vba-on-windows-how-to-get-stringified-json-respresentation-instead-of\n    Static soScriptEngine As ScriptControl\n    If soScriptEngine Is Nothing Then\n        Set soScriptEngine = New ScriptControl\n        soScriptEngine.Language = \"JScript\"\n\n        soScriptEngine.AddCode \"function getMovies(htmlDocument, microsoftDict) { \" &amp; _\n                                    \"var titles = htmlDocument.querySelectorAll('a.browse-movie-title'), i;\" &amp; _\n                                    \"var years = htmlDocument.querySelectorAll('div.browse-movie-year'), j;\" &amp; _\n                                    \"if ( years.length === years.length) {\" &amp; _\n                                    \"for (i=0; i&lt; years.length; ++i) {\" &amp; _\n                                    \"   var film = titles[i].innerText;\" &amp; _\n                                    \"   var year = years[i].innerText;\" &amp; _\n                                    \"   microsoftDict.Add(film, year);\" &amp; _\n                                    \"}}}\"\n\n    End If\n    Set GetScriptEngine = soScriptEngine\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 2, "last_activity_date": 1578006851, "last_edit_date": 1578006851, "creation_date": 1523303641, "answer_id": 49740683, "question_id": 47993064, "link": "https://stackoverflow.com/questions/47993064/scraper-throws-errors-instead-of-quitting-the-browser-when-everything-is-done/49740683#49740683", "title": "Scraper throws errors instead of quitting the browser when everything is done", "body": "<p>The website has an <a href=\"https://yts.am/api\" rel=\"nofollow noreferrer\">API</a>. Check e. g. result from the URL <a href=\"https://yts.am/api/v2/list_movies.json?page=1&amp;limit=50\" rel=\"nofollow noreferrer\">https://yts.am/api/v2/list_movies.json?page=1&amp;limit=50</a>, which actually represents 50 movies from first page of latest movies category, in JSON format.</p>\n\n<p>Take a look at the below example. <strong>Import <a href=\"https://github.com/omegastripes/VBA-JSON-parser\" rel=\"nofollow noreferrer\">JSON.bas</a> module into the VBA project for JSON processing.</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Test()\n\n    Dim sJSONString As String\n    Dim vJSON\n    Dim sState As String\n    Dim lPage As Long\n    Dim aRes()\n    Dim i As Long\n    Dim aData()\n    Dim aHeader()\n\n    With Sheets(1)\n        .Cells.Delete\n        .Cells.WrapText = False\n    End With\n    lPage = 1\n    aRes = Array()\n    Do\n        With CreateObject(\"MSXML2.XMLHTTP\")\n            .Open \"GET\", \"https://yts.am/api/v2/list_movies.json?page=\" &amp; lPage &amp; \"&amp;limit=50\", False\n            .send\n            sJSONString = .responseText\n        End With\n        JSON.Parse sJSONString, vJSON, sState\n        If Not vJSON(\"data\").Exists(\"movies\") Then Exit Do\n        vJSON = vJSON(\"data\")(\"movies\")\n        ReDim Preserve aRes(UBound(aRes) + UBound(vJSON) + 1)\n        For i = 0 To UBound(vJSON)\n            Set aRes(UBound(aRes) - UBound(vJSON) + i) = vJSON(i)\n        Next\n        lPage = lPage + 1\n        Debug.Print \"Parsed \" &amp; (UBound(aRes) + 1)\n        DoEvents\n    Loop\n    JSON.ToArray aRes, aData, aHeader\n    With Sheets(1)\n        OutputArray .Cells(1, 1), aHeader\n        Output2DArray .Cells(2, 1), aData\n        .Columns.AutoFit\n    End With\n    MsgBox \"Completed\"\n\nEnd Sub\n\nSub OutputArray(oDstRng As Range, aCells As Variant)\n\n    With oDstRng\n        .Parent.Select\n        With .Resize(1, UBound(aCells) - LBound(aCells) + 1)\n            .NumberFormat = \"@\"\n            .Value = aCells\n        End With\n    End With\n\nEnd Sub\n\nSub Output2DArray(oDstRng As Range, aCells As Variant)\n\n    With oDstRng\n        .Parent.Select\n        With .Resize( _\n                UBound(aCells, 1) - LBound(aCells, 1) + 1, _\n                UBound(aCells, 2) - LBound(aCells, 2) + 1)\n            .NumberFormat = \"@\"\n            .Value = aCells\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The output for me as follows, at the moment there are 7182 movies total:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Hc8z6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Hc8z6.png\" alt=\"output\"></a></p>\n\n<p>BTW, the similar approach applied <a href=\"https://stackoverflow.com/search?tab=newest&amp;q=user%3a2165759%20is%3aanswer%20json.bas\">in other answers</a>.</p>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 1, "answer_count": 2, "score": 11, "last_activity_date": 1578006851, "creation_date": 1514381403, "last_edit_date": 1561735184, "question_id": 47993064, "link": "https://stackoverflow.com/questions/47993064/scraper-throws-errors-instead-of-quitting-the-browser-when-everything-is-done", "title": "Scraper throws errors instead of quitting the browser when everything is done", "body": "<p>I've written a scraper to parse movie information from a torrent site. I used <code>IE</code> and <code>queryselector</code>.</p>\n\n<p>My code does parse everything. It throws errors instead of quitting the browser when everything is done. If I cancel the error box then I can see the results.</p>\n\n<p>Here is the full code:</p>\n\n<pre><code>Sub Torrent_Data()\n    Dim IE As New InternetExplorer, html As HTMLDocument\n    Dim post As Object\n\n    With IE\n        .Visible = False\n        .navigate \"https://yts.am/browse-movies\"\n        Do While .readyState &lt;&gt; READYSTATE_COMPLETE: Loop\n        Set html = .Document\n    End With\n\n    For Each post In html.querySelectorAll(\".browse-movie-bottom\")\n        Row = Row + 1: Cells(Row, 1) = post.queryselector(\".browse-movie-title\").innerText\n        Cells(Row, 2) = post.queryselector(\".browse-movie-year\").innerText\n    Next post\n    IE.Quit\nEnd Sub\n</code></pre>\n\n<p>I have uploaded two images to show the errors.</p>\n\n<p><img src=\"https://i.stack.imgur.com/p6Is0.jpg\" alt=\"First error\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/7Ctss.jpg\" alt=\"Second error\"></p>\n\n<p>Both of the errors are appearing at the same time.</p>\n\n<p>I'm using Internet Explorer 11.</p>\n\n<p>If I try like below it brings the results successfully with no issues.</p>\n\n<pre><code>Sub Torrent_Data()\n    Dim IE As New InternetExplorer, html As HTMLDocument\n    Dim post As Object\n\n    With IE\n        .Visible = False\n        .navigate \"https://yts.am/browse-movies\"\n        Do While .readyState &lt;&gt; READYSTATE_COMPLETE: Loop\n        Set html = .Document\n    End With\n\n    For Each post In html.getElementsByClassName(\"browse-movie-bottom\")\n        Row = Row + 1: Cells(Row, 1) = post.queryselector(\".browse-movie-title\").innerText\n        Cells(Row, 2) = post.queryselector(\".browse-movie-year\").innerText\n    Next post\n    IE.Quit\nEnd Sub\n</code></pre>\n\n<p>References added to the library:</p>\n\n<blockquote>\n  <ol>\n  <li>Microsoft Internet Controls  </li>\n  <li>Microsoft HTML Object Library</li>\n  </ol>\n</blockquote>\n\n<p>Is there any reference to add to the library to shake off errors?</p>\n"}, {"tags": ["excel", "vba", "userform", "scripting.dictionary"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514382782, "post_id": 47992903, "comment_id": 82954862, "body": "Can you not use the Worksheet.Name property to get the correct worksheet and then a <a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">lastRow</a> calculation to retrieve the last row?"}, {"owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514383153, "post_id": 47992903, "comment_id": 82955029, "body": "To be honest, I&#39;m not sure, as I&#39;m still relatively new to VBA and haven&#39;t used that property before.  In looking it up, I&#39;m not sure how it would allow me to A - identify the correct sheet, based on the value of the cobo_ClientID or B - be able to bring over the values from the correct sheet, found in the row with the MAX updated date."}, {"owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514388037, "post_id": 47992903, "comment_id": 82957178, "body": "Each Client sheet is named the same as the Client ID.  So, if there are 3 Clients with an ID of &quot;RB1&quot;, &quot;RB2&quot; and &quot;QJ4&quot; respectively, there are 3 Client sheets named &quot;RB1&quot;, &quot;RB2&quot; and &quot;QJ4&quot;.  I&#39;ve been able to get the code to identify the correct sheet, but still can&#39;t get the code to pull in the data from cells on that sheet,from the last row."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514388635, "post_id": 47992903, "comment_id": 82957461, "body": "Struggling to work out from the above but you should be able to use a variable that is the sheet to work with e.g. Set ws1 = Worksheets(cobo_ClientID)   , and to determine the last row see the link i provided in earlier comment, then are the values you want within specific columns in that row? E.g. myValue1 = ws1.Cells(lastRow, &quot;A&quot;)"}, {"owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514389637, "post_id": 47992903, "comment_id": 82957873, "body": "Between the LastRow link you provided, and some advice from another forum, I think I may have it.  So far, this code seems to be working:     Private Sub cobo_ClientID_Change()  Dim Sht As String Dim LastRow As Long  Sht = Me.cobo_ClientID  With ActiveSheet     LastRow = .Cells(.Rows.Count, &quot;E&quot;).End(xlUp).Row End With  txt_Name = Sheets(Sht).Range(&quot;E&quot;).Value txt_DPPymtAmt = Sheets(Sht).Range(&quot;H&quot; &amp; LastRow).Value    End Sub"}, {"owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514389698, "post_id": 47992903, "comment_id": 82957905, "body": "Not sure why, but I don&#39;t see an option to post the code properly, as in my original post."}, {"owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514390072, "post_id": 47992903, "comment_id": 82958083, "body": "Got it!  Thank you VERY much for your help.  My laptop was about to have to grow wings as it flew through the window."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "is_accepted": false, "score": 0, "last_activity_date": 1514390039, "creation_date": 1514390039, "answer_id": 47995018, "question_id": 47992903, "link": "https://stackoverflow.com/questions/47992903/userform-identifying-correct-sheet-based-on-cobo-value/47995018#47995018", "title": "UserForm Identifying Correct Sheet Based on cobo Value", "body": "<p>Between the LastRow link that was provided, and some advice from another forum, I think I have the solution.  The issue seemed to be with how I was setting the LastRow, as well as finding the correct sheet.</p>\n\n<pre><code>Private Sub cobo_ClientID_Change()\n\nDim Sht As String\nDim LastRow As Long\n\nSht = Me.cobo_ClientID\n\nWith ActiveSheet\nLastRow = .Cells(.Rows.Count, \"E\").End(xlUp).Row\nEnd With\n\ntxt_Name = Sheets(Sht).Range(\"E\" &amp; LastRow).Value\ntxt_DPPymtAmt = Sheets(Sht).Range(\"H\" &amp; LastRow).Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1514394101, "last_edit_date": 1514394101, "creation_date": 1514393535, "answer_id": 47995839, "question_id": 47992903, "link": "https://stackoverflow.com/questions/47992903/userform-identifying-correct-sheet-based-on-cobo-value/47995839#47995839", "title": "UserForm Identifying Correct Sheet Based on cobo Value", "body": "<p>This code will look at each sheet name and list them within the combo box.  When you select one of the sheets it will take the values from the last row and place them in the text boxes on the form.   </p>\n\n<p>Add these controls to a userform:  </p>\n\n<ul>\n<li>Combo box called <code>cmbSheets</code></li>\n<li>Three text boxes named <code>txtColA</code>, <code>txtColB</code> and <code>txtColC</code>.  </li>\n</ul>\n\n<p>-</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Dim wrkSht As Worksheet\n\n    'Populate the combo-box with sheet names.\n    For Each wrkSht In ThisWorkbook.Worksheets\n        With Me.cmbSheets\n            .AddItem wrkSht.Name\n        End With\n    Next wrkSht\n\nEnd Sub\n\n\n'Will place the values from the last row columns A:C in textboxes on the form.\nPrivate Sub cmbSheets_Change()\n    Dim rLastCell As Range\n    Dim shtSelected As Worksheet\n\n    'Set a reference to the sheet selected by the combo box.\n    Set shtSelected = ThisWorkbook.Worksheets(cmbSheets.Value)\n\n    Set rLastCell = LastCell(shtSelected)\n\n    With shtSelected\n        Me.txtColA = .Cells(rLastCell.Row, 1)\n        Me.txtColB = .Cells(rLastCell.Row, 2)\n        Me.txtColC = .Cells(rLastCell.Row, 3)\n    End With\nEnd Sub\n\n'This function can be placed in a normal module.\n'Finds the last cell given a worksheet reference.\nPublic Function LastCell(wrkSht As Worksheet) As Range\n\n    Dim lLastCol As Long, lLastRow As Long\n\n    On Error Resume Next\n\n    With wrkSht\n        lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n        lLastRow = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n\n        If lLastCol = 0 Then lLastCol = 1\n        If lLastRow = 0 Then lLastRow = 1\n\n        Set LastCell = wrkSht.Cells(lLastRow, lLastCol)\n    End With\n    On Error GoTo 0\n\nEnd Function  \n</code></pre>\n\n<p><strong>Note -</strong> if any of the values require certain formatting then that should be added using the <code>FORMAT</code> command when copying.<br>\n<strong>E.g.</strong> If a cell has the date <em>01/05/2016</em> for 1st May 2016 then it appears in the text box as <em>5/1/2016</em> (converted to US date format).<br>\nUsing the code <code>Me.txtColC = Format(.Cells(rLastCell.Row, 3), \"dd-mmm-yy\")</code> will display the date as <em>01-May-16</em> on the form.<br>\nSimilarly currency should be added as <code>Me.txtColB = Format(.Cells(rLastCell.Row, 2), \"Currency\")</code> otherwise <em>\u00a315</em> will appear as <em>15</em>.</p>\n\n<p>If you want to exclude certain sheets have a look at <code>SELECT CASE...END SELECT</code> code blocks (or <code>IF...ELSE...END IF</code>)  </p>\n\n<p>If you want the sheet to change as you select different values in the combo box just add <code>shtSelected.Select</code> to the end of the <code>cmbSheets_Change()</code> event.</p>\n"}], "owner": {"reputation": 11, "user_id": 8992222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1da85584d2863abc4f1a03973f39d53?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/8992222/rodger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514394101, "creation_date": 1514380652, "question_id": 47992903, "link": "https://stackoverflow.com/questions/47992903/userform-identifying-correct-sheet-based-on-cobo-value", "title": "UserForm Identifying Correct Sheet Based on cobo Value", "body": "<p>I have a workbook that houses Client information.  There is a sheet for each Client, and each sheet is labeled with the Client's unique ID.  I'm wanting to launch a UserForm where the User will select a Client from a cobo box.  Then, data from the last row of the appropriate sheet populates the UserForm.  </p>\n\n<p>In other code within the same workbook, I'm using a scripting dictionary, but those all tie to a specific range, in a specific sheet.  I have no clue how to code for the UserForm to search across all sheets to find the one that has the same name as the value in the cobo_ClientID field, and then bring in the correct data elements from the row with the MAX updated date.</p>\n\n<p>Here's an example of the scripting dictionary that I've been using in other areas:</p>\n\n<pre><code>Set coboDict = CreateObject(\"Scripting.Dictionary\")\nWith coboDict\n    For Each cStatsClientID In ws1.Range(\"StatsClientID\")\n        If Not .exists(cStatsClientID.Value) Then\n            .Add cStatsClientID.Value, cStatsClientID.Row\n        Else\n            If CLng(cStatsClientID.Offset(, -2).Value) &gt; CLng(ws1.Range(\"B\" &amp; .Item(cStatsClientID.Value))) Then\n            .Item(cStatsClientID.Value) = cStatsClientID.Row\n            End If\n        End If\n    Next cStatsClientID\n    Me.cobo_ClientID.List = Application.Transpose(.keys)\n    End With\n</code></pre>\n"}, {"tags": ["vba", "email", "move"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3341275, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100002897910928/picture?type=large", "display_name": "user3341275", "link": "https://stackoverflow.com/users/3341275/user3341275"}, "edited": false, "score": 0, "creation_date": 1514458887, "post_id": 47992986, "comment_id": 82980707, "body": "Thanks for your reply this was indeed the solution!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1514380980, "creation_date": 1514380980, "answer_id": 47992986, "question_id": 47992801, "link": "https://stackoverflow.com/questions/47992801/vba-move-mail-from-junk-to-inbox/47992986#47992986", "title": "VBA: Move Mail from Junk to Inbox", "body": "<p>Try without <code>()</code></p>\n\n<pre><code>Item.Move olFLD\n</code></pre>\n\n<p>Source:</p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-move-method-outlook\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/mailitem-move-method-outlook</a></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 416, "user_id": 4225297, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vVOhmxwSR7E/AAAAAAAAAAI/AAAAAAAAAS4/kItxZ-QFCos/photo.jpg?sz=128", "display_name": "John Ink", "link": "https://stackoverflow.com/users/4225297/john-ink"}, "reply_to_user": {"reputation": 17, "user_id": 3341275, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100002897910928/picture?type=large", "display_name": "user3341275", "link": "https://stackoverflow.com/users/3341275/user3341275"}, "edited": false, "score": 0, "creation_date": 1514459388, "post_id": 47993135, "comment_id": 82980925, "body": "Glad I could help."}], "tags": [], "owner": {"reputation": 416, "user_id": 4225297, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vVOhmxwSR7E/AAAAAAAAAAI/AAAAAAAAAS4/kItxZ-QFCos/photo.jpg?sz=128", "display_name": "John Ink", "link": "https://stackoverflow.com/users/4225297/john-ink"}, "is_accepted": true, "score": 1, "last_activity_date": 1514381632, "creation_date": 1514381632, "answer_id": 47993135, "question_id": 47992801, "link": "https://stackoverflow.com/questions/47992801/vba-move-mail-from-junk-to-inbox/47993135#47993135", "title": "VBA: Move Mail from Junk to Inbox", "body": "<p>Parenthesis are weird in vba. When you call a function from an object where you're not expecting a return value, you'd leave off the parenthesis.</p>\n\n<pre><code>Item.Move olFLD\n</code></pre>\n\n<p>Alternatively, to avoid confusion as to when and when not to use parenthesis, you can preface functions with <code>Call</code></p>\n\n<pre><code>Call Item.Move(olFLD)\n</code></pre>\n\n<p>Read more:\n<a href=\"https://stackoverflow.com/questions/5413765/what-are-the-rules-governing-usage-of-brackets-in-vba-function-calls\">What are the rules governing usage of brackets in VBA function calls?</a></p>\n"}], "owner": {"reputation": 17, "user_id": 3341275, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/100002897910928/picture?type=large", "display_name": "user3341275", "link": "https://stackoverflow.com/users/3341275/user3341275"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 47993135, "answer_count": 2, "score": 0, "last_activity_date": 1514381632, "creation_date": 1514380221, "question_id": 47992801, "link": "https://stackoverflow.com/questions/47992801/vba-move-mail-from-junk-to-inbox", "title": "VBA: Move Mail from Junk to Inbox", "body": "<p>I'm trying to move all my junk mail to my inbox by VBA code. Unfortunately i get an '424 object required' error on this line:</p>\n\n<pre><code>    Item.Move (olFLD)\n</code></pre>\n\n<p>The code works when i try to move mail from inbox to another folder but it doesn't work the other way around when i try to move a mail from junk to the inbox.</p>\n\n<pre><code>Dim OlNS As Outlook.NameSpace\nDim olFLD As Outlook.Folder\nDim olJunk As Outlook.Folder\n\nSub Junk()\n\nSet OlNS = Outlook.GetNamespace(\"MAPI\")\nSet olFLD = OlNS.GetDefaultFolder(olFolderInbox)\nSet olJunk = OlNS.GetDefaultFolder(olFolderJunk)\n\nWhile olJunk.Items.Count &lt;&gt; 0\n\nFor Each Item In olJunk.Items\n\nItem.Move (olFLD)\n\nNext\n\nWend\n\nEnd Sub\n</code></pre>\n\n<p>Does anyone have an answer to my problem?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "xml-parsing"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1514379078, "post_id": 47992452, "comment_id": 82953170, "body": "Welcome to SO, I could not find a clear question, can you modify your post and define a question to solve? Please read&gt; <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> also read&gt; <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514379868, "post_id": 47992452, "comment_id": 82953534, "body": "It&#39;s not XML. It&#39;s just a set of tags."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1514381143, "post_id": 47992452, "comment_id": 82954104, "body": "Where do you load the Document?  I would start by modifying the <code>Sub LoadDocument</code> found here: <a href=\"https://msdn.microsoft.com/en-us/library/aa468547.aspx\" rel=\"nofollow noreferrer\">A Beginner&#39;s Guide to the XML DOM</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 0, "last_activity_date": 1514390570, "creation_date": 1514390570, "answer_id": 47995153, "question_id": 47992452, "link": "https://stackoverflow.com/questions/47992452/extract-xml-data-from-nodes-in-vba/47995153#47995153", "title": "Extract XML data from nodes in VBA", "body": "<p>As commented your original Xml did not \"compile\" (well-formed) so I edited that resource I hope it was a good edit because I have written code against it.</p>\n\n<p>I have a problem with Xml namespaces because I do not know how to get a default namespace where I can skip a prefix.  So I am forced in my solution to always use a prefix even if I have to fake one.  The fake namespace <code>sf2</code> is added in my line beginning </p>\n\n<p><code>dom.setProperty \"SelectionNamespaces\", \"xmlns:sf='urn:sobject.enterprise.soap.sforce.com' xmlns:sf2='urn:enterprise.soap.sforce.com'</code></p>\n\n<p>I hope real Xml namespace expert can rewrite this answer better.  In the meantime this code works.  So I saved the file to a local drive.  Also, it is possible to totally drill in and grab the two <code>&lt;records/&gt;</code> elements directly but if you want a full path then see the commented out <code>Debug.Assert</code> lines</p>\n\n<pre><code>Option Explicit\n\n\nSub TestCoreLogic()\n    Dim dom As MSXML2.DOMDocument60\n    Set dom = New MSXML2.DOMDocument60\n\n    dom.Load \"N:\\xmlfile1.xml\"\n    Debug.Assert dom.parseError.ErrorCode = 0\n\n\n\n    dom.setProperty \"SelectionLanguage\", \"XPath\"\n\n\n    dom.setProperty \"SelectionNamespaces\", \"xmlns:sf='urn:sobject.enterprise.soap.sforce.com' xmlns:sf2='urn:enterprise.soap.sforce.com' xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' \"\n\n    CoreLogic dom\nEnd Sub\n'\nFunction CoreLogic(ByVal xmlDoc As MSXML2.DOMDocument60)\n\n    Dim records As MSXML2.IXMLDOMElement\n    Set records = xmlDoc.DocumentElement\n\n    Dim lists As MSXML2.IXMLDOMNodeList\n\n    'Debug.Assert records.SelectNodes(\"//soapenv:Envelope\").Length = 1\n    'Debug.Assert records.SelectNodes(\"//soapenv:Envelope/soapenv:Body\").Length = 1\n    'Debug.Assert records.SelectNodes(\"//soapenv:Envelope/soapenv:Body/sf2:queryResponse\").Length = 1\n    'Debug.Assert records.SelectNodes(\"//soapenv:Envelope/soapenv:Body/sf2:queryResponse/sf2:result\").Length = 1\n    '\n    'Debug.Assert records.SelectNodes(\"//soapenv:Envelope/soapenv:Body/sf2:queryResponse/sf2:result/sf2:records\").Length = 2\n    'Set lists = records.SelectNodes(\"//soapenv:Envelope/soapenv:Body/sf2:queryResponse/sf2:result/sf2:records\")\n\n    Debug.Assert records.SelectNodes(\"//sf2:records\").Length = 2\n    Set lists = records.SelectNodes(\"//sf2:records\")\n\n    Dim listNode As MSXML2.IXMLDOMNode\n\n    For Each listNode In lists\n        Debug.Print \"---Email---\"\n\n        Dim fieldNode As MSXML2.IXMLDOMNode\n        For Each fieldNode In listNode.ChildNodes\n            Debug.Print \"[\" &amp; fieldNode.BaseName &amp; \"] = [\" &amp; fieldNode.Text &amp; \"]\"\n        Next fieldNode\n    Next listNode\n\n    Set records = Nothing\n    Set lists = Nothing\n    Set listNode = Nothing\n    Set fieldNode = Nothing\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7552958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8yPRX.jpg?s=128&g=1", "display_name": "Elia", "link": "https://stackoverflow.com/users/7552958/elia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 47995153, "answer_count": 1, "score": 0, "last_activity_date": 1514390570, "creation_date": 1514378759, "last_edit_date": 1531164843, "question_id": 47992452, "link": "https://stackoverflow.com/questions/47992452/extract-xml-data-from-nodes-in-vba", "title": "Extract XML data from nodes in VBA", "body": "<p>hey I'm trying to see what I'm doing wrong I hope you can help me\nI get an <strong>xml</strong> response as follows</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns=\"urn:enterprise.soap.sforce.com\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:sf=\"urn:sobject.enterprise.soap.sforce.com\"&gt;\n  &lt;soapenv:Header&gt;\n    &lt;LimitInfoHeader&gt;\n      &lt;limitInfo&gt;\n        &lt;current&gt;50&lt;/current&gt;\n        &lt;limit&gt;5000000&lt;/limit&gt;\n        &lt;type&gt;API REQUESTS&lt;/type&gt;\n      &lt;/limitInfo&gt;\n    &lt;/LimitInfoHeader&gt;\n  &lt;/soapenv:Header&gt;\n  &lt;soapenv:Body&gt;\n    &lt;queryResponse&gt;\n      &lt;result&gt;\n        &lt;done&gt;true&lt;/done&gt;\n        &lt;queryLocator xsi:nil=\"true\"/&gt;\n        &lt;records xsi:type=\"sf:Nodav\"&gt;\n          &lt;sf:Id&gt;a0S0E000000DMUg320&lt;/sf:Id&gt;\n          &lt;sf:Name&gt;Netta test 11&lt;/sf:Name&gt;\n        &lt;/records&gt;\n        &lt;records xsi:type=\"sf:Nodav\"&gt;\n          &lt;sf:Id&gt;a0S0E000000DMUg321&lt;/sf:Id&gt;\n          &lt;sf:Name&gt;Netta test 32&lt;/sf:Name&gt;\n        &lt;/records&gt;\n        &lt;size&gt;2&lt;/size&gt;\n      &lt;/result&gt;\n    &lt;/queryResponse&gt;\n  &lt;/soapenv:Body&gt;\n&lt;/soapenv:Envelope&gt;\n</code></pre>\n\n<p>and my code looks like:</p>\n\n<pre><code>Dim xmlhtp As New MSXML2.XMLHTTP\nDim xmlDoc As New MSXML2.DOMDocument\n    Set records = xmlDoc.DocumentElement\nSet lists = records.SelectNodes(\"//Envelope/Header/Body/queryResponse/result/records\")\nFor Each listNode In lists.ChildNodes\n    Debug.Print \"---Email---\"\n    For Each fieldNode In listNode.ChildNodes\n        Debug.Print \"[\" &amp; fieldNode.BaseName &amp; \"] = [\" &amp; fieldNode.Text &amp; \"]\"\n    Next fieldNode\nNext listNode\n\nSet records = Nothing\n</code></pre>\n\n<p>now I get en error and all I want is to get the <code>sf:id</code> and the <code>sf:name</code> from all records can you help me fix my code please?</p>\n\n<p>have a great day</p>\n"}, {"tags": ["xml", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1514378935, "post_id": 47992369, "comment_id": 82953104, "body": "Welcome to SO, I could not find a clear question, can you modify your post and define a question to solve? Please read&gt; <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514407804, "post_id": 47992571, "comment_id": 82965294, "body": "It&#39;s an awesome solution @William Walseth. +1 for this. What if I&#39;ve a text file in my desktop loaded with the same content you defined in your <code>strXML</code> and I would like to use the way you did here then how would the change will look like? I tried with <code>strXML = ThisWorkbook.Path &amp; &quot;\\ht_ml.txt&quot;</code> but it doesn&#39;t seem to work at all. Should I bring about any changes other than what you have done up there? Thanks."}, {"owner": {"reputation": 2461, "user_id": 901290, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ISEyi.jpg?s=128&g=1", "display_name": "William Walseth", "link": "https://stackoverflow.com/users/901290/william-walseth"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514408579, "post_id": 47992571, "comment_id": 82965559, "body": "Use the XML.Load( strFullPathToYourFile) to load the XML"}, {"owner": {"reputation": 13, "user_id": 9145176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d856c92402b01c4a253124ad3401d8?s=128&d=identicon&r=PG&f=1", "display_name": "atp", "link": "https://stackoverflow.com/users/9145176/atp"}, "edited": false, "score": 0, "creation_date": 1514444281, "post_id": 47992571, "comment_id": 82974170, "body": "This is working for me. Thanks... But how i will read the IP address &lt;P type=&quot;IP&quot;&gt;172.18.12.243&lt;/P&gt;  , because, here i cannot give a particular attribute. I need to extract IP address as will.  I am new to the coding ."}, {"owner": {"reputation": 2461, "user_id": 901290, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ISEyi.jpg?s=128&g=1", "display_name": "William Walseth", "link": "https://stackoverflow.com/users/901290/william-walseth"}, "edited": false, "score": 0, "creation_date": 1514470513, "post_id": 47992571, "comment_id": 82986261, "body": "ndXML(i).SelectSingleNode( &quot;//p[@type=&#39;IP&#39;]&quot;).InnerText"}], "tags": [], "owner": {"reputation": 2461, "user_id": 901290, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ISEyi.jpg?s=128&g=1", "display_name": "William Walseth", "link": "https://stackoverflow.com/users/901290/william-walseth"}, "is_accepted": true, "score": 1, "last_activity_date": 1514379286, "creation_date": 1514379286, "answer_id": 47992571, "question_id": 47992369, "link": "https://stackoverflow.com/questions/47992369/find-in-xml-through-vba/47992571#47992571", "title": "Find in XML through vba", "body": "<p>Here's a quick function that loops through each //ConnectedAP that outputs the @iedName attribute.</p>\n\n<pre><code>Public Sub getXML()\n  Set XML = CreateObject(\"MSXML2.DOMDocument\")\n  Dim strXML As String\n  strXML = \"&lt;xml&gt;&lt;ConnectedAP apName='I16:ETH0' iedName='IE16'&gt;    &lt;Address&gt;      &lt;P type='OSI-AP-Title'&gt;1,3,9999,23&lt;/P&gt;      &lt;P type='IP'&gt;172.18.12.243&lt;/P&gt;      &lt;P type='OSI-AE-Qualifier'&gt;23&lt;/P&gt;      &lt;P type='OSI-PSEL'&gt;0001&lt;/P&gt;      &lt;P type='OSI-SSEL'&gt;0001&lt;/P&gt;      &lt;P type='OSI-TSEL'&gt;00000001&lt;/P&gt;    &lt;/Address&gt;  &lt;/ConnectedAP&gt;  &lt;ConnectedAP apName='S1' iedName='STGK16999997422'&gt;   &lt;Address&gt;      &lt;P type='OSI-AP-Title'&gt;1,3,9999,23&lt;/P&gt;      &lt;P type='IP'&gt;172.18.12.24&lt;/P&gt;      &lt;P type='OSI-AE-Qualifier'&gt;23&lt;/P&gt;      &lt;P type='OSI-PSEL'&gt;00000001&lt;/P&gt;      &lt;P type='OSI-SSEL'&gt;0001&lt;/P&gt;      &lt;P type='OSI-TSEL'&gt;0001&lt;/P&gt;    &lt;/Address&gt;&lt;/ConnectedAP&gt;&lt;/xml&gt;\"\n  Call XML.LoadXML(strXML)\n  Dim ndXML As Object\n  Set ndXML = XML.SelectNodes(\"//ConnectedAP\")\n  For i = 0 To ndXML.Length - 1\n    MsgBox ndXML(i).getAttribute(\"iedName\")\n  Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9145176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d856c92402b01c4a253124ad3401d8?s=128&d=identicon&r=PG&f=1", "display_name": "atp", "link": "https://stackoverflow.com/users/9145176/atp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 47992571, "answer_count": 1, "score": 0, "last_activity_date": 1514388226, "creation_date": 1514378405, "last_edit_date": 1514388226, "question_id": 47992369, "link": "https://stackoverflow.com/questions/47992369/find-in-xml-through-vba", "title": "Find in XML through vba", "body": "<p>I have a <strong>xml</strong> file like below.</p>\n\n<pre><code>  &lt;ConnectedAP apName=\"I16:ETH0\" iedName=\"IE16\"&gt;    \n    &lt;Address&gt;   \n      &lt;P type=\"OSI-AP-Title\"&gt;1,3,9999,23&lt;/P&gt;    \n      &lt;P type=\"IP\"&gt;172.18.12.243&lt;/P&gt;    \n      &lt;P type=\"OSI-AE-Qualifier\"&gt;23&lt;/P&gt; \n      &lt;P type=\"OSI-PSEL\"&gt;0001&lt;/P&gt;   \n      &lt;P type=\"OSI-SSEL\"&gt;0001&lt;/P&gt;   \n      &lt;P type=\"OSI-TSEL\"&gt;00000001&lt;/P&gt;   \n    &lt;/Address&gt;  \n  &lt;/ConnectedAP&gt;    \n  &lt;ConnectedAP apName=\"S1\" iedName=\"STGK16999997422\"&gt;   \n    &lt;Address&gt;   \n      &lt;P type=\"OSI-AP-Title\"&gt;1,3,9999,23&lt;/P&gt;    \n      &lt;P type=\"IP\"&gt;172.18.12.24&lt;/P&gt; \n      &lt;P type=\"OSI-AE-Qualifier\"&gt;23&lt;/P&gt; \n      &lt;P type=\"OSI-PSEL\"&gt;00000001&lt;/P&gt;   \n      &lt;P type=\"OSI-SSEL\"&gt;0001&lt;/P&gt;   \n      &lt;P type=\"OSI-TSEL\"&gt;0001&lt;/P&gt;   \n    &lt;/Address&gt;  \n  &lt;/ConnectedAP&gt;    \n  &lt;ConnectedAP apName=\"LD0\" iedName=\"GTG699999731RET\"&gt;  \n    &lt;Address&gt;   \n</code></pre>\n\n<p>I need to find the value of <code>iedName</code> via <strong>vba</strong>.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1514382697, "post_id": 47992251, "comment_id": 82954826, "body": "Using Access since &#39;98 and didn&#39;t know that.   Never had need to click those icons I guess and never accidentally clicked them either. :)"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1514382980, "post_id": 47992251, "comment_id": 82954960, "body": "@Darren Bartrup-Cook Same here. I only found out when I accidentally pressed the procedure view one day."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1514377871, "creation_date": 1514377871, "answer_id": 47992251, "question_id": 47992164, "link": "https://stackoverflow.com/questions/47992164/how-to-view-code-for-all-subs-in-a-module-at-the-same-time/47992251#47992251", "title": "How to view code for all subs in a module at the same time", "body": "<p>On the left hand side of the horizontal scrollbar in VB Editor, there are two button options:</p>\n\n<p>1) Procedure view</p>\n\n<p>2) Full module view.</p>\n\n<p>Select the latter. Hover your mouse to see which is which.</p>\n"}], "owner": {"reputation": 2344, "user_id": 8461786, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/55878061e134ad81c5d169881b3c6d2e?s=128&d=identicon&r=PG&f=1", "display_name": "barciewicz", "link": "https://stackoverflow.com/users/8461786/barciewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 47992251, "answer_count": 1, "score": 2, "last_activity_date": 1514378015, "creation_date": 1514377473, "last_edit_date": 1514378015, "question_id": 47992164, "link": "https://stackoverflow.com/questions/47992164/how-to-view-code-for-all-subs-in-a-module-at-the-same-time", "title": "How to view code for all subs in a module at the same time", "body": "<p>For some reason my VBA editor changed behavior and now to see the code of another subroutine in a module I have to use navigate to them using dropdowns and thus can see only one at a time.</p>\n\n<p>How do I change the view to see all subs and functions at the same time, only divided by a horizontal line, as it was before?</p>\n"}, {"tags": ["vba", "excel", "printing"], "answers": [{"tags": [], "owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "is_accepted": true, "score": 0, "last_activity_date": 1514801158, "creation_date": 1514801158, "answer_id": 48048741, "question_id": 47991398, "link": "https://stackoverflow.com/questions/47991398/activeprinter-not-works-for-embedded-documents/48048741#48048741", "title": "ActivePrinter not works for embedded documents", "body": "<p>In this case (<em>set specific printer for printing an embedded document</em>), the point is that we should set printer for the embedded object <code>Application</code> object.</p>\n\n<p>Sub PrintJob()</p>\n\n<pre><code>    Dim ObjWord As Word.Application\n    Dim objDoc As Word.Document\n\n    'Initialization\n    ActiveSheet.OLEObjects(\"WDoc\").Activate\n    Set ObjWord = GetObject(, \"Word.Application\")\n    ObjWord.Visible = False\n    Set objDoc = ObjWord.activedocument\n\n    'Here we set the ActivePrinter for the objWord's Application object:\n    objWord.Application.ActivePrinter = \"HP LaserJet Pro MFP M127-M128 PCLmS on Ne01:\"\n\n    objDoc.PrintOut\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 434, "user_id": 9075944, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1cfe5b6b167756a9d0b83c40cf631bdf?s=128&d=identicon&r=PG&f=1", "display_name": "Tuberose", "link": "https://stackoverflow.com/users/9075944/tuberose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 48048741, "answer_count": 1, "score": 0, "last_activity_date": 1514801158, "creation_date": 1514374214, "last_edit_date": 1514613660, "question_id": 47991398, "link": "https://stackoverflow.com/questions/47991398/activeprinter-not-works-for-embedded-documents", "title": "ActivePrinter not works for embedded documents", "body": "<p>My default printer in <code>Control Panel&gt; Printer and Faxes</code>, is <strong><code>HP LaserJet P2035 on Ne02:</code></strong></p>\n\n<p>I have <strong>two</strong> active printers connected to my system.</p>\n\n<p>I want <code>PrintOut</code> with my second printer which is: <strong><code>HP LaserJet Pro MFP M127-M128 PCLmS on Ne01:</code></strong></p>\n\n<p>There is a <em>MS-Word document which embedded</em> (<strong>as an Icon</strong>) in <code>Sheet1</code></p>\n\n<p>I <code>PrintOut</code> above embedded document.</p>\n\n<p>My code is:</p>\n\n<pre><code>Sub PrintJob()\n\n    Dim ObjWord As Word.Application\n    Dim objDoc As Word.Document\n\n    'Initialization\n    ActiveSheet.OLEObjects(\"WDoc\").Activate\n    Set ObjWord = GetObject(, \"Word.Application\")\n    ObjWord.Visible = False\n    Set objDoc = ObjWord.activedocument\n    Application.ActivePrinter = \"HP LaserJet Pro MFP M127-M128 PCLmS on Ne01:\"\n\n    objDoc.PrintOut\n\nEnd Sub\n</code></pre>\n\n<p>Unfortunately the <code>PrintOut</code> done with <code>HP LaserJet P2035 on Ne02:</code> printer.</p>\n\n<p>So the <code>PrintOut</code> does not accept the <code>ActivePrinter</code> argument.</p>\n\n<p>The point is the <code>PrintOut</code> with changing <code>ActivePrinter</code> is act rightly when using in <code>Worksheet</code> Print. (as below)</p>\n\n<pre><code>Application.ActivePrinter=\"HP LaserJet Pro MFP M127-M128 PCLmS on Ne01:\"\nThisWorkbook.ActiveSheet.Printout\n</code></pre>\n\n<p>But the problem is for changing <code>ActivePrinter</code> and <code>objDoc.PrintOut</code> (first above code), is the <code>ActivePrinter</code> is not effective and <code>PrintOut</code> have done with my <strong>System Default Printer</strong>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 8949722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7875d8b59ce65d2d5eec82784e6220b0?s=128&d=identicon&r=PG&f=1", "display_name": "venom181", "link": "https://stackoverflow.com/users/8949722/venom181"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514374096, "post_id": 47991227, "comment_id": 82950954, "body": "I have added the code which I am trying to work on"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514374749, "post_id": 47991227, "comment_id": 82951249, "body": "You can replace this Range(&quot;H1&quot;, Range(&quot;H1&quot;).End(xlDown)).Rows.Count with a variable e.g. lastRow, j serves no purpose in the second For Loop as does not increment so can be removed."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514375353, "post_id": 47991227, "comment_id": 82951491, "body": "Your code doesn&#39;t do any comparison other than an ISEMPTY test. It simply copies and pastes."}], "owner": {"reputation": 1, "user_id": 8949722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7875d8b59ce65d2d5eec82784e6220b0?s=128&d=identicon&r=PG&f=1", "display_name": "venom181", "link": "https://stackoverflow.com/users/8949722/venom181"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514378136, "creation_date": 1514373489, "last_edit_date": 1514378136, "question_id": 47991227, "link": "https://stackoverflow.com/questions/47991227/copying-from-a-set-of-cells-from-one-column-and-paste-them-in-consecutive-column", "title": "Copying from a set of cells from one column and paste them in consecutive columns in VBA Excel Macros", "body": "<p>I have got a set of values in Range 'A' and Range 'B'. I want to compare each consecutive row of Range 'A' and when the previous row is greater than the next row ; I want to copy then set of points below the compared points and paste them in the consecutive columns. for eg. C,G,J etc... I have got the compare  part  done ..Just the arranging part is taking my time. In my case I am trying to use DO Until and For Loop. But is there any better way ... PLs Advice...</p>\n\n<pre><code> Range(\"H1\").Select\n\n Do Until Range(\"H1\", Range(\"H1\").End(xlDown))\n\n If IsEmpty(ActiveCell) Then\n\n ActiveCell.Offset(1, 0).Select\n j = 2\n\n For i = 1 To Range(\"H1\", Range(\"H1\").End(xlDown)).Rows.Count\n\n Cells(i + 1, 8).Select\n Selection.Copy\n Cells(i + 1, 11 + j).Select\n ActiveSheet.Paste\n\n Cells(i + 1, 9).Select\n Selection.Copy\n Cells(i + 1, 12 + j).Select\n ActiveSheet.Paste\n\n\n Next i\n\nActiveCell.Offset(1, 0).Select\n\n\n Else\n\n j = 0\n For i = 1 To Range(\"H1\", Range(\"H1\").End(xlDown)).Rows.Count\n\n Cells(i + 1, 8).Select\n Selection.Copy\n Cells(i + 1, 11 + j).Select\n ActiveSheet.Paste\n\n Cells(i + 1, 9).Select\n Selection.Copy\n Cells(i + 1, 12 + j).Select\n ActiveSheet.Paste\n\n Next i\n\n ActiveCell.Offset(1, 0).Select\n\n End If\n\n\n\nLoop\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "rows"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514374075, "post_id": 47991176, "comment_id": 82950942, "body": "If you look into powerquery, you can set your data up as a table, then inside of this table go to  powerquery or data(2016) tab &gt; query from table , then in the window that appears select the last 2 columns and right click unpivot columns"}, {"owner": {"reputation": 1, "user_id": 9144820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb4c9903ddd437cab86dbf5c36427d7e?s=128&d=identicon&r=PG&f=1", "display_name": "tasoik", "link": "https://stackoverflow.com/users/9144820/tasoik"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514374730, "post_id": 47991176, "comment_id": 82951241, "body": "Thanks for the reply. Where is this powerquery? I have Office 2013"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514374841, "post_id": 47991176, "comment_id": 82951282, "body": "2013 it is a free microsoft <a href=\"https://www.microsoft.com/en-gb/download/details.aspx?id=39379\" rel=\"nofollow noreferrer\">add-in</a> - if a work machine check that you are allowed to install."}, {"owner": {"reputation": 1, "user_id": 9144820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb4c9903ddd437cab86dbf5c36427d7e?s=128&d=identicon&r=PG&f=1", "display_name": "tasoik", "link": "https://stackoverflow.com/users/9144820/tasoik"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514375032, "post_id": 47991176, "comment_id": 82951360, "body": "Sorry cannot install addins. Firewall restrictions etc...It is forbidden by a company policy. So is there any way to create the result just like my example?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514375088, "post_id": 47991176, "comment_id": 82951379, "body": "You could enquire with your IT dept whether they will allow as is a microsoft not third party add-in."}], "answers": [{"tags": [], "owner": {"reputation": 352, "user_id": 4009944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e5e3f1e0d0143ff5761aaf55c39d34a?s=128&d=identicon&r=PG&f=1", "display_name": "Neechalkaran", "link": "https://stackoverflow.com/users/4009944/neechalkaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1514375068, "creation_date": 1514375068, "answer_id": 47991580, "question_id": 47991176, "link": "https://stackoverflow.com/questions/47991176/how-to-create-macro-to-split-columns-and-rows/47991580#47991580", "title": "How to create macro to split columns and rows?", "body": "<p>I have created simple VBA code to split the rows into column from sheet1 to sheet2 of the Activeworkbook. you can modify the code as per need.</p>\n\n<pre><code>Dim sel As Range, b As Range\nDim rcount As Integer: rcount = 1\nActiveWorkbook.Sheets(2).Range(\"A:C\").Delete Shift:=xlDown\nWith ActiveWorkbook.Sheets(1)\nSet sel = .Range(\"A2:C\" &amp; .UsedRange.Rows.Count)\nFor Each b In sel.Rows\nActiveWorkbook.Sheets(2).Cells(rcount, 1).Value = b.Value2(1, 1)\nActiveWorkbook.Sheets(2).Cells(rcount, 2).Value = .Cells(1, 2).Value\nActiveWorkbook.Sheets(2).Cells(rcount, 3).Value = b.Value2(1, 2)\nActiveWorkbook.Sheets(2).Cells(rcount + 1, 1).Value = b.Value2(1, 1)\nActiveWorkbook.Sheets(2).Cells(rcount + 1, 2).Value = .Cells(1, 3).Value\nActiveWorkbook.Sheets(2).Cells(rcount + 1, 3).Value = b.Value2(1, 3)\nrcount = rcount + 2\nNext\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9144820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb4c9903ddd437cab86dbf5c36427d7e?s=128&d=identicon&r=PG&f=1", "display_name": "tasoik", "link": "https://stackoverflow.com/users/9144820/tasoik"}, "edited": false, "score": 0, "creation_date": 1514384978, "post_id": 47991655, "comment_id": 82955822, "body": "Thank you both. This is what I was looking for. :)"}], "tags": [], "owner": {"reputation": 1167, "user_id": 7675683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dZE7OcdTDRU/AAAAAAAAAAI/AAAAAAAAACo/XOwRcFSsn8A/photo.jpg?sz=128", "display_name": "Phil", "link": "https://stackoverflow.com/users/7675683/phil"}, "is_accepted": false, "score": 1, "last_activity_date": 1514375390, "creation_date": 1514375390, "answer_id": 47991655, "question_id": 47991176, "link": "https://stackoverflow.com/questions/47991176/how-to-create-macro-to-split-columns-and-rows/47991655#47991655", "title": "How to create macro to split columns and rows?", "body": "<p>Suppose your data are in <code>Sheet1</code>, and we will let the splited data in <code>Sheet2</code>. Here is a simple solution:</p>\n\n<pre><code>Sub Split_Column()\n\nSet st1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet st2 = ThisWorkbook.Sheets(\"Sheet2\")\n\nj = 1\nFor i = 1 To st1.UsedRange.Rows.Count\n\n    st2.Cells(j, 1) = st1.Cells(i, 1)\n    st2.Cells(j, 2) = \"Pay\"\n    st2.Cells(j, 3) = st1.Cells(i, 3)\n    j = j + 1\n    st2.Cells(j, 1) = st1.Cells(i, 1)\n    st2.Cells(j, 2) = \"Receive\"\n    st2.Cells(j, 3) = st1.Cells(i, 2)\n    j = j + 1\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9144820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb4c9903ddd437cab86dbf5c36427d7e?s=128&d=identicon&r=PG&f=1", "display_name": "tasoik", "link": "https://stackoverflow.com/users/9144820/tasoik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514402825, "creation_date": 1514373243, "last_edit_date": 1531164843, "question_id": 47991176, "link": "https://stackoverflow.com/questions/47991176/how-to-create-macro-to-split-columns-and-rows", "title": "How to create macro to split columns and rows?", "body": "<p>I have a long worksheet which include 3 columns:</p>\n\n<p>Column A = Invoice number<br>\nColumn B = Receive amounts<br>\nColumn C - Pay amounts</p>\n\n<p>Each number in column A need to split to two rows: Pay and Receive.<br>\nFor Pay will take the associate number from column C<br>\nFor receive will take associate number from column B</p>\n\n<p><img src=\"https://i.stack.imgur.com/EVNUU.jpg\" alt=\"Test excel\"></p>\n"}, {"tags": ["excel", "temporary-files", "file-not-found", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "edited": false, "score": 0, "creation_date": 1515100522, "post_id": 47991224, "comment_id": 83182807, "body": "hm ok but what does this mean - can it be that it closes the file too quickly?"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1514373480, "creation_date": 1514373480, "answer_id": 47991224, "question_id": 47991173, "link": "https://stackoverflow.com/questions/47991173/error-when-copying-worksheet-into-activeworkbook/47991224#47991224", "title": "error when copying worksheet into activeworkbook", "body": "<p><code>VBCDAE.tmp</code> is a temporary file which is locked. And apparently it's not a workbook.</p>\n"}], "owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514373480, "creation_date": 1514373235, "last_edit_date": 1531164843, "question_id": 47991173, "link": "https://stackoverflow.com/questions/47991173/error-when-copying-worksheet-into-activeworkbook", "title": "error when copying worksheet into activeworkbook", "body": "<p>I am facing some problems when copying some worksheets from another file into my active worksheet.</p>\n\n<p>The code I am currently using is as follows:</p>\n\n<pre><code>        With Workbooks.Open(ActiveWorkbook.path &amp; \"\\templates\\\" &amp; etype &amp; \".xlsx\").Worksheets(\"template\")\n            .Copy After:=Workbooks(ThisWorkbook.Name).Sheets(ThisWorkbook.Sheets.Count)\n            .Name = result\n            .Parent.Close savechanges:=False\n        End With\n</code></pre>\n\n<p>It works most of the times but every now and then - and all is done the same way - sometimes I click ten times on the same button and it works but at the eleventh time - it throws the following error:</p>\n\n<blockquote>\n  <p>File not found: '{AppData_DIR}\\Local\\VBCDAE.tmp'</p>\n</blockquote>\n\n<p>Can somebody help me with this?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "excel", "append"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514371262, "post_id": 47990706, "comment_id": 82949637, "body": "You need to place them one under another?"}, {"owner": {"reputation": 363, "user_id": 8010314, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10155350443964809/picture?type=large", "display_name": "Cagdas Kanar", "link": "https://stackoverflow.com/users/8010314/cagdas-kanar"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514371459, "post_id": 47990706, "comment_id": 82949735, "body": "Yes sir, exactly. The column names in all sheets are exactly same and I also don&#39;t want to repeat them when appending the files."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514371979, "post_id": 47990706, "comment_id": 82949965, "body": "Is this something that would need to be re-run regularly, or would this be one-time?"}, {"owner": {"reputation": 363, "user_id": 8010314, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10155350443964809/picture?type=large", "display_name": "Cagdas Kanar", "link": "https://stackoverflow.com/users/8010314/cagdas-kanar"}, "edited": false, "score": 0, "creation_date": 1514372374, "post_id": 47990706, "comment_id": 82950139, "body": "it&#39;s something that I encounter quite often sir. that&#39;s why I am trying to have an automated pipeline for this."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514372399, "post_id": 47990706, "comment_id": 82950153, "body": "Is there header in text file?"}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514372176, "post_id": 47990881, "comment_id": 82950052, "body": "...except it&#39;s supposed skip the header row on  all but one of the files (I think)"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514372366, "post_id": 47990881, "comment_id": 82950134, "body": "@ashleedawg Good point, but OP didn&#39;t mention whether there&#39;s a header :)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514372452, "post_id": 47990881, "comment_id": 82950179, "body": "uh huh  :-)  <code>The column names in all sheets are exactly same and I also don&#39;t want to repeat them when appending the files</code>"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514372715, "post_id": 47990881, "comment_id": 82950296, "body": "@ashleedawg Fixed!"}, {"owner": {"reputation": 363, "user_id": 8010314, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10155350443964809/picture?type=large", "display_name": "Cagdas Kanar", "link": "https://stackoverflow.com/users/8010314/cagdas-kanar"}, "edited": false, "score": 0, "creation_date": 1514373169, "post_id": 47990881, "comment_id": 82950510, "body": "You are amazing guys. I will be away from my laptop for a while but looking forward to test this solution when I\u2019m back. I will keep you posted on how it goes. Many thanks!"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 2, "last_activity_date": 1514396007, "last_edit_date": 1514396007, "creation_date": 1514371971, "answer_id": 47990881, "question_id": 47990706, "link": "https://stackoverflow.com/questions/47990706/combine-multiple-text-files-in-a-single-excel-sheet/47990881#47990881", "title": "combine multiple text files in a single excel sheet", "body": "<pre><code>Sub Combiner()\n\n    Dim strTextFilePath$, strFolder$\n    Dim wksTarget As Worksheet\n    Dim wksSource As Worksheet\n    Dim x As Long\n\n    Set wksTarget = Sheets.Add()\n    strFolder = \"c:\\Temp\\test\\\"\n    strTextFilePath = Dir(strFolder)\n\n    While Len(strTextFilePath) &gt; 0\n        '// \"x\" variable is just a counter.\n        '// It's purpose is to track whether the iteration is first or not.\n        '// If iteration is first (x=1), then we include header (zero offset down),\n        '// otherwise - we make an offset (1 row offset down).\n        x = x + 1\n        Set wksSource = Workbooks.Open(strFolder &amp; strTextFilePath).Sheets(1)\n        With wksTarget\n            wksSource.Range(\"A1\").CurrentRegion.Offset(IIf(x = 1, 0, 1)).Copy _\n                      .Cells(.Rows.Count, 1).End(xlUp).Offset(1)\n        End With\n        wksSource.Parent.Close False\n        strTextFilePath = Dir()\n    Wend\n\n    MsgBox \"Well done!\", vbInformation\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 8010314, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10155350443964809/picture?type=large", "display_name": "Cagdas Kanar", "link": "https://stackoverflow.com/users/8010314/cagdas-kanar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3705, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1514396007, "creation_date": 1514371185, "question_id": 47990706, "link": "https://stackoverflow.com/questions/47990706/combine-multiple-text-files-in-a-single-excel-sheet", "title": "combine multiple text files in a single excel sheet", "body": "<p>I have 27 txt files with the same format and columns, and I want to append all of these in a single excel sheet. I have checked some previous threads here, but I could only find the code below which helped me to import txt fiels into separate sheets. However, I also want to append these separate sheets into a sheet that I want to append all my data.</p>\n\n<pre><code>Sub Test()\n'UpdatebyExtendoffice6/7/2016\n    Dim xWb As Workbook\n    Dim xToBook As Workbook\n    Dim xStrPath As String\n    Dim xFileDialog As FileDialog\n    Dim xFile As String\n    Dim xFiles As New Collection\n    Dim I As Long\n    Set xFileDialog = Application.FileDialog(msoFileDialogFolderPicker)\n    xFileDialog.AllowMultiSelect = False\n    xFileDialog.Title = \"Select a folder [Vendor_data_25DEC]\"\n    If xFileDialog.Show = -1 Then\n        xStrPath = xFileDialog.SelectedItems(1)\n    End If\n    If xStrPath = \"\" Then Exit Sub\n    If Right(xStrPath, 1) &lt;&gt; \"\\\" Then xStrPath = xStrPath &amp; \"\\\"\n    xFile = Dir(xStrPath)\n    'xFile = Dir(xStrPath &amp; \"*.txt\") 'this is the original version that you can amend according to file extension\n    If xFile = \"\" Then\n        MsgBox \"No files found\", vbInformation, \"Vendor_data_25DEC\"\n        Exit Sub\n    End If\n    Do While xFile &lt;&gt; \"\"\n        xFiles.Add xFile, xFile\n        xFile = Dir()\n    Loop\n    Set xToBook = ThisWorkbook\n    If xFiles.Count &gt; 0 Then\n        For I = 1 To xFiles.Count\n            Set xWb = Workbooks.Open(xStrPath &amp; xFiles.Item(I))\n            xWb.Worksheets(1).Copy after:=xToBook.Sheets(xToBook.Sheets.Count)\n            On Error Resume Next\n            ActiveSheet.Name = xWb.Name\n            On Error GoTo 0\n            xWb.Close False\n        Next\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I am not sure how to do this with VBA in order to combine the data in separate sheets into a single sheet quickly. I know the consolidate feature of excel but it also includes lots of manual steps, so I seek for a faster and automated solution. Any help is much appreciated.\nThanks a lot in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514371848, "post_id": 47990618, "comment_id": 82949900, "body": "This is finding the last column so there will presumably be available columns after so what is the purpose of adding more columns? You want to duplicate the last column n times?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514372005, "post_id": 47990618, "comment_id": 82949976, "body": "Where is this function you mention? You could increase your SUM with a lastRow calculation e.g. &quot;B29:B&quot; &amp; lastRow"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514372073, "post_id": 47990618, "comment_id": 82950009, "body": "Thanks for replying! The function needs to add a number of columns specified by the user, starting from the last. I would need the complete reverse of the code I mentioned, where I can select the number of columns to add from another worksheet, starting from the last, and if I want to add more columns, it will continue adding from the last, never from a pre-specified column"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "edited": false, "score": 0, "creation_date": 1514374566, "post_id": 47990618, "comment_id": 82951168, "body": "Yes, I am copying the last column, but it can be any column."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "edited": false, "score": 0, "creation_date": 1514374678, "post_id": 47990618, "comment_id": 82951221, "body": "Edited and added what I have so far"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514376054, "post_id": 47990618, "comment_id": 82951786, "body": "Not sure what you are expecting if you simply want to copy the last column the number of times specified in Range E19 then   .Range(.Cells(1, LastCol + 1), .Cells(1, LastCol + DelCnt)).EntireColumn = .Cells(1, LastCol).EntireColumn.Value"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514376568, "post_id": 47990618, "comment_id": 82952050, "body": "@QHarr Thanks, that seems to do the job although only the values are being copied rather than the formulas, as well as the first row within the column is year and that stays fixed too. Would it be possible for the function to do the exact same role, but copy formulas rather than concrete values?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "edited": false, "score": 0, "creation_date": 1514377086, "post_id": 47990618, "comment_id": 82952280, "body": "That doesn&#39;t seem to work, the years dont change and the formula applies not from the previous column, but from the one before that. Is there anything else I could try?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514377751, "post_id": 47990618, "comment_id": 82952596, "body": "Done @QHarr  Hope that helps (That is after I ran the Macro, which extends years by 2)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514378474, "post_id": 47990618, "comment_id": 82952926, "body": "Is Year 1 etc text? Or is it numeric e.g. 2017 And the formula is supposed to be in which row looking at which row?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "edited": false, "score": 0, "creation_date": 1514378925, "post_id": 47990618, "comment_id": 82953101, "body": "Its text, but when I autofill it goes 2,3,4 etc"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "edited": false, "score": 0, "creation_date": 1514379675, "post_id": 47992529, "comment_id": 82953425, "body": "Thanks! I added a picture on the end, and it seems to drag the formula not from the previous cell, but from the one before the previous, hence the figures wont carry on correctly, I assume"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514379750, "post_id": 47992529, "comment_id": 82953464, "body": "Code above takes from prior column"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "edited": false, "score": 0, "creation_date": 1514402768, "post_id": 47992529, "comment_id": 82963368, "body": "Thanks, however, the formula for profit, is completely re-arranged, ive attached the image to see"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514403498, "post_id": 47992529, "comment_id": 82963654, "body": "so K3 should be J3*1.05 , L3 should be K3*1.05 etc? Is it just that row that is a problem?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "edited": false, "score": 0, "creation_date": 1514403864, "post_id": 47992529, "comment_id": 82963808, "body": "Every column, profit is not worked out for the current year. The columns should be autofilled, rather than anything else, based from the last column, N number of times, I think that would get the solution. @QHarr"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514404196, "post_id": 47992529, "comment_id": 82963930, "body": "Profit formula: F2-F3 is supposed to be G2-G3?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514404740, "post_id": 47992529, "comment_id": 82964153, "body": "Making sure cell A1 has text in it such as &quot;Header&quot; , then with my code and using your first 3 years i get year 4 , sales 133, Costs 35.28 and profits 97.72 this is correct for using autofill. I think we are missing something else here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "edited": false, "score": 0, "creation_date": 1514453247, "post_id": 47992529, "comment_id": 82977825, "body": "Does anyone else have a solution, which performs the reverse of the formula I mentioned?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514453925, "post_id": 47992529, "comment_id": 82978138, "body": "What are your expected values for year 4?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1514379100, "creation_date": 1514379100, "answer_id": 47992529, "question_id": 47990618, "link": "https://stackoverflow.com/questions/47990618/how-to-copy-column-from-last-column-n-number-of-times/47992529#47992529", "title": "How to copy column from last column N number of times?", "body": "<p>Try the following. Assumes you can use column A to find the last used row:</p>\n\n<pre><code>Sub YearsNumberReduction()\n\n    Dim LastCol As Long\n    Dim DelCnt As Integer\n    DelCnt = Sheets(\"Panel\").Range(\"E19\").Value\n    Dim copyCol As Range\n    Dim DestRange As Range\n    Dim lastRow As Long\n\n    With ThisWorkbook.Sheets(\"Current\")\n\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        Set copyCol = .Range(.Cells(1, LastCol), .Cells(lastRow, LastCol))\n\n        Set DestRange = .Range(.Cells(1, LastCol), .Cells(lastRow, LastCol + DelCnt))\n\n        copyCol.AutoFill Destination:= DestRange, Type:=xlFillDefault\n\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9114427"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 47992529, "answer_count": 1, "score": 0, "last_activity_date": 1514402788, "creation_date": 1514370889, "last_edit_date": 1514402788, "question_id": 47990618, "link": "https://stackoverflow.com/questions/47990618/how-to-copy-column-from-last-column-n-number-of-times", "title": "How to copy column from last column N number of times?", "body": "<p>I currently have the following code, which was made by a lovely member here</p>\n\n<pre><code>Sub YearsNumberReduction()\nDim LastCol As Long\nDim DelCnt As Integer\nDelCnt = Sheets(\"Panel\").Range(\"E19\").Value\nWith ThisWorkbook.Sheets(\"Current\")\n    LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    If LastCol &gt;= DelCnt Then\n        .Range(.Cells(1, LastCol - DelCnt + 1), .Cells(1, LastCol)).EntireColumn.Delete\n    End If\nEnd With\n</code></pre>\n\n<p>This code takes the last column, and deletes the column by the number of times specified in E19. How can I change the code, so instead of deleting a specified number of times from the last row, we can add columns instead? Essentially reversing the role of that VBA Macro. </p>\n\n<p>I also have another question. In my Excel solution, I constantly add the number of years and decrease them (those years are business years and each year carries a profit, calculated by revenue-costs). On the main worksheet, I have 10 years. That is the default number of years. However, this does not change when I add or decrease years based on the function I mentioned. The profit for the 10 years is calculated by =SUM(B29:B39). How can I make the range change (e.g if I add one more year, Year 11 will be added and =SUM(B29:40) in the main spreadsheet which gives a profit overview?</p>\n\n<p>Current adding of columns</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"L1:L15\").AutoFill Destination:=Worksheets(\"Sheet1\").Range(\"L1\").Resize(15, Worksheets(\"Panel\").Range(\"E17\") + 1), Type:=xlFillDefault\n</code></pre>\n\n<p>However, this adds from a fixed column, rather than the last. So I extend columns by 5, it will add 5, but if I extend it by 5 again, it wont extend since it has a fixed point. So I need it to change based on the last column.</p>\n\n<p>EDIT</p>\n\n<pre><code>Year 1  Year 2  Year 3  Year 3  Year 3\nSales   100 115 132 132 152\nCosts   30  32  33  33  35\nProfit  70  84  99  99  99\n</code></pre>\n\n<p>Year 3 stays the same, and costs do not update (=C3*1.05) it should rise by 5%</p>\n\n<p><a href=\"https://i.stack.imgur.com/DKtfw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DKtfw.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/GoSVX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GoSVX.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/r4WDJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r4WDJ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 0, "last_activity_date": 1514424739, "last_edit_date": 1514424739, "creation_date": 1514424155, "answer_id": 48000513, "question_id": 47990503, "link": "https://stackoverflow.com/questions/47990503/adding-footer-with-a-file-name-before-printing-and-without-deleting-existing-fo/48000513#48000513", "title": "Adding footer with a file name, before printing and without deleting existing footer/s", "body": "<p>The code you have doesn't need further code for implementation. Simply place a reference field in the footer in whatever place you want the file name to appear. From the Insert tab select Quick Parts > Fields and insert a DocVariable field. Name the field \"Fname\" (or any other name matching the name in the code). Then run the code below while the document where you want the file name is active.</p>\n\n<pre><code>Sub SetDocVariable()\n    ' 28 Dec 2017\n\n    Dim Sp() As String\n    Dim Test As String\n    Dim VarName As String\n    Dim VarValue As String\n\n    VarName = \"Fname\"\n    With ActiveDocument\n        Sp = Split(.Name, \".\")\n        ReDim Preserve Sp(UBound(Sp) - 1)\n        VarValue = Join(Sp, \".\")\n'        VarValue = \"\"                  ' Use this line to show nothing\n        On Error Resume Next\n        Test = .Variables(VarName).Value\n        If Err Then\n            .Variables.Add VarName\n            Err.Clear\n        End If\n        If .Variables(VarName).Value &lt;&gt; VarValue Then .Variables(VarName).Value = VarValue\n    End With\nEnd Sub\n</code></pre>\n\n<p>This code will write the file name to the document variable, adding the variable to the document if it didn't exist. The field you inserted will show nothing while the variable is blank. It will show an error if the variable doesn't exist. Set the document variable to \"\" to have no error and no file name.</p>\n\n<p>A perhaps even better way would be to use one of the built-in document properties (or a custom document property if none of the built-in ones can be diverted for the purpose) in place of the document variable, together with the appropriate reference field (Quick Parts > Document Properties). You would have to type the file name into the property dialog but wouldn't need any code at all.</p>\n\n<p>BTW, the 'FileName' reference field (Quick Parts > Fields > FileName) displays the file name in the format you want but it can't be made to be blank.</p>\n"}], "owner": {"reputation": 63, "user_id": 9144708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617372902420f24fb59d5a455e8a09de?s=128&d=identicon&r=PG&f=1", "display_name": "mpa", "link": "https://stackoverflow.com/users/9144708/mpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 48000513, "answer_count": 1, "score": 1, "last_activity_date": 1593731602, "creation_date": 1514370481, "last_edit_date": 1593731602, "question_id": 47990503, "link": "https://stackoverflow.com/questions/47990503/adding-footer-with-a-file-name-before-printing-and-without-deleting-existing-fo", "title": "Adding footer with a file name, before printing and without deleting existing footer/s", "body": "<p>I need to create a macro in Word 2010, that will add a footer with the file name, without the extension.</p>\n\n<p>I found a code that displays the file name without the extension when you use a docvariable field:</p>\n\n<pre><code>Sub autofilenamefooter()\n\nDim fname As String\nfname = ActiveDocument.Name\nfname = Left(fname, InStr(fname, \".\") - 1)\n\nWith ActiveDocument\n\n   .Variables(\"fname\").Value = fname\n\n   .PrintPreview\n   .ClosePrintPreview\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>How can I use this to create a macro that:</p>\n\n<ol>\n<li><p>Foots the document with the file name before printing (so that the field will be updated each time you print the document).</p></li>\n<li><p>In addition, the new footer (with the file name) will not delete existing footers, if any. This requirement is due to the fact that the macro should be applied to all documents in our document management system, and some of the documents already have footers (such as firm papers with logos) that I would like to keep. </p></li>\n</ol>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514579174, "post_id": 47990199, "comment_id": 83026025, "body": "What i am not sure about is if this is a merge or an append of sorts? You have different columns so not sure how UNION ALL would work without adding in the same column names to each table. I think if  this were an append operation and there were matching headers and numbers of rows you could have a helper column which identifies which table the original row came from then apply conditional formatting to the merged table with an IF statement that applies the orginal source formatting depending on the helper column value?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514579523, "post_id": 47990199, "comment_id": 83026169, "body": "And were it a merge, i guess you might look at using the header to identify which table the column came from, and use that to apply the right formatting.What i would then be unsure of is how to do this without VBA. Also, the JOIN type would need to be determined. Unsure, if one can override conditional formatting of powerquery table merges."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 5, "creation_date": 1514584415, "post_id": 47990199, "comment_id": 83027756, "body": "Your question is too broad.  You need to clarify the relationship between the  tables and more importantly some code demonstrating the effort that you have put in to solve the problem yourself.  You should worry about the data first then take care of the formatting."}, {"owner": {"reputation": 395, "user_id": 4967730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2de2164be5e2a579e3245e856694659?s=128&d=identicon&r=PG&f=1", "display_name": "Ames", "link": "https://stackoverflow.com/users/4967730/ames"}, "edited": false, "score": 0, "creation_date": 1514608558, "post_id": 47990199, "comment_id": 83032196, "body": "why don&#39;t you record a macro to add &quot;Destination&quot; column into Worksheet1 after Total, then add &quot;Price&quot; column into Worksheet2 after Amount. Then continue the macro with copy and paste with source formating from Worksheet1 and Worksheet2 to NEW Worksheet3. And also record a macro to clear all data in Worksheet3 each time before running the first macro. And also another macro to remove &quot;Destination&quot; and &quot;Price&quot; column from Worksheet1 and 2 after first macro at the end (after Worksheet 3 is populated)."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 0, "creation_date": 1514627930, "post_id": 47990199, "comment_id": 83035797, "body": "On one hand, it would be good if you tried something so others can follow up. On the other hand, the merging operation seems to be ill-defined. You should specify what is the result you want to get for the various possible combinations of coinciding/not coinciding values in rows/columns."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514644454, "post_id": 47990199, "comment_id": 83039699, "body": "the two tables in your images at the top don&#39;t have the same columns - Union All (in TSQL at least, so i assume for VBA SQL operations) requires the same number of columns (also you want them to match up) so how is your query working? If there are matching columns output them with a helper field that indicates source table, apply conditional formatting to the recordset output using this helper column? As per my first comment, this is not a merge but an append."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1514780962, "post_id": 47990199, "comment_id": 83065839, "body": "Doesn&#39;t <a href=\"https://stackoverflow.com/questions/9923385/combine-2-excel-tables-into-one-appending-the-data\">this</a> do 90% of your tasks with an obvious place to code the remainder?"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1514929810, "post_id": 47990199, "comment_id": 83110208, "body": "I was going to say make a temp table with empty columns inserted on a temp worksheet sheet to ensure proper col alignment prior to merge.  Destroy temps post merge.  This can be done without tables and all in VBA/worksheet but you lose some of the header functionality that comes easily with tables."}], "answers": [{"tags": [], "owner": {"reputation": 194, "user_id": 5931459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/cd151b959b42e221807cc68f16aa9141?s=128&d=identicon&r=PG&f=1", "display_name": "Nicho247", "link": "https://stackoverflow.com/users/5931459/nicho247"}, "is_accepted": false, "score": 1, "last_activity_date": 1514799018, "creation_date": 1514799018, "answer_id": 48048530, "question_id": 47990199, "link": "https://stackoverflow.com/questions/47990199/concat-tables-in-different-excel-worksheet/48048530#48048530", "title": "Concat tables in different excel worksheet", "body": "<p>you have a few problems...union can work. Assuming union path from your first edit.</p>\n\n<p>Add placeholder columns on both sheets to allow proper union, OR force placeholders columns in with your t-sql queries.</p>\n\n<p>Add columns to each sheet representing the source OR add these in with your t-sql queries. e.g. 'Sheet1'</p>\n\n<p>On your unioned sheet with the results, add conditional formatting, where the row with the cell of the source type is evaluated, then the entire row is formatted as necessary. e.g. cell A2 has 'Sheet1', then row A is colored green.</p>\n"}, {"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 1, "last_activity_date": 1514921231, "creation_date": 1514921231, "answer_id": 48066686, "question_id": 47990199, "link": "https://stackoverflow.com/questions/47990199/concat-tables-in-different-excel-worksheet/48066686#48066686", "title": "Concat tables in different excel worksheet", "body": "<p>If i understand you well, you want to:</p>\n\n<ol>\n<li>copy data preserving formatting from existing sheets and put them into another sheet (new or existing; let's call it \"merged data\"),</li>\n<li>keep one-way synchronization betweem source sheets and \"merged sheet\", which means when source sheet is changing, a \"merged sheet\" changes too.</li>\n</ol>\n\n<p>The answer for both issues is YES depending on a way you choose to merge/synchronize/display data...</p>\n\n<p><strong>Method #1</strong> - using copy &amp; paste data one below another</p>\n\n<p>This method will preserve formatting, but there's no chance to update destination table (sheet) when source data have been changed. You'll need to create it every time you want to see merged data. </p>\n\n<p><strong>Method #2</strong> - using <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-copyfromrecordset-method-excel\" rel=\"nofollow noreferrer\">Range.CopyFromRecordset method </a> together with <code>UNION</code> statement</p>\n\n<p>If you want to use this method, you have to change your data set into model of <a href=\"https://en.wikipedia.org/wiki/Relational_database\" rel=\"nofollow noreferrer\">relational database</a>. There's no chance for preserving source formatting, but \"merged sheet\" may be quickly reloaded (a'ka updated).</p>\n\n<p>Both methods of copying data between sheets you'll find here: <a href=\"https://www.codeproject.com/Tips/1187802/Copy-Data-Between-Excel-Sheets-using-VBA\" rel=\"nofollow noreferrer\">Copy Data Between Excel Sheets using VBA</a>, but this tip does not provide information about copying data within its originall format. So, i decided to clarify how to achieve that and show/provide code which create destination sheet with merged data.</p>\n\n<p>In my example i have 3 sheets. First and second sheet is used as source of data and the 3. one is used to display merged data. Only 3 columns (A-C) contain data, so ranges to copy are hard-coded.</p>\n\n<pre><code>Option Explicit\n\n'method #1\nPrivate Sub CopyWithFormatting(srcSh As Worksheet, dstSh As Worksheet, Optional sCol As String = \"A\")\nDim e1 As Long, e2 As Long\n\nOn Error GoTo Err_CopyWithFormatting\n'last row in src and dst sheet\ne1 = srcSh.Range(sCol &amp; srcSh.Rows.Count - 1).End(xlUp).Row\ne2 = dstSh.Range(sCol &amp; dstSh.Rows.Count - 1).End(xlUp).Row + 1\n'do not refresh screen\nApplication.ScreenUpdating = False\n\n'copy defined range\nsrcSh.Range(\"A2:C\" &amp; e1).Copy\n'paste below existing data\nWith dstSh.Range(\"A\" &amp; e2)\n    .PasteSpecial xlPasteAllUsingSourceTheme\n    .PasteSpecial xlPasteFormats\n    .PasteSpecial xlPasteValidation\nEnd With\n\nExit_CopyWithFormatting:\n    On Error Resume Next\n    'restore default settings\n    With Application\n        .CutCopyMode = False\n        .ScreenUpdating = True\n    End With\n    Exit Sub\n\nErr_CopyWithFormatting:\n    MsgBox Err.Description, vbExclamation, \"Err no. \" &amp; Err.Number\n    Resume Exit_CopyWithFormatting\n\nEnd Sub\n</code></pre>\n\n<p>How to use it?</p>\n\n<pre><code>Sub TestMethod1()\nDim CopiedSheet As Worksheet, DestSheet As Worksheet\n\n'as i mentioned -&gt; 3. sheet is used to merge data \n'you can change it by using sheet's name or its index\nSet DestSheet = ThisWorkbook.Worksheets(3)\n\n'copy data from sheets into destination sheet\nFor Each CopiedSheet In ThisWorkbook.Worksheets\n    'ignore destination sheet\n    If CopiedSheet Is DestSheet Then GoTo SkipNext\n    CopyWithFormatting CopiedSheet, DestSheet\nSkipNext:\nNext\n\nEnd Sub\n</code></pre>\n\n<p><strong>Finall note:</strong>  Feel free to change above code to your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 1901, "user_id": 7182460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9dc8963c161d5689dc85c6771cf4b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Neil B", "link": "https://stackoverflow.com/users/7182460/neil-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1515170371, "last_edit_date": 1515170371, "creation_date": 1515165608, "answer_id": 48116459, "question_id": 47990199, "link": "https://stackoverflow.com/questions/47990199/concat-tables-in-different-excel-worksheet/48116459#48116459", "title": "Concat tables in different excel worksheet", "body": "<p>In the third sheet I would have a macro in the Activate event, that pulls the data from from the first two sheets. I would add a hidden column in the third sheet that contains to originating sheet. In your conditional formatting for the third sheet you would need to base your formatting on the value in the hidden column. I can post a sample to clarify if you wish. </p>\n\n<p>EDIT: Added sample</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Dim Sheet1 As Worksheet\n    Dim Sheet2 As Worksheet\n    Dim Sheet3 As Worksheet\n    Set Sheet1 = Worksheets(1)\n    Set Sheet2 = Worksheets(2)\n    Set Sheet3 = Worksheets(3)\n    Sheet1.Range(\"A2:D101\").Copy\n    Sheet3.Cells(2, 1).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Sheet2.Range(\"A2:D101\").Copy\n    Sheet3.Cells(102, 1).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Sheet3.Cells(1, 1).Select\n    ActiveWorkbook.Worksheets(\"Sheet3\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet3\").AutoFilter.Sort.SortFields.Add Key:=Range _\n        (\"A1:A201\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet3\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Here is an example file.\n<a href=\"https://www.dropbox.com/s/55o4yz1wbvi1lu5/ConcatSheets%20Example.xlsm?raw=1\" rel=\"nofollow noreferrer\">ConcatSheets Example.xlsm</a></p>\n"}], "owner": {"reputation": 249, "user_id": 4541755, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/5c3c7acab813c92d720acafa992ca0e5?s=128&d=identicon&r=PG&f=1", "display_name": "Armelias", "link": "https://stackoverflow.com/users/4541755/armelias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1515170371, "creation_date": 1514369378, "last_edit_date": 1515051282, "question_id": 47990199, "link": "https://stackoverflow.com/questions/47990199/concat-tables-in-different-excel-worksheet", "title": "Concat tables in different excel worksheet", "body": "<h1>Question</h1>\n\n<p>I'm trying to do something that may be very simple using Excel but I can't find how to do it.</p>\n\n<p>I have several worksheets, each one contains a single table. To give you an example, here are two of my worksheets :</p>\n\n<p><a href=\"https://i.stack.imgur.com/wZzEW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wZzEW.jpg\" alt=\"enter image description here\"></a>\n<em>First worksheet. Please note that lines are green.</em>\n<em>Some data. Without 's', sorry :-)</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/Cq2O9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cq2O9.jpg\" alt=\"enter image description here\"></a>\n<em>Second one. Lines are grey but cells can be red. Headers are NOT the same</em></p>\n\n<p>I would like to :</p>\n\n<ul>\n<li>merge those tables into another worksheet</li>\n<li>keep style formatting (line color, etc)</li>\n<li>when I update a table, the merged one should update too (may be a macro)</li>\n</ul>\n\n<p>Here is a possible output :</p>\n\n<p><a href=\"https://i.stack.imgur.com/QeiKI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QeiKI.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Note that same headers are correctly merged.</strong></p>\n\n<p>Can I do this with Excel ? I know that I can do a query (UNION ALL) but doing this doesn't preserve style formatting.</p>\n\n<h1>Edit 1</h1>\n\n<p>I've tried to build the table using microsoft queries. Here is my query : </p>\n\n<pre><code>SELECT * FROM `C:\\Users\\cflodrops\\Downloads\\comptes.xlsx`.`Purchases$` `Purchases$`  \nUNION ALL  \nSELECT * FROM `C:\\Users\\cflodrops\\Downloads\\comptes.xlsx`.`Sales$` `Sales$`\nUNION ALL  \nSELECT * FROM `C:\\Users\\cflodrops\\Downloads\\comptes.xlsx`.`Trades$` `Trades$`\nUNION ALL  \nSELECT * FROM `C:\\Users\\cflodrops\\Downloads\\comptes.xlsx`.`Transfers$` `Transfers$`\n</code></pre>\n\n<p>This request works great, here is the result :</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZApHO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZApHO.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>But I still have issues :</p>\n\n<ul>\n<li>style formatting is incorrect (background colors and numbers format)</li>\n<li>datas are not synchronized between arrays. It's not an issue, I can create a macro to execute the request whenever I click on a button.</li>\n</ul>\n"}, {"tags": ["vba", "security"], "comments": [{"owner": {"reputation": 1045, "user_id": 4548985, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/546tA.png?s=128&g=1", "display_name": "Lich4r", "link": "https://stackoverflow.com/users/4548985/lich4r"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514370028, "post_id": 47990187, "comment_id": 82948978, "body": "I&#39;ve seen a lot about cracking password not about storing it. I&#39;m asking for a way of achieving this, that does not looks like an opinion based to me. I know they could crack it but I do not want them to find the actual password that I must keep &quot;human readable&quot; for my coworkers to use it... :/"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 4, "creation_date": 1514373481, "post_id": 47990187, "comment_id": 82950661, "body": "Storing the password within the file itself is kind of like leaving a house key under a door mat.  (Might as well not have a password!)  Here&#39;s some good info about obfuscation and <a href=\"https://security.stackexchange.com/questions/108746/how-to-store-passwords-written-on-a-physical-notebook\">password storage</a>,"}, {"owner": {"reputation": 1045, "user_id": 4548985, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/546tA.png?s=128&g=1", "display_name": "Lich4r", "link": "https://stackoverflow.com/users/4548985/lich4r"}, "edited": false, "score": 0, "creation_date": 1514373820, "post_id": 47990187, "comment_id": 82950833, "body": "Good reading although this does not help. I could store those wb passwords in a pswd manager like I do for my personal use that does not fix the problem that anyone who &quot;crack&quot; the VBA project will be able to read it. I&#39;d like to protect sheets with a hash of the actual password but I do not know how to compute that hash without the password appearing in clear text in the code."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1514376388, "post_id": 47990187, "comment_id": 82951960, "body": "It looks like <code>ActiveSheet.Protect</code> takes a plain text password as its argument so the only way around saving this password in the code with the excel sheet is to try protecting them from VBA code in a <i>different</i> Excel / VBA file. But basically, Excel is not secure. If you need this application to be secure then you need to build it on a more secure platform."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 1, "creation_date": 1514378658, "post_id": 47990187, "comment_id": 82952988, "body": "Removing the VBA password is very simple: <a href=\"https://stackoverflow.com/questions/1026483/is-there-a-way-to-crack-the-password-on-an-excel-vba-project\" title=\"is there a way to crack the password on an excel vba project\">stackoverflow.com/questions/1026483/&hellip;</a> So, simple answer is: No, there is no secure way to protect a VBA project."}, {"owner": {"reputation": 1045, "user_id": 4548985, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/546tA.png?s=128&g=1", "display_name": "Lich4r", "link": "https://stackoverflow.com/users/4548985/lich4r"}, "edited": false, "score": 0, "creation_date": 1514390192, "post_id": 47990187, "comment_id": 82958140, "body": "I do not want to secure the VBA project. I want that anyone who crack it is not able to know which password was used. This way I know that if sth has been modified, this means the project has been cracked and not that the password has been given."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9799201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KQLxil4dqP0/AAAAAAAAAAI/AAAAAAAAiTQ/NlEVlEETJBw/photo.jpg?sz=128", "display_name": "Jeroen", "link": "https://stackoverflow.com/users/9799201/jeroen"}, "is_accepted": false, "score": 1, "last_activity_date": 1526464510, "last_edit_date": 1526464510, "creation_date": 1526463426, "answer_id": 50367299, "question_id": 47990187, "link": "https://stackoverflow.com/questions/47990187/securely-store-password-in-a-vba-project/50367299#50367299", "title": "Securely store password in a VBA project", "body": "<p>This should do the trick. The password is <code>smp2smp2</code>, which you will get when running <code>GetPassword</code>, but that actual value is not stored in the project. It is stored using the code <code>30555112012321187051111661144119</code>, which will be converted to the actual password (human readable) by using <code>CreatePasswordFromCode</code>. By the way, I have no idea how to easily get the code that belongs to a certain password. And in this way, it is always 8 characters long, no room for changes unless you adjust the code. I have found this somewhere in an old project of somebody else, no source mentioned unfortunately.</p>\n\n<pre><code>Option Explicit\n\nFunction GetPassword() As String\n\n    'the password is stored as codes, so the real password is not stored in this project\n    GetPassword = CreatePasswordFromCode(\"30555112012321187051111661144119\")\n\nEnd Function\n\nFunction CreatePasswordFromCode(ByVal pstrPasswordCode As String) As String\nDim intChar As Integer\nDim intCode As Integer\nDim arrintShifts(0 To 7) As Integer\nDim arrlngCharCode(0 To 7) As Long\nDim strMessage As String\n\n    intChar = 0\n    intCode = 0\n\n    For intCode = 0 To 7\n        'store -8 to -1 into 0-7\n        arrintShifts(intCode) = intCode - 8\n    Next intCode\n\n    'the code is stored by using the number of the letter of the password in the 4th character.\n    'the real code of the character is directly behind that.\n    'so the code 30555112012321187051111661144119\n    'has on position 3, 055, 5, 112, 0, 123, 2, 118, 7, 051, 1, 116, 6, 114 and 4, 119\n    'so sorted this is 0, 123, 1, 116, 2, 118, 3, 055, 4, 119, 5, 112, 6, 114, 7, 051\n    'then there is also the part where those charcode are shifted by adding -8 to -1 to them.\n    'leading to the real charactercodes:\n    '0, 123-8, 1, 116-7, 2, 118-6, 3, 055-5, 4, 119-4, 5, 112-3, 6, 114-2, 7, 051-1\n    '0, 115, 1, 109, 2, 112, 3, 050, 4, 115, 5, 109, 6, 112, 7, 050\n    For intChar = 0 To 7\n        If Mid(pstrPasswordCode, 1, 1) = intChar Then\n            arrlngCharCode(intChar) = (Mid(pstrPasswordCode, 2, 3) + arrintShifts(intChar))\n        ElseIf Mid(pstrPasswordCode, 5, 1) = intChar Then\n            arrlngCharCode(intChar) = (Mid(pstrPasswordCode, 6, 3) + arrintShifts(intChar))\n        ElseIf Mid(pstrPasswordCode, 9, 1) = intChar Then\n            arrlngCharCode(intChar) = (Mid(pstrPasswordCode, 10, 3) + arrintShifts(intChar))\n        ElseIf Mid(pstrPasswordCode, 13, 1) = intChar Then\n            arrlngCharCode(intChar) = (Mid(pstrPasswordCode, 14, 3) + arrintShifts(intChar))\n        ElseIf Mid(pstrPasswordCode, 17, 1) = intChar Then\n            arrlngCharCode(intChar) = (Mid(pstrPasswordCode, 18, 3) + arrintShifts(intChar))\n        ElseIf Mid(pstrPasswordCode, 21, 1) = intChar Then\n            arrlngCharCode(intChar) = (Mid(pstrPasswordCode, 22, 3) + arrintShifts(intChar))\n        ElseIf Mid(pstrPasswordCode, 25, 1) = intChar Then\n            arrlngCharCode(intChar) = (Mid(pstrPasswordCode, 26, 3) + arrintShifts(intChar))\n        ElseIf Mid(pstrPasswordCode, 29, 1) = intChar Then\n            arrlngCharCode(intChar) = (Mid(pstrPasswordCode, 30, 3) + arrintShifts(intChar))\n        End If\n    Next intChar\n\n    'by getting the charcodes of these values, you create the password\n    CreatePasswordFromCode = Chr(arrlngCharCode(0)) &amp; Chr(arrlngCharCode(1)) &amp; Chr(arrlngCharCode(2)) &amp; Chr(arrlngCharCode(3)) &amp; Chr(arrlngCharCode(4)) &amp; Chr(arrlngCharCode(5)) &amp; Chr(arrlngCharCode(6)) &amp; Chr(arrlngCharCode(7))\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9925651, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/b60f2d5edd0385109010cc5ae5769a68?s=128&d=identicon&r=PG", "display_name": "Arne G.", "link": "https://stackoverflow.com/users/9925651/arne-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1528726944, "creation_date": 1528726944, "answer_id": 50799987, "question_id": 47990187, "link": "https://stackoverflow.com/questions/47990187/securely-store-password-in-a-vba-project/50799987#50799987", "title": "Securely store password in a VBA project", "body": "<p>Modified the code for use with up to 99 characters. Added Password generator.</p>\n\n<p>But still: this all is just an obfuscation of the real password.</p>\n\n<pre><code>Function CreatePasswordFromCode(ByVal pstrPasswordCode As String) As String\n' Original Code https://stackoverflow.com/questions/47990187/securely-store-password-in-a-vba-project?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\n' Modified to extend password length\n' Modifications free to use\nDim codeLen As Integer\n\nDim intChar As Integer\nDim intCode As Integer\nDim arrintShifts() As Integer\nDim arrlngCharCode() As Long\nDim icp As Integer\n\n    ' Initialise Arrays\n    icp = IIf(Right(pstrPasswordCode, 1) Mod 2 = 0, 5, 4)\n    pstrPasswordCode = Left(pstrPasswordCode, Len(pstrPasswordCode) - IIf(Right(pstrPasswordCode, 1) Mod 2 = 0, 1, 1))\n    codeLen = Len(pstrPasswordCode) / icp - 1 ' Array Index starts with 0\n    ReDim arrintShifts(codeLen)\n    ReDim arrlngCharCode(codeLen)\n\n    intChar = 0\n    intCode = 0\n\n    For intCode = 0 To codeLen\n        'store -8 to -1 into 0-7\n        arrintShifts(intCode) = intCode - (codeLen + 1)\n    Next intCode\n\n    'the code is stored by using the number of the letter of the password in the 4th character.\n    'the real code of the character is directly behind that.\n    'so the code 30555112012321187051111661144119\n    'has on position 3, 055, 5, 112, 0, 123, 2, 118, 7, 051, 1, 116, 6, 114 and 4, 119\n    'so sorted this is 0, 123, 1, 116, 2, 118, 3, 055, 4, 119, 5, 112, 6, 114, 7, 051\n    'then there is also the part where those charcode are shifted by adding -8 to -1 to them.\n    'leading to the real charactercodes:\n    '0, 123-8, 1, 116-7, 2, 118-6, 3, 055-5, 4, 119-4, 5, 112-3, 6, 114-2, 7, 051-1\n    '0, 115, 1, 109, 2, 112, 3, 050, 4, 115, 5, 109, 6, 112, 7, 050\n\n    For intChar = 0 To codeLen\n        For intCode = 0 To codeLen\n            If CInt(Mid(pstrPasswordCode, intCode * icp + 1, icp - 3)) = intChar Then\n                arrlngCharCode(intChar) = (Mid(pstrPasswordCode, (intCode + 1) * icp - 2, 3) + arrintShifts(intChar))\n                Exit For\n            End If\n        Next intCode\n    Next intChar\n\n    'by getting the charcodes of these values, you create the password\n    CreatePasswordFromCode = \"\"\n    For intChar = 0 To codeLen\n        CreatePasswordFromCode = CreatePasswordFromCode &amp; Chr(arrlngCharCode(intChar))\n    Next intChar\n\nEnd Function\n\nFunction CreateCodeFromPassword(ByVal pstrPasswordCode As String) As String\n' Generator free to use\nDim pwLen As Integer\nDim scp As String   ' String Code Position, for formatting \"0\" or \"00\"\nDim icp As Integer  ' marker if pwLen &lt; 10 or &gt; 10\nDim intCode As Integer\nDim arrintShifts() As Integer\nDim arrlngCharCode() As Long\nDim pw() As String\n\nDim Temp As Variant\nDim arnd() As Variant\nDim irnd As Variant\n\n    Randomize\n\n    ' Initialise Arrays\n    pwLen = Len(pstrPasswordCode) - 1 ' Array Index starts with 0\n    scp = IIf(pwLen &lt; 10, \"0\", \"00\")\n    ' Create odd/even marker if we have 1 (odd) or 2 (even) byte index digits (scp), values between 0 and 9\n    icp = IIf(pwLen &lt; 10, Int(Rnd() * 5 + 1) * 2 - 1, Int(Rnd() * 5 + 1) * 2)\n\n    ReDim arrintShifts(pwLen)\n    ReDim arrlngCharCode(pwLen)\n    ReDim pw(pwLen)\n    ReDim arnd(pwLen)\n\n    For intCode = 0 To pwLen\n        arnd(intCode) = intCode\n    Next intCode\n\n    ' randomize the indizes to bring the code into a random order\n    For intCode = LBound(arnd) To UBound(arnd)\n        irnd = CLng(((UBound(arnd) - intCode) * Rnd) + intCode)\n        If intCode &lt;&gt; irnd Then\n            Temp = arnd(intCode)\n            arnd(intCode) = arnd(irnd)\n            arnd(irnd) = Temp\n        End If\n    Next intCode\n\n    'by getting the charcodes of these values, you create the password\n    For intCode = 0 To pwLen\n        'get characters\n        pw(intCode) = Mid(pstrPasswordCode, intCode + 1, 1)\n        'and store -8 to -1 into 0-7 (for additional obfuscation)\n        arrintShifts(intCode) = intCode - (pwLen + 1)\n    Next intCode\n\n    ' Search for the random index and throw the shifted code at this position\n    For intCode = 0 To pwLen\n        arrlngCharCode(Application.Match(intCode, arnd, False) - 1) = AscB(pw(intCode)) - arrintShifts(intCode)\n    Next intCode\n\n    ' Chain All Codes, combination of arnd(intcode) and arrlngCharCode(intcode) gives the random order\n    CreateCodeFromPassword = \"\"\n    For intCode = 0 To pwLen\n        CreateCodeFromPassword = CreateCodeFromPassword &amp; Format(arnd(intCode), scp) &amp; Format(arrlngCharCode(intCode), \"000\")\n    Next intCode\n    CreateCodeFromPassword = CreateCodeFromPassword &amp; icp\n\nEnd Function\n</code></pre>\n\n<p>Obfuscated version</p>\n\n<pre><code>'VBA code protection using: www.excel-pratique.com/en/vba_tricks/vba-obfuscator.php\nFunction CreatePasswordFromCode(ByVal z4891679d877f1da36647b21d6197fbfd As String) As String\nDim b2da54ddb60c93bf346493d7e08bc6d08 As Integer\nDim bf56f94eb6ed9a658e82e88591237324d As Integer\nDim bec732ae8e18b7b2ff2e9ccd058f3e8fc As Integer\nDim m06993036154505accc9ce092bdb57b17() As Integer\nDim b8026f9f8f7fe86372be0799d8c9c6691() As Long\nDim q24471047c7a6e466b78de3c6ae66f20f As String\nDim t5f443e88a552a3f943275f985dde03ca As Integer\nt5f443e88a552a3f943275f985dde03ca = IIf(Right(z4891679d877f1da36647b21d6197fbfd, 1) Mod 2 = 0, 5, 4)\nz4891679d877f1da36647b21d6197fbfd = Left(z4891679d877f1da36647b21d6197fbfd, Len(z4891679d877f1da36647b21d6197fbfd) - IIf(Right(z4891679d877f1da36647b21d6197fbfd, 1) Mod 2 = 0, 1, 1))\nb2da54ddb60c93bf346493d7e08bc6d08 = Len(z4891679d877f1da36647b21d6197fbfd) / t5f443e88a552a3f943275f985dde03ca - 1\nReDim m06993036154505accc9ce092bdb57b17(b2da54ddb60c93bf346493d7e08bc6d08)\nReDim b8026f9f8f7fe86372be0799d8c9c6691(b2da54ddb60c93bf346493d7e08bc6d08)\nbf56f94eb6ed9a658e82e88591237324d = 0\nbec732ae8e18b7b2ff2e9ccd058f3e8fc = 0\nFor bec732ae8e18b7b2ff2e9ccd058f3e8fc = 0 To b2da54ddb60c93bf346493d7e08bc6d08\nm06993036154505accc9ce092bdb57b17(bec732ae8e18b7b2ff2e9ccd058f3e8fc) = bec732ae8e18b7b2ff2e9ccd058f3e8fc - (b2da54ddb60c93bf346493d7e08bc6d08 + 1)\nNext bec732ae8e18b7b2ff2e9ccd058f3e8fc\nFor bf56f94eb6ed9a658e82e88591237324d = 0 To b2da54ddb60c93bf346493d7e08bc6d08\nFor bec732ae8e18b7b2ff2e9ccd058f3e8fc = 0 To b2da54ddb60c93bf346493d7e08bc6d08\nIf CInt(Mid(z4891679d877f1da36647b21d6197fbfd, bec732ae8e18b7b2ff2e9ccd058f3e8fc * t5f443e88a552a3f943275f985dde03ca + 1, t5f443e88a552a3f943275f985dde03ca - 3)) = bf56f94eb6ed9a658e82e88591237324d Then\nb8026f9f8f7fe86372be0799d8c9c6691(bf56f94eb6ed9a658e82e88591237324d) = (Mid(z4891679d877f1da36647b21d6197fbfd, (bec732ae8e18b7b2ff2e9ccd058f3e8fc + 1) * t5f443e88a552a3f943275f985dde03ca - 2, 3) + m06993036154505accc9ce092bdb57b17(bf56f94eb6ed9a658e82e88591237324d))\nExit For\nEnd If\nNext bec732ae8e18b7b2ff2e9ccd058f3e8fc\nNext bf56f94eb6ed9a658e82e88591237324d\nCreatePasswordFromCode = \"\"\nFor bf56f94eb6ed9a658e82e88591237324d = 0 To b2da54ddb60c93bf346493d7e08bc6d08\nCreatePasswordFromCode = CreatePasswordFromCode &amp; Chr(b8026f9f8f7fe86372be0799d8c9c6691(bf56f94eb6ed9a658e82e88591237324d))\nNext bf56f94eb6ed9a658e82e88591237324d\nEnd Function\nFunction CreateCodeFromPassword(ByVal z4891679d877f1da36647b21d6197fbfd As String) As String\nDim qe564274d6cab7b91a3393ef092dac78f As Integer\nDim b330c8da5472f3c36b801671ef5a54797 As String\nDim t5f443e88a552a3f943275f985dde03ca As Integer\nDim bec732ae8e18b7b2ff2e9ccd058f3e8fc As Integer\nDim m06993036154505accc9ce092bdb57b17() As Integer\nDim b8026f9f8f7fe86372be0799d8c9c6691() As Long\nDim b343223dcae485b35af2792c7dd91f92b() As String\nDim e0d4cf763c9da42470a729a29b30d7d50 As Variant\nDim b41d8f2e79c0e09113beb7629aa0d8c48() As Variant\nDim b42a57d0c121b9fe34a74143aa279157c As Variant\nRandomize\nqe564274d6cab7b91a3393ef092dac78f = Len(z4891679d877f1da36647b21d6197fbfd) - 1\nb330c8da5472f3c36b801671ef5a54797 = IIf(qe564274d6cab7b91a3393ef092dac78f &lt; 10, \"0\", \"00\")\nt5f443e88a552a3f943275f985dde03ca = IIf(qe564274d6cab7b91a3393ef092dac78f &lt; 10, Int(Rnd() * 5 + 1) * 2 - 1, Int(Rnd() * 5 + 1) * 2)\nReDim m06993036154505accc9ce092bdb57b17(qe564274d6cab7b91a3393ef092dac78f)\nReDim b8026f9f8f7fe86372be0799d8c9c6691(qe564274d6cab7b91a3393ef092dac78f)\nReDim b343223dcae485b35af2792c7dd91f92b(qe564274d6cab7b91a3393ef092dac78f)\nReDim b41d8f2e79c0e09113beb7629aa0d8c48(qe564274d6cab7b91a3393ef092dac78f)\nFor bec732ae8e18b7b2ff2e9ccd058f3e8fc = 0 To qe564274d6cab7b91a3393ef092dac78f\nb41d8f2e79c0e09113beb7629aa0d8c48(bec732ae8e18b7b2ff2e9ccd058f3e8fc) = bec732ae8e18b7b2ff2e9ccd058f3e8fc\nNext bec732ae8e18b7b2ff2e9ccd058f3e8fc\nFor bec732ae8e18b7b2ff2e9ccd058f3e8fc = LBound(b41d8f2e79c0e09113beb7629aa0d8c48) To UBound(b41d8f2e79c0e09113beb7629aa0d8c48)\nb42a57d0c121b9fe34a74143aa279157c = CLng(((UBound(b41d8f2e79c0e09113beb7629aa0d8c48) - bec732ae8e18b7b2ff2e9ccd058f3e8fc) * Rnd) + bec732ae8e18b7b2ff2e9ccd058f3e8fc)\nIf bec732ae8e18b7b2ff2e9ccd058f3e8fc &lt;&gt; b42a57d0c121b9fe34a74143aa279157c Then\ne0d4cf763c9da42470a729a29b30d7d50 = b41d8f2e79c0e09113beb7629aa0d8c48(bec732ae8e18b7b2ff2e9ccd058f3e8fc)\nb41d8f2e79c0e09113beb7629aa0d8c48(bec732ae8e18b7b2ff2e9ccd058f3e8fc) = b41d8f2e79c0e09113beb7629aa0d8c48(b42a57d0c121b9fe34a74143aa279157c)\nb41d8f2e79c0e09113beb7629aa0d8c48(b42a57d0c121b9fe34a74143aa279157c) = e0d4cf763c9da42470a729a29b30d7d50\nEnd If\nNext bec732ae8e18b7b2ff2e9ccd058f3e8fc\nFor bec732ae8e18b7b2ff2e9ccd058f3e8fc = 0 To qe564274d6cab7b91a3393ef092dac78f\nb343223dcae485b35af2792c7dd91f92b(bec732ae8e18b7b2ff2e9ccd058f3e8fc) = Mid(z4891679d877f1da36647b21d6197fbfd, bec732ae8e18b7b2ff2e9ccd058f3e8fc + 1, 1)\nm06993036154505accc9ce092bdb57b17(bec732ae8e18b7b2ff2e9ccd058f3e8fc) = bec732ae8e18b7b2ff2e9ccd058f3e8fc - (qe564274d6cab7b91a3393ef092dac78f + 1)\nNext bec732ae8e18b7b2ff2e9ccd058f3e8fc\nFor bec732ae8e18b7b2ff2e9ccd058f3e8fc = 0 To qe564274d6cab7b91a3393ef092dac78f\nb8026f9f8f7fe86372be0799d8c9c6691(Application.Match(bec732ae8e18b7b2ff2e9ccd058f3e8fc, b41d8f2e79c0e09113beb7629aa0d8c48, False) - 1) = AscB(b343223dcae485b35af2792c7dd91f92b(bec732ae8e18b7b2ff2e9ccd058f3e8fc)) - m06993036154505accc9ce092bdb57b17(bec732ae8e18b7b2ff2e9ccd058f3e8fc)\nNext bec732ae8e18b7b2ff2e9ccd058f3e8fc\nCreateCodeFromPassword = \"\"\nFor bec732ae8e18b7b2ff2e9ccd058f3e8fc = 0 To qe564274d6cab7b91a3393ef092dac78f\nCreateCodeFromPassword = CreateCodeFromPassword &amp; Format(b41d8f2e79c0e09113beb7629aa0d8c48(bec732ae8e18b7b2ff2e9ccd058f3e8fc), b330c8da5472f3c36b801671ef5a54797) &amp; Format(b8026f9f8f7fe86372be0799d8c9c6691(bec732ae8e18b7b2ff2e9ccd058f3e8fc), \"000\")\nNext bec732ae8e18b7b2ff2e9ccd058f3e8fc\nCreateCodeFromPassword = CreateCodeFromPassword &amp; t5f443e88a552a3f943275f985dde03ca\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "is_accepted": false, "score": 3, "last_activity_date": 1567656789, "creation_date": 1567656789, "answer_id": 57798334, "question_id": 47990187, "link": "https://stackoverflow.com/questions/47990187/securely-store-password-in-a-vba-project/57798334#57798334", "title": "Securely store password in a VBA project", "body": "<p>Summarising the useful info from comments:</p>\n\n<ul>\n<li>if your code has access to the password (even directly or through obfuscation) anybody having access to the code have access to the password too</li>\n<li>password protection of Excel VBA is very weak, it's a trivial job to crack it</li>\n</ul>\n\n<p>Conclusion :  <strong>there is no way securely storing password in Excel VBA</strong></p>\n"}], "owner": {"reputation": 1045, "user_id": 4548985, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/546tA.png?s=128&g=1", "display_name": "Lich4r", "link": "https://stackoverflow.com/users/4548985/lich4r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5056, "favorite_count": 3, "answer_count": 3, "score": 5, "last_activity_date": 1567656789, "creation_date": 1514369349, "last_edit_date": 1514374415, "question_id": 47990187, "link": "https://stackoverflow.com/questions/47990187/securely-store-password-in-a-vba-project", "title": "Securely store password in a VBA project", "body": "<p>I built a file used by various people in one of my company service.</p>\n\n<p>Each sheet is protected by a password and all users entries are handled with a VBA user form. All sheets are protected by the same password and my code protect/unprotect sheet when users modify data. </p>\n\n<p>The problem is I'm storing the password in clear text in the VBA project so as to call the <code>ActiveSheet.Protect password</code> method. The VBA project is also protected by this password.</p>\n\n<p><strong>Is there a secure way to store that password in the VBA project ?</strong></p>\n\n<p>Anyone who knows how to search a bit would find a code to crack that VBA project password and be able to read it.</p>\n\n<p><strong><em>EDIT :</em></strong></p>\n\n<p>I have thought of computing a new password each time the file is open by adding some randomness in it. This way one could read the code without knowing the password. Adding a msgbox could reveal it but only until the file is reopenend. The problem is I cannot manually unprotect/protect sheet with that method as I won't be aware of the password.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514367616, "post_id": 47989636, "comment_id": 82947883, "body": "What line errors out? It&#39;s hard to tell without some pictures..."}, {"owner": {"reputation": 39, "user_id": 9144488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26d517458b48c57596b50fc9f4ede25c?s=128&d=identicon&r=PG&f=1", "display_name": "hypestar", "link": "https://stackoverflow.com/users/9144488/hypestar"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514367796, "post_id": 47989636, "comment_id": 82947951, "body": "I edited the lines giving me an error to the original post."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514368240, "post_id": 47989636, "comment_id": 82948142, "body": "Your <code>range</code> and <code>rng2</code> are on different sheets."}, {"owner": {"reputation": 39, "user_id": 9144488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26d517458b48c57596b50fc9f4ede25c?s=128&d=identicon&r=PG&f=1", "display_name": "hypestar", "link": "https://stackoverflow.com/users/9144488/hypestar"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514368527, "post_id": 47989636, "comment_id": 82948247, "body": "That worked! Thank you very much, im quite new to vba so I&#39;m still trying to figure stuff out."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514368605, "post_id": 47989636, "comment_id": 82948285, "body": "You&#39;re welcome! I&#39;ll put it as answer."}], "answers": [{"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 0, "last_activity_date": 1514368616, "creation_date": 1514368616, "answer_id": 47989990, "question_id": 47989636, "link": "https://stackoverflow.com/questions/47989636/moving-a-relative-range-in-excel-vba/47989990#47989990", "title": "Moving a relative range in Excel vba", "body": "<p>Your <code>range</code> and <code>rng2</code> are on different sheets.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>When you type <code>Range</code>, then you effectively refer to whichever sheet happens to be active, so it's good idea to qualify Range with sheet name.</p>\n"}], "owner": {"reputation": 39, "user_id": 9144488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26d517458b48c57596b50fc9f4ede25c?s=128&d=identicon&r=PG&f=1", "display_name": "hypestar", "link": "https://stackoverflow.com/users/9144488/hypestar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 47989990, "answer_count": 1, "score": 0, "last_activity_date": 1514378686, "creation_date": 1514367259, "last_edit_date": 1514378686, "question_id": 47989636, "link": "https://stackoverflow.com/questions/47989636/moving-a-relative-range-in-excel-vba", "title": "Moving a relative range in Excel vba", "body": "<p>So I'm trying to move a relative range in excel one cell down but i am getting an error trying to do so.\nI basically got 2 Worksheets. \nThe second one contains a couple of cells with hostnames. Below each hostname are more cells with names of locations. \nThe first worksheet contains a button and whenever I click that button it asks me for a hostname and a new location. The idea is to find that hostname in the second worksheet and copy that whole list of locations one cell down without touching the actual hostname so that i can add the new location to the cell right below the hostname without losing any data.</p>\n\n<p>This is my code so far which gives me an error:</p>\n\n<pre><code>Sub UpdateLocation(hostname As String, newLocation As String)\nDim rng1 As range\nDim rng2 As range\nDim tmpRng As range\nDim oldLocation As String\n\n'find cells in both sheets\nSet rng1 = FindCellInSheet(hostname, \"ServerListe\")\nSet rng2 = FindCellInSheet(hostname, \"History\")\n\nIf Not rng1 Is Nothing And Not rng2 Is Nothing Then 'were both cells found?\n    'change values in first sheet\n    oldLocation = rng1.Offset(0, 1).Value\n    rng1.Offset(0, 1).Value = newLocation\n    rng1.Offset(1, 4).Value = oldLocation\n    'change values in second sheet\n    If Not IsEmpty(rng2.Offset(1, 0)) Then 'is there a history record yet?\n        'select whole record until first empty cell\n        Set tmpRng = range(rng2.Offset(1, 0), rng2.End(xlDown))\n        'move content one cell down\n        range(rng2.Offset(2, 0), rng2.Offset((1 + tmpRng.Rows.count), 0)).Value = tmpRng.Value\n    End If\n    'insert oldLocation into history\n    rng2.Offset(1, 0).Value = oldLocation\nElse\n    'in case one or both cells weren't found\n    MsgBox \"'\" &amp; hostname &amp; \"' wurde nicht gefunden oder ist nur in einer Tabelle vorhanden.\"\nEnd If\nEnd Sub\n\nPrivate Function FindCellInSheet(searchString As String, sheetName As String) As range\nIf Not IsEmpty(Trim(searchString)) Then 'remove spaces and check if cell is empty\n    With Sheets(sheetName).UsedRange 'selects all cells with content\n        'find searchString in specified sheet, case insensitive\n        Set FindCellInSheet = .Find(What:=searchString, _\n                                    LookIn:=xlValues, _\n                                    LookAt:=xlWhole, _\n                                    SearchOrder:=xlByRows, _\n                                    SearchDirection:=xlNext, _\n                                    MatchCase:=False)\n    End With\nEnd If\nExit Function\nEnd Function\n</code></pre>\n\n<p>Everything is working finde besides the part where i try to select the range and move the whole lot one cell down.</p>\n\n<p>I hope you guys can point me in the right direction.\nThank you in advance!</p>\n\n<p>Edit: </p>\n\n<pre><code>        'select whole record until first empty cell\n        Set tmpRng = range(rng2.Offset(1, 0), rng2.End(xlDown))\n        'move content one cell down\n        range(rng2.Offset(2, 0), rng2.Offset((1 + tmpRng.Rows.count), 0)).Value = tmpRng.Value\n</code></pre>\n\n<p>Those are the lines giving me an error.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1514373992, "post_id": 47989292, "comment_id": 82950911, "body": "You could just open the HTA as a text file and search for it"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1514382517, "creation_date": 1514382517, "answer_id": 47993339, "question_id": 47989292, "link": "https://stackoverflow.com/questions/47989292/i-want-to-get-document-elements-value-of-hta-running-in-vba/47993339#47993339", "title": "I want to get document.elements value of HTA running in VBA", "body": "<p>Named elements in a HTA file can be referred by their name. </p>\n\n<blockquote>\n  <p>run_button.value</p>\n</blockquote>\n\n<p>When more than 1 element share the same name, the name will return a collection of elements.</p>\n\n<blockquote>\n  <p>run_buttons(1).value</p>\n</blockquote>\n\n<pre><code>&lt;input type=\"button\" value=\"Run Script\" name=\"run_buttons\" onClick=\"TestSub\"&gt; \n</code></pre>\n\n<h2>    </h2>\n\n<pre><code>&lt;head&gt;\n&lt;title&gt;HTA Test&lt;/title&gt;\n&lt;HTA:APPLICATION `enter code here`\n     APPLICATIONNAME=\"HTA Test\"\n     SCROLL=\"yes\"\n     SINGLEINSTANCE=\"yes\"\n     WINDOWSTATE=\"maximize\"&gt;\n&lt;/head&gt;\n\n&lt;script language=\"VBScript\"&gt;\n    Sub TestSub\n        Msgbox run_button.value\n    End Sub\n&lt;/script&gt;\n\n&lt;body&gt;\n&lt;input type=\"button\" value=\"Run Script\" name=\"run_button\" onClick=\"TestSub\"&gt; \n&lt;/body&gt;\n</code></pre>\n\n<p>Another technique would be to pass a reference of element to the subroutine using <code>Me</code>.</p>\n\n<pre><code>&lt;head&gt;\n&lt;title&gt;HTA Test&lt;/title&gt;\n&lt;HTA:APPLICATION `enter code here`\n     APPLICATIONNAME=\"HTA Test\"\n     SCROLL=\"yes\"\n     SINGLEINSTANCE=\"yes\"\n     WINDOWSTATE=\"maximize\"&gt;\n&lt;/head&gt;\n\n&lt;script language=\"VBScript\"&gt;\n    Sub TestSub(ele)\n        Msgbox ele.value\n    End Sub\n&lt;/script&gt;\n\n&lt;body&gt;\n&lt;input type=\"button\" value=\"Run Script\" name=\"run_buttons\" onClick=\"TestSub(Me)\"&gt; \n\n&lt;/body&gt;\n</code></pre>\n\n<p>When I write HTA or VBS files, I use HTAEdit and Vbsedit respectively.  You can get them here <a href=\"http://www.vbsedit.com/\" rel=\"nofollow noreferrer\">VBEdit.com</a>.  </p>\n"}], "owner": {"reputation": 1, "user_id": 9144324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8612aa288ce7bdc6f85f05eb90b4e4d?s=128&d=identicon&r=PG&f=1", "display_name": "hiraikou", "link": "https://stackoverflow.com/users/9144324/hiraikou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1514382517, "creation_date": 1514365747, "last_edit_date": 1514371582, "question_id": 47989292, "link": "https://stackoverflow.com/questions/47989292/i-want-to-get-document-elements-value-of-hta-running-in-vba", "title": "I want to get document.elements value of HTA running in VBA", "body": "<p>test source</p>\n\n<pre><code>&lt;head&gt;\n&lt;title&gt;HTA Test&lt;/title&gt;\n&lt;HTA:APPLICATION `enter code here`\n     APPLICATIONNAME=\"HTA Test\"\n     SCROLL=\"yes\"\n     SINGLEINSTANCE=\"yes\"\n     WINDOWSTATE=\"maximize\"&gt;\n&lt;/head&gt;\n\n&lt;script language=\"VBScript\"&gt;\n    Sub TestSub\n        Msgbox \"Testing 1-2-3.\"\n    End Sub\n&lt;/script&gt;\n\n&lt;body&gt;\n&lt;input type=\"button\" value=\"Run Script\" name=\"run_button\" onClick=\"TestSub\"&gt; \n&lt;/body&gt;\n</code></pre>\n\n<p>For example</p>\n\n<p>In the running html application (title: HTA Test)</p>\n\n<p>The value of (<code>name = \"run_button\"</code>)\nGet with VBA (<code>document.getelementsby</code>) </p>\n\n<p>I want to come and ask if this is possible.</p>\n"}, {"tags": ["vba", "foreach"], "answers": [{"tags": [], "owner": {"reputation": 4167, "user_id": 363132, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2016af46ed42c48efdf3b13057061a8?s=128&d=identicon&r=PG", "display_name": "teukkam", "link": "https://stackoverflow.com/users/363132/teukkam"}, "is_accepted": true, "score": 0, "last_activity_date": 1514365906, "creation_date": 1514365906, "answer_id": 47989329, "question_id": 47989287, "link": "https://stackoverflow.com/questions/47989287/vba-do-same-code-in-all-sheets/47989329#47989329", "title": "vba: Do same code in all sheets", "body": "<p>Try <code>hoja.Range</code> instead of simply <code>Range</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9117129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be87045970daef0fd35c4c7aa2c9cb91?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/9117129/mario"}, "edited": false, "score": 0, "creation_date": 1514535218, "post_id": 47989330, "comment_id": 83007956, "body": "Thank you Branislav, so simple, still I couln&#39;t see it :S. Thanks!!"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 33, "user_id": 9117129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be87045970daef0fd35c4c7aa2c9cb91?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/9117129/mario"}, "edited": false, "score": 0, "creation_date": 1514541587, "post_id": 47989330, "comment_id": 83010417, "body": "@Mario You`re welcome. Obvious things are the easiest to overlook."}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": false, "score": 1, "last_activity_date": 1514365908, "creation_date": 1514365908, "answer_id": 47989330, "question_id": 47989287, "link": "https://stackoverflow.com/questions/47989287/vba-do-same-code-in-all-sheets/47989330#47989330", "title": "vba: Do same code in all sheets", "body": "<p>The <code>Range</code> object, if not qualified, always refers to active sheet.<br>\nIf you want to copy paste each time on different sheet, use the code below:  </p>\n\n<pre><code>Dim hoja as worksheet\nFor Each hoja In Workbooks(\"Origen.xlsx\").Worksheets\nhoja.Range(\"a1:a2\").copy Destination:=hoja.Range(\"a3:a4\")\nnext\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9117129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be87045970daef0fd35c4c7aa2c9cb91?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/9117129/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16, "favorite_count": 0, "accepted_answer_id": 47989329, "answer_count": 2, "score": 2, "last_activity_date": 1514365908, "creation_date": 1514365724, "question_id": 47989287, "link": "https://stackoverflow.com/questions/47989287/vba-do-same-code-in-all-sheets", "title": "vba: Do same code in all sheets", "body": "<p>Simple question. The following code works fine:</p>\n\n<pre><code>Dim hoja as worksheet\nFor Each hoja In Workbooks(\"Origen.xlsx\").Worksheets\nMsgbox hoja.name\nnext\n</code></pre>\n\n<p>However, the following code does NOT work. Can anybody say why and make it work?</p>\n\n<pre><code>Dim hoja as worksheet\nFor Each hoja In Workbooks(\"Origen.xlsx\").Worksheets\nRange(\"a1:a2\").copy Destination:=Range(\"a3:a4\")\nnext\n</code></pre>\n\n<p>The second code only does the copy/paste thing in one of the sheets, but not in all. \nPlease can you help? I'm so frustrated with such a simple thing.\nThanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1514366180, "post_id": 47989246, "comment_id": 82947234, "body": "Maybe this helps <a href=\"https://stackoverflow.com/questions/22880225/how-can-i-use-persian-date-shamsi-in-excel-2007\" title=\"how can i use persian date shamsi in excel 2007\">stackoverflow.com/questions/22880225/&hellip;</a>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1514366617, "post_id": 47989246, "comment_id": 82947443, "body": "In case of Office 365 you might already have this <a href=\"https://s3.amazonaws.com/uploads.uservoice.com/assets/112/838/348/original/Persian_Calendar.jpg?AWSAccessKeyId=AKIAJF4UXUF6KJMEJFQQ&amp;Expires=1514368061&amp;Signature=zVpAu5nPVupoebvPXJJD1cefWrs%3D\" rel=\"nofollow noreferrer\">s3.amazonaws.com/uploads.uservoice.com/assets/112/838/348/&hellip;</a>"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1514367556, "post_id": 47989246, "comment_id": 82947849, "body": "Very likely, either E13 isn&#39;t a date and/or B13 isn&#39;t a number. In both cases, test with this formula, <code>=VALUE(E13)</code>, respectively B13. In both cases the formula will return a #VALUE error if the cell contains a string. The equivalent in VBA is the Val() function which you might include in your code. It returns 0 instead of an error. So, <code>n = Sheets(3).Range(&quot;e13&quot;).Value</code> <code>If n Then FirstDate = CDate(n)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1514367208, "creation_date": 1514367208, "answer_id": 47989626, "question_id": 47989246, "link": "https://stackoverflow.com/questions/47989246/using-excel-dateadd-function/47989626#47989626", "title": "Using Excel DateAdd Function", "body": "<p>By default VBA uses the Gregorian Date Calendar. So I assume that you need to convert your Hijri Date to Gregorian Date and after adding the days to it convert the Gregorian Date back to the Hijri Date.</p>\n\n<p>Please give this a try...</p>\n\n<pre><code>Sub mydateaddfunction()\n    Dim FirstDate As Date\n    Dim Number As Integer\n    Dim gDate As Date\n    FirstDate = HijriToGreg(Sheets(3).Range(\"e13\").Value)\n    Number = Sheets(3).Range(\"b13\").Value\n    gDate = DateAdd(\"d\", Number, FirstDate)\n    Sheets(3).Range(\"e14\").Value = GregToHijri(gDate)\nEnd Sub\n\nFunction GregToHijri(dtGegDate As Date) As String\n    'Converts Gregorian date to a Hijri date\n    VBA.Calendar = vbCalHijri\n    GregToHijri = dtGegDate\n    VBA.Calendar = vbCalGreg\nEnd Function\n\nFunction HijriToGreg(dtHijDate As String) As Date\n    'Converts Hijri date to a Gregorian date\n    VBA.Calendar = vbCalHijri\n    HijriToGreg = dtHijDate\n    VBA.Calendar = vbCalGreg\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 307, "user_id": 5329282, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2e3fa3808a20ccdbc34aa3352dfd0f43?s=128&d=identicon&r=PG&f=1", "display_name": "M. Safari", "link": "https://stackoverflow.com/users/5329282/m-safari"}, "edited": false, "score": 0, "creation_date": 1514369469, "post_id": 47989641, "comment_id": 82948723, "body": "To be honest &quot;Does not work &quot; is not really helpful. Anyway, as mentioned, you need to have Excel 2016 Otherwise, you are right, it will not work."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1514367281, "creation_date": 1514367281, "answer_id": 47989641, "question_id": 47989246, "link": "https://stackoverflow.com/questions/47989246/using-excel-dateadd-function/47989641#47989641", "title": "Using Excel DateAdd Function", "body": "<p>In case of Excel 2016 Change your code to</p>\n\n<pre><code>Sub mydateaddfunction()\n    Dim FirstDate As Date\n    Dim Number As Integer\n\n    Dim rg As Range\n    Set rg = Union(Sheets(1).Range(\"E13\"), Sheets(1).Range(\"E14\"))\n    rg.NumberFormat = \"[$-fa-IR,16]dd/mm/yyyy;@\"\n\n\n      FirstDate = Sheets(1).Range(\"e13\").Value\n      Number = Sheets(1).Range(\"b13\").Value\n      Sheets(1).Range(\"e14\").Value = DateAdd(\"d\", Number, FirstDate)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 2774543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/676e045f99cdd96a254c93be99d8e7a8?s=128&d=identicon&r=PG&f=1", "display_name": "Tahir", "link": "https://stackoverflow.com/users/2774543/tahir"}, "is_accepted": false, "score": 0, "last_activity_date": 1604883989, "creation_date": 1604883989, "answer_id": 64744650, "question_id": 47989246, "link": "https://stackoverflow.com/questions/47989246/using-excel-dateadd-function/64744650#64744650", "title": "Using Excel DateAdd Function", "body": "<p>For those looking for a simple solution, they can use Excel existing function called &quot;Workday&quot; to add x number of days to a data.</p>\n<p>WORKDAY(start_date, days, [holidays])</p>\n"}], "owner": {"reputation": 307, "user_id": 5329282, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/2e3fa3808a20ccdbc34aa3352dfd0f43?s=128&d=identicon&r=PG&f=1", "display_name": "M. Safari", "link": "https://stackoverflow.com/users/5329282/m-safari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1604883989, "creation_date": 1514365505, "last_edit_date": 1514378198, "question_id": 47989246, "link": "https://stackoverflow.com/questions/47989246/using-excel-dateadd-function", "title": "Using Excel DateAdd Function", "body": "<p>I want to use excel DateAdd function to add some days to a cell containing a persian/hijri calendar date. So, I've created a button and assigned a macro to it like :</p>\n\n<pre><code>Sub mydateaddfunction()\n    Dim FirstDate As Date\n    Dim Number As Integer\n      FirstDate = Sheets(3).Range(\"e13\").Value\n      Number = Sheets(3).Range(\"b13\").Value\n      Sheets(3).Range(\"e14\").Value = DateAdd(\"d\", Number, FirstDate)\nEnd Sub\n</code></pre>\n\n<p>but unfortunately it throws an error </p>\n\n<blockquote>\n  <p>application defined or object-defined error</p>\n</blockquote>\n\n<p>error coming from this line :</p>\n\n<pre><code>Sheets(3).Range(\"e14\").Value = DateAdd(\"d\", Number, FirstDate)\n</code></pre>\n\n<p>e13 cell contains the date, b13 contains the number of days I want to add to the e13 cell. so if e13 cell be something like : </p>\n\n<blockquote>\n  <p>1396/10/17</p>\n</blockquote>\n\n<p>and b13 contains a number like 3, I want e14 to be:</p>\n\n<blockquote>\n  <p>1396/10/20</p>\n</blockquote>\n\n<p>What I'm doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514363676, "post_id": 47988344, "comment_id": 82946248, "body": "Do you want to delete named ranges entirely or just remove names?"}, {"owner": {"reputation": 85, "user_id": 8530965, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/04eb060290a063f46fa5ceebe23a67a0?s=128&d=identicon&r=PG&f=1", "display_name": "Surbhi Manocha", "link": "https://stackoverflow.com/users/8530965/surbhi-manocha"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514364819, "post_id": 47988344, "comment_id": 82946681, "body": "Remove name ranges entirely"}], "answers": [{"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1514361837, "creation_date": 1514361837, "answer_id": 47988504, "question_id": 47988344, "link": "https://stackoverflow.com/questions/47988344/delete-specific-name-ranges-using-vba/47988504#47988504", "title": "Delete specific name ranges using vba", "body": "<pre><code>Sub DeleteNamedRanges()\n    Dim all_names, n\n    all_names = Array(\"Fruits\", \"Vegetables\", \"friends\", \"Classes\")\n    For Each n In all_names\n        Names(n).Delete\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1514367002, "creation_date": 1514367002, "answer_id": 47989581, "question_id": 47988344, "link": "https://stackoverflow.com/questions/47988344/delete-specific-name-ranges-using-vba/47989581#47989581", "title": "Delete specific name ranges using vba", "body": "<p>Code should differentiate between the scope of the names to be deleted. It should also take account of the possibility that the name doesn't exist. Finally, since your array is intended to have different content it can't be specified in the executing procedure. Therefore my code below has a calling procedure to specify the array and scope, and an executing procedure which doesn't crash out when a name isn't found.</p>\n\n<pre><code>Sub CallDeleteNamedRanges()\n\n    Dim Scope As Object\n    Dim Arr() As String\n\n    Set Scope = ThisWorkbook\n'    ' you can specify a workbook, a worksheet, a table etc.\n'    ' For example:-\n'    Set Scope = ThisWorkbook.Worksheets(\"Sheet1\")\n    Arr = Split(\"Fruits,Vegetables,Friends,Classes\", \",\")\n    DeleteNamedRanges Arr, Scope\nEnd Sub\n\nPrivate Sub DeleteNamedRanges(Arr() As String, _\n                              Scope As Object)\n\n    Dim i As Integer\n\n    For i = 0 To UBound(Arr)\n        ' an error will occur if the name doesn't exist\n        On Error Resume Next\n        Scope.Names(Arr(i)).Delete\n    Next i\n    Err.Clear\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 8530965, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/04eb060290a063f46fa5ceebe23a67a0?s=128&d=identicon&r=PG&f=1", "display_name": "Surbhi Manocha", "link": "https://stackoverflow.com/users/8530965/surbhi-manocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3918, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1514367002, "creation_date": 1514360949, "last_edit_date": 1531164843, "question_id": 47988344, "link": "https://stackoverflow.com/questions/47988344/delete-specific-name-ranges-using-vba", "title": "Delete specific name ranges using vba", "body": "<p>I have an array with few items, each item represents a name range. i am trying to write a code to delete the named ranges present ONLY in that array. Example:\n[Arr1]={Fruits,Vegetables,friends,Classes}</p>\n\n<p>I want to delete all the name ranges by the name of elements present in Arr1. Arr1 can have different elements at different points in time.</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514361996, "post_id": 47988318, "comment_id": 82945659, "body": "Of course <i>on whatever cell I&#39;m pointing on</i> because you use <code>Selection</code>."}, {"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514362322, "post_id": 47988318, "comment_id": 82945736, "body": "oops.. Sorry, used my old test code by accident. I&#39;ll edit in the proper one."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514363273, "post_id": 47988318, "comment_id": 82946086, "body": "It&#39;s good that you rephrased the [previous question][1] (now I understand your followup question) but some more info is needed on this one.  What is the rest of the error message, and on which line is it occurring?  Are you sure <code>Me.Range(&quot;table1[Last Service Date]&quot;)</code> is a valid range?  What happens if you try put a &quot;regular&quot; formula there like <code>.Formula=&quot;1+1&quot;</code>?  Also, what is the purpose of <code>.Value = .Value</code>?"}, {"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1514363590, "post_id": 47988318, "comment_id": 82946208, "body": "Glad to get that cleared up :p. Anyways <code>Me.Range(&quot;table1[Last Service Date]&quot;)</code> is valid for formulas at least. Cuz when I replaced array with 1+1 formula, the entire column auto creates 2 just as intended. As for the <code>.value = .value </code>, its a means to change the formula into values only. I don&#39;t need to keep the formula around in the table."}, {"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1514364293, "post_id": 47988318, "comment_id": 82946495, "body": "Also the error message just says <code>400</code>. That&#39;s it. The line causing it is on <code>.FormulaArray</code>."}], "answers": [{"comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1514367865, "post_id": 47989294, "comment_id": 82947984, "body": "Actually, specifying the entire target range for the array formula is more efficient than specifying the first cell and then copy down."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1514369966, "post_id": 47989294, "comment_id": 82948950, "body": "I don&#39;t think that would work. Did you ever try implementing the Array Formula to the entire range through VBA?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1514422329, "post_id": 47989294, "comment_id": 82969222, "body": "Yes, I did. Excel 2010. <code>ArrRng.FormulaArray = &quot;=MINVERSE(&quot; &amp; DataRange &amp; &quot;)&quot;</code>"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1514365748, "creation_date": 1514365748, "answer_id": 47989294, "question_id": 47988318, "link": "https://stackoverflow.com/questions/47988318/how-to-insert-array-formula-into-excel-via-vba/47989294#47989294", "title": "How to insert array formula into Excel via VBA?", "body": "<p>What's the point of using Me in the code? Have you placed that code in the Sheet Module? I would suggest you to move this code on to the Standard Module like Module1 and replace the Me keyword with the proper sheet reference. Otherwise I hope you have a good reason to place that code into the sheet module.</p>\n\n<p>Also you should place the Array Formula in the first cell of the table in the desired column and since the data is formatted as an Excel Table, the whole column will be filled with the formula automatically. If not, you can then use AutoFill property to fill down the formula down the rows.</p>\n\n<p>Give this a try to see if that resolves your issue.\nThe answer assumes that the formula you are trying to place through VBA works well when you put it manually on the Sheet.</p>\n\n<pre><code>With Me.Range(\"table1[Last Service Date]\").Cells(1)\n    .FormulaArray = \"=LARGE(IF(table2[[#All],[Asset No]]=[@[Asset No]],table2[[#All],[Entry Date]]),2)\"\n    .Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1514365748, "creation_date": 1514360843, "last_edit_date": 1514362655, "question_id": 47988318, "link": "https://stackoverflow.com/questions/47988318/how-to-insert-array-formula-into-excel-via-vba", "title": "How to insert array formula into Excel via VBA?", "body": "<p>Previously I have an Excel VBA code that performs index &amp; match formula from 1 sheet to another for an entire column in a table. Code example as below:</p>\n\n<pre><code>With Me.Range(\"table1[Description]\")\n    .Formula = \"=IFerror(INDEX(table2,MATCH(B4,table2[Asset No],0),2),\"\"\"\")\"\n    .Value = .Value\n End With\n</code></pre>\n\n<p>Now I would like to add an array function into the sheet so I copied the formula and replace the old formula with array along with other modifications.</p>\n\n<pre><code>Sub refresh()\n\nWith Me.Range(\"table1[Last Service Date]\")\n    .FormulaArray = \"=LARGE(IF(table2[[#All],[Asset No]]=[@[Asset No]],table2[[#All],[Entry Date]]),2)\"\n    .Value = .Value\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>But when I try to test the code, I keep getting the error message 400.\nAnything I need to change in my code for array formulas?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514360735, "post_id": 47988278, "comment_id": 82945159, "body": "I don&#39;t have an answer, but I would caution you in general from storing such unnormalized data in Excel (or in a database, for that matter).  Excel isn&#39;t the best too for this kind of data scrubbing operation."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514360754, "post_id": 47988278, "comment_id": 82945169, "body": "Is number of items the same in both columns (in case where there are more than one item)?"}, {"owner": {"reputation": 57, "user_id": 1106592, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9988e622fe7c960e0b35db60dd651d8e?s=128&d=identicon&r=PG", "display_name": "sanjeev", "link": "https://stackoverflow.com/users/1106592/sanjeev"}, "edited": false, "score": 0, "creation_date": 1514360877, "post_id": 47988278, "comment_id": 82945225, "body": "Yes, Same number of items in columns of a particular Row."}, {"owner": {"reputation": 57, "user_id": 1106592, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9988e622fe7c960e0b35db60dd651d8e?s=128&d=identicon&r=PG", "display_name": "sanjeev", "link": "https://stackoverflow.com/users/1106592/sanjeev"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514361018, "post_id": 47988278, "comment_id": 82945275, "body": "@TimBiegeleisen : Thanks for your concern but that&#39;s the format in which data got extracted from outlook for CCed Email. :)"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514361059, "post_id": 47988278, "comment_id": 82945296, "body": "Do you have access to something like Java, C#, Perl, etc.?  This problem would be much easier with a different tool."}, {"owner": {"reputation": 57, "user_id": 1106592, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9988e622fe7c960e0b35db60dd651d8e?s=128&d=identicon&r=PG", "display_name": "sanjeev", "link": "https://stackoverflow.com/users/1106592/sanjeev"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1514361253, "post_id": 47988278, "comment_id": 82945382, "body": "@TimBiegeleisen : C#"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 1106592, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9988e622fe7c960e0b35db60dd651d8e?s=128&d=identicon&r=PG", "display_name": "sanjeev", "link": "https://stackoverflow.com/users/1106592/sanjeev"}, "edited": false, "score": 0, "creation_date": 1514368225, "post_id": 47988461, "comment_id": 82948136, "body": "Thanks a lot. You made my day."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 1, "last_activity_date": 1514361604, "creation_date": 1514361604, "answer_id": 47988461, "question_id": 47988278, "link": "https://stackoverflow.com/questions/47988278/excel-mapping-from-column-to-column/47988461#47988461", "title": "Excel mapping from column to column", "body": "<pre><code>Sub Test()\n\n    Dim arr1(), arr2(), split1, split2\n    Dim rng As Range, rngRow As Range\n    Dim x As Integer, z As Integer\n\n    'Assuming data starts from A1 cell\n    Set rng = Range(\"A1\").CurrentRegion\n\n    For Each rngRow In rng.Rows\n        split1 = Split(rngRow.Cells(1), \";\")\n        split2 = Split(rngRow.Cells(2), \";\")\n        For x = LBound(split1) To UBound(split1)\n            z = z + 1\n            ReDim Preserve arr1(1 To z)\n            ReDim Preserve arr2(1 To z)\n            arr1(z) = split1(x)\n            arr2(z) = split2(x)\n        Next\n    Next\n\n    Range(\"D1\").Resize(UBound(arr1), 1).Value = Application.Transpose(arr1)\n    Range(\"E1\").Resize(UBound(arr2), 1).Value = Application.Transpose(arr2)\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 1106592, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9988e622fe7c960e0b35db60dd651d8e?s=128&d=identicon&r=PG", "display_name": "sanjeev", "link": "https://stackoverflow.com/users/1106592/sanjeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 47988461, "answer_count": 1, "score": 0, "last_activity_date": 1514361604, "creation_date": 1514360599, "last_edit_date": 1531161705, "question_id": 47988278, "link": "https://stackoverflow.com/questions/47988278/excel-mapping-from-column-to-column", "title": "Excel mapping from column to column", "body": "<p>I have data in following format in Excel:\nInput:</p>\n\n<pre><code>Col1       | Col2\nA1;A2;A3;A4|B1;B2;B3;B4\nA5;A6      | B5;B6\nA7;A8      | B7;B8\n</code></pre>\n\n<p>I want data to be in subsequent formatting i.e Output</p>\n\n<pre><code>Col1 | Col2\nA1 |B1\nA2 |B2\nA3 |B3\nA4 |B4\nA5 |B5\nA6 |B6\nA7 |B7\nA8 |B8\n</code></pre>\n\n<p>I tried a lot but didn't find any solution about How to frame this question or do it in excel.\nEvery Help/Guide/Link will be highly appreciated.\nThanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514361798, "post_id": 47988175, "comment_id": 82945598, "body": "Column D2?  Starting from Cell D2?"}, {"owner": {"reputation": 1, "user_id": 9144076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24965996bb90fb40098a17b95fa1726?s=128&d=identicon&r=PG&f=1", "display_name": "divide by zero", "link": "https://stackoverflow.com/users/9144076/divide-by-zero"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514362293, "post_id": 47988175, "comment_id": 82945732, "body": "Yes, starting from cell D2. Sorry for my bad English language. I am rookie in Excel."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514362364, "post_id": 47988175, "comment_id": 82945754, "body": "Is this an activex or a form control?"}, {"owner": {"reputation": 1, "user_id": 9144076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24965996bb90fb40098a17b95fa1726?s=128&d=identicon&r=PG&f=1", "display_name": "divide by zero", "link": "https://stackoverflow.com/users/9144076/divide-by-zero"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514362757, "post_id": 47988175, "comment_id": 82945891, "body": "It is ActiveX control"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1514363732, "last_edit_date": 1514363732, "creation_date": 1514362802, "answer_id": 47988687, "question_id": 47988175, "link": "https://stackoverflow.com/questions/47988175/generate-combo-box-list-from-column-entries-without-duplicates/47988687#47988687", "title": "Generate Combo Box list from column entries, without duplicates", "body": "<p>Code would go in a <a href=\"http://www.contextures.com/xlvba01.html\" rel=\"nofollow noreferrer\">standard module</a> which can be added via the VBE (<KBD>Alt</KBD> +  <KBD>F11</KBD>)</p>\n\n<p><strong>Option 1 using a dictionary to collect unique countries</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub PopulateCombo()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Sheet2\") 'change as appropriate\n\n    Dim lastRowInD As Long\n    Dim dedupRange As Range\n\n    lastRowInD = ws.Cells(ws.Rows.Count, \"D\").End(xlUp).Row\n    Set dedupRange = ws.Range(\"D2:D\" &amp; lastRowInD)\n\n    Dim dict As New Scripting.Dictionary\n    Dim currCell As Range\n\n    For Each currCell In dedupRange\n         If Not dict.Exists(currCell.Value2) Then dict.Add currCell.Value2, currCell.Value2\n    Next currCell\n\n    Dim key As Variant\n\n    With ws.OLEObjects(\"ComboBox1\").Object\n        .Clear\n        For Each key In dict.Keys\n            .AddItem dict(key)\n        Next key\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Option 2: Using de-duplicate Excel functionality.</strong></p>\n\n<p>Warning: This deletes duplicates from the sheet in column D.</p>\n\n<p>This works if you have an ActiveX comboxbox in a sheet and a named range called <code>Countries</code> which is created by <KBD> Ctrl </KBD> + <KBD>F3</KBD> to open the <code>Name Manager</code> and then entering </p>\n\n<p>Name: Countries</p>\n\n<p>Refers to:   <code>=OFFSET(Sheet2!$D$2,0,0,COUNTA(Sheet2!$D$2:$D$1048576),1)</code></p>\n\n<p>Adjust  $D$1048576 if you have an earlier version of Excel with a smaller row limit of 65536.</p>\n\n<pre><code>Public Sub PopulateCombo()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Sheet2\") 'change as appropriate\n\n    Dim lastRowInD As Long\n    Dim dedupRange As Range\n\n    lastRowInD = ws.Cells(ws.Rows.Count, \"D\").End(xlUp).Row\n    Set dedupRange = ws.Range(\"D2:D\" &amp; lastRowInD)\n\n    dedupRange.RemoveDuplicates Columns:=1, Header:=xlNo\n\n    With ws.OLEObjects(\"ComboBox1\").Object\n       .List = ws.Range(\"Countries\").Value\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9144076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24965996bb90fb40098a17b95fa1726?s=128&d=identicon&r=PG&f=1", "display_name": "divide by zero", "link": "https://stackoverflow.com/users/9144076/divide-by-zero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 503, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565438548, "creation_date": 1514360089, "last_edit_date": 1565438548, "question_id": 47988175, "link": "https://stackoverflow.com/questions/47988175/generate-combo-box-list-from-column-entries-without-duplicates", "title": "Generate Combo Box list from column entries, without duplicates", "body": "<p>I am doing car manufacturer list in Excel.</p>\n\n<p>I populate a Combo Box from column D2. </p>\n\n<ul>\n<li>United States </li>\n<li>United States</li>\n<li>Japan</li>\n<li>Germany</li>\n<li>France</li>\n</ul>\n\n<p>United States has many car companies, but I want to show United States only once in my Combo Box.</p>\n\n<p>Is there a way to modify Excel or write VBA so that each country is shown in Combo Box only once.</p>\n\n<p><img src=\"https://i.stack.imgur.com/9PJqr.png\" alt=\"Car manufacturers in Excel\"></p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1514363331, "post_id": 47988166, "comment_id": 82946116, "body": "Welcome to Stack Overflow!  Please provide example data so we can see what you have and what you&#39;re trying to do.  Also check out the <a href=\"https://stackoverflow.com/tour\">tour</a> as well as <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514370435, "post_id": 47988166, "comment_id": 82949213, "body": "+1 @ashleedawg data is needed. Basavaraj: you can possibly use a LOOKUP/SEARCH based construct but if there are duplicates (as they are names) then it will give you hard time."}, {"owner": {"reputation": 3, "user_id": 7519324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-fRfHgVjJH7M/AAAAAAAAAAI/AAAAAAAAAC4/HJJNxTS0WJQ/photo.jpg?sz=128", "display_name": "Basavaraj k.s.", "link": "https://stackoverflow.com/users/7519324/basavaraj-k-s"}, "edited": false, "score": 0, "creation_date": 1514380444, "post_id": 47988166, "comment_id": 82953791, "body": "sheet 1 column A have first middle last name and sheet 2 I have names which is only one part of column A ( like first name or middle or last name). I cant split names in sheet 1 because have reports and other formulas ( If I split I need to write 3 times V lookup formula)"}, {"owner": {"reputation": 3, "user_id": 7519324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-fRfHgVjJH7M/AAAAAAAAAAI/AAAAAAAAAC4/HJJNxTS0WJQ/photo.jpg?sz=128", "display_name": "Basavaraj k.s.", "link": "https://stackoverflow.com/users/7519324/basavaraj-k-s"}, "edited": false, "score": 0, "creation_date": 1514380614, "post_id": 47988166, "comment_id": 82953856, "body": "Any suggestions how to get data"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7519324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-fRfHgVjJH7M/AAAAAAAAAAI/AAAAAAAAAC4/HJJNxTS0WJQ/photo.jpg?sz=128", "display_name": "Basavaraj k.s.", "link": "https://stackoverflow.com/users/7519324/basavaraj-k-s"}, "edited": false, "score": 0, "creation_date": 1514380515, "post_id": 47990169, "comment_id": 82953821, "body": "I got your point , am really not sure here Index formula works ? I have never formulated INDEX formula please help"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1514455697, "last_edit_date": 1514455697, "creation_date": 1514369264, "answer_id": 47990169, "question_id": 47988166, "link": "https://stackoverflow.com/questions/47988166/first-middle-last-name-is-in-cell-a-next-sheet-having-one-name-tried-text-left/47990169#47990169", "title": "first middle last name is in cell A, next sheet having one name tried text left formulas", "body": "<p>Split the names in column A into three columns using the Data,TextToColumns feature, then use three MATCH formulas (one on each column) to find the cell and then use INDEX to return the contents of Column A</p>\n\n<p>=MATCH(sheet2!name you are looking for,sheet1!columnB,0) will return either #N/A or the number of the cell in column B if it finds a match. INDEX(sheet1!A:A,x,0)  will return the contents of the cell which is at row x in column A. So</p>\n\n<p>INDEX(sheet1!A:A,MATCH(Sheet2!name,sheet1!B:B,0),0)</p>\n\n<p>will give you the full name from column A if the first name is in column B or an error. Repeat for columns C and D</p>\n"}], "owner": {"reputation": 3, "user_id": 7519324, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-fRfHgVjJH7M/AAAAAAAAAAI/AAAAAAAAAC4/HJJNxTS0WJQ/photo.jpg?sz=128", "display_name": "Basavaraj k.s.", "link": "https://stackoverflow.com/users/7519324/basavaraj-k-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1514455697, "creation_date": 1514360023, "last_edit_date": 1531161705, "question_id": 47988166, "link": "https://stackoverflow.com/questions/47988166/first-middle-last-name-is-in-cell-a-next-sheet-having-one-name-tried-text-left", "title": "first middle last name is in cell A, next sheet having one name tried text left formulas", "body": "<p>In cell A first name middle name last name in one cell &amp; i have another list in sheet 2 have only one name. It may be first middle last name is it possible through look up to get data. If data matching it has to provide as in cell A first middle last names to my sheet2 look-up data.</p>\n\n<p>I have tried multiple text find formula. Is this possible in Excel please advise or do I need to go macro code for this ?</p>\n\n<p>Much appreciated for your help.</p>\n"}, {"tags": ["xml", "vba", "notepad++", "xmldom"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1514404979, "post_id": 47988000, "comment_id": 82964257, "body": "Edited/corrected wrong closing tag <code>&lt;&#47;carStuf&gt;</code> to <code>&lt;&#47;carStuff&gt;</code> to receive a well formed XML file."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514363428, "post_id": 47988400, "comment_id": 82946158, "body": "Wish it was this simple. The &lt;man&gt;Ford&lt;/man&gt; may also have lines with NA, but these should be kept. That is the reason I&#39;m looking for fields where &lt;man&gt; is NOT Ford or Dodge.  In addition only two lines above &lt;man&gt; should be checked for NA."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514363611, "post_id": 47988400, "comment_id": 82946220, "body": "a one-time thing? or something that needs to be done repeatedly?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514364103, "post_id": 47988400, "comment_id": 82946422, "body": "There are a number of ways to tackle this depending on a few things like whether the file is properly formatted XML (as opposed to your sample, missing top-level, etc), as well as where this file is coming from, whether this is a 1-time change, where the data is going when you&#39;re done, etc."}, {"owner": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514364533, "post_id": 47988400, "comment_id": 82946583, "body": "Two lines above &lt;man&gt; should be checked when it is not Ford or Dodge.   E.g. - script checks line by line, find NOT Ford or Dodge on line 4, goes up one line to 3rd and if it is NA - removes line, else leaves as is. Then goes up another line to 2nd and checks if it is NA - same logic as line 3. Resumes from the line 4 where it found NOT Ford or Dodge, and does the same operation until the end of file."}, {"owner": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514364705, "post_id": 47988400, "comment_id": 82946633, "body": "Unfortunately unable to share the file, but it is a well formatted xml with the fields I described being in their nodes."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514364834, "post_id": 47988400, "comment_id": 82946688, "body": "I can&#39;t think of an easily-explained way to do that especially without seeing some data.  I&#39;m a bit of a data geek so I could likely write a quick sub to accomplish that but not without a test file... You could always make a sample one with fake data, and 10 records. (and the appropriate headers etc so its representative of the actual file)."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514365218, "post_id": 47988400, "comment_id": 82946839, "body": "...now I&#39;m curious!  Which lines could be &quot;NA&quot;?  Any of the 3 besides &quot;&lt;man&gt;&quot;?  Will there always be 4 <i>(and only 4)</i> items per record (number/year/model/man) ?"}, {"owner": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514366096, "post_id": 47988400, "comment_id": 82947197, "body": "I&#39;ll try to mock-up something. There&#39;s more data. but only one group requires amendments, it contains a fixed number of nodes of which &lt;year&gt; and &lt;model&gt; must be removed or kept based on &lt;man&gt; value."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514366138, "post_id": 47988400, "comment_id": 82947218, "body": "always just those 4 items for this node?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514370671, "post_id": 47988400, "comment_id": 82949349, "body": "Thanks, that&#39;s much more clear example; unfortunately I&#39;m out of time for the moment....  in the meantime, have you tried Excel&#39;s built in XML tools?  (ie, xml table or source pane options when just Ctrl+O opening the xml file in Excel?)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1514361329, "creation_date": 1514361329, "answer_id": 47988400, "question_id": 47988000, "link": "https://stackoverflow.com/questions/47988000/find-multiple-lines-in-txt-xml-file-and-remove-if-criteria-met/47988400#47988400", "title": "Find multiple lines in TXT/xml file and remove if criteria met", "body": "<p>Sounds like you need to remove all lines that contain <code>&gt;NA&lt;</code>.</p>\n\n<p>This isn't really a programming question (so it's <a href=\"https://stackoverflow.com/help/on-topic\">off-topic</a>) but here's a quick answer using <a href=\"https://notepad-plus-plus.org/\" rel=\"nofollow noreferrer\">Notepad++</a>:</p>\n\n<ul>\n<li><p><kbd>Ctrl</kbd> + <kbd>H</kbd> to bring up the find replace dialog.</p></li>\n<li><p>In the <code>Find what:</code> text box include your regex: <code>.*&gt;NA&lt;.*\\r?\\n</code> <em>(where the <code>\\r</code> is optional in case the file doesn't have Windows line endings)</em>.</p></li>\n<li><p>Leave the <code>Replace with:</code> text box empty.</p></li>\n<li><p>Make sure the <code>Regular Expression</code> radio button in the Search Mode area is selected. </p></li>\n<li><p>lick <code>Replace All</code> and voil\u00e0!  All lines containing <code>&gt;NA&lt;</code> have been removed.</p></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/FnpND.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FnpND.gif\" alt=\"NPP repl line example\"></a></p>\n\n<p><sub>(Answer adapted from <a href=\"https://stackoverflow.com/questions/5876296/regex-remove-lines-containing\">this</a>).</sub></p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514442717, "post_id": 47997884, "comment_id": 82973621, "body": "Great! Simple and easy to understand.  I&#39;ll just need to amend it slightly, just to find &lt;soldCar&gt; node no matter the parent node."}, {"owner": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 1, "creation_date": 1514443389, "post_id": 47997884, "comment_id": 82973862, "body": "In case anyone would need it, maybe there&#39;s a simpler way, but did it like so:  Set noli = xDoc.DocumentElement.SelectNodes(&quot;descendant::soldCar&quot;)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514454151, "post_id": 47997884, "comment_id": 82978267, "body": "Glad I could be helpful. I edited my answer with a 2nd workable version permitting to avoid two <code>If</code> conditions by including them into the XPath string."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "reply_to_user": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "edited": false, "score": 0, "creation_date": 1514456375, "post_id": 47997884, "comment_id": 82979526, "body": "You can search nodes at any level via a double slash prefix <code>&#47;&#47;</code>, too. BTW, it isn&#39;t necessary in this case to use <code>DocumentElement</code> designing the root node, precisely because <b>all</b> XML levels are included."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1514454921, "last_edit_date": 1514454921, "creation_date": 1514404382, "answer_id": 47997884, "question_id": 47988000, "link": "https://stackoverflow.com/questions/47988000/find-multiple-lines-in-txt-xml-file-and-remove-if-criteria-met/47997884#47997884", "title": "Find multiple lines in TXT/xml file and remove if criteria met", "body": "<p><strong>Solution via XMLDom</strong></p>\n\n<p>You can use XMLDom and XPath to search in a so called NodeList for <code>&lt;man&gt;</code> tags not containing Dodge or Ford strings and check all siblings if they contain \"NA\" in order to delete them. The code below uses <em>late binding</em>. BTW, your xml in OP wasn't well formed (closing tag <code>&lt;/carStuf&gt;</code> instead of <code>&lt;/carStuff&gt;</code> - I added a little parse error routine to check this when loading. </p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub checkNA()\nDim xDoc        As Object    ' xml document\nDim noli, noli2 As Object    ' node list\nDim no, no2     As Object    ' node\nDim noMan       As Object    ' node &lt;man&gt; to check if no Dodge or Ford\nDim s           As String\nDim sFile       As String    ' xml file name\n\n  sFile = ThisWorkbook.Path &amp; \"\\xml\\na_test.xml\"  ' &lt;&lt;&lt; change to your xml file name\n\n' late binding xml\n  Set xDoc = CreateObject(\"MSXML2.DOMDocument.6.0\")\n  xDoc.async = False: xDoc.validateOnParse = False\n  xDoc.setProperty \"SelectionLanguage\", \"XPath\"\n' load xml\n  If xDoc.Load(sFile) Then\n    Debug.Print \"Loaded successfully\"\n  Else\n    Dim xPE        As Object    ' Set xPE = CreateObject(\"MSXML2.IXMLDOMParseError\")\n    Dim strErrText As String\n    Set xPE = xDoc.parseError\n    With xPE\n    strErrText = \"Load error \" &amp; .ErrorCode &amp; \" xml file \" &amp; vbCrLf &amp; _\n                 Replace(.URL, \"file:///\", \"\") &amp; vbCrLf &amp; vbCrLf &amp; _\n                 xPE.reason &amp; _\n                 \"Source Text: \" &amp; .srcText &amp; vbCrLf &amp; vbCrLf &amp; _\n                 \"Line No.:    \" &amp; .Line &amp; vbCrLf &amp; _\n                 \"Line Pos.: \" &amp; .linepos &amp; vbCrLf &amp; _\n                \"File Pos.:  \" &amp; .filepos &amp; vbCrLf &amp; vbCrLf\n    End With\n    MsgBox strErrText, vbExclamation\n    Set xPE = Nothing\n    Exit Sub\n  End If\n\n' check items\n  s = \"carExo/soldCar\"\n  Set noli = xDoc.DocumentElement.SelectNodes(s)\n  For Each no In noli\n      Set noMan = no.SelectSingleNode(\"man\")\n      If Not noMan Is Nothing Then\n         If InStr(\"Ford.Dodge\" &amp; \".\", noMan.Text &amp; \".\") = 0 Then\n            Debug.Print \"delete\", noMan.Text\n            ' delete all subtags containing \"NA\" as text\n            Set noli2 = no.SelectNodes(\"*\")\n            For Each no2 In noli2\n                If no2.Text = \"NA\" Then\n                   ' delete item\n                     Debug.Print , no2.nodename &amp; \"=\" &amp; no2.Text\n                     no2.ParentNode.RemoveChild no2\n                End If\n            Next no2\n\n         Else\n            ' Debug.Print \"keep\", noman.Text\n         End If\n      End If\n  Next no\n\n' save\n  ' Debug.Print xDoc.XML\n  xDoc.Save sFile      \n' close\n  Set xDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>Edit 12/29 - Addendum</strong></p>\n\n<p>I added a second workable version of the <code>' check items</code> part using some extra XPath. This alternative simply avoids two <code>If</code> conditions in normal code as it narrows the range of found nodes in the two node lists.</p>\n\n<pre><code>' check items\n  s = \"carExo/soldCar[man!='Ford'][man!='Dodge']\"   ' &lt;&lt; (1) added condition to XPath\n  Set noli = xDoc.DocumentElement.SelectNodes(s)\n  For Each no In noli\n      Set noMan = no.SelectSingleNode(\"man\")\n      If Not noMan Is Nothing Then\n         Debug.Print \"delete\", noMan.Text\n       ' delete all subtags containing \"NA\" as text\n         Set noli2 = no.SelectNodes(\"*[.='NA']\")    ' &lt;&lt; (2)added condition to XPath\n         For Each no2 In noli2\n           ' delete item\n             Debug.Print , no2.nodename &amp; \"=\" &amp; no2.Text\n             no2.ParentNode.RemoveChild no2\n         Next no2\n      End If\n  Next no\n</code></pre>\n\n<p><strong>Hint</strong></p>\n\n<p>Of course there are many streets leading to Rome, see @Parfait 's XSLT approach below.   </p>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1514452838, "post_id": 47998617, "comment_id": 82977638, "body": "Helpful as it shows the other way round via XSLT (and early binding) +"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1514471284, "post_id": 47998617, "comment_id": 82986637, "body": "Indeed. And even more XSLT is portable and not restricted to VBA. OP can use this same XSL script in other languages to transform original XML: Java, PHP, Python, even PowerShell and Bash! No <code>For</code> loops or <code>If...Then</code> logic needed."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1514408532, "creation_date": 1514408532, "answer_id": 47998617, "question_id": 47988000, "link": "https://stackoverflow.com/questions/47988000/find-multiple-lines-in-txt-xml-file-and-remove-if-criteria-met/47998617#47998617", "title": "Find multiple lines in TXT/xml file and remove if criteria met", "body": "<p>Simply use <a href=\"https://www.w3.org/Style/XSL/\" rel=\"nofollow noreferrer\">XSLT</a>, the special-purpose language designed to do exactly what you need in transforming original XML file by removing nodes according to various criteria.</p>\n\n<p>Specifically below runs the <a href=\"http://www.usingxml.com/Transforms/XslIdentity\" rel=\"nofollow noreferrer\">Identity Transform</a> to copy XML as is and then excludes the nodes by your criteria for model / year / man.</p>\n\n<p><strong>XSLT</strong> <em>(save as .xsl, a special .xml file)</em></p>\n\n<pre><code>&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"&gt;\n  &lt;xsl:output indent=\"yes\"/&gt;\n  &lt;xsl:strip-space elements=\"*\"/&gt;\n\n  &lt;xsl:template match=\"@*|node()\"&gt;\n    &lt;xsl:copy&gt;\n      &lt;xsl:apply-templates select=\"@*|node()\"/&gt;\n    &lt;/xsl:copy&gt;\n  &lt;/xsl:template&gt;\n\n  &lt;xsl:template match=\"soldCar[man != 'Ford' and man != 'Dodge']\"&gt;\n    &lt;xsl:copy&gt;\n        &lt;xsl:copy-of select=\"amount|lotNumber\"/&gt;\n        &lt;xsl:if test=\"model != 'NA'\"&gt;\n            &lt;xsl:copy-of select=\"model\"/&gt;\n        &lt;/xsl:if&gt;\n        &lt;xsl:if test=\"year != 'NA'\"&gt;\n            &lt;xsl:copy-of select=\"year\"/&gt;\n        &lt;/xsl:if&gt;\n        &lt;xsl:copy-of select=\"man\"/&gt;\n    &lt;/xsl:copy&gt;\n  &lt;/xsl:template&gt;\n\n&lt;/xsl:stylesheet&gt;\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub RunXSLT()\n    Dim strFile As String, strPath As String\n    ' REFERENCE MS XML, v6.0\n    Dim xmlDoc As New MSXML2.DOMDocument60, xslDoc As New MSXML2.DOMDocument60 \n    Dim newDoc As New MSXML2.DOMDocument60\n\n    ' LOAD XML SOURCE\n    xmlDoc.Load \"C:\\Path\\To\\Input.xml\"\n\n    ' LOAD XSL SOURCE\n    xslDoc.Load \"C:\\Path\\To\\XSLT\\Script.xsl\"\n\n   ' TRANSFORM SOURCE\n   xmlDoc.transformNodeToObject xslDoc, newDoc\n   newDoc.Save \"C:\\Path\\To\\Output.xml\"\n\n   ' RELEASE DOM OBJECTS\n    Set xmlDoc = Nothing: Set xslDoc = Nothing: Set newDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;CarStuff&gt;\n  &lt;fileName&gt;CarExpor201217.xml&lt;/fileName&gt;\n  &lt;numberCars&gt;5&lt;/numberCars&gt;\n  &lt;ref&gt;2017XY&lt;/ref&gt;\n  &lt;carExo id=\"CAR0001_01\"&gt;\n    &lt;dealVen id=\"CAR0001_02\"&gt;\n      &lt;name&gt;John&lt;/name&gt;\n      &lt;surname&gt;Smith&lt;/surname&gt;\n    &lt;/dealVen&gt;\n    &lt;soldCar&gt;\n      &lt;amount&gt;1811.10&lt;/amount&gt;\n      &lt;lotNumber&gt;1&lt;/lotNumber&gt;\n      &lt;man&gt;Acura&lt;/man&gt;\n    &lt;/soldCar&gt;\n  &lt;/carExo&gt;\n  &lt;carExo id=\"CAR0002_01\"&gt;\n    &lt;dealVen id=\"CAR0002_02\"&gt;\n      &lt;name&gt;John&lt;/name&gt;\n      &lt;surname&gt;Smith&lt;/surname&gt;\n    &lt;/dealVen&gt;\n    &lt;soldCar id=\"CAR0002_03\"&gt;\n      &lt;amount&gt;1811.10&lt;/amount&gt;\n      &lt;lotNumber&gt;1&lt;/lotNumber&gt;\n      &lt;year&gt;NA&lt;/year&gt;\n      &lt;model&gt;NA&lt;/model&gt;\n      &lt;man&gt;Ford&lt;/man&gt;\n    &lt;/soldCar&gt;\n  &lt;/carExo&gt;\n  &lt;carExo id=\"CAR0003_01\"&gt;\n    &lt;dealVen id=\"CAR0003_02\"&gt;\n      &lt;name&gt;John&lt;/name&gt;\n      &lt;surname&gt;Smith&lt;/surname&gt;\n    &lt;/dealVen&gt;\n    &lt;soldCar&gt;\n      &lt;amount&gt;1811.10&lt;/amount&gt;\n      &lt;lotNumber&gt;1&lt;/lotNumber&gt;\n      &lt;year&gt;1997&lt;/year&gt;\n      &lt;man&gt;Bugati&lt;/man&gt;\n    &lt;/soldCar&gt;\n  &lt;/carExo&gt;\n  &lt;carExo id=\"CAR0004_01\"&gt;\n    &lt;dealVen id=\"CAR0004_02\"&gt;\n      &lt;name&gt;John&lt;/name&gt;\n      &lt;surname&gt;Smith&lt;/surname&gt;\n    &lt;/dealVen&gt;\n    &lt;soldCar id=\"CAR0004_03\"&gt;\n      &lt;amount&gt;1811.10&lt;/amount&gt;\n      &lt;lotNumber&gt;1&lt;/lotNumber&gt;\n      &lt;year&gt;1997&lt;/year&gt;\n      &lt;model&gt;NA&lt;/model&gt;\n      &lt;man&gt;Dodge&lt;/man&gt;\n    &lt;/soldCar&gt;\n  &lt;/carExo&gt;\n  &lt;carExo id=\"CAR0005_01\"&gt;\n    &lt;dealVen id=\"CAR0005_02\"&gt;\n      &lt;name&gt;John&lt;/name&gt;\n      &lt;surname&gt;Smith&lt;/surname&gt;\n    &lt;/dealVen&gt;\n    &lt;soldCar id=\"CAR0005_03\"&gt;\n      &lt;amount&gt;1811.10&lt;/amount&gt;\n      &lt;lotNumber&gt;2&lt;/lotNumber&gt;\n      &lt;year&gt;NA&lt;/year&gt;\n      &lt;model&gt;Charger&lt;/model&gt;\n      &lt;man&gt;Dodge&lt;/man&gt;\n    &lt;/soldCar&gt;\n  &lt;/carExo&gt;\n  &lt;carExo id=\"CAR0005_01\"&gt;\n    &lt;dealVen id=\"CAR0005_02\"&gt;\n      &lt;name&gt;John&lt;/name&gt;\n      &lt;surname&gt;Smith&lt;/surname&gt;\n    &lt;/dealVen&gt;\n    &lt;soldCar&gt;\n      &lt;amount&gt;1811.10&lt;/amount&gt;\n      &lt;lotNumber&gt;3&lt;/lotNumber&gt;\n      &lt;model&gt;Dot&lt;/model&gt;\n      &lt;man&gt;Datsun&lt;/man&gt;\n    &lt;/soldCar&gt;\n  &lt;/carExo&gt;\n&lt;/CarStuff&gt;\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2716085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/774c8250bd9c56c9872c4aedcb23f1f0?s=128&d=identicon&r=PG&f=1", "display_name": "user99776644", "link": "https://stackoverflow.com/users/2716085/user99776644"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 47997884, "answer_count": 3, "score": 1, "last_activity_date": 1514923688, "creation_date": 1514359118, "last_edit_date": 1514923688, "question_id": 47988000, "link": "https://stackoverflow.com/questions/47988000/find-multiple-lines-in-txt-xml-file-and-remove-if-criteria-met", "title": "Find multiple lines in TXT/xml file and remove if criteria met", "body": "<p>Been wondering if it would be possible to make a simple script to check if multiple criteria are met and make necessary amendments to file.</p>\n\n<p>Moving on to example of what I have and what I want to achieve.</p>\n\n<p>I have an xml file with 4 lines - number, year, model and man.</p>\n\n<p>If <code>&lt;man&gt;</code> is Ford or Dodge, I want no amendments to be made. But if <code>&lt;man&gt;</code> is anything other than that, then I want to check if <code>&lt;year&gt;</code> or <code>&lt;model&gt;</code> are \"NA\" and remove the line with \"NA\".</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;CarStuff&gt;\n    &lt;fileName&gt;CarExpor201217.xml&lt;/fileName&gt;\n    &lt;numberCars&gt;5&lt;/numberCars&gt;\n    &lt;ref&gt;2017XY&lt;/ref&gt;\n    &lt;carExo id=\"CAR0001_01\"&gt;\n        &lt;dealVen id=\"CAR0001_02\"&gt;\n            &lt;name&gt;John&lt;/name&gt;\n            &lt;surname&gt;Smith&lt;/surname&gt;\n        &lt;/dealVen&gt;\n        &lt;soldCar id=\"CAR0001_03\"&gt;\n            &lt;amount&gt;1811.10&lt;/amount&gt;\n            &lt;lotNumber&gt;1&lt;/lotNumber&gt;\n            &lt;year&gt;NA&lt;/year&gt;             - Line must be removed\n            &lt;model&gt;NA&lt;/model&gt;           - Line must be removed\n            &lt;man&gt;Acura&lt;/man&gt;\n        &lt;/soldCar&gt;\n    &lt;/carExo&gt;\n    &lt;carExo id=\"CAR0002_01\"&gt;\n        &lt;dealVen id=\"CAR0002_02\"&gt;\n            &lt;name&gt;John&lt;/name&gt;\n            &lt;surname&gt;Smith&lt;/surname&gt;\n        &lt;/dealVen&gt;\n        &lt;soldCar id=\"CAR0002_03\"&gt;\n            &lt;amount&gt;1811.10&lt;/amount&gt;\n            &lt;lotNumber&gt;1&lt;/lotNumber&gt;\n            &lt;year&gt;NA&lt;/year&gt;         - Line must be kept\n            &lt;model&gt;NA&lt;/model&gt;       - Line must be kept\n            &lt;man&gt;Ford&lt;/man&gt;\n        &lt;/soldCar&gt;\n    &lt;/carExo&gt;\n    &lt;carExo id=\"CAR0003_01\"&gt;\n        &lt;dealVen id=\"CAR0003_02\"&gt;\n            &lt;name&gt;John&lt;/name&gt;\n            &lt;surname&gt;Smith&lt;/surname&gt;\n        &lt;/dealVen&gt;\n        &lt;soldCar id=\"CAR0003_03\"&gt;\n            &lt;amount&gt;1811.10&lt;/amount&gt;\n            &lt;lotNumber&gt;1&lt;/lotNumber&gt;\n            &lt;year&gt;1997&lt;/year&gt;       - Line must be kept\n            &lt;model&gt;NA&lt;/model&gt;       - Line must be removed\n            &lt;man&gt;Bugati&lt;/man&gt;\n        &lt;/soldCar&gt;\n    &lt;/carExo&gt;\n    &lt;carExo id=\"CAR0004_01\"&gt;\n        &lt;dealVen id=\"CAR0004_02\"&gt;\n            &lt;name&gt;John&lt;/name&gt;\n            &lt;surname&gt;Smith&lt;/surname&gt;\n        &lt;/dealVen&gt;\n        &lt;soldCar id=\"CAR0004_03\"&gt;\n            &lt;amount&gt;1811.10&lt;/amount&gt;\n            &lt;lotNumber&gt;1&lt;/lotNumber&gt;\n            &lt;year&gt;1997&lt;/year&gt;       - Line must be kept\n            &lt;model&gt;NA&lt;/model&gt;       - Line must be kept\n            &lt;man&gt;Dodge&lt;/man&gt;\n        &lt;/soldCar&gt;\n    &lt;/carExo&gt;\n    &lt;carExo id=\"CAR0005_01\"&gt;\n        &lt;dealVen id=\"CAR0005_02\"&gt;\n            &lt;name&gt;John&lt;/name&gt;\n            &lt;surname&gt;Smith&lt;/surname&gt;\n        &lt;/dealVen&gt;\n        &lt;soldCar id=\"CAR0005_03\"&gt;\n            &lt;amount&gt;1811.10&lt;/amount&gt;\n            &lt;lotNumber&gt;2&lt;/lotNumber&gt;\n            &lt;year&gt;NA&lt;/year&gt;         - Line must be kept\n            &lt;model&gt;Charger&lt;/model&gt;  - Line must be kept\n            &lt;man&gt;Dodge&lt;/man&gt;\n        &lt;/soldCar&gt;\n    &lt;/carExo&gt;\n    &lt;carExo id=\"CAR0005_01\"&gt;\n        &lt;dealVen id=\"CAR0005_02\"&gt;\n            &lt;name&gt;John&lt;/name&gt;\n            &lt;surname&gt;Smith&lt;/surname&gt;\n        &lt;/dealVen&gt;\n        &lt;soldCar id=\"CAR0005_03\"&gt;\n            &lt;amount&gt;1811.10&lt;/amount&gt;\n            &lt;lotNumber&gt;3&lt;/lotNumber&gt;\n            &lt;year&gt;NA&lt;/year&gt;         - Line must be removed\n            &lt;model&gt;Dot&lt;/model&gt;      - Line must be kept\n            &lt;man&gt;Datsun&lt;/man&gt;\n        &lt;/soldCar&gt;\n    &lt;/carExo&gt;\n&lt;/CarStuff&gt;\n</code></pre>\n\n<p>Grateful for all the comments and ideas. </p>\n"}, {"tags": ["vba", "excel", "web-scraping", "click"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514360934, "post_id": 47987082, "comment_id": 82945247, "body": "I don&#39;t know if this is relevant <a href=\"https://stackoverflow.com/questions/27741188/vba-to-change-dropdown-value-in-internet-explorer\">vba-to-change-dropdown-value-in-internet-explorer</a>"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514363962, "post_id": 47987082, "comment_id": 82946361, "body": "Thanks QHarr for your suggestion. The solution you talk about is a working one and it does work here as well. I&#39;ve tested it. However, the thing is I expect to learn about how clicking method works in IE. Moreover, this type of solution breaks most of the cases. I have come across lots of webpages in which, even if the value of something is made to change within that page the url stays the same. Thanks again for the link."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514364096, "post_id": 47987082, "comment_id": 82946418, "body": "I will be watching as keen to see how this is resolved. I had a play for a while and still wasn&#39;t able to get the follow through on the link but i am not that familiar with HTML manipulation via VBA."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 1, "creation_date": 1514930152, "post_id": 47987082, "comment_id": 83110326, "body": "Looks like you figured it out to me.  I was going to say that you go straight for the HTML manipulation, but most sites have protection against over writing, unless its server side, that is how hacking happens."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1514977599, "post_id": 47987082, "comment_id": 83125842, "body": "Have you seen this: <a href=\"https://forums.asp.net/t/1470345.aspx?How+to+fire+listbox+s+ONCHANGE+event+programmatically\" rel=\"nofollow noreferrer\">How to fire listbox&#39;s ONCHANGE event programmatically</a>?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514979663, "post_id": 47987082, "comment_id": 83126974, "body": "No I haven&#39;t yet. Gonna track this link. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514654889, "post_id": 48036146, "comment_id": 83042484, "body": "Thanks A STEFANI, for your offer. Basically, I&#39;m not interested in their data at all. I can simply do that using selenium in combination with vba or python. In fact, to reach the data it is not necessary to initiate a click. If i scrape the league names and concatenate each league with the base url then I can reach the data. All I wanna learn is how to perform a click using IE and select any item from the dropdown option. That&#39;s it."}, {"owner": {"reputation": 6426, "user_id": 4471715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af5026f58744339680af12b163aad259?s=128&d=identicon&r=PG&f=1", "display_name": "A STEFANI", "link": "https://stackoverflow.com/users/4471715/a-stefani"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514745289, "post_id": 48036146, "comment_id": 83060809, "body": "For click issue, did you try &quot;mousedown&quot; then &quot;mouseup&quot; event instead of the &quot;click&quot; event ?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514750643, "post_id": 48036146, "comment_id": 83061863, "body": "Thanks @A STEFANI for shedding some light. No, I didn&#39;t try that. I&#39;m not familiar with that. Could you please guide me on that."}], "tags": [], "owner": {"reputation": 6426, "user_id": 4471715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af5026f58744339680af12b163aad259?s=128&d=identicon&r=PG&f=1", "display_name": "A STEFANI", "link": "https://stackoverflow.com/users/4471715/a-stefani"}, "is_accepted": false, "score": 1, "last_activity_date": 1612385609, "last_edit_date": 1612385609, "creation_date": 1514654138, "answer_id": 48036146, "question_id": 47987082, "link": "https://stackoverflow.com/questions/47987082/cant-find-any-way-to-click-on-the-dropdown-menu-to-choose-any-preferable-item/48036146#48036146", "title": "Can&#39;t find any way to click on the dropdown menu to choose any preferable item", "body": "<p>Does GUI web-browser is absolutely required for webscraping ? Let me doubt...</p>\n<p>If you try to debug the <a href=\"https://ubet.com/sports/soccer/nexttoplay\" rel=\"nofollow noreferrer\">target page</a> you will see that the data you are looking for is JSON type and is resulting from an XHR request.</p>\n<p>So assuming that you got all required cookies to sent an XHR request to the target website, you may directly get the JSON data (from curl) instead of browsing the website ...</p>\n<hr />\n<p>Apparently each league have an unique ID (50 for england, 76 for Australia, etc...)</p>\n<p>So in order to get access to the <code>Australia A-League</code> data , you have to send a GET request :</p>\n<p><a href=\"https://ubet.com/api/sportsViewData/nexttoplay/false/3/76\" rel=\"nofollow noreferrer\">https://ubet.com/api/sportsViewData/nexttoplay/false/3/76</a> <code>Australia A-League</code></p>\n<hr />\n<p>In this resulting JSON file, you will get an <code>Offers</code> key, which contain a dict which contain all offers and contain also all required data I expect that you  are looking to  scrap....</p>\n<p>Please see an offer example :</p>\n<pre><code>LongDisplayName &quot;Central Coast Mariners&quot;\nDisplayOrder    1\nOfferOrder  1\nHAD 1\nPlaceDeduction  0\nShowOfferBasedDynamicOffer  false\nOfferId 308151\nOfferName   &quot;Central Coast&quot;\nDisplayHAD  1\nWinReturn   1.85\nPlaceReturn 0\nDynamicOffer    null\nStatus  &quot;o&quot;\n</code></pre>\n<p>Regards</p>\n"}, {"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1515116824, "creation_date": 1515116824, "answer_id": 48106115, "question_id": 47987082, "link": "https://stackoverflow.com/questions/47987082/cant-find-any-way-to-click-on-the-dropdown-menu-to-choose-any-preferable-item/48106115#48106115", "title": "Can&#39;t find any way to click on the dropdown menu to choose any preferable item", "body": "<p>Navigating to <code>https://ubet.com/sports/soccer/england-premier-league</code> gets you that web page.  </p>\n\n<p>I know that is a short answer.  I have been looking at this for some time (even though the answer is brief) and it is an Angular.js application but I cannot yet figure out how it works.  Somehow one needs to call <code>vm.selectedKeyChange</code> manually.  I'm working on it.</p>\n"}, {"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1515226156, "post_id": 48125401, "comment_id": 83227588, "body": "You are the vba giant @Robin Mackenzie. You just made me dumbfounded with your revolutionary script. Thankssssssssssssssss a trillion."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515228002, "post_id": 48125401, "comment_id": 83227939, "body": "How does  Set selectElement = divElement(0).getElementsByTagName(&quot;select&quot;)(0)  access the &quot;Australia A-League&quot;  please? I can&#39;t test on this machine but it &quot;feels&quot; like it should be accessing the UK section?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1515229576, "post_id": 48125401, "comment_id": 83228291, "body": "@Robin Mackenzie, a simple question to get the clarity on one thing: in your script you used <code>optionElement.localName</code> within the for loop. Firstly I thought <code>.localName</code> was an attribute taken from the elements from that webpage but I suppose I&#39;m wrong. What is it actually? Thanks again."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1515235802, "post_id": 48125401, "comment_id": 83229798, "body": "@RobinMackenzie Thank you very much. I had been monitoring this question for the solutions given. Very helpful for stuff i am looking at at present. Much obliged for the extra detail."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1515236093, "post_id": 48125401, "comment_id": 83229862, "body": "You are just impossible @RobinMackenzie. You made my day."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1515235664, "last_edit_date": 1515235664, "creation_date": 1515225540, "answer_id": 48125401, "question_id": 47987082, "link": "https://stackoverflow.com/questions/47987082/cant-find-any-way-to-click-on-the-dropdown-menu-to-choose-any-preferable-item/48125401#48125401", "title": "Can&#39;t find any way to click on the dropdown menu to choose any preferable item", "body": "<p>This is do-able as a small extension of your existing code. </p>\n\n<p>I avoid using <code>querySelector</code> and <code>querySelectorAll</code> because they are flakey (per your other bounty <a href=\"https://stackoverflow.com/questions/47993064/my-scraper-throws-errors-instead-of-quitting-the-browser-when-everything-is-done\">question</a>). </p>\n\n<p>I didn't use <code>Focus</code> and used <code>Click</code> instead as I'm guessing this executes whatever required script runs in the background. </p>\n\n<p>You can then either manually select the correct index (using <code>selectedIndex</code>) or search the child elements for the <code>&lt;label&gt;</code> value you need:</p>\n\n<p>Working code:</p>\n\n<pre><code>Option Explicit\n\nSub Soccer_Dropdown()\n\n    Dim IE As New InternetExplorer, html As HTMLDocument\n    Dim divElement As Object, selectElement As Object, optionElement As Object\n    Dim optionIndex As Long\n    Dim targetOption  As String\n\n    ' load page\n    With IE\n        .Visible = True\n        .navigate \"https://ubet.com/sports/soccer/nexttoplay\"\n        Do Until .readyState = 4: DoEvents: Loop\n        Set html = .document\n    End With\n\n    ' let page do its thing\n    Application.Wait Now + TimeValue(\"00:00:05\")\n\n    ' get the div\n    Set divElement = html.getElementsByClassName(\"ubet-fixed-price-navigator-selector-league\")\n\n    ' get the select in the div\n    Set selectElement = divElement(0).getElementsByTagName(\"select\")(0)\n\n    ' click it to activate any script to populate select\n    selectElement.Click\n\n    ' select by index - this works but showing the other technique below\n    'selectElement.selectedIndex = 9\n\n    ' select by iterating the options\n    optionIndex = 0\n    targetOption = \"Australia A-League\"\n    For Each optionElement In selectElement\n        If LCase(optionElement.localName) = \"option\" And optionElement.Label = targetOption Then\n            selectElement.selectedIndex = optionIndex\n            Debug.Print targetOption &amp; \" at index \" &amp; optionIndex\n            Exit For\n        End If\n        optionIndex = optionIndex + 1\n    Next\n\n    ' quit IE\n    'IE.Quit\n\nEnd Sub\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>@QHarr - per your question <em>How does Set selectElement = divElement(0).getElementsByTagName(\"select\")(0) access the \"Australia A-League\"?</em></p>\n\n<p>The div containing the dropdown has class <code>ubet-fixed-price-navigator-selector-league</code> and that <code>&lt;div&gt;</code> has a single <code>&lt;select&gt;</code> element - which is the dropdown. Because <code>getElementsByTagName</code> returns a set of HTML elements, we are just saying to return the <em>first</em> <code>&lt;select&gt;</code> element within the <code>&lt;div&gt;</code>. The 0 index doesn't refer to the list of things in the dropdown (i.e. the <code>&lt;option&gt;</code>s). See the HTML:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IGyAz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IGyAz.png\" alt=\"enter image description here\"></a></p>\n\n<p>A bit further down the HTML you can see the <code>&lt;option&gt;</code> elements (grouped in <code>&lt;optgroup&gt;</code>s) where you can access the dropdown values:</p>\n\n<p><a href=\"https://i.stack.imgur.com/l2AYs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l2AYs.png\" alt=\"enter image description here\"></a></p>\n\n<p>@Topto - good question - the <code>localName</code> property, along with a few others for the <code>optionElement</code> variable was one that I could see in the Locals window as having a value of <code>option</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/POwvZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/POwvZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>I guess you could use <code>nodeName</code> just as well as <code>localName</code>. There is <code>tagName</code> as well, which I suppose is the most obvious sounding:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZYfLP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZYfLP.png\" alt=\"enter image description here\"></a></p>\n\n<p>HTH</p>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1612385609, "creation_date": 1514354422, "last_edit_date": 1531164843, "question_id": 47987082, "link": "https://stackoverflow.com/questions/47987082/cant-find-any-way-to-click-on-the-dropdown-menu-to-choose-any-preferable-item", "title": "Can&#39;t find any way to click on the dropdown menu to choose any preferable item", "body": "<p>I've written some code in vba using IE to choose <code>England Premier League</code> from a dropdown which is visible as <code>Next To Play</code> at this moment. My target is to click on that dropdown link captioned as <code>Next To Play</code> and then choose the <code>Australia A-League</code> from option. However, I can't find any way to click on that very link. If I run my below script the way it is, it neither works nor throws any error and finally quits the browser.</p>\n\n<p>Link to that webpage: <a href=\"https://ubet.com/sports/soccer/nexttoplay\" rel=\"noreferrer\">URL</a></p>\n\n<p>Here is what I've tried so far:</p>\n\n<pre><code>Sub soccer()\n    Dim IE As New InternetExplorer, html As HTMLDocument\n    Dim post As Object\n\n    With IE\n        .Visible = True\n        .navigate \"replace_with_above_link\"\n        Do Until .readyState = READYSTATE_COMPLETE: Loop\n        Set html = .document\n    End With\n\n    Application.Wait Now + TimeValue(\"00:00:05\")\n    For Each post In html.getElementsByTagName(\"option\")\n''        If InStr(post.innerText, \"Next To Play\") &gt; 0 Then MsgBox post.innerText: Exit For  ''checked to see if I'm on the right place\n        If InStr(post.innerText, \"Next To Play\") &gt; 0 Then post.Click: Exit For\n    Next post\n\n   IE.Quit\nEnd Sub\n</code></pre>\n\n<p>This is the partial picture of the webpage where I wanna trigger a click.</p>\n\n<p><a href=\"https://i.stack.imgur.com/C97nS.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/C97nS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to be able to click on that link and choose any option from there.</p>\n\n<p>It seems I'm close to the solution. My below script can select the portion I wanna perform a click:</p>\n\n<pre><code>Sub Soccer_Dropdown()\n\n    Dim IE As New InternetExplorer, html As HTMLDocument\n    Dim post As Object\n\n    With IE\n        .Visible = True\n        .navigate \"https://ubet.com/sports/soccer/nexttoplay\"\n        Do Until .readyState = 4: DoEvents: Loop\n        Set html = .document\n    End With\n\n    Application.Wait Now + TimeValue(\"00:00:05\")\n    Set post = html.querySelector(\".ubet-fixed-price-navigator-selector-league select\")\n    post.Focus\n\n'   IE.Quit\nEnd Sub\n</code></pre>\n\n<p>Picture of the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IGAjh.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/IGAjh.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>However, when it comes to perform a click I can't do anymore.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514354370, "post_id": 47986965, "comment_id": 82942867, "body": "How is the date displaying, and how do you need it to display?"}, {"owner": {"reputation": 1, "user_id": 9094064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348930fba93033b5e12c7442fec8b25a?s=128&d=identicon&r=PG&f=1", "display_name": "wang", "link": "https://stackoverflow.com/users/9094064/wang"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514357555, "post_id": 47986965, "comment_id": 82943975, "body": "In my CSV files, the actual date is 02/01/1987, when the CSVs is imported, the date shows 01/02/1987"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514357669, "post_id": 47986965, "comment_id": 82944027, "body": "...and that date is also the name of the folder?  I&#39;m trying to figure out <i>where</i> you need to convert the date.  And is 01 the month or the day?  A better example is: do you need to display &quot;12/13/1987&quot; or &quot;13/12/1987&quot;?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1514370314, "post_id": 47986965, "comment_id": 82949139, "body": "I think the problem is that when the data within the csv is read in, Excel insists in interpreting the format d/m/y as literally anything else for any date where that interpretation is possible. So it reads 1/12/17 as 12th January but 31/12/17 as 17th Dec 1931. I&#39;ve had this problem and ended up importing data using FSO.TextStreams, but I&#39;ve since found this <a href=\"https://superuser.com/questions/307496/how-can-i-set-excel-to-always-import-all-columns-of-csv-files-as-text\" title=\"how can i set excel to always import all columns of csv files as text\">superuser.com/questions/307496/&hellip;</a>  which may help"}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514357969, "post_id": 47987744, "comment_id": 82944155, "body": "I&#39;m not sure the OP is trying to display the date different, I think he needs a different value for use with a filename (in which case the number format won&#39;t help)."}], "tags": [], "owner": {"reputation": 424, "user_id": 4780023, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hGayi1otdN8/AAAAAAAAAAI/AAAAAAAAAmI/vdlw159t9ik/photo.jpg?sz=128", "display_name": "Chris Meurer", "link": "https://stackoverflow.com/users/4780023/chris-meurer"}, "is_accepted": false, "score": 0, "last_activity_date": 1514357908, "creation_date": 1514357908, "answer_id": 47987744, "question_id": 47986965, "link": "https://stackoverflow.com/questions/47986965/overcome-excel-vba-americanisation-issues/47987744#47987744", "title": "Overcome Excel VBA Americanisation Issues?", "body": "<p>You need to set the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-numberformat-property-excel\" rel=\"nofollow noreferrer\"><code>Range.NumberFormat</code></a> property to display the date how you want.</p>\n\n<p>For example, if your dates are in column \"D\" then something like:</p>\n\n<pre><code>wb.Sheets(i).Range(\"D:D\").NumberFormat = \"yyyy-mm-dd\"\n</code></pre>\n\n<p>or you may also use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-numberformatlocal-property-excel\" rel=\"nofollow noreferrer\"><code>Range.NumberFormatLocal</code></a> if that gives the desired result.</p>\n"}, {"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1514358936, "creation_date": 1514358936, "answer_id": 47987959, "question_id": 47986965, "link": "https://stackoverflow.com/questions/47986965/overcome-excel-vba-americanisation-issues/47987959#47987959", "title": "Overcome Excel VBA Americanisation Issues?", "body": "<p>To <em>display</em> a date different on the worksheet, you can change the number format by selecting the cell or cells, and changing the <strong>cell format</strong> by pressing <kbd>Ctrl</kbd>+<kbd>1</kbd>.  Select a <code>Date</code> format that works for you or else choose <code>Custom</code> to enter a format like <code>M/D/YYYY</code> or <code>D/M/YYYY</code> as required.  See: <a href=\"https://support.office.com/en-us/article/Format-a-date-the-way-you-want-8e10019e-d5d8-47a1-ba95-db95123d273e\" rel=\"nofollow noreferrer\">Format a date the way you want</a></p>\n\n<p>To convert the date to <strong>formatted text on a worksheet</strong>, you can use the <a href=\"https://support.office.com/en-us/article/TEXT-function-20d5ac4d-7b94-49fd-bb38-93d29371225c\" rel=\"nofollow noreferrer\"><code>TEXT</code> function</a>.  For example (using cell A1):</p>\n\n<pre><code>=TEXT(A1, \"M/D/YYYY\")\n</code></pre>\n\n<p>To use the date as a <strong>formatted string in VBA</strong>, you can use the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\"><code>FORMAT</code> function</a>.  For example (using cell A1):</p>\n\n<pre><code>Format(Range(\"A1\"), \"M/D/YYYY\")\n</code></pre>\n\n<p>If you need to programmatically change the cell's formatting, you can use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-numberformat-property-excel\" rel=\"nofollow noreferrer\"><code>NumberFormat</code> property</a>:</p>\n\n<pre><code>.NumberFormat = \"M/D/YYYY\"\n</code></pre>\n\n<p>If your worksheet will be used in multiple locales, the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-numberformatlocal-property-excel\" rel=\"nofollow noreferrer\"><code>NumberFormatLocal</code> property</a> might be better:</p>\n\n<pre><code>.NumberFormatLocal\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9094064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348930fba93033b5e12c7442fec8b25a?s=128&d=identicon&r=PG&f=1", "display_name": "wang", "link": "https://stackoverflow.com/users/9094064/wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514358936, "creation_date": 1514353612, "last_edit_date": 1531164843, "question_id": 47986965, "link": "https://stackoverflow.com/questions/47986965/overcome-excel-vba-americanisation-issues", "title": "Overcome Excel VBA Americanisation Issues?", "body": "<p>I have written a Excel VB Code to enable the user to choose a folder which contains CSVs file, and the macro will insert all the CSV files into the workbook with each worksheet named as the filename of the CSV files. However, there is a date americanisation issues on the date in the worksheet.Some websites suggest that Local:= True can help to correct this issue, but as I am new to Excel VBA, i don't know where to add in this code.Or anyone here have a better suggestion which can help me on this matter? Thank You</p>\n\n<pre><code>Set wb = ActiveWorkbook\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    If .Show Then myDir = .SelectedItems(1) &amp; \"\\\"\nEnd With\nIf myDir = \"\" Then Exit Sub\nApplication.ScreenUpdating = False\nfn = Dir(myDir &amp; \"*.csv\")\nDo While fn &lt;&gt; \"\"\n    With Workbooks.Open(myDir &amp; fn)\n        .Sheets(1).Copy after:=wb.Sheets(wb.Sheets.Count)\n        .Close False\n    End With\n    fn = Dir\nLoop\nMsgBox (\"All data from your selected source file are completed extracted.\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1243, "user_id": 4551257, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/iOjjG.jpg?s=128&g=1", "display_name": "Griva", "link": "https://stackoverflow.com/users/4551257/griva"}, "edited": false, "score": 0, "creation_date": 1514349265, "post_id": 47986349, "comment_id": 82941579, "body": "Would be better if you use just code instead of images. Image can be deleted and question-answer can become useless for community."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514349986, "post_id": 47986349, "comment_id": 82941743, "body": "Do cells <code>A2</code> and <code>B2</code>contain filenames?  And nothing except for filenames in columns A &amp; B below row 2?"}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "edited": false, "score": 0, "creation_date": 1514350786, "post_id": 47986349, "comment_id": 82941925, "body": "Yes A2 and B2 have filenames. No, there are multiple filenames below A2 and B2"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514351485, "post_id": 47986349, "comment_id": 82942088, "body": "Do you have update access to the directory?  (Try renaming one of the files manually using Windows Explorer and see if it lets you.)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1514383800, "post_id": 47986349, "comment_id": 82955331, "body": "Rather than use <code>Set srcrng = Range(&quot;A2&quot;, ActiveSheet.Range(&quot;A2&quot;).End(xlDown))</code> which will return all rows if there&#39;s only a value in A2, use <code>Set srcrng = Range(&quot;A2&quot;, ActiveSheet.Cells(Rows.Count, 1).End(xlUp))</code> instead.  I think your main problem is as @HarassedDad says in his answer though (which could be linked to <code>Set srcrng</code> problem finding empty cells)."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1514373233, "creation_date": 1514373233, "answer_id": 47991172, "question_id": 47986349, "link": "https://stackoverflow.com/questions/47986349/i-am-getting-a-path-file-access-error-in-my-vba-code-why-is-that-so/47991172#47991172", "title": "I am getting a Path/File access error in my VBA code? Why is that so?", "body": "<p>You don't check for the existence of the file before you try to rename it. Try</p>\n\n<pre><code> If Dir(strpath &amp; cell.value) = \"\" then\n\n else\n     Name strPath &amp; cell.Value As strPath &amp; cell.Offset(0, 1).Value \nEnd if\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1485, "favorite_count": 0, "accepted_answer_id": 47991172, "answer_count": 1, "score": 0, "last_activity_date": 1514373233, "creation_date": 1514349076, "last_edit_date": 1531164843, "question_id": 47986349, "link": "https://stackoverflow.com/questions/47986349/i-am-getting-a-path-file-access-error-in-my-vba-code-why-is-that-so", "title": "I am getting a Path/File access error in my VBA code? Why is that so?", "body": "<p>I am getting a</p>\n\n<blockquote>\n  <p>Run-time error '75':<br>\n  Path/File access error</p>\n</blockquote>\n\n<p>in my VBA code and I am not sure about the reason behind that error.   </p>\n\n<p>When I debugged the code I saw this particular line as the error line:</p>\n\n<pre><code>Name strPath &amp; cell.Value As strPath &amp; cell.Offset(0, 1).Value\n</code></pre>\n\n<p>Full code is:</p>\n\n<pre><code>Sub RenameFiles()\n\n    Dim strPath As String\n    strPath = \"C:\\Users\\Satish Muppidi\\Downloads\\\"\n\n    Dim srcrng As Range\n    Set srcrng = Range(\"A2\", ActiveSheet.Range(\"A2\").End(xlDown))\n\n        For Each cell In srcrng\n\n            Name strPath &amp; cell.Value As strPath &amp; cell.Offset(0, 1).Value\n\n        Next cell\n\n    Range(\"A1\").Select\n\n    End Sub\n</code></pre>\n\n<p>Please help me in updating the code.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1514341056, "post_id": 47985541, "comment_id": 82940096, "body": "Well that depends on how the users use it. For all I know they may jump around here and there so I gotta be prepared for that."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1514341752, "post_id": 47985541, "comment_id": 82940195, "body": "These formulas require that the dates be &quot;true&quot; dates (meaning numeric, not strings). They will throw an error if there was no second-largest, such as Project No. 03 in the question&#39;s example."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1514342341, "post_id": 47985541, "comment_id": 82940274, "body": "@hjh93 - so an older date <i>could</i> be entered after a newer one, correct?  Also to address Variatus&#39;s concern, I assume the dates are stored normally, not as text, correct?  (As in, do the example formulas I gave work so far?)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514342899, "post_id": 47985541, "comment_id": 82940371, "body": "see my above <a href=\"https://stackoverflow.com/a/47985541/8112776\">edit</a> (in my answer) to clarify what you need."}, {"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1514344976, "post_id": 47985541, "comment_id": 82940798, "body": "2nd to most recent."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514345169, "post_id": 47985541, "comment_id": 82940831, "body": "Perfect, in that case the formula I gave above will work.  (and you can forget what I said about the data having to be in ascending order.)"}, {"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1514355827, "post_id": 47985541, "comment_id": 82943373, "body": "Ok. I tried and I works. But say I want to put it in VBA. How exactly do I do it? Just copy the array into VBA?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1514357535, "post_id": 47985541, "comment_id": 82943966, "body": "@hjh93 - What do you mean, &quot;you want to put it in VBA&quot;, and why?  Either way, it&#39;s more than &quot;just copying&quot; it...  If it works fine, why the need to complicate it?"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 2, "last_activity_date": 1514345105, "last_edit_date": 1514345105, "creation_date": 1514340738, "answer_id": 47985541, "question_id": 47985325, "link": "https://stackoverflow.com/questions/47985325/excel-vba-vlookup-second-most-recent-data-for-a-value/47985541#47985541", "title": "Excel VBA Vlookup second most recent data for a value", "body": "<p>Instead of seeking the <em>\"second-to-last match\"</em> we could instead look for the <em>\"second highest match\"</em>, in which case an <strong>array formula</strong> using the <code>LARGE</code> function will return what you need.</p>\n\n<p>If your example data is arranged in <code>A2:C6</code> like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Y2XP9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y2XP9.png\" alt=\"sample data\"></a></p>\n\n<p>then you could use this array formula to return the \"2nd highest date\" where the <code>ID = A1</code> :</p>\n\n<pre><code>=LARGE(IF($B$2:$B$6=\"A1\",$C$2:$C$6),2)\n</code></pre>\n\n<p>Your question said you need to look for <code>ID = 01</code> but those are two different columns.  If you instead need to look for `Project No = 01\" then your array formula would be :</p>\n\n<pre><code>=LARGE(IF($A$2:$A$6=\"01\",$C$2:$C$6),2)\n</code></pre>\n\n<p>...that's assuming that <code>Project No</code> is stored as <strong>text</strong>.  If it's actually a number (formatted with a leading zero) then you would use :</p>\n\n<pre><code>=LARGE(IF($A$2:$A$6=1,$C$2:$C$6),2).\n</code></pre>\n\n<hr>\n\n<p><strong>\u2606</strong> Remember that <strong><em>since these are all ARRAY FORMULAS you need to specify that</em></strong> when entering the formulas; instead of using <kbd>ENTER</kbd>, finish entering the formula with:</p>\n\n<blockquote>\n  <p><strong><kbd>CTRL</kbd> + <kbd>SHIFT</kbd> + <kbd>ENTER</kbd></strong></p>\n</blockquote>\n\n<hr>\n\n<h2>EDIT:</h2>\n\n<p>To clarify whether this method will work, if the data is arranged like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5okTz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5okTz.png\" alt=\"example2\"></a></p>\n\n<p>...which value should be returned for <code>ID = A1</code> (or <code>Project No = 1</code>)?</p>\n\n<ul>\n<li><p>second-to-<strong>last</strong>  (2016-12-17)</p></li>\n<li><p>second-most-<strong>recent</strong>?  (2014-12-17)</p></li>\n</ul>\n"}], "owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 47985541, "answer_count": 1, "score": 1, "last_activity_date": 1514351797, "creation_date": 1514338042, "last_edit_date": 1514351797, "question_id": 47985325, "link": "https://stackoverflow.com/questions/47985325/excel-vba-vlookup-second-most-recent-data-for-a-value", "title": "Excel VBA Vlookup second most recent data for a value", "body": "<p>Currently working on an Excel worksheet with Vlookup. My reference table in Sheet 1 has a list of data along with its date, its name defined as ProjectEntry. For example:</p>\n\n<pre><code>-----------------------------------\n| Project No | ID |  Service Date |\n|------------|----|---------------|\n|     01     | A1 |   10/12/17    |\n|     02     | B2 |   13/12/17    |\n|     01     | A1 |   14/12/17    |\n|     03     | C3 |   14/12/17    |\n|     01     | A1 |   16/12/17    |\n-----------------------------------\n</code></pre>\n\n<p>Now my Vlookup in Sheet2 wants to lookup the second most recent date based on the ID to get the last service date. For example when I select ID = 01 , Vlookup = 14/12/17.</p>\n\n<p>For the Vlookup formula I managed to get the first entered Service Date (10/12/17):</p>\n\n<pre><code>=VLOOKUP(I7,ProjectEntry[[#All],[ID]:[Service Date]],2,FALSE) \n</code></pre>\n\n<p>But I'm not sure how to get the 2nd most recent date for A1. What should I add to the formula to make it work?</p>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1514338320, "creation_date": 1514338320, "answer_id": 47985344, "question_id": 47985295, "link": "https://stackoverflow.com/questions/47985295/embed-chart-template-into-macro/47985344#47985344", "title": "Embed Chart Template into Macro", "body": "<p>Perhaps modify <code>Sub BuildChart</code> like this:</p>\n\n<pre><code>Private Sub BuildChart(ByRef ws As Worksheet, ByRef unionRng As Range)\n\n    With ws.Shapes.AddChart2(240, xlXYScatter).Chart\n        .SetSourceData Source:=unionRng\n        .ApplyChartTemplate ( _\n            \"C:\\Users\\maaro\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\1.crtx\")\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514403378, "creation_date": 1514337644, "last_edit_date": 1514403378, "question_id": 47985295, "link": "https://stackoverflow.com/questions/47985295/embed-chart-template-into-macro", "title": "Embed Chart Template into Macro", "body": "<p>I am trying to embed applying a chart template into a macro and require help. \nI have this code for the Macro that I am using to create scatter plots:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n\n' Keyboard Shortcut: Ctrl+Shift+X\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Worksheets(\"Sheet1\") 'change as appropriate\n\nApplication.ScreenUpdating = False\n\nBuildChart ws, SelectRanges(ws)\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n Private Function SelectRanges(ByRef ws As Worksheet) As Range\n\n Dim rngX As Range\n Dim rngY As Range\n\n ws.Activate\n\n Application.DisplayAlerts = False\n\n On Error Resume Next\n\n Set rngX = Application.InputBox(\"Please select X values. One column.\", \n Type:=8)\n\n If rngX Is Nothing Then GoTo InvalidSelection\n\n Set rngY = Application.InputBox(\"Please select Y values. One column.\", \n Type:=8)\n\n If rngY Is Nothing Then GoTo InvalidSelection\n\n If rngX.Columns.Count &gt; 1 Or rngY.Columns.Count &gt; 1 Then GoTo \n InvalidSelection\n\n On Error GoTo 0\n\n Set SelectRanges = Union(rngX, rngY)\n Application.DisplayAlerts = True\n Exit Function\n\n InvalidSelection:\nIf rngX Is Nothing Or rngY Is Nothing Then\n    MsgBox \"Please ensure you have selected both X and Y ranges.\"\nElseIf rngX.Rows.Count &lt;&gt; rngX.Rows.Count Then\n     MsgBox \"Please ensure the same number of rows are selected for X and Y \nranges\"\nElseIf rngX.Columns.Count &gt; 1 Or rngY.Columns.Count &gt; 1 Then\n    MsgBox \"Please ensure X range has only one column and Y range has only \none column\"\nElse\n   MsgBox \"Unspecified\"\nEnd If\n\nApplication.DisplayAlerts = True\nEnd\n\nEnd Function\n\nPrivate Sub BuildChart(ByRef ws As Worksheet, ByRef unionRng As Range)\n\n With ws.Shapes.AddChart2(240, xlXYScatter).Chart\n    .SetSourceData Source:=unionRng\nEnd With\n\nActiveChart.ApplyChartTemplate ( _\n    \"C:\\Users\\maaro\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\1.crtx\")\n\nEnd Sub\n</code></pre>\n\n<p>And would like to embed this code below into the above code so that it applies the template to the chart I create whenever I run this Macro. My initial guess would be to put it underneath \"Private Sub BuildCharts\". How would I be able to do this? Thank you. </p>\n\n<pre><code>       ActiveChart.ApplyChartTemplate ( _\n    \"C:\\Users\\XXXXX\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\1.crtx\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1514335909, "post_id": 47985143, "comment_id": 82939303, "body": "What&#39;s the name of your <i>currently opened workbook</i>? (And nit-picking: A .csv file is  not a spreadsheet; it&#39;s a text file of comma-separated values (AKA a <i>CSV file</i>).)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514338166, "post_id": 47985143, "comment_id": 82939637, "body": "Reboot your computer and try again.  Also, add a line <code>Debug.Print ThisWorkbook.Path</code> to make sure it&#39;s returning the proper path.  (For example, it will be <i>blank</i> if your workbook hasn&#39;t been saved.)  At first glance I think your syntax is a little off too, see <a href=\"https://stackoverflow.com/a/12259729/8112776\">this detailed example</a> of reading csv with VBA."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514350793, "post_id": 47985143, "comment_id": 82941928, "body": "If it&#39;s an error 55, it probably means that you already have a file open with a file handle of <code>#1</code>.  (Not necessarily the <b>same</b> file, just any file.)  Try entering <code>Close</code> (to close all open files) in the Immediate Window, and then run your code again"}], "answers": [{"tags": [], "owner": {"reputation": 389, "user_id": 1801763, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/EBIHO.jpg?s=128&g=1", "display_name": "Mr.J", "link": "https://stackoverflow.com/users/1801763/mr-j"}, "is_accepted": false, "score": 0, "last_activity_date": 1514339667, "creation_date": 1514339667, "answer_id": 47985453, "question_id": 47985143, "link": "https://stackoverflow.com/questions/47985143/excel-vba-file-already-open-when-its-not-windows-office/47985453#47985453", "title": "Excel Vba &quot;File already open&quot; when its not - windows office", "body": "<p>I am also experiencing the errors which you have, these are the probable causes of the said error.</p>\n\n<p>1) The <code>CSV</code> is open along with the <code>Excel</code> file\n2) Your code has <a href=\"http://www.decisionmodels.com/memlimitsd.htm\" rel=\"nofollow noreferrer\">memory leaks</a></p>\n\n<p>To resolve number 1</p>\n\n<ul>\n<li>Try running the VBA code when the CSV is not opened</li>\n</ul>\n\n<p>To resolve number 2</p>\n\n<ul>\n<li>Try to use close the <code>CSV</code>object after you have written your data inside it.</li>\n</ul>\n\n<p>I'm not sure about your full code, but please check if you have something like <code>Excel.Close</code> or <code>Excel.Quit</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1514370727, "last_edit_date": 1514370727, "creation_date": 1514364843, "answer_id": 47989106, "question_id": 47985143, "link": "https://stackoverflow.com/questions/47985143/excel-vba-file-already-open-when-its-not-windows-office/47989106#47989106", "title": "Excel Vba &quot;File already open&quot; when its not - windows office", "body": "<p>Try the following code to make sure there is no file open with handle #1</p>\n\n<pre><code>Sub ReadFile()\n    InFile = ThisWorkbook.Path &amp; \"\\smallDataset.csv\"\n    Close #1\n    Open InFile For Input As #1\n        Input #1, a, b\n        Close #1\n        Debug.Print (a &amp; \" \" &amp; b)\nEnd Sub\n</code></pre>\n\n<p>Or you use Freefile to get the next number</p>\n\n<pre><code>Sub ReadFile\nFileNumber = FreeFile\n\nInFile = ThisWorkbook.Path &amp; \"\\smallDataset.csv\"\n\n    Open InFile For Input As FileNumber\n        Input #FileNumber, a, b\n        Close #FileNumber\n        Debug.Print (a &amp; \" \" &amp; b)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5870454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e40c814644679273b22b27e381d1568?s=128&d=identicon&r=PG&f=1", "display_name": "Colours", "link": "https://stackoverflow.com/users/5870454/colours"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7191, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1514370727, "creation_date": 1514335733, "question_id": 47985143, "link": "https://stackoverflow.com/questions/47985143/excel-vba-file-already-open-when-its-not-windows-office", "title": "Excel Vba &quot;File already open&quot; when its not - windows office", "body": "<p>I am trying to read data from another spreadsheet in the same folder as my currently opened workbook, whenever I run this code I get the error file already open. Is there something wrong with my syntax or anything that might stop this from happening?</p>\n\n<p>Here is the code.</p>\n\n<pre><code>Sub ReadFile()\n    Infile = ThisWorkbook.Path &amp; \"\\smallDataset.csv\"\n    Open Infile For Input As #1\n        Input #1, a, b\n        Close #1\n        Debug.Print (a &amp; \" \" &amp; b)\nEnd Sub\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["arrays", "vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1514332622, "post_id": 47984858, "comment_id": 82938699, "body": "What is the value of <b><i>x</i></b> when the error occurs ??"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1514352759, "post_id": 47984858, "comment_id": 82942415, "body": "Think you should add check on line <code>If c = myArray(x) Then</code> to evaluate if it is not exceeding array&#39;s upper bound. Something like <code>If c = myArray(x) and x &lt;= ubound(myArray) Then</code>."}, {"owner": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1514460062, "post_id": 47984858, "comment_id": 82981240, "body": "X = 0 as is it should.  If c = myArray(x) and x &lt;= ubound(myArray) Then  This did not work for my For loop it still will not compare the values."}, {"owner": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1517611338, "post_id": 47984858, "comment_id": 84181069, "body": "I have found the solution and posted my code above that reflects what I truly wanted. I needed nested for loops. Thanks everyone for helping me come to this conclusion. Thanks @Chris Mack for helping me with ubounds and string conversions. I now know more about vba programming."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1514372510, "post_id": 47984972, "comment_id": 82950210, "body": "Sorry I&#39;ve tried to use 1 as the starting point, this is indeed not the case. Like I said my array functions just fine its the For loop that is not spooling through the array properly"}], "tags": [], "owner": {"reputation": 148, "user_id": 8980452, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uYDGOIPesBs/AAAAAAAAAAI/AAAAAAAAAEk/ytw1bk7juSc/photo.jpg?sz=128", "display_name": "Fernando Bravo Diaz", "link": "https://stackoverflow.com/users/8980452/fernando-bravo-diaz"}, "is_accepted": false, "score": -2, "last_activity_date": 1514333520, "creation_date": 1514333520, "answer_id": 47984972, "question_id": 47984858, "link": "https://stackoverflow.com/questions/47984858/vba-excel-loop-will-not-handle-array/47984972#47984972", "title": "VBA Excel Loop will not handle array", "body": "<p>Try calling the array starting by 1:</p>\n\n<pre><code>    x = 1\n    if c = myArray(x) then\n</code></pre>\n\n<p>on others <a href=\"http://www.excel-easy.com/vba/array.html\" rel=\"nofollow noreferrer\">examples of array in vba</a> I have seen that they start on 1 instead of 0</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1514460042, "post_id": 47985116, "comment_id": 82981231, "body": "This did not work for me, I tried both ways as shrivallabha mentioned above as well. The loops does just not recognize integer &#39;x&#39; in my array, When I print out x it is equal to 0 as it should be."}, {"owner": {"reputation": 4928, "user_id": 5314530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/671d5901621bffdfce67c830735f4c97?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mack", "link": "https://stackoverflow.com/users/5314530/chris-mack"}, "reply_to_user": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1514473741, "post_id": 47985116, "comment_id": 82987971, "body": "If you are comparing integers you will need to use <code>CInt</code>, as your array is a string array. See my updated code."}, {"owner": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1516967338, "post_id": 47985116, "comment_id": 83914315, "body": "So this is now saying its a data type mismatch, so I tried CLng and even CStr. The datatype would have to a be a long as the numbers im looking up are large. This still does not function properly as I want it to. It no longers spits out any errors. The program runs and it still refuses to look at my array(x) and grab any rows that contain the data i want in columns B:D and move it to sheet 2. When I put in the number manually it runs just fine. What is wrong with my array???"}, {"owner": {"reputation": 4928, "user_id": 5314530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/671d5901621bffdfce67c830735f4c97?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mack", "link": "https://stackoverflow.com/users/5314530/chris-mack"}, "reply_to_user": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1516992558, "post_id": 47985116, "comment_id": 83928890, "body": "Could you upload a workbook or something? Just something basic that demonstrates the problem."}, {"owner": {"reputation": 4928, "user_id": 5314530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/671d5901621bffdfce67c830735f4c97?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mack", "link": "https://stackoverflow.com/users/5314530/chris-mack"}, "reply_to_user": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1517364532, "post_id": 47985116, "comment_id": 84062390, "body": "I&#39;m unable to access that without Gmail. Do you have Dropbox, Google Drive, or anything like that?"}, {"owner": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1517611648, "post_id": 47985116, "comment_id": 84181179, "body": "I have found the solution and posted my code above that reflects what I truly wanted. I needed nested for loops. Thanks everyone for helping me come to this conclusion. Thanks @Chris Mack for helping me with ubounds and string conversions. I now know more about vba programming."}, {"owner": {"reputation": 4928, "user_id": 5314530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/671d5901621bffdfce67c830735f4c97?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mack", "link": "https://stackoverflow.com/users/5314530/chris-mack"}, "reply_to_user": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "edited": false, "score": 0, "creation_date": 1517612540, "post_id": 47985116, "comment_id": 84181465, "body": "Cool - and no problem!"}], "tags": [], "owner": {"reputation": 4928, "user_id": 5314530, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/671d5901621bffdfce67c830735f4c97?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Mack", "link": "https://stackoverflow.com/users/5314530/chris-mack"}, "is_accepted": true, "score": 0, "last_activity_date": 1514473686, "last_edit_date": 1514473686, "creation_date": 1514335512, "answer_id": 47985116, "question_id": 47984858, "link": "https://stackoverflow.com/questions/47984858/vba-excel-loop-will-not-handle-array/47985116#47985116", "title": "VBA Excel Loop will not handle array", "body": "<p>It looks like you're likely to keep checking the array after you've incremented <code>x</code> past its upper bound, as that loop is independent of the <code>B1:D6719</code> loop.</p>\n\n<p>Would it be a case of amending the code to something like:</p>\n\n<pre><code>For Each c In Source.Range(\"B1:D6719\")\n    If c = CInt(myArray(x)) Then '&lt;--Here is where my problem is, this line right here\n        Source.rows(c.Row).Copy Target.rows(j)\n        j = j + 1\n        x = x + 1\n    End If\n\n    If x &gt; UBound(myArray) Then Exit For\nNext c\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9143131, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100172619491984/picture?type=large", "display_name": "Panther Sol", "link": "https://stackoverflow.com/users/9143131/panther-sol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 47985116, "answer_count": 2, "score": 0, "last_activity_date": 1518519953, "creation_date": 1514332154, "last_edit_date": 1518519953, "question_id": 47984858, "link": "https://stackoverflow.com/questions/47984858/vba-excel-loop-will-not-handle-array", "title": "VBA Excel Loop will not handle array", "body": "<p>****UPDATE THIS HAS BEEN SOLVED***** Thanks everyone for your help to lead me to this conclusion!******</p>\n\n<p>So everything in my code as seen below does as intended except for one line.</p>\n\n<p><code>If c = myArray(x) Then</code></p>\n\n<p>This script reads in a file that I have left unmentioned. It reads the 'A' column from the file and throws each row into <code>myArray</code>. I know the array works because when I loop it out into dialogue boxes it prints out the data properly. The loop functions properly searching for each row, if it's equal to 'c' it grabs my data and puts it in another sheet. I know this works because when I just enter in the data it grabs it as intended. My trouble is whenever I try to add in the element of <code>myArray(x)</code> to compare it with integer 'c'. It refuses to look at the x integer to properly loop through <code>myArray()</code> with integer 'x'.</p>\n\n<p>Can someone please explain to me why <code>myArray(x)</code> will not loop properly or help me with a solution. I am not a veteran VBA programmer but I have written my fair share of code that functions just fine. I just feel like I am missing a minor detail and have overlooked something simple. Any help at all would be appreciated this is for work purposes and you'd be helping others not just myself.</p>\n\n<pre><code>Sub myArray()\n    Dim FSO As Object, MyFile As Object\n    Dim FileName As String, Arr As Variant\n    Dim c As Range\n    Dim j As Integer, i as Integer\n    Dim Source As Worksheet, Target As Worksheet\n\n    FileName = \"\"   '&lt;--This is left intentionally blank.\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set MyFile = FSO.OpenTextFile(FileName, 1)\n    Arr = Split(MyFile.ReadAll, vbNewLine)  \n    Set Source = ActiveWorkbook.Sheets(\"Sheet1\")\n    Set Target = ActiveWorkbook.Sheets(\"Sheet2\")\n\n    i = 0\n    j = 1\n\n   For i = LBound(Arr) To UBound(Arr)\n    For Each c In Source.Range(\"B:D\")\n        If c = Arr(i) Then\n            Source.rows(c.Row).Copy Target.rows(j)\n            j = j + 1\n        End If\n    Next c\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1514331732, "post_id": 47984421, "comment_id": 82938549, "body": "Your code is designed to handle only single cell changes...........to handle multiple cell changes, you would need a <b><i>loop</i></b>."}, {"owner": {"reputation": 87, "user_id": 9143058, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c068775dc7b21ea0b8e045bb163fa4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Father Goose", "link": "https://stackoverflow.com/users/9143058/father-goose"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1514338140, "post_id": 47984421, "comment_id": 82939634, "body": "You are a legend, your re-code worked perfectly. Thank you so much these Msgbox are so important. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1514332314, "creation_date": 1514332314, "answer_id": 47984866, "question_id": 47984421, "link": "https://stackoverflow.com/questions/47984421/run-time-error-13-occurs-when-deleting-delete-multiple-cells/47984866#47984866", "title": "Run-time error 13 occurs when deleting delete multiple cells", "body": "<p>Give this code a try:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range, r As Range, rv As Long\n    Set rng = Intersect(Target, Range(\"C77:AD81\"))\n    If rng Is Nothing Then Exit Sub\n    For Each r In rng\n        rv = r.Value\n        'Peak Flow 120 and 180 Doctor Warning\n        If rv = 180 Then\n            MsgBox \"''PEAK FLOW CRITICAL AT 180L/MIN''\" &amp; vbCrLf &amp; \"''PREDNISONE PROBABLY REQUIRED''\" &amp; vbCrLf &amp; \"''MAKE DOCTOR'S APPOINTMENTS ASAP''\", vbInformation, \"WARNING\"\n        End If\n        If rv = 120 Then\n            MsgBox \"''PEAK FLOW CRITICAL AT 120L/MIN''\" &amp; vbCrLf &amp; \"''MAKE URGENT DOCTOR'S APPOINTMENTS''\" &amp; vbCrLf &amp; \"''OR GO TO A&amp;E IMMEDIATELY''\", vbInformation, \"CRITICAL WARNING\"\n        End If\n        If rv &gt;= 450 Then\n            MsgBox \"''CHECK OR TEST PEAK FLOW METER''\" &amp; vbCrLf &amp; \"''IT MAY BE FAULTY AND GIVING FALSE HIGH's''\", vbInformation, \"WARNING\"\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9143058, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c068775dc7b21ea0b8e045bb163fa4e6?s=128&d=identicon&r=PG&f=1", "display_name": "Father Goose", "link": "https://stackoverflow.com/users/9143058/father-goose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 47984866, "answer_count": 1, "score": 0, "last_activity_date": 1561497370, "creation_date": 1514327696, "last_edit_date": 1531161705, "question_id": 47984421, "link": "https://stackoverflow.com/questions/47984421/run-time-error-13-occurs-when-deleting-delete-multiple-cells", "title": "Run-time error 13 occurs when deleting delete multiple cells", "body": "<p>I'm new to VBA in Excel. I've written the code below which works fine, but when I try to delete multiple cells a run-time error 13 occurs. I've checked other search problems but can't figure it out.</p>\n\n<p>My code is:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n'Peak Flow 120 and 180 Doctor Warning\nIf Intersect(Target, Range(\"C77:AD81\")) = 180 Then\n    MsgBox \"''PEAK FLOW CRITICAL AT 180L/MIN''\" &amp; vbCrLf &amp; \"''PREDNISONE PROBABLY REQUIRED''\" &amp; vbCrLf &amp; \"''MAKE DOCTOR'S APPOINTMENTS ASAP''\", vbInformation, \"WARNING\"\nEnd If\nIf Intersect(Target, Range(\"C77:AD81\")) = 120 Then\n    MsgBox \"''PEAK FLOW CRITICAL AT 120L/MIN''\" &amp; vbCrLf &amp; \"''MAKE URGENT DOCTOR'S APPOINTMENTS''\" &amp; vbCrLf &amp; \"''OR GO TO A&amp;E IMMEDIATELY''\", vbInformation, \"CRITICAL WARNING\"\nEnd If\nIf Intersect(Target, Range(\"C77:AD81\")) &gt;= 450 Then\n    MsgBox \"''CHECK OR TEST PEAK FLOW METER''\" &amp; vbCrLf &amp; \"''IT MAY BE FAULTY AND GIVING FALSE HIGH's''\", vbInformation, \"WARNING\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1514326874, "post_id": 47984293, "comment_id": 82937606, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">Error in finding last used cell in VBA</a>"}, {"owner": {"reputation": 535, "user_id": 2854647, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/198e1025a309115c12c98888f46f5e88?s=128&d=identicon&r=PG&f=1", "display_name": "Maki", "link": "https://stackoverflow.com/users/2854647/maki"}, "edited": false, "score": 1, "creation_date": 1514335744, "post_id": 47984293, "comment_id": 82939277, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/71180/how-can-i-find-last-row-that-contains-data-in-the-excel-sheet-with-a-macro\">How can I find last row that contains data in the Excel sheet with a macro?</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514343052, "post_id": 47984293, "comment_id": 82940405, "body": "Welcome to Stack Overflow!  Please take a few minutes to check out the <a href=\"https://stackoverflow.com/tour\">tour</a> as well as <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  You can <a href=\"https://stackoverflow.com/posts/47984293/edit\">edit</a> your question to provide more specific information about your issue, starting with some examples showing what you have and what you need to do."}], "owner": {"reputation": 13, "user_id": 2620128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccea719be085581c730e9ce48266d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr M", "link": "https://stackoverflow.com/users/2620128/mr-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514338362, "creation_date": 1514326750, "last_edit_date": 1514338362, "question_id": 47984293, "link": "https://stackoverflow.com/questions/47984293/copy-and-paste-to-the-last-populated-row", "title": "Copy and paste to the last populated row", "body": "<p>I am currently trying to combine two sheets of data which are updated periodically and then remove duplicates. </p>\n\n<p>I have 4 worksheets:</p>\n\n<ul>\n<li>Sheet X</li>\n<li>Sheet Y</li>\n<li>Sheet Z</li>\n<li>Sheet AA</li>\n</ul>\n\n<p>Sheet X and Y are updated hourly and only ever grow. </p>\n\n<p>I wish to clear <code>Sheet Z</code> completely, clear columns <code>C:P</code> on <code>Sheet AA</code>, Then copy all the data from <code>X</code> and <code>Y</code> and paste into <code>Z</code>, sort by <code>column A</code>, oldest to newest, then remove duplicates from <code>columns B &amp; E</code>. Then copy all the data left and paste into <code>Sheet AA</code> where I run further calculations and <code>VLOOKUPS</code> from.</p>\n\n<p>The issue I have is at the moment I am only copying/editing data up to the row which is recorded in the macro. Is there a way in which to select up to the last populated Row? </p>\n"}, {"tags": ["vba", "range"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1514321747, "post_id": 47983594, "comment_id": 82936079, "body": "You declared <code>RangSE1</code> as a <code>Variant</code>, and then didn&#39;t <code>Set</code> it, so it doesn&#39;t know you were trying to use it as a <code>Range</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8595501, "user_type": "registered", "profile_image": "https://graph.facebook.com/1158156107662070/picture?type=large", "display_name": "Susan Liu", "link": "https://stackoverflow.com/users/8595501/susan-liu"}, "edited": false, "score": 0, "creation_date": 1514440317, "post_id": 47983659, "comment_id": 82972828, "body": "Hi It solves my question so well .Thank you ! Although I wonder why I can&#39;t define all range objects as range by define together?"}, {"owner": {"reputation": 1, "user_id": 8595501, "user_type": "registered", "profile_image": "https://graph.facebook.com/1158156107662070/picture?type=large", "display_name": "Susan Liu", "link": "https://stackoverflow.com/users/8595501/susan-liu"}, "edited": false, "score": 0, "creation_date": 1514440425, "post_id": 47983659, "comment_id": 82972855, "body": "And I have a data set of 150000. In this case my look always get stuck even if I loop by range .Is there anyway that I can fasten the loop process within 5 mins?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 8595501, "user_type": "registered", "profile_image": "https://graph.facebook.com/1158156107662070/picture?type=large", "display_name": "Susan Liu", "link": "https://stackoverflow.com/users/8595501/susan-liu"}, "edited": false, "score": 1, "creation_date": 1514444703, "post_id": 47983659, "comment_id": 82974306, "body": "@SusanLiu &quot;I wonder why I can&#39;t define all range objects as range by define together?&quot; - You can do <code>Dim x, y, z As Range</code> but that is treated by VBA as <code>Dim x As Variant, y As Variant, z As Range</code>.  If you don&#39;t include an <code>As type</code> declaration, VBA assumes the variable is to be declared as a <code>Variant</code>.  So if you want multiple variables to all be declared as <code>Range</code> objects, you need to declare all of them <code>As Range</code>, i.e. <code>Dim x As Range, y As Range, z As Range</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 8595501, "user_type": "registered", "profile_image": "https://graph.facebook.com/1158156107662070/picture?type=large", "display_name": "Susan Liu", "link": "https://stackoverflow.com/users/8595501/susan-liu"}, "edited": false, "score": 0, "creation_date": 1514444863, "post_id": 47983659, "comment_id": 82974376, "body": "@SusanLiu Re speed - if you were only accessing the values of your range, and not the formatting, I would recommend that you read the data into an array, then perform your processing against the array, and then (when finished) write the array back to the sheet.  But because you are processing colours, you can&#39;t do that that way."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1514322943, "last_edit_date": 1514322943, "creation_date": 1514322092, "answer_id": 47983659, "question_id": 47983594, "link": "https://stackoverflow.com/questions/47983594/run-time-error-424-object-required-when-i-try-to-reach-range-and-use-range-da/47983659#47983659", "title": "Run time error: 424 : Object required when I try to reach range and use range data", "body": "<p>Your lines saying</p>\n\n<pre><code>Dim RangSe1\n'...\nRangSe1 = wsSettle1.Range(\"A1:AQ\" &amp; iLastrow1)\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>Dim RangSe1 As Variant\n'...\nRangSe1 = wsSettle1.Range(\"A1:AQ\" &amp; iLastrow1).Value\n</code></pre>\n\n<p>which will create a <code>Variant</code> array dimensioned as <code>1 To iLastrow1, 1 To 43</code>.  You can't use an <code>Activate</code> method on the <code>(1, 1)</code>th position of an array, because an array is not an object and therefore does not have methods or properties.</p>\n\n<hr>\n\n<p>You have two major mistakes that are causing your code to not do what you expect:</p>\n\n<p>1) You are not defining your variables correctly because:</p>\n\n<pre><code>Dim RangSe1, RangSo1, RangSe2, RangSo2, RangS As Range\n</code></pre>\n\n<p>is equivalent to :</p>\n\n<pre><code>Dim RangSe1 As Variant, RangSo1 As Variant, RangSe2 As Variant, RangSo2 As Variant, RangS As Range\n</code></pre>\n\n<p>You should use:</p>\n\n<pre><code>Dim RangSe1 As Range, RangSo1 As Range, RangSe2 As Range, RangSo2 As Range, RangS As Range\n</code></pre>\n\n<p>2) You are not using the <code>Set</code> keyword when assigning a reference to your <code>Range</code> objects so, for instance,</p>\n\n<pre><code>RangSe1 = wsSettle1.Range(\"A1:AQ\" &amp; iLastrow1)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Set RangSe1 = wsSettle1.Range(\"A1:AQ\" &amp; iLastrow1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8595501, "user_type": "registered", "profile_image": "https://graph.facebook.com/1158156107662070/picture?type=large", "display_name": "Susan Liu", "link": "https://stackoverflow.com/users/8595501/susan-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514322943, "creation_date": 1514321596, "question_id": 47983594, "link": "https://stackoverflow.com/questions/47983594/run-time-error-424-object-required-when-i-try-to-reach-range-and-use-range-da", "title": "Run time error: 424 : Object required when I try to reach range and use range data", "body": "<p>I am trying to highligh new excel the same way as old excel and data is large .So I saved the data in range and tried to do find, count if functions in range .But it keep showing \"object not find error\".I really don't get it since I defined the range object well. Here are part of my codes .I tried to debug by \"RangSe1(1, 1).Activate\" after I defined the RangSe1 object and it give me the 424 error even from here . I am really confused . </p>\n\n<pre><code> Sub Morningsmall()\n\n Dim strfile As String\n Dim iLastrow, iColor, iFind, iLastrow1, iLastrow2, iLastrow3, iLastrow4,   iRow As Long\n Dim RangSe1, RangSo1, RangSe2, RangSo2, RangS As Range\n\n\n Dim wbLastday, wbToday As Workbook\n Dim wsSettle1, wsSettle2, wsSophis1, wsSophis2 As Worksheet\n\n    With Application\n\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .Calculate\n        .Calculation = xlCalculationManual\n        .DisplayStatusBar = False\n    End With\n\n\n  'Open yesterday's file\n   MsgBox \"Open Yesterday's Settlement Report\"\n   strfile = Application.GetOpenFilename\n   If strfile &lt;&gt; \"False\" Then Workbooks.Open strfile\n\nSet wbLastday = ActiveWorkbook\nSet wsSettle1 = wbLastday.Sheets(\"SettlementReport\")\nSet wsSophis1 = wbLastday.Sheets(\"Sophis\")\n\niLastrow1 = wsSettle1.Cells(wsSettle1.Rows.Count, 1).End(xlUp).Row\niLastrow2 = wsSophis1.Cells(wsSophis1.Rows.Count, 1).End(xlUp).Row\n\nRangSe1 = wsSettle1.Range(\"A1:AQ\" &amp; iLastrow1)\nRangSo1 = wsSophis1.Range(\"A1:AJ\" &amp; iLastrow2)\n\n\nRangSe1(1, 1).Activate\n\n...\n...\n...\n\n\nFor i = 2 To iLastrow3\n    iFind = RangSe2(i, 1)\n    'a = Application.WorksheetFunction.CountIf(Rang, iFind)\n    If Application.WorksheetFunction.CountIf(wsSettle1, iFind) &gt; 0 Then\n\n   'range1.Find(\"test id\", LookIn:=xlValues)\n        If RangSe1(wsSettle1.Cells.Find(what:=iFind).Row, 6) = RangSe2(i,           6)     Then\n       iColor = RangSe1.Find(what:=iFind).Interior.Color\n           If iColor &lt;&gt; 16777215 Then\n                 wsSettle2.Rows(i).Interior.Color = iColor\n           End If\n       End If\n End If\n\n...\n...\n...\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1514319335, "post_id": 47983280, "comment_id": 82935297, "body": "This can be done with a simple formula if you want."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8605006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66c3c64a3942a3d703985a3c3534427c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix Ning", "link": "https://stackoverflow.com/users/8605006/phoenix-ning"}, "edited": false, "score": 0, "creation_date": 1514388344, "post_id": 47983360, "comment_id": 82957317, "body": "Thank you so much for your answer!  I have a question, why I run &quot;myvalue = myvalue + Range(&quot;A&quot; &amp; i).Value&quot; it was an error 13: Type mismatch?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 7, "user_id": 8605006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66c3c64a3942a3d703985a3c3534427c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix Ning", "link": "https://stackoverflow.com/users/8605006/phoenix-ning"}, "edited": false, "score": 0, "creation_date": 1514391330, "post_id": 47983360, "comment_id": 82958666, "body": "@PhoenixNing That means that whatever&#39;s in that cell in column A is not really a number, is it like <code>124124A</code> or something?"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 1, "last_activity_date": 1514319670, "creation_date": 1514319670, "answer_id": 47983360, "question_id": 47983280, "link": "https://stackoverflow.com/questions/47983280/sum-a-small-range-between-two-special-marks/47983360#47983360", "title": "sum a small range between two special marks", "body": "<p>VBA solution:</p>\n\n<p>EDIT: Realized I was missing a 1 in my example so it doesn't match yours, but you get the gist I suppose.</p>\n\n<pre><code>Option Explicit\nSub SumBetweenMarks()\nDim sht As Worksheet, lastrow As Long, myvalue As Long, i as long\n\nSet sht = ActiveSheet\nlastrow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nmyvalue = 0\nFor i = 1 To lastrow\n    If Range(\"B\" &amp; i).Value &lt;&gt; 1 Then\n        myvalue = myvalue + Range(\"A\" &amp; i).Value\n    Else\n        myvalue = myvalue + Range(\"A\" &amp; i).Value\n        Range(\"C\" &amp; i).Value = myvalue\n        myvalue = 0\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kLsM9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kLsM9.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 8605006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66c3c64a3942a3d703985a3c3534427c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix Ning", "link": "https://stackoverflow.com/users/8605006/phoenix-ning"}, "edited": false, "score": 0, "creation_date": 1514388234, "post_id": 47983368, "comment_id": 82957265, "body": "Wooooooo  amazing!!! I am a beginner of VBA, it cost me long time. Thank you so much."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1514319746, "creation_date": 1514319746, "answer_id": 47983368, "question_id": 47983280, "link": "https://stackoverflow.com/questions/47983280/sum-a-small-range-between-two-special-marks/47983368#47983368", "title": "sum a small range between two special marks", "body": "<pre><code>Dim Lastrow As Long\nWith ActiveSheet\n    Lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Range(\"C1\").Formula = \"=IF(B1=1,A1,\"\"\"\")\"\n    .Range(\"C2:C\" &amp; Lastrow).Formula = \"=IF(B2=1,SUM($A$1:A2)-SUM($C$1:C1),\"\"\"\")\"\nEnd With\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ePAR6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ePAR6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 7, "user_id": 8605006, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/66c3c64a3942a3d703985a3c3534427c?s=128&d=identicon&r=PG&f=1", "display_name": "Phoenix Ning", "link": "https://stackoverflow.com/users/8605006/phoenix-ning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 47983368, "answer_count": 2, "score": 0, "last_activity_date": 1514319746, "creation_date": 1514319005, "last_edit_date": 1514319316, "question_id": 47983280, "link": "https://stackoverflow.com/questions/47983280/sum-a-small-range-between-two-special-marks", "title": "sum a small range between two special marks", "body": "<p>Sample data:  </p>\n\n<pre><code>Column A       Column B\n\n63843       \n60208        \n57606   \n130717           1    \n190407   \n186980           1    \n167839   \n180043   \n174384           1   \n170289           1  \n107142   \n87628      \n41637  \n48807            1    \n57602   \n51537   \n</code></pre>\n\n<p>Column A is concentration and column B are something like marks. </p>\n\n<p>I want to sum the concentration after one mark to the next mark into a new column (column C), the concentration besides \"1\" is the last element of one sum.\nFor example: sum(63843:130717),sum(190407:186980),sum(167839:174384),etc.</p>\n\n<p>If marks are stick to each other, like between 174384 with 170289, the sum is 170289. </p>\n\n<p>I hope I express it clearly. I know I should write some code in this part, but I totally have no idea. I think I should use something like: </p>\n\n<p>Range(\"C1:C\" &amp; lastrow).Formula = \"=IF(B1=1,TEXT(SUM(...........),\"\"...................\"\"),\"\"\"\")\"</p>\n\n<p>Thank you so much. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1514321355, "post_id": 47983130, "comment_id": 82935943, "body": "Where is this sub located? Is it in your <code>This Workbook</code> object?"}, {"owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1514321633, "post_id": 47983130, "comment_id": 82936040, "body": "Yes it is in the ThisWorkbook object.. the other commands seem to work!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1514322049, "post_id": 47983130, "comment_id": 82936193, "body": "This is interesting. In this <a href=\"http://www.vbaexpress.com/forum/showthread.php?12379-Solved-Hiding-Command-Toolbars\" rel=\"nofollow noreferrer\">link</a> it looks like they&#39;re using <code>Workbook_Activate()</code> instead. Maybe try that?"}, {"owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1514374093, "post_id": 47983130, "comment_id": 82950952, "body": "no unfortunately also does not work"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "edited": false, "score": 0, "creation_date": 1514374239, "post_id": 47986210, "comment_id": 82951021, "body": "thank you for your reply - the problem however is that on the other hand i need to be able to select the shapes and also to generate them per vba.. when i protect the sheet neither is possible anymore.."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "edited": false, "score": 0, "creation_date": 1514391221, "post_id": 47986210, "comment_id": 82958616, "body": "When you need to creaye or manipulate the shapes via VBA, you can programmatically unprotect &amp; reprotect the sheet as required.  Why do the users need to be able to select the shapes?  There&#39;s likely an alternative."}, {"owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "edited": false, "score": 0, "creation_date": 1514392074, "post_id": 47986210, "comment_id": 82958992, "body": "hm yeah you are right that should not be a problem with the creation of new shapes - but the selection of shapes is crucial to my program as i need to select various shapes to align them via vba.. basically i overwrite the left, or top values of the selected shapes with the value of the first selected shape.."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "edited": false, "score": 0, "creation_date": 1514392322, "post_id": 47986210, "comment_id": 82959102, "body": "Are there a limited number of shapes? If so, perhaps an alternate method of selecrion would work, like [static or dynamic] checkboxes...?  A screen  shot example of what you&#39;re doing might be helpful."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "edited": false, "score": 1, "creation_date": 1514392454, "post_id": 47986210, "comment_id": 82959153, "body": "....since unfortunately there&#39;s no built-in functionality for disabling only certain interactions with shapes. (Short of creating a custom add-on with C#)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 2, "last_activity_date": 1514347691, "creation_date": 1514347691, "answer_id": 47986210, "question_id": 47983130, "link": "https://stackoverflow.com/questions/47983130/disable-right-click-menu-of-shapes/47986210#47986210", "title": "Disable right click menu of shapes", "body": "<p>The right-click menu (aka, <em>context menu</em>) is <strong>not a Command Bar</strong>. </p>\n\n<p>You may know Command Bars by their older name, <em>Toolbars</em>, or their newer name, <em>Ribbons</em>.</p>\n\n<p>Although you <strong>can</strong> <a href=\"https://www.extendoffice.com/documents/excel/4291-excel-disable-right-click-menu.html#a1\" rel=\"nofollow noreferrer\">capture and/or disable a right-click event on a worksheet</a>, this <strong>doesn't apply</strong> to objects like shapes.</p>\n\n<p>However, you can prevent the context menu from showing by protecting the worksheet from changes (with or without a password).</p>\n\n<p>If necessary you can allow some changes, but not others, to be made by the user.  More information at <a href=\"https://support.office.com/en-us/article/Lock-or-unlock-specific-areas-of-a-protected-worksheet-75481b72-db8a-4267-8c43-042a5f2cd93a\" rel=\"nofollow noreferrer\">this link</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AZymH.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AZymH.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "is_accepted": false, "score": 0, "last_activity_date": 1514393093, "creation_date": 1514393093, "answer_id": 47995724, "question_id": 47983130, "link": "https://stackoverflow.com/questions/47983130/disable-right-click-menu-of-shapes/47995724#47995724", "title": "Disable right click menu of shapes", "body": "<p>I have attached some screenshots of my application just to describe what I want to archive.</p>\n\n<p>The problem is that the menu is realy annoying when trying to select more than one shape.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PAUDl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PAUDl.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/1r3fC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1r3fC.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1450, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1514393093, "creation_date": 1514317986, "last_edit_date": 1514343528, "question_id": 47983130, "link": "https://stackoverflow.com/questions/47983130/disable-right-click-menu-of-shapes", "title": "Disable right click menu of shapes", "body": "<p>Is there a way to disable the right click menu for shapes like e.g. rectangles in VBA?</p>\n\n<p>I tried:</p>\n\n<pre><code>Private Sub Workbook_Open()\n'    Application.WindowState = xlMaximized\n    Application.DisplayFullScreen = True\n    Application.CommandBars(\"Ply\").Enabled = False\n    Application.CommandBars(\"Shapes\").Enabled = False\nEnd Sub\n</code></pre>\n\n<p>but this does not seem to work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514317445, "post_id": 47982997, "comment_id": 82934649, "body": "Use the <code>Name</code> command (<code>Name oldfile As newfile</code>)"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514317618, "post_id": 47982997, "comment_id": 82934701, "body": "@YowE3K I guess, OP needs to rename files <i>in Excel</i> rather <i>OS</i> :)"}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514317837, "post_id": 47982997, "comment_id": 82934776, "body": "@YowE3K It would be really useful to me if you can let me know the full logic. Thanks."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514317923, "post_id": 47982997, "comment_id": 82934806, "body": "@YowE3K I know what is <code>Name</code>. Does OP need to rename in Excel or OS?"}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514318002, "post_id": 47982997, "comment_id": 82934824, "body": "@YowE3K. FYI, I have a logic already for the column B to rename filenames, but the logic isn&#39;t working right. Please suggest me changes to the existing code, if you have any. Thanks."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514318089, "post_id": 47982997, "comment_id": 82934863, "body": "@YowE3K Oops! My bad! Didn&#39;t see changes :("}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514318107, "post_id": 47982997, "comment_id": 82934871, "body": "@JohnyL, It would be excel, because I am trying to rename file names in the network directory using Excel VBA"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514318145, "post_id": 47982997, "comment_id": 82934888, "body": "@YowE3K Ahaha))"}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514318251, "post_id": 47982997, "comment_id": 82934927, "body": "@YowE3K Any suggestions?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514318279, "post_id": 47982997, "comment_id": 82934934, "body": "@user9070221 What part of the code isn&#39;t working - my quick read of it makes me think it should work OK."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1514318381, "post_id": 47982997, "comment_id": 82934978, "body": "<code>not working effectively</code> as in a) Its slow. b) file names are not changed c) I am getting an error. ..........or something else?"}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1514318955, "post_id": 47982997, "comment_id": 82935171, "body": "@cyboashu I mean the code isn&#39;t working effectively because the folder names hasn&#39;t changed , even though the old names are in Column A and new names are in column B. Thanks."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1514343399, "post_id": 47982997, "comment_id": 82940465, "body": "@user9070221 Are you able to move files manually to the target directory? If so, your code should work. Also, do you have network security that might be hindering changes on network files through automation?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "edited": false, "score": 0, "creation_date": 1514319030, "post_id": 47983186, "comment_id": 82935191, "body": "Thanks for the response. Do this code work if I want to rename multiple filenames and the source directory is a network directory?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "edited": false, "score": 0, "creation_date": 1514319519, "post_id": 47983186, "comment_id": 82935367, "body": "@user9070221 Yes. Just use loop as set <code>File</code> object and rename it."}, {"owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "edited": false, "score": 0, "creation_date": 1514319919, "post_id": 47983186, "comment_id": 82935496, "body": "FYI, the code shows no error but it doesn&#39;t change anything as well."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "edited": false, "score": 0, "creation_date": 1514321676, "post_id": 47983186, "comment_id": 82936054, "body": "@user9070221 I updated the code. The code works for me. I tested it on shared folder."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 1, "last_activity_date": 1514321633, "last_edit_date": 1514321633, "creation_date": 1514318351, "answer_id": 47983186, "question_id": 47982997, "link": "https://stackoverflow.com/questions/47982997/the-old-file-names-are-in-column-a-and-new-file-names-are-in-column-b-how-to-re/47983186#47983186", "title": "The old file names are in Column A and new file names are in Column B, how to replace the old ones with new ones in the directory using VBA?", "body": "<p>You could use FileSystemObject:</p>\n\n<pre><code>Sub Iterator()\n\n    'Tools -&gt; References -&gt; Microsoft Scripting Runtime\n    Dim fso As New FileSystemObject\n    Dim fl As File\n    Dim r As Long\n\n    For r = 1 To 3\n        Set fl = fso.GetFile(Cells(r, \"A\")) 'Path is taken from column \"A\"\n        fl.Name = Cells(r, \"B\") 'Rename with name taken from column B\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9070221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/daf6e5abcb4868db6173be7f7861488d?s=128&d=identicon&r=PG&f=1", "display_name": "user9070221", "link": "https://stackoverflow.com/users/9070221/user9070221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1514321633, "creation_date": 1514317124, "last_edit_date": 1531164843, "question_id": 47982997, "link": "https://stackoverflow.com/questions/47982997/the-old-file-names-are-in-column-a-and-new-file-names-are-in-column-b-how-to-re", "title": "The old file names are in Column A and new file names are in Column B, how to replace the old ones with new ones in the directory using VBA?", "body": "<p>I have an excel file that has two columns, column A &amp; Column B. </p>\n\n<p>The column A is \"Path and filenames that had been selected\", which has path of each file name in a network directory:</p>\n\n<pre><code>\\\\xxx\\yyyy\\gggg\\ooo.pdf\n\\\\xxx\\yyyy\\gggg\\ogh.pdf\n\\\\xxx\\yyyy\\gggg\\pjo.pdf\n</code></pre>\n\n<p>The column B has \"new file names\", which are supposed to replace old file names (ooo.pdf, ogh.pdf, pjo.pdf):</p>\n\n<pre><code>fff.pdf\nfgh.pdf\nhjk.pdf\n</code></pre>\n\n<p>I have a code that is supposed to rename the old file names with new file names, but somehow it is not working effectively. PLease let me know what is wrong with the below code :</p>\n\n<pre><code>Sub RenameFiles()\nDim xDir As String\nDim xFile As String\nDim xRow As Long\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .AllowMultiSelect = False\nIf .Show = -1 Then\n    xDir = .SelectedItems(1)\n    xFile = Dir(xDir &amp; Application.PathSeparator &amp; \"*\")\n    Do Until xFile = \"\"\n        xRow = 0\n        On Error Resume Next\n        xRow = Application.Match(xFile, Range(\"A:A\"), 0)\n        If xRow &gt; 0 Then\n            Name xDir &amp; Application.PathSeparator &amp; xFile As _\n            xDir &amp; Application.PathSeparator &amp; Cells(xRow, \"B\").Value\n        End If\n        xFile = Dir\n    Loop\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Please let me know the VBA code that can replace the old file name with the new file name in the directory.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 6, "creation_date": 1514316887, "post_id": 47982960, "comment_id": 82934456, "body": "You can hope Excel correctly guesses that what you enter as a <code>Value</code> is a formula, or you can ensure that Excel knows that what you enter as a <code>Formula</code> is a formula"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 3, "creation_date": 1514316943, "post_id": 47982960, "comment_id": 82934476, "body": "also when reading (the getter) range.formula &lt;&gt; range.value."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1514317440, "post_id": 47982960, "comment_id": 82934646, "body": "Also, if you want to use <code>R1C1</code> notation, it&#39;s actually not required to use it because you can achieve the same goal with <code>A1</code> notation. For instance: <code>Range(&quot;A1:A10&quot;).Formula = &quot;=B1+C1&quot;</code> is the same as <code>Range(&quot;A1:A10&quot;).Formula = &quot;=RC[1]+RC[2]&quot;</code> (note that when using <code>R1C1</code> formula, we can use <code>Formula</code> as well as <code>FormulaR1C1</code> - it&#39;s again twist of Excel)."}, {"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "edited": false, "score": 0, "creation_date": 1514317694, "post_id": 47982960, "comment_id": 82934732, "body": "You will find issues when making references to other sheets, or if the cell isn\u2019t formatted correctly for the data you want to go in. Good practice would have you only use .Value when entering a Value, but using .Formula when you are inputting any Formula (Sorry, I know that last bit is obvious)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1514318354, "post_id": 47982960, "comment_id": 82934971, "body": "It&#39;s called <b>overhead</b>. The compiler and platform attempts to correct any stupid mistakes that dumbass, lazy &#39;programmers&#39; make. The more overhead that is built into the compiler, the slower the programming language. Try the same in C or Assembler."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 1, "creation_date": 1514320561, "post_id": 47982960, "comment_id": 82935677, "body": "@JohnyL There are cases where Excel can&#39;t correctly guess that you are using R1C1 notation if you use the <code>Formula</code> property - e.g. <code>Range(&quot;A1&quot;).Formula = &quot;=RC2+RC3&quot;</code> and <code>Range(&quot;A1&quot;).FormulaR1C1 = &quot;=RC2+RC3&quot;</code> give different results"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1514321082, "post_id": 47982960, "comment_id": 82935842, "body": "@YowE3K Yes, that&#39;s why I called it a twist, but it&#39;s <i>always</i> better to be explicit."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514321206, "post_id": 47982960, "comment_id": 82935892, "body": "@YowE3K Your example with <code>Formula</code> gave incorrect result (more accurately, the one we didn&#39;t expect), because <code>RC2</code> and <code>RC3</code> are <i>valid</i> sheet cells."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514321238, "post_id": 47982960, "comment_id": 82935904, "body": "IMO - Using <code>Range(&quot;F3&quot;) = &quot;=sum(b6+h9)&quot;</code> and Excel resolving that as the real sum is a bug/&#39;mistake&#39; on Excel/VBA&#39;s part. Without using <code>Formula</code>, default is <code>.Value</code>, so I&#39;d personally expect that line to resolve to the string <code>=sum(b6+h9)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514321274, "post_id": 47982960, "comment_id": 82935919, "body": "@JohnyL Yes, that is why it is good to be explicit - in some cases Excel guesses your intentions incorrectly"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1514321506, "post_id": 47982960, "comment_id": 82935998, "body": "@BruceWayne I just wish Excel would pop up an error message when users enter <code>=SUM(B6+H9)</code> saying &quot;Don&#39;t be silly, what&#39;s the point in using SUM when you have only got a single, non-array, parameter&quot; ;)"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514350441, "post_id": 47982960, "comment_id": 82941852, "body": "@BruceWayne - Another example of MS smarting you out."}], "owner": {"reputation": 133, "user_id": 8663563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/832f2278268ebe21db455ac752d60526?s=128&d=identicon&r=PG&f=1", "display_name": "s0ulr3aper07", "link": "https://stackoverflow.com/users/8663563/s0ulr3aper07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514343885, "creation_date": 1514316786, "last_edit_date": 1514343885, "question_id": 47982960, "link": "https://stackoverflow.com/questions/47982960/why-is-the-formula-property-necessary", "title": "Why is the Formula property necessary?", "body": "<p>I have been wondering what the purpose of the <em>Formula property</em> is in VBA since we can get the exact same output in Excel using the same code without the the said property.</p>\n\n<p>For example :</p>\n\n<pre><code>Sub myformula()\n\nRange(\"f3\").Formula = \"=sum(b6+h9)\"\n\nEnd Sub\n</code></pre>\n\n<p>produces the same results as </p>\n\n<pre><code>Sub myformula()\n\nRange(\"f3\") = \"=sum(b6+h9)\"\n\nEnd Sub\n</code></pre>\n\n<p>Is there a specific scenario in which using this property becomes important and just typing out the formula as a value might not work? </p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514322148, "post_id": 47982850, "comment_id": 82936233, "body": "To be clear, the 50+ options are slices themselves, not 50+ options for <i>which</i> to put the slicer on?  I.e. when you create a slicer, the first option is to choose a category to &quot;slice&quot;.  <i>Then</i> you have the list of various slicers."}, {"owner": {"reputation": 337, "user_id": 9142709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129ae1878f35b4d62dc31367b0d06b7b?s=128&d=identicon&r=PG&f=1", "display_name": "excelislife", "link": "https://stackoverflow.com/users/9142709/excelislife"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514323266, "post_id": 47982850, "comment_id": 82936595, "body": "Hi BruceWayne, say I click on Slicer option in pivot table. I get one box. In that box there are 50+ options. I can click on any one option and I can get data/plots updated. Say it is years: 2015, 2016, 2017. If I click on 2015, the data gets updated. This is what I meant. I apologize if it is not very clear still."}, {"owner": {"reputation": 337, "user_id": 9142709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129ae1878f35b4d62dc31367b0d06b7b?s=128&d=identicon&r=PG&f=1", "display_name": "excelislife", "link": "https://stackoverflow.com/users/9142709/excelislife"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514323573, "post_id": 47982850, "comment_id": 82936672, "body": "When we click on Pivot table, we see In the Analyze tab &quot;Insert slicer&quot;. This gives the box for slicer. When I click inside the content of the box, there are many options I can select or deselect. I want to add comments on these options. Not on the huge box itself. Hope this makes it clear. I apologize again if not clear."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1514323731, "post_id": 47982850, "comment_id": 82936711, "body": "In <a href=\"https://i.stack.imgur.com/Ds7jr.gif\" rel=\"nofollow noreferrer\">this .gif</a>, are you looking to show the comment in the first part (where I select <code>SOFAA</code>), or the second part when the slices are showing (2001/2002/2003)?  You&#39;re looking to add comments to the first part, yeah?"}, {"owner": {"reputation": 337, "user_id": 9142709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129ae1878f35b4d62dc31367b0d06b7b?s=128&d=identicon&r=PG&f=1", "display_name": "excelislife", "link": "https://stackoverflow.com/users/9142709/excelislife"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514323951, "post_id": 47982850, "comment_id": 82936783, "body": "Hi Bruce, awesome gif. Yes, I am looking to add comments to the first part. However, you have made some marvelous gif! Can it also be known how to add comments to the second part? This is outstanding!! :)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514324106, "post_id": 47982850, "comment_id": 82936834, "body": "This is tricky - I&#39;ve been playing around with the VBA for PivotTables, and it doesn&#39;t seem like there&#39;s a built-in way to do this.  My thinking is you&#39;re going to instead want to create a UserForm that pops up, shows the options (which can likely have comments), then from <i>there</i>, create the slicer.  I know you have many options (50+) but perhaps a quick and dirty solution is just to create a table of abbreviations, and their meaning, and show that in a MessageBox before the slicer, or even on a separate sheet?  That&#39;d be much easier to code I&#39;d think."}, {"owner": {"reputation": 337, "user_id": 9142709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129ae1878f35b4d62dc31367b0d06b7b?s=128&d=identicon&r=PG&f=1", "display_name": "excelislife", "link": "https://stackoverflow.com/users/9142709/excelislife"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514324380, "post_id": 47982850, "comment_id": 82936908, "body": "Hi Bruce, Thanks a ton for the reply. I will take your suggestion for it. Yes, this is indeed super tricky one. I will follow your suggestion for it. Again thanks for the reply. Happy Holidays :)"}], "owner": {"reputation": 337, "user_id": 9142709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/129ae1878f35b4d62dc31367b0d06b7b?s=128&d=identicon&r=PG&f=1", "display_name": "excelislife", "link": "https://stackoverflow.com/users/9142709/excelislife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 446, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1556984359, "creation_date": 1514316088, "last_edit_date": 1556984359, "question_id": 47982850, "link": "https://stackoverflow.com/questions/47982850/add-comments-to-excel-pivot-slicer-options", "title": "Add comments to Excel pivot slicer options", "body": "<p>In one Excel pivot table slicer I have almost 50 options. I have given codes to each slicer option rather than writing the entire description about the slicer option.</p>\n\n<p>I am looking to right click/hover over a particular slicer to see the entire description.</p>\n\n<p>Say I have abbreviated one of the options in slicer as 'SOFAA'</p>\n\n<p>On hovering over/right clicking 'SOFAA' I should be able to read a comment 'Stack overflow friends are awesome'.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1514316179, "post_id": 47982809, "comment_id": 82934241, "body": "Why double &quot;&quot; // never seen this before?!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 1, "creation_date": 1514316248, "post_id": 47982809, "comment_id": 82934265, "body": "Because it is inside the first and last <code>&quot;</code>.  It needs to be doubled to actually retain the one.  If not vba thinks the string ends."}, {"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1514316653, "post_id": 47982809, "comment_id": 82934378, "body": "How do I actually use that answer without ActiveSheet.Evaluate?! The MsgBox shows the formula. Not the sum."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1514316708, "post_id": 47982809, "comment_id": 82934397, "body": "You have to use the evaluate with my answer, otherwise you need to use the method on the duplicate."}, {"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1514361712, "post_id": 47982809, "comment_id": 82945567, "body": "Is it also possible to use SumIfs and Range within an UDF without passing the RANGE as function parameter? \u2013 fabian 2 mins ago   edit"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1514317058, "last_edit_date": 1514317058, "creation_date": 1514315851, "answer_id": 47982809, "question_id": 47982724, "link": "https://stackoverflow.com/questions/47982724/how-to-use-or-operator-with-sumifs/47982809#47982809", "title": "How to use OR Operator with SumIfs()", "body": "<p>Slightly different approach than the duplicate, Use Evaluate to evaluate the worksheet formula.</p>\n\n<pre><code>Dim Sm As Long\n\nSm = ActiveSheet.Evaluate(\"Sum(SumIfs(REVENUE, UNIT, \"\"avengers\"\", region, {\"\"north\"\", \"\"south\"\", \"\"west\"\"}))\")\n\nMsgBox Sm\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1514316052, "post_id": 47982815, "comment_id": 82934209, "body": "this should be a comment. Not an answer exactly. You might get down votes for this. :)"}, {"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1514316103, "post_id": 47982815, "comment_id": 82934223, "body": "@cyboashu I know I might (oops), but it does answer the question."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1514316143, "post_id": 47982815, "comment_id": 82934234, "body": "yep... agreed ."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1514316492, "post_id": 47982815, "comment_id": 82934331, "body": "@cyboashu I always forget that one must use late binding to make this work."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514316812, "post_id": 47982815, "comment_id": 82934435, "body": "@Sercho as you are correct that duplicate answers the question, please provide how to use that in this instance.  Link only answers, especially ones that point to a duplicate here, are usually down voted.  If you keep the link and show how to use it in this specific instance then it becomes an answer, that no one should down vote."}, {"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514316939, "post_id": 47982815, "comment_id": 82934472, "body": "@ScottCraner understood, will amend."}, {"owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1514361533, "post_id": 47982815, "comment_id": 82945494, "body": "Is it possible to use SumIfs and Range within an UDF without passing the RANGE as function parameter?"}, {"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "reply_to_user": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "edited": false, "score": 0, "creation_date": 1514363985, "post_id": 47982815, "comment_id": 82946372, "body": "@fabian that would be a whole other question. You should post it separately and see what people think"}], "tags": [], "owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "is_accepted": true, "score": 3, "last_activity_date": 1514317501, "last_edit_date": 1514317501, "creation_date": 1514315893, "answer_id": 47982815, "question_id": 47982724, "link": "https://stackoverflow.com/questions/47982724/how-to-use-or-operator-with-sumifs/47982815#47982815", "title": "How to use OR Operator with SumIfs()", "body": "<p>Try googling \u201cVBA excel sumifs Or\u201d and you will find result #1:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/42931598/vba-sumifs-with-or\">VBA - SumIfs with Or</a></p>\n\n<pre><code>Dim Sum as Double\nDim Revenue As Range, Unit As Range, Region As Range\n\n'You will need to define your ranges.\nSet Revenue = Range(\"\")\nSet Unit ...\nSet Region ...\n\nSum = Application.Sum(Application.SumIfs(Revenue, Regions, Unit, \"Avengers\", Array(\"North\", \"south\",\"west\")))\n</code></pre>\n"}], "owner": {"reputation": 5203, "user_id": 272741, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/451ef6ae8db697c20ac425f88eb3f858?s=128&d=identicon&r=PG", "display_name": "fabian", "link": "https://stackoverflow.com/users/272741/fabian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "closed_date": 1514316139, "accepted_answer_id": 47982815, "answer_count": 2, "score": -1, "last_activity_date": 1514317501, "creation_date": 1514315288, "question_id": 47982724, "link": "https://stackoverflow.com/questions/47982724/how-to-use-or-operator-with-sumifs", "closed_reason": "Duplicate", "title": "How to use OR Operator with SumIfs()", "body": "<p>How do I use SumIfs to sum if 1 out of 3 criteria (=OR) matches?</p>\n\n<p>How can I use OR for the criteria? Here is the pseudocode.</p>\n\n<pre><code>Sub SumDemo()\n\n    Dim Sum\n\n    Sum = Application.WorksheetFunction.SumIfs([REVENUE], [UNIT], \"=avengers\", [region], \"=north OR =south OR = west\")\n\n    MsgBox Sum\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "edit", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1514312947, "post_id": 47982260, "comment_id": 82933117, "body": "Posible duplicated with <a href=\"https://stackoverflow.com/questions/31042383/vba-to-enable-editing\" title=\"vba to enable editing\">stackoverflow.com/questions/31042383/vba-to-enable-editing</a>"}, {"owner": {"reputation": 53, "user_id": 5851978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8475b73b1d89a2a1f84084ba8c75e709?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/5851978/tony"}, "edited": false, "score": 0, "creation_date": 1514313717, "post_id": 47982260, "comment_id": 82933361, "body": "I tried that solution and still came with the same result. I should have posted that in the questions. Sorry, I am still getting use to the forums."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514327022, "post_id": 47982260, "comment_id": 82937634, "body": "Have you tried <code>For w = wCount To 1 Step -1</code>? I have never used <code>ProtectedViewWindows</code> but I assume when <code>w</code> is <code>1</code> and the <code>.Edit</code> is performed, <code>ProtectedViewWindows(1)</code> is removed from the collection.  And then, when <code>w</code> is <code>2</code>, <code>ProtectedViewWindows(2)</code> will be referring to what was originally the third element of the collection (the second element of the original collection now being <code>ProtectedViewWindows(1)</code>), so you end up only processing every second element.  (And the <code>On Error</code> is masking the subscript out of range errors.)"}, {"owner": {"reputation": 53, "user_id": 5851978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8475b73b1d89a2a1f84084ba8c75e709?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/5851978/tony"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514381198, "post_id": 47982260, "comment_id": 82954132, "body": "@YowE3K Thank you for the suggestion. That made it work perfectly!! Is there a way I can give you credit for solving it?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514402129, "post_id": 47982260, "comment_id": 82963096, "body": "@Tony I have posted an actual &quot;answer&quot; based on my comment."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1514402103, "creation_date": 1514402103, "answer_id": 47997474, "question_id": 47982260, "link": "https://stackoverflow.com/questions/47982260/enable-editing-vba/47997474#47997474", "title": "Enable editing vba", "body": "<p><code>Application.ProtectedViewWindows</code> appears to be a collection of all the protected-view windows.  As soon as you execute the <code>.Edit</code> method on one of those protected-view windows it is no longer in protected-view mode and is therefore removed from the collection.</p>\n\n<p>This means that when you <code>Edit</code> the first member of the collection (when <code>w</code> is <code>1</code>), what was the second member now becomes the first member, what was the third member now becomes the second, etc.  And then on the next iteration of your loop (when <code>w</code> is <code>2</code>) your code is therefore looking at the original third member, having completely ignored looking at the original second member.</p>\n\n<p>The easiest way to fix the issue is to loop through the array in reverse order, i.e. use:</p>\n\n<pre><code>For w = wCount To 1 Step -1\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5851978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8475b73b1d89a2a1f84084ba8c75e709?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/5851978/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2977, "favorite_count": 0, "accepted_answer_id": 47997474, "answer_count": 1, "score": 0, "last_activity_date": 1514402103, "creation_date": 1514312451, "last_edit_date": 1531164843, "question_id": 47982260, "link": "https://stackoverflow.com/questions/47982260/enable-editing-vba", "title": "Enable editing vba", "body": "<p>I am working in Excel 2016. I currently created a macro that will loop through all open workbooks and grab the data in them if they start with the word \"report\". The issue I am trying to solve now is how to enable editing. If the users enable editing after downloading all reports to be combined there is no issue with the macro. They run into issues with the macro not grabbing the data if they missed that button. </p>\n\n<p>While they are not working with that many workbooks, I am trying to make it easier for them. The code that I have posted will do the first 3 workbooks and then continue looping through the remaining 5 but will not \"Enable Edit\".  </p>\n\n<pre><code> Sub EnableEdit()\n\n Dim bk As Workbook\n Dim w As Long, wCount As Long\n\n wCount = Application.ProtectedViewWindows.Count\n Set wsh = ThisWorkbook.Worksheets(\"Data\")\n\n On Error Resume Next\n    If wCount &gt; 0 Then\n        For w = 1 To wCount\n            Application.ProtectedViewWindows(w).Activate\n            Application.ProtectedViewWindows(w).Edit\n\n            If Left(ActiveWorkbook.Name, 6) = \"report\" Then\n                ActiveWorkbook.Worksheets(1).Range(\"A1:Z1\").Copy _\n                    Destination:=wsh.Range(\"A1\")\n                nrow = wsh.Cells(Rows.Count, 1).End(xlUp).Row + 1\n                ActiveWorkbook.Worksheets(1).Range(\"A2:Z500\").Copy _\n                    Destination:=wsh.Range(\"A\" &amp; nrow)\n                ActiveWorkbook.Close\n            End If\n        Next w\n    End If\n On Error GoTo 0\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514312677, "post_id": 47982103, "comment_id": 82933045, "body": "Did it work exactly as you have it? Your <code>If&#47;Else</code> statements don&#39;t really follow convention - do they indeed work as expected?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1514357215, "post_id": 47982103, "comment_id": 82943848, "body": "@BruceWayne It works Bruce and the logic is sickening :). I didn&#39;t get the logic until I ran the code line by line. Silly me."}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1514356829, "last_edit_date": 1514356829, "creation_date": 1514356489, "answer_id": 47987474, "question_id": 47982103, "link": "https://stackoverflow.com/questions/47982103/selecting-multiple-items-to-a-data-validation-field-in-excel/47987474#47987474", "title": "Selecting multiple items to a data validation field in Excel", "body": "<p>I think your problem is on disabling and enabling of events.<br>\nI refactored your code and it works fine. See below:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'Original Code by Sumit Bansal from https://trumpexcel.com\n'To Select Multiple Items from a Drop Down List in Excel\n\n'Refactored error handling...\n    On Error GoTo halt\n    Dim Oldvalue As String, Newvalue As String\n    Application.EnableEvents = False '/* disable events here */\n    If Target.Column = 2 And Target.Row &gt;= 11 And Target.Row &lt;= 27 Then\n        If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n            'GoTo ExitSub \n        Else\n            If Target.Value = \"\" Then GoTo ExitSub\n            Newvalue = Target.Value: Application.Undo\n            Oldvalue = Target.Value\n            If Oldvalue = \"\" Then\n                Target.Value = Newvalue\n            Else\n                If InStr(1, Oldvalue, Newvalue) = 0 Then\n                    Target.Value = Oldvalue &amp; \"/\" &amp; Newvalue\n                Else\n                    Target.Value = Oldvalue\n                End If\n            End If\n        End If\n    End If\n\nExitSub:\n    Application.EnableEvents = True '/* enable before exit */\n    Exit Sub\nhalt:\n    '/* handle error and communicate to user */\n    MsgBox \"Opps, encountered error but dismissed it. See details below:\" &amp; _\n    vbNewLine &amp; Err.Number &amp; \": \" &amp; Err.Description\n    Err.Clear '/* clear the error */ \n    Resume ExitSub '/* make sure to re-enable events */\nEnd Sub\n</code></pre>\n\n<p>I also removed non-relevant codes. HTH.</p>\n"}], "owner": {"reputation": 41, "user_id": 8395493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58912a55a7b4b420beeaf16cbc0a6600?s=128&d=identicon&r=PG&f=1", "display_name": "Seabhach", "link": "https://stackoverflow.com/users/8395493/seabhach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 47987474, "answer_count": 1, "score": 1, "last_activity_date": 1514356829, "creation_date": 1514311365, "last_edit_date": 1531161705, "question_id": 47982103, "link": "https://stackoverflow.com/questions/47982103/selecting-multiple-items-to-a-data-validation-field-in-excel", "title": "Selecting multiple items to a data validation field in Excel", "body": "<p>I have multiple drop down lists on a sheet that sometimes require individuals to input multiple selections within the validated field.  In other words, sometimes they need more than just apples, they need oranges as well; then the data validation field will be apples/oranges.</p>\n\n<p>This code worked until recently, and now for some reason it isn't working, the code is in the \"SHEET\" not in a module in order for it to work specifically within that sheet.</p>\n\n<p>Here are the specs on the sheet that may be effecting it: the macros are locked (I've tried leaving it unlocked and it didn't fix it).  There are two sheets in the same workbook that have similar code (I tried deleting the script out of the other sheet and it didn't fix it).  There is one other question out there that is pretty close to this but has no answers, so hopefully \"Knowing\" that this code worked but now doesn't maybe someone can check it out for me.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'Code by Sumit Bansal from https://trumpexcel.com\n' To Select Multiple Items from a Drop Down List in Excel\nDim Oldvalue As String\nDim Newvalue As String\nApplication.EnableEvents = True\nOn Error GoTo Exitsub\nIf Target.Column = 2 And Target.Row &gt; 11 And Target.Row &lt; 27 Then\n    If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n        GoTo Exitsub\n    Else: If Target.Value = \"\" Then GoTo Exitsub Else\n        Application.EnableEvents = False\n        Newvalue = Target.Value\n        Application.Undo\n        Oldvalue = Target.Value\n        If Oldvalue = \"\" Then\n            Target.Value = Newvalue\n        Else\n            If InStr(1, Oldvalue, Newvalue) = 0 Then\n                Target.Value = Oldvalue &amp; \"/\" &amp; Newvalue\n            Else:\n                Target.Value = Oldvalue\n            End If\n        End If\n    End If\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "vpn"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1514312044, "post_id": 47982026, "comment_id": 82932826, "body": "Can you connect to the mapped drive via Windows Explorer while on VPN?"}, {"owner": {"reputation": 1, "user_id": 9142439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1e442318fa9370ceec2a1431c274d9?s=128&d=identicon&r=PG&f=1", "display_name": "Scott H", "link": "https://stackoverflow.com/users/9142439/scott-h"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1514314794, "post_id": 47982026, "comment_id": 82933768, "body": "Yes I can connect and open the file just fine on VPN."}], "owner": {"reputation": 1, "user_id": 9142439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1e442318fa9370ceec2a1431c274d9?s=128&d=identicon&r=PG&f=1", "display_name": "Scott H", "link": "https://stackoverflow.com/users/9142439/scott-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514311496, "creation_date": 1514310824, "last_edit_date": 1514311496, "question_id": 47982026, "link": "https://stackoverflow.com/questions/47982026/vba-run-time-1004-error-when-connected-via-vpn", "title": "VBA run time &#39;1004&#39; error when connected via VPN", "body": "<p>I've searched through several forums and have found similar questions, but not my specific problem.</p>\n\n<p>I have a macro that saves the active workbook to the specific user's folder, and saves a dated, xlsx, version in a sub folder. My macro-enable workbook is used by both in-office and remote associates. The in-office associates have no issue using this macro to save &amp; archive the workbook to their folder, and, up until last week, the remote associates using VPN had no issues either. </p>\n\n<p>However, over the past few days the remote associates using VPN have been receiving an error like <code>run time error '1004': The specified dimensions are not valid for the current chart type</code> and the code hangs on the <code>ActiveWorkbook.SaveAs</code> line at the end. Why would this error be coming up for a <code>.SaveAs</code> issue? I'm at a loss.</p>\n\n<pre><code>MainPath = \"O:\\Revenue Management\\Centralized Revenue Management Service\\CRMS Hotels\\\"\nsPathSeek = MainPath &amp; strPropNo &amp; \"*\"\nsFile = Dir(sPathSeek, vbDirectory)\nsFileCheck = MainPath &amp; sFile &amp; \"\\Strategy Pack\"\nsBuildHist = MainPath &amp; sFile &amp; \"\\Strategy Pack\\\" &amp; year1 &amp; \"\\\"\nfilePath = MainPath &amp; sFile &amp; \"\\Strategy Pack\\\" &amp; propNo &amp; \" Strategy Pack.xlsm\"\nhistPath = MainPath &amp; sFile &amp; \"\\Strategy Pack\\\" &amp; year1 &amp; \"\\\" &amp; propNo &amp; \" Strategy Pack \" &amp; STRdate &amp; \".xlsx\"\niLength = Len(Dir(sFileCheck, vbDirectory))\niLength2 = Len(Dir(sBuildHist, vbDirectory))\n\nIf iLength = 0 Then\nMkDir (sFileCheck)\nEnd If\n\nIf iLength2 = 0 Then\nMkDir (sBuildHist)\nEnd If\n\n'Save Master Workbook\nApplication.DisplayAlerts = False\nActiveWorkbook.SaveAs FileName:=filePath,\n\nFileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n</code></pre>\n\n<p>The file I am trying to save over is also a .xlsm file.\nI've tried removing all charts.\nI've tried re-saving the master file.</p>\n\n<p><sub>It's worth noting that the same day this started happening, my VPN access would not log in until our systems administrator unlocked it (which was a first)</sub></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1514310058, "post_id": 47981844, "comment_id": 82932205, "body": "In the third <code>With</code> block you are assinging <code>lastrow</code> instead of <code>comlast</code>."}, {"owner": {"reputation": 17, "user_id": 9142429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f8be4c25cce1f7a01a5bb76c76b766?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/9142429/ian"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1514310159, "post_id": 47981844, "comment_id": 82932241, "body": "Thank you! Failed to pick that up. I&#39;ve corrected it and the same error is still coming up"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1514310311, "post_id": 47981844, "comment_id": 82932289, "body": "Now you need to debug and inspect the three values at the point before assigning the formulas."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1514310435, "post_id": 47981844, "comment_id": 82932327, "body": "You also need to <a href=\"https://stackoverflow.com/q/2656443/11683\">qualify</a> the nested <code>Cells(lastrow, lastcol)</code> with the sheet object."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514310875, "post_id": 47981844, "comment_id": 82932447, "body": "On which line do you get the error?"}, {"owner": {"reputation": 17, "user_id": 9142429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f8be4c25cce1f7a01a5bb76c76b766?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/9142429/ian"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1514311031, "post_id": 47981844, "comment_id": 82932507, "body": "@Scott Craner: the last line before end sub"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1514311182, "post_id": 47981844, "comment_id": 82932549, "body": "Then your answer is in the @gserg last comment. <code>...Sheets(&quot;Formula&quot;).Range(Sheets(&quot;Formula&quot;).Cells(2, &quot;D&quot;), Sheets(&quot;Formula&quot;).Cells(lastrow, lastcol))...</code>"}, {"owner": {"reputation": 17, "user_id": 9142429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f8be4c25cce1f7a01a5bb76c76b766?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/9142429/ian"}, "edited": false, "score": 0, "creation_date": 1514311482, "post_id": 47981844, "comment_id": 82932657, "body": "Appreciate the help Scott and GSerg, I understand now. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "reply_to_user": {"reputation": 17, "user_id": 9142429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f8be4c25cce1f7a01a5bb76c76b766?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/9142429/ian"}, "edited": false, "score": 0, "creation_date": 1514324343, "post_id": 47982940, "comment_id": 82936895, "body": "@Ian if that doesn\u2019t work still, you may have to use .Range(Cells(last Row,last Col).Address) instead of .cells(last Row,last Col)"}, {"owner": {"reputation": 17, "user_id": 9142429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f8be4c25cce1f7a01a5bb76c76b766?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/9142429/ian"}, "edited": false, "score": 0, "creation_date": 1514325536, "post_id": 47982940, "comment_id": 82937243, "body": "Got it to work after Scott and GSerg&#39;s help but I&#39;ll look up .address for future reference"}, {"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "reply_to_user": {"reputation": 17, "user_id": 9142429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f8be4c25cce1f7a01a5bb76c76b766?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/9142429/ian"}, "edited": false, "score": 0, "creation_date": 1514326549, "post_id": 47982940, "comment_id": 82937507, "body": "@Ian no worries"}], "tags": [], "owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "is_accepted": true, "score": 0, "last_activity_date": 1514316650, "creation_date": 1514316650, "answer_id": 47982940, "question_id": 47981844, "link": "https://stackoverflow.com/questions/47981844/combining-r1c1-in-vba-with-a-dynamic-range/47982940#47982940", "title": "Combining R1C1 in vba with a dynamic range", "body": "<p>I would change the following:</p>\n\n<pre><code>Dim comlast As Long\nWith Sheets(\"Combined\")\n    Comlast = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n</code></pre>\n\n<p>And</p>\n\n<pre><code>With Sheets(\"Formula\")\n    .Range(\"D2\").FormulaR1C1 = \"=IFERROR(VLOOKUP(RC3&amp;\"\" | \"\"&amp;R1C,Combined!R2C3:R\" &amp; comlast &amp; \"C4, 2, FALSE),\"\" \"\")\"\n    .Range(\"D2\").AutoFill Destination:=.Range(\"D2:D\" &amp; lastrow), Type:=xlFillDefault\n    .Range(\"D2:D\" &amp; lastrow).AutoFill Destination:=.Range(Cells(2, \"D\"), .Cells(lastrow, lastcol)), Type:=xlFillDefault\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9142429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24f8be4c25cce1f7a01a5bb76c76b766?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/9142429/ian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1305, "favorite_count": 0, "accepted_answer_id": 47982940, "answer_count": 1, "score": 0, "last_activity_date": 1514316650, "creation_date": 1514309625, "last_edit_date": 1531164843, "question_id": 47981844, "link": "https://stackoverflow.com/questions/47981844/combining-r1c1-in-vba-with-a-dynamic-range", "title": "Combining R1C1 in vba with a dynamic range", "body": "<p>I'm trying to use a <code>vlookup</code> in <code>sheets(\"formula\").range(\"D3\")</code> and autofill it to all cells between D3 and the cell in the last row and last column in <code>sheets(\"formula\")</code>. The lookup values are in <code>sheets(\"combined\")</code> which has a dynamic range in terms of the number or rows. Here is my code so far:</p>\n\n<pre><code>Sub Vlookup ()\n    Dim lastcol As Integer\n    With Sheets(\"Formula\")\n        lastcol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\n\n    Dim lastrow As Long\n    With Sheets(\"Formula\")\n        lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    Dim comlast As Long\n    With Sheets(\"Combined\")\n        lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    Sheets(\"Formula\").Range(\"D2\").FormulaR1C1 = \"=IFERROR(VLOOKUP(RC3&amp;\"\" | \"\"&amp;R1C,Combined!R2C3:R\" &amp; comlast &amp; \"C4, 2, FALSE),\"\" \"\")\"\n    Sheets(\"Formula\").Range(\"D2\").AutoFill Destination:=Sheets(\"Formula\").Range(\"D2:D\" &amp; lastrow), Type:=xlFillDefault\n    Sheets(\"Formula\").Range(\"D2:D\" &amp; lastrow).AutoFill Destination:=Sheets(\"Formula\").Range(Cells(2, \"D\"), Cells(lastrow, lastcol)), Type:=xlFillDefault\nEnd Sub\n</code></pre>\n\n<p>I'm getting a run-time error '1004': application-defined or object-defined error.</p>\n\n<p>Any assistance would be appreciated</p>\n"}, {"tags": ["vba", "excel", "powershell"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1514309009, "post_id": 47980831, "comment_id": 82931904, "body": "what is this number format <code>TT.MM. hh:mm</code>, it is not a valid format in Excel."}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1514313650, "post_id": 47980831, "comment_id": 82933339, "body": "@cyboashu Your comment is right for the non localized (or en-US) version of Excel. If the display language is set to another value, you may get other valid format strings."}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1514313982, "post_id": 47980831, "comment_id": 82933463, "body": "@cyboashu That date-time will be displayed as &quot;27.12. 13:45&quot; if you entered this with the GUI. But I need to setbit by script."}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1514314169, "post_id": 47980831, "comment_id": 82933538, "body": "Display language is &quot;German (Deutschland)&quot; also shown as DE-DE."}], "answers": [{"tags": [], "owner": {"reputation": 799, "user_id": 6429085, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bab17b514830fc30db635706cce00f0?s=128&d=identicon&r=PG&f=1", "display_name": "michael", "link": "https://stackoverflow.com/users/6429085/michael"}, "is_accepted": true, "score": 0, "last_activity_date": 1514315059, "creation_date": 1514315059, "answer_id": 47982686, "question_id": 47980831, "link": "https://stackoverflow.com/questions/47980831/assign-excel-number-format-from-string-variable/47982686#47982686", "title": "Assign Excel number format from string variable", "body": "<p>Use <code>NumberFormatLocal</code> instead of <code>NumberFormat</code> to get/set a localized format:</p>\n\n<pre><code>$axis.TickLabels.NumberFormatLocal = $fmt\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1514644203, "post_id": 47982729, "comment_id": 83039632, "body": "If I read the CategoryType instead of setiing it, I get already the value 2. That&#39;s no surprise, because the data column the is the source for the x-axis is already a list of date-time values.  Well with that background I could not get any help from your answer. Thank you, anyway."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 2, "last_activity_date": 1514315333, "creation_date": 1514315333, "answer_id": 47982729, "question_id": 47980831, "link": "https://stackoverflow.com/questions/47980831/assign-excel-number-format-from-string-variable/47982729#47982729", "title": "Assign Excel number format from string variable", "body": "<p>The issue is not with number format. </p>\n\n<p>You need to set your axis type to Text before you can add a date to it and apply custom format (with time bits) on top of that. </p>\n\n<p>This works:</p>\n\n<pre><code>$chart.Axes(1).CategoryType =2\n$axis= $chart.axes(1)\n$axis.TickLabels.NumberFormat = \"DD.MM. hh:mm\"\n</code></pre>\n\n<p>where as if you leave the Axix category to default/automatic, the number format doesn't work as expected.</p>\n\n<pre><code>$axis= $chart.axes(1)\n$axis.TickLabels.NumberFormat = \"DD.MM. hh:mm\"\n</code></pre>\n\n<p>You have a time format in your number formatting and apart from scatter charts nothing else support that on an axis. So you need to first change your axis type.</p>\n"}], "owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 47982686, "answer_count": 2, "score": 3, "last_activity_date": 1514315333, "creation_date": 1514303395, "last_edit_date": 1514313459, "question_id": 47980831, "link": "https://stackoverflow.com/questions/47980831/assign-excel-number-format-from-string-variable", "title": "Assign Excel number format from string variable", "body": "<p>I create an Excel workbook using a PowerShell script. The workbook consists a chart with two axes. The number format for one axis shall be set to a localized custom date-time-format.</p>\n\n<p>The standard format is prepared as a shorter version of the long date format: </p>\n\n<pre><code>[string]$fmt = \"MM/dd hh:mm\"\n</code></pre>\n\n<p>The script evaluates the automatically created axis NumberFormat member and uses a different string if the NumberFormat is already localized:</p>\n\n<pre><code>if ($axis.TickLabels.NumberFormat.Contains(\"JJJJ\")) {\n  $fmt = \"TT.MM. hh:mm\"\n}\n</code></pre>\n\n<p>Finally the script tries to assign the string to the axis member:</p>\n\n<pre><code> $axis.TickLabels.NumberFormat = $fmt\n</code></pre>\n\n<p>But this format is not accepted by the axis object. If I read back the value I get \"Standard\".</p>\n\n<p>Even this code resets the number format to standard:</p>\n\n<pre><code> $fmt = $axis.TickLabels.NumberFormat\n $axis.TickLabels.NumberFormat = $fmt\n</code></pre>\n\n<p>How can I set a custom date-time-format?</p>\n\n<p><strong>Edit:</strong>\nThe standard date-time-format for the localization DE-DE is \"TT.MM.JJJJ hh:mm\". Excel uses this as default if the chart is created. That format is valid for DE-DE even it may be unknown in your Excel localization.</p>\n"}, {"tags": ["excel", "office365", "office-2010", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1514305736, "post_id": 47980215, "comment_id": 82930866, "body": "I could not understand your question. Can you try to explain your question?"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1514314199, "post_id": 47980215, "comment_id": 82933549, "body": "@DavidG......The macro goes through a list of units.  For each unit, the macro runs 2 queries.  1 runs against a &quot;current&quot; table (2017 data) and the 1 against a &quot;prior&quot; data table (2014 - 2016).  I watched it run on a user&#39;s machine, and we got an error when the 2nd query ran.  I had updated the macro on a machine with Office 365.  The user&#39;s are running in machines with Office 2010.  Users are telling me the macro is really slow now.  20 - 25 minutes instead of 1 to 2 minutes.  I&#39;m wondering if updating the macro on a machine with Office 365 is having a negative impact for the users.  Thx"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514348817, "post_id": 47980215, "comment_id": 82941496, "body": "<code>we got an error when the 2nd query ran</code> -- which error?  Did Excel crash &amp; close?  What happens if you run the 2nd query manually in the Query Editor (instead of through VBA).  In my experience, the problem is likely unrelated to the upgrade, more likely related to your first line <code>I updated a macro</code>...no offense of course!  What was wrong with the query <b><i>between</i></b> the upgrade and your changes to the query?"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1514470616, "post_id": 47980215, "comment_id": 82986320, "body": "@ashleedawg.....Excel is displaying a message that it has stopped working.  Some users leave the message alone and it eventually completes and returns results but takes much longer.  All queries were using the &quot;submit date&quot; as criteria  The results were incomplete since the &quot;submit date&quot; was blank on some records.  I changed all queries to use &quot;deposit date&quot; since the &quot;deposit date&quot; is never blank.  I&#39;ve checked the code and this is not the issue.  When I run it on my machine (with Office 365)  it runs in 2 minutes or less like it did before the change.  Thanks...."}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1329, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514301006, "creation_date": 1514299950, "last_edit_date": 1531161705, "question_id": 47980215, "link": "https://stackoverflow.com/questions/47980215/macro-does-work-for-users-after-updating-in-in-office-365", "title": "macro does work for users after updating in in Office 365", "body": "<p>I was converted to Office 365 2 weeks ago.  After conversion, I updated a macro that runs 2 queries against an Access database.  I changed the SQL to use a different date field.  The 1st query runs against 2017 data while the 2nd query runs against data from prior years.  The macro runs fine for me.  </p>\n\n<p>FYI: The reason for the different SQL statements is because the queries hit different tables for the US and Canada.  The queries can also be run for a single date or a date range.  The macro has worked for at least 10 years without any issues.  </p>\n\n<p>This macro was sent to field users in the US and Canada who are still on Office 2010.  A number of them have said the macro no longer works for them. They get an error message that says Excel has stopped worked.  I've remoted into a users machine and saw that the issue occurs when the 2nd query is run.</p>\n\n<p>Is there something about updating a macro on Office 365 and then running it on Office 2010?</p>\n\n<p>Thanks for the help.</p>\n\n<pre><code>Sub Get_Data()\n    Application.ScreenUpdating = False\n    Load frmDealers\n    frmDealers.Show\n    Startdate = CalSelDate1\n    Enddate = CalSelDate2\n    Dim MyGroup As String\n    MyGroup = \"\"\n    MyGroup = Cells(5, 6)\n    HowMany = 0\n    Got1 = False\n    Got2 = False\n    GotUS = False\n    GotCN = False\n    If Startdate &lt;&gt; \"12:00:00 AM\" And Enddate = \"12:00:00 AM\" Then Got1 = True\n    If Startdate &lt;&gt; \"12:00:00 AM\" And Enddate &lt;&gt; \"12:00:00 AM\" Then Got2 = True\n    If UCase(Mid(MyGroup, 1, 1)) = \"C\" Then\nGotCN = True\n    Else\n        GotUS = True\n    End If\n    Dim Connection As New ADODB.Connection\n    Dim RecSet1 As ADODB.Recordset\n    Dim Recset2 As ADODB.Recordset\n     Dim vsql As String\n    Dim NoRecs1 As Boolean\n    Dim NoRecs2 As Boolean\n    Dim r As Integer\n    Dim MyRow As Integer\n    Dim MyUnit As String\n    vsql = \"\"\n    NoRecs1 = False\n    NoRecs2 = False\n    r = 6\n    MyRow = 2\n    MyUnit = \"\"\n    Set Connection = New ADODB.Connection\n    Connection.ConnectionString = ConnectionString\n    Connection.Open\n    Do Until Len(Trim(Cells(r, 2))) = 0\n        Cells(r, 2) = UCase(Cells(r, 2))\n        MyUnit = \"\"\n        MyUnit = Cells(r, 2)\n        Application.StatusBar = \"Retrieving data for unit number: \" &amp; MyUnit\n\n        If Got1 = True And GotUS = True Then\n            vsql = \"SELECT\u2026\u2026.\n        End If\n\n    If Got1 = True And GotCN = True Then\n            vsql = \"SELECT\u2026\u2026\u2026\u2026.\n        End If\n\n        If Got2 = True And GotUS = True Then\n            vsql = \"SELECT\u2026\u2026\u2026\u2026\u2026\n        End If\n\n        If Got2 = True And GotCN = True Then\n            vsql = \"SELECT\u2026\u2026\u2026\u2026. \n        End If\n    Set RecSet1 = Connection.Execute(vsql, dbrows, adCmdText)\n\n'       archive table\n        If Got1 = True And GotUS = True Then\n            vsql = \"SELECT\u2026\u2026\u2026\u2026\n        End If\n\n        If Got1 = True And GotCN = True Then\n            vsql = \"SELECT\u2026\u2026\u2026\u2026..\n        End If\n\n        If Got2 = True And GotUS = True Then\n            vsql = \"SELECT\u2026\u2026\u2026\u2026\n        End If\n\n        If Got2 = True And GotCN = True Then\n            vsql = \"SELECT\u2026\u2026\u2026\u2026 \n        End If\n\n        '''' ERROR OCCURS on this line\n        Set Recset2 = Connection.Execute(vsql, dbrows, adCmdText)\n\n        '\u2026other code\n\n        NoRecs1 = False\n        NoRecs2 = False\n     Worksheets(\"Macros\").Activate\n        r = r + 1\n    Loop\n\n    Cells(1, 1).Select\n    Connection.Close\n    Set RecSet1 = Nothing\n    Set Recset2 = Nothing\n\n'''  other code to format data\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514298512, "post_id": 47979779, "comment_id": 82928387, "body": "You need to prefix the asterisk with a tilde (e.g. ~) character to force Excel to explicitly look for an asterisk and not to treat the asterisk as a wildcard."}, {"owner": {"reputation": 257, "user_id": 9021547, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad65f86d10e951794f2478a7c385e93d?s=128&d=identicon&r=PG&f=1", "display_name": "Serge Kashlik", "link": "https://stackoverflow.com/users/9021547/serge-kashlik"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514299721, "post_id": 47979779, "comment_id": 82928797, "body": "So the correct line would be like this?      And Not cellFormula Like &quot;<i>~*</i>&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514306009, "post_id": 47979779, "comment_id": 82930948, "body": "Did you already tried @AntiDrondert suggestion?"}, {"owner": {"reputation": 257, "user_id": 9021547, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad65f86d10e951794f2478a7c385e93d?s=128&d=identicon&r=PG&f=1", "display_name": "Serge Kashlik", "link": "https://stackoverflow.com/users/9021547/serge-kashlik"}, "edited": false, "score": 0, "creation_date": 1514357863, "post_id": 47979779, "comment_id": 82944115, "body": "Yes I did, but it did not help."}], "owner": {"reputation": 257, "user_id": 9021547, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad65f86d10e951794f2478a7c385e93d?s=128&d=identicon&r=PG&f=1", "display_name": "Serge Kashlik", "link": "https://stackoverflow.com/users/9021547/serge-kashlik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514297543, "creation_date": 1514297543, "last_edit_date": 1531164843, "question_id": 47979779, "link": "https://stackoverflow.com/questions/47979779/macro-for-coloring-cells-in-a-financial-model", "title": "Macro for coloring cells in a financial model", "body": "<p>I have a macro for changing the font color of cells based on their type. The code looks like this</p>\n\n<pre><code>Sub ModelColoring()\n\nDim cell As Range, constantCell As Range, formulaCells As Range\nDim cellFormula As String\n\nWith Selection\nOn Error Resume Next\n    Set constantCell = .SpecialCells(xlCellTypeConstants, xlNumbers)\n    Set formulaCells = .SpecialCells(xlCellTypeFormulas, 21)\nOn Error GoTo 0\nEnd With\n\n\nIf Not constantCell Is Nothing Then\n    constantCell.Font.Color = vbBlue\nEnd If\n\nIf Not formulaCells Is Nothing Then\nFor Each cell In formulaCells\n    cellFormula = cell.Formula\n\n    If cellFormula Like \"*.xls*]*!*\" Then\n        cell.Font.Color = RGB(0, 176, 80)\n    ElseIf cellFormula Like \"*!*\" _\n    And Not cellFormula Like \"*\\**\" _\n    And Not cellFormula Like \"*+*\" _\n    And Not cellFormula Like \"*-*\" _\n    And Not cellFormula Like \"*/*\" _\n    And Not cellFormula Like \"*^*\" _\n    And Not cellFormula Like \"*%*\" _\n    And Not cellFormula Like \"*&gt;*\" _\n    And Not cellFormula Like \"*&lt;*\" _\n    And Not cellFormula Like \"*=&lt;*\" _\n    And Not cellFormula Like \"*=&gt;*\" _\n    And Not cellFormula Like \"*&lt;&gt;*\" _\n    And Not cellFormula Like \"*&amp;*\" Then\n        cell.Font.Color = vbRed\n    Else\n    cell.Font.Color = vbBlack\n    End If\nNext cell\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I am having problems with this line</p>\n\n<pre><code>And Not cellFormula Like \"*\\**\"\n</code></pre>\n\n<p>Basically I want all the cells with constants have one font color, those  that perform a calculation to have another and those that derive their value from another sheet a third. However, the above mentioned line does not seem to recognize the multiplication symbol * for some reason and colors the cells that use values from other sheets and multiply them as if they are simply derived from another sheet (i.e. vbRed instead of black).</p>\n"}, {"tags": ["json", "vba", "excel"], "comments": [{"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1514301918, "post_id": 47979461, "comment_id": 82929570, "body": "What is the error description?"}, {"owner": {"reputation": 14667, "user_id": 535480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jBU8R.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/535480/james"}, "edited": false, "score": 1, "creation_date": 1514301972, "post_id": 47979461, "comment_id": 82929593, "body": "Capital <code>R</code> in <code>ReturnValue</code>?"}, {"owner": {"reputation": 1, "user_id": 8214034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c6b778051a37c090bea4145fa165fae?s=128&d=identicon&r=PG&f=1", "display_name": "Santosh Fernandes", "link": "https://stackoverflow.com/users/8214034/santosh-fernandes"}, "edited": false, "score": 0, "creation_date": 1514346802, "post_id": 47979461, "comment_id": 82941137, "body": "The Excel in my computer is behaving irrationally it is converting the Capital R into small r, what could be the reason."}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1514348490, "creation_date": 1514348490, "answer_id": 47986280, "question_id": 47979461, "link": "https://stackoverflow.com/questions/47979461/using-api-parsing-json-object-in-excel-vba/47986280#47986280", "title": "Using API Parsing JSON object in Excel VBA", "body": "<h1><strong>In this case, Capitalization matters!</strong></h1>\n\n<p><strong>ReturnValue</strong> needs to be capitalized properly.</p>\n\n<p>It may be defaulting to a \"small r\" when you type <code>ReturnValue</code> if there are other references to <code>returnValue</code>.  (VBA is trying to be helpful by correcting the word to how you typed it before!)</p>\n\n<h2>In the VBA Editor:</h2>\n\n<ul>\n<li><p>hit <kbd>Ctrl</kbd>+<kbd>H</kbd>.  </p></li>\n<li><p>Enter <code>ReturnValue</code> for <em>both</em> <code>Find What</code> and <code>Replace With</code>.  </p></li>\n<li><p>Make sure <code>Current Project</code> is selected, and that <strong><code>Match Case</code> is unchecked</strong>.</p></li>\n<li><p>Click <code>Replace All</code></p></li>\n</ul>\n\n<p>Every occurrence of the word will be changed to the correct capitalization.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rAmvZ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rAmvZ.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 8214034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c6b778051a37c090bea4145fa165fae?s=128&d=identicon&r=PG&f=1", "display_name": "Santosh Fernandes", "link": "https://stackoverflow.com/users/8214034/santosh-fernandes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 322, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514348490, "creation_date": 1514295791, "last_edit_date": 1514301765, "question_id": 47979461, "link": "https://stackoverflow.com/questions/47979461/using-api-parsing-json-object-in-excel-vba", "title": "Using API Parsing JSON object in Excel VBA", "body": "<p>I have an issue with understanding <a href=\"https://stackoverflow.com/questions/5773683/excel-vba-parsed-json-object-loop\">Excel VBA: Parsed JSON Object Loop</a>.</p>\n\n<p>I need a solution on the below code:</p>\n\n<pre><code>Sub getPricesOnReport()\n\n Dim url As String: url = \"http://statistics.mla.com.au/ReportApi/RunReport?ReportGuid=70587516-e17a-4065-a8aa-e3fe4c512159&amp;FromDate=13%2F03%2F2017&amp;ToDate=18%2F03%2F2017\"\n Dim httpRequest As Object: Set httpRequest = CreateObject(\"MSXML2.XMLHttp\")\n Dim httpResponse As Object\n Dim scriptControl As Object: Set scriptControl = createObject(\"MSScriptControl.ScriptControl\")\n Dim XDOM As ListObject\n\nscriptControl.Language = \"JScript\"\n\nhttpRequest.Open \"GET\", url, False\nhttpRequest.send\n\nSet httpResponse = scriptControl.eval(\"(\" + httpRequest.responseText + \")\")\n\nWith Sheets(\"MLA\")\n\nIf httpResponse.ResponseStatus &lt;&gt; \"OK\" Then\n    MsgBox \"Error in Response\"\nElse\nCells(3, 2).Value = httpResponse.ResponseDate\nCells(3, 3).Value = httpResponse.ResponseHeader\nCells(3, 4).Value = httpResponse.ResponseStatus\nCells(3, 5).Value = httpResponse.ResponseDisclaimer\n'Cells(4, 2).Value = httpResponse.returnValue ' \nEnd If  \nEnd With\nEnd Sub\n</code></pre>\n\n<p><br>\nI am getting an error for the code</p>\n\n<pre><code>Cells(4, 2).Value = httpResponse.returnValue\n</code></pre>\n\n<p>though the object is available.</p>\n\n<p>PFB image:</p>\n\n<p><img src=\"https://i.stack.imgur.com/ZlMu5.png\" alt=\"Json object\"></p>\n\n<p>How do i modify the code to access the data?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1514297310, "post_id": 47979430, "comment_id": 82927970, "body": "What does 1 to 15 have to do with it? Is 15 the number of comboboxes?"}, {"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514298536, "post_id": 47979430, "comment_id": 82928395, "body": "yes. and also textbox"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514298570, "post_id": 47979430, "comment_id": 82928400, "body": "Are these part of a form?"}, {"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514299087, "post_id": 47979430, "comment_id": 82928564, "body": "yes. its part a form"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514299180, "post_id": 47979430, "comment_id": 82928601, "body": "I&#39;m not sure about change events, i don&#39;t really have time to have a play but you might be able to do something via <a href=\"https://stackoverflow.com/questions/30932425/loop-through-comboboxes-vba\">controls</a>"}, {"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514299345, "post_id": 47979430, "comment_id": 82928652, "body": "what is this meant can not change combobox_change command as a whole?"}, {"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514299621, "post_id": 47979430, "comment_id": 82928765, "body": "the above command can be run, but on combobox4, error message appears .. why is that?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514299741, "post_id": 47979430, "comment_id": 82928804, "body": "What is the error message? And what code are you running that generates it?"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "edited": false, "score": 0, "creation_date": 1514306722, "post_id": 47980379, "comment_id": 82931185, "body": "is not this the same as repeating code writing in the following line? I want to control a lot of combobox in one command."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1514300792, "creation_date": 1514300792, "answer_id": 47980379, "question_id": 47979430, "link": "https://stackoverflow.com/questions/47979430/multi-combobox-change-declaration/47980379#47980379", "title": "Multi Combobox Change Declaration", "body": "<p>Learn to loop through controls. Here is a sample of your basic way to interact with your controls in a loop. </p>\n\n<pre><code>    Dim cCont As Control\n    For Each cCont In Me.Controls\n        If TypeName(cCont) = \"CheckBox\" Then\n            Me.Controls(\"TextBox\" &amp; i) =  False\n        End If\n    Next cCont\n    For Each cCont In Me.Controls\n        If TypeName(cCont) = \"TextBox\" Then\n            Me.Controls(\"TextBox\" &amp; i) = \"whatever\"\n        End If\n    Next cCont\n    For Each cCont In Me.Controls\n        If TypeName(cCont) = \"ComboBox\" Then\n            Me.Controls(\"ComboBox\" &amp; i) = \"whatever\"\n        End If\n    Next cCont\n</code></pre>\n\n<p>You can do quite a bit with this <em>if</em> your controls have some kind of consistent naming convention. Your example it looks as if they do, but its worth mentioning b/c a lot of people don't put that much thought into their controls when first starting out. </p>\n\n<p>Also beware that if you have tab strips that this will hit controls on those as well. </p>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "edited": false, "score": 0, "creation_date": 1514307581, "post_id": 47980816, "comment_id": 82931473, "body": "where is combobox?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "edited": false, "score": 0, "creation_date": 1514307629, "post_id": 47980816, "comment_id": 82931480, "body": "What do you mean?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 0, "last_activity_date": 1514307693, "last_edit_date": 1514307693, "creation_date": 1514303317, "answer_id": 47980816, "question_id": 47979430, "link": "https://stackoverflow.com/questions/47979430/multi-combobox-change-declaration/47980816#47980816", "title": "Multi Combobox Change Declaration", "body": "<p>What you are trying to achieve can be done using a procedure and be called 15 times.</p>\n\n<pre><code>Sub MyChange ()\n  For i = 1 to 15\n    Call ChangeCmb(i)\n  Next\nEnd Sub\n</code></pre>\n\n<p>Sub to be called:</p>\n\n<pre><code>Private Sub ChangeCmb(index as Integer)\n    nkm = cmbslno.ListIndex + 1\n    Set wk = Sheets(\"kkm\" &amp; nkm)\n    Me.Controls(\"TextBox\" &amp; i).Text = Application.WorksheetFunction.VLookup(Me.Controls(\"ComboBox\" &amp; i), wk.Range(\"A33:B52\"), 2, 0)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "edited": false, "score": 0, "creation_date": 1514660244, "post_id": 47985442, "comment_id": 83043946, "body": "Can you write example"}], "tags": [], "owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "is_accepted": false, "score": 0, "last_activity_date": 1514339605, "creation_date": 1514339605, "answer_id": 47985442, "question_id": 47979430, "link": "https://stackoverflow.com/questions/47979430/multi-combobox-change-declaration/47985442#47985442", "title": "Multi Combobox Change Declaration", "body": "<p>you can assign code (events) to controls in a loop.</p>\n\n<p>The how to is, by using a class, wich you might find already hundreds of examples easily by searching.</p>\n\n<p>If only certain of your combobox must do some action, in the loop you can test from the control's name or tag for example.</p>\n\n<p>The good thing with class is that you write your events only once, and after you can assign it to nearly a limitless number of controls.</p>\n\n<p>An other way of limiting the affected controls is by putting them into a container : frame, multitab, etc...</p>\n"}], "owner": {"reputation": 87, "user_id": 8184547, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zV1Qj_cFJ30/AAAAAAAAAAI/AAAAAAAAEfI/S7Irmae9XjQ/photo.jpg?sz=128", "display_name": "Yan LimaBenua", "link": "https://stackoverflow.com/users/8184547/yan-limabenua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 47980816, "answer_count": 3, "score": 0, "last_activity_date": 1514339605, "creation_date": 1514295632, "last_edit_date": 1514302422, "question_id": 47979430, "link": "https://stackoverflow.com/questions/47979430/multi-combobox-change-declaration", "title": "Multi Combobox Change Declaration", "body": "<p>is there a simple command for loop combobox_change like the code below?</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    nkm = cmbslno.ListIndex + 1\n    Set wk = Sheets(\"kkm\" &amp; nkm)\n    TextBox1.Text = Application.WorksheetFunction.VLookup(ComboBox1, wk.Range(\"A33:B52\"), 2, 0)\nEnd Sub\nPrivate Sub ComboBox2_Change()\n    nkm = cmbslno.ListIndex + 1\n    Set wk = Sheets(\"kkm\" &amp; nkm)\n    TextBox2.Text = Application.WorksheetFunction.VLookup(ComboBox2, wk.Range(\"A33:B52\"), 2, 0)\nEnd Sub\nPrivate Sub ComboBox3_Change()\n    nkm = cmbslno.ListIndex + 1\n    Set wk = Sheets(\"kkm\" &amp; nkm)\n    TextBox3.Text = Application.WorksheetFunction.VLookup(ComboBox3, wk.Range(\"A33:B52\"), 2, 0)\nEnd Sub\nPrivate Sub ComboBox4_Change()\n    nkm = cmbslno.ListIndex + 1\n    Set wk = Sheets(\"kkm\" &amp; nkm)\n    TextBox4.Text = Application.WorksheetFunction.VLookup(ComboBox4, wk.Range(\"A33:B52\"), 2, 0)\nEnd Sub\n</code></pre>\n\n<p>I want to simplify in one command line</p>\n\n<pre><code>for i = 1 to 15\n......... \"code above\" .....\nnext\n</code></pre>\n"}, {"tags": ["html", "excel", "radio-button", "vba"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1529428720, "last_edit_date": 1529428720, "creation_date": 1529427420, "answer_id": 50933448, "question_id": 47979109, "link": "https://stackoverflow.com/questions/47979109/automating-selection-of-radio-buttons-in-web-form-filling-through-vba/50933448#50933448", "title": "Automating selection of radio buttons in web form filling through vba", "body": "<p>From the HTML you have supplied you can grab the option buttons by their className which is <code>option</code>. You don't show enough HTML to be sure this will limit to the two in sample given. Assuming they do, this returns the following (assume the <code>\".\"</code>  in the image below is <code>className</code> and that the entire query string of <code>.option</code> is the same as <code>.document.getElementsByClassName(\"radio\")</code>. I have replicated the VBA with a CSS query on the HTML.</p>\n\n<p><strong>CSS query: This shows you what elements are captured by the code below</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Wosis.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wosis.png\" alt=\"CSS query\"></a></p>\n\n<hr>\n\n<p><strong>VBA code outline:</strong></p>\n\n<p>We target the option buttons by their class name with the <code>.getElementsByClassName</code> method of the HTML document returned by the instance of IE navigating to the URL and post load. This is a 0 base collection that is returned (as you can see in image above), so you access items by index starting at 0 for first option.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim ie As Object\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    With ie\n        .Visible = True\n        .navigate \"yourURL\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim radioButtons As Object\n        Set radioButtons = .document.getElementsByClassName(\"radio\")\n        radioButtons(0).Click                    '&lt;== first option\n        radioButtons(1).Click                    '&lt;== first option\n\n        'Quit '&lt;== Remember to quit application\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9130729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6902d7d8cc2198584552851e4cc7462?s=128&d=identicon&r=PG&f=1", "display_name": "Payal", "link": "https://stackoverflow.com/users/9130729/payal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 691, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529428720, "creation_date": 1514293766, "last_edit_date": 1531164843, "question_id": 47979109, "link": "https://stackoverflow.com/questions/47979109/automating-selection-of-radio-buttons-in-web-form-filling-through-vba", "title": "Automating selection of radio buttons in web form filling through vba", "body": "<p>I am trying to automate this website using VBA excel. I am struck at a point where I have to select between <code>2 radio buttons</code>. As I am new in VBA so really confuse about the coding part for these radio buttons.\nhere is <strong>HTML</strong> script for the radio button.</p>\n\n<pre><code>&lt;li class=\"required or ok\" id=\"petGenderLI\"&gt;\n            &lt;div class=\"formElTop\" id=\"petGenderMainDiv\"&gt;\n                &lt;div class=\"leftCol\" id=\"petGenderLeftDiv\"&gt;\n\n&lt;label id=\"yourPetGenderField-label\"&gt;&lt;span class=\"petNameToReplace\"&gt;Your pet&lt;/span&gt;'s &lt;span style=\"white-space: nowrap;\"&gt;Gender&lt;/span&gt;&lt;/label&gt;\n\n&lt;/div&gt;\n                &lt;div class=\"rightCol radios\" id=\"petGenderRightDiv\"&gt;\n                    &lt;div class=\"buttonLeft\"&gt;\n                        &lt;input name=\"pets[0].gender\" class=\"radio\" id=\"yourDetailsPolicyHolderPetGender-f0\" type=\"radio\" value=\"NWA_PET_M\" data-di-field-id=\"pets0Gender\"&gt;&lt;label for=\"yourDetailsPolicyHolderPetGender-f0\"&gt;Male&lt;/label&gt;\n                    &lt;/div&gt;\n                    &lt;div class=\"buttonRight\"&gt;\n                        &lt;input name=\"pets[0].gender\" class=\"radio\" id=\"yourDetailsPolicyHolderPetGender-m0\" type=\"radio\" value=\"NWA_PET_F\" data-di-field-id=\"pets0Gender\"&gt;&lt;label for=\"yourDetailsPolicyHolderPetGender-m0\"&gt;Female&lt;/label&gt;\n                    &lt;/div&gt;\n\n                &lt;/div&gt;&lt;span class=\"errorIcon\"&gt;&amp;nbsp;&lt;/span&gt;&lt;div class=\"errorMessage\"&gt;&lt;div class=\"errorTop\"&gt;&lt;div class=\"errorContent\"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n                &lt;div class=\"clearFloat\" id=\"petGenderTailDiv\"&gt;&amp;nbsp;&lt;/div&gt;\n            &lt;/div&gt;\n        &lt;/li&gt;\n</code></pre>\n"}, {"tags": ["vba", "winscp", "winscp-net"], "comments": [{"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514290181, "post_id": 47978324, "comment_id": 82925536, "body": "@ashleedawg wb file is opening that is no issue. issue is not opening winscp"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514290326, "post_id": 47978324, "comment_id": 82925591, "body": "Are you able to  connect to the IP properly <i>manually</i> from your location?"}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514290406, "post_id": 47978324, "comment_id": 82925626, "body": "@ashleedawg by manual it is opening but via script it doesn&#39;t work"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514290801, "post_id": 47978324, "comment_id": 82925754, "body": "can you share some more information, perhaps including a screenshot of successful login or ping test at <a href=\"ftp://103.231.8.66/\" rel=\"nofollow noreferrer\">ftp://103.231.8.66/</a>?  Also, is that the entirety of the code?  What&#39;s the end goal?"}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514291448, "post_id": 47978324, "comment_id": 82925978, "body": "@ashleedawg simple logic i want to add the workbook file into Winscp via vba . now i add the images in post"}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1514296560, "post_id": 47978324, "comment_id": 82927733, "body": "Show us log files for both WinSCP .NET assembly (<code>Session.SessionLogPath</code>) and WinSCP GUI. + Are you running both on the <b>same</b> machine?"}, {"owner": {"reputation": 349, "user_id": 5581639, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd39075f66c34597ec596dc52e653d28?s=128&d=identicon&r=PG&f=1", "display_name": "JG7", "link": "https://stackoverflow.com/users/5581639/jg7"}, "edited": false, "score": 2, "creation_date": 1514305771, "post_id": 47978324, "comment_id": 82930879, "body": "Why in the world did you leave credentials in this?!? Please edit your code and remove the login information. Then please change the password to something new."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 349, "user_id": 5581639, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd39075f66c34597ec596dc52e653d28?s=128&d=identicon&r=PG&f=1", "display_name": "JG7", "link": "https://stackoverflow.com/users/5581639/jg7"}, "edited": false, "score": 0, "creation_date": 1514343561, "post_id": 47978324, "comment_id": 82940489, "body": "@JoeyGrant - I saw that too but I assumed (hoped) they aren&#39;t the real credentials.  Ashok, if that was the real password, you should probably change it on your network (the original posts are still visible online)"}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "reply_to_user": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1514356577, "post_id": 47978324, "comment_id": 82943615, "body": "@MartinPrikryl - Hi Martin, yes i am running on same machine.  I have <code>Session.SessionLogPath</code> log file , i dont know how to get WinSCP GUI.. is it XML file format?"}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "reply_to_user": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1514361858, "post_id": 47978324, "comment_id": 82945613, "body": "@MartinPrikryl Please find the .log and .xml file <a href=\"https://drive.google.com/drive/folders/1_vT6K7tQH5Xd8Y6Hx-i268X-TIgyN2-9\" rel=\"nofollow noreferrer\">drive.google.com/drive/folders/&hellip;</a>"}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1514366231, "post_id": 47978324, "comment_id": 82947259, "body": "Not, it&#39;s not XML file format. Just a regular session log: <a href=\"https://winscp.net/eng/docs/ui_pref_logging\" rel=\"nofollow noreferrer\">winscp.net/eng/docs/ui_pref_logging</a> - Append the logs to your question."}, {"owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "reply_to_user": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1514369335, "post_id": 47978324, "comment_id": 82948669, "body": "@MartinPrikryl have found only one log file in temp folder..i read the what u shared but i dont know how to get it"}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1514369613, "post_id": 47978324, "comment_id": 82948801, "body": "Sorry, but you are too vague. Did you enable logging in the preferences in GUI? What did you do? + Please accept my answer to your previous question."}], "answers": [{"tags": [], "owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "is_accepted": true, "score": 0, "last_activity_date": 1514443801, "creation_date": 1514443801, "answer_id": 48002906, "question_id": 47978324, "link": "https://stackoverflow.com/questions/47978324/error-on-session-open-in-winscp-vba/48002906#48002906", "title": "Error on Session.Open in Winscp - VBA", "body": "<p>Finally found answer my question:  Adding Port No <code>.PortNumber = XXXX</code> in <code>mySessionOptions</code> and i removed <code>Set wb = Workbooks.Open(wb1)</code>. its works perfectly</p>\n"}, {"tags": [], "owner": {"reputation": 11749, "user_id": 2063096, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kYnaM.jpg?s=128&g=1", "display_name": "SoEzPz", "link": "https://stackoverflow.com/users/2063096/soezpz"}, "is_accepted": false, "score": 0, "last_activity_date": 1618935361, "creation_date": 1618935361, "answer_id": 67182624, "question_id": 47978324, "link": "https://stackoverflow.com/questions/47978324/error-on-session-open-in-winscp-vba/67182624#67182624", "title": "Error on Session.Open in Winscp - VBA", "body": "<blockquote>\n<p>WinSCP VBA</p>\n</blockquote>\n<p>WinSCP port number defaults to the protocol being used i.e. SFTP port 22, FTP port 21.</p>\n<p>The session options defaults for Protocol is SFTP with Port 22.</p>\n<p>If you are using SFTP then no port number or protocol is required for sessionOptions.</p>\n<blockquote>\n<p>Below is an example when default SFTP</p>\n</blockquote>\n<pre><code>    Dim mySessionOptions As New SessionOptions\n    With mySessionOptions\n        .HostName = &quot;103.231.8.66&quot;\n        .UserName = &quot;username&quot;\n        .Password = &quot;password&quot;\n        .SshHostKeyFingerprint = &quot;ssh-ed25519 256 df......&quot;\n    End With\n</code></pre>\n"}], "owner": {"reputation": 244, "user_id": 8219745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/461a5f5a7698d5fdb33a067c662a5c50?s=128&d=identicon&r=PG&f=1", "display_name": "Ashok", "link": "https://stackoverflow.com/users/8219745/ashok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 1, "accepted_answer_id": 48002906, "answer_count": 2, "score": -1, "last_activity_date": 1618935361, "creation_date": 1514289439, "last_edit_date": 1514334170, "question_id": 47978324, "link": "https://stackoverflow.com/questions/47978324/error-on-session-open-in-winscp-vba", "title": "Error on Session.Open in Winscp - VBA", "body": "<p>Hi I am trying to upload the file  in WinSCP via VBA. the <code>mySession.Open mySessionOptions</code> got <code>Error - Network error connection to \"103.231.8.66\" time out</code>. i googled but didn't get idea. any suggestion would appreciated </p>\n\n<pre><code> Sub test()\n    Dim wbs As String\n     wbs = \"D:\\Ashok\\Work\\Loan_Input_Template V8-Library.xlsx\"\n    Dim mySession As New Session\n\n        ' Enable custom error handling\n        On Error Resume Next\n\n       Call Upload(mySession, wbs)\n\n        ' Query for errors\n        If Err.Number &lt;&gt; 0 Then\n            MsgBox \"Error: \" &amp; Err.Description\n\n            ' Clear the error\n            Err.Clear\n        End If\n\n        ' Disconnect, clean up\n        mySession.Dispose\n\n        ' Restore default error handling\n        On Error GoTo 0\n\n              '  wb.Close SaveChanges:=True\n\n    'FileSystemObject.DeleteFile sPathName\n\n    End Sub\n\n     Private Sub Upload(ByRef mySession As Session, ByRef wb1 As String)  'error line\n     Dim wb As Workbook\n    Set wb = Workbooks.Open(wb1)\n        ' Setup session options\n        Dim mySessionOptions As New SessionOptions\n        With mySessionOptions\n            .Protocol = Protocol_SFTP\n            .HostName = \"103.231.8.66\"\n            .UserName = \"username\"\n            .Password = \"password\"\n            .SshHostKeyFingerprint = \"ssh-ed25519 256 df:94:44:56:1b:c2:75:8b:b4:58:3a:e2:ef:2e:0d:78\"\n        End With\n\n        ' Connect\n\n        mySession.Open mySessionOptions ' ERROR LINE\n\n        ' Upload files\n        Dim myTransferOptions As New TransferOptions\n        myTransferOptions.TransferMode = TransferMode_Binary\n        Dim transferResult As TransferOperationResult\n\n'i am not sure this line will working or not\n\n        Set transferResult = mySession.PutFiles(wb, \"/home/sftpcf/\", False, myTransferOptions)\n\n        ' Throw on any error\n        transferResult.Check\n\n        ' Display results\n        Dim transfer As TransferEventArgs\n        For Each transfer In transferResult.Transfers\n            MsgBox \"Upload of \" &amp; transfer.FileName &amp; \" succeeded\"\n        Next\n\n    End Sub\n</code></pre>\n\n<p>error msg:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LnE06.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LnE06.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Manual Logging:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GA4td.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GA4td.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1514337087, "post_id": 47978095, "comment_id": 82939479, "body": "It seems to me that the down-votes were applied with a dash of undue haste. This question has more merit than the way it is put."}, {"owner": {"reputation": 69, "user_id": 8822631, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f84b3291e5ac5e4a6cbb86503ef827d3?s=128&d=identicon&r=PG&f=1", "display_name": "K.R. pnx", "link": "https://stackoverflow.com/users/8822631/k-r-pnx"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1514338404, "post_id": 47978095, "comment_id": 82939683, "body": "Sorry, my English is not good, may not express clearly, can anyone know my code where there is a problem, provide a point to help I am very grateful"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8822631, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f84b3291e5ac5e4a6cbb86503ef827d3?s=128&d=identicon&r=PG&f=1", "display_name": "K.R. pnx", "link": "https://stackoverflow.com/users/8822631/k-r-pnx"}, "edited": false, "score": 0, "creation_date": 1514339952, "post_id": 47985444, "comment_id": 82939928, "body": "thanks, I changed <code>Str(strText)</code> to <code>CInt(strText)</code> is access to do"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 69, "user_id": 8822631, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f84b3291e5ac5e4a6cbb86503ef827d3?s=128&d=identicon&r=PG&f=1", "display_name": "K.R. pnx", "link": "https://stackoverflow.com/users/8822631/k-r-pnx"}, "edited": false, "score": 1, "creation_date": 1514340872, "post_id": 47985444, "comment_id": 82940080, "body": "I&#39;m glad I could help you, kerry. Please mark my answer as &quot;Selected&quot;. Thank you."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1514340328, "last_edit_date": 1514340328, "creation_date": 1514339613, "answer_id": 47985444, "question_id": 47978095, "link": "https://stackoverflow.com/questions/47978095/irbbionx-editbox-how-to-pass-a-reference-to-the-vba-code/47985444#47985444", "title": "IRbbionx &lt;editBox/&gt; How to pass a reference to the VBA code", "body": "<p>The code below will find the number in the caption. You may have to tweak it to find the picture under which that number is found.</p>\n\n<pre><code>Private Sub GoToFigure(ByVal Num As Integer)\n    ' 27 Dec 2017\n\n    Dim Fld As Field\n\n    For Each Fld In ActiveDocument.Fields\n        With Fld\n            If (.Type = wdFieldSequence) And _\n               (InStr(1, .Code, \"figure\", vbTextCompare) &gt; 0) Then\n                If .Result = Num Then\n                    .Select\n                End If\n            End If\n        End With\n    Next Fld\nEnd Sub\n</code></pre>\n\n<p>The Sub's parameter <code>Num</code> is the number of the caption you want to find. Call the sub with code like this.</p>\n\n<pre><code>GoToFigure 1\n</code></pre>\n\n<p>where \"1\" is the number from your EditBox.</p>\n"}], "owner": {"reputation": 69, "user_id": 8822631, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f84b3291e5ac5e4a6cbb86503ef827d3?s=128&d=identicon&r=PG&f=1", "display_name": "K.R. pnx", "link": "https://stackoverflow.com/users/8822631/k-r-pnx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 47985444, "answer_count": 1, "score": -1, "last_activity_date": 1514340328, "creation_date": 1514288350, "last_edit_date": 1514338967, "question_id": 47978095, "link": "https://stackoverflow.com/questions/47978095/irbbionx-editbox-how-to-pass-a-reference-to-the-vba-code", "title": "IRbbionx &lt;editBox/&gt; How to pass a reference to the VBA code", "body": "<pre><code>&lt;editBox id=\"layout_deck_search_replace_locate_Caption_item\"\n                        label=\"Caption Item\"\n                        showLabel=\"false\"\n                        sizeString=\"xxx\"\n                        maxLength=\"3\"\n                        onChange=\"layout_search_replace.jump_to_caption_item\" /&gt;\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/kXrKB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kXrKB.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<pre><code> Sub jump_to_caption_item(ByVal control As IRibbonControl, ByRef strText)\n\n    selection.collapse Direction:=wdCollapseEnd\n\n\n        a = \"Figure \" &amp; Str(strText)\n\n        MsgBox a\n                With selection.Find\n\n                    .Font.Bold = True\n                    .Text = \"Figure \" &amp; Str(strText)\n\n                    .Forward = True\n                    .Wrap = wdFindContinue\n\n                    .MatchWildcards = False\n                    .Replacement.Text = \"\"\n                    .Execute\n\n                End With End Sub\n</code></pre>\n\n<p>Above is my xml and vba code,\nI want to find Figure 1 when i write \"1\" in editbox</p>\n\n<hr>\n\n<p>When I write \"1\" in <strong>editbox</strong>, can msgbox \"Figure 1\", but my word can't go to \"Figure 1\". because <strong>\"Figure \" &amp; Str(strText)</strong> is not a string?</p>\n"}, {"tags": ["excel", "events", "triggers", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514286422, "post_id": 47977567, "comment_id": 82924171, "body": "Could you explain what this macro is <i>doing</i>?  You want a macro to change a cell to trigger an event to run a different macro?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514286806, "post_id": 47977567, "comment_id": 82924335, "body": "Or you&#39;re want the <i>OnChange</i> event to change a cell and trigger an <i>OnChange</i> event?"}, {"owner": {"reputation": 123, "user_id": 9061059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01bcb1f7b3413bf61a61c38338f78354?s=128&d=identicon&r=PG&f=1", "display_name": "milanDD", "link": "https://stackoverflow.com/users/9061059/milandd"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514287788, "post_id": 47977567, "comment_id": 82924686, "body": "This macro is supposed trigger other macros when the cell values changes, these other macros is changing the color of the cells in the target area."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514288580, "post_id": 47977567, "comment_id": 82924973, "body": "@Deldar22 What is value of <code>Application.EnableEvents</code> when you use a macro? If you set it to <code>False</code> at the start of the macro or right before changing cells, it will not trigger <code>Worksheet_Change</code>."}, {"owner": {"reputation": 123, "user_id": 9061059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01bcb1f7b3413bf61a61c38338f78354?s=128&d=identicon&r=PG&f=1", "display_name": "milanDD", "link": "https://stackoverflow.com/users/9061059/milandd"}, "edited": false, "score": 0, "creation_date": 1514288814, "post_id": 47977567, "comment_id": 82925058, "body": "To be honest, I am not sure. It is an old code. I think it can be remove without impacting the code"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514288940, "post_id": 47977567, "comment_id": 82925105, "body": "@Deldar22 Are <code>Macro1</code>,<code>Macro2</code>,<code>Macro3</code> are similiar to each other? Can you post one for example? There might be something that stops macro from triggering."}, {"owner": {"reputation": 123, "user_id": 9061059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01bcb1f7b3413bf61a61c38338f78354?s=128&d=identicon&r=PG&f=1", "display_name": "milanDD", "link": "https://stackoverflow.com/users/9061059/milandd"}, "edited": false, "score": 0, "creation_date": 1514289741, "post_id": 47977567, "comment_id": 82925376, "body": "Yes, of course."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514292973, "post_id": 47977567, "comment_id": 82926491, "body": "The event is not triggered because none of your <code>If</code>s is <code>True</code>?"}, {"owner": {"reputation": 123, "user_id": 9061059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01bcb1f7b3413bf61a61c38338f78354?s=128&d=identicon&r=PG&f=1", "display_name": "milanDD", "link": "https://stackoverflow.com/users/9061059/milandd"}, "edited": false, "score": 0, "creation_date": 1514295605, "post_id": 47977567, "comment_id": 82927420, "body": "No, the cells are having a value. the cells contains is a formula that calculate a value based on cells in other sheets."}], "owner": {"reputation": 123, "user_id": 9061059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/01bcb1f7b3413bf61a61c38338f78354?s=128&d=identicon&r=PG&f=1", "display_name": "milanDD", "link": "https://stackoverflow.com/users/9061059/milandd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 500, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514316351, "creation_date": 1514285904, "last_edit_date": 1531164843, "question_id": 47977567, "link": "https://stackoverflow.com/questions/47977567/worksheet-change-event-not-triggered-when-vba-macro-used", "title": "Worksheet_change Event not triggered when vba macro used", "body": "<p>I have this code: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim C As Range, A As Range, D As Range\n\n    Set C = Range(\"F121:F218\")\n    Set A = Range(\"AB121\")\n    Set D = Range(\"G236:G261\")\n\n    If Not Application.Intersect(C, Range(Target.Address)) _\n        Is Nothing Then Call Macro1 \n\n    If Not Application.Intersect(A, Range(Target.Address)) _\n        Is Nothing Then Call Macro2 \n\n    If Not Application.Intersect(D, Range(Target.Address)) _\n        Is Nothing Then Call Macro3\n\nEnd Sub\n</code></pre>\n\n<p>The code works when I change the target cells by myself in excel, but when I use a macro to change them, event trigger doesn't work.   </p>\n\n<p>What is the reason for this?  </p>\n\n<p>I believe that it is because my target cells is having a formula and even though the value is changing the formula in the cells is not and that is why the trigger is not fired. But then the question is how do I make it trigger by both a value change and calculation? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514281441, "post_id": 47976521, "comment_id": 82922253, "body": "Read <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-specialcells-method-excel\" rel=\"nofollow noreferrer\">documentation</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 3, "last_activity_date": 1514283749, "creation_date": 1514283749, "answer_id": 47977124, "question_id": 47976521, "link": "https://stackoverflow.com/questions/47976521/understanding-the-syntax-of-special-cells-in-excel-vba/47977124#47977124", "title": "Understanding the syntax of &quot;special cells&quot; in Excel VBA", "body": "<p>Looks like:</p>\n\n<pre><code>Set FormulaCell = .SpecialCells(xlCellTypeFormulas, 21)\n</code></pre>\n\n<p>is the same as:</p>\n\n<pre><code>Set FormulaCell = .SpecialCells(xlCellTypeFormulas, xlErrors + xlLogical + xlNumbers)\n</code></pre>\n\n<p>because:</p>\n\n<blockquote>\n  <p>If <em>Type</em> is either <strong><em>xlCellTypeConstants</em></strong> or <strong><em>xlCellTypeFormulas</em></strong> , this argument is used to determine which types of cells to include in the result. These values can be added together to return more than one type. The default is to select all constants or formulas, no matter what the type.</p>\n</blockquote>\n\n<p>and:</p>\n\n<blockquote>\n  <h2><strong><em>XlSpecialCellsValue</em> constants</strong></h2>\n\n<pre><code>xlErrors     +16\n\nxlLogical     +4 \n\nxlTextValues  +2\n\nxlNumbers     +1 \n</code></pre>\n</blockquote>\n\n<p>at:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-specialcells-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-specialcells-method-excel</a></p>\n\n<p>(also, <code>xlCellTypeFormulas</code> is misspelled in your example.)</p>\n"}], "owner": {"reputation": 257, "user_id": 9021547, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ad65f86d10e951794f2478a7c385e93d?s=128&d=identicon&r=PG&f=1", "display_name": "Serge Kashlik", "link": "https://stackoverflow.com/users/9021547/serge-kashlik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2971, "favorite_count": 0, "accepted_answer_id": 47977124, "answer_count": 1, "score": 2, "last_activity_date": 1529865600, "creation_date": 1514280981, "last_edit_date": 1529865600, "question_id": 47976521, "link": "https://stackoverflow.com/questions/47976521/understanding-the-syntax-of-special-cells-in-excel-vba", "title": "Understanding the syntax of &quot;special cells&quot; in Excel VBA", "body": "<p>I have a part of my code that looks like this:</p>\n\n<pre><code>With Selection\n    Set ConstantCell = .SpecialCells(xlCellTypeConstants, xlNumber)\n    Set FormulaCell = .SpecialCells(xltypeformulas, 21)\nEnd With\n</code></pre>\n\n<p>It is part of a macro to color cells with different types of data in them. I understand what this part does but what I want to ask is what does the <code>21</code> represents? I found that in the syntax of this formula it represents some value and I thought that it would only select the cells which have formulas and equal to 21 but that was not the case when I ran the whole macro.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "iif"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 3, "creation_date": 1514281776, "post_id": 47976191, "comment_id": 82922363, "body": "They serve different purposes, so run tests yourself based on your actual data. Further, Nz is only present in Access VBA."}], "answers": [{"tags": [], "owner": {"reputation": 416, "user_id": 7564178, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-q75MbZldt14/AAAAAAAAAAI/AAAAAAAAYPU/6QHQkGiKJYs/photo.jpg?sz=128", "display_name": "Harshit kyal", "link": "https://stackoverflow.com/users/7564178/harshit-kyal"}, "is_accepted": true, "score": 1, "last_activity_date": 1514280230, "creation_date": 1514280230, "answer_id": 47976386, "question_id": 47976191, "link": "https://stackoverflow.com/questions/47976191/iif-and-nz-operator-in-access-sql/47976386#47976386", "title": "IIF and Nz operator in access sql", "body": "<p>Execution of each will be near identical except in extraordinarily large iterations. </p>\n\n<p>In queries - there are a couple of issues I think that stand out.\nFor me those are, the returned data type and the native status of the function.</p>\n\n<p>Immediate If does preserve the data type. Not only that - you can use it to coerce the data type. If you want an Integer back or a Date then you can pass that as your returning parameter. Nz gives you the variant (Text/String) that it wants to give back.</p>\n\n<p>The other issue I mentioned is availability. The Immediate If is implemented by Jet's expression service. The full Access VBA library doesn't need to be loaded to expose it.</p>\n\n<p>In other words - if you create a query such as</p>\n\n<pre><code>SELECT * FROM TableName WHERE IIF(FieldName Is Null, 0, FieldName) = 0\n</code></pre>\n\n<p>then you can execute that query from code libraries external to Access (not requiring an Access connection).</p>\n\n<p>Jet will evaluate the function. (Not that this is a particularly good query - its actually terrible using either function).</p>\n\n<p>The equivalent</p>\n\n<pre><code>SELECT * FROM TableName WHERE Nz(FieldName, 0) = 0\n</code></pre>\n\n<p>relies on the fact that Nz is a member of the Access Application object model. It absolutely requires that it is Access which executes the query. Not necessarily a common problem, but a consideration.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9140459"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 0, "closed_date": 1514297761, "accepted_answer_id": 47976386, "answer_count": 1, "score": -1, "last_activity_date": 1514354748, "creation_date": 1514279136, "last_edit_date": 1514354748, "question_id": 47976191, "link": "https://stackoverflow.com/questions/47976191/iif-and-nz-operator-in-access-sql", "closed_reason": "Needs more focus", "title": "IIF and Nz operator in access sql", "body": "<p>I have used <code>IIF(expression , truePart , falsePart)</code> in my sql query in ms-access-2010. I had also found another operator <code>NZ(expression,falsePart).</code></p>\n\n<p>I want to know which operator is faster in terms of time and space complexity and how ?</p>\n\n<p>Example If I want to fetch records from a table having 10k records . which from the above operator is better to use?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1514279053, "post_id": 47975993, "comment_id": 82921346, "body": "I usually use a dictionary to filter for unique values though i am sure there are other ways. Can you order the data first and then add to a dictionary? Or use VBA SQL query where you Union a Select Distinct Top 5 Order By Asc and Select Distinct Top 5 Order By Desc? Need With ties specified  <a href=\"https://stackoverflow.com/questions/887787/access-sql-using-top-5-returning-more-than-5-results\">example with top</a> , <a href=\"https://stackoverflow.com/questions/23345176/how-to-select-distinct-values-from-one-column-in-adodb-recordset-excel-vba\">example with distinct</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514281005, "post_id": 47975993, "comment_id": 82922064, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1429899/getting-unique-values-in-excel-by-using-formulas-only\">Getting unique values in Excel by using formulas only</a>"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1514289143, "post_id": 47977195, "comment_id": 82925174, "body": "That is +1 for use of Small and Large"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514292761, "post_id": 47977195, "comment_id": 82926433, "body": "@QHarr Thanks, LARGE function accepts Variant so that made it easy i.e. without loop."}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": true, "score": 3, "last_activity_date": 1514284031, "creation_date": 1514284031, "answer_id": 47977195, "question_id": 47975993, "link": "https://stackoverflow.com/questions/47975993/extracting-unique-max-and-min-values-from-a-given-range-with-index-position/47977195#47977195", "title": "Extracting unique Max and Min values from a given range with index position", "body": "<p>You can use Dictionary Object to get such results which QHarr is referring to like below.</p>\n\n<pre><code>Public Sub GetMinMax()\nDim objDict As Object\nDim i As Long\nSet objDict = CreateObject(\"Scripting.Dictionary\")\n'\\\\ Add uniques to list\nFor i = 2 To Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    If Not objDict.exists(Range(\"B\" &amp; i).Value) Then objDict.Add Range(\"B\" &amp; i).Value, Range(\"A\" &amp; i).Value\nNext\n'\\\\ Populate output columns\nRange(\"F1\").Resize(1, 4).Value = Array(\"S.No.\", \"Max\", \"S.No.\", \"Min\")\nFor i = 1 To 5\n    Range(\"G\" &amp; i + 1).Value = Application.Large(objDict.keys, i)\n    Range(\"F\" &amp; i + 1).Value = objDict.Item(Range(\"G\" &amp; i + 1).Value)\n    Range(\"I\" &amp; i + 1).Value = Application.Small(objDict.keys, i)\n    Range(\"H\" &amp; i + 1).Value = objDict.Item(Range(\"I\" &amp; i + 1).Value)\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8323673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b4ec85ed7027324e7f870ecdf3e61e65?s=128&d=identicon&r=PG&f=1", "display_name": "Hola", "link": "https://stackoverflow.com/users/8323673/hola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 47977195, "answer_count": 1, "score": 0, "last_activity_date": 1514298213, "creation_date": 1514277788, "last_edit_date": 1531164843, "question_id": 47975993, "link": "https://stackoverflow.com/questions/47975993/extracting-unique-max-and-min-values-from-a-given-range-with-index-position", "title": "Extracting unique Max and Min values from a given range with index position", "body": "<p>Please have a look at the following given code. It does the work but the code gives the values including the duplicates. (see the output)  </p>\n\n<p>I couldn't figure out how to extract unique vales instead of duplicates.</p>\n\n<pre><code> S.No   Values\n 1      99.501\n 2      99.441\n 3      99.346\n 4      99.683\n 5      99.683\n 6      99.941\n 7      99.326\n 8      99.315\n 9      99.326\n10      99.564\n11      99.565\n12      99.513\n13      99.396\n14      99.676\n15      99.083\n16      99.083\n17      98.886\n18      99.129\n19      99.129\n20      99.73\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>Sub MaxMin()\n\n    Dim Rng As Range, Dn As Range, Lg As String\n    Dim n As Long, c As Long, nRay As Variant\n    Dim Sm As String, Sp As Variant, ac As Long\n    Dim col As Integer, R As Long, t\n    Set Rng = Range(Range(\"b2\"), Range(\"b\" &amp; Rows.Count).End(xlUp))\n    For n = 1 To 5\n        Lg = Lg &amp; IIf(Lg = \"\", Application.Large(Rng, n), \",\" _\n                        &amp; Application.Large(Rng, n))\n        Sm = Sm &amp; IIf(Sm = \"\", Application.Small(Rng, n), \",\" _ \n                        &amp; Application.Small(Rng, n))\n    Next n\n    Sp = Array(Split(Lg, \",\"), Split(Sm, \",\"))\n    ReDim Ray(1 To 11, 1 To 4)\n    Ray(1, 1) = \"S.No\"\n    Ray(1, 2) = \"Max\"\n    Ray(1, 3) = \"S.No\"\n    Ray(1, 4) = \"Min\"\n    For ac = 0 To 1\n        col = IIf(ac = 0, 1, 3)\n        c = 0\n        nRay = Range(Range(\"A2\"), Range(\"b\" &amp; Rows.Count).End(xlUp)).Resize(, 2)\n        c = 1\n        For n = 0 To 4\n            For R = 1 To UBound(nRay, 1)\n                If Not IsEmpty(nRay(R, 2)) And nRay(R, 2) = Val(Sp(ac)(n)) Then\n                    c = c + 1\n                    Ray(c, col) = nRay(R, 1)\n                    Ray(c, col + 1) = nRay(R, 2)\n                    nRay(R, 2) = \"\"\n                    Exit For\n                End If\n            Next R\n        Next n\n    Next ac\n    Range(\"F1\").Resize(6, 4).Value = Ray\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>S.No    Max     S.No    Min\n6       99.941  17      98.886\n20      99.73   15      99.083\n4       99.683  16      99.083\n5       99.683  18      99.129\n14      99.676  19      99.129\n</code></pre>\n\n<p>The modified code should not include \"duplicate\" only \"unique\" 5 max and 5 min values with their index positions.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1514275193, "post_id": 47975525, "comment_id": 82920271, "body": "I think if you delete the entire section that you think has a problem, and instead add in a line saying <code>ActiveCell.Offset(xRow, 0) = xFolder.Name</code> into the section where you are writing out the other info, it will probably work."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 1, "creation_date": 1514275468, "post_id": 47975525, "comment_id": 82920358, "body": "refer <a href=\"https://stackoverflow.com/questions/45154354/how-to-loop-through-all-subfolders-and-get-contents-of-row-1-of-each-excel-file/45156109#45156109\">this</a>"}, {"owner": {"reputation": 1206, "user_id": 7651845, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fa3778b8c2abf35e7ebb2363aba38b23?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Chen", "link": "https://stackoverflow.com/users/7651845/peter-chen"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1514280192, "post_id": 47975525, "comment_id": 82921726, "body": "@YowE3K Great. It works. I think you can answer the question and I will mark it up."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 3, "last_activity_date": 1556641693, "last_edit_date": 1556641693, "creation_date": 1514314379, "answer_id": 47982576, "question_id": 47975525, "link": "https://stackoverflow.com/questions/47975525/get-sub-folders-name-with-files-name-by-vba/47982576#47982576", "title": "Get sub-folders name with files name by VBA", "body": "<p>Your entire</p>\n\n<pre><code>For Each xSubFolder In xSubFolders\n   xSubFolderName = xSubFolder.Name\n   ActiveCell.Offset(xRow, 0) = xSubFolderName\n   xRow = xRow + 1\nNext xSubFolder\n</code></pre>\n\n<p>section is going to fail because you haven't defined <code>xSubFolders</code> at that point.  Even if it didn't fail, it wouldn't do what you wanted because it would be moving the writing of the subfolder name away from the rows where you are writing the file details.</p>\n\n<p>To resolve your issue you should delete that section and simply write the folder name out at the same time as you write the file details:</p>\n\n<pre><code>Private Sub ProcessFolder(fso As FileSystemObject, xFolder As Folder)\n    Dim xFiles As Files\n    Dim xFile As File\n    Dim xSubFolders As Folders\n    Dim xSubFolder As Folder\n    Dim xFileName As String\n    Dim xFileTime As String\n\n    Set xFiles = xFolder.Files\n    Set xSubFolders = xFolder.SubFolders\n    'Adding Column names\n    'This should really be done once in the main procedure, rather than being performed\n    'for every folder processed, but is simply overwriting the information written\n    'last time through so will be inefficient but not incorrect.\n    Cells(1, \"A\").Value = \"SubFolder Name\"\n    Cells(1, \"B\").Value = \"File Name\"\n    Cells(1, \"C\").Value = \"Modified Date/Time\"\n\n    'LOOPS THROUGH EACH FILE NAME IN FOLDER\n    For Each xFile In xFiles\n\n      'EXTRACT INFORMATION FROM FILE NAME\n       xFileName = xFile.Name\n       xFileTime = xFile.DateLastModified\n\n      'INSERT INFO INTO EXCEL\n       ActiveCell.Offset(xRow, 0) = xFolder.Name\n       ActiveCell.Offset(xRow, 1) = xFileName\n       ActiveCell.Offset(xRow, 2) = xFileTime\n       xRow = xRow + 1\n    Next xFile\n\n    Set xSubFolders = xFolder.SubFolders\n    For Each xSubFolder In xSubFolders\n        ProcessFolder fso, xSubFolder\n    Next xSubFolder\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514321110, "post_id": 47982780, "comment_id": 82935855, "body": "&quot;Your original code was going to wipe over the data when you got to each new SubFolder.&quot; - Actually, it wouldn&#39;t - they always wrote to row <code>xRow</code> (a module-scope variable) and incremented that by 1 after each write.  There <b>is</b> an issue in that they initialise <code>xRow</code> to <code>0</code> in <code>Get_MAIN_File_Names</code> when it should be initialised to <code>2</code>, but that&#39;s an issue irrespective of how many subfolders are processed.  (Once they get it fixed to work for the first folder, all the other folders would be correctly written below it.)"}, {"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1514322117, "post_id": 47982780, "comment_id": 82936221, "body": "@YowE3K apologies, I missed the xRow definition. I would still adjust the other parts of your code though, as there is no need to store the data as a separate variable unless you require it later. The only exception to this is for speed of processing, in which case, you could build an array of all the data and then write it all in one hit at the end (probably negligible gains for the numbers of files you want to process)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514322715, "post_id": 47982780, "comment_id": 82936429, "body": "Yeah, I agree that <code>xFileName = xFile.Name</code> is fairly pointless which is why I just added the line to write <code>xFolder.Name</code>, rather than put it into a temporary variable.  (I guess there could be some efficiency gains to put the folder name into a temporary variable so that the <code>.Name</code> property was only accessed once rather than for each file within the folder - but there&#39;s definitely no advantage to storing <code>xFile.Name</code> and <code>DateLastModified</code>.) But I didn&#39;t want to change the OP&#39;s code too much, especially as they already had the answer from the comment so probably would never see it. :D"}, {"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1514324258, "post_id": 47982780, "comment_id": 82936875, "body": "@YowE3K fair enough."}, {"owner": {"reputation": 1206, "user_id": 7651845, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fa3778b8c2abf35e7ebb2363aba38b23?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Chen", "link": "https://stackoverflow.com/users/7651845/peter-chen"}, "edited": false, "score": 0, "creation_date": 1514338649, "post_id": 47982780, "comment_id": 82939722, "body": "Thank to both of you. If there are any efficient code to solve, could you please add to question for reference? I think it is important to learn optimized solution. Appreciate again"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1206, "user_id": 7651845, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fa3778b8c2abf35e7ebb2363aba38b23?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Chen", "link": "https://stackoverflow.com/users/7651845/peter-chen"}, "edited": false, "score": 2, "creation_date": 1514347975, "post_id": 47982780, "comment_id": 82941344, "body": "@PeterChen Unless you have thousands of files, or you are running the code many, many times each day, any improvement to the current solution probably wouldn&#39;t be worth the effort of rewriting it.  And requests for &quot;optimised solutions&quot; for working code should be made on Code Review rather than Stack Overflow."}, {"owner": {"reputation": 1206, "user_id": 7651845, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fa3778b8c2abf35e7ebb2363aba38b23?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Chen", "link": "https://stackoverflow.com/users/7651845/peter-chen"}, "edited": false, "score": 0, "creation_date": 1514361397, "post_id": 47982780, "comment_id": 82945443, "body": "Oh. Honestly I had never heard of <code>Code Review</code>. And I actually have thousands of files... Thank you for comment"}], "tags": [], "owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "is_accepted": false, "score": 1, "last_activity_date": 1514315658, "creation_date": 1514315658, "answer_id": 47982780, "question_id": 47975525, "link": "https://stackoverflow.com/questions/47975525/get-sub-folders-name-with-files-name-by-vba/47982780#47982780", "title": "Get sub-folders name with files name by VBA", "body": "<p>The code you provided is unlikely to work for a number of reasons, have a look at the changes below, which might help:</p>\n\n<pre><code>Private Sub ProcessFolder(FSO as FileSystemObject, xFolder As Folder)\n    Dim xFile as File\n    Dim CurRow As Integer\n\n    'Your original code was going to wipe over the data when you got to each new SubFolder. This should prevent that:\n    For CurRow = 1 to 100000\n        If Range(\"A\" &amp; CurRow).Value = \"\" And Range(\"B\" &amp; CurRow).Value = \"\" Then Exit For\n    Next CurRow\n    If CurRow = 1 then\n            Range(\"A1\").Value = \"Sub Folder Name\"\n            Range(\"B1\").Value = \"File Name\"\n            Range(\"C1\").Value = \"Modified Date/Time\"\n            CurRow = CurRow + 1\n    End If\n\n    Range(\"A\" &amp; CurRow).Value = xFolder.Name\n    CurRow = CurRow + 1\n\n    For Each xFile in xFolder.Files\n        Range(\"B\" &amp; CurRow).Value = xFile.Name\n        Range(\"C\" &amp; CurRow).Value = xFile.DateLastModified\n        CurRow = CurRow + 1\n    Next xFile\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 2, "last_activity_date": 1514435010, "creation_date": 1514435010, "answer_id": 48001548, "question_id": 47975525, "link": "https://stackoverflow.com/questions/47975525/get-sub-folders-name-with-files-name-by-vba/48001548#48001548", "title": "Get sub-folders name with files name by VBA", "body": "<p>Try this version.</p>\n\n<pre><code>Sub TestListFolders()\n\n    Application.ScreenUpdating = False\n\n     'create a new workbook for the folder list\n\n     'commented out by dr\n     'Workbooks.Add\n\n     'line added by dr to clear old data\n    Cells.Delete\n\n     ' add headers\n    With Range(\"A1\")\n        .Formula = \"Folder contents:\"\n        .Font.Bold = True\n        .Font.Size = 12\n    End With\n\n    Range(\"A3\").Formula = \"Folder Path:\"\n    Range(\"B3\").Formula = \"Folder Name:\"\n    Range(\"C3\").Formula = \"Size:\"\n    Range(\"D3\").Formula = \"Subfolders:\"\n    Range(\"E3\").Formula = \"Files:\"\n    Range(\"F3\").Formula = \"Short Name:\"\n    Range(\"G3\").Formula = \"Short Path:\"\n    Range(\"A3:G3\").Font.Bold = True\n\n     'ENTER START FOLDER HERE\n     ' and include subfolders (true/false)\n    ListFolders \"C:\\Users\\Excel\\Desktop\\Coding\\Microsoft Excel\\Work Samples\\Finance\\\", True\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nSub ListFolders(SourceFolderName As String, IncludeSubfolders As Boolean)\n     ' lists information about the folders in SourceFolder\n     ' example: ListFolders \"C:\\\", True\n    Dim FSO As Scripting.FileSystemObject\n    Dim SourceFolder As Scripting.Folder, SubFolder As Scripting.Folder\n    Dim r As Long\n\n    Set FSO = New Scripting.FileSystemObject\n    Set SourceFolder = FSO.GetFolder(SourceFolderName)\n\n     'line added by dr for repeated \"Permission Denied\" errors\n\n    On Error Resume Next\n\n     ' display folder properties\n    r = Range(\"A65536\").End(xlUp).Row + 1\n    Cells(r, 1).Formula = SourceFolder.Path\n    Cells(r, 2).Formula = SourceFolder.Name\n    Cells(r, 3).Formula = SourceFolder.Size\n    Cells(r, 4).Formula = SourceFolder.SubFolders.Count\n    Cells(r, 5).Formula = SourceFolder.Files.Count\n    Cells(r, 6).Formula = SourceFolder.ShortName\n    Cells(r, 7).Formula = SourceFolder.ShortPath\n    If IncludeSubfolders Then\n        For Each SubFolder In SourceFolder.SubFolders\n            ListFolders SubFolder.Path, True\n        Next SubFolder\n        Set SubFolder = Nothing\n    End If\n\n    Columns(\"A:G\").AutoFit\n\n    Set SourceFolder = Nothing\n    Set FSO = Nothing\n\n     'commented out by dr\n     'ActiveWorkbook.Saved = True\n\nEnd Sub\n</code></pre>\n\n<p>As an alternative, you can download the sample file from the link below (click 'Download Now').  That Macro will do a nice job for you.</p>\n\n<p><a href=\"http://learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/\" rel=\"nofollow noreferrer\">http://learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/</a></p>\n"}], "owner": {"reputation": 1206, "user_id": 7651845, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fa3778b8c2abf35e7ebb2363aba38b23?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Chen", "link": "https://stackoverflow.com/users/7651845/peter-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9671, "favorite_count": 0, "accepted_answer_id": 47982576, "answer_count": 3, "score": 4, "last_activity_date": 1556641693, "creation_date": 1514274746, "last_edit_date": 1514351370, "question_id": 47975525, "link": "https://stackoverflow.com/questions/47975525/get-sub-folders-name-with-files-name-by-vba", "title": "Get sub-folders name with files name by VBA", "body": "<p>I want to get <em>subfolders</em> name with files name through Excel VBA.<br>\nWhat I really want is <code>Column A</code> shows <em>subfolders name</em>, <code>Column B</code> shows <em>files name</em>.</p>\n\n<p>Here is my code:  </p>\n\n<pre><code>Option Explicit\n\nPrivate xRow As Long\n\nSub Get_MAIN_File_Names()\n    Dim fso As FileSystemObject\n    Dim xDirect As String\n    Dim xRootFolder As Folder\n    Dim DrawingNumb As String\n    Dim RevNumb As String\n    Dim rootFolderStr As String\n\n    Set fso = New FileSystemObject\n    xRow = 0\n    With Application.FileDialog(msoFileDialogFolderPicker)\n       .Title = \"Select Main File\"\n       .Show\n\n       'PROCESS ROOT FOLDER\n       If .SelectedItems.Count &lt;&gt; 0 Then\n          xDirect = .SelectedItems(1) &amp; \"\\\"\n          Set xRootFolder = fso.GetFolder(xDirect)\n          ProcessFolder fso, xRootFolder\n       End If\n\n    End With\n\nEnd Sub\n\nPrivate Sub ProcessFolder(fso As FileSystemObject, xFolder As Folder)\n    Dim xFiles As Files\n    Dim xFile As File\n    Dim xSubFolders As Folders\n    Dim xSubFolder As Folder\n    Dim xSubFolderName As String\n    Dim xFileName As String\n    Dim xFileTime As String\n\n    Set xFiles = xFolder.Files\n    'Adding Column names\n    Cells(1, \"A\").Value = \"SubFolder Name\"\n    Cells(1, \"B\").Value = \"File Name\"\n    Cells(1, \"C\").Value = \"Modified Date/Time\"\n\n    For Each xSubFolder In xSubFolders\n       xSubFolderName = xSubFolder.Name\n       ActiveCell.Offset(xRow, 0) = xSubFolderName\n       xRow = xRow + 1\n    Next xSubFolder\n\n    'LOOPS THROUGH EACH FILE NAME IN FOLDER\n    For Each xFile In xFiles\n\n      'EXTRACT INFORMATION FROM FILE NAME\n       xFileName = xFile.Name\n       xFileTime = xFile.DateLastModified\n\n      'INSERT INFO INTO EXCEL\n       ActiveCell.Offset(xRow, 1) = xFileName\n       ActiveCell.Offset(xRow, 2) = xFileTime\n       xRow = xRow + 1\n    Next xFile\n\n    Set xSubFolders = xFolder.SubFolders\n    For Each xSubFolder In xSubFolders\n        ProcessFolder fso, xSubFolder\n    Next xSubFolder\n\nEnd Sub\n</code></pre>\n\n<p>However, I don't get what I want. I think the problem is here:  </p>\n\n<pre><code>For Each xSubFolder In xSubFolders\n   xSubFolderName = xSubFolder.Name\n   ActiveCell.Offset(xRow, 0) = xSubFolderName\n   xRow = xRow + 1\nNext xSubFolder\n</code></pre>\n\n<p>Which part do I ignore? Or is there another way to solve?<br>\nI think the code is too long. Maybe inefficient. How to modify the code?</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4657027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3de13cb3dfdd7f96db0c3423591cd0?s=128&d=identicon&r=PG&f=1", "display_name": "Swapnil Wankhede", "link": "https://stackoverflow.com/users/4657027/swapnil-wankhede"}, "edited": false, "score": 0, "creation_date": 1514263698, "post_id": 47973929, "comment_id": 82917447, "body": "Yes, that will work,  thanks a lot for quick suggestion,just wanted to how to click on that specific icons also                                                                 1. Suppose i am login into some organization website and need to click on some option, whether the same kind of technique will work? (after login to webpage , navigate the required web page)"}], "tags": [], "owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "is_accepted": false, "score": 1, "last_activity_date": 1514262962, "creation_date": 1514262962, "answer_id": 47973929, "question_id": 47973861, "link": "https://stackoverflow.com/questions/47973861/how-to-click-on-icons-by-using-vba-code/47973929#47973929", "title": "How to click on Icons by using VBA code", "body": "<p>Why not just navigate to the linked site as per the HTML?</p>\n\n<pre><code>&lt;div class=\"headGNBWrap\"&gt; &lt;div itemscope itemtype=\"https://schema.org/Organization\" class=\"headGNB cloneCont wrap\"&gt;&lt;a itemprop=\"url\" class=\"nLogo fl\" href=\"https://www.naukri.com\"&gt;&lt;img itemprop=\"logo\" src=\"https://static.naukimg.com/s/4/100/i/naukri_Logo.png\" alt=\"Naukri.com, India\u2019s No.1 Job Site\" /&gt;&lt;/a&gt;&lt;ul class=\"midSec menu\"&gt;&lt;li class=\"mActive\"&gt;&lt;a title=\"Search Jobs\" href=\"https://www.naukri.com/browse-jobs\" target=\"_blank\"&gt;&lt;span class=\"topIcon jobs\"&gt;&amp;nbsp;&lt;/span&gt;&lt;div class=\"mTxt\"&gt;Jobs&lt;/div&gt;&lt;/a&gt;&lt;div class=\"subMenu c2\"&gt;&lt;ul&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://www.naukri.com/browse-jobs\" title=\"Browse All Jobs\"&gt;Browse All Jobs&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://www.naukri.com/jobs-by-location\" title=\"Jobs by Location\"&gt;Jobs by Location&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://www.naukri.com/top-skill-jobs\" title=\"Jobs by Skill\"&gt;Jobs by Skill&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://www.naukri.com/top-jobs-by-designations\" title=\"Jobs by Designation\"&gt;Jobs by Designation&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Create Free Job Alert\" href=\"https://www.naukri.com/free-job-alerts\" target=\"_blank\" class=\"\" data-ga-track=\"CreateCJA_Desktop|CreateCJA_Desktop_GNB_HP\"&gt;Create Free Job Alert&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://www.naukri.com/top-company-jobs\" title=\"Jobs by Company\"&gt;Jobs by Company&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://www.naukri.com/jobs-by-category\" title=\"Jobs by Category\"&gt;Jobs by Category&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a data-domain=\"https://www.naukri.com/\" class=\"target_advanceSeachLayer\" target=\"_blank\" href=\"https://www.naukri.com/advanced-search\" title=\"Advanced Search\"&gt;Advanced Search&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href=\"https://www.naukri.com/tieups/tieups.php?othersrcp=5424&amp;id=\" title=\"Post your Resume\"&gt;Post your Resume&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=\"\\'\\'\"&gt;&lt;a href=\"https://www.naukri.com/recruiters\" title=\"Search Recruiters\" target=\"_blank\"&gt;&lt;span class=\"topIcon jobs Recr\"&gt;&amp;nbsp;&lt;/span&gt;&lt;div class=\"mTxt\"&gt;Recruiters&lt;/div&gt;&lt;/a&gt;&lt;div class=\"subMenu\"&gt;&lt;ul&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://www.naukri.com/recruiters/browse-all-recruiters\" title=\"Browse All Recruiters\"&gt;Browse All Recruiters&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://naukrirecruiter.naukri.com?src=128\" title=\"Go to NaukriRecruiter\"&gt;Go to NaukriRecruiter&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=\"\\'\\'\"&gt;&lt;a title=\"Jobs Posted By Top Companies\" href=\"https://www.naukri.com/top-company-jobs\" target=\"_blank\"&gt;&lt;span class=\"topIcon jobs Comp\"&gt;&amp;nbsp;&lt;/span&gt;&lt;div class=\"mTxt\"&gt;Companies&lt;/div&gt;&lt;/a&gt;&lt;div class=\"subMenu\"&gt;&lt;ul&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://www.naukri.com/top-company-jobs\" title=\"Browse All Companies\"&gt;Browse All Companies&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://ambitionbox.com/interviews?utm_source=naukri&amp;utm_medium=gnb\" title=\"Interview Questions\"&gt;Interview Questions&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://ambitionbox.com/companies?utm_source=naukri&amp;utm_medium=gnb\" title=\"About Companies\" rel=\"noindex nofollow\"&gt;About Companies&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://ambitionbox.com/contribute?review_name=CompanyReview&amp;utm_source=naukri&amp;utm_medium=gnb\" title=\"Write Company Review\" rel=\"noindex nofollow\"&gt;Write Company Review&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://ambitionbox.com/contribute?review_name=InterviewAdvice&amp;utm_source=naukri&amp;utm_medium=gnb\" title=\"Write Interview Advice\"&gt;Write Interview Advice&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=\"\\'\\'\"&gt;&lt;a title=\"Naukri FastForward- Resume Services\" href=\"https://resume.naukri.com/resume-services?fftid=100001&amp;id=\" target=\"_blank\"&gt;&lt;span class=\"topIcon jobs Serv\"&gt;&amp;nbsp;&lt;/span&gt;&lt;div class=\"mTxt\"&gt;Services&lt;/div&gt;&lt;/a&gt;&lt;div class=\"subMenu c3\"&gt;&lt;ul class=\"group\"&gt;&lt;li class=\"header1\"&gt;&lt;a title=\"Resume Writing\"&gt;Resume Writing&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://resume.naukri.com/resume-writing-services?fftid=101001\" title=\"Text Resume\"&gt;Text Resume&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://resume.naukri.com/visual-resume-writing-services?fftid=101002\" title=\"Visual Resume\"&gt;Visual Resume&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://resume.naukri.com/resume-quality-score?fftid=101003\" title=\"Resume Quality Score - Free\"&gt;Resume Quality Score - Free&lt;/a&gt;&lt;/li&gt;&lt;li class=\"lastSib\"&gt;&lt;a target=\"_blank\" href=\"https://resume.naukri.com/resume-samples?fftid=101004\" title=\"Resume Samples\"&gt;Resume Samples&lt;/a&gt;&lt;/li&gt;&lt;li class=\"header1\"&gt;&lt;a title=\"Jobs For You\"&gt;Jobs For You&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://resume.naukri.com/job-alerts-on-mobile-mail?fftid=101011#jobmail\" title=\"Jobs4U\"&gt;Jobs4U&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=\"group\"&gt;&lt;li class=\"header1\"&gt;&lt;a&gt;Recruiter Reach&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Resume Display\" href=\"https://resume.naukri.com/resume-display?fftid=101009\" target=\"_blank\"&gt;Resume Display&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"RecruiterConnection\" href=\"https://resume.naukri.com/contact-recruiters-hr?fftid=101010\" target=\"_blank\"&gt;&lt;span class=\"newStatus\"&gt;&lt;/span&gt;RecruiterConnection&lt;/a&gt;&lt;/li&gt;&lt;li class=\"lastSib\"&gt;&lt;a title=\"Priority Applicant\" href=\"https://resume.naukri.com/priority-job-application?fftid=101019\" target=\"_blank\"&gt;&lt;span class=\"newStatus\"&gt;&lt;/span&gt;Priority Applicant&lt;/a&gt;&lt;/li&gt;&lt;li class=\"header1\"&gt;&lt;a&gt;Other&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Help/FAQ\" href=\"https://resume.naukri.com/frequently-asked-questions-faq/?fftid=101013\" target=\"_blank\"&gt;Help / FAQ&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Career Advice\" href=\"https://resume.naukri.com/articles/?fftid=101014\" target=\"_blank\"&gt;Career Advice&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Contact Us\" href=\"https://resume.naukri.com/contact-us?fftid=101015\" target=\"_blank\"&gt;Contact Us&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=\"group\"&gt;&lt;li class=\"header1\"&gt;&lt;a&gt;Courses / Certifications&lt;/a&gt;&lt;/li&gt;&lt;li class=\"club\"&gt;&lt;a title=\"IT &amp; Telecom\" href=\"https://learning.naukri.com/it-telecom-courses-certification-training-ct31?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;IT &amp; Telecom&lt;/a&gt;|&lt;a title=\"PMP\" href=\"https://learning.naukri.com/project-management-courses-certification-training-st313?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;PMP&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Banking &amp; Finance\" href=\"https://learning.naukri.com/banking-finance-analytics-courses-certification-training-ct35?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;Banking &amp; Finance&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"IFRS\" href=\"https://learning.naukri.com/ifrs-certification?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;IFRS&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Data Science , Analytics\" href=\"https://learning.naukri.com/data-science-analytics-courses-certification-training-st309?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;Data Science , Analytics&lt;/a&gt;&lt;/li&gt;&lt;li class=\"club\"&gt;&lt;a title=\"Operations\" href=\"https://learning.naukri.com/bpo-operations-engineering-courses-certification-training-ct41?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;Operations&lt;/a&gt;|&lt;a title=\"Quality\" href=\"https://learning.naukri.com/six-sigma-quality-courses-certification-training-st311?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;Quality&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Digital Marketing\" href=\"https://learning.naukri.com/digital-marketing-courses-certification-training-st301?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;Digital Marketing&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"HR &amp; Admin\" href=\"https://learning.naukri.com/human-resources-administration-courses-certification-training-ct37?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;HR &amp; Admin&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Leadership &amp; Strategy\" href=\"https://learning.naukri.com/leadership-management-courses-certification-training-ct49?utm_source=naukri&amp;utm_medium=naukri_gnb&amp;utm_content=naukri_gnb&amp;utm_campaign=naukri_gnb_top&amp;fftid=naukri_gnb\" target=\"_blank\"&gt;Leadership &amp; Strategy&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li class=\\'\"\"\\'&gt;&lt;a href=\"http://naukri.shiksha.com\" target=\"_blank\"&gt;&lt;span class=\"topIcon jobs More\"&gt;&amp;nbsp;&lt;/span&gt;&lt;div class=\"mTxt\"&gt;More&lt;/div&gt;&lt;/a&gt;&lt;div class=\"subMenu c3\"&gt;&lt;ul class=\"group\"&gt;&lt;li class=\"header1\"&gt;&lt;a&gt;Management and Business&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://www.shiksha.com/mba/mba-home\" title=\"MBA\"&gt;MBA&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://www.shiksha.com/mba/distance-mba-home\" title=\"Distance MBA\"&gt;Distance MBA&lt;/a&gt;&lt;/li&gt;&lt;li class=\"lastSib\"&gt;&lt;a target=\"_blank\" href=\"http://www.shiksha.com/mba/executive-mba-home\" title=\"Executive MBA\"&gt;Executive MBA&lt;/a&gt;&lt;/li&gt;&lt;li class=\"header1\"&gt;&lt;a&gt;Information Technology&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://naukri.shiksha.com/mca-colleges-in-india-categorypage-10-98-1-0-0-1-1-2-0-none-1-1\" title=\"MCA\"&gt;MCA&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=\"group\"&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://naukri.shiksha.com/mca-distance-education-in-india-categorypage-10-97-1-0-0-1-1-2-0-none-1-1\" title=\"Distance MCA\"&gt;Distance MCA&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://naukri.shiksha.com/computer-programming-language-courses-in-india-categorypage-10-105-1-0-0-1-1-2-0-none-1-1\" title=\"Software Courses\"&gt;Software Courses&lt;/a&gt;&lt;/li&gt;&lt;li class=\"lastSib\"&gt;&lt;a target=\"_blank\" href=\"http://naukri.shiksha.com/cisco-certification-courses-in-india-categorypage-10-101-1-0-0-1-1-2-0-none-1-1\" title=\"Hardware Courses\"&gt;Hardware Courses&lt;/a&gt;&lt;/li&gt;&lt;li class=\"header1\"&gt;&lt;a&gt;Animation, Multimedia&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://naukri.shiksha.com/animation-courses-in-india-categorypage-12-89-1-0-0-1-1-2-0-none-1-1\" title=\"Animation\"&gt;Animation&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://naukri.shiksha.com/graphic-designing-courses-in-india-categorypage-12-92-1-0-0-1-1-2-0-none-1-1\" title=\"Graphic Designing\"&gt;Graphic Designing&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://naukri.shiksha.com/web-designing-courses-in-india-categorypage-12-93-1-0-0-1-1-2-0-none-1-1\" title=\"Web Designing\"&gt;Web Designing&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=\"group\"&gt;&lt;li class=\"header1\"&gt;&lt;a&gt;Study Abroad&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"MBA\" href=\"http://studyabroad.shiksha.com/mba-in-abroad-dc11508\" target=\"_blank\"&gt;MBA&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"MS\" href=\"http://studyabroad.shiksha.com/ms-in-abroad-dc11509\" target=\"_blank\"&gt;MS&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"BE/BTech\" href=\"http://studyabroad.shiksha.com/be-btech-in-abroad-dc11510\" target=\"_blank\"&gt;BE/BTech&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=\"group\"&gt;&lt;li class=\"header1\"&gt;&lt;a&gt;More&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://careernavigator.naukri.com\" title=\"Paycheck\"&gt;Paycheck&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://www.naukri.com/mobile\" title=\"Naukri On Mobile\"&gt;Naukri On Mobile&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"http://blogs.naukri.com\" title=\"Naukri Blog\"&gt;Blog&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;li&gt;&lt;a title=\"Jobseeker Login\" href=\"https://login.naukri.com/nLogin/Login.php\" id=\"login_Layer\"&gt;&lt;span class=\"topIcon jobs Login\"&gt;&amp;nbsp;&lt;/span&gt;&lt;div class=\"mTxt\"&gt;Login&lt;/div&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;div class=\"rghtSec fr menu nonLogged\"&gt;&lt;ul class=\"notifySec\"&gt;&lt;li&gt;&lt;a href=\"https://www.naukri.com/recommendedjobs\" target=\"_blank\" class=\"blob\" id=\"blobId\"&gt;&lt;div class=\"topIcon notify\"&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div class=\"mTxt\"&gt;Notifications&lt;span id=\"rJobCntr\" class=\"rJobCntr\"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul class=\"otherSec\"&gt;&lt;li class=\"first-child\"&gt;&lt;a title=\"Employer Login\" href=\"https://login.recruit.naukri.com\" class=\"immediate\" target=\"_blank\"&gt;Employer Zone&lt;/a&gt;&lt;/li&gt;&lt;li class=\"last-child\"&gt;&lt;a title=\"Buy Online- RESDEX and Vacancy Listings\" href=\"https://recruit.naukri.com/rCommerce/demo/buy\" class=\"immediate\" target=\"_blank\"&gt;&lt;div&gt;Buy Online&lt;span class=\"\\&amp;quot;smArw\\&amp;quot;\"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/a&gt;&lt;div class=\"subMenu\"&gt;&lt;ul&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://recruit.naukri.com/rCommerce/demo/buy\" title=\"Buy Online- RESDEX and Vacancy Listings\"&gt;Buy Online&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a target=\"_blank\" href=\"https://recruit.naukri.com/rCommerce/instaPost/default\" title=\"Post an Insta Job\"&gt;Post an Insta Job&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;input type=\"hidden\" domain=\".naukri.com\" id=\"blobNotificationURL\" value=\"https://www.naukri.com/notify\" cache=\"true\" unReg=\"true\"/&gt;&lt;div class=\"septr\"&gt;&lt;/div&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt;\n</code></pre>\n\n<p>You could just navigate to <a href=\"https://www.naukri.com/browse-jobs\" rel=\"nofollow noreferrer\">https://www.naukri.com/browse-jobs</a> once logged in? After all that is all clicking the menu item does.</p>\n"}], "owner": {"reputation": 25, "user_id": 4657027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3de13cb3dfdd7f96db0c3423591cd0?s=128&d=identicon&r=PG&f=1", "display_name": "Swapnil Wankhede", "link": "https://stackoverflow.com/users/4657027/swapnil-wankhede"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "closed_date": 1514291197, "answer_count": 1, "score": -2, "last_activity_date": 1514262962, "creation_date": 1514262124, "last_edit_date": 1514262539, "question_id": 47973861, "link": "https://stackoverflow.com/questions/47973861/how-to-click-on-icons-by-using-vba-code", "closed_reason": "Not suitable for this site", "title": "How to click on Icons by using VBA code", "body": "<p>Can someone please help me with below issue?\nI am trying to develop a web macro which can login into Naukri.com and click on Jobs button Icon and get the job search page; I could able to login into Naukri.com but not sure how to click on Jobs (jobs icons present at top of the page) , below is my code</p>\n\n<p><a href=\"https://i.stack.imgur.com/QiDQi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QiDQi.png\" alt=\"Want to click on red highlighted button and reach to next page\"></a></p>\n\n<pre><code>    Sub Naukari_Login()\n\n\n    'https://login.naukri.com/nLogin/Login.php\n\n\n\n    'Dim ie As SHDocVw.InternetExplorer\n\n    'Set ie = New SHDocVw.InternetExplorer\n\n    Set ie = CreateObject(\"InternetExplorer.application\")\n\n\n\n    ie.Visible = True\n\n    'ie.navigate \"https://www.linkedin.com/m/login/\" '\u2018we are trying to login to askeygeek.com admin page\n\n    ie.navigate \"https://login.naukri.com/nLogin/Login.php\" '\u2018we are trying to login to askeygeek.com admin page\n\n\n    Do\n\n    DoEvents\n\n    Loop Until ie.readyState = 4\n\n\n    Call ie.document.getElementById(\"emailTxt\").setAttribute(\"value\", \"EmailID\")\n    '\u2018 EmailID \u2013 enter your \u2018email ID\n\n    Call ie.document.getElementById(\"pwd1\").setAttribute(\"value\", \"password\")\n\n'\u2018password - Enter your Naukri .com password \n    'Call ie.document.getElementById(\"user_pass\").setAttribute(\"value\", \"Wankhade\")\n\n    '''\n    Set AllInputs1 = ie.document.getElementsByTagName(\"input\") '\u2018you can use any tagname as you wish    For Each hyper_link In AllInputs\n\n    For Each hyper_link In AllInputs1\n\n         Debug.Print hyper_link.Name\n         If hyper_link.Name = \"Login\" Then '\u2018you can use .name, .id etc\n\n            hyper_link.Click\n\n            Exit For\n\n        End If\n    Next\n\n\n    'ie.Quit ' close the web page\n\n    'Set ie = Nothing\n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "commandbutton"], "comments": [{"owner": {"reputation": 1292, "user_id": 1887634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d96d668a832a01e56fae26fc8859bc?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/1887634/alan"}, "edited": false, "score": 1, "creation_date": 1514260739, "post_id": 47973529, "comment_id": 82917015, "body": "Explain in what way it doesn&#39;t work."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1292, "user_id": 1887634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d96d668a832a01e56fae26fc8859bc?s=128&d=identicon&r=PG", "display_name": "Alan", "link": "https://stackoverflow.com/users/1887634/alan"}, "edited": false, "score": 0, "creation_date": 1514262350, "post_id": 47973529, "comment_id": 82917239, "body": "@Alan - the fact that the code is doing a goal seek on sheet1 (because that is the <code>ActiveSheet</code> when the button is pressed) but the question says that the goal seek formula is on sheet2 means &quot;it doesn&#39;t work&quot; in this case refers to &quot;the goal seek isn&#39;t being performed&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9140218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7690b2f8b8bc958d674381dfc22f63?s=128&d=identicon&r=PG&f=1", "display_name": "peterjohn", "link": "https://stackoverflow.com/users/9140218/peterjohn"}, "edited": false, "score": 0, "creation_date": 1514337496, "post_id": 47973644, "comment_id": 82939542, "body": "Thanks for your suggestion, YowE3K. After adding . the error message doesn&#39;t show anymore but the goalseek is still not done on sheet2. Any idea why?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 9140218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7690b2f8b8bc958d674381dfc22f63?s=128&d=identicon&r=PG&f=1", "display_name": "peterjohn", "link": "https://stackoverflow.com/users/9140218/peterjohn"}, "edited": false, "score": 0, "creation_date": 1514348585, "post_id": 47973644, "comment_id": 82941455, "body": "@peterjohn (a) What error message were you getting?  I assumed it simply wasn&#39;t working and even voted to re-open the question on the assumption that there was no error.  You had better edit the question yourself then to explain what &quot;it just doesn&#39;t work&quot; means.  (b) The edited code worked for me, but it will depend on what formulas you have on sheet2 which are calculating Sheet2!O23 (etc) based on Sheet2!N23 (etc)."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1514261880, "last_edit_date": 1514261880, "creation_date": 1514259252, "answer_id": 47973644, "question_id": 47973529, "link": "https://stackoverflow.com/questions/47973529/excel-vba-linking-a-command-to-another-sheet/47973644#47973644", "title": "excel vba linking a command to another sheet", "body": "<p>Because you never qualify your <code>Cells</code> properties with which worksheet they are referring to, they default to referring to <code>ActiveSheet</code> (which will be the sheet on which your button is located), and so your current code is equivalent to</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim J As Variant\n    For J = 23 To 26\n        ActiveSheet.Cells(J, \"o\").GoalSeek Goal:=0, ChangingCell:=ActiveSheet.Cells(J, \"n\")\n    Next J\nEnd Sub\n</code></pre>\n\n<p>You have also included a <code>With Worksheets(\"sheet2\")</code> block in your code, but you never make use of it.</p>\n\n<hr>\n\n<p>The easiest way to fix your issue is simply to ensure that you qualify which worksheet is being referred to and, because you already have a <code>With Worksheets(\"sheet2\")</code> block already in your code, that just means adding the <code>.</code> to specify that your <code>With</code> object is the qualifier of each of your <code>Cells</code> properties:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nWith Worksheets(\"sheet2\")\nFor J = 23 To 26\n      .Cells(J, \"o\").GoalSeek Goal:=0, ChangingCell:=.Cells(J, \"n\")\nNext J\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9140218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f7690b2f8b8bc958d674381dfc22f63?s=128&d=identicon&r=PG&f=1", "display_name": "peterjohn", "link": "https://stackoverflow.com/users/9140218/peterjohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1514283606, "answer_count": 1, "score": 0, "last_activity_date": 1514319948, "creation_date": 1514257498, "last_edit_date": 1514319948, "question_id": 47973529, "link": "https://stackoverflow.com/questions/47973529/excel-vba-linking-a-command-to-another-sheet", "closed_reason": "Not suitable for this site", "title": "excel vba linking a command to another sheet", "body": "<p>I have an ActiveX button on sheet1 but my goal seek formula is on sheet2. When I run it, the cells in column N of sheet2 are not changed. Can anyone fix the code for me?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nWith Worksheets(\"sheet2\")\nFor J = 23 To 26\n      Cells(J, \"o\").GoalSeek Goal:=0, ChangingCell:=Cells(J, \"n\")\nNext J\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "file", "input"], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1514268478, "creation_date": 1514268478, "answer_id": 47974505, "question_id": 47973249, "link": "https://stackoverflow.com/questions/47973249/vba-input-on-a-dataset/47974505#47974505", "title": "VBA Input on A Dataset", "body": "<p>The array size is strange.\nThe following is the data of the csv file.</p>\n\n<pre><code>Sub ReadFileSmall()\n    Dim Infile As String\n    Dim vDB\n    Infile = ThisWorkbook.Path &amp; \"\\Power_smallDataset.csv\"\n\n    Workbooks.Open Filename:=Infile, Format:=2\n    With ActiveSheet\n        vDB = .UsedRange\n    End With\n    ActiveWorkbook.Close (0)\n\n    Range(\"A4\").Resize(UBound(vDB, 1), ubouns(vDB, 2)) = vDB\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9138857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8a596f0f26e87f0f016a8f143f42327?s=128&d=identicon&r=PG&f=1", "display_name": "Chris K", "link": "https://stackoverflow.com/users/9138857/chris-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514268478, "creation_date": 1514253295, "question_id": 47973249, "link": "https://stackoverflow.com/questions/47973249/vba-input-on-a-dataset", "title": "VBA Input on A Dataset", "body": "<p>Thankyou for the time to click on this question. Ive been having problems with placing this data set on my vba code. I always keep on getting a file 'overflow' then a 'file already opened' error. The data set I am using is a data recordings of power consumption over time. And this set of data is meant to be put into 7 arrays. These are the datasets. </p>\n\n<p><a href=\"https://data.world/databeats/household-power-consumption\" rel=\"nofollow noreferrer\">https://data.world/databeats/household-power-consumption</a></p>\n\n<p>What is wrong with my code? Any suggestions? \nThankyou.</p>\n\n<p>My code so far</p>\n\n<pre><code>Dim ID(50) As String, Day(50) As Date\nDim Time(50) As Integer, GlobelActivePower(50) As Integer\nDim Sub1(50) As Integer, Sub2(50) As Integer, Sub3(50) As Integer\nPublic N As Integer\n\nSub ReadFileSmall()\nDim Infile As String\nInfile = ThisWorkbook.Path &amp; \"\\Power_smallDataset.csv\"\n    Open Infile For Input As #1\n    N = 0\n\n    Do Until EOF(1)\n        Input #1, ID(N), Day(N), Time(N), GlobelActivePower(N), Sub1(N), \n        Sub2(N), Sub3(N)\n        N = N + 1\n    Loop\n\nRange(\"A4\").Select\nFor indx = 0 To N - 1\n    ActiveCell.Offset(indx, 0).Value = ID(indx)\n    ActiveCell.Offset(indx, 1).Value = Day(indx)\n    ActiveCell.Offset(indx, 2).Value = Time(indx)\n    ActiveCell.Offset(indx, 4).Value = GlobelActivePower(indx)\n    ActiveCell.Offset(indx, 5).Value = Sub1(indx)\n    ActiveCell.Offset(indx, 6).Value = Sub2(indx)\n    ActiveCell.Offset(indx, 7).Value = Sub3(indx)\nNext\n\nClose #1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 6509536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dbc00b49e5b4da3cf8adb4be0043a04?s=128&d=identicon&r=PG&f=1", "display_name": "jacob spitzer", "link": "https://stackoverflow.com/users/6509536/jacob-spitzer"}, "edited": false, "score": 0, "creation_date": 1514738120, "post_id": 47993798, "comment_id": 83059192, "body": "Not answered My Question!"}, {"owner": {"reputation": 346, "user_id": 6524338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sje7.png?s=128&g=1", "display_name": "billyhoes", "link": "https://stackoverflow.com/users/6524338/billyhoes"}, "reply_to_user": {"reputation": 83, "user_id": 6509536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dbc00b49e5b4da3cf8adb4be0043a04?s=128&d=identicon&r=PG&f=1", "display_name": "jacob spitzer", "link": "https://stackoverflow.com/users/6509536/jacob-spitzer"}, "edited": false, "score": 0, "creation_date": 1514918223, "post_id": 47993798, "comment_id": 83105360, "body": "I refer you then to the first sentence in my answer."}], "tags": [], "owner": {"reputation": 346, "user_id": 6524338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sje7.png?s=128&g=1", "display_name": "billyhoes", "link": "https://stackoverflow.com/users/6524338/billyhoes"}, "is_accepted": false, "score": 1, "last_activity_date": 1514384584, "creation_date": 1514384584, "answer_id": 47993798, "question_id": 47972716, "link": "https://stackoverflow.com/questions/47972716/update-vba-code-to-work-on-accde-file-instant-of-mde/47993798#47993798", "title": "Update VBA Code to work on ACCDE file instant of MDE", "body": "<p>Your question doesn't provide enough clarity to give you a definitive answer.  That said, I can make a guess at what might be your request.</p>\n\n<p>If the issue is with declare statements at the head of your code you may need to add PtrSafe to them.</p>\n\n<p>e.g., Instead of just:</p>\n\n<pre><code>Private Declare Sub Sleep Lib \"kernel32\" (ByVal lngMilliSeconds As Long)\n</code></pre>\n\n<p>it would be</p>\n\n<pre><code>Private Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal lngMilliSeconds As Long)\n</code></pre>\n\n<p>If however, you have people running different versions of office and VBA you'll want to encapsulate it in a precompiled (#) if statement to ensure backwards compatibility with earlier VBA versions.</p>\n\n<p>e.g.,</p>\n\n<pre><code>#If VBA7 Then\n   Private Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal lngMilliSeconds As Long)\n#Else\n   Private Declare Sub Sleep Lib \"kernel32\" (ByVal lngMilliSeconds As Long)\n#End If\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 83, "user_id": 6509536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dbc00b49e5b4da3cf8adb4be0043a04?s=128&d=identicon&r=PG&f=1", "display_name": "jacob spitzer", "link": "https://stackoverflow.com/users/6509536/jacob-spitzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1594638551, "creation_date": 1514244897, "last_edit_date": 1594638551, "question_id": 47972716, "link": "https://stackoverflow.com/questions/47972716/update-vba-code-to-work-on-accde-file-instant-of-mde", "title": "Update VBA Code to work on ACCDE file instant of MDE", "body": "<p>I have a VBA code in Access for some function for MDE file, I want to update the function to work on ACCDE file instant of MDE.\nWhere can i send my code to update it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1514243441, "post_id": 47972428, "comment_id": 82914825, "body": "Read through <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">how to avoid using <code>.Select</code>/<code>.Activate</code></a>, it will help greatly."}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "edited": false, "score": 0, "creation_date": 1514309986, "post_id": 47973832, "comment_id": 82932188, "body": "Thanks for the effort @ Sercho, But this code is not working as expected, Sorry  And Yes,  &quot;Role&quot; is in Column C, and &quot;January&quot; starts in Column D"}, {"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "reply_to_user": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "edited": false, "score": 0, "creation_date": 1514314145, "post_id": 47973832, "comment_id": 82933527, "body": "@dhanya how is the code not working as expected? I need more information if I am to offer help. Your original code just added borders to a range of cells, if you actually explain what you want to achieve, there is a chance I can provide a better answer."}, {"owner": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "edited": false, "score": 0, "creation_date": 1514460778, "post_id": 47973832, "comment_id": 82981588, "body": "Thank you @ Sercho,I am extremely sorry, last time when i use this code it was not working for me (infact i updated some fields on &#39;Set_Basicdetails&#39; and the reason why the code was not working, it was just setting border for 1st line only ), but today when i tried it again with new workbook it worked perfectly, Thank you and sorry for my previous comment..."}, {"owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "reply_to_user": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "edited": false, "score": 0, "creation_date": 1514487471, "post_id": 47973832, "comment_id": 82994336, "body": "@dhanya all good. I was just intrigued by how it wasn\u2019t working, as I had tested it myself"}], "tags": [], "owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "is_accepted": true, "score": 1, "last_activity_date": 1514261713, "creation_date": 1514261713, "answer_id": 47973832, "question_id": 47972428, "link": "https://stackoverflow.com/questions/47972428/vba-code-review-and-set-border-for-the-fileds-which-change-frequently/47973832#47973832", "title": "VBA: Code review and set border for the fileds which change frequently", "body": "<p>My guess for the error would be the use of Column 10 in your LastRow definition. I have made some changes below.</p>\n\n<p>From your example dataset, it seems like \"Role\" is in Column C, and \"January\" starts in Column D?</p>\n\n<p>If so, I think you need to adjust your code to be something like this:</p>\n\n<pre><code>Sub Set_border()\n    Range(\"C2\").Select\n    LastRow = Cells(Rows.Count, 3).End(xlUp).Row\n    LastCol = Cells(2, Columns.Count).End(xlToLeft).Column\n    Range(\"A2:\" &amp; Cells(LastRow, LastCol).Address).Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    Range(\"D1:\" &amp; Cells(1, LastCol).Address).Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 8938470, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0667486b14c91507c8b2c88f68fe0536?s=128&d=identicon&r=PG&f=1", "display_name": "dhanya", "link": "https://stackoverflow.com/users/8938470/dhanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 47973832, "answer_count": 1, "score": 0, "last_activity_date": 1514261713, "creation_date": 1514240828, "last_edit_date": 1514246004, "question_id": 47972428, "link": "https://stackoverflow.com/questions/47972428/vba-code-review-and-set-border-for-the-fileds-which-change-frequently", "title": "VBA: Code review and set border for the fileds which change frequently", "body": "<p>Kindly help me to set border for a set of fields which use to change as per the data (Weeks of a month) provided by the user, I tried few things but nothing going through because when the fields changes it will just go crazy</p>\n\n<p>For the first time i set values as Jan 2018 &amp; Feb 2018</p>\n\n<p><strong>The code</strong></p>\n\n<pre><code>Sub ClearPage()\n\n    Sheets(\"WeekWise_Revenue\").Select\n    Cells.Select\n    Selection.Delete Shift:=xlUp\n\n    Call Set_Basicdetails\n\nEnd Sub\n\nSub Set_Basicdetails()\n\n    Range(\"3:3,5:5\").Select\n    Range(\"C3\").Activate\n    With Selection.Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent5\n        .TintAndShade = 0.599993896298105\n        .PatternTintAndShade = 0\n    End With\n    Range(\"4:4,6:6\").Select\n    Range(\"C4\").Activate\n    With Selection.Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent6\n        .TintAndShade = 0.599993896298105\n        .PatternTintAndShade = 0\n    End With\n\n' Macro2 Macro\n\n    Range(\"A2\").Select\n    ActiveCell.FormulaR1C1 = \"Country\"\n    Range(\"A2:B2\").Select\n    Selection.Merge\n\n\n    Range(\"A3\").Select\n    ActiveCell.FormulaR1C1 = \"US\"\n    Range(\"A3:B4\").Select\n    Selection.Merge\n      With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent3\n        .TintAndShade = 0.399975585192419\n        .PatternTintAndShade = 0\n      End With\n\n    Range(\"A5\").Select\n    ActiveCell.FormulaR1C1 = \"India\"\n    Range(\"A5:B6\").Select\n    Selection.Merge\n      With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent3\n        .TintAndShade = 0.799981688894314\n        .PatternTintAndShade = 0\n      End With\n\n\n    Range(\"C3\").Select\n    ActiveCell.FormulaR1C1 = \"Senior Ops\"\n    Range(\"C4\").Select\n    ActiveCell.FormulaR1C1 = \"Ops Eng\"\n    Range(\"C5\").Select\n    ActiveCell.FormulaR1C1 = \"Senior Ops\"\n    Range(\"C6\").Select\n    ActiveCell.FormulaR1C1 = \"Ops Eng\"\n    Range(\"C7\").Select\n    ActiveCell.FormulaR1C1 = \"Revenue\"\n\n    Columns(\"A:C\").Select\n    Columns(\"A:C\").EntireColumn.AutoFit\n\nCall SetDate\n\nEnd Sub\n\nSub SetDate()\n\n    Dim intDay As Integer, firstIter As Integer\n    Dim startMonth As Date, endMonth As Date\n    Dim str As String\n    Dim IsStartMonth As Boolean, IsEndMonth As Boolean\n    Dim Rng As Range, rng1 As Range, rng2 As Range\n    Dim i As Long\n    Dim ws As Worksheet\n\n    Application.ScreenUpdating = False\n    firstIter = 1\n    Set ws = ThisWorkbook.Sheets(\"WeekWise_Revenue\")  'change Sheet4 to your sheet\n    IsStartMonth = False\n    IsEndMonth = False\n    Do\n        If Not IsStartMonth Then\n        'get start date\n            str = InputBox(\"Enter Start Date in month-year format \" &amp; vbCrLf &amp; \"(like Sep 2017 or September 2017)\", \"Date\")\n            If IsDate(str) Then         'if entery is valid date\n                startMonth = str\n                IsStartMonth = True\n            ElseIf IsEmpty(str) Then    'if nothing is entered\n                IsStartMonth = True\n            ElseIf StrPtr(str) = 0 Then 'user clicks close\n                IsStartMonth = True\n                Exit Sub\n            Else                        'display input box again\n                Call MsgBox(\"Enter a valid date\", vbCritical + vbOKOnly, \"Date Only\")\n            End If\n        Else\n        'get end date\n            str = InputBox(\"Enter End Date in month-year format \" &amp; vbCrLf &amp; \"(like Sep 2017 or September 2017)\", \"Date\")\n            If IsDate(str) Then         'if entery is valid date\n                endMonth = DateAdd(\"d\", -1, DateAdd(\"m\", 1, str))\n                IsEndMonth = True\n            ElseIf IsEmpty(str) Then    'if nothing is entered\n                IsEndMonth = True\n            ElseIf StrPtr(str) = 0 Then 'user clicks close\n                IsEndMonth = True\n                Exit Sub\n            Else                        'display input box again\n                Call MsgBox(\"Enter a valid date\", vbCritical + vbOKOnly, \"Date Only\")\n            End If\n        End If\n    Loop Until IsStartMonth And IsEndMonth\n\n    Set Rng = ws.Range(\"D2\")\n    ws.Range(\"C2\") = \"Role\"\n    Set rng1 = Rng.Offset(-1, i)\n    intDay = intDay + 1\n\n    Do\n        If Format(startMonth + intDay, \"ddd\") = \"Mon\" Then      'check whether date is Monday\n            Rng.Offset(-1, i).Value = MonthName(Format(startMonth + intDay, \"m\"))\n            Rng.Offset(0, i).Value = Format(startMonth + intDay, \"d\")   'display monday dates\n            i = i + 1\n            intDay = intDay + 7\n\n            'merge cells in Row 1\n            If rng1.Value = Rng.Offset(-1, i - 1).Value Then\n                If firstIter &lt;&gt; 1 Then\n                    Rng.Offset(-1, i - 1).Value = \"\"\n                End If\n                firstIter = 0\n                With Range(rng1, Rng.Offset(-1, i - 1))\n                    .Merge\n                    .HorizontalAlignment = xlCenter\n                End With\n            Else\n                Set rng1 = Rng.Offset(-1, i - 1)\n            End If\n\n        Else\n            intDay = intDay + 1\n        End If\n    Loop Until CDate(startMonth + intDay) &gt; CDate(endMonth) 'loop till start date is less then end date\nApplication.ScreenUpdating = True\n\nCall Set_border\nEnd Sub\n</code></pre>\n\n<p><strong>Code to set border</strong> where I am facing issue</p>\n\n<pre><code>Sub Set_border()\n\n    Range(\"D1\").Select\n    LastRow = Cells(Rows.Count, 10).End(xlUp).Row\n    Range(\"D1:D\" &amp; LastRow).Select\n    ''ActiveCell.Offset(4, 0).Select\n    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select\n\n\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I am expecting something like this </p>\n\n<p><a href=\"https://i.stack.imgur.com/Ry1Mc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ry1Mc.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is working fine but next time when i run the code and enter Jan 2018 only but the border will be get added to all the fileds which was selected previously, I tried to delete all the fields before the main code starts but facing same issue</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 1, "creation_date": 1514238356, "post_id": 47972002, "comment_id": 82914107, "body": "Not sure what you mean about file explorer opening up for each instance of the &quot;Sheet34&quot;, but your assignment should have the single quotes inside the double quotes, i.e. <code>&quot;=&#39;&quot; &amp; sheetName &amp; &quot;&#39;!$H$69&quot;</code>"}, {"owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1514244086, "post_id": 47972002, "comment_id": 82914930, "body": "Good to know about the double quotes.  So far as the File Explorer opening up; the file explorer to open an Excel file shows up 5 times, for each instance of the line   &quot;=&quot; &amp; sheetName &amp; &quot;!$U$69&quot;  The only thing I can assume is that because of the orientation of single and double quotes, it assumes the sheet is in another workbook, perhaps? Though I was under the assumption that calling a sheet by its codename intrinsically assumed the sheet was in the active workbook unless otherwise stated?"}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "is_accepted": false, "score": 0, "last_activity_date": 1514262702, "creation_date": 1514262702, "answer_id": 47973909, "question_id": 47972002, "link": "https://stackoverflow.com/questions/47972002/worksheet-codename-errors/47973909#47973909", "title": "Worksheet Codename Errors", "body": "<p>You are trying to set the value of a cell to a formula...Try out the following:</p>\n\n<ol>\n<li>Create a direct link to a cell in another sheet within the same workbook</li>\n<li>Open another workbook.</li>\n<li>Create a direct link to a cell in a sheet from the other workbook</li>\n</ol>\n\n<p>You will find that the following would be correct use for a worksheet reference:</p>\n\n<pre><code>Worksheets(\"SUMMARY\").Cells(47, 6).Formula = \"='\" &amp; sheetName &amp; \"'!$H$69\"\n</code></pre>\n\n<p>And the below for a workbook reference:</p>\n\n<pre><code>Worksheets(\"SUMMARY\").Cells(47, 6).Formula = \"='[\" &amp; Worboookpath &amp; \"] &amp; sheetName &amp; \"'!$H$69\"\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9034763, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/133453167341658/picture?type=large", "display_name": "Tom Stone", "link": "https://stackoverflow.com/users/9034763/tom-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1514361146, "creation_date": 1514235571, "last_edit_date": 1514361146, "question_id": 47972002, "link": "https://stackoverflow.com/questions/47972002/worksheet-codename-errors", "title": "Worksheet Codename Errors", "body": "<p>When using the code below to reference a worksheet by codename, I get file explorer opening up for each instance of the \"Sheet34\". How can I prevent this?</p>\n\n<pre><code>Private Sub CheckBox4_Click()\nApplication.ScreenUpdating = False\n\nDim ws As Worksheet\nDim sheetName As String\n\n\nIf CheckBox4.Value = True Then\n    ActiveWorkbook.Unprotect\n    Worksheets(\"SUMMARY\").Unprotect\n    sheetName = Sheets(\"Control\").Cells(16, \"I\")\n    If sheetName = \"\" Then\n        MsgBox \"You must enter a valid Allowance descriptor. No entry was detected.\"\n        CheckBox4.Value = False\n        Exit Sub\n    End If\n    If Len(sheetName) &gt; 31 Then\n        MsgBox \"Worksheet tab names cannot be greater than 31 characters in length.\"\n        Application.EnableEvents = False\n        Sheets(\"Control\").Cells(16, \"I\").ClearContents\n        Application.EnableEvents = True\n        CheckBox4.Value = False\n        Exit Sub\n    End If\n    Dim IllegalCharacter(1 To 7) As String, i As Integer\n    IllegalCharacter(1) = \"/\"\n    IllegalCharacter(2) = \"\\\"\n    IllegalCharacter(3) = \"[\"\n    IllegalCharacter(4) = \"]\"\n    IllegalCharacter(5) = \"*\"\n    IllegalCharacter(6) = \"?\"\n    IllegalCharacter(7) = \":\"\n    For i = 1 To 7\n        If InStr(sheetName, (IllegalCharacter(i))) &gt; 0 Then\n            MsgBox \"You used a character that violates sheet naming rules. Please refrain from the following characters: / \\ [ ] * ? : \"\n            Application.EnableEvents = False\n            Sheets(\"Control\").Cells(16, \"I\").ClearContents\n            Application.EnableEvents = True\n            CheckBox4.Value = False\n            Exit Sub\n        End If\n\n    Next i\n    If Sheets(\"Control\").Range(\"I16\") = Sheets(\"Control\").Range(\"I17\") Then\n        MsgBox \"There is already an Allowance with this name. Please choose a different name.\"\n        Application.EnableEvents = False\n            Sheets(\"Control\").Cells(16, \"I\").ClearContents\n            Application.EnableEvents = True\n            CheckBox4.Value = False\n            Exit Sub\n        End If\n        If Sheets(\"Control\").Range(\"I16\") = Sheets(\"Control\").Range(\"I18\") Then\n        MsgBox \"There is already an Allowance with this name. Please choose a different name.\"\n        Application.EnableEvents = False\n            Sheets(\"Control\").Cells(16, \"I\").ClearContents\n            Application.EnableEvents = True\n            CheckBox4.Value = False\n            Exit Sub\n        End If\n        If Sheets(\"Control\").Range(\"I16\") = Sheets(\"Control\").Range(\"I21\") Then\n        MsgBox \"There is already an Other Item with this name. Please choose a different name.\"\n        Application.EnableEvents = False\n            Sheets(\"Control\").Cells(16, \"I\").ClearContents\n            Application.EnableEvents = True\n            CheckBox4.Value = False\n            Exit Sub\n        End If\n        If Sheets(\"Control\").Range(\"I16\") = Sheets(\"Control\").Range(\"I22\") Then\n        MsgBox \"There is already an Other Item with this name. Please choose a different name.\"\n        Application.EnableEvents = False\n            Sheets(\"Control\").Cells(16, \"I\").ClearContents\n            Application.EnableEvents = True\n            CheckBox4.Value = False\n            Exit Sub\n        End If\n        If Sheets(\"Control\").Range(\"I16\") = Sheets(\"Control\").Range(\"I23\") Then\n        MsgBox \"There is already an Other Item with this name. Please choose a different name.\"\n        Application.EnableEvents = False\n            Sheets(\"Control\").Cells(16, \"I\").ClearContents\n            Application.EnableEvents = True\n            CheckBox4.Value = False\n            Exit Sub\n        End If\n    If WorksheetExists(sheetName) Then\n        Worksheets(sheetName).Visible = -1\n        Worksheets(\"SUMMARY\").Rows(\"47\").EntireRow.Hidden = False\n        Worksheets(\"SUMMARY\").Cells(47, 2).Value = \"ALL 1:\"\n        Worksheets(\"SUMMARY\").Cells(47, 3).Value = \"='Control'!I16\"\n        Worksheets(\"SUMMARY\").Cells(47, 3).NumberFormat = \"General\"\n        Worksheets(\"SUMMARY\").Cells(47, 4).Value = \"='Control'!K16\"\n        Worksheets(\"SUMMARY\").Cells(47, 5).Value = \"='Control'!L16\"\n        Worksheets(\"SUMMARY\").Cells(47, 6).Value = \"=\" &amp; sheetName &amp; \"!$H$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 7).Value = \"=\" &amp; sheetName &amp; \"!$J$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 8).Value = \"=\" &amp; sheetName &amp; \"!$N$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 9).Value = \"=\" &amp; sheetName &amp; \"!$P$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 10).Value = \"=SUM(F47:I47)/D47\"\n        Worksheets(\"SUMMARY\").Cells(47, 11).Value = \"=L47/F3\"\n        Worksheets(\"SUMMARY\").Cells(47, 12).Value = \"=\" &amp; sheetName &amp; \"!$U$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 13).Value = \"=L47/$K$57\"\n        ActiveWorkbook.Protect\n        Sheets(sheetName).Protect\n        Sheets(\"SUMMARY\").Protect\n        Exit Sub\n    Else\n        Set ws = ActiveWorkbook.Sheet34\n        ws.Name = sheetName\n        ws.Protect\n        ws.EnableSelection = xlUnlockedCells\n        Application.CutCopyMode = False\n\n        Worksheets(\"SUMMARY\").Rows(\"47\").EntireRow.Hidden = False\n        Worksheets(\"SUMMARY\").Cells(47, 2).Value = \"ALL 1:\"\n        Worksheets(\"SUMMARY\").Cells(47, 3).Value = \"='Control'!I16\"\n        Worksheets(\"SUMMARY\").Cells(47, 3).NumberFormat = \"General\"\n        Worksheets(\"SUMMARY\").Cells(47, 4).Value = \"='Control'!K16\"\n        Worksheets(\"SUMMARY\").Cells(47, 5).Value = \"='Control'!L16\"\n        Worksheets(\"SUMMARY\").Cells(47, 6).Value = \"=\" &amp; ws.Name &amp; \"!$H$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 7).Value = \"=\" &amp; ws.Name &amp; \"!$J$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 8).Value = \"=\" &amp; ws.Name &amp; \"!$N$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 9).Value = \"=\" &amp; ws.Name &amp; \"!$P$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 10).Value = \"=SUM(F47:I47)/D47\"\n        Worksheets(\"SUMMARY\").Cells(47, 11).Value = \"=L47/F3\"\n        Worksheets(\"SUMMARY\").Cells(47, 12).Value = \"=\" &amp; ws.Name &amp; \"!$U$69\"\n        Worksheets(\"SUMMARY\").Cells(47, 13).Value = \"=L47/$K$57\"\n\n        ActiveWorkbook.Protect\n        Sheets(sheetName).Protect\n        Sheets(\"SUMMARY\").Protect\n        Worksheets(\"Control\").Activate\n\n    End If\n\nEnd If\nIf CheckBox4.Value = False Then\n    ActiveWorkbook.Unprotect\n    Worksheets(\"SUMMARY\").Unprotect\n    sheetName = Sheets(\"Control\").Cells(16, \"I\")\n\n    If WorksheetExists(sheetName) Then\n        Worksheets(sheetName).Visible = 2\n        Worksheets(\"SUMMARY\").Rows(\"47\").EntireRow.ClearContents\n        Worksheets(\"SUMMARY\").Rows(\"47\").EntireRow.Hidden = True\n        ActiveWorkbook.Protect\n        Sheets(sheetName).Protect\n        Sheets(\"SUMMARY\").Protect\n    End If\n\n   End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Follow up question: This code is taking an existing sheet and renaming it. The concern I have is if the user names the sheet in Cell I16, then renames it, and unchecks or checks the box, I get a row on the Summary Worksheet with poor references. Also, the code will not allow me to enter the code below</p>\n\n<pre><code>Worksheets(\"SUMMARY\").Cells(47, 6).Value = \"=\" &amp; sheetName &amp; \"!$H$69\"\n</code></pre>\n\n<p>as</p>\n\n<pre><code>Worksheets(\"SUMMARY\").Cells(47, 6).Value = \"=\"' &amp; sheetName &amp; '\"!$H$69\"\n</code></pre>\n\n<p>as it turns the &amp; sheetName &amp; into a comment. How can I fix this so that the worksheet is properly referenced in the code? Do I need to keep with the codename worksheet?</p>\n\n<p>My thoughts on how to stop the renaming issue was to protect the named cell so long as the checkbox value is positive, and allow the user to edit the cell if the checkbox value is false; maybe adding a line of code that checks if the cell is being changed and asking the user if they are sure this is the cell they want to modify, which would clear the data, but not the formatting, of the existing spreadsheet.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1514231842, "post_id": 47971603, "comment_id": 82912781, "body": "You aren&#39;t telling it a file format. <code>Sub SaveAs([FileName], [FileFormat], [LockComments], [Password], [AddToRecentFiles], [WritePassword], [ReadOnlyRecommended], [EmbedTrueTypeFonts], [SaveNativePictureFormat], [SaveFormsData], [SaveAsAOCELetter], [Encoding], [InsertLineBreaks], [AllowSubstitutions], [LineEnding], [AddBiDiMarks]) </code>"}, {"owner": {"reputation": 1, "user_id": 7213819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1263105883769642/picture?type=large", "display_name": "Shani Mudassar", "link": "https://stackoverflow.com/users/7213819/shani-mudassar"}, "reply_to_user": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1514232072, "post_id": 47971603, "comment_id": 82912829, "body": "can you please fix it somehow. i am not good at coding."}, {"owner": {"reputation": 1, "user_id": 7213819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1263105883769642/picture?type=large", "display_name": "Shani Mudassar", "link": "https://stackoverflow.com/users/7213819/shani-mudassar"}, "reply_to_user": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1514232134, "post_id": 47971603, "comment_id": 82912838, "body": "i dont need multiple things. the file should be saved in .txt only. as WORD document also contains text. No special formatting though."}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 1, "creation_date": 1514234021, "post_id": 47971603, "comment_id": 82913288, "body": "<code>[..]</code> means OPTIONAL parameter that all the above are. <code>ActiveDocument.SaveAs , wdFormatPlainText</code>. The comma shows I&#39;ve omitted the file name but you can put it in."}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1514234554, "post_id": 47971603, "comment_id": 82913395, "body": "If you put the text caret on <code>SaveAs</code> and press F1 you will get help explaining how to use the command. Also you can see how Word would write the command you want by recording it. Alt + T, M, R. Do your save as. Repeat keys to stop recording. Look in VBA code editor for the code Word wrote. Also pressing Ctrl + I to show parameters, Ctrl + Space to show autocomplete names while typing the function."}, {"owner": {"reputation": 412, "user_id": 8907742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiXbC.jpg?s=128&g=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8907742/jpr"}, "reply_to_user": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1514263284, "post_id": 47971603, "comment_id": 82917377, "body": "@ACatInLove You should perhaps post it as an answer? Your comment seems to be the solution to Shani&#39;s problem."}, {"owner": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "reply_to_user": {"reputation": 412, "user_id": 8907742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiXbC.jpg?s=128&g=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8907742/jpr"}, "edited": false, "score": 0, "creation_date": 1514265594, "post_id": 47971603, "comment_id": 82917723, "body": "@jpr Not reading help that&#39;s under your nose is not a worthwhile question. If he reads help in the future my comments are worth it."}, {"owner": {"reputation": 412, "user_id": 8907742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RiXbC.jpg?s=128&g=1", "display_name": "JPR", "link": "https://stackoverflow.com/users/8907742/jpr"}, "reply_to_user": {"reputation": 532, "user_id": 8994815, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/8994815/acatinlove"}, "edited": false, "score": 0, "creation_date": 1514271513, "post_id": 47971603, "comment_id": 82919168, "body": "@ACatInLove Got it. I&#39;m still trying to better understand good/standard practices on this site."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1514299244, "post_id": 47971603, "comment_id": 82928616, "body": "What is not working?"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1514513933, "creation_date": 1514513933, "answer_id": 48016640, "question_id": 47971603, "link": "https://stackoverflow.com/questions/47971603/splitting-word-document-into-multiple-txt-files-using-a-macro/48016640#48016640", "title": "Splitting Word document into multiple .txt files using a macro", "body": "<p>Try this and see if it does what you want.</p>\n\n<pre><code>Sub SplitNotes(delim As String, strFilename As String)\n    Dim doc As Document\n    Dim arrNotes\n    Dim I As Long\n    Dim X As Long\n    Dim Response As Integer\n\n    arrNotes = Split(ActiveDocument.Range, delim)\n\n    Response = MsgBox(\"This will split the document into \" &amp; UBound(arrNotes) + 1 &amp; \" sections. Do you wish to proceed?\", 4)\n    If Response = 7 Then Exit Sub\n    For I = LBound(arrNotes) To UBound(arrNotes)\n        If Trim(arrNotes(I)) &lt;&gt; \"\" Then\n            X = X + 1\n            Set doc = Documents.Add\n            doc.Range = arrNotes(I)\n            doc.SaveAs ThisDocument.Path &amp; \"\\\" &amp; strFilename &amp; \".txt\"\n            doc.Close True\n        End If\n    Next I\nEnd Sub\n\n\nSub test()\n     ' delimiter &amp; filename\n    SplitNotes \"///\", \"Notes \"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7213819, "user_type": "registered", "profile_image": "https://graph.facebook.com/1263105883769642/picture?type=large", "display_name": "Shani Mudassar", "link": "https://stackoverflow.com/users/7213819/shani-mudassar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1514513933, "creation_date": 1514231528, "last_edit_date": 1514272507, "question_id": 47971603, "link": "https://stackoverflow.com/questions/47971603/splitting-word-document-into-multiple-txt-files-using-a-macro", "title": "Splitting Word document into multiple .txt files using a macro", "body": "<p>I am splitting a single MS Word document into multiple using a custom delimiter. I am able to create multiple files in MS Word format, but I want to create multiple .txt files instead.</p>\n\n<p>The code that I am using now is:</p>\n\n<pre><code>Sub SplitNotes(delim As String, strFilename As String)\n    Dim doc As Document\n    Dim arrNotes\n    Dim I As Long\n    Dim X As Long\n    Dim Response As Integer\n\n    arrNotes = Split(ActiveDocument.Range, delim)\n\n    Response = MsgBox(\"This will split the document into \" &amp; \nUBound(arrNotes) + 1 &amp; \" sections. Do you wish to proceed?\", 4)\n\n    If Response = 7 Then Exit Sub\n\n    For I = LBound(arrNotes) To UBound(arrNotes)\n\n        If Trim(arrNotes(I)) &lt;&gt; \"\" Then\n\n            X = X + 1\n\n            Set doc = Documents.Add\n            doc.Range = arrNotes(I)\n\n            doc.SaveAs ThisDocument.Path &amp; \"\\\" &amp; strFilename &amp; Format(X, \"000\")\n            doc.Close True\n\n        End If\n\n    Next I\n\nEnd Sub\n\n\nSub test()\n     '      delimiter &amp; filename\n    SplitNotes \"%%%%%%%%%%%%%%\", \"Notes \"\nEnd Sub\n</code></pre>\n\n<p>Can anyone help me with this please?</p>\n"}, {"tags": ["vba", "image", "button", "userform", "redundancy"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514235427, "post_id": 47971260, "comment_id": 82913560, "body": "So, you&#39;re looking for a simple way to perform an action (or set of actions) on <b><i>all</i></b> image and labels on a certain userform?  If so, you could probably look through the controls.  Also, Welcome to Stack Overflow!  Be sure to check out the <a href=\"https://stackoverflow.com/tour\">tour</a> as well as <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514246160, "post_id": 47971260, "comment_id": 82915229, "body": "Thanks. I am looking for a solution to only write my OnMouseOver script once and apply this Sub to any Image/Label where I hover my mouse over. All (4 Images, which will be my buttons) will have the same effects being performed when hovering/MouseDown/MouseUp the image."}], "owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1514228293, "creation_date": 1514228293, "question_id": 47971260, "link": "https://stackoverflow.com/questions/47971260/vba-call-template-sub-for-changing-color-of-an-image-on-a-userform", "title": "(VBA) Call Template-Sub for changing color of an Image on a UserForm", "body": "<p>I want to avoid redundant code in my VBA Project, therefore I coded several Template-Subs to call in a certain situation.</p>\n\n<p>Background information: I have a UserForm on which I have several Images. Those Images replace the normal CommandButton for design reasons. I want onMouseOver effects to take place etc.</p>\n\n<p>I would like to know whether I can apply the Template Sub to all buttons on my UserForm somehow. I don't know how, because each Image has a different name.</p>\n\n<p>my Code so far, which works for one specific Image and a specific label in that image:</p>\n\n<pre><code>Private Sub Frame1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nCall OnAnyWhereElse\nEnd Sub\n\nPrivate Sub Frame1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nCall OnAnyWhereElse\nEnd Sub\n\nPrivate Sub Frame1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nCall OnAnyWhereElse\nEnd Sub\n\n\n\nPrivate Sub LbVersenden_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nCall OnMouseOver\nEnd Sub\n\nPrivate Sub LbVersenden_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nCall OnMouseDown\nEnd Sub\n\nPrivate Sub LbVersenden_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nCall OnMouseUp\nEnd Sub\n\n\n\nPrivate Sub OnAnyWhereElse()\nImgVersenden.BackColor = RGB(209, 20, 122) 'pink\nImgVersenden.BorderColor = RGB(209, 20, 122) 'pink\nLbVersenden.ForeColor = RGB(255, 255, 255) 'weiss\nEnd Sub\n\nPrivate Sub OnMouseOver()\nImgVersenden.BorderColor = RGB(0, 148, 171) 't\u00fcrkis\nImgVersenden.BackColor = RGB(0, 148, 171) 't\u00fcrkis\nEnd Sub\n\nPrivate Sub OnMouseDown()\nImgVersenden.BackColor = RGB(255, 255, 255) 'weiss\nImgVersenden.BorderColor = RGB(0, 148, 171) 't\u00fcrkis\nLbVersenden.ForeColor = RGB(0, 148, 171) 't\u00fcrkis\nEnd Sub\n\nPrivate Sub OnMouseUp()\nImgVersenden.BorderColor = RGB(0, 148, 171) 't\u00fcrkis\nImgVersenden.BackColor = RGB(0, 148, 171) 't\u00fcrkis\nLbVersenden.ForeColor = RGB(255, 255, 255) 'weiss\nEnd Sub\n</code></pre>\n\n<p>Let's say I have several more Images like \"Exit\", \"Browse\", ... How can I manage to call the same Subs (\"OnMouseOver\", \"OnMouseUp\", \"OnAnywhereElse\") without stating all the Image and Label names within the subs...\nOtherwise it makes no sense to even declare those extra subs, when they consist of the same amount of code I could have put into the Image-action itself.</p>\n\n<p>hope my intention is clear enough. Thanks for your help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514229867, "post_id": 47970687, "comment_id": 82912389, "body": "any reason why you can&#39;t use the inbuilt highlight duplicates functionality of conditional formatting in the gome tab?"}, {"owner": {"reputation": 85, "user_id": 8783237, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/936102396542601/picture?type=large", "display_name": "Mohammed Zegui", "link": "https://stackoverflow.com/users/8783237/mohammed-zegui"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514277609, "post_id": 47970687, "comment_id": 82920932, "body": "I&#39;m using it, my code can&#39;t run without conditional formatting. The problem is that checking with <code>Range.DisplayFormat</code> method  is not available for Excel  2007."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 8783237, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/936102396542601/picture?type=large", "display_name": "Mohammed Zegui", "link": "https://stackoverflow.com/users/8783237/mohammed-zegui"}, "edited": false, "score": 0, "creation_date": 1514277720, "post_id": 47971519, "comment_id": 82920957, "body": "Thank you for the code, it&#39;s really valuable but what I want is just a function that does a boolean check (returning True or False)  and having for entry the Range and the value."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 85, "user_id": 8783237, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/936102396542601/picture?type=large", "display_name": "Mohammed Zegui", "link": "https://stackoverflow.com/users/8783237/mohammed-zegui"}, "edited": false, "score": 0, "creation_date": 1514277943, "post_id": 47971519, "comment_id": 82921028, "body": "Where would it return this information? Presumably, depending on how you apply the conditional formatting, you could check for the .FormatConditions(1).Interior properties (e.g. as set by using the 2007 highlight duplicates functionality). Sort of a reversal of my code, where rather than setting, test for those settings (having applied them manually). You could loop a range doing this test and store the ranges found and their values in dictionary."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1517409003, "last_edit_date": 1517409003, "creation_date": 1514230638, "answer_id": 47971519, "question_id": 47970687, "link": "https://stackoverflow.com/questions/47970687/range-displayformat-method-and-vba-excel-2007/47971519#47971519", "title": "Range.DisplayFormat method and VBA Excel 2007", "body": "<p>You can use the inbuilt conditional formatting functionality</p>\n\n<p>Either </p>\n\n<p>1) select the area to highlight and then go to <code>Home &gt; Conditional Formatting &gt; Highlight cell rules &gt; Duplicate Values</code> and choose your format </p>\n\n<p>Or</p>\n\n<p>2) Use code similar to the following:</p>\n\n<pre><code>Sub findDupsInMyCol()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim rngSelection As Range\n    Dim lastRow As Long\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Data\")\n    lastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row 'find last used row number\n    Set rngSelection = ws.Range(\"A1:A\" &amp; lastRow) 'set target range\n    ws.Activate\n    FormatDups rngSelection \n\nEnd Sub\n\n\nSub FormatDups(ByRef rngSelected As Range)\n\n    rngSelected.FormatConditions.AddUniqueValues\n    rngSelected.FormatConditions(rngSelected.FormatConditions.Count).SetFirstPriority\n    With rngSelected.FormatConditions(1)\n        .DupeUnique = xlDuplicate\n        .Font.Color = -16383844\n        .Interior.PatternColorIndex = xlAutomatic\n        .Interior.Color = 13551615\n        .StopIfTrue = False\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 8783237, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/936102396542601/picture?type=large", "display_name": "Mohammed Zegui", "link": "https://stackoverflow.com/users/8783237/mohammed-zegui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1372, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1517409003, "creation_date": 1514222614, "question_id": 47970687, "link": "https://stackoverflow.com/questions/47970687/range-displayformat-method-and-vba-excel-2007", "title": "Range.DisplayFormat method and VBA Excel 2007", "body": "<p>I want to check if there are any duplicates in my column, I set a conditional formatting manually and then I made the following test : </p>\n\n<pre><code>            If cell2.DisplayFormat.Interior.Color &lt;&gt; RGB(255, 199, 206) Then\n\n                Label8.Caption = cell2.Offset(, 2).Text\n                Label9.Caption = cell2.Offset(, 3).Text\n                Label10.Caption = cell2.Offset(, 4).Text\n                Label12.Caption = cell2.Offset(, 5).Text\n                Label13.Caption = cell2.Offset(, 6).Text\n                Label28.Caption = cell2.Offset(, 7).Text\n                Label30.Caption = cell2.Offset(, 8).Text\n                CommandButton2.Enabled = True\n\n            Else\n                cell2.Value = \"\"\n                MsgBox \"Votre bac existe d\u00e9j\u00e0\", vbExclamation, \"Bac double\"\n                Me.TextBox1.Value = \"\"\n                Me.TextBox1.SetFocus\n\n            End If\n</code></pre>\n\n<p>The problem is that I use Excel 2007, and this one does not support <code>Range.DisplayFormat</code> method, so what I need is one of the following :</p>\n\n<ul>\n<li>An alternative to <code>Range.DisplayFormat</code> method.\nOR</li>\n<li>Another way to test the duplicates without using conditional formatting.</li>\n</ul>\n\n<p>THANK YOU!</p>\n"}, {"tags": ["vba", "excel", "class", "oop"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 5581639, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dd39075f66c34597ec596dc52e653d28?s=128&d=identicon&r=PG&f=1", "display_name": "JG7", "link": "https://stackoverflow.com/users/5581639/jg7"}, "edited": false, "score": 0, "creation_date": 1514259602, "post_id": 47973371, "comment_id": 82916868, "body": "This is definitely helpful information, but it doesn\u2019t help answer the question of why do the stated changes affect overall execution time."}], "tags": [], "owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "is_accepted": false, "score": 0, "last_activity_date": 1514255054, "creation_date": 1514255054, "answer_id": 47973371, "question_id": 47970385, "link": "https://stackoverflow.com/questions/47970385/excel-vba-the-same-code-becomes-slow-if-get-properties-are-added-to-a-class/47973371#47973371", "title": "Excel vba: the same code becomes slow if get properties are added to a class", "body": "<p>You can use the following codes to disable your application features while running the macro.</p>\n\n<p><strong>References:</strong></p>\n\n<p><a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=1035\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/kb/getarticle.php?kb_id=1035</a><br>\n<a href=\"https://wellsr.com/vba/2017/excel/speed-up-VBA-macro-with-these-subroutines/\" rel=\"nofollow noreferrer\">https://wellsr.com/vba/2017/excel/speed-up-VBA-macro-with-these-subroutines/</a></p>\n\n<pre><code>Sub SpeedOff()\n     'Turns on the time wasters\n     With Application\n         .Calculation = xlCalculationAutomatic\n         .ScreenUpdating = True\n         .EnableEvents = True\n         .DisplayAlerts = True\n         .Cursor = xlDefault\n         .StatusBar = False\n         .EnableCancelKey = xlInterrupt\n     End With\nEnd Sub\n\nSub SpeedOn()\n    'Turns off the time wasters\n    With Application\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .DisplayAlerts = False\n        .Cursor = xlWait\n        .EnableCancelKey = xlErrorHandler\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1514255054, "creation_date": 1514219680, "question_id": 47970385, "link": "https://stackoverflow.com/questions/47970385/excel-vba-the-same-code-becomes-slow-if-get-properties-are-added-to-a-class", "title": "Excel vba: the same code becomes slow if get properties are added to a class", "body": "<p>I have a main sub that makes use of a <code>Client</code> class: creates an array with <code>100 000</code> <code>Clients</code> and loops over the array <code>100</code> times, each time setting a different random number to each <code>Client</code>.</p>\n\n<pre><code>Sub start()\n\n    Application.ScreenUpdating = False\n\n    Dim i As Long\n    Dim j As Long\n\n    Dim clientsColl() As Client\n    ReDim clientsColl(1 To 100000) As Client\n\n    For j = 1 To 100000\n        Set clientsColl(j) = New Client\n        clientsColl(j).setClientName = \"Client_\" &amp; j\n\n        Application.StatusBar = \"Getting client \" &amp; j\n\n        DoEvents\n    Next\n\n    Dim clientCopy As Variant\n    For i = 1 To 100\n        For Each clientCopy In clientsColl\n            clientCopy.generateRandom\n        Next\n\n        Application.StatusBar = \"Calculating \" &amp; i\n\n        DoEvents\n    Next\n\n    MsgBox (\"done\")\n\n    Application.StatusBar = False\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Client class:</p>\n\n<pre><code>Option Explicit\n\nPrivate clientname As String\nPrivate identityNumber As String\nPrivate creditRating As String\n\nPrivate contractTenor As Long\nPrivate contractNumber As String\nPrivate contractRate As Double\n\nPrivate totalReserves As Double\nPrivate totalReservesRate As Double\n\nPrivate debtType As String\nPrivate totalDebt As Double\n\nPrivate lossRatio As Double\nPrivate totalLoss As Variant\nPrivate totalProfit As Double\n\nPrivate totalPd As Double\nPrivate totalLgd As Double\n\nPrivate simulationCount As Long\nPrivate randomNumber As Double\nPrivate outcome As Integer\n\nPrivate loss As Double\nPrivate profit As Double\n\nPrivate sumLosses() As Double\nPrivate sumProfits() As Double\nPrivate sumResults() As Double\n\nPrivate averageDebtInfo As Double\n\nPublic Sub generateRandom()\n    randomNumber = Rnd()\nEnd Sub\n\nPublic Property Get getClientName()\n    getClientName = clientName\nEnd Property\n\nPublic Property Let setClientName(value As String)\n    clientName = value\nEnd Property\n</code></pre>\n\n<p>However, this code takes different time to run, depending whether the <code>Client</code> class has the <code>Get</code> and <code>Let</code> properties or not. The current version of the class posted above runs in about <code>25</code> seconds. If I add several <code>Get</code> properties to get things like <code>identityNumber</code> or <code>contractRate</code> it would take about <code>1 minute 25 seconds</code>.</p>\n\n<p>Why does adding simple <code>Get</code> properties affect the code so much? Can anything be done about it? I can't afford this code to run any more than 30 seconds..</p>\n"}, {"tags": ["vba", "excel", "charts", "excel-charts"], "comments": [{"owner": {"reputation": 2466, "user_id": 4778809, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dTdrn.png?s=128&g=1", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/4778809/vikas-yadav"}, "edited": false, "score": 0, "creation_date": 1514219138, "post_id": 47970278, "comment_id": 82909962, "body": "Better tell your approach for the problem first."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1514219271, "post_id": 47970278, "comment_id": 82909991, "body": "SO is not a free coding service. Show your efforts."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514219395, "post_id": 47970278, "comment_id": 82910024, "body": "Start with recording a macro then possibly look at the  type argument for inputbox that allows for user selecting a range."}, {"owner": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "edited": false, "score": 0, "creation_date": 1514219911, "post_id": 47970278, "comment_id": 82910149, "body": "I have just updated the question with the code I had for a Macro I was using before. This worked when selecting a specific range, but I now want to be able to prompt the selection of X and Y values so that I can use this Macro multiple times to generate many charts. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "edited": false, "score": 0, "creation_date": 1514236927, "post_id": 47970942, "comment_id": 82913884, "body": "Many thanks QHarr, when I tried entering this into a new module and running it, I get an error that says: Compile error: Variable not defined on line 19 - Private Function SelectRanges(Byref ws As Worksheet) As Range. Could you help me? Thanks."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "edited": false, "score": 0, "creation_date": 1514237500, "post_id": 47970942, "comment_id": 82913961, "body": "couple of typos. Corrected. Please try now."}, {"owner": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "edited": false, "score": 0, "creation_date": 1514318140, "post_id": 47970942, "comment_id": 82934885, "body": "QHarr, thank you very much! This works greatly.   I had one final question. In order to make everything easier and make the procedure faster, I wanted to format the charts to have a certain style. The way I see it is there are two ways of doing this:  1. I could code the formatting into the Macro  2. I could assign a template into the Macro.   Do you know how to assign a template for the chart into a Macro?  Thank you again!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "edited": false, "score": 0, "creation_date": 1514318282, "post_id": 47970942, "comment_id": 82934935, "body": "I have never tried this but if you create a template and then record a macro assigning this template style you might be find a style is applied that you later reference. Otherwise, it is easy enough to code formatting. Give it a try and let me know how it goes."}, {"owner": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "edited": false, "score": 0, "creation_date": 1514330450, "post_id": 47970942, "comment_id": 82938324, "body": "Thanks a lot QHarr, this has been really helpful!"}, {"owner": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "edited": false, "score": 0, "creation_date": 1514330881, "post_id": 47970942, "comment_id": 82938399, "body": "So I assigned a template, and got these two lines of code:     ActiveChart.ApplyChartTemplate ( _         &quot;C:\\Users\\maaro\\AppData\\Roaming\\Microsoft\\Templates\\Charts\\1&zwnj;&#8203;.crtx&quot;)   Where would I have to add these and what would I have to change?  I am presuming that I should be adding it to the BuildChart function but I got an error. What else would I have to change?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "edited": false, "score": 0, "creation_date": 1514380004, "post_id": 47970942, "comment_id": 82953597, "body": "It should go in the BuildChart function above the .SetSourceData and syntax is .ApplyChartTemplate (&quot;C:\\Users\\.......crtx&quot; ).  Don&#39;t forget to have &quot;.&quot; at the start. Also, this will work for you but other users may not have access to the filepath."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1514237418, "last_edit_date": 1514237418, "creation_date": 1514225026, "answer_id": 47970942, "question_id": 47970278, "link": "https://stackoverflow.com/questions/47970278/excel-vba-chart/47970942#47970942", "title": "Excel VBA Chart", "body": "<p>This is a bit rough and ready but shows some ideas. Apologies if any typos whilst entering via this device and you definitely want to implement better error handling.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Data\") 'change as appropriate\n\n    Application.ScreenUpdating = False\n\n    BuildChart ws, SelectRanges(ws)\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nPrivate Function SelectRanges(ByRef ws As Worksheet) As Range\n\n     Dim rngX As Range\n     Dim rngY As Range\n\n     ws.Activate\n\n     Application.DisplayAlerts = False\n\n     On Error Resume Next\n\n     Set rngX = Application.InputBox(\"Please select X values. One column.\", Type:=8)\n\n     If rngX Is Nothing Then GoTo InvalidSelection\n\n     Set rngY = Application.InputBox(\"Please select Y values. One column.\", Type:=8)\n\n     If rngY Is Nothing Then GoTo InvalidSelection\n\n     If rngX.Columns.Count &gt; 1 Or rngY.Columns.Count &gt; 1 Then GoTo InvalidSelection\n\n     On Error GoTo 0\n\n     Set SelectRanges = Union(rngX, rngY)\n     Application.DisplayAlerts = True\n     Exit Function\n\nInvalidSelection:\n    If rngX Is Nothing Or rngY Is Nothing Then\n        MsgBox \"Please ensure you have selected both X and Y ranges.\"\n    ElseIf rngX.Rows.Count &lt;&gt; rngX.Rows.Count Then\n         MsgBox \"Please ensure the same number of rows are selected for X and Y ranges\"\n    ElseIf rngX.Columns.Count &gt; 1 Or rngY.Columns.Count &gt; 1 Then\n        MsgBox \"Please ensure X range has only one column and Y range has only one column\"\n    Else\n       MsgBox \"Unspecified\"\n    End If\n\n    Application.DisplayAlerts = True\n    End\n\nEnd Function\n\nPrivate Sub BuildChart(ByRef ws As Worksheet, ByRef unionRng As Range)\n\n     With ws.Shapes.AddChart2(240, xlXYScatter).Chart\n        .SetSourceData Source:=unionRng\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9139253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9318a5ff8cd3fba975b35aee53d9e1c?s=128&d=identicon&r=PG&f=1", "display_name": "excellearner123", "link": "https://stackoverflow.com/users/9139253/excellearner123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 47970942, "answer_count": 1, "score": 0, "last_activity_date": 1514237418, "creation_date": 1514218827, "last_edit_date": 1514219845, "question_id": 47970278, "link": "https://stackoverflow.com/questions/47970278/excel-vba-chart", "title": "Excel VBA Chart", "body": "<p>I am required to create many charts on excel because I have many sets of numbers. Ideally, I would like to create a scatter plot and I am new in learning how to use excel and VBA. </p>\n\n<p>I would like to create a template module code to generate a scatter plot where I can choose X and Y values for columns or rows that are not next to each other. Furthermore, I would like to be able to format the plot's details - font, size, etc.  </p>\n\n<p>Could someone help me create a simple template? Thank you. </p>\n\n<p>I have tried doing this. I essentially want to be able to use this Macro multiple times to be able to generate many scatter plots with the same formatting, but selecting different X and Y values every single time. </p>\n\n<p>What can I add to this code so that when I run it it prompts me to select desired X and Y values?</p>\n\n<pre><code>Sub Macro8()\n'\n' Macro8 Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+W\n'   Dim rng As Range\n    Set rng = Application.InputBox(prompt:=\"Sample\", Type:=8)\n    ActiveSheet.Shapes.AddChart2(240, xlXYScatterLines).Select\n    ActiveChart.SetSourceData Source:=rng\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "selection", "shapes", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "edited": false, "score": 0, "creation_date": 1514218390, "post_id": 47970194, "comment_id": 82909788, "body": "thank you did that but had: dim v as shape --&gt; my bad thank you in advance"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1514218387, "last_edit_date": 1514218387, "creation_date": 1514218033, "answer_id": 47970194, "question_id": 47970115, "link": "https://stackoverflow.com/questions/47970115/get-single-shape-of-selection/47970194#47970194", "title": "get single shape of selection", "body": "<p>Maybe like this</p>\n\n<pre><code>Sub Tester()\n\nDim v As Variant\n\n    For Each v In ActiveSheet.Shapes.Range(Array(\"feed\", \"000-100-SRC\", \"product\"))\n        Debug.Print v.Name\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>or like that</p>\n\n<pre><code>Sub Tester()\n\nDim vArr As Variant\n\n    vArr = Array(\"feed\", \"000-100-SRC\", \"product\")\n    Debug.Print vArr(0)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "is_accepted": false, "score": 1, "last_activity_date": 1514339993, "creation_date": 1514339993, "answer_id": 47985483, "question_id": 47970115, "link": "https://stackoverflow.com/questions/47970115/get-single-shape-of-selection/47985483#47985483", "title": "get single shape of selection", "body": "<p>basically your set of ranges is called a shaperange.</p>\n\n<p>You can get its item like in any collection like : MyShaperange(1) , where myshaperange is a variable, or you replace it by activesheet.shapes(array(\"gggg\",\"yyy\"))(1)</p>\n\n<p>If already selected, you can also: selection.shaperange(1) ,  but usually selecting ranges or shapes is not advised when coding.</p>\n"}], "owner": {"reputation": 43, "user_id": 3506555, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/100000911035962/picture?type=large", "display_name": "woipi", "link": "https://stackoverflow.com/users/3506555/woipi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 47970194, "answer_count": 2, "score": 0, "last_activity_date": 1514339993, "creation_date": 1514217184, "last_edit_date": 1531164843, "question_id": 47970115, "link": "https://stackoverflow.com/questions/47970115/get-single-shape-of-selection", "title": "get single shape of selection", "body": "<p>I am currently wondering if there is a way to get single objects (shapes) of a selection.</p>\n\n<p>I have the following selection:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>ActiveSheet.Shapes.Range(Array(\"feed\", \"000-100-SRC\", \"product\")).Select\n</code></pre>\n\n<p>How do I get the name of the first item?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514219505, "post_id": 47970021, "comment_id": 82910044, "body": "Consider using arrays rather than continually touching the spreadsheet I.e. read data into arrays where possible and perform operations on the arrays."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514241479, "post_id": 47970021, "comment_id": 82914555, "body": "So, you have a single set of coordinates and you want to determine which two have the shortest distance between each other (only returning a single point), correct? And is this a one-time job or something that would be re-calculated as the data changes?"}, {"owner": {"reputation": 53, "user_id": 8162763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac7cd501e7828b0f48bd74fa6030380?s=128&d=identicon&r=PG&f=1", "display_name": "kdreed15", "link": "https://stackoverflow.com/users/8162763/kdreed15"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514242676, "post_id": 47970021, "comment_id": 82914720, "body": "@ashleedawg I have ~15,000 different coordinates. Each coordinate needs to show the closest distance to another coordinate in that dataset. This is a one time job."}, {"owner": {"reputation": 53, "user_id": 8162763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac7cd501e7828b0f48bd74fa6030380?s=128&d=identicon&r=PG&f=1", "display_name": "kdreed15", "link": "https://stackoverflow.com/users/8162763/kdreed15"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514242728, "post_id": 47970021, "comment_id": 82914728, "body": "@Qharr thanks, thats next on my list to learn. Guess now is as good as any time to learn."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514264546, "post_id": 47970021, "comment_id": 82917545, "body": "Coincidentally, I recently wrote a sub to do the same thing; I&#39;ll share my code shortly."}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 9124856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ttqxL.png?s=128&g=1", "display_name": "Sercho", "link": "https://stackoverflow.com/users/9124856/sercho"}, "is_accepted": true, "score": 1, "last_activity_date": 1514266058, "creation_date": 1514266058, "answer_id": 47974200, "question_id": 47970021, "link": "https://stackoverflow.com/questions/47970021/closest-distance-between-lat-longs-in-large-dataset-in-excel-vba/47974200#47974200", "title": "Closest distance between lat/longs in large dataset in excel vba", "body": "<p>I would recommend using arrays as @Qharr said. I would also look to speed up the process by including some logic steps that avoid doing the complex math on every set of points.</p>\n\n<p>What I mean is that you can do a Rough Estimate first to see whether or not to bother doing the actual calculations. I went with looking at whether or not either the Lat or Long of the current position is closer than the last closest point, but you could do anything you wanted.</p>\n\n<p>I would change your code to something like:</p>\n\n<pre><code>Sub WellSpacing()\n    Dim R As Integer, C As Integer, L As Integer, LastRow As Integer, Shortest() As Integer\n    Dim Lats() As Double, Longs() As Double, Distances() As Double\n    Dim Distance As Double, D1 As Double, D2 As Double, D3 As Double\n    Dim PI As Double\n\n    On Error Resume Next\n    PI = Application.WorksheetFunction.PI()\n    L = 2\n    R = 3\n    C = 10\n    LastRow = Sheets(\"Test\").Cells(Rows.Count, 10).End(xlUp).Row\n    ReDim Lats(1 To (LastRow - 1)) As Double\n    ReDim Longs(1 To (LastRow - 1)) As Double\n    ReDim Distances(1 To (LastRow - 1)) As Double\n    ReDim Shortest(1 To (LastRow - 1)) As Integer\n\n    For L = 2 To LastRow\n        Lats(L - 1) = Sheets(\"Test\").Range(\"J\" &amp; L).Value\n        Longs(L - 1) = Sheets(\"Test\").Range(\"K\" &amp; L).Value\n    Next L\n\n    For L = 1 To (LastRow - 1)\n        'This is a method of setting an initial value that can't be obtained  through the caclucations (so you will know if any calcs have been done or not).\n        Distances(L) = -1\n        For R = 1 To (LastRow - 1)\n            'This minimises your calculations by 15,000 to begin with\n            If R = L Then GoTo Skip_This_R\n            'This skips checking the previous distances if it is the first calculation being checked.\n            If Distances(L) = -1 Then GoTo Skip_Check\n            'If there has already been a distance calculated, this does a rough check of whether the Lat or Long is closer. If neither\n            'the Lat or Long are closer than the current closest, then it will skip it. This reduces the code by 7 lines for most pairs.\n            If Abs(Lats(L) - Lats(R)) &lt; Abs(Lats(L) - Lats(Shortest(L))) Or Abs(Longs(L) - Longs(R)) &lt; Abs(Longs(L) - Longs(Shortest(L))) Then\nSkip_Check:\n                    D1 = Sin((Abs((Lats(R) - Lats(L))) * PI / 180 / 2)) ^ 2 + Cos(Lats(L) * PI / 180) * Cos(Lats(R) * PI / 180) * Sin(Abs(Longs(R) - Longs(L)) * PI / 180 / 2) ^ 2\n                    D2 = 2 * Application.WorksheetFunction.Atan2(Sqr(1 - D1), Sqr(D1))\n                    D3 = 6371 * D2 * 3280.84\n                    If D3 &lt; Distances(L) Or Distances(L) = -1 Then\n                            Distances(L) = D3\n                            'This stores the index value in the array of the closest Lat/Long point so far.\n                            Shortest(L) = R\n                    End If\n            End If\nSkip_This_R:\n        Next R\n        'This puts the resulting closest distance into the corresponding cell.\n        Sheets(\"Test\").Range(\"L\" &amp; (L + 1)).Value = Distances(L)\n        'This clears any previous comments on the cell.\n        Sheets(\"Test\").Range(\"L\" &amp; (L + 1)).Comments.Delete\n        'This adds a nice comment to let you know which Lat/Long position it is closest to.\n        Sheets(\"Test\").Range(\"L\" &amp; (L + 1)).AddComment \"Matched to Row \" &amp; (Shortest(L) + 1)\n    Next L\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1514367213, "post_id": 47975073, "comment_id": 82947683, "body": "Very helpful and thorough explanations as well for Excel as for Access +"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 3, "last_activity_date": 1514272429, "last_edit_date": 1514272429, "creation_date": 1514271924, "answer_id": 47975073, "question_id": 47970021, "link": "https://stackoverflow.com/questions/47970021/closest-distance-between-lat-longs-in-large-dataset-in-excel-vba/47975073#47975073", "title": "Closest distance between lat/longs in large dataset in excel vba", "body": "<p>I've been working with geo-location math (aka, <a href=\"https://en.wikipedia.org/wiki/Coordinate_system#Coordinates_of_geometric_objects\" rel=\"nofollow noreferrer\">coordinate geometry</a>) a lot lately and wrote a sub to do pretty much the same thing you're seeking.</p>\n\n<p>Your code probably isn't creating an infinite loop, but calculating distances between thousands of coordinates can be <strong><em>very</em> processor-intensive</strong> and even minor changes to your code can have a <em>huge</em> impact on processing time.</p>\n\n<hr>\n\n<h2>Calculating closest coordinate pair: <strong>Brute Force Method</strong></h2>\n\n<p>There are a number of algorithms for determining closest points however the easiest to code (therefore possibly best for one-time use) is known as the <strong>Brute Force Method</strong>.</p>\n\n<pre><code>For p1 = 1 to numPoints\n    For p2 = p1 + 1 to numPoints\n        ...calculate {distance}\n        ...if {distance} &lt; minDistance then minDist = {distance}\n    Next p2\nNext p1\n</code></pre>\n\n<p>Using this method, distance will be calculated between <strong><em><code>x * ( n - 1 ) / 2</code></em></strong> pairs of points.</p>\n\n<p>For example, a list of <strong>5 points</strong> would require <strong>10 comparisons</strong>:</p>\n\n<blockquote>\n  <ol>\n  <li><strong>Point 1</strong>  \u2194  <strong>Point 2</strong></li>\n  <li><strong>Point 1</strong>  \u2194  <strong>Point 3</strong></li>\n  <li><strong>Point 1</strong>  \u2194  <strong>Point 4</strong></li>\n  <li><strong>Point 1</strong>  \u2194  <strong>Point 5</strong></li>\n  <li><strong>Point 2</strong>  \u2194  <strong>Point 3</strong></li>\n  <li><strong>Point 2</strong>  \u2194  <strong>Point 4</strong></li>\n  <li><strong>Point 2</strong>  \u2194  <strong>Point 5</strong></li>\n  <li><strong>Point 3</strong>  \u2194  <strong>Point 4</strong></li>\n  <li><strong>Point 3</strong>  \u2194  <strong>Point 5</strong></li>\n  <li><strong>Point 4</strong>  \u2194  <strong>Point 5</strong></li>\n  </ol>\n</blockquote>\n\n<p>Since additional points will increase execution time <em>exponentially</em>, this method can create some lengthy processing times, especially on a slower machine or with an excessive number of points.</p>\n\n<p>The methods I use for <strong>calculating distances between points</strong> and for <strong>comparing distances between lists of points</strong> are far from the [code-heavier] most-efficient alternatives, but they work for my \"one-off\" needs.</p>\n\n<p>Depending on my purposes, I'll switch (<em>almost</em> identical code) between Excel &amp; Access, but Access is much faster, so you may want to move your list into a table and do it that way.</p>\n\n<p>One of the lists of points I compare has <strong>252 items</strong>, which requires <strong>31,628 individual comparisons</strong> using this \"easy-code\" method.  In <strong>Excel</strong>, the process completes in <strong>1.12 seconds</strong>, which is <strong>Access</strong> it only takes <strong>0.16 seconds</strong>.</p>\n\n<p>This may not seem like a big difference until we starting working with longer lists of points: another list of mine (closer to the size of yours) has about <strong>12,000 points</strong>, which requires <strong>71,994,000 calculations</strong> using the <em>Brute Force</em> method. In <strong>Access</strong>, the process completes in <strong>8.6 minutes</strong>, so I estimate it would take <strong>about an hour</strong> in <strong>Excel</strong>.</p>\n\n<p>Of course, all of these times are based on my operating system, processing power, Office version, etc.  VBA isn't ideal for this level of computation, and everything you can do to reduce length of code will make a big difference, including commenting-out the status bar updates, immediate-window output, turn off screen updates, etc.</p>\n\n<p>This code is a little messy &amp; un-commented since I slapped it together for my own purposes, but it works for me.  Let me know if you have any questions about how it works.  All calculations are in metric but can be easily converted.</p>\n\n<pre><code>Sub findShortestDist_Excel()\n\n    Const colLatitude = \"C\" ' Col.C = Lat, Col.D = Lon\n    Dim pointList As Range, pointCount As Long, c As Range, _\n        arrCoords(), x As Long, y As Long\n    Dim thisDist As Double, minDist As Double, minDist_txt As String\n    Dim cntCurr As Long, cntTotal As Long, timerStart As Single\n\n    timerStart = Timer\n    Set pointList = Sheets(\"Stops\").UsedRange.Columns(colLatitude)\n    pointCount = WorksheetFunction.Count(pointList.Columns(1))\n\n    'build array of numbers found in Column C/D\n    ReDim arrCoords(1 To 3, 1 To pointCount)\n    For Each c In pointList.Columns(1).Cells\n        If IsNumeric(c.Value) And Not IsEmpty(c.Value) Then\n            x = x + 1\n            arrCoords(1, x) = c.Value\n            arrCoords(2, x) = c.Offset(0, 1).Value\n        End If\n    Next c\n\n    minDist = -1\n    cntTotal = pointCount * (pointCount + 1) / 2\n\n    'loop through array\n    For x = 1 To pointCount\n        For y = x + 1 To pointCount\n            If (arrCoords(1, x) &amp; arrCoords(2, x)) &lt;&gt; (arrCoords(1, y) &amp; arrCoords(2, y)) Then\n                cntCurr = cntCurr + 1\n                thisDist = Distance(arrCoords(1, x), arrCoords(2, x), _\n                    arrCoords(1, y), arrCoords(2, y))\n                'check if this distance is the smallest yet\n                If ((thisDist &lt; minDist) Or (minDist = -1)) And thisDist &gt; 0 Then\n                    minDist = thisDist\n                    'minDist_txt = arrCoords(1, x) &amp; \",\" &amp; arrCoords(2, x) &amp; \" -&gt; \" &amp; arrCoords(1, y) &amp; \",\" &amp; arrCoords(2, y)\n                End If\n                'Application.StatusBar = \"Calculating Distances: \" &amp; Format(cntCurr / cntTotal, \"0.0%\")\n            End If\n        Next y\n        'DoEvents\n    Next x\n\n    Debug.Print \"Minimum distance: \" &amp; minDist_txt &amp; \" = \" &amp; minDist &amp; \" meters\"\n    Debug.Print \"(\" &amp; Round(Timer - timerStart, 2) &amp; \"sec)\"\n    Application.StatusBar = \"Finished.  Minimum distance: \" &amp; minDist_txt &amp; \" = \" &amp; minDist &amp; \"m\"\n\nEnd Sub\n</code></pre>\n\n<p>Note that <strong><em>the procedure above is dependent on the following</em></strong> (which has slightly different versions for Access vs. Excel):</p>\n\n<h2>Excel: <em>Calculate distance between points</em></h2>\n\n<pre><code>Public Function Distance(ByVal lat1 As Double, ByVal lon1 As Double, _\n    ByVal lat2 As Double, ByVal lon2 As Double) As Double\n'returns Meters distance in Excel (straight-line)\n    Dim theta As Double: theta = lon1 - lon2\n    Dim Dist As Double: Dist = Math.Sin(deg2rad(lat1)) * Math.Sin(deg2rad(lat2)) + Math.Cos(deg2rad(lat1)) * Math.Cos(deg2rad(lat2)) * Math.Cos(deg2rad(theta))\n    Dist = rad2deg(WorksheetFunction.Acos(Dist))\n    Distance = Dist * 60 * 1.1515 * 1.609344 * 1000\nEnd Function\n\nFunction deg2rad(ByVal deg As Double) As Double\n    deg2rad = (deg * WorksheetFunction.PI / 180#)\nEnd Function\n\nFunction rad2deg(ByVal rad As Double) As Double\n    rad2deg = rad / WorksheetFunction.PI * 180#\nEnd Function\n</code></pre>\n\n<p>...and alternative code, for Microsoft Access:</p>\n\n<h2>Access: <em>Shortest Distance</em></h2>\n\n<pre><code>Sub findShortestDist_Access()\n\n    Const tableName = \"Stops\"\n    Dim pointCount As Long, arrCoords(), x As Long, y As Long\n    Dim thisDist As Double, minDist As Double\n    Dim cntCurr As Long, cntTotal As Long, timerStart As Single\n    Dim rs As Recordset\n\n    timerStart = Timer\n\n    Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM \" &amp; tableName)\n    With rs\n        .MoveLast\n        .MoveFirst\n        pointCount = .RecordCount\n\n        'build array of numbers found in Column C/D\n        ReDim arrCoords(1 To 2, 1 To pointCount)\n        Do While Not .EOF\n            x = x + 1\n            arrCoords(1, x) = !stop_lat\n            arrCoords(2, x) = !stop_lon\n            .MoveNext\n        Loop\n        .Close\n    End With\n\n    minDist = -1\n    cntTotal = pointCount * (pointCount + 1) / 2\n    SysCmd acSysCmdInitMeter, \"Calculating Distances:\", cntTotal\n\n    'loop through array\n    For x = 1 To pointCount\n        For y = x + 1 To pointCount\n                cntCurr = cntCurr + 1\n                thisDist = Distance(arrCoords(1, x), arrCoords(2, x), _\n                    arrCoords(1, y), arrCoords(2, y))\n                'check if this distance is the smallest yet\n                If ((thisDist &lt; minDist) Or (minDist = -1)) And thisDist &gt; 0 Then\n                    minDist = thisDist\n                End If\n                SysCmd acSysCmdUpdateMeter, cntCurr\n        Next y\n        DoEvents\n    Next x\n    SysCmd acSysCmdRemoveMeter\n    Debug.Print \"Minimum distance: \" &amp; minDist_txt &amp; \" = \" &amp; minDist &amp; \" meters\"\n    Debug.Print \"(\" &amp; Round(Timer - timerStart, 2) &amp; \"sec)\"\n\nEnd Sub\n</code></pre>\n\n<p>Note that <strong><em>the procedure above is dependent on the following</em></strong>...  (Access may handle mass-calculations more quickly, but we have to build some functions ourselves that are built-in to Excel)</p>\n\n<h2>Access: <em>Calculate distance between points</em></h2>\n\n<pre><code>Const pi As Double = 3.14159265358979\n\nPublic Function Distance(ByVal lat1 As Double, ByVal lon1 As Double, _\n    ByVal lat2 As Double, ByVal lon2 As Double) As Double\n'returns Meters distance in Access (straight-line)\n    Dim theta As Double: theta = lon1 - lon2\n    Dim dist As Double\n    dist = Math.Sin(deg2rad(lat1)) * Math.Sin(deg2rad(lat2)) + Math.Cos(deg2rad(lat1)) _\n        * Math.Cos(deg2rad(lat2)) * Math.Cos(deg2rad(theta))\n    dist = rad2deg(aCos(dist))\n    Distance = dist * 60 * 1.1515 * 1.609344 * 1000\nEnd Function\n\nFunction deg2rad(ByVal deg As Double) As Double\n    deg2rad = (deg * pi / 180#)\nEnd Function\n\nFunction rad2deg(ByVal rad As Double) As Double\n    rad2deg = rad / pi * 180#\nEnd Function\n\nFunction aTan2(x As Double, y As Double) As Double\n    aTan2 = Atn(y / x)\nEnd Function\n\nFunction aCos(x As Double) As Double\n    On Error GoTo aErr\n    If x = 0 Or Abs(x) = 1 Then\n        aCos = 0\n    Else\n        aCos = Atn(-x / Sqr(-x * x + 1)) + 2 * Atn(1)\n    End If\n    Exit Function\naErr:\n    aCos = 0\nEnd Function\n</code></pre>\n\n<hr>\n\n<h2>Planar Case</h2>\n\n<p>Another method of calculating closer points is called <strong>Planar Case</strong>.  I haven't seen any ready-to-use code samples and I don't need it bad enough to  bother coding it, but the gist of it is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/s9RQv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s9RQv.png\" alt=\"Planar Case\"></a></p>\n\n<p>Read about this and more about the <strong><a href=\"https://en.wikipedia.org/wiki/Closest_pair_of_points_problem\" rel=\"nofollow noreferrer\">Closest pair of points problem</a></strong> on Wikipedia.</p>\n"}], "owner": {"reputation": 53, "user_id": 8162763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac7cd501e7828b0f48bd74fa6030380?s=128&d=identicon&r=PG&f=1", "display_name": "kdreed15", "link": "https://stackoverflow.com/users/8162763/kdreed15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1217, "favorite_count": 0, "accepted_answer_id": 47974200, "answer_count": 2, "score": 5, "last_activity_date": 1514285397, "creation_date": 1514216396, "last_edit_date": 1514243657, "question_id": 47970021, "link": "https://stackoverflow.com/questions/47970021/closest-distance-between-lat-longs-in-large-dataset-in-excel-vba", "title": "Closest distance between lat/longs in large dataset in excel vba", "body": "<p>Beginner looper here...I am working on this well spacing project that looks at lat/longs and determines the next closest well. I think I may be creating an infinite loop or the program is just taking forever to run (It's looping through 15,000 rows). My main struggle has been trying to make sure each location is compared to every location in the dataset. From there I take the 2nd lowest distance (since the lowest will be zero when it compares to itself).</p>\n\n<pre><code>Sub WellSpacing()\nDim r As Integer, c As Integer, L As Integer, lastrow As Integer\nDim lat1 As Double, lat2 As Double, long1 As Double, long2 As Double\nDim distance As Double, d1 As Double, d2 As Double, d3 As Double\nDim PI As Double\n\nPI = Application.WorksheetFunction.PI()\nL = 2\nr = 3\nc = 10\nlastrow = Sheets(\"Test\").Cells(Rows.Count, \"J\").End(xlUp).Row\n\nFor L = 2 To lastrow\n    For r = 2 To lastrow\n        lat1 = Sheets(\"Test\").Cells(L, c)\n        long1 = Sheets(\"Test\").Cells(L, c + 1)\n        lat2 = Sheets(\"Test\").Cells(r, c)\n        long2 = Sheets(\"Test\").Cells(r, c + 1)\n        d1 = Sin((Abs((lat2 - lat1)) * PI / 180 / 2)) ^ 2 + Cos(lat1 * PI / 180) * Cos(lat2 * PI / 180) * Sin(Abs(long2 - long1) * PI / 180 / 2) ^ 2\n        d2 = 2 * Application.WorksheetFunction.Atan2(Sqr(1 - d1), Sqr(d1))\n        d3 = 6371 * d2 * 3280.84\n        Sheets(\"Working\").Cells(r - 1, c - 9) = d3\n    Next r\n\n    Sheet2.Activate\n    Range(\"A:A\").Sort Key1:=Range(\"A1\"), Order1:=xlAscending\n    distance = Sheet2.Range(\"A2\")\n    Sheets(\"Test\").Cells(L, c + 2) = distance\n    Sheet2.Range(\"A:A\").Clear\n    Sheet1.Activate\n\nNext L\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514203222, "post_id": 47968184, "comment_id": 82906295, "body": "Are you familiar with <code>Application.ScreenUpdating</code> and <code>Application.StatusBar</code> <code>Application</code> properties?"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514203396, "post_id": 47968184, "comment_id": 82906329, "body": "@AntiDrondert I tried adding <code>Application.ScreenUpdating = False</code> to the <code>start</code> macros, its seems to be working faster, but the fundamental problem: that if the inner statusbar is renewed the macros is slower still exists."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1514204250, "post_id": 47968184, "comment_id": 82906511, "body": "&quot;the fundamental problem: that if the inner statusbar is renewed the macros is slower still exists&quot;: So you think the time which is needed updating the status bar could be 0? It surely cannot be 0."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514205044, "post_id": 47968184, "comment_id": 82906719, "body": "@Ans Compare status bar flickering to screen flickering, when <code>Application.ScreenUpdating</code> is <code>True</code>. Statement itself is false, ofcourse, but it gives the general idea of what is happening. It spends time (I don&#39;t know numbers) to access <code>Application.StatusBar</code> properties and update them on each iteration (total of 100). It is similiar to updating Worksheet data, when screen updating is turned off. I should add that <code>Client</code> class module is irrelevant in this question."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1514205498, "post_id": 47968184, "comment_id": 82906849, "body": "Status bar is ultimately visual indicator so it will take some time. How long does your program take with and without it?"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1514205928, "post_id": 47968184, "comment_id": 82906967, "body": "When the status bar is updated, it is not slow because it works 100 * 100000 times."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1514208710, "post_id": 47968184, "comment_id": 82907620, "body": "@AntiDrondert Thank you for the answer. But isn&#39;t the statusbar supposed to be renewed in a separate thread, so that it wouldn&#39;t affect the other thread&#39;s computations?"}], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 1, "last_activity_date": 1514224591, "creation_date": 1514224591, "answer_id": 47970899, "question_id": 47968184, "link": "https://stackoverflow.com/questions/47968184/excel-vba-program-takes-a-long-time-if-status-bar-is-renewed/47970899#47970899", "title": "Excel vba: program takes a long time if status bar is renewed", "body": "<p>VBA is fast enough as long as you stay within. Whenever you turn to Excel, it may get much slower because Excel makes thousands of operations every time it gets control. You may consider turning off a few more services of Excel like I do in my applications: </p>\n\n<pre><code>Application.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False\nApplication.EnableEvents = False\nActiveSheet.DisplayPageBreaks = False\n</code></pre>\n\n<p>... and as far as I know DoEvents is the best way to make Excel update the status bar when you turn off automatic updates. \nAnother timesaving workaround can be to display only every 100th or 1000th message from within the inner loop.</p>\n"}, {"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1514379589, "post_id": 47985542, "comment_id": 82953396, "body": "But wouldn&#39;t that check <code>j MOD 100 = 0</code> that would need to happen at every iteration slow down execution time as well?"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1514803492, "post_id": 47985542, "comment_id": 83069500, "body": "the doevents would slow down way more then a simple if"}], "tags": [], "owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "is_accepted": false, "score": 1, "last_activity_date": 1514340781, "creation_date": 1514340781, "answer_id": 47985542, "question_id": 47968184, "link": "https://stackoverflow.com/questions/47968184/excel-vba-program-takes-a-long-time-if-status-bar-is-renewed/47985542#47985542", "title": "Excel vba: program takes a long time if status bar is renewed", "body": "<p>when doing a progressbar or statusbar, you need to use it wisely.</p>\n\n<p>Basically the progress info needs to be refreshed only every 0.1 seconds or so.</p>\n\n<p>Knowing your max number of loops , and the time it takes, you might want to update the info only every (in your case) , let's say, 100 iterations of the loop.</p>\n\n<p>This is done like this:  if j mod 100=0 then application.statusbar=\"...\" : doevents</p>\n\n<p>Usually i even go further by using doevents less than my progressbar (second if j mod).</p>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2203, "favorite_count": 0, "accepted_answer_id": 47970899, "answer_count": 2, "score": 0, "last_activity_date": 1514340781, "creation_date": 1514201373, "question_id": 47968184, "link": "https://stackoverflow.com/questions/47968184/excel-vba-program-takes-a-long-time-if-status-bar-is-renewed", "title": "Excel vba: program takes a long time if status bar is renewed", "body": "<p>I have a program that creates <code>100 000</code> objects of class <code>Client</code>, puts them into array and then goes through that array <code>100</code> times, each time assigning each <code>Client</code> a different random number through <code>Rnd()</code> function:</p>\n\n<p>Main sub:  </p>\n\n<pre><code>Sub start()\n    Dim i As Long\n    Dim j As Long\n\n    Dim clientsColl() As Client\n    ReDim clientsColl(1 To 100000) As Client\n\n    For j = 1 To 100000\n        Set clientsColl(j) = New Client\n        clientsColl(j).setClientName = \"Client_\" &amp; j\n\n        Application.StatusBar = \"Getting client \" &amp; j\n\n        DoEvents\n    Next\n\n\n    Dim tempCount As Long\n    Dim clientCopy As Variant\n    For i = 1 To 100\n        tempCount = 0\n        For Each clientCopy In clientsColl\n            tempCount = tempCount + 1\n\n            clientCopy.generateRandom\n\n            'Application.StatusBar = \"Calculating \" &amp; i &amp; \": \" &amp; tempCount &amp; \"/\" &amp; 100000  '(1)\n\n            'DoEvents\n        Next\n\n        Application.StatusBar = \"Calculating \" &amp; i\n\n        DoEvents\n    Next\n\n    MsgBox (\"done\")\nEnd Sub\n</code></pre>\n\n<p><code>Client</code> class:</p>\n\n<pre><code>Option Explicit\n\nDim clientName As String\nDim randomNumber As Double\n\nPublic Sub generateRandom()\n    randomNumber = Rnd()\nEnd Sub\n\nPublic Property Get getClientName()\n    getClientName = clientName\nEnd Property\n\nPublic Property Let setClientName(value As String)\n    clientName = value\nEnd Property\n</code></pre>\n\n<p>The problem is, the execution time depends on whether or not line <code>(1)</code> is commented out. If it's executed, the statusbar gets renewed, but the execution time is very slow. If it's not executed, the program gets done really fast.</p>\n\n<p>Why does this happen?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514186173, "post_id": 47966406, "comment_id": 82902555, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/34837006/excel-vba-add-code-to-sheet-module-programmatically\">Excel vba add code to sheet module programmatically</a>"}, {"owner": {"reputation": 13, "user_id": 9138036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4001af9ff96f20a823631dad103e856?s=128&d=identicon&r=PG&f=1", "display_name": "jc agunos", "link": "https://stackoverflow.com/users/9138036/jc-agunos"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514186695, "post_id": 47966406, "comment_id": 82902640, "body": "i tryed that one but its create additional workbook not on the woorkbook it selft and i try to manipulate the code so that it just on the thisworkbook it will apply, but no lock, its not working. im just new to vba and starting, thank you again"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1514188520, "post_id": 47966406, "comment_id": 82903018, "body": "I have given you an example below."}], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1514186625, "creation_date": 1514186625, "answer_id": 47966579, "question_id": 47966406, "link": "https://stackoverflow.com/questions/47966406/excel-vba-transfer-of-code-from-module-to-sheet-newly-created-work-sheet/47966579#47966579", "title": "excel vba transfer of code from module to sheet newly created work sheet", "body": "<p>do like this</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Address = \"$D$10\" Then\n\n    Call mymacro\n    Me.Copy after:=Sheets(Sheets.Count)\n    ActiveSheet.Cells.Clear\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1514188819, "last_edit_date": 1514188819, "creation_date": 1514188488, "answer_id": 47966768, "question_id": 47966406, "link": "https://stackoverflow.com/questions/47966406/excel-vba-transfer-of-code-from-module-to-sheet-newly-created-work-sheet/47966768#47966768", "title": "excel vba transfer of code from module to sheet newly created work sheet", "body": "<p>An example adaption of <a href=\"https://stackoverflow.com/questions/34837006/excel-vba-add-code-to-sheet-module-programmatically\">@davesexcel</a> as i have never tried this way before. This code goes in a standard module which you could call from your main sub. Requires a reference to be added to VBA Extensibility and access to vb model to be trusted.</p>\n\n<pre><code>Public Sub AddWorksheetEventCode()\n'Tools &gt; references &gt; Microsoft Visual Basic for Applications Extensibility 5.3 \n'Trust access to VBA model\n\n    Dim wb As Workbook\n    Dim wsNew As Worksheet\n\n    Set wb = ThisWorkbook\n\n    Dim xPro As VBIDE.VBProject\n    Dim xCom As VBIDE.VBComponent\n    Dim xMod As VBIDE.CodeModule\n    Dim xLine As Long\n\n    wb.Worksheets.Add After:= wb.Worksheets(ActiveSheet.Index)\n    Set wsNew = ActiveSheet\n\n    With wsNew\n        Set xPro = wb.VBProject\n        Set xCom = xPro.VBComponents(wsNew.Name)\n        Set xMod = xCom.CodeModule\n\n        With xMod\n\n            xLine = .CreateEventProc(\"Change\", \"Worksheet\")\n            xLine = xLine + 1\n            .InsertLines xLine, \"If Target.Address = \"\"$D$10\"\" Then \"\n            xLine = xLine + 1\n            .InsertLines xLine, \"Call mymacro\"\n\n        End With\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Enable <a href=\"https://www.ibm.com/support/knowledgecenter/en/SSD29G_2.0.0/com.ibm.swg.ba.cognos.ug_cxr.2.0.0.doc/t_ug_cxr_enable_developer_macro_settings.html\" rel=\"nofollow noreferrer\">Trust access</a> to the VBA project object model:</strong></p>\n\n<ol>\n<li>Click File and then Options.</li>\n<li>In the navigation pane, select Trust Center.</li>\n<li>Click Trust Center Settings....</li>\n<li>In the navigation pane, select Macro Settings.</li>\n<li>Ensure that Trust access to the VBA project object model is checked.</li>\n<li>Click OK.</li>\n</ol>\n\n<p>**Read up on trusting access to the vba project model to determine if appropriate for you.</p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 6, "last_activity_date": 1514204512, "last_edit_date": 1514204512, "creation_date": 1514188971, "answer_id": 47966818, "question_id": 47966406, "link": "https://stackoverflow.com/questions/47966406/excel-vba-transfer-of-code-from-module-to-sheet-newly-created-work-sheet/47966818#47966818", "title": "excel vba transfer of code from module to sheet newly created work sheet", "body": "<p>You could use the Workbook_SheetChange Event. Put the code in the workbook module. Then there is no need to copy any code it all. </p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n   If Target.Address = \"$D$10\" Then\n       Call mymacro\n   End If\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong> If you need to prevent the code from running on certain sheets you could add the follwoing function</p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n    On Error Resume Next ' Invalid Parameters passed, IsInArray will be defaulted to FALSE\n    IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\n</code></pre>\n\n<p>and change the Workbook_SheetChange Event to</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\nDim shArr() As Variant\n\n    'Example, mymacro will not run on the sheets \"Overview\" and \"Total\"\n    shArr = Array(\"Overview\", \"Total\")\n\n    If Not IsInArray(Sh.Name, shArr) Then\n        If Target.Address = \"$D$10\" Then\n            Call mymacro\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1514204298, "post_id": 47967999, "comment_id": 82906526, "body": "If you need to prevent code from running on certain sheets you could add a function isInArray. I edited my answer."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1514249930, "last_edit_date": 1514249930, "creation_date": 1514199817, "answer_id": 47967999, "question_id": 47966406, "link": "https://stackoverflow.com/questions/47966406/excel-vba-transfer-of-code-from-module-to-sheet-newly-created-work-sheet/47967999#47967999", "title": "excel vba transfer of code from module to sheet newly created work sheet", "body": "<p>I have up-voted @Storax answer because I didn't know that. However, you should bear in mind that the Workbook_SheetChange event will fire for <em>all</em> sheets, possibly including some where you don't want your macro to run. Therefore you would need to add code to prevent the macro from taking action when the event is triggered where you don't want it.</p>\n\n<p>As an alternative, look at the way you create your sheets. If you <code>insert</code> a new sheet the new addition will be totally blank, but if you use \"Move or Copy / Create a copy\" (or its VBA equivalent) you get a new sheet which is the copy of the original including its code. A further advantage is that you get a fully formatted sheet, and it is normally quite easy to clean out any data that were also copied in this process.</p>\n"}], "owner": {"reputation": 13, "user_id": 9138036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4001af9ff96f20a823631dad103e856?s=128&d=identicon&r=PG&f=1", "display_name": "jc agunos", "link": "https://stackoverflow.com/users/9138036/jc-agunos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 1, "accepted_answer_id": 47966768, "answer_count": 4, "score": 1, "last_activity_date": 1514249930, "creation_date": 1514184980, "last_edit_date": 1514189489, "question_id": 47966406, "link": "https://stackoverflow.com/questions/47966406/excel-vba-transfer-of-code-from-module-to-sheet-newly-created-work-sheet", "title": "excel vba transfer of code from module to sheet newly created work sheet", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$D$10\" Then\n        Call mymacro\n    End If\nEnd Sub\n</code></pre>\n\n<p>the question is:          </p>\n\n<ol>\n<li>i can store this code to a module?</li>\n<li>if not, how can the code be the code transfer to the newly created        worksheet </li>\n<li>from module how can i transfer this code every time a sheet is added\nThanks in advance</li>\n</ol>\n"}]