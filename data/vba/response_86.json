[{"tags": ["excel", "compiler-errors", "macros", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1472687912, "post_id": 39260737, "comment_id": 65857371, "body": "Do you read the code you copy/paste? You&#39;re calling <code>AddDropDown</code> with no arguments, and it&#39;s clearly written to require 4 (a worksheet, a long, and two strings)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1472688412, "post_id": 39260737, "comment_id": 65857503, "body": "Yes, the help page is exactly correct.  <code>The number and types of arguments must match those expected.</code>  You have called it with no parameters (<code>AddDropDown</code>), and it is expecting 4 values (<code>Sub AddDropDown(sht As Worksheet, dropDownCounter As Long, header As String, validationFormula As String)</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1472835577, "post_id": 39260950, "comment_id": 65928709, "body": "Would the <i>brave</i> downvoter show up and give any explanation so as to both have people know why they shouldn&#39;t follow thi answer and teach me how to improve it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1472689367, "creation_date": 1472689367, "answer_id": 39260950, "question_id": 39260737, "link": "https://stackoverflow.com/questions/39260737/compile-error-argument-not-optional-error-when-i-call-macro-from-other-macro/39260950#39260950", "title": "Compile Error: Argument not optional error when I call macro from other macro", "body": "<p>In <code>Sub Button_Click()</code>, change:</p>\n\n<pre><code>Private Sub Button_Click()\n    Macro1\n    Macro2\n    AddDropDowns\n    AddDropDown\n    Macro3\nEnd Sub\n</code></pre>\n\n<p>into: </p>\n\n<pre><code>Private Sub Button_Click()\n    Macro1\n    Macro2\n    AddDropDowns\n    Macro3\nEnd Sub\n</code></pre>\n\n<p>In <code>AddDropDowns()</code>, change:</p>\n\n<pre><code>AddDropDownEnroll Worksheets(\"DropDownsSheet\"), iDropDown, cell.Offset(-1).Value, \"='\" &amp; .Name &amp; \"'!\" &amp; cell.Resize(WorksheetFunction.CountA(cell.EntireColumn) - 1).Address\n</code></pre>\n\n<p>into:</p>\n\n<pre><code>AddDropDown Worksheets(\"DropDownsSheet\"), iDropDown, cell.Offset(-1).Value, \"='\" &amp; .Name &amp; \"'!\" &amp; cell.Resize(WorksheetFunction.CountA(cell.EntireColumn) - 1).Address\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "accepted_answer_id": 39260950, "answer_count": 1, "score": 0, "last_activity_date": 1472689367, "creation_date": 1472687642, "last_edit_date": 1531161705, "question_id": 39260737, "link": "https://stackoverflow.com/questions/39260737/compile-error-argument-not-optional-error-when-i-call-macro-from-other-macro", "title": "Compile Error: Argument not optional error when I call macro from other macro", "body": "<p>I have a button that when pressed calls some Macros to be done. \nAll my macros are running fine with Exception of the \u201cAddDropDown\u201c Macro. \nIt keeps giving me an error that says \u201cCompile Error: Argument not optional (Error 449)\u201d. </p>\n\n<p>These run fine if I manually just select them and press Run. </p>\n\n<p>The help page says \u201cThe number and types of arguments must match those expected. This error has the following causes and solutions:\n\u2022   Incorrect number of arguments. Supply all necessary arguments. For example, the Left function requires two arguments; the first representing the character string being operated on, and the second representing the number of characters to return from the left side of the string. Because neither argument is optional, both must be supplied.\n\u2022   Omitted argument isn't optional. An argument can only be omitted from a call to a user-defined procedure if it was declared Optional in the procedure declaration. Either supply the argument in the call or declare the parameter Optional in the definition.\u201d</p>\n\n<p>My code is something like this:</p>\n\n<pre><code>    Private Sub Button_Click()\n        Macro1\n        Macro2\n        AddDropDowns\n        AddDropDown\n        Macro3\n    End Sub\n</code></pre>\n\n<p>And the Macro that gives the error is the one below:</p>\n\n<pre><code>Sub AddDropDowns()\nDim cell As Range\nDim iDropDown As Long\n\nWith Worksheets(\"SourceSheet\")\n    For Each cell In .Range(\"B13\", .Cells(13,     .Columns.Count).End(xlToLeft)).SpecialCells(XlCellType.xlCellTypeConstants)\n        AddDropDownEnroll Worksheets(\"DropDownsSheet\"), iDropDown, cell.Offset(-1).Value, \"='\" &amp; .Name &amp; \"'!\" &amp; cell.Resize(WorksheetFunction.CountA(cell.EntireColumn) - 1).Address \n    Next cell\nEnd With\nEnd Sub\n\n\nSub AddDropDown(sht As Worksheet, dropDownCounter As Long, header As String, validationFormula As String)\nWith sht.Range(\"A1\").Offset(, dropDownCounter) '&lt;--| reference passed sheet row 1 passed column\n    .Cells(1, 1) = header '&lt;--| write header\n    With .Cells(2, 1).Validation '&lt;--| reference 'Validation' property of cell 1 row below currently referenced one\n        .Delete            \n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=validationFormula\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .ErrorTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = True\n        .ShowError = True\n    End With\nEnd With\ndropDownCounter = dropDownCounter + 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 1, "creation_date": 1472685614, "post_id": 39260443, "comment_id": 65856811, "body": "&quot;code is not working&quot; is not helpful to anyone. Please provide details of what the expected behavior is, and what the error is."}, {"owner": {"reputation": 23, "user_id": 6763299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e94372f5136774a0c340f7ea624e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mblankfield", "link": "https://stackoverflow.com/users/6763299/mblankfield"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1472685816, "post_id": 39260443, "comment_id": 65856860, "body": "Find the newest file located in &quot;sFolder&quot; that begins with &quot;sName&quot; and that has a &quot;sOPID&quot; that matches the &quot;value38&quot; result of the ReadTextFile function is the expected behavior. Returns 0 value is the current error. I assume it is not passing a variable between the if statements correctly but I am not sure."}, {"owner": {"reputation": 23, "user_id": 6763299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e94372f5136774a0c340f7ea624e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mblankfield", "link": "https://stackoverflow.com/users/6763299/mblankfield"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1472686200, "post_id": 39260443, "comment_id": 65856956, "body": "The output should be a date. It should be the most recent date that matches all three criteria."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472686207, "post_id": 39260443, "comment_id": 65856961, "body": "Why on earth would you use a mix of <code>FileSystemObject</code> and legacy VBA file handling? If you iterate the actual <code>File</code> objects in the directory instead of using <code>Dir</code>, you can use the FSO methods to read the file..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472686228, "post_id": 39260443, "comment_id": 65856970, "body": "Need to do a little debugging - add some <code>Debug.Print</code> lines or breakpoints to make sure you&#39;re getting the values you expect"}, {"owner": {"reputation": 23, "user_id": 6763299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e94372f5136774a0c340f7ea624e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mblankfield", "link": "https://stackoverflow.com/users/6763299/mblankfield"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472686354, "post_id": 39260443, "comment_id": 65857005, "body": "@Comintern I initially tried with FileSystemObject but the folder has ~13,000 files and is growing daily."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1472686462, "post_id": 39260443, "comment_id": 65857027, "body": "@Mblankfield maybe this can help <a href=\"http://spreadsheetpage.com/index.php/tip/identifying_the_newest_file_in_a_directory/\" rel=\"nofollow noreferrer\">spreadsheetpage.com/index.php/tip/&hellip;</a>"}, {"owner": {"reputation": 1632, "user_id": 1137382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70bf08ba67ec43e13287b989ac566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Hewitt", "link": "https://stackoverflow.com/users/1137382/jim-hewitt"}, "edited": false, "score": 0, "creation_date": 1472686758, "post_id": 39260443, "comment_id": 65857099, "body": "Am I missing something?  What is <code>Split(fline, vbTab)(38)</code>?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 1632, "user_id": 1137382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70bf08ba67ec43e13287b989ac566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Hewitt", "link": "https://stackoverflow.com/users/1137382/jim-hewitt"}, "edited": false, "score": 0, "creation_date": 1472687101, "post_id": 39260443, "comment_id": 65857174, "body": "@JimHewitt that gets the 38th value on the second line of a tab delimited file"}, {"owner": {"reputation": 23, "user_id": 6763299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e94372f5136774a0c340f7ea624e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mblankfield", "link": "https://stackoverflow.com/users/6763299/mblankfield"}, "reply_to_user": {"reputation": 1632, "user_id": 1137382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70bf08ba67ec43e13287b989ac566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Hewitt", "link": "https://stackoverflow.com/users/1137382/jim-hewitt"}, "edited": false, "score": 0, "creation_date": 1472687355, "post_id": 39260443, "comment_id": 65857230, "body": "@Jim Slai is correct. I want to compare the 38th value on the second line of my tab delimited file to the input value of sOPID and make sure they are equal."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472687483, "post_id": 39260443, "comment_id": 65857256, "body": "Is <code>MsgBox fpath</code> firing?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472687775, "post_id": 39260443, "comment_id": 65857331, "body": "Also - what does <code>FileDateTime</code> return? The file creation date?"}, {"owner": {"reputation": 23, "user_id": 6763299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e94372f5136774a0c340f7ea624e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mblankfield", "link": "https://stackoverflow.com/users/6763299/mblankfield"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472687806, "post_id": 39260443, "comment_id": 65857342, "body": "@Comintern No, I can only get it to fire by running just the first function. FileDateTime returns either creation date or last modified date but in my case they are always going to be the same."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472708276, "post_id": 39260443, "comment_id": 65862208, "body": "using (38) will give you the 39th element in the line, since Split by default creates a zero-based array."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6763299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e94372f5136774a0c340f7ea624e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mblankfield", "link": "https://stackoverflow.com/users/6763299/mblankfield"}, "edited": false, "score": 0, "creation_date": 1472694341, "post_id": 39261137, "comment_id": 65858808, "body": "Wow! Thank you so much. It works great. I really appreciate you finding a better way to solve my problem. This made my day :D"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 23, "user_id": 6763299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e94372f5136774a0c340f7ea624e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mblankfield", "link": "https://stackoverflow.com/users/6763299/mblankfield"}, "edited": false, "score": 0, "creation_date": 1472694648, "post_id": 39261137, "comment_id": 65858880, "body": "@Mblankfield - I felt your pain when you said 13K files and growing daily... ;-)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 23, "user_id": 6763299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e94372f5136774a0c340f7ea624e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mblankfield", "link": "https://stackoverflow.com/users/6763299/mblankfield"}, "edited": false, "score": 0, "creation_date": 1472694892, "post_id": 39261137, "comment_id": 65858933, "body": "@Mblankfield - Also forgot to mention. If you start getting weird FSO errors like &quot;File not found&quot; or &quot;Read past end of stream&quot; on the temp file, either increase the &#39;Sleep&#39; time or switch to something like <a href=\"http://www.cpearson.com/excel/ShellAndWait.aspx\" rel=\"nofollow noreferrer\">Chip Pearson&#39;s ShellAndWait implementation</a>."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1472698316, "post_id": 39261137, "comment_id": 65859715, "body": "a bit easier with Wscript.Shell <a href=\"http://stackoverflow.com/a/32600510/1383168\">stackoverflow.com/a/32600510/1383168</a>"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1472692969, "last_edit_date": 1472692969, "creation_date": 1472691111, "answer_id": 39261137, "question_id": 39260443, "link": "https://stackoverflow.com/questions/39260443/functions-work-separately-but-not-together-returns-0-value/39261137#39261137", "title": "Functions work separately but not together, returns 0 value", "body": "<p>Given the huge number of files, I'd skip the <code>Dir</code> function entirely.  I'd also skip the manual sorting of the results by creation date (I'm assuming this is the criteria - if not, it should be fairly easy to modify).  Let the Windows Shell do the heavy lift for you.  Unlike the VBA <code>Dir()</code> function or the <code>Scripting.FileSystemObject</code>, the shell <code>dir</code> command has a ton of parameters that allow you to retrieve sorted output.  For this purpose, going through a list of files <em>sorted in reverse order</em> is much, much more efficient.  <a href=\"https://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/dir.mspx?mfr=true\" rel=\"nofollow\">You can see all of the <code>dir</code> options here</a>. </p>\n\n<p>So, I'd approach this by shelling to a <code>dir</code> command that retrieves the list of files in reverse date order, pipe it to a temp file, and then pick up the temp file to go through the list.  That way you can just exit when you find your first match. Then you can simplify both your loop and <code>ReadTextFile</code> function by using the <code>FileSystemObject</code>:</p>\n\n<p>ReadTextFile:</p>\n\n<pre><code>Public Function ReadTextFile(target As File) As String\n    With target.OpenAsTextStream\n        If Not .AtEndOfStream Then .SkipLine\n        Dim values() As String\n        If Not .AtEndOfStream Then\n            values = Split(.ReadLine, vbTab)\n            If UBound(values) &gt;= 38 Then\n                ReadTextFile = values(38)\n            End If\n        End If\n        .Close\n    End With\nEnd Function\n</code></pre>\n\n<p>ReportTimeByOP:</p>\n\n<pre><code>Function ReportTimeByOP(ByVal sName As String, ByVal sFolder As String, _\n                        ByVal sOPID As String) As Date\n    With New Scripting.FileSystemObject\n        Dim temp As String\n        temp = .BuildPath(.GetSpecialFolder(TemporaryFolder), .GetTempName)\n\n        Dim seeking As String\n        seeking = .BuildPath(sFolder, sName &amp; \"*hdr.txt\")\n        Shell \"cmd /c dir \"\"\" &amp; seeking &amp; \"\"\" /b /a:-d  /o:-d &gt; \" &amp; temp\n        'Shell is asychronous - wait .2 seconds for it to complete.\n        Sleep 200\n\n        With .GetFile(temp).OpenAsTextStream\n            Dim directory() As String\n            directory = Split(.ReadAll, vbNewLine)\n            .Close\n        End With\n        .DeleteFile temp\n\n        Dim i As Long\n        Dim value38 As String\n        Dim candidate As File\n        'Temp file will end with a newline, so the last element is empty.\n        For i = LBound(directory) To UBound(directory) - 1 \n            Set candidate = .GetFile(.BuildPath(sFolder, directory(i)))\n            value38 = ReadTextFile(candidate)\n            If Trim$(value38) = Trim$(sOPID) Then\n                ReportTimeByOP = candidate.DateCreated\n                Exit Function\n            End If\n        Next i\n    End With\nEnd Function\n</code></pre>\n\n<p>And this declaration somewhere:</p>\n\n<pre><code>Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6763299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51e94372f5136774a0c340f7ea624e4e?s=128&d=identicon&r=PG&f=1", "display_name": "Mblankfield", "link": "https://stackoverflow.com/users/6763299/mblankfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 39261137, "answer_count": 1, "score": 1, "last_activity_date": 1482942237, "creation_date": 1472685400, "last_edit_date": 1482942237, "question_id": 39260443, "link": "https://stackoverflow.com/questions/39260443/functions-work-separately-but-not-together-returns-0-value", "title": "Functions work separately but not together, returns 0 value", "body": "<p>I recently got help here with the first function but I am stumped about why my code is not working.. </p>\n\n<p>I'm trying to use the ReportTimeByOP function to find the newest file located in \"sFolder\" that begins with \"sName\" and that has a \"sOPID\" that matches the \"value38\" result of the ReadTextFile function. </p>\n\n<p>For whatever reason I have no trouble getting both functions to work independently but my attempts to combine them into one seamless operation have failed. What I currently have is:</p>\n\n<pre><code>Function ReadTextFile(fpath)\n    Dim fline   As String\n    Dim fnumb   As Long\n    Dim i       As Long\n    Dim Wanted  As String\n\n    fnumb = FreeFile\n    Open fpath For Input As #fnumb\n    i = 1\n    Do While Not EOF(fnumb)\n        Line Input #fnumb, fline\n        If i = 2 Then\n            Wanted = Split(fline, vbTab)(38)\n            Exit Do\n        End If\n        i = i + 1\n    Loop\n    Close #fnumb\n    MsgBox fpath\n    ReadTextFile = Wanted\nEnd Function\n\nFunction ReportTimeByOP(ByVal sName As String, ByVal sFolder As String, ByVal sOPID As String)\n    Dim FileName As String\n    Dim MostRecentFile As String\n    Dim MostRecentDate As Date\n    Dim value38 As String\n    Dim oFSO As FileSystemObject\n\n    If Right(sFolder, 1) &lt;&gt; \"\\\" Then sFolder = sFolder &amp; \"\\\"\n\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    If oFSO.FolderExists(sFolder) Then\n        FileName = Dir(sFolder &amp; sName &amp; \"*hdr.txt\", 0)\n        If FileName &lt;&gt; \"\" Then\n            MostRecentFile = FileName\n            MostRecentDate = FileDateTime(sFolder &amp; FileName)\n            Do While FileName &lt;&gt; \"\"\n                value38 = ReadTextFile(sFolder &amp; FileName)\n                If FileDateTime(sFolder &amp; FileName) &gt; MostRecentDate And Trim(value38) = Trim(sOPID) Then\n                     MostRecentFile = FileName\n                     MostRecentDate = FileDateTime(sFolder &amp; FileName)\n                     value38 = ReadTextFile(sFolder &amp; FileName)\n                 End If\n                 FileName = Dir\n                 DoEvents\n            Loop\n        End If\n    Else\n        MostRecentFile = \"Err: folder not found.\"\n    End If\n    Set oFSO = Nothing\n    ReportTimeByOP = MostRecentDate\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "powerpoint", "vba"], "comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1472730279, "post_id": 39260416, "comment_id": 65875616, "body": "What is your source shape? Is it a group of rectangles or a table? Are you pasting into a selection e.g. a placeholder? Could you share the file?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1472832303, "post_id": 39260416, "comment_id": 65926932, "body": "Further to Jamie&#39;s question, are you pasting onto a slide with any blank content or picture placeholders?"}, {"owner": {"reputation": 419, "user_id": 5096638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76dfe882b62aa82f12f04960f4009cf0?s=128&d=identicon&r=PG&f=1", "display_name": "PalFS", "link": "https://stackoverflow.com/users/5096638/palfs"}, "edited": false, "score": 0, "creation_date": 1474064544, "post_id": 39260416, "comment_id": 66395677, "body": "Thanks for your comments. The problem was that the range array was changed when i run the code. So, after fixing it, than shape no more truncates."}], "answers": [{"tags": [], "owner": {"reputation": 419, "user_id": 5096638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76dfe882b62aa82f12f04960f4009cf0?s=128&d=identicon&r=PG&f=1", "display_name": "PalFS", "link": "https://stackoverflow.com/users/5096638/palfs"}, "is_accepted": true, "score": 0, "last_activity_date": 1474064721, "creation_date": 1474064721, "answer_id": 39540910, "question_id": 39260416, "link": "https://stackoverflow.com/questions/39260416/shape-truncated-after-paste-special-from-excel-to-powerpoint-2013/39540910#39540910", "title": "shape truncated after paste special from excel to powerpoint 2013", "body": "<p>I fixed the problem my self when i debug the code. The problem was that the range array gets changed when i run the code. So, after fixing it, than shape no more truncates.</p>\n"}], "owner": {"reputation": 419, "user_id": 5096638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76dfe882b62aa82f12f04960f4009cf0?s=128&d=identicon&r=PG&f=1", "display_name": "PalFS", "link": "https://stackoverflow.com/users/5096638/palfs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 39540910, "answer_count": 1, "score": 0, "last_activity_date": 1474064721, "creation_date": 1472685219, "last_edit_date": 1531161705, "question_id": 39260416, "link": "https://stackoverflow.com/questions/39260416/shape-truncated-after-paste-special-from-excel-to-powerpoint-2013", "title": "shape truncated after paste special from excel to powerpoint 2013", "body": "<p>I need to copy excel data to powerpoint slides but shape get truncated after paste special.</p>\n\n<p>This is my code: </p>\n\n<pre><code>    Set myShape = mySlide.Shapes(\"obj\" &amp; i)\n    mySlide.Shapes.PasteSpecial DataType:=2\n    Set newShape = mySlide.Shapes(mySlide.Shapes.Count)\n    newShape.LockAspectRatio = msoFalse\n    newShape.Left = myShape.Left\n    newShape.Top = myShape.Top\n    newShape.Height = myShape.Height\n    newShape.Width = myShape.Width\n\n    myShape.Delete\n</code></pre>\n\n<p>I need to replace existing shapes same as their properties so I first get the shape and set its properties to new shape and then delete it.</p>\n\n<p>Before I run the code the shape is this:\n<a href=\"https://i.stack.imgur.com/gkY0V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gkY0V.png\" alt=\"Before\"></a></p>\n\n<p>After shape is this(truncated):\n<a href=\"https://i.stack.imgur.com/QY59g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QY59g.png\" alt=\"After\"></a>\nI tried other data types also but in vain. </p>\n"}, {"tags": ["vba", "arguments", "countif"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "edited": false, "score": 0, "creation_date": 1472754783, "post_id": 39260287, "comment_id": 65891857, "body": "There is an erro of &quot;unable to get countif property of the worksheetfunction class&quot; !"}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "edited": false, "score": 0, "creation_date": 1472766258, "post_id": 39260287, "comment_id": 65897068, "body": "@Zapata - Or <a href=\"http://www.mrexcel.com/forum/excel-questions/584979-runtime-error-1004-unable-get-countif-property-worksheetfunction-class-please-help.html\" rel=\"nofollow noreferrer\">this</a>. Try <code>Application.CountIfs(...</code> instead of <code>Application.WorksheetFunction.CountIfs(...</code>."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "edited": false, "score": 0, "creation_date": 1472766339, "post_id": 39260287, "comment_id": 65897111, "body": "@Zapata - Please post the complete amended code in your question."}], "tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 2, "last_activity_date": 1472684297, "creation_date": 1472684297, "answer_id": 39260287, "question_id": 39260209, "link": "https://stackoverflow.com/questions/39260209/how-to-use-countif-with-more-than-2-arguments-in-vba/39260287#39260287", "title": "How to use countif with more than 2 arguments in VBA?", "body": "<p>You have to resort to <code>Countifs</code>, with any number of conditions.</p>\n\n<p>Plus, you can consolidate the two numeric conditions into one (abs((x-(xmin+xmax)/2) &lt; (xmax-xmin)/2).</p>\n"}], "owner": {"reputation": 113, "user_id": 6096077, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50e35954f90332fd8a6d54dd38ca9c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Zapata", "link": "https://stackoverflow.com/users/6096077/zapata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1472684297, "creation_date": 1472683835, "question_id": 39260209, "link": "https://stackoverflow.com/questions/39260209/how-to-use-countif-with-more-than-2-arguments-in-vba", "title": "How to use countif with more than 2 arguments in VBA?", "body": "<p>I want to use the countif statement to calculate the number of employee (in my example) whose gender are Male and their age is between 15 to 30. I am not sure how to add another argument to the countif statement to add the restriction of gender, since it just take 2 statements.\nHere is my function code:</p>\n\n<pre><code>Function Calculate(Column_target As Integer, Row_number As Double, Level_of_response As Integer, Column_of_reference As Integer, level_of_reference As Integer) As Double\n\n    Sheets(\"A\").Select\n    Range(Cells(2, Column_target ), Cells(Row_number , Column_target )).Select\n\n    For i = 3 To Row_number + 1\n\n        If (Level_of_response = 1) Then\n        Calculate = (Application.WorksheetFunction.CountIf(Selection, \"&lt;31\") - Application.WorksheetFunction.CountIf(Selection, \"&lt;15\")) / (Row_number - 1)\n\n        End If\n</code></pre>\n\n<p>This is the code that I want to add as the 3rd argument to the countif statement. </p>\n\n<p><code>(Cells(i, Column_of_reference ) = level_of_reference )</code> ' this shows that Gender is male (or female) when level_of_reference is 1 (or 2).</p>\n"}, {"tags": ["sql-server", "vba", "ms-access", "sql-server-2008-r2", "ms-access-2013"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1472685264, "post_id": 39260050, "comment_id": 65856719, "body": "You could obviously script something in VBA using ADO, but I&#39;m curious why the wizards aren&#39;t working."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1472687412, "post_id": 39260050, "comment_id": 65857244, "body": "You might be better to start from SSMS <a href=\"https://msdn.microsoft.com/en-us/library/ms140052.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms140052.aspx</a>"}, {"owner": {"reputation": 187, "user_id": 6704853, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30712d794e8d7661be2ac6ad96fffa67?s=128&d=identicon&r=PG&f=1", "display_name": "PinkSmelly BlueSocks", "link": "https://stackoverflow.com/users/6704853/pinksmelly-bluesocks"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472688146, "post_id": 39260050, "comment_id": 65857440, "body": "@Comintern - I know how to script from SQL To Access, but not the other way.  Any links or tips on how to start the other way around?"}, {"owner": {"reputation": 187, "user_id": 6704853, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30712d794e8d7661be2ac6ad96fffa67?s=128&d=identicon&r=PG&f=1", "display_name": "PinkSmelly BlueSocks", "link": "https://stackoverflow.com/users/6704853/pinksmelly-bluesocks"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1472688440, "post_id": 39260050, "comment_id": 65857508, "body": "@Fionnuala - if I do access database engine or jet database engine it only shows .mdb.  If I change it to all files to select my accdb then the error is thrown."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 6704853, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30712d794e8d7661be2ac6ad96fffa67?s=128&d=identicon&r=PG&f=1", "display_name": "PinkSmelly BlueSocks", "link": "https://stackoverflow.com/users/6704853/pinksmelly-bluesocks"}, "edited": false, "score": 0, "creation_date": 1472691844, "post_id": 39261150, "comment_id": 65858263, "body": "The Migration Assistant was removed from Access 2013."}, {"owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "reply_to_user": {"reputation": 187, "user_id": 6704853, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30712d794e8d7661be2ac6ad96fffa67?s=128&d=identicon&r=PG&f=1", "display_name": "PinkSmelly BlueSocks", "link": "https://stackoverflow.com/users/6704853/pinksmelly-bluesocks"}, "edited": false, "score": 0, "creation_date": 1472692166, "post_id": 39261150, "comment_id": 65858326, "body": "The Migration Assistant is a separate utility and NOT part of Access. It is the upsizing wizard that was removed from Access. Follow the link that I posted."}, {"owner": {"reputation": 187, "user_id": 6704853, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30712d794e8d7661be2ac6ad96fffa67?s=128&d=identicon&r=PG&f=1", "display_name": "PinkSmelly BlueSocks", "link": "https://stackoverflow.com/users/6704853/pinksmelly-bluesocks"}, "edited": false, "score": 0, "creation_date": 1472692797, "post_id": 39261150, "comment_id": 65858458, "body": "I did, when trying to download the SQL Server Migration Assistant from that link <a href=\"http://aka.ms/ssmaforaccess\" rel=\"nofollow noreferrer\">aka.ms/ssmaforaccess</a> I just get a spinning circle."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1472710616, "post_id": 39261150, "comment_id": 65863118, "body": "It should lead you here: <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=53121\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=53121</a>"}, {"owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "edited": false, "score": 0, "creation_date": 1472725150, "post_id": 39261150, "comment_id": 65872153, "body": "A spinning circle doesn&#39;t equate to &#39;removed from Access 2013&#39;. The link I posted contains the information on SSMA and includes the same download link that Andre posted. Try the download link above or with a different browser."}], "tags": [], "owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "is_accepted": false, "score": 0, "last_activity_date": 1472691215, "creation_date": 1472691215, "answer_id": 39261150, "question_id": 39260050, "link": "https://stackoverflow.com/questions/39260050/access-2013-to-link-all-local-tables-to-sql-server/39261150#39261150", "title": "Access 2013 To Link All Local Tables To Sql Server", "body": "<p>What you need it the SQL Server Migration Assistant.\n<a href=\"https://msdn.microsoft.com/en-us/library/mt613434.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/mt613434.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n"}], "owner": {"reputation": 187, "user_id": 6704853, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/30712d794e8d7661be2ac6ad96fffa67?s=128&d=identicon&r=PG&f=1", "display_name": "PinkSmelly BlueSocks", "link": "https://stackoverflow.com/users/6704853/pinksmelly-bluesocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472691215, "creation_date": 1472682919, "last_edit_date": 1472688589, "question_id": 39260050, "link": "https://stackoverflow.com/questions/39260050/access-2013-to-link-all-local-tables-to-sql-server", "title": "Access 2013 To Link All Local Tables To Sql Server", "body": "<p>I have roughly 75 local tables in an Access 2013 database, that I need to get into SQL Server 2008 R2.  The export wizard or upsize wizard does not work for me, the only process I have found that works is to export the table to .csv then import the .csv into SQL Server.  I also do it this way so that I do not have to set-up a DSN on my computer.  I would rather not do that will all 75 tables, so I was wondering if there was a VBA way of Exporting Local Access 2013 tables To SQL Server with no DSN set-up?</p>\n\n<p><br><br>\n<strong>EDIT</strong><br>\n1) And there is no linked server between my server and access (I am not a sys admin to add) so using the Openrowset is not an option</p>\n\n<p>2) I have the Access 2007 Database Engine installed on my system already.</p>\n"}, {"tags": ["vba", "excel", "hyperlink", "reference"], "answers": [{"comments": [{"owner": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472684224, "post_id": 39260028, "comment_id": 65856439, "body": "I tried this and was confronted with the error: the name that you entered is not valid reasons for this could include: ..."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472684495, "post_id": 39260028, "comment_id": 65856516, "body": "@TylerDickson - You need to use the actual document, sheet, and cell names.  As YowE3K points out, the sheet name will be the file name for a CSV."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1472684615, "last_edit_date": 1472684615, "creation_date": 1472682784, "answer_id": 39260028, "question_id": 39259879, "link": "https://stackoverflow.com/questions/39259879/create-hyperlink-to-cell-in-another-workbook-csv-vba/39260028#39260028", "title": "Create Hyperlink to Cell in Another Workbook/CSV VBA", "body": "<p>If the link is in another workbook and you want Excel to open it if it isn't already open, you need to specify both the address and the sub-address (kind of like an anchor in an HTML link):</p>\n\n<pre><code>SelRangeA(iRow, 2) = \"=HYPERLINK(\"\"C:\\Foo.xlsx#[C:\\Foo.xlsx]Sheet1!A1\"\")\"\n</code></pre>\n\n<p>EDIT: Note that for a <code>.csv</code> file, the worksheet name will default to the file name on open:</p>\n\n<pre><code>SelRangeA(iRow, 2) = \"=HYPERLINK(\"\"C:\\Foo.csv#[C:\\Foo.csv]Foo!A1\"\")\"\n                                                         '^^^   \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472684563, "post_id": 39260086, "comment_id": 65856538, "body": "This would work, but the Workbook2 is going to be changing to a new file alot so I don&#39;t think I&#39;ll be able to keep the Name Manager consistent"}], "tags": [], "owner": {"reputation": 1096, "user_id": 3160610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XUIaj.jpg?s=128&g=1", "display_name": "Andrew L", "link": "https://stackoverflow.com/users/3160610/andrew-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1472683128, "creation_date": 1472683128, "answer_id": 39260086, "question_id": 39259879, "link": "https://stackoverflow.com/questions/39259879/create-hyperlink-to-cell-in-another-workbook-csv-vba/39260086#39260086", "title": "Create Hyperlink to Cell in Another Workbook/CSV VBA", "body": "<p>One way to do this is to define a name (Formulas->Name Manager) whenever certain cells get changed. For example if the name was defined as \"changedcell\" you would set the hyperlink as follows:</p>\n\n<p>=HYPERLINK(\"[C:..\\WorkbookB.csv#changedcell]\",\"CLICK HERE\")</p>\n\n<p>Just make sure the scope of the name is set to full workbook if there are multiple worksheets.</p>\n"}, {"comments": [{"owner": {"reputation": 1096, "user_id": 3160610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XUIaj.jpg?s=128&g=1", "display_name": "Andrew L", "link": "https://stackoverflow.com/users/3160610/andrew-l"}, "edited": false, "score": 0, "creation_date": 1472683701, "post_id": 39260140, "comment_id": 65856284, "body": "Nice catch, missed the csv detail"}, {"owner": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1472684051, "post_id": 39260140, "comment_id": 65856382, "body": "I&#39;ll just use this Answer to reply to both you and @cyboashu :P . This makes sense as when I looked at the csv file once it was opened - the first sheet name was WorkbookB (in this example). However it&#39;s still throwing the Reference is not valid. error :/ Any other thoughts?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472687799, "post_id": 39260140, "comment_id": 65857338, "body": "@TylerDickson - The statement <code>=HYPERLINK(&quot;[L:\\xyz\\Temp\\Temp1.csv]&#39;Temp1&#39;!B4&quot;)</code> works for me.  I assume your <code>..</code> is just hiding the actual path you are using, and is not an attempt to access the parent directory of the current directory.  Are you getting the error when the file is <b>actually</b> WorkbookB.csv, or are you doing your testing with another (real) file?  (I included the <code>&#39;</code> marks around the sheet name to avoid problems with spaces in the name but, if your workbook name contains some other weird character, it may not be the name that Excel uses for the sheetname.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472688105, "post_id": 39260140, "comment_id": 65857428, "body": "@TylerDickson - e.g. A filename of &quot;Temp1[1]Copy.csv&quot; will be loaded into Excel with a sheetname of &quot;Temp1(1)Copy&quot;, because the &quot;[&quot; and &quot;]&quot; are not valid characters in sheet names."}, {"owner": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472744199, "post_id": 39260140, "comment_id": 65886016, "body": "After ALOT of troubleshooting, I managed to get the file to open when I changed the internal Sheet name to Sheet1. I find it odd that there is no way to default to the first Sheet when referencing another document - but I guess this solution is manageable. My final code snippet ended up looking like this: <code>=HYPERLINK(&quot;[WorkbookB.csv]Sheet1!B4&quot;,&quot;CLICK HERE&quot;)</code>. Thanks for the feedback!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472747193, "post_id": 39260140, "comment_id": 65887786, "body": "@TylerDickson - I&#39;m glad it&#39;s working for you, but I must admit that I can&#39;t understand how you changed a CSV file to have a &quot;sheet&quot; name that wasn&#39;t the file name.  A .csv file (assuming it is just a comma-separated value text file and not, for instance, an Excel spreadsheet saved with a non-standard file extension) just contains text, with no way of storing any meta-data such as a sheetname.  So, although you could change the sheetname while it is open, once you close the file and open it again the sheetname will revert to the normal one."}, {"owner": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472747824, "post_id": 39260140, "comment_id": 65888130, "body": "@YowE3K - Yea I think a majority of the issues on my end were just that - on my end. We receive these csv&#39;s from another company and I&#39;m thinking that they are just saving .xls files as .csv (which makes life more difficult on our end). Now that you mention it, the data they send us already looks formatted in Excel when the csv is opened, so I probably should&#39;ve clued in earlier. But even when I changed this file to a .xls format, I was still running into errors until I changed the sheet name to Sheet1. Would you happen to know a way to select the first Sheet without specifying a name?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 1, "creation_date": 1472748132, "post_id": 39260140, "comment_id": 65888290, "body": "@TylerDickson - As far as I know, you can&#39;t do that with just a HYPERLINK function.  (If using VBA you could open each of the workbooks that you were linking to, determine which was the first [only] sheet name, then modify the hyperlinks - but I can&#39;t see how that would be the most practical solution to any real-world problem.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472748537, "post_id": 39260140, "comment_id": 65888513, "body": "@TylerDickson - just using <code>=HYPERLINK(&quot;C:\\..\\WorkbookB.csv&quot;,&quot;CLICK HERE&quot;)</code> would work, but only open up to the first cell in the sheet, not to a specific cell.  (But the fact that yours isn&#39;t a real CSV file may mean it might have the same issue as you currently have.)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1472683428, "creation_date": 1472683428, "answer_id": 39260140, "question_id": 39259879, "link": "https://stackoverflow.com/questions/39259879/create-hyperlink-to-cell-in-another-workbook-csv-vba/39260140#39260140", "title": "Create Hyperlink to Cell in Another Workbook/CSV VBA", "body": "<p>A CSV file won't contain a \"Sheet1\".  The \"sheet\" name is derived from the name of the file.</p>\n\n<p>So your code needs to be:</p>\n\n<pre><code>=HYPERLINK(\"[C:\\..\\WorkbookB.csv]'\" &amp; filename &amp; \"'!B4\",\"CLICK HERE\")\n</code></pre>\n\n<p>where <code>filename</code> has been set to the base part of the CSV file's filename (i.e. it needs to equate to \"WorkbookB\" in your example).</p>\n"}], "owner": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1414, "favorite_count": 0, "accepted_answer_id": 39260140, "answer_count": 3, "score": 1, "last_activity_date": 1472743095, "creation_date": 1472682068, "last_edit_date": 1472743095, "question_id": 39259879, "link": "https://stackoverflow.com/questions/39259879/create-hyperlink-to-cell-in-another-workbook-csv-vba", "title": "Create Hyperlink to Cell in Another Workbook/CSV VBA", "body": "<p>I'm currently working on a script in WorkbookA that notifies of a change in another Workbook (WorkbookB). I would like to add the functionality of being taken to that Workbook if the user would like to see the change. Currently, I'm running the code:</p>\n\n<pre><code>SelRangeA(iRow, 2) = \"=HYPERLINK(\"\"[C:\\..\\WorkbookB.csv]Sheet1!B4\"\",\"\"CLICK HERE\"\")\"\n</code></pre>\n\n<p>Which displays the proper Hyperlink in the spreadsheet : <code>Click Here</code> with contents:</p>\n\n<pre><code>=HYPERLINK(\"[C:\\..\\WorkbookB.csv]Sheet1!B4\",\"CLICK HERE\")\n</code></pre>\n\n<p>However when I follow the link, it opens the requested Workbook with an error: </p>\n\n<blockquote>\n  <p>Reference is not valid.</p>\n</blockquote>\n\n<p>Any insight on how to properly reference the required cell? Thanks!</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "autofilter"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1472682680, "post_id": 39259641, "comment_id": 65855968, "body": "As far as I know you&#39;ll have to take the VBA route to visualize this information. Depending on the filters the solution to your post might even get a bit complex. It might be easy if the filter is just a simple list of selected items. But what about date filters such as <code>between 01&#47;01&#47;2000 and 12&#47;31&#47;2000</code>? Do you want to list (in this case) all the dates or do you expect to see this range? What about text filters such as <code>Den*</code>? In this case there might be once again a list such as <code>Denver</code>, <code>Denton</code>, <code>Denison</code>, etc. Do you want the list or do you expect <code>all cities starting with Den</code>?"}, {"owner": {"reputation": 1045, "user_id": 3831575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Loiro.jpg?s=128&g=1", "display_name": "Daniel Fletcher", "link": "https://stackoverflow.com/users/3831575/daniel-fletcher"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1472837688, "post_id": 39259641, "comment_id": 65929736, "body": "@Ralph The idea is simply to list which headers are actively filtered.  I hope this addresses your questions."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1472838793, "post_id": 39259641, "comment_id": 65930323, "body": "Well, then I guess <a href=\"http://stackoverflow.com/a/39260315/1153513\">my answer</a> addresses your post correctly. Just copy the code into an empty module and then use the new formula in any cell of your Excel file <code>=FilterCrit()</code>."}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 3, "last_activity_date": 1472684483, "creation_date": 1472684483, "answer_id": 39260309, "question_id": 39259641, "link": "https://stackoverflow.com/questions/39259641/is-there-a-way-to-see-which-filters-are-active-in-excel-other-than-just-the-fun/39260309#39260309", "title": "Is there a way to see which filters are active in Excel, other than just the funnel icons?", "body": "<p>This will work to highlight columns which contain active filter. This code just Bolds and sets the font color Red, but you can modify the style changes as per your need.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tJb4j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tJb4j.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub test()\n    Call markFilter(ActiveSheet)\nEnd Sub\n\n\nSub markFilter(wks As Worksheet)\n\n    Dim lFilCol As Long\n\n    With wks\n        If .AutoFilterMode Then\n            For lFilCol = 1 To .AutoFilter.Filters.Count\n\n                '/ If filter is applied then mark the header as bold and font color as red\n                If .AutoFilter.Filters(lFilCol).On Then\n                    .AutoFilter.Range.Columns(lFilCol).Cells(1, 1).Font.Color = vbRed\n                    .AutoFilter.Range.Columns(lFilCol).Cells(1, 1).Font.Bold = True\n                Else\n                     '/ No Filter. Column header font normal and black.\n                    .AutoFilter.Range.Columns(lFilCol).Cells(1, 1).Font.Color = vbBlack\n                    .AutoFilter.Range.Columns(lFilCol).Cells(1, 1).Font.Bold = False\n                End If\n            Next\n        Else\n            '/ No Filter at all. Column header font normal and black.\n            .UsedRange.Rows(1).Font.Color = vbBlack\n            .UsedRange.Rows(1).Font.Bold = False\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1045, "user_id": 3831575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Loiro.jpg?s=128&g=1", "display_name": "Daniel Fletcher", "link": "https://stackoverflow.com/users/3831575/daniel-fletcher"}, "edited": false, "score": 0, "creation_date": 1472686524, "post_id": 39260315, "comment_id": 65857041, "body": "@Ralph Does this function refresh automatically, or does it need to be executed manually?  (I&#39;m unsure if the automation is something that needs to be coded or if I&#39;m missing something).  Thanks for sharing, by the way."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1045, "user_id": 3831575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Loiro.jpg?s=128&g=1", "display_name": "Daniel Fletcher", "link": "https://stackoverflow.com/users/3831575/daniel-fletcher"}, "edited": false, "score": 0, "creation_date": 1472722164, "post_id": 39260315, "comment_id": 65870121, "body": "@DanielFletcher I just updated the solution to address your question. Let me know if you have any further questions."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472722990, "post_id": 39260315, "comment_id": 65870721, "body": "@Comintern Thanks for the note. I updated the answer."}, {"owner": {"reputation": 1045, "user_id": 3831575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Loiro.jpg?s=128&g=1", "display_name": "Daniel Fletcher", "link": "https://stackoverflow.com/users/3831575/daniel-fletcher"}, "edited": false, "score": 0, "creation_date": 1475708134, "post_id": 39260315, "comment_id": 67056632, "body": "Sorry for the delayed-by-a-month reply.  I <i>really</i> like the auto-calculation with <code>Application.Volatile</code>.  Any idea, in quantitative or more specific terms, how much it slows down an xls?  Thanks."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1045, "user_id": 3831575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Loiro.jpg?s=128&g=1", "display_name": "Daniel Fletcher", "link": "https://stackoverflow.com/users/3831575/daniel-fletcher"}, "edited": false, "score": 0, "creation_date": 1475721020, "post_id": 39260315, "comment_id": 67059628, "body": "@DanielFletcher That&#39;s a new question and much too complex to answer in a comment (or include it in the above answer). Post a new question and you shall see. If you believe that there is any relevance to this post / question then you can link it. But (if I am not completely mistaken then) the above code bears no real relevance to this new answer. The above UDF sample code might merely serve as an approximate guesstimate. I shall look forward to this new post and will try to do my best to come up with a fair answer. Yet, I believe that others might know better than me."}, {"owner": {"reputation": 109, "user_id": 12458881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7f40e4367905313682d188660905526?s=128&d=identicon&r=PG&f=1", "display_name": "L. Ouellet", "link": "https://stackoverflow.com/users/12458881/l-ouellet"}, "edited": false, "score": 0, "creation_date": 1584121109, "post_id": 39260315, "comment_id": 107349078, "body": "How can one apply the found filter to an identical table on a different sheet?"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 5, "last_activity_date": 1472722935, "last_edit_date": 1495540110, "creation_date": 1472684537, "answer_id": 39260315, "question_id": 39259641, "link": "https://stackoverflow.com/questions/39259641/is-there-a-way-to-see-which-filters-are-active-in-excel-other-than-just-the-fun/39260315#39260315", "title": "Is there a way to see which filters are active in Excel, other than just the funnel icons?", "body": "<p>If you merely want a simple list of the columns where a filter is applied then the following VBA code may suffice:</p>\n\n<pre><code>Option Explicit\n\nFunction FilterCrit() As String\n\nDim i As Long\nDim ws As Worksheet\nDim Filter As String\n\n'Application.Volatile\n\nSet ws = ThisWorkbook.Worksheets(1)\n\nIf Not ws.FilterMode Then\n    FilterCrit = \"not filtered\"\n    Exit Function\nEnd If\nFor i = 1 To ws.AutoFilter.Filters.Count\n    If ws.AutoFilter.Filters(i).On Then\n        FilterCrit = FilterCrit &amp; \"Filter on column \" &amp; i &amp; Chr(10)\n    End If\nNext i\n\nEnd Function\n</code></pre>\n\n<p>This will iterate the columns and if a filter is applied on any of these columns then it will be listed.</p>\n\n<p>By default all UDFs <a href=\"https://support.office.com/en-us/article/Create-Custom-Functions-in-Excel-2007-2f06c10b-3622-40d6-a1b2-b6748ae8231f\" rel=\"nofollow noreferrer\">user defined functions</a> are not volatile and therefore do not automatically recalculate. Yet, you can force them to automatically recalculate with <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195441.aspx\" rel=\"nofollow noreferrer\">Application.Volatile</a>. But it is highly recommend not to use this option as it can severely slow down your Excel file. Alternative solutions are recommended here: <a href=\"https://stackoverflow.com/questions/25145698/alternative-to-application-volatile-to-auto-update-udf\">Alternative to Application.Volatile to auto update UDF</a></p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1472708543, "last_edit_date": 1472708543, "creation_date": 1472687093, "answer_id": 39260652, "question_id": 39259641, "link": "https://stackoverflow.com/questions/39259641/is-there-a-way-to-see-which-filters-are-active-in-excel-other-than-just-the-fun/39260652#39260652", "title": "Is there a way to see which filters are active in Excel, other than just the funnel icons?", "body": "<p>Example</p>\n\n<pre><code>Sub Active_Filter()\n    Dim Sht As Worksheet\n    Dim lngCount As Long\n    Dim i As Long\n\n    Set Sht = ActiveSheet\n\n    If Sht.FilterMode Then\n        lngCount = Sht.AutoFilter.Filters.Count\n\n'       // Go through each column look for active Filter\n        For i = 1 To lngCount Step 1\n            If Sht.AutoFilter.Filters(i).On Then\n                Debug.Print \"Filter is set on \" &amp; Sht.Columns(i).Address\n            End If\n        Next i\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1045, "user_id": 3831575, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Loiro.jpg?s=128&g=1", "display_name": "Daniel Fletcher", "link": "https://stackoverflow.com/users/3831575/daniel-fletcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9618, "favorite_count": 2, "accepted_answer_id": 39260315, "answer_count": 3, "score": 8, "last_activity_date": 1472722935, "creation_date": 1472680709, "last_edit_date": 1472687044, "question_id": 39259641, "link": "https://stackoverflow.com/questions/39259641/is-there-a-way-to-see-which-filters-are-active-in-excel-other-than-just-the-fun", "title": "Is there a way to see which filters are active in Excel, other than just the funnel icons?", "body": "<p>This question is actually for the Excel GUI, rather than Excel \"programming\", per se.  However, if this is unavailable in the GUI, I would be curious if there's a VBA solution (although, I have basically 0 VBA knowledge/experience).</p>\n\n<p><strong>Is there a way to see which filters are active in Excel, other than just by looking at the funnel icons?</strong>  As shown in my attached screenshot, some spreadsheets can have columns that extend off the visible screen, so it can be easy to miss the funnel icon indicating an active filter.  (Additionally, I think it can be pretty easy to overlook the icon, even amidst only a few columns.)</p>\n\n<p><a href=\"https://i.stack.imgur.com/28pWU.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/28pWU.png\" alt=\"Example of columns going off the screen\"></a></p>\n\n<p>Ideally, there would be some kind of <em>list</em> showing which columns/headers are actively filtered.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["string", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6245473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e0f7d28ad976a7c2df3f001a3de92dab?s=128&d=identicon&r=PG&f=1", "display_name": "HTMLHelpMe", "link": "https://stackoverflow.com/users/6245473/htmlhelpme"}, "edited": false, "score": 0, "creation_date": 1472741424, "post_id": 39259802, "comment_id": 65884097, "body": "Getting &quot;Compile error: Variable not defined&quot; at arrNames.  I think I need a &quot;Dim arrNames as String&quot; or something (but that&#39;s not working)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 41, "user_id": 6245473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e0f7d28ad976a7c2df3f001a3de92dab?s=128&d=identicon&r=PG&f=1", "display_name": "HTMLHelpMe", "link": "https://stackoverflow.com/users/6245473/htmlhelpme"}, "edited": false, "score": 0, "creation_date": 1472741616, "post_id": 39259802, "comment_id": 65884231, "body": "arrNames is declared above - not sure why you&#39;d be getting that error"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1472747153, "last_edit_date": 1472747153, "creation_date": 1472681627, "answer_id": 39259802, "question_id": 39259479, "link": "https://stackoverflow.com/questions/39259479/how-to-save-workbook-with-a-worksheet-titled-x-y-or-z-etc-to-a-subfolde/39259802#39259802", "title": "How to save workbook with a worksheet titled &quot;X, Y, or Z...&quot;, etc. to a subfolder? Multiple variable strings?", "body": "<pre><code>Sub CheckWorksheetNames()\n\n    Dim sName, arrNames  '&lt;&lt;EDIT: removed \"As String\" from sName\n    Dim sFound As Boolean\n    Dim strPath As String\n\n    strPath = ThisWorkbook.Path &amp; \"\\Folder\\Food\\\" &amp; ActiveWorkbook.Name\n\n    arrNames = Array(\"Orange\",\"Apple\",\"Broccoli\",\"Cheese\")\n\n    For Each sName in arrNames\n        If SheetExists(sName, ActiveWorkbook) Then\n            strPath = ThisWorkbook.Path &amp; \"\\Folder\\\" &amp; sName &amp; \"\\\" &amp; _\n                      ActiveWorkbook.Name\n            ActiveWorkbook.SaveAs Filename:=strPath\n        End If\n    Next\n\nEnd Sub\n\nFunction SheetExists(shtName As String, Optional wb As Workbook) As Boolean\n     Dim sht As Worksheet\n\n     If wb Is Nothing Then Set wb = ThisWorkbook\n     On Error Resume Next\n     Set sht = wb.Sheets(shtName)\n     On Error GoTo 0\n     SheetExists = Not sht Is Nothing\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1472683177, "creation_date": 1472683177, "answer_id": 39260093, "question_id": 39259479, "link": "https://stackoverflow.com/questions/39259479/how-to-save-workbook-with-a-worksheet-titled-x-y-or-z-etc-to-a-subfolde/39260093#39260093", "title": "How to save workbook with a worksheet titled &quot;X, Y, or Z...&quot;, etc. to a subfolder? Multiple variable strings?", "body": "<p>You can loop trough all sheets and check if any of them match:</p>\n\n<pre><code>For Each s in Sheets\n  If s.Name = \"Orange\" Or s.Name = \"Apple\" Or s.Name = \"Broccoli\" Or s.Name = \"Cheese\" Then\n    ActiveWorkbook.SaveAs strPath\n    Exit For\n  End If\nNext\n</code></pre>\n\n<p>or </p>\n\n<pre><code>For Each s in Sheets\n    Select Case s.Name\n        Case \"Orange\", \"Apple\", \"Broccoli\", \"Cheese\"\n            ActiveWorkbook.SaveAs strPath\n            Exit For\n    End Select \nNext\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6245473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e0f7d28ad976a7c2df3f001a3de92dab?s=128&d=identicon&r=PG&f=1", "display_name": "HTMLHelpMe", "link": "https://stackoverflow.com/users/6245473/htmlhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472747153, "creation_date": 1472679825, "question_id": 39259479, "link": "https://stackoverflow.com/questions/39259479/how-to-save-workbook-with-a-worksheet-titled-x-y-or-z-etc-to-a-subfolde", "title": "How to save workbook with a worksheet titled &quot;X, Y, or Z...&quot;, etc. to a subfolder? Multiple variable strings?", "body": "<p>This is a VBA code to save an Excel workbook in a \"Food\" folder in the workbook's directory if it has a worksheet named \"Orange, Apple...\"  Right now it only works if I put one food in the code.  I.e.,:</p>\n\n<pre><code>sName = \"Orange\"\n</code></pre>\n\n<p>Here is the full code:</p>\n\n<pre><code>Sub CheckWorksheetNames()\n\nDim sName As String\nDim sFound As Boolean\nDim strPath As String\n\nstrPath = ThisWorkbook.Path &amp; \"\\Folder\\Food\\\" &amp; ActiveWorkbook.Name\n\nsName = \"Orange\" Or \"Apple\" Or \"Broccoli\" Or \"Cheese\"\n\nIf sName = \"\" Then Exit Sub\nsFound = False\n\nOn Error Resume Next\n    ActiveWorkbook.Sheets(sName).Select\n    If Err = 0 Then sFound = True\nOn Error GoTo 0\n\nIf sFound = True Then\nActiveWorkbook.SaveAs Filename:=strPath\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>How do I get it to go through multiple variables?  I.e., if the workbook has worksheets named \"Orange, Apple, Broccoli...\", etc.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472679255, "post_id": 39259220, "comment_id": 65854721, "body": "I realise that your example is (almost certainly) just an example, but if the two &quot;Dd&quot; values were switched would you want &quot;A;number&quot; to be the value kept with &quot;A number&quot; being removed?"}, {"owner": {"reputation": 1287, "user_id": 6680564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a81746e90e80e3243ac8fce0c2943068?s=128&d=identicon&r=PG&f=1", "display_name": "Rita", "link": "https://stackoverflow.com/users/6680564/rita"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472679547, "post_id": 39259220, "comment_id": 65854853, "body": "@YowE3K It will be OK. The purpose of this VBA programm is to delete some duplicates with similarities. It will be OK if I have to change the values manually afterwards."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 2, "last_activity_date": 1472680253, "creation_date": 1472680253, "answer_id": 39259553, "question_id": 39259220, "link": "https://stackoverflow.com/questions/39259220/excel-vba-find-cells-with-similar-values/39259553#39259553", "title": "Excel VBA: Find cells with similar values", "body": "<p>I've run into this previous in my work, when I want to guarantee the \"equivalence\" of certain string. So my technique is to \"normalize\" the strings by focusing on the important content of the string. </p>\n\n<p>In most of my cases, this means:</p>\n\n<ul>\n<li>stripping all whitespace (usually not important anyway)</li>\n<li>converting everything to lowercase (case is often not important to me)</li>\n<li>sometimes ignoring certain special characters</li>\n</ul>\n\n<p>So I have a utility function called <code>NormalizeString</code> that performs these actions.</p>\n\n<p>Your code then becomes:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub DeleteSimilars()\n    Dim thisSH As Worksheet\n    Dim lastRow As Long\n    Set thisSH = ActiveSheet\n    lastRow = thisSH.UsedRange.Rows.Count\n\n    Dim i As Long\n    For i = lastRow To 2 Step -1\n        If thisSH.Cells(i, 1) = thisSH.Cells(i - 1, 1) Then\n            If NormalizeString(thisSH.Cells(i, 2), \";\") = _\n               NormalizeString(thisSH.Cells(i - 1, 2), \";\") Then\n                thisSH.Cells(i, 1) = vbNullString\n                thisSH.Cells(i, 2) = vbNullString\n            End If\n        End If\n    Next i\nEnd Sub\n\nFunction NormalizeString(ByVal inputStr As String, _\n                         Optional ByVal specialChars As String) As String\n    '--- \"normalizes\" a string by a series of modifications, such as\n    '      -- removes all whitespace\n    '      -- converts all characters to lowercase\n    '      -- removes other \"special\" characters that should not\n    '         be considered part of the string\n    Dim returnString As String\n    returnString = Replace(inputStr, \" \", \"\", , , vbTextCompare)\n    returnString = LCase(returnString)\n    If Not IsMissing(specialChars) Then\n        Dim i As Integer\n        For i = 1 To Len(specialChars)\n            returnString = Replace(returnString, _\n                                   Mid(specialChars, i, 1), \"\", , , vbTextCompare)\n        Next i\n    End If\n    NormalizeString = returnString\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1287, "user_id": 6680564, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a81746e90e80e3243ac8fce0c2943068?s=128&d=identicon&r=PG&f=1", "display_name": "Rita", "link": "https://stackoverflow.com/users/6680564/rita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 0, "accepted_answer_id": 39259553, "answer_count": 1, "score": 1, "last_activity_date": 1472680253, "creation_date": 1472678596, "last_edit_date": 1531164843, "question_id": 39259220, "link": "https://stackoverflow.com/questions/39259220/excel-vba-find-cells-with-similar-values", "title": "Excel VBA: Find cells with similar values", "body": "<p>Another difficult task for me...</p>\n\n<p>I have a excel sheet like this...</p>\n\n<p><a href=\"https://i.stack.imgur.com/ttH9g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ttH9g.png\" alt=\"enter image description here\"></a> </p>\n\n<p>In the first column there are two <code>Aa</code>s, their values are shown in the second column, which is <code>A string</code> and <code>Astring</code>.</p>\n\n<p><code>A string</code> and <code>Astring</code> differ <strong>only</strong> from one blank key. I want to use excel VBA to say, these two values are equal, as long as they are same in the first column, but differ only from one letter in the second column. One of them should be deleted then. [shown in the \"target\" part]</p>\n\n<p>Similarly, there are two <code>Dd</code>s, their values differ <strong>only</strong> from a <code>;</code>. </p>\n\n<p>Here I wrote some code, but I dont know how to do the <code>if algorithmus</code>. </p>\n\n<pre><code>Sub deletesimilars()\n\n    Dim lr As Long\n\n    lr = ActiveSheet.UsedRange.Rows.Count\n\n    For i = lr To 1 Step -1  'reverse loop\n       If Cells(i, 1) = Cells(i - 1, 1) Then\n'           if cells(i,2) ??? cells(i-1,2) then     ' I stuck here\n                Cells(i, 1) = \"\"\n                Cells(i, 2) = \"\"\n            End If\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>Thanks!!!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4573, "user_id": 5718868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lMKOf.png?s=128&g=1", "display_name": "jonathana", "link": "https://stackoverflow.com/users/5718868/jonathana"}, "edited": false, "score": 1, "creation_date": 1472675278, "post_id": 39258346, "comment_id": 65852916, "body": "welcome to stackoverflow. please read how to ask a question: <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6780489, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e24c37e79f37746cd8d93db322b63037?s=128&d=identicon&r=PG&f=1", "display_name": "ali", "link": "https://stackoverflow.com/users/6780489/ali"}, "edited": false, "score": 0, "creation_date": 1473130438, "post_id": 39258741, "comment_id": 66010978, "body": "Thank you but I couldn&#39;t solve my problem.This code is working: Sub test()    Dim a(40) As Integer    a(1) = &quot;1&quot;    a(2) = &quot;2&quot;    a(3) = &quot;3&quot;    DoCmd.OpenForm &quot;FR_Certificate&quot;, acViewLayout   With Forms![FR_Certificate]   .txta1.Value = a(1)   .txta2.Value = a(2)   .txta3.Value = a(3)   End With   End Sub  but when I change  .txta1.Value = a(1) .txta2.Value = a(2) .txta3.Value = a(3)  with   For i = 1 To 3 Me.Controls(.&quot;txta&quot; &amp; i.value) = a(i) Next i  I got syntax error."}, {"owner": {"reputation": 31, "user_id": 6780489, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e24c37e79f37746cd8d93db322b63037?s=128&d=identicon&r=PG&f=1", "display_name": "ali", "link": "https://stackoverflow.com/users/6780489/ali"}, "edited": false, "score": 0, "creation_date": 1497125514, "post_id": 39258741, "comment_id": 75950451, "body": "Thank you very much.  How can I write       textBox1.Text in C# using variable i instead of number 1?"}], "tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": false, "score": 3, "last_activity_date": 1472676478, "creation_date": 1472676478, "answer_id": 39258741, "question_id": 39258346, "link": "https://stackoverflow.com/questions/39258346/how-to-make-variable-for-using-for-loop/39258741#39258741", "title": "How to make variable for using For Loop", "body": "<p>try this</p>\n\n<pre><code>for i=1 to n\nme.controls(\"txta\" &amp; i)=a(i)\nnext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1473149680, "post_id": 39339999, "comment_id": 66017970, "body": "You have modified the code of @h2so4 to something without meaning."}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1473182251, "post_id": 39339999, "comment_id": 66038922, "body": "@ali if you want to use the dot . to refer to .txt1,.txt2,.txt3 use the following syntax  .controls(&quot;txt&quot; &amp; i)=a(i) (ie remove the me in the instruction)"}, {"owner": {"reputation": 31, "user_id": 6780489, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e24c37e79f37746cd8d93db322b63037?s=128&d=identicon&r=PG&f=1", "display_name": "ali", "link": "https://stackoverflow.com/users/6780489/ali"}, "edited": false, "score": 0, "creation_date": 1473205406, "post_id": 39339999, "comment_id": 66048311, "body": ".Controls(&quot;txta&quot; &amp; i).Value = a(i)   Works. Thank you very much h2so4."}], "tags": [], "owner": {"reputation": 31, "user_id": 6780489, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e24c37e79f37746cd8d93db322b63037?s=128&d=identicon&r=PG&f=1", "display_name": "ali", "link": "https://stackoverflow.com/users/6780489/ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1473130794, "creation_date": 1473130794, "answer_id": 39339999, "question_id": 39258346, "link": "https://stackoverflow.com/questions/39258346/how-to-make-variable-for-using-for-loop/39339999#39339999", "title": "How to make variable for using For Loop", "body": "<pre><code>Thank you but I couldn't solve my problem.This code is working:\nSub test()\n Dim a(40) As Integer\n a(1) = \"1\"\n a(2) = \"2\"\n a(3) = \"3\"\n DoCmd.OpenForm \"FR_Certificate\", acViewLayout\nWith Forms![FR_Certificate]\n.txta1.Value = a(1)\n.txta2.Value = a(2)\n.txta3.Value = a(3)\nEnd With\nEnd Sub\n\nbut when I change \n.txta1.Value = a(1)\n.txta2.Value = a(2)\n.txta3.Value = a(3)\n\nwith \n\nFor i = 1 To 3\nMe.Controls(.\"txta\" &amp; i.value) = a(i)\nNext i\n\nI got synntax error.\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6780489, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e24c37e79f37746cd8d93db322b63037?s=128&d=identicon&r=PG&f=1", "display_name": "ali", "link": "https://stackoverflow.com/users/6780489/ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1473130794, "creation_date": 1472674764, "last_edit_date": 1472699901, "question_id": 39258346, "link": "https://stackoverflow.com/questions/39258346/how-to-make-variable-for-using-for-loop", "title": "How to make variable for using For Loop", "body": "<p>How can I put textboxes in a for loop in VBA Access?</p>\n\n<pre><code>txta1=a(1)\ntxta2=a(2)\ntxta3=a(3)\n</code></pre>\n\n<p>We had in FoxPro:</p>\n\n<pre><code>txta&amp;i =a(i)\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 276, "user_id": 4885960, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/478d641800a96aa96167f35401a7e7aa?s=128&d=identicon&r=PG&f=1", "display_name": "NuWin", "link": "https://stackoverflow.com/users/4885960/nuwin"}, "edited": false, "score": 0, "creation_date": 1472676542, "post_id": 39258301, "comment_id": 65853505, "body": "Not too familiar with word-vba however why use Split? Wouldn&#39;t something like this work better.. Array(&quot;is, &quot;are&quot;) and use the Instr Function or Like to find if the word contains anything in the array."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1472677605, "post_id": 39258301, "comment_id": 65854019, "body": "So are you running the macro from an Excel workbook to operate on a Word document, or from a Word document that pulls keywords (and possibly other configuration info) from an Excel workbook?"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 1, "creation_date": 1472680690, "post_id": 39258301, "comment_id": 65855264, "body": "Though I&#39;m a little unclear on what you&#39;re trying to achieve, maybe this helps. You can have a word list in Excel, say in A1:A10. Then declare and array of variants: <code>Dim WordList() as Variant</code>. After that fill the array from an Excel Range: <code>WordList = Range(&quot;A1:A10&quot;)</code>. Note that this creates a 2-D array, so you access elements from column 1: <code>WordList(n,1)</code>. This reads directly from a Range to an Array; no need for Split."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472682129, "post_id": 39258301, "comment_id": 65855793, "body": "I&#39;m not sure I see the benefit in maintaining the list in Excel rather than, say in a <code>Const</code> like <code>Const SEARCH_WORDS = &quot; is , are &quot;</code> and then just using <code>Split</code> on that:  <code>WordList = Split(SEARCH_WORDS, &quot;,&quot;)</code>.  Using a separate file seems like it would be even more of a maintenance issue."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1472709960, "creation_date": 1472709960, "answer_id": 39263788, "question_id": 39258301, "link": "https://stackoverflow.com/questions/39258301/using-find-in-word-from-a-list-in-excel-vba/39263788#39263788", "title": "Using Find in Word from a List in Excel VBA", "body": "<p>Here are three ways to retrieve an array of words from an external file (Word, Excel, and Text Files) in MS Word.  Reading from the text file is by far the fastest.</p>\n\n<p>Results </p>\n\n<ul>\n<li>Word:  0.328125 Seconds</li>\n<li>Excel: 1.359130859375 Seconds</li>\n<li>Text:  0.008056640625 Seconds</li>\n</ul>\n\n<hr>\n\n<pre><code>----------    ----------\nGet Word List from Word Document\nStart Time:12/1/2007 11:03:56 PM \nEnd Time:9/1/2016 12:53:16 AM \nDuration:0.328125 Seconds\n------------------------------\n\n----------    ----------\nGet Word List from Excel\nStart Time:12/1/2007 3:05:49 PM \nEnd Time:9/1/2016 12:53:17 AM \nDuration:1.359130859375 Seconds\n------------------------------\n\n----------    ----------\nGet Word List from Text Document\nStart Time:11/30/2007 6:16:01 AM \nEnd Time:9/1/2016 12:53:17 AM \nDuration:0.008056640625 Seconds\n------------------------------\n</code></pre>\n\n<h2>Unit Test</h2>\n\n<pre><code>Sub TestWordList()\n    Dim arData\n\n    EventsTimer \"Get Word List from Word Document\"\n    arData = GetWordsListDoc\n    'Debug.Print Join(arData, \",\")\n    EventsTimer \"Get Word List from Word Document\"\n\n    EventsTimer \"Get Word List from Excel\"\n    arData = GetWordsListXL\n    'Debug.Print Join(arData, \",\")\n    EventsTimer \"Get Word List from Excel\"\n\n    EventsTimer \"Get Word List from Text Document\"\n    arData = GetWordsListTxt\n    'Debug.Print Join(arData, \",\")\n    EventsTimer \"Get Word List from Text Document\"\n\nEnd Sub\n</code></pre>\n\n<h2>Event Timer</h2>\n\n<pre><code>Sub EventsTimer(Optional EventName As String)\n    Static dict As Object\n    If dict Is Nothing Then Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    If dict.Exists(EventName) Then\n        Debug.Print\n        Debug.Print String(10, \"-\"), String(10, \"-\")\n        Debug.Print EventName\n        Debug.Print ; \"Start Time:\"; ; Now - dict(EventName)\n        Debug.Print ; \"End Time:\"; ; Now\n        Debug.Print ; \"Duration:\"; ; Timer - dict(EventName) &amp; \" Seconds\"\n        Debug.Print String(10, \"-\"); String(10, \"-\"); String(10, \"-\")\n        dict.Remove EventName\n    Else\n        dict.Add EventName, CDbl(Timer)\n    End If\n\n    If dict.Count = 0 Then Set dict = Nothing\nEnd Sub\n</code></pre>\n\n<h2>Functions to retrieve a word list from MS Word, Ms Excel and a Text File.</h2>\n\n<pre><code>Function GetWordsListDoc()\n    Const FilePath As String = \"C:\\Users\\best buy\\Downloads\\stackoverfow\\Wordlist\\WordList.docx\"\n\n    Dim doc As Word.Document, oWords As Word.Words\n    Dim x As Long\n    Dim arData\n\n    Set doc = Application.Documents.Open(FileName:=FilePath, ReadOnly:=True)\n\n    Set oWords = doc.Words\n\n    ReDim arData(oWords.Count - 1)\n\n    For x = 1 To oWords.Count\n        arData(x - 1) = Trim(oWords.Item(x))\n    Next\n\n    doc.Close False\n\n    GetWordsListDoc = arData\n\nEnd Function\n\nFunction GetWordsListXL()\n    Const FilePath As String = \"C:\\Users\\best buy\\Downloads\\stackoverfow\\Wordlist\\WordsList.xlsb\"\n    Const xlUp = -4162\n    Dim arData\n    Dim x As Long\n    Dim oExcel As Object, oWorkbook As Object\n    Set oExcel = CreateObject(\"Excel.Application\")\n    With oExcel\n        .Visible = False\n        Set oWorkbook = .Workbooks.Open(FileName:=FilePath, ReadOnly:=True)\n    End With\n\n    With oWorkbook.Worksheets(1)\n        arData = .Range(\"A1\", .Range(\"A\" &amp; .Rows.Count).End(xlUp)).Value\n        arData = oExcel.WorksheetFunction.Transpose(arData)\n    End With\n\n    oWorkbook.Close False\n    oExcel.Quit\n\n    GetWordsListXL = arData\n\nEnd Function\n\nFunction GetWordsListTxt()\n    Const FilePath As String = \"C:\\Users\\best buy\\Downloads\\stackoverfow\\Wordlist\\WordList.txt\"\n    Dim arData, f, fso\n    Set fso = CreateObject(\"Scripting.Filesystemobject\")\n    Set f = fso.OpenTextFile(FilePath)\n\n    arData = Split(f.ReadAll, vbNewLine)\n\n    GetWordsListTxt = arData\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6780412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c01dd34ad7a7de06d34935a11b4ad50e?s=128&d=identicon&r=PG&f=1", "display_name": "John Dougherty", "link": "https://stackoverflow.com/users/6780412/john-dougherty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1297, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472709960, "creation_date": 1472674606, "last_edit_date": 1472690469, "question_id": 39258301, "link": "https://stackoverflow.com/questions/39258301/using-find-in-word-from-a-list-in-excel-vba", "title": "Using Find in Word from a List in Excel VBA", "body": "<p>I am working on an automated peer review macro that would check for certain words and highlight them in a Microsoft Word document. However, I am looking to substitute the <code>WordList = Split(\" is , are ,\", \",\")</code> with a list I created in excel. This would be easier for me to add new words instead of manually typing the words I want highlighted in the code.</p>\n\n<p>For example: A1 has the word \" is \", so I am hoping it would be something like <code>Wordlist = Split(\"A1, A2\")</code> </p>\n\n<p>or something like <code>Exlist = Range(\"A1:A2\").value</code> so <code>WordList = Split(ExList)</code></p>\n\n<p>Is something like that possible? Thank you for your help.</p>\n\n<pre><code>  Sub PeerReview()\n\n  Dim r As Range\n  Dim WordList() As String\n  Dim a As Long\n\n  Dim Doc As Document\n  Dim Response As Integer\n\n  'This code will search through all of the open word documents and ask you which ones you would like to peer review.\n   For Each Doc In Documents\n      'MsgBox Doc\n      Response = MsgBox(prompt:=\"Do you want to peer review \" &amp; Doc &amp; \"?\", Buttons:=vbYesNo)\n      If Response = vbNo Then GoTo ShortCut\n\n      'This code will highlight words that do not belong in the paragraph\n      WordList = Split(\" is , are ,\", \",\") 'List of words to check for when it is peer-reviewing\n      Options.DefaultHighlightColorIndex = wdPink *'Highlight when found*\n      For a = 0 To UBound(WordList())\n          Set r = ActiveDocument.Range\n          With r.Find\n            .Text = WordList(a)\n            .Replacement.Highlight = wdYellow\n            .Execute Replace:=wdReplaceAll\n          End With\n      Next 'next word\n\nShortCut:\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1472673426, "post_id": 39257916, "comment_id": 65851929, "body": "see: <a href=\"http://stackoverflow.com/questions/36576540/sorting-using-a-custom-order-in-excel-gives-error-1004\" title=\"sorting using a custom order in excel gives error 1004\">stackoverflow.com/questions/36576540/&hellip;</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1472673431, "post_id": 39257916, "comment_id": 65851934, "body": "Have you used the Macro Recorder to see what code is generated if you do that sort manually?"}, {"owner": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "edited": false, "score": 0, "creation_date": 1472675091, "post_id": 39257916, "comment_id": 65852812, "body": "Yea Scott, the question you linked to answers my question within his question :P (although I don&#39;t think it&#39;s a duplicate)"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1472674213, "creation_date": 1472674213, "answer_id": 39258212, "question_id": 39257916, "link": "https://stackoverflow.com/questions/39257916/sorting-by-text-value-in-vba/39258212#39258212", "title": "Sorting by Text Value in VBA", "body": "<p>Using the macro recorder led me to the following code:</p>\n\n<pre><code>With ActiveSheet\n    .Sort.SortFields.Clear\n    .Sort.SortFields.Add Key:=.Range(\"C:C\"), _\n                         SortOn:=xlSortOnValues, _\n                         Order:=xlAscending, _\n                         CustomOrder:=\"Fail,Dismissed,Passed\", _\n                         DataOption:=xlSortNormal\n    .Sort.SortFields.Add Key:=.Range(\"G:G\"), _\n                         SortOn:=xlSortOnValues, _\n                         Order:=xlAscending, _\n                         CustomOrder:=\"Critical,High,Medium,Low\", _\n                         DataOption:=xlSortNormal\n    .Sort.SortFields.Add Key:=.Range(\"A:A\"), _\n                         SortOn:=xlSortOnValues, _\n                         Order:=xlAscending, _\n                         DataOption:=xlSortNormal\n    .Sort.SetRange .Range(\"A:AA\")\n    .Sort.Header = xlYes\n    .Sort.MatchCase = False\n    .Sort.Orientation = xlTopToBottom\n    .Sort.SortMethod = xlPinYin\n    .Sort.Apply\nEnd With\n</code></pre>\n\n<p>Hopefully that should do what you want.</p>\n"}], "owner": {"reputation": 373, "user_id": 6471719, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6c3795a02559b134181d1975afe22c30?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Dickson", "link": "https://stackoverflow.com/users/6471719/tyler-dickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2870, "favorite_count": 0, "accepted_answer_id": 39258212, "answer_count": 1, "score": 0, "last_activity_date": 1473018732, "creation_date": 1472673134, "last_edit_date": 1473018732, "question_id": 39257916, "link": "https://stackoverflow.com/questions/39257916/sorting-by-text-value-in-vba", "title": "Sorting by Text Value in VBA", "body": "<p>After running a VBA function on my spreadsheet, I would like to re-sort the data automatically, so the user doesn't have to. The sort options I'm trying to complete are as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3WoMa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3WoMa.png\" alt=\"enter image description here\"></a></p>\n\n<p>And my vba code is currently:</p>\n\n<pre><code>Columns(\"A:AA\").Sort key1:=Range(\"C1:C1\"), order1:=xlAscending, key2:=Range(\"G1:G1\"), order2:=xlAscending, key3:=Range(\"A1:A1\"), order3:=xlAscending, Header:=xlYes\n</code></pre>\n\n<p>As you can see, column A will sort properly, although the other 2 will not sort based on the <code>Fail, Dismissed, Passed</code> criteria and the <code>Critical, High, Medium, Low</code></p>\n\n<p>Is what I'm trying to do possible? Does anyone know a way to specify these Sort Orders?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6341511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/539c1f272569945385450961ba581bda?s=128&d=identicon&r=PG&f=1", "display_name": "YLS", "link": "https://stackoverflow.com/users/6341511/yls"}, "edited": false, "score": 0, "creation_date": 1472671097, "post_id": 39257135, "comment_id": 65850765, "body": "Thank you so much. You definitely answered by original question. Thank you also for pointing out these other points, i think they answered some other problems i have. for point 1, what i am trying to do is to return the rownumber for every worksheet. It did work well for a single worksheet, but once i loop through all the sheets, it starts to give weird numbers. And i still do not know why.  For point2, i correct that in the code, thanks for the tips. For point3, as i know there are less than 100 rows, so i used it for a quick code. Can you please elaborate on the point1? Thanks!"}, {"owner": {"reputation": 39, "user_id": 6341511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/539c1f272569945385450961ba581bda?s=128&d=identicon&r=PG&f=1", "display_name": "YLS", "link": "https://stackoverflow.com/users/6341511/yls"}, "edited": false, "score": 0, "creation_date": 1472673503, "post_id": 39257135, "comment_id": 65851978, "body": "i see what you mean by point 1. And updated by code--it seems to be working, pls let me know if you see any issues or there is a better way of doing it."}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": true, "score": 2, "last_activity_date": 1472686224, "last_edit_date": 1472686224, "creation_date": 1472670096, "answer_id": 39257135, "question_id": 39257084, "link": "https://stackoverflow.com/questions/39257084/copying-dynamic-rows-from-one-worksheet-to-another-in-vba/39257135#39257135", "title": "Copying dynamic rows from one worksheet to another in VBA", "body": "<p>What you're looking for is:</p>\n\n<pre><code>ws.Rows(rownumber1 &amp; \":\" &amp; rownumber2).EntireRow.Copy\n</code></pre>\n\n<p>Although, there are some other things to consider with your code.  It may be a work in progress so I only answered your question, but:</p>\n\n<ul>\n<li>Your loop is going to return row 100 every time, so I'm curious what the point of your loop is.  </li>\n<li>You should never DIM in a loop, since you can only declare a variable once and the loop will attempt to do it every time and <em>should</em> throw an error (Dim your rownumber variables with your <code>ws</code> variable).  </li>\n<li>Why loop to 100?  You should loop to the end of the list of values.</li>\n</ul>\n\n<p><strong>Reply to Edits</strong></p>\n\n<p>It looks pretty good.  the main thing is that it works.  Although I would change this:</p>\n\n<pre><code>ActiveSheet.Paste Range(\"A65536\").End(xlUp).Offset(1, 0)\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>ActiveSheet.Paste Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n</code></pre>\n\n<p>Hard-coded values aren't very future-proof, this looks at the last row of the sheet (whatever that might be).  If any of your sheets start to reach the row max you need to do this:</p>\n\n<pre><code>If Cells(Rows.Count, 1) &lt;&gt; \"\" Then\n  ActiveSheet.Paste Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\nElse\n  MsgBox(\"Sheet \" &amp; ws.Name &amp; \" is full, row cannot be copied\")\nEnd If\n</code></pre>\n\n<p>But that's probably way down the road and at that point you might be outgrowing Excel.</p>\n"}], "owner": {"reputation": 39, "user_id": 6341511, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/539c1f272569945385450961ba581bda?s=128&d=identicon&r=PG&f=1", "display_name": "YLS", "link": "https://stackoverflow.com/users/6341511/yls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 39257135, "answer_count": 1, "score": 1, "last_activity_date": 1472686224, "creation_date": 1472669936, "last_edit_date": 1472673440, "question_id": 39257084, "link": "https://stackoverflow.com/questions/39257084/copying-dynamic-rows-from-one-worksheet-to-another-in-vba", "title": "Copying dynamic rows from one worksheet to another in VBA", "body": "<p>I am trying to copy a number of rows from each worksheet to the worksheet called \"renew\" in the same workbook. </p>\n\n<p>The rows are defined as between the key words of <code>\"Service Requests\"</code> and <code>\"Renewals\"</code>. </p>\n\n<p>so step 1: define those row numbers, and step 2: copy them to the Renew sheet. </p>\n\n<p>I run into the problem with step 2, somehow, i couldn't work out how to use the rownumber1 and rownumber2 in the copy command. </p>\n\n<p>Any help would be appreciated. Thanks!</p>\n\n<p><a href=\"https://i.stack.imgur.com/Tlfbb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tlfbb.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub test()\n\nDim ws As Worksheet\n\n    Application.ScreenUpdating = False\n    Sheets(\"Renew\").Activate\n\nFor Each ws In Worksheets\n        If ws.Name &lt;&gt; \"Renew\" Then\n\n            For i = 1 To 100\n\n                Dim rownumber1 As Integer\n                Dim rownumber2 As Integer\n\n                    If Range(\"A\" &amp; i).Text = \"Service Requests\" Then\n                       rownumber1 = i\n                    ElseIf Range(\"A\" &amp; i).Text = \"Renewals\" Then\n                       rownumber2 = i\n                    End If\n\n            Next i\n\n       'copy rows between rownumber1 and rownumber2 to the renew sheet\n\n        ws.Rows(\"rownumber1:rownumber2\").EntireRow.Copy\n        ActiveSheet.Paste Range(\"A65536\").End(xlUp).Offset(1, 0)\n\n     End If\n\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>update: </p>\n\n<pre><code>Sub test2()\n\nDim ws As Worksheet\n\nDim rownumber1 As Integer\nDim rownumber2 As Integer\nDim FoundCell As Excel.Range\n\nApplication.ScreenUpdating = False\nSheets(\"Renew\").Activate\n\nFor Each ws In Worksheets\n        If ws.Name &lt;&gt; \"Renew\" Then\n\n            Set FoundCell = ws.Range(\"A:A\").Find(what:=\"Service Requests\", lookat:=xlWhole)\n            If Not FoundCell Is Nothing Then\n            rownumber1 = FoundCell.Row\n            End If\n\n            Set FoundCell = ws.Range(\"A:A\").Find(what:=\"Renewals\", lookat:=xlWhole)\n            If Not FoundCell Is Nothing Then\n            rownumber2 = FoundCell.Row\n            End If                              \n\n'copy renewals to the renewalsummary\n\n        ws.Rows(rownumber1 &amp; \":\" &amp; rownumber2).EntireRow.Copy\n        ActiveSheet.Paste Range(\"A65536\").End(xlUp).Offset(1, 0)\n\n     End If\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "udf", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1472668940, "post_id": 39256743, "comment_id": 65849468, "body": "you are defining a <code>Function</code> but you are not returning anything, you can just use a <code>Sub</code>, or you need to define it as <code>Function FrictionSum(rngInput As Range) As Long</code> for instance. Also, you are passing <code>rngInput</code> , but you are not doing anything with it inside your <b>UDF</b> ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472668955, "post_id": 39256743, "comment_id": 65849479, "body": "so the formula <code>=SUM(INDIRECT(&quot;&#39;&quot; &amp; A1 &amp; &quot;&#39;!Q:Q&quot;))</code> where A1 is the sheet name did not work?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1472669087, "post_id": 39256743, "comment_id": 65849567, "body": "Also you do not assign a value to strName, Is Excel supposed to guess?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6780117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9377b08d377709b7f5b0edc8cd494620?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/6780117/tom"}, "edited": false, "score": 0, "creation_date": 1472669855, "post_id": 39256930, "comment_id": 65850065, "body": "I had initially tried using SUM with INDIRECT, but for one reason or another it wouldnt work for me (probably missing a quote).  It works now.  In the UDF, the only reason I didnt have strName assigned was because I was troubleshooting.  I assigned FrictionSum to rngInput.Value, then commented it out when it worked OK, I just didnt re-assign strName.  As for the no return, why wouldnt FrictionSum inside my For Each loop be used as a return value?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 25, "user_id": 6780117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9377b08d377709b7f5b0edc8cd494620?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/6780117/tom"}, "edited": false, "score": 0, "creation_date": 1472670205, "post_id": 39256930, "comment_id": 65850254, "body": "Sorry I missed that.  it should have.  Maybe it was just a cascade, fix one error to create another.  but this should be faster."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1472670271, "last_edit_date": 1472670271, "creation_date": 1472669330, "answer_id": 39256930, "question_id": 39256743, "link": "https://stackoverflow.com/questions/39256743/excel-udf-to-sum-ranges-on-variable-worksheets/39256930#39256930", "title": "Excel UDF to sum ranges on variable worksheets", "body": "<p>As stated the formula:</p>\n\n<pre><code>=SUM(INDIRECT(\"'\" &amp; A1 &amp; \"'!Q:Q\"))\n</code></pre>\n\n<p>Should do what you want.</p>\n\n<p>The worksheet Function Sum will do what you want without the need to iterate.\nAlso make sure you assign the value to strName.</p>\n\n<p>code:</p>\n\n<pre><code>Function FrictionSum(rngInput As Range) As Double\n    Dim rngDomain As Range\n    Dim strName As String\n\n\n    strName = rngInput.Value\n\n\n    Set rngDomain = Sheets(strName).Range(\"Q:Q\")\n    FrictionSum = Application.WorksheetFunction.Sum(rngDomain)\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6780117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9377b08d377709b7f5b0edc8cd494620?s=128&d=identicon&r=PG", "display_name": "Tom", "link": "https://stackoverflow.com/users/6780117/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 39256930, "answer_count": 1, "score": 1, "last_activity_date": 1472670271, "creation_date": 1472668651, "last_edit_date": 1531164843, "question_id": 39256743, "link": "https://stackoverflow.com/questions/39256743/excel-udf-to-sum-ranges-on-variable-worksheets", "title": "Excel UDF to sum ranges on variable worksheets", "body": "<p>This is my first post here, so I will do my best to be as clear as possible.</p>\n\n<p>I have sort of settled on a UDF as being the correct solution here, but that is mostly because I couldnt figure out what built in function would work.</p>\n\n<p>My workbook starts out having two sheets: \"Summary Sheet\" and \"{System Template}\".  On Summary Sheet, I create a list of systems, and from that list I have some code that generates new worksheets using {System Template} and names the sheets based on the values in the list, which is working just fine.  In the cell next to the one that contains the system name on the summary sheet, I am trying to sum the values in the range \"Q:Q\" for each of the different systems on their respective sheet.  The only part of the range that is changing is the sheet name where the data is coming from.  This is where I am having trouble.  I get a #Value error and I have no idea how to figure out where the problem is.  Normally I would use the built in formula evaluation tool, but it is kind of useless with a UDF.  Any help would be much appreciated.</p>\n\n<pre><code>Function FrictionSum(rngInput As Range)\n    Dim rngCell, rngDomain As Range\n    Dim strName As String\n    FrictionSum = 0\n\n    'FrictionSum = rngInput.Value\n    Set rngDomain = Sheets(strName).Range(\"Q:Q\")\n\n        For Each rngCell In rngDomain\n            FrictionSum = FrictionSum + rngCell.Value\n        Next rngCell\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1472668472, "post_id": 39256357, "comment_id": 65849211, "body": "We don&#39;t know where the error is occurring in relationship to the first block of code you posted. Please <a href=\"https://stackoverflow.com/posts/39256357/edit\">edit</a> to add the remaining code between the two blocks."}, {"owner": {"reputation": 53, "user_id": 6535147, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa9ae20214a638379ee93ab8341c466e?s=128&d=identicon&r=PG&f=1", "display_name": "Jexon", "link": "https://stackoverflow.com/users/6535147/jexon"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1472669393, "post_id": 39256357, "comment_id": 65849759, "body": "That is all the code"}], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1472676754, "last_edit_date": 1472676754, "creation_date": 1472668788, "answer_id": 39256797, "question_id": 39256357, "link": "https://stackoverflow.com/questions/39256357/keep-reference-to-object-created-with-internet-explorer/39256797#39256797", "title": "Keep reference to object created with Internet Explorer", "body": "<p>After you navigate is when it Loses its place.   You can use a small method to obtain the correct IE object by passing in the URL you navigated to, assuming it isn't redirected and only one instance of IE has the url.  You will need to add a reference to Microsoft Shell Controls and Automation.</p>\n\n<p>Call it like</p>\n\n<pre><code>Set IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.navigate \"https://www.programworkshop.com/6.0.0.0/login/login.aspx?skin=default&amp;lang=enu\"\nWhile IE.readyState &lt;&gt; 4: DoEvents: Wend\nset IE = GetWebPage(\"https://www.programworkshop.com/6.0.0.0/login/login.aspx?skin=default&amp;lang=enu\")\n\n\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Desc: The Function gets the Internet Explorer window that has the current\n'   URL from the sURL Parameter.  The Function Timesout after 30 seconds\n'Input parameters:\n    'String sURL - The URL to look for\n'Output parameters:\n    'InternetExplorer ieWin - the Internet Explorer window holding the webpage\n'Result: returns the Internet Explorer window holding the webpage\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nFunction GetWebPage(sURL As String) As InternetExplorer\nDim winShell As Shell\nDim dt As Date\nDim ieWin As InternetExplorer\n\ndt = DateAdd(\"s\", 30, DateTime.Now)\n\nDo While dt &gt; DateTime.Now\n    Set winShell = New Shell\n    'loop through the windows and check the internet explorer windows\n    For Each ieWin In winShell.Windows\n        If ieWin.LocationURL = sURL Then\n            ieWin.Visible = True\n            Set GetWebPage = ieWin\n            Do While ieWin.Busy\n                DoEvents\n            Loop\n            Exit Do\n        Set winShell = Nothing\n        End If\n    Next ieWin\n    Set winShell = Nothing\n    DoEvents\nLoop\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6535147, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/aa9ae20214a638379ee93ab8341c466e?s=128&d=identicon&r=PG&f=1", "display_name": "Jexon", "link": "https://stackoverflow.com/users/6535147/jexon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1490099326, "creation_date": 1472667159, "last_edit_date": 1490099326, "question_id": 39256357, "link": "https://stackoverflow.com/questions/39256357/keep-reference-to-object-created-with-internet-explorer", "title": "Keep reference to object created with Internet Explorer", "body": "<p>I am trying to login to a website and then continue clicking on and filling in information within that same website. However, when I run my code I run into an error that says the object is forgotten. </p>\n\n<p>Here is the code</p>\n\n<pre><code>Sub Vba2HtmlForm()\n    Dim IE as Object\n    Dim frm as variant\n    dim element as variant\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n    IE.navigate \"https://www.programworkshop.com/6.0.0.0/login/login.aspx?skin=default&amp;lang=enu\"\n    While IE.readyState &lt;&gt; 4: DoEvents: Wend\n\n    ''trying to get form by ID''\n\n    IE.document.getElementById(\"Login\").Value = \"something@something.com\"\n\n    IE.document.getElementById(\"Pass\").Value = \"somepassword\"\n    IE.document.getElementById(\"btnlogin\").Click\n    While IE.readyState &lt;&gt; 4: DoEvents: Wend\n\n     Application.Wait (Now + TimeValue(\"00:00:02\"))\n\n    ' And then here is where I run into the following error:\n    ' Run-time error '424':\n    ' Object Required\n\n    IE.document.all(\"sd5\").Click\n    '''just a note here. I have also tried getelementbyId and getelementbyname with no luck''''\n\nEnd Sub\n</code></pre>\n\n<p>Here is the HTML</p>\n\n<pre><code>&lt;a id=\"sd5\" class=\"node\" href=\"javascript:treeAction(strURL5)\" onmouseover=\"window.status='Examinees';return true;\" onmouseout=\"window.status='';return true;\" onclick=\"javascript: d.s(5);\"&gt;Examinees&lt;/a&gt;\n</code></pre>\n"}, {"tags": ["vba", "outlook", "macros"], "answers": [{"tags": [], "owner": {"reputation": 5095, "user_id": 51759, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7025057f088002df38b8411719084db3?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Lamb", "link": "https://stackoverflow.com/users/51759/jeff-lamb"}, "is_accepted": true, "score": 0, "last_activity_date": 1472669927, "creation_date": 1472669927, "answer_id": 39257081, "question_id": 39256143, "link": "https://stackoverflow.com/questions/39256143/set-all-mail-items-in-an-outlook-conversation-to-read-using-vba/39257081#39257081", "title": "Set all mail items in an outlook conversation to read using VBA", "body": "<p>This worked for me:</p>\n\n<pre><code>Sub Archive()\n    Dim Item As Outlook.MailItem ' Mail Item\n    Dim oConv As Outlook.Conversation ' Get the conversation\n\n    Set ArchiveFolder = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox).Parent.Folders(\"Archive\")\n    If ArchiveFolder Is Nothing Then\n          Set ArchiveFolder = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox).Parent.Folders.Add(\"Archive\")\n    End If\n    Set oStore = ArchiveFolder.Store\n    Set selections = ActiveExplorer.Selection\n\n    If selections.Count &lt;&gt; 0 Then\n        ' Mail item selected\n        For Each theSelection In selections\n            Set oConv = theSelection.GetConversation\n            If Not (oConv Is Nothing) Then\n\n                For Each MailItem In oConv.GetRootItems ' Items in the conversation.\n                    If TypeOf MailItem Is Outlook.MailItem Then\n                        ' Set current mail item to read\n                        Set Item = MailItem\n                        Item.UnRead = False\n\n                        ' Process all children as well\n                        GetConv Item, oConv\n                    End If\n                Next\n\n                oConv.SetAlwaysMoveToFolder ArchiveFolder, oStore\n                oConv.StopAlwaysMoveToFolder oStore\n            End If\n        Next theSelection\n    Else\n        ' Conversation header selected\n        Set oConv = ActiveExplorer.Selection.GetSelection(Outlook.OlSelectionContents.olConversationHeaders).Item(1).GetConversation\n        If Not (oConv Is Nothing) Then\n\n            For Each MailItem In oConv.GetRootItems ' Items in the conversation.\n                If TypeOf MailItem Is Outlook.MailItem Then\n                    ' Set current mail item to read\n                    Set Item = MailItem\n                    Item.UnRead = False\n\n                    ' Process all children as well\n                    GetConv Item, oConv\n                End If\n            Next\n\n            oConv.SetAlwaysMoveToFolder ArchiveFolder, oStore\n            oConv.StopAlwaysMoveToFolder oStore\n\n        End If\n    End If\nEnd Sub\n\n\nFunction GetConv(Item As Object, Conversation As Outlook.Conversation)\n    Dim Items As Outlook.SimpleItems\n    Dim MailItem As Object\n    Dim Folder As Outlook.Folder\n    Dim olNs As NameSpace\n    Dim Inbox As Outlook.MAPIFolder\n    Dim SubFolder As Outlook.MAPIFolder\n\n    Set olNs = Application.GetNamespace(\"MAPI\")\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n    Set Items = Conversation.GetChildren(Item)\n\n    If Items.Count &gt; 0 Then\n        For Each MailItem In Items\n            If TypeOf MailItem Is Outlook.MailItem Then\n                ' Set current mail item to read\n                MailItem.UnRead = False\n            End If\n            ' Process all children as well\n            GetConv MailItem, Conversation\n        Next\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5095, "user_id": 51759, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7025057f088002df38b8411719084db3?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Lamb", "link": "https://stackoverflow.com/users/51759/jeff-lamb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2394, "favorite_count": 0, "accepted_answer_id": 39257081, "answer_count": 1, "score": 0, "last_activity_date": 1604524166, "creation_date": 1472666261, "question_id": 39256143, "link": "https://stackoverflow.com/questions/39256143/set-all-mail-items-in-an-outlook-conversation-to-read-using-vba", "title": "Set all mail items in an outlook conversation to read using VBA", "body": "<p>I have a macro that archives entire conversations.  This works for both selecting a single mail item in the conversation as well as selecting the conversation header.  I'd like to add the ability to mark all messages within the conversation as read.  I can't seem to figure it out.  How can I do this?</p>\n\n<p>Here's the existing macro:</p>\n\n<pre><code>Sub Archive()\n    Set ArchiveFolder = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox).Parent.Folders(\"Archive\")\n    If ArchiveFolder Is Nothing Then\n          Set ArchiveFolder = Application.GetNamespace(\"MAPI\").GetDefaultFolder(olFolderInbox).Parent.Folders.Add(\"Archive\")\n    End If\n    Set oStore = ArchiveFolder.Store\n    Set selections = ActiveExplorer.Selection\n    If selections.Count &lt;&gt; 0 Then\n        ' Mail item selected\n        For Each theSelection In selections\n            Set oConv = theSelection.GetConversation\n            If Not (oConv Is Nothing) Then\n                 oConv.SetAlwaysMoveToFolder ArchiveFolder, oStore\n                 oConv.StopAlwaysMoveToFolder oStore\n            End If\n        Next theSelection\n    Else\n        ' Conversation header selected\n        Set oConv = ActiveExplorer.Selection.GetSelection(Outlook.OlSelectionContents.olConversationHeaders).Item(1).GetConversation\n        If Not (oConv Is Nothing) Then\n            oConv.SetAlwaysMoveToFolder ArchiveFolder, oStore\n            oConv.StopAlwaysMoveToFolder oStore\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472668663, "post_id": 39256128, "comment_id": 65849307, "body": "let me know if what you wanted is in my answer below"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1472668939, "post_id": 39256128, "comment_id": 65849467, "body": "The following line of VBA code will give you the page count for a sheet (based on the current page setup. <code>ThisWorkbook.Worksheets(1).PageSetup.Pages.Count</code> Yet, if a user is changing the page setup just before printing then you&#39;re out of luck. So, I&#39;d suggest that you control printing altogether by offering a print button."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472747165, "post_id": 39256128, "comment_id": 65887773, "body": "@Flower_Dance have you tested it ?"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1472668637, "creation_date": 1472668637, "answer_id": 39256739, "question_id": 39256128, "link": "https://stackoverflow.com/questions/39256128/excel-vba-how-to-insert-sequential-page-number/39256739#39256739", "title": "Excel VBA - How to Insert Sequential Page Number", "body": "<p>If you mean you want to write the index of the current sheet out of the entire number of sheets in your <code>ActiveWorkbook</code>, then use the following code:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"Appendix A\").PageSetup.CenterFooter = \"Page \" &amp; ActiveWorkbook.Worksheets(\"Appendix A\").Index &amp; \" of \" &amp; ActiveWorkbook.Sheets.Count\nActiveWorkbook.Worksheets(\"Summary\").PageSetup.CenterFooter = \"Page \" &amp; ActiveWorkbook.Worksheets(\"Summary\").Index &amp; \" of \" &amp; ActiveWorkbook.Sheets.Count\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6032786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce23403782e4fca53fdf4bfa21185e2?s=128&d=identicon&r=PG&f=1", "display_name": "Flower_Dance", "link": "https://stackoverflow.com/users/6032786/flower-dance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3162, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472668637, "creation_date": 1472666212, "question_id": 39256128, "link": "https://stackoverflow.com/questions/39256128/excel-vba-how-to-insert-sequential-page-number", "title": "Excel VBA - How to Insert Sequential Page Number", "body": "<p>I would like to insert sequential page number across the entire workbook (there are two worksheets in the workbook.</p>\n\n<p>Here is my code to insert page numbers:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"Appendix A\").PageSetup.CenterFooter = \"&amp;P of &amp;N\"\nActiveWorkbook.Worksheets(\"Summary\").PageSetup.CenterFooter = \"&amp;P of &amp;N\"\n</code></pre>\n"}, {"tags": ["vba", "vb6", "windows-10"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1472666644, "post_id": 39256063, "comment_id": 65848244, "body": "it is a default setting.."}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 3, "creation_date": 1472670071, "post_id": 39256063, "comment_id": 65850181, "body": "Nothing to do with VB 6. All window title bars look like this. They are white and blend in to the window background, which is also white. It&#39;s a setting, I can&#39;t remember exactly where. Look in the Personalization settings, probably under Color. Or search Google. Make sure you have the latest version of Windows 10; the early versions did not support changing the colors of title bars."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1472672916, "post_id": 39256063, "comment_id": 65851669, "body": "windows pro 10 version 1511 @CodyGray"}, {"owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 2, "creation_date": 1472725327, "post_id": 39256063, "comment_id": 65872272, "body": "That is the version I happen to have on a Virtual Machine right now. My title bars are a khaki color. Right-click on the desktop, choose &quot;Personalize&quot;. The &quot;Settings -&gt; Personalization&quot; dialog will appear. Choose &quot;Colors&quot; in the left-hand side bar, turn off &quot;Automatically pick an accent color&quot;, choose one of the accent colors from the palette of options, and then turn on the &quot;Show color on Start, taskbar, action center, and title bar&quot; option below. (The other sites you found and were linked are all for the original version of Windows 10, which didn&#39;t support this and required hacks.)"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1472735532, "post_id": 39256063, "comment_id": 65879480, "body": "@CodyGray - Perfect - Thank you lots!"}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "reply_to_user": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "edited": false, "score": 0, "creation_date": 1472737342, "post_id": 39256063, "comment_id": 65880915, "body": "@CodyGray if you post as answer i&#39;ll accept it. The other answer helped me a lot but this resolved it."}], "answers": [{"comments": [{"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1472672376, "post_id": 39257134, "comment_id": 65851415, "body": "This doesn&#39;t seem to work - in Win 7 you are able to see what the top bar of msg box looks like. Here you are not and changing it to a different accent color doesnt fix the issue."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1472672902, "post_id": 39257134, "comment_id": 65851658, "body": "I&#39;m running windows 10 pro  version 1511"}, {"owner": {"reputation": 4573, "user_id": 5718868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lMKOf.png?s=128&g=1", "display_name": "jonathana", "link": "https://stackoverflow.com/users/5718868/jonathana"}, "reply_to_user": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1472673434, "post_id": 39257134, "comment_id": 65851936, "body": "it seems to be more complicated than i  to assumed...googled and found this post: <a href=\"http://superuser.com/questions/949920/window-color-and-appearance-removed-in-win10\" title=\"window color and appearance removed in win10\">superuser.com/questions/949920/&hellip;</a>"}, {"owner": {"reputation": 4573, "user_id": 5718868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lMKOf.png?s=128&g=1", "display_name": "jonathana", "link": "https://stackoverflow.com/users/5718868/jonathana"}, "reply_to_user": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1472674574, "post_id": 39257134, "comment_id": 65852553, "body": "you can customize forms (but not Msgboxes)  but i guess that you will not go back to your old Apps and replace all msgboxes with a new personal customized Msgbox."}, {"owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "edited": false, "score": 0, "creation_date": 1472676785, "post_id": 39257134, "comment_id": 65853622, "body": "yeah we will see what happens - need user input first. Thanks for your help with this."}], "tags": [], "owner": {"reputation": 4573, "user_id": 5718868, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lMKOf.png?s=128&g=1", "display_name": "jonathana", "link": "https://stackoverflow.com/users/5718868/jonathana"}, "is_accepted": true, "score": 2, "last_activity_date": 1472670088, "creation_date": 1472670088, "answer_id": 39257134, "question_id": 39256063, "link": "https://stackoverflow.com/questions/39256063/vb6-applications-in-windows-10/39257134#39257134", "title": "VB6 applications in Windows 10", "body": "<p>The controls implemented from the OS. You need to change properties on the operation system. Maybe this could help:</p>\n\n<p><a href=\"http://answers.microsoft.com/en-us/windows/forum/windows_10-start/change-application-background-color-window-10/167b133e-62f4-4eae-9425-2b9a6019bded\" rel=\"nofollow\">http://answers.microsoft.com/en-us/windows/forum/windows_10-start/change-application-background-color-window-10/167b133e-62f4-4eae-9425-2b9a6019bded</a></p>\n"}], "owner": {"reputation": 1471, "user_id": 6641623, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IOoNP.png?s=128&g=1", "display_name": "BobSki", "link": "https://stackoverflow.com/users/6641623/bobski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 39257134, "answer_count": 1, "score": 0, "last_activity_date": 1472670088, "creation_date": 1472665960, "question_id": 39256063, "link": "https://stackoverflow.com/questions/39256063/vb6-applications-in-windows-10", "title": "VB6 applications in Windows 10", "body": "<p>I moved a few of my applications to WINDOWS 10 and one of the issue I noticed - which is not really an issue with functionality but rather the colors. Msgboxes seem to not have the top bar anymore (where TITLE goes) - it's actually there, but it's so light that it's difficult to see where the top bar is and the rest of the msg box. does anyone know how to tweak it so that it looks more defined just like it did when it was run in XP or Win7</p>\n"}, {"tags": ["vba", "excel", "consolidation"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1472665615, "post_id": 39255878, "comment_id": 65847620, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) writing their own code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve. Also, you might want to give us a specific question to which you expect an answer."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1472665856, "post_id": 39255878, "comment_id": 65847792, "body": "First thought would be to break down your process into steps and try to get each step working. As you struggle through that, post questions here for help in getting things working. It may take some time to learn how to do all you need to do, but that is coding I guess. My thought is that you should loop through and open each workbook, input the necessary data (copy/paste has a lot of overhead, so recommend a different approach) then close it and move to the next."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1472668218, "post_id": 39255878, "comment_id": 65849066, "body": "@Kyle At first I wanted to post a comment like yours. But then I figured that there are too many options (and routes) to go about this question. It is simply too broad to answer it as is: should it be done with formulas and simple <code>VLookUps</code> or with VBA? If VBA, should it be simple <code>Workbook.Open</code> and then <code>.Copy</code> and <code>.Paste</code>? Should it be imported using <code>ADO</code>? Is a central SQL an option? I believe that the OP needs to do some more research or (better yet) chat with someone to find out what he/she wants: <a href=\"http://chat.stackexchange.com/rooms/info/21/the-whiteboard\">chat.stackexchange.com/rooms/info/21/the-whiteboard</a>"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1472668547, "post_id": 39255878, "comment_id": 65849251, "body": "@Ralph, that&#39;s a great point. The actual end goal of this (and resources available) would dictate a large portion of how this should be designed."}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 6780181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17a722f0142d7c9eeeef8e0da1c5a10?s=128&d=identicon&r=PG&f=1", "display_name": "Coolshaikh", "link": "https://stackoverflow.com/users/6780181/coolshaikh"}, "is_accepted": false, "score": 1, "last_activity_date": 1472672811, "last_edit_date": 1472672811, "creation_date": 1472668570, "answer_id": 39256720, "question_id": 39255878, "link": "https://stackoverflow.com/questions/39255878/consolidating-data-from-other-workbooks-into-one-workbook/39256720#39256720", "title": "Consolidating Data from Other Workbooks into One Workbook", "body": "<p>How about setting the destination range to the values of the source range?\ne.g.:</p>\n\n<pre><code>rngTarget.Resize(rngSource.Rows.Count, rngSource.Columns.Count).Value = rngSource.Value\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6779990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698bcea108b763f138535a497adbae38?s=128&d=identicon&r=PG&f=1", "display_name": "toddexcel", "link": "https://stackoverflow.com/users/6779990/toddexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537946450, "creation_date": 1472665309, "last_edit_date": 1537946450, "question_id": 39255878, "link": "https://stackoverflow.com/questions/39255878/consolidating-data-from-other-workbooks-into-one-workbook", "title": "Consolidating Data from Other Workbooks into One Workbook", "body": "<p><strong>Current Situation:</strong> I am consolidating a data package that receives multiple inputs from programs that roll into mine. Essentially, each program provides me their set of data and I am responsible for accurately consolidating data into one Excel workbook in a certain format. I have pushed out a template so that all the data comes back in the same format, but now I am having trouble quickly consolidating besides using \"copy and paste\". </p>\n\n<p><strong>Solutions I've looked into:</strong> I've looked into using connections to see if can pull in the data I need through a connected file however it imports the table in a different format and does not transfer correctly into the consolidation template that I have set up. I tried doing external source referencing to pull in data that way, but again the formatting is off. I know there are ways to just pull in the workbook, but I need data from specific points in these program workbooks that I can slot into my consolidated workbook. In most cases, copy and pasting would work, but I have over hundreds of programs that flow into this data sheet so any help would be appreciated!</p>\n"}, {"tags": ["csv", "ms-access", "import", "vba", "leading-zero"], "comments": [{"owner": {"reputation": 836, "user_id": 6419727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f5532e6c9f3d91e56fdffd792dcf9?s=128&d=identicon&r=PG&f=1", "display_name": "random_answer_guy", "link": "https://stackoverflow.com/users/6419727/random-answer-guy"}, "edited": false, "score": 0, "creation_date": 1472668171, "post_id": 39255736, "comment_id": 65849037, "body": "Are the leading zero&#39;s dynamic or is the field length fixed? If fixed, you could set the columns format property to retain the leading zeros"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 2, "creation_date": 1472671008, "post_id": 39255736, "comment_id": 65850713, "body": "since you are reading the file to get the column count, what is stopping you to loop through the line and insert all rows? i know this is not the answer you wanted but just saying. BTW. If you really want to fix this, add an empty/test row on top of your .csv file that all coumns have text values. it will force access to read all columns as Text, otherwise Access converts columns while transferring and yours is one of its side effect."}, {"owner": {"reputation": 21, "user_id": 6779598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163a2f833ca1eaa64795262297c6dd97?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/6779598/carl"}, "reply_to_user": {"reputation": 836, "user_id": 6419727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e6f5532e6c9f3d91e56fdffd792dcf9?s=128&d=identicon&r=PG&f=1", "display_name": "random_answer_guy", "link": "https://stackoverflow.com/users/6419727/random-answer-guy"}, "edited": false, "score": 0, "creation_date": 1472672687, "post_id": 39255736, "comment_id": 65851554, "body": "@random_answer_guy - leading zeros are dynamic."}, {"owner": {"reputation": 21, "user_id": 6779598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163a2f833ca1eaa64795262297c6dd97?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/6779598/carl"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1472673008, "post_id": 39255736, "comment_id": 65851710, "body": "@krishKM - yeah I was hoping to avoid looping through the file; instead, I wanted to &quot;bulk insert&quot; it into the table. And, I tried inserting a test row right after the header row with non-numeric values for the problematic columns. No luck.It still stripped off the leading zeros on subsequent rows. Thanks for your input!"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1472673408, "post_id": 39255736, "comment_id": 65851918, "body": "this problem is very familiar but not sure how I did it. i think access evaluates either 1st row or first 10 rows to identify the data type. (i know its stupid) if you really want to be sure, just insert it line by line at least you know what you did.."}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1472692146, "post_id": 39255736, "comment_id": 65858322, "body": "@Carl, just tried myself. Leading zeros remain when I used at least 5 dummy records (non-numeric values only)."}, {"owner": {"reputation": 21, "user_id": 6779598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163a2f833ca1eaa64795262297c6dd97?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/6779598/carl"}, "reply_to_user": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1472764902, "post_id": 39255736, "comment_id": 65896469, "body": "@Rene, thank you for the input. I believe I have found the underlying issue. I need to do some more testing but if it turns out to be correct, I will post back here with my solution."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6779598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163a2f833ca1eaa64795262297c6dd97?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/6779598/carl"}, "edited": false, "score": 0, "creation_date": 1472735168, "post_id": 39261241, "comment_id": 65879195, "body": "Set HasFieldNames to false. Got error &quot;The INSERT INTO statement contains the following unknown field name: &#39;F1&#39;. etc, etc."}, {"owner": {"reputation": 21, "user_id": 6779598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163a2f833ca1eaa64795262297c6dd97?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/6779598/carl"}, "edited": false, "score": 0, "creation_date": 1472735229, "post_id": 39261241, "comment_id": 65879239, "body": "And, the field names must be the first row because that&#39;s how I determine the column names for creating the table."}], "tags": [], "owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "is_accepted": false, "score": 1, "last_activity_date": 1472775998, "last_edit_date": 1472775998, "creation_date": 1472691962, "answer_id": 39261241, "question_id": 39255736, "link": "https://stackoverflow.com/questions/39255736/import-csv-file-to-msaccess-table-without-losing-leading-zeros/39261241#39261241", "title": "Import .csv file to MSAccess table without losing leading zeros", "body": "<p>Instead of using the field names from the import file, name all of the fields in the import table F1, F2, F3, etc.\nSet the HasFieldNames parameter to false. Then the first row will always be text. You can delete that row later.\nThen either change the field names to what you want or insert the data into another table. I always use this method anyway, so that I can clean up the import data before inserting it into final destination tables.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 6779598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163a2f833ca1eaa64795262297c6dd97?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/6779598/carl"}, "is_accepted": false, "score": 0, "last_activity_date": 1474476048, "last_edit_date": 1495541781, "creation_date": 1474476048, "answer_id": 39622109, "question_id": 39255736, "link": "https://stackoverflow.com/questions/39255736/import-csv-file-to-msaccess-table-without-losing-leading-zeros/39622109#39622109", "title": "Import .csv file to MSAccess table without losing leading zeros", "body": "<p>Here's the solution that worked for me; credit to Ryan Griffin for his answer to a similar question on Stack Overflow.</p>\n\n<p>Re-stating the requirements:</p>\n\n<p>1) import a .csv file into MSAccess</p>\n\n<p>2) must retain all leading zeros in fields that have them</p>\n\n<p>3) .csv file is dynamic; the number of columns can (and usually does) vary with every import</p>\n\n<p>4) data type can be Text for all columns</p>\n\n<p>5) length of data for a given column will never be > 255</p>\n\n<p>6) first row of .csv file will always contain column names and a column name will never have a comma in it</p>\n\n<p>7) columns may or may not have quote delimiters; if any column contains a comma then that column will be quote-delimited; otherwise it may or may not be.</p>\n\n<p>Here's a sample .csv file:</p>\n\n<p>Name,Department,Extension</p>\n\n<p>\"ManyJohns, John\",02,0987</p>\n\n<p>John Smallberries,\"Acquisitions\",\"32939\"</p>\n\n<p>\"John Bigbootie\",0001,GIGO</p>\n\n<hr>\n\n<p>System setup: Windows 7 and MSAccess 2007</p>\n\n<p>I was aware of a registry setting which helped on a similar project years ago.\nWin7 path is HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Jet\\4.0\\Engines\\Text</p>\n\n<p>Change the value of <strong>ImportMixedTypes</strong> from <strong>Majority Type</strong> to <strong>Text</strong></p>\n\n<p>First try: using the TransferText action</p>\n\n<p>Variables: TableName and FilePathAndName</p>\n\n<p>DoCmd.TransferText acImportDelim, , TableName, FilePathAndName, True</p>\n\n<p>Note that there is no import specification because as mentioned above it can change every time.\nResult: Dropped leading zeros and removed text values</p>\n\n<p><a href=\"https://i.stack.imgur.com/tzA6Z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tzA6Z.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Second try: opening the .csv file as an Access object</p>\n\n<p>Variables: TableName, FilePath and FileName</p>\n\n<pre><code>SQLStatement = \"INSERT INTO \" &amp; TableName &amp; \" SELECT * FROM [TEXT;FMT=Delimited;HDR=YES;IMEX=1;CharacterSet=437;DATABASE=\" &amp; FilePath &amp; \"].[\" &amp; FileName &amp; \"]\"\nDoCmd.RunSQL SQLStatement\n</code></pre>\n\n<p>Result: I had never seen this used before; kind of cool, I thought. But, it also dropped leading zeros and removed text values.</p>\n\n<p><a href=\"https://i.stack.imgur.com/z13DZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z13DZ.jpg\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Third try: dynamically creating an import/export specification\nHere's the post from Ryan Griffin whose solution I adapted for my purposes. Thank you sir; I salute you.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3413740/access-data-project-importing-csv-file-in-vba/11147920#11147920\">Access Data Project Importing CSV File In VBA</a></p>\n\n<p>And, success.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XB7p7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XB7p7.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Because of the dynamic nature of my .csv files, here's the final code based on Ryan's work.\nI did not include variable declarations here; if interested let me know and I'll put something together a little more polished.</p>\n\n<pre><code>Private Function CreateImportSpecification()\n\n    'based on solution from Ryan Griffin 21-JUN-2012\n    ImportSpecificationName = \"ImportSpec_\" &amp; TableName\n\n    xml = \"\"\n    xml = xml &amp; \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"utf-8\"\" ?&gt;\" &amp; vbCrLf\n    xml = xml &amp; \"&lt;ImportExportSpecification Path=\" &amp; Chr(34) &amp; FilePathAndName &amp; Chr(34) &amp; \" xmlns=\"\"urn:www.microsoft.com/office/access/imexspec\"\"&gt;\" &amp; vbCrLf\n    xml = xml &amp; \"   &lt;ImportText TextFormat=\"\"Delimited\"\" FirstRowHasNames=\"\"true\"\" FieldDelimiter=\"\",\"\" CodePage=\"\"437\"\" Destination=\" &amp; Chr(34) &amp; TableName &amp; Chr(34) &amp; \" &gt;\" &amp; vbCrLf\n    xml = xml &amp; \"      &lt;DateFormat DateOrder=\"\"MDY\"\" DateDelimiter=\"\"/\"\" TimeDelimiter=\"\":\"\" FourYearDates=\"\"true\"\" DatesLeadingZeros=\"\"false\"\" /&gt;\" &amp; vbCrLf\n    xml = xml &amp; \"      &lt;NumberFormat DecimalSymbol=\"\".\"\" /&gt;\" &amp; vbCrLf\n    xml = xml &amp; \"         &lt;Columns PrimaryKey=\"\"{none}\"\"&gt;\" &amp; vbCrLf\n\n    ' dynamically populate the 'FieldName' property of the &lt;Column&gt; attribute\n    For i = 0 To UBound(ColumnNames)\n        xml = xml &amp; \"            &lt;Column Name=\"\"Col\" &amp; (i + 1) &amp; \"\"\" FieldName=\"\"\" &amp; ColumnNames(i) &amp; \"\"\" Indexed=\"\"NO\"\" SkipColumn=\"\"false\"\" DataType=\"\"Text\"\" Width=\"\"255\"\" /&gt;\" &amp; vbCrLf\n    Next i\n\n    xml = xml &amp; \"         &lt;/Columns&gt;\" &amp; vbCrLf\n    xml = xml &amp; \"   &lt;/ImportText&gt;\" &amp; vbCrLf\n    xml = xml &amp; \"&lt;/ImportExportSpecification&gt;\"\n\n    ' if a specification already exists for this table, delete it\n    With CurrentProject.ImportExportSpecifications\n        For i = 0 To .Count - 1\n            If .Item(i).Name = ImportSpecificationName Then\n                .Item(i).Delete\n                Exit For\n            End If\n        Next i\n        ' add the specification to the database\n        .Add ImportSpecificationName, xml\n        ' could execute ImportSpecificationName right here\n        ' but would need to loop through the ImportExportSpecifications again\n        ' to make sure you had the right one\n    End With\n\n    DoCmd.RunSavedImportExport ImportSpecificationName\n\nEnd Function\n</code></pre>\n\n<p>The only thing I can figure is that MSAccess ignores the registry key (or I am modifying the wrong one) when importing a .csv file.\nUltimately, the only thing that worked for me was to dynamically create an import/export specification.\nAny additional input is welcome.</p>\n"}], "owner": {"reputation": 21, "user_id": 6779598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/163a2f833ca1eaa64795262297c6dd97?s=128&d=identicon&r=PG&f=1", "display_name": "Carl", "link": "https://stackoverflow.com/users/6779598/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1223, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1474476048, "creation_date": 1472664845, "last_edit_date": 1472667079, "question_id": 39255736, "link": "https://stackoverflow.com/questions/39255736/import-csv-file-to-msaccess-table-without-losing-leading-zeros", "title": "Import .csv file to MSAccess table without losing leading zeros", "body": "<p>My objective is to automate the import of a .csv file into an Access table, retaining all data in the csv file, specifically leading zeros.</p>\n\n<p>The csv file will have a varying number of columns every time, so the table it needs to be imported into will have to be created on the fly.\nAlso, the decision was made to have every column defined as text(255).</p>\n\n<p>Here's the relevant code for that process, leaving out the part where the user navigates to a folder and selects a .csv file.</p>\n\n<p>Notes on variables:</p>\n\n<p><strong>FilePathAndName</strong> contains the full path and file name of the .csv file</p>\n\n<p><strong>TableName</strong>       contains the name of the MSAccess table I am creating</p>\n\n<p><strong>HeaderRow</strong>       contains the first row of the csv file which has column names. The column names will never contain a comma.</p>\n\n<p><strong>ColumnNames()</strong>   is an array to hold the column names themselves.</p>\n\n<p><strong>SQLStatement</strong>    will hold a SQL DDL statement to create the table</p>\n\n<pre><code>Open FilePathAndName For Input As #1\n\n' read first row to get column names because that will change every time\nLine Input #1, HeaderRow\nClose #1\nColumnNames = Split(HeaderRow, \",\")\n\n' create MSAccess table via DDL commands\nTableName = \"GROUPS_TEST\"\nSQLStatement = \"CREATE TABLE \" &amp; TableName &amp; \"(\"\nFor i = 0 To UBound(ColumnNames)\n    SQLStatement = SQLStatement &amp; \"[\" &amp; ColumnNames(i) &amp; \"] text(255)\"\n    If i &lt; UBound(ColumnNames) Then\n        SQLStatement = SQLStatement &amp; \", \"\n    End If\nNext i\nSQLStatement = SQLStatement &amp; \")\"\nDoCmd.RunSQL SQLStatement\n\n' load .csv file into the table that was just created\nDoCmd.TransferText acImportDelim, , TableName, FilePathAndName, True\n</code></pre>\n\n<p>It works flawlessly down to and including the DoCmd.RunSQL statement where the table is created.\nAll columns are defined as text(255) because there are some columns which have leading zeros which must be retained.\nThey are not numbers; they are alphanumeric values.\nThen the trouble begins. I execute the TransferText action and the data is imported to the table from the .csv file.\n<strong>Except that it strips leading zeros from the values that have them\n even though I specifically defined all columns as TEXT columns.</strong></p>\n\n<p>I've been googling for a couple of hours and nothing has turned up.\nI don't have an import/export specification because of the dynamic nature of the .csv files.\nAnd I don't know that it would make any difference anyway.</p>\n\n<p>One thing that was mentioned was editing a registry setting for text files in MSAccess but I could not find specifics.\nI'm using Access 2007.\nAnother idea brought up was using a schema.ini file but again due to the dynamic nature of the csv files I don't know if that would work.</p>\n\n<p>Any help will be gratefully accepted. \nThanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1472664805, "post_id": 39255708, "comment_id": 65847166, "body": "Use the <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH function</a> to determine the column number."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1472669057, "post_id": 39255917, "comment_id": 65849549, "body": "Thank you very much! That did exactly what I needed. One question though, This works for cells with values in it. It did not work with drop down lists that were in row 2 of sheet 2. How can I modify the code to Paste value instead of setting them equal to one another?                <code>For Each headerTwo In shtTwoHead     For Each headerOne In shtOneHead         If headerTwo.Value = headerOne.Value Then             headerOne.Offset(1, 0).Value = headerTwo.Offset(1, 0).Value &#39;CAN I COPY AND PASTE? HERE INSTEAD?         End If     Next headerOne Next headerTwo</code>"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 1, "creation_date": 1472669304, "post_id": 39255917, "comment_id": 65849711, "body": "I&#39;m not sure I understand. I modified my made up data to have drop down lists in the second row of sheet two, and the code still matched up the values. Are there any errors that are thrown, or is it just not matching the data and leaving the cells blank?"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1472669439, "post_id": 39255917, "comment_id": 65849796, "body": "@KatyTorres I am adding a new code in addition to what I have up there. Please see above."}, {"owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "edited": false, "score": 0, "creation_date": 1472669455, "post_id": 39255917, "comment_id": 65849803, "body": "No errors are thrown. It works perfect for all the values so I am sure the headers are matching fine, it just does not populate the 2nd row if it happens to be a drop down and not a simple value. I will look into this and let you know what resolves it."}, {"owner": {"reputation": 996, "user_id": 791681, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/rGxk5.jpg?s=128&g=1", "display_name": "2by", "link": "https://stackoverflow.com/users/791681/2by"}, "edited": false, "score": 0, "creation_date": 1560801627, "post_id": 39255917, "comment_id": 99847157, "body": "@PartyHatPanda How can I make it go through all the rows instead of only copying the first row?"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "reply_to_user": {"reputation": 996, "user_id": 791681, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/rGxk5.jpg?s=128&g=1", "display_name": "2by", "link": "https://stackoverflow.com/users/791681/2by"}, "edited": false, "score": 0, "creation_date": 1560888567, "post_id": 39255917, "comment_id": 99882628, "body": "@2by inside the inner loop where I am was having the offset in place, you can capture the last row of the column and loop through from the start row to the last row. Let me know if you need assistance with that, but there are a lot of examples on that."}, {"owner": {"reputation": 996, "user_id": 791681, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/rGxk5.jpg?s=128&g=1", "display_name": "2by", "link": "https://stackoverflow.com/users/791681/2by"}, "edited": false, "score": 0, "creation_date": 1561966510, "post_id": 39255917, "comment_id": 100215230, "body": "@PartyHatPanda I tried a for loop after getting the last row. For some reason it did not work, it still only took the first row but now it didn\u2019t put the values in the right columns. An example would be highly appreciated"}, {"owner": {"reputation": 996, "user_id": 791681, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/rGxk5.jpg?s=128&g=1", "display_name": "2by", "link": "https://stackoverflow.com/users/791681/2by"}, "edited": false, "score": 0, "creation_date": 1561966718, "post_id": 39255917, "comment_id": 100215311, "body": "Sorry, I was looping the wrong value. Everything works - thank you"}], "tags": [], "owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "is_accepted": true, "score": 3, "last_activity_date": 1472669672, "last_edit_date": 1472669672, "creation_date": 1472665468, "answer_id": 39255917, "question_id": 39255708, "link": "https://stackoverflow.com/questions/39255708/how-do-i-match-header-in-different-sheets-and-copy-paste-the-second-row-if-there/39255917#39255917", "title": "How do I match header in different sheets and copy/paste the second row if there&#39;s a match?", "body": "<p>This will do it, assuming sheet names are <code>Sheet1</code> and <code>Sheet2</code>.</p>\n\n<pre><code>Sub colLookup()\n\nDim ShtOne As Worksheet, ShtTwo As Worksheet\nDim shtOneHead As range, shtTwoHead As range\nDim headerOne As range, headerTwo As range\n\nSet ShtOne = Sheets(\"Sheet1\")\nSet ShtTwo = Sheets(\"Sheet2\")\n\nDim lastCol As Long\n\n'get all of the headers in the first sheet, assuming in row 1\nlastCol = ShtOne.Cells(1, Columns.count).End(xlToLeft).column\nSet shtOneHead = ShtOne.range(\"A1\", ShtOne.Cells(1, lastCol))\n\n'get all of the headers in second sheet, assuming in row 1\nlastCol = ShtTwo.Cells(1, Columns.count).End(xlToLeft).column\nSet shtTwoHead = ShtTwo.range(\"A1\", ShtTwo.Cells(1, lastCol))\n\n'actually loop through and find values\nFor Each headerTwo In shtTwoHead\n    For Each headerOne In shtOneHead\n        If headerTwo.Value = headerOne.Value Then\n            headerOne.Offset(1, 0).Value = headerTwo.Offset(1, 0).Value\n        End If\n    Next headerOne\nNext headerTwo\n\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: as per discussion in comments, a copy and paste method was desired. This keeps the cells as a list drop down, although I do not think the drop down will still work. If that was not desired, it is possible to change the <code>xlPasteAll</code> to other formats, such as <code>xlPasteValues</code>. Others are listed in <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837425.aspx\" rel=\"nofollow\">Microsoft's documentation</a>.</p>\n\n<pre><code>Sub colLookup()\n\nDim ShtOne As Worksheet, ShtTwo As Worksheet\nDim shtOneHead As range, shtTwoHead As range\nDim headerOne As range, headerTwo As range\n\nSet ShtOne = Sheets(\"Sheet1\")\nSet ShtTwo = Sheets(\"Sheet2\")\n\nDim lastCol As Long\n\n'get all of the headers in the first sheet, assuming in row 1\nlastCol = ShtOne.Cells(1, Columns.count).End(xlToLeft).column\nSet shtOneHead = ShtOne.range(\"A1\", ShtOne.Cells(1, lastCol))\n\n'get all of the headers in second sheet, assuming in row 1\nlastCol = ShtTwo.Cells(1, Columns.count).End(xlToLeft).column\nSet shtTwoHead = ShtTwo.range(\"A1\", ShtTwo.Cells(1, lastCol))\n\n'actually loop through and find values\nFor Each headerTwo In shtTwoHead\n    For Each headerOne In shtOneHead\n        If headerTwo.Value = headerOne.Value Then\n            headerTwo.Offset(1, 0).Copy\n            headerOne.Offset(1, 0).PasteSpecial xlPasteAll\n            Application.CutCopyMode = False\n        End If\n    Next headerOne\nNext headerTwo\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4836370, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-HRXKb15gBjU/AAAAAAAAAAI/AAAAAAAAAHY/gjs_s4HHjms/photo.jpg?sz=128", "display_name": "Katy Torres", "link": "https://stackoverflow.com/users/4836370/katy-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4019, "favorite_count": 1, "accepted_answer_id": 39255917, "answer_count": 1, "score": 1, "last_activity_date": 1584559589, "creation_date": 1472664749, "last_edit_date": 1472665748, "question_id": 39255708, "link": "https://stackoverflow.com/questions/39255708/how-do-i-match-header-in-different-sheets-and-copy-paste-the-second-row-if-there", "title": "How do I match header in different sheets and copy/paste the second row if there&#39;s a match?", "body": "<p>I have an Excel document with two different Sheets. \nSheet 1 has many columns with header names and blank rows.\nSheet 2 has some of these columns with exact header names and an entry in the 2nd Row.</p>\n\n<p>I want to make a macro that will look through all the column headers in Sheet 2 and find their corresponding match in Sheet1. When the match is found, I need to copy the entry in Row 2 of the Sheet2 header into the matching header of sheet1. \nSome entries in Sheet1 will not have matches and will remain blank.</p>\n\n<h1>My 2 sheets currently:</h1>\n\n<h2>Sheet1</h2>\n\n<pre><code>apple   | orange | mango  | grape  | banana\n------------------------------------------\n[BLANK] |[BLANK] |[BLANK] |[BLANK] | [BLANK]  \n</code></pre>\n\n<h2>Sheet2</h2>\n\n<pre><code>orange | mango  | banana \n--------------------------\nyumm   | yuck   | maybe    \n</code></pre>\n\n<h1>What I want after Macro is run:</h1>\n\n<h2>Sheet1</h2>\n\n<pre><code>apple   | orange | mango  | grape  | banana\n------------------------------------------\n[BLANK] |yumm    |yuck    |[BLANK] | maybe  \n</code></pre>\n\n<p>I am learning VBA, about 2 weeks in. I am having trouble with getting my program to do this. I have seen similar questions but they usually match one item in one column only not multiple names in multiple columns. The codes I have tried have not done anything like what I need.</p>\n\n<p>Also, This has to be done as a macro or function since the program will be sent to a user that needs this to be already done automatically. I think that doing VLOOKUP would not work here since I will not know the number of columns in either sheet until the user enters them in which case the program will automatically populate the row 2 of the matching ones. Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472665180, "post_id": 39255577, "comment_id": 65847382, "body": "You need to add the worksheet you expect the <code>Rows.Count</code> to run on.  I assume it&#39;ll be <code>.Range(&quot;a&quot; &amp; .Rows.Count).End(xlUp)</code>.  Also, what&#39;s <code>If.Cells(c.Row,10)....</code> ? I assume a typo when pasting to SO?"}, {"owner": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472665430, "post_id": 39255577, "comment_id": 65847515, "body": "you mean to say For Each c In .Range(&quot;a2&quot;, .Range(&quot;a&quot; &amp; Rows.Count).End(xlUp)) should be .For Each c In Range(&quot;a&quot; &amp; .Rows.Count).End(xlUp) <a href=\"http://stackoverflow.com/users/6701192/partyhatpanda\">stackoverflow.com/users/6701192/partyhatpanda</a>  <a href=\"http://stackoverflow.com/users/4650297/brucewayne\">stackoverflow.com/users/4650297/brucewayne</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "edited": false, "score": 0, "creation_date": 1472666311, "post_id": 39256007, "comment_id": 65848075, "body": "thank you arun you code looks pretty good, but my number of rows gets changed in both sheets when i run daily how to make it dynamic? <a href=\"http://stackoverflow.com/users/6400030/arun-thomas\">stackoverflow.com/users/6400030/arun-thomas</a>"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "edited": false, "score": 0, "creation_date": 1472666913, "post_id": 39256007, "comment_id": 65848389, "body": "see my updated answer, this will find the number of rows of data in each sheet and analyse accordingly"}, {"owner": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "edited": false, "score": 0, "creation_date": 1472668363, "post_id": 39256007, "comment_id": 65849149, "body": "Thank you so much Thomas. I have a question is there an way in vba to pull data if last 15days from current day. Present iam using lookup function to match and deleting unmatched dates. Once again thank you for instant help. <a href=\"http://stackoverflow.com/users/6400030/arun-thomas\">stackoverflow.com/users/6400030/arun-thomas</a>"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "edited": false, "score": 0, "creation_date": 1472669388, "post_id": 39256007, "comment_id": 65849755, "body": "if you have the date to be checked in cell A1, then you could use the condition <code>If Day(Cells(1, 1).Value) &gt; Day(today) - 15 Then</code>. And it would be much appreciated if you could accept my answer if it helped and this marks the solution to others who visits"}, {"owner": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "edited": false, "score": 0, "creation_date": 1472742731, "post_id": 39256007, "comment_id": 65885027, "body": "Thomas your code is working fine for the current day date it is not deleting the row if it is = today date, and it is deleting the rows having dates before today.  My question how the macro can pull the data of last 15days from current day.<a href=\"http://stackoverflow.com/users/6400030/arun-thomas\">stackoverflow.com/users/6400030/arun-thomas</a>"}, {"owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "reply_to_user": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "edited": false, "score": 0, "creation_date": 1472799781, "post_id": 39256007, "comment_id": 65906428, "body": "use this condition <code>If Cells(1, 1).Value &gt; Now - 15 Then</code>. this will compare dates rather than the day of a date. sorry i didn&#39;t think of the month change. my mistake"}], "tags": [], "owner": {"reputation": 746, "user_id": 6400030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oyeSx.png?s=128&g=1", "display_name": "Arun Thomas", "link": "https://stackoverflow.com/users/6400030/arun-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1472666861, "last_edit_date": 1472666861, "creation_date": 1472665748, "answer_id": 39256007, "question_id": 39255577, "link": "https://stackoverflow.com/questions/39255577/excel-vba-comparing-two-sheets-based-on-unique-value/39256007#39256007", "title": "excel vba comparing two sheets based on unique value", "body": "<p>Sorry to suggest an entirely new code to you, but the below code will do the job\n[this is the way i do it, tested and working]</p>\n\n<pre><code>Sub compare10()\n\nDim found As Integer\n\nWorksheets(\"orange book data alerts\").Activate\nWith ActiveSheet\nlastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nWorksheets(\"total orange book data alerts\").Activate\nWith ActiveSheet\nlastRow2 = .Cells(.Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nWorksheets(\"orange book data alerts\").Activate\n\nFor i = 1 To lastRow\n    found = 0\n    For j = 1 To lastRow2\n        If Sheets(\"orange book data alerts\").Cells(i, 1).Value = Sheets(\"total orange book data alerts\").Cells(j, 1).Value Then\n            found = 1\n            For k = 1 To 13\n                If Sheets(\"orange book data alerts\").Cells(i, k).Value &lt;&gt; Sheets(\"total orange book data alerts\").Cells(j, k).Value Then\n                    Sheets(\"orange book data alerts\").Cells(i, 14).Value = \"Update\"\n                End If\n            Next k\n        End If\n    Next j\n    If found = 0 Then\n        Sheets(\"orange book data alerts\").Cells(i, 14).Value = \"New Addition\"\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1708, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472666861, "creation_date": 1472664318, "last_edit_date": 1472664784, "question_id": 39255577, "link": "https://stackoverflow.com/questions/39255577/excel-vba-comparing-two-sheets-based-on-unique-value", "title": "excel vba comparing two sheets based on unique value", "body": "<p>I have 2 sheets named orange book data alerts and total orange book data alerts , both sheets have data from A to M, unique value is in Column A in both the sheets. here I compare orange book data alerts with total orange book data alerts. When there is a match, compare its row cell values for each and every column and if there is difference the code should be written as Update in sheet orange book data alerts column N and if the unique value is not available it should write New addition in column N.. Below is code which i tried. it is working for if there is any update in data for one column, i need help so that i can compare all the columns and write as new addition if unique value is not present.</p>\n\n<pre><code>Sub compare10() \nDim w1 As Worksheet, w2 As Worksheet \nDim c As Range, a As Range \n\n\nSet w1 = Sheets(\"total orange book data\") \nSet w2 = Sheets(\"orange book data alerts\") \nWith w1 \n    For Each c In .Range(\"a2\", .Range(\"a\" &amp; Rows.Count).End(xlUp)) \n        Set a = w2.Columns(1).Find(c.Value, lookat:=xlWhole) \n        If Not a is nothing then\n            if.cells(c.row,10).value&lt;&gt;w2.cells(a.row(a.row,10) then\n\n            w2.Cells(a.Row, 14).Value = \"update\" \n        End If \n    Next c \nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472665939, "post_id": 39255300, "comment_id": 65847845, "body": "see my answer below (if I understood your post - to find the count of series in an Excel Sheet Clustered Column Chart)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 1977980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f390e745ecd39d670121f722a2529a08?s=128&d=identicon&r=PG", "display_name": "Siva Kumar", "link": "https://stackoverflow.com/users/1977980/siva-kumar"}, "edited": false, "score": 0, "creation_date": 1472718535, "post_id": 39256040, "comment_id": 65867570, "body": "Thanks Shai.  it works in Excel.  I am struggling to find it in Powerpoint charts"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 21, "user_id": 1977980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f390e745ecd39d670121f722a2529a08?s=128&d=identicon&r=PG", "display_name": "Siva Kumar", "link": "https://stackoverflow.com/users/1977980/siva-kumar"}, "edited": false, "score": 0, "creation_date": 1472719518, "post_id": 39256040, "comment_id": 65868196, "body": "@SivaKumar please mark as answer, if you need anything else, open a new post with your needs"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1472665888, "creation_date": 1472665888, "answer_id": 39256040, "question_id": 39255300, "link": "https://stackoverflow.com/questions/39255300/trying-to-find-the-number-of-chart-series-collection-in-powerpoint-using-vba/39256040#39256040", "title": "Trying to find the number of chart series collection in powerpoint using vba", "body": "<p>To get the number of Series collection in a Clustered Column Chart in an Excel sheet, use the code below :</p>\n\n<pre><code>Option Explicit\n\nSub FindLastSeries_inChart()\n\nDim cht                     As ChartObject\nDim Series_counter          As Integer    \n\n' modify \"Sheet 1\" Name to your needed Sheet, and \"Chart 1\" to your chart's name\nSet cht = Sheets(\"Sheet1\").ChartObjects(\"Chart 1\")    \n\nSeries_counter = cht.Chart.SeriesCollection.Count\n\nMsgBox \"Series count in Chart is \" &amp; Series_counter    \n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 6825240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5665e08c4eed9a29a4db2a1f3e1d36df?s=128&d=identicon&r=PG", "display_name": "John Wilson", "link": "https://stackoverflow.com/users/6825240/john-wilson"}, "is_accepted": true, "score": 1, "last_activity_date": 1473748517, "creation_date": 1473748517, "answer_id": 39463598, "question_id": 39255300, "link": "https://stackoverflow.com/questions/39255300/trying-to-find-the-number-of-chart-series-collection-in-powerpoint-using-vba/39463598#39463598", "title": "Trying to find the number of chart series collection in powerpoint using vba", "body": "<p>Try</p>\n\n<pre><code>Sub seriescounter()\n   Dim osld As Slide\n   Dim oshp As Shape\n   Set osld = ActivePresentation.Slides(3)      'or whatever index\n   For Each oshp In osld.Shapes\n      If oshp.HasChart Then\n         If oshp.Chart.ChartType = xlColumnClustered Then MsgBox oshp.Chart.SeriesCollection.Count\n      End If\n   Next oshp\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 1977980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f390e745ecd39d670121f722a2529a08?s=128&d=identicon&r=PG", "display_name": "Siva Kumar", "link": "https://stackoverflow.com/users/1977980/siva-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "accepted_answer_id": 39463598, "answer_count": 2, "score": 0, "last_activity_date": 1593700506, "creation_date": 1472663268, "last_edit_date": 1593700506, "question_id": 39255300, "link": "https://stackoverflow.com/questions/39255300/trying-to-find-the-number-of-chart-series-collection-in-powerpoint-using-vba", "title": "Trying to find the number of chart series collection in powerpoint using vba", "body": "<p>I am trying to find the last series collection index number in the clustered column chart using vba macro.  eg. If I have to find the number of slide</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub GettingLastSlideNumber()\r\n\r\n  With ActivePresentation\r\n    MsgBox .Slides(.Slides.Count).SlideNumber\r\n  End With\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>in the similar way, I am trying to find the clustered column charts Last series number.</p>\n\n<p>Could someone please assist me on this.</p>\n"}, {"tags": ["sql", "vba", "ms-access-2003"], "comments": [{"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "edited": false, "score": 0, "creation_date": 1472666665, "post_id": 39254821, "comment_id": 65848254, "body": "IIF() would be correct you are just doing it in the wrong place/order.  The if statement would be used in the WHERE condition of your select not before.  But for that matter you could test it in VBA before calling the sql too.  honestly the code you posted is too jumbled/poorly formated for me to want to try and decode it more but I can see this is at least 1 of your problems"}, {"owner": {"reputation": 1, "user_id": 3907308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTGX0.png?s=128&g=1", "display_name": "troubbble", "link": "https://stackoverflow.com/users/3907308/troubbble"}, "reply_to_user": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "edited": false, "score": 0, "creation_date": 1472677997, "post_id": 39254821, "comment_id": 65854193, "body": "@Matt How do I address that the <code>FROM</code> changes depending on the outcome of the <code>IIf</code> if the <code>FROM</code> happens before it?  Apologies for the mess. As I said, I don&#39;t know the language. Would it be better if I used generic field and table names? When I look up syntax for each function the examples are very simple and I don&#39;t know how to adjust the formatting, not knowing the general SQL approach."}, {"owner": {"reputation": 12208, "user_id": 5510627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8210c2e2a5900d874c81a557c0f9f789?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5510627/matt"}, "edited": false, "score": 0, "creation_date": 1472683150, "post_id": 39254821, "comment_id": 65856125, "body": "honestly you should probably test the value and use a VBA if then logic to set the query string and then pass the desired string.  You can do it in sql but you would want to left join your optional table and then use an IF() statement in the JOIN as well as the WHERE to account for when the condition is or is not met."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3907308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTGX0.png?s=128&g=1", "display_name": "troubbble", "link": "https://stackoverflow.com/users/3907308/troubbble"}, "edited": false, "score": 0, "creation_date": 1473176971, "post_id": 39274503, "comment_id": 66036012, "body": "Thank you for your response. When I use this, I get prompted for values for sq.column1 and sq.column2, and I am not shown any values in the final list, regardless of my selection in the control box. Do I need to store something as &quot;sq&quot; before referencing it? I&#39;m also having syntax problems w Also, this solution doesn&#39;t address the total problem - I&#39;m trying to get the full set of options when a match isn&#39;t found between the selection in the box and table 3, not just when the control box is empty."}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "reply_to_user": {"reputation": 1, "user_id": 3907308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTGX0.png?s=128&g=1", "display_name": "troubbble", "link": "https://stackoverflow.com/users/3907308/troubbble"}, "edited": false, "score": 0, "creation_date": 1473177628, "post_id": 39274503, "comment_id": 66036425, "body": "Regarding the &#39;sq&#39; problem, that&#39;s a problem with Access not properly processing SQL aliases, which surprises me but is rectified by changing the code to not use the aliases.  I think I can get it to return on non-match by adding <code>OR table3.column1 != [Crt1 input]</code>.  I&#39;ll edit my answer to cover these changes."}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "reply_to_user": {"reputation": 1, "user_id": 3907308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTGX0.png?s=128&g=1", "display_name": "troubbble", "link": "https://stackoverflow.com/users/3907308/troubbble"}, "edited": false, "score": 0, "creation_date": 1473178834, "post_id": 39274503, "comment_id": 66037093, "body": "Scratch that, the <code>OR table3.column1 != [Ctrl1 input]</code> is going to return everything no matter what the input has in it (if Access would run the syntax at all).  If you do need it to show everything when there&#39;s no match, you probably do need <code>IIF</code> and VBA, if it&#39;s possible at all.  I don&#39;t know how to do that.  I&#39;d advise a design change; have it throw an error if there&#39;s no match indicating the process needs a valid value or null."}, {"owner": {"reputation": 1, "user_id": 3907308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTGX0.png?s=128&g=1", "display_name": "troubbble", "link": "https://stackoverflow.com/users/3907308/troubbble"}, "edited": false, "score": 0, "creation_date": 1473183739, "post_id": 39274503, "comment_id": 66039748, "body": "Thanks. For the time being I&#39;ve just hard-coded the exceptions into the <code>OR</code> since there are relatively few of them. Not ideal, but I needed to get that whole list even when there weren&#39;t matches. Thanks. (I would add that the first <code>SELECT</code> above appears to be redundant. This is the same as my initial query with the addition of <code>OR [crtl1 input] is null</code>.)"}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "reply_to_user": {"reputation": 1, "user_id": 3907308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTGX0.png?s=128&g=1", "display_name": "troubbble", "link": "https://stackoverflow.com/users/3907308/troubbble"}, "edited": false, "score": 0, "creation_date": 1473186774, "post_id": 39274503, "comment_id": 66041198, "body": "Yes, it is the same with the <code>OR</code> statement added, that&#39;s the idea; do the same thing your statement does, or instead return everything."}], "tags": [], "owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "is_accepted": false, "score": 1, "last_activity_date": 1473178485, "last_edit_date": 1473178485, "creation_date": 1472740751, "answer_id": 39274503, "question_id": 39254821, "link": "https://stackoverflow.com/questions/39254821/how-to-return-all-records-only-if-join-in-select-returns-null-set/39274503#39274503", "title": "How to return all records only if join in SELECT returns null set", "body": "<p>There's a way to have Access not filter something if a control is empty (or no match is found) that doesn't need <code>IIF</code> or VBA.  You need to tell Access that if the input is null to just return everything.  Your query at the top would look like this.</p>\n\n<pre><code>SELECT table1.column1, table1.column2\n    FROM \n        (SELECT table1.column1, table1.column2\n        FROM table1 \n        INNER JOIN table2 \n        ON table1.column2 = table2.column1)\nINNER JOIN table3 \nON table1.column2 = table3.column3\n    WHERE table3.column1 = [Ctrl1 input]\n    OR [Ctrl1 input] is null\nORDER BY table1.column2;\n</code></pre>\n\n<p>The <code>OR</code> line is what tells Access \"You know what, just give me the whole table if I didn't tell you what to do\".  It shouldn't matter how your list box gets populated, this code only cares about what is in the list box, not how it got there. Code like this can just go in the SQL view of an Access query.</p>\n"}], "owner": {"reputation": 1, "user_id": 3907308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OTGX0.png?s=128&g=1", "display_name": "troubbble", "link": "https://stackoverflow.com/users/3907308/troubbble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473178485, "creation_date": 1472661429, "last_edit_date": 1472678441, "question_id": 39254821, "link": "https://stackoverflow.com/questions/39254821/how-to-return-all-records-only-if-join-in-select-returns-null-set", "title": "How to return all records only if join in SELECT returns null set", "body": "<p>I have a list box in a form that is populated by a select query based on another control (ctrl1) in the same form. It is triggered on update of ctrl1:</p>\n\n<pre><code>PARAMETERS [Ctrl1 input] Long;\nSELECT table1.column1, table1.column2\nFROM (table1 INNER JOIN table2 ON table1.column2 = table2.column1) INNER JOIN table3 ON table2.column2 = table3.column3\nWHERE (((table3.column1)=[Ctrl1 input]))\nORDER BY table1.column2;\n</code></pre>\n\n<p>This works on the basis of the form parameter matching a value in <code>table3.column1</code> that ALSO has a value in the <code>table3.column3</code> field. Right now, if the selection on the form does not have a matching value in <code>table3.column3</code> the list box remains empty. In this situation, I would instead like to return the full list of <code>SELECT table1.column1, table1.column2</code> without all the joins and constraints. (The list is very long, so I would only like to use the entire thing when absolutely necessary.)</p>\n\n<p>In SQL, it appears that a <code>case</code> function would accomplish what I want, something similar to this:</p>\n\n<pre><code>PARAMETERS [Ctrl1 input] Long;\nCASE WHEN  (SELECT table3.column3 WHERE (table3.column2 = [Ctrl1 Input]) IS NOT NULL)\n    THEN \n        SELECT table1.column1, table1.column2\n        FROM (table1 INNER JOIN table2 ON table1.column2 = table2.column1) INNER JOIN table3 ON table2.column2 = table3.column3\n    ELSE \n        SELECT table1.column1, table1.column2\n</code></pre>\n\n<p>But I'm not able to use <code>case</code> in an Access query.</p>\n\n<p>An <code>IIf</code> statement seems like it would also work, </p>\n\n<pre><code>PARAMETERS [Ctrl1 input] Long;\nIIf(\n    (SELECT  table3.column3 WHERE (table3.column1 = [Ctrl1 input]) IS NOT NULL),\n    (SELECT table1.column1, table1.column2 FROM (table1 INNER JOIN table2 ON table1.column2 = table2.column1) INNER JOIN table3 ON table2.column2 = table3.column3),\n    (SELECT table1.column1, table1.column2)\n    )\n</code></pre>\n\n<p>but Access won't accept that, saying that it expects a <code>SELECT</code>, <code>INSERT</code>, <code>DELETE</code>, etc. Also, testing a <code>SELECT IIf</code>, I get something saying that it can only return one value, so that doesn't work for me.</p>\n\n<p>SO, I've seen articles for using both <code>case</code> and <code>IIf</code> in VBA and then using THAT in a query, but I haven't been able to find a clear enough example to understand how I would convert my own situation into a module and then call it. I do not work with VBA, and barely work with SQL. Before delving into VBA I'd like to know:</p>\n\n<ol>\n<li>Will I be able to accomplish what I'd like with VBA?</li>\n<li>Is there a argument for the <code>case</code>, <code>IIf</code>, or other approach?</li>\n<li>In the function, what do I pass as the value? The data from ctrl1 on the form?</li>\n<li>What do I ask the function to return, and how? Is this accomplished by setting <code>myfunction = the code that produces the dataset I need</code> within the function itself?</li>\n</ol>\n\n<p>I think I understand how to use the function in the query, so long as I understand the output type from the function. </p>\n\n<p>Thanks in advance for any insight and information.</p>\n\n<p><em>Note: I'm using Access 2016 but the file itself is 2002-2003 format because that's apparently what's compatible with our GIS software.</em></p>\n"}, {"tags": ["image", "vba", "excel", "userform"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472662107, "post_id": 39254685, "comment_id": 65845713, "body": "In programming, &quot;it throws an error&quot; is not a very useful problem description.  <i>What error</i> is raised, and on which line of your code?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1472662163, "post_id": 39254685, "comment_id": 65845742, "body": "You already have the image file path and name (from user input), why not use <code>ThisWorkbook.Worksheets(3).Pictures.Insert(&quot;File Path Here&quot;)</code>?"}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1496246686, "post_id": 39254685, "comment_id": 75585893, "body": "did you consider using <code>SavePicture Me.ControlName.Picture, Filename </code> , and then <code>activesheet.pictures.insert(filename)</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9385320, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1ac914a2a5c7f3df03fbe1fc584d6879?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/9385320/miguel"}, "is_accepted": false, "score": -1, "last_activity_date": 1519130530, "last_edit_date": 1519130530, "creation_date": 1519125366, "answer_id": 48884042, "question_id": 39254685, "link": "https://stackoverflow.com/questions/39254685/adding-image-to-a-worksheet-from-a-userform-excel-vba/48884042#48884042", "title": "Adding image to a worksheet from a userform (excel vba)", "body": "<p>It's simple</p>\n\n<p>just adds a TextBox (can be invisible in userform)</p>\n\n<pre><code>Private Sub BrowseButton_Click()\n\nDim strFileName As String\n\nuse GetOpenFilename Method to select picture\nstrFileName = Application.GetOpenFilename(filefilter:=\"Tiff Files(*.tif;*.tiff),*.tif;*.tiff,JPEG Files (*.jpg;*.jpeg;*.jfif;*.jpe),*.jpg;*.jpeg;*.jfif;*.jpe,Bitmap Files(*.bmp),*.bmp\", FilterIndex:=2, Title:=\"Select a File\", MultiSelect:=False)\n\nTextBox1 = strFileName  'use to save URL or Link from picture\n\nIf strFileName = \"False\" Then\n    MsgBox \"File Not Selected!\"\n    Else\n    'load picture to Image control, using LoadPicture property\n    Me.Image1.Picture = LoadPicture(strFileName)\n    'after any change vba has to be told to refresh the UserForm for the change to appear\n    Me.Repaint\n    'label caption changes after picture is loaded\n    Me.Label1.Caption = \"Logo loaded\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 2183786, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/36e2751c8af5977fc1cfe24ced9413e1?s=128&d=identicon&r=PG", "display_name": "James Baker", "link": "https://stackoverflow.com/users/2183786/james-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7096, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519130530, "creation_date": 1472660907, "question_id": 39254685, "link": "https://stackoverflow.com/questions/39254685/adding-image-to-a-worksheet-from-a-userform-excel-vba", "title": "Adding image to a worksheet from a userform (excel vba)", "body": "<p>I have a userform with a browse button that allows users to search through their drive and select a picture (for example a logo):</p>\n\n<pre><code>Private Sub BrowseButton_Click()\n\nDim strFileName As String\n\n'use GetOpenFilename Method to select picture\nstrFileName = Application.GetOpenFilename(filefilter:=\"Tiff Files(*.tif;*.tiff),*.tif;*.tiff,JPEG Files (*.jpg;*.jpeg;*.jfif;*.jpe),*.jpg;*.jpeg;*.jfif;*.jpe,Bitmap Files(*.bmp),*.bmp\", FilterIndex:=2, Title:=\"Select a File\", MultiSelect:=False)\n\nIf strFileName = \"False\" Then\n    MsgBox \"File Not Selected!\"\n    Else\n    'load picture to Image control, using LoadPicture property\n    Me.Image1.Picture = LoadPicture(strFileName)\n    'after any change vba has to be told to refresh the UserForm for the change to appear\n    Me.Repaint\n    'label caption changes after picture is loaded\n    Me.Label1.Caption = \"Logo loaded\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The selected picture is stored in an image box on the userform. I have a submit button that, when selected, I wish to get the \"picture\" that the user selected from the image box and insert it in a specific location on a sheet. This is what I have so far:</p>\n\n<pre><code>Sub Image9_Click()\n\n'' Submit Button\n\nDim sld As Worksheet\nSet sld = Sheets(\"Sliders\")\n\nDim logo As Image\nlogo = colourForm.Image1\n\nCall updateAllColScheme ''Ignore this\n\ncolourForm.Hide\n\nEnd Sub\n</code></pre>\n\n<p>This doesn't work at all as it throws an error, does anyone know if this can be done?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1472661009, "post_id": 39254661, "comment_id": 65845150, "body": "Select case is used to test the one value in this case <code>TemplatePick</code> then the Case would be <code>Case &quot;A&quot;</code> which would fire when <code>TemplatePick</code> = &quot;A&quot;"}, {"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1472661124, "post_id": 39254661, "comment_id": 65845215, "body": "Your test case (TemplatePick) doesn&#39;t match your conditions (after case statements). Learn more <a href=\"https://www.techonthenet.com/excel/formulas/case.php\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1472661444, "post_id": 39254661, "comment_id": 65845383, "body": "If you&#39;re trying to implement possibly multiple conditional statements, you&#39;ll need <code>If</code> statements instead of a <code>Case</code> switch."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1472662251, "post_id": 39254661, "comment_id": 65845798, "body": "What do you mean by &quot;not working&quot;? Can you describe what you think should be happening?"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1472661600, "post_id": 39254772, "comment_id": 65845469, "body": "<code>Select Case True</code> ??"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1472661738, "post_id": 39254772, "comment_id": 65845526, "body": "@DavidZemens Yup, it basically turns the case statements into <code>ELSEIF</code> statements."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1472662329, "post_id": 39254772, "comment_id": 65845827, "body": "Interesting... so it will continue processing on <code>False</code> cases until it hits the first <code>True</code> case."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1472662465, "post_id": 39254772, "comment_id": 65845891, "body": "@DavidZemens Yes, just like ElseIf.  It will test in order then stop as soon as one is true.  This is standard for Select Case in general.  As soon as one resolves as true it stops searching."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1472662539, "post_id": 39254772, "comment_id": 65845946, "body": "Neat. I&#39;ve never used it this way before :)"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1472661232, "creation_date": 1472661232, "answer_id": 39254772, "question_id": 39254661, "link": "https://stackoverflow.com/questions/39254661/case-statement-in-vba/39254772#39254772", "title": "Case Statement in VBA", "body": "<p>Select case is used to test the one value in this case <code>TemplatePick</code> then the Case would be <code>Case \"A\"</code> which would fire when <code>TemplatePick</code> = \"A\"</p>\n\n<p>So for this to work:</p>\n\n<pre><code>Select Case True\n\nCase OptCreate.Value\nCall WebFormInfo\n\nCase OptModify \nCall ModifyTemplate\n\n' many more case statement to come \nEnd Select\n</code></pre>\n\n<p>Now one caveat with Select Case, once it finds a match it ignores all others.  In other words if <code>OptCreate.Value</code> is True then it will stop and not test whether <code>OptModify</code> is True.</p>\n"}, {"tags": [], "owner": {"reputation": 8784, "user_id": 116830, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a8105cf7a85838072d606d4230cdd6?s=128&d=identicon&r=PG", "display_name": "Gratzy", "link": "https://stackoverflow.com/users/116830/gratzy"}, "is_accepted": false, "score": 3, "last_activity_date": 1472661265, "creation_date": 1472661265, "answer_id": 39254781, "question_id": 39254661, "link": "https://stackoverflow.com/questions/39254661/case-statement-in-vba/39254781#39254781", "title": "Case Statement in VBA", "body": "<p>Your case test expression (TemplatePick) is not the same as your expresion list (OptCreate.Value, OptMOdify). I have a hard time even understanding what your are trying to do. Properly structured it would look something like this:</p>\n\n<pre><code>Dim TemplatePick As String\n\nSelect Case TemplatePick\n\nCase \"Template 1\"\n Call WebFormInfo\nCase \"Template 2\"\n Call ModifyTemplate\n...\ncase Else\n  'Do default behavior\nEnd Select\n</code></pre>\n\n<p>More resources <a href=\"https://msdn.microsoft.com/en-us/library/cy37t14y.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/cy37t14y.aspx</a></p>\n"}], "owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2098, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1472661265, "creation_date": 1472660840, "last_edit_date": 1531161705, "question_id": 39254661, "link": "https://stackoverflow.com/questions/39254661/case-statement-in-vba", "title": "Case Statement in VBA", "body": "<p>Case statement below is not working when the condition met. </p>\n\n<pre><code>Dim TemplatePick As String\n\nSelect Case TemplatePick\n\nCase OptCreate.Value = True\nCall WebFormInfo\n\nCase OptModify = True\nCall ModifyTemplate\n\n' many more case statement to come \nEnd Select\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "ms-access", "ado"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472660384, "post_id": 39254375, "comment_id": 65844810, "body": "It might be helpful to see how the connection is setup, can you post that? Also can you see the field values in the Locals Window prior to iterating over the recordset?"}, {"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1472662494, "post_id": 39254375, "comment_id": 65845909, "body": "When you say stored procedure, do you mean that you&#39;ve set up a query in Access? Have you tried using the SQL statement in the &#39;procedure&#39; directly from Excel to get the recordset?"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1472665020, "post_id": 39254375, "comment_id": 65847294, "body": "@jhTuppeny Yes, It is a query in Access. I just tried Set RS = Database.Execute(&quot;The entire SQL string&quot;). It successfully gave me the recordset, only now even the first three fields that moved fast before are moving at the same slow rate as the last 10..."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1472665835, "post_id": 39254375, "comment_id": 65847776, "body": "Can you post the full Access SQL query as it can surely be optimized from running 9 separate subqueries?"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1472671095, "post_id": 39254375, "comment_id": 65850762, "body": "Unfortunately, I can&#39;t post the full query. I can&#39;t clean it up enough to remove proprietary info, and it is quite long anyway. The query works, and it only takes about 20 seconds to get all the data in a datasheet view in Access. I just don&#39;t understand why even when I use something like RS.GetRows it still takes so long. I was under the impression GetRows got the data and put it into an array, but that isn&#39;t working well for me either..."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1472673517, "post_id": 39254375, "comment_id": 65851984, "body": "@Parfait I did however edit the question to show a sample data table to illustrate the concept the query performs."}, {"owner": {"reputation": 5439, "user_id": 1736047, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GY4YE.jpg?s=128&g=1", "display_name": "STLDev", "link": "https://stackoverflow.com/users/1736047/stldev"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1472673781, "post_id": 39254375, "comment_id": 65852133, "body": "I agree with @Parfait.  Please post the entire query.  Just genericize the column names."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 5439, "user_id": 1736047, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GY4YE.jpg?s=128&g=1", "display_name": "STLDev", "link": "https://stackoverflow.com/users/1736047/stldev"}, "edited": false, "score": 0, "creation_date": 1472674190, "post_id": 39254375, "comment_id": 65852354, "body": "@STLDeveloper Ok, I generalized it and made an edit to the question."}, {"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1472719613, "post_id": 39254375, "comment_id": 65868264, "body": "I suggest you try different methods of opening the recordset - try Dim rst as New ADODB.Recordset  and then rst.open sql, connection, type, locking. This might help in itself and it will give you some other settings to adjust."}], "answers": [{"comments": [{"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1473183480, "post_id": 39336069, "comment_id": 66039588, "body": "Outstanding, thank you very much! This has completely solved my problem. A much faster processing solution indeed."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1473100698, "creation_date": 1473100698, "answer_id": 39336069, "question_id": 39254375, "link": "https://stackoverflow.com/questions/39254375/ado-recordset-batch-retrievals-running-excessively-slowly/39336069#39336069", "title": "ADO RecordSet Batch Retrievals Running Excessively Slowly", "body": "<p>From your current sample data and desired results, you can certainly optimize the query. Right now, you run 9 separate subqueries to retrieve non-null values from each respective column. Simply, run an aggregate query using <code>MAX()</code> on columns, 3 - 13, grouped on first two columns: </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT Col1, Col2, Max(Col3) As C3,  Max(Col4) As C4,  Max(Col5) As C5, ...\n       Max(Col13) As C13\nFROM t1\nGROUP BY Col1, Col2\n</code></pre>\n"}], "owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 39336069, "answer_count": 1, "score": 0, "last_activity_date": 1473100698, "creation_date": 1472659798, "last_edit_date": 1472753373, "question_id": 39254375, "link": "https://stackoverflow.com/questions/39254375/ado-recordset-batch-retrievals-running-excessively-slowly", "title": "ADO RecordSet Batch Retrievals Running Excessively Slowly", "body": "<p>I am using Excel-VBA to connect with ADO to an MS-Access database. It is executing a stored procedure I have in the Access database. There are about 900 records being returned with 13 fields. I am using the following VBA code:</p>\n\n<pre><code>Dim RS As ADODB.Recordset\n\nCall OpenDatabase 'Subroutine that opens an ADO connection: DatabaseName\n\nSet RS = DatabaseName.Execute(\"SELECT * FROM My_Procedure\")  'This DOES return a recordset\n\nDo While Not RS.EOF\n    Debug.Print RS(0) \n    RS.MoveNext\nLoop\n\nCall CloseDatabase 'Another sub\n</code></pre>\n\n<p>The database connection is made here:</p>\n\n<pre><code>Sub OpenDatabase\n\n    Dim ConnString as String\n    Set DB = New ADODB.Connection\n\n    ConnString = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; My_DB_Path &amp; \"; Persist Security Info=False;\"\n    With DB\n        .ConnectionString = ConnString\n        .ConnectionTimeout = 10\n        .Open\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Here is the query with names generalized:</p>\n\n<pre><code>SELECT Col1, Col2, Col3,\n(SELECT Col4 FROM t2 where t2.Col1 = t1.Col1 AND t2.Col2 = t1.Col2 and Col4 IS NOT NULL) As Col4,\n(SELECT Col5 FROM t2 where t2.Col1 = t1.Col1 AND t2.Col2 = t1.Col2 and Col5 IS NOT NULL) As Col5,\n... (Same through Col13)\nFROM t1\n</code></pre>\n\n<p>Within the stored procedure, fields 1, 2, and 3 are all very simple and everything moves zippy fast. However, fields #4-13 are unfortunately all more complicated select statements and this seems to be part of the problem</p>\n\n<p>This was not exactly a preferable way to do it, but within the limits of MS-Access, this is what I had to do to get the data formatted in the way I need to present it. </p>\n\n<p>When I run this procedure in Access, it takes maybe 15-20 seconds to calculate and display everything in the DataSheet view. When I run the VBA code above, the Do loop takes about .45 seconds to print all 900 rows of RS(0,1,2), but with Debug.Print RS(3->12), it takes more than 280 seconds per field. I suspect that it is recalculating all these embedded subqueries every time I ask for it in VBA, but I do not know why.</p>\n\n<p>Ideally, I want Access to run the procedure and generate the results, and I just pull each record into a VBA variable for further processing. Any ideas of how to speed this retrieval process up?</p>\n\n<p><strong>EDIT TO ADD SAMPLE DATA:</strong></p>\n\n<p>This is a generalized sample of the data the query is operating on and what it is supposed to look like when done. Input is like:</p>\n\n<pre><code>Col1|Col2|Col3|Col4|Col5|...\nA   |01  |X   |    |\nA   |01  |    |Y   |\nA   |02  |X   |    |\nA   |02  |    |Y   |\nB   |01  |    |X   |\nB   |02  |    |X   |\nB   |02  |Y   |    |\nB   |02  |    |    |Z\n</code></pre>\n\n<p>Output is like:</p>\n\n<pre><code>Col1|Col2|Col3|Col4|Col5|...\nA   |01  |X   |Y   |\nA   |02  |X   |Y   |\nB   |01  |    |X   |\nB   |02  |Y   |X   |Z\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "runtime-error", "report", "ms-access-2007"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1472698372, "post_id": 39254313, "comment_id": 65859726, "body": "Your output path should be the fullpath for the file being created - including &quot;.pdf&quot; file extension. You should also add error trapping in case the report is empty (no records) or file already exists - and you get a proper error message returned."}, {"owner": {"reputation": 11, "user_id": 6779636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40b915b3fffc88719e7f35178fac3eb1?s=128&d=identicon&r=PG&f=1", "display_name": "MPoole", "link": "https://stackoverflow.com/users/6779636/mpoole"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1472821571, "post_id": 39254313, "comment_id": 65919982, "body": "Thank you, @dbmitch!  I modified the file path and added the code to trap the error.  It runs perfectly now.  I sitll don&#39;t know what could be causing the error, but as long as my report saves properly and I don&#39;t have my DB users receiving an error (especially when they have that little Debug option and they are curious) it&#39;s not really an issue."}], "owner": {"reputation": 11, "user_id": 6779636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40b915b3fffc88719e7f35178fac3eb1?s=128&d=identicon&r=PG&f=1", "display_name": "MPoole", "link": "https://stackoverflow.com/users/6779636/mpoole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 717, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1594641474, "creation_date": 1472659566, "last_edit_date": 1594641474, "question_id": 39254313, "link": "https://stackoverflow.com/questions/39254313/why-am-i-receiving-run-time-error-2147024809-80070057-in-access", "title": "Why am I receiving run-time error 2147024809 (80070057) in Access?", "body": "<p>When I attempt to save a report as a .pdf (through a form) I receive a run-time error and I have no idea what to do to the code to fix it.  It does save the report even though I get the error, but it saves it as a File file type instead of .pdf.  This is the current code:</p>\n\n<pre><code>Private Sub cmdPDF_Click()\n\nDoCmd.OutputTo acOutputReport, \"rptPDFAllClasses\", acFormatPDF, \"rptPDFAllClasses\", True\n\nMe.Visible = False\n\nEnd Sub\n</code></pre>\n\n<p>When I select debug the Me.Visible = False is highlighted. I am very new to VBA so I apologize for my (surely) obvious ignorance.</p>\n"}, {"tags": ["ms-access", "printing", "vba", "report"], "comments": [{"owner": {"reputation": 49, "user_id": 6684284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-GZQx352Gvhs/AAAAAAAAAAI/AAAAAAABOso/d_sFkyeaHkY/photo.jpg?sz=128", "display_name": "Arne Clicteur", "link": "https://stackoverflow.com/users/6684284/arne-clicteur"}, "edited": false, "score": 0, "creation_date": 1472659848, "post_id": 39253917, "comment_id": 65844567, "body": "I also tried the approach <a href=\"http://windowssecrets.com/forums/showthread.php/93448-Adding-extra-lines-at-end-of-Access-report-(Access-2003)\" rel=\"nofollow noreferrer\">here</a>, but I get the same problem."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472660849, "post_id": 39253917, "comment_id": 65845068, "body": "Hey there, can you put a debug.print &quot;I&#39;m going here&quot; at the top of the <code>Details_Format</code> sub and try the print action again? It seems like this sub isn&#39;t being called when a print action is called, only when the Open event fires. You may need to call the <code>Details_Format</code> sub manually in the Sub where you are printing."}, {"owner": {"reputation": 49, "user_id": 6684284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-GZQx352Gvhs/AAAAAAAAAAI/AAAAAAABOso/d_sFkyeaHkY/photo.jpg?sz=128", "display_name": "Arne Clicteur", "link": "https://stackoverflow.com/users/6684284/arne-clicteur"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472713713, "post_id": 39253917, "comment_id": 65864698, "body": "I tried your suggestion. The changes I made to reset iLine in the report_open don&#39;t fire when I try to save it as PDF. Is there a sub I can call to determine a new generation of the report on printing or exporting?"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 6684284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-GZQx352Gvhs/AAAAAAAAAAI/AAAAAAABOso/d_sFkyeaHkY/photo.jpg?sz=128", "display_name": "Arne Clicteur", "link": "https://stackoverflow.com/users/6684284/arne-clicteur"}, "is_accepted": true, "score": 0, "last_activity_date": 1472716590, "last_edit_date": 1472716590, "creation_date": 1472714383, "answer_id": 39265094, "question_id": 39253917, "link": "https://stackoverflow.com/questions/39253917/access-report-printout-or-pdf-is-missing-information-visible-on-print-preview/39265094#39265094", "title": "Access report printout (or PDF) is missing information visible on print preview", "body": "<p>Found the solution. Had to call the <code>pageHeaderSection_Print</code> sub\n to reset the iLine variable when the report is formatted for printing, now everything is working as I wanted.</p>\n"}], "owner": {"reputation": 49, "user_id": 6684284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-GZQx352Gvhs/AAAAAAAAAAI/AAAAAAABOso/d_sFkyeaHkY/photo.jpg?sz=128", "display_name": "Arne Clicteur", "link": "https://stackoverflow.com/users/6684284/arne-clicteur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 0, "accepted_answer_id": 39265094, "answer_count": 1, "score": 0, "last_activity_date": 1472716590, "creation_date": 1472658330, "question_id": 39253917, "link": "https://stackoverflow.com/questions/39253917/access-report-printout-or-pdf-is-missing-information-visible-on-print-preview", "title": "Access report printout (or PDF) is missing information visible on print preview", "body": "<p>I added VBA to my report to include blank rows in the invoice, got this code from <a href=\"http://vb123.com.au/200310_dl_pad.htm\" rel=\"nofollow noreferrer\">here</a>. The print preview is showing me the blank rows I want, but when I want to export it to PDF or print the report, it shows me invisible text (instead of only in the blank rows). I edited the original code to reset the incremental numbering, but this only works when switching from report view to print preview (the problem was originaly here also, I figured when printing or exporting it would also requery the report and hence the problem would be solved, but to no avail).</p>\n\n<p>This is the code that gives me the blank rows:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nConst iLines As Integer = 15\nPrivate iTotal As Integer\n\n      ' code added to make count able to reset on report load\n      Private iLine As Integer\n\nPrivate Sub Report_Open(Cancel As Integer)\n  ' get total record count\n  iTotal = DCount(\"*\", \"OrderLine\", \"fkOrderID = \" &amp; TempVars!tempOrderID)\n\n        ' code added to reset count\n        iLine = 0\n\nEnd Sub\nPrivate Sub Details_Format(Cancel As Integer, _\n                           FormatCount As Integer)\n\n        ' code added to reset visibility\n        Me!Item.Visible = True\n        Me!qty.Visible = True\n        Me!CalcPrijs.Visible = True\n        Me!TotPrijs.Visible = True\n\n  ' increment iLine on each detail format\n  iLine = iLine + 1\n  If iLine &lt; iTotal Then\n    ' do nothing ... print as usual\n  ElseIf iLine = iTotal Then\n    ' if there are more lines to print, set the\n    ' NextRecord property to false, preventing\n    ' the report from exiting prematurely\n    If iLine &lt; iLines Then Me.NextRecord = False\n  Else\n    ' changed this to make text invisible instead of white\n    Me!Item.Visible = False\n    Me!qty.Visible = False\n    Me!CalcPrijs.Visible = False\n    Me!TotPrijs.Visible = False\n    ' prevent report from advancing past last row\n    ' until all of blank lines has have printed\n    If iLine &lt; iLines Then Me.NextRecord = False\n  End If\nEnd Sub\n</code></pre>\n\n<p>Am I missing something here? I was hoping a good looking print preview would give me a good looking printout. Is there a way I can get the extra blank rows without losing my data on the printout? I added a few pictures to clarify what I want.</p>\n\n<p>Print Preview\n<a href=\"https://i.stack.imgur.com/t8viT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t8viT.png\" alt=\"Print Preview\"></a></p>\n\n<p>PDF output\n<a href=\"https://i.stack.imgur.com/AhtWy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AhtWy.png\" alt=\"PDF output\"></a></p>\n"}, {"tags": ["excel", "vba", "recursion", "indexing", "match"], "comments": [{"owner": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "edited": false, "score": 0, "creation_date": 1472657974, "post_id": 39253591, "comment_id": 65843427, "body": "Sorry the table is poorly formatted. I can&#39;t figure out how to place a table in the message. All the formatting gets stripped out. I&#39;ll try again with pipes..."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472659443, "post_id": 39253591, "comment_id": 65844357, "body": "Wouldn&#39;t it be easier to just &quot;unflatten&quot; the data into normalize into 4 tables - one for each of Charters, Programs, Projects, Features?"}, {"owner": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472662527, "post_id": 39253591, "comment_id": 65845938, "body": "Let&#39;s imagine that I did that. I would still need a function that checks four tables N times. For example, a feature in tbl_Epic_Features might have a parent in tbl_Epic_Projects, but that project may itself have its parent in the tbl_Epic_Projects table. In other words, I am still left with a recursive lookup."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472662747, "post_id": 39253591, "comment_id": 65846051, "body": "Actually you&#39;d be left with a series of fairly simple SQL join statements. You describe the structure as hierarchical, so it would just be a series of 1-M relationships."}, {"owner": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472665506, "post_id": 39253591, "comment_id": 65847545, "body": "The data is exported from a separate system in one flat file. I would first need to split the data, which I guess could be a macro. Then I could consider this approach, but I still need help to write it. I am way out of my depth. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "edited": false, "score": 0, "creation_date": 1473279211, "post_id": 39361194, "comment_id": 66084508, "body": "Error: Out of memory"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "edited": false, "score": 0, "creation_date": 1473279522, "post_id": 39361194, "comment_id": 66084647, "body": "I&#39;m getting a file not found from the download link."}, {"owner": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "edited": false, "score": 0, "creation_date": 1473279595, "post_id": 39361194, "comment_id": 66084671, "body": "Error: Out of memory on line: &quot;Set refList = CreateObject(&quot;System.Collections.ArrayList&quot;)&quot;"}, {"owner": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "edited": false, "score": 0, "creation_date": 1473279744, "post_id": 39361194, "comment_id": 66084742, "body": "Note: In my sample I call one column PARENT NAME. In the real data it is called PORTFOLIO ITEM"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "edited": false, "score": 0, "creation_date": 1473279907, "post_id": 39361194, "comment_id": 66084829, "body": "You already sent me the workbook.  It ran fine for me,  Are you trying to use this as a worksheet function?"}, {"owner": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "edited": false, "score": 0, "creation_date": 1473353810, "post_id": 39361194, "comment_id": 66118906, "body": "What I really was hoping for was a function that calculates the charter for each epic (portfolio item). I&#39;m not sure what this subroutine does yet, because I have not been able to run it. Tell me where to place the routine and I&#39;ll try it from there. Thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "edited": false, "score": 0, "creation_date": 1473355558, "post_id": 39361194, "comment_id": 66119742, "body": "Place it in a standard code module and run it to update all the charter IDs.    If you are making changes to the table; I suggest adding a button to the worksheet to update the charter IDs."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1473222359, "creation_date": 1473222359, "answer_id": 39361194, "question_id": 39253591, "link": "https://stackoverflow.com/questions/39253591/need-function-to-return-find-top-node-in-hierarchy-given-flat-data/39361194#39361194", "title": "Need function to return find top node in hierarchy given flat data", "body": "<pre><code>Sub ProcessEpics()\n    Const ID = \"ID\"\n    Const EPICTYPE = \"EPICTYPE\"\n    Const PARENT = \"PARENT\"\n    Const CHARTERID = \"CHARTERID\"\n    Const HIEARCHY = \"HIEARCHY\"\n\n    Dim arData, arResults, key\n    Dim lastRow As Long, x As Long\n    Dim List As Object, subList As Object, refList As Object\n\n    Set List = CreateObject(\"Scripting.Dictionary\")\n\n    With Worksheets(\"Epics\")\n        lastRow = .Range(\"H\" &amp; .Rows.Count).End(xlUp).Row\n        arData = .Rows(\"2:\" &amp; lastRow).Columns(\"A:H\").Value2\n    End With\n\n    For x = 1 To UBound(arData)\n        If Not List.Exists(arData(x, 3)) And arData(x, 3) &lt;&gt; \"\" Then\n            Set subList = CreateObject(\"Scripting.Dictionary\")\n            subList.Add ID, arData(x, 1)\n            subList.Add EPICTYPE, arData(x, 2)\n            subList.Add PARENT, arData(x, 8)\n            subList.Add CHARTERID, vbNullString\n            subList.Add HIEARCHY, vbNullString\n\n            List.Add arData(x, 3), subList\n        End If\n    Next\n\n    For Each key In List\n        Set refList = CreateObject(\"System.Collections.ArrayList\")\n        Set subList = List(key)\n        refList.Add subList(PARENT)\n\n        Do\n            If subList(PARENT) &lt;&gt; vbNullString Then Set subList = List(subList(PARENT))\n            If refList.Contains(subList(PARENT)) Then\n                refList.Add subList(PARENT)\n                Exit Do\n            End If\n            refList.Add subList(PARENT)\n        Loop Until subList(PARENT) = vbNullString\n\n        If subList(EPICTYPE) = \"Charter\" Then\n            List(key)(CHARTERID) = subList(ID)\n        Else\n            List(key)(CHARTERID) = \"Error \" &amp; subList(EPICTYPE)\n        End If\n\n        List(key)(HIEARCHY) = Join(refList.ToArray, \"-&gt;\")\n\n    Next\n\n    With Worksheets(\"Epics\")\n        For x = 2 To lastRow\n            .Cells(x, \"M\") = List(.Cells(x, 3).Text)(CHARTERID)\n            .Cells(x, \"N\") = List(.Cells(x, 3).Text)(HIEARCHY)\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3221570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf4b84c2d96286411c897d83c07c4aa5?s=128&d=identicon&r=PG&f=1", "display_name": "user3221570", "link": "https://stackoverflow.com/users/3221570/user3221570"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473222359, "creation_date": 1472657310, "last_edit_date": 1472658476, "question_id": 39253591, "link": "https://stackoverflow.com/questions/39253591/need-function-to-return-find-top-node-in-hierarchy-given-flat-data", "title": "Need function to return find top node in hierarchy given flat data", "body": "<p>I've seen some questions about Excel VBA recursive lookup functions, but none seem to work for my purposes. I need help!</p>\n\n<p>I have a table called \"Epics.\" Each Epic is assigned a type that indicates its level on a hierarchy. At the bottom of the hierarchy are features. Then project. Then programs. Then charters. In other words, a charter is a collection of programs. A program is a collection of projects. A project is a collection of features. If the data is good, I want to be able to start with a feature and recursively lookup its parent until I find an Epic of type charter.</p>\n\n<p>To make this possible, we need a relationship between rows. In my case this is a text field called \"Parent.\"</p>\n\n<p>Here is some sample data and psuedo code. Note that I am hiding all the columns with irrelevant data (D, E, F, G, I, J, K, L) to make the table easier to follow.</p>\n\n<pre><code>   | A       | B       | C           | H          | M\n1  | ID      | TYPE    | TITLE       | PARENT_NAME| CHARTERID\n2  | E-01958 | Feature | Apples      | Lemons     | E-01847\n3  | E-01837 | Feature | Bananas     |            | Error - Orphaned Feature\n4  | E-01847 | Charter | Grapes      |            | E-01847 \n5  | E-01865 | Project | Lemons      | Limes      | E-01847\n6  | E-01415 | Program | Limes       | Pineapples | E-01847\n7  | E-01168 |         | Pears       | Melons     | E-01951  \n8  | E-01954 | Feature | Kiwis       | Lemons     | E-01847\n9  | E-01951 | Charter | Melons      |            | E-01951\n10 | E-01901 | Program | Pineapples  | Grapes     | E-01847\n11 | E-09123 | Project | Raspberries |            | Error \u2013 Orphaned Project\n12 | E-98123 |         | Strawberries|            | Error Orphaned NA\n13 | E-01872 | Program | Tomatoes    |            | Error- Orphaned Program\n</code></pre>\n\n<p>Explanation of Function Value (Col M):</p>\n\n<pre><code>Row 1: Headers\n\nRow 2 (Apples)\nType for Apples is Feature, not Charter, so find parent.\nParent for Apples is Lemons.\nType for Lemons is Project, not Charter, so find parent.\nParent for Lemons is Limes.\nType for Limes is Program, not Charter, so find parent.\nParent for Limes is Pineapples.\nType for Pineapples is Program, not Charter, so find parent.\nParent for Pineapples is Grapes.\nType for Grapes is Charter. Success!\nFunction returns E-01847 (ID for Grapes) to M2.\n\nRow 3 (Bananas)\nType for Bananas is Feature, not Charter, so find parent.\nParent for Bananas is null, so we cannot continue the search.\nFunction returns \"Error - Orphaned Feature\" to M3.\nNote: The error here is really \"Error - Orphaned \" &amp; IFNA([Type],\"NA\")\n\nRow 4 (Grapes)\nType for Grapes is Charter. Success!\nFunction returns E-01847 (ID for Grapes) to M4.\n\nRow 5 (Lemons)\nSame logic path as R2\nFunction returns E-01847 (ID for Grapes) to M5.\n\nRow 6 (Limes)\nSame logic path as R2\nFunction returns E-01847 (ID for Grapes) to M6.\n\nRow 7 (Pears)\nType for Pears is Program, not Charter, so find parent.\nParent for Pears is Melons\nType for Melons is Charter. Success!\nFunction returns E-01951 (ID for Melons) to M7.\n\nRow 8 (Kiwis)\nSame logic path as R2\nFunction returns E-01847 (ID for Grapes) to M8.\n\nRow 9 (Melons)\nType for Melons is Charter. Success!\nFunction returns E-01951 (ID for Grapes) to M9.\n\nRow 10 (Pineapples)\nSame logic path as R2\nFunction returns E-01847 (ID for Grapes) to M10.\n\nRow 11 (Raspberries)\nType for Raspberries is Project, not Charter, so find parent.\nParent for Raspberries is null, so we cannot continue the search.\nFunction returns \"Error - Orphaned Project\" to M11.\n\nRow 12 (Strawberries)\nType for Strawberries is null not Charter, so find parent.\nParent for Strawberries is null, so we cannot continue the search.\nFunction returns \"Error - Orphaned NA\" to M12.\n\nRow 13 (Tomatoes)\nType for Tomatoes is Program, not Charter, so find parent.\nParent for Tomatoes is null, so we cannot continue the search.\nFunction returns \"Error - Orphaned program\" to M13.\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 1, "creation_date": 1472658573, "post_id": 39253378, "comment_id": 65843802, "body": "Have a look here: <a href=\"http://stackoverflow.com/questions/15573778/how-can-i-copy-a-row-of-data-and-paste-it-with-an-offset\" title=\"how can i copy a row of data and paste it with an offset\">stackoverflow.com/questions/15573778/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6779356, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wO8ETYgEo14/AAAAAAAAAAI/AAAAAAAAABM/mu-TrFPryuI/photo.jpg?sz=128", "display_name": "Ivramesh Kannan", "link": "https://stackoverflow.com/users/6779356/ivramesh-kannan"}, "edited": false, "score": 0, "creation_date": 1472709020, "post_id": 39254426, "comment_id": 65862482, "body": "Thanks @Chrismas007 tried your way it didnt work for me, I have reposted my required, please have a look and help me out."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 15, "user_id": 6779356, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wO8ETYgEo14/AAAAAAAAAAI/AAAAAAAAABM/mu-TrFPryuI/photo.jpg?sz=128", "display_name": "Ivramesh Kannan", "link": "https://stackoverflow.com/users/6779356/ivramesh-kannan"}, "edited": false, "score": 1, "creation_date": 1472756909, "post_id": 39254426, "comment_id": 65892895, "body": "@IvrameshKannan I&#39;d recommend leaving this question the way you originally asked and reasking the question with your new criteria.  Rewriting the question now won&#39;t get any new views.  I&#39;ll revert your question back to the original and I&#39;d suggest asking a new Q."}, {"owner": {"reputation": 15, "user_id": 6779356, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wO8ETYgEo14/AAAAAAAAAAI/AAAAAAAAABM/mu-TrFPryuI/photo.jpg?sz=128", "display_name": "Ivramesh Kannan", "link": "https://stackoverflow.com/users/6779356/ivramesh-kannan"}, "edited": false, "score": 0, "creation_date": 1472786030, "post_id": 39254426, "comment_id": 65901909, "body": "Thanks @chrismas007"}], "tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": true, "score": 0, "last_activity_date": 1472659989, "creation_date": 1472659989, "answer_id": 39254426, "question_id": 39253378, "link": "https://stackoverflow.com/questions/39253378/correct-syntax-for-rangecells-cells/39254426#39254426", "title": "Correct syntax for Range(Cells(),Cells())", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow\"><code>Range(Cells(x, y), Cells(a, b))</code></a> Selects all the cells from x,y in the top left to a,b in the bottom right.  However, the syntax is a little odd because the ROW comes first (x or a) and the COLUMN comes second (y or b).  Therefore your <code>2</code> in both <code>Cells()</code> is indicating column <code>B</code>.  Simply change it to a <code>4</code> in the second <code>Cells()</code> to select from <code>B:D</code>.</p>\n\n<pre><code>Range(Cells(firstInstanceRow + 1, 2), Cells(lastInstanceRow, 4)).Copy\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6779356, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wO8ETYgEo14/AAAAAAAAAAI/AAAAAAAAABM/mu-TrFPryuI/photo.jpg?sz=128", "display_name": "Ivramesh Kannan", "link": "https://stackoverflow.com/users/6779356/ivramesh-kannan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 1, "accepted_answer_id": 39254426, "answer_count": 1, "score": 1, "last_activity_date": 1472756918, "creation_date": 1472656652, "last_edit_date": 1472756918, "question_id": 39253378, "link": "https://stackoverflow.com/questions/39253378/correct-syntax-for-rangecells-cells", "title": "Correct syntax for Range(Cells(),Cells())", "body": "<p>I am a newbie to VBA and look like similar code with heading VBA script to copy adjacent cells if duplicate found</p>\n\n<pre><code>Range(Cells(firstInstanceRow + 1, 2), Cells(lastInstanceRow, 2)).Copy\n</code></pre>\n\n<p>This selects <strong>Column B</strong> and paste in adjacent cell C, but i would be needing to select B:D and paste in E:G until duplicate found.</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472655922, "post_id": 39253086, "comment_id": 65842037, "body": "What is <code>GetFillColor</code>?  Is this a UDF you wrote?  Please include the code?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1472656984, "post_id": 39253086, "comment_id": 65842773, "body": "If it&#39;s a UDF, you can probably just write another UDF to do this. I did something similar a few years back."}, {"owner": {"reputation": 1, "user_id": 4581330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7c1f3d02e4b115d0d80dc3b3de3902?s=128&d=identicon&r=PG&f=1", "display_name": "liam337", "link": "https://stackoverflow.com/users/4581330/liam337"}, "edited": false, "score": 0, "creation_date": 1472657534, "post_id": 39253086, "comment_id": 65843127, "body": "GetFillColour is a function I have to retrieve the cells color. So if it equals 4 then the colour is green."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1472657615, "post_id": 39253086, "comment_id": 65843187, "body": "I want <code>GetFillColor</code>, how come I&#39;m missing out\u203d"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1472657702, "post_id": 39253086, "comment_id": 65843244, "body": "Try this <code>=SUMPRODUCT((GetFillColor(A1:D1) = 4)*1)&#47;4</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472660714, "post_id": 39253086, "comment_id": 65844999, "body": "You say GetFillColor is a function.  There is no built in function that will directly count and average the color.  So if <code>GetFillColor</code> is available to you as a function then it is coded in vba.  If it is coded, please provide the code in your original post."}, {"owner": {"reputation": 1, "user_id": 4581330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7c1f3d02e4b115d0d80dc3b3de3902?s=128&d=identicon&r=PG&f=1", "display_name": "liam337", "link": "https://stackoverflow.com/users/4581330/liam337"}, "edited": false, "score": 0, "creation_date": 1472661114, "post_id": 39253086, "comment_id": 65845210, "body": "I was hardcoding the percentage in myself, I don&#39;t need to calculate the average. I&#39;m using the cells to calculate when a task is complete. So for example 1, E1 could be A, and then for example 2 E1 could be B. I just want to be able to tell the difference when 1 or 2 or 3 or 4 of the cells are green."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472661356, "post_id": 39253086, "comment_id": 65845337, "body": "You have two good answers, Like I said there is no built function that will do this.  You will need to do some work arounds."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4581330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7c1f3d02e4b115d0d80dc3b3de3902?s=128&d=identicon&r=PG&f=1", "display_name": "liam337", "link": "https://stackoverflow.com/users/4581330/liam337"}, "edited": false, "score": 0, "creation_date": 1472659809, "post_id": 39253940, "comment_id": 65844552, "body": "Is it possible to do this without a function in Microsoft visual basic? So just as an if statement."}], "tags": [], "owner": {"reputation": 71, "user_id": 4926749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368f639353030dd292cf12b4e2558589?s=128&d=identicon&r=PG&f=1", "display_name": "Redlion", "link": "https://stackoverflow.com/users/4926749/redlion"}, "is_accepted": false, "score": 0, "last_activity_date": 1472658388, "creation_date": 1472658388, "answer_id": 39253940, "question_id": 39253086, "link": "https://stackoverflow.com/questions/39253086/ms-excel-populate-cell-with-a-percentage-based-on-number-of-cells-coloured/39253940#39253940", "title": "MS Excel- Populate cell with a percentage based on number of cells coloured?", "body": "<p>Try to change your getfillcolor function with:</p>\n\n<pre><code>Public Function getfillcolor(rng As Range, color As Long) As Integer\nDim i As Integer\nDim cell As Range\nFor Each cell In rng.Cells\n    If cell.Interior.color = color Then\n    i = i + 1\n    Else\n    End If\nNext cell\ngetfillcolor = i\nEnd Function\n</code></pre>\n\n<p>Now you have your sum directly in the specified cell.</p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1472717784, "post_id": 39254416, "comment_id": 65867129, "body": "Good point - I wouldn&#39;t use that approach myself.  I&#39;d use a method that wouldn&#39;t involve counting colours - such as entering 10 in the cell (or more likely TRUE/FALSE) and conditional formatting if I really needed the colours."}, {"owner": {"reputation": 1, "user_id": 4581330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7c1f3d02e4b115d0d80dc3b3de3902?s=128&d=identicon&r=PG&f=1", "display_name": "liam337", "link": "https://stackoverflow.com/users/4581330/liam337"}, "edited": false, "score": 0, "creation_date": 1472720349, "post_id": 39254416, "comment_id": 65868725, "body": "Thank you for your answer. Still don&#39;t have what I wanted to do but still its a big help! I&#39;ll have another mess around with it..."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1472659967, "creation_date": 1472659967, "answer_id": 39254416, "question_id": 39253086, "link": "https://stackoverflow.com/questions/39253086/ms-excel-populate-cell-with-a-percentage-based-on-number-of-cells-coloured/39254416#39254416", "title": "MS Excel- Populate cell with a percentage based on number of cells coloured?", "body": "<p>If you don't mind using <em>helper</em> cells (and no VBA):  </p>\n\n<ul>\n<li>Create a named formula:  <code>=GET.CELL(38,OFFSET(INDIRECT(\"RC\",FALSE),-1,0))</code><br>\nI've called mine <strong>CellColour</strong>.  </li>\n<li>Place the formula <code>=CellColour</code> 1 cell below your coloured cells.<br>\nThe Offset in the formula tells it to look at the row above.  </li>\n<li>The formula will display the number 10 for cells coloured green (RGB = 0,255,0).  </li>\n<li>Now use a simple formula to calculate the percentage: <code>=COUNTIF(A2:D2,10)/COUNTA(A2:D2)</code></li>\n</ul>\n\n<p>You'll need to press F9 to update the formula result.</p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/20611-info-only-get-cell-arguments.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/20611-info-only-get-cell-arguments.html</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4581330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7c1f3d02e4b115d0d80dc3b3de3902?s=128&d=identicon&r=PG&f=1", "display_name": "liam337", "link": "https://stackoverflow.com/users/4581330/liam337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472659967, "creation_date": 1472655752, "last_edit_date": 1472658283, "question_id": 39253086, "link": "https://stackoverflow.com/questions/39253086/ms-excel-populate-cell-with-a-percentage-based-on-number-of-cells-coloured", "title": "MS Excel- Populate cell with a percentage based on number of cells coloured?", "body": "<p>I'm looking to populate a cell value with a number based on how many cells have the colour green.</p>\n\n<p>example 1:</p>\n\n<pre><code>A1 B1 C1 D1 (E1- Answer '15%' will appear here)\nG  NG NG NG (G= Green, NG= Not Green)\n</code></pre>\n\n<p>Another example:</p>\n\n<pre><code>A1 B1 C1 D1 (E1- Answer '30%' will appear here)\nG  G  NG NG (G= Green, NG= Not Green)\n</code></pre>\n\n<p><code>=IF(GetFillColor(A1)=4,\"1\",AND IF(GetFillColor(A1:B1)=4,\"2\"), AND  IF(GetFillColor(A1:C1)=4,\"3\"), AND IF(GetFillColor(A1:C1)=4,\"4\", \"0\"))</code></p>\n\n<p>GetFillColour:</p>\n\n<pre><code> Function GetFillColor(Rng As Range) As Long\n    GetFillColor = Rng.Interior.ColorIndex\n End Function\n</code></pre>\n\n<p>Any help would be much appreciated, Thanks! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15695, "user_id": 682404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxO2o.png?s=128&g=1", "display_name": "xxbbcc", "link": "https://stackoverflow.com/users/682404/xxbbcc"}, "edited": false, "score": 0, "creation_date": 1472655657, "post_id": 39252967, "comment_id": 65841847, "body": "Please update your question with a MCVE - <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>. As it is, your question will be closed as off-topic. You should also debug your script and describe what fails and where and what help you need."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472655684, "post_id": 39252967, "comment_id": 65841867, "body": "<a href=\"http://stackoverflow.com/documentation/vba/802/introduction-to-vba/15512/debugging\">This</a> might also be of help"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1472655697, "post_id": 39252967, "comment_id": 65841878, "body": "I strongly recommend you install and use Smart Indenter to make your code readable. <a href=\"http://www.oaltd.co.uk/indenter/\" rel=\"nofollow noreferrer\">oaltd.co.uk/indenter</a>"}, {"owner": {"reputation": 303, "user_id": 6044529, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f2f10dcbe4c67385ecdbdf9d1f917709?s=128&d=identicon&r=PG&f=1", "display_name": "R Thompson", "link": "https://stackoverflow.com/users/6044529/r-thompson"}, "edited": false, "score": 0, "creation_date": 1472655772, "post_id": 39252967, "comment_id": 65841932, "body": "I will install the indenter and readdress the text file"}, {"owner": {"reputation": 303, "user_id": 6044529, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f2f10dcbe4c67385ecdbdf9d1f917709?s=128&d=identicon&r=PG&f=1", "display_name": "R Thompson", "link": "https://stackoverflow.com/users/6044529/r-thompson"}, "edited": false, "score": 0, "creation_date": 1472655794, "post_id": 39252967, "comment_id": 65841944, "body": "Debuggin also currently yields no issues"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472655797, "post_id": 39252967, "comment_id": 65841945, "body": "What&#39;s the value of tSize when you output to the sheet?  Seems like just before that you&#39;ve been dividing it by 2...."}, {"owner": {"reputation": 303, "user_id": 6044529, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f2f10dcbe4c67385ecdbdf9d1f917709?s=128&d=identicon&r=PG&f=1", "display_name": "R Thompson", "link": "https://stackoverflow.com/users/6044529/r-thompson"}, "edited": false, "score": 0, "creation_date": 1472655843, "post_id": 39252967, "comment_id": 65841975, "body": "I&#39;m hoping tSize begins as an 129 by 129 matrix"}, {"owner": {"reputation": 15695, "user_id": 682404, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxO2o.png?s=128&g=1", "display_name": "xxbbcc", "link": "https://stackoverflow.com/users/682404/xxbbcc"}, "edited": false, "score": 0, "creation_date": 1472655943, "post_id": 39252967, "comment_id": 65842051, "body": "@RThompson Debugging should point out what&#39;s wrong with your script. Your code is doing something that you don&#39;t expect so it&#39;s definitely wrong - your code may execute with no errors but the output is still wrong. Use the debugger to determine the state of your various variables and see which ones have unexpected value. Place breakpoints on important variables and inspect them when the code stops on them."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472656043, "post_id": 39252967, "comment_id": 65842117, "body": "I think this is because you are manually setting <code>TR(1, 1) = 0</code>. When you reach this <code>For ii = 1 To tsize</code> tsize value is 1. So it&#39;s only going to do 1 iteration. You are overwriting tsize&#39;s value with this: <code>tsize = tsize &#47; 2</code>. Maybe you need another variable to hold this value?"}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 6044529, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f2f10dcbe4c67385ecdbdf9d1f917709?s=128&d=identicon&r=PG&f=1", "display_name": "R Thompson", "link": "https://stackoverflow.com/users/6044529/r-thompson"}, "edited": false, "score": 0, "creation_date": 1472681329, "post_id": 39253753, "comment_id": 65855488, "body": "That&#39;s exactly what I was expecting, replicating terrain. Thanks a lot!"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 2, "last_activity_date": 1472657849, "creation_date": 1472657849, "answer_id": 39253753, "question_id": 39252967, "link": "https://stackoverflow.com/questions/39252967/diamond-square-algorithm-in-vba-to-run-in-excel/39253753#39253753", "title": "Diamond Square Algorithm in VBA (to run in excel)", "body": "<p>I think the issue you are experiencing is from not iterating over the array you created as you are resetting the <code>tsize</code> variable to 1.</p>\n\n<p>Changing your code to something like this:</p>\n\n<pre><code>For ii = 1 To 129\n    For jj = 1 To 129\n        Cells(ii, jj).Value = TR(ii, jj)\n    Next\nNext\n</code></pre>\n\n<p>Produces a grid of 129 Rows and 129 columns with numeric values. Alternatively you could use the <code>LBound(TR)</code> and <code>UBound(TR)</code> to achieve the same result as manually typing 1 to 129 in each of the <code>For...Loop</code>. I played around with this, and used a conditional format to color the cells based on their relative size either black or white. Here is the result, I think this is the type of output you are expecting.</p>\n\n<p><a href=\"https://i.stack.imgur.com/J8Isu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J8Isu.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 303, "user_id": 6044529, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f2f10dcbe4c67385ecdbdf9d1f917709?s=128&d=identicon&r=PG&f=1", "display_name": "R Thompson", "link": "https://stackoverflow.com/users/6044529/r-thompson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 631, "favorite_count": 0, "accepted_answer_id": 39253753, "answer_count": 1, "score": 0, "last_activity_date": 1472672023, "creation_date": 1472655358, "last_edit_date": 1531164843, "question_id": 39252967, "link": "https://stackoverflow.com/questions/39252967/diamond-square-algorithm-in-vba-to-run-in-excel", "title": "Diamond Square Algorithm in VBA (to run in excel)", "body": "<p>I've written a script in VBA to create random terrain generation in excel, based on this following matlab script (<a href=\"http://knight.temple.edu/~lakamper/courses/cis350_2004/sources/matlabFractal/createFractalTerrain.m\" rel=\"nofollow\">http://knight.temple.edu/~lakamper/courses/cis350_2004/sources/matlabFractal/createFractalTerrain.m</a>)</p>\n\n<p>After compiling my script I found no bugs, but upon running in excel only cell A1 is assigned a value of zero, and then the script ends.</p>\n\n<p>Now, I wondered if anyone had the time to look through my VBA script and see if they have any idea what's going wrong. I think maybe perhaps I mess around with an array called TR quite a bit when I could perhaps refer to the Cells directly from the get go.</p>\n\n<p>Now, the code is bit long so I have provided a link to the text file that here, and so if nobody has the time I completely understand</p>\n\n<p><a href=\"https://www.dropbox.com/sh/c2l2ha0awirlowb/AAARGVpidQGP7I9Yu0XRN8yaa?dl=0\" rel=\"nofollow\">https://www.dropbox.com/sh/c2l2ha0awirlowb/AAARGVpidQGP7I9Yu0XRN8yaa?dl=0</a></p>\n\n<p>Also, here is the code indented.</p>\n\n<pre><code>Public TR(1 To 129, 1 To 129) As Double\n\nSub DiamondSquare()\n    Dim tsize As Long: tsize = 129\n    Dim StartRangRange As Double: startRandRange = 64.5\n    Dim H As Double:     H = 0.9\n    Call createFractalTerrain(tsize, startRandRange, H)\nEnd Sub\n\n\nFunction createFractalTerrain(ByVal tsize As Long, ByVal startRandRange As Double, ByVal H As Double) As Variant\n'Function creates fractal terrain by midpoint displacement (diamond square algorithm)\n'Output should be a tsize by tsize matrix\n'tSize must be a (power of 2) + 1 ie 129\n'startRandRange defines the overall elevation; size/2 gives natural images\n'Roughness H (between 0 and 1); 0.9 is a natural value\n'H=0 is max roughness\n\n    'Initiate Terrain\n    Dim i As Long\n    Dim j As Long\n    Dim ii As Long\n    Dim jj As Long\n\n    For i = 1 To tsize\n        For j = 1 To tsize\n            TR(i, j) = 10000\n        Next\n    Next\n\n    TR(1, 1) = 0\n    TR(1, tsize) = 0\n    TR(tsize, 1) = 0\n    TR(tsize, tsize) = 0\n\n    tsize = tsize - 1\n    randRange = startRandRange\n\n    'Main Loop\n    While tsize &gt; 1\n        Call diamondStep(tsize, randRange)\n        Call squareStep(tsize, randRange)\n\n        tsize = tsize / 2\n        randRange = randRange * (1 / (2 ^ H))\n    Wend\n\n    For ii = 1 To tsize\n        For jj = 1 To tsize\n            Cells(ii, jj).Value = TR(ii, jj)\n        Next\n    Next\n\nEnd Function\n\n\nSub diamondStep(ByVal tsize As Integer, ByVal randRange As Double)\n\n    sh = tsize / 2\n    maxIndex = UBound(TR, 1)\n\n    RowVal = 1 + sh\n    ColVal = 1 + sh\n\n    While RowVal &lt; maxIndex\n        While ColVal &lt; maxIndex\n\n            'Average height value of 4 cornerpoints\n            ValueH = TR(RowVal - sh, ColVal - sh) + TR(RowVal - sh, ColVal + sh) + TR(RowVal + sh, ColVal - sh) + TR(RowVal + sh, ColVal + sh)\n            ValueH = ValueH / 4\n\n            'Displacement\n            displacement = Int((1 - 0 + 1) * Rnd + 0) * randRange - randRange / 2\n            ValueH = ValueH + displacement\n\n            'Set diamond point\n            If TR(RowVal, ColVal) = 10000 Then TR(RowVal, ColVal) = ValueH\n\n            'Next square in same row\n            ColVal = ColVal + tsize\n        Wend\n\n        'Next row\n        ColVal = 1 + sh\n        RowVal = RowVal + tsize\n    Wend\n\nEnd Sub\n\n\nSub squareStep(ByVal tsize As Integer, ByVal randRange As Double)\n\n    sh = tsize / 2\n    maxIndex = UBound(TR, 1)\n    colStart = 1 + sh\n    RowVal = 1\n    ColVal = colStart\n\n    While (RowVal &lt;= maxIndex)\n        While (ColVal &lt;= maxIndex)\n            ValueH = 0\n            nop = 4     'number of points\n\n            'the following cases handle the boundary points,\n            'i.e. the incomplete diamonds\n\n            'north\n            If RowVal &gt; 1 Then\n                ValueH = ValueH + TR(RowVal - sh, ColVal)\n            Else\n                nop = nop - 1\n            End If\n\n            'east\n            If ColVal &lt; maxIndex Then\n                ValueH = ValueH + TR(RowVal, ColVal + sh)\n            Else\n                nop = nop - 1\n            End If\n\n            'south\n            If RowVal &lt; maxIndex Then\n                ValueH = ValueH + TR(RowVal + sh, ColVal)\n            Else\n                nop = nop - 1\n            End If\n\n            'west\n            If ColVal &gt; 1 Then\n                ValueH = ValueH + TR(RowVal, ColVal - sh)\n            Else\n                nop = nop - 1\n            End If\n\n            'displacement\n            displacement = Int((1 - 0 + 1) * Rnd + 0) * randRange - randRange / 2\n            ValueH = ValueH / nop + displacement\n\n            'set square point (if not predefined)\n            If TR(RowVal, ColVal) = 10000 Then TR(RowVal, ColVal) = ValueH\n\n            'next diamond in same row\n            ColVal = ColVal + sh\n        Wend\n\n        'next row\n        'the starting column alternates between 1 and sh\n        If colStart = 1 Then\n            colStart = sh + 1\n        Else\n            colStart = 1\n        End If\n\n        ColVal = colStart\n        RowVal = RowVal + sh\n    Wend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 24, "user_id": 4298715, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wPCap2TWihw/AAAAAAAAAAI/AAAAAAAAAkY/4NsI_vO_pl4/photo.jpg?sz=128", "display_name": "Rick St Jean", "link": "https://stackoverflow.com/users/4298715/rick-st-jean"}, "is_accepted": true, "score": 0, "last_activity_date": 1472659191, "creation_date": 1472659191, "answer_id": 39254187, "question_id": 39252927, "link": "https://stackoverflow.com/questions/39252927/word-vba-macro-find-text-and-get-its-position-to-replace-it-with-a-textbox/39254187#39254187", "title": "Word vba macro find text and get its position to replace it with a textbox", "body": "<p>You can use Selection.Information(wdVerticalPositionRelativeToPage), Selection.Information(wdHorizontalPositionRelativeToPage) to find the coordinates but it is just relative to that page.</p>\n\n<p>I haven't tested this but if you add</p>\n\n<pre><code>            .Select \n            x = Selection.Information(wdVerticalPositionRelativeToPage)\n            y = Selection.Information(wdHorizontalPositionRelativeToPage)\n            Set Box = ActiveDocument.Shapes.AddTextbox(msoTextOrientationHorizontal,x, y, 100, 100)\n</code></pre>\n\n<p>It should work.</p>\n"}], "owner": {"reputation": 102, "user_id": 3974799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d030182a82259619483902ed8ef9258?s=128&d=identicon&r=PG&f=1", "display_name": "tschan", "link": "https://stackoverflow.com/users/3974799/tschan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1858, "favorite_count": 0, "accepted_answer_id": 39254187, "answer_count": 1, "score": 0, "last_activity_date": 1472659191, "creation_date": 1472655264, "question_id": 39252927, "link": "https://stackoverflow.com/questions/39252927/word-vba-macro-find-text-and-get-its-position-to-replace-it-with-a-textbox", "title": "Word vba macro find text and get its position to replace it with a textbox", "body": "<p>I aim to replace a certain text in a ms word document with a textbox. This textbox needs to have the replaced text in it. The textbox should appear at the same position like the replaced text and the following content must wrap around the textbox.</p>\n\n<p>With the following code I can accomplish the replacement of the text with a textbox and with the replaced text in the textbox, but the textbox is always at the same place.</p>\n\n<p>What I need now, is the possibility to get the position of a found text to use it for the textbox to replace the found text. :)</p>\n\n<p>My code snippet:</p>\n\n<pre><code>positionLeft = 50  /* here I need the left position of the found text */\npositionTop = 50   /* and here the top position */\n\nWith ActiveDocument.Range.find\n            .Forward = True\n            .Wrap = wdFindStop\n            .Text = TextToReplace\n            .Execute\n            If .Found = True Then\n                Dim Box As Shape\n                Set Box = ActiveDocument.Shapes.AddTextbox(msoTextOrientationHorizontal, positionToLeft, positionToRight, 100, 100)\n                Box.TextFrame.textRange.Text = TextToReplace\n                .Parent = \"\"\n            End If\nEnd With\n</code></pre>\n\n<p>Is it even possible to get the absolute left and top position of a text in the word document? And if yes, how can i get this done?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1472656639, "post_id": 39252848, "comment_id": 65842527, "body": "I don&#39;t understand your question. You have a Commit button that the user will click. When they do so, validate the data before allowing the post to the database to occur. If it passes, do the actual save to the DB; if it doesn&#39;t, don&#39;t allow it to be posted."}, {"owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "edited": false, "score": 0, "creation_date": 1472656881, "post_id": 39252848, "comment_id": 65842701, "body": "Do you want to use a bound or unbound form?"}, {"owner": {"reputation": 809, "user_id": 2925985, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/kevlx.png?s=128&g=1", "display_name": "Susannah Potts", "link": "https://stackoverflow.com/users/2925985/susannah-potts"}, "edited": false, "score": 1, "creation_date": 1472657476, "post_id": 39252848, "comment_id": 65843094, "body": "Where is the specific area you need help?  This reads more like a code request than an actual question."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6779117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d268ba41e1e75cc2e1d7c97a7f004819?s=128&d=identicon&r=PG&f=1", "display_name": "Rens", "link": "https://stackoverflow.com/users/6779117/rens"}, "edited": false, "score": 0, "creation_date": 1473865926, "post_id": 39283088, "comment_id": 66305404, "body": "Craig - Thanks, this is a great suggestion, and along the lines of where I was heading on my own before I got stuck and decided to ask for help. That makes me believe I am on the right track."}], "tags": [], "owner": {"reputation": 96, "user_id": 6728643, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207032731592763/picture?type=large", "display_name": "Craig Gross", "link": "https://stackoverflow.com/users/6728643/craig-gross"}, "is_accepted": false, "score": 0, "last_activity_date": 1472779838, "creation_date": 1472779838, "answer_id": 39283088, "question_id": 39252848, "link": "https://stackoverflow.com/questions/39252848/ms-access-2013-how-can-i-programatically-manipulate-data-from-a-form-before-inse/39283088#39283088", "title": "MS access 2013 how can I programatically manipulate data from a form before inserting a record into a table", "body": "<p>I recommend creating a temp table to store the incoming data before moving it to the RunOut History table. Don't forget to include a WheelSpecID field. Here is one approach...</p>\n\n<p>Create a sub form based off of the temp table. Make it a datasheet form so that the users can copy and paste from Excel into the datasheet.</p>\n\n<p>Create a main form that is based off of the WheelSpec table. Insert the sub form onto this form, and link the Master and Child fields (WheelSpecID).</p>\n\n<p>Here's the thing, you need the main form to load with the WheelSpecID, or have it change based off of your Combobox. The way it works, is anything put into the subform takes on the ID# of the main form. When you click your commit button you can run a check against each record from the temp table before moving the item over to your RunOut History table. </p>\n"}], "owner": {"reputation": 1, "user_id": 6779117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d268ba41e1e75cc2e1d7c97a7f004819?s=128&d=identicon&r=PG&f=1", "display_name": "Rens", "link": "https://stackoverflow.com/users/6779117/rens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1594641457, "creation_date": 1472655061, "last_edit_date": 1594641457, "question_id": 39252848, "link": "https://stackoverflow.com/questions/39252848/ms-access-2013-how-can-i-programatically-manipulate-data-from-a-form-before-inse", "title": "MS access 2013 how can I programatically manipulate data from a form before inserting a record into a table", "body": "<p>OK, This is my first time asking a question, so bear with me - its difficult to explain.</p>\n\n<p>I am developing an Access Database application to replace functions and features that users have been doing using an excel Spreadsheet. The data on the Spreadsheet often gets corrupted due to various users incorrectly adding and/or modifying data. The Spreadsheet is basically 2 tables of data and a number of reports, each of which is a separate Sheet.</p>\n\n<p>The idea behind the application is that the customer maintains an inventory of automobile Wheels(rims). Periodically these Wheels are placed on automatic testing machines and run through a test that produces CSV-formatted test data. The test data is manipulate in another application to produce a Spreadsheet containing rows of \"RunOut\" Data.</p>\n\n<p>My Access application has 2 tables - a \"WHEEL SPEC\" Table with basic data about each wheel like name, size, storage location, etc, and a \"RUNOUT HISTORY\" Table where each record is one row of RunOut Data from the processing Spreadsheet. </p>\n\n<p>The customer would like to be able to add RunOut Data to the RUNOUT HISTORY table by copying the Data rows from the processing Spreadsheet (usually 3 to 5 rows) And pasting them into the access table. I would like to set a foreign key field in each row to associate the data with an existing Wheel in the WHEEL SPEC table, and run some data validation before inserting to keep the data from getting corrupt as a result of the copy/paste operation. I have created a form with a combo box where the users can select the Wheel to associate with the new RunOut Data, a sub-form that allows them to paste the copied rows into the table, and two buttons \"Commit\" an \"Cancel\".</p>\n\n<p>When the user selects \"Commit\", I would like to run validation on the copied data and then add the Wheel ID from the Wheel selected in the combo box to each record. I would like validation errors to report to the user without saving the data so they can decide whether to fix the data or Cancel and try again later.</p>\n\n<p>Any help on this will be appreciated. I have looked for for solutions on-line, but most answers just refer to importing excel data which is not quite what I am trying to accomplish here.    </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 3, "creation_date": 1472654360, "post_id": 39252534, "comment_id": 65840887, "body": "That error means your <code>rFound</code> is set to Nothing, because it couldn&#39;t find <code>strSearch</code>.  You&#39;ll need to change the placement of your error checking."}, {"owner": {"reputation": 11, "user_id": 6779196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934714cbbda4e2c953a7ffb0774429bb?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron Austin", "link": "https://stackoverflow.com/users/6779196/cameron-austin"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1473237207, "post_id": 39252534, "comment_id": 66058616, "body": "Thanks! I&#39;ve now added an If rFound is Nothing then exit do statement and it seems to now work fine."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6779196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934714cbbda4e2c953a7ffb0774429bb?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron Austin", "link": "https://stackoverflow.com/users/6779196/cameron-austin"}, "edited": false, "score": 0, "creation_date": 1473236839, "post_id": 39254304, "comment_id": 66058391, "body": "Thanks, I&#39;ve tidied up the code but I&#39;m still having the same problem. For example when searching for word &quot;controller&quot; the code works fine, searching through every file in the folder and reporting all of the instances. However, searching other works like &quot;conveyor&quot; causes the macro to produce the 91 error after searching through the first workbook."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 6779196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934714cbbda4e2c953a7ffb0774429bb?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron Austin", "link": "https://stackoverflow.com/users/6779196/cameron-austin"}, "edited": false, "score": 0, "creation_date": 1473259943, "post_id": 39254304, "comment_id": 66074358, "body": "I would create a new question with the current code and indicate where the error occurs."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 4, "last_activity_date": 1472659534, "creation_date": 1472659534, "answer_id": 39254304, "question_id": 39252534, "link": "https://stackoverflow.com/questions/39252534/unusual-vba-error-object-variable-or-with-block-variable-not-set/39254304#39254304", "title": "unusual - vba error: object variable or with block variable not set", "body": "<p>Your code enters the <code>Do</code> loop even when nothing is found.</p>\n\n<p>Try something like:</p>\n\n<pre><code>Set rFound = wks.UsedRange.Find(what:=strSearch, lookat:=xlWhole, lookin:=xlValues) \nIf Not rFound Is Nothing Then \n    strFirstAddress = rFound.Address \n    Do\n        lRow = lRow + 1\n        .Cells(lRow, 1) = wbk.Name\n        .Cells(lRow, 2) = wks.Name\n        .Cells(lRow, 3) = rFound.Value\n        Set rFound = wks.Cells.FindNext(After:=rFound) \n    Loop While strFirstAddress &lt;&gt; rFound.Address \nEnd If\n</code></pre>\n\n<p>It's a good idea to specify the additional arguments to <code>Find()</code>, since their values will persist between uses (even from a use via the Excel UI) so you can never rely on what values will be used if you omit them.</p>\n"}], "owner": {"reputation": 11, "user_id": 6779196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/934714cbbda4e2c953a7ffb0774429bb?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron Austin", "link": "https://stackoverflow.com/users/6779196/cameron-austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472659534, "creation_date": 1472654203, "last_edit_date": 1472654285, "question_id": 39252534, "link": "https://stackoverflow.com/questions/39252534/unusual-vba-error-object-variable-or-with-block-variable-not-set", "title": "unusual - vba error: object variable or with block variable not set", "body": "<p>Now I'm aware that many issues with this error have been asked and answered in the past but this case is slightly stanger and I can't figure out what is causing the problem.</p>\n\n<p>I've written some code that searches through excel files for a keyword and then returns information on where it found the keyword. The code works fine for most keywords I enter but there are certain ones that when I run the macro it produces the 91 error message. If anyone can figure out why that would be awesome!</p>\n\n<p>Code is:</p>\n\n<pre><code>Sub SearchFolders()\nDim fso As Object\nDim fld As Object\nDim strSearch As String ' Keyword to search for\nDim strPath As String ' Filepath of folder to search\nDim strFile As String ' current file that the loop is searching through\nDim wOut As Worksheet ' Worksheet to display results\nDim wbk As Workbook ' Workbook to be searched\nDim wks As Worksheet ' Worksheet to be searched\nDim lRow As Integer\nDim rFound As Range\nDim strFirstAddress As String\n\nApplication.ScreenUpdating = False\n\n'Change as desired\nstrPath = \"\\\\ant\\dept-eu\\LTN1\\Techies Information\\aa Eng daily log\"\nstrSearch = InputBox(\"Insert Keyword to search\")\n\nSet wOut = Sheet1\nlRow = 1\nWith wOut\n    Sheet1.Cells.Clear\n    .Cells(lRow, 1) = \"Workbook\"\n    .Cells(lRow, 2) = \"Worksheet\"\n    .Cells(lRow, 3) = \"Text in Cell\"\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set fld = fso.GetFolder(strPath)\n\n    strFile = Dir(strPath &amp; \"\\*.xls*\")\n    Do While strFile &lt;&gt; \"\"\n        Set wbk = Workbooks.Open _\n          (Filename:=strPath &amp; \"\\\" &amp; strFile, _\n          UpdateLinks:=0, _\n          ReadOnly:=True, _\n          AddToMRU:=False)\n\n        For Each wks In wbk.Worksheets ' for each worksheet\n            Set rFound = wks.UsedRange.Find(strSearch) ' setting variable to first result in find function\n            If Not rFound Is Nothing Then ' if something is found\n                strFirstAddress = rFound.Address ' set first address to that cell's address\n            End If\n            Do\n                If rFound Is Nothing Then ' if nothing was found\n                    Exit Do ' exit loop\n                Else ' if something was found then add the details to the table\n                    lRow = lRow + 1\n                    .Cells(lRow, 1) = wbk.Name\n                    .Cells(lRow, 2) = wks.Name\n                    .Cells(lRow, 3) = rFound.Value\n                End If\n               Set rFound = wks.Cells.FindNext(After:=rFound)  ' sets rfound vaiable to next found value\n            Loop While strFirstAddress &lt;&gt; rFound.Address ' once the find function gets back to the first address then exit the loop\n\n        Next ' next worksheet in file\n\n        wbk.Close (False)\n        strFile = Dir\n    Loop\n    .Columns(\"A:D\").EntireColumn.AutoFit\nEnd With\nMsgBox \"Done\"\n\nExitHandler:\nSet wOut = Nothing\nSet wks = Nothing\nSet wbk = Nothing\nSet fld = Nothing\nSet fso = Nothing\nApplication.ScreenUpdating = True\nExit Sub\n</code></pre>\n\n<p>The Error occurs on the  Loop While strFirstAddress &lt;> rFound.Address line</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 77, "user_id": 6198644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3855af64bfb099d294f8795dbda9b73d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6198644/alex"}, "edited": false, "score": 0, "creation_date": 1472653382, "post_id": 39252152, "comment_id": 65840106, "body": "This is a shot in the dark, but have you tried declaring oExcel as Excel.Application?  Add this before setting testdb,   set oExcel = new Excel.Application"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1472653731, "post_id": 39252152, "comment_id": 65840377, "body": "You&#39;d likely get this error if the name of the sheet <code>Main</code> doesn&#39;t exist in the Dbase.xlsm file. Maybe there&#39;s an extra space or something, check for accuracy. I emulated your code and it appears ok. One thing that might be an issue is if you are expecting to return a string, you may want to change testvar1 to be a <code>String</code> and not <code>Double</code>."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472653733, "post_id": 39252152, "comment_id": 65840382, "body": "I suspect you are getting your error because your <code>Vlookup</code> returns an error (since not found), you need to add error handling in cases your <code>Vlookup</code> is unsuccessful, see link : <a href=\"http://stackoverflow.com/questions/18063214/how-to-error-handle-1004-error-with-worksheetfunction-vlookup\" title=\"how to error handle 1004 error with worksheetfunction vlookup\">stackoverflow.com/questions/18063214/&hellip;</a>"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1472666142, "post_id": 39252152, "comment_id": 65847970, "body": "i think you need to <code>activate</code> the excel window after open() and before .vlookup. based on my experience"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6776375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1306985249312217/picture?type=large", "display_name": "Shiv", "link": "https://stackoverflow.com/users/6776375/shiv"}, "edited": false, "score": 0, "creation_date": 1472660274, "post_id": 39252392, "comment_id": 65844752, "body": "My sheet name in the workbook and the code was identical and the workbook was not hidden. Still didnt work with the oExcel.Workbooks.Open(), so then I replaced with GetObject() and it worked.  Could you have an idea why this would happen?"}, {"owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "edited": false, "score": 0, "creation_date": 1472675755, "post_id": 39252392, "comment_id": 65853129, "body": "Honestly, I am not sure without being able to experience it first-hand (which I would love to). A couple longshots I have is there is an unreleased COM object VBA did not release from memory or it could be environmental. Perhaps there is a workbook_open() process in the workbook?"}], "tags": [], "owner": {"reputation": 423, "user_id": 3084565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e1f2f5fdd46c93ef1f30a2ac93582e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/3084565/kevin"}, "is_accepted": false, "score": 0, "last_activity_date": 1472653780, "creation_date": 1472653780, "answer_id": 39252392, "question_id": 39252152, "link": "https://stackoverflow.com/questions/39252152/word-excel-vba-vlookup-subscript-out-of-range-error/39252392#39252392", "title": "Word/Excel Vba vlookup &quot;Subscript out of range&quot; error", "body": "<p>This script worked for me. Make sure the Main tab exists, that's how I duplicated the error.</p>\n\n<p>A missing value in the VLookup will give you \"Unable to get Vlookup property...\" error.</p>\n"}], "owner": {"reputation": 1, "user_id": 6776375, "user_type": "registered", "profile_image": "https://graph.facebook.com/1306985249312217/picture?type=large", "display_name": "Shiv", "link": "https://stackoverflow.com/users/6776375/shiv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1582, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472653780, "creation_date": 1472653133, "last_edit_date": 1531164843, "question_id": 39252152, "link": "https://stackoverflow.com/questions/39252152/word-excel-vba-vlookup-subscript-out-of-range-error", "title": "Word/Excel Vba vlookup &quot;Subscript out of range&quot; error", "body": "<p>I'm trying to use vlookup to read a string from a word document and return corresponding values from an excel sheet. I seem to be getting a \"Subscript out or Range\" Error on the vlookup function.</p>\n\n<p>This is the worksheet that i am looking at:\n<a href=\"http://i.stack.imgur.com/uPgMZ.png\" rel=\"nofollow\">Sample Data</a></p>\n\n<p>The code I have is:</p>\n\n<pre><code>Sub Autofill()\nDim oExcel As New Excel.Application\nDim testdb As Excel.Workbook\nDim testvar1 As Double\n\nSet testdb = oExcel.Workbooks.Open(\"k:\\SIF\\Vibration\\Dbase.xlsm\")\n\ntestvar1 = oExcel.WorksheetFunction.VLookup(\"Roger\", testdb.Sheets(\"Main\").Range(\"A1:C4\"), 2, False)\n\nMsgBox (testvar1)\n\nEnd Sub\n</code></pre>\n\n<p>I tried using the Application.Vlookup function as well, to no avail. Got the same error.</p>\n"}, {"tags": ["vba", "macros", "powerpoint"], "comments": [{"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1472653102, "post_id": 39252022, "comment_id": 65839886, "body": "Try adding File name with extension to the FilePath"}, {"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1472653208, "post_id": 39252022, "comment_id": 65839968, "body": "it doesn&#39;t work :("}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1472653300, "post_id": 39252022, "comment_id": 65840026, "body": "Can you please share the error you are getting?"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1472653499, "post_id": 39252022, "comment_id": 65840190, "body": "I have tried adding the file type extension and it worked fine for me"}, {"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "reply_to_user": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "edited": false, "score": 0, "creation_date": 1472653691, "post_id": 39252022, "comment_id": 65840351, "body": "it comes always Run-timr error &#39;53&#39;  File not found"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1472654599, "post_id": 39252268, "comment_id": 65841072, "body": "i don&#39;t understand what&#39;s wrong with it but it still doesn&#39;t work!!!!!!!!!!"}, {"owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "reply_to_user": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1472654929, "post_id": 39252268, "comment_id": 65841328, "body": "If im not wrong you are trying to find the time of a different PPT file(not the PPT in which you are running macro). Am i right? And it is in the &#39;Macro Project&#39; folder"}, {"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1472655769, "post_id": 39252268, "comment_id": 65841928, "body": "no no just for this one! but many users have access for it and can modifie it! so when someone modifies it, i want to see when does he did it"}], "tags": [], "owner": {"reputation": 1109, "user_id": 5773692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbUFO.jpg?s=128&g=1", "display_name": "Siva", "link": "https://stackoverflow.com/users/5773692/siva"}, "is_accepted": false, "score": 0, "last_activity_date": 1472653449, "creation_date": 1472653449, "answer_id": 39252268, "question_id": 39252022, "link": "https://stackoverflow.com/questions/39252022/powerpoint-macro-to-get-the-last-modified-date-of-a-file/39252268#39252268", "title": "Powerpoint macro to get the last modified date of a file", "body": "<p>Try this</p>\n\n<pre><code>Sub proprietes()\n\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nFilePath = \"C:\\Users\\....\\Desktop\\TestPPT.pptx\"\nSet f = fs.GetFile(FilePath)\nfileModDate = f.DateLastModified\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1472656151, "post_id": 39252423, "comment_id": 65842195, "body": "Its not strange if you are not using the full path. For example <code>&quot;C:\\Users\\Moez\\Desktop\\Macro Project\\test v2.ppt&quot;</code>"}, {"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1475657036, "post_id": 39252423, "comment_id": 67025482, "body": "i&#39;m trying and nevr get it!!!!!!!!!!!!!!!!!! i want to get the last modified date of the running PPT in which i&#39;m whriting my macro"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1472653867, "creation_date": 1472653867, "answer_id": 39252423, "question_id": 39252022, "link": "https://stackoverflow.com/questions/39252022/powerpoint-macro-to-get-the-last-modified-date-of-a-file/39252423#39252423", "title": "Powerpoint macro to get the last modified date of a file", "body": "<p>maybe something like this </p>\n\n<pre><code> FilePath = Dir(\"C:\\Users\\Moez\\Desktop\\Macro Project\\test v2*\")\n fileModDate = FileDateTime(FilePath)\n</code></pre>\n\n<p><a href=\"https://www.techonthenet.com/excel/formulas/filedatetime.php\" rel=\"nofollow\">https://www.techonthenet.com/excel/formulas/filedatetime.php</a></p>\n"}], "owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 443, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472653867, "creation_date": 1472652761, "last_edit_date": 1472653111, "question_id": 39252022, "link": "https://stackoverflow.com/questions/39252022/powerpoint-macro-to-get-the-last-modified-date-of-a-file", "title": "Powerpoint macro to get the last modified date of a file", "body": "<p>I want to get the last modified date of a ppt file and put the condition : if it's in after thursady of the week than out else go on. That's what i wrote but it doesn't work! </p>\n\n<pre><code>Sub proprietes()\n\n\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nFilePath = \"C:\\Users\\Moez\\Desktop\\Macro Project\\test v2\"\nSet f = fs.GetFile(FilePath)\nfileModDate = f.DateLastModified\nEnd Sub\n</code></pre>\n\n<p>i always get the mistake in <code>Set f = fs.GetFile(FilePath)</code>!!</p>\n\n<p>Could you help me please? \nthanks a lot</p>\n"}, {"tags": ["sql", "vba", "ms-access", "time", "calc"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1472655855, "last_edit_date": 1472655855, "creation_date": 1472655232, "answer_id": 39252919, "question_id": 39251804, "link": "https://stackoverflow.com/questions/39251804/ms-access-2010-how-to-calculate-time-between-two-records-identical-id-differ/39252919#39252919", "title": "MS Access 2010, how to calculate time between two records - identical ID, different time", "body": "<p>The syntax (and probably performance) in Access are going to be really bad for this, but something like this should work:</p>\n\n<pre><code>SELECT AlarmID,System,\n    (SELECT TOP 1 [Raised On] FROM [Alarmi_On-Off] \n     WHERE A.AlarmID = AlarmID \n     AND A.[Raised On] &lt; [Raised On] \n     AND State = 'Off' ORDER BY [Raised On]) - [Raised On] AS Duration \nFROM [Alarmi_On-Off] AS A \nWHERE State = 'On' \nORDER BY AlarmID,[Raised On]\n</code></pre>\n\n<p>Note that the <code>Duration</code> value will be a <code>Double</code> representing days and fractional days.  You can either cast it to a <code>Date</code> or extract date and time parts as needed with Access's date and time functions, i.e:</p>\n\n<pre><code>SELECT AlarmID,System,HOUR(Duration) AS Hours, MINUTE(Duration) AS Minutes FROM\n(\nSELECT AlarmID,System,\n    (SELECT TOP 1 [Raised On] FROM [Alarmi_On-Off] \n     WHERE A.AlarmID = AlarmID \n     AND A.[Raised On] &lt; [Raised On] \n     AND State = 'Off' ORDER BY [Raised On]) - [Raised On] AS Duration \nFROM [Alarmi_On-Off] AS A \nWHERE State = 'On' \nORDER BY AlarmID,[Raised On]\n) T\n</code></pre>\n\n<p>Results with your sample data:</p>\n\n<blockquote>\n<pre><code>AlarmID   System     Hours   Minutes\n1001      System1    1       54\n1002      System2    0       10\n1002      System2    0       1\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472675637, "post_id": 39253825, "comment_id": 65853072, "body": "I&#39;m ending up with a Cartesian product of start and end times if there is more than one pair per AlarmID in both Access and SQL Server."}, {"owner": {"reputation": 41, "user_id": 6778946, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1533af30bc9afafd8f65e6b5e6738a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Vedran", "link": "https://stackoverflow.com/users/6778946/vedran"}, "edited": false, "score": 0, "creation_date": 1473245397, "post_id": 39253825, "comment_id": 66063729, "body": "Many thanks to everyone, I&#39;ll try it next week when I&#39;ll be back in my office."}], "tags": [], "owner": {"reputation": 2884, "user_id": 6564115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9Xf5H.png?s=128&g=1", "display_name": "AT-2017", "link": "https://stackoverflow.com/users/6564115/at-2017"}, "is_accepted": false, "score": -1, "last_activity_date": 1472658087, "creation_date": 1472658087, "answer_id": 39253825, "question_id": 39251804, "link": "https://stackoverflow.com/questions/39251804/ms-access-2010-how-to-calculate-time-between-two-records-identical-id-differ/39253825#39253825", "title": "MS Access 2010, how to calculate time between two records - identical ID, different time", "body": "<p>You can use the following query to find the time difference between the '<strong>On</strong>' and '<strong>Off</strong>' state:</p>\n\n<pre><code>SELECT\n    start_log.AlarmID,\n    start_log.Rasied_On AS start_time,\n    end_log.Rasied_On AS end_time,\n    DATEDIFF(MINUTE, start_log.Rasied_On, end_log.Rasied_On) AS TimeInMin\nFROM\n    [Alarmi_On-Off] AS start_log\nINNER JOIN\n    [Alarmi_On-Off] AS end_log ON (\n            start_log.AlarmID = end_log.AlarmID AND start_log.Rasied_On &lt; end_log.Rasied_On)\nWHERE start_log.State = 'On'\nAND end_log.State = 'Off'\nGROUP BY start_log.AlarmID, start_log.Rasied_On, end_log.Rasied_On\n</code></pre>\n\n<p>The output I mean the time difference is in minutes:\n<a href=\"https://i.stack.imgur.com/3ILf9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3ILf9.png\" alt=\"Time Difference\"></a></p>\n"}], "owner": {"reputation": 41, "user_id": 6778946, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1533af30bc9afafd8f65e6b5e6738a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Vedran", "link": "https://stackoverflow.com/users/6778946/vedran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 777, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1472733040, "creation_date": 1472652153, "last_edit_date": 1472733040, "question_id": 39251804, "link": "https://stackoverflow.com/questions/39251804/ms-access-2010-how-to-calculate-time-between-two-records-identical-id-differ", "title": "MS Access 2010, how to calculate time between two records - identical ID, different time", "body": "<p>I have a list of records presented with AlarmID, System, State and Raised ON.</p>\n\n<p>One event is presented by two records, same AlarmID, first with State On, second with State Off, and coresponding time.</p>\n\n<p>This is my query:</p>\n\n<pre><code>SELECT *\nFROM [Alarmi_On-Off]\nWHERE [Alarmi_On-Off].[Alarm ID] IN (SELECT [Alarmi_On-Off].[Alarm ID] \n                                     FROM [Alarmi_On-Off]\n                                     GROUP BY [Alarmi_On-Off].[Alarm ID] \n                                     HAVING COUNT([Alarmi_On-Off].[Alarm ID]) &gt; 1);\n</code></pre>\n\n<p>and the result:    </p>\n\n<pre><code>+---------+---------+-------+------------------+\n| AlarmID | System  | State |    Raised On     |\n+---------+---------+-------+------------------+\n|    1001 | System1 | On    | 16.08.2016 14:23 |\n|    1001 | System1 | Off   | 16.08.2016 16:17 |\n|    1002 | System2 | On    | 27.06.2016 12:14 |\n|    1002 | System2 | Off   | 27.06.2016 12:24 |\n|    1002 | System2 | On    | 14.07.2016 03:37 |\n|    1002 | System2 | Off   | 14.07.2016 03:38 |\n+---------+---------+-------+------------------+\n</code></pre>\n\n<p>I want to create a query which calculates the time difference between On and Off state for each system, bearing in mind to exclude all systems with less than 2 events (in an example above, exclude AlarmID 1001), what I tried with \"having COUNT..\"</p>\n\n<p>In that query, instead of two records, I would have one record with system and calculated time.</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["vba", "excel", "batch-file", "macros"], "comments": [{"owner": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "edited": false, "score": 1, "creation_date": 1472651992, "post_id": 39251656, "comment_id": 65839096, "body": "Have you tried to execute it like Output = WshShell.Run(&quot;C:\\Mypath\\Command.bat&quot;, 1, True) just to test *.bat file?"}, {"owner": {"reputation": 114, "user_id": 4989238, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-pSK_jJFh1VM/AAAAAAAAAAI/AAAAAAAAAKo/0ZJN1cwu-Tk/photo.jpg?sz=128", "display_name": "Sandy QA Proffessional", "link": "https://stackoverflow.com/users/4989238/sandy-qa-proffessional"}, "reply_to_user": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "edited": false, "score": 0, "creation_date": 1472652173, "post_id": 39251656, "comment_id": 65839230, "body": "Yes i did, and that gives me an error &#39;Method run of the shell object failed&#39;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472652368, "post_id": 39251656, "comment_id": 65839362, "body": "Do you have the appropriate permissions to run a batch file in the target directory?"}, {"owner": {"reputation": 114, "user_id": 4989238, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-pSK_jJFh1VM/AAAAAAAAAAI/AAAAAAAAAKo/0ZJN1cwu-Tk/photo.jpg?sz=128", "display_name": "Sandy QA Proffessional", "link": "https://stackoverflow.com/users/4989238/sandy-qa-proffessional"}, "edited": false, "score": 0, "creation_date": 1472653406, "post_id": 39251656, "comment_id": 65840133, "body": "When i manual double click on the bat file i am able to execute so i am assuming that i have the permission. Can you elaborate if my assumption is wrong."}, {"owner": {"reputation": 114, "user_id": 4989238, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-pSK_jJFh1VM/AAAAAAAAAAI/AAAAAAAAAKo/0ZJN1cwu-Tk/photo.jpg?sz=128", "display_name": "Sandy QA Proffessional", "link": "https://stackoverflow.com/users/4989238/sandy-qa-proffessional"}, "edited": false, "score": 0, "creation_date": 1472653611, "post_id": 39251656, "comment_id": 65840288, "body": "My path is C:\\WorkspaceRFT\\RMS\\command.bat doesn&#39;t contain any spaces"}, {"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 0, "creation_date": 1472658734, "post_id": 39251656, "comment_id": 65843894, "body": "What about <code>Output = WshShell.Run(&quot;cmd.exe &#47;C Command.bat&quot;, 1, True)</code>? also with full paths to <code>cmd.exe</code> and/or the batch file?"}], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 4989238, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-pSK_jJFh1VM/AAAAAAAAAAI/AAAAAAAAAKo/0ZJN1cwu-Tk/photo.jpg?sz=128", "display_name": "Sandy QA Proffessional", "link": "https://stackoverflow.com/users/4989238/sandy-qa-proffessional"}, "edited": false, "score": 0, "creation_date": 1472653853, "post_id": 39252208, "comment_id": 65840468, "body": "Hi Ryan, This is not helping either, same problem with this code as well."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 114, "user_id": 4989238, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-pSK_jJFh1VM/AAAAAAAAAAI/AAAAAAAAAKo/0ZJN1cwu-Tk/photo.jpg?sz=128", "display_name": "Sandy QA Proffessional", "link": "https://stackoverflow.com/users/4989238/sandy-qa-proffessional"}, "edited": false, "score": 0, "creation_date": 1472654016, "post_id": 39252208, "comment_id": 65840599, "body": "What was the value of <code>output</code>? Did you receive an error? Does <code>Debug.Print Chr(34) &amp; myPath &amp; &quot;\\Command.bat&quot; &amp; Chr(34)</code> match the path to the .Bat file?"}, {"owner": {"reputation": 114, "user_id": 4989238, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-pSK_jJFh1VM/AAAAAAAAAAI/AAAAAAAAAKo/0ZJN1cwu-Tk/photo.jpg?sz=128", "display_name": "Sandy QA Proffessional", "link": "https://stackoverflow.com/users/4989238/sandy-qa-proffessional"}, "edited": false, "score": 0, "creation_date": 1472700734, "post_id": 39252208, "comment_id": 65860241, "body": "Hi Ryan, there is no error as such coming. It opens the cmd and closes it immediately. Cant really see if the commands written in .bat file was loaded either. And yes the path mentioned in code is correct. When the bat file executed it should open the RFT testing tool load a test script and execute it (This happens when i manually double click execute the bat file)"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1472653286, "creation_date": 1472653286, "answer_id": 39252208, "question_id": 39251656, "link": "https://stackoverflow.com/questions/39251656/vba-macros-not-executing-a-bat-file/39252208#39252208", "title": "VBA macros not executing a bat file", "body": "<p>Try the following. As others have mentioned building the path to the variable is a bit finicky, especially when your file path has a space. Using <code>Chr(34)</code> to represent a <code>\"</code> works well here.</p>\n\n<pre><code>Sub Macro1()\n    Dim WshShell As Object: Set WshShell = CreateObject(\"WScript.Shell\")\n    Dim MyPath as String: MyPath = Trim(CStr(Sheets(\"Sheet1\").Cells(1, 1)))\n    Output = WshShell.Run(Chr(34) &amp; myPath &amp; \"\\Command.bat\" &amp; Chr(34), 1, True)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 6734599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b30229ebcbf95e263415b525f128963?s=128&d=identicon&r=PG&f=1", "display_name": "Kier", "link": "https://stackoverflow.com/users/6734599/kier"}, "is_accepted": true, "score": 0, "last_activity_date": 1472658951, "creation_date": 1472658951, "answer_id": 39254102, "question_id": 39251656, "link": "https://stackoverflow.com/questions/39251656/vba-macros-not-executing-a-bat-file/39254102#39254102", "title": "VBA macros not executing a bat file", "body": "<p>How about trying it this way? I have tested this on a local bat file and it executes fine for me. </p>\n\n<pre><code>Dim Foldername As String\nFoldername = \"C:\\WorkspaceRFT\\RMS\\command.bat\"\nShell \"C:\\WINDOWS\\explorer.exe \"\"\" &amp; Foldername &amp; \"\", vbNormalFocus\n</code></pre>\n"}], "owner": {"reputation": 114, "user_id": 4989238, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-pSK_jJFh1VM/AAAAAAAAAAI/AAAAAAAAAKo/0ZJN1cwu-Tk/photo.jpg?sz=128", "display_name": "Sandy QA Proffessional", "link": "https://stackoverflow.com/users/4989238/sandy-qa-proffessional"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1638, "favorite_count": 0, "accepted_answer_id": 39254102, "answer_count": 2, "score": 0, "last_activity_date": 1472658951, "creation_date": 1472651781, "question_id": 39251656, "link": "https://stackoverflow.com/questions/39251656/vba-macros-not-executing-a-bat-file", "title": "VBA macros not executing a bat file", "body": "<p>I have bat file that starts and executes a testing tool silently. Double click manually the bat file does what it needs to do.\nNow i write a VBA macro that needs to execute the bat file, But the macro just opens and immediately closes it.\nfind below the macro code.</p>\n\n<pre><code>Sub Macro1()\nDim WshShell As Object\nSet WshShell = VBA.CreateObject(\"WScript.Shell\")\nWshShell.CurrentDirectory = Trim(CStr(Excel.Sheets(\"Sheet1\").Cells(1, 1)))\nOutput = WshShell.Run(\"Command.bat\", 1, True)\nEnd Sub\n</code></pre>\n\n<p>cell(1,1) in sheet one has the directory where command.bat file is present.\nWhat wrong am i doing?</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6779086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2072cb8aa0f2b465436ac1e4f01c03ec?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6779086/chris"}, "edited": false, "score": 0, "creation_date": 1472652454, "post_id": 39251543, "comment_id": 65839430, "body": "Hmm.  Now it is not running the CheckIsPic saying module not defined"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 1, "user_id": 6779086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2072cb8aa0f2b465436ac1e4f01c03ec?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6779086/chris"}, "edited": false, "score": 0, "creation_date": 1472653190, "post_id": 39251543, "comment_id": 65839949, "body": "Well, he&#39;s probably right :-) Click on CheckIsPic and press Shift+F2 to verify. If the function exists, it will bring you there."}, {"owner": {"reputation": 1, "user_id": 6779086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2072cb8aa0f2b465436ac1e4f01c03ec?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6779086/chris"}, "edited": false, "score": 0, "creation_date": 1472653943, "post_id": 39251543, "comment_id": 65840534, "body": "OK added a function at in my editted original post....No bugs but nothing seems to be changing"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1472661766, "post_id": 39251543, "comment_id": 65845539, "body": "If the picture is in a placeholder, then .Type will not be msoPicture but msoPlaceholder, in which case you need to check the .PlaceholderFormat.ContainedType (if memory serves) to see if IT is msoPicture."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1472667942, "post_id": 39251543, "comment_id": 65848904, "body": "CheckIsPic: if you write something after <code>Then</code>,  then the <code>End If</code> should be removed"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1472651446, "creation_date": 1472651446, "answer_id": 39251543, "question_id": 39251494, "link": "https://stackoverflow.com/questions/39251494/vba-powerpoint-size-and-align-2-images-on-one-slide/39251543#39251543", "title": "VBA powerpoint: Size and align 2 images on one slide", "body": "<p>I think that moving the <code>With</code> OUTSIDE the <code>Do...Loop</code> will solve the issue. (do it twice)  </p>\n\n<pre><code>With oSp\n    Do\n        .Height = (5.6 * 72)\n        .Width = (4.8 * 72)\n        .Left = (0.2 * 72)\n        .Top = (1.3 * 72)\n    Loop While oSp = ActiveWindow.Selection.ShapeRange(1)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6779086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2072cb8aa0f2b465436ac1e4f01c03ec?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6779086/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472653912, "creation_date": 1472651313, "last_edit_date": 1472653912, "question_id": 39251494, "link": "https://stackoverflow.com/questions/39251494/vba-powerpoint-size-and-align-2-images-on-one-slide", "title": "VBA powerpoint: Size and align 2 images on one slide", "body": "<p>I am trying to get two pictures to resize and align side by side...think like a before and after comparison on one slide.  The pictures are already imported to the slide.  I have two macros written, one for the left one for the right, based on the selected shape but was looking to combine to one.</p>\n\n<p>Here is what I have (rookie) to combine</p>\n\n<pre><code>'Updated Macro \nSub SidebySide()\nDim oSp As Shape\nDim oSld As Slide\n\nIf CheckIsPic(oSp) = True Then\nWith oSp\n    Do\n        .Height = (5.6 * 72)\n        .Width = (4.8 * 72)\n        .Left = (0.2 * 72)\n        .Top = (1.3 * 72)\n    Loop While oSp = ActiveWindow.Selection.ShapeRange(1)\nEnd With\n\nWith oSp\n    Do\n            .Height = (5.6 * 72)\n            .Width = (4.8 * 72)\n            .Left = (5# * 72)\n            .Top = (1.3 * 72)\n    Loop While oSp &lt;&gt; ActiveWindow.Selection.ShapeRange(1)\nEnd With\n\nEnd If\n\nEnd Sub\n\nFunction CheckIsPic(oSp As Shape) As Boolean\nIf oSp.Type = msoPicture Then CheckIsPic = True\nEnd If\nEnd Function\n</code></pre>\n\n<p>It is not running so I know I probably have something wrong in there, but essentially I am trying to run a loop if it is a pic on the slide...do A to the selection, do B to the non selection.</p>\n\n<p>Any ideas?  I am sure there is a much better way to go about this.  Thanks</p>\n"}, {"tags": ["vba", "excel", "html-email"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "edited": false, "score": 0, "creation_date": 1472654079, "post_id": 39251653, "comment_id": 65840656, "body": "Thank you, i was searching for hours trying to find this. This works perfectly."}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": false, "score": 1, "last_activity_date": 1472651778, "creation_date": 1472651778, "answer_id": 39251653, "question_id": 39251348, "link": "https://stackoverflow.com/questions/39251348/send-html-email-range/39251653#39251653", "title": "Send HTML Email Range", "body": "<p>You have a couple of options -- either by concatenating range addresses via comma or constructing separate ranges and using <code>Union</code> method. Have a look at <a href=\"https://msdn.microsoft.com/en-us/library/bb211408%28v=office.12%29.aspx\" rel=\"nofollow\">How to: Refer to Multiple Ranges</a> article in Microsoft Help. </p>\n"}, {"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 2, "last_activity_date": 1472651994, "creation_date": 1472651994, "answer_id": 39251730, "question_id": 39251348, "link": "https://stackoverflow.com/questions/39251348/send-html-email-range/39251730#39251730", "title": "Send HTML Email Range", "body": "<p>Using <code>Union</code> is pretty clean way of doing this. See below for a coded example given your code.</p>\n\n<pre><code>    Dim unionrng As Range\n    Set unionrng = Application.Union(Sheets(\"Applications\").Range(Cells(1, 1), Cells(r, 6)), _\n                                     Sheets(\"Applications\").Range(Cells(1, 8), Cells(r, 13)))\n    Sheets(\"Applications\").Range(unionrng.Address).SpecialCells (xlCellTypeVisible)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 6198644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3855af64bfb099d294f8795dbda9b73d?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/6198644/alex"}, "is_accepted": false, "score": 1, "last_activity_date": 1472652115, "creation_date": 1472652115, "answer_id": 39251785, "question_id": 39251348, "link": "https://stackoverflow.com/questions/39251348/send-html-email-range/39251785#39251785", "title": "Send HTML Email Range", "body": "<p>You could try using Union in a loop like this. </p>\n\n<pre><code>Dim x As Long\nDim y As Long\n\nFor y = 1 To 13\n    For x = 1 To r\n\n        If y &lt;&gt; 7 Then\n            If RangeCopy Is Nothing Then\n            Set RangeCopy = cells(x, y)\n            Else\n            Set RangeCopy = Application.Union(RangeCopy, cells(x, y))\n            End If\n        End If\n\n    Next x\nNext y\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 6474719, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/66b7dae9798ae1c2f7b8c03ee4f92444?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6474719/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 39251730, "answer_count": 3, "score": 0, "last_activity_date": 1472652115, "creation_date": 1472650968, "last_edit_date": 1531164843, "question_id": 39251348, "link": "https://stackoverflow.com/questions/39251348/send-html-email-range", "title": "Send HTML Email Range", "body": "<p>I have the below script which sets a range to copy to an email however I require this range to go from column 1 to 13 whilst removing column 7 (\"1:6\",\"8:13\") \nI have tried all sorts to correct this however each attempt results in an error.</p>\n\n<p>Here is the code I'm using</p>\n\n<pre><code>Set RangeCopy = Sheets(\"Applications\").Range(Cells(1, 1), Cells(R, 13)).SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>Any help is appreciated.\nThank you.</p>\n"}, {"tags": ["vba", "error-handling"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1472648582, "post_id": 39250251, "comment_id": 65836555, "body": "goto is the spawn of satan. use a porper loop instead."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 2, "last_activity_date": 1472648264, "creation_date": 1472648264, "answer_id": 39250320, "question_id": 39250251, "link": "https://stackoverflow.com/questions/39250251/how-to-handle-error-handling-once-only/39250320#39250320", "title": "How to handle error handling once only?", "body": "<pre><code>.....Dim blnRetry as Boolean\n\nblnRetry =true\n\nTryAgain:\n....\n....\n   If Not FileExists(\"C:\\\" &amp; FileName) Then\n         if blnRetry then \n               blnRetry=false\n               GoTo TryAgain \n         end if\n    End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1472650572, "post_id": 39251141, "comment_id": 65838000, "body": "This is <b><i>much</i></b> better than using <code>Goto</code>."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 2, "last_activity_date": 1472650455, "creation_date": 1472650455, "answer_id": 39251141, "question_id": 39250251, "link": "https://stackoverflow.com/questions/39250251/how-to-handle-error-handling-once-only/39251141#39251141", "title": "How to handle error handling once only?", "body": "<p>My rule about <code>GoTo</code> is that I only use it in an <code>On Error</code> statement. Consider using a <code>Do..Loop</code> and a counter. Here's an example</p>\n\n<pre><code>Sub Test()\n\n    Dim sFile As String\n    Dim lTryCnt As Long\n\n    Const lMAXTRYCNT As Long = 10\n\n    Do\n        sFile = InputBox(\"Enter file name\")\n        lTryCnt = lTryCnt + 1\n    Loop Until sFile = \"False\" Or Len(Dir(\"C:\\\" &amp; sFile)) &gt; 0 Or lTryCnt &gt;= lMAXTRYCNT\n\n    Debug.Print sFile, lTryCnt\n\nEnd Sub\n</code></pre>\n\n<p><code>sfile = \"False\"</code> is if the user clicks Cancel on the inputbox. <code>Len(Dir())</code> returns a zero length string if the file doesn't exist.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6778865"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 39250320, "answer_count": 2, "score": 0, "last_activity_date": 1472650455, "creation_date": 1472648075, "last_edit_date": 1472648390, "question_id": 39250251, "link": "https://stackoverflow.com/questions/39250251/how-to-handle-error-handling-once-only", "title": "How to handle error handling once only?", "body": "<p>I want to catch my error handling statement only once, if it fails again, resume next. I'm not sure how to achieve that but so far i'm able to rerun the code if it keeps on failing. Reason is i don't want to get stuck in a loop if the file never exist. Here's what i have:</p>\n\n<pre><code>....some code\n\nTryAgain:\n\n....\n....\n    If Not FileExists(\"C:\\\" &amp; FileName) Then\n         GoTo TryAgain &gt;&gt;&gt; Only want to run this once if it fails again continue on down with the next section of codes.\n    End If\n\n ....next code stuff....\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1472648064, "post_id": 39250140, "comment_id": 65836203, "body": "My suggestion is to map the data ranges from the multiple sheets into a single, contiguous range on a single sheet and use that as the source. I don&#39;t believe Excel can handle discontinuous ranges across sheets."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472648335, "post_id": 39250140, "comment_id": 65836401, "body": "@JessieQuick you can create a chart, and later on create each Series and correlate it&#39;s source data range to your desired range. will that solution works for you?"}, {"owner": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472650359, "post_id": 39250140, "comment_id": 65837837, "body": "@Shai Rado Thanks for that idear! it works perfect for me and still fast with no excel crash!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472651984, "post_id": 39250140, "comment_id": 65839084, "body": "@JessieQuick so you have it resolved ? you can asnwer your own post"}, {"owner": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472652780, "post_id": 39250140, "comment_id": 65839654, "body": "I will post a resolve as soon as I have a more beautiful code for my fix around from @Shai Rado&#39;s idear."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472664801, "post_id": 39250140, "comment_id": 65847161, "body": "@JessieQuick can I suggest my assistance ?"}, {"owner": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472682583, "post_id": 39250140, "comment_id": 65855940, "body": "@Shai Rado I posted an update  under my question with what i think you ment."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472699908, "post_id": 39250140, "comment_id": 65860072, "body": "@JessieQuick see my answer below on how to define <code>xRng</code>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "edited": false, "score": 0, "creation_date": 1472679895, "post_id": 39253978, "comment_id": 65854993, "body": "example in the .Range(&quot;Poste_EtatDeLaDemande&quot;) you only need the data from 34-100 how til this work out?"}, {"owner": {"reputation": 648, "user_id": 4049983, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nIZx9Y1bVes/AAAAAAAAAAI/AAAAAAAAAB8/Cn-3Si3KWuo/photo.jpg?sz=128", "display_name": "Yiao SUN", "link": "https://stackoverflow.com/users/4049983/yiao-sun"}, "reply_to_user": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "edited": false, "score": 0, "creation_date": 1472680606, "post_id": 39253978, "comment_id": 65855236, "body": "Your plage can be bigger when you insert a new line in it, what ever if you wan to get 34 to 100 you can use &#39;range(&quot;poste_etatdelademande&quot;).row&#39; get the position of the first line of your plage &#39;poste_etatdelademande&#39; and then you can calculate which line you want"}, {"owner": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "edited": false, "score": 0, "creation_date": 1472713744, "post_id": 39253978, "comment_id": 65864724, "body": "The problem with this is that I cant just do the same on a new workbook contain the same data, I need to go in and plage every new workbook?"}, {"owner": {"reputation": 648, "user_id": 4049983, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nIZx9Y1bVes/AAAAAAAAAAI/AAAAAAAAAB8/Cn-3Si3KWuo/photo.jpg?sz=128", "display_name": "Yiao SUN", "link": "https://stackoverflow.com/users/4049983/yiao-sun"}, "reply_to_user": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "edited": false, "score": 0, "creation_date": 1472714057, "post_id": 39253978, "comment_id": 65864933, "body": "Yes, that what I did with my project."}], "tags": [], "owner": {"reputation": 648, "user_id": 4049983, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nIZx9Y1bVes/AAAAAAAAAAI/AAAAAAAAAB8/Cn-3Si3KWuo/photo.jpg?sz=128", "display_name": "Yiao SUN", "link": "https://stackoverflow.com/users/4049983/yiao-sun"}, "is_accepted": false, "score": 0, "last_activity_date": 1472658528, "creation_date": 1472658528, "answer_id": 39253978, "question_id": 39250140, "link": "https://stackoverflow.com/questions/39250140/mulit-plot-from-different-sheets-in-one-chart-with-vba/39253978#39253978", "title": "mulit plot from different sheets in one chart with VBA", "body": "<p>My solution is use Name of plage, you can give a name of your range<br>\nLike in my photo :\n<a href=\"https://i.stack.imgur.com/9TnT6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9TnT6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Everytime when you want to use these datas you just need call them \nLike this plage i gived them name <code>Poste_EtatDeLaDemande</code> <br><br>\n<a href=\"https://i.stack.imgur.com/C2WY5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C2WY5.png\" alt=\"enter image description here\"></a></p>\n\n<p>When i want to use these elements i just call it like <code>Range(\"Poste_EtatDeLaDemande\")</code> Excel will find it you don't need tell them where it is anymore ; )</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "edited": false, "score": 0, "creation_date": 1472713609, "post_id": 39262174, "comment_id": 65864638, "body": "Union() will plot the two graph to one graph, since last night i was thinking is it possible to make all the sheets into an array of sheets with range?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "edited": false, "score": 0, "creation_date": 1472713924, "post_id": 39262174, "comment_id": 65864837, "body": "I thought the whole idea you want to merge the <code>Range</code> is to have them in the same series, you dont ? <code>Range(&quot;A1:A20&quot;)</code> suppost to be one series, and <code>Range(&quot;C1:C20&quot;)</code> suppost to be another series on the chart ?"}, {"owner": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "edited": false, "score": 0, "creation_date": 1472717550, "post_id": 39262174, "comment_id": 65866994, "body": "no, the idea is to plot like 2  graph from sheet1 (with out merging them) and one graph from sheet2.. etc"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "edited": false, "score": 0, "creation_date": 1472720191, "post_id": 39262174, "comment_id": 65868625, "body": "@JessieQuick try the edited code, I think you&#39;ll like it"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1472720174, "last_edit_date": 1472720174, "creation_date": 1472699883, "answer_id": 39262174, "question_id": 39250140, "link": "https://stackoverflow.com/questions/39250140/mulit-plot-from-different-sheets-in-one-chart-with-vba/39262174#39262174", "title": "mulit plot from different sheets in one chart with VBA", "body": "<p>Responding to your latest update, I have a <code>Sub</code> that creates a series each time it's called from <strong><em>MultiSheetPlot</em></strong> Sub. </p>\n\n<p>You can actually add more parameters to this Sub (as long as you remeber to pass them in the Calling).</p>\n\n<pre><code>Option Explicit\n\nDim cht                             As Chart\n\nSub MultiSheetPlot()\n\nSet cht = Charts.Add\ncht.ChartType = xlLine\n\n' call the series creation chart function (each time for each series you want to add to the existing chart\nCall Create_SeriesChart(\"Sheet1\", Sheets(\"Sheet1\").Range(\"E12:E6232\"), 1, True, msoThemeColorText1)\nCall Create_SeriesChart(\"Sheet1\", Sheets(\"Sheet1\").Range(\"Y12:Y6232\"), 1, True, msoThemeColorText1)\n\nEnd Sub\n\n' ------ this Sub creates a series to the chart, it receives the following parameters: ------\n' 1. seriesName - String\n' 2. serValues - Range\n' 3. lineWeight - Double (the weight of the line)\n' 4. lineVis - Boolean (if you want to hide a certail series)\n' 5. lineColor - MsoColorType (using the current's PC Theme colors\n\nSub Create_SeriesChart(seriesName As String, serValues As Range, lineWeight As Double, lineVis As Boolean, lineColor As MsoColorType)\n\nDim Ser                             As Series\n\nSet Ser = cht.SeriesCollection.NewSeries\n\nWith Ser\n    .Name = seriesName\n    .Values = serValues\n\n    .Format.Line.Weight = lineWeight\n    If lineVis = True Then\n        .Format.Line.Visible = msoTrue\n    Else\n        .Format.Line.Visible = msoFalse\n    End If\n    .Format.Line.ForeColor.ObjectThemeColor = lineColor   ' Line color Black\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4030696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Ecqis.png?s=128&g=1", "display_name": "JessieQuick", "link": "https://stackoverflow.com/users/4030696/jessiequick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1358, "favorite_count": 0, "accepted_answer_id": 39262174, "answer_count": 2, "score": 1, "last_activity_date": 1472720174, "creation_date": 1472647760, "last_edit_date": 1531164843, "question_id": 39250140, "link": "https://stackoverflow.com/questions/39250140/mulit-plot-from-different-sheets-in-one-chart-with-vba", "title": "mulit plot from different sheets in one chart with VBA", "body": "<p>My problem is that I want to make many graph in one chart but the data is from different sheets. </p>\n\n<p>At the moment my code can only take multi data from one sheet, meaning I can plot 2 graph from one sheet.\nMy code at the moment is: </p>\n\n<pre><code>Sub ChartSheet()\n\n    Dim ChartSheet1 As Chart\n    Set ChartSheet1 = Charts.Add\n    With ChartSheet1\n        .SetSourceData Source:=Sheets(\"Sheet1\").Range(\"E12:E6232, Y12:Y6232\")\n        .ChartType = xlLine\n        .HasTitle = True\n        .ChartTitle.Characters.Text = \"Test Chart\"\n        .Axes(xlCategory, xlPrimary).HasTitle = True\n        .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"x\"\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"y\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>What I want is to say: </p>\n\n<pre><code>.SetSourceData Source:=Sheets(\"Sheet1\").Range(\"E12:E6232, Y12:Y6232\")\n.SetSourceData Source:=Sheets(\"Sheet2\").Range(\"D12:E23\")\n.SetSourceData Source:=Sheets(\"Sheet3\").Range(\"Y12:Y6232, G27:G496, H3:5977\")\n</code></pre>\n\n<p>and so on.. \nBut when I do this my code it only print the last line from .SetSoureData</p>\n\n<p>Hope some of you can help me work around this, Many thank in advarnce :)</p>\n\n<p><strong>Update:</strong> \nI found abit of a work around by looping but this is not my total answer\nBut here is my other code: </p>\n\n<pre><code>Sub MultiSheetPlot()\n\nDim cht As Chart, s As Series, xRng As Range\nDim i As Long, chartName As String\n\n    Set cht = Charts.Add\n    cht.ChartType = xlLine\n\n\n    For i = 1 To 3\n\n        chartName = \"Sheet\" &amp; i\n        Set xRng = Sheets(\"Sheet1\").Range(\"A1:A20, C1:C20\")\n\n        With cht.SeriesCollection.NewSeries()\n            .Values = xRng\n            .Name = chartName\n        End With\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>the problem in this code is that it ignores the last range I define like the C10:C20</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1472647666, "post_id": 39249814, "comment_id": 65835901, "body": "You could add a comment easily enough which could be seen in explorer, are you stuck to using tags?"}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1472647740, "post_id": 39249814, "comment_id": 65835968, "body": "Can you be more specific?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1472647852, "post_id": 39249814, "comment_id": 65836042, "body": "Where the &quot;tags&quot; information is displayed in windows explorer - you can also display &quot;comments&quot;. It&#39;s easy to add these comments to the file using VBA but extremely difficult to add tags as these can only be added to a closed file and there&#39;s no native support in VBA to do this easily."}, {"owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1472647977, "post_id": 39249814, "comment_id": 65836140, "body": "that will do, too. I am looking for a way to make life easier for the users, when searching their file into the folder."}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1472648247, "creation_date": 1472648247, "answer_id": 39250314, "question_id": 39249814, "link": "https://stackoverflow.com/questions/39249814/macro-to-tag-generated-files/39250314#39250314", "title": "Macro to tag generated files", "body": "<p>You can use the <code>BuiltInDocumentProperties</code> collection to add a comment which can also be searched for in windows explorer:</p>\n\n<pre><code>'// workbook must be open\nSet targetWorkbook = Workbooks(\"My Workbook.xlsx\")\n\n'// add a comment to the workbook\ntargetWorkbook.BuiltInDocumentProperties(\"Comments\").Value = \"my comment\"\n\n'// save the workbook\ntargetWorkbook.SaveAs \"C:\\Workbooks\\My Saved Workbook.xlsx\", xlOpenXMLWorkbook\n</code></pre>\n\n<p>The workbook will now have a comment of \"my comment\" which can be searched for in windows explorer.</p>\n"}], "owner": {"reputation": 821, "user_id": 6143650, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/OyfHo.jpg?s=128&g=1", "display_name": "L.Dutch - Reinstate Monica", "link": "https://stackoverflow.com/users/6143650/l-dutch-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1115, "favorite_count": 0, "accepted_answer_id": 39250314, "answer_count": 1, "score": -1, "last_activity_date": 1472648247, "creation_date": 1472646831, "last_edit_date": 1531164843, "question_id": 39249814, "link": "https://stackoverflow.com/questions/39249814/macro-to-tag-generated-files", "title": "Macro to tag generated files", "body": "<p>I have written a macro in an Excel file to create and save to a specific folder another Excel file.\nIs there any way to tag the generated file, so that the tag are visible in Windows Explorer while browsing the folder where the files are saved? </p>\n"}, {"tags": ["vba", "date", "macros", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1472649155, "post_id": 39249099, "comment_id": 65836974, "body": "thank you for your help but i didn&#39;t exactly understand what i have to do? I don&#39;t find the solution for this"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1472653051, "post_id": 39249099, "comment_id": 65839850, "body": "textframe.textrange.text = NEXT_THURSDAY(now)  would be how you&#39;d use, add this code to your VBA code, in a new module if you like and then use like so."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1472644879, "creation_date": 1472644879, "answer_id": 39249099, "question_id": 39248997, "link": "https://stackoverflow.com/questions/39248997/powerpoint-macro-to-get-the-date-of-the-next-thursday-from-the-current-date/39249099#39249099", "title": "PowerPoint macro to get the date of the next Thursday from the current date", "body": "<p>Something like this will help, read the WeekDay help</p>\n\n<pre><code>Function NEXT_THURSDAY(dtFrom As Date) As Date\n\nDim intCurrentDay As Integer\n\nintCurrentDay = Weekday(dtFrom, vbThursday)\n\nNEXT_THURSDAY = DateAdd(\"d\", 8 - intCurrentDay, dtFrom)\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1472647607, "post_id": 39249478, "comment_id": 65835863, "body": "<code>Option Explicit</code> is a very good suggestion! I agree, it should always be used."}], "tags": [], "owner": {"reputation": 5254, "user_id": 24447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da74b7df5db7590fc140329c62b3e498?s=128&d=identicon&r=PG", "display_name": "nekomatic", "link": "https://stackoverflow.com/users/24447/nekomatic"}, "is_accepted": false, "score": 1, "last_activity_date": 1472645961, "creation_date": 1472645961, "answer_id": 39249478, "question_id": 39248997, "link": "https://stackoverflow.com/questions/39248997/powerpoint-macro-to-get-the-date-of-the-next-thursday-from-the-current-date/39249478#39249478", "title": "PowerPoint macro to get the date of the next Thursday from the current date", "body": "<p>I think you have misunderstood the syntax of the <code>Select Case</code> statement.</p>\n\n<p>You begin with</p>\n\n<pre><code>Select Case Thursday\n</code></pre>\n\n<p>but you haven't defined <code>Thursday</code>, so VBA will assume this new variable is equal to 0.</p>\n\n<p>Your first case is then</p>\n\n<pre><code>Case oldWeekDay = 1\n</code></pre>\n\n<p>but <code>Case</code> should be followed by a <em>value</em>, not a comparison. VBA is evaluating the comparison <code>oldWeekDay = 1</code> and if it is false, converting that to a value of 0. So the first case will always execute, unless <code>oldWeekDay</code> is actually equal to 1.</p>\n\n<p>What I think you wanted to write was</p>\n\n<pre><code>Select Case oldWeekDay\n    Case 1\n    .TextFrame.TextRange.Text = Format(Now + 4, \" dd.mm.yyyy\")\n</code></pre>\n\n<p>and so on.</p>\n\n<p>Note that if you added the statement <code>Option Explicit</code> at the top of your VBA module, you would instead have got a <code>Variable not defined</code> error for the <code>Select Case</code> line. It's highly recommended to always use <code>Option Explicit</code> for this sort of reason.</p>\n"}], "owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472645961, "creation_date": 1472644564, "last_edit_date": 1472645283, "question_id": 39248997, "link": "https://stackoverflow.com/questions/39248997/powerpoint-macro-to-get-the-date-of-the-next-thursday-from-the-current-date", "title": "PowerPoint macro to get the date of the next Thursday from the current date", "body": "<p>I'm trying to get the date of next Thursday from the current date and write it in the first slide. So far I have the current date but I didn't find how to get the date of the next Thursday. For example I open my presentation on Tuesday 23.08.2016 and when my macro runs I want to get 25.08.2016 (which corresponds to Thursday) on the first slide. </p>\n\n<p>So far I have:</p>\n\n<pre><code>Set objPPTX = CreateObject(\"PowerPoint.Application\")\nobjPPTX.Visible = True\n'Adding Date on First Slide \nSet PPApp = GetObject(, \"Powerpoint.Application\")\n    Set PPPres = PPApp.ActivePresentation\n    PPApp.ActiveWindow.ViewType = ppViewSlide\n    PPApp.Visible = True\n     Set PPSlide = PPPres.Slides(PPApp.ActiveWindow.Selection.SlideRange.SlideIndex)\n\n' Set PPshape = PPSlide.Shapes.AddShape(Type:=msoShapeRectangle, Left:=220, Top:=150, Width:=270, Height:=75)\n Set PPshape1 = PPSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, Left:=20, Top:=150, Width:=680, Height:=70)\n With PPshape1\n .TextFrame.TextRange.Text = \"PT PM Weekly\"\n .TextFrame.TextRange.Font.Name = \"Verdana\"\n .TextFrame.TextRange.Font.Color = vbBlack\n .TextFrame.TextRange.Font.Size = 48\n End With\n\n Set PPshape = PPSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, Left:=350, Top:=150, Width:=680, Height:=70)\nWith PPshape\n\n\nTodate = DateValue(Now)\noldWeekDay = Weekday(Now)\nSelect Case Thursday\n\nCase oldWeekDay = 1\n.TextFrame.TextRange.Text = Format(Now + 4, \" dd.mm.yyyy\")\nCase oldWeekDay = 2\n.TextFrame.TextRange.Text = Format(Now + 3, \" dd.mm.yyyy\")\nCase oldWeekDay = 3\n.TextFrame.TextRange.Text = Format(Now + 2, \" dd.mm.yyyy\")\nCase oldWeekDay = 4\n.TextFrame.TextRange.Text = Format(Now + 1, \" dd.mm.yyyy\")\nCase oldWeekDay = 5\n.TextFrame.TextRange.Text = Format(Now, \" dd.mm.yyyy\")\nCase oldWeekDay = 6\n.TextFrame.TextRange.Text = Format(Now - 1, \" dd.mm.yyyy\")\nCase oldWeekDay = 7\n.TextFrame.TextRange.Text = Format(Now - 2, \" dd.mm.yyyy\")\n\nEnd Select\n\n.TextFrame.TextRange.Font.Name = \"Verdana\"\n.TextFrame.TextRange.Font.Color = vbBlack\n.TextFrame.TextRange.Font.Size = 48\nEnd With\n</code></pre>\n\n<p>but at the end i just get +4 from the current date so I think that the problem is in the Case structure.</p>\n"}, {"tags": ["vba", "excel", "macros", "userform"], "comments": [{"owner": {"reputation": 321, "user_id": 2183786, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/36e2751c8af5977fc1cfe24ced9413e1?s=128&d=identicon&r=PG", "display_name": "James Baker", "link": "https://stackoverflow.com/users/2183786/james-baker"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472653853, "post_id": 39248907, "comment_id": 65840467, "body": "Sorry @ShaiRado I haven&#39;t tried it. Managed to work out my own solution before I checked yours. Thanks though."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1472645025, "creation_date": 1472645025, "answer_id": 39249156, "question_id": 39248907, "link": "https://stackoverflow.com/questions/39248907/changing-colour-of-cells-using-command-button-vba-excel/39249156#39249156", "title": "Changing colour of cells using command button (VBA Excel)", "body": "<p>Try the function which I use on several Applications, it's slightly converted to fit your original minimalized code, let me know if it works for you...</p>\n\n<pre><code>Private Sub Primary_Click()\n\nConst ColorIndexLast                As Long = 32       'index of last custom color in palette\nDim PickNewColor                    As Double          'color that was picked in the dialogue\nDim myOrgColor                      As Double          'original color of color index 32\n\n'save original palette color,modify Range according to your needs\nmyOrgColor = Range(\"A1\").Interior.Color\n\n'call the color picker dialogue\nIf Application.Dialogs(xlDialogEditColor).Show(ColorIndexLast) = True Then\n\n    ' \"OK\" was pressed, read the new color from the palette\n    PickNewColor = ActiveWorkbook.Colors(ColorIndexLast)\n    ActiveWorkbook.Colors(ColorIndexLast) = myOrgColor  ' reset palette color to its original value\nElse\n    ' \"Cancel\" was pressed, palette wasn't changed &gt;&gt; return old color (or xlNone if no color was passed to the function)\n    PickNewColor = myOrgColor\nEnd If\n\n' update Colors in relevant Cell\nRange(\"A1\").Interior.Color = PickNewColor\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 321, "user_id": 2183786, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/36e2751c8af5977fc1cfe24ced9413e1?s=128&d=identicon&r=PG", "display_name": "James Baker", "link": "https://stackoverflow.com/users/2183786/james-baker"}, "is_accepted": false, "score": 0, "last_activity_date": 1472653670, "creation_date": 1472653670, "answer_id": 39252354, "question_id": 39248907, "link": "https://stackoverflow.com/questions/39248907/changing-colour-of-cells-using-command-button-vba-excel/39252354#39252354", "title": "Changing colour of cells using command button (VBA Excel)", "body": "<p>This is the solution I arrived at:</p>\n\n<pre><code>Private Sub Primary_Click()\n\nDim cs As Worksheet\nSet cs = Sheets(\"ColourScheme\")\n\nDim newColour As Long\n\nApplication.Dialogs(xlDialogEditColor).Show (1)\n\nnewColour = ThisWorkbook.Colors(1)\n\ncs.Range(\"B1\").Interior.color = newColour\n\nPrimary.BackColor = newColour\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 2183786, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/36e2751c8af5977fc1cfe24ced9413e1?s=128&d=identicon&r=PG", "display_name": "James Baker", "link": "https://stackoverflow.com/users/2183786/james-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1657, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1472653670, "creation_date": 1472644288, "question_id": 39248907, "link": "https://stackoverflow.com/questions/39248907/changing-colour-of-cells-using-command-button-vba-excel", "title": "Changing colour of cells using command button (VBA Excel)", "body": "<p>I currently have a userform that loads up with three command buttons (primary, secondary and tertiary). The idea here is that a user will select their own colour scheme using these three buttons.</p>\n\n<p>I have cells in my workbook that represent each colour and then a macro which sets all chart objects to these colours (using the cells) when it is run.</p>\n\n<p>I have managed to initialise the userform so that the three command buttons interior colour is determined by the three cells in my workbook:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim cs As Worksheet\nSet cs = Sheets(\"ColourScheme\")\n\nTextBox1.SetFocus '' Shift focus away from primary\n\nPrimary.BackColor = cs.Range(\"B1\").Interior.color\nSecondary.BackColor = cs.Range(\"B2\").Interior.color\nTertiary.BackColor = cs.Range(\"B3\").Interior.color\n\nEnd Sub\n</code></pre>\n\n<p>What I want to do now is that when each button is clicked, the colour palette loads up, the user selects a colour either using the wheel or an RGB figure and then finally the cells in my workbook and the command buttons interior colour change based on the user's choice.</p>\n\n<p>I don't know if this can be done but so far I'm having no luck with anything I've tried to load the palette up:</p>\n\n<pre><code>Private Sub Primary_Click()\n\nApplication.Dialogs.Item(xlDialogColorPalette).Show\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "edited": false, "score": 1, "creation_date": 1472642542, "post_id": 39248144, "comment_id": 65832300, "body": "Why is myUrls defined as Variant? If I were a compiler, I&#39;d think that myUrls is an array of Strings..."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 5, "creation_date": 1472642571, "post_id": 39248144, "comment_id": 65832315, "body": "Is there a sub at the bottom? as currently that piece of code is not inside a <code>Function or </code>Sub` thus will not work."}, {"owner": {"reputation": 57, "user_id": 6757082, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/be08e482d40097dcafce20d4c041eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6757082/kyle"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1472647742, "post_id": 39248144, "comment_id": 65835970, "body": "@dragonsamu I&#39;m working off a suggestion -- so I never was clear on how that would run just sitting at the bottom. Its an integral piece, because it allows me to cycle through my URL list. How do you suggest I update?"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6757082, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/be08e482d40097dcafce20d4c041eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6757082/kyle"}, "edited": false, "score": 0, "creation_date": 1472653550, "post_id": 39251418, "comment_id": 65840228, "body": "&quot;Compile error: Next without For&quot; error under the sub <code>FillTaxiInfo</code>. Not sure why... seems there are both...? Also, under <code>GetJson</code> I initially tried <code>.Open &quot;GET&quot;, myUrls(i)</code> but it did not allow the variable <code>myUrls(i)</code> which I believe I need to cycle through my URLs, no?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 57, "user_id": 6757082, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/be08e482d40097dcafce20d4c041eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6757082/kyle"}, "edited": false, "score": 0, "creation_date": 1472653701, "post_id": 39251418, "comment_id": 65840358, "body": "@Kyle - There was a missing <code>End If</code> in your code that I missed.  See edit."}, {"owner": {"reputation": 57, "user_id": 6757082, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/be08e482d40097dcafce20d4c041eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6757082/kyle"}, "edited": false, "score": 0, "creation_date": 1472654577, "post_id": 39251418, "comment_id": 65841056, "body": "thanks. Now getting a &quot;type mismatch&quot; error on <code>For i = 0 To UBound(data(&quot;prices&quot;)) - 1</code> under <code>FillTaxiInfo</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 57, "user_id": 6757082, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/be08e482d40097dcafce20d4c041eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6757082/kyle"}, "edited": false, "score": 1, "creation_date": 1472661342, "post_id": 39251418, "comment_id": 65845329, "body": "@Kyle - I have no clue what <code>data(&quot;prices&quot;)</code> contains, but that error would indicate that it isn&#39;t an array."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1472653699, "last_edit_date": 1472653699, "creation_date": 1472651121, "answer_id": 39251418, "question_id": 39248144, "link": "https://stackoverflow.com/questions/39248144/how-do-i-organize-and-structure-multi-sub-function-vba-code-such-that-it-actuall/39251418#39251418", "title": "How do I organize and structure multi-sub/function VBA code such that it actually runs?", "body": "<p>Move the global variable to the top, then make an entry point sub that initializes it and executes <code>FillMultipleCityInfo</code>:</p>\n\n<pre><code>Option Explicit\n\nDim myUrls As Variant\n\nPublic Sub RunThis()\n    myUrls = Array(\"URL1\", \"URL2\", \"URL3\", \"URL4\", \"URL5\", \"URL6\", \"URL7\")\n    FillMultipleCityInfo myUrls, ActiveWorkbook\nEnd Sub\n\nFunction GetJson(ByVal url As String) As Dictionary\n    With New WinHttpRequest\n        .Open \"GET\", \"URL\" ''[Should this be a random URL, my list of URLs?]\n        .Send\n        Set GetJson = JsonConverter.ParseJson(.ResponseText)\n    End With\nEnd Function\n\nSub FillTaxiInfo(data As Dictionary, sheet As Worksheet)\n    Dim i As Integer, taxi As Dictionary\n    For i = 0 To UBound(data(\"prices\")) - 1\n        Set taxi = data(\"prices\")(i)\n        If taxi.Exists(\"ViewDisplayName\") Then\n          sheet.Cells(i, 1) = taxi(\"ViewDisplayName\")\n          sheet.Cells(i, 2) = taxi(\"fare\")(\"fareType\")\n        End If \n    Next i\nEnd Sub\n\nSub FillMultipleCityInfo(myUrls As Variant, book As Workbook)\n    Dim i As Integer, data As Dictionary, sheet As Worksheet\n\n    For i = 0 To UBound(myUrls) - 1\n        Set data = GetJson(myUrls(i))\n        Set sheet = book.Sheets(i + 1)\n        FillTaxiInfo data, sheet\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6757082, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/be08e482d40097dcafce20d4c041eb7d?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/6757082/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1502719482, "creation_date": 1472642163, "last_edit_date": 1531164843, "question_id": 39248144, "link": "https://stackoverflow.com/questions/39248144/how-do-i-organize-and-structure-multi-sub-function-vba-code-such-that-it-actuall", "title": "How do I organize and structure multi-sub/function VBA code such that it actually runs?", "body": "<p>How do I setup a run/macro to execute the below code. I've tried many things, including creating a new module that only calls each of the subs individually -- no luck. The output for this project should be an excel workbook that contains  worksheets (4 rows x 8 columns) with parsed JSON text in each cell. The worksheets correspond to unique URLs. For example, Sheet1 = URL1 data, Sheet2 = URL2 data, etc.</p>\n\n<pre><code>Option Explicit\n\nFunction GetJson(ByVal url As String) As Dictionary\n\nWith New WinHttpRequest\n    .Open \"GET\", \"URL\" ''[Should this be a random URL, my list of URLs?] \n    .Send\n    Set GetJson = JsonConverter.ParseJson(.ResponseText)\nEnd With\n\nEnd Function\n\nSub FillTaxiInfo(data As Dictionary, sheet As Worksheet)\nDim i As Integer, taxi As Dictionary\nFor i = 0 To UBound(data(\"prices\")) - 1\n    Set taxi = data(\"prices\")(i)\n    If taxi.Exists(\"ViewDisplayName\") Then\n      sheet.Cells(i, 1) = taxi(\"ViewDisplayName\")\n      sheet.Cells(i, 2) = taxi(\"fare\")(\"fareType\")\nNext i\n\nEnd Sub\n\nSub FillMultipleCityInfo(myUrls As Variant, book As Workbook)\n\nDim i As Integer, data As Dictionary, sheet As Worksheet\n\nFor i = 0 To UBound(myUrls) - 1\n    Set data = GetJson(myUrls(i))\n    Set sheet = book.Sheets(i + 1)\n    FillTaxiInfo data, sheet\nNext i\nEnd Sub\n\n Dim myUrls As Variant\nmyUrls = Array(\"URL1\", \"URL2\", \"URL3\", \"URL4\", \"URL5\", \"URL6\", \"URL7\")\nFillMultipleCityInfo myUrls, ActiveWorkbook\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 22, "user_id": 2752125, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/462251285dee124030fa55a456d4fd42?s=128&d=identicon&r=PG&f=1", "display_name": "elit elit", "link": "https://stackoverflow.com/users/2752125/elit-elit"}, "edited": false, "score": 0, "creation_date": 1472656915, "post_id": 39248036, "comment_id": 65842727, "body": "I tried to combine both but still receive error <code>strSqla = &quot;SELECT DT4.ABALPH, DT4.S1, CASE WHEN S1= &#39;AV&#39; OR S1= &#39;AN&#39; OR S1= &#39;AY&#39; THEN &#39;XDE&#39; &quot; &amp; _     &quot;WHEN S1= &#39;AE&#39; OR S1= &#39;AH&#39; OR S1= &#39;AK&#39; OR S1= &#39;XE&#39; THEN &#39;XME&#39; &quot;     strSqla = strSqla &amp; &quot;ELSE &#39;MANUAL&#39; END AS div &quot;     strSqla = strSqla &amp; &quot;FROM H9.PCFILE.DT4 DT4 WHERE DT4.IDATE &gt; &#39;&quot; &amp; X &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 22, "user_id": 2752125, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/462251285dee124030fa55a456d4fd42?s=128&d=identicon&r=PG&f=1", "display_name": "elit elit", "link": "https://stackoverflow.com/users/2752125/elit-elit"}, "edited": false, "score": 0, "creation_date": 1472657028, "post_id": 39248036, "comment_id": 65842802, "body": "Is that supposed to mean something to me?"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1472641856, "creation_date": 1472641856, "answer_id": 39248036, "question_id": 39247948, "link": "https://stackoverflow.com/questions/39247948/divide-sql-query-on-excel-vba/39248036#39248036", "title": "Divide sql query on excel vba", "body": "<p>use line continuators and string concatenation:</p>\n\n<pre><code>strSqla = \"SELECT DT4 .ABH, DT4 .S1 , CASE WHEN S1 = 'AV' OR \" &amp; _\n          \"S1 = 'AN' OR S1 = 'AY' THEN 'PDE' WHEN S1 = 'AE' OR \" &amp; _\n          \"S1 = 'AH' OR S1 = 'AK' OR S1 = 'FE' THEN 'EME' \" &amp; _\n          \"ELSE 'MANUAL' END AS division FROM H9.PCFILES.DT4 \" &amp; _\n          \"DT4 WHERE DT4 .IDATE &gt; '\" &amp; X &amp; \"'\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22, "user_id": 2752125, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/462251285dee124030fa55a456d4fd42?s=128&d=identicon&r=PG&f=1", "display_name": "elit elit", "link": "https://stackoverflow.com/users/2752125/elit-elit"}, "edited": false, "score": 0, "creation_date": 1472708734, "post_id": 39250234, "comment_id": 65862396, "body": "Martin Thank you for your response, I tried second option, get SQL query from cell, but still get &quot;type mismatch&quot; error. I tried; Write all code in one cell, dvide and write in to one cell, divide codes to 2 cell. non of them works :( fetchSQL = this line gives error, without going second line."}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 22, "user_id": 2752125, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/462251285dee124030fa55a456d4fd42?s=128&d=identicon&r=PG&f=1", "display_name": "elit elit", "link": "https://stackoverflow.com/users/2752125/elit-elit"}, "edited": false, "score": 0, "creation_date": 1472725021, "post_id": 39250234, "comment_id": 65872072, "body": "Why are you using <code>.CommandText = Array(fetchSQL)</code> instead of  <code>.CommandText = fetchSQL</code>? ` Try <code>Debug.Print (fetchSQL)</code> for testing to check if your SQL-String looks like you would expect before using it."}, {"owner": {"reputation": 22, "user_id": 2752125, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/462251285dee124030fa55a456d4fd42?s=128&d=identicon&r=PG&f=1", "display_name": "elit elit", "link": "https://stackoverflow.com/users/2752125/elit-elit"}, "edited": false, "score": 0, "creation_date": 1472738270, "post_id": 39250234, "comment_id": 65881656, "body": "Thank you Martin! now with your correction option 1 is working. But still I have error on option 2 get query from cell. <a href=\"http://i66.tinypic.com/i2klms.jpg\" rel=\"nofollow noreferrer\">link</a>  divided query into cells, write to single cell, add &quot;&quot; or continuations, non of them works <a href=\"http://i67.tinypic.com/8vt94x.jpg\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 22, "user_id": 2752125, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/462251285dee124030fa55a456d4fd42?s=128&d=identicon&r=PG&f=1", "display_name": "elit elit", "link": "https://stackoverflow.com/users/2752125/elit-elit"}, "edited": false, "score": 0, "creation_date": 1476887595, "post_id": 39250234, "comment_id": 67538657, "body": "elit, I am sorry - I missed your response. AFAIK SQL in Excel doesn&#39;t support <code>CASE</code> Expressions. Use the <a href=\"https://www.techonthenet.com/access/functions/advanced/switch.php\" rel=\"nofollow noreferrer\"><code>SWITCH</code> function</a> instead and see if it works. Also, for first testing, try a slightly less complex query where you can rule out any syntax errors, like <code>select top 10 * from yourtable</code>"}], "tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": false, "score": 0, "last_activity_date": 1472724597, "last_edit_date": 1472724597, "creation_date": 1472648046, "answer_id": 39250234, "question_id": 39247948, "link": "https://stackoverflow.com/questions/39247948/divide-sql-query-on-excel-vba/39250234#39250234", "title": "Divide sql query on excel vba", "body": "<p>As an addition to what <code>Macro Man</code> said:</p>\n\n<ul>\n<li>there's a limit to line continuation at about 20 lines</li>\n<li><p>after that one has to resort to something like you did</p>\n\n<p><code>strSqla = \" .... \"\nstrSqla = strSqla &amp; \" .... \"</code></p></li>\n<li><p>either way, the query construction gets clumsy rather quick, especially if you have single quote <code>'string-expressions'</code></p></li>\n</ul>\n\n<p>So, should you use longer SQLs frequently and change them occassionally, consider one of the following Alternatives:</p>\n\n<p>A) Storing the SQL in separate textfiles, then read them into a string with a stored function like so:</p>\n\n<pre><code>Function fetchSQL(path As String) As String\n    Dim Line As String\n    Dim iFile As Integer\n    iFile = FreeFile\n    Open path For Input As #iFile\n\n    Do Until EOF(iFile)\n        Line Input #iFile, Line\n        fetchSQL = fetchSQL &amp; vbNewLine &amp; Line\n    Loop\n\n    Close #iFile\nEnd Function\n</code></pre>\n\n<p>and use it in your code like this:</p>\n\n<pre><code>strSqla = fetchSQL(\"c:\\yourpath\\p01.sql\")\n</code></pre>\n\n<p>B) Alternatively, if you prefer storing your SQL inside your workbook (assuming you use excel), you ofc store the SQL inside a worksheet-column instead and use something like this:</p>\n\n<pre><code>Function fetchSQL as String()\n    Dim i as Integer\n    i = 1\n    While Not IsEmpty(yoursheet.Cells(i, 2))\n        fetchSQL = strSQL &amp; vbCrLf &amp; \" \" &amp; yoursheet.Cells(i, 2).Value\n        i = i + 1\n    Wend\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22, "user_id": 2752125, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/462251285dee124030fa55a456d4fd42?s=128&d=identicon&r=PG&f=1", "display_name": "elit elit", "link": "https://stackoverflow.com/users/2752125/elit-elit"}, "is_accepted": false, "score": 0, "last_activity_date": 1570375265, "last_edit_date": 1570375265, "creation_date": 1472709796, "answer_id": 39263755, "question_id": 39247948, "link": "https://stackoverflow.com/questions/39247948/divide-sql-query-on-excel-vba/39263755#39263755", "title": "Divide sql query on excel vba", "body": "<p>Tried second option but still get error type mismatch here are images\n<a href=\"https://i.stack.imgur.com/caYbV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/caYbV.jpg\" alt=\"cell\"></a>\n\n<a href=\"https://i.stack.imgur.com/df6xr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/df6xr.jpg\" alt=\"vba\"></a>\n</p>\n"}, {"comments": [{"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1473062602, "post_id": 39284970, "comment_id": 65983956, "body": "Glad I could help. Make sure to A) post your questions by editing your original Post or as comments and B) mark a post as an answer if it solved your problem"}], "tags": [], "owner": {"reputation": 22, "user_id": 2752125, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/462251285dee124030fa55a456d4fd42?s=128&d=identicon&r=PG&f=1", "display_name": "elit elit", "link": "https://stackoverflow.com/users/2752125/elit-elit"}, "is_accepted": false, "score": 0, "last_activity_date": 1472794545, "creation_date": 1472794545, "answer_id": 39284970, "question_id": 39247948, "link": "https://stackoverflow.com/questions/39247948/divide-sql-query-on-excel-vba/39284970#39284970", "title": "Divide sql query on excel vba", "body": "<p>It worked , for getting sql query from a cell this is the correct codes ;</p>\n\n<pre><code>Function fetchSQL() As String\nDim i As Integer\ni = 1\nWhile Not IsEmpty(Sheets(\"sheet2\").Cells(i, 7))\nfetchSQL = fetchSQL &amp; Sheets(\"Sheet2\").Cells(i, 7).Value &amp; \" \"\ni = i + 1\nWend\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 22, "user_id": 2752125, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/462251285dee124030fa55a456d4fd42?s=128&d=identicon&r=PG&f=1", "display_name": "elit elit", "link": "https://stackoverflow.com/users/2752125/elit-elit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 366, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1570375265, "creation_date": 1472641620, "question_id": 39247948, "link": "https://stackoverflow.com/questions/39247948/divide-sql-query-on-excel-vba", "title": "Divide sql query on excel vba", "body": "<p>I want to divide a long query here is part of it, when I remove the second line (indicated with !!) everything is ok but when I add, receive error \"type mismatch\". The reason is the lenght of line cause if I shorten second line and add there is no problem.</p>\n\n<p>This method I use to divide query but receive error cause of line lenght  any idea ?</p>\n\n<pre><code>strSqla = \"SELECT DT4 .ABH, DT4 .S1 , CASE WHEN S1 = 'AV' OR S1 = 'AN' OR S1 = 'AY' THEN 'PDE' \"\n' !!!!!!strSqla = strSqla &amp; \"WHEN S1 = 'AE' OR S1 = 'AH' OR S1 = 'AK' OR S1 = 'FE' THEN 'EME' \"\nstrSqla = strSqla &amp; \"ELSE 'MANUAL' END AS division \"\nstrSqla = strSqla &amp; \"FROM H9.PCFILES.DT4 DT4 WHERE DT4 .IDATE &gt; '\" &amp; X &amp; \"'\"\nWith ActiveSheet.ListObjects.Add(SourceType:=0, Source:=\"ODBC;DSN=PCFILES289;\", Destination:=Range(\"$A$1\")).QueryTable\n   .CommandText = Array(strSqla)\n    .RowNumbers = False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3970, "user_id": 2757925, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a6804067a1c00a041299978a7b580ace?s=128&d=identicon&r=PG&f=1", "display_name": "V.K.", "link": "https://stackoverflow.com/users/2757925/v-k"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1472642317, "post_id": 39247657, "comment_id": 65832148, "body": "@pnuts well, you know, sometimes you want to automate stuff..."}], "answers": [{"comments": [{"owner": {"reputation": 3970, "user_id": 2757925, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a6804067a1c00a041299978a7b580ace?s=128&d=identicon&r=PG&f=1", "display_name": "V.K.", "link": "https://stackoverflow.com/users/2757925/v-k"}, "edited": false, "score": 0, "creation_date": 1472642552, "post_id": 39247682, "comment_id": 65832304, "body": "I do not think this inferior (from performance point of view) solution deserves up-votes. Btw. IsEmpty(cell.Value) is also a nice and useful function. :)"}, {"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "reply_to_user": {"reputation": 3970, "user_id": 2757925, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a6804067a1c00a041299978a7b580ace?s=128&d=identicon&r=PG&f=1", "display_name": "V.K.", "link": "https://stackoverflow.com/users/2757925/v-k"}, "edited": false, "score": 0, "creation_date": 1472642681, "post_id": 39247682, "comment_id": 65832396, "body": "Yeah I know but I just wanted to make the least amount of changes in the code of the OP I am lazy :p"}], "tags": [], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "is_accepted": false, "score": 2, "last_activity_date": 1472640953, "creation_date": 1472640953, "answer_id": 39247682, "question_id": 39247657, "link": "https://stackoverflow.com/questions/39247657/vba-filling-empty-cell-with-0/39247682#39247682", "title": "VBA - filling empty cell with 0", "body": "<p>Try this:</p>\n\n<pre><code>Sub test()\n\nDim cell As Range\n\nFor Each cell In Range(\"B2307:B10000\")\nIf Trim(cell.Value) = \"\" Then\n    cell.Value = 0\nEnd If\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3409, "user_id": 4579155, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Dw6Fx.jpg?s=128&g=1", "display_name": "abarisone", "link": "https://stackoverflow.com/users/4579155/abarisone"}, "edited": false, "score": 1, "creation_date": 1472716521, "post_id": 39247769, "comment_id": 65866397, "body": "Please edit with more information. Code-only and &quot;try this&quot; answers are discouraged, because they contain no searchable content, and don&#39;t explain why someone should &quot;try this&quot;."}], "tags": [], "owner": {"reputation": 1363, "user_id": 4508899, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d542443e17bb87bcd18c9828164d65bf?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas_Hess", "link": "https://stackoverflow.com/users/4508899/jonas-hess"}, "is_accepted": false, "score": 0, "last_activity_date": 1472641180, "creation_date": 1472641180, "answer_id": 39247769, "question_id": 39247657, "link": "https://stackoverflow.com/questions/39247657/vba-filling-empty-cell-with-0/39247769#39247769", "title": "VBA - filling empty cell with 0", "body": "<pre><code>Sub test()\n    Dim cell As Range\n    For Each cell In Range(\"B2307:B10000\").Cells\n        If Len(cell.Value) = 0 Then\n            cell.Value = \"0\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3970, "user_id": 2757925, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a6804067a1c00a041299978a7b580ace?s=128&d=identicon&r=PG&f=1", "display_name": "V.K.", "link": "https://stackoverflow.com/users/2757925/v-k"}, "edited": false, "score": 0, "creation_date": 1472642588, "post_id": 39247855, "comment_id": 65832333, "body": "The question was about VBA."}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 2, "last_activity_date": 1472641372, "creation_date": 1472641372, "answer_id": 39247855, "question_id": 39247657, "link": "https://stackoverflow.com/questions/39247657/vba-filling-empty-cell-with-0/39247855#39247855", "title": "VBA - filling empty cell with 0", "body": "<p>Without VBA:</p>\n\n<pre><code>Goto Special, Blanks\ntype '0'\nCtrl+Enter\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": false, "score": 6, "last_activity_date": 1472641999, "creation_date": 1472641999, "answer_id": 39248086, "question_id": 39247657, "link": "https://stackoverflow.com/questions/39247657/vba-filling-empty-cell-with-0/39248086#39248086", "title": "VBA - filling empty cell with 0", "body": "<p>if you really need vba for this, here is a better way</p>\n\n<pre><code>Sub test()\n\n    On Error Resume Next\n    Range(\"B2307:B10000\").SpecialCells(xlCellTypeBlanks) = 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3970, "user_id": 2757925, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a6804067a1c00a041299978a7b580ace?s=128&d=identicon&r=PG&f=1", "display_name": "V.K.", "link": "https://stackoverflow.com/users/2757925/v-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1472642642, "last_edit_date": 1472642642, "creation_date": 1472642263, "answer_id": 39248179, "question_id": 39247657, "link": "https://stackoverflow.com/questions/39247657/vba-filling-empty-cell-with-0/39248179#39248179", "title": "VBA - filling empty cell with 0", "body": "<p>Despite the fact that the solution by Rosetta is the most elegant one for this very special case (empty cells), I think the following is the most general because you can easily adjust it to more situations by changing the formula.</p>\n\n<pre><code>set rng = Range(\"B2307:B10000\")\nrng.Formula = Application.Evaluate(\"=IF(ISBLANK(\" &amp; rng.Address &amp; \"),0,\" &amp; rng.Address &amp; \")\")\n</code></pre>\n\n<p>Remember this pattern, this is so useful!</p>\n"}], "owner": {"reputation": 49, "user_id": 6778366, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/5a9176c3e016fbd77c3e0428445d1378?s=128&d=identicon&r=PG&f=1", "display_name": "aniusni", "link": "https://stackoverflow.com/users/6778366/aniusni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1472642642, "creation_date": 1472640817, "question_id": 39247657, "link": "https://stackoverflow.com/questions/39247657/vba-filling-empty-cell-with-0", "title": "VBA - filling empty cell with 0", "body": "<p>how to fill empty cells with 0 in one column? I suppose my code is complete but not working ;(</p>\n\n<pre><code>Sub test()\n\nDim cell As Range\n\nFor Each cell In Range(\"B2307:B10000\")\nIf Len(cell.Value) = 0 Then\n    cell.Value = 0\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1357214, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0eedea7c1a3ac0325a124acb7fd6e46?s=128&d=identicon&r=PG", "display_name": "Devil&#39;s Dream", "link": "https://stackoverflow.com/users/1357214/devils-dream"}, "edited": false, "score": 0, "creation_date": 1472642453, "post_id": 39247835, "comment_id": 65832244, "body": "Thanks. Can you help me a little bit more? I want to use a for loop. I have an array that I used in query. How can I export multiple file for every array value?"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 523, "user_id": 1357214, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0eedea7c1a3ac0325a124acb7fd6e46?s=128&d=identicon&r=PG", "display_name": "Devil&#39;s Dream", "link": "https://stackoverflow.com/users/1357214/devils-dream"}, "edited": false, "score": 0, "creation_date": 1472643767, "post_id": 39247835, "comment_id": 65833110, "body": "How did you use array? I think it would be better to create another question, comments don&#39;t allow format code examples."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 523, "user_id": 1357214, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0eedea7c1a3ac0325a124acb7fd6e46?s=128&d=identicon&r=PG", "display_name": "Devil&#39;s Dream", "link": "https://stackoverflow.com/users/1357214/devils-dream"}, "edited": false, "score": 1, "creation_date": 1472645425, "post_id": 39247835, "comment_id": 65834233, "body": "Move <code>Set xlApp...</code> and <code>xlApp.Visible..</code> before <code>For</code> and add <code>xlBook.Close</code> after <code>xlBook.SaveAs</code>. Also add <code>xlApp.Quit</code> after loop"}, {"owner": {"reputation": 523, "user_id": 1357214, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0eedea7c1a3ac0325a124acb7fd6e46?s=128&d=identicon&r=PG", "display_name": "Devil&#39;s Dream", "link": "https://stackoverflow.com/users/1357214/devils-dream"}, "edited": false, "score": 0, "creation_date": 1472709932, "post_id": 39247835, "comment_id": 65862830, "body": "I am facing new problem with the xlBook.SaveAs option. The file is saving but when I am trying to open the saved file its showing the file is Read-Only also I am unable to delete the saved file."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 523, "user_id": 1357214, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0eedea7c1a3ac0325a124acb7fd6e46?s=128&d=identicon&r=PG", "display_name": "Devil&#39;s Dream", "link": "https://stackoverflow.com/users/1357214/devils-dream"}, "edited": false, "score": 1, "creation_date": 1472713734, "post_id": 39247835, "comment_id": 65864715, "body": "File is read-only because it&#39;s open in Access. To release add <code>xlBook.Close</code>"}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1472641327, "creation_date": 1472641327, "answer_id": 39247835, "question_id": 39247548, "link": "https://stackoverflow.com/questions/39247548/export-and-save-access-xlsheet-to-excel/39247835#39247835", "title": "Export and save Access xlSheet to Excel", "body": "<p>Name \"Book1\" is default name for new workbook, it is in memory, not on disk.Save the workbook, name will be changed:</p>\n\n<pre><code>xlBook.SaveAs \"C:\\path\\MyFile.xls\"\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1357214, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/f0eedea7c1a3ac0325a124acb7fd6e46?s=128&d=identicon&r=PG", "display_name": "Devil&#39;s Dream", "link": "https://stackoverflow.com/users/1357214/devils-dream"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 39247835, "answer_count": 1, "score": 0, "last_activity_date": 1479978048, "creation_date": 1472640524, "last_edit_date": 1472643815, "question_id": 39247548, "link": "https://stackoverflow.com/questions/39247548/export-and-save-access-xlsheet-to-excel", "title": "Export and save Access xlSheet to Excel", "body": "<p>I am using the following code to export access data to excel. I need formatted excel sheet, this is why I am using the following code. The problem is when I am executing the code its opening a spreadsheet named book1. I want to save it directly to a folder path. How Can I do this?</p>\n\n<pre><code>Private Sub cmdTransfer_Click()\nOn Error GoTo SubError\n\nDim xlApp As Excel.Application\nDim xlBook As Excel.Workbook\nDim xlSheet As Excel.Worksheet\nDim SQL As String\nDim rs1 As DAO.Recordset\nDim i As Integer\nDim j As Integer\n\n'Show user work is being performed\nDoCmd.Hourglass (True)\n\n'*********************************************\n'              RETRIEVE DATA\n'*********************************************\nDim regArray\n\nregArray = Array(\"One\", \"Two\", \"Three\")\n\nFor j = 0 To UBound(regArray)\nDim regName As String\nregName = regArray(j)\n'MsgBox regName\n'SQL statement to retrieve data from database\nSQL = \"SELECT PartNo, PartName, Price, SalePrice, \" &amp; _\n\"(Price - SalePrice) / Price AS Discount \" &amp; _\n\"FROM Parts \" &amp; _\n\"ORDER BY PartNo WHERE PartNo =('\" &amp; regName &amp; \"');\"\n\n'Execute query and populate recordset\nSet rs1 = CurrentDb.OpenRecordset(SQL, dbOpenSnapshot)\n\n'If no data, don't bother opening Excel, just quit\nIf rs1.RecordCount = 0 Then\n    MsgBox \"No data selected for export\", vbInformation + vbOKOnly, \"No data exported\"\n    GoTo SubExit\nEnd If\n\n'*********************************************\n'             BUILD SPREADSHEET\n'*********************************************\n'Create an instance of Excel and start building a spreadsheet\n\n'Early Binding\nSet xlApp = Excel.Application\n\nxlApp.Visible = False\nSet xlBook = xlApp.Workbooks.Add\nSet xlSheet = xlBook.Worksheets(1)\n\nWith xlSheet\n    .Name = \"Discount\"\n    .Cells.Font.Name = \"Calibri\"\n    .Cells.Font.Size = 11\n\n    'Set column widths\n    .Columns(\"A\").ColumnWidth = 13\n    .Columns(\"B\").ColumnWidth = 25\n    .Columns(\"C\").ColumnWidth = 10\n    .Columns(\"D\").ColumnWidth = 10\n    .Columns(\"F\").ColumnWidth = 10\n\n\n    For cols = 0 To rs1.Fields.Count - 1\n        .Cells(1, cols + 1).Value = rs1.Fields(cols).Name\n    Next\n\n    'Copy data from recordset to sheet\n    .Range(\"A2\").CopyFromRecordset rs1\n\nEnd With\n\nxlBook.SaveAs \"E:\\new\\Report_\" &amp; regName &amp; \".xlsx\"\n\nNext\n\n\nSubExit:\nOn Error Resume Next\n    DoCmd.Hourglass False\n    'xlApp.Visible = True\n    rs1.Close\n    Set rs1 = Nothing\n    Exit Sub\n\nSubError:\n    MsgBox \"Error Number: \" &amp; Err.Number &amp; \"= \" &amp; Err.Description, vbCritical + vbOKOnly, _\n        \"An error occurred\"\n    GoTo SubExit\n    End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 372, "user_id": 5884229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a97589d01b91b5d5ac56749e94301dc?s=128&d=identicon&r=PG&f=1", "display_name": "R&#233;mi", "link": "https://stackoverflow.com/users/5884229/r%c3%a9mi"}, "edited": false, "score": 2, "creation_date": 1472641785, "post_id": 39247280, "comment_id": 65831794, "body": "If you show us some code it might help <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 2, "creation_date": 1472646378, "post_id": 39247280, "comment_id": 65834886, "body": "To store a decimal you need to use a <code>Variant</code> data type."}, {"owner": {"reputation": 9, "user_id": 6598860, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154323468517453/picture?type=large", "display_name": "damnthing", "link": "https://stackoverflow.com/users/6598860/damnthing"}, "edited": false, "score": 0, "creation_date": 1472719150, "post_id": 39247280, "comment_id": 65867934, "body": "Remi,  I added some code above Ryan Wildry, I tried the variant data type and the code did nothing."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1472746922, "post_id": 39247280, "comment_id": 65887656, "body": "Don&#39;t use <code>DoCmd.SetWarnings False</code> and <code>DoCmd.RunSQL StrSQL</code>. Instead, try using <code>thisDB.Execute StrSQL, dbFailOnError</code>."}, {"owner": {"reputation": 115, "user_id": 5953480, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5GyKLX0YIp4/AAAAAAAAAAI/AAAAAAAAWS8/FNd0amluVDw/photo.jpg?sz=128", "display_name": "Erick 3E", "link": "https://stackoverflow.com/users/5953480/erick-3e"}, "edited": false, "score": 0, "creation_date": 1473280031, "post_id": 39247280, "comment_id": 66084887, "body": "have you tried explicit conversion before passing on the value?"}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1472786732, "creation_date": 1472786732, "answer_id": 39283848, "question_id": 39247280, "link": "https://stackoverflow.com/questions/39247280/problems-with-passing-decimals-to-vba/39283848#39283848", "title": "Problems with passing decimals to vba", "body": "<p>When you hold the cursor over the variable it hasn't been assigned yet. You're actually showing the last record's value that was assigned to the <code>numField4</code> variable.</p>\n\n<p>What that means is your current recordset field <code>Field4</code> is actually a null. To assign it to the numeric variable you need to trap for that condition.</p>\n\n<p><code>numField4 = Nz(rs!Field4, 0)</code></p>\n\n<p>And you should probably repeat for Field3 to cover thst possibility too</p>\n"}], "owner": {"reputation": 9, "user_id": 6598860, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154323468517453/picture?type=large", "display_name": "damnthing", "link": "https://stackoverflow.com/users/6598860/damnthing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472786732, "creation_date": 1472639746, "last_edit_date": 1472746937, "question_id": 39247280, "link": "https://stackoverflow.com/questions/39247280/problems-with-passing-decimals-to-vba", "title": "Problems with passing decimals to vba", "body": "<p>I am having some trouble passing a decimal number from an access field (using a DAO recordset) to a vba variable. I have tried changing datatypes in access and vba (single / currency), but the same line keeps being highlighted in the debugger, with a Runtime error 94 \"Invalid use of null\". \nThe thing that is confusing me is, when I hold the cursor over the variable in the debugger; the quickinfo shows that the variable is holding the correct value, but the recordset field is null. This only happens for the Decimal field, Other fields (string / integer) are not highlighted.</p>\n\n<p>The line that is higlighted in the debugger is rs!Field4 in the 'Start Loop block. The strange thing is that rs.Field3 sets the numField3 variable fine. The only difference between the two is that field 3 contains integers and field 4 contains decimals. Both were msAccess numbers, but i have changed to currency during problem solve.\nAny feedback would be good\nThanks</p>\n\n<pre><code>    Private Sub Command1_Click()\n\n    'Set Database and Recordset variables\n    Dim thisDB As DAO.Database\n    Dim rs As DAO.Recordset\n    Set thisDB = CurrentDb\n    Set rs = thisDB.OpenRecordset(\"tblTable1\")\n\n    'Declare and set recordset variables variables\n    Dim strField1 As String\n    Dim strField2 As String\n    Dim numField3 As Currency\n    Dim numField4 As Currency\n    Dim dtField5 As Date\n    Dim dtField6 As Date\n\n    'Declare dynamic variables\n    Dim dtVar1 As Date \n    Dim intVar2 As Integer \n    Dim dtVar3 As Date \n\n    'DecalreSQL Variables\n    Dim num1 As Currency\n    Dim num2 As Currency\n    Dim num3 As Currency\n\n    Dim StrSQL As String\n    Dim strValues As String\n\n    'Start Loop\n    Do While Not rs.EOF\n        strField1 = rs!Field1\n        strField2 = rs!Field2\n        numField3 = rs!Field3\n        numField4 = rs!Field4\n        dtField5 = rs!Field5\n        dtField6 = rs!Field6\n\n    If strField1 = \"This\" And strField2 = \"That\" Then\n    'Perform calculations\n        dtVar1 = 0\n        dtVar3 = 0\n         num3 = 0\n\n    Do While dtVar3 &lt; dtField6\n\n        If \u2019Something\u2019 Then\n        This calculation sets variables            \n        ElseIf \u2018SomethingElse\u2019 Then\n        This calculation sets variables            \n        Else\n        This calculation sets variables\n        End If\n\n\n        'Build SQL Query and apprend to table\n        strValues = dtVar1&amp; \",\" &amp; num1 &amp; \",\" &amp;num2 &amp; \",\" &amp; num3\n        StrSQL = \"INSERT INTO tblTable2 (Field1, Field2, Field3, Field4 );\"\n        StrSQL = StrSQL &amp; \"VALUES ('\" &amp; strValues &amp; \"')\"\n\n        DoCmd.SetWarnings False\n        DoCmd.RunSQL StrSQL\n        DoCmd.SetWarnings True\n\n        dtVar3 = dtVar1\n    Loop\n\n    End If\n    rs.MoveNext\n    Loop\n    rs.Close\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1472641268, "post_id": 39247181, "comment_id": 65831435, "body": "What I mean is that once it hits column 40, none of the data (besides the first row - weird) is there.  As in, from column 40 to the end going-right, it&#39;s all empty."}, {"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1472642027, "post_id": 39247181, "comment_id": 65831956, "body": "Thanks for the input. Unfortunately, the data is simply not there (check the whole right-area) - it just gets lost during the text-to-columns process. Additionally, I can&#39;t have consecutive delimiters treated as one due to some cells being left blank on purpose in the data."}, {"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1472642316, "post_id": 39247181, "comment_id": 65832147, "body": "Agreed. What is also strange is that when I try to use the excel text-to-columns function from the Data tab, it works without a problem on the data from the first .csv file (so no problem then)."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1472642580, "post_id": 39247181, "comment_id": 65832326, "body": "@DaveR I just diffed the two sets of input you provided and they appear to be identical, at least after a copy/paste.  Is it perhaps a character-set issue?  Is one generated in a different locale than the other?"}, {"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1472644375, "post_id": 39247181, "comment_id": 65833525, "body": "@cxw yes, the two .csv files have a different generation locations (two databases with essentially the same data). The first one is generated with SAS, the second takes that data, adds additional rows, and saves it as csv (this part is done via a VBA macro)."}, {"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "edited": false, "score": 0, "creation_date": 1472644485, "post_id": 39247181, "comment_id": 65833606, "body": "I have added an edit below the original code with revised code that does TtC on the entire first colums when the data is pasted from the csv - the effect is the same."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1472645834, "post_id": 39247181, "comment_id": 65834513, "body": "@DaveR OK, so <b>(1)</b> Remove or comment out <code>Application.DisplayAlerts = False</code> - that&#39;s there for production code, but it actually discards information you may find useful for debugging.  <b>(2)</b> Single-step through your code in the VBA editor, and at each step, check and make sure the right data is selected, and that the cells contain what you expect.  Perhaps the <code>Workbooks.Open</code> is splitting your input data into two columns, so the full data is never making it to <code>ParamBook</code>."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "edited": false, "score": 0, "creation_date": 1472644738, "post_id": 39248187, "comment_id": 65833771, "body": "Thanks for your input. Thats a great comment about changing the loop bound as the loop continues - I&#39;ll refrain from doing that in the future. Still unfortunately, for some inexplicable reason - the problem persists."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1472646877, "post_id": 39248187, "comment_id": 65835280, "body": "The loop bound never changes after a for loop starts - it gets evaluated once.  The <i>real</i> problem with <code>For K = 1 to K</code> is that it evaluates from left to right, so it sets <code>K</code> to its initial value for the loop (1) and <i>then</i> uses it to set the loop bound. It will always be <code>For K = 1 to 1</code> regardless of what <code>K</code> is going into the structure."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472648518, "post_id": 39248187, "comment_id": 65836509, "body": "@Comintern thanks - I didn&#39;t know the subtleties (never having tried it myself... at least not on purpose ;) )"}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": false, "score": 1, "last_activity_date": 1472648581, "last_edit_date": 1495542770, "creation_date": 1472642284, "answer_id": 39248187, "question_id": 39247181, "link": "https://stackoverflow.com/questions/39247181/vba-text-to-columns-not-parsing-all-data/39248187#39248187", "title": "VBA text to columns not parsing all data", "body": "<p><strong>Edit</strong> See the <a href=\"https://stackoverflow.com/a/39249550/2877364\">actual answer</a>.</p>\n\n<p>The problem is probably this line:</p>\n\n<pre><code>For K = 1 To K\n</code></pre>\n\n<p>You are changing the loop bound as you loop, which is almost never what you want :) .  (<strong>Correction</strong> See <a href=\"https://stackoverflow.com/questions/39247181/vba-text-to-columns-not-parsing-all-data/39249550?noredirect=1#comment65835280_39248187\">Comintern's comment below</a>.)  (If you wanted flexible bounds, a <code>Do</code> loop would be a better choice.)  Try</p>\n\n<pre><code>LastRow = ParamBook.Sheets(\"Data\").Cells(Rows.Count, \"A\").End(xlUp).Row\nThisWorkbook.Sheets(\"Data\").Activate  ' &lt;--- should this reference ParamBook?\nDim CurrentRow as Long\nApplication.DisplayAlerts = False  ' move out of the loop for speed\nFor CurrentRow = 1 To LastRow\n    ThisWorkbook.Sheets(\"Data\").Cells(CurrentRow, 1).Select\n    Selection.TextToColumns DataType:=xlDelimited, Semicolon:=True, Comma:=False\nNext CurrentRow\n</code></pre>\n\n<p>Also, your current code references <em>three</em> workbooks: <code>InputBook</code>, <code>ParamBook</code>, and <code>ThisWorkbook</code> (where the macro lives).  <strong>Edit</strong> I see you have initialized <code>ParamBook</code> to be a copy of <code>ThisWorkbook</code>.  I recommend that you stick with <code>ParamBook</code> throughout, then, as it will make it easier to port the code to an addin should you need to later on.  </p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "edited": false, "score": 0, "creation_date": 1472646904, "post_id": 39249550, "comment_id": 65835313, "body": "This did it. Hats off to you sir :). The file is in fact semicolon delimited, and this tiny change sets everything right."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "edited": false, "score": 0, "creation_date": 1472648422, "post_id": 39249550, "comment_id": 65836455, "body": "@DaveR Glad to hear it!  By the way, while you&#39;re online, check out the <a href=\"https://stackoverflow.com/tour\">tour</a> for more about the site and what people will be looking for in questions.  Enjoy!"}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 1, "last_activity_date": 1472646144, "creation_date": 1472646144, "answer_id": 39249550, "question_id": 39247181, "link": "https://stackoverflow.com/questions/39247181/vba-text-to-columns-not-parsing-all-data/39249550#39249550", "title": "VBA text to columns not parsing all data", "body": "<p>OK &mdash; let's try this again.  When the obvious answers fail, check your inputs.</p>\n\n<pre><code>Set InputBook = Workbooks.Open(InputPath)\n</code></pre>\n\n<p>opens <code>InputPath</code> in the default mode.  You called these \"csv\" files, but really they are <em>semicolon</em> delimited, per your macro.  I suspect the two files have different extensions, and the problematic one is a <code>*.csv</code>.  Yes?  </p>\n\n<p>I just tried this on my Excel 2013 installation.  When I run the above line on a <code>*.csv</code> file containing your first test case above, Excel breaks it into columns at the commas.  Therefore, the data in the <code>InputBook</code> spans columns <code>A:S</code>, so your code only pulling out of column <code>A</code> wouldn't get all the data.  To fix this, I used</p>\n\n<pre><code>Set InputBook = Workbooks.Open(InputPath, format:=5)\n</code></pre>\n\n<p>Format 5 is \"no delimiter\" per the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819.aspx\" rel=\"nofollow\">docs</a>.  When I do that, I get each row entirely in column <code>A</code>, and a manual text-to-columns works.</p>\n\n<p><em>Edit</em> Yes, extension does matter: When I rename my test file from <code>.csv</code> to <code>.txt</code>, a regular <code>Workbooks.Open</code> with no format specified doesn't split the columns.</p>\n"}], "owner": {"reputation": 21, "user_id": 6769334, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d3ce14d53c40a9040e66ac3ad8ccb638?s=128&d=identicon&r=PG&f=1", "display_name": "Dave R", "link": "https://stackoverflow.com/users/6769334/dave-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "accepted_answer_id": 39249550, "answer_count": 2, "score": 1, "last_activity_date": 1472648581, "creation_date": 1472639481, "last_edit_date": 1472646969, "question_id": 39247181, "link": "https://stackoverflow.com/questions/39247181/vba-text-to-columns-not-parsing-all-data", "title": "VBA text to columns not parsing all data", "body": "<p>I have two .csv files - in eyes they're identical, but something about them must be different.  <strong>When data from the first one hits my text-to-columns macro, it does so only for part of the columns (first 39), skipping a portion (from 40 to the end going-right). This does not happen to data from the second .csv.</strong></p>\n\n<p>Here is a sample of the data from both (they're generated from two different databases):</p>\n\n<pre><code>QRT NAME;REPORTING YEAR /;SOLVENCY CALCULA;LEGAL NAME OF TH;HOME COUNTRY;REPORTING CURREN;PORTFOLIO TYPE;ASSET HELD IN UN;PORTFOLIO;LINE ID;ID CODE;ID CODE TYPE;ID CODE LONG TEX;ORIGINAL CURRENC;ISSUER;ISSUER MIDDLE TE;ISSUER SECTOR;ISSUER COUNTRY;ISSUER CODE;ISSUER GROUP;ISSUER GROUP MID;PARTICIPATION;CUSTODIAN;CUSTODIAN MIDDLE;COUNTRY OF CUSTO;CIC ASSET CATEGO;CIC SUB ASSET CA;ASSETS SUBCLASS;TYPE OF SECURITY;TYPE OF COLLATER;BALANCE SHEET IT;EQUITY TYPE;RATING AGENCY;EXTERNAL RATING;MATURITY DATE;DURATION;VALUATION METHOD;QUANTITY;TOTAL PAR AMOUNT;UNIT SII PRICE;PERCENTAGE OF PA;ACCRUED INTEREST;TOTAL SII AMOUNT;ACQUISITION PRIC;WRITE-OFFS/WRITE;TOTAL AMOUNT LOC;IFRS ACCOUNTING;CLEAN VALUE IN O;DIRTY VALUE IN O;EXPOSURE IN ORIG;EQUITY;PROPERTY;FX RISK (DOWNSID;FX RISK (UPSIDE;INTEREST RATE (D;INTEREST RATE (U;SPREAD RISK BOND;SPREAD RISK STRU;SPREAD RISK DERI;;USE OF DERIVATIV;LONG OR SHORT PO;UNWIND TRIGGER O;TRADE DATE;PREMIUM PAID TO;PREMIUM RECEIVED;SWAP OUTFLOW AMO;SWAP DELIVERED C;SWAP INFLOW AMOU;SWAP RECEIVED CU;TRIGGER VALUE;DELTA;NUMBER OF CONTRA;CONTRACT DIMENSI;NOTIONAL AMOUNT;MAXIMUM LOSS UND;ASSET PLEDGED AS;FUND NUMBER;MATCHING PORTFOL;CURRENT INTEREST;INTEREST RATE FR;REDEMPTION;REFERENCE RATE L;FIXING FACTOR;FIXING SPREAD;QUOTATION TYPE;INTEREST RATE TY;REDEMPTION TYPE;QUOTED;LISTING COUNTRY;ANNUITY/INSTALLM;DISCOUNTING SPRE;FUNDS: FIXED INC;FUNDS: EQUITY QU;FUNDS: PROPERTY;FUNDS: CASH QUOT;FUNDS: ALTERNATI;FUNDS: FX-QUOTA;FUNDS: SPREAD DU;FUNDS: DURATION;BALANCE SHEET IT;\nS.06.02.01;006.2016;M1;C;PL;PLN;L;N;LF_COMP;1;PLOPNPL00013;ISIN;X SA;PLN;9978;X;G47;PL;2594002C0DGL8KBA5491;18284;X;N;9448;ING BANK SLASKI;PL;3;PL31;EQ-STOCKS;Equity;NA;EQUI-EQUI;TYPE1;;;;;QMP;4900,000000;;31,470000;;0,000000;154203,000000;160424,170000;;;154203,000000;154203,000000;154203,000000;;49098,510000;0,000000;0,000000;0,000000;0,000000;0,000000;0,000000;;;;;;U;;;;;;;;;;;;;;NC;;;;0,00;;0,00;;;Per unit;;;Quoted;PL;;;;;;;;;;;31;\nS.06.02.01;006.2016;M1;C;PL;PLN;L;N;LF_COMP;3;PL_CLF_PLN_BRE\u00a72510;CAU;TD_PL_CLF_BRE BANK_PLN;PLN;9357;MBANK;K64.1.9;PL;259400DZXF7UJKK2AY35;727;COMMERZBANK;;9357;MBANK;PL;7;XT73;CASH-TD;Deposit;FIN-SEN;CASH-CASH;TYPE2;MDY;BBB;30.12.2016;0,500000;AVM;;448000,000000;;1,000000;4963,960000;452963,960000;;;;448000,000000;448000,000000;452963,960000;;0,000000;0,000000;0,000000;0,000000;-2655,240000;2436,920000;0,000000;;;;;;U;;;;;;;;;;;;;;NC;;;0,02210;0,00;;0,00;;;Percent;;;(none);;;;;;;;;;;;41;\n\n\nQRT NAME;REPORTING YEAR /;SOLVENCY CALCULA;LEGAL NAME OF TH;HOME COUNTRY;REPORTING CURREN;PORTFOLIO TYPE;ASSET HELD IN UN;PORTFOLIO;LINE ID;ID CODE;ID CODE TYPE;ID CODE LONG TEX;ORIGINAL CURRENC;ISSUER;ISSUER MIDDLE TE;ISSUER SECTOR;ISSUER COUNTRY;ISSUER CODE;ISSUER GROUP;ISSUER GROUP MID;PARTICIPATION;CUSTODIAN;CUSTODIAN MIDDLE;COUNTRY OF CUSTO;CIC ASSET CATEGO;CIC SUB ASSET CA;ASSETS SUBCLASS;TYPE OF SECURITY;TYPE OF COLLATER;BALANCE SHEET IT;EQUITY TYPE;RATING AGENCY;EXTERNAL RATING;MATURITY DATE;DURATION;VALUATION METHOD;QUANTITY;TOTAL PAR AMOUNT;UNIT SII PRICE;PERCENTAGE OF PA;ACCRUED INTEREST;TOTAL SII AMOUNT;ACQUISITION PRIC;WRITE-OFFS/WRITE;TOTAL AMOUNT LOC;IFRS ACCOUNTING;CLEAN VALUE IN O;DIRTY VALUE IN O;EXPOSURE IN ORIG;EQUITY;PROPERTY;FX RISK (DOWNSID;FX RISK (UPSIDE;INTEREST RATE (D;INTEREST RATE (U;SPREAD RISK BOND;SPREAD RISK STRU;SPREAD RISK DERI;;USE OF DERIVATIV;LONG OR SHORT PO;UNWIND TRIGGER O;TRADE DATE;PREMIUM PAID TO;PREMIUM RECEIVED;SWAP OUTFLOW AMO;SWAP DELIVERED C;SWAP INFLOW AMOU;SWAP RECEIVED CU;TRIGGER VALUE;DELTA;NUMBER OF CONTRA;CONTRACT DIMENSI;NOTIONAL AMOUNT;MAXIMUM LOSS UND;ASSET PLEDGED AS;FUND NUMBER;MATCHING PORTFOL;CURRENT INTEREST;INTEREST RATE FR;REDEMPTION;REFERENCE RATE L;FIXING FACTOR;FIXING SPREAD;QUOTATION TYPE;INTEREST RATE TY;REDEMPTION TYPE;QUOTED;LISTING COUNTRY;ANNUITY/INSTALLM;DISCOUNTING SPRE;FUNDS: FIXED INC;FUNDS: EQUITY QU;FUNDS: PROPERTY;FUNDS: CASH QUOT;FUNDS: ALTERNATI;FUNDS: FX-QUOTA;FUNDS: SPREAD DU;FUNDS: DURATION;BALANCE SHEET IT;\nS.06.02.01;006.2016;M1;C;PL;PLN;L;N;LF_COMP;1;PLOPNPL00013;ISIN;X SA;PLN;9978;X;G47;PL;2594002C0DGL8KBA5491;18284;X;N;9448;ING BANK SLASKI;PL;3;PL31;EQ-STOCKS;Equity;NA;EQUI-EQUI;TYPE1;;;;;QMP;4900,000000;;31,470000;;0,000000;154203,000000;160424,170000;;;154203,000000;154203,000000;154203,000000;;49098,510000;0,000000;0,000000;0,000000;0,000000;0,000000;0,000000;;;;;;U;;;;;;;;;;;;;;NC;;;;0,00;;0,00;;;Per unit;;;Quoted;PL;;;;;;;;;;;31;\nS.06.02.01;006.2016;M1;C;PL;PLN;L;N;LF_COMP;3;PL_CLF_PLN_BRE\u00a72510;CAU;TD_PL_CLF_BRE BANK_PLN;PLN;9357;MBANK;K64.1.9;PL;259400DZXF7UJKK2AY35;727;COMMERZBANK;;9357;MBANK;PL;7;XT73;CASH-TD;Deposit;FIN-SEN;CASH-CASH;TYPE2;MDY;BBB;30.12.2016;0,500000;AVM;;448000,000000;;1,000000;4963,960000;452963,960000;;;;448000,000000;448000,000000;452963,960000;;0,000000;0,000000;0,000000;0,000000;-2655,240000;2436,920000;0,000000;;;;;;U;;;;;;;;;;;;;;NC;;;0,02210;0,00;;0,00;;;Percent;;;(none);;;;;;;;;;;;41;\n</code></pre>\n\n<p>Here is the text-to-columns formula I use:</p>\n\n<p>note: data is copied from InputBook then the text-to-columns happens in ParamBook</p>\n\n<pre><code>Public Sub Load_input()\n\nInputPath = Application.GetOpenFilename(\"Comma Separated Values (*.csv),*.csv\")\n\nCall Fetch_Data\n\nEnd Sub\n\n\nSub Fetch_Data()\n    Dim InputBook As Workbook\n    Dim ParamBook As Workbook\n    Dim n As Integer\n    Dim K As Integer\n    Set InputBook = Workbooks.Open(InputPath)\n    Set ParamBook = ThisWorkbook\n\n\n    '==========CLEAR CONTENTS OF DATA SHEET==========\n    If ParamBook.Sheets(\"Data\").Cells(1, 1) &lt;&gt; \"\" Then\n        ParamBook.Sheets(\"Data\").Cells.Clear\n    End If\n\n'==========COPY INPUT AND PASTE INTO DATA SHEET==========\nn = InputBook.Sheets(1).Cells(Rows.Count, \"A\").End(xlUp).Row\nInputBook.Activate\nInputBook.Sheets(1).Range(Cells(1, 1), Cells(n, 1)).Select\nSelection.Copy\nParamBook.Activate\nApplication.DisplayAlerts = False\nActiveSheet.Paste Destination:=Worksheets(\"Data\").Range(\"A1\")\n\n\n'==========TEXT TO COLUMSN IN DATA SHEET==========\nK = ParamBook.Sheets(\"Data\").Cells(Rows.Count, \"A\").End(xlUp).Row\nThisWorkbook.Sheets(\"Data\").Activate\nFor K = 1 To K\n    Application.DisplayAlerts = False\n    ThisWorkbook.Sheets(\"Data\").Cells(K, 1).Select\n    Selection.TextToColumns DataType:=xlDelimited, Semicolon:=True, Comma:=False\nNext K\n\n\nInputBook.Close\nEnd Sub\n</code></pre>\n\n<p><strong>If there is something I can do with the code I'd appreciate some tips</strong>, I'd rather not mess with how the .csv files are generated.</p>\n\n<p>edit:</p>\n\n<p>This text-to-columns code just works faster, but still the same issue.</p>\n\n<pre><code>'==========TEXT TO COLUMSN IN SAP_BW_DATA SHEET==========\nK = ParamBook.Sheets(\"SAP BW Data\").Cells(Rows.Count, \"A\").End(xlUp).Row\nThisWorkbook.Sheets(\"SAP BW Data\").Activate\n    ThisWorkbook.Sheets(\"SAP BW Data\").Range(Cells(1, 1), Cells(K, 1)).Select\n    Selection.TextToColumns DataType:=xlDelimited, Semicolon:=True, Comma:=False\n</code></pre>\n\n<p>edit 2:</p>\n\n<p>OK, I have narrowed it down - turns out, the problem does not lie with TtC functionality, but the way the data is pasted from the .csv file. The way it is currently set up only grabs a portion of the data (the same part which is being text-to-column'd), the remainder is not being pasted. Solving that will help the issue. Thanks everyone who participated in helping!</p>\n\n<p>edit 3:</p>\n\n<p>@cxw has fixed the issue, please see his post!</p>\n"}, {"tags": ["excel", "vba", "compare"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472639741, "post_id": 39246885, "comment_id": 65830338, "body": "In your example you have &quot;EFS files&quot; and in your code you have &quot;EFS Files&quot;. <code>StrComp</code> is case sensitive. Or is it just a typo in your example?"}, {"owner": {"reputation": 21, "user_id": 6778200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57127657142ea913cc12bb70e2021e70?s=128&d=identicon&r=PG&f=1", "display_name": "avidsun", "link": "https://stackoverflow.com/users/6778200/avidsun"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472642258, "post_id": 39246885, "comment_id": 65832114, "body": "&quot;EFS Files&quot; is correct. Sorry for typo in example."}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472642953, "post_id": 39246885, "comment_id": 65832580, "body": "is <code>varSheetB</code> the correct sheet to check for &quot;EFS Files&quot;?"}, {"owner": {"reputation": 21, "user_id": 6778200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57127657142ea913cc12bb70e2021e70?s=128&d=identicon&r=PG&f=1", "display_name": "avidsun", "link": "https://stackoverflow.com/users/6778200/avidsun"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472643270, "post_id": 39246885, "comment_id": 65832785, "body": "@arcadeprecinct: The code is working. I made a mistake in checking the output. Thanks for the support. Am sorry if I ended up wasting your time!"}], "owner": {"reputation": 21, "user_id": 6778200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57127657142ea913cc12bb70e2021e70?s=128&d=identicon&r=PG&f=1", "display_name": "avidsun", "link": "https://stackoverflow.com/users/6778200/avidsun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1472639452, "creation_date": 1472638681, "last_edit_date": 1472639452, "question_id": 39246885, "link": "https://stackoverflow.com/questions/39246885/compare-2-sheets-from-different-workbook-until-a-particular-row-is-reached", "title": "Compare 2 sheets from different Workbook until a particular row is reached", "body": "<p>Requirement:\n1) Copy the desired sheet from another workbook (Book2) to the current, active workbook (Book1)\n2) There are 2 types of data - type A and type B - which are clubbed together\nEg: <strong><em>Book1</em></strong>:</p>\n\n<pre><code>NV\nA 1\nB 2\nC 3\nE 4\nEFS files\nA A\nB B\nC C\nD D\n</code></pre>\n\n<p>Each type of Book1 is compared with Book2 i.e. keep comparing until you encounter 'Type B' in next row\n3) If a match is not found in Book1, copy that entire row from Book3 to Book1 at current position</p>\n\n<p>I have written following code but the copy algorithm is not working fine i.e. it is not stopping when it encounters \"EFS files\" string in next row:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n' ##CODE TO COPY THE DESIRED DEFAULT SHEET TO CURRENT WORKBOOK (BASE)\nDim wkbSource As Workbook, wkbDest As Workbook\nDim shtToCopy As Worksheet\n\n'setting current workbook as destination\nSet wkbDest = ActiveWorkbook\n\n'1) add your own file path\nfileStr = \"\\\\D:\\Book2.xlsm\"\nSet wkbSource = Workbooks.Open(fileStr)\n\n'2) add sheet name to be copied\n'COPY ONLY IF THE SHEET IS NOT PRESENT\nSet shtToCopy = wkbSource.Sheets(\"Default\")\n\n'the sheet will be copied after 'Sheet1' of current workbook\nshtToCopy.Copy After:=wkbDest.Sheets(\"Sheet1\")\nwkbSource.Close\n\n' ##COPY ALGO: Copy non-duplicate NV items from Original (Book3) to the newly created base file (Book1)\n'    a) Check the B-column of both files\n'    b) If mismatch --&gt; skip copying since base is given priority\n'    c) If an item is not present in Base, insert it in Base\n\nDim varSheetA As Variant\nDim varSheetB As Variant\nDim strRangeToCheck As String\nDim nvStr1 As String\nDim nvStr2 As String\nDim iRow As Long\nDim iCol As Long\nDim cmpResult As Integer\n\nnvStr1 = \"EFS Files\"\n\nSet wbkA = wkbDest\nSet varSheetA = wbkA.Worksheets(\"Default\")\n\nSet wbkB = Workbooks.Open(filename:=\"\\\\D:\\Book3.xlsm\")\nSet varSheetB = wbkB.Worksheets(\"Default\")\niRow = 6\n\n'Loop until value of cell = \"EFS Files\"\nDo While True\n    'COPY ALGORITHM\n    If varSheetA.Cells(iRow, 2).Value = varSheetB.Cells(iRow, 2).Value Then\n        ' Cells are identical. Do nothing.\n    Else\n        ' Cells are different. Copy the row to Base\n        varSheetA.Cells(iRow, 2).Value = varSheetB.Cells(iRow, 2).Value\n    End If\n\n    iRow = iRow + 1\n    nvStr2 = Trim(varSheetB.Cells(iRow, 1).Value)\n    cmpResult = StrComp(nvStr1, nvStr2)\n\n    If cmpResult = 0 Then\n        Exit Do\n    End If\n'End If\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1472639207, "post_id": 39246793, "comment_id": 65829944, "body": "Is the reference to <code>wsRefor</code> set OK, so that it points to a valid Worksheet object? If you run <code>MsgBox wsRefor.Name</code> first in the For-loop, do you get the same error? Btw, there is no If-statement in your example! :)"}, {"owner": {"reputation": 325, "user_id": 6770000, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6a96fc59cc2e495becf1a7a781194f0?s=128&d=identicon&r=PG&f=1", "display_name": "pApaAPPApapapa", "link": "https://stackoverflow.com/users/6770000/papaappapapapa"}, "reply_to_user": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1472641718, "post_id": 39246793, "comment_id": 65831750, "body": "Hey @OlleSj&#246;gren. Yeah it should be. Also, thanks for pointing out that I wrote &quot;if&quot; and not &quot;for&quot;. It is changed now :)"}, {"owner": {"reputation": 17945, "user_id": 465053, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mj3Xe.jpg?s=128&g=1", "display_name": "RBT", "link": "https://stackoverflow.com/users/465053/rbt"}, "edited": false, "score": 0, "creation_date": 1522757000, "post_id": 39246793, "comment_id": 86265872, "body": "Related post which is <b>important to know</b> while working in VBA - <a href=\"https://stackoverflow.com/q/349613/465053\">What does the keyword Set actually do in VBA?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 6770000, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6a96fc59cc2e495becf1a7a781194f0?s=128&d=identicon&r=PG&f=1", "display_name": "pApaAPPApapapa", "link": "https://stackoverflow.com/users/6770000/papaappapapapa"}, "edited": false, "score": 0, "creation_date": 1472642294, "post_id": 39247015, "comment_id": 65832134, "body": "This worked like a charm. Thanks so much. Increadble how much you gus help in here. When I run the code now, I get the error warning <code>Run time error &#39;1004&#39; Unable to get the Match propertyof the WorksheetFunction class</code>, but it still calculates and prints the averages. Any idea why that might be?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 325, "user_id": 6770000, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6a96fc59cc2e495becf1a7a781194f0?s=128&d=identicon&r=PG&f=1", "display_name": "pApaAPPApapapa", "link": "https://stackoverflow.com/users/6770000/papaappapapapa"}, "edited": false, "score": 0, "creation_date": 1472642798, "post_id": 39247015, "comment_id": 65832488, "body": "@pApaAPPApapapa modify your line to  <code>wsOut.Cells(i + 1, 4).Value = WorksheetFunction.Average(AvgRange)</code> , you don&#39;t need to use the <code>Application</code> before the <code>WorksheetFunction</code> , should work now"}, {"owner": {"reputation": 325, "user_id": 6770000, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6a96fc59cc2e495becf1a7a781194f0?s=128&d=identicon&r=PG&f=1", "display_name": "pApaAPPApapapa", "link": "https://stackoverflow.com/users/6770000/papaappapapapa"}, "edited": false, "score": 0, "creation_date": 1472644254, "post_id": 39247015, "comment_id": 65833452, "body": "Done that. Same happens as before. It does calculate corretly, but still gives me the warning/error message."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 325, "user_id": 6770000, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6a96fc59cc2e495becf1a7a781194f0?s=128&d=identicon&r=PG&f=1", "display_name": "pApaAPPApapapa", "link": "https://stackoverflow.com/users/6770000/papaappapapapa"}, "edited": false, "score": 0, "creation_date": 1472645746, "post_id": 39247015, "comment_id": 65834461, "body": "@pApaAPPApapapa in you code you are running a loop <code>For i = 1 To lastCol</code> , and advancing the rows with this data ? you sure you don&#39;t have a Typo ?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1472646269, "last_edit_date": 1472646269, "creation_date": 1472639021, "answer_id": 39247015, "question_id": 39246793, "link": "https://stackoverflow.com/questions/39246793/object-variable-or-with-block-variable-not-set-in-vba/39247015#39247015", "title": "&quot;Object variable or With block variable not set&quot; in VBA", "body": "<p>Assuming you defined <code>Dim wsRefor As Worksheet</code>, and set it to the right Sheet, then modify your line:</p>\n\n<pre><code>AvgRange = Range(wsRefor.Cells(1 + i, 4), wsRefor.Cells(1 + i, lastCol))\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Set AvgRange = wsRefor.Range(Cells(1 + i, 4), Cells(1 + i, lastCol))\n</code></pre>\n\n<p>or, on the safe side:</p>\n\n<pre><code>With wsRefor\n     Set AvgRange = .Range(.Cells(1 + i, 4), .Cells(1 + i, lastCol))\nEnd With\n</code></pre>\n\n<p><strong>Edit 1</strong>: full code which I've tested (also has error handling for the <code>Average</code> Function)</p>\n\n<pre><code>Option Explicit\n\nSub DynamicAvgRange()\n\nDim wsRefor             As Worksheet\nDim wsOut               As Worksheet\nDim Avg                 As Double\nDim AvgRange            As Range\nDim lastCol             As Long\nDim i                   As Long\n\nSet wsRefor = ThisWorkbook.Sheets(\"Refor\")\nSet wsOut = ThisWorkbook.Sheets(\"Out\")\n\n' just for simulating the tests\nlastCol = 6\n\nFor i = 1 To lastCol\n    With wsRefor\n        Set AvgRange = .Range(.Cells(1 + i, 4), .Cells(1 + i, lastCol))\n    End With\n    If Not IsError(Application.Average(AvgRange)) Then\n        wsOut.Cells(i + 1, 4).Value = Application.Average(AvgRange)\n    Else\n        ' Average value returned an error (no values in the searched range)\n        wsOut.Cells(i + 1, 4).Value = \"\" ' put a blank value &gt;&gt; modify to your needs\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1472640021, "creation_date": 1472640021, "answer_id": 39247374, "question_id": 39246793, "link": "https://stackoverflow.com/questions/39246793/object-variable-or-with-block-variable-not-set-in-vba/39247374#39247374", "title": "&quot;Object variable or With block variable not set&quot; in VBA", "body": "<p>You need to use the <code>Set</code> keyword when you are assigning an object rather than a value.</p>\n\n<p>A <code>Range</code> is an object and so it needs to be <code>Set</code></p>\n\n<hr>\n\n<pre><code>Set AvgRange = Range(wsRefor.Cells(1 + i, 4), wsRefor.Cells(1 + i, lastCol))\n</code></pre>\n\n<hr>\n\n<p>To see the difference, you can do this:</p>\n\n<pre><code>Dim test As Variant\n\nRange(\"A1\").Value = \"some text\"\n\ntest = Range(\"A1\") '// test is now a string containing \"some text\"\n\nSet test = Range(\"A1\") '// test is now a range object\n\nMsgBox test.Value '// Displays the value of the range object \"some text\"\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 6770000, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6a96fc59cc2e495becf1a7a781194f0?s=128&d=identicon&r=PG&f=1", "display_name": "pApaAPPApapapa", "link": "https://stackoverflow.com/users/6770000/papaappapapapa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6181, "favorite_count": 0, "accepted_answer_id": 39247015, "answer_count": 2, "score": 3, "last_activity_date": 1472646269, "creation_date": 1472638467, "last_edit_date": 1472641683, "question_id": 39246793, "link": "https://stackoverflow.com/questions/39246793/object-variable-or-with-block-variable-not-set-in-vba", "title": "&quot;Object variable or With block variable not set&quot; in VBA", "body": "<p>I am looking to calculate a column (in wsOut) of averages using VBA. The input is in another sheet (wsRefor).</p>\n\n<p>I use the following code, where I use the worksheet function to calculate the average</p>\n\n<pre><code>Dim Avg As Double\nDim AvgRange As Range\nSet Reformulering = ActiveSheet\n\nFor i = 1 To lastCol\n    AvgRange = Range(wsRefor.Cells(1 + i, 4), wsRefor.Cells(1 + i, lastCol))\n    wsOut.Cells(i + 1, 4).Value = Application.WorksheetFunction.Average(AvgRange)\nNext\n</code></pre>\n\n<p>Yet, I get the mistake, from the second line inside of the for-loop:</p>\n\n<p>\"Object variable or With block variable not set\"</p>\n\n<p>I am not sure I understand the error from videos I have watched and other forum discussion, so I am hoping anyone can explain or potentially point of the mistake</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1472639166, "last_edit_date": 1472639166, "creation_date": 1472638827, "answer_id": 39246940, "question_id": 39246726, "link": "https://stackoverflow.com/questions/39246726/pasting-from-column-b-into-column-d/39246940#39246940", "title": "Pasting from column B into column D", "body": "<p>This code is working fine for me and is not deleting leading zeros:</p>\n\n<pre><code>Dim i As Integer\n\n'Set the numberformat of column D to text\nRange(\"D1\").EntireColumn.NumberFormat = \"@\"\n\n'Loop through the used rows\nFor i = 1 To UsedRange.SpecialCells(xlCellTypeLastCell).Row Step 1\n\n    'assign the item code to column D\n    Cells(i, \"D\").Value = Split(Cells(i, \"B\").Value, \" \")(0)\nNext i\n</code></pre>\n\n<p>To Explain the <code>Split()</code> function:\n<code>Split()</code> splits the specified String (<code>Cells(i, \"B\").Value</code> in this case) into an array, you can specify the delimiter (which in this case is a space (<code>\" \"</code>)).</p>\n\n<p>Since the returnvalue is an array, we can tell VBA to only return the first value, which should be the item code. This is done by adding <code>(0)</code> at the end of the line.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6094449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lj7eX.jpg?s=128&g=1", "display_name": "RoberFJR", "link": "https://stackoverflow.com/users/6094449/roberfjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1472655322, "creation_date": 1472655322, "answer_id": 39252948, "question_id": 39246726, "link": "https://stackoverflow.com/questions/39246726/pasting-from-column-b-into-column-d/39252948#39252948", "title": "Pasting from column B into column D", "body": "<p>Just change the target cells format to text before running the macro. If you do it after running the macro the zero won't be there.</p>\n"}], "owner": {"reputation": 7, "user_id": 6776042, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fee18301ac2dea2cb0a03cab916d5bb9?s=128&d=identicon&r=PG&f=1", "display_name": "Unknow User", "link": "https://stackoverflow.com/users/6776042/unknow-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552723778, "creation_date": 1472638263, "last_edit_date": 1552723778, "question_id": 39246726, "link": "https://stackoverflow.com/questions/39246726/pasting-from-column-b-into-column-d", "title": "Pasting from column B into column D", "body": "<p>I have to copy/paste item codes from column B into column D.</p>\n\n<p>Most of the cells in column B are like this:</p>\n\n<blockquote>\n  <p>XX787 DO BOLOGNESE 2X2.28KG FR</p>\n</blockquote>\n\n<p>The item code is the first 5 characters in this case.</p>\n\n<p>A few cells in column B are like this: </p>\n\n<blockquote>\n  <p>01333379 Rice Long Grain PB Milled 10  BB</p>\n</blockquote>\n\n<p>In this case, the item code is 8 characters and consists of numbers + the first character is a zero.</p>\n\n<p>The issues:</p>\n\n<ul>\n<li>The zero at the begin is not displayed when I copy/paste from column B into column D. I tried pasting all the cell values as text so that the zero would be displayed, but it didn't help.<br>\nI used this code to format as text: <code>ActiveSheet.Range(\"B:D\").NumberFormat = \"@\"</code></li>\n<li>The first characters are put in column B, but when it more characters, the rest of the characters does not get put in.</li>\n</ul>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "is_accepted": true, "score": 1, "last_activity_date": 1472639658, "creation_date": 1472639658, "answer_id": 39247241, "question_id": 39246718, "link": "https://stackoverflow.com/questions/39246718/delete-dynamically-created-report-on-close-event/39247241#39247241", "title": "Delete dynamically created report on close event", "body": "<p>Place the following, just before you line DoCmd.DeleteObject...</p>\n\n<pre><code>Do While Application.CurrentProject.AllReports(sRptName).IsLoaded\nDoEvents\nLoop\n</code></pre>\n"}], "owner": {"reputation": 746, "user_id": 3671880, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/22a868e9c1a57801061872545dbec969?s=128&d=identicon&r=PG&f=1", "display_name": "rosuandreimihai", "link": "https://stackoverflow.com/users/3671880/rosuandreimihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 39247241, "answer_count": 1, "score": 0, "last_activity_date": 1472639658, "creation_date": 1472638236, "question_id": 39246718, "link": "https://stackoverflow.com/questions/39246718/delete-dynamically-created-report-on-close-event", "title": "Delete dynamically created report on close event", "body": "<p>I am using Access to create a dynamic report and I would like that on close event the report to be deleted.\nRight now, I am creating the report like this:</p>\n\n<pre><code>Set rpt = CreateReport\nWith rpt\n    .Visible = True\n    .Caption = \"Calendar View\"\n    .BorderStyle = 1\n    .AutoCenter = True\n    .ScrollBars = 0\n    .Printer.Orientation = acPRORLandscape\n    .Modal = True\n    .PopUp = True\n    .OnClose = \"[Event Procedure]\"\nEnd With\n\n'extra stuff for report\n\nstrName = rpt.Name\n\nDoCmd.Close acReport, strName, acSaveYes\nDoCmd.Rename \"rptNewName\", acReport, strName\nDoCmd.OpenReport \"rptNewName\", acViewPreview, , , acWindowNormal\nDoCmd.DeleteObject acReport, \"rptNewName\"\n</code></pre>\n\n<p>But, the DeleteObject will throw a error, because the report is still open..\nHow can I delete the report on close event?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "forms", "vba", "colors", "format"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472639462, "post_id": 39246670, "comment_id": 65830130, "body": "are you using VBA UserForm or worksheet ActiveX ones? What is <i>database</i> actually?"}, {"owner": {"reputation": 88, "user_id": 6778169, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-f17G5zYof4U/AAAAAAAAAAI/AAAAAAAAAwM/m4qPGyYv9nU/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/6778169/alex"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472750627, "post_id": 39246670, "comment_id": 65889635, "body": "Im using a VBA form and the database is a table in a worksheet"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472752924, "post_id": 39246670, "comment_id": 65890865, "body": "Please upload relevant code"}, {"owner": {"reputation": 88, "user_id": 6778169, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-f17G5zYof4U/AAAAAAAAAAI/AAAAAAAAAwM/m4qPGyYv9nU/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/6778169/alex"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472877195, "post_id": 39246670, "comment_id": 65940341, "body": "I added the code to the question"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1472887792, "last_edit_date": 1472887792, "creation_date": 1472887005, "answer_id": 39304316, "question_id": 39246670, "link": "https://stackoverflow.com/questions/39246670/change-cell-format-in-a-sheet-according-to-option-button-in-a-form/39304316#39304316", "title": "Change cell format in a sheet according to Option Button in a form", "body": "<p>you must use simply:</p>\n\n<pre><code>If OptionButton1 Then\n\n...\n\nElseIf OptionButton2 Then\n\n...\n\nEnd If\n</code></pre>\n\n<p>because <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278538.aspx\" rel=\"nofollow\"><code>Enabled</code></a> property of userform controls <em>\"Specifies whether a control can receive the focus and respond to user-generated events.\"</em></p>\n\n<p>in other words it <em>greys</em> or <em>blacken</em> the control in the userform  to make it, correspondingly, unavailable or available for user input</p>\n\n<p>while you'd use it <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196172.aspx\" rel=\"nofollow\">`Value'</a> property that <em>\"determines or specifies whether or not the specified option button is selected\"</em></p>\n\n<p>and since <code>OptionButton</code>'s <code>Value</code> property is the default one, you can omit it altogether</p>\n\n<p>furthermore you may want to consider the following little refactoring of your code:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    Dim L As Long\n    Dim Code As String\n    Dim TextBox2 As Long\n\n    If MsgBox(\"Confirm?\", vbYesNo, \"Confirming new invoice\") = vbYes Then\n        With Worksheets(\"FACTURE\")\n            L = .Range(.Rows.Count, \"D\").End(xlUp).Row + 1 'Pour placer le nouvel enregistrement _ la premi_re ligne de tableau non vide\n        End With\n        With Me\n            Range(\"C\" &amp; L).Value = (Now)\n            Range(\"D\" &amp; L).Value = .TextBox2\n            Range(\"E\" &amp; L).Value = .TextBox3\n            Range(\"F\" &amp; L).Value = .TextBox4\n            Range(\"G\" &amp; L).Value = .TextBox5\n            Range(\"K\" &amp; L).Value = .ComboBox1\n            Range(\"L\" &amp; L).Value = .ComboBox2\n            Range(\"M\" &amp; L).Value = .ComboBox3\n            Range(\"N\" &amp; L).Value = .TextBox9\n            Range(\"O\" &amp; L).Value = .TextBox10\n            Range(\"R\" &amp; L).Value = .TextBox39\n            Range(\"P\" &amp; L).Value = .TextBox40\n\n            If .OptionButton1.Enabled Then\n               FormatCell Range(\"B\" &amp; L), xlThemeColorAccent3\n            ElseIf .OptionButton2 Then\n               FormatCell Range(\"B\" &amp; L), xlThemeColorAccent1\n            End If\n        End With\n    End If\nEnd Sub\n\nSub FormatCell(rng As Range, thColor As XlThemeColor)\n    With rng.Interior\n       .Pattern = xlSolid\n       .PatternColorIndex = xlAutomatic\n       .themeColor = thColor\n       .TintAndShade = 0.399975585192419\n       .PatternTintAndShade = 0\n    End With\nEnd Sub\n</code></pre>\n\n<p>where:</p>\n\n<ul>\n<li><p>code gets executed only after user confirmation</p></li>\n<li><p>I used a more conventional (and \"state of the art\") mode to get the first non empty row of a given worksheet column</p>\n\n<p>which, together with the declaration of <code>L</code> as of <code>Long</code> type, makes it excel versioning independent, enabling it to get to the bottom of post Excel 2003 worksheets rows</p></li>\n<li><p>I used <code>With Me</code> block for accessing userform controls through the <em>dot</em> (<code>.</code>) notation</p>\n\n<p>this not only facilitates your coding of userform properties and methods (after the typing the dot Intellisense provides you with their list) but it also avoids possible shadowing of them. </p>\n\n<p>the following code should explain you why:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    Dim TextBox2 As Long\n\n    TextBox2 = 2\n    Range(\"D3\").Value = TextBox2 '&lt;-- you're referring to 'TextBox2' Long variable value\n    Range(\"D3\").Value = Me.TextBox2 '&lt;-- you're referring to the userform control named after \"TextBox2\"\nEnd Sub\n</code></pre></li>\n<li><p>I factorized-out the code responsible for formatting the cell to a specific \n<code>Function FormatCell()</code></p>\n\n<p>every time you see some duplication of code then it's time to write a Sub or Function to handle it with proper parameters</p>\n\n<p>decoupling different tasks leads to a more sustainable and fast code debugging and maintenance</p></li>\n</ul>\n"}], "owner": {"reputation": 88, "user_id": 6778169, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-f17G5zYof4U/AAAAAAAAAAI/AAAAAAAAAwM/m4qPGyYv9nU/photo.jpg?sz=128", "display_name": "Alex", "link": "https://stackoverflow.com/users/6778169/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 701, "favorite_count": 1, "accepted_answer_id": 39304316, "answer_count": 1, "score": 0, "last_activity_date": 1472887792, "creation_date": 1472638104, "last_edit_date": 1472874539, "question_id": 39246670, "link": "https://stackoverflow.com/questions/39246670/change-cell-format-in-a-sheet-according-to-option-button-in-a-form", "title": "Change cell format in a sheet according to Option Button in a form", "body": "<p>I have a database and a form to enter data to it. The form is adding data to the next empty row in a table. I have 4 Option Button in my form indicating wich type of transaction is the next entry. I would like to format the background of the cell in column B depending on wich option button is selected so when I click on confirm, the data from the form is inserted in the database and the background color of cell in column B is set properly. I can't upload my code from this device but actually the background color is set but is always the same and does not change if I select an other option button.</p>\n\n<p>Any idea what could be the problem? Do I need to include a line to clear previous formating prior to applying the option button one? </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim L As Integer\nDim Code As String\n\nIf MsgBox(\"Confirm?\", vbYesNo, \"Confirming new invoice\") = vbYes Then\n    L = Sheets(\"FACTURE\").Range(\"D65535\").End(xlUp).Row + 1 'Pour placer le nouvel enregistrement _ la premi_re ligne de tableau non vide\n    Range(\"C\" &amp; L).Value = (Now)\n    Range(\"D\" &amp; L).Value = TextBox2\n    Range(\"E\" &amp; L).Value = TextBox3\n    Range(\"F\" &amp; L).Value = TextBox4\n    Range(\"G\" &amp; L).Value = TextBox5\n    Range(\"K\" &amp; L).Value = ComboBox1\n    Range(\"L\" &amp; L).Value = ComboBox2\n    Range(\"M\" &amp; L).Value = ComboBox3\n    Range(\"N\" &amp; L).Value = TextBox9\n    Range(\"O\" &amp; L).Value = TextBox10\n    Range(\"R\" &amp; L).Value = TextBox39\n    Range(\"P\" &amp; L).Value = TextBox40\nEnd If\n\nIf OptionButton1.Enabled = True Then\nRange(\"B\" &amp; L).Select\n With Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = 0.399975585192419\n    .PatternTintAndShade = 0\n End With\n\n ElseIf OptionButton2.Enabled = True Then\n Range(\"B\" &amp; L).Select\n  With Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent1\n    .TintAndShade = 0.399975585192419\n    .PatternTintAndShade = 0\n End With\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1472637823, "post_id": 39246464, "comment_id": 65828931, "body": "second line is wrong. <code>Range</code>...which range ? (downvote not me :)"}], "answers": [{"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 1, "last_activity_date": 1472637766, "creation_date": 1472637766, "answer_id": 39246566, "question_id": 39246464, "link": "https://stackoverflow.com/questions/39246464/macro-copy-to-above-cell/39246566#39246566", "title": "Macro copy to above cell?", "body": "<pre><code>Sub test()\n    ActiveCell.Copy Destination:=ActiveCell.Offset(-1, 0)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 3747824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af45cd0dc3eac8e267754d1a23e703e3?s=128&d=identicon&r=PG&f=1", "display_name": "m  e", "link": "https://stackoverflow.com/users/3747824/m-e"}, "is_accepted": false, "score": 1, "last_activity_date": 1472643420, "last_edit_date": 1472643420, "creation_date": 1472637889, "answer_id": 39246600, "question_id": 39246464, "link": "https://stackoverflow.com/questions/39246464/macro-copy-to-above-cell/39246600#39246600", "title": "Macro copy to above cell?", "body": "<p>Your macro would work if you chage the Range line:</p>\n\n<pre><code>Sub Macro3()\n    Selection.Copy\n    Selection.Offset(-1, 0).Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 6161509, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0c4ef8694243cb76c1f8a71da292db8d?s=128&d=identicon&r=PG&f=1", "display_name": "Exostrike", "link": "https://stackoverflow.com/users/6161509/exostrike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1271, "favorite_count": 0, "accepted_answer_id": 39246566, "answer_count": 2, "score": -2, "last_activity_date": 1472643420, "creation_date": 1472637523, "question_id": 39246464, "link": "https://stackoverflow.com/questions/39246464/macro-copy-to-above-cell", "title": "Macro copy to above cell?", "body": "<p>I'm trying to make a simple macro to paste what I select to the cell above it, however for some reason it would always default to a fixed cell so I've tried to use offset to move it from its starting position. However it doesn't work and I just get an \"Argument not optional\" error.</p>\n\n<pre><code>Sub Macro3()\n'\n' Macro3 Macro\n'\n' Keyboard Shortcut: Ctrl+b\n'\n    Selection.Copy\n    Range.Offset(-1, 0).Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>Is it that I have to turn my selection into a range and if so how do I do that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472637951, "post_id": 39246330, "comment_id": 65829029, "body": "see my answer below"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6748492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce19359cef5b9999211ea52ef4e4835f?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro F", "link": "https://stackoverflow.com/users/6748492/alejandro-f"}, "edited": false, "score": 0, "creation_date": 1472644337, "post_id": 39246614, "comment_id": 65833499, "body": "Thanks it worked! Now I can use a range with different size each Loop."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 15, "user_id": 6748492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce19359cef5b9999211ea52ef4e4835f?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro F", "link": "https://stackoverflow.com/users/6748492/alejandro-f"}, "edited": false, "score": 0, "creation_date": 1476109618, "post_id": 39246614, "comment_id": 67200735, "body": "@AlejandroF what happened here ? you took off the <code>V</code> ?"}, {"owner": {"reputation": 15, "user_id": 6748492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce19359cef5b9999211ea52ef4e4835f?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro F", "link": "https://stackoverflow.com/users/6748492/alejandro-f"}, "edited": false, "score": 0, "creation_date": 1476264364, "post_id": 39246614, "comment_id": 67267930, "body": "It was a mistake, I was trying out something"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1472637923, "creation_date": 1472637923, "answer_id": 39246614, "question_id": 39246330, "link": "https://stackoverflow.com/questions/39246330/how-can-i-write-a-code-to-define-a-range-insdide-a-loop-that-will-change-its-siz/39246614#39246614", "title": "How can I write a code to define a range insdide a loop that will change its size?", "body": "<p>Change your line:</p>\n\n<pre><code>positionrepetition = Application.CountIf(Worksheets(\"Sheet2\").Range(\"cells(3 + x + y - 1, 3)\", \"cells(3 + x + y - 1 + submodulrepetition,3\"), Position)\n</code></pre>\n\n<p>With :</p>\n\n<pre><code>positionrepetition = Application.CountIf(Worksheets(\"Sheet2\").Range(Cells(3 + x + y - 1, 3), Cells(3 + x + y - 1 + submodulrepetition, 3), Position))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 1026994, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ujEv1.jpg?s=128&g=1", "display_name": "Priscilla Jobin", "link": "https://stackoverflow.com/users/1026994/priscilla-jobin"}, "is_accepted": false, "score": 0, "last_activity_date": 1472637943, "creation_date": 1472637943, "answer_id": 39246623, "question_id": 39246330, "link": "https://stackoverflow.com/questions/39246330/how-can-i-write-a-code-to-define-a-range-insdide-a-loop-that-will-change-its-siz/39246623#39246623", "title": "How can I write a code to define a range insdide a loop that will change its size?", "body": "<p><strong>If the Range is going to Change by <code>Column/Row</code> use the following code to get the end of column or row:</strong>  </p>\n\n<pre><code>Dim GetColEnd, GetRowEnd As Integer\n\nGetColEnd = Sheets(\"Sheet_Name\").Cells(1, .Columns.Count).End(xlToLeft).Column\nGetRowEnd = Sheets(\"Sheet_Name\").Cells(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n\n<p><strong>Use the <code>GetColEnd</code> <code>GetRowEnd</code> in your <code>Range</code> function for flexible <code>Column\\Row</code> for example as follows:</strong>  </p>\n\n<pre><code>Sheets(\"Sheet_Name\").Range(Cells(1,1),Cells(GetRowEnd,GetColEnd)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6748492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce19359cef5b9999211ea52ef4e4835f?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro F", "link": "https://stackoverflow.com/users/6748492/alejandro-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 39246614, "answer_count": 2, "score": 1, "last_activity_date": 1472637943, "creation_date": 1472637187, "last_edit_date": 1472637519, "question_id": 39246330, "link": "https://stackoverflow.com/questions/39246330/how-can-i-write-a-code-to-define-a-range-insdide-a-loop-that-will-change-its-siz", "title": "How can I write a code to define a range insdide a loop that will change its size?", "body": "<p>I need to use two Loops and the easy part is to count how many times does a \"submodul\" repeats in a defined and known range (\"B3\",\"B18\"), this means the quantity of elements each submodul has. The difficult part comes when trying to count how many times does a \"position\" repeats for each different \"submodul\", this is because the amount of elements of each \"submodul\" is different so I have to adjust a range in a especial Loop to calculate how many times does a specific element (=Position) repeats within a \"submodul\".</p>\n\n<p>The specific part that I need help with is the following:</p>\n\n<pre><code>positionrepetition = Application.CountIf(Worksheets(\"Sheet2\").range(\"cells(3 + x + y - 1, 3)\", \"cells(3 + x + y - 1 + submodulrepetition,3\"), position)\n</code></pre>\n\n<p>If I can manage to write it in a correct format I believe it will work. The problem is that normally I only use the range function when I know that the range is fixed or known, it doesn\u00b4t have to be calculated. I normally write for example: Range(\"A1\",\"F10\").Select </p>\n\n<p>As you can see this is a fixed range, so I imagined that instead of using the format of Range(\"A1\", \"F10\") I could  use the range function with the arguments (\"Cells(1,1)\",\"Cells(10,6)\"). Please correct me if I\u00b4m wrong.</p>\n\n<p>Here is the rest of the code for the Loop.</p>\n\n<pre><code>For x = 0 To numberofparts\n    If Cells(3 + x, 18) = \"1\" Then\n        submodul = Cells(3 + x, 2).Value\n        submodulrepetition = Application.CountIf(Worksheets(\"Sheet2\").range(\"B3\", \"B18\"), submodul)\n        For y = 1 To submodulrepetition\n            position = Cells(3 + x + y - 1, 3).Value\n            positionrepetition = Application.CountIf(Worksheets(\"Sheet2\").range(\"cells(3 + x + y - 1, 3)\", \"cells(3 + x + y - 1 + submodulrepetition,3\"), position)\n        Next\n    Else\n    End If\n    x = x + submodulrepetition - 1\n Next\n</code></pre>\n\n<p>To explain a little more, all data is gathered from Excel Sheets:</p>\n\n<p>-All Information is gathered from a Excel sheet\n-The \"submodules\" are in column B and they are arranged in numerical order. Every submodul repeats in this column as many elements it has.\n-The \"positions\" (elements of the submodules) are in column C and can also repeat in the same column and even in other \"Submodul\"s.</p>\n\n<p>All help will be appreciated and I thank you in advance.</p>\n\n<p>Alejandro Farina</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16420, "user_id": 15609, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/ZVG3d.jpg?s=128&g=1", "display_name": "Phil.Wheeler", "link": "https://stackoverflow.com/users/15609/phil-wheeler"}, "edited": false, "score": 0, "creation_date": 1472637318, "post_id": 39246278, "comment_id": 65828585, "body": "So what does your code actually look like? <code>Dim arr(0 To 20000) As String</code>?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472638014, "post_id": 39246278, "comment_id": 65829071, "body": "I have the same issue on setting an array 37500*24 for the second time in a loop, I&#39;m just investigating myself, so i&#39;ll let you know.  Mines using the variant type to handle setting as range.value"}, {"owner": {"reputation": 177, "user_id": 5541928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ae35e7e845de0f6d12f9384f47794578?s=128&d=identicon&r=PG&f=1", "display_name": "SimonMoss", "link": "https://stackoverflow.com/users/5541928/simonmoss"}, "edited": false, "score": 0, "creation_date": 1472638256, "post_id": 39246278, "comment_id": 65829237, "body": "Thanks, I&#39;ve added a code example"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472638398, "post_id": 39246278, "comment_id": 65829334, "body": "what are you using that array for?"}, {"owner": {"reputation": 177, "user_id": 5541928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ae35e7e845de0f6d12f9384f47794578?s=128&d=identicon&r=PG&f=1", "display_name": "SimonMoss", "link": "https://stackoverflow.com/users/5541928/simonmoss"}, "edited": false, "score": 0, "creation_date": 1472638623, "post_id": 39246278, "comment_id": 65829510, "body": "The array contains a bill of materials, lots of rows because there are lots of parts, lots of columns because there are lots of assembly variants. The matrix contains usage quantities."}, {"owner": {"reputation": 239, "user_id": 5981113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/402d54df630177d975611af7cc741f9b?s=128&d=identicon&r=PG&f=1", "display_name": "ABuckau", "link": "https://stackoverflow.com/users/5981113/abuckau"}, "edited": false, "score": 0, "creation_date": 1472638844, "post_id": 39246278, "comment_id": 65829668, "body": "So 20000x700 == 14,000,000 ...a lot more than 350,000. ??"}, {"owner": {"reputation": 177, "user_id": 5541928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ae35e7e845de0f6d12f9384f47794578?s=128&d=identicon&r=PG&f=1", "display_name": "SimonMoss", "link": "https://stackoverflow.com/users/5541928/simonmoss"}, "edited": false, "score": 0, "creation_date": 1472638969, "post_id": 39246278, "comment_id": 65829754, "body": "I must not have been clear, 700 columns is assumed in all cases, including 350,000 rows"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472639298, "post_id": 39246278, "comment_id": 65830017, "body": "what does your last comment mean?"}, {"owner": {"reputation": 177, "user_id": 5541928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ae35e7e845de0f6d12f9384f47794578?s=128&d=identicon&r=PG&f=1", "display_name": "SimonMoss", "link": "https://stackoverflow.com/users/5541928/simonmoss"}, "edited": false, "score": 0, "creation_date": 1472639512, "post_id": 39246278, "comment_id": 65830163, "body": "All arrays are (n * 700)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472640560, "post_id": 39246278, "comment_id": 65830917, "body": "is that last edited simple code recreating the issue the <i>only</i> one of the running project? or has your project code more subs/modules other than <code>Sub test()</code>?"}, {"owner": {"reputation": 177, "user_id": 5541928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ae35e7e845de0f6d12f9384f47794578?s=128&d=identicon&r=PG&f=1", "display_name": "SimonMoss", "link": "https://stackoverflow.com/users/5541928/simonmoss"}, "edited": false, "score": 0, "creation_date": 1472640747, "post_id": 39246278, "comment_id": 65831052, "body": "Yes, there are several Modules and Subs"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472648504, "post_id": 39246278, "comment_id": 65836499, "body": "A <code>Variant</code> is 12 bytes long, so a declaring a 14,000,000 element array of <code>Variant</code> requires ~168MB of memory to build the data area. Older versions of Excel seem to reserve around 500MB for variable storage, although I don&#39;t start replicating this on my similarly spec&#39;d machine until I hit around 1.2GB with Excel 2013x32. New versions reserve ~2GB <i>total process memory</i> for 32bit installs and ~8GB total for 64 bit. See <a href=\"http://www.decisionmodels.com/memlimitsc.htm\" rel=\"nofollow noreferrer\">this page</a> for more info."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472648947, "post_id": 39246278, "comment_id": 65836818, "body": "@Comintern, but he declared <code>Public arrTest() As String</code>, not <code>Variant</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472649342, "post_id": 39246278, "comment_id": 65837101, "body": "@user3598756 - <a href=\"http://stackoverflow.com/questions/39246278/why-am-i-running-out-of-memory-dimming-this-array?noredirect=1#comment65829071_39246278\">See his comment above</a>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472651548, "post_id": 39246278, "comment_id": 65838760, "body": "@Comintern, IMO &quot;assembly variants&quot; is referring to some <i>different customization of an assembly</i> and have nothing to do with <code>Variant</code> types. Which is also confirmed by his code"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472651668, "post_id": 39246278, "comment_id": 65838856, "body": "@user3598756 - I take &quot;Mines using the variant type to handle setting as range.value&quot; to mean &quot;my array is really of <code>Variant</code>, not the code I posted."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472652893, "post_id": 39246278, "comment_id": 65839739, "body": "@Comintern, so your comment was addressed to Nathan_Sav, while the lack of any &quot;@&quot; made me think it was to SimonMoss"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472653302, "post_id": 39246278, "comment_id": 65840030, "body": "@user3598756 Missed that - I&#39;m still not sure how it&#39;s relevant to the memory limits of Excel or the size of a 14,000,000 element array of <code>Variant</code>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472653546, "post_id": 39246278, "comment_id": 65840224, "body": "@Comintern, it simply didn&#39;t comply with OP&#39;s code specific data type: that&#39;s why I pointed that out. Nothing more"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472764194, "post_id": 39250445, "comment_id": 65896174, "body": "@SimonMoss, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472835563, "post_id": 39250445, "comment_id": 65928698, "body": "Would the <i>brave</i> downvoter show up and give any explanation so as to both have people know why they shouldn&#39;t follow thi answer and teach me how to improve it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1472648587, "creation_date": 1472648587, "answer_id": 39250445, "question_id": 39246278, "link": "https://stackoverflow.com/questions/39246278/why-am-i-running-out-of-memory-dimming-this-array/39250445#39250445", "title": "Why am I Running Out of Memory Dimming this Array?", "body": "<p>You may take advantage of one or more of the following techniques:</p>\n\n<ol>\n<li><p><strong>allocate memory <em>when</em> needed</strong></p>\n\n<p>do really you need <code>arrTest()</code> array to be <code>Public</code>?</p>\n\n<p><code>Public</code> arrays variables are allocated as soon as they are \"sized\" and stay there until it ends</p>\n\n<p>this means that every subsequent memory allocations brought along by other subs variables declarations get added to the <code>Public</code> ones </p>\n\n<p>should you need <code>arrTest()</code> in <code>Sub test()</code> only then move its declaration into this latter</p>\n\n<pre><code>Sub test()\n\n    Dim arrTest(20000, 700)\n\nEnd Sub\n</code></pre>\n\n<p>and as soon as you exit it, the <code>arrTest()</code> memory allocation gets released</p>\n\n<p>otherwise, and for the same reasons, should you need <code>arrTest()</code> across multiple subs than:</p></li>\n<li><p>declare it in the very first <code>Sub</code> that uses it </p></li>\n<li><p>pass it as a parameter to other <code>Subs</code> that need to use/process it</p>\n\n<pre><code>     Sub main()\n\n         sub1 '&lt;--| call 'Sub1(): at this stage no memory allocation has taken place for any 'arrTest()' array\n         'once out of 'sub1' any memory allocation for any 'arrTest()' array has been released\n     End Sub\n\n     Sub sub1()\n         Dim arrTest(20000, 700) As String '&lt;--| here memory allocation takes place for 'arrTest()' array\n\n         sub2 arrTest '&lt;--| pass 'arrTest()' array to Sub2\n\n         'at exiting this sub, the 'arrTest()' memory allocation gets released\n     End Sub\n\n     Sub sub2(stringArray() As String)\n         'here 'arrTest()' array memory allocation stays the same\n\n         'code to exploit passed array\n     End Sub\n</code></pre></li>\n<li><p><strong>allocate <em>as much</em> memory <em>as</em> needed</strong></p>\n\n<p>standing what per previous point 1, size your array for what <em>actually</em> needed, which is also the reason why you would use <em>dynamic</em> arrays instead of <em>static</em> ones</p>\n\n<pre><code>Sub sub1()\n    Dim arrTest() As String\n    Dim nRows As Long, ncols As Long\n\n    With Worksheets(\"Data\")\n        nRows = .Cells(.Rows.Count, 1).End(xlUp).row\n        ncols = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\n\n    ReDim arrTest(1 To nRows, 1 To ncols) As String '&lt;--| here memory allocation takes place for 'arrTest()' array\n\n    sub2 arrTest '&lt;--| pass 'arrTest()' array to Sub2\n\n    'at exiting this sub, the 'arrTest()' memory allocation gets released\nEnd Sub\n</code></pre></li>\n<li><p><strong>work with worksheet range</strong></p>\n\n<p>should all previous efforts be in vane, then you just use Excel ranges and as much its  built-in function as you can to exploit data already stored there</p>\n\n<p>this will most probably raise performance issues, but at least it runs...</p></li>\n</ol>\n\n<p>hope all this can help you out</p>\n"}], "owner": {"reputation": 177, "user_id": 5541928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ae35e7e845de0f6d12f9384f47794578?s=128&d=identicon&r=PG&f=1", "display_name": "SimonMoss", "link": "https://stackoverflow.com/users/5541928/simonmoss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472648587, "creation_date": 1472637011, "last_edit_date": 1472639031, "question_id": 39246278, "link": "https://stackoverflow.com/questions/39246278/why-am-i-running-out-of-memory-dimming-this-array", "title": "Why am I Running Out of Memory Dimming this Array?", "body": "<p>Here's the situation:</p>\n\n<ul>\n<li>Excel 2013 (32)</li>\n<li>4Gb RAM installed</li>\n<li>Excel using ~250Mb RAM with my project workbook open</li>\n<li><strong>Can't Dim a 20,000 * 700 string array (Error 7, 'Out of Memory')</strong></li>\n</ul>\n\n<p>I don't understand why this is, I've experimented dimming a smaller array and watching resource usage in Task Manager, observing Excel to use <strong>~28Mb per 10,000</strong> rows (same column count).</p>\n\n<p>If I consider (conservatively) that Excel can only use another 1000Mb, by this logic it should be able to handle 350,000 rows (same column count).</p>\n\n<p>What am I missing? What can I do differently?</p>\n\n<p>Thanks</p>\n\n<p>EDIT: This is the premise the code works on, this simple code recreates the problem.</p>\n\n<pre><code>Public arrTest() As String\n\nSub test()\n\nReDim arrTest(20000, 700)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1472640963, "post_id": 39245965, "comment_id": 65831224, "body": "see my answer below, let me know if it works"}], "answers": [{"comments": [{"owner": {"reputation": 281, "user_id": 4186618, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/c094d5e72723c899603721345b1276fe?s=128&d=identicon&r=PG&f=1", "display_name": "StackJP", "link": "https://stackoverflow.com/users/4186618/stackjp"}, "edited": false, "score": 0, "creation_date": 1472638442, "post_id": 39246605, "comment_id": 65829369, "body": "It doesn&#39;t solve the problem. Is there any way i can figure out what error it returns?"}, {"owner": {"reputation": 314, "user_id": 5724081, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1308c226220acb79f649ed25159676ed?s=128&d=identicon&r=PG&f=1", "display_name": "dudu721", "link": "https://stackoverflow.com/users/5724081/dudu721"}, "reply_to_user": {"reputation": 281, "user_id": 4186618, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/c094d5e72723c899603721345b1276fe?s=128&d=identicon&r=PG&f=1", "display_name": "StackJP", "link": "https://stackoverflow.com/users/4186618/stackjp"}, "edited": false, "score": 0, "creation_date": 1472640340, "post_id": 39246605, "comment_id": 65830758, "body": "Apply it to Interior instead of Border (see Edit)."}, {"owner": {"reputation": 314, "user_id": 5724081, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1308c226220acb79f649ed25159676ed?s=128&d=identicon&r=PG&f=1", "display_name": "dudu721", "link": "https://stackoverflow.com/users/5724081/dudu721"}, "reply_to_user": {"reputation": 281, "user_id": 4186618, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/c094d5e72723c899603721345b1276fe?s=128&d=identicon&r=PG&f=1", "display_name": "StackJP", "link": "https://stackoverflow.com/users/4186618/stackjp"}, "edited": false, "score": 0, "creation_date": 1472640518, "post_id": 39246605, "comment_id": 65830889, "body": "Also you have a &quot;2&quot; at the end of   Set cht = ActiveSheet.Shapes.AddChart Remove it"}], "tags": [], "owner": {"reputation": 314, "user_id": 5724081, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1308c226220acb79f649ed25159676ed?s=128&d=identicon&r=PG&f=1", "display_name": "dudu721", "link": "https://stackoverflow.com/users/5724081/dudu721"}, "is_accepted": false, "score": 0, "last_activity_date": 1472641226, "last_edit_date": 1472641226, "creation_date": 1472637900, "answer_id": 39246605, "question_id": 39245965, "link": "https://stackoverflow.com/questions/39245965/vba-chart-color-doesnt-change/39246605#39246605", "title": "VBA - Chart Color Doesn&#39;t Change", "body": "<p>Try this : </p>\n\n<pre><code>Sub CreateChart()\nDim rng As Range\nSet rng = ActiveSheet.Range(\"A4:C8\")\nActiveSheet.Shapes.AddChart.Select\nWith ActiveChart\n    .SetSourceData Source:=Range(\"Feuil1!$A$4:$B$8\")\n    .SeriesCollection.NewSeries\n    .SetSourceData Source:=rng, PlotBy:=xlColumns\n    .ChartType = xlBarStacked\n    .SeriesCollection(1).Interior.ColorIndex = 5  'Change value to change color\n    End With\nEnd Sub\n</code></pre>\n\n<p>and choose the value in the color index table. 5 correspond to blue. You can get the color index table <a href=\"http://www.excel-pratique.com/fr/vba/img_couleurs/colorindex.png\" rel=\"nofollow\">here</a> .</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1472640895, "creation_date": 1472640895, "answer_id": 39247669, "question_id": 39245965, "link": "https://stackoverflow.com/questions/39245965/vba-chart-color-doesnt-change/39247669#39247669", "title": "VBA - Chart Color Doesn&#39;t Change", "body": "<p>See answer below, it implements what you wanted in your post, in a different method, allowing you more flexibility in the future:</p>\n\n<pre><code>Option Explicit\n\nSub CreateChart()\n\nDim rng             As Range\nDim cht             As ChartObject\nDim cht_Series      As Series\n\nSet rng = ActiveSheet.Range(\"A4:C8\")\n\n' in brackets (Left, Width, Top, Height) &gt;&gt; modify according to your needs\nSet cht = ActiveSheet.ChartObjects.Add(100, 100, 100, 100)\n\nWith cht\n    .Chart.SetSourceData Source:=rng\n    .Chart.PlotBy = xlColumns\n    .Chart.ChartType = xlBarStacked\nEnd With\n\nSet cht_Series = cht.Chart.SeriesCollection(1)\n' this will result to white (by your post) &gt;&gt; modify to your desired color\ncht_Series.Format.Fill.ForeColor.RGB = RGB(255, 255, 255)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 281, "user_id": 4186618, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/c094d5e72723c899603721345b1276fe?s=128&d=identicon&r=PG&f=1", "display_name": "StackJP", "link": "https://stackoverflow.com/users/4186618/stackjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1144, "favorite_count": 0, "accepted_answer_id": 39247669, "answer_count": 2, "score": 0, "last_activity_date": 1472641226, "creation_date": 1472636251, "question_id": 39245965, "link": "https://stackoverflow.com/questions/39245965/vba-chart-color-doesnt-change", "title": "VBA - Chart Color Doesn&#39;t Change", "body": "<p>I have this code to create a chart:</p>\n\n<pre><code>Sub CreateChart()\n    Dim rng As Range\n    Dim cht As Object\n    Set rng = ActiveSheet.Range(\"A4:C8\")\n    Set cht = ActiveSheet.Shapes.AddChart2\n    cht.Chart.SetSourceData Source:=rng, PlotBy:=xlColumns\n    cht.Chart.ChartType = xlBarStacked\n    cht.SeriesCollection(1).Interior.Color = RGB(255, 255, 255)\nEnd Sub\n</code></pre>\n\n<p>But the series 1 bars are not changing the color.</p>\n\n<p>Can you help?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "sas"], "comments": [{"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1472638806, "post_id": 39245820, "comment_id": 65829639, "body": "What are you using? SAS AMO? SAS EG, Base, or Studio and version. Also as a minimum please provide a screen shot of desired output and what you&#39;ve tried. For example is it the table structure you need or a native Excel pivot table. If it&#39;s a native Excel Pivot that&#39;s much more difficult."}, {"owner": {"reputation": 1, "user_id": 6778036, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208311679603193/picture?type=large", "display_name": "Rajesh M", "link": "https://stackoverflow.com/users/6778036/rajesh-m"}, "reply_to_user": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1472716298, "post_id": 39245820, "comment_id": 65866256, "body": "@Reeza I&#39;m using SAS EG 7.1 and yes, I need a native Excel Pivot. I found an article that helps me create a native pivot in [link] (<a href=\"http://blogs.sas.com/content/sgf/2015/03/27/using-sas-to-add-pivottables-to-your-excel-workbook/\" rel=\"nofollow noreferrer\">blogs.sas.com/content/sgf/2015/03/27/&hellip;</a>) . But I need to create two pivots both on the same page and then use them to create another table also on the same page."}, {"owner": {"reputation": 16968, "user_id": 1919583, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/35a12f323e0bea76c8b442df11825d57?s=128&d=identicon&r=PG", "display_name": "Reeza", "link": "https://stackoverflow.com/users/1919583/reeza"}, "edited": false, "score": 0, "creation_date": 1472722459, "post_id": 39245820, "comment_id": 65870337, "body": "Did you read the comments regarding issue with EG and this method? Also you&#39;re using SAS 9.4tS1M3? Can you run X commands on your installation?"}], "answers": [{"tags": [], "owner": {"reputation": 8247, "user_id": 214994, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e3e91979c0412d33b1c0f9d5476f2d36?s=128&d=identicon&r=PG", "display_name": "Robert Penridge", "link": "https://stackoverflow.com/users/214994/robert-penridge"}, "is_accepted": false, "score": 0, "last_activity_date": 1472669266, "creation_date": 1472669266, "answer_id": 39256909, "question_id": 39245820, "link": "https://stackoverflow.com/questions/39245820/how-do-i-add-two-pivot-tables-to-the-same-excel-sheet-through-a-sas-program-usin/39256909#39256909", "title": "How do I add two pivot tables to the same Excel sheet through a SAS program using two SAS datasets as the pivot data sources?", "body": "<p>This answer is for people that do not have any SAS Office Analytics, or the Office plugin, etc.  If you have some of the above tools (which I do not), there is probably a much better approach.</p>\n\n<p>If you find yourself in this situation I suggest that you do the following:</p>\n\n<ol>\n<li>Use SAS to create a CSV file that contains data that will drive the pivots.</li>\n<li>Create an excel file that links to data in a CSV file.  </li>\n<li>Build the two pivots by hand, with the formatting you desire.</li>\n<li>Whenever you need to refresh the data, just rerun the SAS job, and then 'refresh' the data in Excel (manually).</li>\n</ol>\n\n<p>This also means you can update the data if people already have the excel file open, so it's suitable for files located on a network etc.  Pretty clunky but it will do when no better options are available.</p>\n"}], "owner": {"reputation": 1, "user_id": 6778036, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208311679603193/picture?type=large", "display_name": "Rajesh M", "link": "https://stackoverflow.com/users/6778036/rajesh-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472669266, "creation_date": 1472635891, "last_edit_date": 1472644964, "question_id": 39245820, "link": "https://stackoverflow.com/questions/39245820/how-do-i-add-two-pivot-tables-to-the-same-excel-sheet-through-a-sas-program-usin", "title": "How do I add two pivot tables to the same Excel sheet through a SAS program using two SAS datasets as the pivot data sources?", "body": "<p>I have two SAS tables and I want to create pivot tables in Excel from them. Both must be in the same sheet, say <code>Sheet1</code>.</p>\n\n<p>In the same sheet, I need to create a table that contains cells with formulae based on the first two pivots, e.g. <code>C3-C10</code>, where <code>C3</code> is a data point of the first pivot and <code>C10</code> from the second pivot.</p>\n\n<p>An additional challenge would be to figure out a way to format and change colours of specific rows as required in the sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472635401, "post_id": 39245584, "comment_id": 65827152, "body": "What&#39;s your question?  You can use IF and - in excel.  Made easier by the last 2 outcomes doing the same operation."}, {"owner": {"reputation": 17, "user_id": 6775210, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-10zyCGiOZFs/AAAAAAAAAAI/AAAAAAAAADY/5q-Y8NaaoFw/photo.jpg?sz=128", "display_name": "David ", "link": "https://stackoverflow.com/users/6775210/david"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472635519, "post_id": 39245584, "comment_id": 65827233, "body": "Im not 100% sure how to write it !"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1472635954, "post_id": 39245584, "comment_id": 65827606, "body": "<code>=IF(AND(A1=B1,A1=C1,B1=C1),0,IF(AND(A1=B1,B1&lt;&gt;C1),A1-C1,IF(A&zwnj;&#8203;ND(A1=C1,B1&lt;&gt;C1),A1-&zwnj;&#8203;B1,IF(AND(B1=C1,A1&lt;&gt;&zwnj;&#8203;C1),A1-B1,FALSE))))</code> - there&#39;s probably a better way to write it though."}], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 1, "last_activity_date": 1472636012, "creation_date": 1472636012, "answer_id": 39245881, "question_id": 39245584, "link": "https://stackoverflow.com/questions/39245584/difference-between-three-cells/39245881#39245881", "title": "Difference between three cells", "body": "<p>OK. I agree <em>very</em> similar to your other question, but rather than letter references I have taken the differences and wrapped them in <a href=\"https://support.office.com/en-gb/article/ABS-function-3420200f-5628-4e8c-99da-c99d7c87713c\" rel=\"nofollow\">ABS</a> as I can't see any sign convention making much sense:  </p>\n\n<pre><code>=IF(AND(A1=B1,A1=C1),\"match\",IF(A1=B1,ABS(A1-C1),IF(A1=C1,ABS(B1-A1),IF(B1=C1,ABS(A1-B1),\"none\"))))\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6775210, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-10zyCGiOZFs/AAAAAAAAAAI/AAAAAAAAADY/5q-Y8NaaoFw/photo.jpg?sz=128", "display_name": "David ", "link": "https://stackoverflow.com/users/6775210/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "accepted_answer_id": 39245881, "answer_count": 1, "score": -2, "last_activity_date": 1472636012, "creation_date": 1472635260, "last_edit_date": 1472635545, "question_id": 39245584, "link": "https://stackoverflow.com/questions/39245584/difference-between-three-cells", "title": "Difference between three cells", "body": "<p>I have three cells A,B and C (A=80 B=79.1 C=79.1).\nI require cell D to display the 0.9 difference that occurs and if the case is none match </p>\n\n<p>`If A=B=C = 0</p>\n\n<p>If A=B&lt;>C = difference between A and C</p>\n\n<p>If A=C&lt;>B = difference between A and B\n`</p>\n"}, {"tags": ["vba", "excel", "date", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1472635749, "post_id": 39245434, "comment_id": 65827430, "body": "I&#39;m using <code>English (Australia)</code> as my location and (although we would often write dates in the format the OP has) <code>DATEVALUE(&quot;Aug 29, 2016&quot;)</code> doesn&#39;t work for me.  It might be better to use <code>=TEXT(DATEVALUE(MID(A1,5,2)&amp;&quot; &quot;&amp;MID(A1,1,3)&amp;MID(A1,8,5)),&quot;dd&#47;mm&#47;yyyy&quot;)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1472636214, "post_id": 39245434, "comment_id": 65827820, "body": "Actually, it might be better to use <code>=TEXT(DATEVALUE(SUBSTITUTE(MID(A1,5,2),&quot;,&quot;,&quot;&quot;)&amp;&quot; &quot;&amp;LEFT(A1,3)&amp;&quot; &quot;&amp;RIGHT(A1,4)),&quot;dd&#47;mm&#47;yyyy&quot;)</code> just in case the day is specified as a single digit."}], "tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": true, "score": 2, "last_activity_date": 1472639515, "last_edit_date": 1472639515, "creation_date": 1472634837, "answer_id": 39245434, "question_id": 39245365, "link": "https://stackoverflow.com/questions/39245365/how-to-change-aug-29-2016-date-format-into-dd-mm-yyyy-either-with-formula-or/39245434#39245434", "title": "How to change &#39;Aug 29, 2016&#39; date format into dd/mm/yyyy either with formula or VBA", "body": "<p>try</p>\n\n<pre><code>=TEXT(DATEVALUE(AH2),\"DD/MM/YYYY\")\n</code></pre>\n\n<p>if the date format is not compatible with your system language setting, then you ought to put in additional functions. Below is tested for <strong>English (Australia)</strong>, further shorten from YowE3K suggestion..</p>\n\n<pre><code>=TEXT(--(SUBSTITUTE(MID(A1,5,2),\",\",\"\")&amp;LEFT(A1,3)&amp;RIGHT(A1,4)),\"dd/mm/yyyy\")\n</code></pre>\n\n<p>sometimes the <code>TEXT()</code> is not really necessary because you can always use excel's more versatile number formatting. So you may just convert the dates into values (not as text) and apply the appropriate date format. The formula would be just</p>\n\n<pre><code>=--(SUBSTITUTE(MID(A1,5,2),\",\",\"\")&amp;LEFT(A1,3)&amp;RIGHT(A1,4))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 1, "creation_date": 1472640412, "post_id": 39247272, "comment_id": 65830814, "body": "another way instead of using many IF is <code>=CONCATENATE(MID(A1,5,2),&quot;&#47;&quot;,TEXT(MATCH(LEFT(A1,3),{&quot;Jan&quot;,&quot;F&zwnj;&#8203;eb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&zwnj;&#8203;&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&zwnj;&#8203;&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;D&zwnj;&#8203;ec&quot;},0),&quot;00&quot;),&quot;&#47;&quot;,RI&zwnj;&#8203;GHT(A1,4))</code>"}], "tags": [], "owner": {"reputation": 145, "user_id": 5974075, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a602a3792da84eb828ff22a4450ee180?s=128&d=identicon&r=PG&f=1", "display_name": "TCassa", "link": "https://stackoverflow.com/users/5974075/tcassa"}, "is_accepted": false, "score": 0, "last_activity_date": 1472639731, "creation_date": 1472639731, "answer_id": 39247272, "question_id": 39245365, "link": "https://stackoverflow.com/questions/39245365/how-to-change-aug-29-2016-date-format-into-dd-mm-yyyy-either-with-formula-or/39247272#39247272", "title": "How to change &#39;Aug 29, 2016&#39; date format into dd/mm/yyyy either with formula or VBA", "body": "<p>In addition to @YowE3K's response, I was also using this long-winded solution:</p>\n\n<pre><code>=CONCATENATE(MID(AH2,5,2),\"/\",IF(LEFT(AH2,3) = \"Jan\",\"01\",IF(LEFT(AH2,3) = \"Feb\",\"02\",IF(LEFT(AH2,3) = \"Mar\",\"03\",IF(LEFT(AH2,3) = \"Apr\",\"04\",IF(LEFT(AH2,3) = \"May\",\"05\",IF(LEFT(AH2,3) = \"Jun\",\"06\",IF(LEFT(AH2,3) = \"Jul\",\"07\",IF(LEFT(AH2,3) = \"Aug\",\"08\",IF(LEFT(AH2,3) = \"Sep\",\"09\",IF(LEFT(AH2,3) = \"Oct\",\"10\",IF(LEFT(AH2,3) = \"Nov\",\"11\",\"12\"),\"/2016\")\n</code></pre>\n\n<p>But YowE3K's is better!</p>\n"}, {"tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": false, "score": 0, "last_activity_date": 1472705664, "last_edit_date": 1592644375, "creation_date": 1472705664, "answer_id": 39262915, "question_id": 39245365, "link": "https://stackoverflow.com/questions/39245365/how-to-change-aug-29-2016-date-format-into-dd-mm-yyyy-either-with-formula-or/39262915#39262915", "title": "How to change &#39;Aug 29, 2016&#39; date format into dd/mm/yyyy either with formula or VBA", "body": "<p>The previous answers appear to be giving you the date format as text.  If this suits your needs, great.  However if you would prefer to have it in excels Date/Time format you can use to following.  I find that usually having the date and/or time in the excel format is better as you can then later use simpler formulas with it if there is any form of further manipulation that you may want to do with the dates such as a chronological sort instead of an alphabetical sort.</p>\n<p>You are going to need to go through a series of string manipulation and date functions. Lets start by assuming your string is in the AH2 cell. In order to do this we are going to work from the largest unit (years) to the smallest unit (days). You can do it in any order as it will all be lumped into one formula in the end but for the breakdown of steps its good to have an order.</p>\n<h2>Step 1) PULL OUT THE YEAR</h2>\n<pre><code>=RIGHT(AH2,4)\n</code></pre>\n<p>That will give us the last 4 characters of the string which in this case is the year.</p>\n<h2>Step 2) PULL OUT THE MONTH</h2>\n<pre><code>=MONTH(DATEVALUE(LEFT(AH2,3)&amp;&quot;-&quot;&amp;1))\n</code></pre>\n<p>that takes the first 3 characters which is your month. It then converts it to a format that excel tends to recognize as a date short form by adding a - and the digit 1 to it. So in your case if would look like Aug-1. Datevalue converts this to an excel date serial, which we then pull back and grab the month from and in your case that is 8</p>\n<p>If the above formula does not work for you it could be due to regional settings. If that is the case you can use the following:</p>\n<pre><code>=MATCH(LEFT(AH2,3),{&quot;Jan&quot;,&quot;Feb&quot;,&quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;,&quot;Jun&quot;,&quot;Jul&quot;,&quot;Aug&quot;,&quot;Sep&quot;,&quot;Oct&quot;,&quot;Nov&quot;,&quot;Dec&quot;},0)\n</code></pre>\n<p>If you use this alternate formula , be sure to adjust the final equation accordingly.</p>\n<h2>Step 3) PULL OUT THE DAY</h2>\n<pre><code>=TRIM(MID(AH2,FIND(&quot;,&quot;,AH2)-2,2))\n</code></pre>\n<p>The above formula finds the first comma, and then goes back 2 characters and then starts pulling then next 2 characters. Now since I do not know if the first of the month is 01 or just 1, it may wind up grabbing the space in front of the 1. The trim function removes excess spaces.</p>\n<h2>Step 4) BUILD THE DATE</h2>\n<p>The DATE function in excel requires the YEAR, MONTH, and DAY and converts those values in to the excel date serial. In this case we will convert:</p>\n<pre><code>=DATE(year,month,day)\n</code></pre>\n<p>to the following by substituting our equations from above:</p>\n<pre><code>=DATE(RIGHT(AH2,4),MONTH(DATEVALUE(LEFT(AH2,3)&amp;&quot;-&quot;&amp;1)),TRIM(MID(AH2,FIND(&quot;,&quot;,AH2)-2,2)))\n</code></pre>\n<p>The final touch is to ensure your cell is formatted as date and not General or some other format which will result as the date being displayed in an integer format.</p>\n<h2>FORMULAS USED</h2>\n<p>Text/String Functions</p>\n<ul>\n<li><a href=\"https://support.office.com/en-us/article/LEFT-LEFTB-functions-9203d2d2-7960-479b-84c6-1ea52b99640c\" rel=\"nofollow noreferrer\">LEFT</a></li>\n<li><a href=\"https://support.office.com/en-us/article/RIGHT-RIGHTB-functions-240267ee-9afa-4639-a02b-f19e1786cf2f\" rel=\"nofollow noreferrer\">RIGHT</a></li>\n<li><a href=\"https://support.office.com/en-US/article/MID-MIDB-functions-D5F9E25C-D7D6-472E-B568-4ECB12433028\" rel=\"nofollow noreferrer\">MID</a></li>\n<li><a href=\"https://support.office.com/en-US/article/FIND-FINDB-functions-C7912941-AF2A-4BDF-A553-D0D89B0A0628\" rel=\"nofollow noreferrer\">FIND</a></li>\n<li><a href=\"https://support.office.com/en-US/article/TRIM-function-410388FA-C5DF-49C6-B16C-9E5630B479F9\" rel=\"nofollow noreferrer\">TRIM</a></li>\n</ul>\n<p>Date/Time Functions</p>\n<ul>\n<li><a href=\"https://support.office.com/en-US/article/DATE-function-E36C0C8C-4104-49DA-AB83-82328B832349\" rel=\"nofollow noreferrer\">DATE</a></li>\n<li><a href=\"https://support.office.com/en-US/article/DATEVALUE-function-DF8B07D4-7761-4A93-BC33-B7471BBFF252\" rel=\"nofollow noreferrer\">DATEVALUE</a></li>\n<li><a href=\"https://support.office.com/en-US/article/MONTH-function-579A2881-199B-48B2-AB90-DDBA0EBA86E8\" rel=\"nofollow noreferrer\">MONTH</a></li>\n</ul>\n"}], "owner": {"reputation": 145, "user_id": 5974075, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a602a3792da84eb828ff22a4450ee180?s=128&d=identicon&r=PG&f=1", "display_name": "TCassa", "link": "https://stackoverflow.com/users/5974075/tcassa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1837, "favorite_count": 0, "accepted_answer_id": 39245434, "answer_count": 3, "score": 1, "last_activity_date": 1472705664, "creation_date": 1472634672, "question_id": 39245365, "link": "https://stackoverflow.com/questions/39245365/how-to-change-aug-29-2016-date-format-into-dd-mm-yyyy-either-with-formula-or", "title": "How to change &#39;Aug 29, 2016&#39; date format into dd/mm/yyyy either with formula or VBA", "body": "<p>I've got a file with a date column which contains the dates in this format:</p>\n\n<pre><code>Aug 29, 2016\n</code></pre>\n\n<p>It's formatted as text, and changing the format of the column does not affect it. I need it in DD/MM/YYYY format. Previously, I was doing a formula along the lines of</p>\n\n<pre><code>=CONCATENATE(MID(AH2,5,2),\"/08/2016\")\n</code></pre>\n\n<p>But would have to change the \"/08/2016\" to whatever the month was. I'm looking for a more efficient way I can do this, preferably in a Macro, but a more dynamic formula would be helpful. Can anyone help?</p>\n"}, {"tags": ["vba", "email", "batch-file", "outlook"], "comments": [{"owner": {"reputation": 3370, "user_id": 6707985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1zWzI.jpg?s=128&g=1", "display_name": "geisterfurz007", "link": "https://stackoverflow.com/users/6707985/geisterfurz007"}, "edited": false, "score": 0, "creation_date": 1472635295, "post_id": 39245357, "comment_id": 65827072, "body": "Would opening Outlook, sending the Mail and immediately closing it again be an option?"}, {"owner": {"reputation": 51388, "user_id": 388389, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/zK42B.png?s=128&g=1", "display_name": "npocmaka", "link": "https://stackoverflow.com/users/388389/npocmaka"}, "edited": false, "score": 2, "creation_date": 1472635329, "post_id": 39245357, "comment_id": 65827095, "body": "if you know your smpt credentials you can check <a href=\"http://www.blat.net/?faq/index.html\" rel=\"nofollow noreferrer\">blat</a>"}, {"owner": {"reputation": 79, "user_id": 3066054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e80eaa901b87f19491b7580cb8cd47d?s=128&d=identicon&r=PG&f=1", "display_name": "JSLearner", "link": "https://stackoverflow.com/users/3066054/jslearner"}, "edited": false, "score": 0, "creation_date": 1472635955, "post_id": 39245357, "comment_id": 65827607, "body": "No opening outlook is not an option."}, {"owner": {"reputation": 10786, "user_id": 4158862, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fKDhB.png?s=128&g=1", "display_name": "SomethingDark", "link": "https://stackoverflow.com/users/4158862/somethingdark"}, "edited": false, "score": 0, "creation_date": 1472636545, "post_id": 39245357, "comment_id": 65828031, "body": "VBA (and probably VBScript) can manipulate Outlook without Outlook being open."}, {"owner": {"reputation": 79, "user_id": 3066054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e80eaa901b87f19491b7580cb8cd47d?s=128&d=identicon&r=PG&f=1", "display_name": "JSLearner", "link": "https://stackoverflow.com/users/3066054/jslearner"}, "edited": false, "score": 0, "creation_date": 1472637294, "post_id": 39245357, "comment_id": 65828566, "body": "blat is not an option as the third party tool only uses outlook. I need something which will send emails which are in outbox when outlook is closed."}, {"owner": {"reputation": 22536, "user_id": 1683264, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1775f6311d777e21ee2c59df9769e60b?s=128&d=identicon&r=PG", "display_name": "rojo", "link": "https://stackoverflow.com/users/1683264/rojo"}, "edited": false, "score": 0, "creation_date": 1472643641, "post_id": 39245357, "comment_id": 65833024, "body": "Would CDO be an option? <a href=\"https://support.microsoft.com/en-us/kb/286431\" rel=\"nofollow noreferrer\">Example 1</a> | <a href=\"http://www.rondebruin.nl/win/s1/cdo.htm\" rel=\"nofollow noreferrer\">Example 2</a> | <a href=\"https://www.google.com/search?q=cdo%20html%20email\" rel=\"nofollow noreferrer\">lmgtfy</a>"}, {"owner": {"reputation": 79, "user_id": 3066054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e80eaa901b87f19491b7580cb8cd47d?s=128&d=identicon&r=PG&f=1", "display_name": "JSLearner", "link": "https://stackoverflow.com/users/3066054/jslearner"}, "edited": false, "score": 0, "creation_date": 1472647031, "post_id": 39245357, "comment_id": 65835432, "body": "No. I need is some script which can send emails from outbox when outlook is closed as the third party component just puts the emails in the outbox."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1472647945, "post_id": 39245357, "comment_id": 65836118, "body": "I don&#39;t think what you are asking for is possible, could be wrong though. Outlook has to be opened (albeit programmatically) to send an email. Outlook has always opened up to send an email when using the Outlook Object. You can probably program something in to quit outlook after all emails are sent, so it&#39;s not left open longer than needed. Or as others have mentioned, rework your solution to send the emails directly through the email server (e.g. CDO/blat)."}, {"owner": {"reputation": 79, "user_id": 3066054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e80eaa901b87f19491b7580cb8cd47d?s=128&d=identicon&r=PG&f=1", "display_name": "JSLearner", "link": "https://stackoverflow.com/users/3066054/jslearner"}, "edited": false, "score": 0, "creation_date": 1472650262, "post_id": 39245357, "comment_id": 65837751, "body": "As its a third party tool I cannot change the way it works. I am trying to see if I can write any VB script so that I can do send/receive on outlook without opening it. I am not sure if that is possible."}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 3066054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e80eaa901b87f19491b7580cb8cd47d?s=128&d=identicon&r=PG&f=1", "display_name": "JSLearner", "link": "https://stackoverflow.com/users/3066054/jslearner"}, "is_accepted": false, "score": 0, "last_activity_date": 1473336537, "creation_date": 1473336537, "answer_id": 39390517, "question_id": 39245357, "link": "https://stackoverflow.com/questions/39245357/sending-emails-from-outbox-when-outlook-is-closed/39390517#39390517", "title": "Sending emails from outbox when outlook is closed", "body": "<p>After all the research I found out that outlook 2010 cannot send emails which are in the outbox when it is closed. Even the VB Script I wrote opens it in the background. Thank you to everyone who tried to help. We are using thunderbird now. It does not solve the issue which I asked but it is free so we can create multiple from accounts which we need and keep it open.</p>\n"}], "owner": {"reputation": 79, "user_id": 3066054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1e80eaa901b87f19491b7580cb8cd47d?s=128&d=identicon&r=PG&f=1", "display_name": "JSLearner", "link": "https://stackoverflow.com/users/3066054/jslearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 522, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1473336537, "creation_date": 1472634635, "last_edit_date": 1472640622, "question_id": 39245357, "link": "https://stackoverflow.com/questions/39245357/sending-emails-from-outbox-when-outlook-is-closed", "title": "Sending emails from outbox when outlook is closed", "body": "<p>My application uses a third party tool which sends reports via email using outlook.\nThis functionality was working correctly with outlook express and windows 2003 server. Now we have upgraded to windows 2008 R2 and Outlook 2010 it needs outlook to be open to send out emails or else the emails just sit in the outbox.\nWe don't have any control over third party tool and application is in maintenance mode so no code changes can be done. And we cannot keep outlook open.\nIs there any way emails can be sent from outbox without the outlook being open?\nLike any script which can be run outside of the application?\nOr is there any setting in outlook? </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6777467, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/160dfa2d097132967c66471170847e62?s=128&d=identicon&r=PG&f=1", "display_name": "user6777467", "link": "https://stackoverflow.com/users/6777467/user6777467"}, "edited": false, "score": 0, "creation_date": 1472727976, "post_id": 39245245, "comment_id": 65874147, "body": "I&#39;ve huge data, and a column called as Ending inventory. ending inventory of week w4 should be the ending inventory for Month M1 too, I hope you got my problem, thats why I cant use pivot. I cant use the pattern of dragging as some months have 5 weeks, in that case week5 data should be the ending inventory"}, {"owner": {"reputation": 1212, "user_id": 2834295, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1ab5839bfa69a7282cae53b15097bcfc?s=128&d=identicon&r=PG&f=1", "display_name": "mr.bjerre", "link": "https://stackoverflow.com/users/2834295/mr-bjerre"}, "reply_to_user": {"reputation": 1, "user_id": 6777467, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/160dfa2d097132967c66471170847e62?s=128&d=identicon&r=PG&f=1", "display_name": "user6777467", "link": "https://stackoverflow.com/users/6777467/user6777467"}, "edited": false, "score": 0, "creation_date": 1472798564, "post_id": 39245245, "comment_id": 65905793, "body": "I suggest you extend your original post with your goal - how should the result look like given your above example?"}], "tags": [], "owner": {"reputation": 1212, "user_id": 2834295, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1ab5839bfa69a7282cae53b15097bcfc?s=128&d=identicon&r=PG&f=1", "display_name": "mr.bjerre", "link": "https://stackoverflow.com/users/2834295/mr-bjerre"}, "is_accepted": false, "score": 0, "last_activity_date": 1472634344, "creation_date": 1472634344, "answer_id": 39245245, "question_id": 39245013, "link": "https://stackoverflow.com/questions/39245013/consolidate-data-for-weeks-to-months-and-quarters-weeks-are-like-w1-w2-and-not/39245245#39245245", "title": "Consolidate data for weeks to months and quarters, weeks are like W1, W2 and not in date format", "body": "<p>You should be able to post images here on stackoverflow.</p>\n\n<p>Anyways; will a <code>PivotTable</code> do the job for you? Mark the data and then <code>Insert -&gt; PivotTable</code>. You are working in Excel, right?</p>\n"}], "owner": {"reputation": 1, "user_id": 6777467, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/160dfa2d097132967c66471170847e62?s=128&d=identicon&r=PG&f=1", "display_name": "user6777467", "link": "https://stackoverflow.com/users/6777467/user6777467"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472825246, "creation_date": 1472633643, "last_edit_date": 1531164843, "question_id": 39245013, "link": "https://stackoverflow.com/questions/39245013/consolidate-data-for-weeks-to-months-and-quarters-weeks-are-like-w1-w2-and-not", "title": "Consolidate data for weeks to months and quarters, weeks are like W1, W2 and not in date format", "body": "<p>I've data like this below and want to consolidate data for months and then quarters. Problem is in one month there are 4 weeks and in another month I've 5 weeks, so I can't just apply formula and drag it especially if I've thousands of rows... Any hint would be appreciated.</p>\n\n<p>Data is like this:</p>\n\n<pre><code>Month| Weeks| Sales    \nM1| W1|50    \nM1|W1|30    \nM1| W1|40    \nM1|W1|20    \nM2| W1|50    \nM2|W2|30    \nM2| W3|40    \nM2|W4|20    \nM2|W5|20\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2007"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1472634648, "post_id": 39244954, "comment_id": 65826671, "body": "Welcome to SO, what have you tried so far? SO is not a code writing service, please provide what you have tried to solve this yourself."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472635193, "post_id": 39244954, "comment_id": 65826996, "body": "in less than 1 minute <a href=\"http://stackoverflow.com/questions/7899034/compare-values-in-excel-vba\" title=\"compare values in excel vba\">stackoverflow.com/questions/7899034/compare-values-in-excel-&zwnj;&#8203;vba</a> and <a href=\"http://www.homeandlearn.org/write_to_a_text_file.html\" rel=\"nofollow noreferrer\">homeandlearn.org/write_to_a_text_file.html</a>"}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1472635375, "post_id": 39244954, "comment_id": 65827131, "body": "I planned to use two for loop. Since there are more addresses in dump file (35000) and ard 31000 files in address i am not sure how to do it efficiently.  I have not done a lot of coding and I am a beginner so it is seems very complicated for me."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1472640056, "post_id": 39244954, "comment_id": 65830560, "body": "Show what you have tried and/or get stuck with, this shows research and effort. just asking without providing = plz give me the codez."}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "edited": false, "score": 1, "creation_date": 1472726226, "post_id": 39244954, "comment_id": 65872921, "body": "Where are you getting the data from? It may be quicker, for instance, if you use a database&#39;s own functionality rather than trying to process 132,000 cells in Excel."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1472736328, "post_id": 39244954, "comment_id": 65880125, "body": "I am getting the data from 2 .s19 files.  I am not sure if it has any database functionality."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1472736985, "post_id": 39244954, "comment_id": 65880630, "body": "I import the 2 .s19 files into excel and then split them into the 2columns address and data. Is it a better idea keep it as a single string ? Because after the search I need to check if the data cell if all the characters are FFFFF, if it&#39;s true return OK if not return NOT OK."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "reply_to_user": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "edited": false, "score": 0, "creation_date": 1473082469, "post_id": 39244954, "comment_id": 65994974, "body": "@JasonStallard Will Microsoft Access or SQL Server Express be a better software to do this task?"}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "edited": false, "score": 1, "creation_date": 1473090263, "post_id": 39244954, "comment_id": 65999178, "body": "Doesn&#39;t Metrowerks use s19 files? I&#39;m just a beginner myself in VBA; I&#39;m not a business analyst or anything."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1472693786, "post_id": 39253736, "comment_id": 65858676, "body": "Thanks a lot @Jason Stallard. And the comments really helped me to understand easily."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1472719047, "post_id": 39253736, "comment_id": 65867864, "body": "If the addresses match, I think it doesnt check whether the data is the same at both the addresses. For example, source file has address &#39;s040&#39; with data &#39;z&#39; but dump file has address &#39;s040&#39; with data &#39;d&#39;"}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "reply_to_user": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 1, "creation_date": 1472726466, "post_id": 39253736, "comment_id": 65873107, "body": "You have the targetcell. You just need to compare it&#39;s .Value with the address you are finding (fa)."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1472736675, "post_id": 39253736, "comment_id": 65880386, "body": "I agree. But we are not storing the cell value og column C anywhere, right ? I am not sure how to call the data beside it? I tried to find it  using if Range (d &amp; cr) = range (b &amp; cr) but it didn&#39;t work as the target cell in the  dump file could in another line than cr. I can post my code once I get home."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1472780708, "post_id": 39253736, "comment_id": 65900757, "body": "i mean i need to compare the data linked to the address at column b and d. target cell checks only address, right?"}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "reply_to_user": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 1, "creation_date": 1473091119, "post_id": 39253736, "comment_id": 65999613, "body": "The following can be inserted as part of the if: <code>Else         If Range(Chr(Asc(sf) + 1) &amp; cr).Value &lt;&gt; Range(Chr(targetcell.Column + 65) &amp; cr).Value Then             Write #fn, &quot;Cell &quot; &amp; sf &amp; cr &amp; &quot;: &quot; &amp; Range(sf &amp; cr).Value &amp; &quot;,&quot; &amp; Range(Chr(Asc(sf) + 1) &amp; cr).Value &amp; &quot; differs from cell &quot; &amp; si &amp; cr &amp; &quot;: &quot; &amp; Range(si &amp; cr).Value &amp; &quot;,&quot; &amp; Range(Chr(Asc(si) + 1) &amp; cr).Value         End If</code> but it will report the differences twice. You&#39;ll need to change the loop."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1473219965, "post_id": 39253736, "comment_id": 66051118, "body": "I have 1 more requirement. Hope u could help me. Thanks a lot!"}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "reply_to_user": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1473251725, "post_id": 39253736, "comment_id": 66068085, "body": "Sorry, @Manick9, you lost me."}, {"owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "edited": false, "score": 0, "creation_date": 1473260663, "post_id": 39253736, "comment_id": 66074902, "body": "Its ok. Will using a Collection or Dictionary improve the time of the program? Or is it better to switch to another language such as C# ?"}], "tags": [], "owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "is_accepted": true, "score": 1, "last_activity_date": 1472657787, "creation_date": 1472657787, "answer_id": 39253736, "question_id": 39244954, "link": "https://stackoverflow.com/questions/39244954/comparing-data-in-4-columns/39253736#39253736", "title": "Comparing Data in 4 Columns", "body": "<p>I whipped this up for the fun of it:</p>\n\n<pre><code>'Get a the next available file number\n    fn = FreeFile\n'Open your file ready for writing.\n    Open \"your full path and file name\" For Output As #fn\n'Set the First row to search from.\n    fr = 2\n'Find the last row.\n    lr = ActiveCell.SpecialCells(xlLastCell).Row\n'Set the column for the value that you are searching for.\n    sf = \"A\"\n'Set the column for that you are searching in.\n    si = \"C\"\n'You want to search two columns\n    For l = 1 To 2\n'Loop from first row to the last row.\n        For cr = fr To lr\n'Set the address you're trying to find\n            fa = Range(sf &amp; cr).Value\n'Find it\n            Set targetcell = Range(si &amp; fr &amp; \":\" &amp; si &amp; lr).Find(What:=fa, LookIn:=xlValues, _\n                SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n'If Nothing is returned it is not found\n            If targetcell Is Nothing Then\n'Write your search cell and it's ajacent to your file.\n                Write #fn, Range(sf &amp; cr).Value &amp; \",\" &amp; Range(Chr(Asc(sf) + 1) &amp; cr).Value\n            End If\n'I always put a DoEvents in a loop; just in case you need to break out of it.\n            DoEvents\n        Next\n'Now you've done one column swap them over and do it again.\n        sf = \"C\"\n        si = \"A\"\n    Next\n'It's done.\n    Close #fn\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 6716822, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3c7e315e7518e12f393589376eee9d30?s=128&d=identicon&r=PG&f=1", "display_name": "Manick9", "link": "https://stackoverflow.com/users/6716822/manick9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 39253736, "answer_count": 1, "score": -5, "last_activity_date": 1473219417, "creation_date": 1472633478, "last_edit_date": 1473219417, "question_id": 39244954, "link": "https://stackoverflow.com/questions/39244954/comparing-data-in-4-columns", "title": "Comparing Data in 4 Columns", "body": "<p>I am new to VB I need to compare the address on both columns.</p>\n\n<p>If both addresses match check whether both data match, if not output both source file and dump file address and data to a text file.</p>\n\n<p>If an address in column A is not found in column C, output source file address and data to a text file. </p>\n\n<p>If an address in column C is not found in column A, output dump file address and data to a text file.</p>\n\n<p>Hope someone can help me. Thanks!</p>\n\n<pre><code>  Source File           Dump File  \n      a         b          c        d\n1  address    data      address    data\n2   s100       a         s010       x\n3   S010       x         s020       b\n4   S030       y         S030       y\n5   s040       z         S040       d\n</code></pre>\n\n<hr>\n\n<p>One Issue</p>\n\n<p>If the addresses match, I think it doesnt check whether the data is the same at both the addresses. For example, source file has address 's040' with data 'z' but dump file has address 's040' with data 'd'</p>\n\n<p>Time Issue</p>\n\n<p>It took very long as there are ard 900M iterations. Is it better to to remove the duplicates first then run this search? I tried to use excel's remove duplicates feature but it only work for one column. It takes ard 25mins for the whole cycle.</p>\n\n<hr>\n\n<p>Combining Data if Consecutive addresses are unique in a list:</p>\n\n<p>If there is a chunk of unique addresses in one column, I need to find the start address of the first unique address and the last unique address and \noutput only those lines which are not all FF's like this:</p>\n\n<pre><code>'If all the data are FF's output like this\nFile: dump.s19\n0x006180 \u2013 0x007E8F\n[Result] OK\n\n'Here certain lines are all FF's which are not displayed here, only Non FF's lines need to printed as follows.\nFile: dump.s19\n0x007EB0 \u2013 0x00FFFF\nS224007FF0FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF4247494EFFFFFFFFFFFFFFFF0000FFFF66\nS224008010FFFFFFFF01019D160825A100100201FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFCA\n\nS224008050302D4100E0FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA8\nS224008070FFFFFFFFFFFFFFFFFFFFA3BF454E442EFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9E\nResult: NOK\n</code></pre>\n\n<hr>\n\n<p>I am not sure how to integrate this additional logic into my code.</p>\n\n<pre><code>'Set the address you're trying to find\n            fa = Range(sf &amp; cr).Value\n            fa_data = Range(Chr(Asc(sf) + 1) &amp; cr).Value\n            Debug.Print \"fa\" &amp; fa\n'Find it\n            Set targetcell = Range(si &amp; 3 &amp; \":\" &amp; si &amp; lr_2).Find(What:=fa, LookIn:=xlValues, _\n                SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=True)\n'If Nothing is returned it is not found\n            If targetcell Is Nothing Then\n'Write your search cell and it's ajacent to your file.\n                If l = 1 Then\n\n                    startadd = Range(sf &amp; cr).Value\n                    If startadd &lt;&gt; \"FFFFFF\" Then\n\n                        Dec_startadd = Val(\"&amp;H\" &amp; startadd &amp; \"&amp;H\")\n                        lgth = Len(Range(Chr(Asc(sf) + 1) &amp; cr)) - 2\n                        lgth = lgth / 2 - 1\n                        endadd = Hex(Dec_startadd + lgth)\n                        endadd = Right(\"000000\" &amp; endadd, 6)\n\n                        Print #fn, \"File:\" &amp; orig_filename\n                        Print #fn, \"0x\" &amp; startadd &amp; \" - 0x\" &amp; endadd\n                        Print #fn, Range(Chr(Asc(sf) - 1) &amp; cr).Value &amp; Range(sf &amp; cr).Value &amp; Range(Chr(Asc(sf) + 1) &amp; cr).Value\n                        Print #fn, \"Result: NOK\"\n                        Print #fn,\n                        Print #fn,    \n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 1566860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ff5024f6e4a1ffb89098df42d4c17b?s=128&d=identicon&r=PG", "display_name": "xn1", "link": "https://stackoverflow.com/users/1566860/xn1"}, "is_accepted": true, "score": 0, "last_activity_date": 1472634242, "creation_date": 1472634242, "answer_id": 39245212, "question_id": 39244948, "link": "https://stackoverflow.com/questions/39244948/combobox-text-not-on-list-error-handling-vba/39245212#39245212", "title": "combobox text not on list error handling VBA", "body": "<p>Try checking the list index of the item selected, -1 would indicate something has been entered that is not valid</p>\n\n<pre><code>'if submit button is pressed go to selected worksheet or close the userform:\n\n   Private Sub Submit_Click()\n   Dim sWs As String\n\n   'the string is the text from combobox, called 'Title', selected on front page: \n   If Me.Title.ListIndex = - 1 Then\n     MsgBox \"Invalid Entry\"\n     End\n   End If\n\n      sWs = Me.Title.Value\n\n      'if nothing is selected then close the userform:\n      If sWs = (\"\") Then\n      End\n      End If\n\n      'If an item is selected from the dropdown list then show that worksheet and close the userform:\n      Worksheets(sWs).Select\n      End\n      End Sub\n\n'If exit button is pressed close the userform:\n   Private Sub ExitButton_Click()\n   End \n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6777800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db19720168c90ff5d5342c0f6dec2ee6?s=128&d=identicon&r=PG&f=1", "display_name": "amalpass", "link": "https://stackoverflow.com/users/6777800/amalpass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1752, "favorite_count": 0, "accepted_answer_id": 39245212, "answer_count": 1, "score": 0, "last_activity_date": 1472635105, "creation_date": 1472633460, "question_id": 39244948, "link": "https://stackoverflow.com/questions/39244948/combobox-text-not-on-list-error-handling-vba", "title": "combobox text not on list error handling VBA", "body": "<p>I have a workbook with about 130 sheets in it, which I select from a combobox on the main page. I populate the combobox using rowsource, from a named range which has the sheet names in it. It works great if you select one of the sheet names from the list, and it closes nicely if you don't enter anything and still press submit. I want to cover the case where the user types in something not on the list. I want to say something to VBA like 'if sWs is not equal to something from the named range, then show a message box which says 'error'', or whatever. Here is my code below, with my notes:</p>\n\n<hr>\n\n<pre><code>'if submit button is pressed go to selected worksheet or close the userform:\n   Private Sub Submit_Click()\n   Dim sWs As String\n   'the string is the text from combobox, called 'Title', selected on front page:\n   sWs = Me.Title.Value\n      'if nothing is selected then close the userform:\n      If sWs = (\"\") Then\n      End\n      End If\n      'If an item is selected from the dropdown list then show that worksheet and close the userform:\n      Worksheets(sWs).Select\n      End\n      End Sub\n\n'If exit button is pressed close the userform:\n   Private Sub ExitButton_Click()\n   End \n   End Sub\n</code></pre>\n\n<hr>\n\n<p>I think I need to be using a Boolean, so I can specify what to do when it is false, but not sure how to write it. Sorry, I'm a bit of a noob. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472633126, "post_id": 39244674, "comment_id": 65825691, "body": "You can use SQL, look at the MAX function, not sure this will work with the R etc, but you could say &quot;select top 1 RiskID from tbl_Risks order by RiskID desc&quot; which may work"}, {"owner": {"reputation": 43, "user_id": 6744325, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/552f049809fd060724d03571a4cd2669?s=128&d=identicon&r=PG&f=1", "display_name": "Kashyap Kumar", "link": "https://stackoverflow.com/users/6744325/kashyap-kumar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472634149, "post_id": 39244674, "comment_id": 65826329, "body": "Hey Nathan Worked like magic. Thanks a lot"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472634812, "post_id": 39244674, "comment_id": 65826777, "body": "No probs, i&#39;ll add it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1472634799, "creation_date": 1472634799, "answer_id": 39245418, "question_id": 39244674, "link": "https://stackoverflow.com/questions/39244674/generating-a-risk-id-through-access-vba/39245418#39245418", "title": "Generating a Risk ID through Access VBA", "body": "<p>You can use SQL, look at the MAX function, not sure this will work with the R etc, but you could say <code>\"select top 1 RiskID from tbl_Risks order by RiskID desc\"</code> which may work </p>\n"}], "owner": {"reputation": 43, "user_id": 6744325, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/552f049809fd060724d03571a4cd2669?s=128&d=identicon&r=PG&f=1", "display_name": "Kashyap Kumar", "link": "https://stackoverflow.com/users/6744325/kashyap-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472634799, "creation_date": 1472632724, "question_id": 39244674, "link": "https://stackoverflow.com/questions/39244674/generating-a-risk-id-through-access-vba", "title": "Generating a Risk ID through Access VBA", "body": "<p>I have a table of Risks and Issues with an RiskIssue_ID column.</p>\n\n<p>Risk IDs should be like \"R0001\",\"R0002\" etc</p>\n\n<p>Issue IDs should be like \"I0001\",\"I0002\" etc</p>\n\n<p>Entries done via form. User specifies whether it's a Risk or Issue, that he wants to save.\nI can use that to create a string starting with 'R' or 'I'. But I also need to find the last used number for 'R' or 'I', so that I can set a new ID for the new entry.</p>\n\n<p>E.g. If user is saving a risk and 15 risks are already saved, Last Risk ID in the Table is 'R0015'. I need the new risk to be saved as 'R0016'</p>\n\n<p>Thank you in advance for all your illuminated assistance.</p>\n"}, {"tags": ["vba", "excel", "listbox", "userform"], "answers": [{"comments": [{"owner": {"reputation": 648, "user_id": 4049983, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nIZx9Y1bVes/AAAAAAAAAAI/AAAAAAAAAB8/Cn-3Si3KWuo/photo.jpg?sz=128", "display_name": "Yiao SUN", "link": "https://stackoverflow.com/users/4049983/yiao-sun"}, "edited": false, "score": 0, "creation_date": 1472632695, "post_id": 39244582, "comment_id": 65825360, "body": "Thanks for your reponse, I tested ,it can just get CAN20168301436 but can&#39;t get all information, this is a multi-colonne listbox"}, {"owner": {"reputation": 648, "user_id": 4049983, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nIZx9Y1bVes/AAAAAAAAAAI/AAAAAAAAAB8/Cn-3Si3KWuo/photo.jpg?sz=128", "display_name": "Yiao SUN", "link": "https://stackoverflow.com/users/4049983/yiao-sun"}, "edited": false, "score": 0, "creation_date": 1472633219, "post_id": 39244582, "comment_id": 65825756, "body": "It has 7 colonnes"}], "tags": [], "owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "is_accepted": false, "score": 5, "last_activity_date": 1472633401, "last_edit_date": 1472633401, "creation_date": 1472632432, "answer_id": 39244582, "question_id": 39244444, "link": "https://stackoverflow.com/questions/39244444/how-to-get-selected-value-in-multicolumn-listbox/39244582#39244582", "title": "How to get selected value in multicolumn listbox", "body": "<p>With a single column you can retrieve the value as below:</p>\n\n<pre><code>Dim str as String\nstr = me.ListBox1.Value\n</code></pre>\n\n<p>With a multicolumn you can retrieve the value like this:</p>\n\n<pre><code>Dim strCol1 as String\nDim strCol2 as String\nDim strCol3 as String\nstrCol1 = ListBox1.List(0, 1)\nstrCol2 = ListBox1.List(0, 2)\nstrCol3 = ListBox1.List(0, 3)\n</code></pre>\n\n<p>or you can add all the data into 1 String:</p>\n\n<pre><code>Dim strColumns as String\nstrColumns = ListBox1.List(0, 1) + \" \" + ListBox1.List(0, 2) + \" \" + ListBox1.List(0, 3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 17, "last_activity_date": 1472634366, "creation_date": 1472634366, "answer_id": 39245253, "question_id": 39244444, "link": "https://stackoverflow.com/questions/39244444/how-to-get-selected-value-in-multicolumn-listbox/39245253#39245253", "title": "How to get selected value in multicolumn listbox", "body": "<p>you can use this code</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n    Dim strng As String\n    Dim lCol As Long, lRow As Long\n\n    With Me.ListBox1 '&lt;--| refer to your listbox: change \"ListBox1\" with your actual listbox name\n        For lRow = 0 To .ListCount - 1 '&lt;--| loop through listbox rows\n            If .selected(lRow) Then '&lt;--| if current row selected\n                For lCol = 0 To .ColumnCount - 1 '&lt;--| loop through listbox columns\n                    strng = strng &amp; .List(lRow, lCol) &amp; \" | \" '&lt;--| build your output string\n                Next lCol\n                MsgBox \"you selected\" &amp; vbCrLf &amp; Left(strng, (Len(strng) - 1)) '&lt;--| show output string (after removing its last character (\"|\"))\n                Exit For '&lt;-_| exit loop\n            End If\n        Next lRow\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472636050, "post_id": 39245409, "comment_id": 65827682, "body": "have you tested that? In my Excel VBA up to 2013 a multi-column <code>ListBox</code> <code>ListIndex</code> property would return <code>0</code> if no items selected, as if the first item would be. That&#39;s why I iterate through rows and check <code>Selected</code> property. An alternative would be double check for a <code>0</code> <code>ListIndex</code> like <code>If .ListIndex = 0 and .Selected(0) or .ListIndex &gt;0 Then</code> but that would seem too unclear for a <i>second time around</i> code review"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 648, "user_id": 4049983, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nIZx9Y1bVes/AAAAAAAAAAI/AAAAAAAAAB8/Cn-3Si3KWuo/photo.jpg?sz=128", "display_name": "Yiao SUN", "link": "https://stackoverflow.com/users/4049983/yiao-sun"}, "edited": false, "score": 1, "creation_date": 1472636376, "post_id": 39245409, "comment_id": 65827923, "body": "@YiaoSun: as per my previous comment you may want to test this solution against a possible <i>no-selection</i> scenario"}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472638160, "post_id": 39245409, "comment_id": 65829176, "body": "@user3598756 No selection gives ListIndex = -1, that&#39;s why I test for <code>ListIndex &gt; -1</code>. (I use Excel 2010 where it works like a charm!)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1472638963, "post_id": 39245409, "comment_id": 65829749, "body": "try selecting and deselecting a row: the <code>.ListIndex</code> value remains as the last selected (and then deselected) row was still selected, while <code>.Selected(.ListIndex)</code> (correctly) returns <code>False</code>"}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472639694, "post_id": 39245409, "comment_id": 65830302, "body": "@user3598756 Btw, if the list is short maybe the cost of looping the whole list isn&#39;t that high, but since VBA is pretty slow anyway, any improvements you can make are welcome!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472640280, "post_id": 39245409, "comment_id": 65830709, "body": "I surely agree with you"}], "tags": [], "owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "is_accepted": false, "score": 11, "last_activity_date": 1472639432, "last_edit_date": 1472639432, "creation_date": 1472634778, "answer_id": 39245409, "question_id": 39244444, "link": "https://stackoverflow.com/questions/39244444/how-to-get-selected-value-in-multicolumn-listbox/39245409#39245409", "title": "How to get selected value in multicolumn listbox", "body": "<p>No need to loop the entire list - in order to get the selected item row you can use the <code>ListIndex</code> property. Then you can use the <code>List(Row, Column)</code> property to retreive the data, as in the examples by @DragonSamu and @user3598756:</p>\n\n<pre><code>'***** Verify that a row is selected first\nIf ListBoxResultatFind.ListIndex &gt; -1 And ListBoxResultatFind.Selected(ListBoxResultatFind.ListIndex) Then\n    '***** Use the data - in my example only columns 2 &amp; 3 are used\n    MsgBox ListBoxResultatFind.List(ListBoxResultatFind.ListIndex, 1) &amp; \":\" &amp; ListBoxResultatFind.List(ListBoxResultatFind.ListIndex, 2)\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8398357, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pA7pUeeBCEk/AAAAAAAAAAI/AAAAAAAAB6g/qUQelZ7jDxU/photo.jpg?sz=128", "display_name": "Mark Vincent Manansala", "link": "https://stackoverflow.com/users/8398357/mark-vincent-manansala"}, "is_accepted": false, "score": 0, "last_activity_date": 1502832031, "last_edit_date": 1502832031, "creation_date": 1502826942, "answer_id": 45700542, "question_id": 39244444, "link": "https://stackoverflow.com/questions/39244444/how-to-get-selected-value-in-multicolumn-listbox/45700542#45700542", "title": "How to get selected value in multicolumn listbox", "body": "<p>It's a 6column list box and the 3rd column would be the multiplier hence the \"(x)\". You may also rearrange the list to how you like it.</p>\n\n<pre><code>Private Function selList() As String\nDim i As Long\n\nFor i =LBound(lstListBox1.List) To UBound(lstListBox1.List)\n    If lstListBox1.Selected(i) Then\n        selList = selList &amp; lstListBox1.List(i) &amp; \" \" &amp; lstListBox1.List(i, 1) _\n        &amp; \"(x\" &amp; lstListBox1.List(i, 3) &amp; \")\" &amp; \" \" &amp; lstListBox1.List(i, 2) &amp; \" \" &amp; lstListBox1.List(i, 4) &amp; \", \"\n    End If\nNext i\n\nIf selList= \"\" Then\n    selList= \"\"\nElse\n    selList= Left(selList, Len(selList) - 2)\nEnd If\n\nMsgBox selList\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 648, "user_id": 4049983, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nIZx9Y1bVes/AAAAAAAAAAI/AAAAAAAAAB8/Cn-3Si3KWuo/photo.jpg?sz=128", "display_name": "Yiao SUN", "link": "https://stackoverflow.com/users/4049983/yiao-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56663, "favorite_count": 1, "accepted_answer_id": 39245253, "answer_count": 4, "score": 5, "last_activity_date": 1502832031, "creation_date": 1472632014, "last_edit_date": 1472638526, "question_id": 39244444, "link": "https://stackoverflow.com/questions/39244444/how-to-get-selected-value-in-multicolumn-listbox", "title": "How to get selected value in multicolumn listbox", "body": "<p>I have a multicolumn listbox in my userform and I would like to get all the values of the elements which are in the selected row in the listbox.<br><br>Here is my userform:<a href=\"https://i.stack.imgur.com/o4STx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o4STx.png\" alt=\"UserForm with ListBox\"></a> </p>\n\n<p><br>\nJust like in the photo, I want to select one line then I will click button <code>Associer</code> and I could get the information of this row. I can just get the first column which is <code>CAN20168301436</code> I want to get the information from the whole line.<br> How can I do it? <br/>Here is my button clicked event: <br></p>\n\n<pre><code>Private Sub CommandButton3_Click()\n   a = ListBoxResultatFind.Text\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1485423932, "post_id": 41870271, "comment_id": 70923299, "body": "I was always under the impression that there can only be one instance of Outlook open, so in <i>Outlook only</i> the <code>CreateObject</code> keyword will <code>GetObject</code> if Outlook is already open.  Saying that I can&#39;t find any documentation to support it - but when testing on my PC <code>CreateObject</code> returns a reference to an already existing instance (task manager shows only one instance running)."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1485427412, "post_id": 41870271, "comment_id": 70925149, "body": "@DarrenBartrup-Cook : Never really checked that but you might be right!"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1485422665, "creation_date": 1485422665, "answer_id": 41870271, "question_id": 39244324, "link": "https://stackoverflow.com/questions/39244324/excel-vba-get-email-subject-based-on-dates/41870271#41870271", "title": "Excel VBA: Get email subject based on dates", "body": "<p>This will look into every folders in Outlook and gather the information in <code>mInfo</code> to create a list in sheet <code>Report</code>.</p>\n\n<p>I've modified the structure so that it'll detect if Outlook is already open, add a column with the detected mood and improve performances! ;)</p>\n\n<pre><code>Sub GetMood()\nDim wS As Excel.Worksheet\nDim outlookApp As Outlook.Application\nDim olNs As Outlook.Namespace\nDim Fldr As Outlook.MAPIFolder\nDim olMail As Outlook.MailItem\n'Dim sir() As String\n'Dim iRow As Variant\n'Dim d As Date\n\nDim RgPaste As Excel.Range\nDim mSubj As String\nDim mInfo() As Variant\nDim nbInfos As Integer\nReDim mInfo(1 To 1, 1 To 3)\nnbInfos = UBound(mInfo, 2)\n\n'd = ThisWorkbook.Sheets(\"Main\").Cells(11, 7).Value\n\nSet wS = ThisWorkbook.Sheets(\"Report\")\nWith wS\n    .Cells(1, 1) = \"Sender\"\n    .Cells(1, 2) = \"Mood\"\n    .Cells(1, 3) = \"Date\"\n    Set RgPaste = .Cells(2, 1)\nEnd With 'wS\n\n\nSet outlookApp = GetObject(, \"Outlook.Application\")\nIf outlookApp Is Nothing Then Set outlookApp = CreateObject(\"Outlook.Application\")\n\nSet olNs = outlookApp.GetNamespace(\"MAPI\")\n\nFor Each Fldr In olNs.Folders\n    For Each olMail In Fldr.Items\n        With olMail\n            mSubj = .Subject\n            mInfo(1, 1) = .SenderName\n            mInfo(1, 2) = mSubj\n            mInfo(1, 3) = .ReceivedTime\n            '.Display\n        End With 'olMail\n\n        With RgPaste\n            If (InStr(1, mSubj, \"HAPPY\") &gt; 0) Then\n                .Resize(1, nbInfos).Value = mInfo\n                .Offset(0, nbInfos) = \"HAPPY\"\n                Set RgPaste = .Offset(1, 0)\n            ElseIf (InStr(1, mSubj, \"NEUTRAL\") &gt; 0) Then\n                .Resize(1, nbInfos).Value = mInfo\n                .Offset(0, nbInfos) = \"NEUTRAL\"\n                Set RgPaste = .Offset(1, 0)\n            ElseIf (InStr(1, mSubj, \"SAD\") &gt; 0) Then\n                .Resize(1, nbInfos).Value = mInfo\n                .Offset(0, nbInfos) = \"SAD\"\n                Set RgPaste = .Offset(1, 0)\n            End If\n        End With 'RgPaste\n    Next olMail\nNext Fldr\n\n'MsgBox \"Report Generated\", vbOKOnly\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2748, "favorite_count": 0, "accepted_answer_id": 41870271, "answer_count": 1, "score": 3, "last_activity_date": 1593700598, "creation_date": 1472631665, "last_edit_date": 1593700598, "question_id": 39244324, "link": "https://stackoverflow.com/questions/39244324/excel-vba-get-email-subject-based-on-dates", "title": "Excel VBA: Get email subject based on dates", "body": "<p>I have a macro that will get all emails that contains \"HAPPY\", \"NEUTRAL\" and \"SAD\" in the subject and copy it to a new sheet of the workbook. I want to add a functionality when a user can also define a date to only display mood based on the date defined. Could anyone help me out?</p>\n\n<p>Also, Code below read emails in the inbox. I need it to read all the folders in my email (e.g. Outbox and subfolders). Could you please also help me with this?</p>\n\n<pre><code>Sub GetMood()\n\nDim outlookApp\nDim olNs As Outlook.Namespace\nDim Fldr As Outlook.MAPIFolder\nDim olMail As Variant\nDim myTasks\nDim sir() As String\nDim ws As Worksheet\nDim iRow As Variant\nDim d As Date\n\nx = 2\nd = ThisWorkbook.Sheets(\"Main\").Cells(11, 7).Value\nSet outlookApp = CreateObject(\"Outlook.Application\")\n\nSet olNs = outlookApp.GetNamespace(\"MAPI\")\nSet Fldr = olNs.GetDefaultFolder(olFolderInbox)\nSet myTasks = Fldr.Items\n\n\nFor Each olMail In myTasks\n\nIf (InStr(1, olMail.Subject, \"HAPPY\") &gt; 0) Then\n\n    ThisWorkbook.Sheets(\"Report\").Cells(1, 1) = \"Sender\"\n    ThisWorkbook.Sheets(\"Report\").Cells(1, 2) = \"Mood\"\n    ThisWorkbook.Sheets(\"Report\").Cells(1, 3) = \"Date\"\n\n    ThisWorkbook.Sheets(\"Report\").Cells(x, 1) = olMail.SenderName\n    ThisWorkbook.Sheets(\"Report\").Cells(x, 2) = olMail.Subject\n    ThisWorkbook.Sheets(\"Report\").Cells(x, 3) = olMail.ReceivedTime\n\n    x = x + 1\n\nElseIf (InStr(1, olMail.Subject, \"NEUTRAL\") &gt; 0) Then\n\n    ThisWorkbook.Sheets(\"Report\").Cells(x, 1) = olMail.SenderName\n    ThisWorkbook.Sheets(\"Report\").Cells(x, 2) = olMail.Subject\n    ThisWorkbook.Sheets(\"Report\").Cells(x, 3) = olMail.ReceivedTime\n\n    x = x + 1\n\nElseIf (InStr(1, olMail.Subject, \"SAD\") &gt; 0) Then\n\n    ThisWorkbook.Sheets(\"Report\").Cells(x, 1) = olMail.SenderName\n    ThisWorkbook.Sheets(\"Report\").Cells(x, 2) = olMail.Subject\n    ThisWorkbook.Sheets(\"Report\").Cells(x, 3) = olMail.ReceivedTime\n\n    x = x + 1\n\n   'MsgBox \"Report Generated\", vbOKOnly\n   'Else\n\n\n  'olMail.Display\n\n  Exit For\nEnd If\n\nNext\n\nEnd Sub\n\nPrivate Sub Workbook_Open()\n Worksheets(\"StartSheet\").Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 3, "creation_date": 1472629497, "post_id": 39243589, "comment_id": 65823503, "body": "Mandatory: what have you tried so far?"}, {"owner": {"reputation": 17, "user_id": 6775210, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-10zyCGiOZFs/AAAAAAAAAAI/AAAAAAAAADY/5q-Y8NaaoFw/photo.jpg?sz=128", "display_name": "David ", "link": "https://stackoverflow.com/users/6775210/david"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472630149, "post_id": 39243589, "comment_id": 65823868, "body": "=IF(AND(E2=F2,G2=F2),F1,&quot;None&quot;)  I am going to assign columns, names in which to print to the fourth column to show the user is the wrong column. im thinking now do i require a number of IF statements to rule out whether one doesn&#39;t match or none match."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6775210, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-10zyCGiOZFs/AAAAAAAAAAI/AAAAAAAAADY/5q-Y8NaaoFw/photo.jpg?sz=128", "display_name": "David ", "link": "https://stackoverflow.com/users/6775210/david"}, "edited": false, "score": 0, "creation_date": 1472632074, "post_id": 39243826, "comment_id": 65825002, "body": "Ok so moving on from that if I wanted column &quot;e&quot; to display the the difference between the cells that match and the cells that dont match as a number."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": true, "score": 3, "last_activity_date": 1472630146, "creation_date": 1472630146, "answer_id": 39243826, "question_id": 39243589, "link": "https://stackoverflow.com/questions/39243589/excel-reconciliation/39243826#39243826", "title": "Excel Reconciliation", "body": "<p>Please try:  </p>\n\n<pre><code>=IF(AND(A2=B2,A2=C2),\"match\",IF(A2=B2,\"C\",IF(A2=C2,\"B\",IF(B2=C2,\"A\",\"none\"))))\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6775210, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-10zyCGiOZFs/AAAAAAAAAAI/AAAAAAAAADY/5q-Y8NaaoFw/photo.jpg?sz=128", "display_name": "David ", "link": "https://stackoverflow.com/users/6775210/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 39243826, "answer_count": 1, "score": 0, "last_activity_date": 1472630146, "creation_date": 1472629401, "question_id": 39243589, "link": "https://stackoverflow.com/questions/39243589/excel-reconciliation", "title": "Excel Reconciliation", "body": "<p>I am running a reconciliation that requires 3 columns to be equal so A=B,B=C instead of the forth column displaying True or False I would like to be able to show weather \"None\" match or display whichever column is not matching, either A, B or C?</p>\n\n<p>Thank you guys</p>\n"}, {"tags": ["macos", "vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1472631899, "post_id": 39243489, "comment_id": 65824890, "body": "Have you tried labelling the arguments?"}, {"owner": {"reputation": 143, "user_id": 6418052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b34c50ad50c686ba4ab1c05b299c51?s=128&d=identicon&r=PG&f=1", "display_name": "omannay", "link": "https://stackoverflow.com/users/6418052/omannay"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1472732240, "post_id": 39243489, "comment_id": 65877029, "body": "@Nathan_Sav A great idea. I&#39;ve tried it (see update above), but still no luck."}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 6418052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b34c50ad50c686ba4ab1c05b299c51?s=128&d=identicon&r=PG&f=1", "display_name": "omannay", "link": "https://stackoverflow.com/users/6418052/omannay"}, "is_accepted": true, "score": 1, "last_activity_date": 1472732845, "creation_date": 1472732845, "answer_id": 39271584, "question_id": 39243489, "link": "https://stackoverflow.com/questions/39243489/why-does-the-prompt-text-not-appear-for-my-inputbox-using-vba-in-excel-for-mac/39271584#39271584", "title": "Why does the prompt text not appear for my InputBox using VBA in Excel for Mac?", "body": "<p>I've found the answer, and am posting it here in the hope of helping somebody else who's having the same problem. When I was reading <a href=\"http://www.dummies.com/software/microsoft-office/excel/how-to-use-the-inputbox-function-in-excel-2016-vba/\" rel=\"nofollow\">this page</a> I found the following comment:</p>\n\n<blockquote>\n  <p>Microsoft seems to love confusion, so you also have access to the InputBox method, which is a method of the Application object.</p>\n</blockquote>\n\n<p>So it turns out that I was using Application.InputBox, when I should have been using simply InputBox.</p>\n\n<p>The following code works, i.e. it displays the prompt as well as the input box and title:</p>\n\n<pre><code>On Error Resume Next\n    assessmentName = InputBox( _\n                    Prompt:=\"Please enter a name for the new assessment:\", _\n                    Title:=\"Enter assessment name\")\n    If assessmentName = \"False\" Then\n        Exit Sub\n    End If\nErr.Clear\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8330012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6abaa3a90d2e8ab900c71678063659?s=128&d=identicon&r=PG", "display_name": "320up", "link": "https://stackoverflow.com/users/8330012/320up"}, "is_accepted": false, "score": 1, "last_activity_date": 1545140263, "creation_date": 1545140263, "answer_id": 53834287, "question_id": 39243489, "link": "https://stackoverflow.com/questions/39243489/why-does-the-prompt-text-not-appear-for-my-inputbox-using-vba-in-excel-for-mac/53834287#53834287", "title": "Why does the prompt text not appear for my InputBox using VBA in Excel for Mac?", "body": "<p>Same problem with Excel Mac Version 16.20 packed with VBA Version 7.1.</p>\n\n<p>Using <code>InputBox</code> alone does not work when using <code>Type:=</code></p>\n\n<p>Displays:</p>\n\n<pre><code>Compile error:\nNamed argument Type not found\n</code></pre>\n\n<p>Unfortunately <code>Type:=</code> only works with <code>Application.InputBox</code></p>\n\n<p>As a workaround you can see in the sample code below, I am using a combination of  <code>Title:=</code> and <code>Default:=</code> to \u201cPrompt\u201d what needs to be entered.</p>\n\n<p>Just another option until MS fixes this for Mac users.</p>\n\n<p>By the way, it\u2019s a handy little code snippet.</p>\n\n<pre><code>Sub ClearErrorsFromInputRange()\n    ' Clear all cells containing errors\n    Dim rRange As String\n    On Error Resume Next\n    rRange = Application.InputBox(Prompt:=\"Not Working On Mac\", _\n        Title:=\"Clear Errors From Range\", Default:=\"J2:J4000\", Type:=2)\n    With Range(rRange)\n        .SpecialCells(xlCellTypeConstants, xlErrors).Value2 = \"\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 6418052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b34c50ad50c686ba4ab1c05b299c51?s=128&d=identicon&r=PG&f=1", "display_name": "omannay", "link": "https://stackoverflow.com/users/6418052/omannay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1745, "favorite_count": 0, "accepted_answer_id": 39271584, "answer_count": 2, "score": 3, "last_activity_date": 1546014498, "creation_date": 1472629118, "last_edit_date": 1472732923, "question_id": 39243489, "link": "https://stackoverflow.com/questions/39243489/why-does-the-prompt-text-not-appear-for-my-inputbox-using-vba-in-excel-for-mac", "title": "Why does the prompt text not appear for my InputBox using VBA in Excel for Mac?", "body": "<p>I've been building a system that will keep track of student grades, using Excel. I've coded it under Windows, where everything works fine, but when I test it on the Mac version of Excel (the latest version, 15.24, I believe), the InputBoxes only show the title and the text box for the input data; the prompt text is not shown.\nHere is an example of the code that I use to handle the InputBoxes: </p>\n\n<pre><code>On Error Resume Next\n    assessmentName = Application.InputBox(\"Please enter a name for the new assessment:\", \"Enter assessment name\")\n    If assessmentName = \"False\" Then\n        Exit Sub\n    End If\nErr.Clear\n</code></pre>\n\n<p>In this case, all that is displayed is the title 'Enter assessment name' and the text box where the user types the name.\nIs there a difference in the way the Mac version of Excel deals with VBA code, that would cause this to happen? Are the problems a result of bad coding on my part, combined with the weaker VBA support that Excel seems to have on the Mac?</p>\n\n<p><strong>UPDATE:</strong> I've now labelled the arguments in the code like so:</p>\n\n<pre><code>On Error Resume Next\n    assessmentName = Application.InputBox( _\n                    Prompt:=\"Please enter a name for the new assessment:\", _\n                    Title:=\"Enter assessment name\")\n    If assessmentName = \"False\" Then\n        Exit Sub\n    End If\nErr.Clear\n</code></pre>\n\n<p>Unfortunately, the prompt is still missing when I run the macro on the Mac version of Excel.</p>\n\n<p><strong>SECOND UPDATE:</strong> I've found the solution and posted it in an answer below.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 0, "last_activity_date": 1472629317, "creation_date": 1472629317, "answer_id": 39243554, "question_id": 39243315, "link": "https://stackoverflow.com/questions/39243315/item-in-a-dictionary/39243554#39243554", "title": "Item in a dictionary", "body": "<p><code>Dictionary.Keys()</code> is not a property, it's a function and it does not accept parameters. It always returns all keys, and you need to pick the one you need <em>after</em> it returns:</p>\n\n<pre><code>MsgBox channel.Keys()(i) &amp; \" has \" &amp; channel(channel.Keys()(i)).Count &amp; \" keys.\"\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6727200, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh5.googleusercontent.com/-HBBgqaGwi38/AAAAAAAAAAI/AAAAAAAACJo/FtTx9rELgfM/photo.jpg?sz=128", "display_name": "Vaibhav Miglani", "link": "https://stackoverflow.com/users/6727200/vaibhav-miglani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 39243554, "answer_count": 1, "score": 0, "last_activity_date": 1472629317, "creation_date": 1472628512, "last_edit_date": 1472628844, "question_id": 39243315, "link": "https://stackoverflow.com/questions/39243315/item-in-a-dictionary", "title": "Item in a dictionary", "body": "<p>Following is the code to read the number of keys in every dictionary whose object acts as the item in the main dictionary (<code>channel</code>).</p>\n\n<pre><code>Dim facebook As Object, instagram As Object, twitter As Object, name As String, channel As Object, _\ntype_name As String, Key As Variant, values(5) As Integer, i As Integer, j As Integer\n\nSet facebook = CreateObject(\"Scripting.Dictionary\")\n\nFor i = 0 To 4\n    values(i) = Cells(i + 1, 1)\nNext i\n\nWith facebook\n    .Add \"brand\", values\n    .Add \"post\", 6\n    .Add \"likes\", 7\nEnd With\n\nSet instagram = CreateObject(\"Scripting.Dictionary\")\n\nWith instagram\n    .Add \"brand\", 8\n    .Add \"post\", 9\n    .Add \"likes\", 10\nEnd With\n\nSet twitter = CreateObject(\"Scripting.Dictionary\")\n\nWith twitter\n    .Add \"brand\", 11\n    .Add \"post\", 12\n    .Add \"likes\", 13\nEnd With\n\nSet channel = CreateObject(\"Scripting.Dictionary\")\n\nWith channel\n    .Add \"facebook\", facebook\n    .Add \"twitter\", twitter\n    .Add \"instagram\", instagram\nEnd With\n\nFor i = 0 To channel.count - 1\n    MsgBox channel.Keys(i) &amp; \" has \" &amp; channel(channel.Keys(i)).count &amp; \" keys.\"\nNext i\n</code></pre>\n\n<p>Error which is occurring is shown in the given image file: </p>\n\n<p><img src=\"https://i.stack.imgur.com/jMMTg.png\" alt=\"Error\"></p>\n\n<p>If I replace <code>MsgBox channel.Keys(i) &amp; \" has \" &amp; channel(channel.Keys(i)).count &amp; \" keys.\"</code> with <code>MsgBox channel.Keys(i) &amp; \" has \" &amp; channel.Items(i).count &amp; \" keys.\"</code>, then also it is giving the same error.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1472625626, "creation_date": 1472625626, "answer_id": 39242422, "question_id": 39242190, "link": "https://stackoverflow.com/questions/39242190/using-cell-values-as-a-date-range-autofilter/39242422#39242422", "title": "Using cell values as a date range autofilter", "body": "<p>You are assigning your second range to <code>fechaFin</code>, but later you only use <code>fF</code>, so try assigning your range like this: <code>Set fF = Worksheets(\"Control\").Range(\"B27\")</code></p>\n\n<p>Because right now <code>fF.Value</code> is an empty string, which will probably reset the filter</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1472626107, "post_id": 39242452, "comment_id": 65821510, "body": "You&#39;re right about using between dates, however, I think that you need to escape the <code>&lt;</code> (e.g. <code>format(Now, &quot;\\&lt;=d&#47;m&#47;yyyy&quot;)</code>) .   When I tested <code>format(Now, &quot;&lt;=d&#47;m&#47;yyyy&quot;)</code> in the immediate window it returned <code>=d&#47;m&#47;yyyy8&#47;31&#47;2016 1:48:12 am</code>"}, {"owner": {"reputation": 458, "user_id": 4297055, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SU5oe.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4297055/pablo"}, "edited": false, "score": 0, "creation_date": 1472626364, "post_id": 39242452, "comment_id": 65821655, "body": "This throws an error, method autofilter off class Range."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1472626419, "post_id": 39242452, "comment_id": 65821694, "body": "@ThomasInzina - Thanks for catching that; I ended up escaping tboth teh operator and the equals."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472626581, "post_id": 39242452, "comment_id": 65821796, "body": "The equals tested okay but it doesn&#39;t hurt to escape it.  Just returning the favor."}, {"owner": {"reputation": 458, "user_id": 4297055, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SU5oe.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4297055/pablo"}, "edited": false, "score": 0, "creation_date": 1472626607, "post_id": 39242452, "comment_id": 65821812, "body": "@Jeeped the second solution is doing the same my code was doing before, leave the filter clear/empty."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1472627131, "post_id": 39242452, "comment_id": 65822125, "body": "I&#39;ve performed full testing and made two minor adjustments. It works on my system no matter whether I am set to DMY or MDY."}, {"owner": {"reputation": 458, "user_id": 4297055, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SU5oe.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4297055/pablo"}, "edited": false, "score": 0, "creation_date": 1472627827, "post_id": 39242452, "comment_id": 65822549, "body": "I&#39;ve checked the dates and they are not the problem, I have no idea what is failing..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1472626928, "last_edit_date": 1472626928, "creation_date": 1472625723, "answer_id": 39242452, "question_id": 39242190, "link": "https://stackoverflow.com/questions/39242190/using-cell-values-as-a-date-range-autofilter/39242452#39242452", "title": "Using cell values as a date range autofilter", "body": "<p>I've noticed that you are in a DMY date format. I will try to keep to that regional standard.</p>\n\n<p>Use an array with data types as Criteria2.</p>\n\n<pre><code>With ActiveSheet\n    With .ListObjects(\"TABLE_REPORTS_GENERAL_INFO\")\n        .Range.AutoFilter Field:=13, Operator:=xlFilterValues, _\n            Criteria2:=Array(2, Format(fi.Value, \"d/m/yyyy\"), 2, Format(ff.Value, \"d/m/yyyy\"))\n    End With\nEnd With\n</code></pre>\n\n<p>That should filter for the two dates. However, if you want all the dates between a start date and an end date then you need to introduce operators.</p>\n\n<pre><code>With ActiveSheet\n    With .ListObjects(\"TABLE_REPORTS_GENERAL_INFO\")\n        .Range.AutoFilter Field:=13, _\n            Criteria1:=Format(fi.Value, \"\\&gt;\\=d/m/yyyy\"), Operator:=xlAnd, _\n            Criteria2:=Format(ff.Value, \"\\&lt;\\=d/m/yyyy\")\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 4297055, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/SU5oe.jpg?s=128&g=1", "display_name": "Pablo", "link": "https://stackoverflow.com/users/4297055/pablo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472626928, "creation_date": 1472624780, "last_edit_date": 1472625746, "question_id": 39242190, "link": "https://stackoverflow.com/questions/39242190/using-cell-values-as-a-date-range-autofilter", "title": "Using cell values as a date range autofilter", "body": "<p>I'm trying to adjust my date autofilter with a range extracted from 2 cells. </p>\n\n<p>After some failed tries, I decided to do the macro with the macro builder so I could tweak it to adust to my code, and I ended up with:</p>\n\n<pre><code>Dim fI As Range\nDim fF As Range\n\nSet fI = Worksheets(\"Sheet1\").Range(\"B26\")\n\nSet fF = Worksheets(\"Control\").Range(\"B27\")\n\n\n    ActiveSheet.ListObjects(\"TABLE_REPORTS_GENERAL_INFO\").Range _\n        .AutoFilter Field:=24, Criteria1:=fI.Value, Operator:=xlAnd, _\n        Criteria2:=fF.Value\n</code></pre>\n\n<p>The dates are in the correct format, but it will just let the filter clean. Hardcoding the dates is working, what am I doing wrong?</p>\n\n<p>My dates structure:</p>\n\n<pre><code>Starting Date   01/08/2015\nLast Date   31/07/2016\n</code></pre>\n"}, {"tags": ["vba", "textbox", "ms-word"], "comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1472629055, "post_id": 39242180, "comment_id": 65823266, "body": "You can use <code>Selection.StoryType</code> to check if the selection is inside a TextFrame. <code>Selection.Shaperange(1)</code> to get the textbox. Moving the cursor outside of the textbox is tricky if it isn&#39;t an inline shape. (using the anchor is the only way I can think of right now)"}, {"owner": {"reputation": 31, "user_id": 5771231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e058731d3f7b6cd8e477f0f150dc5e?s=128&d=identicon&r=PG&f=1", "display_name": "ThisPaul", "link": "https://stackoverflow.com/users/5771231/thispaul"}, "reply_to_user": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 0, "creation_date": 1472672301, "post_id": 39242180, "comment_id": 65851389, "body": "Selection.StoryType does the trick. Thank you very much."}], "answers": [{"comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1473843069, "post_id": 39254511, "comment_id": 66290601, "body": "The question is about a textbox in a Microsoft Word document, not about a Windows Forms textbox so your code sample does not apply here."}], "tags": [], "owner": {"reputation": 24, "user_id": 4298715, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wPCap2TWihw/AAAAAAAAAAI/AAAAAAAAAkY/4NsI_vO_pl4/photo.jpg?sz=128", "display_name": "Rick St Jean", "link": "https://stackoverflow.com/users/4298715/rick-st-jean"}, "is_accepted": false, "score": -1, "last_activity_date": 1472660313, "creation_date": 1472660313, "answer_id": 39254511, "question_id": 39242180, "link": "https://stackoverflow.com/questions/39242180/how-to-determine-if-the-selection-is-inside-a-textbox-or-not/39254511#39254511", "title": "how to determine if the selection is inside a textbox or not", "body": "<p>You will need to get the code from here for getting/setting mouse position:\n<a href=\"https://support.microsoft.com/en-us/kb/152969\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/152969</a></p>\n\n<p>Then write the following</p>\n\n<pre><code>Private Sub TextBox1_MouseMove(ByVal intButton As Integer, ByVal intShift As Integer, ByVal sngWidth As Single, ByVal sngHeight As Single) \n\n    If (sngWidth &lt; 5 Or sngWidth &gt; TextBox1.Width - 5) Or (sngHeight &lt; 5 Or sngHeight &gt; TextBox1.Height - 5) Then \n        SetCursorPos x, y\n    End If \nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "is_accepted": false, "score": 3, "last_activity_date": 1473843497, "creation_date": 1473843497, "answer_id": 39486387, "question_id": 39242180, "link": "https://stackoverflow.com/questions/39242180/how-to-determine-if-the-selection-is-inside-a-textbox-or-not/39486387#39486387", "title": "how to determine if the selection is inside a textbox or not", "body": "<p>You can determine whether your selection is inside a textbox by checking the <code>StoryType</code> property of the selected range:</p>\n\n<pre><code>Set Shp = ActiveDocument.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, _\n                Left:=0, Top:=0, Width:=100, Height:=100)\n\nIf Selection.StoryType = WdStoryType.wdTextFrameStory Then\n\n    ' select the paragraph the shape is anchored to\n    Shp.Anchor.Select\n\n    ' collapse to the beginning of the paragraph\n    Selection.Collapse\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5771231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0e058731d3f7b6cd8e477f0f150dc5e?s=128&d=identicon&r=PG&f=1", "display_name": "ThisPaul", "link": "https://stackoverflow.com/users/5771231/thispaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1473843497, "creation_date": 1472624742, "last_edit_date": 1472630684, "question_id": 39242180, "link": "https://stackoverflow.com/questions/39242180/how-to-determine-if-the-selection-is-inside-a-textbox-or-not", "title": "how to determine if the selection is inside a textbox or not", "body": "<p>A few textbox are created by repeating</p>\n\n<pre><code>Set Shp = ActiveDocument.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, \n          Left:=0, Top:=0, Width:=100, Height:=100)\n</code></pre>\n\n<p>how to determine if the current cursor (or selection) is inside one of the textbox or not? I want to move the cursor out of the textbox if it is in, and do not move the cursor if it is not in.</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": false, "score": 0, "last_activity_date": 1472631146, "last_edit_date": 1472631146, "creation_date": 1472629035, "answer_id": 39243466, "question_id": 39242161, "link": "https://stackoverflow.com/questions/39242161/vba-open-ie-as-invisible-is-not-working/39243466#39243466", "title": "VBA open IE as invisible is not working", "body": "<p>A new IE-instance is created by in every iteration of your loop.\nSet <code>ie.visible = True</code> for testing or open a Windows Task Manager, and you see what i mean.</p>\n\n<p>So, quite simply, create the IE-object <strong>once</strong> before entering the loop. After finishing the loop, quit it before setting <code>ie = Nothing</code>.</p>\n\n<pre><code>Set ie = CreateObject(\"InternetExplorer.Application\")\n\nFor k= 2 to lr\n    ie.navigate Sheets(\"sheet1\").Range(\"E\" &amp; k).Value\n    ....\nNext k\n\nie.quit\nSet ie = nothing\n</code></pre>\n\n<p>Should your experience problems with your IE-object getting dropped (for whatever reason), then, by any means, you can still wrap something like </p>\n\n<pre><code>If ie = Nothing Then Set ie = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n\n<p>inside the loop.</p>\n\n<p>Hint: instead of <code>Application.Wait (Now() + TimeValue(\"00:00:03\"))</code> I used something like <code>While ie.busy = True</code> in Powershell - not sure if that applies in VBA too.</p>\n\n<p>EDIT: <code>Do While ie.ReadyState &lt;&gt; 4 : Loop</code></p>\n"}], "owner": {"reputation": 27, "user_id": 5672718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-fi4Hnqcyi9E/AAAAAAAAAAI/AAAAAAAAAB0/hFo8JZLIb8w/photo.jpg?sz=128", "display_name": "Srinivas Mantri", "link": "https://stackoverflow.com/users/5672718/srinivas-mantri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 983, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1472631146, "creation_date": 1472624689, "last_edit_date": 1531164843, "question_id": 39242161, "link": "https://stackoverflow.com/questions/39242161/vba-open-ie-as-invisible-is-not-working", "title": "VBA open IE as invisible is not working", "body": "<p>I am trying to open IE in background as below, but after 2 or 3 pages navigation it is taking more time to navigate and it moving in the loop</p>\n\n<pre><code>For k= 2 to lr\ncheck_w:\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.navigate Sheets(\"sheet1\").Range(\"E\" &amp; k).Value\nie.Visible = False\nApplication.Wait (Now() + TimeValue(\"00:00:03\"))\ncheck_webpage:\nSet BDoc = Nothing\nWeb_app_Title = Sheets(\"sheet1\").Range(\"E\" &amp; k).Value\nsearch_WEB_APP_URL\nIf BDoc Is Nothing Then\n    If ie Is Nothing Then\n         Application.Wait (Now() + TimeValue(\"00:00:03\"))\n         GoTo check_w\n    Else\n        GoTo check_webpage\n   End If\nEnd If\nnext k\n</code></pre>\n"}, {"tags": ["excel", "vba", "count", "duplicates"], "comments": [{"owner": {"reputation": 564, "user_id": 1445733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c29da764b3b70f89fb2ba151494c4b?s=128&d=identicon&r=PG", "display_name": "Michael Whinfrey", "link": "https://stackoverflow.com/users/1445733/michael-whinfrey"}, "edited": false, "score": 0, "creation_date": 1472624477, "post_id": 39241997, "comment_id": 65820690, "body": "you can definitely acheive this in VBA (i.e the language running in the background of ms office) you can write VBA functions directly into your excel documents, you don&#39;t need visual basic. ALthough you will have to enable developer toolbar. see <a href=\"https://www.techonthenet.com/excel/macros/visual_basic_editor2013.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/macros/visual_basic_editor2013.php</a>"}, {"owner": {"reputation": 59, "user_id": 5688937, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/708adbb12e5715006aaf894b45067772?s=128&d=identicon&r=PG&f=1", "display_name": "monkeyman", "link": "https://stackoverflow.com/users/5688937/monkeyman"}, "reply_to_user": {"reputation": 564, "user_id": 1445733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c29da764b3b70f89fb2ba151494c4b?s=128&d=identicon&r=PG", "display_name": "Michael Whinfrey", "link": "https://stackoverflow.com/users/1445733/michael-whinfrey"}, "edited": false, "score": 0, "creation_date": 1472624838, "post_id": 39241997, "comment_id": 65820848, "body": "I expected this might be the response. Unfortunately I have no VBA experience so, whilst I am willing to learn VBA if necessary, I was hoping there&#39;d be an easier solution. Thanks for your response though @MichaelWhinfrey!"}, {"owner": {"reputation": 564, "user_id": 1445733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c29da764b3b70f89fb2ba151494c4b?s=128&d=identicon&r=PG", "display_name": "Michael Whinfrey", "link": "https://stackoverflow.com/users/1445733/michael-whinfrey"}, "edited": false, "score": 0, "creation_date": 1472625130, "post_id": 39241997, "comment_id": 65820977, "body": "if you have any programming experience at all, VBA won&#39;t be a challenge. I only pick it up once a year to do something similar to this across mutiple spreadsheets. Always feels like I&#39;m relearning it but after a few hours it&#39;s all over =) GL"}], "answers": [{"comments": [{"owner": {"reputation": 694, "user_id": 3601237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0I5Sq.jpg?s=128&g=1", "display_name": "eshwar", "link": "https://stackoverflow.com/users/3601237/eshwar"}, "edited": false, "score": 2, "creation_date": 1472633693, "post_id": 39242448, "comment_id": 65826071, "body": "You can actually copy Col B to column C to get the count of counts. Filter out the nulls in Col B to display only relevant rows."}, {"owner": {"reputation": 694, "user_id": 3601237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0I5Sq.jpg?s=128&g=1", "display_name": "eshwar", "link": "https://stackoverflow.com/users/3601237/eshwar"}, "edited": false, "score": 2, "creation_date": 1472635241, "post_id": 39242448, "comment_id": 65827030, "body": "Copying formulas from B to C results in C having the count of counts. Then use autofilter to hide null rows."}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 2, "last_activity_date": 1472625706, "creation_date": 1472625706, "answer_id": 39242448, "question_id": 39241997, "link": "https://stackoverflow.com/questions/39241997/count-specific-number-of-duplicates-in-excel/39242448#39242448", "title": "Count specific number of duplicates in excel", "body": "<p>This might work without VBA. Assuming <code>Data</code> is in A1, enter <code>Count</code> in B1 and in B2:  </p>\n\n<pre><code>=IF(COUNTIF(A$1:A2,A2)=1,COUNTIF(A:A,A2),\"null\")  \n</code></pre>\n\n<p>copied down to suit. Then insert a PivotTable with Count for ROWS and Count of Count for VALUES.  </p>\n\n<p>Result should look so:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/kg14R.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kg14R.jpg\" alt=\"SO39241997 example\"></a>  </p>\n\n<p>The <code>null</code>s should be ignored and a zero count for 2 duplicates has to be inferred. The order can be adjusted to suit.</p>\n"}], "owner": {"reputation": 59, "user_id": 5688937, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/708adbb12e5715006aaf894b45067772?s=128&d=identicon&r=PG&f=1", "display_name": "monkeyman", "link": "https://stackoverflow.com/users/5688937/monkeyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1472625706, "creation_date": 1472624030, "last_edit_date": 1472625088, "question_id": 39241997, "link": "https://stackoverflow.com/questions/39241997/count-specific-number-of-duplicates-in-excel", "title": "Count specific number of duplicates in excel", "body": "<p>I am working in Microsoft Excel 2013 (Windows OS). </p>\n\n<p>I have a column of data as below:</p>\n\n<pre><code>Data\nA\nB\nA\nC\nB\nA\nA\nB\nD\n</code></pre>\n\n<p>As we can see, only A appears 4 times, only B appears 3 times whilst C and D appear 1 time each. </p>\n\n<p>I need a formula/method to count how many times a number of number of duplicates appears and display it in a table like below:</p>\n\n<pre><code>Duplicates | Number of values duplicated this many times\n     4     |        1\n     3     |        1\n     2     |        0\n     1     |        2\n</code></pre>\n\n<p>Does anyone have a way of doing this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1472627566, "creation_date": 1472627566, "answer_id": 39243010, "question_id": 39241858, "link": "https://stackoverflow.com/questions/39241858/vba-calling-function-from-within-userform-causes-strange-errors/39243010#39243010", "title": "VBA - Calling function from within userform causes strange errors", "body": "<p>You can use <code>Selection.ShapeRange.Name</code> to get the name of the selected shape. You'll need to trap the <code>Error 5 'Invalid procedure call or argument</code> that will be thrown if the Selection.ShapeRange doesn't have a name property.</p>\n\n<pre>\n\n    Dim ShapeName As String\n\n    On Error Resume Next\n    ShapeName = Selection.ShapeRange.Name\n    On Error GoTo 0\n    If InStr(ShapeName, \"Text Box\") Then\n        'Do Something\n    End If\n\n</pre>\n"}], "owner": {"reputation": 1, "user_id": 6777236, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153830514632543/picture?type=large", "display_name": "Max Sydney", "link": "https://stackoverflow.com/users/6777236/max-sydney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472627566, "creation_date": 1472623460, "question_id": 39241858, "link": "https://stackoverflow.com/questions/39241858/vba-calling-function-from-within-userform-causes-strange-errors", "title": "VBA - Calling function from within userform causes strange errors", "body": "<p>I am encountering a strange error in Excel when executing a subroutine from a button within a userform. </p>\n\n<p>The purpose of the form is to insert a new product into a long list of products and their details. The subroutine being called selects a range within the product list and calls the insert method on the range. </p>\n\n<p>Once this subroutine has executed Excel begins behaving very strangely. If I select a cell and enter come characters then press enter the cell doesn't update. No modifications can be made to the product list sheet, and I cannot even exit Excel by clocking the X in the top right of the window. Sometimes when this happens, rows in other sheets get shifted. </p>\n\n<p>The only way for Excel to become responsive again is to navigate to another sheet and modify a cell, which seems to set everything straight.</p>\n\n<p>When I run the same subroutine from a button on the sheet, or from the macros menu the problem doesn't occur. </p>\n\n<p>Any suggestions as to what might be going on here? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1472628245, "post_id": 39241721, "comment_id": 65822805, "body": "What does &quot;didn&#39;t work&quot; mean? Error message? Nothing happened? The numbers turned pink? Nuclear holocaust?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1472628375, "post_id": 39241721, "comment_id": 65822881, "body": "Also, you need to read (how to create minimal, complete and verifiable example)[<a href=\"http://stackoverflow.com/help/mcve]\">stackoverflow.com/help/mcve]</a>. YOu can&#39;t expect us to dig through all your code to find the error. Please just show the part with the error."}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 5295430, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9a45bc38bcb51fc2dd7efeda4aa41363?s=128&d=identicon&r=PG&f=1", "display_name": "fanarek", "link": "https://stackoverflow.com/users/5295430/fanarek"}, "edited": false, "score": 0, "creation_date": 1472624945, "post_id": 39242130, "comment_id": 65820894, "body": "It converts entire row into &quot;00:00&quot;"}], "tags": [], "owner": {"reputation": 11, "user_id": 6729464, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J7gOGWdCBec/AAAAAAAAAAI/AAAAAAAAAQw/wTD7tm5NXsI/photo.jpg?sz=128", "display_name": "Sabey", "link": "https://stackoverflow.com/users/6729464/sabey"}, "is_accepted": false, "score": 0, "last_activity_date": 1472624549, "creation_date": 1472624549, "answer_id": 39242130, "question_id": 39241721, "link": "https://stackoverflow.com/questions/39241721/cant-convert-excel-cell-to-hhmm/39242130#39242130", "title": "Can&#39;t convert excel cell to &quot;hh:mm&quot;", "body": "<p>give conditions here....\nand then give,\nWorksheets(2).Cells(i,j)  =  Format(THE_DATE_VARIABLE, \"hh:mm\")</p>\n\n<p>Try this.</p>\n"}], "owner": {"reputation": 367, "user_id": 5295430, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9a45bc38bcb51fc2dd7efeda4aa41363?s=128&d=identicon&r=PG&f=1", "display_name": "fanarek", "link": "https://stackoverflow.com/users/5295430/fanarek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1472624549, "creation_date": 1472622828, "last_edit_date": 1472623040, "question_id": 39241721, "link": "https://stackoverflow.com/questions/39241721/cant-convert-excel-cell-to-hhmm", "title": "Can&#39;t convert excel cell to &quot;hh:mm&quot;", "body": "<p>I have problem with converting cell value to <code>hh:mm</code> format.</p>\n\n<p>Here is my code: </p>\n\n<pre><code>lastRow = ActiveSheet.Cells(Rows.Count, \"D\").End(xlUp).Row\nlastColumn = ActiveSheet.UsedRange.Column - 1 + ActiveSheet.UsedRange.Columns.Count\n\nsql = \"INSERT INTO temp (colId,rowId,kodp,data) \"\nplansql = \"INSERT INTO tempPlan (colId,rowId,kodp,data) \"\nsql3 = \"DELETE From temp\"\nsql4 = \"DELETE From tempPlan\"\nconn.Execute sql3\nconn.Execute sql4\nFor i = 13 To lastRow\n    kodp = Worksheets(2).Cells(i, 1)\n    For j = 6 To lastColumn\n        data = Worksheets(2).Cells(11, j)\n        sql = sql &amp; \"SELECT \" &amp; j &amp; \",\" &amp; i &amp; \",\" &amp; kodp &amp; \",'\" &amp; data &amp; \"' UNION ALL \"\n    Next\n    i = i + 10\nNext\nFor i = 12 To lastRow\n    kodp = Worksheets(2).Cells(i, 1)\n    For j = 6 To lastColumn\n        data = Worksheets(2).Cells(11, j)\n        plansql = plansql &amp; \"SELECT \" &amp; j &amp; \",\" &amp; i &amp; \",\" &amp; kodp &amp; \",'\" &amp; data &amp; \"' UNION ALL \"\n        'sql = sql &amp; \"SELECT \" &amp; j &amp; \",\" &amp; i &amp; \",\" &amp; kodp &amp; \",'\" &amp; data &amp; \"' UNION ALL \"\n    Next\n    i = i + 10\nNext\nsql = Left(sql, Len(sql) - 10)\nplansql = Left(plansql, Len(plansql) - 10)\nconn.Execute sql\nconn.Execute plansql\nsql2 = \"SELECT t.rowId,t.ColID,Realization From FRM_Raport f INNER JOIN temp t ON f.EmployeeId=t.kodp and f.data=t.data\"\nsql5 = \"SELECT t.rowId,t.colId,[Plan] From FRM_Raport f INNER JOIN tempPlan t ON f.Employeeid=t.kodp and f.data=t.data\"\nSet tmp = conn.Execute(sql2)\n\nDo Until tmp.EOF\n    For Each fld In tmp.Fields\n        Worksheets(2).Cells(tmp.Fields(0), tmp.Fields(1)) = tmp.Fields(2)\n    Next fld\n    tmp.MoveNext\nLoop\n\ntmp.Close\nSet tmp = Nothing\n\nSet planRecordset = conn.Execute(sql5)\n\n\n\nDo Until planRecordset.EOF\n    For Each fld In planRecordset.Fields\n        Worksheets(2).Cells(planRecordset.Fields(0), planRecordset.Fields(1)) = planRecordset.Fields(2)\n    Next fld\n    planRecordset.MoveNext\nLoop\n\nplanRecordset.Close\nSet planRecordset = Nothing\n</code></pre>\n\n<p>I need to convert Worksheets(2).Cells(i,j) (i=12 to lastRow,j=6 to lastColumn and i=13 to lastRow,j=6 to lastColumn) value into \"hh:mm\" format. I've tried to read datatype and it's Range or Empty. I also tried convert those cells into int first and it didn't work too. Any ideas ?</p>\n"}, {"tags": ["vba", "excel", "excel-udf"], "answers": [{"tags": [], "owner": {"reputation": 441, "user_id": 4522434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0ee16196ead21501b7e79bada556a62a?s=128&d=identicon&r=PG&f=1", "display_name": "Jing He", "link": "https://stackoverflow.com/users/4522434/jing-he"}, "is_accepted": false, "score": 2, "last_activity_date": 1472622515, "creation_date": 1472622515, "answer_id": 39241656, "question_id": 39241655, "link": "https://stackoverflow.com/questions/39241655/excel-user-defined-function-cant-find-project-or-library-without-any-missing/39241656#39241656", "title": "EXCEL User Defined Function - Can&#39;t find project or library without any MISSING reference", "body": "<p>This problem is very likely caused by the different versions of Microsoft Office Object Library. </p>\n\n<p>You can try to export the VBA code and remove the VBA module in your xlsm file, and then reinsert the VBA code back in users' computers. Usually the problem will be solved. </p>\n\n<p>The reason why this problem occurs is that Excel actually DOES save the compiled code of VBA, though we never see any compiled codes or compiled packages. When other users open your Macros Enabled file, Excel will automatically run the compiled machine code instead of the readable source code. Due to different interfaces (I guess it is called interface?) for different libraries in machine codes, Excel cannot find the library and error occurs.</p>\n\n<p>So you can also try to decompile your VBA code before you distribute your XLSM files. Visit this page to download the tool for decompiling your XLSM file:\n<a href=\"http://orlando.mvps.org/VBADecompilerMore.asp\" rel=\"nofollow\">VBA Decompiler</a></p>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 1958216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/968a99cfbfdbeaf9569438f6d21aa29f?s=128&d=identicon&r=PG", "display_name": "Paul G.", "link": "https://stackoverflow.com/users/1958216/paul-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1472626973, "last_edit_date": 1495541697, "creation_date": 1472626973, "answer_id": 39242831, "question_id": 39241655, "link": "https://stackoverflow.com/questions/39241655/excel-user-defined-function-cant-find-project-or-library-without-any-missing/39242831#39242831", "title": "EXCEL User Defined Function - Can&#39;t find project or library without any MISSING reference", "body": "<p>This likely happens when you use early-binding somewhere in your code (I don't see this happening in the codepart on the screenshot). </p>\n\n<p>A workaround would be to change your code to use late-binding. Please have a look at the answer of Siddharth Rout in \n<a href=\"https://stackoverflow.com/questions/9491314/preventing-excel-vba-compile-errors-due-to-users-having-an-older-version-of-ms-o\">Preventing Excel VBA compile errors due to users having an older version of MS Office (MS Outlook) installed?</a> for more information.</p>\n"}], "owner": {"reputation": 441, "user_id": 4522434, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0ee16196ead21501b7e79bada556a62a?s=128&d=identicon&r=PG&f=1", "display_name": "Jing He", "link": "https://stackoverflow.com/users/4522434/jing-he"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2451, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1472628198, "creation_date": 1472622515, "last_edit_date": 1472628198, "question_id": 39241655, "link": "https://stackoverflow.com/questions/39241655/excel-user-defined-function-cant-find-project-or-library-without-any-missing", "title": "EXCEL User Defined Function - Can&#39;t find project or library without any MISSING reference", "body": "<p>I developed a user defined function in my computer and save the document as XLSM. When I distributed it to other users in my company, they get \"Can't find project or library\" error as long as they open the workbook and then hit \"Enable Macros\".</p>\n\n<p>If they hit <code>Debug</code>, the yellow line will fall on the head line of the user defined function, like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/8tREK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8tREK.png\" alt=\"Error on the first line\"></a></p>\n\n<p>Then I checked the Tools - Reference of VBE, but find nothing missing in all computers (mine and other users').</p>\n\n<p>But the Reference is a little bit difference,</p>\n\n<p>In my computer, it is</p>\n\n<p><a href=\"https://i.stack.imgur.com/qGUUD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qGUUD.png\" alt=\"Reference in Developer&#39;s Computer\"></a></p>\n\n<p>In other users' computer, it is</p>\n\n<p><a href=\"https://i.stack.imgur.com/CZ1lo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CZ1lo.png\" alt=\"Reference in other user\"></a></p>\n\n<p>The only difference is the highlighted line. In my computer it is Microsoft office <strong>16.0</strong> Object Library, since I installed Project 2016 with Excel 2013. While others' are <strong>15.0</strong>.</p>\n\n<p>By the way, I get the above picture before I hit the \"Enable Macro\" button since once I hit it, the error message will show for infinite times and I will never be able to go into the Reference in VBE. Therefore it is possible that there will be a MISSING reference when the code is actually running.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1472622578, "post_id": 39241639, "comment_id": 65819835, "body": "What do you mean by the textbox does not active upon checking it? Do you want to set the focus to the textbox?"}, {"owner": {"reputation": 51, "user_id": 6343673, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-3_VrAqW-G_A/AAAAAAAAAAI/AAAAAAAABU4/AGw86wHotkE/photo.jpg?sz=128", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/6343673/coding-enthusiast"}, "reply_to_user": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1472623183, "post_id": 39241639, "comment_id": 65820070, "body": "<code>Label54.enable = True TextBox46.enable = True</code> is initially set to enable false. Then I implemented the logic with checkbox to activate the label and the texbox upon the checking the box, but it does not do anything. I did not set the focus on anything. I do not want the focus to set on anything."}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1472625443, "post_id": 39241639, "comment_id": 65821122, "body": "Alright, the proper setting is <code>TextBox46.Enabled = True</code> instead of <code>TextBox46.Enable = True</code>"}, {"owner": {"reputation": 51, "user_id": 6343673, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-3_VrAqW-G_A/AAAAAAAAAAI/AAAAAAAABU4/AGw86wHotkE/photo.jpg?sz=128", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/6343673/coding-enthusiast"}, "reply_to_user": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "edited": false, "score": 0, "creation_date": 1472626609, "post_id": 39241639, "comment_id": 65821813, "body": "yeah. Thanks for catching up on that. I did correct it. It still doesnt enable  the checkobx to enter data"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1472627400, "post_id": 39241639, "comment_id": 65822299, "body": "You want the <code>Textbox</code> to be enabled after clicking the <code>Checkbox</code> but the specific code is in the <code>commandbutton_Click()</code> event. You will need to place it in the <code>Checkbox_Exit()</code> event."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472835523, "post_id": 39244388, "comment_id": 65928673, "body": "Would the <i>brave</i> downvoter show up and give any explanation so as to both have people know why they shouldn&#39;t follow thi answer and teach me how to improve it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1472631864, "creation_date": 1472631864, "answer_id": 39244388, "question_id": 39241639, "link": "https://stackoverflow.com/questions/39241639/excel-send-email-macro-in-userform/39244388#39244388", "title": "excel send email macro in userform", "body": "<p>you must:</p>\n\n<ul>\n<li><p>set both <code>Label54</code> and <code>TextBox46</code> <code>Enabled</code> property prior to executing any Userform event handling code </p>\n\n<p>this you can achieve:</p>\n\n<ul>\n<li><p>either with a <code>Private Sub UserForm_Initialize()</code> sub:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    With Me\n        .Label54.Enabled = False\n        .TextBox46.Enabled = False\n    End With\nEnd Sub\n</code></pre></li>\n<li><p>or in the Userform calling block of your \"main\" sub</p>\n\n<pre><code>Sub Main()\n\n    ... code\n\n    With MyUserForm '&lt;--| change \"MyUserForm\" to your actual userform name\n        .Label54.Enabled = False\n        .TextBox46.Enabled = False\n\n        ... other possible code here to set some Userform members before showing it\n\n        .Show '&lt;--| show your userform\n    End With\n    Unload MyUserForm\n\n    ... more code\n\nEnd SUb\n</code></pre></li>\n</ul></li>\n<li><p>set both <code>Label54</code> and <code>TextBox46</code> <code>Enabled</code> property in your <code>CommandButton9_Click</code> event handler accordingly to <code>CheckBox1</code> value</p>\n\n<p>like follows:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton9_Click()\n    Dim OutApp As Object\n    Dim mailSht As Worksheet\n    Dim rowOffset As Long\n\n    Set OutApp = GetApp(\"Outlook.Application\")\n    If OutApp Is Nothing Then\n        MsgBox \"Couldn't set 'Outlook.Application' object\"\n        Exit Sub\n    End If\n\n    Set mailSht = ActiveWorkbook.Sheets(\"Mail\")\n    rowOffset = IIf(CheckBox1, 56, 7) '&lt;--| set a row offset (from row 1) in according to CheckBox value\n\n    Label54.Enabled = CheckBox1 '&lt;--| enable Label54 control if CheckBox1 is checked\n    TextBox46.Enabled = CheckBox1 '&lt;--| enable TextBox46 control if CheckBox1 is checked\n\n    With Me '&lt;--| refer to this userform\n        'fill \"Mail\" sheet properly offsetted cells with ComboBoxes and TextBoxes values\n        FillRangeWithComboBoxValue .ComboBox4, mailSht.Range(\"m1\").Offset(rowOffset)\n        mailSht.Range(\"n1\").Offset(rowOffset).value = .TextBox40.value\n        FillRangeWithComboBoxValue .ComboBox5, mailSht.Range(\"q1\").Offset(rowOffset)\n        FillRangeWithComboBoxValue .ComboBox6, mailSht.Range(\"r1\").Offset(rowOffset)\n        FillRangeWithComboBoxValue .ComboBox7, mailSht.Range(\"s1\").Offset(rowOffset)\n        mailSht.Range(\"t1\").Offset(rowOffset).value = .TextBox44.value\n    End With\n\n    On Error GoTo ERRORMSG\n    With OutApp.CreateItem(0)\n        .To = mailSht.Range(\"G12\").value\n        .CC = mailSht.Range(\"L12\").value\n        .Subject = mailSht.Range(\"O15\").value\n\n        'force html format\n        .HTMLBody = \"&lt;HTML&gt;&lt;body&gt;&lt;body&gt;&lt;/HTML&gt;\"\n        .display\n        With .GetInspector.WordEditor\n            '--- start with 6 CrLf's, so we can place each table\n            '    above all but the last used...\n            .Range.InsertAfter vbCrLf &amp; vbCrLf\n\n            '--- now reselect the entire document, collapse our cursor to the end\n            '    and back up one character (so that the table inserts before the SIXTH CrLf)\n            With .Range\n                .collapse 0\n                .Move 1, -1\n                mailSht.Range(\"K3:T10\").Copy\n                .Paste\n            End With\n\n            '--- finally move the cursor all the way to the end and paste the\n            '    second table BELOW the SIXTH CrLf\n            With .Range\n                .collapse 0\n                mailSht.Range(\"K38:T46\").Copy\n                .Paste\n            End With\n        End With\n    End With\n    Set OutApp = Nothing '&lt;--| dispose the object variable\n\n    Exit Sub\nERRORMSG:\n    MsgBox \"Error on email processing\", vbExclamation\nEnd Sub\n\nFunction GetApp(appName As String) As Object\n    On Error Resume Next\n    Set GetApp = GetObject(, appName)\n    If GetApp Is Nothing Then Set GetApp = CreateObject(appName)\nEnd Function\n\nSub FillRangeWithComboBoxValue(cb As msforms.ComboBox, rng As Range)\n    If cb.ListIndex &lt;&gt; -1 Then rng.value = cb.value\nEnd Sub\n</code></pre>\n\n<p>where you see I proposed some code shortening and <em>modulizing</em> tips to have it (hopefully) more readable and maintainable</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472636565, "post_id": 39245570, "comment_id": 65828044, "body": "Fine. However you may want to consider code refactoring I proposed to you"}, {"owner": {"reputation": 51, "user_id": 6343673, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-3_VrAqW-G_A/AAAAAAAAAAI/AAAAAAAABU4/AGw86wHotkE/photo.jpg?sz=128", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/6343673/coding-enthusiast"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472636748, "post_id": 39245570, "comment_id": 65828169, "body": "Thanks a ton, I will be looking into this. The code modulizing is amazing. But it would take a while, as I have multiple codes in the userform."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472637100, "post_id": 39245570, "comment_id": 65828436, "body": "then you may want to post it in <a href=\"http://codereview.stackexchange.com/questions/tagged/vba\">Code Review</a> and have people help you in increasing your code quality and (possibily) performance"}], "tags": [], "owner": {"reputation": 51, "user_id": 6343673, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-3_VrAqW-G_A/AAAAAAAAAAI/AAAAAAAABU4/AGw86wHotkE/photo.jpg?sz=128", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/6343673/coding-enthusiast"}, "is_accepted": false, "score": 0, "last_activity_date": 1472635202, "creation_date": 1472635202, "answer_id": 39245570, "question_id": 39241639, "link": "https://stackoverflow.com/questions/39241639/excel-send-email-macro-in-userform/39245570#39245570", "title": "excel send email macro in userform", "body": "<p>Thanks Guys, it was a simple fix. I put the checkbox condition in the checkbox change event and it works like a gem. </p>\n\n<p><code>Private Sub CheckBox1_Change()</code></p>\n"}], "owner": {"reputation": 51, "user_id": 6343673, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-3_VrAqW-G_A/AAAAAAAAAAI/AAAAAAAABU4/AGw86wHotkE/photo.jpg?sz=128", "display_name": "Coding Enthusiast", "link": "https://stackoverflow.com/users/6343673/coding-enthusiast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1214, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593307279, "creation_date": 1472622413, "last_edit_date": 1593307279, "question_id": 39241639, "link": "https://stackoverflow.com/questions/39241639/excel-send-email-macro-in-userform", "title": "excel send email macro in userform", "body": "<p>I have the following logic to send an email through outlook from excel. using a userform. The problem is having the textbox activated upon selecting the checkbox. The texbox does not activate upon checking it. I also have tried with the visible property. </p>\n\n<p>The problem is the checkbox is not activating the logic that the else statement.</p>\n\n<pre><code>Private Sub CommandButton9_Click()\nOn Error GoTo ERRORMSG\nDim OutApp As Object\nDim OutMail As Object\nDim olInsp As Object\nDim wdDoc As Object\nDim oRng As Object\n\n\nSet otlApp = CreateObject(\"Outlook.Application\")\nSet olMail = otlApp.CreateItem(olMailItem)\nSet Doc = olMail.GetInspector.WordEditor\nSet mainWB = ActiveWorkbook\n\nIf CheckBox1.Value = False Then\n\nmainWB.Sheets(\"Mail\").Range(\"m8\").Value = ComboBox4.Value\nmainWB.Sheets(\"Mail\").Range(\"n8\").Value = TextBox40.Value\nmainWB.Sheets(\"Mail\").Range(\"q8\").Value = ComboBox5.Value\nmainWB.Sheets(\"Mail\").Range(\"r8\").Value = ComboBox6.Value\nmainWB.Sheets(\"Mail\").Range(\"s8\").Value = ComboBox7.Value\nmainWB.Sheets(\"Mail\").Range(\"t8\").Value = TextBox44.Value\n\n\n On Error Resume Next\nSet OutApp = GetObject(, \"Outlook.Application\")\nIf Err &lt;&gt; 0 Then Set OutApp = CreateObject(\"Outlook.Application\")\n    On Error GoTo 0\n\nSet OutMail = OutApp.CreateItem(0)\n\nWith OutMail\n    .To = \"mainWB.Sheets(\"Mail\").Range(\"G12\").Value\"\n    .cc = mainWB.Sheets(\"Mail\").Range(\"L12\").Value\n    .Subject = mainWB.Sheets(\"Mail\").Range(\"O15\").Value\n    Set olInsp = .GetInspector\n    Set wdDoc = olInsp.WordEditor\n    Set oRng = wdDoc.Range\n\n    'force html format\n    .HTMLBody = \"&lt;HTML&gt;&lt;body&gt;&lt;body&gt;&lt;/HTML&gt;\"\n    .display\n\n\n    '--- start with 6 CrLf's, so we can place each table\n    '    above all but the last used...\n    oRng.InsertAfter vbCrLf &amp; vbCrLf\n\n    '--- now reselect the entire document, collapse our cursor to the end\n    '    and back up one character (so that the table inserts before the SIXTH CrLf)\n    Set oRng = wdDoc.Range\n    oRng.collapse 0\n    oRng.Move 1, -1\n    Range(\"K3:T10\").Select\n    Selection.Copy\n    oRng.Paste\n\n\n    '--- finally move the cursor all the way to the end and paste the\n    '    second table BELOW the SIXTH CrLf\n    Set oRng = wdDoc.Range\n    oRng.collapse 0\n    Range(\"K38:T46\").Select\n    Selection.Copy\n    oRng.Paste\nEnd With\n\nElse\nLabel54.enable = True\nTextBox46.enable = True\n\nmainWB.Sheets(\"Mail\").Range(\"m57\").Value = ComboBox4.Value\nmainWB.Sheets(\"Mail\").Range(\"n57\").Value = TextBox40.Value\nmainWB.Sheets(\"Mail\").Range(\"O57\").Value = TextBox46.Value\nmainWB.Sheets(\"Mail\").Range(\"q57\").Value = ComboBox5.Value\nmainWB.Sheets(\"Mail\").Range(\"r57\").Value = ComboBox6.Value\nmainWB.Sheets(\"Mail\").Range(\"s57\").Value = ComboBox7.Value\nmainWB.Sheets(\"Mail\").Range(\"t57\").Value = TextBox44.Value\n\n\n On Error Resume Next\nSet OutApp = GetObject(, \"Outlook.Application\")\nIf Err &lt;&gt; 0 Then Set OutApp = CreateObject(\"Outlook.Application\")\n    On Error GoTo 0\n\nSet OutMail = OutApp.CreateItem(0)\n\nWith OutMail\n    .To = \"mainWB.Sheets(\"Mail\").Range(\"G12\").Value\"\n    .cc = mainWB.Sheets(\"Mail\").Range(\"L12\").Value\n    .Subject = mainWB.Sheets(\"Mail\").Range(\"O15\").Value\n    Set olInsp = .GetInspector\n    Set wdDoc = olInsp.WordEditor\n    Set oRng = wdDoc.Range\n\n    'force html format\n    .HTMLBody = \"&lt;HTML&gt;&lt;body&gt;&lt;body&gt;&lt;/HTML&gt;\"\n    .display\n\n\n    '--- start with 6 CrLf's, so we can place each table\n    '    above all but the last used...\n    oRng.InsertAfter vbCrLf &amp; vbCrLf\n\n    '--- now reselect the entire document, collapse our cursor to the end\n    '    and back up one character (so that the table inserts before the SIXTH CrLf)\n    Set oRng = wdDoc.Range\n    oRng.collapse 0\n    oRng.Move 1, -1\n    Range(\"K52:T59\").Select\n    Selection.Copy\n    oRng.Paste\n\n\n    '--- finally move the cursor all the way to the end and paste the\n    '    second table BELOW the SIXTH CrLf\n    Set oRng = wdDoc.Range\n    oRng.collapse 0\n    Range(\"K38:T46\").Select\n    Selection.Copy\n    oRng.Paste\nEnd With\nEnd If\nExit Sub\nERRORMSG:\nMsgBox \"No email was sent\", vbExclamation\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1472623041, "post_id": 39241102, "comment_id": 65820016, "body": "I&#39;m thinking that the colon should be a comma. I&#39;ll run some tests."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472623371, "post_id": 39241102, "comment_id": 65820172, "body": "If it was a comma it would be considered two separate arguments; one for each cell.  Using Range will extend the range between the cells.  But let me know, just in case..lol."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1472624132, "post_id": 39241102, "comment_id": 65820530, "body": "Yes, you are always counting <b>1</b> regardless of the actual count because you are concatenating together the cell value from the first, then a colon then the cell value from the last. You are essentially counting a single string which will always be <b>1</b>. YOu would have to Evaluate it as a worksheet function using the cell addresses concatenated with the colon to use it this way. By using Range and supplying hte upper-left and lower-right separated by a comma, I count the whole range."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472624283, "post_id": 39241102, "comment_id": 65820600, "body": "You worded that much more better that I did. Thanks for the feedback."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1472619721, "creation_date": 1472619721, "answer_id": 39241102, "question_id": 39240958, "link": "https://stackoverflow.com/questions/39240958/counta-returns-0-worksheetfunction-counta-returns-1/39241102#39241102", "title": "CountA returns 0, WorksheetFunction.CountA returns 1", "body": "<p>Your syntax is wrong.  </p>\n\n<p>Correct Syntax: </p>\n\n<p><code>Application.WorksheetFunction.CountA (Range(Cells(4 + (i - 1) * rows_per_record, 28), Cells(5 + (i - 1) * rows_per_record, 58)))\n</code></p>\n\n<p>Your code is counting each argument that is not an empty string.  The only argument is a colon surrounded by the two empty cell values.</p>\n\n<p><code>Application.WorksheetFunction.CountA(ThisWorkbook.Sheets(n).Cells(4 + (i - 1) * rows_per_record, 28) &amp; \":\" &amp; ThisWorkbook.Sheets(n).Cells(5 + (i - 1) * rows_per_record, 58))</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/7fYC3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7fYC3.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472623652, "post_id": 39241726, "comment_id": 65820302, "body": "I should have wrapped my ranges inside a With block and qualified them."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1472623247, "last_edit_date": 1472623247, "creation_date": 1472622860, "answer_id": 39241726, "question_id": 39240958, "link": "https://stackoverflow.com/questions/39240958/counta-returns-0-worksheetfunction-counta-returns-1/39241726#39241726", "title": "CountA returns 0, WorksheetFunction.CountA returns 1", "body": "<p>I believe you have the answer and one version of the correct syntax in another response. Here is an alternate:</p>\n\n<pre><code>dim c as long\nwith ThisWorkbook.Sheets(n)\n    c = Application.CountA(.range(.Cells(4 + (i - 1) * rows_per_record, 28), _\n                                  .Cells(5 + (i - 1) * rows_per_record, 58)))\n    debug.print c\nend with\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a> is constructed by supplying the upper-left and lower right corners with two <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow\">Range.Cells properties</a>. The parent worksheet is referenced through the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a>.</p>\n"}], "owner": {"reputation": 655, "user_id": 2670777, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d69cb2368cc72bf16229fdddf46e557a?s=128&d=identicon&r=PG", "display_name": "joehua", "link": "https://stackoverflow.com/users/2670777/joehua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1982, "favorite_count": 0, "accepted_answer_id": 39241102, "answer_count": 2, "score": 3, "last_activity_date": 1472624407, "creation_date": 1472618980, "last_edit_date": 1472624407, "question_id": 39240958, "link": "https://stackoverflow.com/questions/39240958/counta-returns-0-worksheetfunction-counta-returns-1", "title": "CountA returns 0, WorksheetFunction.CountA returns 1", "body": "<p>In the debug window, the following expressions all return one.</p>\n\n<pre><code>Application.WorksheetFunction.CountA(Cells(4 + (i - 1) * rows_per_record, 28) &amp; \":\" &amp; Cells(5 + (i - 1) * rows_per_record, 58))\n\nApplication.WorksheetFunction.CountA(ThisWorkbook.Sheets(n).Cells(4 + (i - 1) *  rows_per_record, 28) &amp; \":\" &amp; ThisWorkbook.Sheets(n).Cells(5 + (i - 1) * rows_per_record, 58))\n</code></pre>\n\n<p>In this particular case, the range is AB60:BF61, which is confirmed in debug window.</p>\n\n<p>In the worksheet, while the script is paused, I enter in a cell <code>=CountA(AB60:BF61)</code> and the result is 0, which is what it should be.</p>\n\n<p>Any explanation will be greatly appreciated.</p>\n\n<p>Windows 7, Excel 2010</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2969, "user_id": 2200824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/14d5e4db680bf435588c48c505301479?s=128&d=identicon&r=PG", "display_name": "ARich", "link": "https://stackoverflow.com/users/2200824/arich"}, "edited": false, "score": 1, "creation_date": 1472619277, "post_id": 39240909, "comment_id": 65818614, "body": "You should be using string. What do you mean &quot;string isn&#39;t working&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 198, "user_id": 6467769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa77ecf4c9477bb226f22a812908e2fd?s=128&d=identicon&r=PG&f=1", "display_name": "Chrowno", "link": "https://stackoverflow.com/users/6467769/chrowno"}, "reply_to_user": {"reputation": 276, "user_id": 4885960, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/478d641800a96aa96167f35401a7e7aa?s=128&d=identicon&r=PG&f=1", "display_name": "NuWin", "link": "https://stackoverflow.com/users/4885960/nuwin"}, "edited": false, "score": 1, "creation_date": 1472624765, "post_id": 39241289, "comment_id": 65820813, "body": "That was an example of how to deal with different data types when you need a number in a string and for example in a calculation."}, {"owner": {"reputation": 125, "user_id": 4973780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-s5-hQhNOQ4c/AAAAAAAAAAI/AAAAAAAAABo/2XTmMOvvklw/photo.jpg?sz=128", "display_name": "Vinayak Bakshi", "link": "https://stackoverflow.com/users/4973780/vinayak-bakshi"}, "edited": false, "score": 0, "creation_date": 1472635764, "post_id": 39241289, "comment_id": 65827446, "body": "I used variant instead and it worked with that. I did not have to concatenate string and integer variables. Thanx for the help anyways guys."}], "tags": [], "owner": {"reputation": 198, "user_id": 6467769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa77ecf4c9477bb226f22a812908e2fd?s=128&d=identicon&r=PG&f=1", "display_name": "Chrowno", "link": "https://stackoverflow.com/users/6467769/chrowno"}, "is_accepted": true, "score": 1, "last_activity_date": 1472634120, "last_edit_date": 1472634120, "creation_date": 1472620697, "answer_id": 39241289, "question_id": 39240909, "link": "https://stackoverflow.com/questions/39240909/data-type-confusion-for-word-with-both-alphabet-and-numbers-eg-tlc5/39241289#39241289", "title": "Data type confusion... for word with both alphabet and numbers eg. tlc5?", "body": "<p>Without having seen your current code: use string. VBA can convert any number to a string.</p>\n\n<p>e.g.</p>\n\n<pre><code>Dim i as Integer\nDim s as String\n\ni = 2\ns = \"test\" &amp; i\n</code></pre>\n\n<p>will result in a string \"test2\". To convert any other data type to a string there is the CStr() function.</p>\n\n<p>If you need to work with a number contained in said string later on, I would suggest you store the number and string in a seperate variables as show above.</p>\n"}], "owner": {"reputation": 125, "user_id": 4973780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-s5-hQhNOQ4c/AAAAAAAAAAI/AAAAAAAAABo/2XTmMOvvklw/photo.jpg?sz=128", "display_name": "Vinayak Bakshi", "link": "https://stackoverflow.com/users/4973780/vinayak-bakshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 39241289, "answer_count": 1, "score": -1, "last_activity_date": 1472634120, "creation_date": 1472618722, "last_edit_date": 1531164843, "question_id": 39240909, "link": "https://stackoverflow.com/questions/39240909/data-type-confusion-for-word-with-both-alphabet-and-numbers-eg-tlc5", "title": "Data type confusion... for word with both alphabet and numbers eg. tlc5?", "body": "<p>In my code i want to provide inputs which are both alphabet and numbers. Eg- tlc5. What data type should i use for such an input since only integer or only string isn't working?</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472617550, "post_id": 39240316, "comment_id": 65818156, "body": "A screenshot or sample workbook would really help."}, {"owner": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "edited": false, "score": 0, "creation_date": 1472620193, "post_id": 39240316, "comment_id": 65818935, "body": "I&#39;ve added two examples of worksheets. The first is a typical week ending and falls within a calendar month. The next is one which straddles two months.  The number of sheets is dynamic, in that each new week ending is a new sheet (there will be another this Friday for example). I can grab the YTD info fine, but I&#39;m having issues grabbing by date to get a monthly breakdown of total route hours and total overall hours per month--just stuck in a mental quagmire(sorry for being vague again)."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "edited": false, "score": 0, "creation_date": 1472685119, "post_id": 39252233, "comment_id": 65856675, "body": "Thank you for your efforts.   I&#39;ll be trying the suggested code out tomorrow, but in reading it, it makes sense and would cover what I was trying/wishing to do."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "edited": false, "score": 0, "creation_date": 1472685904, "post_id": 39252233, "comment_id": 65856883, "body": "Let me know how it works out for you.  THanks for accepting my answer."}, {"owner": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "edited": false, "score": 0, "creation_date": 1472934733, "post_id": 39252233, "comment_id": 65954974, "body": "Sorry for the delay in response--work has been hectic.  The code has worked well and I understood it well enough to modify it for a second workbook as well.  I remain a bit fuzzy on your method for dealing with work week which straddle calendar months. I&#39;ve manually checked the figures(correct) and can use your code, but there&#39;s still a bit of a logical disconnect.  Please explain this portion of your code in a bit more detail and/or in pseudo code when you get a chance. It would be appreciated."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "edited": false, "score": 0, "creation_date": 1472948076, "post_id": 39252233, "comment_id": 65957720, "body": "I actually just broke the data down into days.  Did you want to group it by work weeks in a month?"}, {"owner": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "edited": false, "score": 0, "creation_date": 1473621169, "post_id": 39252233, "comment_id": 66201806, "body": "I&#39;ve got the original code working as needed--and I&#39;ve done some more research on dateserial as well, so I have a decent understanding of it at this point. However, I&#39;ve tried addapting the code to another workbook and am running into an odd error.  I am getting a type mismatch on:      d= DateSerial(Year(.Cells(4,y)), Month(.Cells(4,y)),1) The format of the new workbook is the same as the former, but for the row(changed to 4). I&#39;ve looked through all the sheets and all the cells in question are dates. I&#39;ve no clue where a type mismatch could be generated. Do you have any suggestions?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "edited": false, "score": 0, "creation_date": 1473627140, "post_id": 39252233, "comment_id": 66203409, "body": "When the code breaks click debug; hover the mouse over <code>.Cells(4,y)</code> you&#39;ll see a tool tip text showing the value of the cell.  If you have a tough time reading it hold down <code>Ctrl</code>+<code>G</code> to bring up the immediate window.  Type <code>?.Cells(4,y)</code> and press <code>Enter</code>.  This will print the value of the cell to the immediate window.  Let me know what the value is for the cell that is breaking the code."}, {"owner": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "edited": false, "score": 0, "creation_date": 1473682270, "post_id": 39252233, "comment_id": 66221192, "body": "I never realised that a mouse over would have a &quot;data value tool tip&quot;. That is an excellent piece of information.  Your code is perfect, as is my recent modification. The data entry on the sheets was not---they had one cell, out of several dozen worksheets, which had a rogue character in one of the date fields.  Thank you very much. I wish I could upvote your comments. Your assistance has been invaluable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "edited": false, "score": 0, "creation_date": 1473684312, "post_id": 39252233, "comment_id": 66222410, "body": "You should watch this whole video series <a href=\"https://www.youtube.com/watch?v=DlqKfYTgc9Q\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 3 - What to do When Things Go Wrong (Errors and Debugging)</a>. I&#39;m happy here that it is working for you.  Happy Coding!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1472653357, "creation_date": 1472653357, "answer_id": 39252233, "question_id": 39240316, "link": "https://stackoverflow.com/questions/39240316/search-excel-sheets-for-dates-to-consolidate-data-by-month-using-vba/39252233#39252233", "title": "Search Excel Sheets for dates to consolidate data by month using VBA", "body": "<p>I think that it would be just as easy to compile the data as to use consolidate.</p>\n\n<h2><a href=\"https://i.stack.imgur.com/liegz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/liegz.jpg\" alt=\"enter image description here\"></a></h2>\n\n<pre><code>Sub ProcessData()\n    Dim arTemp\n    Dim d As Date\n    Dim x As Long, y As Integer\n    Dim ws As Worksheet\n    Dim list As Object\n    Set list = CreateObject(\"System.Collections.SortedList\")\n\n    For Each ws In Worksheets\n        If ws.Name &lt;&gt; \"Summary\" Then\n            With ws\n                For y = 2 To 6\n                    d = DateSerial(Year(.Cells(2, y)), Month(.Cells(2, y)), 1)\n                    If list.ContainsKey(d) Then\n                        arTemp = list(d)\n                    Else\n                        ReDim arTemp(2)\n                    End If\n                    arTemp(0) = arTemp(0) + .Cells(3, y)\n                    arTemp(1) = arTemp(1) + .Cells(4, y)\n                    arTemp(2) = arTemp(2) + 1\n                    list(d) = arTemp\n\n                Next\n            End With\n        End If\n    Next\n    With Worksheets(\"Summary\")\n        .Cells.Delete\n        .Range(\"A1:F1\") = Array(\"Year\", \"Month\", \"Avg. Kilometres\", \"Avg. Route Hours\", \"Sum Kilometres\", \"Sum Route Hours\")\n        For x = 0 To list.Count - 1\n            d = list.GetKey(x)\n            .Cells(x + 2, 1) = Year(d)\n            .Cells(x + 2, 2) = Month(d)\n            .Cells(x + 2, 3) = list(d)(0) / list(d)(2)\n            .Cells(x + 2, 4) = list(d)(1) / list(d)(2)\n            .Cells(x + 2, 5) = list(d)(0)\n            .Cells(x + 2, 6) = list(d)(1)\n        Next\n            .Rows(x + 2).Columns(\"C:D\").FormulaR1C1 = \"=Average(R[-\" &amp; x &amp; \"]C:R[-1]C)\"\n            .Rows(x + 2).Columns(\"E:F\").FormulaR1C1 = \"=Sum(R[-\" &amp; x &amp; \"]C:R[-1]C)\"\n            .Columns(\"C:F\").NumberFormat = \"0.00\"\n        .Columns.AutoFit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6759039, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/789b149bf63a605dac816dbb3c75902b?s=128&d=identicon&r=PG&f=1", "display_name": "WarOrdos", "link": "https://stackoverflow.com/users/6759039/warordos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1179, "favorite_count": 0, "accepted_answer_id": 39252233, "answer_count": 1, "score": 1, "last_activity_date": 1472653357, "creation_date": 1472614549, "last_edit_date": 1472620454, "question_id": 39240316, "link": "https://stackoverflow.com/questions/39240316/search-excel-sheets-for-dates-to-consolidate-data-by-month-using-vba", "title": "Search Excel Sheets for dates to consolidate data by month using VBA", "body": "<p>I have an unknown number of Sheets in a workbook but each sheet shares identical formating. Each sheet represents a work week. These weeks can straddle calendar months. Each column has a row which reflects a day of the week and has a date cell. Date format is dd/mm/yr</p>\n\n<p>My code currently finds the number of sheets and parses through the sheets to consolidate specific information to a summary sheet. This information is in a year to date (YTD) format.</p>\n\n<p>In addition to YTD format, I need to be able to pull out the data on a calendar month basis.</p>\n\n<p>Each sheet has up to 5 cells of data (one per day of the week) and two groups of up to 5 cells (ie. Route Hours and Total Hours, up to 5 entries- Mon-Fri, if with in the active month) The cells will be summed together resulting in two sums. This needs to be done for each working week in a calendar month and the total values then output to my summary sheet.</p>\n\n<p>The code below is what I am using to go through each data sheet and grab YTD data. I want to add code to cover the monthly data extraction as well but I am having extreme difficulty implementing such code--I keep going in mental circles.</p>\n\n<pre><code>Dim I As Integar\nDim WS_Count As Integar\nDim ConsolidationArrayYTDTotalDailyAve() 'Array storage YTD Tot Daily Ave\n\nWS_Count = ActiveWorkbook.Worksheets.Count ' last worksheet\nReDim ConsolidationArrayYTDTotalDailyAve(WS_Count-2)   \n\nFor I = 2 to WS_Count 'check from 2nd WS as first sheet is the summary\n    ConsolidationArrayYTDTotalDailyAve(I - 2) = Worksheets(I).Name &amp; \"!R54C3:R56C8\" 'Grab the data from each sheet and save in the array\nNext I\nSheets(\"Summary\").Range(\"B4\").Consolidate sources:=(ConsolidationArrayYTDTotalDailyAve), Function:=xlAverage\n</code></pre>\n\n<p>I am thinking somewhat of the following design(with the do while loop to be inside the above For loop--not actual code just trying to express thought process):</p>\n\n<pre><code>Dim Im As Integer 'Same function as I when parsing through sheets\nDim FirstDay As Date 'first day of the month\nDim LastDay As Date 'last day of the month\nDim Month as Integer 'tracks active month 1 through 12\nDim RouteHrsSum As Single 'stores the sum of monthly Route Hours\nDim TotalHrsSum As Single 'stores the sum of monthly Total Hours\n\nMonth = 1 'set default month to January\n\nDo While (ActiveCell &gt;= FirstDay &amp; ActiveCell &lt;= LastDay) &amp; Month &lt;= 12\n    For Im = 2 to WS_Count\n        IF Month = 1 Then\n            FirstDay = 1/1/2016 &amp; LastDay = 31/1/2016\n        ElseIF Month = 2 Then\n            FirstDay = 1/2/2016 &amp; LastDay = 29/02/2016\n        ETC...\n        Else\n            FirstDay = 1/12/2016 &amp; LastDay = 31/12/2016\n        Action: Scan a range of cells for dates for the active month\n        IF Date of Active Month found then sum cells A2, B2, C2 together, sum cells A9,B9,C9 together and write both sums to a pair of storage vairables (RouteHrsSum and TotalHrsSum respectively)\n        Else\n            Output RouterHrsSum &amp; TotalHRsSum to respective cells on sheeet 1\n            Month = Month + 1 'Make next month active\n            'need to be able to recheck the last worksheet for a calendar month straddle and get data if so for new month's days\n        Next Im \nLoop\n</code></pre>\n\n<p>Sample of a data worksheet: (week ending 19-Aug)</p>\n\n<pre><code>Driver Bob    Monday    Tuesday    Wednesday    Thursday    Friday    \n              15-Aug    16-Aug     17-Aug       18-Aug      19-Aug\nKilometres    318       91         119          219         394\nRoute Hours   5.74      4          2.5          4.25        6\nTotal Hours   9         9          9            9           10\n</code></pre>\n\n<p>Sample of a data worksheet: (week ending straddling calendar months)</p>\n\n<pre><code>Driver Bob    Monday    Tuesday    Wednesday    Thursday    Friday    \n              29-Aug    30-Aug     31-Aug       1-Sept      2-Sept\nKilometres    300       110        119          89          394\nRoute Hours   7         4          2.5          4.25        6\nTotal Hours   9         9          9            9           9\n</code></pre>\n\n<p>I feel I'm on the right track, conceptually, but I keep getting bogged down when it comes to the actual code and design. Any assistance is appreciated. I apologise if this is vague, but I cannot see the forest for the trees.</p>\n\n<p>I will readily edit this question for content as greater clarity presents.</p>\n"}, {"tags": ["vba", "excel", "named-ranges"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1472611693, "post_id": 39239902, "comment_id": 65816844, "body": "do you want to copy the value from E3 to F3 only when F3 is not blank?"}, {"owner": {"reputation": 3, "user_id": 6776725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b368a8c567e46a99433b358bf50694cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch125", "link": "https://stackoverflow.com/users/6776725/mitch125"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1472612214, "post_id": 39239902, "comment_id": 65816948, "body": "yes, copy it to become the name (not the value) of F3, and repeat for all the cells in column F that are not blank"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1472615109, "creation_date": 1472615109, "answer_id": 39240383, "question_id": 39239902, "link": "https://stackoverflow.com/questions/39239902/naming-the-non-empty-cells-of-a-column-as-the-previous-columns-values/39240383#39240383", "title": "Naming the non-empty cells of a column as the previous column&#39;s values", "body": "<p>From your sample image this looks like it should work.</p>\n\n<pre><code>Option Explicit\n\nSub name_eff()\n    Dim rw As Long\n    With Worksheets(\"Sheet6\")\n        For rw = 2 To Application.Min(.Cells(.Rows.Count, \"E\").End(xlUp).Row, _\n                                      .Cells(.Rows.Count, \"F\").End(xlUp).Row)\n            If Application.CountA(.Cells(rw, \"E\").Resize(1, 2)) = 2 Then _\n                .Cells(rw, \"F\").Name = .Cells(rw, \"E\").Text\n        Next rw\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mSDBM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mSDBM.png\" alt=\"named_ranges\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 6776725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b368a8c567e46a99433b358bf50694cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch125", "link": "https://stackoverflow.com/users/6776725/mitch125"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 39240383, "answer_count": 1, "score": 0, "last_activity_date": 1472616806, "creation_date": 1472611004, "last_edit_date": 1472616806, "question_id": 39239902, "link": "https://stackoverflow.com/questions/39239902/naming-the-non-empty-cells-of-a-column-as-the-previous-columns-values", "title": "Naming the non-empty cells of a column as the previous column&#39;s values", "body": "<p>So what I want is a button that when pressed will automatically name the right hand column cells the left hand column values, my code at the moment looks something like this, </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Range(\"F3\").Name = Range(\"E3\")\n    Range(\"F4\").Name = Range(\"E4\")\n    Range(\"F5\").Name = Range(\"E5\")\n    Range(\"F6\").Name = Range(\"E6\")\n\nEnd Sub\n</code></pre>\n\n<p>I'm new to using VBA and have looked around a little but couldn't find what I wanted to achieve. Just want a simple solution which can automatically do what my code already does without having to be specific about cell rows.\nI imagine that there will be either a while or for loop to repeat over many rows and an if statement for the code not running if a cell is empty.</p>\n\n<p>Basically I want the command to run something like below but don't quite know how to write it in excel VBA myself.</p>\n\n<pre><code>for j=3:100\n    if F(j) = non empty\n        F(j).name = E(j)\n    else end\n    next j\nend\n</code></pre>\n\n<p>Image below shows the end result :</p>\n\n<p><img src=\"https://i.stack.imgur.com/iCMCV.png\" alt=\"end result\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1472609025, "post_id": 39239595, "comment_id": 65816267, "body": "Do you need a VBA solution?  The Excel formula solution is <code>=CONCATENATE(&quot;Column&quot;,COLUMN(D1) &#47; 2 - 1)</code> where <code>D1</code> is the cell that it&#39;s in."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1472609183, "post_id": 39239595, "comment_id": 65816298, "body": "@pnuts - Good point :-D - I missed the 500-1000 columns bit and just looked at the screenshot."}, {"owner": {"reputation": 3, "user_id": 6776716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63e7672fb48fad38e7d5c685bada7c9?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Halbert", "link": "https://stackoverflow.com/users/6776716/joe-halbert"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472610257, "post_id": 39239595, "comment_id": 65816518, "body": "@Comintern Yea unfortunately I do because there are just sooooo many columns."}, {"owner": {"reputation": 3, "user_id": 6776716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63e7672fb48fad38e7d5c685bada7c9?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Halbert", "link": "https://stackoverflow.com/users/6776716/joe-halbert"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472610354, "post_id": 39239595, "comment_id": 65816545, "body": "@user3598756 that worked remarkabley well. It does the numbers in multiples of 2 (2,4,6,8) instead of (1,2,3,4,5) but I can probably work around that on my back end. Thank you!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472610558, "post_id": 39239595, "comment_id": 65816597, "body": "@JoeHalbert, see edited answer"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1472610480, "last_edit_date": 1472610480, "creation_date": 1472609246, "answer_id": 39239660, "question_id": 39239595, "link": "https://stackoverflow.com/questions/39239595/insert-a-string-and-a-sequential-number-every-other-column-in-vba/39239660#39239660", "title": "Insert a String and a Sequential Number Every Other Column in VBA", "body": "<p>Try this</p>\n\n<pre><code>Sub insert_column_every_other()\n    Dim lColumn As Long, iColumn As Long\n\n    With Worksheets(\"MySheetName\") ' change \"MySheetName\" to your actual worksheet name\n        lColumn = .Cells(2, .Columns.Count).End(xlToLeft).Column\n        For iColumn = 2 To lColumn Step 2\n            .Cells(2, iColumn).Value = \"Column\" &amp; iColumn/2\n        Next iColumn\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6776716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63e7672fb48fad38e7d5c685bada7c9?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Halbert", "link": "https://stackoverflow.com/users/6776716/joe-halbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 39239660, "answer_count": 1, "score": 0, "last_activity_date": 1472610480, "creation_date": 1472608750, "question_id": 39239595, "link": "https://stackoverflow.com/questions/39239595/insert-a-string-and-a-sequential-number-every-other-column-in-vba", "title": "Insert a String and a Sequential Number Every Other Column in VBA", "body": "<p>I cannot figure this out. </p>\n\n<p><a href=\"http://i.stack.imgur.com/3cowo.png\" rel=\"nofollow\">First Few Columns of data</a></p>\n\n<p>Right Now I've got a bunch of worksheets with 500-1000 columns with data. Next to each Column is a blank space I inserted. I'm Trying to insert the text \"Column\" Followed by a sequential number \"Column1\" \"Column2\" \"Column3\" etc until the data ends. </p>\n\n<p>So far I have tried playing around with</p>\n\n<pre><code>Sub insert_column_every_other()\nDim lColumn As Long\nlColumn = ws.Cells(2, Columns.Count).End(xlToLeft).Column\nFor colx = 2 To col.last Step 2\nColumns(colx).Value = \"Column\" +1\nNext\nEnd Sub\n</code></pre>\n\n<p>but its not even close. Does anybody have any idea how to do this?</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "worksheet-function"], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472615650, "post_id": 39240104, "comment_id": 65817695, "body": "the problem is for each sheet, the column for &quot;Names&quot; and &quot;Status&quot; varies."}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472617331, "post_id": 39240104, "comment_id": 65818107, "body": "and also, not all sheets should be searched. there are some sheets on the workbook that is not should be part of the search."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472622265, "post_id": 39240104, "comment_id": 65819728, "body": "So which is the pattern of &quot;Status&quot; and &quot;Names&quot; columns positions across worksheets? And how to detect worksheets where to search?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472632086, "post_id": 39240104, "comment_id": 65825010, "body": "@ErinSantos, could please answer my question and let me help you out? Should columns be found by means of their <i>header</i> value (i.e. &quot;Names&quot; column in any sheet is the one whose <i>header</i> in row 1  is &quot;Names&quot;), then the code can be easily adjusted and you don&#39;t need to hardcode anything in it but those columns header names (e.g: &quot;Names&quot; and &quot;Status&quot;)"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472682360, "post_id": 39240104, "comment_id": 65855866, "body": "There is only a handful of worksheet to search so sheet name is where I would base my search, as for the columns, their positions are just random. <code>Names</code> and <code>Status</code> was just randomly inserted. <code>Names</code> column always comes first before <code>Status</code> column though."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472683059, "post_id": 39240104, "comment_id": 65856094, "body": "&quot;Sheet name is where I would base my search&quot;: what does that mean? &quot;Names&quot; and &quot;Status&quot; was just randomly inserted&quot;: so a &quot;Names&quot; column header in one sheet differs from that of any other one?"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472684478, "post_id": 39240104, "comment_id": 65856510, "body": "The <code>Names</code> and <code>Status</code> column header are constant but their column in their worksheet differs. For sheet1, <code>Names</code> column could be in A and <code>Status</code> column could be in C, while for sheet2, <code>Names</code> column could be in C while <code>Status</code> column could be in F. For worksheets, I do not need to search all sheets on the workbook, I just need to search a number of specificly named worksheets."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472685219, "post_id": 39240104, "comment_id": 65856706, "body": "So what are &quot;Names&quot; and &quot;Status&quot; columns actual constant headers? And which row are they in? Do sheets to be searched in share a unique and common pattern (e.g.: they and only they all have names beginning with/ending with/containing &quot;xyz&quot;, they and only they all have &quot;wxy&quot; in their cell &quot;A1&quot;,...)?"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472685548, "post_id": 39240104, "comment_id": 65856795, "body": "They are in first row since they are header names. Their header names are <code>Names</code> and <code>Status</code>. The sheets don&#39;t really have a common pattern."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472686329, "post_id": 39240104, "comment_id": 65856998, "body": "Are to-be-searched in sheets the only ones with both &quot;Names&quot; and &quot;Status&quot; headers in row 1? While as for <i>&quot;They are in first row since they are header names.&quot;</i>: well, hang around a little bit here and you&#39;ll see things that you&#39;d never think possible..."}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472686832, "post_id": 39240104, "comment_id": 65857115, "body": "No, some of the sheets that do not need to be searched also have both <code>Names</code> and <code>Status</code> columns."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472718509, "post_id": 39240104, "comment_id": 65867555, "body": "@ErinSantos: you may want to see my edited code which reduces both hard coding needs and (possibly, in the <i>refactored</i> edition) debugging-maintenance efforts"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472780283, "post_id": 39240104, "comment_id": 65900669, "body": "I tried your code and it&#39;s working perfectly and faster. Thanks!"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472785559, "post_id": 39240104, "comment_id": 65901835, "body": "If I have another column that I need to populate. I want to put the content of the <code>MsgBox</code> to a <code>Notes</code> column, do I have to modify the functions too?"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472802576, "post_id": 39240104, "comment_id": 65908027, "body": "Apologies. Don&#39;t mind my last question. I was able accomplish it by adding a few lines. How do I reference the original sheet where the first update happened? THanks again!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472805717, "post_id": 39240104, "comment_id": 65909924, "body": "Excellent answer. +1"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472806841, "post_id": 39240104, "comment_id": 65910693, "body": "can you tell where is the line where you reference the first updated row?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472807562, "post_id": 39240104, "comment_id": 65911167, "body": "cell updating takes place in <code>.Cells(f.row, statusCol) = statusValue </code> (right before the <code>MsgBox</code> statement in <code>Sub UpdateSheet()</code>: is that what you need?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472807858, "post_id": 39240104, "comment_id": 65911388, "body": "thanks @ThomasInzina. Yours was fine as well and suitable in case there were no &quot;Status-Names columns&quot; searching pattern. You could leave it for useful reference"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1472808302, "post_id": 39240104, "comment_id": 65911703, "body": "It worked but I really force it.  I immediately defaulted to a dictionary because we&#39;re looking in multiple list.  When in actuality it didn&#39;t make much sense because we are looking for a single match in each list."}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472810180, "post_id": 39240104, "comment_id": 65912967, "body": "I want to know how I can reference the row where a matched has been found from a specific sheet. For example if there is a match in sheet1, I want to get the row number where a match is found. Thanks!"}, {"owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "edited": false, "score": 0, "creation_date": 1472881859, "post_id": 39240104, "comment_id": 65941018, "body": "@user3598756 apologies. I wasn&#39;t clear. What I wanted is to check this specific sheet. Let&#39;s call it master_sheet. So whenever an update happened in master_sheet, be it by user input or automated AND there is a same record from other sheet, I want to get the row where there is a match from specifically master_sheet because beside this <code>Status</code> column from <code>master_SHeet</code> is a <code>notes</code> column where I&#39;d like to place the texts form <code>msgbox</code>. But if there is change that does not involve the <code>master_sheet</code> then, nothing will happen in <code>master_sheet</code>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472883676, "post_id": 39240104, "comment_id": 65941332, "body": "well since an user input can be involved that you&#39;d go with a worksheet event handler. there are a lot of SO answers about such an issue: you can check and should you get stuck then back with a new post (as per SO rules: one issue= one post) with your code"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1472885084, "post_id": 39240104, "comment_id": 65941612, "body": "if you don&#39;t help with already available SO Q&amp;A on the same issue, yes. But be sure to post your code attempt to increase feedbacks probability"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 3, "last_activity_date": 1472815043, "last_edit_date": 1472815043, "creation_date": 1472612697, "answer_id": 39240104, "question_id": 39239525, "link": "https://stackoverflow.com/questions/39239525/excel-update-multiple-columns-if-a-column-from-one-of-the-worksheet-is-updated/39240104#39240104", "title": "excel - Update multiple columns if a column from one of the worksheet is updated", "body": "<p>Your code errors because you're trying to offset 11 columns left of column D</p>\n\n<p><strong>edited</strong> after OP's clarification about:</p>\n\n<ul>\n<li><p><em>to-be-searched-in</em> sheet names to be hard coded, since no common pattern can be found to filter them amongst all other worksheets </p></li>\n<li><p><code>Names</code> and <code>Status</code> columns having, correspondingly, \"Names\" and \"Status\" headers in row 1 of every <em>to-be-searched-in</em> worksheet</p></li>\n</ul>\n\n<p><strong>edited2</strong> to take account of the first update row index (see lines with \"****\")</p>\n\n<p>put this code in <code>ThisWorkbook</code> code pane:</p>\n\n<pre><code>Option Explicit\n\nConst STATUSHEADER As String = \"Status\"\nConst NAMESHEADER As String = \"Names\"\n\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    Dim nameValue As String\n    Dim sht As Worksheet\n    Dim sheetNames As Variant\n    Dim firstUpdatedRowIndex As Long '&lt;--| this will store first updated row index  ****\n\n    If Not Proceed(Target) Then Exit Sub\n\n    sheetNames = Array(\"Sheet0001\", \"Sheet0002\", \"Sheet0003\") '&lt;--| fill array with sheets-to-be-searched names\n\n    On Error GoTo EXITSUB\n    Application.EnableEvents = False\n\n    nameValue = GetNameValue(Target) '&lt;--| get value in the \"Names\" column corresponding row\n    For Each sht In Worksheets(sheetNames) '&lt;--| loop through to-be-searched-in sheets\n        If sht.name &lt;&gt; Sh.name Then UpdateSheet sht, nameValue, Target.value, firstUpdatedRowIndex   '****\n    Next sht\n\nEXITSUB:\n    Application.EnableEvents = True\nEnd Sub\n\n\nSub UpdateSheet(sht As Worksheet, nameValue As String, statusValue As Variant, firstUpdatedRowIndex As Long) '****\n    Dim namesCol As Long, statusCol As Long\n    Dim f As Range\n\n    With sht '&lt;--| refer to current to-be-searched-in sheet\n        With .Rows(1).SpecialCells(XlCellType.xlCellTypeConstants) '&lt;--| refer to its 1st row non blank cells range\n            namesCol = FindFirstCell(NAMESHEADER, .Cells).Column '&lt;--| get its \"Names\" column index\n            statusCol = FindFirstCell(STATUSHEADER, .Cells).Column '&lt;--| get its \"Status\" column index\n        End With\n        Set f = FindFirstCell(nameValue, .Columns(namesCol).SpecialCells(XlCellType.xlCellTypeConstants)) '&lt;--| search its \"names\" column for the \"name\" value corresponding to the changed \"Status\" in the originally changed sheet\n        If Not f Is Nothing Then '&lt;--| if any matching cell found in \"Names\" column ...\n            .Cells(f.row, statusCol) = statusValue '&lt;--| update its corresponding \"Status\" column value\n            MsgBox \"record in row \" &amp; f.row &amp; \" has been updated in \" &amp; .name &amp; \" tab\"\n            If firstUpdatedRowIndex = 0 Then firstUpdatedRowIndex = f.row '&lt;--| store first updated row  ****\n        End If\n    End With\nEnd Sub\n\n\nFunction FindFirstCell(value As String, rng As Range) As Range\n    Set FindFirstCell = rng.Find(what:=value, lookat:=xlWhole, LookIn:=xlValues, MatchCase:=True)\nEnd Function\n\n\nFunction GetNameValue(Target As Range) As String\n    With Target.Parent\n        GetNameValue = .Cells(Target.row, FindFirstCell(NAMESHEADER, .Range(.Cells(1, 1), .Cells(1, Target.Column - 1))).Column).value '&lt;--|  search columns preceeding the 'Target' (i.e.: \"Status\") one for the \"Names\" column and get its value at the row corresponding to changed \"Status\" one\n    End With\nEnd Function\n\n\nFunction Proceed(rng As Range) As Boolean\n    Proceed = rng.Cells.Count = 1 '&lt;--| proceed if only one changed cell\n    If Proceed Then Proceed = rng.Offset(-rng.row + 1) = STATUSHEADER '&lt;--| proceed only if the changed cell is a \"Status\" column\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 2398423, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3a4467552c7f52f9eb165c14bf036471?s=128&d=identicon&r=PG", "display_name": "Erin Santos", "link": "https://stackoverflow.com/users/2398423/erin-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "accepted_answer_id": 39240104, "answer_count": 1, "score": 0, "last_activity_date": 1472815043, "creation_date": 1472608148, "question_id": 39239525, "link": "https://stackoverflow.com/questions/39239525/excel-update-multiple-columns-if-a-column-from-one-of-the-worksheet-is-updated", "title": "excel - Update multiple columns if a column from one of the worksheet is updated", "body": "<p>I have multiple sheets and one of the columns in all of the sheet contains a same column (say \"Names\"). In each of the column \"Names\" is a corresponding \"Status\" column. Each \"Names\" column may contain same record from one or more sheets. If one of the record in \"Status\" column is updated, I want to get its corresponding \"Names\" column value, then search all of the sheets, If it also has that same \"Names\" record, I should be able to updates its corresponding \"Status\" value based on the value from the first \"Status\" update.</p>\n\n<p>Now, I was able to search for an answer from the web that is working (see below), the problem is it only works one way. I can update a value from a sheet (say sheet1) and it will be able to update a value from one or more worksheet. But when I tried to update a value from another worksheet (not the sheet1), it returns an error <code>Method \"Find' of object 'Range' failed</code>. </p>\n\n<p>Sample (this should be in each worksheet, with columns, sheet names changed):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\nDim fn2 As Range\n\nIf Not Intersect(Target, Range(\"B:B\")) Is Nothing Then\n    Set fn2 = Sheets(\"Sheet1\").Range(\"D:D\").Find(Target.Offset(, -11).Value, , xlValues, xlWhole)\n    If Not fn2 Is Nothing Then\n        fn2.Offset(, 13) = Target.Value\n        MsgBox \"A record has been updated name_tab tab\"\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Please help. Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1472603438, "post_id": 39238939, "comment_id": 65815137, "body": "curly brackets do not have any place in VBA except for inside a string literal."}, {"owner": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "edited": false, "score": 0, "creation_date": 1472603779, "post_id": 39238939, "comment_id": 65815196, "body": "Is there an equivilent way to achieve the result of using the curly brackets?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1472603883, "post_id": 39238939, "comment_id": 65815223, "body": "I&#39;ve never used the <code>Choose</code> function TBH I have no idea what it does. I&#39;m sure there&#39;s a corollary way to do this in VBA though."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1472604407, "post_id": 39238939, "comment_id": 65815336, "body": "What&#39;s the intended outcome here?  When I try that formula it always returns the lookup value from the second table (even when only the first table has a match) - what&#39;s the array for?"}, {"owner": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1472604591, "post_id": 39238939, "comment_id": 65815372, "body": "Hi @TimWilliams I am attempting to return a value from the left of the <code>VLOOKUP</code> function by using <code>CHOOSE</code>.  See here - <a href=\"https://www.nhaustralia.com.au/blog/choose-function-arrays-excel/\" rel=\"nofollow noreferrer\">nhaustralia.com.au/blog/choose-function-arrays-excel</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472604920, "post_id": 39238939, "comment_id": 65815451, "body": "OK I see - that&#39;s totally new to me..."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1472610524, "post_id": 39238939, "comment_id": 65816583, "body": "@smeapublic, while the <code>CHOOSE</code> technique is interesting, the usual approach where the lookup column is to the left of the index column is to use <code>INDEX(... , MATCH( ... ) )</code>  In your case <code>Application.Index(Table3, Application.Match(cl, Table2, False))</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1472612199, "post_id": 39238939, "comment_id": 65816945, "body": "If nothing else, that would have to be <code>Application.Choose(...)</code> not simply <code>Choose(...)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1472612537, "post_id": 39238939, "comment_id": 65817022, "body": "re: <i>&#39;Given the A column is to the Left H I can&#39;t simply return it using the VLOOKUP function&#39;</i> - Then use an <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow noreferrer\">INDEX</a>/<a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH</a> function pair."}, {"owner": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1472618776, "post_id": 39238939, "comment_id": 65818479, "body": "Upvote for @chrisneilsen - the Index Match was a much better solution.  Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "edited": false, "score": 0, "creation_date": 1472604352, "post_id": 39239078, "comment_id": 65815326, "body": "Thank you for your answer - Why would you reccoment this?"}, {"owner": {"reputation": 1217, "user_id": 2193381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/643fd74e5365aaaf1717eabf643f5162?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/2193381/vishal"}, "reply_to_user": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "edited": false, "score": 0, "creation_date": 1472605013, "post_id": 39239078, "comment_id": 65815466, "body": "You have flexibility to construct complex formulae and string it together this way. The answer that @cyboashu has provided is a better answer to your specific question."}], "tags": [], "owner": {"reputation": 1217, "user_id": 2193381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/643fd74e5365aaaf1717eabf643f5162?s=128&d=identicon&r=PG&f=1", "display_name": "Vishal", "link": "https://stackoverflow.com/users/2193381/vishal"}, "is_accepted": false, "score": 0, "last_activity_date": 1472604089, "creation_date": 1472604089, "answer_id": 39239078, "question_id": 39238939, "link": "https://stackoverflow.com/questions/39238939/use-of-the-character-in-vba/39239078#39239078", "title": "Use of the &#39;{&#39; character in VBA", "body": "<p>I would recommend using <code>Sheet1.Cells(myRow, myCol).Formula = \"=VLOOKUP(...)\"</code> followed by <code>Sheet1.Cells(myRow, myCol).Calculate</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1472604961, "post_id": 39239132, "comment_id": 65815458, "body": "Why the downvote? This is the VBA version of OP&#39;s worksheet formula. It performs as expected, and answers OP&#39;s question."}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "reply_to_user": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "edited": false, "score": 0, "creation_date": 1472605556, "post_id": 39239132, "comment_id": 65815586, "body": "No problem.  Just to be clear, I posted my answer before your first edit, in which you added your code. Otherwise, my answer would have been more specific to your code, as was the answer posted by @cyboashu. Perhaps I should not have responded so quickly."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1472606336, "post_id": 39239132, "comment_id": 65815728, "body": "Yeah... this a valid translation in VBA. Agreed. ++"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "edited": false, "score": 0, "creation_date": 1472610039, "post_id": 39239132, "comment_id": 65816477, "body": "@smeapublic this is closest to the correct answer.  In essence, use <code>Array(1, 2)</code> instead of <code>{1,2}</code>"}], "tags": [], "owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "is_accepted": false, "score": 3, "last_activity_date": 1472604530, "creation_date": 1472604530, "answer_id": 39239132, "question_id": 39238939, "link": "https://stackoverflow.com/questions/39238939/use-of-the-character-in-vba/39239132#39239132", "title": "Use of the &#39;{&#39; character in VBA", "body": "<p>Try the following, which doesn't require modification or recalculation of any cells on the Worksheet:</p>\n\n<pre><code>WorksheetFunction.VLookup(\"EN878\", WorksheetFunction.Choose(Array(1, 2), Range(\"A2:B5\"), Range(\"D2:E5\")), 2, False)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "edited": false, "score": 0, "creation_date": 1472605228, "post_id": 39239151, "comment_id": 65815516, "body": "Thank you for this - However I just want to return the Value in Table3 using the Table2 in the <code>VLOOKUP</code> (<code>Table3</code> is just the (A:A) column of a sheet where <code>Table2</code> is the (H:H) column of the same sheet).  Given the A column is to the Left H I can&#39;t simply return it using the <code>VLOOKUP</code> function"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1472609879, "post_id": 39239151, "comment_id": 65816442, "body": "@cyboashu This answer is just plan wrong.  I suggest you delete it"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 2, "last_activity_date": 1472611045, "last_edit_date": 1472611045, "creation_date": 1472604656, "answer_id": 39239151, "question_id": 39238939, "link": "https://stackoverflow.com/questions/39238939/use-of-the-character-in-vba/39239151#39239151", "title": "Use of the &#39;{&#39; character in VBA", "body": "<p>If you are trying to decide which table to use as Vlookup array you can use <code>IIf</code> function. \nLike:</p>\n\n<pre><code>Application.WorksheetFunction.VLookup(cl, IIf(cl.column=1, Table2, Table3), 2, False)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "edited": false, "score": 0, "creation_date": 1472611328, "post_id": 39239326, "comment_id": 65816762, "body": "Very close; I would expect the output but the <code>F</code> column in the left and the <code>A</code> column on the right"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "edited": false, "score": 0, "creation_date": 1472615304, "post_id": 39239326, "comment_id": 65817627, "body": "If I use that same formula on the worksheet (as an array) I get the same A:F output"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "edited": false, "score": 0, "creation_date": 1472615708, "post_id": 39239326, "comment_id": 65817710, "body": "Never mind - I missed that your VBA example uses single-column ranges..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1472606323, "creation_date": 1472606323, "answer_id": 39239326, "question_id": 39238939, "link": "https://stackoverflow.com/questions/39238939/use-of-the-character-in-vba/39239326#39239326", "title": "Use of the &#39;{&#39; character in VBA", "body": "<p>Not an answer but what the OP is doing is not as simple as it appears.</p>\n\n<p>Given this data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tDIfs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tDIfs.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this code:</p>\n\n<pre><code>Sub Tester()\n\n    Dim r\n\n    r = Application.Evaluate(\"CHOOSE({1,2},A1:B5,E1:F5)\")\n\n    Dumper r\n\nEnd Sub\n\n\nSub Dumper(arr)\nDim r, c, s, v\n    For r = 1 To UBound(arr, 1)\n        s = \"\"\n        For c = 1 To UBound(arr, 2)\n            v = arr(r, c)\n            s = s &amp; vbTab &amp; IIf(IsError(v), \"Err!\", v)\n        Next c\n        Debug.Print s\n    Next r\nEnd Sub\n</code></pre>\n\n<p>Here's the output:</p>\n\n<pre><code>A1  F1\nA2  F2\nA3  F3\nA4  F4\nA5  F5\n</code></pre>\n\n<p>Is that what you'd expect ?</p>\n"}, {"tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1472607551, "creation_date": 1472607551, "answer_id": 39239452, "question_id": 39238939, "link": "https://stackoverflow.com/questions/39238939/use-of-the-character-in-vba/39239452#39239452", "title": "Use of the &#39;{&#39; character in VBA", "body": "<p>I would use <code>range.formulaR1C1</code> property.</p>\n\n<pre><code>Table3AddressR1C1 = Workbooks(\"gangstar.xlsx\").Worksheets(\"60 in August 2016-26082016-1137\").Range(\"A1:A1000\").address(,,xlR1C1, true)\nTable2AddressR1C1 = Workbooks(\"gangstar.xlsx\").Worksheets(\"60 in August 2016-26082016-1137\").Range(\"H1:H1000\").address(,,xlR1C1, true)\n\nSheet1.Range(Cells(1, Dept_Clm), Cells(Table1.rows.count, Dept_Clm)).FormulaR1C1 = \"=VLookup(RxCx, Choose({1,2}, Table2AddressR1C1, Table3AddressR1C1), 2, False)\"\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6776576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870506216434a2d131d62e6be628db3?s=128&d=identicon&r=PG&f=1", "display_name": "smea public", "link": "https://stackoverflow.com/users/6776576/smea-public"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2621, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1472611045, "creation_date": 1472602856, "last_edit_date": 1472603817, "question_id": 39238939, "link": "https://stackoverflow.com/questions/39238939/use-of-the-character-in-vba", "title": "Use of the &#39;{&#39; character in VBA", "body": "<p>I am trying to write a similar function in VBA:</p>\n\n<pre><code>=VLOOKUP(\u201cEN878\u201d,CHOOSE({1,2},A2:B5,D2:E5),2,False)\n</code></pre>\n\n<p>In particular, <strong>What is the correct way of using the <code>{}</code> character</strong> in VBA?</p>\n\n<p>Every time I try, I get <em>\"Compile error: Invalid Character\"</em></p>\n\n<p>My code:</p>\n\n<p><strong>Variables</strong></p>\n\n<pre><code>Table3 = Workbooks(\"gangstar.xlsx\").Worksheets(\"60 in August 2016-26082016-1137\").Range(\"A1:A1000\")\nTable2 = Workbooks(\"gangstar.xlsx\").Worksheets(\"60 in August 2016-26082016-1137\").Range(\"H1:H1000\")\n\nFor Each cl In Table1\n  Sheet1.Cells(Dept_Row, Dept_Clm) = Application.WorksheetFunction.VLookup(cl, Choose({1,2}, Table2, Table3), 2, False)\n  Dept_Row = Dept_Row + 1\nNext cl\n</code></pre>\n\n<p>I am able to use the <code>VLOOKUP</code> with <code>CHOOSE</code> fine in the Excel spreadsheet.    </p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472606812, "post_id": 39238493, "comment_id": 65815828, "body": "Is &quot;Pessoal&quot; on the ActiveSheet, or is it on Sheet18?  (Sheet18 is not necessarily the active sheet when you are executing the line which says <code>ActiveSheet.ListObjects(&quot;Pessoal&quot;).ListRows.Add (last_row_with_data)</code>)  If it is on Sheet18 change <code>ActiveSheet.</code> to <code>.</code>."}, {"owner": {"reputation": 11, "user_id": 6715838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72954039c5a1a78b68c459505c820f9?s=128&d=identicon&r=PG&f=1", "display_name": "SaM", "link": "https://stackoverflow.com/users/6715838/sam"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472766644, "post_id": 39238493, "comment_id": 65897231, "body": "&quot;Pessoal&quot; is on the Sheet18."}, {"owner": {"reputation": 11, "user_id": 6715838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72954039c5a1a78b68c459505c820f9?s=128&d=identicon&r=PG&f=1", "display_name": "SaM", "link": "https://stackoverflow.com/users/6715838/sam"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472766675, "post_id": 39238493, "comment_id": 65897240, "body": "I<code>ve just changed but it doesn</code>t work too."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472767758, "post_id": 39238493, "comment_id": 65897631, "body": "(a) What is the value of <code>last_row_with_data</code> when it crashes?  (b) Is <code>Sheet18</code> the sheet with the name &quot;Sheet18&quot; and, if not, is <code>Sheet18</code> the sheet you are really trying to access, or is <code>Worksheets(&quot;Sheet18&quot;)</code> the one you want?  (The sheet number and the sheet name are not necessarily linked - I often seem to end up with <code>Sheet1</code> having the name &quot;Sheet2&quot; and <code>Sheet2</code> having the name &quot;Sheet1&quot;.)"}, {"owner": {"reputation": 11, "user_id": 6715838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72954039c5a1a78b68c459505c820f9?s=128&d=identicon&r=PG&f=1", "display_name": "SaM", "link": "https://stackoverflow.com/users/6715838/sam"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472776862, "post_id": 39238493, "comment_id": 65899934, "body": "Ok, it works. Thank you very much. And how can I mantain the formulas, as  the row before."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472781221, "post_id": 39238493, "comment_id": 65900867, "body": "If &quot;Pessoal&quot; is an Excel table, I thought it automatically copied the formulas when you did a ListRows.Add.  But never having used Excel tables, I&#39;m probably not the best person to assist in answering that question."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 11, "user_id": 6715838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72954039c5a1a78b68c459505c820f9?s=128&d=identicon&r=PG&f=1", "display_name": "SaM", "link": "https://stackoverflow.com/users/6715838/sam"}, "edited": false, "score": 0, "creation_date": 1472799833, "post_id": 39239307, "comment_id": 65906462, "body": "If <code>Sheet18</code> is a valid worksheet reference and <i>&quot;Pessoal&quot;</i> is a valid name of a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197604.aspx\" rel=\"nofollow noreferrer\">ListObject</a> in that sheet then it <i>does</i> work, i.e. it adds a new row just before <i>Pessoal</i> table  last one. You may want to check it and let me know"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1472606090, "creation_date": 1472606090, "answer_id": 39239307, "question_id": 39238493, "link": "https://stackoverflow.com/questions/39238493/add-row-in-a-table-and-mantain-formulas/39239307#39239307", "title": "Add row in a table and mantain formulas", "body": "<p>Try this</p>\n\n<pre><code>With Sheet18.ListObjects(\"Pessoal\").ListRows\n    .Add(.Count)\nEnd With`\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6715838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b72954039c5a1a78b68c459505c820f9?s=128&d=identicon&r=PG&f=1", "display_name": "SaM", "link": "https://stackoverflow.com/users/6715838/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472606090, "creation_date": 1472599207, "last_edit_date": 1531164843, "question_id": 39238493, "link": "https://stackoverflow.com/questions/39238493/add-row-in-a-table-and-mantain-formulas", "title": "Add row in a table and mantain formulas", "body": "<p>I would like add the last but one row in few tables and mantain formulas (copy the formula - for example in the row before - and past on the blank row). \nThe first step (add the last but one row) doesn`t work. \nSomeone can help me, please?</p>\n\n<p>The code is:</p>\n\n<pre><code>`Sheet18.Activate\nWith Sheet18\nlast_row_with_data = .Range(\"A65536\").End(xlUp).Row\nlast_row_with_data = last_row_with_data - 1\nActiveSheet.ListObjects(\"Pessoal\").ListRows.Add (last_row_with_data)\nEnd With`\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1472597708, "post_id": 39238247, "comment_id": 65813696, "body": "Replace all of the multiple spaces with a single space before using Split."}, {"owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1472598213, "post_id": 39238247, "comment_id": 65813872, "body": "the problem is that i dont know how many multiple spaces there are...  so  <code>newText = Replace(NewTextLine, &quot;    &quot;, &quot; &quot;) </code>  doesnt work cause i dont know the number of spaces to find"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1472598899, "post_id": 39238247, "comment_id": 65814073, "body": "Replace any double spaces with single space until there are no more double spaces in the string.  <code>Do While Instr(NewTextLine, &quot;  &quot;)&gt;0:NewTextLine=Replace(NewTextLine,&quot;  &quot;,&quot; &quot;):Loop</code>"}, {"owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472599571, "post_id": 39238247, "comment_id": 65814260, "body": "But this way could be very slowly, considerazione that in the file i Will have manu lines"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1472600280, "post_id": 39238247, "comment_id": 65814414, "body": "Are you asking for a solution to the problem, or an argument about a performance impact that you don&#39;t know will happen?"}, {"owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472600592, "post_id": 39238247, "comment_id": 65814497, "body": "I ask for a solution but i have to consider the execution time too.  I&#39;m thinking about regular espression"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1472606081, "post_id": 39238247, "comment_id": 65815670, "body": "Is that the actual data?  That looks suspiciously like fixed width to me if it has 5 columns.  How else do you tell the which element <code>21,45</code> or <code>39,87</code> belong to?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472610290, "post_id": 39238247, "comment_id": 65816527, "body": "I&#39;d agree with @Comintern, <code>21,45</code> and <code>39,87</code> would seem to be different columns. Perhaps DR and CR?"}, {"owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472622775, "post_id": 39238247, "comment_id": 65819915, "body": "Yes they are differenti colums"}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1472626735, "post_id": 39238247, "comment_id": 65821892, "body": "Edited OP&#39;s post for clarity."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1472670854, "post_id": 39238247, "comment_id": 65850619, "body": "Use <code>Workbooks.OpenText</code> with fixed width and then read the range into an array - much easier."}], "answers": [{"comments": [{"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1472608973, "post_id": 39239587, "comment_id": 65816256, "body": "I was assuming your data is four columns with varying amounts of whitespace surrounding the third.  If it&#39;s actually 5 columns, then @Comintern has a pretty good point."}, {"owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472622932, "post_id": 39239587, "comment_id": 65819976, "body": "Infact there is the problema that there are 5 columns"}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "reply_to_user": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472623026, "post_id": 39239587, "comment_id": 65820010, "body": "Then, as @Comintern asked, how do you tell which column the data belongs to?"}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "reply_to_user": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472625964, "post_id": 39239587, "comment_id": 65821415, "body": "Never mind, obviously the way you can tell is by where the data appears on the line (I was still thinking in terms of replacing spaces).  Please see my revised answer."}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "reply_to_user": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472626741, "post_id": 39239587, "comment_id": 65821896, "body": "Edited OP&#39;s post for clarity."}, {"owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472669729, "post_id": 39239587, "comment_id": 65849970, "body": "Hi , i tried your code , it&#39;s works just if you know how many spaces there are between the strings. The problem is that i download the file text and i have to populate with that information an access&#39; table. But the spaces between the second and the third items is variable , cause it depends from how many characters is made the number  <code>03&#47;08&#47;2016    03&#47;08&#47;2016          1,00                    COMMISS. BOLLETTINO</code>  <code>03&#47;08&#47;2016    03&#47;08&#47;2016        248,89                    ADDEBITO</code>"}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "reply_to_user": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472670265, "post_id": 39239587, "comment_id": 65850292, "body": "Then, please update your question so as to provide <b><i>several</i></b> lines of your data with different examples of this. In your original two-line example, the spacing appears constant, not variable. Additionally, now we are back to the question of how do you tell which column the data belongs to?"}, {"owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472671724, "post_id": 39239587, "comment_id": 65851091, "body": "I updated the code , but i make this question: it&#39;s possible with regex expression to locate the first space after a string?"}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "reply_to_user": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472672304, "post_id": 39239587, "comment_id": 65851393, "body": "Yes, you can use something like this: <code>\\w+(\\s)</code>. Regarding your update, all of your data still appears to be fixed-width, so the numbers for my code&#39;s <code>Mid</code> functions may need some adjustment, but it should still work.  Also, what are &quot;COMMISS. BOLLETTINO&quot; and &quot;ADDEBITO BOLLETTINO&quot;? They contain spaces, so are they supposed to be two columns, or just one?"}, {"owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472672684, "post_id": 39239587, "comment_id": 65851553, "body": "yes , i&#39;m trying to adjust your code, but the problem are the numbers, i cannot foresee if there is  10000.69 or 2.48 or 10000000.69 cause i noticed that some spaces between the second, the third , and fourth fields are deleted by the numbers, how you can see in the forth row of my example. I think the key is find the first space after the string , substituite with a : and then split. Unfortunally in the last field there are spaces..."}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "reply_to_user": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472673489, "post_id": 39239587, "comment_id": 65851965, "body": "I&#39;ve already adjusted the numbers based on your updated sample data, and have updated my answer accordingly.  You didn&#39;t answer my &quot;two columns, or just one&quot; question, so I assumed &quot;just one&quot;."}, {"owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "edited": false, "score": 0, "creation_date": 1472674207, "post_id": 39239587, "comment_id": 65852364, "body": "Yes the last filed is one column but with spaces inside the text"}], "tags": [], "owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "is_accepted": false, "score": 1, "last_activity_date": 1472673214, "last_edit_date": 1472673214, "creation_date": 1472608707, "answer_id": 39239587, "question_id": 39238247, "link": "https://stackoverflow.com/questions/39238247/vba-access-read-textfile-delimited-by-spaces/39239587#39239587", "title": "VBA Access read TextFile delimited by spaces", "body": "<p>Since your data consists of 5 columns, my original code for replacing the spaces (when I thought it was 4 columns) will not work. Try this:</p>\n\n<pre><code>Public Function GetArray2(pstrExpression As Variant)\n  Dim data(4) As String\n\n  data(0) = Trim(Mid(pstrExpression, 1, 14))\n  data(1) = Trim(Mid(pstrExpression, 13, 20))\n  data(2) = Trim(Mid(pstrExpression, 33, 13))\n  data(3) = Trim(Mid(pstrExpression, 46, 13))\n  data(4) = Trim(Mid(pstrExpression, 59, 20))\n\n  GetArray2 = data\nEnd Function\n</code></pre>\n\n<p><br>\nTest method:</p>\n\n<pre><code>Public Sub TestGetArray2()\n  Dim item As Integer\n  Dim data As Variant\n  Dim dataLines As Variant\n  Dim lineItem As Variant\n\n  dataLines = Array(\"16/08/2016    16/08/2016                           6,52   ACCREDITO\", _\n                    \"09/08/2016    09/08/2016                         206,73   ACCREDITO\", _\n                    \"03/08/2016    03/08/2016          1,00                    COMMISS. BOLLETTINO\", _\n                    \"03/08/2016    03/08/2016        248,89                    ADDEBITO BOLLETTINO\")\n\n  For Each lineItem In dataLines\n    Debug.Print\n\n    data = GetArray2(CStr(lineItem))\n\n    For item = 0 To UBound(data)\n      Debug.Print \"Item\" &amp; item &amp; \": \" &amp; data(item)\n    Next item\n  Next lineItem\n End Sub\n</code></pre>\n\n<p><br>\nOutput:</p>\n\n<pre><code>Item0: 16/08/2016\nItem1: 16/08/2016\nItem2: \nItem3: 6,52\nItem4: ACCREDITO\n\nItem0: 09/08/2016\nItem1: 09/08/2016\nItem2: \nItem3: 206,73\nItem4: ACCREDITO\n\nItem0: 03/08/2016\nItem1: 03/08/2016\nItem2: 1,00\nItem3: \nItem4: COMMISS. BOLLETTINO\n\nItem0: 03/08/2016\nItem1: 03/08/2016\nItem2: 248,89\nItem3: \nItem4: ADDEBITO BOLLETTINO\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 2586781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46d8a330e56dcfcde8a100e3a81af17a?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/2586781/andrea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472673214, "creation_date": 1472597363, "last_edit_date": 1472670683, "question_id": 39238247, "link": "https://stackoverflow.com/questions/39238247/vba-access-read-textfile-delimited-by-spaces", "title": "VBA Access read TextFile delimited by spaces", "body": "<p>I have a textfile with fixed-width strings delimited by spaces. Each row in the file represents a row of data, and each row of data consists of 5 columns.\nexample:</p>\n\n<p><code>\n16/08/2016    16/08/2016                           6,52   ACCREDITO\n09/08/2016    09/08/2016                         206,73   ACCREDITO\n03/08/2016    03/08/2016          1,00                    COMMISS. BOLLETTINO \n03/08/2016    03/08/2016        248,89                    ADDEBITO BOLLETTINO\n</code></p>\n\n<p>i tried to do this</p>\n\n<pre><code>Open \"d:\\Users\\Desktop\\q.txt\" For Input As #1\nDim i As Integer\ni = 0\nDo Until EOF(1)\n    Line Input #1, NewTextLine  \n    WrdArray() = Split(NewTextLine, \" \")\nLoop\nClose #1\n</code></pre>\n\n<p>The problem is that the delimiter in split function is fixed \" \" but the spaces that separate the strings are not fixed so the array WrdArray contains spaces too, and i dont need spases, i would that my array contains</p>\n\n<pre><code>First Line:\n    WrdArray(0)----&gt;09/05/2016\n    WrdArray(1)----&gt;11/05/2016\n    WrdArray(2)----&gt;21,45\n    WrdArray(3)----&gt;0,00\n    WrdArray(4)----&gt;descrizione\nSecond Line\n    WrdArray(0)----&gt;09/05/2016\n    WrdArray(1)----&gt;11/05/2016\n    WrdArray(2)----&gt;0,00\n    WrdArray(3)----&gt;39,87\n    WrdArray(4)----&gt;descrizione\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink", "macros"], "answers": [{"comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1472599087, "post_id": 39238397, "comment_id": 65814131, "body": "@Thomas2016 you might need to add this too <code>h.TextToDisplay = Replace(h.TextToDisplay, &quot;\\NSH-HDRIVES1\\&quot;, &quot;F:\\Procurement\\&quot;)</code>"}, {"owner": {"reputation": 25, "user_id": 5900357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2067969dee308cc9162bae06bfafcfc3?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas2016", "link": "https://stackoverflow.com/users/5900357/thomas2016"}, "edited": false, "score": 0, "creation_date": 1472599360, "post_id": 39238397, "comment_id": 65814206, "body": "Brilliant, I have a master sheet that I can divy up, so its all fixed up now."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1472599332, "last_edit_date": 1472599332, "creation_date": 1472598481, "answer_id": 39238397, "question_id": 39238101, "link": "https://stackoverflow.com/questions/39238101/modify-range-of-hyperlinks-in-excel/39238397#39238397", "title": "Modify range of Hyperlinks in Excel", "body": "<p>The following code may help, but it is set up to only work on the ActiveSheet.  If your hyperlinks are in multiple workbooks and multiple worksheets you will need to loop through them all.</p>\n\n<pre><code>For Each h In ActiveSheet.Hyperlinks\n    h.Address = Replace(h.Address, \"\\NSH-HDRIVES1\\\", \"F:\\Procurement\\\")\n    h.TextToDisplay = Replace(h.TextToDisplay, \"\\NSH-HDRIVES1\\\", \"F:\\Procurement\\\")\nNext\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5900357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2067969dee308cc9162bae06bfafcfc3?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas2016", "link": "https://stackoverflow.com/users/5900357/thomas2016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1803, "favorite_count": 0, "accepted_answer_id": 39238397, "answer_count": 1, "score": 0, "last_activity_date": 1472599332, "creation_date": 1472596385, "question_id": 39238101, "link": "https://stackoverflow.com/questions/39238101/modify-range-of-hyperlinks-in-excel", "title": "Modify range of Hyperlinks in Excel", "body": "<p>So, I have a spreadsheet that I have sent out to several of our staff asking to update certain fields/columns. I have a Document Link field (Column G) which links them a folder in our F: Drive which they can use to help populate the necessary fields.</p>\n\n<p>The spreadsheets which I want them to complete are also in this F:Drive. However, I noticed each of the document links no longer work, and when I check the link under Edit Hyperlink, I notice instead of the desired \"*F:\\Procurement...\" I have my home drive \"+\\NSH-HDRIVES1...\" as the header,</p>\n\n<ul>\n<li><p>F:\\Procurement\\Contracts\\Alco...xxx...</p></li>\n<li><p>\\NSH-HDRIVES1\\Contracts\\Alco...xxx...</p></li>\n</ul>\n\n<p>I have hundreds of these lines with document links that need \"\\NSH-HDRIVES1\" replaced with \"F:\". </p>\n\n<p>Is there some kind of VBA Macro that will let me do this? I have little experience and time to learn VBA Macros at this point so any help would be greatly appreciated. Note each link is different and goes to a different folder within our F:Drive, all I need is to change the prefix. </p>\n\n<p>Thanks and sorry for any duplication.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1472595857, "post_id": 39237893, "comment_id": 65813121, "body": "Here is the macro"}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1472597397, "post_id": 39237893, "comment_id": 65813604, "body": "When you say &quot;does not work&quot;, what do you mean exactly? Is an error returned, or is the MsgBox not being displayed when it should be, or being displayed when it shouldn&#39;t be, or is something else happening? Also, how does the &quot;test sheet&quot; differ from &quot;this sheet&quot;?"}, {"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "reply_to_user": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1472597848, "post_id": 39237893, "comment_id": 65813748, "body": "Thanks for your questions. The test sheet starts at row 2. The error I receive is, &quot;Run Time Error 91 Object variable or with block variable not set&quot;  And when I hit Debug, the following line is highlighted      lngLastRow = .Range(&quot;B5000&quot;).End(xlUp).Row"}, {"owner": {"reputation": 2221, "user_id": 6765643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e845f9ead31a78b0ffad2273ef46965?s=128&d=identicon&r=PG", "display_name": "MJH", "link": "https://stackoverflow.com/users/6765643/mjh"}, "edited": false, "score": 0, "creation_date": 1472598841, "post_id": 39237893, "comment_id": 65814060, "body": "So when the error occurs, what is <code>wsCurr</code> referencing at that point? Perhaps it was not set in the preceding <code>For</code> loop, e.g. because no &quot;Current&quot; sheet exists."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472599143, "post_id": 39237893, "comment_id": 65814147, "body": "It sounds like you don&#39;t have a worksheet that contains &quot;Current&quot; as the first 7 characters of the worksheet name.  Check whether one does exist, that there are no typos in the name (e.g. &quot;Curent&quot;) and no case differences (e.g. &quot;current&quot;).  It may be an idea to include (for testing purposes) a <code>MsgBox ws.Name &amp; &quot; found&quot;</code> just before <code>Set wsCurr = ws</code>."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1472603835, "post_id": 39237893, "comment_id": 65815215, "body": "Consider using Excel <a href=\"http://superuser.com/questions/536862/data-validation-require-nearby-cell-not-be-blank\">Data Validation</a> with formulas so that it will work even if macros are disabled."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1472667680, "post_id": 39238678, "comment_id": 65848781, "body": "Thank you so much. The end of a long day and I did not remember I still had the worksheet title there. Thank you, this solution works great."}, {"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1472679210, "post_id": 39238678, "comment_id": 65854706, "body": "A few things. First of all, thank you. This does mostly work. However, it always generates the message. &quot;First and Last Name, or HCO, must be populated but not both.&quot; If there is data in column E, this message is generated regardless of contents of B, C, or D. Also, I would prefer this check to start at row 19. Do you have any suggestions? I hate to take up so much of your time."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1472681005, "post_id": 39238678, "comment_id": 65855367, "body": "Firstly, if you want to start your checks at row 19, change <code>For lngRow = 2 To lngLastRow</code> to <code>For lngRow = 19 To lngLastRow</code>.  Secondly, the <code>&quot;First and Last Name, or HCO, must be populated but not both.&quot;</code> message should only be displayed if column B and D both contain something, or if column B and D are both empty.  But if B is empty and D is populated, or D is populated and B is empty, then it shouldn&#39;t be appearing.  Place a breakpoint on the <code>MsgBox</code> line which is generating that message and then have a look at the value of <code>.Cells(lngRow, 2)</code> and <code>.Cells(lngRow, 4)</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1472681781, "post_id": 39238678, "comment_id": 65855680, "body": "@MatthewIngle - I have updated the answer to include the row number causing the error in the error message (i.e. started the messages in the MsgBox statements with <code>&quot;Row &quot; &amp; lngRow &amp; &quot; - </code>).  Modify your code the same way so that you can tell easily which row is generating the error.  It may be generating the error because your data has a space in a cell (test will fail because &quot; &quot; &lt;&gt; &quot;&quot;) or something equally non-obvious.  (If it is a space, we can easily amend the code to <code>Trim</code> the values before using them in the test.)"}, {"owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "edited": false, "score": 0, "creation_date": 1472683314, "post_id": 39238678, "comment_id": 65856171, "body": "Again, thank you. This worked very well. You must be right and I had an errant value in the row."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1472681461, "last_edit_date": 1472681461, "creation_date": 1472600648, "answer_id": 39238678, "question_id": 39237893, "link": "https://stackoverflow.com/questions/39237893/excel-vba-columns-b-and-c-or-column-d-required/39238678#39238678", "title": "Excel VBA Columns B and C OR Column D required", "body": "<p>Once you get past whatever is causing the error trying to access wsCurr (which I suspect is just a case of the worksheet not existing), you should modify your code as follows:</p>\n\n<pre><code>With wsCurr\n    lngLastRow = .Range(\"E5000\").End(xlUp).Row\n    For lngRow = 2 To lngLastRow\n        'First check whether first/last name has been consistently advised\n        If (.Cells(lngRow, 2) = \"\") &lt;&gt; _\n           (.Cells(lngRow, 3) = \"\") Then\n            MsgBox \"Row \" &amp; lngRow &amp; \" - First Name and Last Name must both be advised or both be blank\"\n            Cancel = True  ' I assume this is a global variable?\n            Exit Sub\n        End If\n\n        'Now check that last name has not been advised if HCO has been, and vice-versa\n        If (.Cells(lngRow, 2) = \"\") = _\n           (.Cells(lngRow, 4) = \"\") Then\n            MsgBox \"Row \" &amp; lngRow &amp; \" - First and Last Name, or HCO, must be populated but not both.\"\n            Cancel = True\n            Exit Sub\n        End If\n    Next\nEnd With\n</code></pre>\n\n<p>This will get around the existing problem with your tests, which (as far as I can tell) aren't allowing for the case where all three columns have been advised.</p>\n\n<p>I also changed the column on which lngLastRow was being set because, if it is set based on column B and the last row(s) of your data only contained values in column C and/or D, those final row(s) would not be being tested.</p>\n"}], "owner": {"reputation": 117, "user_id": 4682681, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/tKFRF.jpg?s=128&g=1", "display_name": "Matthew Ingle", "link": "https://stackoverflow.com/users/4682681/matthew-ingle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 1, "accepted_answer_id": 39238678, "answer_count": 1, "score": 0, "last_activity_date": 1472681461, "creation_date": 1472595236, "last_edit_date": 1531161705, "question_id": 39237893, "link": "https://stackoverflow.com/questions/39237893/excel-vba-columns-b-and-c-or-column-d-required", "title": "Excel VBA Columns B and C OR Column D required", "body": "<p>I have a spreadsheet which is used enterprise-wide. I am trying to put in checks such that certain fields are required. Specifically, columns B (last name) AND C (first name) are required, OR Column D (Organization) is required. However, B, C, and D cannot all three be filled in. If the row has any data at all in it, B and C or D are required.</p>\n\n<p>My idea is to put in a button to run this macro. That I can do.</p>\n\n<p>I've tried many things at this point. I can include the spreadsheet in case anyone can offer any insight. I had a macro that worked on a test sheet, but does not work on this sheet, if that will help at all.\nHere is the macro</p>\n\n<pre><code>Sub CheckVal2()\nDim ws As Worksheet\nDim wsCurr As Worksheet\nDim cel As Range\nDim lngLastRow As Long\nDim lngRow As Long\n\nFor Each ws In Worksheets\n    If Left$(ws.Name, 7) = \"Current\" Then\n        Set wsCurr = ws\n        Exit For\n    End If\nNext\n\nWith wsCurr\n    lngLastRow = .Range(\"B5000\").End(xlUp).Row\n    For lngRow = 2 To lngLastRow\n        For Each cel In .Range(\"B\" &amp; lngRow &amp; \":E\" &amp; lngRow)\n        If cel = \"\" Then\n        MsgBox \"First and Last Name or HCO must be populated.\"\n        Cancel = True\n        Exit Sub\n        End If\n\n            If cel &lt;&gt; \"\" Then\n               If .Cells(lngRow, \"D\") = \"\" Then\n                    If .Cells(lngRow, \"B\") = \"\" Or _\n                    .Cells(lngRow, \"C\") = \"\" Then\n                    MsgBox \"First and Last Name or HCO must be populated.\"\n                    Cancel = True\n                    Exit Sub\n                        End If\n                    End If\n                End If\n\n\n        Next\n    Next\nEnd With\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472593453, "post_id": 39237404, "comment_id": 65812271, "body": "It&#39;s not clear why the code to copy the headers is in the loop.  Are they the same on all 8 worksheets?"}, {"owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1472593908, "post_id": 39237404, "comment_id": 65812463, "body": "Yes, they&#39;re the exact same on all worksheets. All the other worksheets use the same headers but they just have different training information and it feeds up to the master sheet. I&#39;m trying to test out this macro and I&#39;m running into some issues with spacing as well so I guess I&#39;ll have to do some thorough testing before piloting it."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "edited": false, "score": 0, "creation_date": 1472595351, "post_id": 39237743, "comment_id": 65812953, "body": "It was already copying over the contents of the headers but it wouldn&#39;t carry over the proper formatting wrapping text or filters on the headers. Do you think it has something to do with the fact that my code deletes the &quot;Master Sheet&quot; and recreates it every time the code is ran? I&#39;m not sure how to adjust it to just update the &quot;Master Sheet&#39; starting from A2. Also the code is putting like 5 spaces between each sheet&#39;s data."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1472594376, "creation_date": 1472594376, "answer_id": 39237743, "question_id": 39237404, "link": "https://stackoverflow.com/questions/39237404/macro-to-copy-header-formatting/39237743#39237743", "title": "Macro to Copy Header Formatting", "body": "<p>If all the headers are the same, just copy them on your first trip through the loop:</p>\n\n<pre><code>StartRow = 1\n\nFor Each sh In ActiveWorkbook.Worksheets\n    If sh.Name &lt;&gt; DestSh.Name Then\n        Last = LastRow(DestSh)\n        shLast = LastRow(sh)\n        If shLast &gt; 0 And shLast &gt;= StartRow Then\n            Set CopyRng = sh.Range(sh.Rows(StartRow), sh.Rows(shLast))\n            If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                MsgBox \"There are not enough rows in the Destsh\"\n                GoTo ExitTheSub\n            End If\n\n            CopyRng.Copy\n            With DestSh.Cells(Last + 1, \"A\")\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n            If StartRow = 1 Then StartRow = 2\n        End If\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1472594376, "creation_date": 1472592733, "last_edit_date": 1472594220, "question_id": 39237404, "link": "https://stackoverflow.com/questions/39237404/macro-to-copy-header-formatting", "title": "Macro to Copy Header Formatting", "body": "<p>I have an excel file that has 8 region's training information and I have a macro setup that will compile all 8 sheets into a master sheet that I can use to Pivot.</p>\n\n<p>Everything works fine except I can't get it to properly format the master sheet properly.</p>\n\n<p>The code for the copying of the headers:</p>\n\n<pre><code>    If WorksheetFunction.CountA(DestSh.UsedRange) = 0 Then\n      sh.Range(\"A1:Z1\").Copy DestSh.Range(\"A1\")\n    End If\n</code></pre>\n\n<p>I need wrapping of text on all columns and to have a filter on them. </p>\n\n<p>Entire code:</p>\n\n<pre><code>Select Code  copy to clipboard\nSub CopyDataWithHeaders()\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim shLast As Long\n    Dim CopyRng As Range\n    Dim StartRow As Long\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Delete the sheet \"Master Sheet\" if it exist\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.Worksheets(\"Master Sheet\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    'Add a worksheet with the name \"Master Sheet\"\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"Master Sheet\"\n\n    'Fill in the start row\n    StartRow = 2\n\n    'loop through all worksheets and copy the data to the DestSh\n    For Each sh In ActiveWorkbook.Worksheets\n        If sh.Name &lt;&gt; DestSh.Name Then\n\n    'Copy header row, change the range if you use more columns\n    If WorksheetFunction.CountA(DestSh.UsedRange) = 0 Then\n      sh.Range(\"A1:Z1\").Copy DestSh.Range(\"A1\")\n    End If\n\n            'Find the last row with data on the DestSh and sh\n            Last = LastRow(DestSh)\n            shLast = LastRow(sh)\n\n            'If sh is not empty and if the last row &gt;= StartRow copy the CopyRng\n            If shLast &gt; 0 And shLast &gt;= StartRow Then\n\n                'Set the range that you want to copy\n                Set CopyRng = sh.Range(sh.Rows(StartRow), sh.Rows(shLast))\n\n                'Test if there enough rows in the DestSh to copy all the data\n                If Last + CopyRng.Rows.Count &gt; DestSh.Rows.Count Then\n                    MsgBox \"There are not enough rows in the Destsh\"\n                    GoTo ExitTheSub\n                End If\n\n                'This example copies values/formats, if you only want to copy the\n                'values or want to copy everything look below example 1 on this page\n                CopyRng.Copy\n                With DestSh.Cells(Last + 1, \"A\")\n                    .PasteSpecial xlPasteValues\n                    .PasteSpecial xlPasteFormats\n                    Application.CutCopyMode = False\n                End With\n\n            End If\n\n        End If\n    Next\n\nExitTheSub:\n\n    Application.Goto DestSh.Cells(1)\n\n    'AutoFit the column width in the DestSh sheet\n    DestSh.Columns.AutoFit\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            Lookat:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>Any ideas on what I need to add to this code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1472592011, "post_id": 39237222, "comment_id": 65811691, "body": "Have you tried anything? Recording a macro and viewing/editing the generated code?"}, {"owner": {"reputation": 13, "user_id": 6776222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b1a50a67db8b2a8afc3a3672df0f8a?s=128&d=identicon&r=PG&f=1", "display_name": "K.Caller", "link": "https://stackoverflow.com/users/6776222/k-caller"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1472592118, "post_id": 39237222, "comment_id": 65811740, "body": "I was thinking of doing this but I&#39;m not to sure how that would work."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1472592173, "post_id": 39237222, "comment_id": 65811766, "body": "Well, until you&#39;re stuck on a <i>specific</i> programming issue, this site can&#39;t help you. Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6776222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b1a50a67db8b2a8afc3a3672df0f8a?s=128&d=identicon&r=PG&f=1", "display_name": "K.Caller", "link": "https://stackoverflow.com/users/6776222/k-caller"}, "edited": false, "score": 0, "creation_date": 1472593029, "post_id": 39237413, "comment_id": 65812110, "body": "Yes thank you i was working on something like this but as this is at work i was unable to see it. I know now where i went wrong i was missing the vb at the start of the day thank you once again"}, {"owner": {"reputation": 26, "user_id": 6771089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a8870261666859e943ef37acbf7c4d4?s=128&d=identicon&r=PG&f=1", "display_name": "oscar", "link": "https://stackoverflow.com/users/6771089/oscar"}, "reply_to_user": {"reputation": 13, "user_id": 6776222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b1a50a67db8b2a8afc3a3672df0f8a?s=128&d=identicon&r=PG&f=1", "display_name": "K.Caller", "link": "https://stackoverflow.com/users/6776222/k-caller"}, "edited": false, "score": 0, "creation_date": 1472593176, "post_id": 39237413, "comment_id": 65812171, "body": "You&#39;re welcome.  Make sure to check it as the correct answer if that is indeed what you needed (I need the rep)."}], "tags": [], "owner": {"reputation": 26, "user_id": 6771089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a8870261666859e943ef37acbf7c4d4?s=128&d=identicon&r=PG&f=1", "display_name": "oscar", "link": "https://stackoverflow.com/users/6771089/oscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1472592774, "creation_date": 1472592774, "answer_id": 39237413, "question_id": 39237222, "link": "https://stackoverflow.com/questions/39237222/vba-code-for-button-to-copy-data/39237413#39237413", "title": "VBA code for button to copy data", "body": "<p>Is something like this what you're looking for?</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Sub CopyDataByDay()\n    Dim data As Range\n    Dim today As Date\n\n    Set data = ThisWorkbook.Worksheets(1).Range(\"A1\")\n    today = Date\n\n    If (Weekday(today) = vbMonday) Then\n        ThisWorkbook.Worksheets(1).Range(\"B1\") = data.Value\n    ElseIf (Weekday(today) = vbTuesday) Then\n        ThisWorkbook.Worksheets(1).Range(\"B2\") = data.Value\n    ElseIf (Weekday(today) = vbWednesday) Then\n        ThisWorkbook.Worksheets(1).Range(\"B3\") = data.Value\n    ElseIf (Weekday(today) = vbThursday) Then\n        ThisWorkbook.Worksheets(1).Range(\"B4\") = data.Value\n    ElseIf (Weekday(today) = vbFriday) Then\n        ThisWorkbook.Worksheets(1).Range(\"B5\") = data.Value\n    ElseIf (Weekday(today) = vbSaturday) Then\n        ThisWorkbook.Worksheets(1).Range(\"B6\") = data.Value\n    End If\n\n    data.Value = \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1472608816, "creation_date": 1472608816, "answer_id": 39239606, "question_id": 39237222, "link": "https://stackoverflow.com/questions/39237222/vba-code-for-button-to-copy-data/39239606#39239606", "title": "VBA code for button to copy data", "body": "<p>You can try this:</p>\n\n<pre><code>Sub Main()\n    Dim IWeekday As Integer\n\n    IWeekday = Weekday(Date(), vbMonday)\n    With ThisWorkbook.Worksheets(1).Range(\"A1\")\n        If IWeekday &lt;&gt; 7 Then .Offset(IWeekday -1, 1).Value = .Value\n        .ClearContents\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6776222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0b1a50a67db8b2a8afc3a3672df0f8a?s=128&d=identicon&r=PG&f=1", "display_name": "K.Caller", "link": "https://stackoverflow.com/users/6776222/k-caller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1472620739, "accepted_answer_id": 39237413, "answer_count": 2, "score": -1, "last_activity_date": 1472608816, "creation_date": 1472591822, "question_id": 39237222, "link": "https://stackoverflow.com/questions/39237222/vba-code-for-button-to-copy-data", "closed_reason": "Needs more focus", "title": "VBA code for button to copy data", "body": "<p>I'm looking for some help with a button, I have got data in cell A1 that i need to paste in to a different cell once i'm done at the end off the day.</p>\n\n<p>In cell B1:B6 I have Monday to Saturday I'm looking to make a button to copy the data for A1 to Monday i have made a button to clear A1 when i have finished at the end of the day ready for the next day.</p>\n\n<p>I will need to button to update the data at the end of each day and stay under that day once i push the clear button the next day to start again.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1472591888, "post_id": 39237198, "comment_id": 65811624, "body": "In your sub <code>AuthExpense</code>, change all references to <code>ActiveSheet</code> to <code>Current</code> and it should work."}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1472592908, "post_id": 39237198, "comment_id": 65812062, "body": "When I change &quot;Active&quot; to &quot;Current&quot;, the macro only loops through one iteration. Why would this occur?"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1472592813, "post_id": 39237269, "comment_id": 65812020, "body": "FWIW - <code>Target_Workbook.Sheets(BusinessUnit)</code> can be replaced by <code>Current</code> (because <code>BusinessUnit</code> was set to be the Name of the <code>Current</code> worksheet in ThisWorkbook and <code>Target_Workbook</code> has been set to <code>ThisWorkbook</code>)."}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "edited": false, "score": 0, "creation_date": 1472592879, "post_id": 39237269, "comment_id": 65812045, "body": "When I change &quot;Active&quot; to &quot;Current&quot;, the macro only loops through one iteration. Furethermore, it appears that it&#39;s now appending my Windows USERNAME to the file path. Why would this occur?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1472592995, "post_id": 39237269, "comment_id": 65812100, "body": "How many worksheets are in the workbook this code is housed in? Do you receive any errors?"}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "edited": false, "score": 0, "creation_date": 1472593658, "post_id": 39237269, "comment_id": 65812367, "body": "10 source_workbooks, each with 20 tabs. Since I am only copying one tab per source_workbook, the target_workbook therefore has 10 tabs."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1472594046, "post_id": 39237269, "comment_id": 65812516, "body": "Can you step through the code and check your variables? There is nothing wrong with the code, so I anticipate something isn&#39;t named right, etc"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "edited": false, "score": 1, "creation_date": 1472594304, "post_id": 39237269, "comment_id": 65812610, "body": "@kidlogic - The macros are located in the workbook (target_workbook) that contains 10 sheets (one for each business unit)?  And each of the 10 sheets has a valid business name in cell B2?"}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472656235, "post_id": 39237269, "comment_id": 65842252, "body": "@YowE3K this is correct.   please disregard my previous comment about the function inserting my USERNAME - this was due to another page that holds meta data concerning the last author of the workbook."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "edited": false, "score": 0, "creation_date": 1472661912, "post_id": 39237269, "comment_id": 65845617, "body": "@kidlogic - I assume you have now deleted that extra worksheet, or changed your code to say something like <code>If Current.Name &lt;&gt; &quot;whatever bad sheet is called&quot; Then</code> <code>Call AuthExpense(Current)</code> <code>End If</code>.  Does it still only go through the loop once?"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1472592060, "creation_date": 1472592060, "answer_id": 39237269, "question_id": 39237198, "link": "https://stackoverflow.com/questions/39237198/iterate-through-workbook-copy-paste-data-to-new-workbook/39237269#39237269", "title": "Iterate Through Workbook; Copy &amp; Paste Data to new workbook", "body": "<p>Your <code>AllUnits()</code> sub has no problems. It should just loop through the sheets in the workbook it is housed in. You must change you sub <code>AuthExpense</code> to not reference the <code>ActiveSheet</code>. You never activate the sheet in your <code>AllUnits()</code> sub, so the next sheet isn't the active one. Use the below. </p>\n\n<pre><code>Sub AllUnits()\n\nDim Current As Worksheet\n\n'For every worksheet in workbook, call AuthExpense function\nFor Each Current In ThisWorkbook.Worksheets\nCall AuthExpense(Current)\nNext Current\n\nEnd Sub\n\n\nSub AuthExpense(Current As Worksheet)\n\nDim Target_Workbook As Workbook\nDim Source_Workbook As Workbook\nDim Source_Path As String\n\n\n'Configure macro for business-specific unit\nBusinessUnit = Current.Name\nBusinessName = Current.Cells(2, 2)\n\n'Declare Target &amp; Source workbooks w/ relative paths\nSet Target_Workbook = ThisWorkbook\nSource_Path = ThisWorkbook.Path &amp; \"\\Business Unit Monthly Reporting Template_\" &amp; BusinessName &amp; \".xlsx\"\nSet Source_Workbook = Workbooks.Open(Source_Path)\n\n'Copy Source Workbook to Target Workbook\nSource_Workbook.Sheets(\"Auth Expense Data Entry\").Range(\"A1:H150\").Copy\n\n'Paste Special Source data to Target workbook\nTarget_Workbook.Sheets(BusinessUnit).Range(\"A5\").PasteSpecial Paste:=xlPasteValues\n\n'Clear clipboard cache and close\nApplication.CutCopyMode = False\nSource_Workbook.Close (False)\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472592060, "creation_date": 1472591681, "question_id": 39237198, "link": "https://stackoverflow.com/questions/39237198/iterate-through-workbook-copy-paste-data-to-new-workbook", "title": "Iterate Through Workbook; Copy &amp; Paste Data to new workbook", "body": "<p><strong>Background</strong></p>\n\n<p>I receive a bunch of excel workbooks (AUTHORIZED EXPENSES) from various BUSINESS UNITS throughout the world. My objective is to create a macro that opens each BUSINESS UNIT'S workbook, copy their expense data, and paste it into a master file for easy comparison.</p>\n\n<p><strong>PROCESS</strong></p>\n\n<ol>\n<li><p>Create a tab for each BUSINESS UNIT in the TARGET_WORKBOOK (<em>this is done outside of the macro</em>)</p></li>\n<li><p>For each tab in TARGET_WORKBOOK, have some meta data that helps the\nmacro in navigating to the BUSINESS UNIT's proper file path\n    (SOURCE_WORKBOOK)</p></li>\n<li>Open correct SOURCE_WORKBOOK and navigate to \"Auth Expense Data\nEntry\" tab within the SOURCE_WORKBOOK</li>\n<li>Copy data from SOURCE_WORKBOOK to TARGET_WORKBOOK, clear clipboard\ncache, close SOURCE_BOOK</li>\n<li><strong>ISSUE</strong> - <em>Move to next tab in SOUCE_WORKBOOK and repeat Step 1</em></li>\n</ol>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>Sub AllUnits()\n\nDim Current As Worksheet\n\n'For every worksheet in workbook, call AuthExpense function\nFor Each Current In ThisWorkbook.Worksheets\nCall AuthExpense(Current)\nNext Current\n\nEnd Sub\n\n\nSub AuthExpense(Current As Worksheet)\n\nDim Target_Workbook As Workbook\nDim Source_Workbook As Workbook\nDim Source_Path As String\n\n\n'Configure macro for business-specific unit\nBusinessUnit = ActiveSheet.Name\nBusinessName = ActiveSheet.Cells(2, 2)\n\n'Declare Target &amp; Source workbooks w/ relative paths\nSet Target_Workbook = ThisWorkbook\nSource_Path = ThisWorkbook.Path &amp; \"\\Business Unit Monthly Reporting Template_\" &amp; BusinessName &amp; \".xlsx\"\nSet Source_Workbook = Workbooks.Open(Source_Path)\n\n'Copy Source Workbook to Target Workbook\nSource_Workbook.Sheets(\"Auth Expense Data Entry\").Range(\"A1:H150\").Copy\n\n'Paste Special Source data to Target workbook\nTarget_Workbook.Sheets(BusinessUnit).Range(\"A5\").PasteSpecial Paste:=xlPasteValues\n\n'Clear clipboard cache and close\nApplication.CutCopyMode = False\nSource_Workbook.Close (False)\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE</strong></p>\n\n<ul>\n<li>I can successfully open, copy, paste, clear clipboard cache, and close a BUSINESS UNIT's workbook.</li>\n</ul>\n\n<p><strong>ISSUES</strong></p>\n\n<ol>\n<li>My issues occurs in the looping/iteration function (\"AllUnits()\"). When the macro runs, the Master Excel file copy/pastes the same business unit's data 10 times (on the same worksheet, overwriting itself). I believe my issue occurs when I try to move over to the next tab on the Master File. Any suggestions?</li>\n</ol>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1472590529, "post_id": 39236909, "comment_id": 65811016, "body": "change <code>lRow = .Range(&quot;A&quot; &amp; .rows.Count).End(xlUp).Row</code> to <code>lRow = .Range(&quot;C&quot; &amp; .rows.Count).End(xlUp).Row</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1472592162, "post_id": 39236909, "comment_id": 65811757, "body": "<code>FinalRow = .Cells(rows.Count, &quot;C&quot;).End(xlUp).Row</code> as well."}, {"owner": {"reputation": 133, "user_id": 3761259, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/ABrOe.jpg?s=128&g=1", "display_name": "nahaelem", "link": "https://stackoverflow.com/users/3761259/nahaelem"}, "edited": false, "score": 0, "creation_date": 1472653769, "post_id": 39236909, "comment_id": 65840405, "body": "Hi there, when i execute the code, it doesn&#39;t copy the data. Now granted that i have changed the code a bit from what it originally was. But, it still contains the core logic  with your suggested changed."}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": true, "score": 1, "last_activity_date": 1479134829, "creation_date": 1479134829, "answer_id": 40591470, "question_id": 39236909, "link": "https://stackoverflow.com/questions/39236909/excel-macro-to-copy-row-of-data-to-bottom-row/40591470#40591470", "title": "Excel Macro to copy row of data to bottom row", "body": "<p>Your code does not need to be so long, please try the below and let me know how it works for you :):</p>\n\n<pre><code>sub copydata()\nDim lrow As Long\nlrow = Sheets(\"test\").Cells(Rows.Count, 3).End(xlUp).Row\nWith Sheets(\"test\")\n    .Range(\"C2:G2\").Copy\n    .Range(\"C\" &amp; lrow + 1).PasteSpecial xlPasteValues\nEnd With\nend sub\n</code></pre>\n\n<p>Place a button on the worksheet, and press it before you create a new month :)</p>\n"}], "owner": {"reputation": 133, "user_id": 3761259, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/ABrOe.jpg?s=128&g=1", "display_name": "nahaelem", "link": "https://stackoverflow.com/users/3761259/nahaelem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5427, "favorite_count": 0, "accepted_answer_id": 40591470, "answer_count": 1, "score": 2, "last_activity_date": 1479134829, "creation_date": 1472590382, "last_edit_date": 1472654043, "question_id": 39236909, "link": "https://stackoverflow.com/questions/39236909/excel-macro-to-copy-row-of-data-to-bottom-row", "title": "Excel Macro to copy row of data to bottom row", "body": "<p>Good day,</p>\n\n<p>I am trying to create a macro that copies data from the current month row to the bottom. The current month row is refreshed and the date will change for a new month (sep--16), but before it is refreshed, copy the data to the matching month. but i can't seem to get it to work. </p>\n\n<p><a href=\"https://i.stack.imgur.com/wbxpy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wbxpy.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>    With test_example.Sheets(\"test\")\n    FinalRow = .Cells(rows.Count, 1).End(xlUp).Row\n    'Loop through each row\n    For x = 2 To FinalRow\n       'Decide if to copy based on column B\n       ThisValue = .Cells(1, 2).Value\n       If ThisValue = \"Aug--16\" Then\n           Sheets(\"sheet 1\").Range(\"B2:G2\").Copy\n           lRow = .Range(\"A\" &amp; .rows.Count).End(xlUp).Row\n           .Range(\"A\" &amp; lRow + 1, \"Z\" &amp; lRow + 1).Select\n        ActiveSheet.Paste\n      End If\n   Next x\n End With\n\n\n   // edited code because i only have one sheet in the workbook\n    Sub CopyData()\n        FinalRow = Cells(Rows.Count, \"C\").End(xlUp).Row\n        'Loop through each row\n        For x = 2 To FinalRow\n          'Decide if to copy based on column B\n          ThisValue = Cells(1, 2).Value\n          If ThisValue = \"Aug--16\" Then\n            Sheets(\"Sheet1\").Range(\"B2:G2\").Copy\n            lRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n            Range(\"A\" &amp; lRow + 1, \"Z\" &amp; lRow + 1).Select\n            ActiveSheet.Paste\n          End If\n       Next x\n    End Sub\n</code></pre>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["vba", "excel", "split"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6776042, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fee18301ac2dea2cb0a03cab916d5bb9?s=128&d=identicon&r=PG&f=1", "display_name": "Unknow User", "link": "https://stackoverflow.com/users/6776042/unknow-user"}, "edited": false, "score": 0, "creation_date": 1472592302, "post_id": 39237082, "comment_id": 65811825, "body": "I get the following error: subscription out of range                                                            THANKS A LOT for your fast help btw"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 7, "user_id": 6776042, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fee18301ac2dea2cb0a03cab916d5bb9?s=128&d=identicon&r=PG&f=1", "display_name": "Unknow User", "link": "https://stackoverflow.com/users/6776042/unknow-user"}, "edited": false, "score": 0, "creation_date": 1472592521, "post_id": 39237082, "comment_id": 65811906, "body": "Did you change the name of the worksheet to be processed?"}, {"owner": {"reputation": 7, "user_id": 6776042, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fee18301ac2dea2cb0a03cab916d5bb9?s=128&d=identicon&r=PG&f=1", "display_name": "Unknow User", "link": "https://stackoverflow.com/users/6776042/unknow-user"}, "edited": false, "score": 0, "creation_date": 1472593207, "post_id": 39237082, "comment_id": 65812180, "body": "Yes, I did. Why? :)"}, {"owner": {"reputation": 7, "user_id": 6776042, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fee18301ac2dea2cb0a03cab916d5bb9?s=128&d=identicon&r=PG&f=1", "display_name": "Unknow User", "link": "https://stackoverflow.com/users/6776042/unknow-user"}, "edited": false, "score": 0, "creation_date": 1472593227, "post_id": 39237082, "comment_id": 65812186, "body": "Would it be possible to add you on skype? I need some further help with automating Vlookuo using VBA macro&#39;s. I dont wanna disppoint my boss or i might get fired, even though he is a very good guy.. I would be willing to pay even.. Via paypal or bank idk... Sounds dramatic but this job is importsnt and i dont wanna lose it"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 7, "user_id": 6776042, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fee18301ac2dea2cb0a03cab916d5bb9?s=128&d=identicon&r=PG&f=1", "display_name": "Unknow User", "link": "https://stackoverflow.com/users/6776042/unknow-user"}, "edited": false, "score": 0, "creation_date": 1472594318, "post_id": 39237082, "comment_id": 65812618, "body": "I cannot commit to something like that at this time. I would suggest you post your requirements in <a href=\"http://stackoverflow.com/jobs?med=site-ui&amp;ref=jobs-tab\">StackOverflow Jobs</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 7, "user_id": 6776042, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fee18301ac2dea2cb0a03cab916d5bb9?s=128&d=identicon&r=PG&f=1", "display_name": "Unknow User", "link": "https://stackoverflow.com/users/6776042/unknow-user"}, "edited": false, "score": 0, "creation_date": 1472651814, "post_id": 39237082, "comment_id": 65838969, "body": "I&#39;m guessing that there is no space in the entry that threw that error."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1472591134, "creation_date": 1472591134, "answer_id": 39237082, "question_id": 39236789, "link": "https://stackoverflow.com/questions/39236789/pasting-split-data-from-column-b-into-columns-d-e/39237082#39237082", "title": "Pasting Split Data From Column B into Columns D &amp; E", "body": "<p>Try this coded and conditional text-to-columns.</p>\n\n<pre><code>Option Explicit\n\nSub wqewtrqw()\n    Dim s As Long, a As Long, aVALs As Variant\n\n    With Worksheets(\"Sheet5\")\n        aVALs = .Range(.Cells(12, \"B\"), .Cells(.Rows.Count, \"B\").End(xlUp)).Value2\n        ReDim Preserve aVALs(LBound(aVALs, 1) To UBound(aVALs, 1), 1 To 2)\n        For a = LBound(aVALs, 1) To UBound(aVALs, 1)\n            s = InStr(1, aVALs(a, 1), Chr(32))\n            aVALs(a, 2) = Mid(aVALs(a, 1), s + 1)\n            aVALs(a, 1) = Left(aVALs(a, 1), s - 1)\n        Next a\n        .Cells(12, \"D\").Resize(UBound(aVALs, 1), UBound(aVALs, 2)) = aVALs\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6776042, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fee18301ac2dea2cb0a03cab916d5bb9?s=128&d=identicon&r=PG&f=1", "display_name": "Unknow User", "link": "https://stackoverflow.com/users/6776042/unknow-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472591622, "creation_date": 1472589887, "last_edit_date": 1472591622, "question_id": 39236789, "link": "https://stackoverflow.com/questions/39236789/pasting-split-data-from-column-b-into-columns-d-e", "title": "Pasting Split Data From Column B into Columns D &amp; E", "body": "<p>In column B there is the 5 character item code + the item description.\nI managed to make a macro that copy/pastes the 5 character item codes from column B into column D and the item descriptions into column E.</p>\n\n<p>Example:</p>\n\n<pre><code>          Column B              Column C  Column D     Column E\nXX787 DO BOLOGNESE 2X2.28KG FR   &lt;other&gt;    XX787    DO BOLOGNESE 2X2.28KG FR\n</code></pre>\n\n<p>I am facing the following issues:</p>\n\n<ul>\n<li>About 1% of the item codes are not 5 characters but 8 characters, for example</li>\n<li>This percentage that exists out of 8 characters exists of numbers and starts with 0</li>\n</ul>\n\n<p>As you can see, the last 2 are examples of item codes that have a different format, and even though there is only a small amount of them, they have to be taken into account of course.</p>\n\n<p>So with my current coding, the following issues arise:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NbN5y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NbN5y.png\" alt=\"Hier een foto\"></a></p>\n\n<p>I think the macro should do the following to make this work properly:</p>\n\n<p>For item codes in column D: Copy/paste all the characters BEFORE the first space from column B\nFor item descriptions in column E: Copy/paste all the characters AFTER the first space</p>\n\n<p>The code I am currently running for this is the following:</p>\n\n<pre><code>Sub Seperate_Item_Code_And_Description_Code()\n    'Copy/paste the item codes and descriptions from column B to column D and E seperately\n\n    Range(\"B12\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.TextToColumns Destination:=Range(\"D12\"), DataType:=xlFixedWidth, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    FieldInfo:=Array(Array(0, 1), Array(6, 1)), TrailingMinusNumbers:= _\n    True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1472589266, "post_id": 39236609, "comment_id": 65810388, "body": "Is <code>fname</code> a string variable or a workbook variable?"}, {"owner": {"reputation": 11, "user_id": 6776094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3f7c018763af38d3c0ed9f23d08bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryland Taylor", "link": "https://stackoverflow.com/users/6776094/ryland-taylor"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1472590084, "post_id": 39236609, "comment_id": 65810786, "body": "String Variable.  Should I change it to workbook?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472590790, "post_id": 39236609, "comment_id": 65811144, "body": "Does the sheet &quot;Policy Search&quot; exist?  Does the workbook referred to by <code>fname</code> exist and is it open?  Does that workbook contain a sheet referred to by the variable <code>SheetName</code>? (Or is that a typo and is meant to be <code>&quot;SheetName&quot;</code>?)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1472591172, "post_id": 39236609, "comment_id": 65811319, "body": "Does <code>fname</code> contain the fully qualified file name / path, or just the file name?  (The Workbooks object is indexed by the file name, not the name/path.)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6776094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3f7c018763af38d3c0ed9f23d08bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryland Taylor", "link": "https://stackoverflow.com/users/6776094/ryland-taylor"}, "edited": false, "score": 0, "creation_date": 1472590050, "post_id": 39236786, "comment_id": 65810766, "body": "That is actually what I had written earlier. Still getting same error. Thank you though."}], "tags": [], "owner": {"reputation": 1, "user_id": 6776157, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/1728dd2b3740fc2d50a75e09ec5ef240?s=128&d=identicon&r=PG", "display_name": "luisz_1", "link": "https://stackoverflow.com/users/6776157/luisz-1"}, "is_accepted": false, "score": 0, "last_activity_date": 1472589874, "creation_date": 1472589874, "answer_id": 39236786, "question_id": 39236609, "link": "https://stackoverflow.com/questions/39236609/move-or-copy-excel-sheet-to-another-workbook-destination-workbook-is-named-usin/39236786#39236786", "title": "Move or Copy Excel Sheet to Another Workbook (Destination workbook is named using variable)", "body": "<p>Try this:</p>\n\n<pre><code>Sub MoveSheet()\n    Sheets(\"Policy Search\").Select\n    Sheets(\"Policy Search\").Move After:=Workbooks(fname).Sheets(SheetName)\nEnd Sub\n</code></pre>\n\n<p>It assumes \"Policy Search\" is the active sheet.</p>\n"}], "owner": {"reputation": 11, "user_id": 6776094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3f7c018763af38d3c0ed9f23d08bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryland Taylor", "link": "https://stackoverflow.com/users/6776094/ryland-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 713, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1472589874, "creation_date": 1472589102, "last_edit_date": 1531164843, "question_id": 39236609, "link": "https://stackoverflow.com/questions/39236609/move-or-copy-excel-sheet-to-another-workbook-destination-workbook-is-named-usin", "title": "Move or Copy Excel Sheet to Another Workbook (Destination workbook is named using variable)", "body": "<p>I am trying to copy an excel worksheet into another excel workbook.  This generally wouldn't be too difficult, except I am moving my worksheet into a workbook that is saved using variables. </p>\n\n<p>Here is a bit of my code:</p>\n\n<pre><code>Sheets.Add After:=Sheets(Sheets.Count)\nActiveCell.FormulaR1C1 = \"a\"\nSheets(\"Policy Search\").Move After:=Workbooks(fname).Sheets(SheetName)\n</code></pre>\n\n<p>\"policy search\" will always be named the same, and this is the workbook I am trying to move.  However, I am trying to move it to a file that is dynamically saved using the variable \"fname\", and the sheet name \"SheetName\".</p>\n\n<p>Every time I try and run this bit of code, I am getting a Subscript out of range error.  Any ideas on how to fix this?</p>\n\n<p>Thanks!</p>\n"}]