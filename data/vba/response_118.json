[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "edited": false, "score": 0, "creation_date": 1492040820, "post_id": 43381322, "comment_id": 73824781, "body": "It looks like a pop-up box will appear for every cell in the range.  Is this the desired behaviour?  (btw, you have an extra <code>.</code> at the end of your <code>xlDown</code>)"}, {"owner": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "reply_to_user": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "edited": false, "score": 0, "creation_date": 1492041045, "post_id": 43381322, "comment_id": 73824838, "body": "@lebelinoz , no just want the popup box to appear after it is done searching."}, {"owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "edited": false, "score": 0, "creation_date": 1492041254, "post_id": 43381322, "comment_id": 73824894, "body": "The &quot;InStr(Edward)&quot; line doesn&#39;t make sense, either.  Can you edit the question to include working code?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1492041716, "post_id": 43381322, "comment_id": 73825006, "body": "Remove the <code>.Select</code> at the end of that line.  Plus the others&#39; comments."}, {"owner": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "edited": false, "score": 0, "creation_date": 1492041794, "post_id": 43381322, "comment_id": 73825032, "body": "I have editted the OP, it seems correct but it does not include finding the entire range and assigning it to the range variable theForest."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1492042033, "creation_date": 1492042033, "answer_id": 43381534, "question_id": 43381322, "link": "https://stackoverflow.com/questions/43381322/finding-a-value-in-the-range/43381534#43381534", "title": "Finding a value in the range", "body": "<pre><code> Dim theForest as Range, f as Range\n\n\n Set theForest = ActiveSheet.Range(ActiveSheet.Range(\"A1\"), _\n                                     ActiveSheet.Range(\"A1\").End(xlDown))\n\n Set f = theForest.Find(\"Edward\", lookat:=xlWhole) \n\n If Not f Is Nothing Then\n      Msgbox\"He was found\"\n Else\n     Msgbox\"He was not found sorry\"\n End If\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 43381534, "answer_count": 1, "score": 0, "last_activity_date": 1494837793, "creation_date": 1492040521, "last_edit_date": 1531164843, "question_id": 43381322, "link": "https://stackoverflow.com/questions/43381322/finding-a-value-in-the-range", "title": "Finding a value in the range", "body": "<p>I am writing a subroutine that looks through a range of cells starting in cell A1 (the range is 1 column wide) containing String values. My sub first finds the entire range and assign it to a Range variable \"theForest\" to help make searching easier. Then, it looks through each cell in the range until it finds the word \u201cEdward\u201d. If he is found or not, it display the result in a message (stating that he was or was not found).</p>\n\n<p>The code I have so far is this:</p>\n\n<pre><code>With Range(\"A1\")\n     'this will help find the entire range, since it is only one column I will search by going down\n   theForest = Range(.Offset(0,0), .End(xlDown)).Select\n   Dim cell As Range\n   For Each cell In theForest\n        If InStr(Edward) Then\n            Msgbox\"He was found\"\n        Else\n            Msgbox\"He was not found sorry\"\n        End If\n   Next cell\nEnd With\n</code></pre>\n\n<p>However I am getting numerous errors upon running the program and I think the issue is with the    </p>\n\n<pre><code>theForest = Range(.Offset(0,0), .End(xlDown.)).Select \n</code></pre>\n\n<p>line of code. I would appreciate any guidance into this simple code.</p>\n\n<p>Thank you :)</p>\n\n<p>EDIT: Here is some new code I have come up with:</p>\n\n<pre><code>Dim isFound As Boolean\nisFound = False\nWith Range(\"A1\")\n    For i = 1 to 500\n        If .Offset(1,0).Value = \"Edward\" Then\n            isFound = True\n            Exit For\n        End If\n    Next\nEnd With\nIf isFound = True Then\n    Msgbox \" Edward was found\"\nElse\n    MsgBox \"Edward was not found\"\nEnd if\n</code></pre>\n\n<p>Then again it does not include finding the entire range and assiging it to the range variable theForest.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3425887, "user_type": "registered", "profile_image": "https://graph.facebook.com/1445898919/picture?type=large", "display_name": "user3425887", "link": "https://stackoverflow.com/users/3425887/user3425887"}, "edited": false, "score": 0, "creation_date": 1492086111, "post_id": 43388690, "comment_id": 73845213, "body": "Great i think this is what i need but can you place also show me how to embed this in my code? because i tried pasting it in but it gives me a error."}, {"owner": {"reputation": 33, "user_id": 3425887, "user_type": "registered", "profile_image": "https://graph.facebook.com/1445898919/picture?type=large", "display_name": "user3425887", "link": "https://stackoverflow.com/users/3425887/user3425887"}, "edited": false, "score": 0, "creation_date": 1492087089, "post_id": 43388690, "comment_id": 73845929, "body": "The list i would like to end up with should look like this. In you bottom example they shift up. that would scramble the data.      [1]: <a href=\"https://i.stack.imgur.com/ijYVP.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/ijYVP.png</a>"}, {"owner": {"reputation": 33, "user_id": 3425887, "user_type": "registered", "profile_image": "https://graph.facebook.com/1445898919/picture?type=large", "display_name": "user3425887", "link": "https://stackoverflow.com/users/3425887/user3425887"}, "edited": false, "score": 0, "creation_date": 1492087272, "post_id": 43388690, "comment_id": 73846082, "body": "the formulas in the pict should use collum A not B"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 33, "user_id": 3425887, "user_type": "registered", "profile_image": "https://graph.facebook.com/1445898919/picture?type=large", "display_name": "user3425887", "link": "https://stackoverflow.com/users/3425887/user3425887"}, "edited": false, "score": 0, "creation_date": 1492090808, "post_id": 43388690, "comment_id": 73848771, "body": "The code won&#39;t copy and paste. You need to try and adapt the method to your situation. HTH"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 0, "last_activity_date": 1492076274, "creation_date": 1492076274, "answer_id": 43388690, "question_id": 43381285, "link": "https://stackoverflow.com/questions/43381285/exclude-rows-with-formulas-from-range-in-macro/43388690#43388690", "title": "Exclude rows with formulas from range in macro", "body": "<p>If you want to copy and paste and exclude formula-based cells then you can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\"><code>SpecialCells</code></a> method of the <code>Range</code> object. `xlCellTypeConstants' will filter out cells without a formula <em>and</em> blank cells. </p>\n\n<p>E.g. with your code:</p>\n\n<pre><code>Dim rngSource As Range\nDim rngFilter As Range\n\nSet rngSource = historyWks.Range(historyWks.Cells(lRecRow, 3), historyWks.Cells(lRecRow, 128))\nSet rngFilter = rngSource.SpecialCells(xlCellTypeConstants)\n</code></pre>\n\n<p>Note once pasted the <code>Range</code> will be smaller than the original because the cells with formulas are discounted.</p>\n\n<p>You can <code>Union</code> different calls <code>SpecialCells</code> together. So to include blanks you could use:</p>\n\n<pre><code>Dim rngSource As Range\nDim rngFilter As Range\n\nSet rngSource = historyWks.Range(historyWks.Cells(lRecRow, 3), historyWks.Cells(lRecRow, 128))\n\nSet rngFilter = Union( _\n    rngSource.SpecialCells(xlCellTypeConstants), _\n    rngSource.SpecialCells(xlCellTypeBlanks) _\n)\n</code></pre>\n\n<p>Sample code for minimal example of use of <code>SpecialCells</code>:</p>\n\n<pre><code>Option Explicit\n\nSub TestRangeCopyExcludingFormulas()\n\n    Dim ws As Worksheet\n    Dim rngToCopy As Range\n    Dim rngToCopyExcludingFormulas As Range\n    Dim rngToPaste As Range\n    Dim rngCell As Range\n\n    ' set the worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    ' set the range to copy excluding formulas\n    Set rngToCopy = ws.Range(\"B3:B13\")\n\n    ' copy just the constants\n'    Set rngToCopyExcludingFormulas = rngToCopy.SpecialCells(xlCellTypeConstants)\n\n    ' copy constants and blanks\n    Set rngToCopyExcludingFormulas = Union( _\n        rngToCopy.SpecialCells(xlCellTypeConstants), _\n        rngToCopy.SpecialCells(xlCellTypeBlanks))\n\n    ' set the range to paste to\n    Set rngToPaste = ws.Range(\"E3\")\n\n    ' do the copy and paste\n    rngToCopyExcludingFormulas.Copy\n    rngToPaste.PasteSpecial Paste:=xlPasteValues\n    ' use transpose etc\n'    rngToPaste.PasteSpecial Paste:=xlPasteValues, Transpose:=True\n\n    ' remove the dancing ants\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p>See screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GFZCv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GFZCv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 3425887, "user_type": "registered", "profile_image": "https://graph.facebook.com/1445898919/picture?type=large", "display_name": "user3425887", "link": "https://stackoverflow.com/users/3425887/user3425887"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 970, "favorite_count": 0, "accepted_answer_id": 43388690, "answer_count": 1, "score": 1, "last_activity_date": 1492076274, "creation_date": 1492040202, "last_edit_date": 1492072926, "question_id": 43381285, "link": "https://stackoverflow.com/questions/43381285/exclude-rows-with-formulas-from-range-in-macro", "title": "Exclude rows with formulas from range in macro", "body": "<p>I made a Data Entry Form that ads or updates rows in a datasheet. With this <a href=\"http://www.contextures.com/exceldataentryupdateform.html\" rel=\"nofollow noreferrer\">http://www.contextures.com/exceldataentryupdateform.html</a> as the base. The form has 128 rows and 5 of those are vlookup formulas (row 12, 19, 30, 34, 36) that should be excluded when using the view record navigation buttons. Otherwise the formulas get deleted and replaced by a value, if you use the nav buttons.</p>\n\n<p>But I really have no clue how to do this. I'm really new to VBA. This is my first project so all help will be greatly appreciated.</p>\n\n<pre><code>Sub ViewLogDown()\n\n    Dim historyWks As Worksheet\n    Dim inputWks As Worksheet\n    Dim rngA As Range\n\n    Dim lRec As Long\n    Dim lRecRow As Long\n    Dim lLastRec As Long\n    Dim lastRow As Long\n    Application.EnableEvents = False\n\n    Set inputWks = Worksheets(\"Input\")\n    Set historyWks = Worksheets(\"Werknemers\")\n    Set rngA = ActiveCell\n\n    With historyWks\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row - 1\n        lLastRec = lastRow - 1\n    End With\n\n    With inputWks\n        lRec = .Range(\"CurrRec\").Value\n        If lRec &lt; lLastRec Then\n            .Range(\"CurrRec\").Value = lRec + 1\n            lRec = .Range(\"CurrRec\").Value\n            lRecRow = lRec + 1\n        historyWks.Range(historyWks.Cells(lRecRow, 3), historyWks.Cells(lRecRow, 128)).Copy\n        .Range(\"D5\").PasteSpecial Paste:=xlPasteValues, Transpose:=True\n        inputWks.Range(\"OrderSel\").Value = .Range(\"D5\").Value\n        rngA.Select\n          End If\n    End With\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 64, "user_id": 7787506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9eJ9l.jpg?s=128&g=1", "display_name": "Khang Huynh", "link": "https://stackoverflow.com/users/7787506/khang-huynh"}, "edited": false, "score": 0, "creation_date": 1492040657, "post_id": 43381237, "comment_id": 73824742, "body": "I think this thread will address your concern. <a href=\"https://superuser.com/questions/205759/format-a-number-with-optional-decimal-places-in-excel\">Old thread from superuser</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1492046976, "creation_date": 1492046976, "answer_id": 43382120, "question_id": 43381237, "link": "https://stackoverflow.com/questions/43381237/formatting-excel-percentage-decimals/43382120#43382120", "title": "Formatting excel percentage decimals", "body": "<p>If it is mission critical that you display 95% instead of 95.0% you could add a Conditional Formatting Rule based on the following formula:</p>\n\n<pre><code>=ROUND(A2, 3)=ROUND(A2, 2)\n</code></pre>\n\n<p>First set the percentage cell number format for 1 decimal then add a CFR that changes it to zero decimals based on that formula.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mpIB4.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mpIB4.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 7541604, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f49b52e2247e0a8d9178a0fe010e3faf?s=128&d=identicon&r=PG&f=1", "display_name": "T.Hannah", "link": "https://stackoverflow.com/users/7541604/t-hannah"}, "is_accepted": false, "score": 0, "last_activity_date": 1492054449, "creation_date": 1492054449, "answer_id": 43383101, "question_id": 43381237, "link": "https://stackoverflow.com/questions/43381237/formatting-excel-percentage-decimals/43383101#43383101", "title": "Formatting excel percentage decimals", "body": "<p>Jeeped's answer works. If for some reason you want to avoid conditional formatting and keep the formatting static, another solution would be to add a temporary column and use the formula Jeeped used:</p>\n\n<pre><code>=rounddown(A2,2)=rounddown(A2,3)\n</code></pre>\n\n<p>Filter to TRUE and highlight the column - set the formatting at 0 decimal points.\nFilter to FALSE and highlight the column - set the formatting to 1 decimal point.</p>\n\n<p>My 2 cents - if 3 significant digits are necessary, it's best to keep all the data at 3 sig figs.  This usually leads to a lot less confusion than removing extra 0s.</p>\n"}], "owner": {"reputation": 27, "user_id": 7311465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb4c6722d8eb15ff71177a02c1c0b236?s=128&d=identicon&r=PG&f=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/7311465/tommy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 43382120, "answer_count": 2, "score": 1, "last_activity_date": 1500199351, "creation_date": 1492039946, "last_edit_date": 1531161705, "question_id": 43381237, "link": "https://stackoverflow.com/questions/43381237/formatting-excel-percentage-decimals", "title": "Formatting excel percentage decimals", "body": "<p>I have a row of excel percentage decimals that I have imported from CSV.</p>\n\n<p>The row contains data such as \"95%\" or \"99.5%\"</p>\n\n<p>After the import, all the \"99.5%\" changes to \"99.50%\"</p>\n\n<p>I can right click on the cell and change the cell's decimal place to 1.\nHowever there are 20,000 rows I have to go through manually.</p>\n\n<p>If I select the entire row and change to 1 decimal place, then even those with \"95%\" changes to \"95.0%\".</p>\n\n<p>How to I prevent excel from messing up my format.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1492040163, "post_id": 43381169, "comment_id": 73824597, "body": "By &quot;yesterday&quot; do you mean the day previous to the day the Workbook is currently open?"}, {"owner": {"reputation": 39, "user_id": 7859173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fea0f2674317fd3438228cf8eec8be1?s=128&d=identicon&r=PG&f=1", "display_name": "Loudo", "link": "https://stackoverflow.com/users/7859173/loudo"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1492040546, "post_id": 43381169, "comment_id": 73824711, "body": "Yes sorry, should of made that clear."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1492053375, "post_id": 43381545, "comment_id": 73827735, "body": "there&#39;s no need to use <code>Columns(&quot;C:C&quot;).Select</code> , just insert it in the <code>Find</code> line, <code>a = Range(&quot;C:C&quot;).Find(...</code>. However, you need to check that <code>Find</code> is successful. A safer way would be, <code>Set Rng = Range(&quot;C:C&quot;).Find(...</code> , and after use <code>If Not Rng is Nothing Then</code> , <code>a = Rng.Address</code>."}], "tags": [], "owner": {"reputation": 170, "user_id": 7851883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abe8064acbf27c000ad0e2fb846ffd2c?s=128&d=identicon&r=PG&f=1", "display_name": "sadtank", "link": "https://stackoverflow.com/users/7851883/sadtank"}, "is_accepted": false, "score": 1, "last_activity_date": 1492042136, "creation_date": 1492042136, "answer_id": 43381545, "question_id": 43381169, "link": "https://stackoverflow.com/questions/43381169/vba-excel-define-range-by-yesterdays-date/43381545#43381545", "title": "VBA Excel - Define range by yesterdays date", "body": "<p>I'll get you 90% there. The code you want should look something like this. Based on your question I don't fully understand what vars you wanted set.</p>\n\n<pre><code>Dim d As Date\n d = DateAdd(\"d\", -1, Date)\n\nDim x As Range\nDim a As String\n\n'Range(\"e1\").Value = d\n\nColumns(\"C:C\").Select\na = Cells.Find(What:=d, After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    False, SearchFormat:=False).Address\n\n'Range(a).Offset(0, 31).Range(\"A1:B1\").Select\n'adjust this\n' x = Range(a).Offset(0, 31).Range(\"A1:B1\").Address\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 7859173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fea0f2674317fd3438228cf8eec8be1?s=128&d=identicon&r=PG&f=1", "display_name": "Loudo", "link": "https://stackoverflow.com/users/7859173/loudo"}, "edited": false, "score": 0, "creation_date": 1492062044, "post_id": 43383693, "comment_id": 73830253, "body": "This works perfectly, however the &quot;date&quot; is Column C is actually a Custom format of DD/MM/YYYY HH:MM:SS - I&#39;m assuming that it will not work with this at all?  Also, is there a way I can tweak this code to run from a different sheet in the workbook, or would it only work for the current active worksheet?  Thank you kindly for your help with this"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 39, "user_id": 7859173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fea0f2674317fd3438228cf8eec8be1?s=128&d=identicon&r=PG&f=1", "display_name": "Loudo", "link": "https://stackoverflow.com/users/7859173/loudo"}, "edited": false, "score": 0, "creation_date": 1492062086, "post_id": 43383693, "comment_id": 73830277, "body": "@Loudo did you try it ? let me know what you get"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1492058754, "creation_date": 1492058754, "answer_id": 43383693, "question_id": 43381169, "link": "https://stackoverflow.com/questions/43381169/vba-excel-define-range-by-yesterdays-date/43383693#43383693", "title": "VBA Excel - Define range by yesterdays date", "body": "<p>Try the code below (explanation inside the code comments):</p>\n\n<pre><code>Option Explicit\n\nSub FindYesterdaysDateRow()\n\nDim Rng     As Range\nDim YesterD As Date\n\nYesterD = DateAdd(\"d\", -1, Date) ' &lt;-- get yesterday's date\n\n' the following line will work if you have column C formatted as \"Date\"\nSet Rng = Range(\"C:C\").Find(What:=YesterD, LookIn:=xlValues, LookAt:=xlWhole)\n\nIf Not Rng Is Nothing Then '&lt;-- Find was successful\n    Range(\"A\" &amp; Rng.Row &amp; \":I\" &amp; Rng.Row).Select\nElse ' &lt;-- Find was unable to find yesterday's date\n    MsgBox \"Yesterday's date not found in Column C\"\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7859173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fea0f2674317fd3438228cf8eec8be1?s=128&d=identicon&r=PG&f=1", "display_name": "Loudo", "link": "https://stackoverflow.com/users/7859173/loudo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8202, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1492058754, "creation_date": 1492039371, "last_edit_date": 1492044756, "question_id": 43381169, "link": "https://stackoverflow.com/questions/43381169/vba-excel-define-range-by-yesterdays-date", "title": "VBA Excel - Define range by yesterdays date", "body": "<p>Within VBA, I am trying to set the range as the day previous to when the workbook is open (e.g. Workbook is open on the 13/04/2017, I want the range to be 12/04/2017)</p>\n\n<p>I would like VBA to search Column C for the previous day and when it finds it, it then selects the cells adjacent to it (A:I preferably).</p>\n\n<p>Then, with this information, I would like the range to be set as to what was found with the search - This will then be converted to HTML and sent as an email.</p>\n\n<p>Hopefully what I'm requesting makes sense.</p>\n"}, {"tags": ["excel", "vba", "loops", "date"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1492037904, "post_id": 43380815, "comment_id": 73823953, "body": "You should qualify all of your <code>Cells()</code> with a worksheet object, otherwise they default to the active sheet."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1492038260, "post_id": 43380815, "comment_id": 73824052, "body": "Also quality the <code>Rows.Count</code> with the sheet you expect the row count to occur on."}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "edited": false, "score": 0, "creation_date": 1492059497, "post_id": 43380815, "comment_id": 73829358, "body": "Strictly speaking, you don&#39;t need to qualify the references to cells and rows after activating the sheet you&#39;re working on. It won&#39;t make any difference to how your code operates. However, it is better practice because code is easier to read and safer because you don&#39;t have to always ensure the correct sheet is active when making changes to code. Not having to activate sheets also improves performance."}], "answers": [{"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1492058998, "creation_date": 1492058998, "answer_id": 43383735, "question_id": 43380815, "link": "https://stackoverflow.com/questions/43380815/automatically-updating-chart-in-vba/43383735#43383735", "title": "Automatically Updating Chart in VBA", "body": "<p>You determine the FinalRow before adding the date to the cell below it. The For loop stops at the FinalRow, which is before reaching the cell with the date you added.</p>\n\n<p>You either need to set the Date before determining the FinalRow, or loop i from 2 to FinalRow + 1</p>\n"}], "owner": {"reputation": 31, "user_id": 6866553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0bd3363a89f676f57a37923ecf8477?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6866553/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492058998, "creation_date": 1492037094, "question_id": 43380815, "link": "https://stackoverflow.com/questions/43380815/automatically-updating-chart-in-vba", "title": "Automatically Updating Chart in VBA", "body": "<p>I'm wondering why my code isn't working</p>\n\n<pre><code>Sheets(\"Chart\").Activate\n\nFinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nRange(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Value = Date\n\nFor i = 2 To FinalRow\n    If Cells(i, 1).Value = Date Then\n        Cells(i, 2).Value = Sheets(\"Main Sheet\").Range(\"D2\").Value\n        Cells(i, 4).Value = Sheets(\"Main Sheet\").Range(\"D3\").Value\n    End If\nNext i\n</code></pre>\n\n<p>The loop appears to ignore the date value placed in column A. Am I missing something?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492036402, "post_id": 43380594, "comment_id": 73823486, "body": "Relabel your worksheets 01_abc, 02_adf, 03_dasf, 11_ad etc."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1492036758, "post_id": 43380594, "comment_id": 73823602, "body": "You&#39;re using the <code>&gt;</code> comparison in both blocks - look again at the original code"}, {"owner": {"reputation": 4592, "user_id": 2543622, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/9c20a1658db39998c589a874842c8e03?s=128&d=identicon&r=PG", "display_name": "user2543622", "link": "https://stackoverflow.com/users/2543622/user2543622"}, "edited": false, "score": 0, "creation_date": 1492036892, "post_id": 43380594, "comment_id": 73823656, "body": "thanks Tim. It is working now"}], "answers": [{"comments": [{"owner": {"reputation": 4592, "user_id": 2543622, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/9c20a1658db39998c589a874842c8e03?s=128&d=identicon&r=PG", "display_name": "user2543622", "link": "https://stackoverflow.com/users/2543622/user2543622"}, "edited": false, "score": 0, "creation_date": 1492036686, "post_id": 43380689, "comment_id": 73823573, "body": "Thanks. I tried but it is giving problem in update1 above"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 4592, "user_id": 2543622, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/9c20a1658db39998c589a874842c8e03?s=128&d=identicon&r=PG", "display_name": "user2543622", "link": "https://stackoverflow.com/users/2543622/user2543622"}, "edited": false, "score": 0, "creation_date": 1492036795, "post_id": 43380689, "comment_id": 73823615, "body": "You need one block with <code>&gt;</code> and one with <code>&lt;</code>"}, {"owner": {"reputation": 4592, "user_id": 2543622, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/9c20a1658db39998c589a874842c8e03?s=128&d=identicon&r=PG", "display_name": "user2543622", "link": "https://stackoverflow.com/users/2543622/user2543622"}, "edited": false, "score": 0, "creation_date": 1492445451, "post_id": 43380689, "comment_id": 73965691, "body": "i have sheets like 01_Sheet2, 02_Sheet3, 1_Sheet1 and this vba code is putting 1_Sheet1 at the end. I would 1_Sheet1 to apper before 02_Sheet3 as &#39;1&#39; is &lt; &#39;02&#39;. How should i modify this code?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 4592, "user_id": 2543622, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/9c20a1658db39998c589a874842c8e03?s=128&d=identicon&r=PG", "display_name": "user2543622", "link": "https://stackoverflow.com/users/2543622/user2543622"}, "edited": false, "score": 0, "creation_date": 1492497371, "post_id": 43380689, "comment_id": 73985759, "body": "That&#39;s quite different from your original question - You should post a new question for this"}, {"owner": {"reputation": 4592, "user_id": 2543622, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/9c20a1658db39998c589a874842c8e03?s=128&d=identicon&r=PG", "display_name": "user2543622", "link": "https://stackoverflow.com/users/2543622/user2543622"}, "edited": false, "score": 0, "creation_date": 1492538239, "post_id": 43380689, "comment_id": 74013575, "body": "done - <a href=\"http://stackoverflow.com/questions/43479146/excel-vba-sort-sheet-numerically-by-looking-at-first-few-characters\" title=\"excel vba sort sheet numerically by looking at first few characters\">stackoverflow.com/questions/43479146/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 6, "last_activity_date": 1492036398, "creation_date": 1492036398, "answer_id": 43380689, "question_id": 43380594, "link": "https://stackoverflow.com/questions/43380594/excel-vba-sort-sheet-numerically/43380689#43380689", "title": "excel vba sort sheet numerically", "body": "<p>Instead of this:</p>\n\n<pre><code>If UCase(Worksheets(N).Name) &gt; UCase(Worksheets(M).Name) Then     \n</code></pre>\n\n<p>you need something like this:</p>\n\n<pre><code>If CLng(Split(Worksheets(N).Name,\"_\")(0)) &gt; _\n   CLng(Split(Worksheets(M).Name,\"_\")(0)) Then\n</code></pre>\n"}], "owner": {"reputation": 4592, "user_id": 2543622, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/9c20a1658db39998c589a874842c8e03?s=128&d=identicon&r=PG", "display_name": "user2543622", "link": "https://stackoverflow.com/users/2543622/user2543622"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1586, "favorite_count": 0, "accepted_answer_id": 43380689, "answer_count": 1, "score": 1, "last_activity_date": 1599383141, "creation_date": 1492035879, "last_edit_date": 1492036660, "question_id": 43380594, "link": "https://stackoverflow.com/questions/43380594/excel-vba-sort-sheet-numerically", "title": "excel vba sort sheet numerically", "body": "<p>I want to sort sheets in my excel file. I found <a href=\"http://www.vbaexpress.com/kb/getarticle.php?kb_id=72\" rel=\"nofollow noreferrer\">this</a> code which works. But the problem is that my sheet names are 1_abc, 2_adf, 3_dasf, 11_ad etc. This code puts 11_ad before 2_adf and 3_dasf. I would like to sort sheets based upon number before \"_\" (first underscore) in my sheet name. How could I do the same?</p>\n\n################################UPDATE1\n\n<p>I modified the code as below. But it is sorting in descending order :(. I want to sort in ascending order</p>\n\n<pre><code>Option Explicit\n\nSub SortWorksheets()\n\n    Dim N As Integer\n    Dim M As Integer\n    Dim FirstWSToSort As Integer\n    Dim LastWSToSort As Integer\n    Dim SortDescending As Boolean\n\n    SortDescending = False\n\n    If ActiveWindow.SelectedSheets.Count = 1 Then\n\n         'Change the 1 to the worksheet you want sorted first\n        FirstWSToSort = 1\n        LastWSToSort = Worksheets.Count\n    Else\n        With ActiveWindow.SelectedSheets\n            For N = 2 To .Count\n                If .Item(N - 1).Index &lt;&gt; .Item(N).Index - 1 Then\n                    MsgBox \"You cannot sort non-adjacent sheets\"\n                    Exit Sub\n                End If\n            Next N\n            FirstWSToSort = .Item(1).Index\n            LastWSToSort = .Item(.Count).Index\n        End With\n    End If\n\n    For M = FirstWSToSort To LastWSToSort\n        For N = M To LastWSToSort\n            If SortDescending = True Then\n                If CLng(Split(Worksheets(N).Name, \"_\")(0)) &gt; _\n   CLng(Split(Worksheets(M).Name, \"_\")(0)) Then\n                    Worksheets(N).Move Before:=Worksheets(M)\n                End If\n            Else\n                If CLng(Split(Worksheets(N).Name, \"_\")(0)) &gt; _\n   CLng(Split(Worksheets(M).Name, \"_\")(0)) Then\n                    Worksheets(N).Move Before:=Worksheets(M)\n                End If\n            End If\n        Next N\n    Next M\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492038171, "post_id": 43380593, "comment_id": 73824024, "body": "There&#39;s always a way to &quot;combine&quot; many objectives. For example you can write some linear combination of two objectives in a cell which you set as the target to optimize. This is all I can say for now as it is not clear what are the two objectives you want to combine and how."}, {"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492041746, "post_id": 43380593, "comment_id": 73825017, "body": "Need to maximise the value of N1 while minimising the value of O1"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492043427, "post_id": 43380593, "comment_id": 73825424, "body": "One way would be to maximize (say <code>Q1</code>) <code>=N1-O1</code>, <code>=10*N1-O1</code>, etc.. Also possible is to maximize <code>=Min(N1, -O1)</code>. The choice depends on the model you&#39;re trying to solve."}], "answers": [{"tags": [], "owner": {"reputation": 40, "user_id": 7554291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aad891af8eaf024d92abe56754c2a7c?s=128&d=identicon&r=PG", "display_name": "Algau", "link": "https://stackoverflow.com/users/7554291/algau"}, "is_accepted": true, "score": 2, "last_activity_date": 1601610245, "last_edit_date": 1601610245, "creation_date": 1492141846, "answer_id": 43404936, "question_id": 43380593, "link": "https://stackoverflow.com/questions/43380593/multiple-objectives-in-excel-solver/43404936#43404936", "title": "Multiple objectives in Excel solver", "body": "<p>You shall see this as a sequential process.</p>\n<ol>\n<li>Obtain the initial optimal solution.</li>\n<li>Add the optimal value to the system of constraints.</li>\n<li>Solve again the whole problem, but with your new objective wich would be to maximize (or minimize) your variable of interest.</li>\n</ol>\n<p>So your first objective will be fulfilled, and by adding it's optimal value to the system of constraints it won't be possible to affect it. And then, as long as it doesn't interfere with the previous objective, your second objective will also be fulfilled.</p>\n<p>In fact, doing so you could add as many objectives as you want and they would be solve with a lexicographic order (higher priority given to the previous objective).</p>\n"}], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8171, "favorite_count": 0, "accepted_answer_id": 43404936, "answer_count": 1, "score": 1, "last_activity_date": 1601610245, "creation_date": 1492035869, "question_id": 43380593, "link": "https://stackoverflow.com/questions/43380593/multiple-objectives-in-excel-solver", "title": "Multiple objectives in Excel solver", "body": "<p>I have a macro that runs through multiple sets of permutations using Excel's solver. Each macro runs the solver 3 times, using Simplex followed by 2 x Evolutionary. It seems to work reasonably well.</p>\n\n<p>However, I noticed that the solution keeps changing, due to one of the variables only being constrained by a maximum value. As such, I need to make the variable a max/min objective. </p>\n\n<p>I know that Excel's solver only allows for one max/min objective. Is there any way that I can set a second max/min objective?</p>\n\n<p>The code I have is as follows:</p>\n\n<pre><code>a = Range(\"Q1\")\n\n    SolverReset\n    SolverOk SetCell:=\"$N$1\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$M$2:$M\" &amp; a, _\n        Engine:=3, EngineDesc:=\"Simplex LP\"\n    SolverAdd CellRef:=\"$O$1\", Relation:=1, FormulaText:=\"80\"\n    SolverAdd CellRef:=\"$M$1\", Relation:=2, FormulaText:=\"8\"\n    SolverAdd CellRef:=\"$P$1\", Relation:=3, FormulaText:=\"5\"\n    SolverOk SetCell:=\"$N$1\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$M$2:$M\" &amp; a, _\n        Engine:=3, EngineDesc:=\"Simplex LP\"\n    SolverAdd CellRef:=\"$M$2:$M\" &amp; a, Relation:=4, FormulaText:=\"integer\"\n    SolverAdd CellRef:=\"$M$2:$M\" &amp; a, Relation:=1, FormulaText:=\"1\"\n    SolverAdd CellRef:=\"$M$2:$M\" &amp; a, Relation:=3, FormulaText:=\"0\"\n    SolverOk SetCell:=\"$N$1\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$M$2:$M\" &amp; a, _\n        Engine:=3, EngineDesc:=\"Simplex LP\"\n    SolverSolve ShowRef = 0\n\n    SolverReset\n    SolverOk SetCell:=\"$N$1\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$M$2:$M\" &amp; a, _\n        Engine:=3, EngineDesc:=\"Evolutionary\"\n    SolverAdd CellRef:=\"$O$1\", Relation:=1, FormulaText:=\"80\"\n    SolverAdd CellRef:=\"$M$1\", Relation:=2, FormulaText:=\"8\"\n    SolverAdd CellRef:=\"$P$1\", Relation:=3, FormulaText:=\"5\"\n    SolverOk SetCell:=\"$N$1\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$M$2:$M\" &amp; a, _\n        Engine:=3, EngineDesc:=\"Evolutionary\"\n    SolverAdd CellRef:=\"$M$2:$M\" &amp; a, Relation:=4, FormulaText:=\"integer\"\n    SolverAdd CellRef:=\"$M$2:$M\" &amp; a, Relation:=1, FormulaText:=\"1\"\n    SolverAdd CellRef:=\"$M$2:$M\" &amp; a, Relation:=3, FormulaText:=\"0\"\n    SolverOk SetCell:=\"$N$1\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$M$2:$M\" &amp; a, _\n        Engine:=3, EngineDesc:=\"Evolutionary\"\n    SolverSolve ShowRef = 0\n\n    SolverReset\n    SolverOk SetCell:=\"$N$1\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$M$2:$M\" &amp; a, _\n        Engine:=3, EngineDesc:=\"Evolutionary\"\n    SolverAdd CellRef:=\"$O$1\", Relation:=1, FormulaText:=\"80\"\n    SolverAdd CellRef:=\"$M$1\", Relation:=2, FormulaText:=\"8\"\n    SolverAdd CellRef:=\"$P$1\", Relation:=3, FormulaText:=\"5\"\n    SolverOk SetCell:=\"$N$1\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$M$2:$M\" &amp; a, _\n        Engine:=3, EngineDesc:=\"Evolutionary\"\n    SolverAdd CellRef:=\"$M$2:$M\" &amp; a, Relation:=4, FormulaText:=\"integer\"\n    SolverAdd CellRef:=\"$M$2:$M\" &amp; a, Relation:=1, FormulaText:=\"1\"\n    SolverAdd CellRef:=\"$M$2:$M\" &amp; a, Relation:=3, FormulaText:=\"0\"\n    SolverOk SetCell:=\"$N$1\", MaxMinVal:=1, ValueOf:=0, ByChange:=\"$M$2:$M\" &amp; a, _\n        Engine:=3, EngineDesc:=\"Evolutionary\"\n    SolverSolve ShowRef = 0\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1492036308, "post_id": 43380475, "comment_id": 73823458, "body": "Does your listbox actually have 15 columns  if not &#39;ListBox1.Column(a)&#39; will cause errors when a goes above the number of columns?  Generally I expect at most a couple columns in a single listbox.  Also &#39;rows.count&#39; will probably cause an error as it needs the worksheet name &#39;Sheet1.rows.count&#39;"}, {"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1492036510, "post_id": 43380475, "comment_id": 73823519, "body": "thank you for replying. Yes my sheet has 14 columns. 0 - 15 Controls(&quot;textbox&quot; &amp; a + 1) = ListBox1.Column(a) is where i get the error."}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1492036744, "post_id": 43380475, "comment_id": 73823595, "body": "in your macro your reference <code>ListBox1.Column(a)</code> which means your listbox needs 15 columns (not your sheet)"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1492037077, "post_id": 43380684, "comment_id": 73823725, "body": "if i hover over with the mouse in debug, it shows a = 14"}, {"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1492037407, "post_id": 43380684, "comment_id": 73823826, "body": "Private Sub UserForm_Initialize() Dim price As Double price = 0  Sheet1.Activate ListBox1.ColumnWidths = &quot;40;50;40;65;65;180;40;40;60;40;60;30;30;60&quot;         &#39;Column Widths Of Listbox ListBox1.ColumnCount = 14                                                        &#39;Column Count Of Listbox ListBox1.List = Sheet1.Range(&quot;A2:N&quot; &amp; Sheet1.Cells(Rows.Count, 1).End(xlUp).Row).Value"}], "tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": false, "score": 0, "last_activity_date": 1492036364, "creation_date": 1492036364, "answer_id": 43380684, "question_id": 43380475, "link": "https://stackoverflow.com/questions/43380475/could-not-get-column-property-error-that-i-can-not-figure-out/43380684#43380684", "title": "could not get column property error that i can not figure out", "body": "<p>Likely your listbox has less then 15 columns. </p>\n\n<p><code>ListBox1.Column(a)</code> will cause errors when a goes above the number of columns you have in the listbox (not the sheet). Generally I expect at most a couple columns in a single listbox.  </p>\n\n<p>Also <code>rows.count</code> will probably cause an error as it needs the worksheet name <code>Sheet1.rows.count</code></p>\n"}], "owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1024, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492036364, "creation_date": 1492035137, "question_id": 43380475, "link": "https://stackoverflow.com/questions/43380475/could-not-get-column-property-error-that-i-can-not-figure-out", "title": "could not get column property error that i can not figure out", "body": "<p>Can please someone tell me what the problem is with this code. If i uncomment the code on error resume next the code works. but without i get error, could not get column property, invalid argument. This happens when i click in de listbox. I can not figure out what the problem is. i have a sheet whit 14 columns, starting from A, offset 1 row</p>\n\n<pre><code>Private Sub ListBox1_Click()   \n  Dim say, lastrow As Long, a As Byte\n  'On Error Resume Next\n'ListBox1.MultiSelect = 0\nOptionButton1.Value = True\nFor a = 0 To 15\nControls(\"textbox\" &amp; a + 1) = ListBox1.Column(a)\nNext a\n\nlastrow = Sheet1.Cells(Rows.Count, \"B\").End(xlUp).Row\nSheet1.Activate\nSheet1.Range(\"B2:B\" &amp; lastrow).Find(What:=ListBox1.Value, LookIn:=xlValues, LookAt:=xlWhole).Activate\n\nsay = ActiveCell.Row\nTextBox15.Value = say\nSheet1.Range(\"A\" &amp; say &amp; \":N\" &amp; say).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492033688, "post_id": 43380158, "comment_id": 73822460, "body": "A lot will depend on what you mean by &quot;duplicates&quot;, but have you tried using Excel&#39;s &quot;Remove Duplicates&quot; feature?  (Either manually or via code.)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1492033704, "post_id": 43380158, "comment_id": 73822465, "body": "Are the duplicates due to the code, or do your various COLLAB sheets have duplicates when all combined on the main sheet?"}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1492033931, "post_id": 43380158, "comment_id": 73822562, "body": "@BruceWayne I think it&#39;s the code. Have a look at the screenshots i posted. It seems to have nothing to do with my sheets duplicates."}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492034000, "post_id": 43380158, "comment_id": 73822588, "body": "@YowE3K No I didn&#39;t. Please have a look at the screenshots."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492034059, "post_id": 43380158, "comment_id": 73822615, "body": "Without seeing what is on sheets &quot;COLLAB1&quot;, &quot;COLLAB2&quot; and &quot;COLLAB3&quot;, it&#39;s hard to tell whether the problem is with the code or with the data."}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492034143, "post_id": 43380158, "comment_id": 73822641, "body": "@YowE3K  Just random things for testing purposes. I&#39;ll upload screenshots of both sheets in a few seconds."}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492034386, "post_id": 43380158, "comment_id": 73822717, "body": "@YowE3K. Can&#39;t add them to the main post. Here they are. <a href=\"https://i.stack.imgur.com/d3qiR.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/d3qiR.png</a> <a href=\"https://i.stack.imgur.com/W5Q4L.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/W5Q4L.png</a> <a href=\"https://i.stack.imgur.com/UZiav.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/UZiav.png</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1492035039, "post_id": 43380158, "comment_id": 73822985, "body": "Yeah, you have duplicate data, don&#39;t you? Just run <code>Remove Duplicates</code> after it&#39;s all on your main sheet...Unless I&#39;m missing something.  How do you know which ones to keep, is it based on column A?  That does change...but perhaps <i>before</i> adding to the sheet, do a check that If value X already exists in main sheet, go to next row, otherwise copy?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1492035408, "post_id": 43380158, "comment_id": 73823137, "body": "@BruceWayne - But that final results is showing <b>two</b> of everything.  I.e. 8 rows from COLLAB1, 7 rows from COLLAB2, 7 rows from COLLAB3 = 22 rows, but COLLABT has those 22 rows <b>twice</b>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1492035483, "post_id": 43380158, "comment_id": 73823173, "body": "Your code shows no check to see if a record exists before dumping the row data into the master sheet. If you do not want to check to see if a record exists then use remove duplicates (as suggested by @BruceWayne) after dumping all of the records."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492035516, "post_id": 43380158, "comment_id": 73823191, "body": "@MaximusE. I tested the code and it works for me (providing I first put something into row 1 of COLLABT so that the <code>UsedRange.Rows.Count</code> gives the correct last row - but without that fix it just writes everything to row 2 over and over)"}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1492035545, "post_id": 43380158, "comment_id": 73823198, "body": "@BruceWayne You&#39;re right, it works. I was expecting a different behavior. How can i automate the process like you suggested ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492035576, "post_id": 43380158, "comment_id": 73823207, "body": "Record yourself doing it."}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492035753, "post_id": 43380158, "comment_id": 73823271, "body": "@YowE3K That&#39;s exactly what i was talking about. i have the final results twice. I put the same things in row 1 of COLLABT as i have in COLLAB1 to 3,  but i still have twice the result. Did i miss something?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492035767, "post_id": 43380158, "comment_id": 73823274, "body": "I&#39;d still like to know <b>why</b> it is generating two of every record!!  (Remove Duplicates will fix the symptoms, but I&#39;d rather find the cause of the problem.)"}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "edited": false, "score": 0, "creation_date": 1492035819, "post_id": 43380158, "comment_id": 73823295, "body": "@Jeeped what should i add to my code to check if a record exists?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492035845, "post_id": 43380158, "comment_id": 73823300, "body": "@MaximusE. - If you put the same things in row 1 of COLLABT as each of the other sheets, why don&#39;t they still appear in your screendump - that may be another symptom of what is happening."}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492035978, "post_id": 43380158, "comment_id": 73823345, "body": "@YowE3K I manually deleted everything from the COLLABT sheet to see if it would fix the issue while i was looking for a solution (just CTRL+A and DEL). I forgot to copy back the first row afterwards."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492036109, "post_id": 43380158, "comment_id": 73823388, "body": "@MaximusE. If you did a CTRL+A / DEL, you would have ended up with information only in row 2.  Do you have other code that you haven&#39;t included in the question?"}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492036136, "post_id": 43380158, "comment_id": 73823393, "body": "@YowE3K I spent 4 hours trying to figure this out. Granted, I am not very good at coding, but still."}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492036351, "post_id": 43380158, "comment_id": 73823470, "body": "@YowE3K I have 2 pivot tables in the &quot;synthese collaborateur&quot; and &quot;detail collaborateur&quot; sheets. The only coded besides the macro is the click button   Private Sub CommandButton1_Click() COLLABT End Sub  Did the same thing once again. CTRL+A / DEL. it deleted the first row (titles), and still gave me twice the result, like shown in the screenshot."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492036575, "post_id": 43380158, "comment_id": 73823539, "body": "@MaximusE. I&#39;m going to have to give up and start working on my paid job now, but I will certainly be coming back later today to see if anyone has come up with an explanation for this!"}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492036828, "post_id": 43380158, "comment_id": 73823626, "body": "@YowE3K No problem. Thanks a lot for you help, much appreciated. AS a side note, i kept pressing the button after that CTRL+A/ DEL and it skipped a few rows before duplicating the results..."}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "edited": false, "score": 0, "creation_date": 1492037111, "post_id": 43380158, "comment_id": 73823732, "body": "@Jeeped I recorded the macro, then tried to copy the resulting code at the end of my 1st macro, didn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "edited": false, "score": 0, "creation_date": 1492087485, "post_id": 43382943, "comment_id": 73846264, "body": "Fixed the duplicates, thanks. But it doesn&#39;t copy some of the fields to COLLABT as it should: the date column (B) returns #######, the I column is not returned for COLLAB2 and 3. Samethings goes for parts of the E column."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "edited": false, "score": 0, "creation_date": 1492127695, "post_id": 43382943, "comment_id": 73867298, "body": "I&#39;m glad the duplicates issue was fixed. So, your question was answered, your problem solved, and what remains is for you to accept the answer. If the code doesn&#39;t copy the parts you want, that is another matter which should be posted as another question and will receive an answer, from me or others, if it complies with site rules which, at this moment, it doesn&#39;t."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "edited": false, "score": 0, "creation_date": 1492129941, "post_id": 43382943, "comment_id": 73867743, "body": "When you start your own effort prior to asking your next question please bear in mind that <code>######</code> is an output Excel uses to indicate overflow, meaning the column is too narrow to display the cell&#39;s assigned value. You often get this with dates. The cure is to either widen the column or change the date format. In the context of this thread I see it as an indication that my code assigns a value to a wrong column. Expanding the column to see what causes the error may help you find its source, eliminating the need for another question."}, {"owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "edited": false, "score": 0, "creation_date": 1492174653, "post_id": 43382943, "comment_id": 73882685, "body": "Thank you. Found it yesterday."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 0, "last_activity_date": 1492053322, "creation_date": 1492053322, "answer_id": 43382943, "question_id": 43380158, "link": "https://stackoverflow.com/questions/43380158/duplicate-results-with-excel-macro/43382943#43382943", "title": "Duplicate results with excel macro", "body": "<p>There are a few things in this code which I instinctively don't like. Such as,</p>\n\n<ol>\n<li>It calls a lot of sheet it doesn't want to use.</li>\n<li>It uses <code>.End(xlUp).Row</code> as the last number in the <code>For ... Next</code> declaration. I distrust this number if it is calculated anew on each loop in which I make changes to worksheets.</li>\n<li>The code also used <code>.UsedRange.Rows.Count + 1</code> to introduce instability. I like to take control of my numbers before the looping starts and then keep control of them while looping.</li>\n</ol>\n\n<p>The following code does that.</p>\n\n<pre><code>Sub COLLABT()\n\n    Dim ShNames() As String\n    Dim i As Integer\n    Dim Rng As Range\n    Dim Sh As Worksheet\n    Dim Rsl As Long                             ' Last row: Source\n    Dim Rs As Long, Rt                          ' Row: Source / Target\n\n    ShNames = Split(\"COLLAB1,COLLAB2,COLLAB3\", \",\")\n    With Worksheets(\"COLLABT\")\n        Set Rng = .Range(.Rows(2), .Rows(.UsedRange.Row + .UsedRange.Rows.Count))\n        Rng.ClearContents\n\n        For i = 0 To UBound(ShNames)\n            Set Sh = Worksheets(ShNames(i))\n            Rt = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n            Rsl = Sh.Cells(Sh.Rows.Count, 1).End(xlUp).Row\n            For Rs = 2 To Rsl\n                Set Rng = Sh.Range(Sh.Cells(Rs, 1), Sh.Cells(Rs, 15))\n                Rng.Copy Destination:=.Cells(Rt, 1)\n                Rt = Rt + 1\n            Next Rs\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>I don't say that any of the above mentioned factors must be to blame, but they might, and if my code doesn't produce the same result that would prove my point.</p>\n\n<p>Frankly, when asked what the real source of the problem might be, I would look at the calling of the procedure first. Is there an event procedure somewhere in the background that reacts to anything the code does and effectively calls it twice? Or, even simpler, is this an error which can only occur during testing, such as the data actually being duplicated in one of the source sheets? That's what I would check first, but since I don't have access to the facts, I wrote code. Please try it.</p>\n"}], "owner": {"reputation": 43, "user_id": 6849788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/457badf1c292c91b306084abef42b59a?s=128&d=identicon&r=PG&f=1", "display_name": "Maximus E.", "link": "https://stackoverflow.com/users/6849788/maximus-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 43382943, "answer_count": 1, "score": 0, "last_activity_date": 1492053322, "creation_date": 1492033486, "last_edit_date": 1531161705, "question_id": 43380158, "link": "https://stackoverflow.com/questions/43380158/duplicate-results-with-excel-macro", "title": "Duplicate results with excel macro", "body": "<p>I have one sheet (COLLABT) on an excel file that displays some informations from 3 other worksheets (COLLAB1,COLLAB2 and COLLAB3). My problem is that i have duplicates of the results.\nDoes anyone knows how to fix this?</p>\n\n<p>Here is the code of my macro </p>\n\n<pre><code>    Sub COLLABT()\nWith Sheets(\"COLLABT\")\n.Range(\"A2:O65536\").Delete\n      For Each sh In Sheets\nSelect Case sh.Name\n  Case \"COLLAB1\", \"COLLAB2\", \"COLLAB3\"\n    For lg = 2 To sh.Range(\"A65536\").End(xlUp).Row\n      LgS = .UsedRange.Rows.Count + 1\n      .Cells(LgS, 1) = sh.Cells(lg, 1)\n      .Cells(LgS, 2) = sh.Cells(lg, 2)\n      .Cells(LgS, 3) = sh.Cells(lg, 3)\n      .Cells(LgS, 4) = sh.Cells(lg, 4)\n      .Cells(LgS, 5) = sh.Cells(lg, 5)\n      .Cells(LgS, 6) = sh.Cells(lg, 6)\n      .Cells(LgS, 7) = sh.Cells(lg, 7)\n      .Cells(LgS, 8) = sh.Cells(lg, 8)\n      .Cells(LgS, 9) = sh.Cells(lg, 9)\n      .Cells(LgS, 10) = sh.Cells(lg, 10)\n      .Cells(LgS, 11) = sh.Cells(lg, 11)\n      .Cells(LgS, 12) = sh.Cells(lg, 12)\n      .Cells(LgS, 13) = sh.Cells(lg, 13)\n      .Cells(LgS, 14) = sh.Cells(lg, 14)\n      .Cells(LgS, 15) = sh.Cells(lg, 15)\n\n    Next\n\n\nEnd Select\nNext\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Here is the current result</p>\n\n<p><a href=\"https://i.stack.imgur.com/Hgu9g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Hgu9g.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is what it should be </p>\n\n<p>[<img src=\"https://i.stack.imgur.com/oX2Wo.png\" alt=\"enter image description here\"><a href=\"https://i.stack.imgur.com/oX2Wo.png\" rel=\"nofollow noreferrer\">2</a></p>\n"}, {"tags": ["vba", "file-upload", "winhttprequest"], "owner": {"reputation": 173, "user_id": 4273095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/A34DI.png?s=128&g=1", "display_name": "Seraphim", "link": "https://stackoverflow.com/users/4273095/seraphim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1128, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499905446, "creation_date": 1492032995, "question_id": 43380047, "link": "https://stackoverflow.com/questions/43380047/basic-upload-using-vba", "title": "Basic Upload Using VBA", "body": "<p>I am trying to understand the file upload process using vba and winhttp. </p>\n\n<p>I am trying to upload files to:\n<a href=\"https://uploadfiles.io/\" rel=\"nofollow noreferrer\">https://uploadfiles.io/</a></p>\n\n<p>Using the following code in VBA:</p>\n\n<pre><code>Public Function GetFileBytes(ByVal path As String) As Byte()\n    Dim lngFileNum As Long\n    Dim bytRtnVal() As Byte\n    lngFileNum = FreeFile\n    If LenB(Dir(path)) Then ''// Does file exist?\n        Open path For Binary Access Read As lngFileNum\n        ReDim bytRtnVal(LOF(lngFileNum) - 1&amp;) As Byte\n        Get lngFileNum, , bytRtnVal\n        Close lngFileNum\n    Else\n        Err.Raise 53\n    End If\n    GetFileBytes = bytRtnVal\n    Erase bytRtnVal\nEnd Function\n\nSub testLoad()\nDim http\nDim filedata() As Byte\n\nfiledata = GetFileBytes(\"C:\\apps\\somefile.pdf\")\nSet http = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nURL = \"https://uploadfiles.io/upload\"\nhttp.Open \"POST\", URL, False\n\nhttp.setRequestHeader \"Content-Type\", \"multipart/form-data; boundary=---------------------------7e1881e4703b8\" 'Add boundary\nhttp.setRequestHeader \"Content-Length\", 80047 'Add length\n\nhttp.send filedata\n\nMsgBox http.Status\nEnd Sub\n</code></pre>\n\n<p>I am a pretty big noob working with the web and winhttp. Using this code I get a successful 200 response... I think. But I have no idea where the file is now that it is uploaded. So here are my questions:</p>\n\n<p>1.) Where and how do I set the file information as it is being uploaded?</p>\n\n<p>2.) What exactly is the \"boundary=\" in the requestHeader? I manually set this by watching the network traffic, but I don't know what it means.</p>\n\n<p>3.) What is the length in the requestHeader? Can I use len(filedata)</p>\n\n<p>Any help would be greatly appreciated, thank you.</p>\n"}, {"tags": ["vba", "knockout.js"], "comments": [{"owner": {"reputation": 2129, "user_id": 2000930, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c62a49bf0db3da3f986eb4edbcbc0efd?s=128&d=identicon&r=PG", "display_name": "Dandy", "link": "https://stackoverflow.com/users/2000930/dandy"}, "edited": false, "score": 0, "creation_date": 1492075568, "post_id": 43379950, "comment_id": 73837900, "body": "Try calling &#39;blur&#39; on element after you insert value."}, {"owner": {"reputation": 36, "user_id": 7858613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9e838a738e679dc10419d7a507ffa6?s=128&d=identicon&r=PG&f=1", "display_name": "moconnorism", "link": "https://stackoverflow.com/users/7858613/moconnorism"}, "reply_to_user": {"reputation": 2129, "user_id": 2000930, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c62a49bf0db3da3f986eb4edbcbc0efd?s=128&d=identicon&r=PG", "display_name": "Dandy", "link": "https://stackoverflow.com/users/2000930/dandy"}, "edited": false, "score": 0, "creation_date": 1492110644, "post_id": 43379950, "comment_id": 73860632, "body": "How do I call blur?"}, {"owner": {"reputation": 36, "user_id": 7858613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9e838a738e679dc10419d7a507ffa6?s=128&d=identicon&r=PG&f=1", "display_name": "moconnorism", "link": "https://stackoverflow.com/users/7858613/moconnorism"}, "reply_to_user": {"reputation": 2129, "user_id": 2000930, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c62a49bf0db3da3f986eb4edbcbc0efd?s=128&d=identicon&r=PG", "display_name": "Dandy", "link": "https://stackoverflow.com/users/2000930/dandy"}, "edited": false, "score": 0, "creation_date": 1492111634, "post_id": 43379950, "comment_id": 73861075, "body": "I&#39;ve added the following line of code but unfortunately it didn&#39;t do anything....     firstName.FireEvent &quot;onblur&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 454, "user_id": 11845595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/788c050470ff65674e12c2b4294dfffa?s=128&d=identicon&r=PG&f=1", "display_name": "FAlonso", "link": "https://stackoverflow.com/users/11845595/falonso"}, "is_accepted": false, "score": 0, "last_activity_date": 1566270697, "creation_date": 1566270697, "answer_id": 57566233, "question_id": 43379950, "link": "https://stackoverflow.com/questions/43379950/using-vba-how-do-i-input-a-value-to-a-input-text-box-on-a-webpage-that-uses-k/57566233#57566233", "title": "Using VBA, how do I input a value to a &lt;input&gt; text box on a webpage that uses Knockout JS?", "body": "<p>Basically, you would need to handle such automated inputs as 'HTMLevents' and trigger them. An updated snippet from your original code:</p>\n\n<pre><code>                    With hDoc\n                        Set evt = hDoc.createEvent(\"HTMLEvents\")\n                        evt.initEvent \"change\", True, False\n                        firstName.Value = \"Joe\"\n                        firstName.dispatchEvent evt\n                    End With\n</code></pre>\n\n<p>Tested this code and works fine for the website that link that you have provided.</p>\n\n<p>I have done tons of website automations with VBA and the most robust approach is to create one event, specific to each field that you would want to fill, assign a value to the field, and dispatch the event that you have created.</p>\n\n<p>For further information, refer to the documentation on MSDN <a href=\"https://msdn.microsoft.com/en-us/ie/ff975247(v=vs.94)\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/ie/ff975247(v=vs.94)</a></p>\n"}], "owner": {"reputation": 36, "user_id": 7858613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9e838a738e679dc10419d7a507ffa6?s=128&d=identicon&r=PG&f=1", "display_name": "moconnorism", "link": "https://stackoverflow.com/users/7858613/moconnorism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566270697, "creation_date": 1492032525, "last_edit_date": 1495541849, "question_id": 43379950, "link": "https://stackoverflow.com/questions/43379950/using-vba-how-do-i-input-a-value-to-a-input-text-box-on-a-webpage-that-uses-k", "title": "Using VBA, how do I input a value to a &lt;input&gt; text box on a webpage that uses Knockout JS?", "body": "<p>I'm trying to populate a form on a webpage that uses Knockout JS. When I insert a value into a particular text box it appears to have taken the value but when I submit the form it retains it's previous value. With a bit of digging around I've discovered that Knockout JS uses data-binding to update the underlying value. When I insert a value into the input text box the Knockout JS is not being triggered and therefore not updating the underlying value. <a href=\"https://stackoverflow.com/questions/38168722/excel-vba-controls-webpage-with-knockout-fills-out-details-clicks-on-save-app\">This post</a> is for something similar but with a check box and dropdown box rather than a text box. But I can't figure out how to get it working with a text box.</p>\n\n<p>The actual website I'm trying update requires a login, however I think this page on the Knockout JS Site <a href=\"http://knockoutjs.com/examples/helloWorld.html\" rel=\"nofollow noreferrer\">http://knockoutjs.com/examples/helloWorld.html</a> will suffice for testing purposes. </p>\n\n<p>Basically what I need is, using VBA, to enter a FirstName and LastName in the 2 text boxes (where it currently says 'Planet' and 'Earth'). You should see the 2 input values appear immediately below where it says 'Hello Planet Earth'. Typing it manually into the text boxes works fine. But I just can't get it to work in VBA.</p>\n\n<p>Here' what I have so far...</p>\n\n<pre><code>Sub KnockoutTest()\n\n\nDim IE As New InternetExplorer\nDim hDoc As HTMLDocument\n\nIE.Visible = True\n\n\n'Load webpage and loop until loading is complete.\nIE.Navigate \"http://knockoutjs.com/examples/helloWorld.html\"\nDo While (IE.Busy Or IE.ReadyState &lt;&gt; READYSTATE_COMPLETE)\n  DoEvents\nLoop\n\nSet hDoc = IE.Document\n\nSet firstName = hDoc.getElementsByClassName(\"liveExample\").Item(0).all.Item(1)\nSet lastName = hDoc.getElementsByClassName(\"liveExample\").Item(0).all.Item(3)\n\nfirstName.Click\nfirstName.Value = \"Joe\"\nlastName.Click\nlastName.Value = \"Bloggs\"\n\n'Close ie object\nSet IE = Nothing\nApplication.ScreenUpdating = True \n</code></pre>\n\n<p>End Sub</p>\n\n<p>Anyone got any ideas on how I get the knockout events to fire?</p>\n\n<p>The actual html from the text box on the page I'm trying to update is this....</p>\n\n<pre><code>&lt;input type=\"text\" ondrop=\"return false;\" onpaste=\"return false;\" data-bind=\"numericValue: Markup, visible: IsCellEditable(), selected: IsCellEditable(), event: { blur: blurZoneMarkup, keypress: function (data, event) { return $parent.isDecimal(data, event, hdnIsDiscount) }, keydown: function (data, event) { $(event.target).data('tabcode', event.which || event.keyCode); { return true; } } }\" style=\"width: 90%; display: none;\"&gt;\n</code></pre>\n\n<p>Any help or advice would be much appreciated. I've been trying to solve this for 3 days now!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 821, "user_id": 7834205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f852e10580cfe5145deab2e9a9e2c6?s=128&d=identicon&r=PG&f=1", "display_name": "yass", "link": "https://stackoverflow.com/users/7834205/yass"}, "edited": false, "score": 0, "creation_date": 1492032584, "post_id": 43379792, "comment_id": 73822009, "body": "IS it space or CHAR(255)? Alt+Enter?"}, {"owner": {"reputation": 821, "user_id": 7834205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f852e10580cfe5145deab2e9a9e2c6?s=128&d=identicon&r=PG&f=1", "display_name": "yass", "link": "https://stackoverflow.com/users/7834205/yass"}, "edited": false, "score": 0, "creation_date": 1492032789, "post_id": 43379792, "comment_id": 73822084, "body": "You can use in a new column =Substitute(B8,CHAR(255),&quot;&quot;) and drag it and when finish copy the new column paste special values where you need it"}, {"owner": {"reputation": 157, "user_id": 7023467, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f517388d2c33fb349c12d2d4a1adda0a?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7023467/owen"}, "reply_to_user": {"reputation": 821, "user_id": 7834205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f852e10580cfe5145deab2e9a9e2c6?s=128&d=identicon&r=PG&f=1", "display_name": "yass", "link": "https://stackoverflow.com/users/7834205/yass"}, "edited": false, "score": 0, "creation_date": 1492032843, "post_id": 43379792, "comment_id": 73822110, "body": "Hi, there are no spaces. Alt and enter does the opposite to what i&#39;m try to do it, it creates a newline, though I cannot find any line breaks."}, {"owner": {"reputation": 157, "user_id": 7023467, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f517388d2c33fb349c12d2d4a1adda0a?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7023467/owen"}, "reply_to_user": {"reputation": 821, "user_id": 7834205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f852e10580cfe5145deab2e9a9e2c6?s=128&d=identicon&r=PG&f=1", "display_name": "yass", "link": "https://stackoverflow.com/users/7834205/yass"}, "edited": false, "score": 0, "creation_date": 1492033201, "post_id": 43379792, "comment_id": 73822233, "body": "the char(255) suggestion kept on line 3 when I paste specialed."}, {"owner": {"reputation": 24193, "user_id": 5811078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlknE.png?s=128&g=1", "display_name": "zipa", "link": "https://stackoverflow.com/users/5811078/zipa"}, "edited": false, "score": 0, "creation_date": 1492033211, "post_id": 43379792, "comment_id": 73822236, "body": "It&#39;s <code>CHAR(13)</code>, most of the time :)"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 7023467, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f517388d2c33fb349c12d2d4a1adda0a?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7023467/owen"}, "edited": false, "score": 0, "creation_date": 1492033294, "post_id": 43380064, "comment_id": 73822284, "body": "I&#39;ve tried this (and its worked for me before). I&#39;m seeing the flashing dot in the find what box but when I search it it does not find a match. As per screenshot I pasted above. I&#39;ve also tried re-opening my sheet as well. May need to close all excel sessions?"}, {"owner": {"reputation": 24193, "user_id": 5811078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlknE.png?s=128&g=1", "display_name": "zipa", "link": "https://stackoverflow.com/users/5811078/zipa"}, "reply_to_user": {"reputation": 157, "user_id": 7023467, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f517388d2c33fb349c12d2d4a1adda0a?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7023467/owen"}, "edited": false, "score": 0, "creation_date": 1492033601, "post_id": 43380064, "comment_id": 73822423, "body": "I edited my post because it could be <code>CHAR(10)</code> that is making you these troubles :)"}, {"owner": {"reputation": 157, "user_id": 7023467, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f517388d2c33fb349c12d2d4a1adda0a?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7023467/owen"}, "edited": false, "score": 0, "creation_date": 1492073151, "post_id": 43380064, "comment_id": 73836335, "body": "To bring some closure tho this. I closed out of all excel sessions and tried the ctrl + j to find newlines and it worked."}], "tags": [], "owner": {"reputation": 24193, "user_id": 5811078, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlknE.png?s=128&g=1", "display_name": "zipa", "link": "https://stackoverflow.com/users/5811078/zipa"}, "is_accepted": true, "score": 2, "last_activity_date": 1492033555, "last_edit_date": 1492033555, "creation_date": 1492033059, "answer_id": 43380064, "question_id": 43379792, "link": "https://stackoverflow.com/questions/43379792/delete-multiple-lines-in-same-cell-excel-not-a-line-break/43380064#43380064", "title": "delete multiple lines in same cell excel (not a line break)", "body": "<p>Go to <code>Find and replace</code> and in <code>Find what</code> just press <code>Ctrl</code> + <code>J</code> (you won't see anything but that's what you need) and replace it with empty or whatever you want.</p>\n\n<p>Another thing that could be it is <code>CHAR(10)</code>, for that one hold <code>Alt</code> and press <code>0</code> then <code>1</code> then <code>0</code> and release <code>Alt</code>. Rest is the same.</p>\n"}], "owner": {"reputation": 157, "user_id": 7023467, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f517388d2c33fb349c12d2d4a1adda0a?s=128&d=identicon&r=PG&f=1", "display_name": "Owen", "link": "https://stackoverflow.com/users/7023467/owen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1821, "favorite_count": 0, "closed_date": 1492041092, "accepted_answer_id": 43380064, "answer_count": 1, "score": 0, "last_activity_date": 1492033555, "creation_date": 1492031835, "last_edit_date": 1531161705, "question_id": 43379792, "link": "https://stackoverflow.com/questions/43379792/delete-multiple-lines-in-same-cell-excel-not-a-line-break", "closed_reason": "Not suitable for this site", "title": "delete multiple lines in same cell excel (not a line break)", "body": "<p><a href=\"https://i.stack.imgur.com/kJOt1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kJOt1.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have a column of 2,000 numbers where there are 3 lines in the one cell and the information i need is in the lowest cell (as per b8) in sample below. In order for a lookup to work i need to put the cursor in front of first character of text on bottom row and key 'del' twice</p>\n\n<p>I don't believe there are line breaks in this cell as cntl + j doesn't find anything as per screenprint. Could anyone kindly suggest a bulk way to delete these top 2 line please</p>\n"}, {"tags": ["excel", "xml", "vba", "filter"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1492036642, "post_id": 43379399, "comment_id": 73823560, "body": "<a href=\"https://www.pcreview.co.uk/threads/full-xpath-support-in-visual-basic.2336295/\" rel=\"nofollow noreferrer\">This old forum thread</a> pointed to an MSDN article which listed restrictions on the XPath predicates that could be used with XMLMaps in Excel 2003. The link in the thread is dead but the article can be found <a href=\"https://msdn.microsoft.com/en-us/library/office/aa203724(v=office.11).aspx#odc_xl_excel2003xmlintro_mappingranges\" rel=\"nofollow noreferrer\">here</a>. No idea if this is relevant for more recent versions of Excel though"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1492051145, "post_id": 43379399, "comment_id": 73827206, "body": "Surely you been around SO a while, can we see some data (xml data, schema file) for a reproducible example?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1492179851, "post_id": 43379399, "comment_id": 73885621, "body": "@Parfait - Fair point :). I will do my best to upload sample data in coming days. Very busy with work at the moment."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1549016062, "post_id": 43379399, "comment_id": 95761557, "body": "@ScottHoltzman - An unanswered question upvoted 7 times draws some attention to it. Although an older post, I&#39;d appreciate your editing some complementary xml data &amp; a schema file very much. Hopefully for (some) answers, too :-)"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1549576905, "post_id": 43379399, "comment_id": 95962939, "body": "Can you throw the data through regex and work off of that?"}], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 998, "favorite_count": 0, "answer_count": 0, "score": 7, "last_activity_date": 1578682331, "creation_date": 1492030189, "last_edit_date": 1578682331, "question_id": 43379399, "link": "https://stackoverflow.com/questions/43379399/map-filtered-xml-to-an-excel-table", "title": "Map Filtered XML to an Excel Table", "body": "<p>I have the below code that maps an XML Schema to Excel Tables (as in ListObjects). </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub MapXMLFieldsToExcelCells(wb As Workbook, sLOB As String)\n\n'*******************************************************************\n'**    Name:        xmlFieldMap\n'**    Purpose:     Maps fields of existing xlmMap (named \"xmlData\") to file\n'**    Dependents:  TieXMLToExcel (remapping of xml file)\n'**    Notes:\n'*******************************************************************\n\nsProcName = \"MapXMLFieldsToExcelCells\"\n\nWith wb\n\n    Dim xMap As XmlMap\n    Set xMap = .XmlMaps(sLOB)\n\n    Dim wsXMLMain As Worksheet\n\n    Set wsXMLMain = .Worksheets(\"xml\" &amp; IIf(Left(.Name, 2) = \"SA\", \"SA\", \"\") &amp; sLOB)\n\n    Dim wsConfig As Worksheet\n    Set wsConfig = .Worksheets(\"rConfig\")\n\n    With wsConfig\n\n        Dim rNode As Range\n        For Each rNode In .Range(\"xmlNodeMapping\").Columns(1).Cells\n\n            Dim sNodePath As String\n            sNodePath = rNode &amp; rNode.Offset(, 1)\n\n            Dim sTable As String\n            sTable = rNode.Offset(, 2)\n\n            'only have this here in case node does not exist\n            'caveat is that it will fail also if node is just written out wrong\n            Application.DisplayAlerts = False\n            'On Error Resume Next\n            wsXMLMain.ListObjects(sTable).ListColumns(rNode.Offset(, 3).Value2).XPath.SetValue xMap, sNodePath\n            'On Error GoTo ErrorReport\n            Application.DisplayAlerts = True\n\n        Next\n\n    End With\n\n    .XmlMaps(sLOB).DataBinding.Refresh\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><em>(please ignore project specific lines here - there are not too many)</em></p>\n\n<p>The code works great. I can map nodes and attributes of nodes if I pass a configuration sheet like this:</p>\n\n<pre><code>Xpath           Node    Table   Field\n/root/d/p/t/    ar      tForms  AR\n/root/d/p/t/    @n      tFormsa name\n</code></pre>\n\n<p>What I would like to do, if it's possible, is to apply a filter on a node to only map certain elements of that node. </p>\n\n<p>For example, based on correct syntax:</p>\n\n<pre><code>Xpath                       Node        Table   Field\n/root/d/p/t[item='ar']/     type        tForms  type\n</code></pre>\n\n<p>Would only pull elements from node t that = ar. </p>\n\n<p>I can't get this to work and can't find anything online. I could accept is that is not an option but wanted to ask before giving up on the approach.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492029576, "post_id": 43379217, "comment_id": 73820613, "body": "You cannot assign two values to the same variable."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7858661, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xU2i9.jpg?s=128&g=1", "display_name": "rebecca_m_wonk", "link": "https://stackoverflow.com/users/7858661/rebecca-m-wonk"}, "edited": false, "score": 0, "creation_date": 1492035815, "post_id": 43379863, "comment_id": 73823290, "body": "They all unfortunately need to be labeled the same."}, {"owner": {"reputation": 21, "user_id": 7858661, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xU2i9.jpg?s=128&g=1", "display_name": "rebecca_m_wonk", "link": "https://stackoverflow.com/users/7858661/rebecca-m-wonk"}, "edited": false, "score": 0, "creation_date": 1492095310, "post_id": 43379863, "comment_id": 73852104, "body": "Works perfect! Thank you!"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 21, "user_id": 7858661, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xU2i9.jpg?s=128&g=1", "display_name": "rebecca_m_wonk", "link": "https://stackoverflow.com/users/7858661/rebecca-m-wonk"}, "edited": false, "score": 0, "creation_date": 1492098618, "post_id": 43379863, "comment_id": 73854265, "body": "You&#39;re welcome. Glad it worked. Please take a moment to accept the answer to mark your question as Solved."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1492058891, "last_edit_date": 1492058891, "creation_date": 1492032124, "answer_id": 43379863, "question_id": 43379217, "link": "https://stackoverflow.com/questions/43379217/pull-columns-with-same-name-and-copy-into-different-worksheet/43379863#43379863", "title": "Pull Columns with same name and copy into different worksheet", "body": "<p>Change your second date column header to something else like Date2 which I have used in the code below. Otherwise your first condition will always be evaluated as True and it will pick the first column always.</p>\n\n<p>You may try it like thie...</p>\n\n<pre><code>Sub MoveColumns()\n' MoveColumns Macro\n\n' Description: Rearrange columns in Excel based on column header\nDim iRow As Long\nDim iCol As Long\nDim TargetCol As Long\nDim FirstDate As Boolean\n'Constant values\ndata_sheet1 = InputBox(\"Specify the name of the Sheet that needs to be reorganized:\") 'Create Input Box to ask the user which sheet needs to be reorganised\ntarget_sheet = \"Final Report\" 'Specify the sheet to store the results\niRow = Sheets(data_sheet1).UsedRange.Rows.Count 'Determine how many rows are in use\n'Create a new sheet to store the results\nWorksheets.Add.Name = \"Final Report\"\n'Start organizing columns\nFor iCol = 1 To Sheets(data_sheet1).UsedRange.Columns.Count\n'Sets the TargetCol to zero in order to prevent overwriting existing targetcolumns\nTargetCol = 0\n'Read the header of the original sheet to determine the column order\n\nIf LCase(Sheets(data_sheet1).Cells(1, iCol).Value) = \"date\" Then\n    If Not FirstDate Then\n        TargetCol = 1\n        FirstDate = True\n    Else\n        TargetCol = 6\n    End If\nElseIf LCase(Sheets(data_sheet1).Cells(1, iCol).Value) = \"system name\" Then\n    TargetCol = 2\nElseIf LCase(Sheets(data_sheet1).Cells(1, iCol).Value) = \"ch\" Then\n    TargetCol = 3\nElseIf LCase(Sheets(data_sheet1).Cells(1, iCol).Value) = \"carr key\" Then\n    TargetCol = 4\nElseIf LCase(Sheets(data_sheet1).Cells(1, iCol).Value) = \"flag\" Then\n    TargetCol = 5\nElseIf LCase(Sheets(data_sheet1).Cells(1, iCol).Value) = \"date\" Then\n    TargetCol = 6\nEnd If\n\n\n\n'If a TargetColumn was determined (based upon the header information) then copy the column to the right spot\nIf TargetCol &lt;&gt; 0 Then\n'Select the column and copy it\nSheets(data_sheet1).Range(Sheets(data_sheet1).Cells(1, iCol), Sheets(data_sheet1).Cells(iRow, iCol)).Copy Destination:=Sheets(target_sheet).Cells(1, TargetCol)\nEnd If\nNext iCol 'Move to the next column until all columns are read\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7858661, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xU2i9.jpg?s=128&g=1", "display_name": "rebecca_m_wonk", "link": "https://stackoverflow.com/users/7858661/rebecca-m-wonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 43379863, "answer_count": 1, "score": 2, "last_activity_date": 1492116782, "creation_date": 1492029450, "last_edit_date": 1492116782, "question_id": 43379217, "link": "https://stackoverflow.com/questions/43379217/pull-columns-with-same-name-and-copy-into-different-worksheet", "title": "Pull Columns with same name and copy into different worksheet", "body": "<p>I am trying to copy multiple columns with the same header name into a new worksheet. </p>\n\n<p>The problem I am having is it only copies one column and leaves the other blank. </p>\n\n<p>In this example I want the date to be in column 1 and in column 5 but it only places the column in Target Column 5.</p>\n\n<pre><code>Sub MoveColumns()\n' MoveColumns Macro\n\n' Description: Rearrange columns in Excel based on column header\nDim iRow As Long\nDim iCol As Long\n'Constant values\ndata_sheet1 = InputBox(\"Specify the name of the Sheet that needs to be reorganized:\") 'Create Input Box to ask the user which sheet needs to be reorganised\ntarget_sheet = \"Final Report\" 'Specify the sheet to store the results\niRow = Sheets(data_sheet1).UsedRange.Rows.Count 'Determine how many rows are in use\n'Create a new sheet to store the results\nWorksheets.Add.Name = \"Final Report\"\n'Start organizing columns\nFor iCol = 1 To Sheets(data_sheet1).UsedRange.Columns.Count\n'Sets the TargetCol to zero in order to prevent overwriting existing targetcolumns\nTargetCol = 0\n'Read the header of the original sheet to determine the column order\n\nIf Sheets(data_sheet1).Cells(1, iCol).value = \"DATE\" Then TargetCol = 1\nIf Sheets(data_sheet1).Cells(1, iCol).value = \"SYSTEM NAME\" Then TargetCol = 2\nIf Sheets(data_sheet1).Cells(1, iCol).value = \"CH\" Then TargetCol = 3\nIf Sheets(data_sheet1).Cells(1, iCol).value = \"CARR KEY\" Then TargetCol = 3\nIf Sheets(data_sheet1).Cells(1, iCol).value = \"FLAG\" Then TargetCol = 4\nIf Sheets(data_sheet1).Cells(1, iCol).value = \"DATE\" Then TargetCol = 5\n\n\n\n'If a TargetColumn was determined (based upon the header information) then copy the column to the right spot\nIf TargetCol &lt;&gt; 0 Then\n'Select the column and copy it\nSheets(data_sheet1).Range(Sheets(data_sheet1).Cells(1, iCol), Sheets(data_sheet1).Cells(iRow, iCol)).Copy Destination:=Sheets(target_sheet).Cells(1, TargetCol)\nEnd If\nNext iCol 'Move to the next column until all columns are read\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "edited": false, "score": 1, "creation_date": 1492029479, "post_id": 43379174, "comment_id": 73820559, "body": "what&#39;s the code look like?"}, {"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "reply_to_user": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "edited": false, "score": 0, "creation_date": 1492029579, "post_id": 43379174, "comment_id": 73820614, "body": "LinhaInicio = 1 While Workbooks(planilha).Sheets(&quot;Boletas&quot;).Cells(LinhaInicio, 2) &lt;&gt; &quot;X&quot;     LinhaInicio = LinhaInicio + 1 Wend  LinhaFim = LinhaInicio While Workbooks(planilha).Sheets(&quot;Boletas&quot;).Cells(LinhaFim, 2) = &quot;X&quot;     LinhaFim = LinhaFim + 1 Wend  LinhaFim = LinhaFim - 1  RangeInicio = Workbooks(planilha).Sheets(&quot;Boletas&quot;).Cells(LinhaInicio, 26).Address  RangeFim = Workbooks(planilha).Sheets(&quot;Boletas&quot;).Cells(LinhaFim, 34).Address  Set RangeCopiar = ActiveSheet.Range(RangeInicio, RangeFim)  Thats the part that needs the loop to find the others X"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1492029667, "post_id": 43379174, "comment_id": 73820665, "body": "Add the code to your question, and format it using the <code>{}</code> button. Code in comments is not readable"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "edited": false, "score": 0, "creation_date": 1492029741, "post_id": 43379174, "comment_id": 73820702, "body": "Yep, for me, it would be much more difficult to troubleshoot otherwise."}, {"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492029871, "post_id": 43379174, "comment_id": 73820780, "body": "i will add the whole macro to my question, does it help?"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "edited": false, "score": 0, "creation_date": 1492029994, "post_id": 43379174, "comment_id": 73820835, "body": "yeah, I can see your issue though.  your main loop should include the entire scope of the procedure that emails out the sheet.  so that way you&#39;re continuing to look for x&#39;s"}, {"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492030106, "post_id": 43379174, "comment_id": 73820883, "body": "Do you know how to correct it Clyde?"}, {"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492030312, "post_id": 43379174, "comment_id": 73820980, "body": "And how can i add the code to my question? I tried to use the {} but it didnt work"}, {"owner": {"reputation": 834, "user_id": 3206247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/c9OIV.gif?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/3206247/marco"}, "edited": false, "score": 0, "creation_date": 1492030349, "post_id": 43379174, "comment_id": 73820999, "body": "Click <code>edit</code> right under the tags in your question"}, {"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492030454, "post_id": 43379174, "comment_id": 73821069, "body": "but how can i add the code, it says i cant"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492032359, "post_id": 43379689, "comment_id": 73821919, "body": "Clyde, still not working as you said. I tried to search for everything on the internet. Lets wait for Tim then."}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492032479, "post_id": 43379689, "comment_id": 73821969, "body": "in the event he doesn&#39;t - that second one I&#39;m gonna tweak minimally after I get off the phone with this customer"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492033217, "post_id": 43379689, "comment_id": 73822239, "body": "sorry rough day today - not sure if this helps or not but the issue is your first loop is looking for the first x the second loop looking for the end of the x&#39;s and then your not climbing back up to look for more x&#39;s so it needs to be contained in its own loop.  but the counter should increment beyond the number of x&#39;s otherwise it&#39;ll duplicate the email information.  not sure exactly what the data looks like but this might get you a little closer at least"}, {"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492033335, "post_id": 43379689, "comment_id": 73822306, "body": "I got it. Do you know how to fix it? I mean, to make my loop climb back and get the others X?"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492033480, "post_id": 43379689, "comment_id": 73822370, "body": "yeah you could do something like count the number of rows in your dataset and while i &lt; datasetlength &#39;do all code stuff wend"}, {"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492033813, "post_id": 43379689, "comment_id": 73822514, "body": "Clyde, can you do like you did before? Send me the macro, because i tried here and it didnt work."}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492034679, "post_id": 43379689, "comment_id": 73822841, "body": "just now had to make an edit -         LinhaFim = linhaInicio          While vArr(LinhaFim, 2) = &quot;X&quot;"}, {"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492035114, "post_id": 43379689, "comment_id": 73823012, "body": "I cant believe whats going on with my macro :( Still not working"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492035277, "post_id": 43379689, "comment_id": 73823078, "body": "unmark the question as answered you might get better visibility on it"}, {"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492035606, "post_id": 43379689, "comment_id": 73823214, "body": "How can I send you the whole macro? so then you can see it and check wheres the problem"}, {"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "reply_to_user": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492036962, "post_id": 43379689, "comment_id": 73823674, "body": "k got it gonna take a look through it"}], "tags": [], "owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "is_accepted": false, "score": 0, "last_activity_date": 1492034625, "last_edit_date": 1492034625, "creation_date": 1492031334, "answer_id": 43379689, "question_id": 43379174, "link": "https://stackoverflow.com/questions/43379174/looping-to-find-letters-in-a-column-on-vba/43379689#43379689", "title": "Looping to find letters in a column on VBA", "body": "<p>Maybe Try something like this:</p>\n\n<pre><code>Dim vArr As Variant\nDim LinhaFim As Long\nSub mainLoop()\n    'put all values into variant array vArr\n    vArr = Workbooks(planilha).Sheets(\"Boletas\").UsedRange\n    For i = LBound(vArr) To UBound(vArr)\n\n        If vArr(i, 2) = \"X\" Then\n            Nestedloops (i) 'initiate nested loops\n            i = LinhaFim    'artificially increment counter\n        End If\n\n    Next i\nEnd Sub\n\n\nSub Nestedloops(LinhaIncio As Long)\n    With Workbooks(planilha).Sheets(\"Boletas\")\n        LinhaFim = linhaInicio\n        While vArr(LinhaFim, 2) = \"X\"\n            LinhaFim = LinhaFim + 1\n        Wend\n        LinhaFim = LinhaFim - 1\n        RangeInicio = .Cells(LinhaInicio, 26).Address\n        RangeFim = .Cells(LinhaFim, 34).Address\n        Set RangeCopiar = ActiveSheet.Range(RangeInicio, RangeFim)\n\n        'email code goes here\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Tim could come up with something better though might want to see what he comes up with</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492113530, "post_id": 43387559, "comment_id": 73862112, "body": "lonut, my macro search for the lines at the column B that contain the letter X, so then it sends an email for the clients by creating a new sheet with the lines that have the X at the column B, but it works only if the X are in sequence. So when there is the letter X at the line 3 and line 5, just the line 3 goes to the sheet. Got it?"}, {"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "reply_to_user": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "edited": false, "score": 0, "creation_date": 1492149807, "post_id": 43387559, "comment_id": 73871951, "body": "i don&#39;t know if you have defined an array but if you have your code should look like this: for i=2 to ubound (your_array,1)    If your_array(i,2)= X then   your condition  end if  next I if you don&#39;t have an array you should define one, it will improve your code."}], "tags": [], "owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "is_accepted": false, "score": 0, "last_activity_date": 1492073294, "creation_date": 1492073294, "answer_id": 43387559, "question_id": 43379174, "link": "https://stackoverflow.com/questions/43379174/looping-to-find-letters-in-a-column-on-vba/43387559#43387559", "title": "Looping to find letters in a column on VBA", "body": "<p>you wanna search the X letter to columns or rows, sorry I didn't understand what you try to say. You want to create a loop to count all the X letter for every row and column or only for every row from a column?</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "is_accepted": false, "score": 0, "last_activity_date": 1492150181, "creation_date": 1492150181, "answer_id": 43406154, "question_id": 43379174, "link": "https://stackoverflow.com/questions/43379174/looping-to-find-letters-in-a-column-on-vba/43406154#43406154", "title": "Looping to find letters in a column on VBA", "body": "<p>here is how you define an array: </p>\n\n<pre><code>Dim timelinessSheet, o As Variant\ntimelinessSheet = Worksheets(\"your_sheet_name\").Range(\"A2:X\" &amp; Worksheets(\"your_sheet_name\").Cells(Worksheets(\"your_sheet_name\").Rows.Count, \"B\").End(xlUp).Row).Value\n</code></pre>\n\n<p>and then your code </p>\n\n<pre><code>dim i as long\nfor i=2 to ubound (timelinessSheet,1)\n if  timelinessSheet(i,2)= X then \n   Your_condition \n end if \nnext I\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7858629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035e7d20162f78ced4662fdc4fd56538?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Verardino", "link": "https://stackoverflow.com/users/7858629/gabriel-verardino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1492150181, "creation_date": 1492029272, "last_edit_date": 1492042772, "question_id": 43379174, "link": "https://stackoverflow.com/questions/43379174/looping-to-find-letters-in-a-column-on-vba", "title": "Looping to find letters in a column on VBA", "body": "<p>My macro is to send emails for some clients. It sends the email only if there is a X at one of the lines of the column B, so then it sends the whole line to the client by creating a new sheet that goes attached to the client on the email.\nThe problem is that I need to create a loop to count all the columns that contain the letter X, because this macro is counting only the first line that contains the letter X and then the other ones don't go to the new sheet and consequently it doesn't go to the client. Everything is OK in my macro, despite of the counter. When i run it, just the first line that contains the X goes to the client, and the others don't. Can you guys help me?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>LinhaInicio = 1\nWhile Workbooks(planilha).Sheets(\"Boletas\").Cells(LinhaInicio, 2) &lt;&gt; \"X\"\n    LinhaInicio = LinhaInicio + 1\nWend\nLinhaFim = LinhaInicio\nWhile Workbooks(planilha).Sheets(\"Boletas\").Cells(LinhaFim, 2) = \"X\"\n    LinhaFim = LinhaFim + 1\nWend\nLinhaFim = LinhaFim - 1\nRangeInicio = Workbooks(planilha).Sheets(\"Boletas\").Cells(LinhaInicio, 26).Address\nRangeFim = Workbooks(planilha).Sheets(\"Boletas\").Cells(LinhaFim, 34).Address\nSet RangeCopiar = ActiveSheet.Range(RangeInicio, RangeFim)\n</code></pre>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1492099652, "post_id": 43378988, "comment_id": 73854900, "body": "Maybe take a look at this one: <a href=\"http://stackoverflow.com/questions/1712094/vbscript-and-ado-3704-operation-is-not-allowed-when-the-object-is-closed\" title=\"vbscript and ado 3704 operation is not allowed when the object is closed\">stackoverflow.com/questions/1712094/&hellip;</a>   If not that then it would be useful to show your actual SQL (or something very close) and indicate exactly which line raises the error you&#39;re seeing."}, {"owner": {"reputation": 47, "user_id": 3541387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3503624c7d78decbcdc66e5a718b3f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Francois Lemieux", "link": "https://stackoverflow.com/users/3541387/francois-lemieux"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1492103310, "post_id": 43378988, "comment_id": 73856873, "body": "Hi thank you, ill analyse the other question but even this does not work:  declare test table (value varchar(200),compare varchar(20)) insert test(value,compare) values (&#39;X&#39;,&#39;Y&#39;), (&#39;Z&#39;,&#39;A&#39;) ; select * from test"}, {"owner": {"reputation": 47, "user_id": 3541387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3503624c7d78decbcdc66e5a718b3f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Francois Lemieux", "link": "https://stackoverflow.com/users/3541387/francois-lemieux"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1492103907, "post_id": 43378988, "comment_id": 73857195, "body": "I can&#39;t use  the at-sign in the comments but it is used to declare my temporary table and to call it afterward, just like that it does not work in excel or SQL of course"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 3541387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3503624c7d78decbcdc66e5a718b3f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Francois Lemieux", "link": "https://stackoverflow.com/users/3541387/francois-lemieux"}, "edited": false, "score": 0, "creation_date": 1492087408, "post_id": 43379054, "comment_id": 73846194, "body": "Thank you for this swift answer. I&#39;ve double checked the other vba and I&#39;ve always used the first one and it used to work, i just change it to what you&#39;ve instructed me cause it does make a lot of sense but it&#39;s the same error. My fear is, the server side do not allow to keep an active connection, could this be the case?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1492030403, "last_edit_date": 1492030403, "creation_date": 1492028881, "answer_id": 43379054, "question_id": 43378988, "link": "https://stackoverflow.com/questions/43378988/runtime-error-3704-on-a-opened-object/43379054#43379054", "title": "runtime error 3704 on a opened object", "body": "<pre><code>con.Open (strCon)\nrs.ActiveConnection = strCon\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>con.Open strCon\nrs.ActiveConnection = con\n</code></pre>\n\n<p>ie. you should set <code>ActiveConnection</code> to the <code>Connection</code> object you just opened, not to the connection string. </p>\n"}], "owner": {"reputation": 47, "user_id": 3541387, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3503624c7d78decbcdc66e5a718b3f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Francois Lemieux", "link": "https://stackoverflow.com/users/3541387/francois-lemieux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492090637, "creation_date": 1492028596, "last_edit_date": 1492090637, "question_id": 43378988, "link": "https://stackoverflow.com/questions/43378988/runtime-error-3704-on-a-opened-object", "title": "runtime error 3704 on a opened object", "body": "<p>I am struggling with this situation</p>\n\n<p>I have a query that when i run in MSSQL server management studio it gives me 18 rows, it it stored in a cell. The database is connected to a live server and we would like to create Excel dashboards out of them so it get refreshed with live data and create graph etc....</p>\n\n<p>***** EDIT *****</p>\n\n<p>I tried a very simple query and it works i can get for example</p>\n\n<p>select max(datetime)from table and i do have the latest sync.</p>\n\n<p>The thing is: my query has</p>\n\n<p>1) A Declared table for validation\n2) A temporary table \"with table as( ) ;\" that sorts all data and rank them with some filtering \"RowNumber\" that is called later in with a where statement that take only some row numbers to avoid repeats</p>\n\n<p>I think that in between the connection must close, can it be?</p>\n\n<hr>\n\n<p>Normally this code works out but for this server i get:</p>\n\n<p>\"runtime error 3704 operation is not allowed when the object is closed\"</p>\n\n<p>I've searched the forum and the google with no luck</p>\n\n<pre><code>Dim con As ADODB.Connection\nDim rs As ADODB.Recordset\nDim query As String\nSet con = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\nstrCon = \"Provider=SQLOLEDB.1;\" _\n           &amp; \"Password=*******;\" _\n           &amp; \"Persist Security Info=True;\" _\n           &amp; \"User ID=********;\" _\n           &amp; \"Initial Catalog=*******;\" _\n           &amp; \"Data Source=***.**.**.**;\" _\n           &amp; \"Use Procedure for Prepare=1;\" _\n           &amp; \"Auto Translate=True;Packet Size=4096;\" _\n           &amp; \"Use Encryption for Data=False;\" _\n           &amp; \"Tag with column collation when possible=False\"\n\ncon.Open (strCon)\n\nrs.ActiveConnection = Con 'modified with suggestion below\n\nstrSQLQuery = Worksheets(\"Query\").Range(\"B2\").Value\n\nrs.Open strSQLQuery\n      For i = 0 To rs.Fields.Count - 1\nSheet2.Cells(1, i + 1) = rs.Fields(i).Name\nNext i\n\nWorksheets(\"Result\").Range(\"A2\").CopyFromRecordset rs\nrs.Close\n\nSet rs = Nothing\ncon.Close\nSet cn = Nothing\n</code></pre>\n\n<p>Can a magician help me out? because now im doing it with excel VBA as a demo but i would like to promote it to a VB tool and want to make sure it is not a server related issue.</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492028972, "post_id": 43378747, "comment_id": 73820278, "body": "What is <code>EconGrowth1</code>? (Btw your npvRange doesn&#39;t look right.)"}, {"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492029985, "post_id": 43378747, "comment_id": 73820832, "body": "EconGrowth1 is a named range that is a percent. The Net Present Value in excel (NPV) requires it as the first argument in the function. Can you elaborate about what doesn&#39;t look right about it? I&#39;m honestly stumped..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1492030093, "post_id": 43378747, "comment_id": 73820878, "body": "I don&#39;t know if it would cause an error, but <code>npvRange</code> will only be set to the last value in the loop because you are overwriting the previous setting of n (whereas in the calcrange loop you are incorporating the previous range in the union). In other words, I guess you should have <code>Set npvRange = Union(npvrange, Cells(57, n))</code>."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1492030836, "post_id": 43379440, "comment_id": 73821253, "body": "I&#39;ve never used NPV but I think you might be able to dispense with the brackets altogether. I didn&#39;t think they would cause an error though so what do I know..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1492031729, "post_id": 43379440, "comment_id": 73821664, "body": "@SJR You&#39;re probably right, it seems that the parameters can be <code>(rate, value1, [value2], [value3], ...)</code>.  (I originally added them into the IRR formula because it just has <code>(values, guess)</code>, and therefore needed the brackets to group the cells being used for <code>values</code>.)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492032529, "post_id": 43379440, "comment_id": 73821990, "body": "I don&#39;t see why the double brackets cause an error. <code>=sum((a1:a2))</code> is fine."}, {"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1492032719, "post_id": 43379440, "comment_id": 73822060, "body": "@ SJR @YowE3K Thank you both so much. That did it. Yow, you heped me out the other day as well, thanks again. I hate to sound completely ignorant, but I seem to be up against a steep learning curve; VBA is really the first &quot;programming&quot; I have ever tried. Are there any books or resources you&#39;d recommend to develop a more technical proficiency on programming? Thanks"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492032721, "post_id": 43379440, "comment_id": 73822062, "body": "@SJR - the extra brackets won&#39;t be an issue, but the IRR formula <b>without</b> the double brackets did cause an issue (i.e. <code>=IRR(InvestmentOutlay,$C$57,$E$57,$G$57)</code> didn&#39;t work because it had to be <code>=IRR((InvestmentOutlay,$C$57,$E$57,$G$57))</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 1, "creation_date": 1492032829, "post_id": 43379440, "comment_id": 73822102, "body": "@jules325 - I learned to program from a book called &quot;Computer Programming Made Simple&quot;, which gave a simple guide to COBOL and FORTRAN (the only real languages available back then).  Everything else has been learned by 40+ years of experience.  And I&#39;m still learning more every day by reading (and attempting to answer) SO questions."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 1, "creation_date": 1492033154, "post_id": 43379440, "comment_id": 73822213, "body": "YowE3K - thanks for clarifying. @jules325 - I haven&#39;t read it, but John Walkenbach&#39;s book is supposed to be good. There is so much online though. Hang around here and forums like it as you are - the best experience is to solve an actual problem as you have."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1492031865, "last_edit_date": 1492031865, "creation_date": 1492030313, "answer_id": 43379440, "question_id": 43378747, "link": "https://stackoverflow.com/questions/43378747/trouble-running-a-macro-which-selects-every-second-column-in-a-range-and-inputs/43379440#43379440", "title": "Trouble running a macro which selects every second column in a range and inputs the result in a formula", "body": "<p>The brackets you are placing around both the <code>EconGrowth1</code> and <code>npvRange</code> values is making them into one parameter, but <code>EconGrowth1</code> should be the first parameter, and the other cells should be the second parameter.</p>\n\n<p>So you need to move your brackets:</p>\n\n<pre><code>Range(\"NPV\").Formula = \"=NPV(EconGrowth1,(\" &amp; npvRange.Address &amp; \"))\"\n</code></pre>\n\n<hr>\n\n<p>And, as SJR mentioned in a comment, your <code>Union</code> should be changed to:</p>\n\n<pre><code>Set npvRange = Union(npvRange, Cells(57, n))\n</code></pre>\n\n<hr>\n\n<p>And, as you have already initialised <code>npvRange</code> to be <code>C57</code>, you can start the loop at column 5.</p>\n\n<p>The final code could look like:</p>\n\n<pre><code>Dim npvRange As Range\nDim n As Long\nSet npvRange = Range(\"C57\")\nFor n = 5 To Range(\"C57\").End(xlToRight).Column Step 2\n    Set npvRange = Union(npvRange, Cells(57, n))\nNext\nRange(\"NPV\").Formula = \"=NPV(EconGrowth1,(\" &amp; npvRange.Address &amp; \"))\"\n</code></pre>\n\n<hr>\n\n<p>SJR has just pointed out in a comment that the <code>NPV</code> formula doesn't even need brackets because, unlike the <code>IRR</code> formula which only takes one parameter for <code>values</code>, the <code>NPV</code> formula has parameters of <code>rate, value1, [value2], ...</code>.</p>\n\n<p>So that means the <code>Formula</code> line can be just:</p>\n\n<pre><code>Range(\"NPV\").Formula = \"=NPV(EconGrowth1,\" &amp; npvRange.Address &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 43379440, "answer_count": 1, "score": 0, "last_activity_date": 1492031865, "creation_date": 1492027704, "last_edit_date": 1531164843, "question_id": 43378747, "link": "https://stackoverflow.com/questions/43378747/trouble-running-a-macro-which-selects-every-second-column-in-a-range-and-inputs", "title": "Trouble running a macro which selects every second column in a range and inputs the result in a formula", "body": "<p>I have a macro that selects every second column and inputs the addresses in to an excel defined function:</p>\n\n<pre><code>Dim calcrange As Range\nDim c As Long\nSet calcrange = Range(\"InvestmentOutlay\")\nFor c = 3 To Range(\"C57\").End(xlToRight).Column Step 2\n    Set calcrange = Union(calcrange, Cells(57, c))\nNext\nRange(\"IRR\").Formula = \"=IRR((\" &amp; calcrange.Address &amp; \"))\"\n</code></pre>\n\n<p>This code works, however, when I try to run this code:</p>\n\n<pre><code>Dim npvRange As Range\nDim n As Long\nSet npvRange = Range(\"C57\")\nFor n = 3 To Range(\"C57\").End(xlToRight).Column Step 2\n    Set npvRange = Union(Range(\"C57\"), Cells(57, n))\nNext\nRange(\"NPV\").Formula = \"=NPV((EconGrowth1,\" &amp; npvRange.Address &amp; \"))\"\n</code></pre>\n\n<p>I get an \"Application defined or object defined error\". The debug highlights the last line of code. I'm still pretty new with VBA, and am unsure what is causing this error, and how to fix it. Any assistance would be greatly appreciated, thanks,</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1492026220, "post_id": 43378231, "comment_id": 73818650, "body": "You&#39;re naming a worksheet, and every worksheet must have a unique name.  Because you&#39;re getting the worksheet name from C2, if the value in C2 didn&#39;t change then you are trying to give a worksheet a duplicate name which will cause the error you&#39;ve described.  Make sure you&#39;re not trying to assign a duplicate worksheet name."}, {"owner": {"reputation": 336, "user_id": 641965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae13c9dd08b1f46634a49c633a2c78?s=128&d=identicon&r=PG", "display_name": "phhlho", "link": "https://stackoverflow.com/users/641965/phhlho"}, "edited": false, "score": 0, "creation_date": 1492026326, "post_id": 43378231, "comment_id": 73818720, "body": "After running the macro, the active sheet in the workbook will be the copy. If you update cell C2 on that sheet, running the macro again will give you the error described because the script is going to look at cell C2 on Sheet1. Is there a chance you made this mistake?"}, {"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1492026932, "post_id": 43378231, "comment_id": 73819090, "body": "@tigeravatar - I am changing cell C2 every time I&#39;m trying to update it. E.g. cell C2 on the first run is 10011-01, I change it on the second run to 10011-02 on Sheet 1, but it still gives me the same error then when I return to Sheet 1, The macro has replaced 10011-02 with the original 10011-01."}, {"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "reply_to_user": {"reputation": 336, "user_id": 641965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae13c9dd08b1f46634a49c633a2c78?s=128&d=identicon&r=PG", "display_name": "phhlho", "link": "https://stackoverflow.com/users/641965/phhlho"}, "edited": false, "score": 0, "creation_date": 1492027121, "post_id": 43378231, "comment_id": 73819193, "body": "@phhlho - Doesn&#39;t my activation call on Sheet 1 make this irrelevant? I am updating Cell C2 on Sheet 1 every time, not the copy, and I don&#39;t want people to use the copy to update again, they should always be using Sheet 1 to do work, then the button essentially freezes a copy of their work and paste as values into a new sheet which allows us to see the changes made at the time."}, {"owner": {"reputation": 336, "user_id": 641965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae13c9dd08b1f46634a49c633a2c78?s=128&d=identicon&r=PG", "display_name": "phhlho", "link": "https://stackoverflow.com/users/641965/phhlho"}, "edited": false, "score": 0, "creation_date": 1492027325, "post_id": 43378231, "comment_id": 73819308, "body": "@cdipaola The activation will make sure you pull the value from Sheet1 - the problem is if whoever changes the value of C2 doesn&#39;t change the value on Sheet1. I raised this as a possibility of what&#39;s happening, because the first thing that I did when I tried that macro was to accidentally edit the copy, not Sheet1 and I received that same error. After making sure I was changing the value of C2 on Sheet1 in between each run, the script appeared to be working as expected."}, {"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "reply_to_user": {"reputation": 336, "user_id": 641965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae13c9dd08b1f46634a49c633a2c78?s=128&d=identicon&r=PG", "display_name": "phhlho", "link": "https://stackoverflow.com/users/641965/phhlho"}, "edited": false, "score": 0, "creation_date": 1492028259, "post_id": 43378231, "comment_id": 73819878, "body": "@phhlho - Good to know, I will see if that was what I was doing, just maybe not realizing it! Thank you for your input!"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "edited": false, "score": 0, "creation_date": 1492027735, "post_id": 43378540, "comment_id": 73819552, "body": "Just to be sure I&#39;m understanding if a user were to update sheet 1 Cell C2 multiple times and try and press the button assigned to this macro after each edit of cell C2, this will then edit each sheet to be a newly named sheet? <code>ActiveSheet.UsedRange.Value = ActiveSheet.UsedRange.Value</code> Will this then only keep values and take out any formulas used?"}, {"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "edited": false, "score": 0, "creation_date": 1492027969, "post_id": 43378540, "comment_id": 73819702, "body": "So now I&#39;m getting an error &quot;RunTime Error &#39;1004&#39;:  and when I open the debugger it&#39;s pointing at the code   <code>activesheet.usedrange.value = activesheet.usedrange.value</code>"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "edited": false, "score": 0, "creation_date": 1492028240, "post_id": 43378540, "comment_id": 73819866, "body": "Yes it will convert all the formulas to their values on the ActiveSheet."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "edited": false, "score": 0, "creation_date": 1492028273, "post_id": 43378540, "comment_id": 73819883, "body": "Not sure why you are getting error 1004. The code works perfectly fine at my end."}, {"owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "edited": false, "score": 0, "creation_date": 1492028450, "post_id": 43378540, "comment_id": 73819989, "body": "You are actually super correct. I had my sheet protected and It wasn&#39;t allowing that piece of the code to run. Your code works perfectly! Thank you!"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1492026964, "creation_date": 1492026964, "answer_id": 43378540, "question_id": 43378231, "link": "https://stackoverflow.com/questions/43378231/vba-variable-not-updating-after-a-second-run-of-the-macro/43378540#43378540", "title": "VBA - Variable Not updating after a second run of the macro", "body": "<p>There cannot be two sheets with the same name. So when you are running the code second time, the new sheet added will be renamed on the basis of cell C2 from Sheet1.</p>\n\n<p>Also you can shorten your code like this...</p>\n\n<pre><code>Sub freezesheet()\n   Dim x As String\n\n   Sheets(\"Sheet1\").Activate\n   x = Range(\"C2\").Value\n\n   Sheets(\"Sheet1\").Copy after:=Sheets(3)\n   ActiveSheet.Name = x\n   ActiveSheet.UsedRange.Value = ActiveSheet.UsedRange.Value\nEnd Sub\n</code></pre>\n\n<p>The above code will run without an issue if you change the C2 value each time before running the code next time.</p>\n"}], "owner": {"reputation": 67, "user_id": 7111332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OG8RP.png?s=128&g=1", "display_name": "DataNinja", "link": "https://stackoverflow.com/users/7111332/dataninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1630, "favorite_count": 1, "accepted_answer_id": 43378540, "answer_count": 1, "score": 1, "last_activity_date": 1492026964, "creation_date": 1492025906, "last_edit_date": 1492026747, "question_id": 43378231, "link": "https://stackoverflow.com/questions/43378231/vba-variable-not-updating-after-a-second-run-of-the-macro", "title": "VBA - Variable Not updating after a second run of the macro", "body": "<p>Okay, so I have a spreadsheet in which I am trying to copy as a new sheet then re-name as a value of a cell on the original spreadsheet. When I run the macro the first time, it works fine. Ever subsequent time, however, it gives me the \"Name is already taken\" error and tries to pass the value of the original variable (x) again instead of taking the new value in cell C2.</p>\n\n<p>I am self-taught and still fairly new at this, so any help would be greatly appreciated.I feel like the error might be coming in my range reference, as in there is a different way to declare the variable (x) to that cells' value that I might be missing. </p>\n\n<pre><code> Sub freezesheet()\n    Dim x As String\n\n    Sheets(\"Sheet1\").Activate\n    x = Range(\"C2:C2\").Value\n    Debug.Print (x)\n\n    Sheets(\"Sheet1\").Copy after:=Sheets(3)\n    Sheets(\"Sheet1 (2)\").Name = x\n    x = \"\"\n\n    Debug.Print (x)\n\n    Cells.Select\n    selection.Copy\n    selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "global-variables"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1492026239, "post_id": 43378166, "comment_id": 73818664, "body": "Something is resettting the value of your global between calling <code>ImportGammaData</code> and <code>SaveAs</code>.  Either the VBProject is getting reset (which clears all globals) or some other code is actively clearing the value of <code>gammaSheet</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492026684, "post_id": 43378166, "comment_id": 73818943, "body": "Where (in which module) is this code written in, who&#39;s calling it, and does anything anywhere use the <code>End</code> instruction?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492027865, "post_id": 43378166, "comment_id": 73819634, "body": "I suppose you removed the instruction that assigns <code>gammaFileName</code>? Because otherwise the <code>Set gammaFile</code> instruction would fail. Did you otherwise &quot;clean up&quot; your code before posting? e.g. removed <code>On Error Resume Next</code> instructions by any chance?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1492038440, "post_id": 43378166, "comment_id": 73824111, "body": "Does your code even compile? There&#39;s no <code>End With</code> following the <code>With ActiveWorkbook</code> and in any case you&#39;re not actually using any members of the <code>With ActiveWorkbook</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1492038668, "post_id": 43378166, "comment_id": 73824157, "body": "@ThunderFrame I think OP tried to &quot;clean up&quot; their code for posting, and inadvertently removed the key to the problem. <i>And</i> made the code uncompilable."}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1492070230, "post_id": 43378166, "comment_id": 73834539, "body": "Woops, yeah I tried to clean up my code because honestly <code>ImportGammaData</code> is SUPER long. I&#39;ll post the full code when I get into work in a few hours."}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1492101840, "post_id": 43378166, "comment_id": 73856123, "body": "Ok, I just posted my full code. It&#39;s probably really overwhelming, but hopefully it would help to better pinpoint the source of the problem."}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1492103145, "post_id": 43378166, "comment_id": 73856793, "body": "I found out that the values of global variables of a workbook are wiped out after you do <code>.SaveAs</code> on that workbook. I think this is the root of the issue for me."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1492027451, "post_id": 43378636, "comment_id": 73819375, "body": "<code>Global</code> is deprecated and does <b>EXACTLY</b> the same thing as <code>Public</code>, except <code>Public</code> can also be used in class modules. OP&#39;s variable is therefore <i>already</i> global, and this code changes absolutely nothing."}, {"owner": {"reputation": 31, "user_id": 7045036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdb08166fdac9b3cca774fd39e0affd?s=128&d=identicon&r=PG&f=1", "display_name": "V&#237;ctor Urbina", "link": "https://stackoverflow.com/users/7045036/v%c3%adctor-urbina"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492036591, "post_id": 43378636, "comment_id": 73823544, "body": "Though deprecated, &quot;Global&quot; is still VALID. I have had this kind of trouble before, and this is how I solved it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1492037828, "post_id": 43378636, "comment_id": 73823934, "body": "The point is that it&#39;s IDENTICAL to <code>Public</code> everywhere it&#39;s VALID. So whatever you <i>think</i> you fixed with that, <code>Global</code> didn&#39;t fix it all by itself. Go ahead, try to reproduce that problem and fix it by replacing <code>Public</code> with <code>Global</code>. Include the repro in your answer and I&#39;ll happily remove my downvote. Otherwise, this answer is spreading misinformation and relies on magic. BTW, OP&#39;s variable is <code>gammaSheet</code>, not <code>gamaSheet</code>."}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1492103883, "post_id": 43378636, "comment_id": 73857175, "body": "Hey Victor, I appreciate you trying to help even though it didn&#39;t work! Sorry you got downvoted so much :("}], "tags": [], "owner": {"reputation": 31, "user_id": 7045036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdb08166fdac9b3cca774fd39e0affd?s=128&d=identicon&r=PG&f=1", "display_name": "V&#237;ctor Urbina", "link": "https://stackoverflow.com/users/7045036/v%c3%adctor-urbina"}, "is_accepted": false, "score": -3, "last_activity_date": 1492027316, "creation_date": 1492027316, "answer_id": 43378636, "question_id": 43378166, "link": "https://stackoverflow.com/questions/43378166/vba-public-string-not-saving/43378636#43378636", "title": "VBA public string not saving", "body": "<p>Make <code>gammaSheet</code> a global variable. Global variables keep their value after execution. In this case, after taking the value in <code>ImportGammaData()</code>, you will no have trouble when you recall the value of <code>gammaSheet</code> from <code>SaveAs()</code>.</p>\n\n<p>Change this:</p>\n\n<pre><code>    Public gamaSheet As String\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>    Global gamaSheet As String\n</code></pre>\n"}], "owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492101809, "creation_date": 1492025694, "last_edit_date": 1492101809, "question_id": 43378166, "link": "https://stackoverflow.com/questions/43378166/vba-public-string-not-saving", "title": "VBA public string not saving", "body": "<p>I'm trying to automatically save a file using public variables in two separate functions, but for some reason my public variable doesn't seem to be saving.</p>\n\n<p>After I assign my public variable <code>gammaSheet</code> a value in <code>ImportGammaData()</code>, the function works in properly assigning <code>Sheets(wkbkSheet).Name = gammaSheet</code>.</p>\n\n<p><code>MsgBox(gammaSheet)</code> also displays the proper string.</p>\n\n<p>Unfortunately, when I try to use <code>gammaSheet</code> in <code>SaveAs()</code>, it has no value.</p>\n\n<p><code>MsgBox(gammaSheet)</code> displays absolutely nothing.</p>\n\n<p>What's going on?</p>\n\n<pre><code>Public gammaSheet As String\nPublic radionuclide As String\nPublic radioligand As String\nPublic studyCond As String\nPublic studyDate As String\nPublic folderName As String\nPublic studyName As String\nPublic gammaFile As Excel.Workbook\n____________________________________________________ \nSub ImportGammaData()\n\nDim wkbkSheet As String\nwkbkSheet = ThisWorkbook.Sheets(6).Name\nThisWorkbook.Sheets(wkbkSheet).Range(\"A1:L105\").Value = \"\"\nThisWorkbook.Sheets(wkbkSheet).Range(\"A1:L105\").Interior.ColorIndex = 0\n\nDim gammaFileName As String\n\nDim starting_file_directory As String\nstarting_file_directory = Range(\"E3\").Text\nChDrive starting_file_directory\ngammaFileName = Application.GetOpenFilename(, , \"Gamma counter file for study sheet\")\n\nSet gammaFile = Workbooks.Open(gammaFileName)\n\nWith ActiveWorkbook\n\ngammaSheet = ActiveSheet.Name\n\nRange(\"A1\").TextToColumns Destination:=Range(\"A1\"), DataType:=xlFixedWidth, _\n    FieldInfo:=Array(Array(0, 1), Array(17, 1), Array(41, 1)), TrailingMinusNumbers _\n    :=True\n\nRange(\"A3:A8\").TextToColumns Destination:=Range(\"A3\"), DataType:=xlFixedWidth, _\n    FieldInfo:=Array(Array(0, 1), Array(20, 1), Array(31, 1)), TrailingMinusNumbers _\n    :=True\n\nRange(\"A10\").Select\nRange(Selection, Selection.End(xlDown)).TextToColumns Destination:=Range(\"A10\"), DataType:=xlFixedWidth, _\n    FieldInfo:=Array(Array(0, 1), Array(6, 1), Array(11, 1), Array(17, 1), Array(23, 1), _\n    Array(32, 1), Array(42, 1), Array(51, 1), Array(61, 1)), TrailingMinusNumbers:=True\n\nThisWorkbook.Sheets(wkbkSheet).Range(\"A1:I105\").Value = gammaFile.Sheets(gammaSheet).Range(\"A1:I105\").Value\n\nEnd With\n\ngammaFile.Close savechanges:=False\n\nSheets(wkbkSheet).Name = gammaSheet\n\nSheets(gammaSheet).Range(\"A10:I10\").Font.Bold = True\nSheets(gammaSheet).Range(\"J10\") = \"Sample ID\"\nSheets(gammaSheet).Range(\"J11\") = \"Cs-137\"\nSheets(gammaSheet).Range(\"J12\") = \"Ge\"\nSheets(gammaSheet).Range(\"J13\") = \"Background\"\nSheets(gammaSheet).Range(\"K10\") = \"Volume (\u00b5L)\"\nSheets(gammaSheet).Range(\"L10\") = \"ACN (\u00b5L)\"\n\nSheets(1).Range(\"A16\").Value = gammaSheet\n\nSheets(\"Decay Correction\").Range(\"C2\").Value = Sheets(gammaSheet).Range(\"C1\").Value\n\nIf Sheets(gammaSheet).Range(\"B6\").Value = \"C-11\" Then\n    Sheets(\"Decay Correction\").Range(\"B3\").Value = \"t(1/2) of C-11\"\n    Sheets(\"Decay Correction\").Range(\"C3\").Value = \"20.385\"\nEnd If\n\nIf Sheets(gammaSheet).Range(\"B6\").Value = \"F-18\" Then\n    Sheets(\"Decay Correction\").Range(\"B3\").Value = \"t(1/2) of F-18\"\n    Sheets(\"Decay Correction\").Range(\"C3\").Value = \"109.77\"\nEnd If\n\nSheets(1).Range(\"B6\").Value = \"GAMMA COUNTER FILE IMPORTED!\"\nThisWorkbook.Sheets(1).Range(\"B6\").Interior.ColorIndex = 50\n\nradionuclide = \"[\" + Sheets(gammaSheet).Range(\"B6\").Value + \"]\"\n\nEnd Sub\n____________________________________________________ \nSub SaveAs()\nSheets(\"Initial\").Select\nfolderName = Range(\"A20\").Value\nstudyName = Range(\"A16\").Value + \" \" + Range(\"B16\").Value + \" \" + Range(\"C16\").Value + \" \" + Range(\"D16\").Value + \" \" + CStr(Range(\"E16\").Value) + \" \" + Range(\"F16\").Value\n\n'Dim strPath As String\n'strPath = \"C:\\Users\\tyeg\\Documents\\Gamma Counter Processing\" &amp; folderName\n'Dim elm As Variant\n'Dim strCheckPath As String\n'\n'strCheckPath = \"\"\n'For Each elm In split(strPath, \"\\\")\n'    strCheckPath = strCheckPath &amp; elm &amp; \"\\\"\n'    If Len(Dir(strCheckPath, vbDirectory)) = 0 Then MkDir strCheckPath\n'Next\n\nThisWorkbook.SaveAs Filename:= _\n    \"C:\\Users\\tyeg\\Documents\\Gamma Counter Processing\\\" + folderName + \"\\\" + studyName + \".xlsm\"\n\nMsgBox (gammaSheet)\n\ngammaFile.SaveAs Filename:= _\n    \"C:\\Users\\tyeg\\Documents\\Gamma Counter Processing\\\" + folderName + \"\\\" + gammaSheet + \".T\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1492026157, "post_id": 43378132, "comment_id": 73818606, "body": "Is <code>ClassList2017</code> an actual Excel Table (as in the Table object itself) or is it just a named range that you have set up in a table like fashion?"}, {"owner": {"reputation": 95, "user_id": 7853320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-sNsg1EjAqg8/AAAAAAAAAAI/AAAAAAAAABE/l44AiARM8sQ/photo.jpg?sz=128", "display_name": "Cielo Salas", "link": "https://stackoverflow.com/users/7853320/cielo-salas"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1492030321, "post_id": 43378132, "comment_id": 73820986, "body": "Thanks for the swift response! It is just a named range in the table"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492030909, "post_id": 43378132, "comment_id": 73821289, "body": "You can use <code>cname.Offset(,1)</code> to refer to the cell one to the right."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 7853320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-sNsg1EjAqg8/AAAAAAAAAAI/AAAAAAAAABE/l44AiARM8sQ/photo.jpg?sz=128", "display_name": "Cielo Salas", "link": "https://stackoverflow.com/users/7853320/cielo-salas"}, "edited": false, "score": 0, "creation_date": 1492033696, "post_id": 43379741, "comment_id": 73822462, "body": "Thank you so much Scott! Can&#39;t express it enough how much i appreciate this."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1492031579, "creation_date": 1492031579, "answer_id": 43379741, "question_id": 43378132, "link": "https://stackoverflow.com/questions/43378132/vba-create-additional-tabs-in-the-worksheet-based-on-a-list-in-a-table/43379741#43379741", "title": "vba Create additional tabs in the worksheet based on a list in a table", "body": "<p>I think this will work. I refactored a bit to avoid the GoTo statement and declare some explicit objects. Proper error trapping always beats GoTo statements.</p>\n\n<pre><code>Option Explicit\n\nSub CreateCATtabs()\n\n    Dim wsControl As Worksheet, wsAttendance As Worksheet\n\n    Set wsControl = Worksheets(\"Control\")\n    Set wsAttendance = Worksheets(\"Class Attendance\")\n\n    Dim cName As Range, cList As Range\n\n    Set cList = wsControl.Range(\"ClassList2017\")\n\n    For Each cName In cList\n\n        If cName.Value &lt;&gt; \"\" Then\n\n            wsAttendance.Copy After:=Sheets(Sheets.Count)\n\n            Dim wsCopy As Worksheet\n            Set wsCopy = ActiveSheet\n\n            With wsCopy\n\n               .Name = cName.Value\n               .Range(\"E6\").Value = cName.Value\n               .Range(\"E5\").Value = cName.Offset(, 10).Value 'offset is 1 minus the column number\n               .Range(\"E7\").Value = cName.Offset(, 7).Value\n               .Range(\"E8\").Value = cName.Offset(, 1).Value\n\n            End With\n\n\n        Else\n\n            Exit For\n\n        End If\n\n    Next cName\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 7853320, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh3.googleusercontent.com/-sNsg1EjAqg8/AAAAAAAAAAI/AAAAAAAAABE/l44AiARM8sQ/photo.jpg?sz=128", "display_name": "Cielo Salas", "link": "https://stackoverflow.com/users/7853320/cielo-salas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 43379741, "answer_count": 1, "score": 1, "last_activity_date": 1492031579, "creation_date": 1492025584, "question_id": 43378132, "link": "https://stackoverflow.com/questions/43378132/vba-create-additional-tabs-in-the-worksheet-based-on-a-list-in-a-table", "title": "vba Create additional tabs in the worksheet based on a list in a table", "body": "<p>i am not well versed in vba and macros and i need help in creating additional worksheets based on a list. So i have a table with a class list on the first column, location on 2nd column, Trainer in column 8 and start date in column 11. I need to also rename the copied tab using the class list data and put that into cell E6 as well. Problem is i don't know how to also get the location, Trainer and start date for each class and put those in the copied tab (start date in E5, Trainer in E7 and location in E8.</p>\n\n<p>Here is what i have so far:</p>\n\n<pre><code>   Sub CreateCATtabs()\n        On Error GoTo GetOut\n\n        Dim cName As Range, cList As Range\n\n        Set cList = Sheets(\"Control\").Range(\"ClassList2017\")\n\n        For Each cName In cList\n            If cName.Value = \"\" Then GoTo GetOut\n\n            Sheets(\"Class Attendance\").Copy After:=Sheets(Sheets.Count)\n            With ActiveSheet\n               .Name = cName.Value\n               .Range(\"E6\").Value = cName.Value\n\n            End With\n        Next cName\n        GetOut:\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492025225, "post_id": 43377999, "comment_id": 73818102, "body": "Have you debugged? Set breakpoint and step through code. Are variables populated with expected values? I have never seen # used like that (-1#, 0#). What is it for?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1492025329, "post_id": 43377999, "comment_id": 73818169, "body": "I believe #Name means you have a syntax error; you need to check the output formula for spelling, etc."}, {"owner": {"reputation": 165, "user_id": 5551198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bdea722e6099ff2292086e9e0090694?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/5551198/david"}, "edited": false, "score": 0, "creation_date": 1492026243, "post_id": 43377999, "comment_id": 73818667, "body": "Whenever I tried to initialize the double with a decimal of &quot;.0&quot; it would correct it to &quot;#&quot; so -1.0 was auto-corrected to -1#."}, {"owner": {"reputation": 165, "user_id": 5551198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bdea722e6099ff2292086e9e0090694?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/5551198/david"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1492026458, "post_id": 43377999, "comment_id": 73818786, "body": "It is not letting me debug, so a syntax error as @Cyril suggested would make sense. Excel is saying it is an Invalid Name Error, but I can&#39;t figure out why. In cell B2 I used &quot;=getWeight(A2)&quot;. The value in A2 is &quot;R221-FT-AA1&quot;. Why would I get an invalid name error here?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492027279, "post_id": 43377999, "comment_id": 73819288, "body": "The NAME error suggests the formula name is not recognised. You can step into a function by adding a <code>Stop</code> statement at the top."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1492028079, "post_id": 43377999, "comment_id": 73819759, "body": "You put the function in the worksheet module as opposed to regular module, didn&#39;t you?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492029707, "post_id": 43377999, "comment_id": 73820683, "body": "Where is this code written in? Macros and UDF&#39;s <b>must</b> be implemented in <b>standard modules</b> (.bas), not classes (i.e. not in documents/worksheets/workbooks, userforms and class modules)."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1492028355, "post_id": 43378791, "comment_id": 73819931, "body": "None of that will result in a <code>#NAME?</code> error though."}, {"owner": {"reputation": 153, "user_id": 7753279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a80a3c3ee5d2ef3188d576f743b06fc?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/7753279/jared"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1492029438, "post_id": 43378791, "comment_id": 73820534, "body": "Aside from that it has to be a problem with the data.  When I plugged this code in it returned 0.  Now it returns a weight.  Have a lookup sheet called weights, ColA is product, ColB is weights.  A2 has product."}, {"owner": {"reputation": 153, "user_id": 7753279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a80a3c3ee5d2ef3188d576f743b06fc?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/7753279/jared"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1492032233, "post_id": 43378791, "comment_id": 73821872, "body": "Mat&#39;s Mug probably has the #Name answer below.  I just threw this into a module straight away, didn&#39;t even think about it."}, {"owner": {"reputation": 165, "user_id": 5551198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bdea722e6099ff2292086e9e0090694?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/5551198/david"}, "edited": false, "score": 0, "creation_date": 1492092628, "post_id": 43378791, "comment_id": 73850063, "body": "You&#39;re right about the booleans. I didn&#39;t notice that, thank you."}], "tags": [], "owner": {"reputation": 153, "user_id": 7753279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a80a3c3ee5d2ef3188d576f743b06fc?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/7753279/jared"}, "is_accepted": false, "score": 2, "last_activity_date": 1492028293, "last_edit_date": 1492028293, "creation_date": 1492027883, "answer_id": 43378791, "question_id": 43377999, "link": "https://stackoverflow.com/questions/43377999/custom-vba-function-returning-name/43378791#43378791", "title": "Custom VBA function returning #NAME?", "body": "<p>Each iteration of the </p>\n\n<pre><code>p = 1 to len(compmodel) \n</code></pre>\n\n<p>loop resets all your Booleans to false.  This means the statement</p>\n\n<pre><code>If samePump And (sameMotor Or special) Then\n</code></pre>\n\n<p>is never true because it never evaluates all of those on the same pass of the loop.  Put the boolean setters before the start of the loop instead of in it.</p>\n\n<pre><code>samePump = False\nsameMotor = False\nspecial = False\nnumMatches = 0\nFor p = 1 To Len(compModel)\n</code></pre>\n\n<p>Also if you did want to use the debugger just run this.  That way you can step through the code line by line and see whats going on.</p>\n\n<pre><code>Sub main()\nDim THingy As Double\nTHingy = getWeight(\"R221-FT-AA1\")\nMsgBox (THingy)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1492030793, "last_edit_date": 1495541386, "creation_date": 1492029909, "answer_id": 43379337, "question_id": 43377999, "link": "https://stackoverflow.com/questions/43377999/custom-vba-function-returning-name/43379337#43379337", "title": "Custom VBA function returning #NAME?", "body": "<p>The function is (implicitly) <code>Public</code>, so the only way to get a <code>#NAME?</code> error is to implement it in the wrong type of module, such that Excel doesn't know what <code>=getWeight</code> is referring to.</p>\n\n<p>You need to add a <em>standard procedural module (.bas)</em> to your project, cut the function, and paste it in there.</p>\n\n<p><a href=\"https://stackoverflow.com/a/43378791/1188513\">Bugs aside</a>, you should be able to call your UDF from the worksheet.</p>\n\n<p><code>ThisWorkbook</code>, as well as all <code>Worksheet</code> modules, <code>UserForm</code> modules, and plain class modules, are <em>blueprints</em> for <strong>objects</strong>, which means in order to call their public members you need to qualify the member calls with an <em>instance</em> of that class... and a UDF (or macro for that matter) call can't do that.</p>\n"}, {"tags": [], "owner": {"reputation": 165, "user_id": 5551198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bdea722e6099ff2292086e9e0090694?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/5551198/david"}, "is_accepted": false, "score": 0, "last_activity_date": 1492093453, "creation_date": 1492093453, "answer_id": 43394869, "question_id": 43377999, "link": "https://stackoverflow.com/questions/43377999/custom-vba-function-returning-name/43394869#43394869", "title": "Custom VBA function returning #NAME?", "body": "<p>I found the problem. Even though the file was saved as a macro enabled workbook (.xlsm) macros were not enabled. When I reopened it this morning, it gave me the option to enable macros. Once I did that and corrected the code as Jared suggested, it all worked as planned.</p>\n"}], "owner": {"reputation": 165, "user_id": 5551198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bdea722e6099ff2292086e9e0090694?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/5551198/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3221, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1492093453, "creation_date": 1492025054, "question_id": 43377999, "link": "https://stackoverflow.com/questions/43377999/custom-vba-function-returning-name", "title": "Custom VBA function returning #NAME?", "body": "<p>I have written a VBA function to calculate the weight of a determine the weight of a certain item from its model number by comparing it to the model number of items with known weights. For some reason it is only returning <b>#NAME?</b></p>\n\n<p>Here is the code:</p>\n\n<pre><code>Function getWeight(model As String) As Double\nDim weight As Double\nweight = -1#\n\nDim compModel As String\ncompModel = \"\"\n\nDim prevNumMatches As Integer\nprevNumMatches = 0\n\nDim numMatches As Integer\nnumMatches = 0\n\nDim i As Integer\nDim p As Integer\n\nDim samePump As Boolean\nDim sameMotor As Boolean\nDim special As Boolean\n\n\nFor i = 2 To 1000\n    compModel = CStr(Sheets(\"Weights\").Cells(i, 1).Value)\n\n    For p = 1 To Len(compModel)\n        samePump = False\n        sameMotor = False\n        special = False\n        numMatches = 0\n\n        If p = 1 Then\n            If Mid(model, p, 1) = Mid(compModel, p, 1) Then\n                samePump = True\n                numMatches = numMatches + 1\n            End If\n        ElseIf p = 5 Then\n            If Mid(model, p, 1) &lt;&gt; \"-\" Then\n                special = True\n            End If\n            If Mid(model, p, 1) = Mid(compModel, p, 1) Then\n                numMatches = numMatches + 1\n            End If\n        ElseIf p = 9 Then\n            If Mid(model, p, 1) = Mid(compModel, p, 1) Then\n                sameMotor = True\n                numMatches = numMatches + 1\n            End If\n        Else\n            If Mid(model, p, 1) = Mid(compModel, p, 1) Then\n                numMatches = numMatches + 1\n            End If\n        End If\n\n        If samePump And (sameMotor Or special) Then\n            If numMatches &gt; prevNumMatches Then\n                weight = CDbl(Sheets(\"Weights\").Cells(i, 2).Value)\n                prevNumMatches = numMatches\n            ElseIf numMatches = prevNumMatches Then\n                If CDbl(Sheets(\"Weights\").Cells(i, 2).Value) &gt; weight Then\n                    weight = CDbl(Sheets(\"Weights\").Cells(i, 2).Value)\n                End If\n            End If\n        End If\n    Next p\nNext i\n\nIf weight = -1# Then\n    getWeight = 0#\nElse\n    getWeight = weight\nEnd If\nEnd Function\n</code></pre>\n\n<p>Why is this not returning a number as I expect?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492025190, "post_id": 43377968, "comment_id": 73818088, "body": "What is &quot;isFound&quot;? It looks like a variable, but you don&#39;t show how it&#39;s declared or set. Your use of &quot;in&quot; also seems odd."}, {"owner": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "reply_to_user": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492025311, "post_id": 43377968, "comment_id": 73818152, "body": "@RichHolton , i think isFound is the vba boolean function"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492025947, "post_id": 43377968, "comment_id": 73818481, "body": "I do not think isFound is an intrinsic VBA function or constant. Looks more like a user defined variable or constant, perhaps it has been globally declared and set in a public module."}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492026117, "post_id": 43377968, "comment_id": 73818578, "body": "You might find the Excel VBA reference useful: <a href=\"https://msdn.microsoft.com/en-us/library/office/ee861528.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ee861528.aspx</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492028075, "post_id": 43377968, "comment_id": 73819757, "body": "Clearly it&#39;s pseudo code."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "edited": false, "score": 0, "creation_date": 1492025580, "post_id": 43378108, "comment_id": 73818294, "body": "the use of InStr(rng, srch) is much easier! thank you"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "edited": false, "score": 0, "creation_date": 1492025698, "post_id": 43378108, "comment_id": 73818353, "body": "You&#39;re weleomce EricCarlson! Glad it worked. Please take a moment to accept the answer to mark your question as Solved."}, {"owner": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "edited": false, "score": 0, "creation_date": 1492025967, "post_id": 43378108, "comment_id": 73818496, "body": "I tried to run it with the overall program but I got an error on that InStr line, it states there is a type mismatch"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "edited": false, "score": 0, "creation_date": 1492026013, "post_id": 43378108, "comment_id": 73818522, "body": "How did you call that function?"}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492026251, "post_id": 43378108, "comment_id": 73818674, "body": "inStr does not take a Range as a parameter. It operates on Strings."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492026421, "post_id": 43378108, "comment_id": 73818768, "body": "@Rich When you pass a range in instr, it reads it&#39;s value as .Value is default property used when a range is used alone. Alternatively you can use Rng.Value also."}, {"owner": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "edited": false, "score": 0, "creation_date": 1492026598, "post_id": 43378108, "comment_id": 73818873, "body": "@sktneer , ran the updated code that you posted, but still getting type mismatch error for the InStr line"}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492026757, "post_id": 43378108, "comment_id": 73818989, "body": "@skineer -- But it fails when the Range isn&#39;t a single cell. Why write a function to find if a string exists in a Range if the Range is limited to only a single cell? That&#39;s pointless."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1492027164, "post_id": 43378108, "comment_id": 73819217, "body": "You are right. But OP needs to check a string in a range of cells. See the edited function as per OP&#39;s request."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1492027961, "post_id": 43378108, "comment_id": 73819696, "body": "Does your range contains Error returned by a formula?"}, {"owner": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "edited": false, "score": 0, "creation_date": 1492030073, "post_id": 43378108, "comment_id": 73820870, "body": "@sktneer , there is no formula at all in any cells"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1492030204, "post_id": 43378108, "comment_id": 73820930, "body": "Then I see no reason why you get type mismatch error. I tested the function on the worksheet as well as on Module and it worked completely fine as per your code. It may return False but producing an error is not understood by any means."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1492030752, "post_id": 43378108, "comment_id": 73821209, "body": "Watch this short video to know how the function works. I ran your code with the latest function with some modification like I used If InStr(LCase(cell), LCase(srch)) Then to make the search case insensitive. Video link:  <a href=\"https://www.screencast.com/t/fl6nqoPxFDg\" rel=\"nofollow noreferrer\">screencast.com/t/fl6nqoPxFDg</a>"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1492026211, "last_edit_date": 1492026211, "creation_date": 1492025480, "answer_id": 43378108, "question_id": 43377968, "link": "https://stackoverflow.com/questions/43377968/vba-function-search-error/43378108#43378108", "title": "Vba function search error", "body": "<p>You may try it like this...</p>\n\n<pre><code>Function stringExists(rng As Range, srch As String) As Boolean\n    If InStr(rng, srch) Then\n        stringExists = True\n    Else\n        stringExists = False\n    End If\nEnd Functio\n</code></pre>\n\n<p>The above function will work if you pass a single cell as a first argument.\nIf your range contains more than one cell, try that function like this...</p>\n\n<pre><code>Function stringExists(rng As Range, srch As String) As Boolean\nDim cell As Range\nFor Each cell In rng\n    If InStr(cell, srch) Then\n        stringExists = True\n        Exit For\n    Else\n        stringExists = False\n    End If\nNext cell\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7525347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fef1b39eee5e4420c17b4acdeb0df2d7?s=128&d=identicon&r=PG&f=1", "display_name": "EricCarlson", "link": "https://stackoverflow.com/users/7525347/ericcarlson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 43378108, "answer_count": 1, "score": 1, "last_activity_date": 1492026211, "creation_date": 1492024926, "last_edit_date": 1492025994, "question_id": 43377968, "link": "https://stackoverflow.com/questions/43377968/vba-function-search-error", "title": "Vba function search error", "body": "<p>I am trying to write a Boolean function named stringExists. The function takes two arguments: a Range named rng and a String named srch. The function returns True if the string srch is found in the Range rng.</p>\n\n<p>This is the code I have so far:</p>\n\n<pre><code>Function stringExists(rng As Range, srch As String) As Boolean\n    if srch isFound in rng then\n        stringExists = True\n    else\n        stringExists = False\nEnd Function\n</code></pre>\n\n<p>However the line if srch isFound is highlighted red in my vba editor. I am pretty sure I have the basics of this code correct but I am stumped as to what my mistake is. Would appreciate some guidance on this matter. Thank you !</p>\n\n<p>Edit here is what I have so far:</p>\n\n<pre><code>Sub test()\n\nDim rng As Range\nDim srch As String\n\nsrch = InputBox(\"Enter the string you want to search for: \")\nSet rng = Range(\"A1:A100\")\n\nMsgBox \"The phrase is\" &amp; _\n    stringExists(rng, srch)\nEnd Sub\nFunction stringExists(rng As Range, srch As String) As Boolean\nIf InStr(rng, srch) Then\n    stringExists = True\nElse\n    stringExists = False\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "edited": false, "score": 0, "creation_date": 1492030069, "post_id": 43378790, "comment_id": 73820869, "body": "Thanks Jon! This works well but I would need it to automatically calculate these numbers from another sheet based on the name of each person in the sheet so they can see their average. Is there a way to get the macro to automatically calculate each name&#39;s average and place it into a cell onto the next sheet?"}, {"owner": {"reputation": 1, "user_id": 7858521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681225e3c02bc18a1ddf964ed89e027c?s=128&d=identicon&r=PG&f=1", "display_name": "JonS2017", "link": "https://stackoverflow.com/users/7858521/jons2017"}, "reply_to_user": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "edited": false, "score": 0, "creation_date": 1492033477, "post_id": 43378790, "comment_id": 73822369, "body": "I would change it to a function then instead of msg box output it... then take your cols and combine them into 1 and then do a unique on it."}, {"owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "edited": false, "score": 0, "creation_date": 1492075239, "post_id": 43378790, "comment_id": 73837679, "body": "This shows 266.667 instead of 275 for Bill because it double counts the first row. To avoid this, it needs an <code>Exit For</code> statement under the <code>If</code> clause. Also, if there are any blanks within Bill&#39;s cell it will return 0."}], "tags": [], "owner": {"reputation": 1, "user_id": 7858521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681225e3c02bc18a1ddf964ed89e027c?s=128&d=identicon&r=PG&f=1", "display_name": "JonS2017", "link": "https://stackoverflow.com/users/7858521/jons2017"}, "is_accepted": false, "score": -1, "last_activity_date": 1492027875, "creation_date": 1492027875, "answer_id": 43378790, "question_id": 43377934, "link": "https://stackoverflow.com/questions/43377934/excel-if-value-appears-in-any-column-average-the-reference-column/43378790#43378790", "title": "Excel if value appears in any column, average the reference column", "body": "<p>So if Bill is in any col a-e that number is taking into the ave...  If so depending on your data size why not do this simply...:</p>\n\n<pre><code>Sub simplesearch()\n    cnt = 0\n    tot = 0\n    srchval = InputBox(\"What are we looking for?\")\n    lr = Range(\"A1000000\").End(xlUp).Row\n    For i = 1 To lr\n        For j = 1 To 5\n            If Cells(i, j).Value = srchval Then\n                tot = tot + Cells(i, 6).Value\n                cnt = cnt + 1\n            End If\n        Next j\n    Next i\n    If Not (cnt = 0) Then\n        MsgBox (tot / cnt)\n    Else\n        MsgBox (\"0\")\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 104, "user_id": 7214249, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/500d7f49fd67bb3abc3a42ea8187ba63?s=128&d=identicon&r=PG", "display_name": "Delete Me", "link": "https://stackoverflow.com/users/7214249/delete-me"}, "is_accepted": false, "score": 0, "last_activity_date": 1492034155, "creation_date": 1492034155, "answer_id": 43380289, "question_id": 43377934, "link": "https://stackoverflow.com/questions/43377934/excel-if-value-appears-in-any-column-average-the-reference-column/43380289#43380289", "title": "Excel if value appears in any column, average the reference column", "body": "<p>Assuming the lookup value (Bill etc) is in cell C7, add the following formula in G1 then copy down for other rows.</p>\n\n<pre><code>=IF(ISERROR(MATCH($C$7,A1:E1,0)),\"\",F1)\n</code></pre>\n\n<p>Then do</p>\n\n<pre><code>=AVERAGE(G1:G4)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "edited": false, "score": 0, "creation_date": 1492090168, "post_id": 43380722, "comment_id": 73848305, "body": "This works great as long as the array is 4 lines long. My array always has 6 columns and the value is in a 7th column. However, my array can range from 8 to 36 rows every month. Is there a way to use this with variable sizes of arrays?"}, {"owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "reply_to_user": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "edited": false, "score": 0, "creation_date": 1492092372, "post_id": 43380722, "comment_id": 73849891, "body": "I have updated the answer so that it solves the generic version too. Three parts need to be edited, as shown in the in-line comments. Storing the data in VBA arrays makes the calculations pretty fast, even for tens of hundreds times more data, so I would just fix the rows to 40 (or even more), as suggested in the comments."}, {"owner": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "edited": false, "score": 0, "creation_date": 1492097919, "post_id": 43380722, "comment_id": 73853850, "body": "That did the trick, and it worked perfectly! Is there any chance this sort of answer would work to answer this problem as well? <a href=\"http://stackoverflow.com/questions/43374008/excel-counts-the-number-of-times-a-value-appears-in-a-group-of-columns-but-count?rq=1\">Counts the number of times a value appears in a group of columns but counts only one instance per row</a>"}, {"owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "reply_to_user": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "edited": false, "score": 0, "creation_date": 1492108359, "post_id": 43380722, "comment_id": 73859391, "body": "Yes, that is easy: just remove the last <code>If</code> block altogether and put <code>my_average=dlbSum</code> instead. Probably a better name for the function would be a good idea too."}, {"owner": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "edited": false, "score": 0, "creation_date": 1492139587, "post_id": 43380722, "comment_id": 73869718, "body": "That too worked amazingly well! Thanks again for all your help!"}], "tags": [], "owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "is_accepted": true, "score": 0, "last_activity_date": 1492092186, "last_edit_date": 1492092186, "creation_date": 1492036583, "answer_id": 43380722, "question_id": 43377934, "link": "https://stackoverflow.com/questions/43377934/excel-if-value-appears-in-any-column-average-the-reference-column/43380722#43380722", "title": "Excel if value appears in any column, average the reference column", "body": "<p>I would use the function below, assuming that the data is placed in <code>Sheet1</code>.</p>\n\n<pre><code>Function my_average(strName As String) As Variant\n Dim varArrayNames As Variant\n Dim varValues As Variant\n Dim dblInSum(1 To 4) As Double '~~&gt; change to \"1 To 40\"\n Dim lngCnt As Long\n Dim strRow As String\n Dim dblSum As Double\n\n varArrayNames = Sheet1.Range(\"B1:E4\").Value '~~&gt; change to \"B1:G40\"\n varValues = Sheet1.Range(\"F1:F4\").Value    '~~&gt; change to \"H1:H40\"\n\n For lngCnt = LBound(varArrayNames, 1) To UBound(varArrayNames, 1)\n     strRow = Join(WorksheetFunction.Index(varArrayNames, lngCnt, 0))\n     If InStr(strRow, strName) &gt; 0 Then\n       dblInSum(lngCnt) = 1\n     End If\n Next lngCnt\n\n dblSum = WorksheetFunction.Sum(dblInSum)\n\n If dblSum &gt; 0 Then\n   my_average = WorksheetFunction.SumProduct(dblInSum, Application.Transpose(varValues)) / dblSum\n Else\n  my_average = 0\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Testing:</p>\n\n<p>Place <code>=my_average(\"Bill\")</code> in any workbook (or a cell reference instead of \"Bill\").</p>\n\n<p>Formulas:\n<a href=\"https://i.stack.imgur.com/qgi4K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qgi4K.png\" alt=\"enter image description here\"></a></p>\n\n<p>Results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zA83b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zA83b.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 43380722, "answer_count": 3, "score": 0, "last_activity_date": 1492092186, "creation_date": 1492024797, "last_edit_date": 1531161705, "question_id": 43377934, "link": "https://stackoverflow.com/questions/43377934/excel-if-value-appears-in-any-column-average-the-reference-column", "title": "Excel if value appears in any column, average the reference column", "body": "<p>I need to find the average of a number found in column F if a particular value is found in any of the other columns in the sheet. </p>\n\n<p>For instance: I have the following in a range...</p>\n\n<pre><code>     A        B         C         D         E        F  \n</code></pre>\n\n<ol>\n<li>Red&nbsp;&emsp;&emsp;&nbsp;&nbsp;Bill&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;Jack&emsp;&emsp;&nbsp;&nbsp;Ruby&emsp;&emsp;&nbsp;&nbsp;&nbsp;Bill&emsp;&emsp;&nbsp;&nbsp;&nbsp;250</li>\n<li>Blue&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ruby&emsp;&emsp;&nbsp;Ivan&emsp;&emsp;&nbsp;&nbsp;Raul&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;Ted&emsp;&emsp;&nbsp;&nbsp;350</li>\n<li>Green&emsp;&nbsp;&nbsp;&nbsp;Ted&emsp;&emsp;&nbsp;&nbsp;&nbsp;James&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rick&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ted&emsp;&emsp;&nbsp;125</li>\n<li>Red&nbsp;&nbsp;&nbsp;&emsp;&emsp;Ted&emsp;&emsp;&nbsp;&nbsp;&nbsp;Phil&emsp;&emsp;&nbsp;&nbsp;&nbsp;Ruby&emsp;&emsp;&nbsp;&nbsp;&nbsp;&nbsp;Bill&emsp;&emsp;&nbsp;&nbsp;300</li>\n</ol>\n\n<p>And in this worksheet, I want to find any instance of the name Bill and get the average of the number found in column F. In this case, the answer of 275 because Bill's name shows up in two rows. In the same respect, If I choose to look at Ted's numbers, the answer should be 258 because Ted's name shows up in three rows.</p>\n\n<p>I would also appreciate if the formula would ignore any blank cells in the process of calculating the answer.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "excel-automation"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1492024511, "post_id": 43377811, "comment_id": 73817716, "body": "Do you have any code which you&#39;ve tried to help you scrape from the webpage?  As SO is designed to help with coding, not code for you, it would help the process along."}, {"owner": {"reputation": 67, "user_id": 6057330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ol1J1dV_rok/AAAAAAAAAAI/AAAAAAAAACQ/cOC0KULsvs4/photo.jpg?sz=128", "display_name": "Bharath Babu", "link": "https://stackoverflow.com/users/6057330/bharath-babu"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1492024768, "post_id": 43377811, "comment_id": 73817873, "body": "Hi cyril.. I&quot;ve use Below code"}], "owner": {"reputation": 67, "user_id": 6057330, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ol1J1dV_rok/AAAAAAAAAAI/AAAAAAAAACQ/cOC0KULsvs4/photo.jpg?sz=128", "display_name": "Bharath Babu", "link": "https://stackoverflow.com/users/6057330/bharath-babu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492025539, "creation_date": 1492024310, "last_edit_date": 1492025539, "question_id": 43377811, "link": "https://stackoverflow.com/questions/43377811/how-to-scrape-data-from-newly-opening-webpage", "title": "How to scrape data from newly opening webpage?", "body": "<p>To scrape data from webpage which is opening after clicking a <em>submit</em> button</p>\n\n<p>In <a href=\"http://www.omnilogistics.com/\" rel=\"nofollow noreferrer\">this website</a> I'm filling textbox showing place-holder <strong>#Tracking</strong> with this value <strong>148459</strong> after filling clicking <em>Submit</em> it opens another page, with details... I want to scrape the data on that page and bring it into Excel using VBA.</p>\n\n<p>My guess is that the <em>Submit</em> button is using POST method; I need help to scrape the webpage with POST method.</p>\n\n<p>I've worked out with below code:</p>\n\n<pre><code>Dim IE    As New SHDocVw.InternetExplorer\nDim HTMLDoc     As MSHTML.HTMLDocument\nDim HTMLInput   As MSHTML.IHTMLElement\nDim HTMLButton  As MSHTML.IHTMLElement\nDim HTMLButtons As MSHTML.IHTMLElementCollection\n\nDim HTMLAs As MSHTML.IHTMLElementCollection\nDim HTMLA As MSHTML.IHTMLElement\nDim txt As String\nDim delStat As String\n\ntxt = ActiveCell.Value\nIE.Visible = True\n'IE.Navigate \"http://206.50.6.194/WebtrakWT/shipinquiry/quicktrack.aspx\"\nIE.Navigate \"http://206.50.6.194/WebtrakWT/shipinquiry/ShipInfo.aspx?OrderNo=393874&amp;Back=QuickTrack&amp;TrackType=HousebillNo&amp;TrackNo=\" &amp; txt\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\nLoop\n\nSet HTMLDoc = IE.Document\n\n'Set HTMLInput = HTMLDoc.getElementById(\"ddlTrackBy\")\n'HTMLInput.Value = \"HousebillNo\"\n'Set HTMLInput = HTMLDoc.getElementById(\"txtInputNo\")\n'HTMLInput.Value = ActiveCell.Value\n'Do While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n'    DoEvents\n'    Loop\n'Set HTMLButton = HTMLDoc.getElementById(\"btnSubmit\")\n'HTMLButton.Click\n\nDo While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\n    Loop\n\nSet HTMLAs = HTMLDoc.getElementsByTagName(\"span\")\n\nFor Each HTMLA In HTMLAs\n    Debug.Print HTMLA.getAttribute(\"id\"), HTMLA.innerHTML\nNext HTMLA\n\ndelStat = HTMLDoc.getElementById(\"lblStatus\").innerHTML\nDebug.Print delStat\n\nIf delStat = \"DELIVERED\" Then\nActiveCell.Offset(0, 5).Value = \"Delivered\"\nCall screenShot\nElse\nActiveCell.Offset(0, 5).Value = \"Not Delivered\"\nEnd If\n\nIE.Quit\nSet IE = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba", "finance", "financial"], "comments": [{"owner": {"reputation": 2750, "user_id": 1596105, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/167dc957b0dcdbdc9c2a877075ac71a2?s=128&d=identicon&r=PG", "display_name": "criticalfix", "link": "https://stackoverflow.com/users/1596105/criticalfix"}, "edited": false, "score": 1, "creation_date": 1492023823, "post_id": 43377604, "comment_id": 73817325, "body": "You might want to ask Yahoo, or check their documentation?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7858332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313caf29667687432a82356fb280b919?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/7858332/sebastian"}, "edited": false, "score": 0, "creation_date": 1492028605, "post_id": 43378702, "comment_id": 73820075, "body": "I understand that, but I&#39;m not entirely sure how to corrected efficiently. I was not the one who made the coding"}, {"owner": {"reputation": 13, "user_id": 7858332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313caf29667687432a82356fb280b919?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/7858332/sebastian"}, "edited": false, "score": 0, "creation_date": 1492028721, "post_id": 43378702, "comment_id": 73820139, "body": "I guess my question would be how do I get, or what is the exact API address?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 13, "user_id": 7858332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313caf29667687432a82356fb280b919?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/7858332/sebastian"}, "edited": false, "score": 0, "creation_date": 1492029470, "post_id": 43378702, "comment_id": 73820551, "body": "It looks like it is dynamically generated now.  It looks like the income statement, balance sheet, and cash flow statement all have table class  = Lh(1.7) W(100%) M(0) Yahoo must have changed it recently."}, {"owner": {"reputation": 13, "user_id": 7858332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313caf29667687432a82356fb280b919?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/7858332/sebastian"}, "edited": false, "score": 0, "creation_date": 1492029869, "post_id": 43378702, "comment_id": 73820776, "body": "Okay, I apologize for my ignorance, so that means it cannot be fixed and I should look for other sources?"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1492053318, "last_edit_date": 1492053318, "creation_date": 1492027535, "answer_id": 43378702, "question_id": 43377604, "link": "https://stackoverflow.com/questions/43377604/stocks-financial-statements-from-yahoo-no-longer-transferrinf-to-excel/43378702#43378702", "title": "Stocks Financial Statements from yahoo no longer transferrinf to excel", "body": "<p>I think yahoo changed it's site recently.  Just check your URL, and get that working first.</p>\n\n<p><a href=\"http://finance.yahoo.com/quote/IBM/financials?p=IBM\" rel=\"nofollow noreferrer\">http://finance.yahoo.com/quote/IBM/financials?p=IBM</a></p>\n\n<p>When you know that is right, engineer everything else around that.</p>\n\n<p>Here is a solution that works for me.  This imports data for several tickers, listed in a sheet, in cells A2, down to the end of the array.</p>\n\n<pre><code>Sub Dow_HistoricalData()\n\n    Dim xmlHttp As Object\n    Dim TR_col As Object, TR As Object\n    Dim TD_col As Object, TD As Object\n    Dim row As Long, col As Long\n\n    ThisSheet = ActiveSheet.Name\n    Range(\"A2\").Select\n    Do Until ActiveCell.Value = \"\"\n    Symbol = ActiveCell.Value\n    Sheets(ThisSheet).Select\n    Sheets.Add\n\n    Set xmlHttp = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n    ' http://finance.yahoo.com/quote/\" &amp; Symbol &amp; \"/financials?ltr=1\n    xmlHttp.Open \"GET\", \"http://finance.yahoo.com/quote/\" &amp; Symbol &amp; \"/financials?ltr=1\", False\n    xmlHttp.setRequestHeader \"Content-Type\", \"text/xml\"\n    xmlHttp.send\n\n    Dim html As Object\n    Set html = CreateObject(\"htmlfile\")\n    html.body.innerHTML = xmlHttp.ResponseText\n\n    Dim tbl As Object\n    Set tbl = html.getElementById(\"Lh(1.7) W(100%) M(0)\")\n    '\n\n    row = 1\n    col = 1\n\n    Set TR_col = html.getelementsbytagname(\"TR\")\n    For Each TR In TR_col\n        Set TD_col = TR.getelementsbytagname(\"TD\")\n        For Each TD In TD_col\n            Cells(row, col) = TD.innerText\n            col = col + 1\n        Next\n        col = 1\n        row = row + 1\n    Next\n\nSheets(ActiveSheet.Name).Name = Symbol\nSheets(ThisSheet).Select\nActiveCell.Offset(1, 0).Select\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Here is a screen shot of my setup.</p>\n\n<p><a href=\"https://i.stack.imgur.com/excjo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/excjo.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 7858332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313caf29667687432a82356fb280b919?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/7858332/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 674, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1492053318, "creation_date": 1492023615, "question_id": 43377604, "link": "https://stackoverflow.com/questions/43377604/stocks-financial-statements-from-yahoo-no-longer-transferrinf-to-excel", "title": "Stocks Financial Statements from yahoo no longer transferrinf to excel", "body": "<ol>\n<li><p>I have a VBA code which transfers stocks Financial Statements (Income Statement, Balance Sheet, Cash Flows) from yahoo finance to excel, I have used it for a while now, but it seems yahoo has changed the links or something. Could someone help me re-link the links so that coding transfers the pulled information from yahoo to excel once again? Below is the coding</p>\n\n<p>Sub FinancialStatements()\n    Dim ticker As String\n    Dim urlend As String</p>\n\n<pre><code>Application.ScreenUpdating = False\n\n\nticker = Sheets(\"inputs\").Cells(2, 1)\nIf Sheets(\"Inputs\").Shapes(\"Check Box 14\").ControlFormat.Value = 1 Then\n    urlend = \"&amp;annual\"\nElse: urlend = \"\"\n\nEnd If\n\n\n\nSheets(\"Income Statement\").Select\nCells.Clear\n\nIf Sheets(\"Inputs\").Shapes(\"Check Box 11\").ControlFormat.Value = 1 Then\n\n'\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;http://finance.yahoo.com/q/is?s=\" &amp; ticker &amp; \"\" &amp; urlend &amp; \"\", Destination:=Range(\"$A$1\") _\n)\n.Name = \"is?s=MSFT&amp;annual\"\n.FieldNames = True\n.RowNumbers = False\n.FillAdjacentFormulas = False\n.PreserveFormatting = True\n.RefreshOnFileOpen = False\n.BackgroundQuery = True\n.RefreshStyle = xlInsertDeleteCells\n.SavePassword = False\n.SaveData = True\n.AdjustColumnWidth = True\n.RefreshPeriod = 0\n.WebSelectionType = xlSpecifiedTables\n.WebFormatting = xlWebFormattingNone\n.WebTables = \"9\"\n.WebPreFormattedTextToColumns = True\n.WebConsecutiveDelimitersAsOne = True\n.WebSingleBlockTextImport = False\n.WebDisableDateRecognition = False\n.WebDisableRedirections = False\n.Refresh BackgroundQuery:=False\n  End With\n\n      End If\n\n\n    Sheets(\"Balance Sheet\").Select\nCells.Clear\n\nIf Sheets(\"Inputs\").Shapes(\"Check Box 12\").ControlFormat.Value = 1 Then\n\n'\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;http://finance.yahoo.com/q/bs?s=\" &amp; ticker &amp; \"\" &amp; urlend &amp; \"\", Destination:=Range(\"$A$1\") _\n)\n.Name = \"is?s=MSFT&amp;annual\"\n.FieldNames = True\n.RowNumbers = False\n.FillAdjacentFormulas = False\n.PreserveFormatting = True\n.RefreshOnFileOpen = False\n.BackgroundQuery = True\n.RefreshStyle = xlInsertDeleteCells\n.SavePassword = False\n.SaveData = True\n.AdjustColumnWidth = True\n.RefreshPeriod = 0\n.WebSelectionType = xlSpecifiedTables\n.WebFormatting = xlWebFormattingNone\n.WebTables = \"9\"\n.WebPreFormattedTextToColumns = True\n.WebConsecutiveDelimitersAsOne = True\n.WebSingleBlockTextImport = False\n.WebDisableDateRecognition = False\n.WebDisableRedirections = False\n.Refresh BackgroundQuery:=False\n    End With\n       End If\n\nSheets(\"Cash Flows\").Select\nCells.Clear\nIf Sheets(\"Inputs\").Shapes(\"Check Box 13\").ControlFormat.Value = 1 Then\n\n'\n     With ActiveSheet.QueryTables.Add(Connection:= _\n\"URL;http://finance.yahoo.com/q/cf?s=\" &amp; ticker &amp; \"\" &amp; urlend &amp; \"\", Destination:=Range(\"$A$1\") _\n)\n.Name = \"is?s=MSFT&amp;annual\"\n.FieldNames = True\n.RowNumbers = False\n.FillAdjacentFormulas = False\n.PreserveFormatting = True\n.RefreshOnFileOpen = False\n.BackgroundQuery = True\n.RefreshStyle = xlInsertDeleteCells\n.SavePassword = False\n.SaveData = True\n.AdjustColumnWidth = True\n.RefreshPeriod = 0\n.WebSelectionType = xlSpecifiedTables\n.WebFormatting = xlWebFormattingNone\n.WebTables = \"9\"\n.WebPreFormattedTextToColumns = True\n.WebConsecutiveDelimitersAsOne = True\n.WebSingleBlockTextImport = False\n.WebDisableDateRecognition = False\n.WebDisableRedirections = False\n.Refresh BackgroundQuery:=False\n    End With\nEnd If\n\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre></li>\n</ol>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1236, "user_id": 3283247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7003a5c0cd48173d94e7f5da1e360932?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/3283247/alexey"}, "edited": false, "score": 1, "creation_date": 1492023954, "post_id": 43377542, "comment_id": 73817396, "body": "Compilation fails because there is obviously no label SetFirst. Where is the execution supposed to go when the error is raised in the line between <code>On Error GoTo SetFirst</code> and <code>On Error GoTo 0</code>?"}, {"owner": {"reputation": 27, "user_id": 7845699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64bc3a17d7236cdec98c9efaed2f0e1?s=128&d=identicon&r=PG&f=1", "display_name": "S Rock", "link": "https://stackoverflow.com/users/7845699/s-rock"}, "reply_to_user": {"reputation": 1236, "user_id": 3283247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7003a5c0cd48173d94e7f5da1e360932?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/3283247/alexey"}, "edited": false, "score": 0, "creation_date": 1492024452, "post_id": 43377542, "comment_id": 73817686, "body": "Im not sure, I am brand new to this. Do you have a suggestion?"}, {"owner": {"reputation": 1236, "user_id": 3283247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7003a5c0cd48173d94e7f5da1e360932?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/3283247/alexey"}, "edited": false, "score": 0, "creation_date": 1492024732, "post_id": 43377542, "comment_id": 73817852, "body": "I will probably be able to suggest if you could explain what exactly your code should do. What&#39;s the purpose of all this subroutine? Also, your code is not complete, it starts with <code>Dim ...</code> however should start with <code>Sub ...</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1236, "user_id": 3283247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7003a5c0cd48173d94e7f5da1e360932?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/3283247/alexey"}, "edited": false, "score": 0, "creation_date": 1492024915, "post_id": 43377542, "comment_id": 73817950, "body": "@Alexey ha, good eye! The indentation threw me off, my brain subconsciously replaced <code>Dim</code> with <code>Sub</code> and ignored the rest of the line!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492053662, "post_id": 43377542, "comment_id": 73827821, "body": "@S Rock It&#39;s OK using the code from the answer I gave you here <a href=\"http://stackoverflow.com/questions/43351143/change-code-so-that-it-doesnt-populate-more-cells-just-replaces-with-changes\" title=\"change code so that it doesnt populate more cells just replaces with changes\">stackoverflow.com/questions/43351143/&hellip;</a> , but using it here and <b>Not</b> marking as &quot;Answer&quot; - not so much"}, {"owner": {"reputation": 27, "user_id": 7845699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64bc3a17d7236cdec98c9efaed2f0e1?s=128&d=identicon&r=PG&f=1", "display_name": "S Rock", "link": "https://stackoverflow.com/users/7845699/s-rock"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492089840, "post_id": 43377542, "comment_id": 73848030, "body": "@shairado I wouldnt have asked another question if it worked. I have 0 knowledge of macros and any help is appreciated."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1506018638, "last_edit_date": 1506018638, "creation_date": 1492024601, "answer_id": 43377880, "question_id": 43377542, "link": "https://stackoverflow.com/questions/43377542/compile-error-label-not-defined/43377880#43377880", "title": "Compile error: label not defined", "body": "<blockquote>\n<pre><code>On Error GoTo SetFirst\n</code></pre>\n</blockquote>\n\n<p>This instruction tells the VBA runtime, in case of an error, to jump straight to the <code>SetFirst</code> subroutine to handle the error.</p>\n\n<p>When you compile the code, VBA sees that there's a conditional jump to that <code>SetFirst</code> label, but there's no such label to jump to, so VBA can't resolve <code>SetFirst</code> and compilation fails.</p>\n\n<p>Not sure what your intent is, but things would typically look something like this:</p>\n\n<pre><code>    Exit Sub\n\nSetFirst: '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; that's your line label\n    Debug.Print \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n    Err.Clear\n    'comment-out or remove before distributing:\n    Stop\n    Resume 'step through (F8) here to jump back to error-causing instruction\nEnd Sub\n</code></pre>\n\n<p>Line labels / subroutines are locally scoped, meaning you can't <code>GoTo</code>-jump to a line label that's located in another procedure. If you have <code>SetFirst</code> in another procedure and intend to jump there in case of an error, you have some serious spaghettification in process.</p>\n"}], "owner": {"reputation": 27, "user_id": 7845699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64bc3a17d7236cdec98c9efaed2f0e1?s=128&d=identicon&r=PG&f=1", "display_name": "S Rock", "link": "https://stackoverflow.com/users/7845699/s-rock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "accepted_answer_id": 43377880, "answer_count": 1, "score": 1, "last_activity_date": 1506018638, "creation_date": 1492023424, "last_edit_date": 1492024636, "question_id": 43377542, "link": "https://stackoverflow.com/questions/43377542/compile-error-label-not-defined", "title": "Compile error: label not defined", "body": "<p>I have a code that looks for something from the master sheet in column D such as \"1x Daily\" or \"2x Month\" (as well as others). If the cell matches a Sheet name, it gets pasted into that sheet. The problem is each row from the Master sheet is unique and therefore cannot be repeated on each sheet. Every time I run the code, it adds the rows again, so I end up with something like this</p>\n\n<p>Coubourn, Stephen|A|201|Q4hours\nEudy, Donna      |A|202|Q4hours\nPotts, Betty     |A|203|Q4hours\nCoubourn, Stephen|A|201|Q4hours\nEudy, Donna      |A|202|Q4hours\nPotts, Betty     |A|203|Q4hours\nCoubourn, Stephen|A|201|Q4hours\nEudy, Donna      |A|202|Q4hours\nPotts, Betty     |A|203|Q4hours</p>\n\n<p>Below is what I have so far for this code I am trying to make, however, it isnt working. Im receiving the error message \"Compile error, label not defined\" on the line that says \"On Error GoTo SetFirst\"</p>\n\n<pre><code>Dim cell As Range\n    Dim cmt As Comment\n    Dim bolFound As Boolean\n    Dim sheetNames() As String\n    Dim lngItem As Long, lngLastRow As Long\n    Dim sht As Worksheet, shtMaster As Worksheet\n    Dim MatchRow As Variant\n\n    Set shtMaster = ThisWorkbook.Worksheets(\"Master Vitals Data\")\n\n    ReDim sheetNames(0)\n    For Each sht In ThisWorkbook.Worksheets\n        If sht.Name &lt;&gt; shtMaster.Name Then\n            sheetNames(UBound(sheetNames)) = sht.Name\n            ReDim Preserve sheetNames(UBound(sheetNames) + 1)\n        End If\n    Next sht\n    ReDim Preserve sheetNames(UBound(sheetNames) - 1)\n\n    For Each cell In shtMaster.Range(\"D1:D\" &amp; shtMaster.Cells(shtMaster.Rows.Count, \"D\").End(xlUp).Row)\n    bolFound = False\n        MatchRow = Application.Match(cell.Offset(, -3).Value, sht.Range(\"A:A\"), 0)\n        If Not IsError(MatchRow) Then\n            shtMaster.Rows(cell.Row).EntireRow.Copy Destination:=sht.Cells(MatchRow, 1)\n        Else \n            On Error GoTo SetFirst\n            lngLastRow = sht.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\n            On Error GoTo 0\n            shtMaster.Rows(cell.Row).EntireRow.Copy Destination:=sht.Cells(lngLastRow, 1)\n        End If\n\n        If bolFound = False Then\n            For Each cmt In shtMaster.Comments\n                If cmt.Parent.Address = cell.Address Then cmt.Delete\n            Next cmt\n            cell.AddComment \"no sheet found for this row\"\n            ActiveSheet.EnableCalculation = False\n    ActiveSheet.EnableCalculation = True\n        End If\n\n    Set sht = Nothing\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "function", "checkbox", "subroutine"], "answers": [{"tags": [], "owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "is_accepted": false, "score": 0, "last_activity_date": 1492023962, "creation_date": 1492023962, "answer_id": 43377711, "question_id": 43377369, "link": "https://stackoverflow.com/questions/43377369/writing-a-string-instead-of-true-false-for-a-checkbox-in-vba/43377711#43377711", "title": "Writing a string instead of true/false for a checkbox in VBA?", "body": "<p>Something like this:</p>\n\n<pre><code> Worksheets(\"AppropriateWorksheetName\").Range(\"D11\").Value = \"No Roll-Out Service\"\n</code></pre>\n\n<blockquote>\n  <p>I'm pretty new to VBA so I'm not sure if I'm using the correct command window or if I need to write a function and then call it in the sub?</p>\n</blockquote>\n\n<p>The command window writes a function; they both do the same thing, it's just that the command window is easier to use but has more limited functionality. If you are just learning, the command window is fine</p>\n"}], "owner": {"reputation": 11, "user_id": 7858315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad71e5b9b6e9f4c885a604e346c44805?s=128&d=identicon&r=PG&f=1", "display_name": "peterf1510", "link": "https://stackoverflow.com/users/7858315/peterf1510"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492023962, "creation_date": 1492022829, "last_edit_date": 1492022908, "question_id": 43377369, "link": "https://stackoverflow.com/questions/43377369/writing-a-string-instead-of-true-false-for-a-checkbox-in-vba", "title": "Writing a string instead of true/false for a checkbox in VBA?", "body": "<p>I have been trying to output a string when a checkbox is clicked in excel. The checkboxes are currently linked to a separate page in the work book. The code I am writing so far is:</p>\n\n<pre><code>Private Sub Rollout()\n\nIf Rollout.Value = True Then\nRange(D11, [D11]).Value = \"Roll-Out\"\nElse\nRange(D11, [D11]).Value = \"No Roll-Out Service\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Rollout() is the Macro assigned to the checkbox. The cell on the page that I want the string to output is D11. </p>\n\n<p>I'm pretty new to VBA so I'm not sure if I'm using the correct command window or if I need to write a function and then call it in the sub?</p>\n\n<p>Any help would be great, Thanks!</p>\n"}, {"tags": ["excel", "worksheet-function", "worksheet", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1492025032, "post_id": 43377209, "comment_id": 73818018, "body": "Doing everything in memory with arrays would be faster than making every change directly on the sheet. Also, note that each <code>Change</code> on the sheet triggers another <code>change event</code>. So, the sub you have coded is calling itself over and over again (recursively). You should turn off events while you make these changes on the sheet. Another point: where is the dictionary <code>oData</code> being populated? Please include this portion into the above code snippet."}], "answers": [{"tags": [], "owner": {"reputation": 64, "user_id": 7787506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9eJ9l.jpg?s=128&g=1", "display_name": "Khang Huynh", "link": "https://stackoverflow.com/users/7787506/khang-huynh"}, "is_accepted": true, "score": 1, "last_activity_date": 1492023792, "creation_date": 1492023792, "answer_id": 43377656, "question_id": 43377209, "link": "https://stackoverflow.com/questions/43377209/need-to-calculate-data-faster/43377656#43377656", "title": "Need to calculate data faster", "body": "<p>Have you tried turning off Screen Updating? Add this line right under your Sub line and see if that helps with the speed at all.</p>\n\n<pre><code>Application.ScreenUpdating = False\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7693831, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a524470b24e971dc6702492ceae3c0e3?s=128&d=identicon&r=PG&f=1", "display_name": "YaZ", "link": "https://stackoverflow.com/users/7693831/yaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 43377656, "answer_count": 1, "score": 0, "last_activity_date": 1492023792, "creation_date": 1492022340, "last_edit_date": 1531161705, "question_id": 43377209, "link": "https://stackoverflow.com/questions/43377209/need-to-calculate-data-faster", "title": "Need to calculate data faster", "body": "<p>I am struggling with this code please help me. I want to record change in sheet this code does that but it goes cell by cell which makes it slower. my active sheet runs on 200ms which is very fast by the time this code does its job values changed. is there any way that display values at the same time not by going to each cell. i have so much confusion in my mind please pardon me if my request did not even made any sense.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nConst Scope = \"G9:H9,G11:H11,G13:H13,G15:H15,G17:H17,G19:H19,G21:H21,G23:H23,G25:H25,G27:H27,G29:H29,G31:H31,G33:H33,G35:H35,G37:H37,G39:H39,G41:H41,G43:H43,G45:H45,G47:H47,G49:H49,G51:H151,G53:H53,G55:H55,G57:H57,G59:H59,G61:H61,G63:H63,G65:H65,G67:H67\" ' monitoring area\n\nStatic oData As New Dictionary\nDim rCells As Range\nDim oCell\nDim dDelta\n\nSet rCells = Application.Intersect(Target, Target.Parent.Range(Scope))\nIf Not rCells Is Nothing Then\n    For Each oCell In rCells\n        With oCell\n            dDelta = oData(.Address)\n           .Offset(0, 1).Value = dDelta\n            oData(.Address) = .Value\n        End With\n    Next\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1492022551, "post_id": 43377177, "comment_id": 73816642, "body": "How haven&#39;t those threads helped? What have you tried specifically? It sounds like some use of <code>Match</code> or a <code>Find</code> should work. Please post any code you&#39;ve tried, and any errors it&#39;s throwing, or if it&#39;s not working, explain <i>how</i> it&#39;s not working."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 3, "creation_date": 1492025970, "post_id": 43377177, "comment_id": 73818499, "body": "Does this really need VBA?  This sounds like an issue that the <a href=\"https://support.office.com/en-us/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1\" rel=\"nofollow noreferrer\">VLOOKUP function</a> can solve..."}, {"owner": {"reputation": 51, "user_id": 7858191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1fda4b7bf323b3b144a086c2e79f05?s=128&d=identicon&r=PG&f=1", "display_name": "Thea", "link": "https://stackoverflow.com/users/7858191/thea"}, "edited": false, "score": 0, "creation_date": 1492038652, "post_id": 43377177, "comment_id": 73824152, "body": "To clarify, I tried VLOOKUP but I need to return the cell address, not its value, so I didn&#39;t think it would be helpful. The action once I have the address is to go 2 columns to the left and copy that cell&#39;s content (an image embedded in a comment in the cell), then paste that content into another sheet. So I think it&#39;s more complicated than VLOOKUP can handle. Thanks for your thoughts."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492039266, "post_id": 43377612, "comment_id": 73824331, "body": "but why? the built in functions like Match, Vlookup, or the range.Find method are well suited for this sort of task -- there&#39;s no need to reinvent the wheel \ud83d\ude03"}], "tags": [], "owner": {"reputation": 101, "user_id": 7798223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56caec1d3c39ec58e886d25bb05d6235?s=128&d=identicon&r=PG&f=1", "display_name": "Joe W", "link": "https://stackoverflow.com/users/7798223/joe-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1492023647, "creation_date": 1492023647, "answer_id": 43377612, "question_id": 43377177, "link": "https://stackoverflow.com/questions/43377177/how-to-find-and-use-the-row-number-of-a-specific-value-using-an-excel-macro/43377612#43377612", "title": "How to find and use the row number of a specific value using an Excel macro", "body": "<p>You could try to use a loop to accomplish this. Depending on your data this should work. You did not provide much detail into the action to perform in column A or how your variable is declared so this is a start.</p>\n\n<pre><code> Sub Macro1()\n' This macro will loop through each row and look for your variable in column C if it finds your variable in column C it will then perform your action in column A of that same row.\n\nDim variable As String\nvariable = \"insert value or cell here\"\n\nWith Sheets(\"Sheet1\")\n    LR = .Cells(Rows.Count, \"C\").End(xlUp).Row\n    For i = LR To 2 Step -1\n        If .Cells(i, \"C\").Value = variable Then\n            .Cells(i, \"A\").Value = \"perform action here\"\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492028494, "post_id": 43378850, "comment_id": 73820018, "body": "<i>The problem I&#39;m continuing to have is the global/public variables not working between sheets</i> &lt; -- you need to scope your variables appropriately. <code>Public</code> declarations in a UserForm, Worksheet, or Class module are not the same as <code>Public</code> declarations in an ordinary code module. :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492028539, "post_id": 43378850, "comment_id": 73820047, "body": "This might help: <a href=\"http://stackoverflow.com/questions/16374253/how-to-make-excel-vba-variables-available-to-multiple-macros/16374516#16374516\" title=\"how to make excel vba variables available to multiple macros\">stackoverflow.com/questions/16374253/&hellip;</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492028663, "post_id": 43378850, "comment_id": 73820108, "body": "You can also store values in a <code>Name</code> that is accessible from any code module, or from the worksheet itself."}, {"owner": {"reputation": 51, "user_id": 7858191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1fda4b7bf323b3b144a086c2e79f05?s=128&d=identicon&r=PG&f=1", "display_name": "Thea", "link": "https://stackoverflow.com/users/7858191/thea"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492037329, "post_id": 43378850, "comment_id": 73823799, "body": "Excellent! Thank you so much."}], "tags": [], "owner": {"reputation": 51, "user_id": 7858191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1fda4b7bf323b3b144a086c2e79f05?s=128&d=identicon&r=PG&f=1", "display_name": "Thea", "link": "https://stackoverflow.com/users/7858191/thea"}, "is_accepted": false, "score": 0, "last_activity_date": 1492028112, "creation_date": 1492028112, "answer_id": 43378850, "question_id": 43377177, "link": "https://stackoverflow.com/questions/43377177/how-to-find-and-use-the-row-number-of-a-specific-value-using-an-excel-macro/43378850#43378850", "title": "How to find and use the row number of a specific value using an Excel macro", "body": "<p>UPDATE: My problem was with using variables correctly, and a solution appears to be:</p>\n\n<pre><code>Public Const SKUVALUE As String = \"$B$1\"\nPublic imageValue As Long\nPublic n As Long\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>Sub FindFirstInstance()\nDim ws As Excel.Worksheet\nDim FoundCell As Excel.Range\nDim imageValue As Long: imageValue = Range(SKUVALUE).Value\nSet ws = ActiveSheet\nSet FoundCell = ws.Range(\"C:C\").Find(what:=imageValue, lookat:=xlWhole)\nIf Not FoundCell Is Nothing Then\n    MsgBox (imageValue &amp; \" found in row: \" &amp; FoundCell.Row)\nn = FoundCell.Row\nMsgBox \"n is \" &amp; n\nRange(\"$C$1\").Value = n\nElse\nMsgBox (imageValue &amp; \" not found\")\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The problem I'm continuing to have is the global/public variables not working between sheets. That's why I'm putting the value of n into C1 above, so I can grab it later. But I will keep working on that. For the moment, I think I have what I need. Many thanks.</p>\n"}], "owner": {"reputation": 51, "user_id": 7858191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec1fda4b7bf323b3b144a086c2e79f05?s=128&d=identicon&r=PG&f=1", "display_name": "Thea", "link": "https://stackoverflow.com/users/7858191/thea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2597, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492028112, "creation_date": 1492022238, "last_edit_date": 1531161705, "question_id": 43377177, "link": "https://stackoverflow.com/questions/43377177/how-to-find-and-use-the-row-number-of-a-specific-value-using-an-excel-macro", "title": "How to find and use the row number of a specific value using an Excel macro", "body": "<p>I know this question has been addressed in several places here, but none so far are solving my problem, and I can't think of anything else to search for.</p>\n\n<p>Specifically, within an Excel macro I need to find the row number of the cell on a specific sheet that has a value that matches a variable. Then I need to use that row number to perform an action on another cell in that row. The value I'm looking for will be in Column C, then the action will be performed in Column A.</p>\n\n<p>I have tried these solutions but no luck yet:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10389920/how-to-find-the-row-number-of-a-specific-value-in-excel-using-vbscript\">How to find the row number of a specific value in Excel using vbscript</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/23951214/assigning-the-value-of-a-worksheet-cell-to-a-constant\">Assigning the value of a worksheet cell to a constant</a></p>\n\n<p>I've tried pasting my variable value into B1 as a placeholder, but I can't find a way to find the matching value elsewhere on the sheet (there will be only one other). I've tried:</p>\n\n<pre><code>Public Const SKUVALUE As String = \"$B$1\"\n</code></pre>\n\n<p>but of course that returns the quoted string, not the value of the B1 cell.</p>\n\n<p>If it would help for me to explain the bigger picture of my project I will be happy to do that, but it's somewhat complicated. In short I am trying to bring content from one sheet to another sheet based on a numeric value (SKU) that is assigned to a specific row on each sheet. The row numbers will not match because of filters being applied on the first sheet. If I can mirror those filters on the second sheet then I would know the row number, but that sounds like a nightmare to implement. I can't begin to think how to do it.</p>\n\n<p>I'm really at my wit's end with this. Any suggestions will be much appreciated.\nThank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492022119, "post_id": 43377016, "comment_id": 73816374, "body": "what is the value of <code>LastRow</code> ? <code>LastRow</code> should also be <code>LastRow = wsData.Cells(wsData.Rows.Count, 1).End(xlUp).Row</code>"}, {"owner": {"reputation": 15, "user_id": 7858254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60529c0611a523931d9d66ee4d89101?s=128&d=identicon&r=PG&f=1", "display_name": "Xuan Zhou", "link": "https://stackoverflow.com/users/7858254/xuan-zhou"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492022268, "post_id": 43377016, "comment_id": 73816450, "body": "I fixed this part and this was not the problem, the &quot;set PT_Cache&quot; still got the error...."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492053137, "post_id": 43377016, "comment_id": 73827672, "body": "have you read my answer and tested the code below ?"}, {"owner": {"reputation": 15, "user_id": 7858254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60529c0611a523931d9d66ee4d89101?s=128&d=identicon&r=PG&f=1", "display_name": "Xuan Zhou", "link": "https://stackoverflow.com/users/7858254/xuan-zhou"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492103428, "post_id": 43377016, "comment_id": 73856945, "body": "@ShaiRado Yes! I just tried! It works! But I&#39;m keep running into problems as I adding more code, I&#39;m able to create a empty pivot table with your code, after I added some values field, it tells me that I have error with the previous code...."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492103569, "post_id": 43377016, "comment_id": 73857016, "body": "Then you should open a new post, with your modified code, and describe what you are trying to achieve."}, {"owner": {"reputation": 15, "user_id": 7858254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60529c0611a523931d9d66ee4d89101?s=128&d=identicon&r=PG&f=1", "display_name": "Xuan Zhou", "link": "https://stackoverflow.com/users/7858254/xuan-zhou"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492104167, "post_id": 43377016, "comment_id": 73857316, "body": "@ShaiRado I just did. Thank you very much for you help! I really appreciated!"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1492022923, "creation_date": 1492022923, "answer_id": 43377399, "question_id": 43377016, "link": "https://stackoverflow.com/questions/43377016/creating-a-pivot-table-using-vba-error/43377399#43377399", "title": "Creating a Pivot Table using VBA error", "body": "<p>Try the code below, I've added 2 options to set the <code>PivotCache</code>, try one and comment the other (or vise versa), see which one works for you (both worked when I tested it with my dummy data)</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub Create_Pivot_Table()\n\nDim wsData As Worksheet, wsPT As Worksheet\nDim PT_Cache    As PivotCache\nDim PT          As PivotTable\nDim PRng        As Range\nDim LastRow     As Long\n\nWith ThisWorkbook\n    Set wsData = .Worksheets(\"Data\")\n    Set wsPT = .Worksheets(\"Pivot Table\")\nEnd With\n\nLastRow = wsData.Cells(wsData.Rows.Count, 1).End(xlUp).Row\nMsgBox LastRow ' &lt;-- confirm value\n\nSet PRng = wsData.Range(\"A1:O\" &amp; LastRow)\n\n' option 1: Set the Pivot Cache\nSet PT_Cache = ThisWorkbook.PivotCaches.Create(xlDatabase, PRng)\n\n' option 2: Set the Pivot Cache\nSet PT_Cache = ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRng.Address(True, True, xlR1C1, True))\n\n' set the Pivot Table\nSet PT = wsPT.PivotTables.Add(PivotCache:=PT_Cache, TableDestination:=wsPT.Range(\"D5\"), TableName:=\"Pivot_Table_Test\")\n\nSet PT = Nothing\nSet PT_Cache = Nothing\nSet wsData = Nothing\nSet wsPT = Nothing\nExit Sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7858254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60529c0611a523931d9d66ee4d89101?s=128&d=identicon&r=PG&f=1", "display_name": "Xuan Zhou", "link": "https://stackoverflow.com/users/7858254/xuan-zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 43377399, "answer_count": 1, "score": 1, "last_activity_date": 1492022923, "creation_date": 1492021635, "last_edit_date": 1492022683, "question_id": 43377016, "link": "https://stackoverflow.com/questions/43377016/creating-a-pivot-table-using-vba-error", "title": "Creating a Pivot Table using VBA error", "body": "<p>I have this code below, but the <code>Set PT_Cache</code> line is raising a <em>Type mismatch</em> error.</p>\n\n<p>Anyone knows why?</p>\n\n<pre><code>Sub Create_Pivot_Table()\nDim wsData As Worksheet, wsPT As Worksheet\nDim PT_Cache As PivotCache\nDim PT As PivotTable\nDim LastRow As Long\n\nWith ThisWorkbook\nSet wsData = .Worksheets(\"Data\")\nSet wsPT = .Worksheets(\"Pivot Table\")\nEnd With\n\nLastRow = wsData.Cells(Rows.Count, 1).End(xlUp).Row\n\nSet PT_Cache = ThisWorkbook.PivotCaches.Create(xlDatabase, wsData.Range(\"A1:O\" &amp; LastRow))\n\nSet PT = PT_Cache.CreatePivotTable(wsPT.Range(\"D5\"), \"Pivot_Table_Test\")\n\nSet PT = Nothing\nSet PT_Cache = Nothing\nSet wsData = Nothing\nSet wsPT = Nothing\nExit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1330, "user_id": 4554876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0oszf.png?s=128&g=1", "display_name": "jradich1234", "link": "https://stackoverflow.com/users/4554876/jradich1234"}, "edited": false, "score": 0, "creation_date": 1492021628, "post_id": 43376895, "comment_id": 73816114, "body": "Why do you need a mask?  Couldn&#39;t you just do a sub string if &lt;= 5 or a &quot;left(5)&quot;?"}, {"owner": {"reputation": 3, "user_id": 6363205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf23d425f5b2a9b296e7f6c6cb8eac6?s=128&d=identicon&r=PG", "display_name": "ERandallN", "link": "https://stackoverflow.com/users/6363205/erandalln"}, "reply_to_user": {"reputation": 1330, "user_id": 4554876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0oszf.png?s=128&g=1", "display_name": "jradich1234", "link": "https://stackoverflow.com/users/4554876/jradich1234"}, "edited": false, "score": 0, "creation_date": 1492092783, "post_id": 43376895, "comment_id": 73850198, "body": "Would that avoid the hyphen in display strings of 5, but include it in strings of 9? I want to avoid storing the hard-coded characters (&#39;-&#39;, in zip codes; &#39;(&#39;,&#39;)&#39; and &#39;x&#39;, in phone numbers).  If I write the entire procedure in VB, will I invite security issues?"}, {"owner": {"reputation": 1330, "user_id": 4554876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0oszf.png?s=128&g=1", "display_name": "jradich1234", "link": "https://stackoverflow.com/users/4554876/jradich1234"}, "edited": false, "score": 0, "creation_date": 1492094850, "post_id": 43376895, "comment_id": 73851767, "body": "You wouldn&#39;t get any special characters unless they exist in the first 5 characters.  If these are all valid US based zip codes only and you haven&#39;t suppressed leading zeros it shouldn&#39;t be an issue."}, {"owner": {"reputation": 3, "user_id": 6363205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf23d425f5b2a9b296e7f6c6cb8eac6?s=128&d=identicon&r=PG", "display_name": "ERandallN", "link": "https://stackoverflow.com/users/6363205/erandalln"}, "reply_to_user": {"reputation": 1330, "user_id": 4554876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0oszf.png?s=128&g=1", "display_name": "jradich1234", "link": "https://stackoverflow.com/users/4554876/jradich1234"}, "edited": false, "score": 0, "creation_date": 1492104872, "post_id": 43376895, "comment_id": 73857671, "body": "The user would have to input the hyphen in a zip+4 entry?"}, {"owner": {"reputation": 1330, "user_id": 4554876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0oszf.png?s=128&g=1", "display_name": "jradich1234", "link": "https://stackoverflow.com/users/4554876/jradich1234"}, "edited": false, "score": 0, "creation_date": 1492108171, "post_id": 43376895, "comment_id": 73859295, "body": "In a properly formatted US zip+4 wouldn&#39;t the hyphen be the sixth character...."}, {"owner": {"reputation": 3, "user_id": 6363205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf23d425f5b2a9b296e7f6c6cb8eac6?s=128&d=identicon&r=PG", "display_name": "ERandallN", "link": "https://stackoverflow.com/users/6363205/erandalln"}, "reply_to_user": {"reputation": 1330, "user_id": 4554876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0oszf.png?s=128&g=1", "display_name": "jradich1234", "link": "https://stackoverflow.com/users/4554876/jradich1234"}, "edited": false, "score": 0, "creation_date": 1492109384, "post_id": 43376895, "comment_id": 73860016, "body": "Yes, which means that if the user chose to enter a properly fomatted zip+4, he/she would(?) have to enter the hyphen.  I&#39;m trying to avoid that and use the resulting technique in the phone number field relative to optional area code and extension data. The optionality is a customer (in this case textbook) requirement, the final display characteristics are my desire to increase the professional looks of the final product."}], "owner": {"reputation": 3, "user_id": 6363205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cf23d425f5b2a9b296e7f6c6cb8eac6?s=128&d=identicon&r=PG", "display_name": "ERandallN", "link": "https://stackoverflow.com/users/6363205/erandalln"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593956318, "creation_date": 1492021257, "last_edit_date": 1593956318, "question_id": 43376895, "link": "https://stackoverflow.com/questions/43376895/input-mask-to-make-optional-zip4-display-hyphen-optional", "title": "Input mask to make optional zip+4 display hyphen optional", "body": "<p>Purpose:</p>\n\n<p>To make the hyphen in the zip+4 not display if +4 data isn't present (I also want to apply the same logic to an optional area code and extension in my phone number field).</p>\n\n<p>I have the following VBA for my input mask (I've tried GetFocus(), BeforeUpdate(), AfterUpdate() and LostFocus() for my events):</p>\n\n<pre><code>Private Sub Zip_LostFocus()\n    'Display hyphen (-) only if using \"Plus-4\" zip code\n    If Len([Zip]) &lt;= 5 Then\n        Me.[Zip].InputMask = \"00000;;_\"\n    End If\n    If Len([Zip]) &gt; 5 Then\n        Me.[Zip].InputMask = \"00000\\-9999;;_\"\n    Else\n    End If\nEnd Sub\n</code></pre>\n\n<p>I am having the devil of a time finding help on this.\nI appreciate anything anyone can contribute to a solution for my \"obsession.\"</p>\n\n<p>erandalln</p>\n\n<p>P.S.: Now I know why I couldn't find \"inputmask\" in my search-need a 1500 rep to create a new 'tag'; the existing one is \"input-mask\".</p>\n"}, {"tags": ["vba", "stack-overflow", "data.stackexchange.com", "stackexchange.exceptional"], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1498564965, "post_id": 44779797, "comment_id": 76539993, "body": "You will also have to give the 2 functions different names."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1498564928, "creation_date": 1498564928, "answer_id": 44779797, "question_id": 43376787, "link": "https://stackoverflow.com/questions/43376787/teleform-vba-recieving-error-remove-preceding-zeros-then-fill-blank-fields-with/44779797#44779797", "title": "Teleform VBA recieving error remove preceding zeros then fill blank fields with one zero 20170412", "body": "<p>Your function definitions are nested within a subroutine (actually 2) and that's not how it works... here, I will clean it up for you, but I did not test it to see if it does what you want, as integers do not have leading zeros.</p>\n\n<pre><code>Function RemoveLeadingZeroes(ByVal MONTH As String) As Integer\n  Dim tempmonth\n  tempmonth = MONTH\n  While Left(tempmonth, 1) = \"0\" And tempmonth &lt;&gt; \"\"\n    tempmonth = Right(tempmonth, Len(tempmonth) - 1)\n  Wend\n  RemoveLeadingZeroes = tempmonth\nEnd Function\n\nFunction RemoveLeadingZeroes(ByVal DAY As String) As Integer\n  Dim tempday\n  tempday = DAY\n  While Left(tempday, 1) = \"0\" And tempday &lt;&gt; \"\"\n    tempday = Right(tempday, Len(tempday) - 1)\n  Wend\n  RemoveLeadingZeroes = tempday\nEnd Function\n</code></pre>\n\n<p>Alternatively, you could just use the <code>val()</code> function to turn a string into an integer.</p>\n"}], "owner": {"reputation": 1, "user_id": 7857944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05435fd68f6fee2a33cf7ad71ac00d79?s=128&d=identicon&r=PG&f=1", "display_name": "thangamajog", "link": "https://stackoverflow.com/users/7857944/thangamajog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498564928, "creation_date": 1492020846, "last_edit_date": 1498563594, "question_id": 43376787, "link": "https://stackoverflow.com/questions/43376787/teleform-vba-recieving-error-remove-preceding-zeros-then-fill-blank-fields-with", "title": "Teleform VBA recieving error remove preceding zeros then fill blank fields with one zero 20170412", "body": "<p>This is my VBA in a form for a program called Teleform. My tech support is only for the program and they are unable to assist with scripting to remove preceding zeros from collected data of 2 specific fields. The fields are numeric Month and day fields that are stored as text.  </p>\n\n<p>I need another script that will put a zero in all empty or blank data fields.</p>\n\n<p>We found a script online that I have tried to accommodate to the preceding zero deletion.  It runs but I receive the error \"A runtime error occurred in the 'Form_Export' event of the 'Form_Script' project.  Unspecified error (v11.0 11038)\". </p>\n\n<p>I am way over my head and in need of ur knowledge.</p>\n\n<p>TIA for ur assistance!  and Happy Happy Easter everyone!</p>\n\n<pre><code>Private Sub Form_Evaluate()\nSub Form_Export()\n\nFunction RemoveLeadingZeroes(ByVal MONTH)  THIS PORTION SAMES IN RED TEXT, IF TRIED REMOVING BUT IT AND RECEIVE SAME ERROR MESSAGE.\n\nDim tempmonth\n\ntempmonth = MONTH\n\nWhile Left(tempmonth, 1) = \"0\" And tempmonth &lt;&gt; \"\"\n\n    tempmonth = Right(tempmonth, Len(tempmonth) - 1)\n\nWend\n\nRemoveLeadingZeroes = tempmonth\n\nEnd Sub\n\nFunction RemoveLeadingZeroes(ByVal DAY)  THIS PORTION SAMES IN RED TEXT, IF TRIED REMOVING BUT IT AND RECEIVE SAME ERROR MESSAGE.\n\nDim tempday\n\ntempday = DAY\n\nWhile Left(tempday, 1) = \"0\" And tempday &lt;&gt; \"\"\n\n    tempday = Right(tempday, Len(tempday) - 1)\n\nWend\n\nRemoveLeadingZeroes = tempday\n</code></pre>\n"}, {"tags": ["excel", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1492021282, "post_id": 43376774, "comment_id": 73815930, "body": "do a search of SO, this type of question has been answered many times."}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1492021356, "post_id": 43376774, "comment_id": 73815977, "body": "Can you send me link if you have any @ Sorceri"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1492021574, "post_id": 43376774, "comment_id": 73816084, "body": "I wont because that is me doing the search for you, the point is that you could have had an answer already if you just do a search, top of the page, search vba save sheet CSV, literally the first hit will give you an answer."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1492400631, "post_id": 43376774, "comment_id": 73946062, "body": "<a href=\"https://meta.stackexchange.com/a/5235/289619\">meta.stackexchange.com/a/5235/289619</a>"}], "answers": [{"tags": [], "owner": {"reputation": 170, "user_id": 7851883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abe8064acbf27c000ad0e2fb846ffd2c?s=128&d=identicon&r=PG&f=1", "display_name": "sadtank", "link": "https://stackoverflow.com/users/7851883/sadtank"}, "is_accepted": true, "score": 1, "last_activity_date": 1492022112, "last_edit_date": 1495535466, "creation_date": 1492022112, "answer_id": 43377146, "question_id": 43376774, "link": "https://stackoverflow.com/questions/43376774/vba-to-create-new-sheet-with-file-name-using-save-dialogue-box-and-save-as-csv-f/43377146#43377146", "title": "VBA to create new sheet with file name using save dialogue box and save as CSV format", "body": "<p>This should do the trick, edit to taste. Save the macro to a new module, then add a button Developer Tab > Insert > Button. Assign the button to this macro. </p>\n\n<pre><code>Sub SaveWorksheetsAsCsv()\n\nDim WS As Excel.Worksheet\nDim SaveToDirectory As String\n\nDim CurrentWorkbook As String\nDim CurrentFormat As Long\n\nCurrentWorkbook = ThisWorkbook.FullName\nCurrentFormat = ThisWorkbook.FileFormat\n' Store current details for the workbook\n\n'Change the path, must end with \\\nSaveToDirectory = \"C:\\Users\\username\\Documents\\test\\\"\nFor Each WS In ThisWorkbook.Worksheets\n    Sheets(WS.Name).Copy\n    ActiveWorkbook.SaveAs Filename:=SaveToDirectory &amp; ThisWorkbook.Name &amp; \"-\" &amp; WS.Name &amp; \".csv\", FileFormat:=xlCSV\n    ActiveWorkbook.Close savechanges:=False\n    ThisWorkbook.Activate\nNext\n'edit/remove the for loop to suit\nEnd Sub\n</code></pre>\n\n<p>Credit where credit is due. Adapted from this answer:\n<a href=\"https://stackoverflow.com/questions/10551353/saving-excel-worksheet-to-csv-files-with-filenameworksheet-name-using-vb\">Saving excel worksheet to CSV files with filename+worksheet name using VB</a></p>\n"}], "owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 0, "accepted_answer_id": 43377146, "answer_count": 1, "score": 0, "last_activity_date": 1492040428, "creation_date": 1492020785, "last_edit_date": 1531161705, "question_id": 43376774, "link": "https://stackoverflow.com/questions/43376774/vba-to-create-new-sheet-with-file-name-using-save-dialogue-box-and-save-as-csv-f", "title": "VBA to create new sheet with file name using save dialogue box and save as CSV format", "body": "<p>My requirement is that I am having a sheet with some data and a button which has to perform below said task.</p>\n\n<p>Task is that once button is clicked it has to ask for file name and location to be save to the new sheet in csv format and the data in the active sheet has to be copied and pasted in a new sheet and name of new sheet should be the name given for file to save in CSV format.</p>\n\n<p>Can anyone please help on this?</p>\n"}, {"tags": ["vba", "vb.net", "outlook", "office-interop"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1492021635, "post_id": 43376637, "comment_id": 73816118, "body": "Work with - .HTMLBody"}, {"owner": {"reputation": 135, "user_id": 6850609, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/66f03c802bf5ff858014290884ae2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "lolikols", "link": "https://stackoverflow.com/users/6850609/lolikols"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1492022090, "post_id": 43376637, "comment_id": 73816357, "body": "@0m3r That was it! Thanks! I&#39;d love to mark your comment as the answer, so would you be able to post that as a reply?"}, {"owner": {"reputation": 135, "user_id": 6850609, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/66f03c802bf5ff858014290884ae2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "lolikols", "link": "https://stackoverflow.com/users/6850609/lolikols"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1492023481, "post_id": 43376637, "comment_id": 73817183, "body": "Ah. Shoot. Turns out me doing .HTMLBody has messed with the formatting. I&#39;ll update original post."}, {"owner": {"reputation": 135, "user_id": 6850609, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/66f03c802bf5ff858014290884ae2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "lolikols", "link": "https://stackoverflow.com/users/6850609/lolikols"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1492024465, "post_id": 43376637, "comment_id": 73817695, "body": "Got it! Figured it out."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 6850609, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/66f03c802bf5ff858014290884ae2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "lolikols", "link": "https://stackoverflow.com/users/6850609/lolikols"}, "edited": false, "score": 0, "creation_date": 1492025351, "post_id": 43378014, "comment_id": 73818185, "body": "Yes, this is true - I&#39;ve tried it, but have been unable to add the email body after I call the display. Do you know of a way to?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 135, "user_id": 6850609, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/66f03c802bf5ff858014290884ae2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "lolikols", "link": "https://stackoverflow.com/users/6850609/lolikols"}, "edited": false, "score": 0, "creation_date": 1492026146, "post_id": 43378014, "comment_id": 73818597, "body": "You would need to merge the existing message body (with the newly added signature) and the new text. You can do that either using the Word Object Model (MailItem.GetInspector.WordEditor) or by reading the HTMLBody property and inserting your data after the body tag, then setting the HTMLBody back."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1492025100, "creation_date": 1492025100, "answer_id": 43378014, "question_id": 43376637, "link": "https://stackoverflow.com/questions/43376637/adding-the-default-signature-to-outlook-email/43378014#43378014", "title": "Adding the default signature to Outlook email", "body": "<p>There is no need to do any of that - the signature is added automatically when Display is called if you do <strong>not</strong> set the Body or HTMLBody property before that. </p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1492025110, "creation_date": 1492025110, "answer_id": 43378017, "question_id": 43376637, "link": "https://stackoverflow.com/questions/43376637/adding-the-default-signature-to-outlook-email/43378017#43378017", "title": "Adding the default signature to Outlook email", "body": "<p>Work with <strong><code>HTMLBody Property</code></strong></p>\n\n<blockquote>\n  <p><em>The property Returns or sets a String representing the HTML body of the specified item. The HTMLBody property should be an HTML syntax string. Read/write.</em></p>\n</blockquote>\n"}], "owner": {"reputation": 135, "user_id": 6850609, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/66f03c802bf5ff858014290884ae2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "lolikols", "link": "https://stackoverflow.com/users/6850609/lolikols"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1111, "favorite_count": 0, "accepted_answer_id": 43378017, "answer_count": 2, "score": 2, "last_activity_date": 1592900125, "creation_date": 1492020234, "last_edit_date": 1592900125, "question_id": 43376637, "link": "https://stackoverflow.com/questions/43376637/adding-the-default-signature-to-outlook-email", "title": "Adding the default signature to Outlook email", "body": "<p>I have an application that will fill out the To/Subject/Body of an outlook email:</p>\n\n<pre><code>Dim App As New Outlook.Application\nDim MailItem As Outlook._MailItem = DirectCast(App.CreateItem(Outlook.OlItemType.olMailItem), Outlook._MailItem)\n\n\nDim appDataDir As String = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) + \"\\Microsoft\\Signatures\"\nDim Signature As String = String.Empty\nDim diInfo As New DirectoryInfo(appDataDir)\n\nIf diInfo.Exists Then\n    Dim fiSignature As FileInfo() = diInfo.GetFiles(\"*.htm\")\n        If fiSignature.Length &gt; 0 Then\n            Dim sr As New StreamReader(fiSignature(0).FullName, Encoding.[Default])\n            Signature = sr.ReadToEnd()\n\n            If Not String.IsNullOrEmpty(Signature) Then\n                Dim fileName As String = fiSignature(0).Name.Replace(fiSignature(0).Extension, String.Empty)\n                Signature = Signature.Replace(fileName &amp; Convert.ToString(\"_files/\"), (Convert.ToString(appDataDir &amp; Convert.ToString(\"/\")) &amp; fileName) + \"_files/\")\n            End If\n        End If\nEnd If\n\nWith MailItem\n    .To = \"asdf\"\n    .Subject = \"asdf\"\n    .Body = txtTemplatePreview.Text &amp; vbNewLine\nEnd With\nMailItem.Display(True)\n</code></pre>\n\n<p>So the function of the first If Then statement is to append my default signature to the end of the email. However, when this code is run, the signature that is appended looks to be HTML code instead of the signature itself. </p>\n\n<p>In addition, I'm told that the first If Then statement will fail if the user has more than one signature. Is there a way to circumvent this?</p>\n"}, {"tags": ["vba", "onenote", "outlook-2013"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 7858092, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/04124897b794c488aa1c8198ee5ecba5?s=128&d=identicon&r=PG&f=1", "display_name": "viRg", "link": "https://stackoverflow.com/users/7858092/virg"}, "edited": false, "score": 0, "creation_date": 1492084775, "post_id": 43387534, "comment_id": 73844235, "body": "Thanks Vishaal for the quick response. I&#39;m not very proficient in any coding, although I usually end up doing what I initially set out doing, but this time, I am totally stumped.   I am not using OneDrive for Business, just the plain old Office 2013 Professional, so I&#39;ll have to use the graph and REST APIs as you suggested. Would you be able to give me an example of what you mean when you say to use the graph and REST APIs?"}], "tags": [], "owner": {"reputation": 670, "user_id": 2471176, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/87c7008d1f5c9e280e9d940473e9d057?s=128&d=identicon&r=PG", "display_name": "Vishaal Kalwani", "link": "https://stackoverflow.com/users/2471176/vishaal-kalwani"}, "is_accepted": false, "score": 1, "last_activity_date": 1492073198, "creation_date": 1492073198, "answer_id": 43387534, "question_id": 43376586, "link": "https://stackoverflow.com/questions/43376586/alternate-way-of-sending-email-from-outlook-to-onenote/43387534#43387534", "title": "Alternate way of sending email from Outlook to OneNote", "body": "<p>Are you using OneDrive for Business? If so, these Microsoft Flow templates might be very useful: <a href=\"https://ms.flow.microsoft.com/en-us/services/shared_onenote/onenote-business/\" rel=\"nofollow noreferrer\">https://ms.flow.microsoft.com/en-us/services/shared_onenote/onenote-business/</a>. In particular, one is for sending important e-mails to OneNote. You can also create your own flow that has different triggers, and specify the name of the page/section you want to create. </p>\n\n<p>Here is an example flow: \n<a href=\"https://i.stack.imgur.com/ImaNx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ImaNx.png\" alt=\"enter image description here\"></a></p>\n\n<p>Note the \"Add Dynamic Content\" button. This allows you to specify the name and content of the section.</p>\n\n<p>If you're not using O365, you might be able to use the Microsoft Graph API and the OneNote REST API together to achieve what you want. There aren't VBA examples but there are many others.</p>\n"}], "owner": {"reputation": 85, "user_id": 7858092, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/04124897b794c488aa1c8198ee5ecba5?s=128&d=identicon&r=PG&f=1", "display_name": "viRg", "link": "https://stackoverflow.com/users/7858092/virg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1757, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1492073198, "creation_date": 1492020085, "question_id": 43376586, "link": "https://stackoverflow.com/questions/43376586/alternate-way-of-sending-email-from-outlook-to-onenote", "title": "Alternate way of sending email from Outlook to OneNote", "body": "<p>I've scoured the internet to find an answer, but was unable to find an answer. Here is my problem:</p>\n\n<p>My organisation has a size limitation in Outlook 2013 inbox size. As such, we have had to come up with possible solutions to saving these emails in a comprehesive way which is easy to manage and easy to find way. </p>\n\n<p>I've heard that we could possibly automatically send our emails directly to OneNote 2013. I've used the \"send to OneNote\" button in Outlook, however I was wondering if anyone has any better solution that could automatically create a section named the email sender's name if it does not exist and copy the email to a new page. </p>\n\n<p>The only VBA code I have found in my searches is to either create a OneNote page or search, however my very limited knowledge in XML does not allow me to go further.</p>\n\n<p>Can anyone point me in the right direction?</p>\n\n<p>Here is some of the code I've found:</p>\n\n<pre><code>Option Explicit\n</code></pre>\n\n<p>Sub CreateNewPage()\n    ' Connect to OneNote 2010.\n    ' To see the results of the code,\n    ' you'll want to ensure the OneNote 2010 user\n    ' interface is visible.</p>\n\n<pre><code>Dim OneNote As OneNote.Application\nSet OneNote = New OneNote.Application\n\n' Get all of the Notebook nodes.\nDim nodes As MSXML2.IXMLDOMNodeList\nSet nodes = GetFirstOneNoteNotebookNodes(OneNote)\nIf Not nodes Is Nothing Then\n    ' Get the first OneNote Notebook in the XML document.\n    Dim node As MSXML2.IXMLDOMNode\n    Set node = nodes(2)\n    Dim noteBookName As String\n    noteBookName = node.Attributes.getNamedItem(\"name\").Text\n\n    ' Get the ID for the Notebook so the code can retrieve\n    ' the list of sections.\n    Dim notebookID As String\n    notebookID = node.Attributes.getNamedItem(\"ID\").Text\n\n    ' Load the XML for the Sections for the Notebook requested.\n    Dim sectionsXml As String\n    OneNote.GetHierarchy notebookID, hsSections, sectionsXml, xs2013\n   ' Dim a As MSXML2.DOMDocument60\n    Dim secDoc As MSXML2.DOMDocument60\n    Set secDoc = New MSXML2.DOMDocument60\n\n    If secDoc.LoadXML(sectionsXml) Then\n        ' select the Section nodes\n        Dim secNodes As MSXML2.IXMLDOMNodeList\n        Debug.Print secDoc.DocumentElement.XML\n        Dim soapNS\n        soapNS = \"xmlns:one='http://schemas.microsoft.com/office/onenote/2013/onenote'\"\n        secDoc.SetProperty \"SelectionNamespaces\", soapNS\n        Set secNodes = secDoc.DocumentElement.SelectNodes(\"//one:Section\")\n\n        If Not secNodes Is Nothing Then\n            ' Get the first section.\n            Dim secNode As MSXML2.IXMLDOMNode\n            Set secNode = secNodes(0)\n\n            Dim sectionName As String\n            sectionName = secNode.Attributes.getNamedItem(\"name\").Text\n            Dim sectionID As String\n            sectionID = secNode.Attributes.getNamedItem(\"ID\").Text\n\n            ' Create a new blank Page in the first Section\n            ' using the default format.\n            Dim newPageID As String\n            OneNote.CreateNewPage sectionID, newPageID, npsDefault\n\n            ' Get the contents of the page.\n            Dim outXML As String\n            OneNote.GetPageContent newPageID, outXML, piAll, xs2013\n\n            Dim doc As MSXML2.DOMDocument60\n            Set doc = New MSXML2.DOMDocument60\n            ' Load Page's XML into a MSXML2.DOMDocument object.\n            If doc.LoadXML(outXML) Then\n                ' Get Page Node.\n                Dim pageNode As MSXML2.IXMLDOMNode\n                soapNS = \"xmlns:one='http://schemas.microsoft.com/office/onenote/2013/onenote'\"\n                doc.SetProperty \"SelectionNamespaces\", soapNS\n                Set pageNode = doc.SelectSingleNode(\"//one:Page\")\n\n                ' Find the Title element.\n                Dim titleNode As MSXML2.IXMLDOMNode\n                Set titleNode = doc.SelectSingleNode(\"//one:Page/one:Title/one:OE/one:T\")\n\n                ' Get the CDataSection where OneNote store's the Title's text.\n                Dim cdataChild As MSXML2.IXMLDOMNode\n                Set cdataChild = titleNode.SelectSingleNode(\"text()\")\n\n                ' Change the title in the local XML copy.\n                cdataChild.Text = \"A Page Created from VBA\"\n                ' Write the update to OneNote.\n                OneNote.UpdatePageContent doc.XML\n\n                Dim newElement As MSXML2.IXMLDOMElement\n                Dim newNode As MSXML2.IXMLDOMNode\n\n                ' Create Outline node.\n                Set newElement = doc.createElement(\"one:Outline\")\n                Set newNode = pageNode.appendChild(newElement)\n                ' Create OEChildren.\n                Set newElement = doc.createElement(\"one:OEChildren\")\n                Set newNode = newNode.appendChild(newElement)\n                ' Create OE.\n                Set newElement = doc.createElement(\"one:OE\")\n                Set newNode = newNode.appendChild(newElement)\n                ' Create TE.\n                Set newElement = doc.createElement(\"one:T\")\n                Set newNode = newNode.appendChild(newElement)\n\n                ' Add the text for the Page's content.\n                Dim cd As MSXML2.IXMLDOMCDATASection\n                Set cd = doc.createCDATASection(\"Is this what I need to change?\")\n\n                newNode.appendChild cd\n\n\n                ' Update OneNote with the new content.\n                OneNote.UpdatePageContent doc.XML\n\n                ' Print out information about the update.\n                Debug.Print \"A new page was created in \"\n                Debug.Print \"Section \" &amp; sectionName &amp; \" in\"\n                Debug.Print \"Notebook \" &amp; noteBookName &amp; \".\"\n                Debug.Print \"Contents of new Page:\"\n\n                Debug.Print doc.XML\n            End If\n        Else\n            MsgBox \"OneNote 2010 Section nodes not found.\"\n        End If\n    Else\n        MsgBox \"OneNote 2010 Section XML Data failed to load.\"\n    End If\nElse\n    MsgBox \"OneNote 2010 XML Data failed to load.\"\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n\n<pre><code>Private Function GetAttributeValueFromNode(node As MSXML2.IXMLDOMNode, attributeName As String) As String\nIf node.Attributes.getNamedItem(attributeName) Is Nothing Then\n    GetAttributeValueFromNode = \"Not found.\"\nElse\n    GetAttributeValueFromNode = node.Attributes.getNamedItem(attributeName).Text\nEnd If\n</code></pre>\n\n<p>End Function</p>\n\n<pre><code>Private Function GetFirstOneNoteNotebookNodes(OneNote As OneNote.Application) As MSXML2.IXMLDOMNodeList\n' Get the XML that represents the OneNote notebooks available.\nDim notebookXml As String\n' OneNote fills notebookXml with an XML document providing information\n' about what OneNote notebooks are available.\n' You want all the data and thus are providing an empty string\n' for the bstrStartNodeID parameter.\nOneNote.GetHierarchy \"\", hsNotebooks, notebookXml, xs2013\n\n' Use the MSXML Library to parse the XML.\nDim doc As MSXML2.DOMDocument60\nSet doc = New MSXML2.DOMDocument60\n\nIf doc.LoadXML(notebookXml) Then\n   Dim soapNS\n   soapNS = \"xmlns:one='http://schemas.microsoft.com/office/onenote/2013/onenote'\"\n    doc.SetProperty \"SelectionNamespaces\", soapNS\n    Set GetFirstOneNoteNotebookNodes = doc.DocumentElement.SelectNodes(\"//one:Notebook\")\n    Debug.Print doc.DocumentElement.XML\n\nElse\n    Set GetFirstOneNoteNotebookNodes = Nothing\nEnd If\n</code></pre>\n\n<p>End Function</p>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492019857, "post_id": 43376444, "comment_id": 73815161, "body": "<code>Set lastrow = fedex.Cells(Rows.Count, 8).End(xlUp).Row</code> should be <code>lastrow = fedex.Cells(fedex.Rows.Count, 8).End(xlUp).Row</code>"}, {"owner": {"reputation": 89, "user_id": 5636822, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3655f93059b7d9ccfe13dbf8fdfbeb81?s=128&d=identicon&r=PG&f=1", "display_name": "DHI", "link": "https://stackoverflow.com/users/5636822/dhi"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492020153, "post_id": 43376444, "comment_id": 73815316, "body": "it didn&#39;t work...I&#39;m getting the same error message.."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1492021948, "creation_date": 1492021948, "answer_id": 43377101, "question_id": 43376444, "link": "https://stackoverflow.com/questions/43376444/how-to-delete-a-row-that-matches-criteria-in-other-sheet/43377101#43377101", "title": "how to delete a row that matches criteria in other sheet?", "body": "<p>Try the shorter code version below (explanations inside the code comments):</p>\n\n<pre><code>Option Explicit\n\nSub deletepaidshipments()\n\nDim FedexSht As Worksheet\nDim Sht1 As Worksheet\nDim LastRow As Long\nDim x As Long\n\nSet FedexSht = ThisWorkbook.Sheets(\"fedex_shipment_detail_payer_det\")\nSet Sht1 = ThisWorkbook.Sheets(\"sheet1\")\n\nWith FedexSht\n    LastRow = .Cells(.Rows.Count, \"H\").End(xlUp).Row\n\n    For x = LastRow To 2 Step -1 ' allways loop backwards when deleting rows\n        If Not IsError(Application.Match(.Range(\"H\" &amp; x).Value, Sht1.Range(\"A:A\"), 0)) Then ' check if there is a match &gt;&gt; delete row\n            .Rows(x).Delete\n        End If\n    Next x\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5636822, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3655f93059b7d9ccfe13dbf8fdfbeb81?s=128&d=identicon&r=PG&f=1", "display_name": "DHI", "link": "https://stackoverflow.com/users/5636822/dhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 43377101, "answer_count": 1, "score": 1, "last_activity_date": 1492022014, "creation_date": 1492019662, "last_edit_date": 1531164843, "question_id": 43376444, "link": "https://stackoverflow.com/questions/43376444/how-to-delete-a-row-that-matches-criteria-in-other-sheet", "title": "how to delete a row that matches criteria in other sheet?", "body": "<p>I have two spreadsheets one contains the data that I need to clean up (named \"fedex\") by deleting some rows that matches a list of numbers in another spreadsheet (named \"sheet1\"). \nSpreadsheet \"fedex\" column \"H\" has the numbers that match with spreadsheet \"sheet1\" column \"A\". </p>\n\n<p>I'm getting a <strong>type mismatch</strong> error message when it gets to <code>set lastrow = fedex.cells(Rows.count,8)end(xlUp).Row</code></p>\n\n<p>I'm not sure if the rest of the code will work since I'm stuck there. </p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub deletepaidshipments()\n\nDim fedex As Worksheet\nSet fedex = ThisWorkbook.Sheets(\"fedex_shipment_detail_payer_det\")\nDim sheet1 As Worksheet\nSet sheet1 = ThisWorkbook.Sheets(\"sheet1\")\nSet lastrow = fedex.Cells(Rows.Count, 8).End(xlUp).Row\n\nFor x = 2 To lastrow\n    t = 0\n    On Error Resume Next\n    t = Application.WorksheetFunction.Match(fedex.Range(\"h\" &amp; x), sheet1.Range(\"a :a\"), 0)\n    On Error GoTo 0\n    If t &gt; 0 Then\n        fedex.Rows(x, lastrow).Delete        \n    End If\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1492089087, "post_id": 43379756, "comment_id": 73847412, "body": "Huh, I tried to get that link out of the button, and couldn&#39;t find it for the life of me. Thanks."}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1492093328, "post_id": 43379756, "comment_id": 73850611, "body": "Hmm, workbooks.open(URL) gives a <code>Run-time error 1004 application-defined or object-defined error</code>.  And if I try to <code>IE.navigate URL</code> then it opens up the downloads menu, asking me if I&#39;d like to save it or download it.  How would I go about either telling it to download/why is it struggling in excel?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7857431"}, "reply_to_user": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1492107491, "post_id": 43379756, "comment_id": 73858975, "body": "Updated my comment, use this sub to open file directly in Excel. To download file without opening (or open later), use urlmon library or ADODB stream. Solution is here: <a href=\"http://stackoverflow.com/questions/17877389/how-do-i-download-a-file-using-vba-without-internet-explorer\" title=\"how do i download a file using vba without internet explorer\">stackoverflow.com/questions/17877389/&hellip;</a>"}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1492108869, "post_id": 43379756, "comment_id": 73859697, "body": "Hmm, I&#39;m still getting that generic <code>Run-time error 1004 Application-defined or object-defined error</code>, at least with <code>Application.Workbooks.open(strURL)</code>.  VBA will have to use it right after opening it, so I don&#39;t need to download without opening, though it comes to it, I&#39;ll do that and just open it from the drive.  I&#39;d like to see if I can just do it directly, though - I feel like it&#39;d be more elegant, easier to understand, faster, etc."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7857431"}, "reply_to_user": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1492113219, "post_id": 43379756, "comment_id": 73861923, "body": "Try to open any file first from the hard drive: <code>Workbooks.open(&quot;C:\\test.csv&quot;)</code> and if it works, that means something wrong with permissions or some system, network or IE setting."}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1492539580, "post_id": 43379756, "comment_id": 74014502, "body": "Oh wow didn&#39;t see this comment, sorry.  I can&#39;t try and open it from the drive because I don&#39;t have it downloaded, so I have to go onto internet explorer to get it (or another browser, but since IE and Excel are both MS programs, I figure it&#39;s gotta&#39; be the easiest one).  I&#39;ve gotten closer (I think), though, give me a few minutes to edit the question to where I&#39;ve gotten."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7857431"}, "is_accepted": false, "score": 2, "last_activity_date": 1492107245, "last_edit_date": 1492107245, "creation_date": 1492031691, "answer_id": 43379756, "question_id": 43376237, "link": "https://stackoverflow.com/questions/43376237/use-vba-to-open-ie-and-download-a-csv-file/43379756#43379756", "title": "Use vba to open IE and download a .csv file?", "body": "<p>If I understand right, you want to download CSV file and open it in Excel. If you do it manually with Chrome, for example, you can see that URL where it came from is:</p>\n\n<pre><code>http://climate.weather.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;stationID=889&amp;Year=2011&amp;Month=9&amp;Day=19&amp;timeframe=1&amp;submit=Download+Data\n</code></pre>\n\n<p>You can continue with Workbooks.Open(URL) or use XMLHTTP object or even QueryTables, just format URL string with parameters you need (station ID, date etc.). No IE required - I'm trying to use it only if auth, buttons clicks or JavaScript required to get data.</p>\n\n<p><strong>UPD:</strong>\nUse this macro below, works without errors</p>\n\n<pre><code>Sub OpenCSV()\nstrURL = \"http://climate.weataher.gc.ca/climate_data/bulk_data_e.html?format=csv&amp;stationID=889&amp;Year=2011&amp;Month=9&amp;Day=19&amp;timeframe=1&amp;submit=Download+Data\"\nApplication.Workbooks.Open (strURL)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4658, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492540415, "creation_date": 1492018907, "last_edit_date": 1531164843, "question_id": 43376237, "link": "https://stackoverflow.com/questions/43376237/use-vba-to-open-ie-and-download-a-csv-file", "title": "Use vba to open IE and download a .csv file?", "body": "<p>I have a program that has to open a webpage, copy over some data, save the data, and close the webpage.  <a href=\"http://climate.weather.gc.ca/climate_data/hourly_data_e.html?hlyRange=1953-01-01%7C2013-06-13&amp;dlyRange=1937-01-01%7C2013-06-12&amp;mlyRange=1937-01-01%7C2013-06-01&amp;StationID=889&amp;Prov=BC&amp;urlExtension=_e.html&amp;searchType=stnName&amp;optLimit=specDate&amp;StartYear=1840&amp;EndYear=2017&amp;selRowPerPage=25&amp;Line=2&amp;searchMethod=contains&amp;Month=9&amp;Day=19&amp;txtStationName=vancouver&amp;timeframe=1&amp;Year=2011\" rel=\"nofollow noreferrer\">This is the format of the webpage I am looking for</a>.  My goal is to have vba automatically download that .csv file (right side of the page, above the data itself, if you don't see it), and move it to a particular location out of downloads.  </p>\n\n<p>(I was using <code>workbooks.open(URL)</code> before, but I changed the URL to a government site to get better, more reliable data.  Problem is, this URL doesn't seem to work when I do that, unlike the old website, which would open up the page inside of Excel.  That was convenient, and if anyone knows how to make that work again with this site, I'll just do that instead, though I'm still curious to know how to use IE for vba)</p>\n\n<p>Problem is, I know piss all about how to use IE via VBA.  The code I have so far is</p>\n\n<pre><code>Dim IE As InternetExplorer\nDim Doc As Object, Elements As Object 'these two things and the next row are just things I heard might be useful through my research on how to do this\nDim WSSh As Object\n\nSet IE = New InternetExplorer\nSet WSSh = CreateObject(\"WScript.Shell\") 'not even sure what to do with this but until I'm sure I won't need it I'll just leave it there\n\nWith IE\n    .Visible = True 'once it's finished I'll take this out, I don't actually need to see this happen\n        'just want to see it happen while I write/debug it\n    .Navigate DataURLBegin &amp; DataURLMiddle &amp; DataURLEnd 'these three combined form the url above\n    Do\n        DoEvents\n    Loop While .ReadyState &lt;&gt; READYSTATE_COMPLETE\n    Stop\n    'this is where I've tried a lot of things but I'm not sure where to even start\nEnd With\n</code></pre>\n\n<p>As you can see I...haven't gotten far.  I gather from other people's attempts to do similar things that I have to loop through the elements on the sheet that can be activated, but I looked through IE's children, and I didn't see anything that seemed like elements, or that I could loop through.  So I'm not entirely sure where to proceed. </p>\n\n<p>Edit: so I think I've gotten closer, but I'm still having trouble.  My code is now: </p>\n\n<pre><code>Option Explicit\n\nSub ContactWeb(ByVal URL As String, ByVal DownloadPath As String)\n'I moved it into its own sub to stop taking up so much space\n'and make things easy to read\n\nDim IE As InternetExplorer 'some of these aren't used, I'll clean it up once this works\nDim Doc As Object, Elmt As Object\nDim HTMLColl As MSHTML.IHTMLElementCollection\nDim HTMLInput As MSHTML.HTMLInputElement\n\nSet IE = New InternetExplorer\n\nWith IE\n    .Visible = True\n    .Navigate URL\n\n    Do  'waits until the webpage is fully loaded, otherwise everything afterwards fails\n        DoEvents\n    Loop While .readyState &lt;&gt; READYSTATE_COMPLETE\n\n    Set Doc = IE.Document\n\n    Set Elmt = Doc.getElementById(\"bulkCsvLink\")\n\n    Elmt.Click 'I can't tell if this is actually doing anything, though...\n\n    Do\n        DoEvents\n    Loop While .readyState &lt;&gt; READYSTATE_COMPLETE\n\n    Stop\n\n    Set HTMLColl = Doc.getElementsByTagName(\"input\")\n    For Each Elmt In HTMLColl\n        If Elmt.innerText = \"Download Data\" Or Elmt.Value = \"Download Data\" Then\n            Stop\n            Elmt.Click 'This I know works because I tested it on the xml version\n            Exit For\n        End If\n    Next Elmt\n\n    Stop\n    Do\n        DoEvents\n    Loop While .readyState &lt;&gt; READYSTATE_COMPLETE\n    IE.Quit\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>As near as I can tell, this code is correct, but I don't know how to confirm the little message at the bottom that asks if I want to download (which I could have sworn wasn't appearing before, but maybe that was just me; sorry to anyone who saw the flurry of edits I did).  How do I click on confirm?  Preferably with the ability to input a download location, though I suppose I can always just copy/paste it to the right place using code as well.  </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7752500, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5125bc374d1b177a5253422aa023052c?s=128&d=identicon&r=PG&f=1", "display_name": "Kelsie", "link": "https://stackoverflow.com/users/7752500/kelsie"}, "edited": false, "score": 0, "creation_date": 1492098664, "post_id": 43380339, "comment_id": 73854301, "body": "Hi Jared. The problem I&#39;m having is that the lines of data can vary. Essentially I need to configure the code to identify the last row and apply the requested actions through the last line of data."}], "tags": [], "owner": {"reputation": 153, "user_id": 7753279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a80a3c3ee5d2ef3188d576f743b06fc?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/7753279/jared"}, "is_accepted": false, "score": 0, "last_activity_date": 1492099108, "last_edit_date": 1492099108, "creation_date": 1492034464, "answer_id": 43380339, "question_id": 43376174, "link": "https://stackoverflow.com/questions/43376174/setting-dynamic-ranges-in-vba/43380339#43380339", "title": "Setting Dynamic Ranges in VBA", "body": "<p>I'm assuming your problem is dealing with the letter aspect of ranges and trying to make that dynamic?  If so the syntax you may be looking for is.</p>\n\n<pre><code>Set MyRange = MySheet.Range(MySheet.Cells(TopRow, LeftCol), MySheet.Cells(LastRow, RightCol))\n</code></pre>\n\n<p>So For example, these two ranges will be equivalent but the first can be generated dynamically.</p>\n\n<pre><code>TopRow = 1\nLeftCol = 2\nLastRow = 100\nRightCol = 3\nSet MyRange = MySheet.Range(MySheet.Cells(TopRow, LeftCol), MySheet.Cells(LastRow, RightCol))\n\nSet MyOtherRange = mysheet.range(\"B1:C100\")\n</code></pre>\n\n<p>There are several methods to find the last row of a column, some work better in other circumstances then others.  Look here <a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba</a></p>\n\n<p>I usually use this</p>\n\n<pre><code>LastRow = sht.Cells(sht.Rows.Count, ColumnNumber).End(xlUp).Row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10260849, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PpHhKbcBXfA/AAAAAAAAAAI/AAAAAAAABGg/P3LrdiLl1nU/photo.jpg?sz=128", "display_name": "Zachary Airola", "link": "https://stackoverflow.com/users/10260849/zachary-airola"}, "is_accepted": false, "score": 0, "last_activity_date": 1537984496, "last_edit_date": 1537984496, "creation_date": 1537983576, "answer_id": 52523362, "question_id": 43376174, "link": "https://stackoverflow.com/questions/43376174/setting-dynamic-ranges-in-vba/52523362#52523362", "title": "Setting Dynamic Ranges in VBA", "body": "<p>If I understand the question correctly, the columns and starting rows are static and only a dynamic last row reference is needed. </p>\n\n<p>In <code>Worksheet_Change</code> event:</p>\n\n<pre><code>Set cell = Range(\"AK9:\" &amp; LastRow(\"BI\"))\nSet controlRng = Range(\"AF9:\" &amp; LastRow(\"AF\"))\n</code></pre>\n\n<p>Choose a row number larger than any number of rows your data will likely have (e.g.1000). Then, in the same module:</p>\n\n<pre><code>function LastRow(strColumn as string) as long\n  LastRow=range(strColumn &amp; 1000).end(xlup).row\nend function\n</code></pre>\n\n<p>VBA will re-calculate the <code>LastRow</code> every time the <code>Worksheet_Change</code> event is raised, \nthus making your ranges dynamic. </p>\n"}], "owner": {"reputation": 35, "user_id": 7752500, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5125bc374d1b177a5253422aa023052c?s=128&d=identicon&r=PG&f=1", "display_name": "Kelsie", "link": "https://stackoverflow.com/users/7752500/kelsie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4926, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537984496, "creation_date": 1492018703, "last_edit_date": 1531164843, "question_id": 43376174, "link": "https://stackoverflow.com/questions/43376174/setting-dynamic-ranges-in-vba", "title": "Setting Dynamic Ranges in VBA", "body": "<p>I have the following code below. Instead of using stagnant ranges (i.e., Range(\"AF9:AF50\") &amp; Range(AK9:BI50\")) I'm looking to implement a dynamic range that runs the code starting at row 9 through the last row of data for those columns. I've been reading on how to set dynamic ranges but I can't get it to work. Any advice/assistance is greatly appreciated. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\n\nDim cell As Range\nDim controlRng As Range, nRng As Range\n\nSet cell = Range(\"AK9:BI50\")\nSet controlRng = Range(\"AF9:AF50\")\nSet nRng = Intersect(controlRng, target)\n\nApplication.EnableEvents = False\n\nIf Not nRng Is Nothing Then\n    Select Case target.Value\n        Case \"No Promotion\"\n            target.Offset(, 1).Value = Range(\"M\" &amp; target.Row).Value\n            target.Offset(, 4).Value = Range(\"P\" &amp; target.Row).Value\n            target.Offset(, 9).Value = \"\"\n        Case \"Promotion\"\n            target.Offset(, 1).Value = \"\"\n            target.Offset(, 4).Value = \"\"\n            target.Offset(, 9).Value = 0.07\n        Case \"Demotion\", \"Partner\", \"\"\n            target.Offset(, 1).Value = \"\"\n            target.Offset(, 4).Value = \"\"\n            target.Offset(, 9).Value = \"\"\n    End Select\nEnd If\n\nIf Not Application.Intersect(cell, target) Is Nothing Then\n    Select Case target.Column\n        Case 37, 39, 43\n            target.Offset(, 1).Value = target.Value / Range(\"V\" &amp; target.Row).Value\n        Case 38, 40, 44\n            target.Offset(, -1).Value = WorksheetFunction.RoundUp((target.Value * Range(\"V\" &amp; target.Row).Value), -2)\n        Case 41, 60\n            target.Offset(, 1).Value = WorksheetFunction.RoundUp((target.Value * Range(\"V\" &amp; target.Row).Value), -2)\n        Case 42, 61\n            target.Offset(, -1).Value = target.Value / Range(\"V\" &amp; target.Row).Value\n    End Select\nEnd If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 61, "user_id": 7858036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/873b9c8bf99ab2785a72e2a8c7a0d5fc?s=128&d=identicon&r=PG&f=1", "display_name": "IrisRose", "link": "https://stackoverflow.com/users/7858036/irisrose"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492026407, "post_id": 43376136, "comment_id": 73818758, "body": "Sorry, I tried pasting the code and it was all jumbled into a paragraph. I didn&#39;t know how to fix it (new to forum and just learned what &#39;macros&#39; is today to try this code). I don&#39;t know how to post the code in the right format. :\\  But I edited the original post with the jumbled text (and a link to the original code, if you click it and scroll down it&#39;s there in the right format)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492026714, "post_id": 43376136, "comment_id": 73818967, "body": "Once you get the code into the question you need to indent every line by 4 spaces to make it look good.  Ctrl-K is a shortcut key to do that."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492026929, "post_id": 43376136, "comment_id": 73819085, "body": "FWIW - my guess that opening the workbook was causing the clipboard to be cleared wasn&#39;t correct."}, {"owner": {"reputation": 61, "user_id": 7858036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/873b9c8bf99ab2785a72e2a8c7a0d5fc?s=128&d=identicon&r=PG&f=1", "display_name": "IrisRose", "link": "https://stackoverflow.com/users/7858036/irisrose"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492027293, "post_id": 43376136, "comment_id": 73819298, "body": "<i>Thank you for fixing my original message. The code is now there</i> :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492027773, "post_id": 43376136, "comment_id": 73819575, "body": "I&#39;m not a Word-VBA expert (I came across your question while removing the incorrect &quot;macros&quot; tag) but until an actual expert comes along can you try changing <code>aRange.Copy</code> to <code>myTempText = aRange.Text</code>, and <code>objSheet.Cells(intRowCount, 1).Select</code> <code>objSheet.Paste</code> to <code>objSheet.Cells(intRowCount, 1).Value = myTempText</code> - that might help determine whether it is a copy/paste related problem or something else.  (I can&#39;t replicate the problem with some dummy data that I set up, so I&#39;m thinking there might be something in your document itself which is causing problems with copy/paste)"}, {"owner": {"reputation": 61, "user_id": 7858036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/873b9c8bf99ab2785a72e2a8c7a0d5fc?s=128&d=identicon&r=PG&f=1", "display_name": "IrisRose", "link": "https://stackoverflow.com/users/7858036/irisrose"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492028095, "post_id": 43376136, "comment_id": 73819773, "body": "Oh my god! Yes, that worked. I&#39;m going to try a second document just to double check, but it went through without error and the extracted text looks about right.  I&#39;ll post an update shortly. <i>thank you!!!!!</i>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492028104, "post_id": 43376136, "comment_id": 73819779, "body": "The other thing you could try is including <code>appExcel.workbooks(1).Save</code> after the <code>objSheet.Paste</code> line - that will save the workbook every time it finds a value and then, once it crashes you can open the workbook and hopefully find where in the document it got to successfully, then find the next &quot;Hair&quot; and see if there is anything weird about that sentence."}, {"owner": {"reputation": 61, "user_id": 7858036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/873b9c8bf99ab2785a72e2a8c7a0d5fc?s=128&d=identicon&r=PG&f=1", "display_name": "IrisRose", "link": "https://stackoverflow.com/users/7858036/irisrose"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492028740, "post_id": 43376136, "comment_id": 73820153, "body": "Okay, I tried it 3x times to be as certain as possible with varying document lengths, including one with over 1 million words just to see if it could handle a much larger document and it worked each time!   !!!!!!!!!! :) :) :) !!!!!!!!!!!!!!!  Thank you again. The only minor issue it has is that it&#39;s not 100% accurate. For instance,  a manual search may show the word &quot;blue&quot; 250 times, but the output of the script is 215. So, it&#39;s not perfect, but it&#39;s more than good enough for my needs. I can&#39;t possibly thank you enough. I tried fixing it on my own <i>ALL</i> day (from 8am to now, nearly 8 hours!!)"}, {"owner": {"reputation": 61, "user_id": 7858036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/873b9c8bf99ab2785a72e2a8c7a0d5fc?s=128&d=identicon&r=PG&f=1", "display_name": "IrisRose", "link": "https://stackoverflow.com/users/7858036/irisrose"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492028802, "post_id": 43376136, "comment_id": 73820188, "body": "You&#39;re an <i>EXPERT</i> in my eyes, for sure!  :) :) :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492028897, "post_id": 43376136, "comment_id": 73820240, "body": "Are the other 35 instances ones where &quot;Hair&quot; occurs twice in one sentence?"}, {"owner": {"reputation": 61, "user_id": 7858036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/873b9c8bf99ab2785a72e2a8c7a0d5fc?s=128&d=identicon&r=PG&f=1", "display_name": "IrisRose", "link": "https://stackoverflow.com/users/7858036/irisrose"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492029224, "post_id": 43376136, "comment_id": 73820422, "body": "Yes, I went back and there are a few instances where the word was repeated in the same sentence. Wow. I would have never thought of that. TY."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1492029046, "creation_date": 1492029046, "answer_id": 43379103, "question_id": 43376136, "link": "https://stackoverflow.com/questions/43376136/macro-error-microsoft-word-run-time-error-1004-paste-method-of-worksheet/43379103#43379103", "title": "Macro Error - Microsoft Word - Run-time error &#39;1004&#39;: Paste method of Worksheet class failed", "body": "<p>If the issue is due to copy/pasting the information, that can be avoided by just assigning the text directly:</p>\n\n<pre><code>Sub FindWordCopySentence()\n    Dim appExcel As Object\n    Dim objSheet As Object\n    Dim aRange As Range\n    Dim intRowCount As Integer\n    Dim myTempText As String\n    intRowCount = 1\n    Set aRange = ActiveDocument.Range\n    With aRange.Find\n        Do\n            .Text = \"Hair\"\n            .Execute\n            If .Found Then\n                aRange.Expand Unit:=wdSentence\n                'Store the text into a variable\n                myTempText = aRange.Text\n                aRange.Collapse wdCollapseEnd\n                If objSheet Is Nothing Then\n                    Set appExcel = CreateObject(\"Excel.Application\")\n                    Set objSheet = appExcel.workbooks.Open(\"C:\\Users\\HNR\\Desktop\\hair.xlsx\").Sheets(\"Sheet1\")\n                    intRowCount = 1\n                End If\n                'Set the destination cell to the text we stored\n                objSheet.Cells(intRowCount, 1).Value = myTempText\n                intRowCount = intRowCount + 1\n            End If\n        Loop While .Found\n    End With\n    If Not objSheet Is Nothing Then\n        appExcel.workbooks(1).Close True\n        appExcel.Quit\n        Set objSheet = Nothing\n        Set appExcel = Nothing\n    End If\n    Set aRange = Nothing\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Another potential cause of the issue is if you were bored while processing the large document, so you left it running in the background while doing other copy/paste operations on something else.</p>\n\n<p><code>Copy</code> and <code>Paste</code> share the clipboard with other applications so, if you do a copy between when the code did its <code>Copy</code> and when it did its <code>Paste</code>, it will be trying to <code>Paste</code> what you copied instead of what it copied.</p>\n\n<p>So, whenever possible, avoid using Copy/Paste within code.</p>\n"}], "owner": {"reputation": 61, "user_id": 7858036, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/873b9c8bf99ab2785a72e2a8c7a0d5fc?s=128&d=identicon&r=PG&f=1", "display_name": "IrisRose", "link": "https://stackoverflow.com/users/7858036/irisrose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492065466, "creation_date": 1492018581, "last_edit_date": 1492065466, "question_id": 43376136, "link": "https://stackoverflow.com/questions/43376136/macro-error-microsoft-word-run-time-error-1004-paste-method-of-worksheet", "title": "Macro Error - Microsoft Word - Run-time error &#39;1004&#39;: Paste method of Worksheet class failed", "body": "<p>I am trying to run a script that searches for a keyword, then copies the entire sentence where that keyword is found, and pastes it on an excel spreadsheet.</p>\n\n<p>When I run the script on a document that is 1-2 pages, it runs fine, but when I am try a much longer document (100+ pages), I get the following error:</p>\n\n<p>Run-time error '1004': Paste method of Worksheet class failed.\nWhen I click \"debug\" it says \"objsheet.paste\" is the problem.</p>\n\n<p>Could you please help me fix the code so that it can work with longer text, too?</p>\n\n<pre><code>Sub FindWordCopySentence()\n    Dim appExcel As Object\n    Dim objSheet As Object\n    Dim aRange As Range\n    Dim intRowCount As Integer\n    intRowCount = 1\n    Set aRange = ActiveDocument.Range\n    With aRange.Find\n        Do\n            .Text = \"Hair\"\n            .Execute\n            If .Found Then\n                aRange.Expand Unit:=wdSentence\n                aRange.Copy\n                aRange.Collapse wdCollapseEnd\n                If objSheet Is Nothing Then\n                    Set appExcel = CreateObject(\"Excel.Application\")\n                                         Set objSheet = appExcel.workbooks.Open(\"C:\\Users\\HNR\\Desktop\\hair.xlsx\").Sheets(\"Sheet1\")\n                    intRowCount = 1\n                End If\n                objSheet.Cells(intRowCount, 1).Select\n                objSheet.Paste\n                intRowCount = intRowCount + 1\n            End If\n        Loop While .Found\n    End With\n    If Not objSheet Is Nothing Then\n        appExcel.workbooks(1).Close True\n        appExcel.Quit\n        Set objSheet = Nothing\n        Set appExcel = Nothing\n    End If\n    Set aRange = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "import", "vba"], "comments": [{"owner": {"reputation": 45496, "user_id": 436560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/2GESV.jpg?s=128&g=1", "display_name": "Lajos Arpad", "link": "https://stackoverflow.com/users/436560/lajos-arpad"}, "edited": false, "score": 0, "creation_date": 1492018907, "post_id": 43376126, "comment_id": 73814653, "body": "Did you try &amp; &quot;11.04.2017&quot; at the end of the file?"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1492028487, "creation_date": 1492028487, "answer_id": 43378951, "question_id": 43376126, "link": "https://stackoverflow.com/questions/43376126/excel-vba-macro-open-file-with-data-import-for-specific-date/43378951#43378951", "title": "Excel VBA macro open file with data import for specific date", "body": "<p>All you have to do is concatenate the value from some object, such as a cell on a sheet, for instance.  Here I am passing the value from Cell E1 into the URL string.</p>\n\n<pre><code>\"URL;https://finance.yahoo.com/quote/IBM/financials?p=\" &amp; Range(\"E1\").Value, Destination:= _\n        Range(\"$A$1\"))\n</code></pre>\n\n<p>You can pass values from an InputBox, a TextBox, a ComboBox....pretty much anyt kind of object.</p>\n"}], "owner": {"reputation": 21, "user_id": 5537363, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/15b3cc181948f5db25faa1598e7c4211?s=128&d=identicon&r=PG&f=1", "display_name": "P.Schmid", "link": "https://stackoverflow.com/users/5537363/p-schmid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492028487, "creation_date": 1492018553, "last_edit_date": 1531164843, "question_id": 43376126, "link": "https://stackoverflow.com/questions/43376126/excel-vba-macro-open-file-with-data-import-for-specific-date", "title": "Excel VBA macro open file with data import for specific date", "body": "<p>I want to create a macro that is able to open htm file that has the correct name. All the htm files are named only after the date. So i want the macro only to open and import the data of the htm file with the correct date. So for example i want the macro only import the data of the date today. My idea was that i specify in one cell which date i want to get imported. </p>\n\n<p>Dim file As Variant\n    file = ThisWorkbook.Sheets(5).Range(\"B17\").Value</p>\n\n<p><em>So here i thought i refer to the cell where i specify the date.</em></p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:= _\n    \"URL;file:///C:/Users.....\n    Destination:=Range(\"$A$1\"))\n</code></pre>\n\n<p><em>But here i am not sure how to import the date value into the link for the file?</em></p>\n\n<p>In the end i want the link to look like</p>\n\n<p>\"URL;file:///C:/Users.../11.04.2017\"</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492018410, "post_id": 43375914, "comment_id": 73814394, "body": "What does &quot;doesn&#39;t&quot; mean - error message, wrong results, nothing happens? Why do you even need to do this? Rather bizarre design. Why should the label duplicate the data? Why not just a generic label like &quot;First Name&quot;."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492018901, "post_id": 43375914, "comment_id": 73814648, "body": "@June7 It&#39;s someone else&#39;s design that I&#39;m assisting with. The Placeholder caption isn&#39;t updating when the text fields are changed. The caption needs to be a concatenation of First, Last name and title so we can&#39;t do a generic label. Specifically because the form is intended to support adding a new customer, whose attributes are defined on the same form."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1492019389, "post_id": 43375914, "comment_id": 73814893, "body": "<code>AfterUpdate()</code> doesn&#39;t have the <code>Cancel</code> parameter. Something is very off here."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1492019464, "post_id": 43375914, "comment_id": 73814934, "body": "Have you placed the event into the AfterUpdate property of the first_name control."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492019801, "post_id": 43375914, "comment_id": 73815128, "body": "Still bizarre. This means changing the label caption after each data element is input. Duplicates what is already displayed in each input control. Instead of VBA, could just have a textbox with expression that concatenates the data elements. Set the textbox as TabStop No. You say this is a &#39;header&#39; caption - header for what? Or is this just a detached label on a form?"}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492019971, "post_id": 43375914, "comment_id": 73815231, "body": "@june7, I think OP is using a label that is separate from the three individual labels he&#39;s updating."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492020258, "post_id": 43375914, "comment_id": 73815368, "body": "@June7 That&#39;s not really possible because the individual may not have a title, or they may only have a last name and title, etc. So we need to detect which fields aren&#39;t null and then concatenate them to the text box header. This needs to be handled differently when defining a new individual, since all text fields will be blank initially."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492021311, "post_id": 43375914, "comment_id": 73815950, "body": "Entirely possible. The Nulls can be handled in the expression."}], "answers": [{"comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492019397, "post_id": 43376317, "comment_id": 73814897, "body": "Suggest using dot (.) instead of bang (!) when referencing objects and controls to get intellisense tips."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492019499, "post_id": 43376317, "comment_id": 73814958, "body": "what&#39;s intellisense?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492020872, "post_id": 43376317, "comment_id": 73815711, "body": "Intellisense is feature in VBA (and other programming platforms as well) that provides popup help tips as you type code. The dot (.) will trigger intellisense popups, bang (!) will not. In Access 2010, intellisense was expanded to the Expression Builder, so you can see what arguments your expression requires. However, in Access objects (query, form, report) design, the bang works there to give popup help."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492021160, "post_id": 43376317, "comment_id": 73815873, "body": "Ah, I actually just read up on it a bit.  I like the bang as I&#39;ve always used it to refer to that collection member and dots before the properties.  I think it&#39;s an Access thing, as I&#39;ve seen the notation change outside of Access - but seems like it&#39;s widely discussed."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492021820, "post_id": 43376317, "comment_id": 73816213, "body": "The dot will list control names so can be helpful in typing control names in code as well as their properties."}], "tags": [], "owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "is_accepted": false, "score": 0, "last_activity_date": 1492020111, "last_edit_date": 1492020111, "creation_date": 1492019204, "answer_id": 43376317, "question_id": 43375914, "link": "https://stackoverflow.com/questions/43375914/update-a-header-based-on-live-entry-into-a-text-field/43376317#43376317", "title": "Update a header based on live entry into a text field", "body": "<p>I just tested and no issue.   Is your first_name a text box?</p>\n\n<pre><code>Private Sub ProviderUpdate()\n    Me!provider_label.Caption = Me!first_name &amp; \" \" &amp; me!last_name &amp; \" \" &amp; me!Title\nEnd Sub\n</code></pre>\n\n<p>Then in each individual text_box, set the event procedure to call the ProviderUpdate sub.</p>\n"}, {"comments": [{"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1492022434, "post_id": 43376789, "comment_id": 73816560, "body": "Was just going to comment:  <code>NZ(Me!first_name,&quot;&quot;) &amp; &quot; &quot; &amp; NZ(me!last_name,&quot;&quot;) &amp; &quot; &quot; &amp; NZ(me!Title,&quot;&quot;)</code>   (or forms!control instead of me! if you&#39;re using absolute reference)"}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1492026097, "post_id": 43376789, "comment_id": 73818569, "body": "This works! It&#39;s not optimal since there&#39;s a comma regardless of whether last name is entered or not, but it will suffice."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492114305, "post_id": 43376789, "comment_id": 73862518, "body": "Revised first expression to deal with the orphan comma."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 2, "last_activity_date": 1492114260, "last_edit_date": 1492114260, "creation_date": 1492020855, "answer_id": 43376789, "question_id": 43375914, "link": "https://stackoverflow.com/questions/43375914/update-a-header-based-on-live-entry-into-a-text-field/43376789#43376789", "title": "Update a header based on live entry into a text field", "body": "<p>Non-VBA solution using expression in textbox ControlSource:</p>\n\n<p><code>= IIf([Last Name] &amp; [First Name] &amp; [Title] &amp; \"\" = \"\", \"Placeholder\", [Last Name] &amp; IIf(IsNull([Last Name]),\"\",\", \") + [First Name] &amp; \" - \" + [Title])</code></p>\n\n<p>or</p>\n\n<p><code>= IIf([Last Name] &amp; [First Name] &amp; [Title] &amp; \"\" = \"\", \"Placeholder\", Nz([Last Name], \"No LN\") &amp; \", \" &amp; Nz([First Name], \"No FN\") &amp; \" - \" &amp; Nz([Title], \"No Title))</code></p>\n"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1492114260, "creation_date": 1492017760, "question_id": 43375914, "link": "https://stackoverflow.com/questions/43375914/update-a-header-based-on-live-entry-into-a-text-field", "title": "Update a header based on live entry into a text field", "body": "<p>I have a header caption that starts as \"Placeholder\". Then I have three field; First name, last name and Title. I want to update and then append that caption as the user types into those three fields.</p>\n\n<p>So if someone enters the name, \"Steven\" into the first name field, the caption should update from placeholder to Steven.</p>\n\n<pre><code>Private Sub First_Name_AfterUpdate(Cancel As Integer)\n    Me.provider_label.Caption = Me.First_Name.Value\nEnd Sub\n</code></pre>\n\n<p>I thought this code would work but it doesn't. Almost seems too simple. I'm writing it in VBA in Microsoft Access on a form.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 1944, "user_id": 6171218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/631d9eb92bcd93033198ace2b00a01e5?s=128&d=identicon&r=PG&f=1", "display_name": "Erdem Akkas", "link": "https://stackoverflow.com/users/6171218/erdem-akkas"}, "edited": false, "score": 2, "creation_date": 1492018546, "post_id": 43375879, "comment_id": 73814461, "body": "Similar one here <a href=\"http://stackoverflow.com/questions/43273441/import-emails-from-specific-folder-in-outlook/43274160#43274160\" title=\"import emails from specific folder in outlook\">stackoverflow.com/questions/43273441/&hellip;</a>"}, {"owner": {"reputation": 336, "user_id": 641965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66ae13c9dd08b1f46634a49c633a2c78?s=128&d=identicon&r=PG", "display_name": "phhlho", "link": "https://stackoverflow.com/users/641965/phhlho"}, "edited": false, "score": 0, "creation_date": 1492025952, "post_id": 43375879, "comment_id": 73818486, "body": "Agree with Erdem - I&#39;m doing something similar with Powershell and the Microsoft.Office.Interop.Outlook. I just need to use the &#39;Folders&#39; property on one folder and pick the folder with the correct name to navigate to the subfolder."}, {"owner": {"reputation": 9, "user_id": 7857806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5230cf2ca7fcc161dccfa145c3330f?s=128&d=identicon&r=PG&f=1", "display_name": "Leah L", "link": "https://stackoverflow.com/users/7857806/leah-l"}, "edited": false, "score": 0, "creation_date": 1492612354, "post_id": 43375879, "comment_id": 74051690, "body": "Thank you I have made some changes to the code to choose which shared inbox to pull from with a date range but I get zero output on the excel file any advice?"}], "answers": [{"comments": [{"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 10622, "user_id": 3467532, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWfq5.jpg?s=128&g=1", "display_name": "daniele3004", "link": "https://stackoverflow.com/users/3467532/daniele3004"}, "edited": false, "score": 0, "creation_date": 1492096631, "post_id": 43382146, "comment_id": 73853027, "body": "The poster wants to know how to access folders in another mailbox, and my answer stands as the approach to use"}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 0, "last_activity_date": 1492047251, "creation_date": 1492047251, "answer_id": 43382146, "question_id": 43375879, "link": "https://stackoverflow.com/questions/43375879/macro-to-copy-emails-from-shared-mailbox-subfolders-to-excel/43382146#43382146", "title": "Macro to copy emails from shared mailbox subfolders to excel", "body": "<p>Loop through the NameSpace.Accounts collection until you find the Account object for the other mailbox. Then use Account.DeliveryStore to get a Store object, and use Store.GetDefaultFolder to get the Inbox, and then use Folder.Folders(\"FolderName\") to get the folder you need.</p>\n"}], "owner": {"reputation": 9, "user_id": 7857806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e5230cf2ca7fcc161dccfa145c3330f?s=128&d=identicon&r=PG&f=1", "display_name": "Leah L", "link": "https://stackoverflow.com/users/7857806/leah-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2068, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593325236, "creation_date": 1492017661, "last_edit_date": 1593325236, "question_id": 43375879, "link": "https://stackoverflow.com/questions/43375879/macro-to-copy-emails-from-shared-mailbox-subfolders-to-excel", "title": "Macro to copy emails from shared mailbox subfolders to excel", "body": "<p>I'm trying to create a few macros to help track multiple shared mailboxes for my job. I'm inexperienced when it comes to this so everything Ive put together has been through searching this site and google. Ive created one macro that will copy the emails over to excel however I am not able to figure out how to specify to only pull from a shared mailbox inbox subfolder. Any advice would be greatly appreciated!</p>\n\n<pre><code>Option Explicit\n Sub CopyToExcel()\n Dim xlApp As Object\n Dim xlWB As Object\n Dim xlSheet As Object\n Dim rCount As Long\n Dim bXStarted As Boolean\n Dim enviro As String\n Dim strPath As String\n\nDim objOL As Outlook.Application\nDim ns As Outlook.NameSpace\nDim objFolder As Outlook.MAPIFolder\nDim objItems As Outlook.Items\n Dim obj As Object\n Dim olItem 'As Outlook.MailItem\n Dim strColA, strColB, strColC, strColD, strColE, strColF As String\n\nSet ns = Application.GetNamespace(\"MAPI\")\n\n' Get Excel set up\nenviro = CStr(Environ(\"USERPROFILE\"))\n'the path of the workbook\nstrPath = \"H:\\Test\\Book1.xlsx\"\n     On Error Resume Next\n     Set xlApp = GetObject(, \"Excel.Application\")\n     If Err &lt;&gt; 0 Then\n         Application.StatusBar = \"Please wait while Excel source is opened ... \"\n         Set xlApp = CreateObject(\"Excel.Application\")\n         bXStarted = True\n     End If\n     On Error GoTo 0\n\nOn Error Resume Next\n  ' Open the workbook to input the data\n  ' Create workbook if doesn't exist\n     Set xlWB = xlApp.Workbooks.Open(strPath)\nIf Err &lt;&gt; 0 Then\n        Set xlWB = xlApp.Workbooks.Add\n      xlWB.SaveAs FileName:=strPath\nEnd If\n   On Error GoTo 0\n     Set xlSheet = xlWB.Sheets(\"Sheet1\")\n\nOn Error Resume Next\n' add the headers if not present\nIf xlSheet.Range(\"A1\") = \"\" Then\n  xlSheet.Range(\"A1\") = \"Sender Name\"\n  xlSheet.Range(\"B1\") = \"Sender Email\"\n  xlSheet.Range(\"C1\") = \"Subject\"\n  xlSheet.Range(\"D1\") = \"Body\"\n  xlSheet.Range(\"E1\") = \"Sent To\"\n  xlSheet.Range(\"F1\") = \"Date\"\nEnd If\n\n'Find the next empty line of the worksheet\nrCount = xlSheet.Range(\"B\" &amp; xlSheet.Rows.Count).End(-4162).Row\n'needed for Exchange 2016. Remove if causing blank lines.\nrCount = rCount + 1\n\n' get the values from outlook\nSet objOL = Outlook.Application\nSet objFolder = ns.Folder(\"shadow.customer.claims.legal.requests@blank.com\\Inbox\")\n    Set objItems = objFolder.Items\n  For Each obj In objItems\n\n    Set olItem = obj\n\n 'collect the fields\n\n    strColA = olItem.SenderName\n    strColB = olItem.SenderEmailAddress\n    strColC = olItem.Subject\n    strColD = olItem.Body\n    strColE = olItem.To\n    strColF = olItem.ReceivedTime\n\n\n' Get the Exchange address\n' if not using Exchange, this block can be removed\n Dim olEU As Outlook.ExchangeUser\n Dim oEDL As Outlook.ExchangeDistributionList\n Dim recip As Outlook.Recipient\n Set recip = Application.Session.CreateRecipient(strColB)\n\n If InStr(1, strColB, \"/\") &gt; 0 Then\n' if exchange, get smtp address\n     Select Case recip.AddressEntry.AddressEntryUserType\n       Case OlAddressEntryUserType.olExchangeUserAddressEntry\n         Set olEU = recip.AddressEntry.GetExchangeUser\n         If Not (olEU Is Nothing) Then\n             strColB = olEU.PrimarySmtpAddress\n         End If\n       Case OlAddressEntryUserType.olOutlookContactAddressEntry\n         Set olEU = recip.AddressEntry.GetExchangeUser\n         If Not (olEU Is Nothing) Then\n            strColB = olEU.PrimarySmtpAddress\n         End If\n       Case OlAddressEntryUserType.olExchangeDistributionListAddressEntry\n         Set oEDL = recip.AddressEntry.GetExchangeDistributionList\n         If Not (oEDL Is Nothing) Then\n            strColB = olEU.PrimarySmtpAddress\n         End If\n     End Select\nEnd If\n' End Exchange section\n\n'write them in the excel sheet\n  xlSheet.Range(\"A\" &amp; rCount) = strColA\n  xlSheet.Range(\"B\" &amp; rCount) = strColB\n  xlSheet.Range(\"c\" &amp; rCount) = strColC\n  xlSheet.Range(\"d\" &amp; rCount) = strColD\n  xlSheet.Range(\"e\" &amp; rCount) = strColE\n  xlSheet.Range(\"f\" &amp; rCount) = strColF\n\n'Next row\n  rCount = rCount + 1\nxlWB.Save\n\n Next\n\n' don't wrap lines\nxlSheet.Rows.WrapText = False\n\nxlWB.Save\n     xlWB.Close 1\n     If bXStarted Then\n         xlApp.Quit\n     End If\n\n     Set olItem = Nothing\n     Set obj = Nothing\n     Set xlApp = Nothing\n     Set xlWB = Nothing\n     Set xlSheet = Nothing\n End Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "parameters"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492018349, "post_id": 43375617, "comment_id": 73814362, "body": "<i>it&#39;s not possible to have multiple parameters on a Property unless you intend for them to be required</i> - IMO using property parameters for anything other than to create an <i>indexed property</i> is language abuse. Good decision making it a method."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492018416, "post_id": 43375617, "comment_id": 73814398, "body": "30 optional parameters is a bad design? Please tell whoever wrote <code>Application.Run</code>! =)"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492018857, "post_id": 43375617, "comment_id": 73814621, "body": "Nice to see you again @Mat&#39;sMug :) it&#39;s been awhile since I&#39;ve needed assistance. So, how do you think I should handle the situation to provide up to 30 slots? I&#39;d like it to display like how other parameters display on functions when they&#39;re optional. Example when typing <code>test.SetKeywords(</code> I&#39;d like it to look something like <code>KeywordOne As String, [KeywordTwoThroughThirty2],[KeywordTwoThroughThirty3]...[Key&zwnj;&#8203;wordTwoThroughThirty&zwnj;&#8203;30])</code>. Is that at all possible? If not, is there another method you&#39;d suggest for providing the 30 optional params?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1492018999, "post_id": 43375617, "comment_id": 73814699, "body": "If you want that kind of IntelliSense then you need to do what <code>Application.Run</code> did - that&#39;s right, 30 explicitly optional parameters. And then live with callers being able to do <code>DoSomething &quot;foo&quot;, arg10:=&quot;bar&quot;</code> to supply one optional argument and break everything that expected the first optional argument to be <code>arg1</code> ;-)"}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1492019094, "post_id": 43375617, "comment_id": 73814742, "body": "@CaffeinatedCoder - Who are your users? Could you expect them to be able to pass an array, then your function could use only the non empty elements?"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492019149, "post_id": 43375617, "comment_id": 73814767, "body": "I&#39;m afraid I&#39;m not completely following what you mean @Mat&#39;sMug :P Do you mind providing an example as an answer to help my rustiness along ;)"}, {"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1492019239, "post_id": 43375617, "comment_id": 73814809, "body": "@Absinthe I have to assume my users are complete imbeciles; therefore, I need it to be straight-forward. Most, if not all, would have no idea how to correctly pass an array unfortunately. That&#39;s why I&#39;d like to be able to provide an Intellisense-like experience for them."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492020140, "post_id": 43375617, "comment_id": 73815306, "body": "You&#39;re not <i>passing an array</i> with <code>ParamArray</code> - you&#39;re passing a comma-separated list of parameters, and VBA stuffs them into an array for you."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1492021537, "post_id": 43375617, "comment_id": 73816063, "body": "@CaffeinatedCoder - Assuming untrained monkeys will be using your code how about a low-tech solution? Create a worksheet &amp; table to hold the parameters."}], "answers": [{"comments": [{"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1492021037, "post_id": 43376575, "comment_id": 73815793, "body": "Really clever with the alternate approach and as always a very well-explained approach. Much appreciated, thank you :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1492020805, "last_edit_date": 1492020805, "creation_date": 1492020054, "answer_id": 43376575, "question_id": 43375617, "link": "https://stackoverflow.com/questions/43375617/is-it-possible-to-limit-the-args-of-a-paramarray-in-a-vba-class-sub-or-property/43376575#43376575", "title": "Is it possible to limit the args of a ParamArray in a VBA Class Sub or Property?", "body": "<p>It's not possible. <code>ParamArray</code>, as the name states, gives you a <em>parameter array</em>.</p>\n\n<p>A <code>ParamArray</code> can only be passed by reference (implicitly - explicit <code>ByRef</code> won't compile), and only be an array of <code>Variant</code> items, and can't be <code>Optional</code> - so this can't compile:</p>\n\n<pre><code>Optional ParamArray KeywordTwoThroughThirty(29) as String\n</code></pre>\n\n<p>Instead you'd just do:</p>\n\n<pre><code>ParamArray KeywordTwoThroughThirty()\n</code></pre>\n\n<p>What you <em>can</em> do, is use a <em>guard clause</em> to throw an error back at the caller when they've supplied too many arguments - interestingly it seems <code>Option Base</code> has no impact on the base boundary of <code>ParamArray</code> arrays, which seems to be 0 regardless of <code>Option Base</code> settings.. which makes it much simpler to verify how many arguments were specified:</p>\n\n<pre><code>Const maxArgs As Long = 30\nIf UBound(KeywordTwoThroughThirty) + 1 &gt; maxArgs Then\n    Err.Raise 5, \"SetKeywords\", _\n                 \"Too many arguments were specified. Maximum is \" &amp; maxArgs &amp; \".\"\nEnd If\n</code></pre>\n\n<p>Now the callers can pass up to 30 optional arguments; if they pass 31 or more, they'll have to deal with a run-time error 5 \"invalid procedure call or argument\", which is particularly appropriate here.</p>\n\n<hr>\n\n<p><em>IntelliSense</em> won't help your callers know how many arguments they're passing though:</p>\n\n<p><img src=\"https://i.stack.imgur.com/youh9.png\" alt=\"IntelliSense showing only one argument\"></p>\n\n<p>If you want calling code's <em>IntelliSense</em> to look like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/SUuif.png\" alt=\"IntelliSense showing all arguments, optional ones in square brackets\"></p>\n\n<p>...then you need to specify explicit optional arguments <em>for every single one of the 30 arguments you can get</em>.</p>\n\n<p>That's how <code>Application.Run</code> did it.</p>\n\n<p><img src=\"https://i.stack.imgur.com/zp4jL.png\" alt=\"Application.Run intellisense\"></p>\n\n<p>I'd recommend passing them all explicitly <code>ByVal</code> though.</p>\n\n<p>One problem you can hit is that a clever caller can do this:</p>\n\n<pre><code>DoSomething arg1:=\"foo\", arg14:=\"bar\"\n</code></pre>\n\n<p>And now if your implementation assumes an empty <code>arg2</code> means an empty <code>arg3</code> and an empty <code>arg14</code>, then you'll have bugs... whereas the <code>ParamArray</code> solution doesn't quite allow the user to mess things up with named arguments, and your implementation can iterate the array if it needs to, depending on the purpose of this.</p>\n\n<hr>\n\n<p>I'd recommend a different approach though.</p>\n\n<blockquote>\n<pre><code>Public Sub SetCategories(CategoryOne As String, Optional CategoryTwo As String)\n    pCategories(0) = CategoryOne\n    pCategories(1) = CategoryTwo\nEnd Sub\n</code></pre>\n</blockquote>\n\n<p>Your class won't have a value for <code>pCategories(0)</code> if the caller doesn't call <code>SetCategories</code> anyway - so I'd go with your first idea: an indexed property:</p>\n\n<pre><code>Public Property Get Category(ByVal index As Long) As String\n    Category = pCategories(index)\nEnd Property\n\nPublic Property Let Category(ByVal index As Long, ByVal value As String)\n    pCategories(index) = value\nEnd Property\n</code></pre>\n\n<p>And then expose some <code>Init</code> method:</p>\n\n<pre><code>Public Sub Init(ByVal category1 As String)\n    ReDim pCategories(0 To 29) As String\n    pCategories(0) = category1\nEnd Sub\n</code></pre>\n\n<p>That way the caller can do this:</p>\n\n<pre><code>With foo\n    .Init \"bar\"\n    .Category(1) = \"smurf\"\n    .Category(2) = \"blah\"\n    '...\nEnd With\n</code></pre>\n\n<p>And they can work with loops and other data structures to access and manipulate the 30 encapsulated items; VBA will take care of throwing a <em>subscript out of range</em> error if they try to work with more than 30 elements.</p>\n"}], "owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 1, "accepted_answer_id": 43376575, "answer_count": 1, "score": 1, "last_activity_date": 1492020805, "creation_date": 1492016678, "last_edit_date": 1492018622, "question_id": 43375617, "link": "https://stackoverflow.com/questions/43375617/is-it-possible-to-limit-the-args-of-a-paramarray-in-a-vba-class-sub-or-property", "title": "Is it possible to limit the args of a ParamArray in a VBA Class Sub or Property?", "body": "<p>I'm creating a vba excel class and are trying to figure out how to allow users to set groups of values that apply to a variable/field. From what I've read, it's not possible to have multiple parameters on a Property unless you intend for them to be required. What'd I'm trying to do is make it so only the first parameter is required the and a remaining number of parameters is optional. I've seem the suggestion of using a sub when needing to make subsequent parameters optional. That works fine, for example, when I'm setting up the following Sub</p>\n\n<pre><code>Public Sub SetCategories(CategoryOne As String, Optional CategoryTwo As String)\n    pCategories(0) = CategoryOne\n    pCategories(1) = CategoryTwo\nEnd Sub\n</code></pre>\n\n<p>Since there are only two parameters and I need only one to be required the above setup suffices. However, I have other properties that I need to allow up to 30 values and I'd really rather not hardcode 1 required value and 29 optional because that just seems like bad design. That's when I started looking into the ParamArray option. The ParamArray is perfect for this situation, except there's one issue I'm running into. The ParamArray allows as many args as you want and I need to be able to limit it to 29 (plus the one required). So, is there a way to limit the upperbound of a ParamArray to only allow so many arguments for a Sub? </p>\n\n<p>Something like the following</p>\n\n<pre><code>Public Sub SetKeywords(KeywordOne As String, Optional ParamArray KeywordTwoThroughThirty(29) as String)\n\nEnd Sub\n</code></pre>\n\n<p>Is that possible? If so, how? If not, how would you suggest I go about this scenerio?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1492020908, "post_id": 43376471, "comment_id": 73815728, "body": "Thanks this is what i m looking for."}], "tags": [], "owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "is_accepted": true, "score": 2, "last_activity_date": 1492019762, "creation_date": 1492019762, "answer_id": 43376471, "question_id": 43375293, "link": "https://stackoverflow.com/questions/43375293/vba-deleting-rows-that-dont-contain-specific-word/43376471#43376471", "title": "vba - deleting rows that don&#39;t contain specific word", "body": "<p>You need to change the column value in the line of code below to 1 instead of 17 like so:</p>\n\n<pre><code>If InStr(1, Rng.Cells(x, 1).Value, \"NW\") = 0 Then\n</code></pre>\n\n<p>This is because you are accessing the cells within the range you set previously, which only has 1 column: column Q.  So column Q is the first column of the Rng variable.  Column 17 is 17 columns from the first column in your range (column Q), which is column AG.  Your code would be selecting the correct column if you had written it as <code>ws.Cells(x, 17).Value</code> because then that would be the 17th column of the spreadsheet, as opposed to the 17th column of the range you set.</p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1492020315, "creation_date": 1492020315, "answer_id": 43376658, "question_id": 43375293, "link": "https://stackoverflow.com/questions/43375293/vba-deleting-rows-that-dont-contain-specific-word/43376658#43376658", "title": "vba - deleting rows that don&#39;t contain specific word", "body": "<p>You may try something like this...</p>\n\n<pre><code>Sub FilterAndDeleteRows()\nDim ws As Worksheet\nDim lr As Long\nSet ws = ActiveSheet\nlr = ws.Cells(Rows.Count, 2).End(xlUp).Row\nws.AutoFilterMode = False\nws.Range(\"B2:Q4\").AutoFilter field:=16, Criteria1:=\"NW\"\nOn Error Resume Next\nIf ws.Range(\"Q4:Q\" &amp; lr).SpecialCells(xlCellTypeVisible).Rows.Count &gt; 1 Then\n    ws.Range(\"Q5:Q\" &amp; lr).SpecialCells(xlCellTypeVisible).EntireRow.Delete\nEnd If\nws.AutoFilterMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 1, "accepted_answer_id": 43376471, "answer_count": 2, "score": 1, "last_activity_date": 1492020315, "creation_date": 1492015617, "last_edit_date": 1531164843, "question_id": 43375293, "link": "https://stackoverflow.com/questions/43375293/vba-deleting-rows-that-dont-contain-specific-word", "title": "vba - deleting rows that don&#39;t contain specific word", "body": "<p>I am trying to delete rows that don't contain specific word in column Q and re calculate the sum row. Now this is part of the codes that I am designing so I am only posting this part since the rest of codes work just fine.</p>\n\n<p>As for my data, I have a list of cites and their info and I added a column for their corresponding region (column Q) so I would like to filter the region I want to do analysis. For the total row, I need to re-calculate the numbers since it should only reflect the sum that are in the region.</p>\n\n<p>My data range has merged headers and a total row so not sure if this will complicate the situation. </p>\n\n<pre><code>Sub test()\n\nDim Rng As Range\nDim x, lngLastRow As Long\nDim ws As Worksheet\n\nSet ws = Worksheets(\"A\")\nlngLastRow = ws.Cells(Rows.Count, \"B\").End(xlUp).Row\nSet Rng = Range(\"Q5:Q\" &amp; lngLastRow - 1)\nFor x = Rng.Rows.Count To 1 Step -1\nIf InStr(1, Rng.Cells(x, 17).Value, \"NW\") = 0 Then\nRng.Cells(x, 1).EntireRow.Delete\nEnd If\nNext x\nEnd Sub\n</code></pre>\n\n<p>Now my current codes just delete everything excepts the merged header so I need help to filter for each region. And you can see that I haven't re-calculate the sum row as well since my codes have not worked so far so I haven't added that part yet.</p>\n\n<p>Now, second method I have tried is to use filter function and it's giving me \"Run Time Error 1004 AutoFilter method of Range class Failed\" and this is the codes I tried.</p>\n\n<pre><code>   With ws.Range(\"B5\", \"Q\" &amp; lngLastRow)\n   .AutoFilter\n   .AutoFilter Field:=17, Criteria1:=\"NW\"\n   End with\n</code></pre>\n\n<p>So I don't know which way will work better or if you guys have a different approach.</p>\n\n<p>Here is a display of my data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZWpss.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZWpss.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1492014512, "post_id": 43374910, "comment_id": 73812226, "body": "It&#39;s always best to show your code."}, {"owner": {"reputation": 41, "user_id": 6569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8af1593eee32c7b9c549a8e04851c26?s=128&d=identicon&r=PG&f=1", "display_name": "Monster", "link": "https://stackoverflow.com/users/6569888/monster"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1492014722, "post_id": 43374910, "comment_id": 73812350, "body": "This is my code: Cells(LastRow + 1, 3).Formula = &quot;=SI.ERROR(BUSCARV(&quot; &amp; &quot;B&quot; &amp; laststr &amp; &quot; , Datos!A2:E52, 3), &quot;&quot;&quot;&quot;)&quot; as I said it insert the text perfectly on the selected cell but for some reason Excel is not &quot;executing&quot; the code inside that cell unless pressing F2 and Enter"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1492014725, "post_id": 43374910, "comment_id": 73812354, "body": "What formatting you have applied to the cells where you are putting the formulas, Text?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492014965, "post_id": 43374910, "comment_id": 73812492, "body": "I <b>think</b> you need to use FormulaLocal to insert locale-dependent formulas."}, {"owner": {"reputation": 41, "user_id": 6569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8af1593eee32c7b9c549a8e04851c26?s=128&d=identicon&r=PG&f=1", "display_name": "Monster", "link": "https://stackoverflow.com/users/6569888/monster"}, "edited": false, "score": 0, "creation_date": 1492014971, "post_id": 43374910, "comment_id": 73812496, "body": "I&#39;m doing this to a &quot;brand new&quot; sheet so it&#39;s set to General."}, {"owner": {"reputation": 41, "user_id": 6569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8af1593eee32c7b9c549a8e04851c26?s=128&d=identicon&r=PG&f=1", "display_name": "Monster", "link": "https://stackoverflow.com/users/6569888/monster"}, "edited": false, "score": 0, "creation_date": 1492015014, "post_id": 43374910, "comment_id": 73812521, "body": "I&#39;m using Excel in Spanish, that&#39;s why the formula names are in that language."}, {"owner": {"reputation": 41, "user_id": 6569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8af1593eee32c7b9c549a8e04851c26?s=128&d=identicon&r=PG&f=1", "display_name": "Monster", "link": "https://stackoverflow.com/users/6569888/monster"}, "edited": false, "score": 0, "creation_date": 1492015145, "post_id": 43374910, "comment_id": 73812598, "body": "Thanx YoyE3K!!! Using FormulaLocal seems to work (so far)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1492015436, "post_id": 43374910, "comment_id": 73812765, "body": "FWIW using <code>FormulaLocal</code> makes your <i>code</i> locale-dependent, which means if any of your users runs the macro on another machine configured in another locale, <i>they</i> will be getting the <code>#NAME!</code> errors. To avoid this use <code>.Formula</code> and use the English function names in VBA. That way a French client will see <code>=SOMME</code>, an English one will see <code>=SUM</code> and a Spanish one will see whatever the Spanish is for the SUM formula. =)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492024404, "post_id": 43374910, "comment_id": 73817655, "body": "@Monster - Can you &quot;unaccept&quot; my answer please, and accept your own one instead - as Mat&#39;s Mug has pointed out, my answer is a stupid idea."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492024516, "post_id": 43374910, "comment_id": 73817719, "body": "@YowE3K that&#39;s not what I said... ;-)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492025006, "post_id": 43374910, "comment_id": 73818000, "body": "@Mat&#39;sMug - I paraphrased (because it <b>is</b> a stupid idea, even if you didn&#39;t say it)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492025240, "post_id": 43374910, "comment_id": 73818117, "body": "@YowE3K you could always edit your answer.. &quot;just do it the wrong way&quot; -style ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492015815, "post_id": 43375173, "comment_id": 73812967, "body": "This feels like a horrible idea (code is no longer portable), but +1 for &quot;fixing&quot; the immediate problem."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492024441, "post_id": 43375173, "comment_id": 73817676, "body": "@Mat&#39;sMug - Good point - I&#39;ll try to get the OP to unaccept the answer so that I can delete it."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1492025468, "last_edit_date": 1495542342, "creation_date": 1492015222, "answer_id": 43375173, "question_id": 43374910, "link": "https://stackoverflow.com/questions/43374910/issues-with-macros-and-formulas-in-excel/43375173#43375173", "title": "Issues with macros and formulas in Excel", "body": "<p>Please refer to <a href=\"https://stackoverflow.com/a/43376054/6535336\">the answer by Monster</a> for the correct solution to the problem.</p>\n\n<p>I have to leave this answer here until it is \"unaccepted\", and then I will be able to delete it.</p>\n\n<hr>\n\n<p>To enter locale-dependent formulas, you need to use <code>FormulaLocal</code>:</p>\n\n<pre><code>Cells(LastRow + 1, 3).FormulaLocal = \"=SI.ERROR(BUSCARV(B\" &amp; laststr &amp; \" , Datos!A2:E52, 3), \"\"\"\")\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 6569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8af1593eee32c7b9c549a8e04851c26?s=128&d=identicon&r=PG&f=1", "display_name": "Monster", "link": "https://stackoverflow.com/users/6569888/monster"}, "is_accepted": false, "score": 2, "last_activity_date": 1492025112, "last_edit_date": 1492025112, "creation_date": 1492018280, "answer_id": 43376054, "question_id": 43374910, "link": "https://stackoverflow.com/questions/43374910/issues-with-macros-and-formulas-in-excel/43376054#43376054", "title": "Issues with macros and formulas in Excel", "body": "<p>Thanks for your replies!!! </p>\n\n<p>Using FormulaLocal works great!!! What I did was to \"translate\" the functions names and done!</p>\n\n<pre><code>Cells(LastRow + 1, 3).Formula = \"=IFERROR(VLOOKUP(\" &amp; \"B\" &amp; laststr &amp; \" , Datos!A2:E52, 3), \"\"\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6569888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8af1593eee32c7b9c549a8e04851c26?s=128&d=identicon&r=PG&f=1", "display_name": "Monster", "link": "https://stackoverflow.com/users/6569888/monster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 0, "accepted_answer_id": 43375173, "answer_count": 2, "score": 0, "last_activity_date": 1492025468, "creation_date": 1492014355, "last_edit_date": 1492014833, "question_id": 43374910, "link": "https://stackoverflow.com/questions/43374910/issues-with-macros-and-formulas-in-excel", "title": "Issues with macros and formulas in Excel", "body": "<p>I'm having problems when inserting a formula from a macro in Excel. I managed to insert exactly the same value that I have on another cell where the formula is working perfectly. It always says #\u00bfNAME? unless I press F2 and Enter. I checked and rechecked the calculation mode and is not Manual, is set to automatic but this formulas doesn't work at all. The method SendKeys \"{f2}\" SendKeys \"{enter}\" seems to work but it's horrible and not \"seamless\".</p>\n\n<p>I've tried with different formulas (from simpler to more complex) and every time a tried any function inside my formula just doesn't work. The only way I insert a working formula is just using numbers (ex. \"=1+1\" and stuff like that) but when using any function for ex. \"=SUM(A1:A5)\" just don't work (unless pressing F2 and Enter).</p>\n\n<p>I don't understand why having exactly the same \"text\" inserted as Formula it just don't work.\nWhat can I do to solve this???\nThanx in advance</p>\n"}, {"tags": ["excel", "vba", "excel-2013"], "comments": [{"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 1, "creation_date": 1492014053, "post_id": 43374700, "comment_id": 73811934, "body": "Worst, your code doesn&#39;t even run! Target &lt;&gt; Range leads to type mismatch! But I accept optimization as a valid question!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492014131, "post_id": 43374700, "comment_id": 73811981, "body": "<code>If Target &lt;&gt; Range(&quot;A7:A98&quot;) Then</code>  &lt;~~ this is wrong."}, {"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1492014919, "post_id": 43374700, "comment_id": 73812458, "body": "I forgot I had that there. If Target &lt;&gt; Range(&quot;A7:A98&quot;) Then was me butchering the code trying to figure out how to ignore the cells other than the ones being checked... Clearly it didn&#39;t work. i will edit the post accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1492014300, "creation_date": 1492014300, "answer_id": 43374894, "question_id": 43374700, "link": "https://stackoverflow.com/questions/43374700/sheet-behaving-very-slow-with-hidden-rows/43374894#43374894", "title": "Sheet behaving very slow with hidden rows", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim rCheck As Range\n    Dim rCell As Range\n    Dim rHide As Range\n    Dim lCalc As XlCalculation\n\n    Set rCheck = Me.Range(\"A7:A98\")\n\n    With Application\n        lCalc = .Calculation\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    On Error GoTo CleanExit\n\n    If Not Intersect(Target, rCheck) Is Nothing Then\n        rCheck.EntireRow.Hidden = False\n        For Each rCell In rCheck\n            If rCell.Value = 0 And rCell.Value = vbNullString Then\n                If rHide Is Nothing Then\n                    Set rHide = rCell\n                Else\n                    Set rHide = Union(rHide, rCell)\n                End If\n            End If\n        Next rCell\n    End If\n\n    If Not rHide Is Nothing Then rHide.EntireRow.Hidden = True\n\nCleanExit:\n    With Application\n        .Calculation = lCalc\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1492014548, "creation_date": 1492014548, "answer_id": 43374970, "question_id": 43374700, "link": "https://stackoverflow.com/questions/43374700/sheet-behaving-very-slow-with-hidden-rows/43374970#43374970", "title": "Sheet behaving very slow with hidden rows", "body": "<p>Your logic appears sketchy and it is a little hard to tell what you are trying to do but your logical can be shortened and used to determine the boolean .Hidden.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"A7:A98\")) Is Nothing Then\n        On Error GoTo safe_exit\n        Application.EnableEvents = False\n        Dim trgt As Range\n        For Each trgt In Intersect(Target, Range(\"A7:A98\"))\n            trgt.EntireRow.Hidden = CBool(trgt.Value = vbNullString)\n        Next trgt\n    End If\n\nsafe_exit:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 43374970, "answer_count": 2, "score": 0, "last_activity_date": 1492014947, "creation_date": 1492013697, "last_edit_date": 1492014947, "question_id": 43374700, "link": "https://stackoverflow.com/questions/43374700/sheet-behaving-very-slow-with-hidden-rows", "title": "Sheet behaving very slow with hidden rows", "body": "<p>For some reason this shee is behaving very sluggish anytime the macro runs. This is becoming problematic as every time I try to change information on unhidden cells that are not part of the range, it still runs an update and takes nearly 5-10 seconds to complete. </p>\n\n<p>What changes to the formula need to take place to midigate this problem?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim c As Range\n\n\n    For Each c In Range(\"A7:A98\")\n        If c.Value = 0 And c.Value = vbNullString Then\n        c.EntireRow.Hidden = True\n        End If\n    Next c\n\n    For Each c In Range(\"A7:A98\")\n        If c.Value &lt;&gt; 0 And c.Value &lt;&gt; vbNullString Then\n        c.EntireRow.Hidden = False\n        End If\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1492013629, "post_id": 43374665, "comment_id": 73811661, "body": "What exactly do you mean by &quot;if both ranges are the same&quot;?"}, {"owner": {"reputation": 3, "user_id": 7684792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb8ca2ce8afc6833bdb31573c8b032d?s=128&d=identicon&r=PG&f=1", "display_name": "YesHelloThisIsDog", "link": "https://stackoverflow.com/users/7684792/yeshellothisisdog"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492013713, "post_id": 43374665, "comment_id": 73811724, "body": "For example, if the predetermined range is S8:AC8 on Sheet1, and if the user selects range S8:AC8 on Sheet1, then both those ranges are the same. I am not talking about cell content here. Sorry if it is ambiguous, I am still learning the appropriate jargon!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1492013776, "post_id": 43374665, "comment_id": 73811753, "body": "OK, try this <code>If Worksheets(&quot;Sheet1&quot;).Range(&quot;S8:AC8&quot;).address = OriginalSelection.address</code>."}, {"owner": {"reputation": 3, "user_id": 7684792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb8ca2ce8afc6833bdb31573c8b032d?s=128&d=identicon&r=PG&f=1", "display_name": "YesHelloThisIsDog", "link": "https://stackoverflow.com/users/7684792/yeshellothisisdog"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492013941, "post_id": 43374665, "comment_id": 73811863, "body": "Works like a charm! Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1492014500, "creation_date": 1492014500, "answer_id": 43374956, "question_id": 43374665, "link": "https://stackoverflow.com/questions/43374665/check-if-selection-is-equal-to-a-predetermined-range/43374956#43374956", "title": "Check if selection is equal to a predetermined range", "body": "<p>To check if the sheet is the same too, you can use the full address:</p>\n\n<pre><code>If Selection.Address(0, 0, , 1) = \"[Book1]Sheet1!S8:AC8\" Then\n</code></pre>\n\n<p>or</p>\n\n<pre><code>If Selection.Address(0, 0) = \"S8:AC8\" And Selection.Parent.Name = \"Sheet1\" Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1492014746, "creation_date": 1492014746, "answer_id": 43375038, "question_id": 43374665, "link": "https://stackoverflow.com/questions/43374665/check-if-selection-is-equal-to-a-predetermined-range/43375038#43375038", "title": "Check if selection is equal to a predetermined range", "body": "<p>You can try comparing the <code>Range.Address</code> with one line:</p>\n\n<pre><code>If Worksheets(\"Sheet1\").Range(\"S8:AC8\").Address(True, True, xlA1, True) = OriginalSelection.Address(True, True, xlA1, True) Then\n</code></pre>\n\n<p>The fourth parameter <code>External = True</code> will return the the full Range including the <code>Workbook.Name</code> and <code>Sheet.Name</code></p>\n"}], "owner": {"reputation": 3, "user_id": 7684792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfb8ca2ce8afc6833bdb31573c8b032d?s=128&d=identicon&r=PG&f=1", "display_name": "YesHelloThisIsDog", "link": "https://stackoverflow.com/users/7684792/yeshellothisisdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492014746, "creation_date": 1492013556, "question_id": 43374665, "link": "https://stackoverflow.com/questions/43374665/check-if-selection-is-equal-to-a-predetermined-range", "title": "Check if selection is equal to a predetermined range", "body": "<p>I have written a bit of code for that has the following purpose: a user must select a range on Sheet1, then will press a button to which a macro is assigned. The macro will then check if the range the user has selected is equal to a predetermined range, also on Sheet1. If both ranges are the same, then the macro will select Sheet2 and complete other tasks. If the ranges are not equal, then the macro will stop. Here is the code:</p>\n\n<pre><code>Sub Example_1()\n\n    Dim OriginalSelection As Range\n    Set OriginalSelection = Selection\n\n    If Worksheets(\"Sheet1\").Range(\"S8:AC8\") = OriginalSelection Then\n        Sheets(\"Sheet2\").Select\n        'The macro will do other things here\n    Else\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This said, whenever I try to run the macro, I get the following error: </p>\n\n<blockquote>\n  <p>Run-time error '13': Type Mismatch</p>\n</blockquote>\n\n<p>Does anybody know where the problem lies? I am still trying to wrap my head around VBA!</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492013675, "post_id": 43374664, "comment_id": 73811695, "body": "You can test this yourself from a worksheet but paste special options are only available if you copy rather than cut. You could copy and then clear the original cells."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7834661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b0de85c903d365fad048a7ea7aa6e6c?s=128&d=identicon&r=PG&f=1", "display_name": "S Beard", "link": "https://stackoverflow.com/users/7834661/s-beard"}, "edited": false, "score": 0, "creation_date": 1492014592, "post_id": 43374806, "comment_id": 73812274, "body": "I apologize, I had to edit the question, the FillRight/Clear function only seems to work with single column ranges, I need to move a 3 column range.  Can this code work with larger than one column ranges?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 47, "user_id": 7834661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b0de85c903d365fad048a7ea7aa6e6c?s=128&d=identicon&r=PG&f=1", "display_name": "S Beard", "link": "https://stackoverflow.com/users/7834661/s-beard"}, "edited": false, "score": 0, "creation_date": 1492014950, "post_id": 43374806, "comment_id": 73812483, "body": "Probably best to go back to a PasteSpecial then but you only need the top-left corner of the destination. This removes bad destination range calculation from consideration."}, {"owner": {"reputation": 47, "user_id": 7834661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b0de85c903d365fad048a7ea7aa6e6c?s=128&d=identicon&r=PG&f=1", "display_name": "S Beard", "link": "https://stackoverflow.com/users/7834661/s-beard"}, "edited": false, "score": 0, "creation_date": 1492015007, "post_id": 43374806, "comment_id": 73812515, "body": "I think it will work if I just use the copy, then pastespecial, then clear the first column of the original copy range."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1492014884, "last_edit_date": 1492014884, "creation_date": 1492014004, "answer_id": 43374806, "question_id": 43374664, "link": "https://stackoverflow.com/questions/43374664/cutting-a-range-and-pastespecial-formulas/43374806#43374806", "title": "Cutting a range and PasteSpecial formulas", "body": "<p>Copy the larger range using only the top-left cell of the destination then Clear.</p>\n\n<pre><code>Sub Cut_Paste\n    with Range(\"D4:F8\")\n        .copy\n        Range(\"E4\").PasteSpecial xlPasteFormulas\n        .clear\n    end with\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 650, "user_id": 7857786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbefe9a0dc20a7f973a96b4ee74045f?s=128&d=identicon&r=PG&f=1", "display_name": "maaajo", "link": "https://stackoverflow.com/users/7857786/maaajo"}, "is_accepted": true, "score": 1, "last_activity_date": 1492014899, "creation_date": 1492014899, "answer_id": 43375087, "question_id": 43374664, "link": "https://stackoverflow.com/questions/43374664/cutting-a-range-and-pastespecial-formulas/43375087#43375087", "title": "Cutting a range and PasteSpecial formulas", "body": "<p>Try something like that:</p>\n\n<pre><code>Sub Cut_Paste\n    Range(\"D4:F8\").Cut Destination:=Range(\"E4:G8\")    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7834661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b0de85c903d365fad048a7ea7aa6e6c?s=128&d=identicon&r=PG&f=1", "display_name": "S Beard", "link": "https://stackoverflow.com/users/7834661/s-beard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1657, "favorite_count": 0, "accepted_answer_id": 43375087, "answer_count": 2, "score": 0, "last_activity_date": 1492014899, "creation_date": 1492013554, "last_edit_date": 1492014660, "question_id": 43374664, "link": "https://stackoverflow.com/questions/43374664/cutting-a-range-and-pastespecial-formulas", "title": "Cutting a range and PasteSpecial formulas", "body": "<p>I am trying to cut a range of cells and then paste the same range one cell over.  When I run this basic code, it still gives me Run-time Error 1004 Application or object-defined error.  Why am I getting this error?  Would this require an array instead?</p>\n\n<pre><code>Sub Cut_Paste\n    Range(\"D4:F8\").Cut\n    Range(\"E4:G8\").PasteSpecial xlPasteFormulas\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "performance", "excel", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1492016840, "post_id": 43374578, "comment_id": 73813586, "body": "Have you tried using a few variables to reduce the amount of time spent resolving those references multiple times for every run though the loop?  For example, set a variable to the mail item in question, or better yet, get the Body text into a string variable and loop over that."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1492019073, "post_id": 43374578, "comment_id": 73814729, "body": "Can you post complete code?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1492080611, "post_id": 43374578, "comment_id": 73841176, "body": "@0m3r : Ok I will edit the post. This will be only to bring value for those who might be interested though since it is unrelated to my question"}], "answers": [{"comments": [{"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1492082124, "post_id": 43378471, "comment_id": 73842295, "body": "I am confused, I thought there was a limit of characters we could store in a string but apparently it works. Also, I thought in order to increase the performance of a code we should use a minimum of variables. Would the performance be really different if I didn&#39;t create the <code>item</code> variable but stored the whole thing in <code>body</code> rather ?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1492089174, "post_id": 43378471, "comment_id": 73847496, "body": "In 32 bit you string is limited to 4Gb. Minimizing the number of variables in the best case will do nothing (the compiler still has to create implicit variables to hold the  intermediate results) and in the worst case (like yours) degrade the performance significantly."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1492042895, "last_edit_date": 1492042895, "creation_date": 1492026773, "answer_id": 43378471, "question_id": 43374578, "link": "https://stackoverflow.com/questions/43374578/reduce-process-time-string-decomposition/43378471#43378471", "title": "Reduce process time String decomposition", "body": "<p>This is multiple dot notation taken to its extreme. Read the item first, then its body, and only then loop through the characters.</p>\n\n<p>You need to realize that each time you <code>call Inbox.Items(MostRecentVersionIndex).body</code>, Outlook returns the Items collection, scrolls to the index MostRecentVersionIndex, opens the message, then reads its (huge) Body property. You do that 5 or 6 times for no good reason.</p>\n\n<pre><code>set Item = Inbox.Items(MostRecentVersionIndex)\nbody = item.Body\nFor position = InStr(body, \"Name\") To Len(body)\n            ThisWorkbook.Sheets(1).Range(\"A\" &amp; CellRow) = Mid(body, InStr(position, body, \"SCA\"), InStr(InStr(position, body, \"SCA\") + 1, body, \"SCA\") - InStr(position, body, \"SCA\"))\n            CellRow = CellRow + 1\n            position = InStr(InStr(position, body, \"SCA\") + 1, body, \"SCA\") - 1\n        Next position \n</code></pre>\n"}], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 43378471, "answer_count": 1, "score": 0, "last_activity_date": 1492082526, "creation_date": 1492013254, "last_edit_date": 1492082526, "question_id": 43374578, "link": "https://stackoverflow.com/questions/43374578/reduce-process-time-string-decomposition", "title": "Reduce process time String decomposition", "body": "<p>I hope you can help me reduce the runtime of my code :</p>\n\n<pre><code>Dim position As Long\nDim CellRow As Long\nCellRow = 2\n\nFor position = InStr(Inbox.Items(MostRecentVersionIndex).body, \"Name\") To Len(Inbox.Items(MostRecentVersionIndex).body)\n            ThisWorkbook.Sheets(1).Range(\"A\" &amp; CellRow) = Mid(Inbox.Items(MostRecentVersionIndex).body, InStr(position, Inbox.Items(MostRecentVersionIndex).body, \"SCA\"), InStr(InStr(position, Inbox.Items(MostRecentVersionIndex).body, \"SCA\") + 1, Inbox.Items(MostRecentVersionIndex).body, \"SCA\") - InStr(position, Inbox.Items(MostRecentVersionIndex).body, \"SCA\"))\n            CellRow = CellRow + 1\n            position = InStr(InStr(position, Inbox.Items(MostRecentVersionIndex).body, \"SCA\") + 1, Inbox.Items(MostRecentVersionIndex).body, \"SCA\") - 1\n        Next position \n</code></pre>\n\n<ol>\n<li>The first part of the code was to find a specific email in Outlook and then I stored its index in <code>MostRecentVersionIndex</code>. (NOT shown above)</li>\n<li>This email has a massive amount of records in its body (about 0.5 million characters) and the second part of my code (shown above) consists in putting each single record in a new row of column A from Sheet 1 . I know that each record starts with \"SCA\" that's why I used it as a split parameter.</li>\n</ol>\n\n<p>Issue : It takes (unsurprisingly) about 10 minutes to run the whole thing.</p>\n\n<p>Any idea on how to reduce this ?</p>\n\n<p>EDIT : Here is FYI the whole code (AFTER THE UPDATE WITH THE SOLUTION) :</p>\n\n<pre><code>Sub MailFinder()\n'1)Finding the most recent mail from Mr. Spoke\n    Dim Inbox As folder\n    Dim i As Integer\n    Dim MostRecentVersionIndex As Integer\n    MostRecentVersionIndex = -1\n    Dim TimeReceived As Date\n    Dim Content As String\n    Set Inbox = Session.GetDefaultFolder(olFolderInbox)\n\n    For i = 1 To Inbox.Items.Count\n\n            If TypeName(Inbox.Items(i)) &lt;&gt; \"ReportItem\" Then ' to avoid errors because we can't access information from this type of file\n                If Left(Inbox.Items(i).Subject, 24) = \"Mr. Spoke Subject\" Then 'And Inbox.Items(i).SenderName = \"Mr.Spoke\" Then\n                      'MsgBox Len(Inbox.Items(i).body) '584512\n                      If Inbox.Items(i).ReceivedTime &gt; TimeReceived Then\n                            TimeReceived = Inbox.Items(i).ReceivedTime\n                            MostRecentVersionIndex = i\n                      End If\n                      'ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1\") = Inbox.Items(i).body ' only get 32000 characters\n\n                End If\n            End If\n    Next i\n\n'2)Retrieving its information and storing each line in a new row from column A\n    Dim position As Long\n    Dim CellRow As Long\n    Dim RightMail As MailItem\n    Set RightMail = Inbox.Items(MostRecentVersionIndex)\n    Dim body As String\n    body = RightMail.body\n    CellRow = 2\n    If MostRecentVersionIndex &lt;&gt; -1 Then\n        ThisWorkbook.Sheets(\"SpokeSubject\").Range(\"A1\") = Left(body, InStr(body, \"Name\") + 3)\n\n        For position = InStr(body, \"Name\") To Len(body)\n            On Error GoTo Fin\n            ThisWorkbook.Sheets(\"SpokeSubject\").Range(\"A\" &amp; CellRow) = Mid(body, InStr(position, body, \"SCA\"), InStr(InStr(position, body, \"SCA\") + 1, body, \"SCA\") - InStr(position, body, \"SCA\"))\n            CellRow = CellRow + 1\n            position = InStr(InStr(position, body, \"SCA\") + 1, body, \"SCA\") - 1\n        Next position '209333\n        'Inbox.Items(i).body.Copy ' doesn't work\n        'ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1\").PasteSpecial\n        'ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1\") = Inbox.Items(MostRecentVersionIndex).body ' all in one cell...\nFin:\n    End If\n    Call Formatter\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1492013360, "post_id": 43374442, "comment_id": 73811520, "body": "The problem youre having are not fully qualified workbooks names/paths. The compiler doesnt know how to distinguish between workbooks when you provide it so little information to work with. Check this answer of mine from a few days ago - it elaborates how to work with multiple workbooks.  <a href=\"http://stackoverflow.com/questions/43287385/how-to-aggregate-compile-multiple-excel-spreasheets-csv-into-separate-sheets/43287810#43287810\" title=\"how to aggregate compile multiple excel spreasheets csv into separate sheets\">stackoverflow.com/questions/43287385/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1492013572, "creation_date": 1492013572, "answer_id": 43374670, "question_id": 43374442, "link": "https://stackoverflow.com/questions/43374442/vba-copy-paste-values-from-one-workbook-to-another/43374670#43374670", "title": "VBA Copy / paste values from one workbook to another", "body": "<p>One of your ranges starts at D1 and the other at A2 but both go to finalRow. This makes them different size ranges. I'll assume that you have actually assigned a row number to finalRow but I won't use it.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    With Workbooks(\"Classeur2\").Worksheets(\"Feuil2\")\n        With .Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp))\n            Workbooks(\"Classeur1\").Worksheets(\"Feuil1\").Range(\"D1\").Resize(.Rows.Count, .Columns.Count) = .Value\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 7787506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9eJ9l.jpg?s=128&g=1", "display_name": "Khang Huynh", "link": "https://stackoverflow.com/users/7787506/khang-huynh"}, "is_accepted": false, "score": 0, "last_activity_date": 1492018859, "creation_date": 1492018859, "answer_id": 43376220, "question_id": 43374442, "link": "https://stackoverflow.com/questions/43374442/vba-copy-paste-values-from-one-workbook-to-another/43376220#43376220", "title": "VBA Copy / paste values from one workbook to another", "body": "<p>You can try to define the name for your table by selecting the range, and Insert -> Tables -> Table. Let's say the name is \"Table1\"</p>\n\n<pre><code>Option Explicit\n\nSub CopyTable()\n'Select the defined Table1 from classeur1 workbook and copy it to classeur2 starting at cell D1\n\nWorkbooks(\"classeur1\").Worksheets(\"Sheet1\").Range(\"Table1[#All]\").Copy _ \n    Workbooks(\"classeur2\").Worksheets(\"Sheet1\").Range(\"D1\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7673903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6778beedd7075bf7cac87919490e2e86?s=128&d=identicon&r=PG&f=1", "display_name": "Hachem Boubaker", "link": "https://stackoverflow.com/users/7673903/hachem-boubaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492018859, "creation_date": 1492012858, "last_edit_date": 1492014466, "question_id": 43374442, "link": "https://stackoverflow.com/questions/43374442/vba-copy-paste-values-from-one-workbook-to-another", "title": "VBA Copy / paste values from one workbook to another", "body": "<p>I have two workbooks the first one is called classeur1 and the second is called classeur2.</p>\n\n<p>I cannot copy / paste merged rows from a table from Sheet1 (from Workbook1) to Sheet2 (from Workbook2).</p>\n\n<p>I would like to know how to do it.</p>\n\n<p>In fact I tried but no result. Here is my code:</p>\n\n<pre><code>Sub test()\n    Dim finalrow As Long\n    Workbooks(\"workbook1\").Worksheets(\"sheet1\").Range(\"D1:D\" &amp; finalrow).Value = Workbooks(\"workbook2\").Worksheets(\"sheet2\").Range(\"A2:A\" &amp; finalrow).Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1492012139, "post_id": 43374142, "comment_id": 73810694, "body": "<code>application.worksheetfunction.match(&quot;plan_tamarard&quot;,workshee&zwnj;&#8203;ts(&quot;name&quot;).range(&quot;a1&zwnj;&#8203;:z1&quot;),false)</code> get&#39;s the column  and use <code>resize</code> to set the length of the data."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "edited": false, "score": 0, "creation_date": 1492188513, "post_id": 43374601, "comment_id": 73890189, "body": "This is great.  Is there some way that I could change the code from a Application.countif, to something like worksheet(&quot;x&quot;).countif?  I&#39;m going to be running the Macro from another workbook, and copying the rng from this workbook, to that other."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "edited": false, "score": 0, "creation_date": 1492189576, "post_id": 43374601, "comment_id": 73890735, "body": "You just need to qualify the range inside the CountIf with the sheet where you want to search the string plan_tamaward*. So in this case it should be If Application.CountIf(Worksheets(&quot;X&quot;).Rows(1), &quot;plan_tamaward*&quot;) &gt; 0 and same way you will need to change the lookup range in the Match function also."}, {"owner": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "edited": false, "score": 0, "creation_date": 1492195337, "post_id": 43374601, "comment_id": 73893715, "body": "Thank you that fixed it!  Now I just have the last step of setting the values of the range that i&#39;m copying = to the ranges I&#39;ve set  this is the code that I have, but when I run it, it copies the data from working sheet.  wbmodel.Sheets(&quot;Copyto&quot;).Range(&quot;F4&quot;).Resize(Rngm.Rows.Count)&zwnj;&#8203;.Value = Rngm.Value     wbmodel.Sheets(&quot;Copyto&quot;).Range(&quot;E4&quot;).Resize(RngSku.Rows.Coun&zwnj;&#8203;t, 1).Value = RngSku.Value     wbmodel.Sheets(&quot;Copyto&quot;).Range(&quot;C4&quot;).Resize(RngPO.Rows.Count&zwnj;&#8203;).Value = RngPO.Value End Sub"}, {"owner": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "edited": false, "score": 0, "creation_date": 1492195718, "post_id": 43374601, "comment_id": 73893895, "body": "Thank you that fixed it!  Now I just have the last step of setting the values of the new range = rng (I changed the variable to be rngm,rngsku,rngpo)  this is the code that I have, but when I run it, it copies the data from &quot;copyto&quot; .  it&#39;s like the variables are overwritten, but when I check the address, they are correct.  wbmodel.Sheets(&quot;Copyto&quot;).Range(&quot;F4&quot;).Resize(Rngm.Rows.Count)&zwnj;&#8203;.Value = Rngm.Value     wbmodel.Sheets(&quot;Copyto&quot;).Range(&quot;E4&quot;).Resize(RngSku.Rows.Coun&zwnj;&#8203;t, 1).Value = RngSku.Value     wbmodel.Sheets(&quot;Copyto&quot;).Range(&quot;C4&quot;).Resize(RngPO.Rows.Count&zwnj;&#8203;).Value = RngPO.Value End Sub"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "edited": false, "score": 0, "creation_date": 1492197754, "post_id": 43374601, "comment_id": 73894840, "body": "Please open a new question. :)"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1492013308, "creation_date": 1492013308, "answer_id": 43374601, "question_id": 43374142, "link": "https://stackoverflow.com/questions/43374142/vba-code-to-search-for-a-row-header-and-select-the-entire-range-beneath-that-he/43374601#43374601", "title": "VBA code to search for a row header, and select the entire range beneath that header", "body": "<p>You can incorporate the following approach into your code...</p>\n\n<pre><code>Dim Col As Long, LastRow As Long\nDim Rng As Range\nIf Application.CountIf(Rows(1), \"plan_tamaward*\") &gt; 0 Then\n    Col = Application.Match(\"plan_tamaward*\", Rows(1), 0)\n    LastRow = Cells(Rows.Count, Col).End(xlUp).Row\n    Set Rng = Range(Cells(2, Col), Cells(LastRow, Col))\nEnd If\nIf Not Rng Is Nothing Then\n    MsgBox Rng.Address\n    'do whatever you want to do with this range here\nElse\n    MsgBox \"The column named like plan_tamaward* was not found in Row1.\", vbExclamation, \"Column Not Found!\"\n    Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7857518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7417ddb750bbc3a750f3972f1b7849ac?s=128&d=identicon&r=PG&f=1", "display_name": "VBArookie", "link": "https://stackoverflow.com/users/7857518/vbarookie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1660, "favorite_count": 0, "accepted_answer_id": 43374601, "answer_count": 1, "score": 0, "last_activity_date": 1492013308, "creation_date": 1492011909, "last_edit_date": 1492012026, "question_id": 43374142, "link": "https://stackoverflow.com/questions/43374142/vba-code-to-search-for-a-row-header-and-select-the-entire-range-beneath-that-he", "title": "VBA code to search for a row header, and select the entire range beneath that header", "body": "<p>I'm VERY new to VBA and i'm trying to automate some of my day to day tasks.  One task that I would like to automate requires me to \"search\" for a specified header, and select that entire column of data.  I will then paste that range into a different spreadsheet.  </p>\n\n<p><code>Tamcolumn = Cells.Find(what:=\"plan_tamaward\", after:=\"a1\", searchdirection:=xlPrevious, searchorder:=xlBycolumn, lookat:=xlPart).Column</code></p>\n\n<p>I've found this little bit of code to be helpful when i'm defining an entire column, the problem is I can't define the column header and define the range below without \"selecting\" the data - which I know is a big no-no.  </p>\n\n<p>I hope this makes sense.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "excel-formula", "countif", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 2, "last_activity_date": 1492012147, "creation_date": 1492012147, "answer_id": 43374207, "question_id": 43374008, "link": "https://stackoverflow.com/questions/43374008/excel-counts-the-number-of-times-a-value-appears-in-a-group-of-columns-but-count/43374207#43374207", "title": "Excel counts the number of times a value appears in a group of columns but counts only one instance of the name per row", "body": "<p>A non-vba solution with a helper column in column  F.</p>\n\n<p>Column F formula  <code>=IF(COUNTIF(B1:E1,$I$1)&gt;0,1,0)</code></p>\n\n<p>J2 formula <code>=SUM(F1:F4)</code></p>\n\n<p>change I1 as needed for name.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JYP3m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JYP3m.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "edited": false, "score": 0, "creation_date": 1492013841, "post_id": 43374259, "comment_id": 73811796, "body": "Thanks to everyone who answered. I only tried this answer so far and it is working perfectly."}], "tags": [], "owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "is_accepted": false, "score": 4, "last_activity_date": 1492012327, "creation_date": 1492012327, "answer_id": 43374259, "question_id": 43374008, "link": "https://stackoverflow.com/questions/43374008/excel-counts-the-number-of-times-a-value-appears-in-a-group-of-columns-but-count/43374259#43374259", "title": "Excel counts the number of times a value appears in a group of columns but counts only one instance of the name per row", "body": "<p>Assuming you put your name of choice, e.g. \"Ted\", in <code>G1</code>, <strong>array formula**</strong>:</p>\n\n<p><code>=SUM(0+(MMULT(0+(A1:E4=G1),TRANSPOSE(COLUMN(A1:E4)))>0))</code></p>\n\n<p>Regards</p>\n\n<p><em>**Array formulas are not entered in the same way as 'standard' formulas. Instead of pressing just ENTER, you first hold down CTRL and SHIFT, and only then press ENTER. If you've done it correctly, you'll notice Excel puts curly brackets {} around the formula (though do not attempt to manually insert these yourself).</em></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 7, "last_activity_date": 1492012959, "creation_date": 1492012959, "answer_id": 43374475, "question_id": 43374008, "link": "https://stackoverflow.com/questions/43374008/excel-counts-the-number-of-times-a-value-appears-in-a-group-of-columns-but-count/43374475#43374475", "title": "Excel counts the number of times a value appears in a group of columns but counts only one instance of the name per row", "body": "<p>Use OFFSET with SUMPRODUCT. In F7 (per supplied image) as,</p>\n\n<pre><code>=SUMPRODUCT(SIGN(COUNTIF(OFFSET(B$1:E$1, ROW($1:$4)-1, 0), E7)))\n</code></pre>\n\n<p>The SIGN function turns any positive number to 1 for each row. <code>ROW(1:4)</code> cycles through each of the rows.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LDb1X.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/LDb1X.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 551, "user_id": 7857145, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10212706971968075/picture?type=large", "display_name": "Jim Bray", "link": "https://stackoverflow.com/users/7857145/jim-bray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1105, "favorite_count": 1, "accepted_answer_id": 43374475, "answer_count": 3, "score": 2, "last_activity_date": 1492034537, "creation_date": 1492011533, "last_edit_date": 1531161705, "question_id": 43374008, "link": "https://stackoverflow.com/questions/43374008/excel-counts-the-number-of-times-a-value-appears-in-a-group-of-columns-but-count", "title": "Excel counts the number of times a value appears in a group of columns but counts only one instance of the name per row", "body": "<p>I need to find the number of times a name appears on this list but I only want to count one instance of the name one time for each row without counting the duplicate name in the row. </p>\n\n<p>For instance: I have the following in a range...</p>\n\n<pre><code>Red     Bill    Jack    Ruby    Bill\nBlue    Ruby    Ivan    Raul    Ted\nGreen   Ted     James   Rick    Ted\nRed     Ted     Phil    Ruby    Bill\n</code></pre>\n\n<p>And in this worksheet, I want to count the number of instances of the name Bill and get the answer of 2 because Bill's name shows up in two rows. In the same respect, If I choose to count the name Ted, the answer should be 3 because Ted's name shows up in three rows.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1492010825, "post_id": 43373580, "comment_id": 73809717, "body": "Are you looking for <code>Target.Parent</code>? If you are using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx\" rel=\"nofollow noreferrer\">Worksheet Change Event</a> the you get <code>Target</code> along with it. Target is the cell (or the cells) which got changed on that sheet. The parent of that cell is the sheet on which the cell is hosted. So, <code>Target.Parent.Name</code> will give you the name of the sheet on which the cell is hosted. Is that what you want?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1492010840, "post_id": 43373580, "comment_id": 73809726, "body": "When you place your code in the code-module of a worksheet it systematically references this worksheet. <code>Me</code> is the keyword to specify that <i>&quot;I am referring to the WS holding this piece of code&quot;</i>. Me.range(...)<code>, </code>With Me` etc..?"}, {"owner": {"reputation": 91, "user_id": 5865063, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/29e6a11d3936b0932b6ea80dd157f633?s=128&d=identicon&r=PG&f=1", "display_name": "Dan S", "link": "https://stackoverflow.com/users/5865063/dan-s"}, "edited": false, "score": 0, "creation_date": 1492012521, "post_id": 43373580, "comment_id": 73810954, "body": "Both great thanks. I&#39;ve gone with Me for simplicity. Thanks again"}], "owner": {"reputation": 91, "user_id": 5865063, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/29e6a11d3936b0932b6ea80dd157f633?s=128&d=identicon&r=PG&f=1", "display_name": "Dan S", "link": "https://stackoverflow.com/users/5865063/dan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492010694, "creation_date": 1492010283, "last_edit_date": 1492010694, "question_id": 43373580, "link": "https://stackoverflow.com/questions/43373580/specify-sheet-in-private-sub-calculate", "title": "Specify sheet in private sub calculate", "body": "<p>I have a bunch of sheets all duplicated from a master, each with a copy of some worksheet calculate code in the private sub for each sheet. \nHowever the code needs to reference the sheet it is in - therefore it cannot just be copied from the master.</p>\n\n<p>I have placed the sheet code number on each sheet when it is created in cell B2.</p>\n\n<p>My question is - how do I specify the sheet individually for 'with sheets(thissheet)'? I have tried pointing it at cell B2 but because it does not yet know which B2 it throws an error. </p>\n\n<p>Is there a way to tell a private sub to use the sheet it is in as 'with..'?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 658, "user_id": 2843172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c8ae2f7e942c1deea7da8b4a6a8e254?s=128&d=identicon&r=PG&f=1", "display_name": "Clouse24", "link": "https://stackoverflow.com/users/2843172/clouse24"}, "is_accepted": false, "score": 0, "last_activity_date": 1492012140, "creation_date": 1492012140, "answer_id": 43374206, "question_id": 43373237, "link": "https://stackoverflow.com/questions/43373237/group-columns-but-not-protect-them-and-password-protect-one-of-the-group-column/43374206#43374206", "title": "Group columns but not protect them and password protect one of the group column", "body": "<p>you can add a piece of code to run at beginning and end of your routine.  This will un-protect the sheet, run your code, then protect it again.</p>\n\n<p>Begin:</p>\n\n<pre><code>Dim mypassword As String\n\nmypassword = \"yourPassword\"\n\nActiveSheet.Unprotect Password:=mypassword\n</code></pre>\n\n<p>End:</p>\n\n<pre><code>ActiveSheet.Protect Password:=mypassword\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 2786962, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/35eebd5677da1d47524a988945763279?s=128&d=identicon&r=PG&f=1", "display_name": "user2786962", "link": "https://stackoverflow.com/users/2786962/user2786962"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492012140, "creation_date": 1492009401, "question_id": 43373237, "link": "https://stackoverflow.com/questions/43373237/group-columns-but-not-protect-them-and-password-protect-one-of-the-group-column", "title": "Group columns but not protect them and password protect one of the group column", "body": "<p>I Have 3 columns a,b,c which I want to group and show as grouped( collapsed section). Column B is locked and when I try to ungroup a,b,c columns it asks me password. I dont want it to ask the password as only column B is password protected not the grouping ungrouping action.</p>\n\n<p>How can I solve this problem in excel/vba</p>\n"}, {"tags": ["html", "angularjs", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7857089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d55405c5079eb9c1088d99b0ea91?s=128&d=identicon&r=PG&f=1", "display_name": "hdan7", "link": "https://stackoverflow.com/users/7857089/hdan7"}, "edited": false, "score": 0, "creation_date": 1492025961, "post_id": 43373705, "comment_id": 73818492, "body": "Hi Ryguy..Thanks is very interesting because with this macro I get All data of page. But it&#39;s posible select specific tags or ID&#39;S for delimited the information of the column D?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 1, "user_id": 7857089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d55405c5079eb9c1088d99b0ea91?s=128&d=identicon&r=PG&f=1", "display_name": "hdan7", "link": "https://stackoverflow.com/users/7857089/hdan7"}, "edited": false, "score": 0, "creation_date": 1492026759, "post_id": 43373705, "comment_id": 73818990, "body": "I&#39;m not sure what you mean.  Can you post an example.  Also, know that you can test the contents of itm.innertext with an IF...THEN statement."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1492010613, "creation_date": 1492010613, "answer_id": 43373705, "question_id": 43373215, "link": "https://stackoverflow.com/questions/43373215/get-data-from-internet-explorer-to-excel/43373705#43373705", "title": "Get data from Internet explorer to excel", "body": "<p>Well, I don't see where you posted the actual URL, so all I can do is make a generic recommendation, but I can't actually test the script for you.</p>\n\n<pre><code>Sub DumpData()\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\n\nURL = \"http://finance.yahoo.com/q?s=sbux&amp;ql=1\"\n\n'Wait for site to fully load\nIE.Navigate2 URL\nDo While IE.Busy = True\n   DoEvents\nLoop\n\nRowCount = 1\n\nWith Sheets(\"Sheet1\")\n   .Cells.ClearContents\n   RowCount = 1\n   For Each itm In IE.document.all\n      .Range(\"A\" &amp; RowCount) = itm.tagname\n      .Range(\"B\" &amp; RowCount) = itm.ID\n      .Range(\"C\" &amp; RowCount) = itm.classname\n      .Range(\"D\" &amp; RowCount) = Left(itm.innertext, 1024)\n\n      RowCount = RowCount + 1\n   Next itm\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Thanks for the script Joel!!  Based on the results of what you get, can you make the appropriate changes to get the data from the table you are working with?</p>\n"}], "owner": {"reputation": 1, "user_id": 7857089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb23d55405c5079eb9c1088d99b0ea91?s=128&d=identicon&r=PG&f=1", "display_name": "hdan7", "link": "https://stackoverflow.com/users/7857089/hdan7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492439016, "creation_date": 1492009343, "question_id": 43373215, "link": "https://stackoverflow.com/questions/43373215/get-data-from-internet-explorer-to-excel", "title": "Get data from Internet explorer to excel", "body": "<p>I'm developing a macro to get data from a Internet Explorer Table and load in a sheet in Excel.</p>\n\n<p>With this code I can get the titles of the table but i can't get the content </p>\n\n<pre><code>    Sub extraerDatos()\n\n    Dim URL As String\n    Dim IE As InternetExplorer\n    Dim HTMLdoc As HTMLDocument\n    Dim TDelements As IHTMLElementCollection\n    Dim TDelement As HTMLTableCell\n    Dim oElement As Object\n    Dim r As Long\n\n\n    URL = \"URL\"\n\n    Set IE = New InternetExplorer\n\n    With IE\n        .Navigate URL\n        .Visible = True\n\n        'Cargar pagina\n        While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n\n        Set HTMLdoc = .Document\n    End With\n  Application.Wait (Now + TimeValue(\"0:00:10\"))\n\nSet dados = HTMLdoc.getElementsByClassName(\"tableContainer\")\n (0).getElementsByTagName(\"span\")\n    I = 0\n For Each oElement In dados\n    Sheets(\"Hoja1\").Range(\"A\" &amp; I + 1) = dados(I).innerText\n    I = I + 1\n Next oElement\nEnd Sub\n</code></pre>\n\n<p>This is part of the HTML code of the page</p>\n\n<pre><code>&lt;div class=\"tableContainer\"  &gt;\n        &lt;div class=\"tlnTable tlnw12\" id=\"tlnAngTableTransfers\" style=\"display:none\" &gt;\n            &lt;span style=\"margin:0; padding-bottom: 10px;\" class=\"field-validation-error ng-binding\" ng-show=\"model.bTransferRequired\"&gt;Select at least one transfer&lt;/span&gt;\n            &lt;div class=\"tlnHeader tlnw12\"&gt; &lt;!-- HEADER --&gt;\n                &lt;div class=\"tlnw3\"&gt;\n                    &lt;div class=\"tlnw1 tlntd\"&gt;\n                        &lt;input type=\"checkbox\" ng-model=\"model.grid.selected\" ng-change=\"model.grid.selectAll()\"/&gt; \n                    &lt;/div&gt;\n                    &lt;div class=\"tlnw6 tlntd\"&gt;\n                        &lt;a href=\"#\" class=\"tlnSortLink tlnw12\" ng-click=\"model.grid.sortableColumns.columns.transferId.changeSort()\"&gt;\n                            &lt;span class=\"tlnw10\"&gt;Transfer ID / PO-SO Number &lt;/span&gt;\n                            &lt;span class=\"tlnSortIco tlnw2\" ng-show=\"model.grid.sortableColumns.lastSortedColumn.id === model.grid.sortableColumns.columns.transferId.id\" &gt;\n                                &lt;span class=\"tlnSortAsc tlnw12 \" ng-class=\"{act: model.grid.sortableColumns.lastSortedColumn.modifier==='asc', inact: model.grid.sortableColumns.lastSortedColumn.modifier==='desc'}\" &gt;&lt;/span&gt;\n                                &lt;span class=\"tlnSortDesc inact tlnw12\" ng-class=\"{act: model.grid.sortableColumns.lastSortedColumn.modifier==='desc', inact: model.grid.sortableColumns.lastSortedColumn.modifier==='asc'}\"&gt;&lt;/span&gt;\n                            &lt;/span&gt;\n                        &lt;/a&gt;\n                    &lt;/div&gt;\n</code></pre>\n\n<p>I Understand that the NG tags are the content of the table but I don't know how get it, for my spreadsheet..</p>\n\n<p>Thanks for the help</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 163, "user_id": 2449724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/cz5jw.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/2449724/felipe"}, "edited": false, "score": 3, "creation_date": 1492009517, "post_id": 43373199, "comment_id": 73808639, "body": "Dear POLOS, you should describe what you want in more details. Please, provide the code you have already developed, so we can analyze and try to help you."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1492009529, "post_id": 43373199, "comment_id": 73808646, "body": "Why not just use conditional formatting to highlight the cell(s) yellow when they are empty?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1492009749, "post_id": 43373299, "comment_id": 73808836, "body": "@Doug Coats  sorry i&#39;m doing my best here  i&#39;m working for a company that everyday want something from me , so I&#39;m looking for quick answers"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1492009852, "post_id": 43373299, "comment_id": 73808935, "body": "LOL naw let him have at it. Besides my posts are full SO material unless I give @Mat&#39;sMug something to do :D"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 2, "creation_date": 1492009934, "post_id": 43373299, "comment_id": 73808999, "body": "@POLOSTutorials well dude hate to tell you that Im likely the only person here who will even entertain basic hand holding, and even I have my limits. Look at the tutorials i pointed you to, it should help significantly"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 2, "last_activity_date": 1492009573, "creation_date": 1492009573, "answer_id": 43373299, "question_id": 43373199, "link": "https://stackoverflow.com/questions/43373199/display-message-for-user-vba-excel/43373299#43373299", "title": "Display message for user VBA excel", "body": "<p>UGH you didnt even bother trying the bare minimum did you?</p>\n\n<p>You know you learn ALL of this stuff in the first few pages of EVERY tutorial right?</p>\n\n<p>I guess ill help though</p>\n\n<pre><code> If ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1\").Value = \"\" Then\n      MsgBox(\"You Cannot leave this cell empty\")\nEnd if\n</code></pre>\n\n<p>Here are some good tutorials. Please do the bare minimum of self teaching and make sure to come to Stack Overflow with <em>specific</em> coding questions.</p>\n\n<p><a href=\"https://www.tutorialspoint.com/vba/\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/vba/</a></p>\n\n<p><a href=\"http://www.excelfunctions.net/Excel-VBA-Tutorial.html\" rel=\"nofollow noreferrer\">http://www.excelfunctions.net/Excel-VBA-Tutorial.html</a></p>\n\n<p><a href=\"http://www.excel-easy.com/vba.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/vba.html</a></p>\n\n<p>This took me less time to find than your post prolly took to write out, just saying. </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1492013088, "post_id": 43373895, "comment_id": 73811337, "body": ",@Doug It shows Do not Leave everytime  but it doesn&#39;t  show where should I fill What I want to exactly   ( I got a table with information to be fill by the user and he should fill every single case ) so I need to  display a message for him when he forgot to fill something"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1492013401, "post_id": 43373895, "comment_id": 73811542, "body": "It is selecting  a filled Case :&#39;(      code Private Sub Worksheet_Deactivate()      If Trim(Cells(1, 460)) = &quot;&quot; Then          MsgBox &quot;Do not leave&quot;         Sheets(&quot;Feuil1&quot;).Select         Cells(1, 460).Select      End If  End Sub"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1492014536, "post_id": 43373895, "comment_id": 73812240, "body": "If it is like this (<a href=\"https://pastebin.com/TQ7KdAFQ\" rel=\"nofollow noreferrer\">pastebin.com/TQ7KdAFQ</a>) , and you have put the code in the correct Sheet in the VBE, this should not be the case. Cells(1,460) is <code>QR1</code>. Are you sure you need <code>QR1</code> and not <code>A460</code>?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1492013148, "last_edit_date": 1492013148, "creation_date": 1492011201, "answer_id": 43373895, "question_id": 43373199, "link": "https://stackoverflow.com/questions/43373199/display-message-for-user-vba-excel/43373895#43373895", "title": "Display message for user VBA excel", "body": "<p>Here you go with another idea:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Deactivate()\n\n    If Trim(Cells(1, 1)) = \"\" Then\n\n        MsgBox \"Do not leave\"\n        Sheets(1).Select\n        Cells(1, 1).Select\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>If you put this code in the worksheet, not in a module, it would work. \nMake sure, that you put it on the first Workbook, not in a module. E.g., here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rx3vy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rx3vy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Depending on what exactly you are doing, you can also put similar procedure in a Worksheet (ThisWorkbook on the picture above) and use the <code>Workbook_BeforeClose</code> event, to disallow users to leave.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1492014367, "creation_date": 1492009305, "last_edit_date": 1492014367, "question_id": 43373199, "link": "https://stackoverflow.com/questions/43373199/display-message-for-user-vba-excel", "title": "Display message for user VBA excel", "body": "<p>I'm new in VBA , I'm trying  to make a macro that show a message to the user when he forgot to fill a case.\nall comments are welcome , </p>\n"}, {"tags": ["excel", "vba", "csv", "crash", "save"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492007382, "post_id": 43371915, "comment_id": 73806786, "body": "what exactly are you trying to do ? is it to save <code>Sheets(&quot;input11&quot;)</code> as <code>CSV</code> file format ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1492007644, "post_id": 43371915, "comment_id": 73807019, "body": "What is the error you&#39;re getting? Which instruction causes it? Your question is incomplete, please <a href=\"https://stackoverflow.com/posts/43371915/edit\">edit</a> - wait no, there&#39;s no error, is there? So the code works but it&#39;s just slow? Can you please clarify your post?"}, {"owner": {"reputation": 1, "user_id": 7856935, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcdH68P-xLE/AAAAAAAAAAI/AAAAAAAABKk/PTrwJmsCbmA/photo.jpg?sz=128", "display_name": "Diego Bauza", "link": "https://stackoverflow.com/users/7856935/diego-bauza"}, "edited": false, "score": 0, "creation_date": 1492097757, "post_id": 43371915, "comment_id": 73853742, "body": "Ok. I have an excel and I want to save as CSV format the sheet (&quot;input11&quot;). And I ran the code for first time with no problem and the  CSV created replaced the existing one. And when I ran it a second time, excel crashed: &quot;Microsoft excel has stopping working&quot;. It happened when I saved the new CSV file replacing the old file."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492057967, "post_id": 43372612, "comment_id": 73828858, "body": "@Diego Bauza  have you tried the code above ? is it working as you intended ?"}, {"owner": {"reputation": 1, "user_id": 7856935, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcdH68P-xLE/AAAAAAAAAAI/AAAAAAAABKk/PTrwJmsCbmA/photo.jpg?sz=128", "display_name": "Diego Bauza", "link": "https://stackoverflow.com/users/7856935/diego-bauza"}, "edited": false, "score": 0, "creation_date": 1492099347, "post_id": 43372612, "comment_id": 73854692, "body": "Thanks for answer. It is not working as I intended. It replace the name of the sheet &quot;input11&quot; to &quot;os&quot; and save the entire original file in CSV format with the name &quot;os&quot;."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1492007695, "creation_date": 1492007695, "answer_id": 43372612, "question_id": 43371915, "link": "https://stackoverflow.com/questions/43371915/excel-crashes-when-saved-as-csv-file-a-second-time/43372612#43372612", "title": "Excel crashes when saved as CSV file a second time", "body": "<p>If you are trying to save <code>Sheets(\"input11\")</code> as \"CSV\" file, all you need to do is:</p>\n\n<pre><code>Option Explicit\n\nSub copiar_ayuda1()\n\nDim PathName As String\nDim Sht As Worksheet\n\nApplication.DisplayAlerts = False\n\nPathName = ThisWorkbook.Path &amp; \"\\os.csv\"\n\nSet Sht = ThisWorkbook.Worksheets(\"input11\")\nWith Sht\n    .SaveAs Filename:=PathName, _\n    FileFormat:=xlCSV, CreateBackup:=False\nEnd With\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7856935, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-HcdH68P-xLE/AAAAAAAAAAI/AAAAAAAABKk/PTrwJmsCbmA/photo.jpg?sz=128", "display_name": "Diego Bauza", "link": "https://stackoverflow.com/users/7856935/diego-bauza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1492025625, "creation_date": 1492006041, "last_edit_date": 1492025625, "question_id": 43371915, "link": "https://stackoverflow.com/questions/43371915/excel-crashes-when-saved-as-csv-file-a-second-time", "title": "Excel crashes when saved as CSV file a second time", "body": "<p>When I run the code for first time, it replaces the existing document and saves the CSV file with no problem. But when I run the code a second time, Excel crashes when save the CSV. </p>\n\n<p>I have a workaround, after running the code for first time re-opening Excel, but it takes too much time, any ideas?</p>\n\n<pre><code>Sub copiar_ayuda1()\n  Application.DisplayAlerts = False\n  With Sheets(\"input11\")\n    .Select\n    .Move\n  End With\n  PathName = \"\" &amp; ThisWorkbook.Path &amp; \"os.csv\"\n\n  ActiveWorkbook.SaveAs Filename:=PathName, FileFormat:=xlCSV, CreateBackup:=False\n\n  Application.CutCopyMode = False\n  ActiveWorkbook.Saved = True\n  ActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "listbox", "mismatch"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492007157, "post_id": 43371800, "comment_id": 73806590, "body": "Your code is implicitly working off the active sheet, which makes it more frail than it needs to be. Consider qualifying the <code>Cells</code> calls with an explicit <code>Worksheet</code> object, preferably using a <code>With</code> block."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492007269, "post_id": 43371800, "comment_id": 73806688, "body": "Either <code>Cells(j, 3)</code> or <code>Cells(i, 3)</code> contains an error value, which cannot be compared to a <code>String</code>. You need to fix the data, and then fix the code so that errors in data don&#39;t throw a <i>type mismatch</i>. Use the <code>IsError</code> function to determine whether a cell contains an error value."}], "owner": {"reputation": 1, "user_id": 7856956, "user_type": "registered", "profile_image": "https://graph.facebook.com/1338766026203191/picture?type=large", "display_name": "Fatima Zahra Zamzam", "link": "https://stackoverflow.com/users/7856956/fatima-zahra-zamzam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "closed_date": 1492007550, "answer_count": 0, "score": 0, "last_activity_date": 1492005763, "creation_date": 1492005763, "question_id": 43371800, "link": "https://stackoverflow.com/questions/43371800/type-mismatch-that-is-normally-matched", "closed_reason": "Duplicate", "title": "Type Mismatch that is normally matched", "body": "<p>I'm  working on a code in VBA that does the following operations :\n- Look for the articles that have the same product of origin in a listbox (Listbox4)\n- Add all the quantities\n- Affect it to the original product in another listbox (Listbox2)</p>\n\n<p>It was working yesterday but when I run it today it says that there is a Type Mismatch, which I don't see and It's driving me crazy. Here is the code </p>\n\n<pre><code>    For t = 0 To ListBox2.ListCount - 1\n     d\u00e9s = ListBox2.List(t, 0)\n     quantit\u00e9 = 0\n            For j = 12 To lastrow1\n              If Cells(j, 3) = d\u00e9s Then\n              codeproduit = Cells(j, 1)\n              End If\n            Next j\n              For i = 12 To lastrow1\n                If Cells(i, 1) = codeproduit And Cells(i, 1) &lt;&gt; Cells(i, 2) Then\n                For k = 0 To ListBox4.ListCount - 1\n                    If Cells(i, 3) = ListBox4.List(k, 0) Then\n                    add = ListBox4.List(k, 5)\n                    quantit\u00e9 = quantit\u00e9 + add\n                    End If\n                Next k\n        End If\n         Next i\n            ListBox2.List(t, 1) = quantit\u00e9\n       Next t\n</code></pre>\n\n<p>I believe that the \"quantit\u00e9\" and \"Listbox4.list(k,5)\" do not match, but why?</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1492005454, "creation_date": 1492005454, "answer_id": 43371669, "question_id": 43371610, "link": "https://stackoverflow.com/questions/43371610/vba-if-exists-copy-to-the-next-row-in-antoher-sheet/43371669#43371669", "title": "VBA If exists copy to the next row in antoher sheet", "body": "<p>Some of your <code>Cells</code> are not qualified with the relevant <code>Worksheet</code>, the same goes for <code>Lastrow</code>.</p>\n\n<p>You may try something like the code below:</p>\n\n<pre><code>Option Explicit\n\nSub copy_to_report()\n\nDim i As Long\nDim Lastrow As Long\nDim ShtReport As Worksheet\n\nSet ShtReport = Worksheets(\"report\")\n\nWith Worksheets(\"Sheet1\")\n    For i = 2 To 500\n        If .Cells(i, 24) &lt;&gt; \"\" And .Cells(i, 25) &lt;&gt; \"\" Then\n            'Lastrow = ShtReport.Cells(ShtReport.Rows.Count, 1).End(xlUp).Row\n            ' maybe it's better to check for last row in Column \"C\"\n            Lastrow = ShtReport.Cells(ShtReport.Rows.Count, \"C\").End(xlUp).Row\n            ShtReport.Cells(Lastrow, 3) = .Cells(i, 24)\n            ShtReport.Cells(Lastrow, 4) = .Cells(i, 25)\n        End If\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7856944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d0d74da9ce2312e9a9a052218f6b96?s=128&d=identicon&r=PG&f=1", "display_name": "Crowell", "link": "https://stackoverflow.com/users/7856944/crowell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 43371669, "answer_count": 1, "score": 0, "last_activity_date": 1492005454, "creation_date": 1492005275, "question_id": 43371610, "link": "https://stackoverflow.com/questions/43371610/vba-if-exists-copy-to-the-next-row-in-antoher-sheet", "title": "VBA If exists copy to the next row in antoher sheet", "body": "<p>I'm trying to sort in another sheet values that I have received and I wrote:</p>\n\n<pre><code>Sub copy_to_report()\n\nDim i As Integer\nDim Lastrow As Long\n\nFor i = 2 To 500\n    If Sheets(\"Sheet1\").Cells(i, 24) &lt;&gt; \"\" &amp; Sheets(\"Sheet1\").Cells(i, 25) &lt;&gt; \"\" Then\n        Lastrow = Sheets(\"report\").Cells(Rows.Count, 1).End(xlUp).Row\n        Sheets(\"report\").Cells(Lastrow, 3) = Cells(i, 24)\n        Sheets(\"report\").Cells(Lastrow, 4) = Cells(i, 25)\n    End If\nNext     \nEnd Sub\n</code></pre>\n\n<p>However it doesn't work. I'd like to check if in a row there is something in 25 and 24 and if yes, copy it from sheet1 to my \"report\"sheet. Could you please help me? :)</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7680396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4da43059f664c1a4a8341e79ee53aff?s=128&d=identicon&r=PG&f=1", "display_name": "pycoder", "link": "https://stackoverflow.com/users/7680396/pycoder"}, "edited": false, "score": 0, "creation_date": 1492007430, "post_id": 43372334, "comment_id": 73806829, "body": "Thank you ! This works great. But now I actually am just curious how to execute the same thing in VBA. Can you help me with that ?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 5, "user_id": 7680396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4da43059f664c1a4a8341e79ee53aff?s=128&d=identicon&r=PG&f=1", "display_name": "pycoder", "link": "https://stackoverflow.com/users/7680396/pycoder"}, "edited": false, "score": 0, "creation_date": 1492008557, "post_id": 43372334, "comment_id": 73807816, "body": "Have added three examples of running the query through VBA."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1492008525, "last_edit_date": 1492008525, "creation_date": 1492007002, "answer_id": 43372334, "question_id": 43371576, "link": "https://stackoverflow.com/questions/43371576/unmatched-query-written-in-visual-basic/43372334#43372334", "title": "Unmatched query written in visual basic", "body": "<p>No VBA needed.<br>\nUse the Query Wizard and \"Find Unmatched Query Wizard\", then just add <code>INSERT INTO ([field name])</code> at the top.</p>\n\n<p>For example, I have Table1.[Column 1] containing some letters of the alphabet, I then have Table2.Column2 containing all letters of the alphabet.<br>\n<strong>NB:</strong>  Square brackets around [Column 1] as it has a space in it.  </p>\n\n<p>The wizard will give me:  </p>\n\n<pre><code>SELECT Table2.Column2\nFROM Table2 LEFT JOIN Table1 ON Table2.[Column2] = Table1.[Column 1]\nWHERE (((Table1.[Column 1]) Is Null));  \n</code></pre>\n\n<p>bit of tidying up in Notepad++ and I have:  </p>\n\n<pre><code>SELECT  Column2\nFROM    Table2 LEFT JOIN Table1 ON Table2.[Column2] = Table1.[Column 1]\nWHERE   [Column 1] Is Null\n</code></pre>\n\n<p><strong>NB</strong>: I've removed the table names from the <code>SELECT</code> and <code>WHERE</code> clauses as <code>Column2</code> is unique to <code>Table2</code> and <code>Column 1</code> is unique to <code>Table1</code>.  You only have to name use the table names if the column name appears in more than one table.  </p>\n\n<p>Finally, I just add the INSERT statement:  </p>\n\n<pre><code>INSERT INTO Table1([Column 1])\nSELECT  Column2\nFROM    Table2 LEFT JOIN Table1 ON Table2.[Column2] = Table1.[Column 1]\nWHERE   [Column 1] Is Null\n</code></pre>\n\n<p><strong>Final NB:</strong>  The LEFT JOIN signifies that all values are returned from Table2 (as it's on the left of the join) and only those values that match the join criteria are returned from Table1 (on the right of the join) - turn LEFT JOIN to RIGHT JOIN to reverse this (or put the tables the other way around).  The WHERE clause then removes the values that appear in both tables.</p>\n\n<p>To use in code any of these will do it:  </p>\n\n<pre><code>Sub Test()\n\n    With DoCmd\n        .SetWarnings False\n        .OpenQuery \"Query3\"\n        .SetWarnings True\n    End With\n\nEnd Sub  \n</code></pre>\n\n<hr>\n\n<pre><code>Sub Test1()\n\n    Dim db As DAO.Database\n    Set db = CurrentDb\n\n    db.Execute \"INSERT INTO Table1 ( [Column 1] ) \" &amp; _\n                      \"SELECT Column2 \" &amp; _\n                      \"FROM Table2 LEFT JOIN Table1 ON Table2.[Column2] = Table1.[Column 1] \" &amp; _\n                      \"WHERE [Column 1] Is Null\"\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Test2()\n\n    Dim qdf As DAO.QueryDef\n\n    Set qdf = CurrentDb.CreateQueryDef(\"\", \"INSERT INTO Table1 ( [Column 1] ) \" &amp; _\n                                           \"SELECT Column2 \" &amp; _\n                                           \"FROM Table2 LEFT JOIN Table1 ON Table2.[Column2] = Table1.[Column 1] \" &amp; _\n                                           \"WHERE [Column 1] Is Null\")\n    qdf.Execute dbFailOnError\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7680396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4da43059f664c1a4a8341e79ee53aff?s=128&d=identicon&r=PG&f=1", "display_name": "pycoder", "link": "https://stackoverflow.com/users/7680396/pycoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 43372334, "answer_count": 1, "score": 0, "last_activity_date": 1492008525, "creation_date": 1492005204, "last_edit_date": 1492005519, "question_id": 43371576, "link": "https://stackoverflow.com/questions/43371576/unmatched-query-written-in-visual-basic", "title": "Unmatched query written in visual basic", "body": "<p>I am pretty new to this stuff and am stuck on this for a while now.\nSo basically I want to write a code in VB which would take a column from one table (Table A) and compare it with some other column in a different table (Table B). Now I want the missing elements in Table A from Table B, to be copied in Table A (just that single column and not the whole row). I would love to get a basic syntax for this.\nThanks for the help.</p>\n"}, {"tags": ["excel", "loops", "date", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 7856826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa50c621849eb3a1ad1b39624f79fed?s=128&d=identicon&r=PG&f=1", "display_name": "Brenda G.", "link": "https://stackoverflow.com/users/7856826/brenda-g"}, "edited": false, "score": 0, "creation_date": 1492004956, "post_id": 43371436, "comment_id": 73804724, "body": "I can only get it to change the date in A1 - I need it to loop down until column A is blank"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1492009665, "post_id": 43371436, "comment_id": 73808768, "body": "<code>For I = 1 To 10 Set Temp = Range(&quot;A&quot; &amp; I)</code>? That for the first 10 rows. For finding last row, see <a href=\"http://stackoverflow.com/a/71310/1726522\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 7798223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56caec1d3c39ec58e886d25bb05d6235?s=128&d=identicon&r=PG&f=1", "display_name": "Joe W", "link": "https://stackoverflow.com/users/7798223/joe-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1492435528, "creation_date": 1492435528, "answer_id": 43452415, "question_id": 43371436, "link": "https://stackoverflow.com/questions/43371436/looping-a-macro-that-changes-date-format-in-column-a-to-column-c-then-continue-u/43452415#43452415", "title": "Looping a macro that changes date format in column A to column C then continue until it&#39;s reached the last used cell in column A", "body": "<p>You will first need to define your last row as below and then set your temp range. Try substituting this into your macro and run through it. </p>\n\n<pre><code>    lRow = WorksheetFunction.Max(Range(\"A65536\").End(xlUp).Row)\n\n    With ActiveSheet\n    For i = lRow To 2 Step -1\n    On Error Resume Next\n    Set Temp = Range(\"A\" &amp; i)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7856826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fa50c621849eb3a1ad1b39624f79fed?s=128&d=identicon&r=PG&f=1", "display_name": "Brenda G.", "link": "https://stackoverflow.com/users/7856826/brenda-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1492435528, "creation_date": 1492004901, "last_edit_date": 1531164843, "question_id": 43371436, "link": "https://stackoverflow.com/questions/43371436/looping-a-macro-that-changes-date-format-in-column-a-to-column-c-then-continue-u", "title": "Looping a macro that changes date format in column A to column C then continue until it&#39;s reached the last used cell in column A", "body": "<p>Looping a macro that changes date format in column A to column C then continue until it's reached the last used cell in column A.</p>\n\n<p>I can only get it to change the date in A1 - I need it to loop down until column A is blank:</p>\n\n<pre><code>Sub Macro1()\n  '\n  ' Macro1 Macro\n  Dim ShipDate, Temp, DateForImport\n  Set ShipDate = Range(\"A1\") ' or whatever cell the date is entered into (D30)\n\n  For I = 1 To 1\n    On Error Resume Next\n    Set Temp = Range(\"A1\")\n\n    If Len(Temp.Text) &gt; 1 Then\n      Set TempDate = Temp\n      'FORMAT SHIP DATE From MM/DD/YY OR MM/DD/YYYY TO YYYY-MM-DD\n      'if single digit month or day then fix it\n      If Len(TempDate.Text) = 10 Then\n        TempDate = TempDate\n        Exit For\n      End If\n      'case M/DD/YYYY length 9\n      If Len(TempDate.Text) = 9 And Mid(TempDate, 2, 1) = \"/\" Then\n        TempDate = \"0\" + Right(TempDate, 9)\n        Exit For\n      End If\n      'case MM/D/YYYY length 9\n      If Len(TempDate.Text) = 9 And Mid(TempDate, 3, 1) = \"/\" Then\n        TempDate = Left(TempDate, 3) + \"0\" + Right(TempDate, 6)\n        Exit For\n      End If\n      'case MM/DD/YY length 8\n      If Len(TempDate.Text) = 8 And Mid(TempDate, 3, 1) = \"/\" Then\n        TempDate = Left(TempDate, 6) + \"20\" + Right(TempDate, 2)\n        Exit For\n      End If\n      'case M/D/YYYY length 8\n      If Len(TempDate.Text) = 8 And Mid(TempDate, 2, 1) = \"/\" Then\n        TempDate = \"0\" + Left(TempDate, 2) + \"0\" + Right(TempDate, 6)\n        Exit For\n      End If\n      'case M/DD/YY length 7\n      If Len(TempDate.Text) = 7 And Mid(TempDate, 2, 1) = \"/\" Then\n        TempDate = \"0\" + Left(TempDate, 2) + Mid(TempDate, 3, 3) + \"20\" + Right(TempDate, 2)\n        Exit For\n      End If\n      'case MM/D/YY length 7\n      If Len(TempDate.Text) = 7 And Mid(TempDate, 3, 1) = \"/\" Then\n        TempDate = Left(TempDate, 3) + \"0\" + Mid(TempDate, 4, 2) + \"20\" + Right(TempDate, 2)\n        Exit For\n      End If\n      'case M/D/YY length 6\n      If Len(TempDate.Text) = 6 And Mid(TempDate, 2, 1) = \"/\" Then\n        TempDate = \"0\" + Left(TempDate, 2) + \"0\" + Mid(TempDate, 3, 2) + \"20\" + Right(TempDate, 2)\n        Exit For\n      End If\n\n      'MsgBox \"found Ship Date:  \" + ShipDate\n      Exit For\n    End If\n\n  Next I\n\n  DateForImport = \"20\" + Right(TempDate, 2) + Left(TempDate, 2) + Mid(TempDate, 4, 2)\n  Range(\"C1\") = DateForImport\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "date-range", "subform"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1492010003, "post_id": 43371240, "comment_id": 73809046, "body": "<code>Me![subCCAuto-Open].Form</code> does this work"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1492010878, "creation_date": 1492010878, "answer_id": 43373788, "question_id": 43371240, "link": "https://stackoverflow.com/questions/43371240/filter-subforms-date-column-via-main-form-date-range-entry-in-vba-access/43373788#43373788", "title": "Filter subforms date column via main form Date range entry in vba access", "body": "<p>Try with the modified syntax:</p>\n\n<pre><code>Private Sub Filter_Click()\n    With Forms!frmCCAuto.Form![subCCAuto-Open]\n        .Filter = \"[InvoiceDate] BETWEEN #\" &amp; Format(Me!StartDate.Value, \"yyyy\\/mm\\/dd\") &amp; \"# AND #\" &amp; Format(Me!EndDate.Value, \"yyyy\\/mm\\/dd\") &amp; \"#\"\n        .FilterOn = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>where <code>frmCCAuto</code> must be the name of the subform <em>control</em>.</p>\n"}], "owner": {"reputation": 131, "user_id": 4710262, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/b6f459204c5faf842ef211de8384e496?s=128&d=identicon&r=PG&f=1", "display_name": "toofaced", "link": "https://stackoverflow.com/users/4710262/toofaced"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 793, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594640128, "creation_date": 1492004365, "last_edit_date": 1594640128, "question_id": 43371240, "link": "https://stackoverflow.com/questions/43371240/filter-subforms-date-column-via-main-form-date-range-entry-in-vba-access", "title": "Filter subforms date column via main form Date range entry in vba access", "body": "<p>I have a form named frmCCAuto which includes my date range i.e. start date and end date text fields with a button to filter date.I have a subform \"subCCAuto-Open\" (I dont know why my seniors decided to use subform name with '-')whose default view is Datasheet and its record source is pulled from a table tblPayments_Auto. So, I have to filter the records displayed in the subform according to the date range which is in main form. In other words, what I want to have happen is on two unbound text boxes allow users to enter a date range and have the subform filtered to only show records of the date range entered in the main form boxes. Codes I have been working on are:</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n    Dim db As Database\n    Set db = CodeDb\n\n    db.Execute \"DELETE * FROM tblPayments_Auto;\"\n    DoCmd.SetWarnings False\n    DoCmd.OpenQuery \"qryPayments_AddAuto\" (store procedure: sp_qryPayments_AddAuto )\n    DoCmd.SetWarnings True\n\n    Me.subOpen.Requery\n    ProcessBtn.Enabled = False\nEnd Sub\n\nPrivate Sub Filter_Click()\n    With Forms!frmCCAuto![subCCAuto-Open].Form\n        .Filter = \"[InvoiceDate] BETWEEN #\" &amp; Me.StartDate &amp; \"# AND #\" &amp; Me.EndDate &amp; \"#\"\n        .FilterOn = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>When I debug my code, it gives me an error saying <code>Microsoft Access can't find the field subCCAuto-Open referred to in your expression.</code> Please help.</p>\n"}, {"tags": ["string", "excel", "for-loop", "vba"], "answers": [{"comments": [{"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1492005223, "post_id": 43371384, "comment_id": 73804948, "body": "i am getting an error message on that.- For each control must be variable or Object"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1492005312, "post_id": 43371384, "comment_id": 73805018, "body": "Oh! Darn. Ok change that declaration to <code>Dim StringToSearch as Variant</code> I will update the answer. I forgot VBA is picky about it."}, {"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1492005571, "post_id": 43371384, "comment_id": 73805236, "body": "I did try that earlier and i got a type mismatch error of run time error 13"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1492007064, "post_id": 43371384, "comment_id": 73806499, "body": "Figured it out. I fat fingered the Array variable&#39;s name in the first for loop. Should be working now."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1492007023, "last_edit_date": 1492007023, "creation_date": 1492004747, "answer_id": 43371384, "question_id": 43371236, "link": "https://stackoverflow.com/questions/43371236/search-multiple-different-string-in-excel-vba/43371384#43371384", "title": "Search Multiple different string in excel VBA", "body": "<p>Instead of storing your string's to search in seperate variables, put them into an array. You can iterate through arrays using a <code>For Each</code> loop so it's a perfect fit:</p>\n\n<pre><code>Private Sub btnUpdateEntry_Click()\n\nDim StringsToFind(1 to 6) As String\nDim StringToFind as Variant 'Array's demand that their elements be declared as variants or objects, but we know that the element will be a string\nDim i As Range\nDim cell As Range\n\n'Iterate through your empty array and ask for values:\nFor Each StringToFind in StringsToFind\n    StringsToFind(StringToFind) = Application.InputBox(\"Enter string to find\", \"Find string\")\nNext StringToFind\n\n\nWith Worksheets(\"Skills Matrix\")\n\n    'Now iterate again to search:\n    For Each StringToFind in StringsToFinds\n        Set cell = .Rows(1).Find(What:=StringToFind, LookAt:=xlWhole, _\n                                 MatchCase:=False, SearchFormat:=False)\n\n        If Not cell Is Nothing Then\n            For Each i In .Range(cell.Offset(1), .Cells(.Rows.Count, cell.Column).End(xlUp))\n                If IsNumeric(i.Value) Then\n                    If i.Value &gt; 0 Then\n                        i.EntireRow.Copy\n                        Sheets(\"Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial\n                    End If\n                End If\n            Next i\n        Else\n            Worksheets(\"Data\").Activate\n            MsgBox \"String not found\"\n        End If\n    Next StringToFind\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>There's probably some other tweaks inside that second for loop to make so it makes sense when you iterate, but this will get you in the ballpark.</p>\n"}, {"comments": [{"owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1492006216, "post_id": 43371885, "comment_id": 73805802, "body": "Thanks for that. However thats bringing up a compile error: Invalid Next control variable reference. thats on the next i  @tigeravatar"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1492006251, "last_edit_date": 1492006251, "creation_date": 1492005966, "answer_id": 43371885, "question_id": 43371236, "link": "https://stackoverflow.com/questions/43371236/search-multiple-different-string-in-excel-vba/43371885#43371885", "title": "Search Multiple different string in excel VBA", "body": "<p>Similar solution, designed for flexibility and speed:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim wsSearch As Worksheet\n    Dim wsData As Worksheet\n    Dim rFound As Range\n    Dim rCopy As Range\n    Dim rTemp As Range\n    Dim aFindStrings() As String\n    Dim vFindString As Variant\n    Dim sTemp As String\n    Dim sFirst As String\n    Dim i As Long, j As Long\n    Dim bExists As Boolean\n\n    Set wb = ActiveWorkbook\n    Set wsSearch = wb.Sheets(\"Skills Matrix\")\n    Set wsData = wb.Sheets(\"Data\")\n    ReDim aFindStrings(1 To 65000)\n    i = 0\n\n    Do\n        sTemp = vbNullString\n        sTemp = InputBox(\"Enter string to find\", \"Find string\")\n        If Len(sTemp) &gt; 0 Then\n            bExists = False\n            For j = 1 To i\n                If aFindStrings(j) = sTemp Then\n                    bExists = True\n                    Exit For\n                End If\n            Next j\n            If Not bExists Then\n                i = i + 1\n                aFindStrings(i) = sTemp\n            End If\n        Else\n            'User pressed cancel or left entry blank\n            Exit Do\n        End If\n    Loop\n\n    If i = 0 Then Exit Sub  'User pressed cancel or left entry blank on the first prompt\n\n    ReDim Preserve aFindStrings(1 To i)\n    For Each vFindString In aFindStrings\n        Set rFound = Nothing\n        Set rFound = wsSearch.Rows(1).Find(vFindString, wsSearch.Cells(1, wsSearch.Columns.Count), xlValues, xlWhole)\n        If Not rFound Is Nothing Then\n            sFirst = rFound.Address\n            Do\n                For Each rTemp In wsSearch.Range(rFound.Offset(1), wsSearch.Cells(wsSearch.Rows.Count, rFound.Column).End(xlUp)).Cells\n                    If IsNumeric(rTemp) And rTemp.Value &gt; 0 Then\n                        If rCopy Is Nothing Then\n                            Set rCopy = rTemp.EntireRow\n                        Else\n                            Set rCopy = Union(rCopy, rTemp.EntireRow)\n                        End If\n                    End If\n                Next rTemp\n                Set rFound = wsSearch.Rows(1).FindNext(rFound)\n            Loop While rFound.Address &lt;&gt; sFirst\n        Else\n            MsgBox \"[\" &amp; vFindString &amp; \"] not found.\"\n        End If\n    Next vFindString\n\n    If Not rCopy Is Nothing Then rCopy.Copy wsData.Cells(wsData.Rows.Count, \"A\").End(xlUp).Offset(1)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 43371885, "answer_count": 2, "score": 0, "last_activity_date": 1492007023, "creation_date": 1492004353, "last_edit_date": 1531161705, "question_id": 43371236, "link": "https://stackoverflow.com/questions/43371236/search-multiple-different-string-in-excel-vba", "title": "Search Multiple different string in excel VBA", "body": "<p>i am trying to allow the user to search up to  6 different types of strings( text). However i have tried it for up to 2 , </p>\n\n<p><strong>Problem</strong></p>\n\n<p>but my code only performs the search correctly for the first one. However any of the searches after fisrt string are not achieving the objective.</p>\n\n<p><strong>Objective</strong></p>\n\n<p>The objective of the code is for it to find the string in the speficied row, then search that coloumn for values greater than zero, if so copy the whole row.</p>\n\n<pre><code>Private Sub btnUpdateEntry_Click()\n\nDim StringToFind As String\nDim SringToFind2 As String\nDim i As Range\nDim cell As Range\n\nStringToFind = Application.InputBox(\"Enter string to find\", \"Find string\")\nStringToFind2 = Application.InputBox(\"Enter string to find\", \"Find string\")\n\nWith Worksheets(\"Skills Matrix\")\n    Set cell = .Rows(1).Find(What:=StringToFind, LookAt:=xlWhole, _\n                             MatchCase:=False, SearchFormat:=False)\n\n    If Not cell Is Nothing Then\n        For Each i In .Range(cell.Offset(1), .Cells(.Rows.Count, cell.Column).End(xlUp))\n            If IsNumeric(i.Value) Then\n                If i.Value &gt; 0 Then\n                    i.EntireRow.Copy\n                    Sheets(\"Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial\n                End If\n            End If\n        Next i\n    Else\n        Worksheets(\"Data\").Activate\n        MsgBox \"String not found\"\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 97, "user_id": 7430985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6445c3ca12e28a00028cdb0e0c313c82?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Wiedemann", "link": "https://stackoverflow.com/users/7430985/lukas-wiedemann"}, "edited": false, "score": 0, "creation_date": 1492002876, "post_id": 43369662, "comment_id": 73802971, "body": "A linked folder can not be accessed as a normal folder. In Windows a linked folder is a file."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7856425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af4784812fefb8bb4ef65866b9d641a?s=128&d=identicon&r=PG&f=1", "display_name": "gogos95", "link": "https://stackoverflow.com/users/7856425/gogos95"}, "edited": false, "score": 0, "creation_date": 1492082949, "post_id": 43371087, "comment_id": 73842893, "body": "Thanks for the link. Can you pls help me to integrate the code into mine? :/"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1492003972, "creation_date": 1492003972, "answer_id": 43371087, "question_id": 43369662, "link": "https://stackoverflow.com/questions/43369662/vba-outlook-broseforfolder-how-to-access-to-all-folders-explorer-exe/43371087#43371087", "title": "VBA Outlook // BroseForFolder: How to access to all folders (Explorer.exe)", "body": "<p>Hummm, I just answered a question like this less than 1 minute ago.  I think you want to list all files in all folders and all sub-folders. Check out this link.</p>\n\n<p><a href=\"http://www.learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/\" rel=\"nofollow noreferrer\">http://www.learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/</a></p>\n\n<p>Download the file; that's the way to go.</p>\n\n<p>i) User wants to get the list of All files inside a folder\nCopy and Paste the below Code and this will list down the list of all the files inside the folder. This will list down all the files only in the specified folder. If there are other files which are there in some other Sub-folders.\nview plaincopy to clipboardprint?</p>\n\n<pre><code>Sub GetFilesInFolder(SourceFolderName As String)  \n\n'--- For Example:Folder Name= \"D:\\Folder Name\\\"  \n\nDim FSO As Scripting.FileSystemObject  \nDim SourceFolder As Scripting.folder, SubFolder As Scripting.folder  \nDim FileItem As Scripting.File  \n\n    Set FSO = New Scripting.FileSystemObject  \n    Set SourceFolder = FSO.GetFolder(SourceFolderName)  \n\n    '--- This is for displaying, whereever you want can be configured  \n\n    r = 14  \n    For Each FileItem In SourceFolder.Files  \n        Cells(r, 2).Formula = r - 13  \n        Cells(r, 3).Formula = FileItem.Name  \n        Cells(r, 4).Formula = FileItem.Path  \n        Cells(r, 5).Formula = FileItem.Size  \n        Cells(r, 6).Formula = FileItem.Type  \n        Cells(r, 7).Formula = FileItem.DateLastModified  \n        Cells(r, 8).Formula = \"=HYPERLINK(\"\"\" &amp; FileItem.Path &amp; \"\"\",\"\"\" &amp; \"Click Here to Open\" &amp; \"\"\")\"  \n\n        r = r + 1   ' next row number  \n    Next FileItem  \n\n    Set FileItem = Nothing  \n    Set SourceFolder = Nothing  \n    Set FSO = Nothing  \nEnd Sub\n</code></pre>\n\n<p>ii) User wants to get the list of all files inside a folder as well as Sub-folders\nCopy and Paste the below Code and this will list down the list of all the files inside the folder as well as sub-folders. If there are other files which are there in some other Sub-folders then it will list down all files from each and Every Folders and Sub-folders.\nview plaincopy to clipboardprint?</p>\n\n<pre><code>Sub GetFilesInFolder(SourceFolderName As String, Subfolders As Boolean)  \n\n'--- For Example:Folder Name= \"D:\\Folder Name\\\" and Flag as Yes or No  \n\nDim FSO As Scripting.FileSystemObject  \nDim SourceFolder As Scripting.folder, SubFolder As Scripting.folder  \nDim FileItem As Scripting.File  \n'Dim r As Long  \n    Set FSO = New Scripting.FileSystemObject  \n    Set SourceFolder = FSO.GetFolder(SourceFolderName)  \n\n    '--- This is for displaying, whereever you want can be configured  \n\n    r = 14  \n    For Each FileItem In SourceFolder.Files  \n        Cells(r, 2).Formula = r - 13  \n        Cells(r, 3).Formula = FileItem.Name  \n        Cells(r, 4).Formula = FileItem.Path  \n        Cells(r, 5).Formula = FileItem.Size  \n        Cells(r, 6).Formula = FileItem.Type  \n        Cells(r, 7).Formula = FileItem.DateLastModified  \n        Cells(r, 8).Formula = \"=HYPERLINK(\"\"\" &amp; FileItem.Path &amp; \"\"\",\"\"\" &amp; \"Click Here to Open\" &amp; \"\"\")\"  \n\n        r = r + 1   ' next row number  \n    Next FileItem  \n\n    '--- This is the Function to go each and Every Folder and get the Files. This is a Nested-Function Calling.  \n\n    If Subfolders = True Then  \n        For Each SubFolder In SourceFolder.Subfolders  \n            ListFilesInFolder SubFolder.Path, True  \n        Next SubFolder  \n    End If  \n\n    Set FileItem = Nothing  \n    Set SourceFolder = Nothing  \n    Set FSO = Nothing  \nEnd Sub  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7856425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af4784812fefb8bb4ef65866b9d641a?s=128&d=identicon&r=PG&f=1", "display_name": "gogos95", "link": "https://stackoverflow.com/users/7856425/gogos95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492003972, "creation_date": 1492000410, "last_edit_date": 1531164843, "question_id": 43369662, "link": "https://stackoverflow.com/questions/43369662/vba-outlook-broseforfolder-how-to-access-to-all-folders-explorer-exe", "title": "VBA Outlook // BroseForFolder: How to access to all folders (Explorer.exe)", "body": "<p>i need your help. \nWhat code do I have to add in order to get access to all folders (like the standard explorer window). Especially to the linked folders. \nThank you very much for your help in advance.</p>\n\n<p>Here is my Code:</p>\n\n<pre><code>Option Explicit\n Function BrowseForFolder(Optional OpenAt As Variant) As Variant\n\n  Dim ShellApp As Object\n\n Set ShellApp = CreateObject(\"Shell.Application\"). _\n      BrowseForFolder(0, \"Bitte den Ordner ausw\u00e4hlen:\", &amp;H1000, OpenAt)\n\n 'Set BrowseDir = ShellApp.BrowseForFolder(0, \"Bitte Ordner ausw\u00e4hlen\", &amp;H4000, OpenAt)\n\n On Error Resume Next\n    BrowseForFolder = ShellApp.self.Path\n     On Error GoTo 0\n\n Set ShellApp = Nothing\n    Select Case Mid(BrowseForFolder, 2, 1)\n        Case Is = \":\"\n            If Left(BrowseForFolder, 1) = \":\" Then GoTo Invalid\n       Case Is = \"\\\"\n            If Not Left(BrowseForFolder, 1) = \"\\\" Then GoTo Invalid\n        Case Else\n            GoTo Invalid\n    End Select\n   Exit Function\n\nInvalid:\n BrowseForFolder = False\n\n\nEnd Function\n\nPublic Sub speichern()\n\n    Dim oMail As Outlook.mailitem\n    Dim objItem As Object\n    Dim sPath, strFolderpath As String\n    Dim dtDate As Date\n    Dim sName As String\n    Dim enviro As String\n\n    enviro = CStr(Environ(\"USERPROFILE\"))\n\n    strFolderpath = BrowseForFolder\n    sPath = strFolderpath &amp; \"\\\"\n\n    For Each objItem In ActiveExplorer.Selection\n        If objItem.MessageClass = \"IPM.Note\" Then\n            Set oMail = objItem\n            sName = oMail.Subject\n            ReplaceCharsForFileName sName, \"-\"\n            dtDate = oMail.ReceivedTime\n            sName = Format(dtDate, \"yyyy-mm-dd\", vbUseSystemDayOfWeek, _\n              vbUseSystem) &amp; \" \" &amp; \"-\" &amp; \" \" &amp; UCase(Split(Trim(Split(objItem.SenderEmailAddress, \"@\")(0)), \".\")(1)) &amp; \" \" &amp; \"-\" &amp; \" \" &amp; sName &amp; \".msg\"\n            Debug.Print sPath &amp; sName\n            sName = InputBox( _\n            prompt:=\"Dateiname. Bei Fertigstellung OK klicken.\", _\n            Default:=sName)\n            oMail.SaveAs sPath &amp; sName, olMSG\n         End If\n    Next\nEnd Sub\n\n   Private Sub ReplaceCharsForFileName(sName As String, _\n  sChr As String _\n)\n  sName = Replace(sName, \"'\", sChr)\n  sName = Replace(sName, \"*\", sChr)\n  sName = Replace(sName, \"/\", sChr)\n  sName = Replace(sName, \"\\\", sChr)\n  sName = Replace(sName, \":\", sChr)\n  sName = Replace(sName, \"?\", sChr)\n  sName = Replace(sName, Chr(34), sChr)\n  sName = Replace(sName, \"&lt;\", sChr)\n  sName = Replace(sName, \"&gt;\", sChr)\n  sName = Replace(sName, \"|\", sChr)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7131137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8046c32d908ff8afad4fadb4464eccb?s=128&d=identicon&r=PG&f=1", "display_name": "Moez", "link": "https://stackoverflow.com/users/7131137/moez"}, "edited": false, "score": 0, "creation_date": 1492001800, "post_id": 43370116, "comment_id": 73802109, "body": "It doesn&#39;t work. lastrow has always 1 and the table is pasted starting from row 1."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 25, "user_id": 7131137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8046c32d908ff8afad4fadb4464eccb?s=128&d=identicon&r=PG&f=1", "display_name": "Moez", "link": "https://stackoverflow.com/users/7131137/moez"}, "edited": false, "score": 0, "creation_date": 1492001933, "post_id": 43370116, "comment_id": 73802212, "body": "@Moez try edited code for a more relable way using the <code>Find</code> function"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1492001892, "last_edit_date": 1492001892, "creation_date": 1492001566, "answer_id": 43370116, "question_id": 43369588, "link": "https://stackoverflow.com/questions/43369588/copy-a-table-from-one-sheet-and-paste-it-in-the-next-empty-row-of-another-sheet/43370116#43370116", "title": "copy a table from one Sheet and paste it in the next empty row of another Sheet using VBA excel", "body": "<p>Your <code>lastrow</code> is not qualified with <code>pasteSheet</code>.</p>\n\n<p>Try:</p>\n\n<pre><code>lastrow = pasteSheet.Range(\"A100000\").End(xlUp).Row\n</code></pre>\n\n<p>A safer way to find the <code>lastrow</code>using the <code>Find</code> function :</p>\n\n<pre><code>lastrow = pasteSheet.Cells.Find(What:=\"*\", After:=pasteSheet.Cells(1), Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7131137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8046c32d908ff8afad4fadb4464eccb?s=128&d=identicon&r=PG&f=1", "display_name": "Moez", "link": "https://stackoverflow.com/users/7131137/moez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 43370116, "answer_count": 1, "score": 0, "last_activity_date": 1492001892, "creation_date": 1492000221, "last_edit_date": 1531164843, "question_id": 43369588, "link": "https://stackoverflow.com/questions/43369588/copy-a-table-from-one-sheet-and-paste-it-in-the-next-empty-row-of-another-sheet", "title": "copy a table from one Sheet and paste it in the next empty row of another Sheet using VBA excel", "body": "<p>I want to copy and paste a table from one Sheet to another Sheet in the next empty row. The problem is that my code doesn't search the next empty row. it gives me always the first row as the empty one.</p>\n\n<p>this is my Code:</p>\n\n<pre><code>Sub AddToPriceSummary()\n\nDim lastrow As Long\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\n\nSet copySheet = Worksheets(\"Sheet2\")\nSet pasteSheet = Worksheets(\"Sheet3\")\nlastrow = Range(\"A100000\").End(xlUp).Row\n\ncopySheet.Range(\"A2:AS10\").Copy\npasteSheet.Cells(lastrow + 1, 1).PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>So here <code>lastrow</code> is always 1 </p>\n\n<p>Any help?</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 5065546, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fa54cbc3320f3e974eae36c5631b0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Euan Ritchie", "link": "https://stackoverflow.com/users/5065546/euan-ritchie"}, "edited": false, "score": 0, "creation_date": 1491999478, "post_id": 43369115, "comment_id": 73800337, "body": "Thanks for the very quick response, and for the useful information. However I did actually try using <code>&quot;## *&quot;</code> and still got a match for cell content &quot;111 some text&quot;, which is what is confusing me. Apologies for not stating that I tried this in the question but I tried a whole range of things (partly in frustration) and thought I had included the most relevant ones. I would prefer to continue using like if possible."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 171, "user_id": 5065546, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fa54cbc3320f3e974eae36c5631b0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Euan Ritchie", "link": "https://stackoverflow.com/users/5065546/euan-ritchie"}, "edited": false, "score": 0, "creation_date": 1491999710, "post_id": 43369115, "comment_id": 73800506, "body": "I&#39;ve just tested <code>&quot;111 some text&quot;</code> against <code>&quot;## *&quot;</code> and I didn&#39;t get a match.  Can you try again?"}, {"owner": {"reputation": 510, "user_id": 7425879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9c7fcc95cfeab92cb4b524efe837b0?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysData", "link": "https://stackoverflow.com/users/7425879/alwaysdata"}, "reply_to_user": {"reputation": 171, "user_id": 5065546, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fa54cbc3320f3e974eae36c5631b0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Euan Ritchie", "link": "https://stackoverflow.com/users/5065546/euan-ritchie"}, "edited": false, "score": 0, "creation_date": 1491999758, "post_id": 43369115, "comment_id": 73800543, "body": "@EuanRitchie I don&#39;t think <code>&quot;## *&quot;</code> should match on 111 Some Text because a space doesn&#39;t follow the two digits. The answer I posted shows that."}, {"owner": {"reputation": 510, "user_id": 7425879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9c7fcc95cfeab92cb4b524efe837b0?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysData", "link": "https://stackoverflow.com/users/7425879/alwaysdata"}, "edited": false, "score": 0, "creation_date": 1491999798, "post_id": 43369115, "comment_id": 73800573, "body": "I agree with @destination-data"}, {"owner": {"reputation": 171, "user_id": 5065546, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fa54cbc3320f3e974eae36c5631b0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Euan Ritchie", "link": "https://stackoverflow.com/users/5065546/euan-ritchie"}, "reply_to_user": {"reputation": 510, "user_id": 7425879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9c7fcc95cfeab92cb4b524efe837b0?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysData", "link": "https://stackoverflow.com/users/7425879/alwaysdata"}, "edited": false, "score": 0, "creation_date": 1492000130, "post_id": 43369115, "comment_id": 73800812, "body": "Thank you both, I totally agree, that was why it was confusing. However I have realised that I have been stupid. I had included an asterix at the beginning because many cells have an unspecified number of white space characters at the beginning (as shown above). But obviously this was picking up the first number as well as the white spaces. So thanks again as I noticed that quicker than I would have done otherwise, but sorry for wasting your time! @don_freem"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1492000597, "post_id": 43369115, "comment_id": 73801139, "body": "No need to apologise!  We&#39;ve all been there.  <a href=\"http://www.homeandlearn.org/trim_len_space.html\" rel=\"nofollow noreferrer\">TRIM()</a> will remove leading, and trailing, spaces.  Something like <code>TRIM(&quot;    11 Some Text&quot;) LIKE &quot;## *&quot;</code> should work."}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": true, "score": 7, "last_activity_date": 1491998904, "last_edit_date": 1495541854, "creation_date": 1491998904, "answer_id": 43369115, "question_id": 43368921, "link": "https://stackoverflow.com/questions/43368921/space-characters-in-like-operator-in-vba/43369115#43369115", "title": "Space characters in &quot;like&quot; operator in VBA", "body": "<p>VBA's like operator doesn't support RegEx.  Instead, it has its own format.  Spaces are matched using the literal value, which does not need escaping.</p>\n\n<pre><code>Input               Op      Pattern     Result\n\"11 Some Text\"      LIKE    \"## *\"      True\n\"11Some Text\"       LIKE    \"## *\"      False  \n</code></pre>\n\n<p>For more see <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251796.aspx\" rel=\"nofollow noreferrer\">Microsoft's documentation</a>.</p>\n\n<p>If you would rather use RegEx take a look at this <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">answer</a>.  @PortlandRunner has kindly taken the time to produce a great guide, that includes many examples.</p>\n"}, {"tags": [], "owner": {"reputation": 510, "user_id": 7425879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9c7fcc95cfeab92cb4b524efe837b0?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysData", "link": "https://stackoverflow.com/users/7425879/alwaysdata"}, "is_accepted": false, "score": 1, "last_activity_date": 1491999569, "creation_date": 1491999569, "answer_id": 43369347, "question_id": 43368921, "link": "https://stackoverflow.com/questions/43368921/space-characters-in-like-operator-in-vba/43369347#43369347", "title": "Space characters in &quot;like&quot; operator in VBA", "body": "<p>I read through the material on this <a href=\"https://msdn.microsoft.com/en-us/library/swf8kaxw(v=vs.100).aspx\" rel=\"nofollow noreferrer\">MSDN</a> site and this seemed to work for me. </p>\n\n<pre><code>If Cells(i, 1).Value Like \"## *\" Then\n    Debug.Print (\"Match\")\nElseIf Cells(i, 1).Value Like \"### *\" Then\n    Debug.Print (\"Match\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5065546, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4fa54cbc3320f3e974eae36c5631b0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Euan Ritchie", "link": "https://stackoverflow.com/users/5065546/euan-ritchie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2584, "favorite_count": 0, "accepted_answer_id": 43369115, "answer_count": 2, "score": 3, "last_activity_date": 1491999569, "creation_date": 1491998373, "question_id": 43368921, "link": "https://stackoverflow.com/questions/43368921/space-characters-in-like-operator-in-vba", "title": "Space characters in &quot;like&quot; operator in VBA", "body": "<p>I am trying to use the like function to distinguish between cells that begin (other than white space characters) with either 2 or 3 numerical digits followed by more white space characters, but seem to be having trouble identifying the latter. For example, for two cells, one containing  </p>\n\n<blockquote>\n  <p>11 some text</p>\n</blockquote>\n\n<p>and another containing </p>\n\n<blockquote>\n  <p>111 some text</p>\n</blockquote>\n\n<p>I have been trying to write an if statement that is true for the first but not the second. I have tried </p>\n\n<pre><code>if cells(i,1) like \"*##[ ]*\" then\n</code></pre>\n\n<p>and </p>\n\n<pre><code>if cells(i,1) like \"*##\\s*\" then\n</code></pre>\n\n<p>and </p>\n\n<pre><code>if cells(i,1) like \"*##[^#]*\" then\n</code></pre>\n\n<p>following information on using regex from various sources (with the first two I was trying to identify 2 digits followed by a white space character, and the third 2 digits followed by a non-digit).    </p>\n\n<p>It is part of a for loop, and as in the examples above, the only numerical digits are at the beginning of the string, other than sometimes white space characters. In the first code example the if statement is true for both 2 and 3 numerical digits, and for the second and third, it is true for neither. I don't understand this given what I have read about regex and the like function. </p>\n\n<p>I would greatly appreciate guidance. I expected this to be relatively simple and so I'm sure I am missing something obvious, and apologies if this is the case. </p>\n"}, {"tags": ["arrays", "vba", "excel", "max", "min"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1492000371, "post_id": 43368711, "comment_id": 73800983, "body": "Does this need to be done in memory?  If not you&#39;d almost certainly be better to drop the values into a spreadsheet and use the built in functions to do this"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1491999137, "creation_date": 1491999137, "answer_id": 43369201, "question_id": 43368711, "link": "https://stackoverflow.com/questions/43368711/indices-of-elements-in-order-from-smallest-to-largest/43369201#43369201", "title": "Indices of elements in order from smallest to largest", "body": "<p>You have to find a way to glue together the values (content) and the indexes.\nAs you have flagged the with <code>excel-vba</code>, I would suggest that you write you data into a sheet, first column the values and second column the indexes and sort them using <code>range.sort</code>. After that, the 2nd column holds your order</p>\n\n<p>If using Excel is not an option, the best bet I can think about is create a <code>Scripting.Dictionary</code> (with index as key) and sort this (there is no build in function to sort it but googling it you can find some examples.</p>\n\n<p>Or you could do something ugly like create a array of doubles from you data with the decimal part holding you index\n<code>[1.001, 4.002, 3.003, 2.004, 5.005, 3.006, 2.007, 1.008]</code>, sort this, get the decimals and multiply them back to integer.</p>\n"}, {"comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1492003672, "post_id": 43370813, "comment_id": 73803627, "body": "Nice answer @Ralph"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 2, "last_activity_date": 1492003371, "creation_date": 1492003371, "answer_id": 43370813, "question_id": 43368711, "link": "https://stackoverflow.com/questions/43368711/indices-of-elements-in-order-from-smallest-to-largest/43370813#43370813", "title": "Indices of elements in order from smallest to largest", "body": "<p>Give this a try and let me know how it works for you:</p>\n\n<pre><code>Option Base 0\nOption Explicit\nOption Compare Text\n\nSub tmpSO()\n\nDim tmp As Double\nDim strJoin As String\nDim i As Long, j As Long\nDim W As Variant, S() As Double, X() As Long\n\n'Load W\nW = Array(1, 4, 3, 2, 5, 3, 2, 1)\n\n'Set the dimensions for the other arrays\nReDim S(LBound(W) To UBound(W))\nReDim X(LBound(W) To UBound(W))\n\n'Copy W into S\nFor i = LBound(W) To UBound(W)\n    S(i) = W(i)\nNext i\n\n'Sort S\nFor i = LBound(S) To UBound(S) - 1\n    For j = i + 1 To UBound(S)\n        If S(i) &gt; S(j) Then\n            tmp = S(j)\n            S(j) = S(i)\n            S(i) = tmp\n        End If\n    Next j\nNext i\n\n'Get the results into X\nFor i = LBound(S) To UBound(S)\n    X(i) = WorksheetFunction.Match(W(i), S, 0)\n    S(WorksheetFunction.Match(W(i), S, 0) - 1) = vbEmpty\nNext i\n\n'Print out W (original array)\nDebug.Print Join(W, \",\")\n\n'Print out x (result array)\nFor i = LBound(X) To UBound(X)\n    strJoin = strJoin &amp; \",\" &amp; X(i)\nNext i\nDebug.Print mid(strJoin, 2)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 7856197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155200501761726/picture?type=large", "display_name": "Oliver Jack Baynham", "link": "https://stackoverflow.com/users/7856197/oliver-jack-baynham"}, "is_accepted": true, "score": 0, "last_activity_date": 1492094170, "creation_date": 1492094170, "answer_id": 43395158, "question_id": 43368711, "link": "https://stackoverflow.com/questions/43368711/indices-of-elements-in-order-from-smallest-to-largest/43395158#43395158", "title": "Indices of elements in order from smallest to largest", "body": "<p>Thank you so much for everyone who gave help!</p>\n\n<p>I took your suggestions and somehow managed to forge my own solution, despite having spent an entire day working on something that has very little to do with my overall project.</p>\n\n<p>Here is the following code I used:</p>\n\n<pre><code>Sub InitialSol(S() As Integer, n As Integer, k As Integer, W() As Long)\nDim i As Integer, c As Integer\nDim min As Long, max As Long, temp As Long\n\nmin = W(1)\nmax = W(1)\nFor i = 2 To n\n    If W(i) &lt;= min Then\n        min = W(i)\n    End If\n    If W(i) &gt;= max Then\n        max = W(i)\n    End If\nNext i\n\nc = 1\nDo While c &lt;= n\n    temp = max\n    For i = 1 To n\n        If W(i) = min Then\n            S(i) = c\n            c = c + 1\n        End If\n    Next i\n    For i = 1 To n\n        If W(i) &gt; min And W(i) &lt;= temp Then\n            temp = W(i)\n        End If\n    Next i\n    min = temp\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7856197, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155200501761726/picture?type=large", "display_name": "Oliver Jack Baynham", "link": "https://stackoverflow.com/users/7856197/oliver-jack-baynham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 43395158, "answer_count": 3, "score": 5, "last_activity_date": 1492094170, "creation_date": 1491997743, "question_id": 43368711, "link": "https://stackoverflow.com/questions/43368711/indices-of-elements-in-order-from-smallest-to-largest", "title": "Indices of elements in order from smallest to largest", "body": "<p>I'm trying to produce an initial solution for the group balancing problem but I seem to be stuck on something that sounds like it should be quite simple.</p>\n\n<p>Basically I have an array of weights (random integers), e.g.</p>\n\n<pre><code>W() = [1, 4, 3, 2, 5, 3, 2, 1]\n</code></pre>\n\n<p>And I want to create another array of the same length with the numbers 1 to the size of the array in place of the smallest to largest numbers respectively, e.g.</p>\n\n<pre><code>S() = [1, 7, 5, 3, 8, 6, 4, 2]\n</code></pre>\n\n<p>For duplicates, the first occurrence is taken as the smaller of the indices.</p>\n\n<p>I originally used a BubbleSort algorithm, but unfortunately this does not allow me to give an output in the required format.</p>\n\n<p>I understand that this is quite a specific problem, but any help would be greatly appreciated.</p>\n"}, {"tags": ["windows", "vba", "excel", "internet-explorer", "sendkeys"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1491999454, "post_id": 43368706, "comment_id": 73800321, "body": "This could be an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>.  What are you trying to achieve?  Is the purpose of your code to download something from an internal website?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1491999719, "post_id": 43368706, "comment_id": 73800513, "body": "Yes I am trying to automate the download process of this .xls file as you can see on the picture above. I&#39;ll update the post to make it clearer"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1492000491, "post_id": 43368706, "comment_id": 73801070, "body": "Does the IE window containing that save bar always have the same caption, next to the IE logo?  Does the download always have the same URL?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1492000733, "post_id": 43368706, "comment_id": 73801229, "body": "the URL and Title of the IE window are always the same yes and the URL(hidden part) of the download bar is also the same. Only the report number varies (aka file name)"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1492001729, "post_id": 43368706, "comment_id": 73802046, "body": "Just test IE11 and send keys.  <code>%{S}</code> worked for me.  You said that AppActivate didn&#39;t work.  Did it raise an error?"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1492001905, "post_id": 43368706, "comment_id": 73802187, "body": "When I send this key nothing happens so it&#39;s just skipped. Then with the AppActivate &quot;TitleOfMyPage&quot; I get a runtime error 5 even though I took precaution to make sure it&#39;s the right title by putting it in an If condition"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1492002317, "post_id": 43368706, "comment_id": 73802524, "body": "There was also someone who suggested to send <code>SendKeys &quot;{F6}&quot;, True         SendKeys &quot;{TAB}&quot;, True         SendKeys &quot;{ENTER}&quot;, True</code> I don&#39;t remember the post though. But again it works only when I manually activate the window"}], "answers": [{"comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1492003262, "post_id": 43370597, "comment_id": 73803288, "body": "Sorry for all the questions, but this kind of automation is much harder that you would expect!"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1492003418, "post_id": 43370597, "comment_id": 73803419, "body": "Yeah I&#39;m still confused honestly. I tried again to send F6 + Tab + Enter but this time with a <code>Application.Wait Now + TimeSerial(0, 0, 1)</code> before and after and it works too...seems like it is random"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1492003810, "post_id": 43370597, "comment_id": 73803742, "body": "That&#39;s quite common. It&#39;s really easy for code to get ahead of the UI. The problem is wait times differ. Sometimes Windows need half a second to update the screen. Sometimes 3. You cannot predict this. If you set wait too low, sometimes it&#39;ll fire too early. If you set it too high, the user has time to start clicking. SendKeys can never be bullet proof, I&#39;m afraid."}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": true, "score": 0, "last_activity_date": 1492003233, "last_edit_date": 1495540954, "creation_date": 1492002806, "answer_id": 43370597, "question_id": 43368706, "link": "https://stackoverflow.com/questions/43368706/active-ie-11-window-for-sendkeys/43370597#43370597", "title": "Active IE 11 window for SendKeys", "body": "<p>Front-end automation is a tricky business.  It can be really hard to find a solution that <strong>always</strong> works (those pesky users are free to move the mouse and click buttons at will, disrupting your code).  Because you are taking the data from an intranet site, this suggests the data you need already exists within your organisation.  If at all possible (and I know it isn't always) take the data from the servers/source systems, rather than via the UI.</p>\n\n<p>AppActivate and SendKeys can be very fussy.  Because the url is always the same a better approach would be to directly download it.  Here is a example, based on another <a href=\"https://stackoverflow.com/questions/17877389/how-do-i-download-a-file-using-vba-without-internet-explorer\">answer</a>.</p>\n\n<p>Before you can run code you will need to add two references:</p>\n\n<ol>\n<li>Microsoft XML, v6.0</li>\n<li>Microsoft ActiveX Data Objects 2.8 Library</li>\n</ol>\n\n<p>From the VBA IDE click <em>Tools</em> >> <em>References...</em> and select from the list (the original answer does not use references, instead it uses late binding).</p>\n\n<pre><code>' Downloads a file from a given URL.\n'   URL     String      URL to get file.  Ex: http:\\\\MySite\\MyFile.\n'   Path    String      Location to save file.  Ex: C:\\Myfile.csv.\n' Requires: Microsoft XML, v6.0\n' Requires: Microsoft ActiveX Data Objects 2.8 Library.\nSub DownloadURL(ByVal URL As String, ByVal Path As String)\n    Dim httpXML As XMLHTTP60            ' Used to download data.\n    Dim st As ADODB.Stream              ' Used to write downloaded data to file system.\n    Set httpXML = New XMLHTTP60\n\n    ' Request file.\n    httpXML.Open \"GET\", URL, False\n    httpXML.send\n\n    ' Download response.\n    If httpXML.Status = 200 And httpXML.readyState = 4 Then\n\n        Set st = New ADODB.Stream\n        st.Open\n        st.Type = adTypeBinary\n        st.Write httpXML.responseBody\n        st.SaveToFile Path, adSaveCreateOverWrite\n        st.Close\n    Else\n\n        MsgBox \"Something went wrong :(\", vbCritical, \"An error occured\"\n    End If\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1508, "favorite_count": 0, "accepted_answer_id": 43370597, "answer_count": 1, "score": 0, "last_activity_date": 1492003233, "creation_date": 1491997721, "last_edit_date": 1491999985, "question_id": 43368706, "link": "https://stackoverflow.com/questions/43368706/active-ie-11-window-for-sendkeys", "title": "Active IE 11 window for SendKeys", "body": "<p><strong>Problem :</strong> I am trying to automate the saving of a file (manage to save the file when the below IE bar appears at the bottom of the page)</p>\n\n<p>My code is going on my intranet, clicking here and there and then I click on an \"Export\" button which will trigger this from IE :<a href=\"https://i.stack.imgur.com/a2734.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a2734.png\" alt=\"enter image description here\"></a></p>\n\n<p>I didn't manage to find a way to automate the saving of the file because the only way (I think) to interact with this \"window\" is to use SendKeys.\nIn order to do so I have to \"activate\" this window (Yes, I have it activated for the HTML scraping with this bit of code, but it's not the active window though):<a href=\"https://i.stack.imgur.com/SxP8z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SxP8z.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried using <code>AppActivate</code> but for some reason it doesn't work.</p>\n\n<p>There are 2 options to pass this obstacle :</p>\n\n<ul>\n<li>Find a way to activate the IE window containing that saving bar so that I can use <code>Application.SendKeys \"%{S}\"</code> on it</li>\n<li>(second option only) : Disable this saving bar or manage to have it open in a new window</li>\n</ul>\n\n<p>So far I have gone through lots of posts talking about that subject but none gave an operational solution for that issue on IE 11.</p>\n\n<p>Let me know if you want to see any bit of code, I have a lot of different attempts gathered from different posts but this would highly increase the length of this post.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 3, "creation_date": 1491997106, "post_id": 43368421, "comment_id": 73798712, "body": "I&#39;m not an Excel guru, but 50 worksheets sounds like being on the verge of not maintainable, and error prone.  If I were you, I&#39;d bring that data into a database, where it would likely be easy to answer your question."}, {"owner": {"reputation": 57, "user_id": 5925219, "user_type": "registered", "profile_image": "https://graph.facebook.com/963219177046434/picture?type=large", "display_name": "Chris Vermeijlen", "link": "https://stackoverflow.com/users/5925219/chris-vermeijlen"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1491999575, "post_id": 43368421, "comment_id": 73800406, "body": "I&#39;m aware of that, and I always recommend DB&#39;s for this (either be it sql, access or filemaker) but this is an excel made by someone in the &quot;early days&quot; :D . Seems, I will have to introduce them to one of these solutions.  Thank you anyway for taking a look."}], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "is_accepted": true, "score": 1, "last_activity_date": 1492002860, "last_edit_date": 1492002860, "creation_date": 1492001203, "answer_id": 43369967, "question_id": 43368421, "link": "https://stackoverflow.com/questions/43368421/get-certain-years-out-of-other-sheets/43369967#43369967", "title": "get certain years out of other sheets", "body": "<p>I'm making some assumptions here:</p>\n\n<ul>\n<li>I'm assuming that each worksheet for a study is in the same format</li>\n<li>The people in a study (the data you want) is in a standardised location on each sheet</li>\n</ul>\n\n<p>One solution would be to do some code in VBA. You could iterate through each sheet (that is not called 'Overview', obviously) and assign to a variable the range where the details you want to check are stored, then iterate through each cell in that range, and record in an array the names of anyone who matches the criteria.</p>\n\n<p>For example, if each of your Study sheets has a list of participants like this:\n<a href=\"https://i.stack.imgur.com/MwE1w.jpg\" rel=\"nofollow noreferrer\">Participant List</a></p>\n\n<p>You would define the range variable as [Worksheet].Range(\"A5:A12\"), and say:</p>\n\n<pre><code>For Each &lt;cell&gt; in &lt;range&gt;.Cells\nIf Year(&lt;Worksheet&gt;.Cells(&lt;cell&gt;.Row, &lt;cell&gt;.column + 1).Value) = 2017 Then\n&lt;assign the contents of &lt;cell&gt; to an Array&gt;\nNext &lt;cell&gt;\n</code></pre>\n\n<p>Once you'd gone through each worksheet, the contents of the array could be output to any desired location, either on the Overview sheet or elsewhere.\nThis would be a basic idea of one way to do it. I would stress though that your data sounds like exactly the kind of thing that an MS Access Database would be ideal for (I know from personal experience however that some companies/departments are afraid of anything that isn't Excel, so I feel your pain!)</p>\n"}], "owner": {"reputation": 57, "user_id": 5925219, "user_type": "registered", "profile_image": "https://graph.facebook.com/963219177046434/picture?type=large", "display_name": "Chris Vermeijlen", "link": "https://stackoverflow.com/users/5925219/chris-vermeijlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 43369967, "answer_count": 1, "score": 0, "last_activity_date": 1492002860, "creation_date": 1491996945, "last_edit_date": 1531161705, "question_id": 43368421, "link": "https://stackoverflow.com/questions/43368421/get-certain-years-out-of-other-sheets", "title": "get certain years out of other sheets", "body": "<p>At work we have a worksheet with serveral (40-50) worksheets. Each worksheets represent a certain study. Several people are on each sheet with a name, surname, start of study (date), birthday, etc. And we have one worksheet with an overview. (worksheet study 1, worksheet study 2, worksheet study 3). </p>\n\n<p>Is there any way, that I can place a column on overview, and filter on the people that have joined a study. (so all people that joined a study in year 2016, but not those that did not.) I have a column with the start date of a study, but people can join a study after a study has started.</p>\n\n<p>I've already tried to use a filter, and tried some stuff with data validation, but Im nowhere close to a a solution. Is there anyone who can put me on the right track? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 815, "user_id": 3233629, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f24b4ae0c4b6c313559ddddb5ea9d8aa?s=128&d=identicon&r=PG&f=1", "display_name": "Tamara Aviv", "link": "https://stackoverflow.com/users/3233629/tamara-aviv"}, "edited": false, "score": 0, "creation_date": 1492004093, "post_id": 43368360, "comment_id": 73804011, "body": "I think you might want to break down your task to smaller sub-tasks, for which finding the solution here on SO will be straight forward, rather than expecting the full solution to your specific problem here. Smaller tasks that I see in your question are: 1) How to find text in sheet/column using VBA. 2) How to add row above a range 3) How to write in Excel cell using VBA..  Find the solution for these three will give you the building blocks you need to write your entire solution."}, {"owner": {"reputation": 65, "user_id": 7719071, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e30b02e783b05605a65deb2ff25b10b3?s=128&d=identicon&r=PG&f=1", "display_name": "Kittu", "link": "https://stackoverflow.com/users/7719071/kittu"}, "reply_to_user": {"reputation": 815, "user_id": 3233629, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f24b4ae0c4b6c313559ddddb5ea9d8aa?s=128&d=identicon&r=PG&f=1", "display_name": "Tamara Aviv", "link": "https://stackoverflow.com/users/3233629/tamara-aviv"}, "edited": false, "score": 0, "creation_date": 1492004424, "post_id": 43368360, "comment_id": 73804306, "body": "I am looking something like &#39;Sub column()  Rows(1).Insert shift:=xlShiftDown Cells(1, 8) = &quot;Open with Infosys&quot; &#39;Here the first value is Row Value and the second one is column value &#39;Cells(1, 1) means first row first column &#39;after above code it should find the next header with with columns assignee and insert a row above it and input value (1,8) = &quot;Open with bank&quot; End Sub&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "is_accepted": false, "score": 0, "last_activity_date": 1492009155, "last_edit_date": 1492009155, "creation_date": 1492008488, "answer_id": 43372907, "question_id": 43368360, "link": "https://stackoverflow.com/questions/43368360/find-a-specific-header-and-insert-a-row-above-it-and-insert-some-value/43372907#43372907", "title": "find a specific header and insert a row above it and insert some value", "body": "<p>For the 1st part of the query (inserting a row above the header):</p>\n\n<p>One thing you could do, if this is just a single sheet, is to name the range in which the headers exist (so, if Row 1 is where all the headers are normally, say A1:Q1, then name A1:Q1 as HeaderRow or similar). This has the advantage that, when you insert rows you don't have to put in any code to reassign the header row. Now, rather than looking through an entire sheet, you're focusing your search on a single defined range.</p>\n\n<p>Once this is done, simply use <code>For Each [cell] in [range].Cells</code> to iterate through each cell, and determine if the cell's contents are what you're looking for. If so, you can insert the row above, and populate the cell that is <code>[cell].Row - 1</code> from your target cell.</p>\n\n<p>It'd look something like this:</p>\n\n<pre><code>Dim InternalCell as Range, myNamedRange as Range\nDim SearchTerm as String\nSearchTerm = \"assignee\"\nSet myNamedRange.Cells = ThisWorkbook.Sheets(\"System\").Range(\"HeaderRows\")\n\nFor Each InternalCell In myNamedRange.Cells\nIf InternalCell.Value = SearchTerm Then\nmyNamedRange.Insert Shift:=xlDown\nThisWorkbook.Sheets(\"System\").cells(MyNamedRange.Row - 1, InternalCell.Column).Value = \"Open with assignee\"\nEnd If\nNext InternalCell\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7719071, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e30b02e783b05605a65deb2ff25b10b3?s=128&d=identicon&r=PG&f=1", "display_name": "Kittu", "link": "https://stackoverflow.com/users/7719071/kittu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1492009155, "creation_date": 1491996774, "last_edit_date": 1531164843, "question_id": 43368360, "link": "https://stackoverflow.com/questions/43368360/find-a-specific-header-and-insert-a-row-above-it-and-insert-some-value", "title": "find a specific header and insert a row above it and insert some value", "body": "<p>I am trying to find a specific header and trying to insert a row above it and insert some value </p>\n\n<p>for example sheet called \"System\" in (A1:Q1) if its find header as \"assignee\" in G column,  it should inert a row above it and paste value as \" Open with assignee\" in G column</p>\n\n<p>in the same way it should check entire G column and if its finds next assignee it should insert a row above it and paste value as \" Open with customer \" in G column </p>\n\n<p>can anyone help me with vba code</p>\n"}, {"tags": ["excel", "sharepoint", "vba"], "comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1492007266, "post_id": 43368159, "comment_id": 73806684, "body": "I think the link below will help you get oriented. <a href=\"http://sharepoint.stackexchange.com/questions/11426/update-list-from-excel-using-vba\" title=\"update list from excel using vba\">sharepoint.stackexchange.com/questions/11426/&hellip;</a>"}, {"owner": {"reputation": 55, "user_id": 7629532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b114af3cbb5d8f6d4967dd5cf8fc3a45?s=128&d=identicon&r=PG&f=1", "display_name": "L.Horvath", "link": "https://stackoverflow.com/users/7629532/l-horvath"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1492590680, "post_id": 43368159, "comment_id": 74035646, "body": "Thanks for your answer, but i dont think, this is what i meant. I dont want to edit lists in excel, but in sharepoint. For example change status, add comments and so on."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7629532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b114af3cbb5d8f6d4967dd5cf8fc3a45?s=128&d=identicon&r=PG&f=1", "display_name": "L.Horvath", "link": "https://stackoverflow.com/users/7629532/l-horvath"}, "edited": false, "score": 0, "creation_date": 1496241450, "post_id": 43883120, "comment_id": 75582139, "body": "Thanks a lot, it was so helpful and solved my problems"}, {"owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "reply_to_user": {"reputation": 55, "user_id": 7629532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b114af3cbb5d8f6d4967dd5cf8fc3a45?s=128&d=identicon&r=PG&f=1", "display_name": "L.Horvath", "link": "https://stackoverflow.com/users/7629532/l-horvath"}, "edited": false, "score": 0, "creation_date": 1496423600, "post_id": 43883120, "comment_id": 75672157, "body": "@L.Horvath No problem,  please mark it as the right answer if everything worked out for you!"}], "tags": [], "owner": {"reputation": 886, "user_id": 6401734, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/87dbeb33da7c89f7b7a55a8bcf792301?s=128&d=identicon&r=PG&f=1", "display_name": "MattE", "link": "https://stackoverflow.com/users/6401734/matte"}, "is_accepted": true, "score": 3, "last_activity_date": 1494386854, "creation_date": 1494386854, "answer_id": 43883120, "question_id": 43368159, "link": "https://stackoverflow.com/questions/43368159/edit-sharepoint-list-with-macro/43883120#43883120", "title": "Edit sharepoint list with macro", "body": "<p>These tutorials should give you what you need to know...excellent and well done, they show you how to do it via Listobjects and via SQL</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=nM-gq3N6f2E\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=nM-gq3N6f2E</a></p>\n\n<p>There is a series of 13 videos.</p>\n"}], "owner": {"reputation": 55, "user_id": 7629532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b114af3cbb5d8f6d4967dd5cf8fc3a45?s=128&d=identicon&r=PG&f=1", "display_name": "L.Horvath", "link": "https://stackoverflow.com/users/7629532/l-horvath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1512, "favorite_count": 2, "accepted_answer_id": 43883120, "answer_count": 1, "score": 4, "last_activity_date": 1494386854, "creation_date": 1491996140, "last_edit_date": 1531164843, "question_id": 43368159, "link": "https://stackoverflow.com/questions/43368159/edit-sharepoint-list-with-macro", "title": "Edit sharepoint list with macro", "body": "<p>I need to change the status and write comments for about 100 lists in SharePoint every week.  I tried to automate it. I know how to open them in edit mode with a macro, but I don't know how to change status or how to write a comment with a macro, any ideas? </p>\n\n<p>Here is my code: </p>\n\n<pre><code>Sub TT()\n  Dim ie(40) As Object, obj As Object\n  Dim cislo As String\n  For i = 0 To 40\n    If Cells(i + 2, 1).Value = \"\" Then\n      Exit Sub\n    End If\n    Set ie(i) = CreateObject(\"Internetexplorer.Application\")\n    ie(i).Visible = True\n    ie(i).Navigate \"http://adress of sharepoint list .com\"\n    Do While ie(i).Busy\n    Loop\n  Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1491995116, "post_id": 43367671, "comment_id": 73797274, "body": "can you post your code inside your <code>For Each xFile In xFolder.Files</code> , when I&#39;m testing it with <code>bgd.Range(&quot;D&quot; &amp; i).Value = xFile.Name</code> it shows me all my file names in column &quot;D&quot;."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1491995721, "post_id": 43367671, "comment_id": 73797716, "body": "Just irritated why did you declare these variables as <code>global</code> at least for <code>Global xFile As Scripting.File</code> it doesn&#39;t make any sense to have this <code>global</code>?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1491997599, "post_id": 43367671, "comment_id": 73799025, "body": "What are your error settings? If it goes directly to the <code>End Sub</code> it probably means that there is an error generated that is masked by the settings. Check the Err object."}, {"owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491998523, "post_id": 43367671, "comment_id": 73799563, "body": "@peh - no reason why they&#39;re global to be honest, usually I use these same variable names in much larger projects where the variables are used outside of a single routine... I guess I just did that as force of habit :)"}, {"owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1491998668, "post_id": 43367671, "comment_id": 73799666, "body": "@VincentG - there are no error handling in the code, and the general idea is one that I&#39;ve used 100s of times successfully in the past. If I add an error handler, it doesn&#39;t get called, suggesting there&#39;s no actual error"}, {"owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491998778, "post_id": 43367671, "comment_id": 73799768, "body": "@ShaiRado the code within the script doesn&#39;t seem to make a difference - I&#39;ve tried it with &quot;Debug.Print 1&quot; on each iteration but it still doesn&#39;t work even with that"}], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "edited": false, "score": 0, "creation_date": 1492001661, "post_id": 43369428, "comment_id": 73801989, "body": "Thanks @Peh - you&#39;re absolutely right on the subject of global variables, it&#39;s just that I&#39;ve used those variables out of necessity as Globals in other instances so many times I just end up typing them out naturally like that!"}, {"owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "edited": false, "score": 0, "creation_date": 1492001760, "post_id": 43369428, "comment_id": 73802075, "body": "Your post was very helpful in another sense - when testing the code on a different folder it works as expected, so it must be something about the (network) folder I was trying to access - possibly a case of security/folder permissions or so on."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "edited": false, "score": 0, "creation_date": 1492002886, "post_id": 43369428, "comment_id": 73802982, "body": "Therefore I always start with a minimal example as simple as possible. If it works you are on the right track and can go more into detail. If it fails you immediately found your issue. Otherwise you run into analyzing the details and end up with something fundamental being wrong after several hours of searching if you start debugging from the wrong side."}, {"owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "edited": false, "score": 0, "creation_date": 1492004313, "post_id": 43369428, "comment_id": 73804202, "body": "I didn&#39;t think to change the folder tbh, since the variable xFolder was assigning properly, but again you&#39;re absolutely spot-on, I should&#39;ve thought to test it. Still, nevermind, I finally joined StackOverflow on the back of this query after years of just being a visitor so one good thing has come of it! :)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1506010709, "last_edit_date": 1506010709, "creation_date": 1491999789, "answer_id": 43369428, "question_id": 43367671, "link": "https://stackoverflow.com/questions/43367671/vba-excel-iterating-through-files-in-folder-via-filesystemobject/43369428#43369428", "title": "VBA (Excel): Iterating through files in folder via FileSystemObject", "body": "<p>This is a working minimal example:</p>\n\n<ol>\n<li>Create a new file</li>\n<li>Reference the Microsoft scripting Runtime</li>\n<li>Create a sheet named <code>BGD</code> and write an existing path into <code>C4</code> e.g. <code>C:\\Windows</code></li>\n<li>Paste the code below into a module and run it</li>\n</ol>\n\n<p>This lists the path and all filenames in the debug window.</p>\n\n<pre><code>Public Sub GetData()\n    Dim bgd As Worksheet\n    Dim myFSO As FileSystemObject\n    Dim xFolder As Scripting.Folder\n    Dim xFile As Scripting.File\n\n\n    Set bgd = ThisWorkbook.Sheets(\"BGD\")\n    Set myFSO = New FileSystemObject\n    Set xFolder = myFSO.GetFolder(bgd.Range(\"C4\").Value)\n\n    Debug.Print xFolder.Path\n    For Each xFile In xFolder.Files\n        Debug.Print xFile.Name\n    Next xFile\n\nEnd Sub\n</code></pre>\n\n<p>If you need the variables locally then declare them locally instead of global. Anything else is very bad practice and leads into errors.</p>\n"}, {"comments": [{"owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "edited": false, "score": 0, "creation_date": 1492007766, "post_id": 43372121, "comment_id": 73807126, "body": "Hi @ryguy72, I&#39;m not looking to list the folder contents; the code nested within the For Each statement opens the files and performs actions on the worksheets within those files. Really, it was not the nested code that was the issue, it was a specific instance of this For Each loop not working. Turns out that it is probably to do with the folder&#39;s security settings or permissions, as another folder worked fine with the same code."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1492006508, "creation_date": 1492006508, "answer_id": 43372121, "question_id": 43367671, "link": "https://stackoverflow.com/questions/43367671/vba-excel-iterating-through-files-in-folder-via-filesystemobject/43372121#43372121", "title": "VBA (Excel): Iterating through files in folder via FileSystemObject", "body": "<p>I  think you want to list all files in all folders and all sub-folders. Check out this link.</p>\n\n<p><a href=\"http://www.learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/\" rel=\"nofollow noreferrer\">http://www.learnexcelmacro.com/wp/2011/11/how-to-get-list-of-all-files-in-a-folder-and-sub-folders/</a></p>\n\n<p>Download the file; that's the way to go. Once all paths and all file names are listed in your Excel worksheet, you can do all kinds of comparisons, manipulations, and the like.</p>\n\n<pre><code> Sub GetFilesInFolder(SourceFolderName As String)  \n\n    '--- For Example:Folder Name= \"D:\\Folder Name\\\"  \n\n    Dim FSO As Scripting.FileSystemObject  \n    Dim SourceFolder As Scripting.folder, SubFolder As Scripting.folder  \n    Dim FileItem As Scripting.File  \n\n        Set FSO = New Scripting.FileSystemObject  \n        Set SourceFolder = FSO.GetFolder(SourceFolderName)  \n\n        '--- This is for displaying, whereever you want can be configured  \n\n        r = 14  \n        For Each FileItem In SourceFolder.Files  \n            Cells(r, 2).Formula = r - 13  \n            Cells(r, 3).Formula = FileItem.Name  \n            Cells(r, 4).Formula = FileItem.Path  \n            Cells(r, 5).Formula = FileItem.Size  \n            Cells(r, 6).Formula = FileItem.Type  \n            Cells(r, 7).Formula = FileItem.DateLastModified  \n            Cells(r, 8).Formula = \"=HYPERLINK(\"\"\" &amp; FileItem.Path &amp; \"\"\",\"\"\" &amp; \"Click Here to Open\" &amp; \"\"\")\"  \n\n            r = r + 1   ' next row number  \n        Next FileItem  \n\n        Set FileItem = Nothing  \n        Set SourceFolder = Nothing  \n        Set FSO = Nothing  \n    End Sub  \n\n\nSub GetFilesInFolder(SourceFolderName As String, Subfolders As Boolean)  \n\n'--- For Example:Folder Name= \"D:\\Folder Name\\\" and Flag as Yes or No  \n\nDim FSO As Scripting.FileSystemObject  \nDim SourceFolder As Scripting.folder, SubFolder As Scripting.folder  \nDim FileItem As Scripting.File  \n'Dim r As Long  \n    Set FSO = New Scripting.FileSystemObject  \n    Set SourceFolder = FSO.GetFolder(SourceFolderName)  \n\n    '--- This is for displaying, whereever you want can be configured  \n\n    r = 14  \n    For Each FileItem In SourceFolder.Files  \n        Cells(r, 2).Formula = r - 13  \n        Cells(r, 3).Formula = FileItem.Name  \n        Cells(r, 4).Formula = FileItem.Path  \n        Cells(r, 5).Formula = FileItem.Size  \n        Cells(r, 6).Formula = FileItem.Type  \n        Cells(r, 7).Formula = FileItem.DateLastModified  \n        Cells(r, 8).Formula = \"=HYPERLINK(\"\"\" &amp; FileItem.Path &amp; \"\"\",\"\"\" &amp; \"Click Here to Open\" &amp; \"\"\")\"  \n\n        r = r + 1   ' next row number  \n    Next FileItem  \n\n    '--- This is the Function to go each and Every Folder and get the Files. This is a Nested-Function Calling.  \n\n    If Subfolders = True Then  \n        For Each SubFolder In SourceFolder.Subfolders  \n            ListFilesInFolder SubFolder.Path, True  \n        Next SubFolder  \n    End If  \n\n    Set FileItem = Nothing  \n    Set SourceFolder = Nothing  \n    Set FSO = Nothing  \nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "is_accepted": false, "score": 0, "last_activity_date": 1492008048, "creation_date": 1492008048, "answer_id": 43372735, "question_id": 43367671, "link": "https://stackoverflow.com/questions/43367671/vba-excel-iterating-through-files-in-folder-via-filesystemobject/43372735#43372735", "title": "VBA (Excel): Iterating through files in folder via FileSystemObject", "body": "<p>Ok - turns out the issue was actually with the folder and not the code. As pointed out by @Peh, I should have tested the code with another folder, as well as testing variations of the code itself. When using another folder, the <code>For Each</code> code worked fine. As stated in the OP, I just used <code>For i = 1 to xFolder.Files.Count</code> rather than <code>For Each</code> and got the result I needed, but I prefer the object-led approach of <code>For Each</code> rather than using an integer/long variable to go through the item count, and wanted to know why that method wasn't working.</p>\n\n<p>To get the <code>For Each</code> code working, I copied the desired files to a different folder and it worked perfectly well. As the original folder was a network location, there was possibly some folder permissions or security setting preventing me from using the code I wanted to.</p>\n"}], "owner": {"reputation": 58, "user_id": 7855712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66c862956b667f83d883eb93d5730b7?s=128&d=identicon&r=PG&f=1", "display_name": "SlashnBurn92", "link": "https://stackoverflow.com/users/7855712/slashnburn92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11669, "favorite_count": 3, "accepted_answer_id": 43369428, "answer_count": 3, "score": 0, "last_activity_date": 1506010709, "creation_date": 1491994717, "question_id": 43367671, "link": "https://stackoverflow.com/questions/43367671/vba-excel-iterating-through-files-in-folder-via-filesystemobject", "title": "VBA (Excel): Iterating through files in folder via FileSystemObject", "body": "<p>Ok, so I consider myself an Excel VBA expert (even though I've not done much with it for a while) but I'm stumped on this one - that obviously means it is something extremely simple which I've overlooked due to my arrogance :D</p>\n\n<p>I'm using a FileSystemObject assigned to a global variable (called \"myFSO\" - original, I know...) and using two other global variables - xFolder and xFile - to iterate through all the files within a folder, and perform actions on each file within the folder.</p>\n\n<p>This is the code:</p>\n\n<pre><code>Global myFSO As FileSystemObject\nGlobal xFolder As Scripting.Folder\nGlobal xFile As Scripting.File\n\nPublic Sub GetData()\n\nSet bgd = ThisWorkbook.Sheets(\"BGD\")\nSet myFSO = New FileSystemObject\nSet xFolder = myFSO.GetFolder(bgd.Range(\"C4\").Value)\n\nFor Each xFile In xFolder.Files\n          &lt;do stuff here&gt;\nNext xFile\n\nEnd Sub\n</code></pre>\n\n<p>So, when I step through the code, I can see that the xFolder is being assigned correctly. If I add a Watch or insert</p>\n\n<pre><code>Debug.Print xFolder.Files.Count\n</code></pre>\n\n<p>into the code, it returns the correct file count, so everything seems to be setup fine to go into the For loop and do what it needs to do.</p>\n\n<p>Once I step past the For Each... statement line however the code just runs to the end of the routine, completely missing out the whole of the code nested within the For Each... Next code. It doesn't even go to the \"Next xFile\" line. If I modify the loop to </p>\n\n<pre><code>For i = 1 to xFolder.Files.Count\n</code></pre>\n\n<p>and do the process that way, it works OK. So, it's not a matter of life-and-death since I can do what I want to do, I just wanted to know if anyone could tell why the \"For Each\" method hasn't worked.</p>\n"}, {"tags": ["vba", "web-scraping"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 2, "creation_date": 1491996194, "post_id": 43367518, "comment_id": 73798065, "body": "When you press the <code>search</code> button, then a request goes to the server and data are returned as <code>json</code>. This data are then displayed in the grid. Sou what you could try is to press the <code>search</code> button programmatically first, wait until the data will be displayed in the grid and then filter the elements by class name."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1491997143, "post_id": 43367518, "comment_id": 73798735, "body": "Right you are sir dee. I also noticed it in the first place but can&#39;t go further as i can&#39;t think of clicking that button using xmlhttp request method. Thanks."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1492019508, "post_id": 43367518, "comment_id": 73814962, "body": "Yes but you can try to use IE object. Then it is possible to click. Or you can just call <code>https:&#47;&#47;jobboerse2.arbeitsagentur.de&#47;jobsuche&#47;pc&#47;v1&#47;jobs?FCT&zwnj;&#8203;.AKTUALITAET=100&amp;FCT&zwnj;&#8203;.ANGEBOTSART=ARBEIT&amp;&zwnj;&#8203;FCT.BEHINDERUNG=AUS</code> and <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">parse</a> the returned <code>json</code> in VBA yourself."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1492019959, "post_id": 43367518, "comment_id": 73815218, "body": "Thanks sir dee for your response. You are very close to what i&#39;m looking for. I also found one &quot;<a href=\"https://jobboerse2.arbeitsagentur.de/jobsuche/pc/v1/jobs\" rel=\"nofollow noreferrer\">jobboerse2.arbeitsagentur.de/jobsuche/pc/v1/jobs</a>&quot;. However, is there any way to get all the links, as in your one and my one so that i can finally make use of those links using json or jscript cause you know the page holds lazy loading method?"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1492029761, "post_id": 43367518, "comment_id": 73820710, "body": "Oh yes you are right,the page doesn&#39;t display all the results at once, because there could be potentially to many items. Instead the result is load by parts. When you watch the url you see there is query string parameter like this <code>&amp;offset=12</code>. This parameter has values from 12, 24, 36, 48, 50 etc. So in 12-record steps. So you&#39;ll have to have a loop and will send your requests changing this parameter <code>offset</code> for each call. When the result is empty (or perhaps an error occurs???) then you reached the end of the data and you know there are no other data on the server."}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1492023420, "creation_date": 1491994338, "last_edit_date": 1492023420, "question_id": 43367518, "link": "https://stackoverflow.com/questions/43367518/trouble-scraping-the-names-from-a-certain-website", "title": "Trouble scraping the names from a certain website", "body": "<p>I've come across such a webpage which seems to me a bit misleading\nto scrape. When I go the address \"<a href=\"https://jobboerse2.arbeitsagentur.de/jobsuche/?s=1\" rel=\"nofollow noreferrer\">https://jobboerse2.arbeitsagentur.de/jobsuche/?s=1</a>\" it takes me to a page with \"suchen\" option. After clicking \"suchen\" it opens a new layout within this tab and takes me to a page with lots of names. So, the site address is same again \"<a href=\"https://jobboerse2.arbeitsagentur.de/jobsuche/?s=1\" rel=\"nofollow noreferrer\">https://jobboerse2.arbeitsagentur.de/jobsuche/?s=1</a>\".\nI would like to scrape the names of that page, as in \"Mitarbeiter f\u00fcr die Leerguttrennung (m/w)\". Any help would be highly appreciated.\nWhat I wrote so far:</p>\n\n<pre><code>Sub WebData()\n    Dim http As New MSXML2.xmlhttp60\n    Dim html As New htmldocument, source As Object, item As Object\n\n    With http\n        .Open \"GET\", \"https://jobboerse2.arbeitsagentur.de/jobsuche/?s=1\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n    Set source = html.getElementsByClassName(\"ng-binding ng-scope\")\n    For Each item In source\n        x = x + 1\n        Cells(x, 1) = item.innerText\n    Next item\n    Set html = Nothing: Set source = Nothing\nEnd Sub\n</code></pre>\n\n<p>The links are incremented like these as per xhr in developer tool but can't figure out what is the number of the last link.</p>\n\n<p>\"<a href=\"https://jobboerse2.arbeitsagentur.de/jobsuche/pc/v1/jobs\" rel=\"nofollow noreferrer\">https://jobboerse2.arbeitsagentur.de/jobsuche/pc/v1/jobs</a>\"\n\"<a href=\"https://jobboerse2.arbeitsagentur.d...00&amp;FCT.ANGEBOTSART=ARBEIT&amp;FCT.BEHINDERUNG=AUS\" rel=\"nofollow noreferrer\">https://jobboerse2.arbeitsagentur.d...00&amp;FCT.ANGEBOTSART=ARBEIT&amp;FCT.BEHINDERUNG=AUS</a>\"\n\"<a href=\"https://jobboerse2.arbeitsagentur.d...EBOTSART=ARBEIT&amp;FCT.BEHINDERUNG=AUS&amp;offset=12\" rel=\"nofollow noreferrer\">https://jobboerse2.arbeitsagentur.d...EBOTSART=ARBEIT&amp;FCT.BEHINDERUNG=AUS&amp;offset=12</a>\"\n\"<a href=\"https://jobboerse2.arbeitsagentur.d...EBOTSART=ARBEIT&amp;FCT.BEHINDERUNG=AUS&amp;offset=24\" rel=\"nofollow noreferrer\">https://jobboerse2.arbeitsagentur.d...EBOTSART=ARBEIT&amp;FCT.BEHINDERUNG=AUS&amp;offset=24</a>\"\n\"<a href=\"https://jobboerse2.arbeitsagentur.d...EBOTSART=ARBEIT&amp;FCT.BEHINDERUNG=AUS&amp;offset=36\" rel=\"nofollow noreferrer\">https://jobboerse2.arbeitsagentur.d...EBOTSART=ARBEIT&amp;FCT.BEHINDERUNG=AUS&amp;offset=36</a>\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1491996852, "post_id": 43367496, "comment_id": 73798532, "body": "This is not possible with <code>.OnKey</code>. Also Excel is not meant for coding a keyboard it is meant for calculating. Therefore you chose the wrong tool. But you might have a look at <a href=\"https://autohotkey.com/\" rel=\"nofollow noreferrer\">AutoHotkey</a>."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 2, "creation_date": 1492002487, "post_id": 43367496, "comment_id": 73802664, "body": "Maybe use the event &quot;keydown&quot;?"}], "owner": {"reputation": 29, "user_id": 6762721, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/00ea13260a691b8b37b8da501aba717b?s=128&d=identicon&r=PG&f=1", "display_name": "Serveira", "link": "https://stackoverflow.com/users/6762721/serveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1491994267, "creation_date": 1491994267, "last_edit_date": 1531164843, "question_id": 43367496, "link": "https://stackoverflow.com/questions/43367496/application-onkey-triggered-by-two-keys", "title": "Application.OnKey triggered by two keys", "body": "<p>I want to develop a kind of stenotype typing keyboard, but for that to work I'd need that a macro is triggered only when two, three or four keys are pressed simultaneously, just as it works with Shift, Alt, Ctrl, i.e:</p>\n\n<pre><code>Application.OnKey \"+^%{RIGHT}\", \"macro\"\n</code></pre>\n\n<p>Is there any simple way to achieve that? Because I'd need to program a few hundreds of combinations for it to work properly.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 4714419, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/268ac063e1f078b7d7ebdabdbe376a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Fuller", "link": "https://stackoverflow.com/users/4714419/fuller"}, "edited": false, "score": 1, "creation_date": 1492001473, "post_id": 43367333, "comment_id": 73801815, "body": "Thanks for the reply.  I am a bit confused on the organising my source data in the way you suggested as I dont see how I can process 150 different items like this? Wouldn&#39;t it make sense to have the field names in separate columns? such as:       A Title   B: Names    C: Floor and then under these columns have the required data, as i have 150 items of data for each.  For example. The data would be Title: PSE, Name: Jamie: Floor: 2 - submit this form and then move to the next row where the next data is another person to complete the form."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 159, "user_id": 4714419, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/268ac063e1f078b7d7ebdabdbe376a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Fuller", "link": "https://stackoverflow.com/users/4714419/fuller"}, "edited": false, "score": 0, "creation_date": 1492002957, "post_id": 43367333, "comment_id": 73803033, "body": "You can do that way.  It doesn&#39;t really matter if you use rows or columns.  Either way, you still need to complete the same number of cells in Excel (300 - 150 names and 150 values).  I&#39;ll add the columns version."}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": true, "score": 2, "last_activity_date": 1492003140, "last_edit_date": 1492003140, "creation_date": 1491993810, "answer_id": 43367333, "question_id": 43367069, "link": "https://stackoverflow.com/questions/43367069/loop-through-rows-of-data-to-submit-web-form/43367333#43367333", "title": "loop through rows of data to submit web form", "body": "<p>The trick here is to organise your source data.  Using two columns you can record the field name and the required value:</p>\n\n<pre><code>    A           B\n1   Title       Sample Title\n2   Names       Sample Names\n3   Floor       Sample Floor\n</code></pre>\n\n<p>To loop:</p>\n\n<pre><code>Sub AutoLoadAccounts()\n\n    Dim IE As Object\n    Dim cRow As Range       ' Current row, used to extract values from Excel.\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Navigate \"https://www.urlhere.com/admin/accounts/create\"\n    IE.Visible = True\n\n    While IE.busy\n    DoEvents\n    Wend\n\n    ' Executes once for each row in the source range.\n    For Each cRow In ThisWorkbook.Sheets(\"sheet1\").Range(\"A1:A3\")\n\n        ' Read field name and value from current row.\n        IE.Document.All(cRow.Value).Value = cRow.Offset(0, 1)\n    Next\n\n\n    IE.Document.All(\"submit\").Click\nEnd Sub\n</code></pre>\n\n<p>This code could be improved.  At the moment the source range is hard coded (<code>Range(\"A1:A3\")</code>).  You could improve this, so the code automatically identifies all completed rows in Excel.  If you are interested research the worksheets <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.worksheet.usedrange.aspx\" rel=\"nofollow noreferrer\">UsedRange object</a>.</p>\n\n<p><strong>EDIT</strong><br>\nAdded example that reads source data from columns, not rows.</p>\n\n<pre><code>Sub AutoLoadAccounts_Columns()\n\n    Dim IE As Object\n    Dim cRow As Range       ' Current row, used to extract values from Excel.\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Navigate \"https://www.urlhere.com/admin/accounts/create\"\n    IE.Visible = True\n\n    While IE.busy\n    DoEvents\n    Wend\n\n    ' Executes once for each row in the source range.\n    For Each cRow In ThisWorkbook.Sheets(\"sheet1\").Range(\"A1:C1\")\n\n        ' Read field name and value from current row.\n        IE.Document.All(cRow.Value).Value = cRow.Offset(1, 0).Value\n    Next\n\n\n    IE.Document.All(\"submit\").Click\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 4714419, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/268ac063e1f078b7d7ebdabdbe376a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Fuller", "link": "https://stackoverflow.com/users/4714419/fuller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 2, "accepted_answer_id": 43367333, "answer_count": 1, "score": 0, "last_activity_date": 1492003140, "creation_date": 1491993105, "question_id": 43367069, "link": "https://stackoverflow.com/questions/43367069/loop-through-rows-of-data-to-submit-web-form", "title": "loop through rows of data to submit web form", "body": "<pre><code>    Sub AutoLoadAccounts()\n\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Navigate \"https://www.urlhere.com/admin/accounts/create\"\n    IE.Visible = True\n\n    While IE.busy\n    DoEvents\n    Wend\n\n    IE.Document.All(\"title\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"a1\")\n    IE.Document.All(\"names\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"b1\")\n    IE.Document.All(\"floor\").Value = 30\n    IE.Document.getElementById(\"status\").selectedindex = 1\n    IE.Document.getElementById(\"email_state\").selectedindex = 1\n    IE.Document.All(\"id\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"c1\")\n    IE.Document.All(\"years\").Value = ThisWorkbook.Sheets(\"sheet1\").Range(\"d1\")\n    IE.Document.All(\"submit\").Click\n\nEnd Sub\n</code></pre>\n\n<p>The above code I use to populate a web form and submit it. I have around 150 rows of data ranging from A1:D1. I am trying to find a way to loop through the rows 1 by 1 after submitting the form until it reaches the end.</p>\n\n<p>So essentially it will start on the first row and populate the fields from A1:D1, then once complete go down to the next row and do the same for A2:D2. and so on</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007", "ms-access-2013"], "comments": [{"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 1, "creation_date": 1492024052, "post_id": 43366381, "comment_id": 73817449, "body": "You probably want to export the data to Word, and then use VBA to change the <code>activedocument.tables</code> object properties in the word document from Access.  For example, to create the border tables,  <code>.borders.enable = true</code> property with the above object will create table around your data.  Use <code>.columns(x).width</code> to set column widths."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7639379, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/0063649fd423b8f47af7ca0f3a556956?s=128&d=identicon&r=PG&f=1", "display_name": "Mitra", "link": "https://stackoverflow.com/users/7639379/mitra"}, "edited": false, "score": 1, "creation_date": 1492009312, "post_id": 43371987, "comment_id": 73808448, "body": "thanks alot, I already tried it.it works when I creat report in access. but problem is , now I want to export report in word (RTF)[EXternal Dat tab-&gt;export section-&gt; more-&gt; to word which gives in RTF] . but then in word; I dont have those lines, I have just data without tables ."}, {"owner": {"reputation": 49, "user_id": 7761048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda05b7572defe67df184aedf1cbafbe?s=128&d=identicon&r=PG&f=1", "display_name": "TDolph", "link": "https://stackoverflow.com/users/7761048/tdolph"}, "reply_to_user": {"reputation": 35, "user_id": 7639379, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/0063649fd423b8f47af7ca0f3a556956?s=128&d=identicon&r=PG&f=1", "display_name": "Mitra", "link": "https://stackoverflow.com/users/7639379/mitra"}, "edited": false, "score": 0, "creation_date": 1492066207, "post_id": 43371987, "comment_id": 73832209, "body": "Would it be possible for you to export it into Excel and then add the Excel spreadsheet into word document?"}], "tags": [], "owner": {"reputation": 49, "user_id": 7761048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda05b7572defe67df184aedf1cbafbe?s=128&d=identicon&r=PG&f=1", "display_name": "TDolph", "link": "https://stackoverflow.com/users/7761048/tdolph"}, "is_accepted": false, "score": 1, "last_activity_date": 1492006194, "creation_date": 1492006194, "answer_id": 43371987, "question_id": 43366381, "link": "https://stackoverflow.com/questions/43366381/in-access-how-to-draw-tables-on-report-and-then-export-it-on-word/43371987#43371987", "title": "in access how to draw tables on Report and then export it on word", "body": "<p>Once you have added your fields into your report, if you select the ones you want in a table, you can select stacked or tabular in the 'Arrange' tab in 'Design view'. This will arrange the fields in columns or rows. You can then add labels and text boxes wherever you want in relation to the table you have created. </p>\n\n<p>You can also change the format of the table by accessing the property sheet for each or multiple table \"cells\" and changing gridline properties in the 'Format' tab.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 7639379, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/0063649fd423b8f47af7ca0f3a556956?s=128&d=identicon&r=PG&f=1", "display_name": "Mitra", "link": "https://stackoverflow.com/users/7639379/mitra"}, "edited": false, "score": 1, "creation_date": 1492007418, "post_id": 43372198, "comment_id": 73806817, "body": "thanks alot.I exactly watched  first video before writing a question. &#180;( I dont know who gave negetive grade but solution is not there).  this video helps to draw table in report I also used that method to draw tables . but problem is when I export my report in word (RTF) then those line will be vanished.   In pdf format i have those lines."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1492006728, "creation_date": 1492006728, "answer_id": 43372198, "question_id": 43366381, "link": "https://stackoverflow.com/questions/43366381/in-access-how-to-draw-tables-on-report-and-then-export-it-on-word/43372198#43372198", "title": "in access how to draw tables on Report and then export it on word", "body": "<p>Check out the YouTube video below.  It does exactly what you want.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=-xqk8-dRwBY\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=-xqk8-dRwBY</a></p>\n\n<p>Also, check out this link, to see how to save a Report to a PDF.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=43gbFu3eC54\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=43gbFu3eC54</a></p>\n"}], "owner": {"reputation": 35, "user_id": 7639379, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/0063649fd423b8f47af7ca0f3a556956?s=128&d=identicon&r=PG&f=1", "display_name": "Mitra", "link": "https://stackoverflow.com/users/7639379/mitra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1007, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1492336511, "creation_date": 1491991348, "last_edit_date": 1492336511, "question_id": 43366381, "link": "https://stackoverflow.com/questions/43366381/in-access-how-to-draw-tables-on-report-and-then-export-it-on-word", "title": "in access how to draw tables on Report and then export it on word", "body": "<p>I need to draw a table within report, I tried to use line  (from controls in design tab in design view) and I it works , I have tables in report . but I need to export my report in word , and pdf . For pdf I can see tables that I created, but in word I dont have tables. Are there other ways to create tables within report? </p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1491991207, "post_id": 43366273, "comment_id": 73794304, "body": "<code>WorkSheetsFunc</code> ?? should be <code>WorksheetFunction</code> , just a Typo, Don&#39;t forget to qualify <code>Cells(rrow, 4).Value</code> with it&#39;s <code>Worksheet</code>"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1491991918, "post_id": 43366273, "comment_id": 73794797, "body": "Your lookup range is a single column but you are looking for a result in the 3rd column of the lookup range."}, {"owner": {"reputation": 361, "user_id": 6463709, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/70b2a236a6ac8fbd1297149fc9bd976c?s=128&d=identicon&r=PG&f=1", "display_name": "decemberrobot", "link": "https://stackoverflow.com/users/6463709/decemberrobot"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1491992111, "post_id": 43366273, "comment_id": 73794956, "body": "@MarkFitzgerald I changed it to Range(&quot;A5693:L5843&quot;) but it prompts me an error saying subscript out of range"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1491992355, "post_id": 43366273, "comment_id": 73795111, "body": "Is <code>rrow</code> defined as a long?  What is its value when called?"}, {"owner": {"reputation": 361, "user_id": 6463709, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/70b2a236a6ac8fbd1297149fc9bd976c?s=128&d=identicon&r=PG&f=1", "display_name": "decemberrobot", "link": "https://stackoverflow.com/users/6463709/decemberrobot"}, "edited": false, "score": 0, "creation_date": 1491992667, "post_id": 43366273, "comment_id": 73795360, "body": "I am running a For loop to loop through all the rows in my current sheet. I declared it as For rrow = 7 to 200"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491997558, "post_id": 43366273, "comment_id": 73799000, "body": "1. Make sure that the sheet <code>Address</code> exists or you get error 9 out of range (check for typos). 2. If your lookup range is <code>Range(&quot;A5693:L5843&quot;)</code> then the value of <code>Cells(rrow, 4).Value</code> has to exist in row <code>A5693</code> to <code>A5843</code> if not it will throw an error 1004."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1491999351, "post_id": 43366273, "comment_id": 73800224, "body": "<code>Tools \u25ba Options \u25ba set Require Variable Declaration</code>.  Put <code>Option Explicit</code> at top of your macro and declare all variables.  Step through your code to see if the values show what they should.  Post back with the rest of your code if still an issue."}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 2, "last_activity_date": 1492000461, "creation_date": 1492000461, "answer_id": 43369687, "question_id": 43366273, "link": "https://stackoverflow.com/questions/43366273/vlookup-in-excel-macro/43369687#43369687", "title": "Vlookup in excel macro", "body": "<p>Few suggestions:</p>\n\n<p>Qualify the lookup value Cells(rrow, 4).Value with the sheet reference. Which sheet this cell belongs to? Otherwise it will refer to the activesheet only.\nAlso make sure rrow is not null in the code.</p>\n\n<p>When retrieving the value through VLookUp, first check if the lookup value is found in lookup column and if yes, proceed for Vlookup to get the desired value from the desired column.\nConsidering lookup_table is Range(\"A5693:L5843\"), the lookup value must be present in the first column i.e. in this case Range(\"A5693:A5843\").</p>\n\n<pre><code>If Application.CountIf(Sheets(\"Address\").Range(\"A5693:A5843\"), Cells(rrow, 4).Value) &gt; 0 Then\n    Sheets(\"Details\").Cells(rrow, 9).Value = Application.WorkSheetsFunc.VLookup(Cells(rrow, 4).Value, Sheets(\"Address\").Range(\"G5693:G5843\"), 3, False)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 6463709, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/70b2a236a6ac8fbd1297149fc9bd976c?s=128&d=identicon&r=PG&f=1", "display_name": "decemberrobot", "link": "https://stackoverflow.com/users/6463709/decemberrobot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1492000461, "creation_date": 1491991067, "last_edit_date": 1491991294, "question_id": 43366273, "link": "https://stackoverflow.com/questions/43366273/vlookup-in-excel-macro", "title": "Vlookup in excel macro", "body": "<p>I am trying to retrieve the value based on a key in another excel sheet but it does not seem to be retrieving it so I am wondering if my code is correct:</p>\n\n<pre><code>Sheets(\"Details\").Cells(rrow, 9).Value = Application.WorkSheetsFunc.VLookup(Cells(rrow, 4).Value, Sheets(\"Address\").Range(\"G5693:G5843\"), 3, False) \n</code></pre>\n\n<p>Anybody know if the syntax is correct or is anything wrong with my code ?</p>\n"}, {"tags": ["vba", "excel", "textbox", "userform"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1491991751, "post_id": 43366045, "comment_id": 73794687, "body": "Could you show more code to put in context, particularly where the X in your <code>Select Case X</code> is coming from?"}, {"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1491991997, "post_id": 43366045, "comment_id": 73794876, "body": "X is the value inserted in the textbox, Y is the value that will be returned into the sheet."}], "answers": [{"comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "edited": false, "score": 0, "creation_date": 1491993542, "post_id": 43366444, "comment_id": 73796034, "body": "If value in Sheet2.Range(&quot;P&quot; &amp; findstart + counter - 1) is say 0.5, it will be displayed in textbox as 1/2."}, {"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "edited": false, "score": 0, "creation_date": 1491993945, "post_id": 43366444, "comment_id": 73796373, "body": "but it does not show as 1/2 in textbox. The value in the sheet is 0.5"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "edited": false, "score": 0, "creation_date": 1491994258, "post_id": 43366444, "comment_id": 73796590, "body": "It does when I checked it. See it here  <a href=\"https://www.dropbox.com/s/13d2chvmmgxih0m/DecimalToFraction.xlsm?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/13d2chvmmgxih0m/DecimalToFraction.xlsm?dl=0</a>"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1491991537, "creation_date": 1491991537, "answer_id": 43366444, "question_id": 43366045, "link": "https://stackoverflow.com/questions/43366045/how-to-setting-textbox-in-userform-for-fractional-value/43366444#43366444", "title": "How to setting textbox in userform for fractional value?", "body": "<p>For the first one, you can try </p>\n\n<pre><code>ctlTXT.Value = WorksheetFunction.Text(Sheet2.Range(\"P\" &amp; findstart + counter - 1).Value, \"#?/?\")\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491991937, "creation_date": 1491990439, "last_edit_date": 1491991937, "question_id": 43366045, "link": "https://stackoverflow.com/questions/43366045/how-to-setting-textbox-in-userform-for-fractional-value", "title": "How to setting textbox in userform for fractional value?", "body": "<p>I have two problems about the fraction number in user form textbox.</p>\n\n<ol>\n<li>How to retrieve a value from excel sheet and show it in the textbox with fraction. For example 0.5(sheet) will be shown as 1/2 (textbox). not all values are fraction, there are also value for integer</li>\n</ol>\n\n<p>This is the code to retrieve the value from the sheet</p>\n\n<pre><code>Set ctlTXT = Me.SizeFrame.Controls.Add(\"Forms.TextBox.1\")\nctlTXT.name = \"OD\" &amp; counter\nctlTXT.value = Sheet2.Range(\"P\" &amp; findstart + counter - 1).value\nctlTXT.Left = 72\nctlTXT.Height = 15: ctlTXT.Width = 54\nctlTXT.Top = 45 + ((counter - 1) * 17 + 2)\n</code></pre>\n\n<ol start=\"2\">\n<li>How to return the <strong>fractional value</strong> inserted in the user form textbox using case select statement. From the code below, there is no value return when 1/2 or 3/4 inserted in textbox.</li>\n</ol>\n\n<p>This is the code for case select</p>\n\n<pre><code>Select Case X\n    Case \"1 / 2\"\n        Y = 15\n    Case \"3 / 4\"\n        Y = 20\n    Case 2\n        Y = 40\nEnd Select\n</code></pre>\n\n<p>Both of these code is not a complete code.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1491992112, "post_id": 43366031, "comment_id": 73794957, "body": "Are these different grades for different subjects?"}], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 7796810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f8b5deb296124be4aa1e86d92250d66?s=128&d=identicon&r=PG&f=1", "display_name": "Digvijay", "link": "https://stackoverflow.com/users/7796810/digvijay"}, "is_accepted": false, "score": 1, "last_activity_date": 1491996668, "creation_date": 1491996668, "answer_id": 43368317, "question_id": 43366031, "link": "https://stackoverflow.com/questions/43366031/vba-excel-how-to-get-specific-value-from-multiple-duplicated-row/43368317#43368317", "title": "VBA Excel - how to get specific value from multiple duplicated row", "body": "<p>If what you want is grades in this order D>C>B>A then sort the grades.</p>\n\n<pre><code>Press ctrl + shift + L\n</code></pre>\n\n<p>then sort column B from Z to A.</p>\n\n<p>Use Vlookup after this. You'll get grades in reverse order.</p>\n"}], "owner": {"reputation": 1, "user_id": 7855529, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tbZ1jjytojE/AAAAAAAAAAI/AAAAAAAAAB0/RcSaxuRQ8NA/photo.jpg?sz=128", "display_name": "Khang Phan", "link": "https://stackoverflow.com/users/7855529/khang-phan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491996668, "creation_date": 1491990413, "last_edit_date": 1531161705, "question_id": 43366031, "link": "https://stackoverflow.com/questions/43366031/vba-excel-how-to-get-specific-value-from-multiple-duplicated-row", "title": "VBA Excel - how to get specific value from multiple duplicated row", "body": "<p>the question may feels confusing but please let me explain.</p>\n\n<p>I have an excel sheet with 4000 rows and there are many duplicate rows like below:</p>\n\n<pre><code>Name--------------Grade\n\nMicheal --------------       A\n\nSarah   ----------------       A\n\nOliver    ----------------     B\n\nMicheal  --------------      C\n\nVelvet    ----------------     A\n\nMicheal  --------------      D\n</code></pre>\n\n<p>I am currently using <code>Application.WorksheetFunction.Vlookup()</code> to get Grade of Micheal but seems that i can only get A from it. </p>\n\n<p>Is there a way to for me to choose which Grade i want to get from Micheal  ?</p>\n\n<p>example: C, and if C does not exists i will get D, using VBA in excel. </p>\n"}, {"tags": ["vba", "excel", "dictionary"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491990400, "post_id": 43365978, "comment_id": 73793661, "body": "Did you read this: <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">excelmacromastery.com/vba-dictionary</a>? I am pretty sure that you&#39;ll find the answer to all your questions in there. The short answers are (1) yes and (2) <a href=\"https://excelmacromastery.com/vba-dictionary/#Checking_if_a_Key_Exists\" rel=\"nofollow noreferrer\">using exists</a>."}, {"owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491990677, "post_id": 43365978, "comment_id": 73793893, "body": "Yes, but for example he is just putting the keys manually and I need it to be more automated with dynamic range maybe a for loop ?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1491990921, "post_id": 43365978, "comment_id": 73794076, "body": "If you have a new question then please post a new question. If you wish to narrow down your question (and be more precise) then please do so in the above post by editing it. Yet, please be <b>very</b> specific so we can provide a very specific answer to your question. Note that this site is not a discussion forum but a pure Questions-and-Answers website. No chit-chat. For more information please take the tour: <a href=\"https://stackoverflow.com/tour\">stackoverflow.com/tour</a>"}, {"owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491990990, "post_id": 43365978, "comment_id": 73794131, "body": "Okay, thanks for the link"}], "owner": {"reputation": 71, "user_id": 7855552, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37814452b191644eac96327e198e4ea4?s=128&d=identicon&r=PG&f=1", "display_name": "VBABegginer", "link": "https://stackoverflow.com/users/7855552/vbabegginer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491990267, "creation_date": 1491990267, "question_id": 43365978, "link": "https://stackoverflow.com/questions/43365978/vba-dictionary-adding-data", "title": "VBA Dictionary - Adding Data", "body": "<p>I am really new to VBA (practicing for 2 weeks now) and I would greatly appreciate your help/advice's regarding the following topic:</p>\n\n<p>I am trying to get to know the dictionary function within vba, but i have a couple of questions: </p>\n\n<ol>\n<li><p>-Is it possible to populate the dictionary with values from a pivot table? For example, you have 2 columns and you put one of them as\nkey and the other one as item.</p></li>\n<li><p>How can i use the dictionary as a VlookUp ? I would like to go through it and find the specific item corresponding to this key.</p></li>\n</ol>\n\n<p>While writing this I feel that the questions are pretty basic but I would really appreciate your help and time and in case it is possible some examples.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1491990717, "post_id": 43365814, "comment_id": 73793926, "body": "can you show an example ? I tried your code in several scenarios, and it worked fine, adding a single <code>*</code> beofre and after my values"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1491991623, "post_id": 43366185, "comment_id": 73794597, "body": "THANK U! Sometimes i truly am an idiot! This goes down in my future vba toolbox!"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 2, "last_activity_date": 1491990773, "creation_date": 1491990773, "answer_id": 43366185, "question_id": 43365814, "link": "https://stackoverflow.com/questions/43365814/add-asterix-before-and-after-value-in-cell/43366185#43366185", "title": "add asterix before and after value in cell.", "body": "<p>You can declare a variable to hold the last row with data in the desired column and then loop through all the cells in the set range.</p>\n\n<pre><code>Sub Add_Asterisk()\nDim LastRow As Long\nDim Rng As Range, Cell As Range\n\n'Finding the last row with data in column A\nLastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'Setting the range in column A\nSet Rng = Range(\"A2:A\" &amp; LastRow)\n\nFor Each Cell In Rng\n    Cell.Value = \"*\" &amp; Cell.Value &amp; \"*\"\nNext Cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 931, "favorite_count": 0, "accepted_answer_id": 43366185, "answer_count": 1, "score": 0, "last_activity_date": 1491990773, "creation_date": 1491989857, "question_id": 43365814, "link": "https://stackoverflow.com/questions/43365814/add-asterix-before-and-after-value-in-cell", "title": "add asterix before and after value in cell.", "body": "<p>I found this code online to help me print asterix before and after values in a column. \nThe problem with this one is that it print 4 asterix if i have a selection of 4 rows in column a etc. I cant hardcode the range beacuse it differs from time to time. Sometimes i have 2 rows in column a with values and other times i have 5 or 7 and so on. </p>\n\n<p>Do u have any tips for how i can solve this or any help? i cant figure out how to declare my ranges for example so it checks one cell at a time instead of a range of cells. </p>\n\n<pre><code>Sub Add_Asterisk()\n\nDim r As Range\n With Selection\n\n    For Each r In Selection\n        r.Value = \"*\" &amp; r.Value &amp; \"*\"\n    Next\n End With\n\n\n End Sub\n</code></pre>\n\n<p>Thank u in advance\n/D</p>\n"}, {"tags": ["sql", "excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 10397, "user_id": 2144048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1WlzH.jpg?s=128&g=1", "display_name": "JohnHC", "link": "https://stackoverflow.com/users/2144048/johnhc"}, "edited": false, "score": 0, "creation_date": 1491993335, "post_id": 43365673, "comment_id": 73795870, "body": "As an aside, old-style joins are never pretty and could bite you in the bottom further down the line"}, {"owner": {"reputation": 97, "user_id": 7628660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c87a067516074e0efafd2d427b7ca06f?s=128&d=identicon&r=PG&f=1", "display_name": "Snayff", "link": "https://stackoverflow.com/users/7628660/snayff"}, "reply_to_user": {"reputation": 10397, "user_id": 2144048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1WlzH.jpg?s=128&g=1", "display_name": "JohnHC", "link": "https://stackoverflow.com/users/2144048/johnhc"}, "edited": false, "score": 0, "creation_date": 1491995727, "post_id": 43365673, "comment_id": 73797718, "body": "Appreciate the feedback, John. How would you restructure it?"}, {"owner": {"reputation": 10397, "user_id": 2144048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1WlzH.jpg?s=128&g=1", "display_name": "JohnHC", "link": "https://stackoverflow.com/users/2144048/johnhc"}, "edited": false, "score": 0, "creation_date": 1491997653, "post_id": 43365673, "comment_id": 73799051, "body": "FROM [eGain] inner join [Staff] on eGain.Racf = Staff.Racf WHERE..."}, {"owner": {"reputation": 97, "user_id": 7628660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c87a067516074e0efafd2d427b7ca06f?s=128&d=identicon&r=PG&f=1", "display_name": "Snayff", "link": "https://stackoverflow.com/users/7628660/snayff"}, "reply_to_user": {"reputation": 10397, "user_id": 2144048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1WlzH.jpg?s=128&g=1", "display_name": "JohnHC", "link": "https://stackoverflow.com/users/2144048/johnhc"}, "edited": false, "score": 0, "creation_date": 1492005634, "post_id": 43365673, "comment_id": 73805303, "body": "Thanks John! Much appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 7628660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c87a067516074e0efafd2d427b7ca06f?s=128&d=identicon&r=PG&f=1", "display_name": "Snayff", "link": "https://stackoverflow.com/users/7628660/snayff"}, "edited": false, "score": 0, "creation_date": 1491990652, "post_id": 43365972, "comment_id": 73793867, "body": "If it works I don&#39;t mind a bit of ruthlessness! Will try shortly and report back."}, {"owner": {"reputation": 97, "user_id": 7628660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c87a067516074e0efafd2d427b7ca06f?s=128&d=identicon&r=PG&f=1", "display_name": "Snayff", "link": "https://stackoverflow.com/users/7628660/snayff"}, "edited": false, "score": 0, "creation_date": 1491992729, "post_id": 43365972, "comment_id": 73795418, "body": "Thanks for the suggestion, John. I managed to utilise a simpler approach. I have posted the answer."}], "tags": [], "owner": {"reputation": 10397, "user_id": 2144048, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1WlzH.jpg?s=128&g=1", "display_name": "JohnHC", "link": "https://stackoverflow.com/users/2144048/johnhc"}, "is_accepted": false, "score": 1, "last_activity_date": 1491990254, "creation_date": 1491990254, "answer_id": 43365972, "question_id": 43365673, "link": "https://stackoverflow.com/questions/43365673/excel-vba-sql-query-to-access-to-return-records-between-dates/43365972#43365972", "title": "Excel VBA SQL Query to Access to return records between dates", "body": "<p>Might have to be ruthless with this and break the dates down and rebuild...</p>\n\n<pre><code>sFromDateY = Year(DateValue(Sht_SpecificView.Range(\"D5\")))\nsFromDateM = Month(DateValue(Sht_SpecificView.Range(\"D5\")))\nsFromDateD = Day(DateValue(Sht_SpecificView.Range(\"D5\")))\n</code></pre>\n\n<p>Then use</p>\n\n<pre><code>AND eGain.RecordDate BETWEEN DateSerial(\" &amp; sFromDateY &amp;\", \"&amp; sFromDateM &amp;\", \"&amp;sFromDateD &amp;\") ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 7628660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c87a067516074e0efafd2d427b7ca06f?s=128&d=identicon&r=PG&f=1", "display_name": "Snayff", "link": "https://stackoverflow.com/users/7628660/snayff"}, "is_accepted": true, "score": 2, "last_activity_date": 1491992686, "creation_date": 1491992686, "answer_id": 43366902, "question_id": 43365673, "link": "https://stackoverflow.com/questions/43365673/excel-vba-sql-query-to-access-to-return-records-between-dates/43366902#43366902", "title": "Excel VBA SQL Query to Access to return records between dates", "body": "<p>Formatting the dates as yyyy/mm/dd worked. Example below. </p>\n\n<pre><code>sFromDate = Format(Sht_Dashboard.Range(\"D5\"), \"yyyy/mm/dd\")\nsToDate = Format(Sht_Dashboard.Range(\"F5\"), \"yyyy/mm/dd\")\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7628660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c87a067516074e0efafd2d427b7ca06f?s=128&d=identicon&r=PG&f=1", "display_name": "Snayff", "link": "https://stackoverflow.com/users/7628660/snayff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1101, "favorite_count": 0, "accepted_answer_id": 43366902, "answer_count": 2, "score": 1, "last_activity_date": 1491992686, "creation_date": 1491989518, "last_edit_date": 1531164843, "question_id": 43365673, "link": "https://stackoverflow.com/questions/43365673/excel-vba-sql-query-to-access-to-return-records-between-dates", "title": "Excel VBA SQL Query to Access to return records between dates", "body": "<p>Morning all,</p>\n\n<p>I am hoping this is a quick one. I have a query in Excel that requests records between two date points. It returns without errors but also returns unexpected values, seemingly because the date has been swapped around. I am working with the UK date format (dd/mm/yyy). </p>\n\n<p>I have tried passing the date as a date type and a string type, as a datevalue and just the text. I have also tried passing it as yyyymmdd.</p>\n\n<p>In the below example sFromDate is 06/04/2016 (6th April) and sToDate is 12/04/16 (12th April). Dates between June and December are being returned.</p>\n\n<pre><code>sSelectedArea = \"ThisTMRacf\"\nsFromDate = DateValue(Sht_SpecificView.Range(\"D5\"))\nsToDate = DateValue(Sht_SpecificView.Range(\"F5\"))\n\nSet rex = db.OpenRecordset(\"SELECT eGain.RecordDate FROM [eGain], [Staff] \nWHERE eGain.Racf = Staff.Racf AND (Staff.TeamManager = '\" &amp; sSelectedArea &amp; \"' \nOR Staff.CSM = '\" &amp; sSelectedArea &amp; \"') \nAND eGain.RecordDate BETWEEN #\" &amp; sFromDate &amp; \"# AND #\" &amp; sToDate &amp; \"# ;\")\n</code></pre>\n\n<p>Is there another way to pass the date so that it doesn't convert?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491989003, "post_id": 43365369, "comment_id": 73792537, "body": "You could simply loop through all of them with <code>For each cell in Range(Split(Cells_addresses, &quot;,&quot;)(1))</code> (or something like that)."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492058016, "post_id": 43365369, "comment_id": 73828871, "body": "@walid attia  have you tried any of the solution provided below ? any feedback ?"}, {"owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "edited": false, "score": 0, "creation_date": 1492189143, "post_id": 43365369, "comment_id": 73890490, "body": "I did not try yet. I had some physical troubles.I will try tomorrow as I feel better.but really I appreciate the great answers from you .thanks slot."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491990385, "post_id": 43365698, "comment_id": 73793646, "body": "Since you&#39;re the only Pure mathematician here, do you know how to benchmark your solution performance with mine ? the faster gets a +1 :)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491991071, "post_id": 43365698, "comment_id": 73794203, "body": "@ShaiRado VBA is a pain to benchmark and I have to work right now on a power point presentation for a class later on today. I suspect that your approach is quicker when the number of cells is &lt;= 1000 since I take the extra pass over the data to pre-allocate the array and have more calls to <code>Range()</code>. Using a single call to <code>Range()</code> like you did is a clever approach."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491994224, "post_id": 43365698, "comment_id": 73796563, "body": "@ShaiRado The power point is on baseball analytics using R. When I have more time I want to convert some of the R tools we&#39;ve studied into VBA macros. I saw that Israel had a team in the World Baseball Classic this year, one which did better than expected. Was it followed much there?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491994337, "post_id": 43365698, "comment_id": 73796643, "body": "Not really :) people here are more into soccer (god knows why)"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1491989579, "creation_date": 1491989579, "answer_id": 43365698, "question_id": 43365369, "link": "https://stackoverflow.com/questions/43365369/how-to-split-range-refrence-of-addresses-into-elements-of-one-dimenaional-array/43365698#43365698", "title": "How to split range refrence of addresses into elements of one dimenaional array", "body": "<p>Here is one way:</p>\n\n<pre><code>Function SplitRanges(RangeString As Variant) As Variant\n    Dim ranges As Variant, v As Variant\n    Dim c As Range\n    Dim i As Long, j As Long, n As Long\n    ranges = Split(RangeString, \",\")\n    For i = 0 To UBound(ranges)\n        n = n + Range(ranges(i)).Cells.Count\n    Next i\n    ReDim v(1 To n)\n    i = 0\n    For j = 0 To UBound(ranges)\n        For Each c In Range(ranges(j)).Cells\n            i = i + 1\n            v(i) = c.Address\n        Next c\n    Next j\n    SplitRanges = v\nEnd Function\n</code></pre>\n\n<p>Tested like:</p>\n\n<pre><code>Sub test()\n    Dim s As String\n    s = \"$A$1,$C$3:$F$3,$F$4\"\n    Debug.Print Join(SplitRanges(s), \",\")\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$A$1,$C$3,$D$3,$E$3,$F$3,$F$4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1491989747, "creation_date": 1491989747, "answer_id": 43365772, "question_id": 43365369, "link": "https://stackoverflow.com/questions/43365369/how-to-split-range-refrence-of-addresses-into-elements-of-one-dimenaional-array/43365772#43365772", "title": "How to split range refrence of addresses into elements of one dimenaional array", "body": "<p>Or like this...</p>\n\n<pre><code>Dim cells_addresses As Variant\nDim OutputArr()\nDim cell As Range\nDim str() As String\nDim i As Long, ii As Long\ncells_addresses = \"$A$1,$C$3:$F$3,$F$4\"\nstr() = Split(cells_addresses, \",\")\nFor i = 0 To UBound(str)\n    For Each cell In Range(str(i))\n        ii = ii + 1\n        ReDim Preserve OutputArr(1 To ii)\n        OutputArr(ii) = cell.Address\n    Next cell\nNext i\nMsgBox Join(OutputArr, \", \")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "edited": false, "score": 0, "creation_date": 1492242541, "post_id": 43365863, "comment_id": 73905682, "body": "Redo  it works very well with me .thanks slot the code is perfect"}, {"owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "edited": false, "score": 0, "creation_date": 1492243183, "post_id": 43365863, "comment_id": 73905833, "body": "Redo , i do not know how"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "edited": false, "score": 0, "creation_date": 1492243729, "post_id": 43365863, "comment_id": 73905971, "body": "@walidattia but you just did :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1491990000, "creation_date": 1491990000, "answer_id": 43365863, "question_id": 43365369, "link": "https://stackoverflow.com/questions/43365369/how-to-split-range-refrence-of-addresses-into-elements-of-one-dimenaional-array/43365863#43365863", "title": "How to split range refrence of addresses into elements of one dimenaional array", "body": "<p>You can set an <code>Range</code> with the <code>Cells_addresses</code> values you provided. After, loop through the <code>Range.Areas</code> , and nested underneath loop through each <code>Area</code> cells, and each one add to your <code>Output_Array</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub SplitRangeAddrrtoArray()\n\nDim cells_addresses As Variant\nDim UnionRng As Range\nDim RngArea As Range\nDim C As Range\nDim i As Long\nDim Output_Array() As Variant\n\ncells_addresses = \"$A$1,$C$3:$F$3,$F$4\"\nReDim Output_Array(0 To 1000) ' init array size &gt;&gt; will optimize later\n\nSet UnionRng = Range(cells_addresses) '&lt;-- Set a Range with the cells addresses provided\n' loop through range's areas in case there are multiple areas\nFor Each RngArea In UnionRng.Areas\n    For Each C In RngArea ' loop through the area's cells\n        Output_Array(i) = C.Address\n        i = i + 1\n    Next C\nNext RngArea\nReDim Preserve Output_Array(0 To i - 1) '&lt;-- resize to actual populated size\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7855488, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c59032c4d9b6e603734b05cb990eb01?s=128&d=identicon&r=PG&f=1", "display_name": "walid attia", "link": "https://stackoverflow.com/users/7855488/walid-attia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3554, "favorite_count": 0, "accepted_answer_id": 43365772, "answer_count": 3, "score": 1, "last_activity_date": 1492189900, "creation_date": 1491988781, "last_edit_date": 1531164843, "question_id": 43365369, "link": "https://stackoverflow.com/questions/43365369/how-to-split-range-refrence-of-addresses-into-elements-of-one-dimenaional-array", "title": "How to split range refrence of addresses into elements of one dimenaional array", "body": "<p>I have a variable type variant stored in it cells addresses and range addresses </p>\n\n<p>e.g:</p>\n\n<pre><code>Dim cells_addresses as variant\nCells_addresses=\"$A$1,$C$3:$F$3,$F$4\"\n</code></pre>\n\n<p>Now I want to use a split function or any other sub or function in VBA to split those  cells addresses in one dimensional array as the following:</p>\n\n<pre><code>Output_Array=\"$A$1\",\"$C$3\",\"$D$3\",\"$E$3\",\"$F$3\",\"$F$4\"\n</code></pre>\n\n<p>Anyone has an idea how to split range of addresses into individual elements of an array?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1491988315, "post_id": 43365166, "comment_id": 73792052, "body": "What is the code of the other macro?"}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "is_accepted": false, "score": 0, "last_activity_date": 1491989831, "creation_date": 1491989831, "answer_id": 43365806, "question_id": 43365166, "link": "https://stackoverflow.com/questions/43365166/open-text-file-only-once-in-excel-vba/43365806#43365806", "title": "Open text file only once in excel vba", "body": "<p>Thanks @Luuklag. I had tried to figure out on my own but no success. After your comment, just went thru code again and got clue.</p>\n\n<p>Below is the correct code where I have called one of the macro (devtest1) which contains above text file creation macro (createdevtest). Before correction I was calling macro in function instead of Sub, so it was looping again and opening txt file many times.</p>\n\n<pre><code>' macro to select folder and list files\nSub GetFileNames_devtest()\nSet Folder = Application.FileDialog(msoFileDialogFolderPicker)\nIf Folder.Show &lt;&gt; -1 Then Exit Sub\nxDir = Folder.SelectedItems(1)\nCall ListFilesInFolder(xDir, True)\n\n' call devtest: corrected to call macro at right place\ndevtest1\nEnd Sub\nSub ListFilesInFolder(ByVal xFolderName As String, ByVal xIsSubfolders As Boolean)\nDim xFileSystemObject As Object\nDim xFolder As Object\nDim xSubFolder As Object\nDim xFile As Object\nDim rowIndex As Long\nSet xFileSystemObject = CreateObject(\"Scripting.FileSystemObject\")\nSet xFolder = xFileSystemObject.GetFolder(xFolderName)\nrowIndex = Application.ActiveSheet.Range(\"A65536\").End(xlUp).Row + 1\nFor Each xFile In xFolder.Files\n  Application.ActiveSheet.Cells(rowIndex, 1).Formula = xFile.Name\n  rowIndex = rowIndex + 1\nNext xFile\nIf xIsSubfolders Then\n  For Each xSubFolder In xFolder.SubFolders\n    ListFilesInFolder xSubFolder.Path, True\n  Next xSubFolder\nEnd If\nSet xFile = Nothing\nSet xFolder = Nothing\nSet xFileSystemObject = Nothing\n'' Was calling wrongly macro here\nEnd Sub\nFunction GetFileOwner(ByVal xPath As String, ByVal xName As String)\nDim xFolder As Object\nDim xFolderItem As Object\nDim xShell As Object\nxName = StrConv(xName, vbUnicode)\nxPath = StrConv(xPath, vbUnicode)\nSet xShell = CreateObject(\"Shell.Application\")\nSet xFolder = xShell.Namespace(StrConv(xPath, vbFromUnicode))\nIf Not xFolder Is Nothing Then\n  Set xFolderItem = xFolder.ParseName(StrConv(xName, vbFromUnicode))\nEnd If\nIf Not xFolderItem Is Nothing Then\n  GetFileOwner = xFolder.GetDetailsOf(xFolderItem, 8)\nElse\n  GetFileOwner = \"\"\nEnd If\nSet xShell = Nothing\nSet xFolder = Nothing\nSet xFolderItem = Nothing\nEnd Function\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491989831, "creation_date": 1491988203, "question_id": 43365166, "link": "https://stackoverflow.com/questions/43365166/open-text-file-only-once-in-excel-vba", "title": "Open text file only once in excel vba", "body": "<p>I have below code which prints text from a column but open a text file many times instead of once. Please let me know what is the wrong.\nWhen I run sub in Visual Basic debug mode, it open text file only once. But I am calling this macro after another macro and that time it is opening (same) text file many times.</p>\n\n<pre><code>Sub createdevtest()\nDim filename As String, lineText As String\nDim data As Range\nDim myrng As Range, i, j\n\n' filename = ThisWorkbook.Path &amp; \"\\textfile-\" &amp; Format(Now, \"ddmmyy-hhmmss\") &amp; \".txt\"\n filename = ThisWorkbook.Path &amp; \"\\devtest\" &amp; \".txt\"\n\nOpen filename For Output As #1\nDim LastRow As Long\n'Find the last non-blank cell in column A(1)\n LastRow = Cells(Rows.count, 1).End(xlUp).Row\nRange(\"B4:B\" &amp; LastRow).Select\nSet myrng = Selection\n\nFor i = 1 To myrng.Rows.count\n    For j = 1 To myrng.Columns.count\n        lineText = IIf(j = 1, \"\", lineText &amp; \",\") &amp; myrng.Cells(i, j)\n    Next j\n    Print #1, lineText\nNext i\n\nClose #1\nRange(\"B4\").Select\n' open devtest\n'Shell \"explorer.exe\" &amp; \" \" &amp; ThisWorkbook.Path, vbNormalFocus\nfilename = Shell(\"Notepad.exe \" &amp; filename, vbNormalFocus)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "http-headers"], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 2709953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YONRF.jpg?s=128&g=1", "display_name": "Nikki", "link": "https://stackoverflow.com/users/2709953/nikki"}, "is_accepted": false, "score": 0, "last_activity_date": 1491989771, "creation_date": 1491989771, "answer_id": 43365781, "question_id": 43364935, "link": "https://stackoverflow.com/questions/43364935/visual-basic-webbrowser-navigate-but-password-has-a-sign-in-pssword/43365781#43365781", "title": "visual basic webbrowser navigate but password has a @ sign in p@ssword", "body": "<p>HI so it took a wile but finally found a answer\nif you were to pass a username or password with certain special symbols like the @ sign you need to do some Encoding on the symbols \ninstead of using p@ssword i now used p%40ssword and it worked heres my working code</p>\n\n<pre><code>WebBrowser1.Navigate(\" https://username:p%40ssword@160.30.90.52/cgi-bin/statuspage.cgi \")\n</code></pre>\n\n<p>and here are some other symbols you guys might need in the future</p>\n\n<pre><code>!  %21\n[space] %20\n@   %40\n$   %24\n%   %25\n^   %5E\n&amp;   %26\n*   %2A\n(   %28\n)   %29\n?   %3F\n,   %2C\n=   %3D\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 2709953, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YONRF.jpg?s=128&g=1", "display_name": "Nikki", "link": "https://stackoverflow.com/users/2709953/nikki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491989804, "creation_date": 1491987626, "last_edit_date": 1491989804, "question_id": 43364935, "link": "https://stackoverflow.com/questions/43364935/visual-basic-webbrowser-navigate-but-password-has-a-sign-in-pssword", "title": "visual basic webbrowser navigate but password has a @ sign in p@ssword", "body": "<p>the following code works with a normal password</p>\n\n<pre><code>  WebBrowser1.Navigate(\"http://username:Password@160.30.90.52/cgi-bin/statuspage.cgi \")\n</code></pre>\n\n<p>but my default password is p@ssword</p>\n\n<pre><code>  WebBrowser1.Navigate(\"http://username:P@ssword@160.30.90.52/cgi-bin/statuspage.cgi \")\n</code></pre>\n\n<p>how can i let this code run with the @ sign</p>\n\n<p>i need to download files from a url programtically and all my code works all i still need is a way to pass the username and password to the url but the url password contaains that @ sign</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1491987303, "post_id": 43364676, "comment_id": 73791223, "body": "Replace <code>Range(Target.Offset(0, 1),Target.Offset(0, 2))</code> with <code>target.Offset(0, 1).resize(,3)</code> or in your original code change the second offset to 3."}, {"owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1491987810, "post_id": 43364676, "comment_id": 73791621, "body": "Thanks SJR for sorting this issue..."}], "owner": {"reputation": 77, "user_id": 4768600, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d2a65f7a22db523ca8fbd651be01e011?s=128&d=identicon&r=PG&f=1", "display_name": "Salman Khan", "link": "https://stackoverflow.com/users/4768600/salman-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491986943, "creation_date": 1491986943, "last_edit_date": 1531164843, "question_id": 43364676, "link": "https://stackoverflow.com/questions/43364676/code-to-change-next-three-cells-if-the-value-is-changed-in-first-cell", "title": "Code to Change Next Three cells if the value is changed in first cell", "body": "<p>Below is my code...</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n'clear contents of dependent cells\nOn Error Resume Next\nIf Target.Validation.Type = 3 Then\n  Application.EnableEvents = False\n\n  Select Case Target.Column\n    Case 6  'clear columns G, H and I\n      Range(Target.Offset(0, 1), _\n        Target.Offset(0, 2)).ClearContents\n\n    Case 7 'clear column H and I\n    Range(Target.Offset(0, 1), _\n    Target.Offset(0, 2)).ClearContents\n\n    Case 8  'clear column I\n      Target.Offset(0, 1).ClearContents\n  End Select\nEnd If\n\nexitHandler:\n  Application.EnableEvents = True\n  Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>I have 4 columns which have dependent drop down lists.\nI want is when i change the value in first column, the next three columns should get cleared. However, the below code only restricting it to two columns not the third column.</p>\n\n<p>Kindly review and advise how to do that.</p>\n\n<p>Thanks\nSalman</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1491986994, "post_id": 43364621, "comment_id": 73790964, "body": "Why not include a link to this page to your answer: <a href=\"https://msdn.microsoft.com/en-us/library/ee440632(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ee440632(v=office.12).aspx</a> Like this the OP can adjust the wildcards to his / her liking for example <code>*STD-#*</code> to find <code>STD-1</code> as well as <code>STD-2</code>."}, {"owner": {"reputation": 65, "user_id": 7594313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VU4KM.gif?s=128&g=1", "display_name": "Matthew C", "link": "https://stackoverflow.com/users/7594313/matthew-c"}, "edited": false, "score": 0, "creation_date": 1491987145, "post_id": 43364621, "comment_id": 73791080, "body": "Thanks but i think this will also find &quot;Parametric STD-1&quot; in first place. is there option to make sure that there is no word before &quot;STD-1&quot; ?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 65, "user_id": 7594313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VU4KM.gif?s=128&g=1", "display_name": "Matthew C", "link": "https://stackoverflow.com/users/7594313/matthew-c"}, "edited": false, "score": 2, "creation_date": 1491987302, "post_id": 43364621, "comment_id": 73791221, "body": "@MatthewC. &quot;I think this will...&quot; sounds a lot like you haven&#39;t tested it. Why don&#39;t you try it out first and then tell us if it did/ didn&#39;t work. Just FYI I tested it with your data and it was working just fine :)"}, {"owner": {"reputation": 65, "user_id": 7594313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VU4KM.gif?s=128&g=1", "display_name": "Matthew C", "link": "https://stackoverflow.com/users/7594313/matthew-c"}, "edited": false, "score": 0, "creation_date": 1491987659, "post_id": 43364621, "comment_id": 73791512, "body": "@CallumDA: So i use &quot;STD-1*&quot; with parameter LookAt:=XlWhole, thats correct? i have tested it and it works fine so far."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 65, "user_id": 7594313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VU4KM.gif?s=128&g=1", "display_name": "Matthew C", "link": "https://stackoverflow.com/users/7594313/matthew-c"}, "edited": false, "score": 0, "creation_date": 1491987831, "post_id": 43364621, "comment_id": 73791641, "body": "@MatthewC, That looks correct to me. I&#39;m pleased it worked for you!"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 1, "last_activity_date": 1491987460, "last_edit_date": 1491987460, "creation_date": 1491986782, "answer_id": 43364621, "question_id": 43364536, "link": "https://stackoverflow.com/questions/43364536/vba-find-exact-match/43364621#43364621", "title": "Vba Find Exact match", "body": "<p>Just use the <code>*</code> wildcard to find the first range with a value starting with  <code>STD-1</code> followed by <em>anything</em></p>\n\n<pre><code>Range(\"A:A\").Find(\"STD-1*\")\n</code></pre>\n\n<p>For more inforomation about wildcard characters have a read of the <a href=\"https://msdn.microsoft.com/en-us/library/ee440632(v=office.12).aspx\" rel=\"nofollow noreferrer\">MSDN documentation</a>. You might also find the <code>#</code> operator useful.</p>\n"}], "owner": {"reputation": 65, "user_id": 7594313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VU4KM.gif?s=128&g=1", "display_name": "Matthew C", "link": "https://stackoverflow.com/users/7594313/matthew-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2650, "favorite_count": 0, "accepted_answer_id": 43364621, "answer_count": 1, "score": 2, "last_activity_date": 1491987460, "creation_date": 1491986529, "last_edit_date": 1531161705, "question_id": 43364536, "link": "https://stackoverflow.com/questions/43364536/vba-find-exact-match", "title": "Vba Find Exact match", "body": "<p>Im trying to make VBA code to find columns with specific header and then perform some calculations on that column. My problem is that i have to look for specific words. In my case i have column headers like this:</p>\n\n<pre><code>Parametric STD-1 randomnumbers\nParametric STD-2 randomnumbers\nSTD-1 randomnumbers\nSTD-2 randomnumbers\n</code></pre>\n\n<p>Its easy to find Parametric STD-1 column address but when i look for STD-1 it will find Parametric. Problem is that i cant use exact match parameter because after STD-1/STD-2 there are some randomnumbers. </p>\n\n<p>Do You have any idea what i could do to always find correct column address?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1492004004, "post_id": 43364496, "comment_id": 73803928, "body": "Is this code that your wrote? Do you understand the what <code>Set ApXL</code> and <code>Set xlWBk</code> are doing?   You say &quot;different workbook within the same Excel file.&quot; --- The same Excel Application, you mean?"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 1, "creation_date": 1492004261, "post_id": 43364496, "comment_id": 73804154, "body": "You can 1. move creating the excel application outside your loop, whatever it may be. 2. close excel and close the file (workbook) each time. 3. use an if statement that detects existing excel applications and loop through them and then loop through their open files in order to find if it matches the file path that you are currently trying to open. --- I prefer 3. and assume that there is only one excel open, but I can&#39;t seem to find the code online. Basically you need to &quot;attach to an existing excel process in vba&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1492004702, "post_id": 43371276, "comment_id": 73804527, "body": "Ah perfect, that <code>&#39;Get or create reference to Excel.</code> is exactly the code I was looking for. I found it in the documentation <a href=\"https://stackoverflow.com/documentation/excel-vba/2327/powerpoint-integration-through-vba/7636/the-basics-launching-powerpoint-from-vba#t=201704121343306834863\">here, under using powerpoint...</a>    AFAIK it doesn&#39;t really work with people who have multiple excel instances open."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1492004970, "post_id": 43371276, "comment_id": 73804741, "body": "Snippets of code like that I have as their own functions and saved as .bas files - when starting a new project I just drag the files into my project and I&#39;m good to go with a simple <code>Set oXL = CreateXL</code>.  With a good size bas library creating projects is just like shopping - I&#39;ll have one of them, one of them and one of them... bit of glue to stick it all together and job done. :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1492004471, "creation_date": 1492004471, "answer_id": 43371276, "question_id": 43364496, "link": "https://stackoverflow.com/questions/43364496/access-multiple-exports-to-existing-excel-workbook/43371276#43371276", "title": "Access multiple exports to existing Excel workbook", "body": "<p>I'd use three procedures.  The first just identifies which file to open and which query goes on which sheet.</p>\n\n<p>This will place Query1 on Sheet1, Query2 on Sheet2.  It uses a <code>ParamArray</code> so you can add as many sheet/query pairs as you like:</p>\n\n<pre><code>Public Sub ProcessExcel()\n\n    SendToExcel \"&lt;full path to Excel file&gt;\", \"Sheet1\", \"Query1\", \"Sheet2\", \"Query2\"\n\nEnd Sub  \n</code></pre>\n\n<p>The second procedure sets a reference to Excel, opens the workbook and then starts processing the ParamArray.  The sheet name is used to create a reference to the actual sheet which is then passed to the next procedure.  </p>\n\n<pre><code>Public Sub SendToExcel(sFilePath As String, ParamArray ShtQry() As Variant)\n\n    Dim oXL As Object   'Ref to Excel.\n    Dim oWB As Object   'Ref to workbook.\n    Dim x As Long       'General counter\n\n    'Get or create reference to Excel.\n    On Error Resume Next\n    Set oXL = GetObject(, \"Excel.Application\")\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        On Error GoTo Err_Handle\n        Set oXL = CreateObject(\"Excel.Application\")\n    End If\n    On Error GoTo Err_Handle\n\n    Set oWB = oXL.Workbooks.Open(sFilePath)\n\n    For x = LBound(ShtQry) To UBound(ShtQry) Step 2\n        SendTQ2XLWbSheetSizeRange oWB.worksheets(CStr(ShtQry(x))), CStr(ShtQry(x + 1))\n    Next x\n\nExit Sub\n\nErr_Handle:\n\nEnd Sub\n</code></pre>\n\n<p>The final procedure opens the recordset and pastes everything onto the correct sheet:  </p>\n\n<pre><code>Public Sub SendTQ2XLWbSheetSizeRange(oWrkSht As Object, sTQName As String)\n    Dim rst As DAO.Recordset\n    Dim db As DAO.Database\n    Dim x As Long\n\n    Set db = CurrentDb\n    Set rst = db.OpenRecordset(sTQName)\n\n    With oWrkSht\n        'Place field headings.\n        For x = 0 To rst.Fields.Count - 1\n            .cells(5, x + 1) = rst.Fields(x).Name\n        Next x\n        'Place values.\n        .Range(\"A6\").CopyFromRecordset rst\n    End With\n\n    rst.Close\n\n    Set rst = Nothing\n    Set db = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I've missed out plenty of error checks in the code - ensure the sheet exists, that the array holds sheet/query pairs and lots I haven't even considered.</p>\n\n<p><strong>Note:</strong>  Not a single <code>Select</code> or <code>Activate</code> in sight - just reference the sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1492006139, "creation_date": 1492006139, "answer_id": 43371966, "question_id": 43364496, "link": "https://stackoverflow.com/questions/43364496/access-multiple-exports-to-existing-excel-workbook/43371966#43371966", "title": "Access multiple exports to existing Excel workbook", "body": "<p>This doesn't sound right: 'export another query to a different workbook within the same Excel file'.  How about exporting the contents of different tables to one single Excel file, but placing the results of each table to a separate sheet in the same Excel file.  You can easily modify the code to export queries to separate Excel sheets, instead of exporting tables.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\nPrivate Sub Command0_Click()\n\n  Dim strFile As String\n  Dim varItem As Variant\n\n    strFile = InputBox(\"Designate the path and file name to export to...\", \"Export\")\n\n    If (strFile = vbNullString) Then Exit Sub\n\n    For Each varItem In Me.List0.ItemsSelected\n        DoCmd.TransferSpreadsheet transferType:=acExport, _\n                                  spreadsheetType:=acSpreadsheetTypeExcel9, _\n                                  tableName:=Me.List0.ItemData(varItem), _\n                                  FileName:=strFile\n    Next\n\n    MsgBox \"Process complete.\", vbOKOnly, \"Export\"\nEnd Sub\nPrivate Sub Form_Open(Cancel As Integer)\n  Dim strTables As String\n  Dim tdf As TableDef\n  ' Reference: MS DAO 3.6\n  ' Properties &gt; All &gt; Row Source Type = Value List\n    For Each tdf In CurrentDb.TableDefs\n        If (Left(tdf.Name, 4) &lt;&gt; \"MSys\") Then\n            strTables = strTables &amp; tdf.Name &amp; \",\"\n        End If\n    Next\n    strTables = Left(strTables, Len(strTables) - 1)\n\n    Me.List0.RowSource = strTables\nEnd Sub\n</code></pre>\n\n<p>Add a ListBox to a form, and a button on the same form, and run it that way.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9v0ee.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9v0ee.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1492008305, "creation_date": 1492008305, "answer_id": 43372836, "question_id": 43364496, "link": "https://stackoverflow.com/questions/43364496/access-multiple-exports-to-existing-excel-workbook/43372836#43372836", "title": "Access multiple exports to existing Excel workbook", "body": "<p>Thanks to everyone for their kind words and suggestions.  I've gone with @Cody G. 2nd suggestions and just closed the excel file each time, so just adding</p>\n\n<pre><code>xlWBk.Close True\n\nSet xlWBk = Nothing\n\nApXL.Quit\n\nSet ApXL = Nothing\n</code></pre>\n\n<p>Each time.</p>\n"}], "owner": {"reputation": 1913, "user_id": 2470603, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6590b90317023caf0ae68e9709c5fcc6?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/2470603/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 595, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1492008305, "creation_date": 1491986452, "last_edit_date": 1491986530, "question_id": 43364496, "link": "https://stackoverflow.com/questions/43364496/access-multiple-exports-to-existing-excel-workbook", "title": "Access multiple exports to existing Excel workbook", "body": "<p>I'm using Access 2013 and exporting data to an exisitng Excel 2010 workbook.  I'm using the following code (passing the query, worksheet and excel filename).  It all works great:</p>\n\n<pre><code>Public Function SendTQ2XLWbSheetSizeRange(strTQName As String, strSheetName As String, strFilePath As String)\n' strTQName is the name of the table or query you want to send to Excel\n' strSheetName is the name of the sheet you want to send it to\n' strFilePath is the name and path of the file you want to send this data into.\n\n    Dim rst As DAO.Recordset\n    Dim ApXL As Object\n    Dim xlWBk As Object\n    Dim xlWSh As Object\n    Dim fld As DAO.Field\n    Dim strPath As String\n    Const xlCenter As Long = -4108\n    Const xlBottom As Long = -4107\n    On Error GoTo err_handler\n\n    strPath = strFilePath\n\n    Set rst = CurrentDb.OpenRecordset(strTQName)\n\n    Set ApXL = CreateObject(\"Excel.Application\")\n\n    Set xlWBk = ApXL.Workbooks.Open(strPath)\n\n    ApXL.Visible = True\n\n    Set xlWSh = xlWBk.Worksheets(strSheetName)\n\n    xlWSh.Activate\n\n    xlWSh.Range(\"A5\").Select\n\n    For Each fld In rst.Fields\n        ApXL.ActiveCell = fld.Name\n        ApXL.ActiveCell.Offset(0, 1).Select\n    Next\n\n    rst.MoveFirst\n\n    xlWSh.Range(\"A6\").CopyFromRecordset rst\n\n    xlWSh.Range(\"1:1\").Select\n    ' This is included to show some of what you can do about formatting.  You can comment out or delete\n    ' any of this that you don't want to use in your own export.\n    With ApXL.Selection.Font\n        .Name = \"Arial\"\n        .Size = 12\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n    End With\n\n    ApXL.Selection.Font.Bold = True\n\n    With ApXL.Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .MergeCells = False\n    End With\n\n    ' selects all of the cells\n    ApXL.ActiveSheet.Cells.Select\n\n    ' does the \"autofit\" for all columns\n    ApXL.ActiveSheet.Cells.EntireColumn.AutoFit\n\n    ' selects the first cell to unselect all cells\n    xlWSh.Range(\"A1\").Select\n\n    rst.Close\n\n    Set rst = Nothing\n\nExit_SendTQ2XLWbSheet:\n    Exit Function\n\nerr_handler:\n    DoCmd.SetWarnings True\n    MsgBox Err.Description, vbExclamation, Err.Number\n    Resume Exit_SendTQ2XLWbSheet\nEnd Function\n</code></pre>\n\n<p>Now I have a requirement to export another query to a different workbook within the same Excel file.  The problem is the code above opens the Excel file, so if I then call the procedure again, it then opens an additional read-only copy of the Excel.  How do I get around this?  It total I will need to perform 3 exports to 3 different worksheets within 1 Excel file.  Can anyone help?</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "edited": false, "score": 0, "creation_date": 1491986899, "post_id": 43364230, "comment_id": 73790895, "body": "Error occured because filename is incorrect, make sure you entered the correct filename.  Subscript out of range means the file does not exist.!"}, {"owner": {"reputation": 1, "user_id": 7855162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa6c234a27eb6f94916dbcf8cd7f4fb?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Shin", "link": "https://stackoverflow.com/users/7855162/catherine-shin"}, "reply_to_user": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "edited": false, "score": 0, "creation_date": 1491990734, "post_id": 43364230, "comment_id": 73793939, "body": "Thank you, that is clear! I was using the whole file directory which I think was the issue."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7855162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa6c234a27eb6f94916dbcf8cd7f4fb?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Shin", "link": "https://stackoverflow.com/users/7855162/catherine-shin"}, "edited": false, "score": 0, "creation_date": 1491987188, "post_id": 43364293, "comment_id": 73791110, "body": "Will this work when the master sheet I am trying to copy to is in a different workbook? I am still getting the error."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1, "user_id": 7855162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa6c234a27eb6f94916dbcf8cd7f4fb?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Shin", "link": "https://stackoverflow.com/users/7855162/catherine-shin"}, "edited": false, "score": 0, "creation_date": 1491987278, "post_id": 43364293, "comment_id": 73791196, "body": "@CatherineShin is the other Workbook named <code>Filename</code> open when you run this code ? Perhaps you shoulr share the rest of your code, to find the error"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 1, "creation_date": 1491988242, "post_id": 43364293, "comment_id": 73791989, "body": "@ Shai Rado  That&#39;s completely ridiculous. Submitting a comment while down voting the answer should be mandatory. There should be a rule for this scenario. Since I didn&#39;t like this behavior, I am up voting the answer to counter it."}, {"owner": {"reputation": 1, "user_id": 7855162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa6c234a27eb6f94916dbcf8cd7f4fb?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Shin", "link": "https://stackoverflow.com/users/7855162/catherine-shin"}, "edited": false, "score": 0, "creation_date": 1491991274, "post_id": 43364293, "comment_id": 73794346, "body": "I have now added the whole code- the initial error has gone potentially due to using the whole directory rather than filename(?) but I have a object error instead which it would be great if you could help with!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1491985883, "creation_date": 1491985883, "answer_id": 43364293, "question_id": 43364230, "link": "https://stackoverflow.com/questions/43364230/using-a-loop-to-select-a-varying-range-using-vba/43364293#43364293", "title": "Using a loop to select a varying range using VBA", "body": "<p>The reason for your error, is the <code>(Cells(1, i), Cells(2174, i + 2))</code> are not qualifed with <code>Workbooks(Filename).Sheets(\"Sheet1\")</code>. </p>\n\n<p>Also, there is no need to <code>Select</code> and then use <code>Selection.Copy</code>, just copy the <code>Range</code> directly (all the <code>Select</code> is \"costing\" a lot of run-time).</p>\n\n<p>Try the code below:</p>\n\n<pre><code>With Workbooks(Filename).Sheets(\"Sheet1\")\n    For i = 1 To 72 Step 3\n        .Range(.Cells(1, i), .Cells(2174, i + 2)).Copy\n        ' rest of your code goes here...\n\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7855162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa6c234a27eb6f94916dbcf8cd7f4fb?s=128&d=identicon&r=PG&f=1", "display_name": "Catherine Shin", "link": "https://stackoverflow.com/users/7855162/catherine-shin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 631, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491991489, "creation_date": 1491985666, "last_edit_date": 1491991489, "question_id": 43364230, "link": "https://stackoverflow.com/questions/43364230/using-a-loop-to-select-a-varying-range-using-vba", "title": "Using a loop to select a varying range using VBA", "body": "<p>I am trying to select three columns of data at a time (e.g. A:C, to row 2174) to copy into a master file, where additional calculations happen in excel. I then want to move onto the next three columns (e.g. D:F) in the original file and repeat the process. For the first part of that process, I have the following code: </p>\n\n<pre><code>For i = 1 To 72 Step 3\n\nWorkbooks(Filename).Sheets(\"Sheet1\").Range(Cells(1, i), Cells(2174, i + 2)).Select\nSelection.Copy\n</code></pre>\n\n<p>The code stops here with the the error \"Subscript Out of Range\" despite the \"cells\" referencing the correct cells and filename inputting correctly from previous code (or when it was changed to directly reference the file name). </p>\n\n<p>Any clarity on why it isn't working would be much appreciated. </p>\n\n<hr>\n\n<h2>EDIT</h2>\n\n<p>I believe the error was occurring due to using the whole file directory rather than just the name, the addition of <code>Filename</code> definition has removed the \"Subscript out of range\" error,  but I now have a </p>\n\n<blockquote>\n  <p>Run-time error '438': Object doesn't support this property or method</p>\n</blockquote>\n\n<p>on the <code>\"With Workbooks(Filename).Sheet1\"</code> line</p>\n\n<p>Whole code is as follows:</p>\n\n<pre><code>Sub TestImport()\n\nDim i As Integer\n\n'creates file directory in specified cell\nDataFile = Application.GetOpenFilename\n\nApplication.ScreenUpdating = False\n'removes right click options\nCancel = True\n\n'clear past data\nRange(\"B48:D5000\").ClearContents\n\n'open data file\nWorkbooks.OpenText Filename:=DataFile, _\n    Origin:=437, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _\n    xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, Semicolon:=False, _\n    Comma:=True, Space:=True, Other:=False, FieldInfo:=Array(1, 1), _\n    TrailingMinusNumbers:=True\n\nFilename = Right(DataFile, 13)\n\nWith Workbooks(Filename).Sheet1\n    For i = 1 To 13 Step 3\n        .Range(Cells(1, i), Cells(2174, i + 2)).Copy\n        Windows(\"Data Processing.xlsm\").Activate\n        Range(\"B48\").Select\n        Selection.PasteSpecial Paste:=xlPasteAll\n        Workbooks.Open DataFile\n        ActiveWorkbook.Close savechanges:=False\n\n        'copy key variable from front sheet to Db\n        Sheets(\"Front Sheet\").Range(\"F51:Z53\").Copy\n        Sheets(\"Db_KeyVariable\").Range(\"B10000\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n\n        'copy summary into Db\n        Sheets(\"Calculations\").Range(\"AO4:BL15\").Copy\n        Sheets(\"Db_StrokeData\").Range(\"B10000\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n        Next i\nEnd With\n\nEnd Sub        \n</code></pre>\n"}, {"tags": ["vba", "excel", "userform", "setfocus"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1491986137, "post_id": 43364225, "comment_id": 73790353, "body": "It is not clear at what line are you getting this error ? is it in <code>iRow = ws.Cells.Find(What:=&quot;*&quot;, SearchOrder:=xlRows, _     SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1</code> ?"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1491988898, "post_id": 43364225, "comment_id": 73792471, "body": "What is BDM ? a text control or check box or something else ?"}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1492012781, "post_id": 43364225, "comment_id": 73811139, "body": "@MukulVarshney sorry for the delay getting back. The BDM is a textbox in the userform which is located on page1 of the userform"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1492017534, "post_id": 43364225, "comment_id": 73813958, "body": "Is the text box BDM visible? Or the page1 visible? They should be visible to get focus."}, {"owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "reply_to_user": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1492071091, "post_id": 43364225, "comment_id": 73835046, "body": "@MukulVarshney yes definitely visible in both cases. I did have the drop down to Exact Match which I wouldn&#39;t normally have, and trialed changing that back which also did not work."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1523896428, "post_id": 43364225, "comment_id": 86739434, "body": "Posted a solution to your <code>Error 2110</code> issue."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1525330509, "post_id": 43364225, "comment_id": 87315380, "body": "@MBrann - If my answer solved your <i>Errror 2110</i> question, I&#39;d appreciate if you marked it as accepted (cf. <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1523896356, "creation_date": 1523896356, "answer_id": 49862157, "question_id": 43364225, "link": "https://stackoverflow.com/questions/43364225/set-focus-requiring-debugging-every-time/49862157#49862157", "title": "Set Focus Requiring Debugging every time", "body": "<p><strong>Avoid error 2110 by showing <code>Page1</code> at top of Multipage control</strong></p>\n\n<p>You'll have to make the textbox control visible by activating <code>Page1</code> before triggering <code>SetFocus</code>. </p>\n\n<p><strong>Relevant code</strong></p>\n\n<p>This code example assumes that your <code>BDM</code> textbox is located on the first page (=index 0) of a multipage control named <code>MultiPage1</code>.\nBy <strong>choosing <code>Page1</code></strong> via <code>Me.MultiPage1.Value = 0</code> you <strong>avoid</strong> that Excel <em>interprets</em> the control as <strong>invisible</strong> and raises error 2110. </p>\n\n<p>Furthermore it will be necessary to actually activate focus by a trick after displaying the messagebox (via subsequent hiding/showing of userform).  </p>\n\n<pre><code>If Me.BDM.Value = \"\" Then\n  'Choose Page1 to allow view without error 2110\n   Me.MultiPage1.Value = 0  ' &lt;&lt; avoid error 2110 by activating Page1\n   MsgBox \"Please Enter BDM\"\n   Me.BDM.SetFocus\n   Me.Hide: Me.Show         ' activate above set focus\n   Exit Sub\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 6190232, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/3b78ce8a9dfd39feff7fc8ec20f02fa6?s=128&d=identicon&r=PG&f=1", "display_name": "MBrann", "link": "https://stackoverflow.com/users/6190232/mbrann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523896356, "creation_date": 1491985646, "last_edit_date": 1531164843, "question_id": 43364225, "link": "https://stackoverflow.com/questions/43364225/set-focus-requiring-debugging-every-time", "title": "Set Focus Requiring Debugging every time", "body": "<p>I have created a <code>set focus</code>option in a <code>userform</code> before. However this time I am having some issues and was wondering if someone could please assist. I believe that the issue exists because I am using <code>pages</code> on my <code>userform</code>, whereas usually I would not.</p>\n\n<p>My <code>userform</code> has 4 pages for the 4 different sections required. I want it so that if I was to leave a field blank to <code>setfocus</code> on said field. However when this is occuring I am getting runtime error '2110'End, Debug.</p>\n\n<pre><code>Dim iRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Master Data\")\n\n'find first empty row in database\niRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\nIf Me.BDM.Value = \"\" Then\n    Me.BDM.SetFocus\n    MsgBox \"Please Enter BDM\"\n    Exit Sub\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 2, "creation_date": 1491985347, "post_id": 43364044, "comment_id": 73789828, "body": "Please do some research yourself. SO is not a code writing service. If you show us the code you tried and where that failed we are willing to help you out or point you in the right direction."}, {"owner": {"reputation": 77, "user_id": 7742523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xlnFL.jpg?s=128&g=1", "display_name": "Ben Vickers", "link": "https://stackoverflow.com/users/7742523/ben-vickers"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1491985624, "post_id": 43364044, "comment_id": 73790007, "body": "@Luuklag, have been doing research and attempting to run the code myself with many failed attempts. I stripped it back to the above as I believed I was taking the wrong approach."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1491985842, "post_id": 43364044, "comment_id": 73790148, "body": "This should get you started (if this question is not a dupe of this one): <a href=\"http://stackoverflow.com/questions/33900668/saving-webpage-as-pdf-to-certain-directory\" title=\"saving webpage as pdf to certain directory\">stackoverflow.com/questions/33900668/&hellip;</a>"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1491988194, "post_id": 43364044, "comment_id": 73791950, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33900668/saving-webpage-as-pdf-to-certain-directory\">Saving webpage as PDF to certain directory</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1492005836, "creation_date": 1492005836, "answer_id": 43371825, "question_id": 43364044, "link": "https://stackoverflow.com/questions/43364044/vba-how-to-download-webpage-after-following-the-hyperlink/43371825#43371825", "title": "VBA - How to download webpage after following the hyperlink", "body": "<p>Ok, so this will import everything from a web page and place it in Cell A1.  You can easily dump the contents of the cell to a PDF (save as PDF), if that is your intention. </p>\n\n<pre><code>Sub Test()\n    Dim IE As Object\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    With IE\n        .Visible = True\n        .Navigate \"http://finance.yahoo.com\" ' should work for any URL\n        Do Until .ReadyState = 4: DoEvents: Loop\n\n            Range(\"A1\").Value = .document.body.innertext\n\n            .Quit\n        End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7742523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xlnFL.jpg?s=128&g=1", "display_name": "Ben Vickers", "link": "https://stackoverflow.com/users/7742523/ben-vickers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1492005836, "creation_date": 1491985172, "last_edit_date": 1491985209, "question_id": 43364044, "link": "https://stackoverflow.com/questions/43364044/vba-how-to-download-webpage-after-following-the-hyperlink", "title": "VBA - How to download webpage after following the hyperlink", "body": "<p>I am currently running the following code which opens up all the links I have in a column. However, after opening the links, because it is opening up so many tabs (as expected and intended), I would like it to then download the contents of the web pages to a pdf and store them in a folder on my machine. </p>\n\n<pre><code>Sub Test()\n\n    Dim Sh As Worksheet\n    Dim Rng As Range\n    Dim Cell As Range\n    Set Sh = Worksheets(\"Sheet1\")\n\n    With Sh\n        Set Rng = .Range(\"L3:L\" &amp; .Cells(.Rows.Count, \"L\").End(xlUp).Row)        \n    End With\n\n    For Each Cell In Rng\n        ThisWorkbook.FollowHyperlink Cell.Text\n    Next Cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "selenium"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528351902, "post_id": 43364008, "comment_id": 88475813, "body": "What does isn&#39;t working mean?  Was there an error message? On which line? And is the URL login based/internal or can it be shared?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8056356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UVtubZ-uKQg/AAAAAAAAAAI/AAAAAAAAAAA/eNcyfTCZhPI/photo.jpg?sz=128", "display_name": "sickvisionz", "link": "https://stackoverflow.com/users/8056356/sickvisionz"}, "is_accepted": false, "score": -1, "last_activity_date": 1495655833, "last_edit_date": 1495655833, "creation_date": 1495582648, "answer_id": 44146675, "question_id": 43364008, "link": "https://stackoverflow.com/questions/43364008/get-data-from-a-site-using-selenium-vba/44146675#44146675", "title": "Get data from a site using Selenium-VBA", "body": "<pre><code>\"www.*****\" &amp; \"-v\" &amp; vrange.Offset(i, 3).Value &amp; \"-en\"\n</code></pre>\n\n<p>Put that part into a string and make sure that it's a legit URL.  I'm not super familiar with Selenium, but is \"/\" in a .Get a special command that Selenium recognizes?</p>\n"}], "owner": {"reputation": 11, "user_id": 7575048, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yoHISWol79c/AAAAAAAAAAI/AAAAAAAAAFM/1xd1_XlzIcg/photo.jpg?sz=128", "display_name": "V\u0169 Ng&#244;", "link": "https://stackoverflow.com/users/7575048/v%c5%a9-ng%c3%b4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 497, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495655833, "creation_date": 1491985060, "last_edit_date": 1492015510, "question_id": 43364008, "link": "https://stackoverflow.com/questions/43364008/get-data-from-a-site-using-selenium-vba", "title": "Get data from a site using Selenium-VBA", "body": "<p>I want to write code to get data from website by ElementID (using selenium and firefox) in VBA, but it isn't working. </p>\n\n<pre><code>Public Sub seleniumtutorial()\nDim bot As New WebDriver\nDim i As Integer\nDim vrange As Range\n    Set vrange = Range(\"B1\")\ni = 1\nDo While Len(vrange.Offset(i, 3).Value) &gt; 0\n\n    bot.Start \"firefox\", \"www.*****\" &amp; \"-v\" &amp; vrange.Offset(i, 3).Value &amp; \"-en\"\n    bot.Get \"/\"\n    Application.Wait (Now + TimeValue(\"0:00:3\"))\n    vrange.Offset(i, 2).Value = bot.FindElementById(\"stats-container\").FindElementsByClass(\"text-primary\").getText()\n\n    i = i + 1\nLoop\nEnd Sub \n</code></pre>\n\n<p>Can anyone help me with this?</p>\n"}, {"tags": ["excel", "vba", "optimization"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1491984090, "post_id": 43363657, "comment_id": 73789007, "body": "If the code works, and you need optimizing/review, then you should post it in <b>Code Review</b> section, at: <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 3, "creation_date": 1491984817, "post_id": 43363657, "comment_id": 73789473, "body": "I&#39;m flagging this question as off-topic because it should be migrated to CodeReview as stipulated here: <a href=\"http://meta.stackoverflow.com/questions/266749/migration-of-code-questions-from-stack-overflow-to-code-review\" title=\"migration of code questions from stack overflow to code review\">meta.stackoverflow.com/questions/266749/&hellip;</a> Reason: the code is working and the OP himself / herself asks for a way to improve upon the performance of the working code. There is no bug or error to overcome."}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": true, "score": 1, "last_activity_date": 1491984287, "creation_date": 1491984287, "answer_id": 43363748, "question_id": 43363657, "link": "https://stackoverflow.com/questions/43363657/search-and-delete-vba-code-needs-optimizing/43363748#43363748", "title": "Search and delete vba code needs optimizing", "body": "<p>I would suggest that this can be done a lot quicker through the use of a formula. For instance you could do a vlookup. You could then sort the sheet and delete any rows that returned a value.</p>\n\n<p>This is one possible solution.</p>\n\n<p>There are many similar things I can think of. But using a formula would be the easiest.</p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1491984854, "creation_date": 1491984854, "answer_id": 43363921, "question_id": 43363657, "link": "https://stackoverflow.com/questions/43363657/search-and-delete-vba-code-needs-optimizing/43363921#43363921", "title": "Search and delete vba code needs optimizing", "body": "<p>You may try something like this...</p>\n\n<pre><code>Sub DeleteRows()\nDim ws1 As Worksheet, ws2 As Worksheet\nDim lr As Long\nApplication.ScreenUpdating = False\nSet ws1 = Sheets(\"ProductsList\")\nSet ws2 = Sheets(\"CurrentProducts\")\n\nWith ws2\n    lr = .Cells(Rows.Count, 1).End(xlUp).Row\n    .Columns(1).Insert\n    .Range(\"A2:A\" &amp; lr).Formula = \"=IF(COUNTIF(\" &amp; ws1.Name &amp; \"!A:A,B2),NA(),\"\"\"\")\"\n    On Error Resume Next\n    .Range(\"A2:A\" &amp; lr).SpecialCells(xlCellTypeFormulas, 16).EntireRow.Delete\n    .Columns(1).Delete\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 1811922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dfe3cca111d79b453689a0d3f10bd602?s=128&d=identicon&r=PG", "display_name": "Gazza", "link": "https://stackoverflow.com/users/1811922/gazza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 43363748, "answer_count": 2, "score": 0, "last_activity_date": 1491984854, "creation_date": 1491984014, "question_id": 43363657, "link": "https://stackoverflow.com/questions/43363657/search-and-delete-vba-code-needs-optimizing", "title": "Search and delete vba code needs optimizing", "body": "<p>I have an excel workbook with 2 sheets (ProductList and CurrentProducts)</p>\n\n<p>I have the following code :</p>\n\n<pre><code>Sub Macro1()\n\nDim Lastrow As Integer\nDim x As Integer\nDim BinNo As String\nDim MyCell As Range\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nLastrow = Sheets(\"ProductsList\").Range(\"A65536\").End(xlUp).Row\n\nFor x = Lastrow To 2 Step -1\n\nBinNo = Sheets(\"ProductsList\").Range(\"A\" &amp; x).Value\n\nWith Sheets(\"CurrentProducts\").Range(\"A:A\")\n    Set MyCell = .Find(What:=BinNo, _\n                    After:=.Cells(.Cells.Count), _\n                    LookIn:=xlValues, _\n                    LookAt:=xlWhole, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False)\n\n    If Not MyCell Is Nothing Then\n        Sheets(\"CurrentProducts\").Range(MyCell.Address).EntireRow.Delete\n    End If\n End With\n\nNext\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>What this does is take each value from column A in ProductList, searches for it in CurrentProducts and if it finds the value then deletes the entire row from CurrentProducts so I am left with any new products in the CurrentProducts sheet.</p>\n\n<p>This code works but is very slow and takes about 5 minutes to run.</p>\n\n<p>Each sheet has about 30,000 rows.</p>\n\n<p>Is there a way to speed this up or is it just because there are so many rows?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1491983204, "post_id": 43363166, "comment_id": 73788443, "body": "What have you done so far? Code please?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1491983295, "post_id": 43363166, "comment_id": 73788488, "body": "You could get the sheet names and numbers using a combination of <code>Indirect</code> and <code>Cell(&quot;filename&quot;)</code>. Yet, I wouldn&#39;t take that route as <code>Indirect</code> is a volatile function. So, I&#39;d stay away from that one (as much as possible). Instead you should use VBA and something along the line of <code>For each sht in ThisWorkbook.Worksheets</code>. Yet, this website does not offer free coding services. Hence, I suggest that you give it a try first and come back with your own very first VBA coding attempt in that direction."}], "answers": [{"tags": [], "owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "is_accepted": true, "score": 1, "last_activity_date": 1491984795, "creation_date": 1491984795, "answer_id": 43363899, "question_id": 43363166, "link": "https://stackoverflow.com/questions/43363166/macro-to-refer-cell-values-from-multiple-excel-worksheets/43363899#43363899", "title": "Macro to refer cell values from multiple Excel worksheets", "body": "<p>As Ralph mentions you should do something along the lines of:</p>\n\n<pre><code>public sub example1()\n    r=2\n    sheets(\"Summary\").Range(\"A1\") = \"SheetName\"\n    sheets(\"Summary\").Range(\"B1\") = \"Sales\"\n\n    sheets(\"Summary\").Range(\"C1\") = \"Profit\"\n\n    For each sh in thisworkbook.sheets\n        'Sheet Name\n        sheets(\"Summary\").Range(\"A\" &amp; r) = sh.Name\n        'Sales\n        sheets(\"Summary\").Range(\"B\" &amp; r) = sheets(sh.Name).range(\"A2\")\n        'Profit\n        sheets(\"Summary\").Range(\"C\" &amp; r) = sheets(sh.Name).range(\"B2\")\n        'Increment Row number \n        r=r+1\n    Next sh\nEND SUB\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1491985206, "creation_date": 1491985206, "answer_id": 43364053, "question_id": 43363166, "link": "https://stackoverflow.com/questions/43363166/macro-to-refer-cell-values-from-multiple-excel-worksheets/43364053#43364053", "title": "Macro to refer cell values from multiple Excel worksheets", "body": "<p>Or you may try something like this...</p>\n\n<pre><code>Sub CreateSummary()\nDim sws As Worksheet, ws As Worksheet\nApplication.ScreenUpdating = False\n\nSet sws = Sheets(\"Summary\")\nsws.UsedRange.Cells.Clear\nWith sws.Range(\"A1:C1\")\n    .Value = Array(\"Country\", \"Sales\", \"Profit\")\n    .Font.Bold = True\n    .Font.Size = 14\nEnd With\nFor Each ws In Worksheets\n    If Not ws Is sws Then\n        lr = sws.Cells(Rows.Count, 1).End(xlUp).Row + 1\n        ws.Range(\"E20:F20\").Copy sws.Range(\"B\" &amp; lr)\n        sws.Range(\"A\" &amp; lr).Value = ws.Name\n\n    End If\nNext ws\nsws.UsedRange.Columns.AutoFit\nsws.Range(\"A1\").CurrentRegion.Borders.Color = vbBlack\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 2604789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/589118968af170ff7b0506b82ea0c164?s=128&d=identicon&r=PG", "display_name": "GaRaGe", "link": "https://stackoverflow.com/users/2604789/garage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 43363899, "answer_count": 2, "score": -1, "last_activity_date": 1491985206, "creation_date": 1491982451, "last_edit_date": 1491982568, "question_id": 43363166, "link": "https://stackoverflow.com/questions/43363166/macro-to-refer-cell-values-from-multiple-excel-worksheets", "title": "Macro to refer cell values from multiple Excel worksheets", "body": "<p>I have an Excel file with 50 tabs (each tab named as a country. e.g Australia, Austria etc.). I need to create a summary sheet which lists out all the country names and add 2 values for each country that refers to 2 cells from each corresponding tab for that country (say E20, F20)</p>\n\n<p>Given below are the images of the summary tab and a country tab. I manually referred the cell to summary tab. How can I do it for 50 tabs using formula/macro?</p>\n\n<p><a href=\"https://i.stack.imgur.com/cDDie.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cDDie.png\" alt=\"tab\"></a>\n<a href=\"https://i.stack.imgur.com/SfrdB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SfrdB.png\" alt=\"summary\"></a></p>\n"}, {"tags": ["excel", "combobox", "vba"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1491984720, "post_id": 43362698, "comment_id": 73789408, "body": "what does the Cell.Value return. I reckon it is something like 40235, the way excel stores dates. If so you must convert your NewYearsHoliday to that as well. Step through your code using <code>F9</code> and mouse over Cell.Value to see its value."}, {"owner": {"reputation": 1, "user_id": 7854771, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103227250900487/picture?type=large", "display_name": "Victor Losse", "link": "https://stackoverflow.com/users/7854771/victor-losse"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1491985348, "post_id": 43362698, "comment_id": 73789831, "body": "If I create a message box showing the cell value it returns. MM/DD/YYYY ex. Cell B3 returns 1/1/2018."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1491985519, "post_id": 43362698, "comment_id": 73789932, "body": "Try to see if there ever is a match by putting a messagebox in your if-statement."}, {"owner": {"reputation": 1, "user_id": 7854771, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103227250900487/picture?type=large", "display_name": "Victor Losse", "link": "https://stackoverflow.com/users/7854771/victor-losse"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1492013218, "post_id": 43362698, "comment_id": 73811439, "body": "Putting the message box in was a huge help."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7854771, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103227250900487/picture?type=large", "display_name": "Victor Losse", "link": "https://stackoverflow.com/users/7854771/victor-losse"}, "is_accepted": true, "score": 0, "last_activity_date": 1492013620, "last_edit_date": 1492013620, "creation_date": 1492013134, "answer_id": 43374527, "question_id": 43362698, "link": "https://stackoverflow.com/questions/43362698/vba-excel-scanning-range-of-cells-and-filling-with-combobox-selection/43374527#43374527", "title": "VBA Excel Scanning Range of Cells and Filling With ComboBox Selection", "body": "<p>Thank you for the suggestions guys. I found two issues with my code.</p>\n\n<h2>A) My TextBox input was formatted as 01/01 and needed to be 1/1 to match the cells.</h2>\n\n<h2>B) The separate module didn't have access to the ComboBox.Value so I had to set that to a public variable so it could have access to the String value.</h2>\n\n<pre><code> Sub Holiday()\n\n'Select Sheet\n     Sheets(\"Jan\").Select\n'Scan Cells for Dates Within Range\n     For Each Cell In ActiveSheet.Range(\"B3:H3,B19:H19,B35:H35,B51:H51,B67:H67,B83:H83\")\n'Set Column Value Based On ComboBox Select\n        If Cell.Value = NewYearsHoliday Then\n             Cell.Select\n             ActiveCell.Offset(1, 0).Resize(14, 1).Select\n             Selection.Value = NewYearsHolidaySelection\n        End If\n     Next\n\nEnd Sub\n</code></pre>\n\n<p>For Reference the NewYearsHoliday and NewYearsHolidaySelection Variables are Strings set by on a CommandButton press based on the values of a TextBox and ComboBox.</p>\n"}], "owner": {"reputation": 1, "user_id": 7854771, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103227250900487/picture?type=large", "display_name": "Victor Losse", "link": "https://stackoverflow.com/users/7854771/victor-losse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 43374527, "answer_count": 1, "score": 0, "last_activity_date": 1614670407, "creation_date": 1491980999, "last_edit_date": 1531161705, "question_id": 43362698, "link": "https://stackoverflow.com/questions/43362698/vba-excel-scanning-range-of-cells-and-filling-with-combobox-selection", "title": "VBA Excel Scanning Range of Cells and Filling With ComboBox Selection", "body": "<p>I have a spreadsheet consisting primarily of 12 sheets corresponding to the months Jan-Dec. I am attempting to fill the sheets on specific dates based upon TextBox entry of dates and ComboBox selection of value. Each sheet has 6 weeks in a separate range. I am hoping to scan all ranges for a specific date and fill the 14 cells down from the found value with a value based on the ComboBox Selection.\nNewYearsHoliday is a String Value in MM/DD/YYYY format that is equivalent to the value cells being scanned. The Cells being scanned are Date Formatted in Excel. The Range corresponds to the cells that show the date.  The ComboBox is filled with a DefinedName list of choices based on an OffSet value on another worksheet.</p>\n\n<pre><code>Sub Holiday()\n\n'Select Sheet\n    Sheets(\"Jan\").Select\n'Scan Cells for Dates Within Range\n    For Each Cell In ActiveSheet.Range(\"B3:H3,B19:H19,B35:H35,B51:H51,B67:H67,B83:H83\")\n'Set Column Value Based On ComboBox Selection\n    If Cell.Value = NewYearsHoliday Then\n         Cell.Select\n         ActiveCell.Offset(1, 0).Resize(14, 1).Select\n         Selection.Value = ComboBoxNewYears.Value\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I want to allow the user to specify the date in the TextBox using MM/DD format I will combine that with the Year chosen in another TextBox then they can select a value from the ComboBox and when they choose apply it will fill the corresponding column in the worksheet with the value selected.</p>\n\n<p>I am aware that New Years day doesn\u2019t move but this is proof of concept code that will be duplicated for all the holidays of the year. Can anyone share any input on why my code does not fill as I expect?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7591092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c749eafe21ef58d5e169ad7ee15b5?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/7591092/rrr"}, "edited": false, "score": 0, "creation_date": 1492019644, "post_id": 43362412, "comment_id": 73815037, "body": "Thanks for your quick response.  I am committed to using Excel VBA on this one because it supplements a lot of existing VBA code.  So, if I was to only deal with Excel xlsx/m workbooks where they are stored in the OpenXML format, would I be able to read directly the EXIF info from the files stored within, provided of course they are JPEGs with EXIF?  I think to begin I need to be able to read the contents of a file in the xlsm workbook and I have found a few examples of this but these examples all export the files first but I want to read them directly.  Is it possible to read a file directly?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 73, "user_id": 7591092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c749eafe21ef58d5e169ad7ee15b5?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/7591092/rrr"}, "edited": false, "score": 0, "creation_date": 1492129371, "post_id": 43362412, "comment_id": 73867625, "body": "Looks like @brettdj&#39;s answer will extract the EXIF data, but you still need to extract the files and read the XML to find the images. .NET makes unzipping relatively easy, but for a pure VBA solution, you&#39;d need to extract the files to a temporary location using code similar to Ron de Bruin&#39;s <a href=\"https://www.rondebruin.nl/win/s7/win002.htm\" rel=\"nofollow noreferrer\">example</a>. Even with the files extracted, you need to be able to interpret the <i>multiple</i> xml files that describe the relationships, layout and content of the file, in order to identify which image is which."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 73, "user_id": 7591092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c749eafe21ef58d5e169ad7ee15b5?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/7591092/rrr"}, "edited": false, "score": 0, "creation_date": 1492129377, "post_id": 43362412, "comment_id": 73867628, "body": "You should perhaps try changing the <code>xlsx</code> file extension to <code>zip</code>, and exploring the contents of the file, to confirm that the images actually have the EXIF data that you need, <i>before</i> you spend too much time pursuing this."}, {"owner": {"reputation": 73, "user_id": 7591092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c749eafe21ef58d5e169ad7ee15b5?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/7591092/rrr"}, "edited": false, "score": 0, "creation_date": 1492142032, "post_id": 43362412, "comment_id": 73870219, "body": "Changing the extension to zip and reading the zipped files contents is particularly where I was going with the second part of my question.  I am currently doing exactly that and am able to iterate through the zipped files names but I don&#39;t know how or if the zipped files contents can be read directly from the zipped folder.  An example how to do that would be great because every example I have found extracts/copies the files to a temporary folder to read and as you indicated is very inefficient."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 73, "user_id": 7591092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c749eafe21ef58d5e169ad7ee15b5?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/7591092/rrr"}, "edited": false, "score": 0, "creation_date": 1492212451, "post_id": 43362412, "comment_id": 73900045, "body": "@RRR How are you currently reading the file names from within the zip?"}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 2, "last_activity_date": 1491980126, "creation_date": 1491980126, "answer_id": 43362412, "question_id": 43362130, "link": "https://stackoverflow.com/questions/43362130/how-to-obtain-exif-info-from-picture-in-an-excel-worksheet-using-vba/43362412#43362412", "title": "How to obtain EXIF info from picture in an excel worksheet using VBA", "body": "<p>The rendered pictures in Excel are typically embedded inside an enhanced metafile (EMF). You'd need to copy the metafile to the clipboard as an EMF, then enumerate the records of the EMF and extract the JPG, then parse the EXIF data from the JPG information.</p>\n\n<p>Alternatively, if the Excel file is saved and is in XLSX/XLSM format, you can extract the JPG from the compressed XLSX/XLSM container and then parse that image for the EXIF data.</p>\n\n<p>Neither approach is trivial to implement, and in both cases, it would be easier with .NET.</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 7591092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c749eafe21ef58d5e169ad7ee15b5?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/7591092/rrr"}, "edited": false, "score": 0, "creation_date": 1492116316, "post_id": 43385044, "comment_id": 73863472, "body": "Thanks for this referral and your insight into the 64 bit Excel implementation.  The exif info is a big part of the solution and I will definitely be pursuing this.  As for the other part of my question.  Can the contents of a zipped file be read or edited or saved to without first exporting the file to a temporary working location?  I am presuming this is not possible because the file is compressed and it appears it can&#39;t even be worked on like that in Windows.  Even a simple text file is opened in a temp location and you can&#39;t save it directly back to the zipped location you opened it from."}, {"owner": {"reputation": 428, "user_id": 3647782, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f1d3ea4a1d93019fce2505b49959c42?s=128&d=identicon&r=PG&f=1", "display_name": "FabianTe", "link": "https://stackoverflow.com/users/3647782/fabiante"}, "edited": false, "score": 0, "creation_date": 1544538038, "post_id": 43385044, "comment_id": 94305546, "body": "Hi, does this approach still work? My Access / Excel (Version 1811 - Office 365) crashes when using the fixed code."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 5, "last_activity_date": 1492064967, "creation_date": 1492064967, "answer_id": 43385044, "question_id": 43362130, "link": "https://stackoverflow.com/questions/43362130/how-to-obtain-exif-info-from-picture-in-an-excel-worksheet-using-vba/43385044#43385044", "title": "How to obtain EXIF info from picture in an excel worksheet using VBA", "body": "<p>Fortunately for you there is a beautiful piece <a href=\"http://www.everythingaccess.com/tutorials.asp?ID=Extracting-GPS-data-from-JPEG-files\" rel=\"noreferrer\">of coding</a> by Andrew Phillips from Australia's North Central Catchment Management Authority that does exactly this.</p>\n\n<p>It is provided as a class module so I haven't looked to re-list this here</p>\n\n<p>The current code can be imported from Access to Excel, in my case I needed to change the functions from 32 to 64 bit as so:</p>\n\n<blockquote>\n  <p>Private Declare Function VirtualAlloc Lib \"kernel32\" (ByVal Address As Long, ByVal Size As Long, ByVal AllocationType As Long, ByVal Protect As Long) As Long</p>\n</blockquote>\n\n<p>to this using <code>PntSafe</code></p>\n\n<blockquote>\n  <p>Private Declare PtrSafe Function VirtualAlloc Lib \"kernel32\" (ByVal Address As Long, ByVal Size As Long, ByVal AllocationType As Long, ByVal Protect As Long) As Long</p>\n</blockquote>\n"}], "owner": {"reputation": 73, "user_id": 7591092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c749eafe21ef58d5e169ad7ee15b5?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/7591092/rrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4415, "favorite_count": 2, "accepted_answer_id": 43385044, "answer_count": 2, "score": 5, "last_activity_date": 1594282774, "creation_date": 1491979217, "last_edit_date": 1492238815, "question_id": 43362130, "link": "https://stackoverflow.com/questions/43362130/how-to-obtain-exif-info-from-picture-in-an-excel-worksheet-using-vba", "title": "How to obtain EXIF info from picture in an excel worksheet using VBA", "body": "<p>How do I obtain the EXIF info like Latitude, Longitude, etc... from a shape picture in an excel worksheet using VBA?  And can it be obtained without extracting or copying the picture out of the worksheet or out of the zipped Excel workbook?</p>\n\n<p>I am able to iterate through the zipped folder contents with the following code.</p>\n\n<pre><code>Public Sub ReadZip()\n    Dim vZipFileName As Variant\n    vZipFileName = \"C:\\Users\\erogrou\\Desktop\\Test.zip\"\n\n    Dim objShell, objFolder\n    Set objShell = CreateObject(\"shell.application\")\n    Set objFolder = objShell.Namespace(vZipFileName)\n\n    Dim vFilename As Variant\n\n    If (Not objFolder Is Nothing) Then\n        Debug.Print objFolder.self.Path\n\n        For Each vFilename In objFolder.items\n            Debug.Print vFilename\n        Next\n\n    End If\n\n    Set objFolder = Nothing\n    Set objShell = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7719401, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/18841ecada440cf0d19efc8aa741c314?s=128&d=identicon&r=PG&f=1", "display_name": "cwight", "link": "https://stackoverflow.com/users/7719401/cwight"}, "edited": false, "score": 0, "creation_date": 1492035393, "post_id": 43364414, "comment_id": 73823132, "body": "This is great! Is there any code I could add to keep the import workbook from recalculating upon open? The import workbook is already recalculated before it has been closed and the recalculation seems to take a very long time. I already tried &quot;UpdateLinks:=False&quot; but this does not seem to do the trick. Thank you!!!!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 65, "user_id": 7719401, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/18841ecada440cf0d19efc8aa741c314?s=128&d=identicon&r=PG&f=1", "display_name": "cwight", "link": "https://stackoverflow.com/users/7719401/cwight"}, "edited": false, "score": 0, "creation_date": 1492065354, "post_id": 43364414, "comment_id": 73831724, "body": "Calculation settings are stored with the workbook. If you save a workbook as manual, it will open as manual. You cannot deactivate automatic calculation without opening the workbook (calculation runs first). Another thing is that at the moment you paste the values at least volatile functions like <code>now()</code> are recalculated before pasting. I suggest to save <code>C:\\History.xlsm</code> with calculation set to manual."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1491986237, "creation_date": 1491986237, "answer_id": 43364414, "question_id": 43362064, "link": "https://stackoverflow.com/questions/43362064/excel-vba-to-copy-and-paste-as-values-from-a-closed-workbook-to-an-active-workbo/43364414#43364414", "title": "Excel VBA to copy and paste as values from a closed workbook to an active workbook, Mac OS X", "body": "<p>You should do a real copy-paste like that</p>\n\n<pre><code>Sub ImportData()\n    Dim App As New Excel.Application 'create a new (hidden) Excel\n\n    ' remember active sheet\n    Dim wsActive As Worksheet\n    Set wsActive = ThisWorkbook.ActiveSheet\n\n    ' open the import workbook in new Excel (as read only)\n    Dim wbImport As Workbook\n    Set wbImport = App.Workbooks.Open(Filename:=\"C:\\History.xlsm\", UpdateLinks:=True, ReadOnly:=True)\n\n    'copy the data of the import sheet\n    wbImport.Worksheets(\"AllDATA\").Range(\"A1:HW6000\").Copy\n    wsActive.Range(\"A1\").PasteSpecial Paste:=xlPasteFormats 'paste formats\n    wsActive.Range(\"A1\").PasteSpecial Paste:=xlPasteValues  'paste values\n\n    App.CutCopyMode = False 'clear clipboard (prevents asking when wb is closed)\n    wbImport.Close SaveChanges:=False 'close wb without saving\n    App.Quit 'quit the hidden Excel\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7719401, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/18841ecada440cf0d19efc8aa741c314?s=128&d=identicon&r=PG&f=1", "display_name": "cwight", "link": "https://stackoverflow.com/users/7719401/cwight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5263, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593678732, "creation_date": 1491979055, "last_edit_date": 1593678732, "question_id": 43362064, "link": "https://stackoverflow.com/questions/43362064/excel-vba-to-copy-and-paste-as-values-from-a-closed-workbook-to-an-active-workbo", "title": "Excel VBA to copy and paste as values from a closed workbook to an active workbook, Mac OS X", "body": "<p>I know this is a common type of query, but I have not been able to find an answer yet to my specific instance after active searching. I am also a new VBA user, so please bear with me. </p>\n\n<p>I want to import  an entire sheet of data (AllDATA tab in HISTORY.XLSM) that contains live formulae (range A1:HW6000) from a closed workbook into an active workbook, but only paste as values into the active workbook. More simply, want to replicate one sheet from the closed workbook as values (not live formuale) into the active worksheet.</p>\n\n<p>I am on Mac OS X. </p>\n\n<p>This is the code that I have been working with (running the code from the active workbook). </p>\n\n<pre><code>Sub GetRange() \n  With Range(\"A1:HW6000\") \n    .Formula = \"='C:\\[HISTORY.xlsm]ALLDATA'!A1\" \n    .Value = .Value \nEnd With \nEnd Sub \n</code></pre>\n\n<p>This code seems to import formats but not actual pasted values into my active workbook. </p>\n\n<p>Any ideas? </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1491982880, "post_id": 43361688, "comment_id": 73788274, "body": "Loop controls object (in VBE press F2 and look for <code>Control</code>)"}, {"owner": {"reputation": 1, "user_id": 6593440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c95075b67d1a36fcf4251fcd37bc7fb5?s=128&d=identicon&r=PG&f=1", "display_name": "Salas", "link": "https://stackoverflow.com/users/6593440/salas"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1491986735, "post_id": 43361688, "comment_id": 73790776, "body": "This helps but i am still unable to write it :("}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1492048490, "creation_date": 1492048490, "answer_id": 43382310, "question_id": 43361688, "link": "https://stackoverflow.com/questions/43361688/word-vb-clear-all-checked-fields/43382310#43382310", "title": "Word VB, Clear all checked fields", "body": "<p>This code will do the job. It must be placed in the UserForm's code sheet.</p>\n\n<pre><code>Private Sub ClearCheckBoxes()\n\n    Dim Ctl As MSForms.Control\n\n    For Each Ctl In Me.Controls\n        If TypeName(Ctl) = \"CheckBox\" Then Ctl.Value = False\n    Next Ctl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6593440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c95075b67d1a36fcf4251fcd37bc7fb5?s=128&d=identicon&r=PG&f=1", "display_name": "Salas", "link": "https://stackoverflow.com/users/6593440/salas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593764871, "creation_date": 1491977795, "last_edit_date": 1593764871, "question_id": 43361688, "link": "https://stackoverflow.com/questions/43361688/word-vb-clear-all-checked-fields", "title": "Word VB, Clear all checked fields", "body": "<p>i have a word with 15+ VB forms and 20-50 CheckBoxes in each.\nHow do i clear (if they are cheched) all the CheckBoxes in active form w/o having to write the name of each CheckBox?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1491978977, "post_id": 43361672, "comment_id": 73785850, "body": "How are you calling this?"}, {"owner": {"reputation": 499, "user_id": 7160536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b7c2e2c668ace472a1b0abc47f4421?s=128&d=identicon&r=PG&f=1", "display_name": "ClintB", "link": "https://stackoverflow.com/users/7160536/clintb"}, "edited": false, "score": 0, "creation_date": 1491984994, "post_id": 43361672, "comment_id": 73789599, "body": "Need to see what is passed to this function in order to debug it."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1492036549, "post_id": 43361672, "comment_id": 73823532, "body": "How do you actually set <code>rng</code> in the calling code?  What&#39;s <code>f</code> declared as?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1492053442, "post_id": 43361672, "comment_id": 73827755, "body": "f should be declared as Object or Variant, because not all conditional formattings are of type <code>FormatCondition</code>. If I remember correctly only the ones that have a formula are of type <code>FormatCondition</code>. Also,  <code>Cells.FormatConditions</code> instead of <code>ActiveSheet.Range(Cells.Address).FormatConditions</code>"}, {"owner": {"reputation": 1085, "user_id": 1853167, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/90c0f277e00d485589f51a2bf9ada29b?s=128&d=identicon&r=PG", "display_name": "Matt Fitzmaurice", "link": "https://stackoverflow.com/users/1853167/matt-fitzmaurice"}, "edited": false, "score": 0, "creation_date": 1492054727, "post_id": 43361672, "comment_id": 73828096, "body": "Thanks Slai. That&#39;s not my problem however. All the conditional formattings on my sheet are of type FormatCondition. My error occurs when I run the ModifyAppliesToRange statement."}], "owner": {"reputation": 1085, "user_id": 1853167, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/90c0f277e00d485589f51a2bf9ada29b?s=128&d=identicon&r=PG", "display_name": "Matt Fitzmaurice", "link": "https://stackoverflow.com/users/1853167/matt-fitzmaurice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 941, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1492051693, "creation_date": 1491977751, "last_edit_date": 1492051693, "question_id": 43361672, "link": "https://stackoverflow.com/questions/43361672/modifyappliestorange-not-working", "title": "ModifyAppliesToRange not working", "body": "<p>I have a worksheet with many duplicated Conditional Formatting instances.\nI'm trying to write code to tidy/delete many of them.</p>\n\n<p>I need to modify the Format Condition.\nAny idea why the following doesn't work?</p>\n\n<pre><code>Sub UpdateCondition(ByRef bFirst As Boolean, rng As Range, f As FormatCondition, replacementFormula As String)\n\n    If bFirst Then\n        f.Modify f.Type, , replacementFormula\n        f.ModifyAppliesToRange rng\n        bFirst = False\n    Else\n        f.Delete\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>Method 'ModifyAppliesToRange' of object 'FormatCondition' failed</p>\n</blockquote>\n\n<p>This code works for many of my conditions. Only some of them trip up.</p>\n\n<p>-- edit --</p>\n\n<p>My calling code is as follows</p>\n\n<pre><code>Dim f As FormatCondition\nDim bFirst As Boolean\nDim i As Integer\n\nSet rng = SomeRangeOnTheSheet\n\nbFirst = True\nFor i = ActiveSheet.Range(Cells.Address).FormatConditions.Count To 1 Step -1\n    Set f = ws.Range(Cells.Address).FormatConditions(i)\n    If f.Formula1 = \"..Some Formula..\" Then\n        UpdateCondition bFirst, rng, f, replacementFormula\n    End If\nNext\n</code></pre>\n\n<p>-- edit --</p>\n\n<pre><code>Function SomeRangeOnTheSheet() As Range\nDim cell1 As Range\nDim cell2 As Range\n\n    Set cell1 = Cells(Range(\"Roster\").row, Range(\"StartDate\").Column)\n    Set cell2 = Cells(Range(\"Roster\").row + Range(\"Roster\").Rows.Count - 1, Range(\"Roster\").Column + Range(\"Roster\").Columns.Count - 1)\n    Set RosterDataRange = Range(cell1, cell2)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "onchange", "userform", "vba"], "comments": [{"owner": {"reputation": 119, "user_id": 7150126, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c6fa3bf5f4682b89a07f6a425fe666d8?s=128&d=identicon&r=PG&f=1", "display_name": "RR33", "link": "https://stackoverflow.com/users/7150126/rr33"}, "edited": false, "score": 0, "creation_date": 1491976687, "post_id": 43361305, "comment_id": 73784764, "body": "EDIT: tbDoorQty Should be tbQty1 in this example.  Code was amended."}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491976809, "post_id": 43361305, "comment_id": 73784813, "body": "try if isnumeric(tbQty1.value) then , This would check if its not blank and numeric"}, {"owner": {"reputation": 119, "user_id": 7150126, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c6fa3bf5f4682b89a07f6a425fe666d8?s=128&d=identicon&r=PG&f=1", "display_name": "RR33", "link": "https://stackoverflow.com/users/7150126/rr33"}, "reply_to_user": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491977769, "post_id": 43361305, "comment_id": 73785249, "body": "Sivaprasath -- nice, it works.  I paired with another IF so the second text box is cleared if the first has a &quot;&quot; value.  Answer instead of comment and I can check &#39;answered&#39; if you want.  Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "is_accepted": true, "score": 0, "last_activity_date": 1491977888, "creation_date": 1491977888, "answer_id": 43361714, "question_id": 43361305, "link": "https://stackoverflow.com/questions/43361305/textbox-change-event-error-on-backspace-vba-userform/43361714#43361714", "title": "Textbox Change Event Error on Backspace --VBA Userform", "body": "<pre><code>If isnumeric(tbQty1.value) then\n 'statements\nend if\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7150126, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c6fa3bf5f4682b89a07f6a425fe666d8?s=128&d=identicon&r=PG&f=1", "display_name": "RR33", "link": "https://stackoverflow.com/users/7150126/rr33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "accepted_answer_id": 43361714, "answer_count": 1, "score": 0, "last_activity_date": 1491977888, "creation_date": 1491976362, "last_edit_date": 1531164843, "question_id": 43361305, "link": "https://stackoverflow.com/questions/43361305/textbox-change-event-error-on-backspace-vba-userform", "title": "Textbox Change Event Error on Backspace --VBA Userform", "body": "<p>I have 2 Text boxes on a user form: tbQty1, tbQty2.  I want tbQty2 value to equal tbQty1.value * 2. The following simple code [_Change()] works unless I delete or backspace out the value of tbQty1.  I get an run time error 13 type mismatch</p>\n\n<pre><code>Private Sub tbQty1_Change()\n\ntbQty2.Value = tbDoorQty.Value * 2\n\nEnd Sub\n</code></pre>\n\n<p>I have tried IF statements with tbQty1.value = \"\" etc. and Keypress (<code>IF KeyAscii = 8 Then tbQty1 = \"\"</code>). All blew up the same way  I'm just missing something.  Thanks for the help</p>\n"}]