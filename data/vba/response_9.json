[{"tags": ["c#", "vba", "excel", "office-interop"], "comments": [{"owner": {"reputation": 5663, "user_id": 4401293, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8e7aa14bcc48ad45b4c0d12cf5b4b147?s=128&d=identicon&r=PG", "display_name": "Quality Catalyst", "link": "https://stackoverflow.com/users/4401293/quality-catalyst"}, "edited": false, "score": 0, "creation_date": 1426118174, "post_id": 28999589, "comment_id": 46247109, "body": "What about asking <a href=\"http://www.google.com\" rel=\"nofollow noreferrer\">Google</a>?"}, {"owner": {"reputation": 10677, "user_id": 122195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65228e5118999b6712f54a7076e15776?s=128&d=identicon&r=PG", "display_name": "thepirat000", "link": "https://stackoverflow.com/users/122195/thepirat000"}, "edited": false, "score": 0, "creation_date": 1426126961, "post_id": 28999589, "comment_id": 46249443, "body": "Do you own the C# code? If so, I think the only way is to register your assembly for COM interop. Check <a href=\"http://stackoverflow.com/a/7092618/122195\">this</a>."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 1, "last_activity_date": 1426162475, "creation_date": 1426162475, "answer_id": 29009517, "question_id": 28999589, "link": "https://stackoverflow.com/questions/28999589/excel-c-how-do-i-call-into-a-c-library-from-excel/29009517#29009517", "title": "Excel &lt;-&gt; C# - how do I call into a C# library from Excel?", "body": "<p>Coopernick,</p>\n\n<p>It looks like you need to develop an Excel add-in and move the VBA code on the add-in rails. See <a href=\"https://msdn.microsoft.com/en-us/library/cc668205.aspx\" rel=\"nofollow\">Walkthrough: Creating Your First Application-Level Add-in for Excel</a> to get started quickly. You may consider an Excel add-in as a regular .Net application where you can use any components and libraries.</p>\n\n<p>You may find the <a href=\"https://msdn.microsoft.com/en-us/library/bb386107(v=vs.90).aspx\" rel=\"nofollow\">Excel Solutions</a> section in MSDN helpful.</p>\n"}], "owner": {"reputation": 220, "user_id": 665430, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/cdac70ad8bff6817b68b08e4475f13f6?s=128&d=identicon&r=PG", "display_name": "Coopernick", "link": "https://stackoverflow.com/users/665430/coopernick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 1, "accepted_answer_id": 29009517, "answer_count": 1, "score": 0, "last_activity_date": 1433140256, "creation_date": 1426117988, "last_edit_date": 1433140256, "question_id": 28999589, "link": "https://stackoverflow.com/questions/28999589/excel-c-how-do-i-call-into-a-c-library-from-excel", "title": "Excel &lt;-&gt; C# - how do I call into a C# library from Excel?", "body": "<p>We have a couple of spreadsheets here that we populate with some data and do some formatting using <code>Microsoft.Office.Interop.Excel</code>.</p>\n\n<p>Now that part is all good - it's something along the lines of what is done here: <a href=\"http://www.clear-lines.com/blog/post/Write-data-to-an-Excel-worksheet-with-C-fast.aspx\" rel=\"nofollow\">Write to Excel example</a>.</p>\n\n<p>What I'd like to do is:</p>\n\n<ul>\n<li>Add a button inside the spreadsheet, bound to a macro.</li>\n<li>When the user clicks the button, the macro fires - we grab some parameters from the cells and pass those to the C# function. That code does all the heavy lifting, populates the spreadsheet as above, etc.</li>\n</ul>\n\n<p>What I don't understand how to do is that second step - I can't see a way to actually pass parameters and call into C# directly.\nAs it stands now, I can call a C# console application and pass command line parameters into it... but that seems a bit wrong, I'd have thought there would be some better way - but I can't seem to find it!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3560218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/414dca048d23293a2f7cead436b6abe1?s=128&d=identicon&r=PG&f=1", "display_name": "shahram", "link": "https://stackoverflow.com/users/3560218/shahram"}, "edited": false, "score": 0, "creation_date": 1426268738, "post_id": 29000779, "comment_id": 46318068, "body": "tahnks.raj.for your answer.but this macro cant work for some condition like when the old seial and new serial are&#39; not in front of together like the table  i updated.cant you develop your vb code to solve that.! thnx....!"}, {"owner": {"reputation": 512, "user_id": 4029005, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8b4ad34d3632c9a5784a643f24f2287b?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/4029005/raj"}, "reply_to_user": {"reputation": 3, "user_id": 3560218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/414dca048d23293a2f7cead436b6abe1?s=128&d=identicon&r=PG&f=1", "display_name": "shahram", "link": "https://stackoverflow.com/users/3560218/shahram"}, "edited": false, "score": 0, "creation_date": 1426271548, "post_id": 29000779, "comment_id": 46319501, "body": "Are these &quot;Old Serial&quot; or&quot;New Serial&quot; values unique?? @shahram"}, {"owner": {"reputation": 3, "user_id": 3560218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/414dca048d23293a2f7cead436b6abe1?s=128&d=identicon&r=PG&f=1", "display_name": "shahram", "link": "https://stackoverflow.com/users/3560218/shahram"}, "edited": false, "score": 0, "creation_date": 1426283099, "post_id": 29000779, "comment_id": 46325022, "body": "yes @raj they are unique. and i want to delete old one."}, {"owner": {"reputation": 3, "user_id": 3560218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/414dca048d23293a2f7cead436b6abe1?s=128&d=identicon&r=PG&f=1", "display_name": "shahram", "link": "https://stackoverflow.com/users/3560218/shahram"}, "edited": false, "score": 0, "creation_date": 1426283295, "post_id": 29000779, "comment_id": 46325084, "body": "your code is good as old and new serial in same row .but i test that for example when  old seial(11) in first row and new serial (11) in second row.and it did not work.!. :)"}, {"owner": {"reputation": 512, "user_id": 4029005, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8b4ad34d3632c9a5784a643f24f2287b?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/4029005/raj"}, "reply_to_user": {"reputation": 3, "user_id": 3560218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/414dca048d23293a2f7cead436b6abe1?s=128&d=identicon&r=PG&f=1", "display_name": "shahram", "link": "https://stackoverflow.com/users/3560218/shahram"}, "edited": false, "score": 0, "creation_date": 1426298603, "post_id": 29000779, "comment_id": 46328927, "body": "I have updated the solution, now it will work even if you have old serial and new serial in different rows. But I am pretty confused with your requirement. You mentioned in the question you want to delete &quot;new code&quot;,&quot;new serial&quot;, &quot;new amount&quot; but in the previous comment you mentioned, you want to delete old one. My code should work for questions&#39;s requirement."}, {"owner": {"reputation": 512, "user_id": 4029005, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8b4ad34d3632c9a5784a643f24f2287b?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/4029005/raj"}, "reply_to_user": {"reputation": 3, "user_id": 3560218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/414dca048d23293a2f7cead436b6abe1?s=128&d=identicon&r=PG&f=1", "display_name": "shahram", "link": "https://stackoverflow.com/users/3560218/shahram"}, "edited": false, "score": 0, "creation_date": 1426393633, "post_id": 29000779, "comment_id": 46351443, "body": "It would me more appreciable, if you mark the answer as &quot;accepted&quot;, when you feel someone answers your question correctly.  Please see [How to accept answer] (<a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>)"}], "tags": [], "owner": {"reputation": 512, "user_id": 4029005, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/8b4ad34d3632c9a5784a643f24f2287b?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/4029005/raj"}, "is_accepted": true, "score": 0, "last_activity_date": 1426298708, "last_edit_date": 1426298708, "creation_date": 1426126381, "answer_id": 29000779, "question_id": 28999380, "link": "https://stackoverflow.com/questions/28999380/delete-three-columns-of-two-grouped-columns-according-to-common-value-of-two-col/29000779#29000779", "title": "delete three columns of two grouped columns according to common value of two column", "body": "<p>Assuming that your data looks like this and all the entries in \"New Serial\" Column are unique, here's the solution:</p>\n\n<p><img src=\"https://i.stack.imgur.com/TOMDL.png\" alt=\"enter image description here\"></p>\n\n<pre><code>Sub test()\nSet ExcelAppl = CreateObject(\"Excel.Application\")\nSet wb = ActiveWorkbook\nApplication.DisplayAlerts = False\nSet ws = wb.Worksheets(1)\nSet Rng = ws.UsedRange\nRowCount = Rng.Rows.Count\nFor i = 1 To RowCount\nOldSerial = Cells(i, 2).Value\n'assign the column range of \"new serial\" that you want to find\nWith ws.Range(\"E:E\")\nSet C = .Find(OldSerial, LookIn:=xlValues)\nIf Not C Is Nothing Then\nrowNumber = C.Row\ncolNumber = C.Column\n'delete new serial\nCells(rowNumber, colNumber).Value = \"\"\n'delete new code\nCells(rowNumber, colNumber - 1).Value = \"\"\n'delete new amount\nCells(rowNumber, colNumber + 1).Value = \"\"\nEnd If\nEnd With\nNext\nSet Rng = Nothing\nSet ws = Nothing\nSet wb = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Output will be:</p>\n\n<p><img src=\"https://i.stack.imgur.com/p5lf5.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 3, "user_id": 3560218, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/414dca048d23293a2f7cead436b6abe1?s=128&d=identicon&r=PG&f=1", "display_name": "shahram", "link": "https://stackoverflow.com/users/3560218/shahram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 29000779, "answer_count": 1, "score": 0, "last_activity_date": 1436008164, "creation_date": 1426116786, "last_edit_date": 1531161705, "question_id": 28999380, "link": "https://stackoverflow.com/questions/28999380/delete-three-columns-of-two-grouped-columns-according-to-common-value-of-two-col", "title": "delete three columns of two grouped columns according to common value of two column", "body": "<p>I have 2 sets of three grouped columns in one worksheet. This stretches for 30000 rows. Sample data is below:</p>\n\n<p>I want a macro Do like this code :\nCode:</p>\n\n<pre><code>when (old serial)=(new serial) then delete (new code) AND (new serial) AND(new amount)\n\nold code    old serial  old amount  new code    new serial  new amount\n  1           11             100       2            12         2000\n  2           12             200       1            11         1000\n  3           13             300       2            200        2000\n  4           14             400       4            400        4000\n</code></pre>\n\n<p>table after algorithm is below :</p>\n\n<pre><code>old code    old serial  old amount  new code    new serial  new amount\n1             11             100        2            200      2000\n2             12             200        4            400      4000\n3             13             300            \n4             14             400        \n</code></pre>\n"}, {"tags": ["vba", "excel", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 3665990, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cec0e9aea658af992a1e691364bab02?s=128&d=identicon&r=PG&f=1", "display_name": "JSM", "link": "https://stackoverflow.com/users/3665990/jsm"}, "edited": false, "score": 0, "creation_date": 1426192643, "post_id": 28999414, "comment_id": 46283249, "body": "Thanks, this did the trick.  I probably would&#39;ve come up with something similar on my own given enough time.  As for the intellisense, I trust it 99% of the time; it&#39;s that 1% that really gets you."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1581013226, "last_edit_date": 1581013226, "creation_date": 1426116934, "answer_id": 28999414, "question_id": 28998969, "link": "https://stackoverflow.com/questions/28998969/why-listbox-doesnt-have-a-findstring-method-in-excel-vba/28999414#28999414", "title": "Why ListBox doesn&#39;t have a FindString method in Excel-VBA?", "body": "<p>I checked <code>Intellisense</code> and I don't think that <code>Method</code> is supported in VBA.<br> Other documentations I've found refers to <code>.Net Framework</code> only as well.<br> So maybe, it is not really supported in VBA, but regardless, you can create a function to do just that. Something like below.</p>\n\n<pre><code>Private Function SearchString(mysearch As String, mylist As Variant) As Long\n    Dim itm As Variant, idx As Long: idx = 0\n    If IsArray(mylist) Then\n        For Each itm In mylist\n            If mysearch = itm Then\n                SearchString = idx: Exit Function\n            End If\n            idx = idx + 1\n        Next\n    End If\n    SearchString = -1\nEnd Function\n</code></pre>\n\n<p>And you can use it like this:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim i As Long\n    'do the search\n    i = SearchString(\"WhatImSearching\", Me.ListBox1.List)\n    'select the item that match your search\n    If i &lt;&gt; -1 Then Me.ListBox1.Selected(i) = True \nEnd Sub\n</code></pre>\n\n<p>I'm not saying that the function I created above is the most efficient way.<bR>\nThat is just an example to give you an idea for a workaround. HTH.</p>\n\n<p><strong>Important:</strong> This works in single column ListBox which have a 1D array list. If you need to work on multi-column ListBox, you'll have to tweak the function a little.</p>\n"}], "owner": {"reputation": 215, "user_id": 3665990, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6cec0e9aea658af992a1e691364bab02?s=128&d=identicon&r=PG&f=1", "display_name": "JSM", "link": "https://stackoverflow.com/users/3665990/jsm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3902, "favorite_count": 0, "accepted_answer_id": 28999414, "answer_count": 1, "score": 1, "last_activity_date": 1581013226, "creation_date": 1426114690, "last_edit_date": 1426115562, "question_id": 28998969, "link": "https://stackoverflow.com/questions/28998969/why-listbox-doesnt-have-a-findstring-method-in-excel-vba", "title": "Why ListBox doesn&#39;t have a FindString method in Excel-VBA?", "body": "<p>Trying to search on a ListBox.  Specifically, I want to look at an array of items from the Cell, and for each one that matches an entry in the ListBox, I want it to select that List.\nI copy-pasted some code that was supposed to let me find a string, but it keeps telling me:</p>\n\n<blockquote>\n  <p>Compile Error: Method or Data Member not found.</p>\n</blockquote>\n\n<p>Any suggestions?</p>\n\n<p><strong>Relevant Code:</strong></p>\n\n<pre><code>Public local_Target As Range\n    ' local_Target is assigned in the sheet function to pass it here\n\nPrivate Sub Network_ListBox_Enter()\n    ' Get data in cell (if any)\n    Dim current_data As String\n    Dim entries() As String\n\n    current_data = local_Target.Value\n\n    If current_data = \"\" Then\n        Exit Sub\n    Else\n        entries = Split(current_data, vbNewLine)\n    End If\n\n    For Each Item In entries\n        FindMyString Item\n    Next Item\n\nEnd Sub\n\n\nPrivate Sub UserForm_Terminate()\n    Dim index As Integer\n    Dim result As String\n\n    ' Iterate through the listbox and create the result, then assign to\n    ' Target.value\n    For index = 0 To Network_ListBox.ListCount - 1\n        If Network_ListBox.Selected(index) Then\n            ' stuff\n            If result = \"\" Then\n                result = Network_ListBox.List(index)\n            ' ElseIf index = Network_ListBox.ListCount - 1 Then\n            '     result = result + Network_ListBox.List(index)\n            Else\n                result = result + vbNewLine + Network_ListBox.List(index)\n            End If\n        End If\n    Next index\n\n    local_Target.Value = result\nEnd Sub\n\nSub FindMyString(ByVal searchString As String)\n   ' Ensure we have a proper string to search for.\n   If searchString &lt;&gt; \"\" Then\n      ' Find the item in the list and store the index to the item.\n      Dim index As Integer\n\n      index = Me.Network_ListBox.FindString(searchString)\n      ' Determine if a valid index is returned. Select the item if it is valid.\n      If index &lt;&gt; -1 Then\n         Network_ListBox.SetSelected index, True\n      'Else\n      '   MessageBox.Show (\"The search string did not match any items in the ListBox\")\n      End If\n   End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2825175, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea35b0af5094fec40a5593158be5352b?s=128&d=identicon&r=PG&f=1", "display_name": "Zygmunt", "link": "https://stackoverflow.com/users/2825175/zygmunt"}, "edited": false, "score": 0, "creation_date": 1426145484, "post_id": 29002150, "comment_id": 46254740, "body": "Works great! Thanks! :-)"}], "tags": [], "owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "is_accepted": true, "score": 1, "last_activity_date": 1426136643, "last_edit_date": 1426136643, "creation_date": 1426136254, "answer_id": 29002150, "question_id": 28998637, "link": "https://stackoverflow.com/questions/28998637/access-show-values-from-subform-in-texboxes/29002150#29002150", "title": "Access - Show values from subform in texboxes", "body": "<p>Yes, you can do this, with a query as the contained object, you need to refer to the <a href=\"http://wiki.lessthandot.com/index.php/Crosstabs,_forms_and_updating\" rel=\"nofollow\">controls property</a>, for example, you can set the control source of a textbox to :</p>\n\n<pre><code>= [Forms]![frm_Results]![subfrm_shv_Results].form.controls(0)\n</code></pre>\n\n<p>Similarly, with a continuous form or such like :</p>\n\n<pre><code>= [Forms]![frm_Results]![subfrm_shv_Results].Form!Surname\n</code></pre>\n\n<p>The result is not editable, but you can get around this by setting the value in VBA.</p>\n\n<p>Make sure you use the name of the subform control, not the the name of the form contained.</p>\n"}], "owner": {"reputation": 89, "user_id": 2825175, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea35b0af5094fec40a5593158be5352b?s=128&d=identicon&r=PG&f=1", "display_name": "Zygmunt", "link": "https://stackoverflow.com/users/2825175/zygmunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1557, "favorite_count": 0, "accepted_answer_id": 29002150, "answer_count": 1, "score": 1, "last_activity_date": 1426136643, "creation_date": 1426113095, "question_id": 28998637, "link": "https://stackoverflow.com/questions/28998637/access-show-values-from-subform-in-texboxes", "title": "Access - Show values from subform in texboxes", "body": "<p>I have a form \"frm_Results\" with subform \"subfrm_shv_Results\" and three textboxes (\"txt_Number\", \"txt_Name\", 'txt_Surname\").</p>\n\n<p><img src=\"https://i.stack.imgur.com/BwqOu.jpg\" alt=\"frm_Results\"></p>\n\n<p>I can show values of selected record in <code>Debug.Print</code> or <code>MsgBox</code>:</p>\n\n<p><code>Debug.Print Form_frm_Results.subfrm_shv_Results.Form!Number.Value</code></p>\n\n<p><code>Debug.Print Form_frm_Results.subfrm_shv_Results.Form!Name.Value</code></p>\n\n<p><code>Debug.Print Form_frm_Results.subfrm_shv_Results.Form!Surname.Value</code></p>\n\n<p>But it is possible to show values of \"Number\", \"Name\" and \"Surname\" in textboxes after click on record in subform \"subfrm_shv_Results\"?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1426116756, "post_id": 28998569, "comment_id": 46246626, "body": "Are all the <b>.JPEG</b> files in a single folder??"}], "answers": [{"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1426230834, "last_edit_date": 1495540611, "creation_date": 1426139200, "answer_id": 29002692, "question_id": 28998569, "link": "https://stackoverflow.com/questions/28998569/pasting-file-properties-into-excel/29002692#29002692", "title": "Pasting file properties into Excel", "body": "<p>Why I wouldn't normally answer a code-less question I found this interesting.</p>\n\n<p>On Windows 7 I can get the <code>DateTaken</code> using <code>Shell</code> below. I know from prior experience (see <a href=\"https://stackoverflow.com/questions/9827715/get-list-of-subdirs-in-vba/9832978#9832978\">get list of subdirs in vba</a>) the <code>Detailsof</code> can vary by OS.</p>\n\n<p>Pls update the code below to point at your directory (currently <em>c:\\temp</em>)</p>\n\n<p>This works for me, but does leave additional characters (<code>?</code> or <code>CHR63</code>) in the date field that I'm yet to manage to clean)</p>\n\n<pre><code>Sub JPG_Details()\n\nDim objShell  As Object\nDim objFolder As Object\nDim objFolderItem As Object\nDim lngCnt As Long\n\n'If StrDir is dimensioned as a string, ParseName fails. Weird but true\nDim strDir\nDim strFile As String\nDim X(1 To 10000, 1 To 3)\n\n\nSet objShell = CreateObject(\"shell.application\")\nstrDir = \"C:\\temp\\\"\nSet objFolder = objShell.Namespace(strDir)\n\nstrFile = Dir(strDir &amp; \"*.jpg\")\n\nDo While Len(strFile) &gt; 0\n    lngCnt = lngCnt + 1\n    Set objFolderItem = objFolder.ParseName(strFile)\n    X(lngCnt, 1) = strFile\n    X(lngCnt, 2) = Split(objFolder.GetDetailsOf(objFolderItem, 12), \" \")(0)\n    X(lngCnt, 3) = Split(objFolder.GetDetailsOf(objFolderItem, 12), \" \")(1)\n    strFile = Dir\nLoop\n\n[a1].Resize(UBound(X, 1), UBound(X, 2)).Value2 = X\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4660607, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153185183199393/picture?type=large", "display_name": "David Johnston", "link": "https://stackoverflow.com/users/4660607/david-johnston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 670, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426230848, "creation_date": 1426112813, "last_edit_date": 1531161705, "question_id": 28998569, "link": "https://stackoverflow.com/questions/28998569/pasting-file-properties-into-excel", "title": "Pasting file properties into Excel", "body": "<p>I have a number of JPEG image files (roughly 8,000!) that I would like to copy the properties for into excel - names of the files and time the specific photo  was taken. </p>\n\n<p>I'd love it if there was a quick and easy way to have this information copied over into separate cells, rather than me having to type them out individually. the format of the page is simple - three columns of Date, Time Taken and Name.</p>\n\n<p>I am not a programmer at all, so the simplest solution (if any) and language would be most helpful! </p>\n\n<p>Cheers</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 468, "user_id": 4628327, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MH5Ee.png?s=128&g=1", "display_name": "Ralph J", "link": "https://stackoverflow.com/users/4628327/ralph-j"}, "edited": false, "score": 0, "creation_date": 1426113692, "post_id": 28998532, "comment_id": 46245423, "body": "Are you looking for someone to write the code for you, or have you made a start at the code yourself?  Can you show us what you have so far?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1426115759, "post_id": 28998532, "comment_id": 46246226, "body": "It is a bit hard to see what is supposed to be in each of the columns of your table too, it would be nice if you made an attempt at improving the formatting."}, {"owner": {"reputation": 1, "user_id": 4660522, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vPs6v3Yv65g/AAAAAAAAAAI/AAAAAAAAAIo/zjsylqP1XOY/photo.jpg?sz=128", "display_name": "William May", "link": "https://stackoverflow.com/users/4660522/william-may"}, "edited": false, "score": 0, "creation_date": 1426270306, "post_id": 28998532, "comment_id": 46318837, "body": "I tried to add a pic to the request, but the system would not allow this."}], "owner": {"reputation": 1, "user_id": 4660522, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vPs6v3Yv65g/AAAAAAAAAAI/AAAAAAAAAIo/zjsylqP1XOY/photo.jpg?sz=128", "display_name": "William May", "link": "https://stackoverflow.com/users/4660522/william-may"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426270478, "creation_date": 1426112671, "last_edit_date": 1531164843, "question_id": 28998532, "link": "https://stackoverflow.com/questions/28998532/duplicate-activity-list-has-a-single-resource-assignment", "title": "Duplicate activity list, has a single resource assignment", "body": "<p>I Have a task list in column \"B\", starting at row 2 and finishes at row 900. In cloumn \"C\" I have a resource assignment. Some background, The Primavera scheduling application exports all schedule activities, when multiple resources are assigned to an activity, the export will have duplicate lines. I would like to be able to find the duplicate lines, and then move the resources assigned to the next available column and up to the first unique line. The delete the additional duplicated activities. An example of this is as follows.</p>\n\n<p>B   C                                                  D                                    E\n 1.0    Install Channel Head, &amp; Torque  Journeyman<br>\n 2.0    Install Channel Head, &amp; Torque  Eq. Operator<br>\n 3.0    Install Channel Head, &amp; Torque  Rigger      </p>\n\n<p>1.0    Install Channel Head, &amp; Torque  Journeyman          Eq. Operator\n 2.0    Row Deleted<br>\n 3.0    Row Deleted         </p>\n"}, {"tags": ["vba", "excel", "sumifs"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 3, "creation_date": 1426110837, "post_id": 28998099, "comment_id": 46244266, "body": "<code>RecebimentosValor</code> should be declared as <code>Double</code> or <code>Single</code> data type to hold the decimal places."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1426111070, "creation_date": 1426111070, "answer_id": 28998189, "question_id": 28998099, "link": "https://stackoverflow.com/questions/28998099/sumif-gives-answer-without-decimals/28998189#28998189", "title": "SumIf gives answer without decimals", "body": "<p>Be sure to use <strong>Double:</strong></p>\n\n<pre><code>Sub ytrewq()\n    Dim SumRange As Range, RecebimentosValor As Double\n    Set SumRange = Range(\"A1:A10\")\n    RecebimentosValor = WorksheetFunction.SumIf(SumRange, \"&gt;0\")\n    MsgBox RecebimentosValor\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/nhKjZ.png\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1426122434, "post_id": 28998846, "comment_id": 46248228, "body": "This way <code>y</code> is implicitly a <code>Variant</code> data type. It will work as well. But it is always better if this type can be avoided."}, {"owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1426149981, "post_id": 28998846, "comment_id": 46256685, "body": "There&#39;s no valid reason to avoid a variant variable. Otherwise they wouldn&#39;t have been invented nor introduced in VBA."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1426198795, "post_id": 28998846, "comment_id": 46285981, "body": "If you&#39;ve been coding for a long time, you&#39;ll realize that there are advantages and disadvantages of using variant data type. As for a well structured routine, it is always best to know the type of data you&#39;re working on. This will help you anticipate and control more runtime errors and would be easier to debug and maintain. That is the time you&#39;ll realize that the disadvantages out weighs the advantages. Well that is for me, I&#39;m not saying that it is true to all."}], "tags": [], "owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "is_accepted": false, "score": 0, "last_activity_date": 1426114035, "creation_date": 1426114035, "answer_id": 28998846, "question_id": 28998099, "link": "https://stackoverflow.com/questions/28998099/sumif-gives-answer-without-decimals/28998846#28998846", "title": "SumIf gives answer without decimals", "body": "<p>I see no problems with</p>\n\n<pre><code>Sub M_snb()\n y = [sum((A1:A12&gt;0)*(A1:A12))]\n y = Application.SumIf(Range(\"A1:A12\"), \"&gt;0\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 4657027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3de13cb3dfdd7f96db0c3423591cd0?s=128&d=identicon&r=PG&f=1", "display_name": "Swapnil Wankhede", "link": "https://stackoverflow.com/users/4657027/swapnil-wankhede"}, "is_accepted": false, "score": 0, "last_activity_date": 1426160800, "creation_date": 1426160800, "answer_id": 29008932, "question_id": 28998099, "link": "https://stackoverflow.com/questions/28998099/sumif-gives-answer-without-decimals/29008932#29008932", "title": "SumIf gives answer without decimals", "body": "<p>Not always. It depends on your input. If your input in decimal format then\noutput will be produce in Decimal form. Simple mathematics rule.</p>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 28998189, "answer_count": 3, "score": 1, "last_activity_date": 1426176262, "creation_date": 1426110705, "last_edit_date": 1531164843, "question_id": 28998099, "link": "https://stackoverflow.com/questions/28998099/sumif-gives-answer-without-decimals", "title": "SumIf gives answer without decimals", "body": "<p>I'm using VBA to sum the values of the cells within my SumRange given that they are positive numbers. The code works, however, it is not returning an answer with decimal places when it should have them.</p>\n\n<pre><code>RecebimentosValor = WorksheetFunction.SumIf(SumRange, \"&gt;0\")\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1426134782, "creation_date": 1426134782, "answer_id": 29001921, "question_id": 28998094, "link": "https://stackoverflow.com/questions/28998094/how-to-run-vba-macro-code-in-powerpoint-2010-without-opening-the-developer/29001921#29001921", "title": "How to run VBA (macro) code in PowerPoint 2010 without opening the developer", "body": "<p>Thanks for the opportunity. There are 3 main parts that can allow you to do that.</p>\n\n<ol>\n<li>Need a way to auto run a macro upon presentation launch</li>\n<li>Need a way to handle PowerPoint Application Events</li>\n<li>A regular module for calls from Event Handler</li>\n</ol>\n\n<p><b>Solution:</b></p>\n\n<ol>\n<li>Follow instructions from <a href=\"http://www.pptalchemy.co.uk/PowerPoint_Auto_Open_Code.html\" rel=\"nofollow noreferrer\">PPT Alchemy</a>, objective is to add UI element:<br> <code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" \nonLoad=\"onLoadCode\" &gt;\n&lt;/customUI&gt;</code><br>\nwhere <strong>onLoadCode</strong> is a sub you will create in a Module</li>\n<li>According to MS <a href=\"https://msdn.microsoft.com/en-us/library/office/ff746018(v=office.14).aspx\" rel=\"nofollow noreferrer\">How to: Use Events with the Application Object</a>, you need to create a Class Module, have it initialized by a Sub. Here we want the <code>onLoadCode</code> to do initialization.<br><img src=\"https://i.stack.imgur.com/U9ev8.png\" alt=\"EventClassModule\"></li>\n<li>A Sub in a Module will do the Chart updates.<br><img src=\"https://i.stack.imgur.com/jKu9x.png\" alt=\"PlayerModule\"></li>\n</ol>\n\n<p>Ensure the Presentation is set to Kiosk mode for your purpose:<br><img src=\"https://i.stack.imgur.com/vxhWl.png\" alt=\"SlideShowSetting\">\n<hr>\n<strong>CODES</strong></p>\n\n<p>Class Module: <strong>EventClassModule</strong></p>\n\n<pre><code>Public WithEvents App As Application\n\nPrivate Sub App_SlideShowBegin(ByVal Wn As SlideShowWindow)\n    Debug.Print Now &amp; vbTab &amp; \"App_SlideShowBegin\"\n    updateCharts Wn\nEnd Sub\n\nPrivate Sub App_SlideShowNextSlide(ByVal Wn As SlideShowWindow)\n    Debug.Print Now &amp; vbTab &amp; \"App_SlideShowNextSlide\"\n    updateCharts Wn\nEnd Sub\n</code></pre>\n\n<p>Module: <strong>Player</strong></p>\n\n<pre><code>Dim X As New EventClassModule\n\nSub OnLoadCode()\n    InitializeApp\nEnd Sub\n\nSub InitializeApp()\n    Set X.App = Application\n    ActivePresentation.SlideShowSettings.Run\nEnd Sub\n\nSub updateCharts(ByRef Win As SlideShowWindow)\n    Dim sld As Slide\n    Dim shp As Shape\n    Debug.Print Now &amp; vbTab &amp; \"Playing slide with index: \" &amp; Win.View.Slide.SlideIndex\n    If Win.View.Slide.SlideIndex = 1 Then\n        Debug.Print Now &amp; vbTab &amp; \"Update charts on other slides!\"\n        For Each sld In Win.Presentation.Slides\n            For Each shp In sld.Shapes\n                If shp.HasChart Then\n                    Debug.Print Now &amp; vbTab &amp; \"Update chart \"\"\" &amp; shp.Chart.Name &amp; \"\"\" on slide index \" &amp; sld.SlideIndex\n                    On Error Resume Next\n                    shp.LinkFormat.Update\n                    shp.Chart.Refresh\n                    If Err.Number &lt;&gt; 0 Then\n                        Debug.Print Now &amp; vbTab &amp; \"ERR(\" &amp; Err.Number &amp; \") \" &amp; Err.Description\n                        Err.Clear\n                    End If\n                    On Error GoTo 0\n                End If\n            Next\n        Next\n    End If\nEnd Sub\n</code></pre>\n\n<p>You should remove the Debug lines for production environment. Have fun!</p>\n"}], "owner": {"reputation": 47, "user_id": 1671033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f439dea91c5c89700879ccdd611a0f1?s=128&d=identicon&r=PG", "display_name": "user1671033", "link": "https://stackoverflow.com/users/1671033/user1671033"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2741, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426192400, "creation_date": 1426110675, "last_edit_date": 1426192400, "question_id": 28998094, "link": "https://stackoverflow.com/questions/28998094/how-to-run-vba-macro-code-in-powerpoint-2010-without-opening-the-developer", "title": "How to run VBA (macro) code in PowerPoint 2010 without opening the developer", "body": "<p>This issues is a bit of quirk - and it may be a systematic issue that just won't work. My overall project is that I need to have a presentation playing on loop 24/7 and it has some linked charts from an excel file that it needs to pull data from. I wrote the basic code to do this.</p>\n\n<p>However when I first open PowerPoint and run the presentation -> No code is run (verified with Debug.Prints and MsgBoxes). However if I just open up the code in developer (But don't edit) and run the presentation, everything works as planned. I've turned all the Trust Center Security settings to allow all macros and setup my network files as automatically trusted as well. I've also verified that this occurs with another of the laptops here. Any help is greatly appreciated. For reference, this is my simple code that needs to run.</p>\n\n<pre><code>Sub updateCharts()\n\nDim i As Integer\nDim sld As Slide\nDim shp As Shape\n\nIf IsFileOpen(filePath) = False Then\n    If ActivePresentation.SlideShowWindow.View.Slide.SlideIndex = 1 Then\n        For Each sld In ActivePresentation.Slides\n            For Each shp In sld.Shapes\n                If shp.HasChart Then\n                    On Error Resume Next\n                    shp.LinkFormat.Update\n                    shp.Chart.Refresh\n                    On Error GoTo 0\n                End If\n            Next shp\n        Next sld\n    End If\nEnd If\n\nEnd Sub\n\n\nSub OnSlideShowPageChange(ByVal Win As SlideShowWindow)\n\nCall updateCharts\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1426110183, "post_id": 28997782, "comment_id": 46243975, "body": "With using breaks; can you give us after which line of the code error appears?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1426110501, "post_id": 28997782, "comment_id": 46244098, "body": "Try <code>&lt;&gt;cell</code> as that is what you are looping, &#39;each cell in columnrange.cells&#39;- you also want to hide the <code>cell.entirecolumn.hidden=true</code>"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1426149650, "post_id": 28997782, "comment_id": 46256500, "body": "As shA.t mentioned. please provide us with the error line. It&#39;s much simpler to debug if you know where to look ;)"}, {"owner": {"reputation": 35, "user_id": 4093475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d69fb098357ceed4e3b3d52d517337c?s=128&d=identicon&r=PG&f=1", "display_name": "StillLearning", "link": "https://stackoverflow.com/users/4093475/stilllearning"}, "edited": false, "score": 0, "creation_date": 1426184927, "post_id": 28997782, "comment_id": 46279163, "body": "Added to above but wanted to list here as well - Thanks everyone for the help :D - turns out range was declared and set as &quot;columnnrange&quot; and the for loop was using &quot;columnrange&quot;. It&#39;s the little things ;) . Appreciate the insight and guidance all!"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 4638010, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-zU9SMZUvpdI/AAAAAAAAAAI/AAAAAAAAAEU/QLl-vrx2-54/photo.jpg?sz=128", "display_name": "Michael Foster", "link": "https://stackoverflow.com/users/4638010/michael-foster"}, "is_accepted": false, "score": 0, "last_activity_date": 1426115660, "creation_date": 1426115660, "answer_id": 28999152, "question_id": 28997782, "link": "https://stackoverflow.com/questions/28997782/object-required-error-in-workbook-open-with-for-loop/28999152#28999152", "title": "Object required error in Workbook_Open with For loop", "body": "<p>You will need to be sure the SelectData form is open. Do you have the code behind for the OK or Close button? If you use something like <code>Me.Close</code> then you won't have an object. You can, instead, use <code>Me.Hide</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1426149511, "creation_date": 1426149511, "answer_id": 29005112, "question_id": 28997782, "link": "https://stackoverflow.com/questions/28997782/object-required-error-in-workbook-open-with-for-loop/29005112#29005112", "title": "Object required error in Workbook_Open with For loop", "body": "<p>Change the loop condition to verify <strong>cell</strong> instead of <strong>columnrange</strong>. Here is a simplified code that should work.</p>\n\n<pre><code>For Each cell In columnrange    \n    If SelectData.DisplayData.Value &lt;&gt; cell Then\n        cell.EntireColumn.Hidden = True\n    Else\n        cell.EntireColumn.Hidden = False\n    End If    \nNext cell\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4093475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d69fb098357ceed4e3b3d52d517337c?s=128&d=identicon&r=PG&f=1", "display_name": "StillLearning", "link": "https://stackoverflow.com/users/4093475/stilllearning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 29005112, "answer_count": 2, "score": 0, "last_activity_date": 1426184858, "creation_date": 1426109531, "last_edit_date": 1426184858, "question_id": 28997782, "link": "https://stackoverflow.com/questions/28997782/object-required-error-in-workbook-open-with-for-loop", "title": "Object required error in Workbook_Open with For loop", "body": "<p>***It's working!! Thanks everyone for the help :D - turns out range was declared and set as \"columnnrange\" and the for loop was using \"columnrange\". It's the little things ;) . Appreciate the insight and guidance all!</p>\n\n<p>*Thanks for the help everyone! I've updated the code per the responses. The error definitely comes when the For loop runs - if it is commented out there is no error. I believe the error is with the range \"columnrange\" object. Thanks!!</p>\n\n<p>I have a simple <code>Workbook_Open()</code> routine that opens a UserForm \"SelectData\" and sets a ComboBox \"DisplayData\" value. I have a <code>MsgBox</code> that confirms the value set in the ComboBox \"DisplayData\".<br>\nOnce set, the UserForm \"SelectData\" is hidden. Then, there is a <code>\"for\"</code> loop to hide all columns where the given cell in range \"columnrange\" is not equal to the ComboBox value. I'm getting an error \"object required\" but for the life of me cannot figure out where I'm going wrong. The goal of this spreadsheet is: \"on open\", allow the user to filter the visible columns on an excel doc exported from a SharePoint list.<br>\nThanks in advance!!</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nDim columnrange As Range\nDim cell As Range\n\nSet columnnrange = ActiveWorkbook.Worksheets(\"owssvr\").Range(\"G1:Z1\")\n\nSelectData.Show\n\nMsgBox (SelectData.DisplayData.Value)\n\nFor Each cell In columnrange\n    If SelectData.DisplayData.Value &lt;&gt; cell Then\n        cell.EntireColumn.Hidden = True\n   Else\n        cell.EntireColumn.Hidden = False\n   End If\nNext cell\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2007", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2820, "user_id": 3390468, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/768800013/picture?type=large", "display_name": "Steven Martin", "link": "https://stackoverflow.com/users/3390468/steven-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1426107612, "creation_date": 1426107612, "answer_id": 28997264, "question_id": 28997106, "link": "https://stackoverflow.com/questions/28997106/how-do-you-lookup-data-in-excel-matching-multiple-columns-i-e-date-product/28997264#28997264", "title": "How do you lookup data in Excel matching multiple columns (i.e. date &amp; product, date &amp; region)?", "body": "<p>If the picture is what your trying to do , then dont bother with the lookup in two columns,  just use a PIVOT TABLE and you will have the data in seconds  ,  you can refresh the pivot with one click or even automatically if you need it</p>\n"}, {"comments": [{"owner": {"reputation": 720, "user_id": 4660313, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10204507953313670/picture?type=large", "display_name": "Zach", "link": "https://stackoverflow.com/users/4660313/zach"}, "edited": false, "score": 0, "creation_date": 1426108712, "post_id": 28997341, "comment_id": 46243220, "body": "Well that gave me something, but not exactly what I want... I think I am on the right track but I honestly don&#39;t know what&#39;s going on in this formula. Here is what I have <a href=\"http://imgur.com/NOnBwxp\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 720, "user_id": 4660313, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10204507953313670/picture?type=large", "display_name": "Zach", "link": "https://stackoverflow.com/users/4660313/zach"}, "edited": false, "score": 0, "creation_date": 1426109153, "post_id": 28997341, "comment_id": 46243489, "body": "This worked! Thank you so much I have been trying to figure this out for hours. I assume that if it needs to match another value (matching now: date, product. matching further: geo, date, product) then I can just add it using another asterisk in the MATCH part?"}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "reply_to_user": {"reputation": 720, "user_id": 4660313, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10204507953313670/picture?type=large", "display_name": "Zach", "link": "https://stackoverflow.com/users/4660313/zach"}, "edited": false, "score": 0, "creation_date": 1426109229, "post_id": 28997341, "comment_id": 46243528, "body": "That&#39;s true :) Happy to help."}, {"owner": {"reputation": 720, "user_id": 4660313, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10204507953313670/picture?type=large", "display_name": "Zach", "link": "https://stackoverflow.com/users/4660313/zach"}, "edited": false, "score": 0, "creation_date": 1426109379, "post_id": 28997341, "comment_id": 46243625, "body": "Okay great, thanks again! Would upvote but it seems my reputation restricts me there as well..."}], "tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": true, "score": 1, "last_activity_date": 1426108395, "last_edit_date": 1426108395, "creation_date": 1426107881, "answer_id": 28997341, "question_id": 28997106, "link": "https://stackoverflow.com/questions/28997106/how-do-you-lookup-data-in-excel-matching-multiple-columns-i-e-date-product/28997341#28997341", "title": "How do you lookup data in Excel matching multiple columns (i.e. date &amp; product, date &amp; region)?", "body": "<p>The following formula will do it (<em>array formula</em> which has to be entered using <strong>Ctrl</strong> + <strong>Shift</strong> + <strong>Enter</strong>):</p>\n\n<pre><code>=INDEX($C$5:$C$9,MATCH(1,($B$5:$B$9=$E5)*($A$5:$A$9=F$4),0))\n</code></pre>\n\n<p>I assume that:</p>\n\n<ul>\n<li>your data of Table 1 is in A5:C10 </li>\n<li>E5 has the value of \"Widget\"</li>\n<li>F4 has the date value</li>\n</ul>\n\n<p>This array formula should be entered in F5.</p>\n"}], "owner": {"reputation": 720, "user_id": 4660313, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10204507953313670/picture?type=large", "display_name": "Zach", "link": "https://stackoverflow.com/users/4660313/zach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "accepted_answer_id": 28997341, "answer_count": 2, "score": 0, "last_activity_date": 1449177013, "creation_date": 1426107087, "last_edit_date": 1531161705, "question_id": 28997106, "link": "https://stackoverflow.com/questions/28997106/how-do-you-lookup-data-in-excel-matching-multiple-columns-i-e-date-product", "title": "How do you lookup data in Excel matching multiple columns (i.e. date &amp; product, date &amp; region)?", "body": "<p><a href=\"https://i.stack.imgur.com/4usc6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4usc6.png\" alt=\"http://imgur.com/BYejKRb\"></a></p>\n\n<p>As you can see in the picture above, I want to take Table 1 and, using formulas that can auto-populate, turn it into Table 2.</p>\n\n<p>I tried using vlookup and index but I'm not 100% sure on how to use the latter and the former allows you to only use one lookup value - I need it to be able to match up both the date and the product.</p>\n\n<p>This needs to be formula-based because table 1 automatically updates based on a data feed.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1426109791, "post_id": 28996838, "comment_id": 46243797, "body": "@PieterGeerkens: I think using that intimidating word is highly unrecommended in SO."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1426110133, "post_id": 28996838, "comment_id": 46243951, "body": "Apparently you know (or you can count) how many columns and rows are included in child sheets. And you know the order of child data in the parent sheet. So you can just count rows and columns using your order and based on that paste values to the parent sheet."}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1426110554, "post_id": 28996838, "comment_id": 46244123, "body": "@JLILIAman: When referring to myself, humorously, I didn&#39;t see the problem. I would never refer to anyone besides myself with that term."}, {"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1426111701, "post_id": 28996838, "comment_id": 46244679, "body": "Note : in first line of your code you select your sheet, and with those next three lines you can find last row (i. A65536: for older versions of excel was the last row of column A - In newer versions its very bigger) and then you copy ranges by columns."}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "edited": false, "score": 0, "creation_date": 1426132586, "post_id": 28996838, "comment_id": 46250820, "body": "So after I map the first child file( eg 50 rows of data), some columns would be completely empty( in my case it&#39;s 15 for the first file).  Now when I try to map the second file, I need the data to start from 51st row, it does start there but the columns which need to have data are blank as the data goes to the first 50 blank columns. Sorry for being so dumb,  but I cannot just present it properly"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1426109358, "creation_date": 1426106196, "last_edit_date": 1426108386, "question_id": 28996838, "link": "https://stackoverflow.com/questions/28996838/generalise-in-vba", "title": "Generalise in Vba", "body": "<p>I am new to Vba for excel programming(worked in access before) and want help in understanding on how to generalize excel.  I tried a lot of code in Vba from internet and stack overflow, below is where I need help.</p>\n\n<p>How can I copy paste data. I have a main sheet( 20 columns) and daily small sheets having around 5 columns(can be different in each of the small sheets). Now I need to map these sheets in to the parent sheet. \nEg; I map a file of 50 rows and 5 columns, so in parent sheet 15 columns will be empty for all the 50 rows. For next sheet some other columns will be empty. I am just stuck as how to select a particular columns every time.</p>\n\n<pre><code>x.Worksheets(\"Sheet1\").Activate\nRange(\"A65536\").Select **' What does A65536 mean**\nActiveCell.End(xlUp).Select\nlastrow = ActiveCell.Row\nRange(\"A2:A\" &amp; lastrow).Copy y.Worksheets(\"Sheet1\").Range(\"a65536\").End(xlUp).Offset(1, 0)\nRange(\"B2:B\" &amp; lastrow).Copy y.Worksheets(\"Sheet1\").Range(\"b65536\").End(xlUp).Offset(1, 0)\n</code></pre>\n\n<p>The above code works but not for me because I have blank values too for columns in some rows and therefore the next values occupy these spaces and that is wrong for me.Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1426104490, "post_id": 28995696, "comment_id": 46240813, "body": "You can try removing <code>Let</code> and leaving just the remaining part in that row: <code>formString = &quot;=&quot; &amp; Range(colAddress)</code>"}, {"owner": {"reputation": 168, "user_id": 979638, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/79ecfdad8b16115e2e070ae89ba97f05?s=128&d=identicon&r=PG", "display_name": "AChrapko", "link": "https://stackoverflow.com/users/979638/achrapko"}, "reply_to_user": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1426104903, "post_id": 28995696, "comment_id": 46241033, "body": "It seems to function the same way even after removing <code>Let</code>. Existing validation-lists populate fine, but it still throws <code>Run-time error &#39;1004&#39;</code> if the list does not exist"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1426106382, "post_id": 28995696, "comment_id": 46241903, "body": "You need some sort of error handling. Something like <code>on error goto: errorhandler</code> and then add  <code>errorhandler: some commands here</code> to the end of the sub."}, {"owner": {"reputation": 168, "user_id": 979638, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/79ecfdad8b16115e2e070ae89ba97f05?s=128&d=identicon&r=PG", "display_name": "AChrapko", "link": "https://stackoverflow.com/users/979638/achrapko"}, "edited": false, "score": 0, "creation_date": 1426107376, "post_id": 28995696, "comment_id": 46242457, "body": "Is there a syntax that I can effectively wrap the entire <code>With Selection.Validation ... End With</code> in an <code>IFERROR()</code> as that block of code is in a loop that checks each Option column in the row that was changed (of which, there are 20 options) and I need to just leave the cell unmodified only if there was no <b>Name (see edit for details</b>"}], "owner": {"reputation": 168, "user_id": 979638, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/79ecfdad8b16115e2e070ae89ba97f05?s=128&d=identicon&r=PG", "display_name": "AChrapko", "link": "https://stackoverflow.com/users/979638/achrapko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 683, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1426107483, "creation_date": 1426102292, "last_edit_date": 1426107483, "question_id": 28995696, "link": "https://stackoverflow.com/questions/28995696/vba-excel-adding-a-dynamic-validation-list", "title": "VBA Excel adding a dynamic validation list", "body": "<p>I have a worksheet in which I am trying to programmatically add DataValidation-Lists when appropriate to the <code>Range(BF:BZ)</code></p>\n\n<p>Currently all cells in <code>Range(D3:D500)</code> use a DataValidation list <code>=type</code> and I have a <code>sub</code> that checks if any cells in that range change. If so it updates all the cells in that row. When I get to the <strong>options</strong> range it references a table on a separate sheet for what to fill in.</p>\n\n<p><img src=\"https://i.stack.imgur.com/76OAC.png\" alt=\"example of different types\"></p>\n\n<p>At this point when filling each <strong>option</strong> I need to also create a DataValidation-list when appropriate, based on the text in the cell. row 6 is an example of results that would require a list, while rows 3 through 5 have multiple results that should just be left as is (for someone to manually type in an ID later or something along those lines)</p>\n\n<pre><code>Dim formString As String\nLet formString = \"=\" &amp; Range(colAddress)\nRange(colAddress).Select\n    With Selection.Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _\n    xlBetween, Formula1:=formString\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"InputTitle\"\n    .ErrorTitle = \"ErrorTitle\"\n    .InputMessage = \"InputMsg\"\n    .ErrorMessage = \"ErrorMsg\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n</code></pre>\n\n<p>This code works in the case that there is a valid DataValidation-list, but I get a <code>Run-time error '1004': Application-defined or object-defined error</code> when <code>formString</code> has values such as <code>speed_OW</code></p>\n\n<p>Would I have to make essentially a list of lists which contains all the valid lookups and call something like <code>IFERROR(VLOOKUP(Range(colAddress),listOfLists,1,FALSE),\"No List\")</code></p>\n\n<p>Or is there a cleaner way of doing this so as to:  if a data-validation-list exists for the current cell then set it, else leave the cell alone for the user to manually change</p>\n\n<p><strong>Edit for additional information below</strong></p>\n\n<p>So in another question someone mentioned making references to the <em>Name Manager</em> and I think just looking through that is all I need to check in a conditional. I will try this tomorrow</p>\n"}, {"tags": ["excel", "vba", "url"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4496765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SNVM.jpg?s=128&g=1", "display_name": "Peatawn", "link": "https://stackoverflow.com/users/4496765/peatawn"}, "edited": false, "score": 0, "creation_date": 1426106808, "post_id": 28996836, "comment_id": 46242145, "body": "It works! This is great! Thanks! I&#39;ll add code to my macro to find/replace all caracters to escape entire URL. Thanks again!"}, {"owner": {"reputation": 15, "user_id": 4496765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SNVM.jpg?s=128&g=1", "display_name": "Peatawn", "link": "https://stackoverflow.com/users/4496765/peatawn"}, "edited": false, "score": 0, "creation_date": 1426106853, "post_id": 28996836, "comment_id": 46242176, "body": "I deleted my previous comment because I omitted one escape! Sorry. ;-P"}], "tags": [], "owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "is_accepted": true, "score": 0, "last_activity_date": 1426106190, "last_edit_date": 1495535402, "creation_date": 1426106190, "answer_id": 28996836, "question_id": 28995414, "link": "https://stackoverflow.com/questions/28995414/excel-vb-to-shorten-urls-with-bit-ly-doesnt-pass-3d-in-long-url/28996836#28996836", "title": "Excel VB to shorten URLs with Bit.ly doesn&#39;t pass &quot;%3d&quot; in long URL", "body": "<p>I'd think that you must escape the entire url when it is used as a parameter inside another url. The problem may not be <code>%3d</code> but the <code>&amp;</code> that follows after it (it starts the next parameter in the bitly-url).</p>\n\n<p>Try to escape this<br>\n<code>http://domain.com/se/?st=YmUQaIg9PCoCs3vex5XHE1NnqfurVpWsXMXix0QkyO4%3d&amp;p=A43S8C</code><br>\nentirely to<br>\n<code>http%3A%2F%2Fdomain.com%2Fse%2F%3Fst%3DYmUQaIg9PCoCs3vex5XHE1NnqfurVpWsXMXix0QkyO4%253d%26p%3DA43S8C</code></p>\n\n<p><a href=\"https://stackoverflow.com/questions/218181/how-can-i-url-encode-a-string-in-excel-vba\">Here</a> are ways to do this in Excel.</p>\n"}], "owner": {"reputation": 15, "user_id": 4496765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SNVM.jpg?s=128&g=1", "display_name": "Peatawn", "link": "https://stackoverflow.com/users/4496765/peatawn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1304, "favorite_count": 0, "accepted_answer_id": 28996836, "answer_count": 1, "score": 1, "last_activity_date": 1454669676, "creation_date": 1426101325, "last_edit_date": 1426103990, "question_id": 28995414, "link": "https://stackoverflow.com/questions/28995414/excel-vb-to-shorten-urls-with-bit-ly-doesnt-pass-3d-in-long-url", "title": "Excel VB to shorten URLs with Bit.ly doesn&#39;t pass &quot;%3d&quot; in long URL", "body": "<p>I'm building a VB macro that shortens URLs in bulk (we're talking thousands). My macro works just fine, until I encountered a long URL with \"%3d\", which translates into the equals symbol (=). </p>\n\n<p>Here is and example of the long URL: <a href=\"http://domain.com/se/?st=YmUQaIg9PCoCs3vex5XHE1NnqfurVpWsXMXix0QkyO4%3d&amp;p=A43S8C\" rel=\"nofollow\">http://domain.com/se/?st=YmUQaIg9PCoCs3vex5XHE1NnqfurVpWsXMXix0QkyO4%3d&amp;p=A43S8C</a></p>\n\n<p>My macro sends the entirety of the URL to Bit.ly, but Bit.ly's response text shows that it shortened this:  <a href=\"http://domain.com/se/?st=YmUQaIg9PCoCs3vex5XHE1NnqfurVpWsXMXix0QkyO4=\" rel=\"nofollow\">http://domain.com/se/?st=YmUQaIg9PCoCs3vex5XHE1NnqfurVpWsXMXix0QkyO4=</a></p>\n\n<p>And in fact, when I go to the shortened link, I'm not directed to the full URL.</p>\n\n<p>This is the portion of my code that prompts Bit.ly and gets the response:</p>\n\n<pre><code>ApiRequest = \"https://api-ssl.bitly.com/v3/shorten?access_token=\" &amp; Token &amp; \"&amp;longUrl=\" &amp; LongURL\nWith HttpRequest\n    .Open \"GET\", ApiRequest, False\n    .Send\nEnd With\n\nResponse = HttpRequest.ResponseText\nHttpRequest.WaitForResponse\nBeginCar = InStr(Response, \"hash\")\nEndCar = BeginCar + 15\nBitlyResult = Right(Mid(Response, BeginCar, (EndCar - BeginCar)), 7)\nRange(\"J\" &amp; l).Value = \"http://bit.ly/\" &amp; BitlyResult\n</code></pre>\n\n<p>How can I tell Bit.ly not to shorten a truncated URL and to keep the symbols such as \"%3d\"?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["excel", "excel-2010", "vb.net-2010", "vba"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "edited": false, "score": 0, "creation_date": 1426101593, "post_id": 28995389, "comment_id": 46239105, "body": "Trust me, I&#39;ve tried... I tried so many combinations while referencing to the line you posted, and I couldn&#39;t get it working..."}, {"owner": {"reputation": 186, "user_id": 4585791, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3699aa68e22875c2560d9498947f462a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Wertz", "link": "https://stackoverflow.com/users/4585791/robert-wertz"}, "reply_to_user": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "edited": false, "score": 0, "creation_date": 1426106000, "post_id": 28995389, "comment_id": 46241659, "body": "Can you run it again and have it print out the values of each variable at the time each variable is used? That way we can see what is being input into the system."}, {"owner": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "edited": false, "score": 0, "creation_date": 1426111640, "post_id": 28995389, "comment_id": 46244657, "body": "Don&#39;t know. We do know where the problem is... It&#39;s this code:     Dim sfinal = Path.Combine(sFolder, sMonth)     xlSh.SaveAs(sfinal &amp; Format(sDate) &amp; &quot;.xlsx&quot;)  I just don&#39;t know of any other way to SaveAs"}, {"owner": {"reputation": 186, "user_id": 4585791, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3699aa68e22875c2560d9498947f462a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Wertz", "link": "https://stackoverflow.com/users/4585791/robert-wertz"}, "reply_to_user": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "edited": false, "score": 0, "creation_date": 1426178167, "post_id": 28995389, "comment_id": 46275402, "body": "Glad you got it working! I was asking for the output as I was wondering about that ending slash, but sounds like you got it on your own, congrats!"}, {"owner": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "edited": false, "score": 0, "creation_date": 1426178473, "post_id": 28995389, "comment_id": 46275628, "body": "Oh, on a another thingie.... How to check if directory exists simply save the file, if it doesn&#39;t, then create the folder and save the file inside it?"}, {"owner": {"reputation": 186, "user_id": 4585791, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3699aa68e22875c2560d9498947f462a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Wertz", "link": "https://stackoverflow.com/users/4585791/robert-wertz"}, "reply_to_user": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "edited": false, "score": 0, "creation_date": 1426185102, "post_id": 28995389, "comment_id": 46279266, "body": "<a href=\"http://stackoverflow.com/questions/15480389/excel-vba-check-if-directory-exists-error\" title=\"excel vba check if directory exists error\">stackoverflow.com/questions/15480389/&hellip;</a>  Something like   <code>IF Dir(sFolder &amp; Format(sMonth), vbDirectory) = &quot;&quot;  Then  My.Computer.FileSystem.CreateDirectory(sFolder &amp; Format(sMonth))      xlSh.SaveAs(sfinal &amp; Format(sFileName))  Else  xlSh.SaveAs(sfinal &amp; Format(sFileName))  End If</code>  Hopefully that makes sense, I can&#39;t seem to separate the lines for the code haha"}, {"owner": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "edited": false, "score": 0, "creation_date": 1426186633, "post_id": 28995389, "comment_id": 46280189, "body": "Thanks. It works, although I modified it a bit.                                         <code>If Dir(sFolder, vbDirectory) = sMonth Then                          xlSh.SaveAs(sfinal &amp; Format(sFileName))         Else                          My.Computer.FileSystem.CreateDirectory(sFolder &amp; Format(sMonth))                          xlSh.SaveAs(sfinal &amp; Format(sFileName))          End If</code>"}, {"owner": {"reputation": 186, "user_id": 4585791, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3699aa68e22875c2560d9498947f462a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Wertz", "link": "https://stackoverflow.com/users/4585791/robert-wertz"}, "reply_to_user": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "edited": false, "score": 0, "creation_date": 1426194937, "post_id": 28995389, "comment_id": 46284283, "body": "Awesome! Always great to tailor others&#39; code to your own needs."}], "tags": [], "owner": {"reputation": 186, "user_id": 4585791, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3699aa68e22875c2560d9498947f462a?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Wertz", "link": "https://stackoverflow.com/users/4585791/robert-wertz"}, "is_accepted": false, "score": 0, "last_activity_date": 1426101274, "creation_date": 1426101274, "answer_id": 28995389, "question_id": 28995231, "link": "https://stackoverflow.com/questions/28995231/connecting-two-path-strings-to-get-the-final-path/28995389#28995389", "title": "Connecting two path strings to get the final path?", "body": "<p>You don't appear to actually be setting the save path to the created directory. Instead, I believe you're appending the month to the beginning of the file name in the xlSh.SaveAs(sFinal &amp; Format(sDate) &amp; \".xlsx\"). Basically (though I'm not sure of the specific command) you need to navigate to the folder you created after you create it. <em>Probably</em> something to the format of </p>\n\n<pre><code>My.Computer.FileSystem.ChangeDirectory(sFolder &amp; Format(sMonth))\n</code></pre>\n\n<p>though I don't know that that specific command actually exists as I wrote it.</p>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "is_accepted": true, "score": 3, "last_activity_date": 1426120506, "last_edit_date": 1426120506, "creation_date": 1426120148, "answer_id": 28999939, "question_id": 28995231, "link": "https://stackoverflow.com/questions/28995231/connecting-two-path-strings-to-get-the-final-path/28999939#28999939", "title": "Connecting two path strings to get the final path?", "body": "<p>After long hours of excruciating pain, I've finally did it!\nApparently I was missing an \"\\\"\nSince \"sMonth\" became dynamic name, which later I wanted to use as path, and save files in that folder. I needed to simply put that \"\\\" after sMonth, to tell it to save inside it.</p>\n\n<p>Before I realize this... I've broken down, simplified the code as much as I could so I can logically connect the pieces. What I ended up with, is something slightly different. Now the SaveAS properly saves the file inside the new folder.</p>\n\n<pre><code>    Dim sDate As String\n    sDate = DateTime.Now.ToString(\"yyyy-MM-dd\") &amp; \"_\" &amp; DateTime.Now.ToString(\"HH-mm-ss\")\n\n    Dim sMonth As String\n    sMonth = DateTime.Now.ToString(\"MMMM\")\n\n    Dim sFileName As String\n    sFileName = sDate + \".xlsx\"\n\n    Dim sFolder As String\n    sFolder = Application.StartupPath &amp; \"\\Resources\\Excel\\\"\n\n\n    Dim sfinal As String\n    sfinal = (sFolder &amp; sMonth &amp; \"\\\") '&lt;- this thingie here o.O\n\n    My.Computer.FileSystem.CreateDirectory(sFolder &amp; Format(sMonth))\n\n    xlSh.SaveAs(sfinal &amp; Format(sFileName))\n\n    xlApp.Workbooks.Close()\n    xlApp.Quit()\n</code></pre>\n\n<p>Thanks for the help.</p>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "is_accepted": false, "score": 0, "last_activity_date": 1426187816, "creation_date": 1426187816, "answer_id": 29018416, "question_id": 28995231, "link": "https://stackoverflow.com/questions/28995231/connecting-two-path-strings-to-get-the-final-path/29018416#29018416", "title": "Connecting two path strings to get the final path?", "body": "<p>To those who have been wondering wtf I was doing with all this, here is the full sub. And if anyone needs something similar. Thanks for the support. Problem has been resolved.</p>\n\n<pre><code>    Private Sub Button_Click(sender As Object, e As EventArgs) Handles Button.Click\n\n    Dim xlApp As Excel.Application\n    Dim xlSh As Excel.Worksheet\n\n\n    xlApp = New Excel.Application\n\n\n    xlApp.Workbooks.Add()\n    xlSh = xlApp.Workbooks(1).Worksheets(1)\n\n    'Items from listbox1 to be exported into excel, second row, second column.\n    Dim row As Integer = 2\n    Dim col As Integer = 2\n    For i As Integer = 0 To ListBox1.Items.Count - 1\n        xlSh.Cells(row, col) = ListBox1.Items(i)\n        row = row + 1\n    Next\n    row += 1\n    col = 1\n\n    'Items from listbox2 to be exported into excel, second row, third column.\n    Dim row2 As Integer = 2\n    Dim col2 As Integer = 3\n    For i As Integer = 0 To ListBox2.Items.Count - 1\n        xlSh.Cells(row2, col2) = ListBox2.Items(i)\n        row2 = row2 + 1\n    Next\n    row2 += 1\n    col2 = 1\n\n\n    'Create folder as Month Name. Save filename as date inside that folder.\n\n    'Make filename be yyyy-MM-DD_HH-mm-ss\n    Dim sDate As String\n    sDate = DateTime.Now.ToString(\"yyyy-MM-dd\") &amp; \"_\" &amp; DateTime.Now.ToString(\"HH-mm-ss\")\n\n    'This will be used as name for the new folder.\n    Dim sMonth As String\n    sMonth = DateTime.Now.ToString(\"MMMM\")\n\n    'Filename + extension.\n    Dim sFileName As String\n    sFileName = sDate + \".xlsx\"\n\n    'This is the path.\n    Dim sFolder As String\n    sFolder = Application.StartupPath &amp; \"\\Resources\\Excel\\\"\n\n    'This is the path combined with sMonth to make the final path.\n    Dim sfinal As String\n    sfinal = (sFolder &amp; sMonth &amp; \"\\\")\n\n    'Check if folder with the name sMonth already exists.\n    If Dir(sFolder, vbDirectory) = sMonth Then\n\n        'If it exist, then simply save the file inside the folder.\n        xlSh.SaveAs(sfinal &amp; Format(sFileName))\n    Else\n        'If it doesn't exist:\n        'This is the creation of sMonth folder, inside \"\\excel\\.\n        My.Computer.FileSystem.CreateDirectory(sFolder &amp; Format(sMonth))\n        'This saves the excel file at path sfinal, with filename of sFileName\n        xlSh.SaveAs(sfinal &amp; Format(sFileName))\n\n    End If\n\n\n\n    'Close everything.\n    xlApp.Workbooks.Close()\n    xlApp.Quit()\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2815, "user_id": 1462295, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/ts6jy.jpg?s=128&g=1", "display_name": "BurnsBA", "link": "https://stackoverflow.com/users/1462295/burnsba"}, "edited": false, "score": 0, "creation_date": 1611672803, "post_id": 56256592, "comment_id": 116522572, "body": "Do note that the above is only valid for <b>excel</b> (which the question is tagged with), in case you end up on this page (like me) searching for VBA path separator in <b>powerpoint</b>"}], "tags": [], "owner": {"reputation": 3188, "user_id": 1195872, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9a1f4955d7b680bc4e08304f5b086816?s=128&d=identicon&r=PG", "display_name": "labilbe", "link": "https://stackoverflow.com/users/1195872/labilbe"}, "is_accepted": false, "score": 4, "last_activity_date": 1558527316, "creation_date": 1558527316, "answer_id": 56256592, "question_id": 28995231, "link": "https://stackoverflow.com/questions/28995231/connecting-two-path-strings-to-get-the-final-path/56256592#56256592", "title": "Connecting two path strings to get the final path?", "body": "<p>you could use the following function (similar to .NET System.IO.Path.Combine)</p>\n\n<pre><code>Function PathCombine(path1 As String, path2 As String)\n\n    Dim combined As String\n\n    combined = path1\n    If Right$(path1, 1) &lt;&gt; Application.PathSeparator Then\n        combined = combined &amp; Application.PathSeparator\n    End If\n    combined = combined &amp; path2\n    PathCombine = combined\n\nEnd Function\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 143, "user_id": 4650920, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/84adbaeb2caa335848695ac5274cb6d4?s=128&d=identicon&r=PG&f=1", "display_name": "Taffs", "link": "https://stackoverflow.com/users/4650920/taffs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10616, "favorite_count": 0, "accepted_answer_id": 28999939, "answer_count": 4, "score": 2, "last_activity_date": 1558527316, "creation_date": 1426100745, "last_edit_date": 1531164843, "question_id": 28995231, "link": "https://stackoverflow.com/questions/28995231/connecting-two-path-strings-to-get-the-final-path", "title": "Connecting two path strings to get the final path?", "body": "<p>I'm trying to save excel file into a specific path. \nSo basically, when I click the button, I'm creating a folder, and want to save the file inside that folder. \nThe created folder has the current month as name. I'm trying to save into that current month folder.</p>\n\n<pre><code>    'Create folder as Month Name. Save filename as date inside \"month\".\n    Dim sDate As String = DateTime.Now.ToString(\"yyyy-MM-dd\") &amp; \"_\" &amp; DateTime.Now.ToString(\"HH-mm-ss\")\n    Dim sMonth As String = DateTime.Now.ToString(\"MMMM\")\n    Dim sFolder = Application.StartupPath &amp; \"\\Resources\\Excel\\\"\n\n\n    My.Computer.FileSystem.CreateDirectory(sFolder &amp; Format(sMonth))\n\n    Dim sfinal = Path.Combine(sFolder, sMonth)\n    xlSh.SaveAs(sfinal &amp; Format(sDate) &amp; \".xlsx\")\n\n    xlApp.Workbooks.Close()\n    xlApp.Quit()\n</code></pre>\n\n<p>As it is, this code doesn't give me any errors. But instead of creating a folder named \"March\" &lt;-current month and saving inside it, it saves the file in \\Excel\\ and it also creates folder in the same place.</p>\n"}, {"tags": ["excel", "paste", "vba"], "answers": [{"comments": [{"owner": {"reputation": 649, "user_id": 3542163, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/303dfd7968445c56eff90d4ab5649533?s=128&d=identicon&r=PG&f=1", "display_name": "Head and toes", "link": "https://stackoverflow.com/users/3542163/head-and-toes"}, "edited": false, "score": 0, "creation_date": 1426101652, "post_id": 28995289, "comment_id": 46239139, "body": "Thank you!!  It seems that when the macro is run multiple times, it is only adding zeros to column D?  was there an error in the code, i wonder?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 649, "user_id": 3542163, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/303dfd7968445c56eff90d4ab5649533?s=128&d=identicon&r=PG&f=1", "display_name": "Head and toes", "link": "https://stackoverflow.com/users/3542163/head-and-toes"}, "edited": false, "score": 0, "creation_date": 1426101860, "post_id": 28995289, "comment_id": 46239257, "body": "It <b>should</b> take the current value in cell <b>C1</b> and put it in the next available cell in column <b>D</b>"}, {"owner": {"reputation": 649, "user_id": 3542163, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/303dfd7968445c56eff90d4ab5649533?s=128&d=identicon&r=PG&f=1", "display_name": "Head and toes", "link": "https://stackoverflow.com/users/3542163/head-and-toes"}, "edited": false, "score": 0, "creation_date": 1426102330, "post_id": 28995289, "comment_id": 46239537, "body": "Yes. I tested it on excel 2010 but it doesnt seem to work properly?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1426100931, "creation_date": 1426100931, "answer_id": 28995289, "question_id": 28995181, "link": "https://stackoverflow.com/questions/28995181/in-excel-how-to-paste-special-to-the-next-empty-row-using-visual-basic-macro/28995289#28995289", "title": "In Excel, how to paste special to the next empty row using visual basic/macro?", "body": "<p>You need to move down:</p>\n\n<pre><code>Sub xCopy()\n    If Sheets(\"Sheet1\").Range(\"D1\").Value = \"\" Then\n        n = 1\n    Else\n        n = Sheets(\"Sheet1\").Cells(Rows.Count, \"D\").End(xlUp).Row + 1\n    End If\n    Sheets(\"Sheet1\").Range(\"C1\").Copy\n    Sheets(\"Sheet1\").Range(\"D\" &amp; n).PasteSpecial Paste:=xlPasteAll\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 649, "user_id": 3542163, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/303dfd7968445c56eff90d4ab5649533?s=128&d=identicon&r=PG&f=1", "display_name": "Head and toes", "link": "https://stackoverflow.com/users/3542163/head-and-toes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1435, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426119478, "creation_date": 1426100563, "last_edit_date": 1531164843, "question_id": 28995181, "link": "https://stackoverflow.com/questions/28995181/in-excel-how-to-paste-special-to-the-next-empty-row-using-visual-basic-macro", "title": "In Excel, how to paste special to the next empty row using visual basic/macro?", "body": "<p>I have four columns on the same sheet.  I want to create a macro so that each time I run the macro the value in column C will be copied and pasted special on the next empty row in Column D.  For example to begin with we have:</p>\n\n<pre><code>Column A    Column B    Column C    Column D\n1           41          42        \n</code></pre>\n\n<p>Column C contains the formula =A1+B1.</p>\n\n<p>Once I run the macro, we would get:</p>\n\n<pre><code>Column A    Column B    Column C    Column D\n1           41          42          42\n</code></pre>\n\n<p>If I run the macro again with different values in Column A and B, I would get:</p>\n\n<pre><code>Column A    Column B    Column C    Column D\n10           90          100          42\n                                     100\n</code></pre>\n\n<p>and so on.</p>\n\n<p>I attempted the visual basic code:</p>\n\n<pre><code>Sub Copy()\nSheets(\"Sheet1\").Range(\"C1\").Copy\nSheets(\"Sheet1\").Range(\"D1\").PasteSpecial\nEnd Sub\n</code></pre>\n\n<p>But this does not work.  It doesn't paste special and it doesn't find the next empty row in column D.</p>\n\n<p>Could anyone let me know how to write the code properly?\nMany thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1426099052, "post_id": 28994503, "comment_id": 46237532, "body": "That is only <b>2 X 9</b>"}, {"owner": {"reputation": 11, "user_id": 4659840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205219244493841/picture?type=large", "display_name": "A.c. Weiman", "link": "https://stackoverflow.com/users/4659840/a-c-weiman"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1426099525, "post_id": 28994503, "comment_id": 46237853, "body": "***E30:G38 @Gary&#39;sStudent"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1426099834, "post_id": 28994503, "comment_id": 46238060, "body": "Why a message box? Wouldn&#39;t a user form and list box be more appropriate?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4659840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205219244493841/picture?type=large", "display_name": "A.c. Weiman", "link": "https://stackoverflow.com/users/4659840/a-c-weiman"}, "edited": false, "score": 1, "creation_date": 1426100752, "post_id": 28994879, "comment_id": 46238618, "body": "Thank you, for the quick response!  I tried copying and pasting the code, but it would not work. @gary&#39;sstudent"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 11, "user_id": 4659840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205219244493841/picture?type=large", "display_name": "A.c. Weiman", "link": "https://stackoverflow.com/users/4659840/a-c-weiman"}, "edited": false, "score": 0, "creation_date": 1426100992, "post_id": 28994879, "comment_id": 46238760, "body": "What happened??  Did you have macros enabled??"}, {"owner": {"reputation": 11, "user_id": 4659840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205219244493841/picture?type=large", "display_name": "A.c. Weiman", "link": "https://stackoverflow.com/users/4659840/a-c-weiman"}, "edited": false, "score": 0, "creation_date": 1426101526, "post_id": 28994879, "comment_id": 46239055, "body": "when I run the debugger f8 it says &quot; i &quot; and &quot;a&quot; are not defined @gary&#39;sStudent"}, {"owner": {"reputation": 531, "user_id": 4244864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/erHT8.jpg?s=128&g=1", "display_name": "bilbo_strikes_back", "link": "https://stackoverflow.com/users/4244864/bilbo-strikes-back"}, "edited": false, "score": 0, "creation_date": 1426109612, "post_id": 28994879, "comment_id": 46243722, "body": "Dim &quot;i&quot; and &quot;a&quot; as Integer"}, {"owner": {"reputation": 11, "user_id": 4659840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205219244493841/picture?type=large", "display_name": "A.c. Weiman", "link": "https://stackoverflow.com/users/4659840/a-c-weiman"}, "edited": false, "score": 0, "creation_date": 1426181884, "post_id": 28994879, "comment_id": 46277561, "body": "Perfect. Thanks again for the quick feedback!  @Gary&#39;sStudent"}, {"owner": {"reputation": 11, "user_id": 4659840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205219244493841/picture?type=large", "display_name": "A.c. Weiman", "link": "https://stackoverflow.com/users/4659840/a-c-weiman"}, "edited": false, "score": 0, "creation_date": 1430164875, "post_id": 28994879, "comment_id": 47932431, "body": "@Gary&#39;sStudent Is there a way for the cells to display in a grid, rather than floating?"}, {"owner": {"reputation": 11, "user_id": 4659840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205219244493841/picture?type=large", "display_name": "A.c. Weiman", "link": "https://stackoverflow.com/users/4659840/a-c-weiman"}, "edited": false, "score": 0, "creation_date": 1430286311, "post_id": 28994879, "comment_id": 47992406, "body": "@Gary&#39;sStudent I seem to have come across a few issues, while  expanding my current model. 1) expanding from 3x9 to 16x8. I added the columns &quot;C&quot;-&quot;R&quot; and i = 56 to 63 but it stacks on top of one another. 2) also, I needed to switch from solver to opensolver but when I call RunOpenSolver in my VB userfrom it gives an error but when I try it in a macro it works fine? any guidance would be greatly appreciated. As to my original question, I wanted to know if I could have the displayed cells in boxes or cells as they look in the excel spread sheet.."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 11, "user_id": 4659840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205219244493841/picture?type=large", "display_name": "A.c. Weiman", "link": "https://stackoverflow.com/users/4659840/a-c-weiman"}, "edited": false, "score": 0, "creation_date": 1430305154, "post_id": 28994879, "comment_id": 48004141, "body": "@A.c.Weiman ............I don&#39;t know the answer to this one............I suggest you open a new question............"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 4, "last_activity_date": 1426110767, "last_edit_date": 1426110767, "creation_date": 1426099537, "answer_id": 28994879, "question_id": 28994503, "link": "https://stackoverflow.com/questions/28994503/how-to-use-msgbox-to-display-3x9-range-of-cells-with-both-text-and-values/28994879#28994879", "title": "how to use msgbox to display 3X9 range of cells with both text and values", "body": "<p>This will produce and output of the cells from <strong>F30</strong> through <strong>H38</strong>:</p>\n\n<pre><code>Sub mesage()\n    Dim msg As String\n    msg = \"\"\n    For i = 30 To 38\n        For Each a In Array(\"F\", \"G\", \"H\")\n            msg = msg &amp; Cells(i, a).Value &amp; vbTab\n        Next a\n        msg = msg &amp; vbCrLf\n    Next i\n    MsgBox msg\nEnd Sub\n</code></pre>\n\n<p>Adjust for any reasonable range:</p>\n\n<p><img src=\"https://i.stack.imgur.com/QlAyu.png\" alt=\"enter image description here\"></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>If you are having <em>Dim</em> problems then:</p>\n\n<pre><code>Option Explicit\n\nSub mesage()\n    Dim msg As String, i As Long, a As Variant\n    msg = \"\"\n    For i = 30 To 38\n        For Each a In Array(\"F\", \"G\", \"H\")\n            msg = msg &amp; Cells(i, a).Value &amp; vbTab\n        Next a\n        msg = msg &amp; vbCrLf\n    Next i\n    MsgBox msg\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4659840, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205219244493841/picture?type=large", "display_name": "A.c. Weiman", "link": "https://stackoverflow.com/users/4659840/a-c-weiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3367, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1426110767, "creation_date": 1426098276, "last_edit_date": 1531164843, "question_id": 28994503, "link": "https://stackoverflow.com/questions/28994503/how-to-use-msgbox-to-display-3x9-range-of-cells-with-both-text-and-values", "title": "how to use msgbox to display 3X9 range of cells with both text and values", "body": "<p>looking for some help with displaying a 3x9 range of cells with both text and values in a message box function or another function that will do the same?</p>\n\n<p>msgbox sheets.(\"solver\").range(\"f30:g38\").value</p>\n"}, {"tags": ["vba", "ms-office", "excel-2010", "ole"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426097961, "post_id": 28993987, "comment_id": 46236854, "body": "What is the point of this line of code?  I haven&#39;t worked with this, but if you remove the line, the code works, and it seems to be trying to resize the object with a factor of 1 to its &quot;original&quot; size.  If this isn&#39;t really doing anything, I would just remove the line of code."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426104377, "post_id": 28993987, "comment_id": 46240757, "body": "By &quot;line of code&quot; in the above comment, I mean &quot;oOLEWd.ShapeRange.ScaleHeight 1, msoCTrue &quot;  Documentation on Microsoft&#39;s website suggests that you can&#39;t use msoCTrue in VBA, but I may be misunderstanding."}, {"owner": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426105438, "post_id": 28993987, "comment_id": 46241352, "body": "@OpiesDad No, you&#39;re right actually. I have tried with msoTrue as well without any results though.   msoFalse works - which emphasizes the fact, that apparently my oOLEWd is not an OLE object.  But why is that, and what can I do to make the scaleheight reach 1?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426106273, "post_id": 28993987, "comment_id": 46241837, "body": "That method isn&#39;t setting the scale height to 1, it is actually scaling it by a factor of 1, which means it isn&#39;t doing anything. The state of True/False is referring to scaling the picture based on the ORIGINAL size of the object, not the current size of the object. The error may be incorrectly stating that it is not an OLE object, when really it means that the object can&#39;t store its ORIGINAL state. I&#39;m not sure how to set the object to be able to store this state, though. I declared oOLEwd as an OLEObject and had the same error message.  Do you need it to resize to its original size?"}, {"owner": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426107298, "post_id": 28993987, "comment_id": 46242428, "body": "Yes - that&#39;s exactly what I need.  I have tried to set the &#39;1&#39; to e.g. 1.1 or 2, it shows the same message..   You can get a better understanding of the problem if you stop the code  at the mistake, and then go into the format settings of the word object, into size and set the height to 100%. THAT&#39;S what I need my code to do.!   The silly thing is, that it works in excel 2003?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426107719, "post_id": 28993987, "comment_id": 46242657, "body": "Is the setting different from 100% when you do this?  When I try to do this, the setting is already at 100%."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426108263, "post_id": 28993987, "comment_id": 46242987, "body": "It works in excel 2007 too, but not in 2010 for me either."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426108698, "post_id": 28993987, "comment_id": 46243211, "body": "Could you just save the height that it is originally and then set the height back to what it was originally?  I can&#39;t figure out why this won&#39;t work as written, but you could at least do that.  What&#39;s the purpose of changing the height and width and then changing it back 3 lines later?"}, {"owner": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426109019, "post_id": 28993987, "comment_id": 46243404, "body": "Hey man - thanks for taking time to help me! :-)  the height on the object is variable. it depends on the &#39;I&#39;.. It is only 100% if the copied text is small enough. Otherwise it is below 100% - meaning, that not all text is shown. This is a problem because in another place in the program I save the sheet as PDF.       <code>wsFactark.Cells(I + 4, 13).Copy</code>  Weird if it works in 2007, but not in 2010. :/"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426110274, "post_id": 28993987, "comment_id": 46244012, "body": "I tried adding the 2007 Word Reference library and this still doesn&#39;t work in 2010.  Not really sure what else to do."}, {"owner": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426146387, "post_id": 28993987, "comment_id": 46255087, "body": "Super weird!! Do you know where I could find help to this problem?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426180357, "post_id": 28993987, "comment_id": 46276716, "body": "Unfortunately I don&#39;t. If I get some more time I may try to mess around with it some more, but best of luck."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "edited": false, "score": 0, "creation_date": 1426525775, "post_id": 29079680, "comment_id": 46398677, "body": "Hmm.. Wouldnt this mean, that the document object already exists?  Right now it isnt created until before the sub, and from the sub I copy the text into it.."}, {"owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "reply_to_user": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "edited": false, "score": 0, "creation_date": 1426535135, "post_id": 29079680, "comment_id": 46404019, "body": "As far as I can see you only want to copy 1 cell into the Word document. You can accomplish the exact same thing by opening an empty Word document with the code I showed and paste that cell into the newly created oleobject. Or: open the word document, paste the cell, save the Word document, open it in the excelfile as oleobject."}, {"owner": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "edited": false, "score": 0, "creation_date": 1426536452, "post_id": 29079680, "comment_id": 46404804, "body": "This sub is only part of my program.  I have a table with a bunch of information concerning how to work with a construction project. There is an increasing amount of &#39;recipes&#39; that explains specific things about the project. In the table each row is a recipe, and the columns are the how&#39;s, why&#39;s, when, notes etc. My program takes the information of each row and puts it in a new sheet. Then it prints it as a pdf and takes the next row.   It&#39;s the &#39;how&#39;-column that is causing me some trouble.. The text length is variable, therefore the Object height also needs to be variable."}, {"owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "reply_to_user": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "edited": false, "score": 0, "creation_date": 1426580248, "post_id": 29079680, "comment_id": 46419620, "body": "I get confused: do you want a Word document ?, A PDF-file ? or a Worddocument as OleObject in the worksheet ? I added some code how to save the copied range in a Word document as PDF-file."}, {"owner": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "edited": false, "score": 0, "creation_date": 1426613456, "post_id": 29079680, "comment_id": 46441543, "body": "I understand why you&#39;re confused. I want a word-object in the excel spreadsheet, which shall be saved as pdf.  I have a table from where each row will be put out as a pdf.. Each row consists of hows, whens, wheres etc for a building project. I need this so I can update it one place instead of 8 different places."}, {"owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "reply_to_user": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "edited": false, "score": 0, "creation_date": 1426622226, "post_id": 29079680, "comment_id": 46446589, "body": "I think my last code suggestion does exactly that. The introduction of a Word oleobject in Excel is an unnecessary complicated method."}, {"owner": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "edited": false, "score": 0, "creation_date": 1426686587, "post_id": 29079680, "comment_id": 46473874, "body": "Wonderful! I&#39;ll try it out next time I&#39;m at work and see where it&#39;s get me.. I&#39;ll be sure to make an update in here.."}], "tags": [], "owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "is_accepted": false, "score": 0, "last_activity_date": 1426580121, "last_edit_date": 1426580121, "creation_date": 1426517036, "answer_id": 29079680, "question_id": 28993987, "link": "https://stackoverflow.com/questions/28993987/vba-doesnt-recognize-ole-object/29079680#29079680", "title": "Vba doesn&#39;t recognize OLE object", "body": "<p>this might do the trick (at least on my system - Excel 2010):</p>\n\n<pre><code>Sub M_snb()\n  ActiveSheet.OLEObjects.Add , \"G:\\example.docx\", True, False, , , , Columns(3).Left, Rows(3).Top\nEnd Sub\n</code></pre>\n\n<p>to save the Word document as PDF:</p>\n\n<pre><code>Sub M_snb()\n Sheet1.Range(\"A1:G7\").Copy\n\n With CreateObject(\"Word.document\")\n  .Windows(1).Visible = True\n  .Content.Paste\n  .ExportAsFixedFormat \"G:\\OF\\new.pdf\", 17\n  .Close -1\n End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4607463, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jd9tOMF-3s8/AAAAAAAAAAI/AAAAAAAAAMc/JgoSLf8Zpnk/photo.jpg?sz=128", "display_name": "FransRasmussen", "link": "https://stackoverflow.com/users/4607463/fransrasmussen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1041, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426580121, "creation_date": 1426096610, "last_edit_date": 1426105568, "question_id": 28993987, "link": "https://stackoverflow.com/questions/28993987/vba-doesnt-recognize-ole-object", "title": "Vba doesn&#39;t recognize OLE object", "body": "<p>Hello all awesome programmers!</p>\n\n<p>Can anyone explain to me how I fix this problem? \nIt works great in excel 2003, but in 2010 i get this error: </p>\n\n<p><img src=\"https://i.imgur.com/tRRn7OT.jpg\" alt=\"Run-time error &#39;-2147024809 (80070057)&#39;\"></p>\n\n<p>Can someone guide me in the right direction?\nWhat scaleheight is supposed to do, is making sure, that ALL the text copied into the word object is visible - which isn't the case if I set scaleheight to 1, but msoFalse. </p>\n\n<p>You should be able to copy paste the code into a new sub. </p>\n\n<pre><code>Sub Embed_WordDocument_To_sheet()\n\nDim oWD As Document ' Word Document Object (Use Microsoft Word Reference)\n\nSet ws = Worksheets.Add\nSet wsFactark = Worksheets(\"Sheet1\")\n\nws.Range(\"C3\").Select\n\nSet oOLEWd = ws.OLEObjects.Add( _\n    ClassType:=\"Word.Document\", _\n    Width:=375)\n\noOLEWd.Name = \"EmbeddedWordDoc\"\noOLEWd.ShapeRange.LockAspectRatio = msoFalse\noOLEWd.Width = 375\noOLEWd.Height = 10 ' bliver ligegyldig n\u00e5r du har gjort det som st\u00e5r i nederste kommentar.\noOLEWd.Top = ws.Range(\"C3\").Top + 2 ' +2 for ikke at overstrege border-linjen\noOLEWd.Left = ws.Range(\"C3\").Left + 5 ' samme\n\n' PROBLEM - \"The relativetooriginalsize argument applies only to a picture or an OLE object.\" !!!\noOLEWd.ShapeRange.ScaleHeight 1, msoTrue ' msoFalse works, msoCTrue doesn't\n\noOLEWd.Placement = xlFreeFloating\n\n' Assign the OLE Object to Word Object\nSet oWD = oOLEWd.Object\nwsFactark.Cells(I + 4, 13).Copy\n\noWD.Paragraphs(oWD.Paragraphs.Count).Range.PasteAndFormat (wdFormatOriginalFormatting)\n\nWith oWD.PageSetup\n.TopMargin = 0\n.BottomMargin = 0\n.LeftMargin = 0\n.RightMargin = 0\n    .PageHeight = 1584 'max\n    .PageWidth = 1584\nEnd With\n\noOLEWd.Activate\n\noOLEWd.Height = selection.Application.UsableHeight\n\noOLEWd.ShapeRange.Line.Visible = msoFalse\n\nIf oOLEWd.Height &gt; 400 And oOLEWd.Height &lt; 800 Then\n    ws.Range(\"B3\").RowHeight = 400\n    ws.Range(\"B4\").RowHeight = oOLEWd.Height - 400 + 20\nElseIf oOLEWd.Height &gt; 800 And oOLEWd.Height &lt; 1000 Then\n    ws.Range(\"B3\").RowHeight = 400\n    ws.Range(\"B4\").RowHeight = 200\n    ws.Range(\"B5\").RowHeight = 200\n    ws.Range(\"B7\").RowHeight = oOLEWd.Height - 800 + 20\nElseIf oOLEWd.Height &gt; 1000 And oOLEWd.Height &lt; 1200 Then\n    ws.Range(\"B3\").RowHeight = 400\n    ws.Range(\"B4\").RowHeight = 200\n    ws.Range(\"B5\").RowHeight = 200\n    ws.Range(\"B6\").RowHeight = 200\n    ws.Range(\"B7\").RowHeight = 200\n    ws.Range(\"B9\").RowHeight = oOLEWd.Height - 1000 + 20\nElse\n    ws.Range(\"B3\").RowHeight = oOLEWd.Height\n    ws.Range(\"B4:B11\").RowHeight = 0\nEnd If\n    ws.Range(\"B12\").RowHeight = 10\n\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 0, "last_activity_date": 1426096780, "last_edit_date": 1426096780, "creation_date": 1426096329, "answer_id": 28993886, "question_id": 28993859, "link": "https://stackoverflow.com/questions/28993859/vba-read-text-file-preserve-commas/28993886#28993886", "title": "vba - read text file, preserve commas", "body": "<p>Use <code>Line Input</code> rather than just <code>Input</code>.</p>\n\n<p>This will read one line at a time; thus retaining the commas.</p>\n\n<p>Also, you should use the function <code>FreeFile</code> rather than hardcoding 1 as the file handle.</p>\n"}], "owner": {"reputation": 3734, "user_id": 2921363, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5caeedd7806ff7242659106e06d3f2a9?s=128&d=identicon&r=PG&f=1", "display_name": "bsapaka", "link": "https://stackoverflow.com/users/2921363/bsapaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "accepted_answer_id": 28993886, "answer_count": 1, "score": 2, "last_activity_date": 1426096780, "creation_date": 1426096250, "last_edit_date": 1531161705, "question_id": 28993859, "link": "https://stackoverflow.com/questions/28993859/vba-read-text-file-preserve-commas", "title": "vba - read text file, preserve commas", "body": "<p>How do you read a text file with the commas included? For example:</p>\n\n<p>Test.txt file contents:</p>\n\n<pre><code>item 1, item 2, item 3\n</code></pre>\n\n<p>VBA to read the file:</p>\n\n<pre><code>Sub readFile()\n\nDim sFile As String\nDim sPath As String\nsFile = \"test.txt\"\nsPath = ThisWorkbook.Path &amp; \"\\\" &amp; sFile\n\nDim s As String\nDim sFullStr As String\nsFullStr = \"\"\n\nOpen sPath For Input As #1\nDo Until EOF(1)\n    Input #1, s\n    sFullStr = sFullStr  + \" \" + s\nLoop\nClose #1\n\nDebug.Print sFullStr \n\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>item 1 item 2 item 3\n</code></pre>\n\n<p>The output I desire is the original text file contents with commas included</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1426100791, "post_id": 28993580, "comment_id": 46238643, "body": "Have you tried <code>Data&gt;&gt;From Access</code> in Excel ?"}, {"owner": {"reputation": 133, "user_id": 3490320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0871e516142f36d2fb17098e062f54?s=128&d=identicon&r=PG&f=1", "display_name": "loegare", "link": "https://stackoverflow.com/users/3490320/loegare"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1426102841, "post_id": 28993580, "comment_id": 46239835, "body": "im looking for a way to do it out of access. i have a lot of data that i need in excel for the people consuming it, split into several workbooks, id rather not have to go into every excel book manually to update it"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1426103579, "post_id": 28993580, "comment_id": 46240279, "body": "You can use automation to open your excel files and place the data."}, {"owner": {"reputation": 133, "user_id": 3490320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0871e516142f36d2fb17098e062f54?s=128&d=identicon&r=PG&f=1", "display_name": "loegare", "link": "https://stackoverflow.com/users/3490320/loegare"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1426103725, "post_id": 28993580, "comment_id": 46240370, "body": "darn, i was hoping there would be an easy way to do it, similar to the method in the link in the original post, thanks for your help!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1426137869, "post_id": 28993580, "comment_id": 46252084, "body": "This link which is posted as an answer in your linked question shows how to automate Excel from Access to do what you want: <a href=\"http://access.mvps.org/access/modules/mdl0035.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/modules/mdl0035.htm</a>"}], "owner": {"reputation": 133, "user_id": 3490320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0871e516142f36d2fb17098e062f54?s=128&d=identicon&r=PG&f=1", "display_name": "loegare", "link": "https://stackoverflow.com/users/3490320/loegare"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426168988, "creation_date": 1426095484, "last_edit_date": 1495539802, "question_id": 28993580, "link": "https://stackoverflow.com/questions/28993580/append-a-microsoft-access-table-to-an-excel-doc", "title": "append a microsoft access table to an excel doc", "body": "<p>So I saw the post <a href=\"https://stackoverflow.com/questions/1849580/export-ms-access-tables-through-vba-to-an-excel-spreadsheet-in-same-directory\">here</a>, about exporting access to excel. The answer was perfect, however I could not comment to add a follow up question as follows.</p>\n\n<p>Is it possible to append an access table to the end of an excel spreadsheet? If so how.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1426105186, "post_id": 28992820, "comment_id": 46241197, "body": "What is the number and description of this error?"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1426106416, "post_id": 28992820, "comment_id": 46241925, "body": "debug error 6 - it just refers to that line - something like ..runtime error"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1426106697, "post_id": 28992820, "comment_id": 46242081, "body": "I restarted workbook and now there is no error"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "reply_to_user": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1426158832, "post_id": 28992820, "comment_id": 46261794, "body": "another day same problem - it won&#39;t update"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1426166442, "post_id": 28992820, "comment_id": 46266757, "body": "We will need a fresh start on this I think. Either add current codes under your OP, or create a new fresh question. This is very difficult to read. Please write in logical order, what code if run first, then second etc. and what error exactly are you getting and on which line. Thank you. We will overcome this, don&#39;t worry."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426094689, "post_id": 28993087, "comment_id": 46234698, "body": "changing <code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</code> to <code>Private Sub Worksheet_SelectionCalculate(ByVal Target As Range)</code> doesn&#39;t do anything"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426094945, "post_id": 28993087, "comment_id": 46234894, "body": "I get the error procedure declaration does not match description of event or procedure having same name when I change <code>Private Sub Worksheet_SelectionChange(</code> to <code>Worksheet_Calculate(</code>"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426095219, "post_id": 28993087, "comment_id": 46235075, "body": "the range does contain formulas but ...ammending this still doesn&#39;t work"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1426093998, "creation_date": 1426093998, "answer_id": 28993087, "question_id": 28992820, "link": "https://stackoverflow.com/questions/28992820/worksheet-change-event-only-works-when-region-selected-how-to-adjust-to-automa/28993087#28993087", "title": "worksheet change event only works when region selected - how to adjust to automatic update", "body": "<p>Use either the worksheet <em>Calculate</em> event or the worksheet <em>Change</em> event:</p>\n\n<ol>\n<li>use <em>Calculate</em> if the range contains <strong>formulas</strong></li>\n<li>use <em>Change</em> if the cells in the range are changed <strong>manually</strong></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426094804, "post_id": 28993093, "comment_id": 46234781, "body": "<code>Range(&quot;FS3:FS33&quot;)</code> I want to be referenced everytime there is a change there then execute <code>sub hithere3()</code>"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426102404, "post_id": 28993093, "comment_id": 46239585, "body": "I am not sure what you mean but I am close to giving up on this"}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1426094024, "creation_date": 1426094024, "answer_id": 28993093, "question_id": 28992820, "link": "https://stackoverflow.com/questions/28992820/worksheet-change-event-only-works-when-region-selected-how-to-adjust-to-automa/28993093#28993093", "title": "worksheet change event only works when region selected - how to adjust to automatic update", "body": "<p><code>If Intersect(Target, Range(\"FS3:FS33\")) Is Nothing</code> is the culprit. You must change <code>Range(\"FS3:FS33\")</code> to whatever range you want to affect this change.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426101700, "post_id": 28993545, "comment_id": 46239164, "body": "The code is driving me crazy the previious one and possibly this one. The one I am using now works ok for four lines of code and the I get  ############ and debug of the` hithere3`"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426107132, "post_id": 28993545, "comment_id": 46242330, "body": "ah - yes your code does work. Its good you posted this because I thought  had it - then you found it for me , so , thanks for this. Hopefully no more problems :D"}], "tags": [], "owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "is_accepted": false, "score": 0, "last_activity_date": 1426100575, "last_edit_date": 1426100575, "creation_date": 1426095402, "answer_id": 28993545, "question_id": 28992820, "link": "https://stackoverflow.com/questions/28992820/worksheet-change-event-only-works-when-region-selected-how-to-adjust-to-automa/28993545#28993545", "title": "worksheet change event only works when region selected - how to adjust to automatic update", "body": "<p>Finally figured it out, the following code works :</p>\n\n<pre><code>Private Sub Worksheet_calculate()\nIf Range(\"FS3:FS33\") Is Nothing Then\n'Do nothing'\nElse\nCall hithere3\nEnd If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1426097389, "post_id": 28993547, "comment_id": 46236517, "body": "His point is that you should be using the <code>Worksheet_Change</code> event instead of the <code>Worksheet_SelectionChange</code> event"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "edited": false, "score": 0, "creation_date": 1426097592, "post_id": 28993547, "comment_id": 46236641, "body": "Posted few seconds after your answer. But since you ask, there is a difference between <code>Worksheet_SelectionChange(ByVal Target As Range)</code> - only triggers when you click somewhere and <code>Worksheet_Change(ByVal Target As Range)</code> - triggers when you change a cell value for example. But you have found the <code>Worksheet_calculate()</code> and if it works, then this is obsolete. I thought you had manual input cells in the range <code>Range(&quot;FS3:FS33&quot;)</code>, but I guess you have formulas in there. In that case <code>Worksheet_calculate()</code> is OK."}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1426095406, "creation_date": 1426095406, "answer_id": 28993547, "question_id": 28992820, "link": "https://stackoverflow.com/questions/28992820/worksheet-change-event-only-works-when-region-selected-how-to-adjust-to-automa/28993547#28993547", "title": "worksheet change event only works when region selected - how to adjust to automatic update", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range) '&lt;&lt;delete the \"Selection\" from the name of event\nIf Intersect(Target, Range(\"FS3:FS33\")) Is Nothing Then\n'Do nothing '\nElse\nCall hithere3\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1426159249, "creation_date": 1426093276, "last_edit_date": 1531161705, "question_id": 28992820, "link": "https://stackoverflow.com/questions/28992820/worksheet-change-event-only-works-when-region-selected-how-to-adjust-to-automa", "title": "worksheet change event only works when region selected - how to adjust to automatic update", "body": "<p>the combination of this sub in a module</p>\n\n<pre><code>Sub hithere3()\nDim Rng As Range\nDim Unique As Boolean\n\nFor Each Rng In Worksheets(\"Sheet8\").Range(\"FS3:FS30\") 'for each cell     in     your B1 to B30 range, sheet1\nUnique = True 'we'll assume it's unique\nLastunique = Worksheets(\"TRADES\").Range(\"C:C\").Find(\"*\",     SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nFor i = 3 To Lastunique 'for each cell in the unique ID cache\n    If Rng.Value = Worksheets(\"TRADES\").Cells(i, 3).Value Then 'we       check    if it is equal\n        Unique = False 'if yes, it is not unique\n    End If\nNext\nIf Unique Then Worksheets(\"TRADES\").Cells(Lastunique + 1, 3) = Rng 'adds    if it is unique\nNext\nEnd Sub\n</code></pre>\n\n<p>with the loop check in a worksheet change events</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Intersect(Target, Range(\"FS3:FS33\")) Is Nothing Then\n'Do nothing '\nElse\nCall hithere3\nEnd If\nEnd Sub\n</code></pre>\n\n<p>works except it only updates when I select one of the cells in FS3:FS33</p>\n\n<p>Can anyone suggest how this can be overcome?</p>\n\n<p>maybe with a workchange change range selection type from below?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Rng As Range, Dn As Range, n As Long\nDim RngB As Range, RngC As Range\nIf Target.Column = 2 And Target.Count = 1 And Target.Row &gt; 1 Then\nWith CreateObject(\"scripting.dictionary\")\n.CompareMode = vbTextCompare\nSet RngB = Range(Range(\"B2\"), Range(\"B\" &amp; Rows.Count).End(xlUp))\nSet RngC = Range(Range(\"C2\"), Range(\"C\" &amp; Rows.Count).End(xlUp))\nray = Array(RngB, RngC)\nFor n = 0 To 1\n    For Each Dn In ray(n)\n        If Not Dn.Address(0, 0) = \"C1\" And Not Dn.Value = \"\" Then\n            .Item(Dn.Value) = Empty\n        End If\n    Next Dn\nNext n\nRange(\"C2\").Resize(.Count) = Application.Transpose(.Keys)\nEnd With\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1426092939, "post_id": 28992513, "comment_id": 46233453, "body": "Try using <code>cell2.row</code> (row number of <code>cell2</code>) in conjunction with <code>rng3.Cells()</code>."}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1426093397, "post_id": 28992513, "comment_id": 46233787, "body": "@RubberDuck , I dont understand where I would put that in the code. Can you elaborate a bit more?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1426093759, "post_id": 28992513, "comment_id": 46234029, "body": "I think you meant to ping @aucuparia."}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1426093930, "post_id": 28992513, "comment_id": 46234149, "body": "@aucuparia , I dont understand where I would put that code. Can you elaborate a bit more?"}, {"owner": {"reputation": 2017, "user_id": 1698517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366044619e6cb2094c95d889cb75a827?s=128&d=identicon&r=PG", "display_name": "Jaycal", "link": "https://stackoverflow.com/users/1698517/jaycal"}, "edited": false, "score": 1, "creation_date": 1426095496, "post_id": 28992513, "comment_id": 46235259, "body": "you still reference <code>cell2</code> in your <code>elseIf</code> statement; you need to reference the <code>rng3</code> cells"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426095552, "post_id": 28992513, "comment_id": 46235296, "body": "Do you mean that you want to get the values in columns W:AA when the cell in column A is blank or do you want to start the loop over and start getting all of the values in the W:AA range?"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426097854, "post_id": 28992513, "comment_id": 46236811, "body": "@OpiesDad , Yes. I want to get the values in the cells W:AA when cells in column A are blank"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "reply_to_user": {"reputation": 2017, "user_id": 1698517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366044619e6cb2094c95d889cb75a827?s=128&d=identicon&r=PG", "display_name": "Jaycal", "link": "https://stackoverflow.com/users/1698517/jaycal"}, "edited": false, "score": 0, "creation_date": 1426098006, "post_id": 28992513, "comment_id": 46236888, "body": "@Jaycal - I am trying to say ElseIf cell2 is empty then look at ran3.cells and move that data over."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426098263, "post_id": 28992513, "comment_id": 46237036, "body": "Do you need to be able to dynamically change rng3?  Or is this pretty set?"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1426098301, "post_id": 28992513, "comment_id": 46237065, "body": "@OpiesDad , its set, it will be the same range of data each month."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426099541, "post_id": 28994562, "comment_id": 46237864, "body": "I added in your code, and its still not pulling over the next set of data in W. Any ideas?                                                Dim rowCount2 As Long, shtSrc As Worksheet     Dim shtDest As Worksheet     Dim rng2 As Range     Dim rng3 As Range     Dim RangeDiff As Integer     Dim currentRow As Long     RangeDiff = rng3.Column - rng2.Column           Set shtSrc = Sheets(&quot;Data&quot;)     Set shtDest = Sheets(&quot;Audit&quot;)      rowCount2 = shtSrc.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row                    Set rng2 = shtSrc.Range(&quot;A1:A&quot; &amp; rowCount2)     Set rng3 = shtSrc.Range(&quot;W1:W&quot; &amp; rowCount2)"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426100182, "post_id": 28994562, "comment_id": 46238263, "body": "This code will get the values in cells W:AA for rows in which cell A is blank.  Are you intending on finding the first blank in column A and then starting over to get all the values in range 3/cells W:AA?"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426100515, "post_id": 28994562, "comment_id": 46238466, "body": "I am getting Run Time Error 91, object variable or with block not set  for the rangediff = rng3.Column - rng2.column string. I have googled and cannot seem to figure it out."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426100604, "post_id": 28994562, "comment_id": 46238516, "body": "My fault.  That line needs to be after you set the ranges.  I&#39;ll edit the answer to reflect."}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426100606, "post_id": 28994562, "comment_id": 46238517, "body": "Yes. When column A ends/ first blank cell, I need it to move to cell W and start to move that next data set over."}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426100863, "post_id": 28994562, "comment_id": 46238689, "body": "thanks that fixed the error message but it is still not moving the data set in range 3 over?"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426101231, "post_id": 28994562, "comment_id": 46238911, "body": "Exit Loop was giving a syntax error, if I remove it the code appears to work like I needed. Is the exit loop a needed piece of the code?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426104265, "post_id": 28994562, "comment_id": 46240696, "body": "Not vital.  I put it in there to jump outside of the For Loop once an empty cell was encountered.  You could change it to &quot;GoTo StartRange3&quot; and then right before the next loop put &quot;StartRange3:&quot;"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426105373, "post_id": 28994562, "comment_id": 46241312, "body": "Change &quot;Exit Loop&quot; to &quot;Exit For&quot; and it should work, if this is what you actually want."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 1, "last_activity_date": 1426105348, "last_edit_date": 1426105348, "creation_date": 1426098436, "answer_id": 28994562, "question_id": 28992513, "link": "https://stackoverflow.com/questions/28992513/vba-elseif-with-multiple-ranges/28994562#28994562", "title": "VBA ElseIf with multiple ranges", "body": "<p>You could just use the offset function to get to the appropriate columns:</p>\n\n<pre><code>Dim RangeDiff As Integer\n...\nSet rng2 = ...\nSet rng3 = ...\nRangeDiff = Rng3.Column - rng2.column\n...\n\nElseIf cell2.Value = \"\" Then\n\n        shtDest.Range(\"B\" &amp; currentRow).Value2 = cell2.Offset(0, RangeDiff).Value2\n        shtDest.Range(\"C\" &amp; currentRow).Value2 = cell2.Offset(0, RangeDiff + 1)\n\n...\n</code></pre>\n\n<p>EDIT per new understanding of requirements:</p>\n\n<pre><code>...\nFor Each cell2 In rng2.Cells\n    If cell2.Value &lt;&gt; \"\" Then\n        shtDest.Range(\"B\" &amp; currentRow).Value2 = cell2.Value2\n        shtDest.Range(\"C\" &amp; currentRow).Value2 = cell2.Offset(0, 1).Value2\n        shtDest.Range(\"G\" &amp; currentRow).Value2 = cell2.Offset(0, 2).Value2\n\n        currentRow = currentRow + 1\n\n    ElseIf cell2.Value = \"\" Then\n\n        Exit For\n    End If\nNext cell2\n\nFor Each cell3 In rng3.Cells\n    If cell3.Value &lt;&gt; \"\" Then\n        shtDest.Range(\"B\" &amp; currentRow).Value2 = cell3.Value2\n        shtDest.Range(\"C\" &amp; currentRow).Value2 = cell3.Offset(0, 1).Value2\n        shtDest.Range(\"G\" &amp; currentRow).Value2 = cell3.Offset(0, 2).Value2\n\n        currentRow = currentRow + 1\n\n    ElseIf cell3.Value = \"\" Then\n\n        Exit For\n    End If\nNext cell3\n</code></pre>\n\n<p>...</p>\n"}], "owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 28994562, "answer_count": 1, "score": 0, "last_activity_date": 1426105348, "creation_date": 1426092342, "last_edit_date": 1531164843, "question_id": 28992513, "link": "https://stackoverflow.com/questions/28992513/vba-elseif-with-multiple-ranges", "title": "VBA ElseIf with multiple ranges", "body": "<p>I have a file with data in A - U and W - AA. I am trying to write code that will copy cells from the first range A - U and once it encounters a blank cell in A, it looks to the second range W - AA. The first part of the code is working, but I cannot seem to figure out how to call the second range.</p>\n\n<pre><code>Sub Test()\n\n    Dim rowCount2 As Long, shtSrc As Worksheet\n    Dim shtDest As Worksheet\n    Dim rng2 As Range\n    Dim rng3 As Range\n    Dim currentRow As Long\n\n\n    Set shtSrc = Sheets(\"Data\")\n    Set shtDest = Sheets(\"Audit\")\n\n    rowCount2 = shtSrc.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Set rng2 = shtSrc.Range(\"A1:A\" &amp; rowCount2)\n    Set rng3 = shtSrc.Range(\"W1:W\" &amp; rowCount2)\n\n    currentRow = 2\n\n    For Each cell2 In rng2.Cells\n        If cell2.Value &lt;&gt; \"\" Then\n            shtDest.Range(\"B\" &amp; currentRow).Value2 = cell2.Value2\n            shtDest.Range(\"C\" &amp; currentRow).Value2 = cell2.Offset(0, 1).Value2\n            shtDest.Range(\"G\" &amp; currentRow).Value2 = cell2.Offset(0, 2).Value2\n\n            currentRow = currentRow + 1\n\n        ElseIf cell2.Value = \"\" Then\n\n            shtDest.Range(\"B\" &amp; currentRow).Value2 = cell2.Value2\n            shtDest.Range(\"C\" &amp; currentRow).Value2 = cell2.Offset(0, 1)\n\n            currentRow = currentRow + 1\n\n        End If\n    Next cell2\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 5, "creation_date": 1426091263, "post_id": 28991992, "comment_id": 46232315, "body": "It would help if you showed us your actual VBA code..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426091518, "post_id": 28991992, "comment_id": 46232499, "body": "Are you using the <code>FormulaR1C1</code> property by any chance?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1426093153, "post_id": 28991992, "comment_id": 46233612, "body": "@AmishZ please <a href=\"https://stackoverflow.com/posts/28991992/edit\">edit</a> that into your original post :)"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1426094166, "post_id": 28991992, "comment_id": 46234328, "body": "Try doing it without the R1C1... just <code>.Formula</code>"}, {"owner": {"reputation": 1, "user_id": 4650314, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_nhridwKCUU/AAAAAAAAAAI/AAAAAAAAABs/NjX7BNkMGVY/photo.jpg?sz=128", "display_name": "AmishZ", "link": "https://stackoverflow.com/users/4650314/amishz"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1426155652, "post_id": 28991992, "comment_id": 46259765, "body": "It worked! Thank you @Chrismas007"}], "answers": [{"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 0, "last_activity_date": 1426533392, "creation_date": 1426533392, "answer_id": 29085137, "question_id": 28991992, "link": "https://stackoverflow.com/questions/28991992/vba-breaking-my-formula/29085137#29085137", "title": "VBA Breaking My Formula", "body": "<p>Your solution relates to your improper use of <code>FormulaR1C1</code>.  Rather than using this method, you should just use <code>.Formula</code> to insert your formula into the cell.</p>\n"}], "owner": {"reputation": 1, "user_id": 4650314, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_nhridwKCUU/AAAAAAAAAAI/AAAAAAAAABs/NjX7BNkMGVY/photo.jpg?sz=128", "display_name": "AmishZ", "link": "https://stackoverflow.com/users/4650314/amishz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426533392, "creation_date": 1426090880, "last_edit_date": 1426093859, "question_id": 28991992, "link": "https://stackoverflow.com/questions/28991992/vba-breaking-my-formula", "title": "VBA Breaking My Formula", "body": "<p>I am using an Add-in called SEOTools for Excel which is free : <a href=\"http://seotools.nielsbosma.se/releases/\" rel=\"nofollow\">http://seotools.nielsbosma.se/releases/</a></p>\n\n<p>VBA is breaking my formula.</p>\n\n<pre><code>=Dump(GoogleAnalytics(\"\"ga:1169833\"\",\"\"ga:adCost,ga:impressions,ga:adClicks,ga:CTR,ga:CPC,ga:goal7Completions\"\",A307,A306,\"\"ga:campaign\"\",\"\"\"\",\"\"ga:medium==cpc;ga:campaign!=(not set);ga:campaign!=ZZZ_Old_Mexico\"\",\"\"\"\",1,10000,FALSE,FALSE))\n</code></pre>\n\n<p>Whats happening is the A307 shows up as 'A307' when the formula is placed into a cell A1 in Excel which does not work for this formula. Why? Can I stop it adding those characters to the cell reference?</p>\n\n<p>Full code  :</p>\n\n<pre><code>Worksheets(\"Latest Time Range\").Select\nRange(\"A1\").Select\nActiveCell.FormulaR1C1 = \"=Dump(GoogleAnalytics(\"\"ga:1169833\"\",\"\"ga:adCost,ga:impressions,ga:adClicks,ga:CTR,ga:CPC,ga:goal7Completions\"\",A307,A306,\"\"ga:campaign\"\",\"\"\"\",\"\"ga:medium==cpc;ga:campaign!=(not set);ga:campaign!=ZZZ_Old_Mexico\"\",\"\"\"\",1,10000,FALSE,FALSE))\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4581620, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-1nfIahG7mKI/AAAAAAAAAAI/AAAAAAAAAAA/ukLdoYni-s8/photo.jpg?sz=128", "display_name": "SnakZ Maynard", "link": "https://stackoverflow.com/users/4581620/snakz-maynard"}, "edited": false, "score": 0, "creation_date": 1426092179, "post_id": 28992103, "comment_id": 46232935, "body": "That only copy the first row how would i get the number of how many rows there is so i can turn your   .CurrentRegion.Copy wsDest.Range(&quot;A1&quot;)  into a loop"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 29, "user_id": 4581620, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-1nfIahG7mKI/AAAAAAAAAAI/AAAAAAAAAAA/ukLdoYni-s8/photo.jpg?sz=128", "display_name": "SnakZ Maynard", "link": "https://stackoverflow.com/users/4581620/snakz-maynard"}, "edited": false, "score": 0, "creation_date": 1426103357, "post_id": 28992103, "comment_id": 46240145, "body": "? This doesn&#39;t just copy the first row, it would copy all visible rows.  I have tested it and it works just fine for me.  Do you have full rows that are just blank cells breaking up your data? That&#39;s about the only thing that would mess up the <code>CurrentRegion</code>"}, {"owner": {"reputation": 29, "user_id": 4581620, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-1nfIahG7mKI/AAAAAAAAAAI/AAAAAAAAAAA/ukLdoYni-s8/photo.jpg?sz=128", "display_name": "SnakZ Maynard", "link": "https://stackoverflow.com/users/4581620/snakz-maynard"}, "edited": false, "score": 0, "creation_date": 1426163465, "post_id": 28992103, "comment_id": 46264778, "body": "yeah but why does the auto filter not take care of the blank rows ?"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1426091219, "creation_date": 1426091219, "answer_id": 28992103, "question_id": 28991926, "link": "https://stackoverflow.com/questions/28991926/vba-filter-then-copy-rows-to-a-new-sheet-excel-2007/28992103#28992103", "title": "VBA filter then copy rows to a new sheet ? excel 2007", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n\n    Set wsData = Sheets(\"Sheet1\")\n    Set wsDest = Sheets(\"Dump\")\n\n    With wsData.Range(\"B1\", wsData.Cells(Rows.Count, \"B\").End(xlUp))\n        .AutoFilter 1, \"&lt;&gt;\"\n        .CurrentRegion.Copy wsDest.Range(\"A1\")\n        .AutoFilter\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "is_accepted": false, "score": 0, "last_activity_date": 1426092606, "creation_date": 1426092606, "answer_id": 28992599, "question_id": 28991926, "link": "https://stackoverflow.com/questions/28991926/vba-filter-then-copy-rows-to-a-new-sheet-excel-2007/28992599#28992599", "title": "VBA filter then copy rows to a new sheet ? excel 2007", "body": "<p>I believe this will work in 2007 but I can only test it in 2013 (and it worked).  Try to use the paste special \"SkipBlanks\" option:</p>\n\n<pre><code>ActiveSheet.Columns(\"B:B\").AutoFilter\nActiveSheet.Range(\"$B:$B\").AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\"\nActiveSheet.Columns(\"B:B\").Copy\nSheets(\"Dump\").Columns(\"B:B\").PasteSpecial SkipBlanks:=True\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4581620, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-1nfIahG7mKI/AAAAAAAAAAI/AAAAAAAAAAA/ukLdoYni-s8/photo.jpg?sz=128", "display_name": "SnakZ Maynard", "link": "https://stackoverflow.com/users/4581620/snakz-maynard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2807, "favorite_count": 0, "accepted_answer_id": 28992103, "answer_count": 2, "score": 0, "last_activity_date": 1426092606, "creation_date": 1426090688, "last_edit_date": 1531164843, "question_id": 28991926, "link": "https://stackoverflow.com/questions/28991926/vba-filter-then-copy-rows-to-a-new-sheet-excel-2007", "title": "VBA filter then copy rows to a new sheet ? excel 2007", "body": "<p>I need a way to copy rows with data what has been filter user auto-filter </p>\n\n<p>My problem is i dont know why but when VBA copy's and paste data from a filter it makes both of the sheets row limit go all the way down to the max. Making my file size way bigger, and taking longer bc of the added size</p>\n\n<pre><code>    Columns(\"B:B\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$B:$B\").AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\"\n    Cells.Select\n    Selection.Copy\n    Sheets(\"Dump\").Select\n    Cells.Select\n    ActiveSheet.Paste\n</code></pre>\n\n<p>Only thing i have found to deal with this is to </p>\n\n<pre><code>    Columns(\"B:B\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$B:$B\").AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\"\n\n   'some how Copy all rows with data'\n\n    Selection.Copy\n    Sheets(\"Dump\").Select\n    Cells.Select\n    ActiveSheet.Paste\n</code></pre>\n\n<p>I have tested out copying the rows without VBA and it did work without any errors but i dont know how to code VBA to do that so what im asking \nHow to copy the rows that have been filter or if u happen to know away around the size limit problem that would be nice to </p>\n"}, {"tags": ["database", "forms", "vba", "ms-access", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 4589068, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc74af4e4fa0243d46de1f3686557cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Colja", "link": "https://stackoverflow.com/users/4589068/colja"}, "edited": false, "score": 0, "creation_date": 1426175085, "post_id": 28999646, "comment_id": 46273224, "body": "Oh my... This solution is so simple - it almost hurt :-) I just set the Default Value and everything&#39;s fine.  Thank you!"}, {"owner": {"reputation": 209, "user_id": 4589068, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc74af4e4fa0243d46de1f3686557cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Colja", "link": "https://stackoverflow.com/users/4589068/colja"}, "edited": false, "score": 0, "creation_date": 1426176051, "post_id": 28999646, "comment_id": 46273903, "body": "Well... this solution works but now I have another problem. When somebody pushes the button, he automatically jumps to the &quot;new record&quot; with the parent-it being the default value. If the user now closes the form without editing, there is an almost blank record saved to the db.  Is there a smart way dealing with that? Well, when I just define some of the input parameters as required, the user gets some ugly prompts. I&#39;d prefer that the input is just not stored. Any idea? w/ or w/o VBA?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 209, "user_id": 4589068, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc74af4e4fa0243d46de1f3686557cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Colja", "link": "https://stackoverflow.com/users/4589068/colja"}, "edited": false, "score": 0, "creation_date": 1426194313, "post_id": 28999646, "comment_id": 46284024, "body": "Which version above did you use? Form control or VBA? Default values does not save until a record is saved. If all form fields remain empty when form is closed, no data will be saved. Check to see your Form Close or any Close Button event. Remove any Save Record command."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1426118316, "creation_date": 1426118316, "answer_id": 28999646, "question_id": 28991808, "link": "https://stackoverflow.com/questions/28991808/ms-access-keep-id-field-in-subform-filled-with-id-from-parent-form/28999646#28999646", "title": "MS Access keep ID field in subform filled with ID from parent form", "body": "<p>You can use Default Value to set the classid of Tests form but be sure the parent form is open in background or behind the pop up.</p>\n\n<p>Under Property Sheet/Data tab of Tests form's classid control, enter in Default Value cell:</p>\n\n<pre><code>=Forms!parentformname!classid\n</code></pre>\n\n<p>Alternatively, in <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837160.aspx\" rel=\"nofollow\">VBA</a> in the Tests form's OnOpen Event:</p>\n\n<pre><code>Me.classid.DefaultValue = Forms!parentformname!classid\n</code></pre>\n\n<p>You can then choose to hide (Visible - No) this classid control so users do not modify it. It's always advised to never allow users control of primary and foreign keys.</p>\n"}], "owner": {"reputation": 209, "user_id": 4589068, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/dc74af4e4fa0243d46de1f3686557cbb?s=128&d=identicon&r=PG&f=1", "display_name": "Colja", "link": "https://stackoverflow.com/users/4589068/colja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3434, "favorite_count": 0, "accepted_answer_id": 28999646, "answer_count": 1, "score": 0, "last_activity_date": 1426118316, "creation_date": 1426090349, "question_id": 28991808, "link": "https://stackoverflow.com/questions/28991808/ms-access-keep-id-field-in-subform-filled-with-id-from-parent-form", "title": "MS Access keep ID field in subform filled with ID from parent form", "body": "<p>Everytime I jump to where I can enter e new record, the ID field from the parent is empty and so the connection is lost. I am looking for a workaround.</p>\n\n<h2>My Setup</h2>\n\n<p>I have a parent form that deals with two 1:n relationships</p>\n\n<p>(school-class --> pupils, school-class --> tests).</p>\n\n<p>For the first relationship I used the wizard. Everything works find. For the second I show the connected tests in an unbound list. Under the list is a button opening the form for entering a new record (test) for the class I came from (parent form). So I filter the sub-form via VBA so that only the tests of the current class are shown. That works perfectly fine, too.</p>\n\n<p>When moving through the tests already connected with the class the correct ID (of the class filtered) is the value of the corresponding input field. But when I come to the new new record state (all fields empty), then the connection to the parent breaks and the user has to manually enter the ID of the parent (school-class).</p>\n\n<h2>My Question</h2>\n\n<p>Is my setup correct?\nIs there a better way to create a subform that offers to (only) enter a new record connected to the parent data? (Maybe without the ID input field in the subform and passing of forcing the value via VBA?)</p>\n\n<p>Thank you for your time!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1427916100, "post_id": 29246868, "comment_id": 46973978, "body": "Many thanks for taking the time to look at it. I will have to try this out. I really appreciate your time!!!"}, {"owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "edited": false, "score": 0, "creation_date": 1428011402, "post_id": 29246868, "comment_id": 47017586, "body": "I have tried it in various places, but thought this was the most promising. <code>While .Execute bFound = True FindText If oDocRecord Is Nothing Then</code>   It didn&#39;t work, so I thought of using something like: <code>While .Execute If bFound = True Then FindText If oDocRecord Is Nothing Then Set oDocRecord = Documents.Add</code> &lt;br/&gt;This also didn&#39;t work, but I&#39;ve still other thoughts. Just giving an update. (I want to try and work it out for myself at the moment) Thanks for looking"}], "tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": false, "score": 0, "last_activity_date": 1427253762, "creation_date": 1427253762, "answer_id": 29246868, "question_id": 28991705, "link": "https://stackoverflow.com/questions/28991705/searching-for-words-in-word-but-ignoring-tables/29246868#29246868", "title": "Searching for words in word, but ignoring tables", "body": "<p>Instead of trying to debug/edit your code look at this and decide for yourself where to insert it.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub FindText()\r\n    Dim doc As Word.Document, rng As Word.Range\r\n    Set doc = Word.ActiveDocument\r\n    Set rng = doc.Content\r\n    With rng.Find\r\n        .ClearFormatting\r\n        .Format = False\r\n        .Forward = True\r\n        .Text = \"Now is\"\r\n        .Wrap = wdFindStop\r\n        .Execute\r\n        Do While .Found\r\n            If rng.Information(Word.WdInformation.wdWithInTable) Then\r\n                'do nothing\r\n                rng.Collapse Word.WdCollapseDirection.wdCollapseEnd\r\n            Else\r\n                rng.Text = \"Now is not\"\r\n                rng.Collapse Word.WdCollapseDirection.wdCollapseEnd\r\n            End If\r\n            .Execute\r\n        Loop\r\n    End With\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 1, "user_id": 4634052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47d4b8339111d638e9b72dcb20909557?s=128&d=identicon&r=PG&f=1", "display_name": "user4634052", "link": "https://stackoverflow.com/users/4634052/user4634052"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1175, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1427992282, "creation_date": 1426090096, "last_edit_date": 1427992282, "question_id": 28991705, "link": "https://stackoverflow.com/questions/28991705/searching-for-words-in-word-but-ignoring-tables", "title": "Searching for words in word, but ignoring tables", "body": "<p>I have the <strong>fantastic</strong> macro below which </p>\n\n<ul>\n<li>Searches for words (listed in an excel file)</li>\n<li>Copies each instance</li>\n<li>Pastes into a new word document together with it's location from the original document</li>\n</ul>\n\n<p>This has been created and amended by various people and I am truly greatful!!. One thing that I was wondering if possible is:</p>\n\n<p>If in the word document which you're searching there are tables, can you make the macro to ignore tables? or would it be better to say 'If the word is found and is in a table ignore this instance and proceed searching te document again'</p>\n\n<p>The latter would have more unnecessary iterations in my opinion.</p>\n\n<p>I had managed to find the code:</p>\n\n<pre><code>Sub NonTableParagraphs()\n    Dim rng() As Range\n    Dim t As Integer\n    Dim tbl As Table\n    Dim para As Paragraph\n    Dim r As Integer\n\n    ReDim Preserve rng(t)\n    Set rng(t) = ActiveDocument.Range\n    For Each tbl In ActiveDocument.Tables\n        rng(t).End = tbl.Range.Start\n        t = t + 1\n        ReDim Preserve rng(t)\n        Set rng(t) = ActiveDocument.Range\n        rng(t).Start = tbl.Range.End\n    Next tbl\n    rng(t).End = ActiveDocument.Range.End\n    For r = 0 To t\n        For Each para In rng(r).Paragraphs\n             'do processing\n        Next para\n    Next r\nEnd Sub\n</code></pre>\n\n<p>and had tried to insert <code>NonTableParagraphs</code> in the original macro, so it would run a sub routine, but I couldn't get it to work.</p>\n\n<p>It looks like I should be trying to use <code>ActiveDocument.Tables</code> and somehow stating if <code>ActiveDocument.Tables found</code>, skip the rest of the lines in macro &amp; then return to searching after the table but I can't seem to get it to work.</p>\n\n<p>I'll see if I can search for that</p>\n\n<p>Many thanks!!!</p>\n\n<pre><code>Sub CopyKeywordPlusContext()\n'Modified 3-10-2015 TW\n'Modified 2-17-2015 GKM\n'Makro created on 22.01.2013\nDim oDoc As Document, oDocRecord As Document\nDim strSearch As String, arrSearch\nDim lngCharTrailing As Long, lngCharLeading As Long, lngIndex As Long, lngCount As Long\nDim lngPgNum, lngLineNum As Integer\nDim oRng As Word.Range, oRngSpan As Word.Range\nDim bFound As Boolean\nDim oTbl As Word.Table\n  strSearch = vbNullString\n  Dim xl As Object\nSet xl = GetObject(, \"Excel.Application\")\narrSearch = xl.transpose(xl.activesheet.Range(\"A1:A221\").Value)\n  lngCharLeading = 20\n  lngCharTrailing = 20\n  Set oDoc = ActiveDocument\n    For lngIndex = 1 To UBound(arrSearch)\n    ResetFRParams\n    bFound = False\n    lngCount = 0\n    Set oRng = oDoc.Range\n    With oRng.Find\n      .Text = LCase(arrSearch(lngIndex))\n      While .Execute\n        bFound = True\n        If oDocRecord Is Nothing Then\n          Set oDocRecord = Documents.Add\n          Set oTbl = oDocRecord.Tables.Add(oDocRecord.Range, 1, 2)\n        End If\n        lngCount = lngCount + 1\n        If lngCount = 1 Then\n          oTbl.Rows.Add\n          With oTbl.Rows.Last.Previous\n            .Cells.Merge\n            With .Cells(1).Range\n              .Text = \"Search results for \"\"\" &amp; arrSearch(lngIndex) &amp; \"\"\" + context in \" &amp; \"\"\"\" &amp; oDoc.Name &amp; \"\"\"\"\n              .Font.Bold = True\n            End With\n          End With\n        End If\n        Set oRngSpan = oRng.Duplicate\n        oRngSpan.Select\n        lngPgNum = Selection.Information(wdActiveEndPageNumber)\n        lngLineNum = Selection.Information(wdFirstCharacterLineNumber)\n        With oRngSpan\n          .MoveStart wdCharacter, -lngCharLeading\n          .MoveEnd wdCharacter, lngCharTrailing\n          Do While oRngSpan.Characters.First = vbCr\n            oRngSpan.MoveStart wdCharacter, -1\n          Loop\n          Do While oRngSpan.Characters.Last = vbCr\n            oRngSpan.MoveEnd wdCharacter, 1\n            If oRngSpan.End = oDoc.Range.End Then\n              oRngSpan.End = oRngSpan.End - 1\n              Exit Do\n            End If\n          Loop\n        End With\n        oTbl.Rows.Last.Range.Cells(1).Range.Text = Trim(oRngSpan.Text)\n        oTbl.Rows.Last.Range.Cells(2).Range.Text = \"Page: \" &amp; lngPgNum &amp; \" Line: \" &amp; lngLineNum\n        oTbl.Rows.Add\n      Wend\n    End With\n    If bFound Then\n      ResetFRParams\n      With oDocRecord.Range.Find\n        .Text = LCase(arrSearch(lngIndex))\n        .Replacement.Text = \"^&amp;\"\n        .Replacement.Highlight = True\n        .Format = True\n        .Execute Replace:=wdReplaceAll\n      End With\n    End If\n  Next lngIndex\n  oTbl.Rows.Last.Delete\nEnd Sub\nSub ResetFRParams()\n    With Selection.Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Text = \"\"\n    .Replacement.Text = \"\"\n    .Replacement.Highlight = False\n    .Forward = True\n    .Wrap = wdFindStop\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .Execute\n  End With\nlbl_Exit:\n  Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1426131203, "post_id": 28991334, "comment_id": 46250512, "body": "This range loop will still be slow if the range is long, the single short approaches above are better."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1426089150, "creation_date": 1426089150, "answer_id": 28991334, "question_id": 28991174, "link": "https://stackoverflow.com/questions/28991174/excel-macro-to-change-entire-column-to-uppercase/28991334#28991334", "title": "Excel Macro to change entire column to uppercase", "body": "<p>Try this instead. You loop through every cell in column B, which is why it is slow.</p>\n\n<pre><code>Sub Uppercase()\n   ' Loop to cycle through each cell in the specified range.\n   For Each x In Range(\"B1:B\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row))\n      ' Change the text in the column to uppercase letters.\n      x.Value = UCase(x.Value)\n   Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4372020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c4172293406b868696bd4bb3fa441a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jak Parr", "link": "https://stackoverflow.com/users/4372020/jak-parr"}, "edited": false, "score": 0, "creation_date": 1426090730, "post_id": 28991559, "comment_id": 46231912, "body": "Thanks, that did take care of it instantly."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 3, "last_activity_date": 1426089706, "creation_date": 1426089706, "answer_id": 28991559, "question_id": 28991174, "link": "https://stackoverflow.com/questions/28991174/excel-macro-to-change-entire-column-to-uppercase/28991559#28991559", "title": "Excel Macro to change entire column to uppercase", "body": "<p>Don't need a loop at all, this should take care of it basically instantly:</p>\n\n<pre><code>Sub tgr()\n\n    With Range(\"B1\", Cells(Rows.Count, \"B\").End(xlUp))\n        .Value = Evaluate(\"INDEX(UPPER(\" &amp; .Address(External:=True) &amp; \"),)\")\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4372020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c4172293406b868696bd4bb3fa441a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jak Parr", "link": "https://stackoverflow.com/users/4372020/jak-parr"}, "edited": false, "score": 0, "creation_date": 1426090567, "post_id": 28991580, "comment_id": 46231793, "body": "It looks like everyone agrees with you. But to be honest... I have no idea where that goes. Do you mind putting context behind it? Or posting the finished code? I&#39;m like elementary level coding of macros here... But I&#39;m trying to learn."}, {"owner": {"reputation": 535, "user_id": 2573344, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Xp3V4.jpg?s=128&g=1", "display_name": "JRQ", "link": "https://stackoverflow.com/users/2573344/jrq"}, "edited": false, "score": 0, "creation_date": 1426106324, "post_id": 28991580, "comment_id": 46241866, "body": "Well, it would go inside your Sub."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1426132396, "post_id": 28991580, "comment_id": 46250785, "body": "Alternatively if it is a one off just plop it into the debug window (CTRL-G inside the VB Editor in Excel) and press enter"}, {"owner": {"reputation": 25, "user_id": 4372020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c4172293406b868696bd4bb3fa441a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jak Parr", "link": "https://stackoverflow.com/users/4372020/jak-parr"}, "edited": false, "score": 0, "creation_date": 1426159616, "post_id": 28991580, "comment_id": 46262262, "body": "Oh, that&#39;s literally the whole code. ha. ok. that&#39;s what i misunderstood."}], "tags": [], "owner": {"reputation": 535, "user_id": 2573344, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Xp3V4.jpg?s=128&g=1", "display_name": "JRQ", "link": "https://stackoverflow.com/users/2573344/jrq"}, "is_accepted": false, "score": 2, "last_activity_date": 1426089760, "creation_date": 1426089760, "answer_id": 28991580, "question_id": 28991174, "link": "https://stackoverflow.com/questions/28991174/excel-macro-to-change-entire-column-to-uppercase/28991580#28991580", "title": "Excel Macro to change entire column to uppercase", "body": "<p>Do the whole range at once:</p>\n\n<pre><code>Range(\"B:B\") = [index(Upper(B:B),)]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9318605, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dmp3LZd5L5A/AAAAAAAAAAI/AAAAAAAAAFg/C8GJD2BqwQ8/photo.jpg?sz=128", "display_name": "Yvan Helie", "link": "https://stackoverflow.com/users/9318605/yvan-helie"}, "is_accepted": false, "score": 0, "last_activity_date": 1582849983, "last_edit_date": 1582849983, "creation_date": 1527254111, "answer_id": 50530111, "question_id": 28991174, "link": "https://stackoverflow.com/questions/28991174/excel-macro-to-change-entire-column-to-uppercase/50530111#50530111", "title": "Excel Macro to change entire column to uppercase", "body": "<p>Good, but using such a feature on a Selection is much more user friendly.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ToUpper()\n    For Each cell In Selection\n        If Not cell.HasFormula Then\n            cell.Value = UCase(cell.Value)\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4372020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c4172293406b868696bd4bb3fa441a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jak Parr", "link": "https://stackoverflow.com/users/4372020/jak-parr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12371, "favorite_count": 0, "accepted_answer_id": 28991559, "answer_count": 4, "score": 2, "last_activity_date": 1582849983, "creation_date": 1426088758, "last_edit_date": 1531161705, "question_id": 28991174, "link": "https://stackoverflow.com/questions/28991174/excel-macro-to-change-entire-column-to-uppercase", "title": "Excel Macro to change entire column to uppercase", "body": "<p>I'm trying to update a workbook I have to change all the emails from lowercase to uppercase.\nI'm not that savvy with macros yet, but I came up with this one, but it takes forever to run. (only about ~1k rows).</p>\n\n<pre><code>Sub Uppercase()\n   ' Loop to cycle through each cell in the specified range.\n   For Each x In Range(\"B:B\")\n      ' Change the text in the column to uppercase letters.\n      x.Value = UCase(x.Value)\n   Next\nEnd Sub\n</code></pre>\n\n<p>Is there something better I should be using?</p>\n\n<p>tl;dr I need to change entire columns case, to uppercase.</p>\n"}, {"tags": ["forms", "vba", "ms-access", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4095708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e07f2b634cee8b550a5b2ce795107a?s=128&d=identicon&r=PG&f=1", "display_name": "jrdevdba", "link": "https://stackoverflow.com/users/4095708/jrdevdba"}, "edited": false, "score": 0, "creation_date": 1426092633, "post_id": 28991638, "comment_id": 46233242, "body": "Thanks! I think the login form is closing because I exit the function above and also have code to close the form in the calling procedure."}], "tags": [], "owner": {"reputation": 159, "user_id": 3618351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380923b2c8631253ec3e791e2896868a?s=128&d=identicon&r=PG&f=1", "display_name": "EvDev", "link": "https://stackoverflow.com/users/3618351/evdev"}, "is_accepted": true, "score": 0, "last_activity_date": 1426089931, "creation_date": 1426089931, "answer_id": 28991638, "question_id": 28991024, "link": "https://stackoverflow.com/questions/28991024/ms-access-vba-return-to-login-form-if-login-fails/28991638#28991638", "title": "MS Access VBA: Return to login form if login fails", "body": "<p>After \"msgBox strMsg, vbCritical\" in your error handler add the following:</p>\n\n<pre><code>DoCmd.OpenForm \"LoginFormName\"\n</code></pre>\n\n<p>Then in the Form_Open event of the login form put</p>\n\n<pre><code>me.TextBoxName.SetFocus\n</code></pre>\n\n<p>You'll need to change \"LoginFormName\" and \"TextBoxName\" to the name of your forms.  I'd be curious as to why the login form is closing but I'd need to see the rest of your code for that.</p>\n"}], "owner": {"reputation": 113, "user_id": 4095708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e07f2b634cee8b550a5b2ce795107a?s=128&d=identicon&r=PG&f=1", "display_name": "jrdevdba", "link": "https://stackoverflow.com/users/4095708/jrdevdba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 28991638, "answer_count": 1, "score": 0, "last_activity_date": 1426089931, "creation_date": 1426088361, "question_id": 28991024, "link": "https://stackoverflow.com/questions/28991024/ms-access-vba-return-to-login-form-if-login-fails", "title": "MS Access VBA: Return to login form if login fails", "body": "<p>I'm working on a login form using MS Access 2010 and VBA. I have been able to create a message that pops up if a user enters a user/password combination that fails when those credentials are passed to a function that tries to log in to an ODBC database connection. The login form then closes.</p>\n\n<p>What I would like to do is have the application return the focus to the login form and ask the user to try the login again. Below is the current login error I have adapted from the info at this URL:\n<a href=\"http://allenbrowne.com/ser-23a.html\" rel=\"nofollow\">http://allenbrowne.com/ser-23a.html</a></p>\n\n<pre><code>ErrorHandler:\n    strMsg = \"An unexpected situation arose in your program.\" &amp; vbCrLf &amp; _\n        \"Please write down the following details:\" &amp; vbCrLf &amp; vbCrLf &amp; _\n        \"Unable to sign in because of Error: \" &amp; Err.Number &amp; vbCrLf &amp;     Err.Description\n    MsgBox strMsg, vbCritical\n    Exit Function\n</code></pre>\n\n<p>Does anyone have a hint or reference on how to get that behavior using VBA?</p>\n\n<p>Thanks for any help,\njrdevdba</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1426087479, "post_id": 28990443, "comment_id": 46229513, "body": "Have you turned off screenupdating and such?"}, {"owner": {"reputation": 577, "user_id": 4334973, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e2e1e1d15d538ea7559d5c14385bce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Shazu", "link": "https://stackoverflow.com/users/4334973/shazu"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1426087525, "post_id": 28990443, "comment_id": 46229546, "body": "Yes, I have tried that"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1426090562, "last_edit_date": 1426090562, "creation_date": 1426088472, "answer_id": 28991074, "question_id": 28990443, "link": "https://stackoverflow.com/questions/28990443/clearing-cells-with-empty-string-values/28991074#28991074", "title": "Clearing cells with empty string values", "body": "<p>If you have no <strong>formulas</strong> in the columns then running:</p>\n\n<pre><code>Sub clearTHEM()\n    Dim r As Range\n    Dim N As Long\n    N = Cells(Rows.Count, \"AG\").End(xlUp).Row\n    Set r = Range(\"AG2:AJ\" &amp; N)\n    With r\n        .Value = .Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>will clear the <em>Nulls</em>.  However it will also blast away formulas.  If you have formulas, then run the macro, then export, but don't save.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>For a slightly cleaner approach, this code will create a special, for export only, copy of the worksheet without either nulls or formulas:</p>\n\n<pre><code>Sub ForExportOnly()\n    ActiveSheet.Copy After:=Sheets(Sheets.Count)\n    ActiveSheet.Name = \"For Export Only\"\n    With ActiveSheet.UsedRange\n        .Value = .Value\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1426088938, "creation_date": 1426088938, "answer_id": 28991253, "question_id": 28990443, "link": "https://stackoverflow.com/questions/28990443/clearing-cells-with-empty-string-values/28991253#28991253", "title": "Clearing cells with empty string values", "body": "<p>In case you do have formulas, this should work for you and ran on a test dataset for me that had 360000 rows in less than 5 seconds:</p>\n\n<pre><code>Sub tgr()\n\n    Dim lCalc As XlCalculation\n    Dim lCol As Long\n    Dim lLastRow As Long\n\n    With Application\n        lCalc = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    lLastRow = Range(\"AG:AJ\").Find(\"*\", Range(\"AG1\"), , , , xlPrevious).Row\n\n    For lCol = Columns(\"AG\").Column To Columns(\"AJ\").Column\n        With Cells(1, lCol).Resize(lLastRow)\n            .AutoFilter 1, \"=\"\n            .Offset(1).Resize(.Rows.Count - 1).ClearContents\n            .AutoFilter\n        End With\n    Next lCol\n\n    With Application\n        .Calculation = lCalc\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 577, "user_id": 4334973, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e2e1e1d15d538ea7559d5c14385bce1d?s=128&d=identicon&r=PG&f=1", "display_name": "Shazu", "link": "https://stackoverflow.com/users/4334973/shazu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1004, "favorite_count": 0, "accepted_answer_id": 28991253, "answer_count": 2, "score": 0, "last_activity_date": 1426090562, "creation_date": 1426086979, "last_edit_date": 1531161705, "question_id": 28990443, "link": "https://stackoverflow.com/questions/28990443/clearing-cells-with-empty-string-values", "title": "Clearing cells with empty string values", "body": "<p>I am trying to export an excel file to an access database. Certain columns/fields need to have field type <strong>number</strong>, because these fields will be used later on in queries involving functions like sum, count etc.</p>\n\n<p>Now the problem is that the corresponding columns in excel contain empty strings that create problem while exporting to access database (field type mismatch). Even if these columns in excel have the cells formatted as numbers, the problem persists</p>\n\n<p>I used the following VBA Code to eliminate all the empty strings in these columns and it works for a decent number of rows. But the excel file will have 350000 plus rows, and for such a large number of rows, the code seems to run forever.</p>\n\n<p>Any tips on improving my code or taking another approach will be highly appreciated   </p>\n\n<pre><code>Dim r As Range\nFor Each r In ActiveSheet.Range(\"AG2:AJ\" &amp; lastRow)\n    With r\n        If .Value = \"\" Then\n            .Clear\n        End If\n    End With\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 188, "user_id": 3684671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3205b96f7b388c7f1301a4a0c3e35f1f?s=128&d=identicon&r=PG&f=1", "display_name": "Kory", "link": "https://stackoverflow.com/users/3684671/kory"}, "edited": false, "score": 0, "creation_date": 1426086881, "post_id": 28990314, "comment_id": 46229079, "body": "Can you please explain what is happening when you run the code? And where is your Num_Article_Info_Generale object?"}, {"owner": {"reputation": 64, "user_id": 4638528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81a2cd3bcd4995fffd55d5d9c5bc340?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/4638528/philippe"}, "edited": false, "score": 0, "creation_date": 1426087018, "post_id": 28990314, "comment_id": 46229177, "body": "what is the error that you are getting? What is not working?, PS: I would say if the above need before end sub <code>application.screenupdating = true</code>. Additionally I would change <code>&quot;ThisWorkbook.Worksheets(&quot;Donn&#233;es Enregistr&#233;es&quot;).Activate Range(&quot;A$2&quot;).Value = Num_Article_Info_Generale.Text&quot;</code> to <code>sheets(&quot;Donn&#233;es Enregistr&#233;es&quot;).range(&quot;A2&quot;).value = Num_Article_Info_Generale.Text</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "reply_to_user": {"reputation": 64, "user_id": 4638528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81a2cd3bcd4995fffd55d5d9c5bc340?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/4638528/philippe"}, "edited": false, "score": 0, "creation_date": 1426087117, "post_id": 28990314, "comment_id": 46229238, "body": "@Philippe you don&#39;t need the <code>Application.ScreenUpdating = true</code> at the end because when the Sub reaches <code>End Sub</code> it will automatically flip it back to <code>true</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1426087298, "post_id": 28990314, "comment_id": 46229370, "body": "It&#39;s probably slow because it is activating the worksheet and updating the cell every time there&#39;s any <b>change</b> in the textbox.  This means that every time you type a character, the code runs.  Every time you delete a character, the code runs.  I would recommend having this code be on a different event (or a button), removing the <code>Application.ScreenUpdating = False</code> line, and instead of activating the sheet, just use: <code>ThisWorkbook.Sheets(&quot;Donn&#233;es Enregistr&#233;es&quot;).Range(&quot;A2&quot;).Value = Num_Article_Info_Generale.Text</code>"}, {"owner": {"reputation": 64, "user_id": 4638528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81a2cd3bcd4995fffd55d5d9c5bc340?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/4638528/philippe"}, "edited": false, "score": 0, "creation_date": 1426087357, "post_id": 28990314, "comment_id": 46229413, "body": "@MichalKrzych : okay, well i have always used it. and it didn&#39;t got worst by doing it :), thanks for pointing that out anyway."}, {"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426178686, "post_id": 28990314, "comment_id": 46275771, "body": "I thank you for your answer...very friendly to help me. Now It&#39;s working, Thank you so much ;)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "edited": false, "score": 0, "creation_date": 1426334585, "post_id": 28990833, "comment_id": 46335569, "body": "Dear,I still cannot because my reputation is too low (("}], "tags": [], "owner": {"reputation": 61, "user_id": 3683754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1821737a7bba8bd3065cf83913013ea8?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh.S", "link": "https://stackoverflow.com/users/3683754/rajesh-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1426087913, "creation_date": 1426087913, "answer_id": 28990833, "question_id": 28990314, "link": "https://stackoverflow.com/questions/28990314/insert-numbers-from-vba-to-excel/28990833#28990833", "title": "Insert numbers from VBA to Excel", "body": "<p>Better use :</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Donn\u00e9es Enregistr\u00e9es\").Range(\"A2\").Value = Num_Article_Info_Generale.Text\n</code></pre>\n\n<p>Instead of :</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Donn\u00e9es Enregistr\u00e9es\").Activate\n\nRange(\"A$2\").Value = Num_Article_Info_Generale.Text\n</code></pre>\n\n<p>Use a button at the end of your application instead of tracking \"change\" on TextBox</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  ThisWorkbook.Sheets(\"Donn\u00e9es Enregistr\u00e9es\").Range(\"A2\").Value = Num_Article_Info_Generale.Text\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4647774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/aa1eac1a5de6d3bb4473a08dac69999c?s=128&d=identicon&r=PG&f=1", "display_name": "Affolter", "link": "https://stackoverflow.com/users/4647774/affolter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 28990833, "answer_count": 1, "score": -1, "last_activity_date": 1426087913, "creation_date": 1426086613, "last_edit_date": 1426086924, "question_id": 28990314, "link": "https://stackoverflow.com/questions/28990314/insert-numbers-from-vba-to-excel", "title": "Insert numbers from VBA to Excel", "body": "<p>When I'm writing in VBA some numbers:</p>\n\n<p><img src=\"https://i.stack.imgur.com/rFF85.jpg\" alt=\"enter image description here\"></p>\n\n<p>I want that it insert in Excel cell:</p>\n\n<p><img src=\"https://i.stack.imgur.com/xY2NA.jpg\" alt=\"enter image description here\"></p>\n\n<p>This is my code but it is not working correctly, takes much more time.</p>\n\n<pre><code>Private Sub Num_Article_Info_Generale_Change()\n    Application.ScreenUpdating = False\n\n    ThisWorkbook.Worksheets(\"Donn\u00e9es Enregistr\u00e9es\").Activate\n\n    Range(\"A$2\").Value = Num_Article_Info_Generale.Text\nEnd Sub\n</code></pre>\n\n<p>Any solution or different way?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 188, "user_id": 3684671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3205b96f7b388c7f1301a4a0c3e35f1f?s=128&d=identicon&r=PG&f=1", "display_name": "Kory", "link": "https://stackoverflow.com/users/3684671/kory"}, "edited": false, "score": 2, "creation_date": 1426086976, "post_id": 28990296, "comment_id": 46229141, "body": "Why don&#39;t you use the SUMIF spreadsheet function?"}, {"owner": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "reply_to_user": {"reputation": 188, "user_id": 3684671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3205b96f7b388c7f1301a4a0c3e35f1f?s=128&d=identicon&r=PG&f=1", "display_name": "Kory", "link": "https://stackoverflow.com/users/3684671/kory"}, "edited": false, "score": 0, "creation_date": 1426087313, "post_id": 28990296, "comment_id": 46229384, "body": "Do you mean something like: &quot;=SUMIFS(A:A;B:B;B3)&quot; ? I would like to integrate it in macro, because its just a part from longer code"}], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "edited": false, "score": 0, "creation_date": 1426088221, "post_id": 28990515, "comment_id": 46230056, "body": "Thanks! In case i need to add some other conditions (to get kind of =SUMIFS), how to integrate it in this code?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "edited": false, "score": 0, "creation_date": 1426088439, "post_id": 28990515, "comment_id": 46230205, "body": "It would be using SUMIFS and then similar range syntax for each range/condition pair."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 4, "last_activity_date": 1426088394, "last_edit_date": 1426088394, "creation_date": 1426087148, "answer_id": 28990515, "question_id": 28990296, "link": "https://stackoverflow.com/questions/28990296/how-to-sum-values-in-variable-range-in-vba/28990515#28990515", "title": "How to sum values in variable range in VBA?", "body": "<p>Here's one way:</p>\n\n<pre><code>Sub example()\n    Dim ws                    As Worksheet\n    Dim LastRow               As Long\n\n    Set ws = ActiveWorkbook.Sheets(\"Sheet2\")\n\n    LastRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\n    With ws.Range(\"C3:C\" &amp; LastRow)\n        .ClearContents\n        .Value = ws.Evaluate(\"INDEX(SUMIF(B3:B\" &amp; LastRow &amp; \",B3:B\" &amp; LastRow &amp; \",A3:A\" &amp; LastRow &amp; \"),)\")\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7293, "favorite_count": 1, "accepted_answer_id": 28990515, "answer_count": 1, "score": 2, "last_activity_date": 1426088394, "creation_date": 1426086568, "question_id": 28990296, "link": "https://stackoverflow.com/questions/28990296/how-to-sum-values-in-variable-range-in-vba", "title": "How to sum values in variable range in VBA?", "body": "<p>I have a table as shown below. </p>\n\n<p>In column C I would like to Sum values from column A if they have the same index (column B). I would like to put sum result for all the rows if they have same index (as shown in column D). </p>\n\n<p>Unfortunately the range of values with same index is variable and my macro can sum values just with 2 indexes. Can anyone help with it, please? Thanks!</p>\n\n<p><img src=\"https://i.stack.imgur.com/nlysI.jpg\" alt=\"enter image description here\"></p>\n\n<pre><code>Sub example()\nDim ws As Worksheet\nDim LastRow As Long\nDim n, i As Integer\nSet ws = ActiveWorkbook.Sheets(\"Sheet2\")\n\nws.Select\n\nLastRow = Sheets(\"Sheet2\").Range(\"A\" &amp; Sheets(\"Sheet2\").Rows.Count).End(xlUp).Row\n\nRange(\"C3:C\" &amp; LastRow).Select\nSelection.ClearContents\n\nFor i = 3 To LastRow\nIf Range(\"B\" &amp; i + 1) - Range(\"B\" &amp; i) = 0 Then\nRange(\"C\" &amp; i) = Range(\"A\" &amp; i + 1) + Range(\"A\" &amp; i)\nElse\nRange(\"C\" &amp; i) = Range(\"C\" &amp; i - 1)\nEnd If\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-addins", "hyperion", "essbase", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4364820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pwUhdBZsPJk/AAAAAAAAAAI/AAAAAAACchw/5w5J57tQgmU/photo.jpg?sz=128", "display_name": "kh2030", "link": "https://stackoverflow.com/users/4364820/kh2030"}, "is_accepted": false, "score": 1, "last_activity_date": 1426183773, "creation_date": 1426183773, "answer_id": 29017218, "question_id": 28990280, "link": "https://stackoverflow.com/questions/28990280/how-to-get-hyperion-smart-view-for-office-version-add-in/29017218#29017218", "title": "How to get Hyperion Smart View For Office Version add-in?", "body": "<p><a href=\"http://docs.oracle.com/cd/E40248_01/epm.1112/smart_view_developer.pdf\" rel=\"nofollow\">The Smart View for Office Developer's Guide</a> explains the use of HypGetVersion() on Page 44.  It will, among other things, return the version.</p>\n"}], "owner": {"reputation": 11, "user_id": 2554099, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/6iucx.png?s=128&g=1", "display_name": "messinese90", "link": "https://stackoverflow.com/users/2554099/messinese90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426184169, "creation_date": 1426086544, "last_edit_date": 1531161705, "question_id": 28990280, "link": "https://stackoverflow.com/questions/28990280/how-to-get-hyperion-smart-view-for-office-version-add-in", "title": "How to get Hyperion Smart View For Office Version add-in?", "body": "<p>Can you get the version of Hyperion SmartView installed using visual basic code for excel ?</p>\n\n<p>I need to get a string output with the version number or something that looks like this -> 11.1.2.2.000</p>\n\n<p>regards</p>\n"}, {"tags": ["vba", "vbscript"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1426084336, "post_id": 28989351, "comment_id": 46227155, "body": "Nope, that&#39;s what <code>InputBox()</code> does."}, {"owner": {"reputation": 69, "user_id": 1769982, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2733ee3317358e56a232ed69533b2efa?s=128&d=identicon&r=PG", "display_name": "Hun", "link": "https://stackoverflow.com/users/1769982/hun"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1426084700, "post_id": 28989351, "comment_id": 46227409, "body": "the issue with my code is it is selecting automatically"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 1, "creation_date": 1426084742, "post_id": 28989351, "comment_id": 46227439, "body": "Yes, if you give the InputBox some default text, its always displayed selected."}, {"owner": {"reputation": 69, "user_id": 1769982, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2733ee3317358e56a232ed69533b2efa?s=128&d=identicon&r=PG", "display_name": "Hun", "link": "https://stackoverflow.com/users/1769982/hun"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1426085005, "post_id": 28989351, "comment_id": 46227627, "body": "is there any way not to select by default... please..."}, {"owner": {"reputation": 1399, "user_id": 4584335, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Q8zHtvjpvi4/AAAAAAAAAAI/AAAAAAAADEo/Mb1fVAnabIE/photo.jpg?sz=128", "display_name": "Rubik", "link": "https://stackoverflow.com/users/4584335/rubik"}, "edited": false, "score": 0, "creation_date": 1426085540, "post_id": 28989351, "comment_id": 46228060, "body": "If you don&#39;t want the default text to be selected, do your own &quot;InputBox&quot; ;-)"}, {"owner": {"reputation": 69, "user_id": 1769982, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2733ee3317358e56a232ed69533b2efa?s=128&d=identicon&r=PG", "display_name": "Hun", "link": "https://stackoverflow.com/users/1769982/hun"}, "edited": false, "score": 0, "creation_date": 1426086040, "post_id": 28989351, "comment_id": 46228423, "body": "The prefix value should be shown in the inputbox..."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 2, "creation_date": 1426086138, "post_id": 28989351, "comment_id": 46228502, "body": "No, You cannot do that with InputBox()"}], "answers": [{"tags": [], "owner": {"reputation": 492, "user_id": 3226989, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BCvQM.jpg?s=128&g=1", "display_name": "Rafiki", "link": "https://stackoverflow.com/users/3226989/rafiki"}, "is_accepted": false, "score": 1, "last_activity_date": 1426088207, "creation_date": 1426088207, "answer_id": 28990968, "question_id": 28989351, "link": "https://stackoverflow.com/questions/28989351/vbscript-inputbox-unselect-the-text/28990968#28990968", "title": "Vbscript Inputbox unselect the text", "body": "<p>To summarize comments: \nInputBox is a very limited function, and doesn't have any possibility regarding the way it is selecting the default value.\nso you need to press the right arrow before typing.\nNo other way around!</p>\n\n<p>if you want nicer things, as @Rubik suggested, you can generate a proper InputBox with another language, you would be able to manage it. But that's a lot of work (rewrite your code!) for a minor disagreement!</p>\n"}, {"tags": [], "owner": {"reputation": 303, "user_id": 4615693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2e0587b4fcc5c12de197cd0bcb9b73a?s=128&d=identicon&r=PG", "display_name": "Bagger", "link": "https://stackoverflow.com/users/4615693/bagger"}, "is_accepted": false, "score": 1, "last_activity_date": 1426171501, "creation_date": 1426171501, "answer_id": 29012831, "question_id": 28989351, "link": "https://stackoverflow.com/questions/28989351/vbscript-inputbox-unselect-the-text/29012831#29012831", "title": "Vbscript Inputbox unselect the text", "body": "<p>What are you trying to do?</p>\n\n<p>A user can take Wind out of the box and it will not be returned.  If you want to make sure a user entered text the return value can be tested  for \"\" or Wind.</p>\n\n<p>if you want the \" displayed\nchr(34) &amp; \"Wind\" &amp; chr(34)</p>\n\n<p>If you just want to prefix everything with Wind I would do that after the text was retuned </p>\n"}], "owner": {"reputation": 69, "user_id": 1769982, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2733ee3317358e56a232ed69533b2efa?s=128&d=identicon&r=PG", "display_name": "Hun", "link": "https://stackoverflow.com/users/1769982/hun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1426171501, "creation_date": 1426084246, "question_id": 28989351, "link": "https://stackoverflow.com/questions/28989351/vbscript-inputbox-unselect-the-text", "title": "Vbscript Inputbox unselect the text", "body": "<p>Below code works perfect but the inputbox show\u2019s text as \"Wind\" with auto selecting in the inputbox.\nIs there any option to show without selecting... I mean the cursor should be last character of \"Wind\"</p>\n\n<p>mycode...</p>\n\n<pre><code>    Dim Prefex\n    Prefex = \"Wind\"\n\n   sNewComputerName = InputBox (\"enter data here\", \"Computer Name\", Prefex , 30,30)\n    If sNewComputerName = \"\" then\n\n    End If\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 3112698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b52b3315435e01838c71a2d93a3e2cf5?s=128&d=identicon&r=PG&f=1", "display_name": "tang_s", "link": "https://stackoverflow.com/users/3112698/tang-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1426087167, "last_edit_date": 1426087167, "creation_date": 1426085387, "answer_id": 28989817, "question_id": 28989190, "link": "https://stackoverflow.com/questions/28989190/dynamically-create-mergefields-access-to-word/28989817#28989817", "title": "Dynamically create mergefields (Access to Word)", "body": "<p>Never mind, I was able to get it to work after a bit more tweaking. Here's the final code for anyone else:</p>\n\n<pre><code>Do While .Execute\n            Selection.MoveDown Unit:=wdLine, count:=1\n            Selection.Paragraphs.Indent\n\n            For Each fieldName In mergeFields\n                If fieldName &lt;&gt; \"\" Then\n                    Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, PreserveFormatting:=False\n                    Selection.TypeText Text:=mergeFields(I)\n                    Selection.MoveRight Unit:=wdCharacter, count:=2\n                    Selection.TypeParagraph\n                    I = I + 1\n                    End If\n            Next\n        Loop\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 3112698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b52b3315435e01838c71a2d93a3e2cf5?s=128&d=identicon&r=PG&f=1", "display_name": "tang_s", "link": "https://stackoverflow.com/users/3112698/tang-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 28989817, "answer_count": 1, "score": 0, "last_activity_date": 1426256337, "creation_date": 1426083782, "last_edit_date": 1426256337, "question_id": 28989190, "link": "https://stackoverflow.com/questions/28989190/dynamically-create-mergefields-access-to-word", "title": "Dynamically create mergefields (Access to Word)", "body": "<p>Is there anyway I can set the text of a field in Word Document using VBA from an array value?</p>\n\n<pre><code>Do While .Execute\n        Selection.MoveDown Unit:=wdLine, count:=1\n        Selection.Paragraphs.Indent\n\n        For I = 0 To mergeFields.GetUpperBound(0)\n            Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, PreserveFormatting:=False\n            Selection.TypeText Text:=\"MERGEFIELD M_1\"\n            Selection.MoveRight Unit:=wdCharacter, count:=2\n            Selection.TypeParagraph\n        Next \n</code></pre>\n\n<p>In the place of \"MERGEFIELD M_1\", I would like to populate that text from an array called \"mergeFields\", which has similarly named strings. The reason for this is because that array is dynamically set in a separate function, so I may need to create 5 new fields or up to 20 new fields. </p>\n\n<p>So my idea is as followed:</p>\n\n<pre><code>            Selection.TypeText Text:= mergeField(I)\n            Selection.MoveRight Unit:=wdCharacter, count:=2\n            Selection.TypeParagraph\n</code></pre>\n\n<p>Is something like this possible?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426084838, "post_id": 28989151, "comment_id": 46227510, "body": "Either Shift+Click the application X or use the Exit button, which you can add to the Ribbon or QAT."}, {"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 0, "creation_date": 1426085250, "post_id": 28989151, "comment_id": 46227815, "body": "How are you closing? Are you closing the workbook or using <code>Application.Quit</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 4657027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3de13cb3dfdd7f96db0c3423591cd0?s=128&d=identicon&r=PG&f=1", "display_name": "Swapnil Wankhede", "link": "https://stackoverflow.com/users/4657027/swapnil-wankhede"}, "is_accepted": false, "score": 1, "last_activity_date": 1426137236, "creation_date": 1426137236, "answer_id": 29002327, "question_id": 28989151, "link": "https://stackoverflow.com/questions/28989151/how-to-avoid-grey-screen-when-i-close-excel/29002327#29002327", "title": "How to avoid grey screen when I close excel?", "body": "<p>You can write the event in Thisworkbook</p>\n\n<p>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Application.Visible = False</p>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1583, "user_id": 3503032, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/1176862391/picture?type=large", "display_name": "Max Segal", "link": "https://stackoverflow.com/users/3503032/max-segal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1437, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426137236, "creation_date": 1426083636, "last_edit_date": 1531161705, "question_id": 28989151, "link": "https://stackoverflow.com/questions/28989151/how-to-avoid-grey-screen-when-i-close-excel", "title": "How to avoid grey screen when I close excel?", "body": "<p>I use an addin that once opened opens other workbooks ( *.xlsm files) with some macros. These workbooks are hidden and contribute their macros only.\nWhen I close excel what I see is that grey screen which indicates there is still a hidden workbook open. \nHow to avoid that and make excel close all hidden workbooks automatically like it happens with PERSONAL.xlsb macrobook? </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["forms", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "edited": false, "score": 0, "creation_date": 1426096314, "post_id": 28989638, "comment_id": 46235811, "body": "Awesome thanks. I think hiding the form will work best for me for now.    The query idea is great - I didn&#39;t think of that but it definitely make sense to create the queries with the filter built in.    Creating records with the selected Company ID should just be as easy as filtering based on the item selected in the combo box?"}, {"owner": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "edited": false, "score": 0, "creation_date": 1426188933, "post_id": 28989638, "comment_id": 46281354, "body": "I&#39;m having some issues using the combo box on the hidden form to save records back into the table when creating new ones. They need to be associated to the company selected at first.  If it&#39;s any help I&#39;ve been using this to reference the company combo box in queries to filter: &#39;[Forms]![frmHome]![SelectedComp]&#39;"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "edited": false, "score": 0, "creation_date": 1426192349, "post_id": 28989638, "comment_id": 46283098, "body": "I think the simplest idea is to set the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff837160.aspx\" rel=\"nofollow noreferrer\">default value</a> of a hidden control bound to the company ID field, to your expression -- <code>=[Forms]![frmHome]![SelectedComp]</code>. If that doesn&#39;t work, then I suggest asking it as a new question, with more detail."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "edited": false, "score": 0, "creation_date": 1426231414, "post_id": 28989638, "comment_id": 46295514, "body": "If this has answered the qeustion, please accept it, at least until another better/more comprehensive answer comes along. If this answer is useful, then please upvote."}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": true, "score": 0, "last_activity_date": 1426084967, "creation_date": 1426084967, "answer_id": 28989638, "question_id": 28989096, "link": "https://stackoverflow.com/questions/28989096/global-selection-of-company-before-interacting-with-any-other-forms/28989638#28989638", "title": "Global selection of Company before interacting with any other forms", "body": "<p>When the user enters the program, the first form they should see should be the company chooser form. Then the user can continue on to the other forms, which would all be filtered based on the user's initial selection.</p>\n\n<p>You can either have the form write to a module-level variable, and all the forms would be filtered by the value of a function which would return the company ID to filter by.</p>\n\n<p>It may be easier for you to simply hide the form, and filter all the successive forms by the value in the combo box of the hidden form.</p>\n\n<p>You might also want to consider creating a query for each table, which contains only the filtered values per company (either with a function, or by the value of the hidden form) and basing all your forms/reports on those queries. That way you won't accidentally forget to include the filter in a form/report.</p>\n"}], "owner": {"reputation": 49, "user_id": 2630997, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/331101256/picture?type=large", "display_name": "icouper", "link": "https://stackoverflow.com/users/2630997/icouper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 28989638, "answer_count": 1, "score": 0, "last_activity_date": 1426084967, "creation_date": 1426083482, "question_id": 28989096, "link": "https://stackoverflow.com/questions/28989096/global-selection-of-company-before-interacting-with-any-other-forms", "title": "Global selection of Company before interacting with any other forms", "body": "<p>I'm working on the design of a database for a client and they would like to work with one of their companies (customers) at a time throughout the entire session. </p>\n\n<p>Ideally I would like to set up the forms so that they select the company to work with first and then can navigate to various other forms to manage the different aspects of that company (locations, departments, employees, etc.). There will obviously be many companies in the database, so I would need to ensure that they only see records for the selected company and adding new values ties them to the selected company.</p>\n\n<p>I've been doing some searching around for how best to accomplish this but I've had no real luck.</p>\n\n<p>Any guidance you can give would be awesome.</p>\n\n<p>PS. I've got the structure of the database tables setup to ensure that any entity that is company-specific has a foreign key that identifies the company.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 1, "creation_date": 1426083075, "post_id": 28988842, "comment_id": 46226179, "body": "Try this: <a href=\"http://stackoverflow.com/questions/7618121/excel-vba-change-color-of-certain-characters-in-a-cell\" title=\"excel vba change color of certain characters in a cell\">stackoverflow.com/questions/7618121/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/7759962/excel-change-font-color-for-specific-char-in-a-cell-range\" title=\"excel change font color for specific char in a cell range\">stackoverflow.com/questions/7759962/&hellip;</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1426083356, "post_id": 28988842, "comment_id": 46226390, "body": "If there&#39;s a formula in the cell, no."}, {"owner": {"reputation": 101, "user_id": 4559733, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e0d3125e830402b6f6801e32ac08dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "Doppia L", "link": "https://stackoverflow.com/users/4559733/doppia-l"}, "edited": false, "score": 0, "creation_date": 1426084577, "post_id": 28988842, "comment_id": 46227321, "body": "Ok, let&#39;s suppose I don&#39;t have the formula inside the cell."}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 3938912, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/oJF4i.jpg?s=128&g=1", "display_name": "Ygor Yansz", "link": "https://stackoverflow.com/users/3938912/ygor-yansz"}, "is_accepted": false, "score": 2, "last_activity_date": 1426086607, "last_edit_date": 1426086607, "creation_date": 1426086151, "answer_id": 28990146, "question_id": 28988842, "link": "https://stackoverflow.com/questions/28988842/vba-excel-different-colors-for-different-numbers-in-the-same-cell/28990146#28990146", "title": "VBA Excel - different colors for different numbers in the same cell", "body": "<p>Here is what you need, all you have to do is swap the Range(\"A3\") with the one you have =]</p>\n\n<pre><code>Sub Color_Part_of_Cell()\n\nDim cont1       As Integer\nDim cont2       As Integer\n\ncont1 = WorksheetFunction.Search(\"%\", Range(\"A3\"))\n\ncont2 = Len(Mid(Range(\"A3\"), WorksheetFunction.Search(\"-\", Range(\"A3\"), 1), _\n            WorksheetFunction.Search(\"%\", Range(\"A3\"), _\n            WorksheetFunction.Search(\"-\", Range(\"A3\"), 1)))) - cont1 - 2\n\nWith Range(\"A3\")\n.Characters(1, cont1).Font.Color = RGB(0, 0, 255)\n.Characters(cont1 + 3, cont2).Font.Color = RGB(0, 255, 0)\n.Characters(cont1 + cont2 + 6, 10).Font.Bold = true\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4559733, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e0d3125e830402b6f6801e32ac08dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "Doppia L", "link": "https://stackoverflow.com/users/4559733/doppia-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1426086607, "creation_date": 1426082888, "last_edit_date": 1531164843, "question_id": 28988842, "link": "https://stackoverflow.com/questions/28988842/vba-excel-different-colors-for-different-numbers-in-the-same-cell", "title": "VBA Excel - different colors for different numbers in the same cell", "body": "<p>That's a tricky one: I got 3 different numbers extracted by three different formulas in the same cell (as the image below).</p>\n\n<p><img src=\"https://i.stack.imgur.com/cVDii.jpg\" alt=\"enter image description here\"></p>\n\n<p>Is there a way to color those numbers with different styles (i.e. first blue, second green, third bold)?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "rows"], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1426083115, "creation_date": 1426083115, "answer_id": 28988949, "question_id": 28988741, "link": "https://stackoverflow.com/questions/28988741/delete-rows-based-on-cell-color-excel-vba/28988949#28988949", "title": "Delete rows based on cell color excel vba", "body": "<p>You should loop backwards when deleting rows.</p>\n\n<pre><code> For i = lastRow to 2 Step -1 'Step --1 tells VBA to loop in reverse\n'MsgBox (Cells(i, 1) &amp; \" \" &amp; Cells(i, 1).Interior.ColorIndex)\n    If Worksheets(\"Export Worksheet\").Cells(i, 1).Interior.ColorIndex &lt;&gt; \"4\" Then\n       'MsgBox (\"Row \" &amp; i &amp; \" will be deleted\")\n       Rows(i).EntireRow.Delete\n       'MsgBox (\"i is currently \" &amp; i)\n       i = i + 1\n    'MsgBox (\"i is now \" &amp; i)\n    End If\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 9509, "user_id": 1547174, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02984f9cba31484b86a9acab0bbbb919?s=128&d=identicon&r=PG", "display_name": "Trung Tran", "link": "https://stackoverflow.com/users/1547174/trung-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3407, "favorite_count": 0, "accepted_answer_id": 28988949, "answer_count": 1, "score": 0, "last_activity_date": 1426083115, "creation_date": 1426082677, "question_id": 28988741, "link": "https://stackoverflow.com/questions/28988741/delete-rows-based-on-cell-color-excel-vba", "title": "Delete rows based on cell color excel vba", "body": "<p>I am trying to delete rows based on cell color. The issue I run into is the code I wrote keeps \"skipping rows\":</p>\n\n<pre><code> For i = 2 To lastRow\n'MsgBox (Cells(i, 1) &amp; \" \" &amp; Cells(i, 1).Interior.ColorIndex)\n    If Worksheets(\"Export Worksheet\").Cells(i, 1).Interior.ColorIndex &lt;&gt; \"4\" Then\n       'MsgBox (\"Row \" &amp; i &amp; \" will be deleted\")\n       Rows(i).EntireRow.Delete\n       'MsgBox (\"i is currently \" &amp; i)\n       i = i + 1\n    'MsgBox (\"i is now \" &amp; i)\n    End If\n\nNext i\n</code></pre>\n\n<p>Can someone help? Thanks!!</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1426081766, "post_id": 28988123, "comment_id": 46225074, "body": "We can&#39;t help you without seeing your code."}, {"owner": {"reputation": 535, "user_id": 1512511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6NhzcRYaFFs/AAAAAAAAAAI/AAAAAAAAG3Q/YopWGsaq7Dg/photo.jpg?sz=128", "display_name": "Evis", "link": "https://stackoverflow.com/users/1512511/evis"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1426170607, "post_id": 28988123, "comment_id": 46269914, "body": "Hi RubberDuck, it&#180;s about the same as in the link, but I will post it as I implemented. Thanks!"}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1426171100, "post_id": 28988123, "comment_id": 46270291, "body": "What line does the debugger highlight when the error is thrown?"}, {"owner": {"reputation": 535, "user_id": 1512511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6NhzcRYaFFs/AAAAAAAAAAI/AAAAAAAAG3Q/YopWGsaq7Dg/photo.jpg?sz=128", "display_name": "Evis", "link": "https://stackoverflow.com/users/1512511/evis"}, "edited": false, "score": 0, "creation_date": 1426179645, "post_id": 28988123, "comment_id": 46276341, "body": "Hi Degustaf, the error higthlight at the first line after declaration on BASE64SHA1 function &gt;&gt;&gt; Set asc = CreateObject(&quot;System.Text.UTF8Encoding&quot;). Thanks for checking this out."}, {"owner": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1426191606, "post_id": 28988123, "comment_id": 46282708, "body": "@JohnGreen Sounds like that user has a missing/corrupted dll. According to MSDN, that class should be part of mscorlib.dll"}, {"owner": {"reputation": 535, "user_id": 1512511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6NhzcRYaFFs/AAAAAAAAAAI/AAAAAAAAG3Q/YopWGsaq7Dg/photo.jpg?sz=128", "display_name": "Evis", "link": "https://stackoverflow.com/users/1512511/evis"}, "reply_to_user": {"reputation": 2595, "user_id": 3897316, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6cf468fea626f3aec65a199e2f67b309?s=128&d=identicon&r=PG&f=1", "display_name": "Degustaf", "link": "https://stackoverflow.com/users/3897316/degustaf"}, "edited": false, "score": 0, "creation_date": 1426257701, "post_id": 28988123, "comment_id": 46310903, "body": "Hi @Degustaf thank you very much for the time to look at it. Any idea how do we fix it? bg"}], "answers": [{"tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": true, "score": 0, "last_activity_date": 1534246941, "creation_date": 1534246941, "answer_id": 51840593, "question_id": 28988123, "link": "https://stackoverflow.com/questions/28988123/error-in-hash-implementation-in-vba-runtime-error-2146232576-80131700/51840593#51840593", "title": "Error in Hash Implementation in VBA - Runtime Error -2146232576 (80131700)", "body": "<p>There is an identical error number discussed and the problem solved on a post in MSDN (<a href=\"https://social.msdn.microsoft.com/Forums/en-US/9bfcd001-5168-4cff-b2ba-6b8e8d465138/excel-2010-vb-runtime-error-2146232576-80131700-automation-error-on\" rel=\"nofollow noreferrer\">Excel 2010 VB Run-time Error '-2146232576 (80131700)' Automation Error on CreateObject(\"System.Collections.ArrayList\") ???</a>). </p>\n\n<p>The problem there was solved by installing Microsoft .NET Framework 2.0 SP2 (which automatically also installed 3.5).</p>\n"}, {"tags": [], "owner": {"reputation": 1756, "user_id": 1008588, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ijUnZ.jpg?s=128&g=1", "display_name": "Nicolaesse", "link": "https://stackoverflow.com/users/1008588/nicolaesse"}, "is_accepted": false, "score": 2, "last_activity_date": 1541763033, "creation_date": 1541763033, "answer_id": 53224921, "question_id": 28988123, "link": "https://stackoverflow.com/questions/28988123/error-in-hash-implementation-in-vba-runtime-error-2146232576-80131700/53224921#53224921", "title": "Error in Hash Implementation in VBA - Runtime Error -2146232576 (80131700)", "body": "<p>The error</p>\n\n<blockquote>\n  <p>Runtime Error -2146232576 (80131700)</p>\n</blockquote>\n\n<p>on <code>CreateObject</code> in a VBA macro is probably due to the lack of a .NET2 framework, as suggested by ZygD.\nI am answering to introduce a way to check if this is the problem.</p>\n\n<p>You should follow thhese steps:</p>\n\n<ol>\n<li>Open Windows => Run (or hit <kbd>Windows</kbd> + <kbd>R</kbd>)</li>\n<li>Type \"CMD\"</li>\n<li>Push <kbd>Run</kbd></li>\n<li>Paste the following register query to check what are the versions of the Framework .NET installed on your PC: <code>reg query \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\"</code></li>\n</ol>\n\n<p>You will get something like</p>\n\n<blockquote>\n  <p>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\CDF\n  HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4\n  HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4.0</p>\n</blockquote>\n\n<p>The istruction CreateObject require a .NET2 version wich means that even if you have the v4.0, you will need NET Framework v3.5 in addition.\nYou can follow <a href=\"https://docs.microsoft.com/it-it/dotnet/framework/install/dotnet-35-windows-10\" rel=\"nofollow noreferrer\">this tutorial</a> to install it.</p>\n\n<p>Now, if you follow the same steps listed above you should get</p>\n\n<blockquote>\n  <p>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\CDF\n  HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v3.5\n  HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4\n  HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4.0</p>\n</blockquote>\n\n<p>At this point, if you open Microsoft Excel and you hit <kbd>Alt</kbd> + <kbd>F11</kbd> and run the macro this should work.</p>\n"}], "owner": {"reputation": 535, "user_id": 1512511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6NhzcRYaFFs/AAAAAAAAAAI/AAAAAAAAG3Q/YopWGsaq7Dg/photo.jpg?sz=128", "display_name": "Evis", "link": "https://stackoverflow.com/users/1512511/evis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2564, "favorite_count": 1, "accepted_answer_id": 51840593, "answer_count": 2, "score": 3, "last_activity_date": 1541763033, "creation_date": 1426081104, "last_edit_date": 1531161705, "question_id": 28988123, "link": "https://stackoverflow.com/questions/28988123/error-in-hash-implementation-in-vba-runtime-error-2146232576-80131700", "title": "Error in Hash Implementation in VBA - Runtime Error -2146232576 (80131700)", "body": "<p>I have implemented the hash method as suggested on the post:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/8246340/does-vba-have-a-hash-hmac/10068932#10068932\">Does VBA has a Hash_HMAC</a></p>\n\n<p>This is my implementation:</p>\n\n<pre><code>Public Function BASE64SHA1(ByVal sTextToHash As String)\n    Dim asc As Object\n    Dim enc As Object\n    Dim TextToHash() As Byte\n    Dim SharedSecretKey() As Byte\n    Dim bytes() As Byte\n\n    Set asc = CreateObject(\"System.Text.UTF8Encoding\")\n    Set enc = CreateObject(\"System.Security.Cryptography.HMACSHA1\")\n\n    TextToHash = asc.GetBytes_4(sTextToHash)\n    SharedSecretKey = asc.GetBytes_4(sTextToHash)\n    enc.Key = SharedSecretKey\n\n    bytes = enc.ComputeHash_2((TextToHash))\n    BASE64SHA1 = EncodeBase64(bytes)\n\n    Set asc = Nothing\n    Set enc = Nothing\n\nEnd Function\n\nPrivate Function EncodeBase64(ByRef arrData() As Byte) As String\n\n    Dim objXML As Object\n    Dim objNode As Object\n    Set objXML = CreateObject(\"MSXML2.DOMDocument\")\n    Set objNode = objXML.createElement(\"b64\")\n\n    objNode.DataType = \"bin.base64\"\n    objNode.nodeTypedValue = arrData\n    EncodeBase64 = objNode.TEXT\n\n    Set objNode = Nothing\n    Set objXML = Nothing\n\nEnd Function\n</code></pre>\n\n<p>Everything was working great, running under <code>excel 2013</code> (Portuguese), windows 8.1 (Portuguese) and windows 7. </p>\n\n<p>Although, when I start using other computer which uses the same Excel 2013 (Portuguese) but the windows 8.1 (English Version), not sure why and if this is the reason, but it came up with the error and the debugger highlight at the first line in BASE64SHA1 function, after variables declaration:</p>\n\n<p><em><code>Set asc = CreateObject(\"System.Text.UTF8Encoding\")</code></em></p>\n\n<p>Error:</p>\n\n<blockquote>\n  <p>Runtime Error -2146232576 (80131700)</p>\n</blockquote>\n\n<p>I checked the error messages and came with the details below:</p>\n\n<blockquote>\n  <p>err.Source - VBAProject<br>\n  err.HelpContext -  1000440<br>\n  err.HelpFile - C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VBA\\VBA7.1\\1046\\VbLR6.chm<br>\n  err.LastDllError - 0  </p>\n</blockquote>\n\n<p>Did anyone get the same issue? or could help on that? Looks like I am missing a Reference or something... but I declared as Object and it worked fine in other PC\u00b4s... help! =(</p>\n\n<p>Thanks very much!</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 1561, "user_id": 179, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZqopD.jpg?s=128&g=1", "display_name": "Isaac Moses", "link": "https://stackoverflow.com/users/179/isaac-moses"}, "is_accepted": true, "score": 0, "last_activity_date": 1426093043, "creation_date": 1426093043, "answer_id": 28992751, "question_id": 28988113, "link": "https://stackoverflow.com/questions/28988113/comparing-ranges-and-copying/28992751#28992751", "title": "Comparing Ranges and Copying", "body": "<p>You have three <code>For</code> loops:</p>\n\n<ol>\n<li><p><code>For Each greenjob In Range(\"A4:A31\")</code></p></li>\n<li><p><code>For j = 4 To 31</code></p></li>\n<li><p><code>For i = 4 To 10</code></p></li>\n</ol>\n\n<p>Loop 1 goes through all of the rows on Worksheet One and identifies ones that need to be copied, so Loop 2 going through all of those rows again each time Loop 1 catches one doesn't make sense.</p>\n\n<p>Instead, just use the Job Number from the row identified in Loop 1 and compare it to the Job Numbers on Worksheet 1 using Loop 3.</p>\n\n<p>So, remove <code>For j = 4 To 31</code> and <code>Next j</code>, and replace</p>\n\n<pre><code>If jobID.Cells(j, 1).Value = jobID2.Cells(i, 1).Value Then\n</code></pre>\n\n<p>with </p>\n\n<pre><code>If greenjob.Value = jobID2.Cells(i, 1).Value Then\n</code></pre>\n\n<p>since <code>greenjob</code> is, conveniently, the cell in column A that contains the job number.</p>\n"}], "owner": {"reputation": 39, "user_id": 4159092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3de716be2e39d4d8b823390851dc4601?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hughes", "link": "https://stackoverflow.com/users/4159092/jason-hughes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 28992751, "answer_count": 1, "score": 1, "last_activity_date": 1426093043, "creation_date": 1426081053, "last_edit_date": 1426085770, "question_id": 28988113, "link": "https://stackoverflow.com/questions/28988113/comparing-ranges-and-copying", "title": "Comparing Ranges and Copying", "body": "<p>I have been creating a small project that will allow a user to import and export data from work worksheet to another. I will attach screenshots to try and explain what i am trying to achieve.\nI have the import section of my program working without fault and i can import all jobs that are of colour \"Red\" from my second worksheet. However once the row has been changed to colour \"Green\" in worksheet 1 it will then be exported back to sheet 2 and in turn will change the once \"Red\" job to \"Green\" effecting no other rows in sheet 2.</p>\n\n<p>I have tried to implement the code as best as i could however i keep getting errors when comparing the my unique cell in both ranges.</p>\n\n<p>As of just now when i run the code it will copy over the value 10 times and paste over all data from row \"A4\" to row \"A14\"</p>\n\n<p>Worksheet One\n<img src=\"https://i.imgur.com/q7KNsev.png\" alt=\"\"></p>\n\n<p>Worksheet Two\n<img src=\"https://i.imgur.com/0vQbVkp.png\" alt=\"\"></p>\n\n<pre><code>Sub Button3_Click()\n\n'@Author - Jason Hughes(AlmightyThud)\n'@Version - 1.0\n'@Date - 0/03/2015\n'@Description - To Export all Completed Jobs to the \"Daily Work Orders\" Spreadsheet\n'Once exported it will scan for the unique job number in the list and override the existing values\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\n'Declare initial variables for this button'\nDim copyComplete As Boolean\ncopyComplete = False\nDim lR As Long\n'----------------------------------'\n'#When this code is uncommented it will delete all values in column A#'\n\nDim jobID As Range\nDim jobID2 As Range\nSet jobID = Sheets(\"Daily Screen Update\").Range(\"A4:A31\")\nSet jobID2 = Sheets(\"Daily Work Orders\").Range(\"A4:A10000\")\n\n\n'----------------------------------'\n\n'Activate the sheet you will be looping through'\nThisWorkbook.Sheets(\"Daily Screen Update\").Activate\n\n'Simple loop that will loop through all cells to check if the cell is green'\n'If the cell is green then the loop will copy the cell, once copied the loop will check'\n'the \"Daily Work Orders\" Sheet for a job ID with a similar ID and paste over it'\nFor Each greenjob In Range(\"A4:A31\")\n    If greenjob.Cells.EntireRow.Interior.Color = RGB(146, 208, 80) Then\n        greenjob.Cells.EntireRow.Copy\n        For j = 4 To 31\n            For i = 4 To 10\n                If jobID.Cells(j, 1).Value = jobID2.Cells(i, 1).Value Then\n                    Sheets(\"Daily Work Orders\").Range(\"A\" &amp; j).PasteSpecial xlPasteAll\n                    copyComplete = True\n                End If\n            Next i\n        Next j\n    End If\nNext\n\n'Make a check to ensure that the data has been copied\nIf copyComplete = True Then\n    MsgBox (\"All completed jobs have been have been added to Daily Work Orders\")\nElseIf copyComplete = False Then\n    MsgBox (\"Nothing has been added to Daily Work Orders\")\nEnd If\n\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 2161432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/95d599e9bcd6c937757d9cd66781a413?s=128&d=identicon&r=PG", "display_name": "M.Ford", "link": "https://stackoverflow.com/users/2161432/m-ford"}, "edited": false, "score": 0, "creation_date": 1426083438, "post_id": 28988822, "comment_id": 46226454, "body": "This is the type of help I was looking for. Thank you. I will figure out something from here."}], "tags": [], "owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "is_accepted": true, "score": 0, "last_activity_date": 1426082846, "creation_date": 1426082846, "answer_id": 28988822, "question_id": 28988010, "link": "https://stackoverflow.com/questions/28988010/excel-set-cell-value-on-workbook-open/28988822#28988822", "title": "Excel set cell value on workbook open", "body": "<p>From reading the link I have included below, it would appeear that you cannot pass command line parameters to excel directly, however, you can use vb script which accepts parameters and then the vb script opens excel and inserts the parameter value</p>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/6124691b-a5ce-4fc0-a648-e85b4a32f77a/excel-vba-to-read-command-line-parameters-and-copy-in-a-cell?forum=exceldev\" rel=\"nofollow\">Link to post on MSD</a></p>\n"}], "owner": {"reputation": 139, "user_id": 2161432, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/95d599e9bcd6c937757d9cd66781a413?s=128&d=identicon&r=PG", "display_name": "M.Ford", "link": "https://stackoverflow.com/users/2161432/m-ford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1502, "favorite_count": 0, "accepted_answer_id": 28988822, "answer_count": 1, "score": 2, "last_activity_date": 1426082846, "creation_date": 1426080819, "last_edit_date": 1531161705, "question_id": 28988010, "link": "https://stackoverflow.com/questions/28988010/excel-set-cell-value-on-workbook-open", "title": "Excel set cell value on workbook open", "body": "<p>This is a good theory discussion. I have a VBA heavy workbook that pulls information from a database for a specific item. Let's pretend that that item is a sales invoice. The way the workbook works now is that there is a cell in which you put a invoice number then click a refresh button and all the information for that invoice is pulled and munged in the workbook.</p>\n\n<p>Is there a way that, from a command line sorta thing, set the cell with the invoice number to a value then execute the refresh when the workbook is opened? I know that I can fire the refresh macro when the workbook open via VBA, the real question is can I set a cell value to something from outside Excel. The goal is to provide a hyperlink I build that when a user clicks it, the cell value is set then the data refreshed. I am not sure where to look for this answer.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1426083000, "creation_date": 1426083000, "answer_id": 28988899, "question_id": 28987997, "link": "https://stackoverflow.com/questions/28987997/macro-not-copying-rows-correctly/28988899#28988899", "title": "Macro not copying rows correctly.", "body": "<p>Does the <code>OFFSET</code> method serve your need? <code>OFFSET</code> returns a <code>Range</code> object relative to another <code>Range</code> object using the syntax <code>.OFFSET(rowOffset, columnOffset)</code>. For example, <code>Range(\"A1\").Offset(1,2)</code> returns cell <code>C2</code> (1 row below, and 2 columns to the right).</p>\n\n<p>In your case, it seems that <code>InColB</code> is the Range that needs to be offset. Since you only need to <code>Offset</code> columns, the syntax would be something like <code>InColB.Offset(,4)</code></p>\n\n<p>Does this help?</p>\n"}], "owner": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 28988899, "answer_count": 1, "score": 0, "last_activity_date": 1426083000, "creation_date": 1426080795, "last_edit_date": 1426082402, "question_id": 28987997, "link": "https://stackoverflow.com/questions/28987997/macro-not-copying-rows-correctly", "title": "Macro not copying rows correctly.", "body": "<p>The purpose of this macro is to copy certain information from a log and create a purchase order from it. The code itself works, however I can't get it to copy the right information. Each log can have many different lines of data, so the code sifts through that and finds certain keywords and then is supposed to take information from that column, but could be 1-11 rows away. That is where I am running into a problem.</p>\n\n<p>I need this to find the keyword and then depending on what information needs extracted go over x number of rows and take that number and put it into the PO at a certain spot. I am currently using xlToRight, but i just can't seem to figure out how to use it properly. </p>\n\n<p>You can see that each section is laid out, I know that there is probably a better way to write the code out, but I am not too concerned about that.</p>\n\n<p>Any help would be greatly appreciated! Thanks!</p>\n\n<pre><code>Sub Extract_job_info()\n\nDim Title As String\nDim Param As String\nDim Message As String\nDim defaultRef As String\nDim Sht As Worksheet, shtJob As Worksheet\nDim POSheet As Worksheet\nDim CreatePO As Integer\nDim InRowB As Long\nDim InColB As Range\n\nSet POSheet = Sheets(\"Request for PO Template\")\n\n'set message details\nTitle = \"Job Number\"\nMessage = \"Please enter the job number you would like to extract information from.\"\ndefaultRef = \"Enter job number here\"\n\nParam = InputBox(Message, Title, defaultRef)\n\n'find sheet\nFor Each Sht In ThisWorkbook.Worksheets\n    If UCase(Sht.Name) = UCase(Param) Then\n        Set shtJob = Sht\n        Exit For\n    End If\nNext Sht\n\n'If job does not exist\nIf shtJob Is Nothing Then\n    MsgBox (\"Sheet for '\" &amp; Param &amp; \"' was not found !\")\nElse\n    If MsgBox(\"Would you like to extract job number '\" &amp; _\n       Param &amp; \"' to make a PO?\", vbYesNo, \"Confirm\") = vbYes Then\n\n        InRowB = 2 'for testing\n\n\n        'search for travel hours total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n\n            POSheet.Range(\"F30\").Value = InColB.End(xlToRight).Value\n\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCriticalInColB.End(xlToRight).Value\n        End If 'found \"travel hours total\"\n        'search for travel hours amount\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Grand Total\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"B30\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"travel hours amount\"\n\n\n\n\n        'search for Regular Hours total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"F31\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"regular hours total\"\n        'search for regular hours total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Grand Total\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"B31\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"regular hours amount\"\n\n\n\n\n\n        'search for OT hours total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"F32\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"OT total\"\n        'search for OT hours amount\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Grand Total\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"B32\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"OT amount\"\n\n\n\n        'search for Engineering hours total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"F33\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"Engineering hours total\"\n        'search for Engineering hours amount\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Grand Total\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"B33\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"Engineering amount\"\n\n\n\n\n        'search for Engineering OT total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"F34\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"Engineering OT total\"\n        'search for Engineering OT amount\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Grand Total\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"B34\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"Engineering OT amount\"\n\n\n\n        'search for Milage total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"F36\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"Milage total\"\n        'search for milage amount\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Grand Total\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"B34\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"milage amount\"\n\n\n\n\n\n\n        'search for Travel &amp; Lodging  total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"F35\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"Travel &amp; Lodging hours total\"\n        'search for Travel &amp; Lodging amount\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Grand Total\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"B35\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"Travel &amp; Lodging amount\"\n\n\n\n\n        'search for Milage total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"F36\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"Milage total\"\n        'search for milage amount\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Grand Total\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"B37\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"milage amount\"\n\n\n\n\n        'search for Parts total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"F38\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"parts total\"\n        'search for parts amount\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Grand Total\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"B38\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"milage amount\"\n\n\n\n\n        'search for Freight total\n        Set InColB = Sht.Columns(InRowB).Find(What:=\"Cost\", _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n        SearchDirection:=xlNext, MatchCase:=False)\n\n        If Not InColB Is Nothing Then\n            POSheet.Range(\"F42\").Value = InColB.End(xlToRight).Value\n        Else\n            MsgBox \"'Cost' cell not found!\", vbCritical\n        End If 'found \"Freight total\"\n\n\n     End If 'user confirmed extract\n\nEnd If 'got sheet\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "conditional-formatting", "vba"], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 3938912, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/oJF4i.jpg?s=128&g=1", "display_name": "Ygor Yansz", "link": "https://stackoverflow.com/users/3938912/ygor-yansz"}, "is_accepted": true, "score": 0, "last_activity_date": 1426082424, "last_edit_date": 1426082424, "creation_date": 1426081746, "answer_id": 28988370, "question_id": 28987868, "link": "https://stackoverflow.com/questions/28987868/excel-2013-vba-macro-needed-for-highlighting-with-multiple-conditionals/28988370#28988370", "title": "Excel 2013 VBA Macro Needed for Highlighting with Multiple Conditionals", "body": "<p>You have two options one is to use conditional formatting it's easier but takes more time in my opinion </p>\n\n<p>You can also use private methods to change the cells format when their values changes, to do so you need to create a code inside the worksheet on the VBA, select the worksheet you want to use the code with on the list on the left top  select \"View Code\" that's where you must write the code</p>\n\n<p>But be carefull since you're handling with errors such as \"#N/A\" because if you do things such as </p>\n\n<p><code>If Range(\"C2\").value = \"#N/A\" then</code> ...</p>\n\n<p>it won't work, because \"#N/A\" is not the cell value it's a error indicator, so you must use something like this:</p>\n\n<p><code>If worksheetfunciton.IfError(Range(\"C2\"),\"Error\") = \"Error\" then</code> ...</p>\n\n<p>In this example if the cells on the determined range has their values changed the coe will display a message telling you that this cell has changed, all you have to do is change the range according to your desire and change the line: <code>MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"</code> for your conditions, this should work, one method to higlight the cell can be the <code>cells().Interior.ColorIndex = \"color number\"</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n\n    ' The variable KeyCells contains the cells that will\n    ' cause an alert when they are changed.\n    Set KeyCells = Range(\"A1:C10\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n           Is Nothing Then\n\n        ' Display a message when one of the designated cells has been \n        ' changed.\n        ' Place your code here.\n        MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4658319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e283c7bcb31b3947d098667ea27983fb?s=128&d=identicon&r=PG&f=1", "display_name": "JenC", "link": "https://stackoverflow.com/users/4658319/jenc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 28988370, "answer_count": 1, "score": 0, "last_activity_date": 1426082424, "creation_date": 1426080445, "last_edit_date": 1531161705, "question_id": 28987868, "link": "https://stackoverflow.com/questions/28987868/excel-2013-vba-macro-needed-for-highlighting-with-multiple-conditionals", "title": "Excel 2013 VBA Macro Needed for Highlighting with Multiple Conditionals", "body": "<p>I need help writing an Excel macro that does quite a few things. My contribution was the macro to get the data into this format, but I'm stuck on highlighting, and don't even have the slightest idea how to proceed. Sorry this is super long, and thanks a bunch in advance! :D</p>\n\n<p>The problem I'm having is that if there are duplicate names in column A, I need the total of all of the totals in column D for that end user to be used to find the highlighting color. </p>\n\n<p>The only ones receiving the highlighting will say \"#N/A\" in column E. If there are multiple companies but one doesn't say \"#N/A\" in Column E, then only the ones that say \"#N/A\" would be included in the highlighting/adding of totals\u2026</p>\n\n<ol>\n<li><p>If column A has more than one of the same company name, AND the totals in Column D for all of the same company add up to be greater than 0, AND the Order Number in Column C for ALL of the same company begins with a \"5\" (I have been using =LEFT($C1,1)+0=5), AND Column E = \"#N/A\", THEN highlight A:E in yellow.  </p></li>\n<li><p>If Column A has more than one of the same company name, AND the totals in Column D for all of the same company add up to be greater than 0, BUT not all Order Numbers in Column C begin with a \"5,\" AND Column E = \"#N/A\", THEN the cells for A:E for the Order number with a \"5\" are blue (Color 15773696), AND the cells for A:E for the Order Numbers not beginning with a \"5\" are red.</p></li>\n<li><p>If Column A has more than one of the same company name, AND the totals in Column D for all of the same company add up to be 0, AND Column E = \"#N/A\", THEN highlight cells A:E in red.</p></li>\n<li><p>If Column A has more than one of the same company name, AND the totals in Column D for all of the same company add up to be &lt; 0, AND Column E = \"#N/A\", THEN highlight cells A:E for all company lines in orange (Color 49407).</p></li>\n<li><p>If Column A has only one company name, AND the Order Number in Column C begins with a \"5,\" AND the total in Column D is > 0, AND Column E = \"#N/A\", THEN highlight cells A:E for the company name in blue (Color 15773696).</p></li>\n<li><p>If Column A has only one company name, AND the total in Column D is &lt; 0, AND Column E = \"#N/A\", THEN highlight cells A:E for the company name in orange (Color 49407).</p></li>\n<li><p>If Column A has only one company name, AND the Order Number in Column C does not begin with a \"5,\" AND the total in Column D is >= 0, THEN highlight cells A:E for the company name in red. </p></li>\n<li><p>If the line is blue, insert the text \"Booking DER?\" into Column F. </p></li>\n</ol>\n\n<p>Thanks soooooo much for your help! :) I would post an example picture, but it won't let me... </p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426760695, "post_id": 28987692, "comment_id": 46507506, "body": "You could just ask the user to please not click cancel. Perhaps using a <code>MsgBox</code> or <code>Application.Statusbar</code>."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4657027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3de13cb3dfdd7f96db0c3423591cd0?s=128&d=identicon&r=PG&f=1", "display_name": "Swapnil Wankhede", "link": "https://stackoverflow.com/users/4657027/swapnil-wankhede"}, "edited": false, "score": 0, "creation_date": 1426081228, "post_id": 28988026, "comment_id": 46224670, "body": "Thanks vockz , to saw this question. Yes i agree with you on screenudapting = false but , my question is how it will not show  in excel 2003, and screenupdating =false and Application.DisplayAlerts = False  both are different . I have no problem if the user will see after workbook open.."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 25, "user_id": 4657027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3de13cb3dfdd7f96db0c3423591cd0?s=128&d=identicon&r=PG&f=1", "display_name": "Swapnil Wankhede", "link": "https://stackoverflow.com/users/4657027/swapnil-wankhede"}, "edited": false, "score": 0, "creation_date": 1426082402, "post_id": 28988026, "comment_id": 46225629, "body": "I&#39;m afraid I do not know why it shows a loading box for excel 2010, but not in excel 2003. Putting screen updating off when opening the workbook and back on once it&#39;s opened will solve your issue, but with regards to why, I&#39;m afraid I cannot answer :). Maybe somebody else knows!"}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1426080860, "creation_date": 1426080860, "answer_id": 28988026, "question_id": 28987692, "link": "https://stackoverflow.com/questions/28987692/application-displayalerts-false-does-not-work/28988026#28988026", "title": "Application.DisplayAlerts = False does not work", "body": "<p>It sounds like you want to turn screen updating off, preventing the user from seeing that a workbook is currently being opened?</p>\n\n<p>You can use <code>Application.ScreenUpdating = False</code> to turn off screen updating. Remember to use <code>Application.ScreenUpdating = True</code> to turn screen updating back on.</p>\n"}], "owner": {"reputation": 25, "user_id": 4657027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3de13cb3dfdd7f96db0c3423591cd0?s=128&d=identicon&r=PG&f=1", "display_name": "Swapnil Wankhede", "link": "https://stackoverflow.com/users/4657027/swapnil-wankhede"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4434, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1426080860, "creation_date": 1426079942, "last_edit_date": 1426080855, "question_id": 28987692, "link": "https://stackoverflow.com/questions/28987692/application-displayalerts-false-does-not-work", "title": "Application.DisplayAlerts = False does not work", "body": "<p>I have one macro that open many excel macro workbooks. Before open the workbook\ni have Add the codes</p>\n\n<pre><code>Application.DisplayAlerts = False \nApplication.EnableEvents = False\n</code></pre>\n\n<p>The code is perfectly work in excel 2003 but when the same macro will run in excel 2010 it shows An 'xyz workbook opening form this path(it showing path)' it shows with window that have cancel Button , so sometimes many team members click on that cancel button that cause an error.</p>\n\n<p>Please help to sort out this issue.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426080772, "post_id": 28987649, "comment_id": 46224344, "body": "I get &quot;copy range of method failed&quot; error when I try it that way."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426081232, "post_id": 28987649, "comment_id": 46224673, "body": "Not possible - there is no <code>Copy</code> method in that code."}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426081755, "post_id": 28987649, "comment_id": 46225062, "body": "Ah! Gotcha! I left the copy in. Thanks for the clarification, that fixed it!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1426079816, "creation_date": 1426079816, "answer_id": 28987649, "question_id": 28987548, "link": "https://stackoverflow.com/questions/28987548/paste-special-in-vba-code-not-working/28987649#28987649", "title": "Paste Special in VBA code not working", "body": "<p>You can't use <code>PasteSpecial</code> with the destination parameter of the <code>Copy</code> method - you have to use separate operations, but as you're only copying individual cells, you can just assign the values:</p>\n\n<pre><code>shtDest.Range(\"B\" &amp; currentRow).Value2 = cell2.Value2\nshtDest.Range(\"C\" &amp; currentRow).Value2 = cell2.Offset(0, 1).Value2\nshtDest.Range(\"G\" &amp; currentRow).Value2 = cell2.Offset(0, 2).Value2\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1147, "favorite_count": 0, "accepted_answer_id": 28987649, "answer_count": 1, "score": 2, "last_activity_date": 1426080167, "creation_date": 1426079545, "last_edit_date": 1426080167, "question_id": 28987548, "link": "https://stackoverflow.com/questions/28987548/paste-special-in-vba-code-not-working", "title": "Paste Special in VBA code not working", "body": "<p>I have been reading and trying code, but it still will not work. Can someone tell me what I am doing wrong? My excel file has formulas on one tab, I am trying to copy and paste special onto another tab but everything I try is pasting the formula and not the text output I need.  </p>\n\n<pre><code>Dim rowCount2 As Long, shtSrc As Worksheet\nDim shtDest As Worksheet\nDim rng2 As Range\nDim currentRow As Long\n\nSet shtSrc = Sheets(\"Data\")\nSet shtDest = Sheets(\"Audit\")\n\nrowCount2 = shtSrc.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nSet rng2 = shtSrc.Range(\"A1:A\" &amp; rowCount2)\n\ncurrentRow = 1\n\nFor Each cell2 In rng2.Cells\n    If cell2.Value &lt;&gt; \"\" Then\n          cell2.Copy shtDest.Range(\"B\" &amp; currentRow).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n          cell2.Offset(0, 1).Copy (\"C\" &amp; currentRow)\n          cell2.Offset(0, 2).Copy (\"G\" &amp; currentRow)\n        currentRow = currentRow + 1\n\n    End If\nNext cell2\n</code></pre>\n"}, {"tags": ["excel", "vba", "syntax", "formula"], "comments": [{"owner": {"reputation": 4016, "user_id": 540247, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e0b122709fd9aa64da3adb9c2ebb26d3?s=128&d=identicon&r=PG", "display_name": "DKSan", "link": "https://stackoverflow.com/users/540247/dksan"}, "edited": false, "score": 1, "creation_date": 1426078880, "post_id": 28986940, "comment_id": 46222990, "body": "What kind of text are your trying to process? Please give an example. Is it always in the same format?"}, {"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 1, "creation_date": 1426079016, "post_id": 28986940, "comment_id": 46223078, "body": "Try using the record Macro button it will quickly give you the syntax depending on your current cell. It is within the developer tab"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1426079171, "post_id": 28986940, "comment_id": 46223178, "body": "It&#39;s more or less the same except you&#39;ll need the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">Range.Find method</a>."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1426079183, "creation_date": 1426079183, "answer_id": 28987406, "question_id": 28986940, "link": "https://stackoverflow.com/questions/28986940/what-is-the-syntax-for-following-excel-function-in-vba/28987406#28987406", "title": "what is the syntax for following excel function in vba", "body": "<p>Just double-up on the double quotes:</p>\n\n<pre><code>Sub Sarah()\n    MsgBox Evaluate(\"CONCATENATE(MID(A3,FIND(\"\" ::\"\",A3)+3,LEN(A3)-8-FIND(\"\" ::\"\",A3)-5),RIGHT(A6,LEN(A6)-8))\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "is_accepted": false, "score": 0, "last_activity_date": 1426079622, "creation_date": 1426079622, "answer_id": 28987580, "question_id": 28986940, "link": "https://stackoverflow.com/questions/28986940/what-is-the-syntax-for-following-excel-function-in-vba/28987580#28987580", "title": "what is the syntax for following excel function in vba", "body": "<p>I'd probably do it this way, but the answer from Gary's Student should work as well.</p>\n\n<pre><code>Sub StackTest()\nDim Result As String\nDim Yoursheet As Worksheet\nDim FirstString As String\nDim SecondString As String\n\n'yoursheet = **enter your worksheet here, then uncomment the line**\nFirstString = Yoursheet.Range(\"A3\").Text\nSecondString = Yoursheet.Range(\"A6\").Text\n\nResult = Mid(FirstString, InStr(FirstString, \" ::\") + 3, Len(FirstString) - 8 - _\n    InStr(FirstString, \" ::\") - 5) &amp; Right(SecondString, Len(SecondString) - 8)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4557817, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qMApAgEP06Y/AAAAAAAAAAI/AAAAAAAAAAA/_4pUfx6919E/photo.jpg?sz=128", "display_name": "Sarath", "link": "https://stackoverflow.com/users/4557817/sarath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1426079622, "creation_date": 1426077830, "last_edit_date": 1426078385, "question_id": 28986940, "link": "https://stackoverflow.com/questions/28986940/what-is-the-syntax-for-following-excel-function-in-vba", "title": "what is the syntax for following excel function in vba", "body": "<pre><code>=CONCATENATE(MID(A3,FIND(\" ::\",A3)+3,LEN(A3)-8-FIND(\" ::\",A3)-5),RIGHT(A6,LEN(A6)-8))\n</code></pre>\n\n<p>whats the syntax for this in vba? Would be grateful if anyone point me in right direction.</p>\n"}, {"tags": ["ms-access", "vba", "subform"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5061187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d56048e6d16cae4676004077b0fd81b5?s=128&d=identicon&r=PG&f=1", "display_name": "MooneyA", "link": "https://stackoverflow.com/users/5061187/mooneya"}, "is_accepted": false, "score": 0, "last_activity_date": 1435585889, "creation_date": 1435585889, "answer_id": 31117470, "question_id": 28986932, "link": "https://stackoverflow.com/questions/28986932/how-to-get-total-in-subform-access-datasheet-view/31117470#31117470", "title": "How to get Total in subform Access Datasheet View", "body": "<p>It sounds like you want to show the total at the bottom of the datasheet itself. In this case, the functionality you want is built in. In the home tab of the ribbon, there is a button labeled \"Totals\" which displays a totals bar beneath the new record at the very bottom of your datasheet in datasheet view.</p>\n"}], "owner": {"reputation": 55, "user_id": 1576941, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/08d7c631d89a12b8616649a713feb0da?s=128&d=identicon&r=PG", "display_name": "NOOR MOHAMED", "link": "https://stackoverflow.com/users/1576941/noor-mohamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644222, "creation_date": 1426077812, "last_edit_date": 1594644222, "question_id": 28986932, "link": "https://stackoverflow.com/questions/28986932/how-to-get-total-in-subform-access-datasheet-view", "title": "How to get Total in subform Access Datasheet View", "body": "<p>Currently I'm working on subform in Access. I need to get the total hours spend. I have tried using =SUM([Hours]) but still not getting the total hours in Datasheet View.</p>\n\n<p>The output the expected is as below:-</p>\n\n<ul>\n<li><p>Application      Hours</p></li>\n<li><p>A              2   </p></li>\n<li>B              2</li>\n<li>C              2</li>\n<li><p>D              2</p>\n\n<p>Total             8     </p></li>\n</ul>\n"}, {"tags": ["vba", "ms-publisher"], "comments": [{"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1429941457, "post_id": 28986809, "comment_id": 47848853, "body": "I think your question is about ms-publisher instead of publisher tag, And I want to know that your VBA code is running in ms-publisher ?"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4658398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JD5GMLy78YU/AAAAAAAAAAI/AAAAAAAAACU/iUzsfC3Y-PY/photo.jpg?sz=128", "display_name": "M.Baroni", "link": "https://stackoverflow.com/users/4658398/m-baroni"}, "is_accepted": true, "score": 1, "last_activity_date": 1429941548, "last_edit_date": 1429941548, "creation_date": 1426586693, "answer_id": 29096236, "question_id": 28986809, "link": "https://stackoverflow.com/questions/28986809/vba-and-publisher-replacing-text-in-a-master-page/29096236#29096236", "title": "VBA and Publisher - replacing text in a master page", "body": "<p>Here's a working macro for anyone with the same problems</p>\n\n<pre><code>Private WithEvents PubApp As Publisher.Application\n\nPrivate Sub Document_Open()\n Set PubApp = Publisher.Application\nEnd Sub\n\nPrivate Sub PubApp_WindowPageChange(ByVal Vw As View)\n\n  Dim mp As MasterPages\n  Set mp = ActiveDocument.MasterPages\n\n  With mp.Item(1)\n   .Shapes(19).TextFrame.TextRange.Text = \"\"\n   .Shapes(19).TextFrame.TextRange.InsertPageNumber\n   .Shapes(19).TextFrame.TextRange.InsertBefore _\n            NewText:=\"Page \"\n    If ActiveDocument.Pages.Count &gt; 9 Then\n        .Shapes(19).TextFrame.TextRange.InsertAfter _\n            NewText:=\" of \" &amp; _\n            ActiveDocument.Pages.Count\n    Else\n        .Shapes(19).TextFrame.TextRange.InsertAfter _\n            NewText:=\" of 0\" &amp; _\n            ActiveDocument.Pages.Count\n    End If\n  End With\n\nEnd Sub\n</code></pre>\n\n<p><code>X</code> In <code>mp.Item(X)</code> identifies your master page (in case you have more than one).</p>\n\n<p><code>Y</code> in <code>Shapes(Y)</code> identifies the target text box.</p>\n\n<p>The macro runs in background without the need of active input and refreshes the content of the target text box on every page change.</p>\n\n<p>Since the automatic page numbering format used in the document is \"<code>01, 02, 03 ... 11, 12 13</code>\" I included an If selection to add a <code>0</code> before the total page count if said number is lower than <code>10</code>.</p>\n\n<p>I'm sure there are more elegant ways of solving this problems, but hey, at least it works.  </p>\n"}, {"tags": [], "owner": {"reputation": 225, "user_id": 800322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/83c6073eb13af141eda5de9af0ce8800?s=128&d=identicon&r=PG", "display_name": "Mickey D", "link": "https://stackoverflow.com/users/800322/mickey-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1514488744, "last_edit_date": 1514488744, "creation_date": 1514487680, "answer_id": 48012936, "question_id": 28986809, "link": "https://stackoverflow.com/questions/28986809/vba-and-publisher-replacing-text-in-a-master-page/48012936#48012936", "title": "VBA and Publisher - replacing text in a master page", "body": "<p>Here is a clarification for anyone else trying to research the limited information on programmatically changing the header or footer in the master pages using VBA in Publisher. This tip also includes a clarification of how to Add Text To the Left,Center,Right portions of the header:</p>\n\n<p>All the credit goes to <a href=\"https://stackoverflow.com/users/4658398/m-baroni\"><strong>M.Baroni</strong></a></p>\n\n<pre><code>Function FixHeader1()\n  Dim mp As MasterPages\n  Set mp = ActiveDocument.MasterPages\n  With mp.Item(1)\n   .Header.TextRange.text = \"My Publication\" &amp; vbTab\n   .Header.TextRange.InsertPageNumber\n   .Header.TextRange.InsertAfter NewText:=vbTab &amp; MonthName(Month(Date)) &amp; \" \" &amp; Year(Date)\n  End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4658398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JD5GMLy78YU/AAAAAAAAAAI/AAAAAAAAACU/iUzsfC3Y-PY/photo.jpg?sz=128", "display_name": "M.Baroni", "link": "https://stackoverflow.com/users/4658398/m-baroni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1327, "favorite_count": 1, "accepted_answer_id": 29096236, "answer_count": 2, "score": 0, "last_activity_date": 1514488744, "creation_date": 1426077414, "last_edit_date": 1429941094, "question_id": 28986809, "link": "https://stackoverflow.com/questions/28986809/vba-and-publisher-replacing-text-in-a-master-page", "title": "VBA and Publisher - replacing text in a master page", "body": "<p>Recently I have been struggling with publisher at work, and the most recent source of concern is the software inability to give something a simple as an auto-updating \"total pages\" count.</p>\n\n<p>I decided to look into macros for a solution, but with my limited knowledge of VBA I only managed to get so fat before hitting a roadblock.</p>\n\n<p>I want to create a macro that automatically starts when the document is opened and as frequently as possible updates a textbox in the master page. \nThe textbox should show \"page X of Y\", but due to publisher limitations only the \"X\" is automatically updated without using a macro.</p>\n\n<p>What I have right now:</p>\n\n<pre><code>Private WithEvents PubApp As Publisher.Application\n\nPrivate Sub Document_Open()\n Set PubApp = Publisher.Application\nEnd Sub\n\nPrivate Sub PubApp_WindowPageChange(ByVal Vw As View)\n MsgBox \"Your publication contains \" &amp; _\n ActiveDocument.Pages.Count &amp; \" page(s).\"\nEnd Sub\n</code></pre>\n\n<p>The macro automatically starts when the document is opened and creates a popup with the total page number every time the user changes page.</p>\n\n<p>So, I accomplished the first half of my goal, but I need some help with the rest.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1426077729, "post_id": 28986751, "comment_id": 46222181, "body": "Help us to help you - <b>Post your current code.</b>"}, {"owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "edited": false, "score": 1, "creation_date": 1426080204, "post_id": 28986751, "comment_id": 46223955, "body": "That looks like a form control. Do you know how to find the name of the dropdown?"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1426080367, "post_id": 28986751, "comment_id": 46224057, "body": "@Gary&#39;sStudent: Current code is there in the post."}, {"owner": {"reputation": 3, "user_id": 4658371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3ecbe96e4e52e4cb3fc16bf543e4e2e?s=128&d=identicon&r=PG&f=1", "display_name": "RobbieDJ", "link": "https://stackoverflow.com/users/4658371/robbiedj"}, "edited": false, "score": 0, "creation_date": 1426080686, "post_id": 28986751, "comment_id": 46224283, "body": "Yes, it is a form control. It is called Drop Down 11. Any ideas on how to set the value to USD?"}, {"owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "edited": false, "score": 0, "creation_date": 1426080766, "post_id": 28986751, "comment_id": 46224339, "body": "What is the cell link for this control? Is it <code>D1</code>?"}, {"owner": {"reputation": 3, "user_id": 4658371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3ecbe96e4e52e4cb3fc16bf543e4e2e?s=128&d=identicon&r=PG&f=1", "display_name": "RobbieDJ", "link": "https://stackoverflow.com/users/4658371/robbiedj"}, "edited": false, "score": 0, "creation_date": 1426080988, "post_id": 28986751, "comment_id": 46224509, "body": "Yes, the control in located in Cell <code>D1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4658371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3ecbe96e4e52e4cb3fc16bf543e4e2e?s=128&d=identicon&r=PG&f=1", "display_name": "RobbieDJ", "link": "https://stackoverflow.com/users/4658371/robbiedj"}, "edited": false, "score": 0, "creation_date": 1426081344, "post_id": 28988057, "comment_id": 46224751, "body": "Ah yes, you are correct! The form control was actually linked to <code>=$E$109</code> so I just changed the code to  <code>Range(&quot;E109&quot;).Value = &quot;1&quot; </code>  USD is the first Index in the list. Thank you so much for your help! Saved me a lot of further head scratching!"}], "tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": true, "score": 0, "last_activity_date": 1426080931, "creation_date": 1426080931, "answer_id": 28988057, "question_id": 28986751, "link": "https://stackoverflow.com/questions/28986751/excel-macro-to-change-control-drop-down-option/28988057#28988057", "title": "Excel Macro to change control drop down option", "body": "<p>Looks like you are changing the linked cell's value. However, the linked cell stores <em>index</em> (i.e. 1, 2, 3), not the <em>value</em>.</p>\n\n<p>Try changing the index instead:</p>\n\n<pre><code>Range(\"D1\").Value = 1\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4658371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3ecbe96e4e52e4cb3fc16bf543e4e2e?s=128&d=identicon&r=PG&f=1", "display_name": "RobbieDJ", "link": "https://stackoverflow.com/users/4658371/robbiedj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1526, "favorite_count": 0, "accepted_answer_id": 28988057, "answer_count": 1, "score": 0, "last_activity_date": 1426080931, "creation_date": 1426077271, "last_edit_date": 1426080313, "question_id": 28986751, "link": "https://stackoverflow.com/questions/28986751/excel-macro-to-change-control-drop-down-option", "title": "Excel Macro to change control drop down option", "body": "<p>I want to reset the value of this drop down menu to \"USD\" when I run a macro. However, as this is not a normal down down box, the following script will not work:</p>\n\n<pre><code>'Reset Currency to USD  (DOES NOT WORK)\nRange(\"D1\").Value = \"USD\"\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/sXUKc.png\" alt=\"\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "edited": false, "score": 0, "creation_date": 1426082523, "post_id": 28987167, "comment_id": 46225735, "body": "Not a problem. To help future users searching for similar answers, please mark the question as answered."}, {"owner": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "edited": false, "score": 0, "creation_date": 1427633575, "post_id": 28987167, "comment_id": 46848248, "body": "Is it possible to sort the whole table (if not sorted) by sorting column 1? Taking into consideration that there are blank cells in this column"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1426078533, "creation_date": 1426078533, "answer_id": 28987167, "question_id": 28986726, "link": "https://stackoverflow.com/questions/28986726/return-corresponding-value/28987167#28987167", "title": "Return corresponding value", "body": "<p>Use the code below as a reference to establish which cell is actually the bottom cell for the range of values. Let me know if you need help using it.</p>\n\n<pre><code>Sub DoTheThang()\n    Dim TopCell As Range\n    Dim BottomCell As Range\n    Dim SearchString As String\n    Dim rngUsed As Range\n\n    SearchString = \"EEE\"\n\n    Set TopCell = Range(\"A:A\").Find(SearchString, Cells(1, 1))\n    Set BottomCell = TopCell\n    Set rngUsed = Sheet1.UsedRange\n\n    Do While BottomCell.Offset(1).Value = \"\" And Not Intersect(BottomCell, rngUsed) Is Nothing\n        Set BottomCell = BottomCell.Offset(1)\n    Loop\n\n    MsgBox TopCell.Address\n    MsgBox BottomCell.Address\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 28987167, "answer_count": 1, "score": 0, "last_activity_date": 1426078533, "creation_date": 1426077184, "last_edit_date": 1531164843, "question_id": 28986726, "link": "https://stackoverflow.com/questions/28986726/return-corresponding-value", "title": "Return corresponding value", "body": "<p>I have a 2 columns range as the first image shows, and a userform with a 2 column listbox, a textbox and a commandbutton.</p>\n\n<p><img src=\"https://i.stack.imgur.com/11K3U.jpg\" alt=\"image1\"></p>\n\n<p>Is there a code so that if I enter a value in the textbox, then the code search my range until it found this value and return the corresponding value from the other column AND ALL THE FOLLOWING VALUES TILL IT COMES TO THE FIRST NON BLANK CELL IN THE FIRST COLUMN.</p>\n\n<p>For example, If I enter \"DDD\" in the textbox, the first column in the listbox will show \"DDD\" and the second one will show 444, 555and 666 respectively.</p>\n\n<p>This is the code I'm using, but when I enter \"AAA\" in the textbox, .end(xldown) goes to \"DDD\" and not \"BBB\". Is there a way to solve this ??</p>\n\n<p>Thank u in advance.</p>\n\n<pre><code>Dim SearchTerm As String\nDim topCell As Range, BottomCell As Range\n\nSearchTerm = TextBox1.Text\n\nWith Sheet1.Range(\"A:A\")\n    Set topCell = .Find(SearchTerm, after:=.Cells(Rows.Count, 1), LookIn:=xlValues, lookat:=xlWhole, searchdirection:=xlNext, MatchCase:=False)\n\n    If topCell Is Nothing Then\n        MsgBox SearchTerm &amp; \" not found.\"\n    Else\n        Set BottomCell = Range(topCell.End(xlDown).Offset(-1, 0), .Cells(Rows.Count, 2).End(xlUp)).Cells(1, 2)\n\n        With ListBox1\n            .Clear\n            .List = Range(topCell, BottomCell).Value\n        End With\n    End If\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "dynamic", "copy"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1426077409, "creation_date": 1426077409, "answer_id": 28986807, "question_id": 28986421, "link": "https://stackoverflow.com/questions/28986421/excel-vba-copy-paste-column-from-multiple-sheets-to-one-sheet-in-different-colum/28986807#28986807", "title": "Excel VBA copy/paste column from multiple sheets to one sheet in different Columns", "body": "<p>This should do want you need:</p>\n\n<pre><code>Sub marine()\n    Sheets.Add after:=Sheets(Sheets.Count)\n    ActiveSheet.Name = \"compilation\"\n    For i = 1 To Sheets.Count - 1\n        Sheets(i).Range(\"D:D\").Copy Cells(1, 6 + i)\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4658271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123f483513e044108e9f1d10cdc71a9b?s=128&d=identicon&r=PG&f=1", "display_name": "RP de koning", "link": "https://stackoverflow.com/users/4658271/rp-de-koning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1316, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426082934, "creation_date": 1426076271, "last_edit_date": 1426076708, "question_id": 28986421, "link": "https://stackoverflow.com/questions/28986421/excel-vba-copy-paste-column-from-multiple-sheets-to-one-sheet-in-different-colum", "title": "Excel VBA copy/paste column from multiple sheets to one sheet in different Columns", "body": "<p>I have a workbook with approx 20 sheets, which are identical in format and setup. Only the sheet names differ (like \"1010\", \"1020\", \"1030\" and so on).\nNow I would like to copy from every sheet Column D to a newly created sheet, however:  </p>\n\n<p>Column D from sheet \"1010\" needs to go to Column G in the newly created sheet.</p>\n\n<p>Column D from sheet \"1020\" needs to go to Column H in the newly created sheet. </p>\n\n<p>and so on.<br>\nI have manually created the following code for copy/paste Column D into the new sheet.  </p>\n\n<pre><code>Sheets(\"1010\").Select  \n Columns(\"D:D\").Select  \n Application.CutCopyMode = False  \n Selection.Copy  \n Sheets(\"1000 (2)\").Select  \n Range(\"G1\").Select  \n ActiveSheet.Paste  \n\n    Sheets(\"1020\").Select  \nColumns(\"D:D\").Select  \nApplication.CutCopyMode = False  \nSelection.Copy  \nSheets(\"1000 (2)\").Select  \nRange(\"H1\").Select  \nActiveSheet.Paste  \n</code></pre>\n\n<p>Somehow I think this can go faster, although i have no idea how. Please advice.  </p>\n"}, {"tags": ["vba", "outlook", "ms-office"], "answers": [{"comments": [{"owner": {"reputation": 788, "user_id": 4617824, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-RYcsOMVCFYU/AAAAAAAAAAI/AAAAAAAAAIc/xW5x8yb90ms/photo.jpg?sz=128", "display_name": "Ange Loron", "link": "https://stackoverflow.com/users/4617824/ange-loron"}, "edited": false, "score": 0, "creation_date": 1426076385, "post_id": 28986398, "comment_id": 46221341, "body": "item.to gives me the name of the recipient but in this case I would need the email address"}, {"owner": {"reputation": 788, "user_id": 4617824, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-RYcsOMVCFYU/AAAAAAAAAAI/AAAAAAAAAIc/xW5x8yb90ms/photo.jpg?sz=128", "display_name": "Ange Loron", "link": "https://stackoverflow.com/users/4617824/ange-loron"}, "edited": false, "score": 0, "creation_date": 1426078666, "post_id": 28986398, "comment_id": 46222844, "body": "Tks for the edit, that looks good. I am giving it a shot right now. Do you think I could pick only the recipient To and not the CCs, BCCs, etc. As I basically one the email TO address and scan it through a database (if there are more than one address, it won&#39;t scan through the database."}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 788, "user_id": 4617824, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-RYcsOMVCFYU/AAAAAAAAAAI/AAAAAAAAAIc/xW5x8yb90ms/photo.jpg?sz=128", "display_name": "Ange Loron", "link": "https://stackoverflow.com/users/4617824/ange-loron"}, "edited": false, "score": 0, "creation_date": 1426078842, "post_id": 28986398, "comment_id": 46222966, "body": "One of the properties of the <code>Recipient</code> class is <code>Type</code>, which you can use to filter it.  As you&#39;re looping, you can use <code>If (item.Type=olTo) Then</code>..."}, {"owner": {"reputation": 788, "user_id": 4617824, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-RYcsOMVCFYU/AAAAAAAAAAI/AAAAAAAAAIc/xW5x8yb90ms/photo.jpg?sz=128", "display_name": "Ange Loron", "link": "https://stackoverflow.com/users/4617824/ange-loron"}, "edited": false, "score": 0, "creation_date": 1426079157, "post_id": 28986398, "comment_id": 46223169, "body": "Smart, i&#39;ll do that. Here is the next dumb question: I put my code: &quot;sSQL = &quot;SELECT id from dbo.dat... &quot; (as written on the original post) after your code and it sets the variable to Unknown. Should I write the code before the &quot;Next&quot;?"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 788, "user_id": 4617824, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-RYcsOMVCFYU/AAAAAAAAAAI/AAAAAAAAAIc/xW5x8yb90ms/photo.jpg?sz=128", "display_name": "Ange Loron", "link": "https://stackoverflow.com/users/4617824/ange-loron"}, "edited": false, "score": 0, "creation_date": 1426079245, "post_id": 28986398, "comment_id": 46223235, "body": "It shouldn&#39;t be as written in your original post.  It should use the new string you concatenated together, e.g. <code>allRecips</code>."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1426152548, "post_id": 28986398, "comment_id": 46257987, "body": "Well, copying other answers is not a good idea for earning points in the forum."}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1426161158, "post_id": 28986398, "comment_id": 46263226, "body": "@EugeneAstafiev -- First off, <a href=\"http://meta.stackexchange.com/questions/92107/is-stack-overflow-a-forum\">Stack Overflow is not a forum</a>.  Also, it&#39;s not about earning points, it&#39;s about providing good, complete answers.  Just because there is some overlap in our answers doesn&#39;t mean I copied yours; I simply was not finished with my answer when you posted yours.  I hadn&#39;t even looked at your answer until afterwards, to be honest with you."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1426161291, "post_id": 28986398, "comment_id": 46263314, "body": "I didn&#39;t notice &quot;it&#39;s about providing good, complete answers&quot; in your post and decided to answer to this post. But what you did? Just read other answers and edited your post. If you didn&#39;t complete the post, please don&#39;t click the SUBMIT button."}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1426161486, "post_id": 28986398, "comment_id": 46263467, "body": "@EugeneAstafiev -- Sorry, your last comment didn&#39;t make any sense."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1426161686, "post_id": 28986398, "comment_id": 46263599, "body": "I didn&#39;t see any sense in your reply as well. A weak strategy is to copy other answers and then tell everybody that you didn&#39;t notice anything. Moreover, downvote original answers."}], "tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": true, "score": 3, "last_activity_date": 1426077206, "last_edit_date": 1426077206, "creation_date": 1426076210, "answer_id": 28986398, "question_id": 28986306, "link": "https://stackoverflow.com/questions/28986306/get-item-recipient-with-outlook-vba/28986398#28986398", "title": "Get item.recipient with Outlook VBA", "body": "<p>For a \"quick\" way of doing it, you can concatenate the <code>Item.To</code> together with the <code>Item.CC</code> and <code>Item.BCC</code> properties, however, this may not be what you're looking for as sometimes these properties store the display names instead of the SMTP email addresses.</p>\n\n<p>Another way is to use the <code>Item.Recipients</code> collection which contains a <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.recipient.aspx\" rel=\"nofollow\">Recipient</a> object, which contains an <code>Address</code> property, for every recipient (TO, CC, and BCC).</p>\n\n<p>You could loop through each recipient and concatenate them together.  Something like this:</p>\n\n<pre><code>Dim recip As Recipient\nDim allRecips As String\n\nFor Each recip In item.Recipients\n    If (Len(allRecips) &gt; 0) Then allRecips = allRecips &amp; \"; \"\n    allRecips = allRecips &amp; recip.Address\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1426076551, "last_edit_date": 1426076551, "creation_date": 1426076249, "answer_id": 28986413, "question_id": 28986306, "link": "https://stackoverflow.com/questions/28986306/get-item-recipient-with-outlook-vba/28986413#28986413", "title": "Get item.recipient with Outlook VBA", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865320(v=office.15).aspx\" rel=\"nofollow\">Recipients</a> property of the MailItem class returns a Recipients collection that represents all the recipients for the Outlook item.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863703(v=office.15).aspx\" rel=\"nofollow\">Type</a> property of the Recipient class returns or sets an integer representing the type of recipient. For the MailItem the value can be one of the following <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865653.aspx\" rel=\"nofollow\">OlMailRecipientType</a> constants: olBCC, olCC, olOriginator, or olTo.</p>\n\n<p>Also the Recipient class provides the following properties:</p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868965(v=office.15).aspx\" rel=\"nofollow\">Name</a> - a string value that represents the display name for the recipient.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff867602(v=office.15).aspx\" rel=\"nofollow\">Address</a> - a string representing the e-mail address of the Recipient.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff863677(v=office.15).aspx\" rel=\"nofollow\">AddressEntry</a> - the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869306.aspx\" rel=\"nofollow\">AddressEntry</a> object corresponding to the recipient.</li>\n</ul>\n"}], "owner": {"reputation": 788, "user_id": 4617824, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-RYcsOMVCFYU/AAAAAAAAAAI/AAAAAAAAAIc/xW5x8yb90ms/photo.jpg?sz=128", "display_name": "Ange Loron", "link": "https://stackoverflow.com/users/4617824/ange-loron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9584, "favorite_count": 2, "accepted_answer_id": 28986398, "answer_count": 2, "score": 2, "last_activity_date": 1592994467, "creation_date": 1426075890, "last_edit_date": 1592994467, "question_id": 28986306, "link": "https://stackoverflow.com/questions/28986306/get-item-recipient-with-outlook-vba", "title": "Get item.recipient with Outlook VBA", "body": "<p>I need to get the recipient email address out of an item on Outlook 2010.</p>\n\n<p>My code is as follow:</p>\n\n<pre><code>sSQL = \"SELECT id from dbo.database where email_address LIKE '\" &amp; Item.RecipientEmailAddress &amp; \"'\n</code></pre>\n\n<p>item.recipientEmailAddress is not valid, but I need something like that.</p>\n\n<p>I know that you have a code call Item.SenderEmailAddress but in this case I need the recipient's email address.</p>\n\n<p>I've seen some other threads on that subject but I did not manage to make any of them work.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4657963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfcc7047048754f94a96ad507157a938?s=128&d=identicon&r=PG&f=1", "display_name": "slekk", "link": "https://stackoverflow.com/users/4657963/slekk"}, "edited": false, "score": 0, "creation_date": 1426088012, "post_id": 28987597, "comment_id": 46229916, "body": "Hello izzymo, thanks for the code, but if i activate it nothing happens. I created a testfile for you, that you can see how my data looks like. You can download it here <a href=\"https://dl.dropboxusercontent.com/u/14554224/testfile.zip\" rel=\"nofollow noreferrer\">Dropbox</a>. I only deleted one coloum which has included the printed filenames (to ensure the privacy) and i marked the cells yellow which should be deleted, see row 17,45,46,47,119,193,194 and 197."}, {"owner": {"reputation": 29, "user_id": 4657963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfcc7047048754f94a96ad507157a938?s=128&d=identicon&r=PG&f=1", "display_name": "slekk", "link": "https://stackoverflow.com/users/4657963/slekk"}, "edited": false, "score": 0, "creation_date": 1426088029, "post_id": 28987597, "comment_id": 46229935, "body": "Just for information, the text in the file is in german, so the text which has to be deleted is <b>&quot;Gedruckte Schwarzwei&#223;seiten, insgesamt = 0&quot;</b> and <b>&quot; Gedruckte Farbseiten, insgesamt = 0&quot;</b>"}, {"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "reply_to_user": {"reputation": 29, "user_id": 4657963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfcc7047048754f94a96ad507157a938?s=128&d=identicon&r=PG&f=1", "display_name": "slekk", "link": "https://stackoverflow.com/users/4657963/slekk"}, "edited": false, "score": 0, "creation_date": 1426143262, "post_id": 28987597, "comment_id": 46253814, "body": "The reason it wasn&#39;t working was because of a space at the beginning of the text. I have edited the code now to account for that. and also amended the code to German. Please refer to the edited answer above."}, {"owner": {"reputation": 29, "user_id": 4657963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfcc7047048754f94a96ad507157a938?s=128&d=identicon&r=PG&f=1", "display_name": "slekk", "link": "https://stackoverflow.com/users/4657963/slekk"}, "edited": false, "score": 0, "creation_date": 1426147239, "post_id": 28987597, "comment_id": 46255460, "body": "thanks for the edited code, its working perfect :), so my question is answered. sorry that i answer here and not above, but i dont know exactly where i should post my comment, that your code helped me."}], "tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": true, "score": 1, "last_activity_date": 1426143279, "last_edit_date": 1426143279, "creation_date": 1426079654, "answer_id": 28987597, "question_id": 28985986, "link": "https://stackoverflow.com/questions/28985986/how-to-delete-an-entire-row-if-two-cells-contain-specific-text/28987597#28987597", "title": "How to delete an entire row if two cells contain specific text", "body": "<p>Try the following Code:</p>\n\n<pre><code>Sub DeleteRow()\n\nFor i = 1 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    VarBnW = 0\n    VarCol = 0\n    For Each cell In Range(\"A\" &amp; i &amp; \":\" &amp; \"BA\" &amp; i)\n\n        If Trim(cell.Value) = \"Gedruckte Schwarzwei\u00dfseiten, insgesamt = 0\" Then VarBnW = 1\n        If Trim(cell.Value) = \"Gedruckte Farbseiten, insgesamt = 0\" Then VarCol = 1\n\n        If VarCol + VarBnW = 2 Then\n            MsgBox cell.Address\n            cell.EntireRow.Select\n            Selection.Delete\n            i = i - 1\n        End If\n\n    Next cell\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4657963, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dfcc7047048754f94a96ad507157a938?s=128&d=identicon&r=PG&f=1", "display_name": "slekk", "link": "https://stackoverflow.com/users/4657963/slekk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 0, "accepted_answer_id": 28987597, "answer_count": 1, "score": 0, "last_activity_date": 1426144830, "creation_date": 1426074859, "last_edit_date": 1426144830, "question_id": 28985986, "link": "https://stackoverflow.com/questions/28985986/how-to-delete-an-entire-row-if-two-cells-contain-specific-text", "title": "How to delete an entire row if two cells contain specific text", "body": "<p>I need VBA code which can delete an entire row, if two cells (which can be in any column of the sheet) contains a specific text.</p>\n\n<p>I have a daily generated print reporting file and in this file exists the text (in a non specific column) <code>\"printed BlackWhitepages, total = #\"</code> and <code>\"printed Colourpages, total = #\"</code> also in any column.</p>\n\n<p>The # stands for a number, so in my file there could be 0-99999...., depending on how many pages were printed.</p>\n\n<p>The file has columns from <code>A</code> to <code>BA</code> and thousands of rows, and the <code>Blackwhitepages</code> and <code>Colourpages</code> text could be on each column, depending on the print job.</p>\n\n<p>I want the VBA to look at the entire sheet, and if a row contains <strong><code>\"printed BlackWhitepages, total = 0\"</code></strong> and <strong><code>\"printed Colourpages, total = 0\"</code></strong>, the entire row should be deleted.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1426075797, "creation_date": 1426075797, "answer_id": 28986279, "question_id": 28985920, "link": "https://stackoverflow.com/questions/28985920/to-find-a-part-of-text-in-column-b-from-another-a-in-excel/28986279#28986279", "title": "To find a part of text in column B from another A in excel", "body": "<p>Please select ColumnA, HOME > Styles - Conditional Formatting, New Rule..., <em>Use a formula to determine which cells to format</em>, <strong>Format values where this formula is true:</strong>:  </p>\n\n<pre><code>=ISERROR(MATCH(\"*\"&amp;A1&amp;\"*\",B$1:B$6,0))  \n</code></pre>\n\n<p><kbd>Format...</kbd>, select Font, Color: red, OK, OK, OK.</p>\n"}, {"tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": false, "score": 1, "last_activity_date": 1426075817, "creation_date": 1426075817, "answer_id": 28986283, "question_id": 28985920, "link": "https://stackoverflow.com/questions/28985920/to-find-a-part-of-text-in-column-b-from-another-a-in-excel/28986283#28986283", "title": "To find a part of text in column B from another A in excel", "body": "<p>This formula should help you:</p>\n\n<pre><code>=COUNTIF($B$1:$B$6,\"*\" &amp; A1 &amp; \"*\")\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 578135, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/46132c0d981e416217d57c19ed73233e?s=128&d=identicon&r=PG", "display_name": "Darsin", "link": "https://stackoverflow.com/users/578135/darsin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1426075817, "creation_date": 1426074704, "question_id": 28985920, "link": "https://stackoverflow.com/questions/28985920/to-find-a-part-of-text-in-column-b-from-another-a-in-excel", "title": "To find a part of text in column B from another A in excel", "body": "<p>I am looking for a combination of excel formulas , which can tell me if the string in Column A is present in column B or not.</p>\n\n<p>In Column A i have values like:</p>\n\n<pre><code>335776\n510770\n514385\n527400\n411498\n</code></pre>\n\n<p>In Column B i have text like:</p>\n\n<pre><code>abc 411498 - Some random text\nxx 411498 - Some random text 2\ndfdag 335776 - Some random text 3\naddf 510770 - Some random text\naff 514385 - Some random text 4\nasded 514385 - Some random text 5\n</code></pre>\n\n<p>I would like to look to check if the values in Column A are present in Column B or not. If not present then that value be highlighted in RED (via conditional formatting). Thus following values in Column will be highlighted:</p>\n\n<pre><code>527400\n</code></pre>\n\n<p>I would not prefer to use macro, if a combination of INDEX, MATCH, FIND, etc. can work than that would be really great.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 1, "creation_date": 1426073861, "post_id": 28985579, "comment_id": 46219762, "body": "Please could you share an example"}], "answers": [{"comments": [{"owner": {"reputation": 3273, "user_id": 818827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/OsGL0.png?s=128&g=1", "display_name": "peter_the_oak", "link": "https://stackoverflow.com/users/818827/peter-the-oak"}, "edited": false, "score": 2, "creation_date": 1475132917, "post_id": 28986212, "comment_id": 66822236, "body": "This is a fine solution. Please note if you have objects stored, then VBA requires <code>is</code>, so the code line becomes <code>If coll(i) is item Then</code>."}, {"owner": {"reputation": 362, "user_id": 2752308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574f9f2cb6733e7ebcdd340d6ec14b25?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Scofano Diniz", "link": "https://stackoverflow.com/users/2752308/marcelo-scofano-diniz"}, "reply_to_user": {"reputation": 3273, "user_id": 818827, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/OsGL0.png?s=128&g=1", "display_name": "peter_the_oak", "link": "https://stackoverflow.com/users/818827/peter-the-oak"}, "edited": false, "score": 1, "creation_date": 1585858746, "post_id": 28986212, "comment_id": 107920394, "body": "Both solution and @peter_the_oak&#39;s comment are fine, thank you both. To add 0.02$, it is easily implemented as a:  <code>Select Case VarType(coll(i)) Case vbObject  If coll(i) Is item Then ... Case Else ... If coll(i) = item Then        ...</code>"}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": true, "score": 4, "last_activity_date": 1426076109, "last_edit_date": 1426076109, "creation_date": 1426075552, "answer_id": 28986212, "question_id": 28985579, "link": "https://stackoverflow.com/questions/28985579/retrieve-the-index-of-an-object-stored-in-a-collection-using-its-key-vba/28986212#28986212", "title": "Retrieve the index of an object stored in a collection using its key (VBA)", "body": "<p>Essentially, no. There's not a faster way. Not using a collection at least. Here's the fastest way I know to find the index of an item in a collection.</p>\n\n<pre><code>' returns index of item if found, returns 0 if not found\nPublic Function IndexOf(ByVal coll As Collection, ByVal item As Variant) As Long\n    Dim i As Long\n    For i = 1 To coll.Count\n        If coll(i) = item Then\n            IndexOf = i\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>Note that we exit the function as soon as we've found the first matching item. This algorithm has an average and worst case of <strong>O(n)</strong> where <strong>n</strong> is the number of items in the collection.</p>\n\n<p>I think there may be another reason you want to be able to find the index though, so I'm going to suggest also taking a look at the <a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html\" rel=\"nofollow\"><code>Scripting.Dictionary</code></a> in the Microsoft Scripting Runtime library. While, there is also no way to get an item's index via it's key value (other than looping), you <strong>can</strong> actually retrieve the key values from the dictionary, not just it's items. I suspect that you may be asking this question because of the lack of this ability in the built in <code>Collection</code> object.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4658606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21b855579a18a9a423648c56a5c84a6?s=128&d=identicon&r=PG&f=1", "display_name": "nomad", "link": "https://stackoverflow.com/users/4658606/nomad"}, "is_accepted": false, "score": -2, "last_activity_date": 1426081007, "creation_date": 1426081007, "answer_id": 28988098, "question_id": 28985579, "link": "https://stackoverflow.com/questions/28985579/retrieve-the-index-of-an-object-stored-in-a-collection-using-its-key-vba/28988098#28988098", "title": "Retrieve the index of an object stored in a collection using its key (VBA)", "body": "<p>There is no way that I have found to return the index, however if you have a collection of user defined objects that will only be stored in a single collection you can add an index property to the object and set it when the object is added to the collection.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8989181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cc76348c90040f16d4e4f0c3ecccadd?s=128&d=identicon&r=PG&f=1", "display_name": "Sil", "link": "https://stackoverflow.com/users/8989181/sil"}, "is_accepted": false, "score": 0, "last_activity_date": 1511349387, "creation_date": 1511349387, "answer_id": 47433336, "question_id": 28985579, "link": "https://stackoverflow.com/questions/28985579/retrieve-the-index-of-an-object-stored-in-a-collection-using-its-key-vba/47433336#47433336", "title": "Retrieve the index of an object stored in a collection using its key (VBA)", "body": "<p>I recently had the same \"issue\" and used this workaround:</p>\n\n<p>Create two collections: one containing the actual strings of interest and one containing numbers from 1 to n with the actuals strings as keys. This way you can retrieve the index since it's a value in the second collection.</p>\n\n<pre><code>Sub example()\n\n    'imagine we are reading out following excel column\n\n    'one\n    'two\n    'three\n\n    Dim textcol, numcol As New Collection\n    Dim i, index As Integer\n    Dim str As String\n\n    For i = 1 To Range.Rows.Count\n        textcol.Add Range.Cells(i, 1)       'value, no key\n        numcol.Add i, Range.Cells(i, 1)     'i, value as key\n    Next i\n\n    'textcol: \"one\", \"two\", \"three\"\n    'numcol: 1 [\"one\"], 2 [\"two\"], 3 [\"three\"]\n\n    str = \"two\"\n    index = numcol(str) '~&gt; 2\n\nEnd Sub\n</code></pre>\n\n<p>It's not pretty but it worked for me.</p>\n"}, {"comments": [{"owner": {"reputation": 23496, "user_id": 5468463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8eafc92b719d65512cded4c5087892ff?s=128&d=identicon&r=PG&f=1", "display_name": "Vega", "link": "https://stackoverflow.com/users/5468463/vega"}, "edited": false, "score": 1, "creation_date": 1522330319, "post_id": 49557202, "comment_id": 86122342, "body": "Is this an answer?"}, {"owner": {"reputation": 1, "user_id": 9569857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba072658a1428ffc240437cf5d40109?s=128&d=identicon&r=PG&f=1", "display_name": "cweedon", "link": "https://stackoverflow.com/users/9569857/cweedon"}, "reply_to_user": {"reputation": 23496, "user_id": 5468463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8eafc92b719d65512cded4c5087892ff?s=128&d=identicon&r=PG&f=1", "display_name": "Vega", "link": "https://stackoverflow.com/users/5468463/vega"}, "edited": false, "score": 0, "creation_date": 1522419882, "post_id": 49557202, "comment_id": 86159745, "body": "@vega Yes it answers the original question (I would like to know the position of a given element in the collection using its key.) by giving an example where the position of an element can be retrieved using a key without looping through the collection each time.  I am new to posting on this forum so I would appreciate any feed back."}, {"owner": {"reputation": 1767, "user_id": 5134722, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YvI1j.jpg?s=128&g=1", "display_name": "Colm Bhandal", "link": "https://stackoverflow.com/users/5134722/colm-bhandal"}, "edited": false, "score": 0, "creation_date": 1553197230, "post_id": 49557202, "comment_id": 97305730, "body": "Are you sure this works? I get a type mismatch error with an Integer type as the Item."}], "tags": [], "owner": {"reputation": 1, "user_id": 9569857, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dba072658a1428ffc240437cf5d40109?s=128&d=identicon&r=PG&f=1", "display_name": "cweedon", "link": "https://stackoverflow.com/users/9569857/cweedon"}, "is_accepted": false, "score": 0, "last_activity_date": 1522329690, "creation_date": 1522329690, "answer_id": 49557202, "question_id": 28985579, "link": "https://stackoverflow.com/questions/28985579/retrieve-the-index-of-an-object-stored-in-a-collection-using-its-key-vba/49557202#49557202", "title": "Retrieve the index of an object stored in a collection using its key (VBA)", "body": "<p>I liked Sil's answer above.  I think he short changed himself by saying 'Its not pretty but it works'.  In my experience it is way faster when doing a large number of lookups.\nHere is another example</p>\n\n<pre><code>Sub UseCollectionWithKey()\nDim Col As New Collection\nDim I As Integer\n\n' create a new collection that is keyed\nFor I = 1 To ActiveWorkbook.Styles.Count\n  Col.Add I, ActiveWorkbook.Styles(I)   ' where \"ActiveWorkbook.Styles(I)\" is the key\nNext I\n\nMsgBox Col(ActiveCell.Style)    ' this gives the index of the style for the active cell\n\nEnd Sub\n</code></pre>\n\n<p>See also \"Adding Items Using a Key\" at this link\n<a href=\"https://excelmacromastery.com/excel-vba-collections/\" rel=\"nofollow noreferrer\">https://excelmacromastery.com/excel-vba-collections/</a></p>\n"}], "owner": {"reputation": 59, "user_id": 3231739, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9217fc7b7b523ff982e6ca30faddc682?s=128&d=identicon&r=PG&f=1", "display_name": "jalopez910", "link": "https://stackoverflow.com/users/3231739/jalopez910"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21545, "favorite_count": 1, "accepted_answer_id": 28986212, "answer_count": 4, "score": 2, "last_activity_date": 1616540384, "creation_date": 1426073664, "question_id": 28985579, "link": "https://stackoverflow.com/questions/28985579/retrieve-the-index-of-an-object-stored-in-a-collection-using-its-key-vba", "title": "Retrieve the index of an object stored in a collection using its key (VBA)", "body": "<p>I have a collection with several elements in VBA, each of these elements has a key assigned.</p>\n\n<p>I would like to know the position of a given element in the collection using its key. The only way I can think of doing it is to make a loop through the collection until I get the item I want, is there a faster approach?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vb.net", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "edited": false, "score": 0, "creation_date": 1426145480, "post_id": 28985451, "comment_id": 46254738, "body": "It seems to work well when I call the sub from these three events"}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": true, "score": 1, "last_activity_date": 1426073336, "creation_date": 1426073336, "answer_id": 28985451, "question_id": 28985368, "link": "https://stackoverflow.com/questions/28985368/run-a-sub-once-every-time-a-sheet-is-activated/28985451#28985451", "title": "Run a sub _once_, _every time_ a sheet is activated", "body": "<p>Try Workbook.open event :</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/bb242003%28v=office.12%29.aspx\" rel=\"nofollow\">Workbook.Open Event</a></p>\n\n<p>and Application.NewWorkbook Event</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/bb242002%28v=office.12%29.aspx\" rel=\"nofollow\">Application.NewWorkbook Event</a></p>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 28985451, "answer_count": 1, "score": 0, "last_activity_date": 1426073336, "creation_date": 1426073090, "question_id": 28985368, "link": "https://stackoverflow.com/questions/28985368/run-a-sub-once-every-time-a-sheet-is-activated", "title": "Run a sub _once_, _every time_ a sheet is activated", "body": "<p>WHERE I AM NOW:\nI am writing an add-in for Excel in VB.NET. I sub that is called by the \"SheetActivate\" event in all sheets.</p>\n\n<p>PROBLEM:\nBut it is not called when I start a new workbook or when I open an existing workbook. In those cases it isn't called until I select another sheet in that workbook.</p>\n\n<p>Question:\nHow can I make it so that my sub is called once every time a sheet is activated, including when I open or start a workbook? I am not sure that I have thought of all situations in my text above.</p>\n"}, {"tags": ["vba", "excel", "file-handling"], "comments": [{"owner": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "edited": false, "score": 0, "creation_date": 1426073933, "post_id": 28984935, "comment_id": 46219824, "body": "In this case you&#39;d better copy the source file to the destination file."}, {"owner": {"reputation": 3, "user_id": 4658015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58f02c75dcc9f19d2e4c02c2193a6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Craig M", "link": "https://stackoverflow.com/users/4658015/craig-m"}, "reply_to_user": {"reputation": 323, "user_id": 3795077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tGabw.gif?s=128&g=1", "display_name": "snb", "link": "https://stackoverflow.com/users/3795077/snb"}, "edited": false, "score": 0, "creation_date": 1426339817, "post_id": 28984935, "comment_id": 46337125, "body": "This is a cut down example to demonstrate the behavour only, but thanks anyway."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4658015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58f02c75dcc9f19d2e4c02c2193a6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Craig M", "link": "https://stackoverflow.com/users/4658015/craig-m"}, "edited": false, "score": 0, "creation_date": 1426339895, "post_id": 28985145, "comment_id": 46337157, "body": "This answer is correct, thank you, sorry I don&#39;t have the points to &quot;up&quot; your answer."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1426072505, "creation_date": 1426072505, "answer_id": 28985145, "question_id": 28984935, "link": "https://stackoverflow.com/questions/28984935/vba-7-0-in-excel-line-input-appears-to-add-extra-quotes-around-the-line/28985145#28985145", "title": "VBA 7.0 in Excel, Line Input appears to add extra quotes around the line", "body": "<p>It's actually the <code>Write</code> statement that puts quotes round the strings. You should use <code>Print</code> instead if you don't want that.</p>\n"}], "owner": {"reputation": 3, "user_id": 4658015, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58f02c75dcc9f19d2e4c02c2193a6b1?s=128&d=identicon&r=PG&f=1", "display_name": "Craig M", "link": "https://stackoverflow.com/users/4658015/craig-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 28985145, "answer_count": 1, "score": 0, "last_activity_date": 1426072505, "creation_date": 1426071915, "question_id": 28984935, "link": "https://stackoverflow.com/questions/28984935/vba-7-0-in-excel-line-input-appears-to-add-extra-quotes-around-the-line", "title": "VBA 7.0 in Excel, Line Input appears to add extra quotes around the line", "body": "<p>I have a file with lines like:</p>\n\n<blockquote>\n  <p>one<br>\n  two<br>\n  three<br></p>\n</blockquote>\n\n<p>When I read from one file and write to another, they end up quoted.  They are also quoted within the variable in the watch window.</p>\n\n<p>Also when I have a file with:<br></p>\n\n<blockquote>\n  <p>\"one\", \"two\", \"three\"</p>\n</blockquote>\n\n<p>It ends up written as:<br></p>\n\n<blockquote>\n  <p>\"\"\"one\"\", \"\"two\"\", \"\"three\"\"\"</p>\n</blockquote>\n\n<p>Does anyone know what is causing this?  My files have extension \".txt\".<br>\nThank you for your time.</p>\n\n<p>Sample code snippet below:</p>\n\n<pre><code>Public Sub ReadAndWrite()\n\nDim fhInput As Integer\nDim fhOutput As Integer\nDim strSingleLine As String\n\nfhInput = FreeFile()\n\nOpen \"&lt;your input file here&gt;\" For Input As #fhInput\n\nfhOutput = FreeFile()\n\nOpen \"&lt;your output file here&gt;\" For Output As #fhOutput\n\nDo While Not EOF(fhInput)\n    Line Input #fhInput, strSingleLine\n    Write #fhOutput, strSingleLine\nLoop\n\nClose (fhInput)\nClose (fhOutput)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4657988, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/942fc54a2588d7b682dbef9db2f34ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4657988/erik"}, "edited": false, "score": 0, "creation_date": 1426226696, "post_id": 28985721, "comment_id": 46293816, "body": "Thank you. Worked perfectey!"}, {"owner": {"reputation": 159, "user_id": 2821122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XEdpi.jpg?s=128&g=1", "display_name": "Oguzhan D.", "link": "https://stackoverflow.com/users/2821122/oguzhan-d"}, "reply_to_user": {"reputation": 13, "user_id": 4657988, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/942fc54a2588d7b682dbef9db2f34ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4657988/erik"}, "edited": false, "score": 0, "creation_date": 1426535172, "post_id": 28985721, "comment_id": 46404045, "body": "You are welcome. You can select one of the answers as accepted by clicking the &#39;tick&#39; at left of the answer to help others to see the correct answer too."}], "tags": [], "owner": {"reputation": 159, "user_id": 2821122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XEdpi.jpg?s=128&g=1", "display_name": "Oguzhan D.", "link": "https://stackoverflow.com/users/2821122/oguzhan-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1426075076, "last_edit_date": 1426075076, "creation_date": 1426074080, "answer_id": 28985721, "question_id": 28984672, "link": "https://stackoverflow.com/questions/28984672/importing-data-from-new-excel-files-in-a-folder-new-files-added-to-the-folder-d/28985721#28985721", "title": "Importing data from new excel files in a folder (new files added to the folder daily)", "body": "<p>In VBA there is a function named <code>Dir(pathname, attributes)</code>. <br>\n<br>\nYou can find the reference here : <a href=\"https://support.office.com/en-nz/article/Dir-Function-1a1a4275-f92f-4ae4-8b87-41e4513bba2e\" rel=\"nofollow\">Function Reference</a> <br><br></p>\n\n<p>You are going to define a <code>FileList as Variant</code> and then set it with Dir function like this : <code>FileList = Dir(\"c:\\YourFolder\\)</code> <br>\n<br></p>\n\n<p>After that you can iterate through <code>FileList</code> for the Excel Files with a loop like this <code>While (FileList &lt;&gt; \"\")</code> <br>\n<br><br></p>\n\n<p>After reading file you can store which files you read in a text file so that you will not encounter with duplications.</p>\n"}, {"tags": [], "owner": {"reputation": 2197, "user_id": 2519073, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/71094909be9f40bd576b1974a74966aa?s=128&d=identicon&r=PG&f=1", "display_name": "ya_dimon", "link": "https://stackoverflow.com/users/2519073/ya-dimon"}, "is_accepted": true, "score": 0, "last_activity_date": 1426077761, "last_edit_date": 1426077761, "creation_date": 1426077327, "answer_id": 28986772, "question_id": 28984672, "link": "https://stackoverflow.com/questions/28984672/importing-data-from-new-excel-files-in-a-folder-new-files-added-to-the-folder-d/28986772#28986772", "title": "Importing data from new excel files in a folder (new files added to the folder daily)", "body": "<p>This is probably what you wanted: <br></p>\n\n<p>Durgun's answer in code:</p>\n\n<pre><code>Dim CurrentFilePath As Variant '&lt;-- ADDED\nDim wkbOpenedWorkbook As Workbook '&lt;-- ADDED\nDim SelectionB4 as Range '&lt;-- ADDED\nConst sDIR As String = \"H:\\global\\Prosjekt\\NAS\\RCL\\*.csv\" '&lt;-- ADDED, note: \"*.csv\" is filter for your files\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nSet SelectionB4 = Range(Selection, Selection.End(xlDown))'&lt;-- moved/changed, save reference to your 1 selection\nCurrentFilePath = Dir(sDIR) '&lt;-- ADDED\nWhile CurrentFilePath &lt;&gt; \"\" '&lt;-- ADDED\n    Set wkbOpenedWorkbook = Workbooks.Open(Filename:=CurrentFilePath) '&lt;-- CHANGED, save reference to workbook, to close it later\n    SelectionB4.Select\n    Selection.Copy\n    Windows(\"yield1.xlsm\").Activate\n    Sheets(\"Input\").Select\n    Range(\"A9\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Selection.TextToColumns Destination:=Range(\"A9\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n        Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n        Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1)), TrailingMinusNumbers:=True\n\n\n    wkbOpenedWorkbook.Close False '&lt;-- CHANGED 'close and dont save, remove \"False\" to popup the save dialog\n\n    'XYZ\n    Sheets(\"Input\").Select\n     Range(\"R8:R204\").Select\n     Selection.Copy\n     Sheets(\"XYZ\").Select\n       Range(\"xfd1:xfd197\").End(xlToLeft).Offset(0, 1).Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    CurrentFilePath = Dir(sDIR) '&lt;-- ADDED\nWend '&lt;-- ADDED\n</code></pre>\n\n<p>Note: there are many places in code to optimize, make more stable, faster, readable.</p>\n"}], "owner": {"reputation": 13, "user_id": 4657988, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/942fc54a2588d7b682dbef9db2f34ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4657988/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 28986772, "answer_count": 2, "score": 0, "last_activity_date": 1426077761, "creation_date": 1426071168, "last_edit_date": 1531161705, "question_id": 28984672, "link": "https://stackoverflow.com/questions/28984672/importing-data-from-new-excel-files-in-a-folder-new-files-added-to-the-folder-d", "title": "Importing data from new excel files in a folder (new files added to the folder daily)", "body": "<p>I am looking to import data from several excel files located in the same folder. New files are added to the folder daily. I import the data once a week or month and need a loop that imports all data from files I haven't already imported from. Currently I have the following code I use, but I have to go in and retype the filename for every file to get new data. Help please?</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.DisplayAlerts = False\nWorkbooks.Open Filename:=\"H:\\global\\Prosjekt\\NAS\\RCL\\OUTPUT-20150302.csv\"\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nWindows(\"yield1.xlsm\").Activate\nSheets(\"Input\").Select\nRange(\"A9\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nSelection.TextToColumns Destination:=Range(\"A9\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n    Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1)), TrailingMinusNumbers:=True\n\n\nWindows(\"OUTPUT-20150302.csv\").Activate\nActiveWindow.Close\n\n'XYZ\nSheets(\"Input\").Select\n Range(\"R8:R204\").Select\n Selection.Copy\n Sheets(\"XYZ\").Select\n   Range(\"xfd1:xfd197\").End(xlToLeft).Offset(0, 1).Activate\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["excel", "excel-2013", "vba"], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 4340990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac421880c2178ee38d120ad3b1c7fa2a?s=128&d=identicon&r=PG&f=1", "display_name": "Liniel", "link": "https://stackoverflow.com/users/4340990/liniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1426083059, "creation_date": 1426083059, "answer_id": 28988922, "question_id": 28984267, "link": "https://stackoverflow.com/questions/28984267/excel-vba-range-calculate-bug/28988922#28988922", "title": "Excel VBA range.calculate - bug?", "body": "<p>Probably you can't calculate only one sheet without the others. You could try set value to cells by macro, but I don't think you'll be satisfied.</p>\n"}], "owner": {"reputation": 509, "user_id": 11498, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/gTwre.jpg?s=128&g=1", "display_name": "GUI Junkie", "link": "https://stackoverflow.com/users/11498/gui-junkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426083059, "creation_date": 1426070203, "last_edit_date": 1531164843, "question_id": 28984267, "link": "https://stackoverflow.com/questions/28984267/excel-vba-range-calculate-bug", "title": "Excel VBA range.calculate - bug?", "body": "<p>I'm writing a little unit test for a template I'm doing. To optimize the testing, I'm setting <code>Application.Calculation = xlCalculationManual</code></p>\n\n<p>As I want to retrieve the calculated values for each test row, I'm using <code>theRange.Calculate</code> to obtain the value of the cell.</p>\n\n<p>This fails to update the value.</p>\n\n<p>I've tried using <code>sheet.Calculate</code> with the exact same result.</p>\n\n<p>After finishing, <code>Application.Calculation = xlCalculationAutomatic</code> updates all values.</p>\n\n<p>After reading the <a href=\"https://msdn.microsoft.com/en-us/library/office/bb687891.aspx\" rel=\"nofollow\">documentation in MSDN</a> I'm starting to think this is a bug.</p>\n\n<p>The formula I want to have calculated uses named ranges could that affect the calculation? The formula is inside a table.</p>\n"}, {"tags": ["vba", "dynamic", "charts"], "comments": [{"owner": {"reputation": 64, "user_id": 4638528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81a2cd3bcd4995fffd55d5d9c5bc340?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/4638528/philippe"}, "edited": false, "score": 0, "creation_date": 1426087864, "post_id": 28984080, "comment_id": 46229809, "body": "I think instead of using the &quot;<code>me.range</code>&quot; give it a try with the actual sheet name; &quot;<code>sheets(&quot;yoursheetname&quot;).range(....etc</code>&quot;"}, {"owner": {"reputation": 11, "user_id": 4613420, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6431f2e420d8ec6ade429f74a10e1398?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/4613420/nicholas"}, "reply_to_user": {"reputation": 64, "user_id": 4638528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81a2cd3bcd4995fffd55d5d9c5bc340?s=128&d=identicon&r=PG&f=1", "display_name": "Philippe", "link": "https://stackoverflow.com/users/4638528/philippe"}, "edited": false, "score": 0, "creation_date": 1426659060, "post_id": 28984080, "comment_id": 46458692, "body": "I unfortunately still received errors. I did however find an alternative means of achieving the same out come. I will detail this in the answer. Thanks @Philippe"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4613420, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6431f2e420d8ec6ade429f74a10e1398?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/4613420/nicholas"}, "is_accepted": false, "score": 0, "last_activity_date": 1426660739, "creation_date": 1426660739, "answer_id": 29115626, "question_id": 28984080, "link": "https://stackoverflow.com/questions/28984080/dynamically-change-the-data-of-a-bar-chart-with-two-data-series/29115626#29115626", "title": "Dynamically change the data of a bar chart with two data series", "body": "<p>Instead of using VB code, it is possible to specify a dynamic range in Excel using the OFFSET function. The string used to specify the dynamic range is as follows:</p>\n\n<pre><code>=OFFSET(BarGraph_Data!$C$2,1,0,BarGraph_Data!$G$3,1)\n</code></pre>\n\n<p>The offset function works as follows: </p>\n\n<pre><code>=OFFSET(anchor point, rows offset, col offset, height)\n</code></pre>\n\n<p>The height is set as the number of data points which you to plot. The bar graph is then set to plot this data range, and as the height is changed in cell G3, then the range changes accordingly and therefore so does the Bar Graph. </p>\n\n<p>This video assisted me in this solution: </p>\n\n<p><a href=\"https://www.youtube.com/watch?v=1VnITD0rU1A\" rel=\"nofollow\">https://www.youtube.com/watch?v=1VnITD0rU1A</a></p>\n"}], "owner": {"reputation": 11, "user_id": 4613420, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/6431f2e420d8ec6ade429f74a10e1398?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/4613420/nicholas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 398, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426660739, "creation_date": 1426069620, "last_edit_date": 1426074714, "question_id": 28984080, "link": "https://stackoverflow.com/questions/28984080/dynamically-change-the-data-of-a-bar-chart-with-two-data-series", "title": "Dynamically change the data of a bar chart with two data series", "body": "<p>I am trying to create a dynamic algorithm which adjusts the data of a bar chart with two data series each time the data base is adjusted. The code I am trying to use is as follows: </p>\n\n<pre><code>Sheet8.ChartObjects(\"PriceBarGraph\").Activate\nActiveChart.SeriesCollection(1).Values = _\n\"='DeliveredPriceFunction '!$B$7:$B$62\"\nActiveChart.SeriesCollection(2).Values = Me.Range(\"B7\", Cells(Me.Range(\"H3\").Value + 7, 1))\n</code></pre>\n\n<p>I get a Runtime 1004 Application-defined or Object-defined error.</p>\n\n<p>Any assistance would be appreciated, thanks in advance. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 3449173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k1WbA.png?s=128&g=1", "display_name": "Nordik", "link": "https://stackoverflow.com/users/3449173/nordik"}, "is_accepted": true, "score": 1, "last_activity_date": 1426071796, "creation_date": 1426071796, "answer_id": 28984894, "question_id": 28983994, "link": "https://stackoverflow.com/questions/28983994/how-to-compare-text-values-in-vba/28984894#28984894", "title": "How to compare text values in VBA?", "body": "<p>You should modify your IF:</p>\n\n<pre><code>If Range(\"A\" &amp; i) = Range(\"A\" &amp; i + 1) Then\n   Range(\"B\" &amp; i) = n\nElse\n   n = n + 1\n   Range(\"B\" &amp; i) = n-1\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 3956919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0eefe8938fb09b2e91e5c6ac7c27112?s=128&d=identicon&r=PG&f=1", "display_name": "MVAmorim", "link": "https://stackoverflow.com/users/3956919/mvamorim"}, "is_accepted": false, "score": 0, "last_activity_date": 1426071933, "creation_date": 1426071933, "answer_id": 28984940, "question_id": 28983994, "link": "https://stackoverflow.com/questions/28983994/how-to-compare-text-values-in-vba/28984940#28984940", "title": "How to compare text values in VBA?", "body": "<p>try this:</p>\n\n<pre><code>Sub Ma1()\nDim ws As Worksheet\nDim LastRow As Long\nDim i, n As Integer\n\nSet ws = ActiveWorkbook.Sheets(1)\nLastRow = Sheets(1).Range(\"A\" &amp; Sheets(1).Rows.Count).End(xlUp).Row\n\nColumn1 = Sheets(1).Range(\"A3:A\" &amp; LastRow)\n\nn = 1\nFor i = 3 To LastRow\n    On Error Resume Next\n    If Range(\"A\" &amp; i) = Range(\"A\" &amp; i + 1) Then\n        Range(\"B\" &amp; i) = n\n    ElseIf Range(\"A\" &amp; i) &lt;&gt; Range(\"A\" &amp; i + 1) And _\n           Range(\"A\" &amp; i) = Range(\"A\" &amp; i - 1) Then\n        Range(\"B\" &amp; i) = n\n        n = n + 1\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 2918939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f048b224d7c59c683a18ce3934d0fd81?s=128&d=identicon&r=PG&f=1", "display_name": "Ale", "link": "https://stackoverflow.com/users/2918939/ale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 28984894, "answer_count": 2, "score": 0, "last_activity_date": 1426071933, "creation_date": 1426069399, "last_edit_date": 1531164843, "question_id": 28983994, "link": "https://stackoverflow.com/questions/28983994/how-to-compare-text-values-in-vba", "title": "How to compare text values in VBA?", "body": "<p>I have a table as shown below. I would like to compare column A \"Text\" values with the next text value in the same column. In case they are equal to put an index i=1 if they are different, to put the next index i+1.\nThe problem is that in the I get right index for each column B cell except cells that remain blank (as on the picture). Can anyone help with it, please?</p>\n\n<p><img src=\"https://i.stack.imgur.com/uBxip.jpg\" alt=\"enter image description here\"></p>\n\n<pre><code>Sub Ma1()\nDim ws As Worksheet\nDim LastRow As Long\nDim i, n As Integer\n\nSet ws = ActiveWorkbook.Sheets(\"Sheet2\")\nLastRow = Sheets(\"Sheet2\").Range(\"A\" &amp; Sheets(\"Sheet2\").Rows.Count).End(xlUp).Row\n\nColumn1 = Sheets(\"Sheet2\").Range(\"A3:A\" &amp; LastRow)\n\nn = 1\nFor i = 3 To LastRow\nOn Error Resume Next\nIf Range(\"A\" &amp; i) = Range(\"A\" &amp; i + 1) Then\nRange(\"B\" &amp; i) = n\nElse: n = n + 1\nEnd If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4432625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ac2765b80dcd64112c32b4755dc054?s=128&d=identicon&r=PG&f=1", "display_name": "gxe", "link": "https://stackoverflow.com/users/4432625/gxe"}, "edited": false, "score": 0, "creation_date": 1426083034, "post_id": 28988156, "comment_id": 46226147, "body": "That is so great @Permanoob. I have headers at first 3 rows, is it possible to start checking after A3 and going down?"}], "tags": [], "owner": {"reputation": 801, "user_id": 2970747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16141144c3868597857e6ac4a03f2e32?s=128&d=identicon&r=PG&f=1", "display_name": "PermaNoob", "link": "https://stackoverflow.com/users/2970747/permanoob"}, "is_accepted": true, "score": 0, "last_activity_date": 1426084829, "last_edit_date": 1426084829, "creation_date": 1426081185, "answer_id": 28988156, "question_id": 28982970, "link": "https://stackoverflow.com/questions/28982970/macro-to-insert-a-blank-row-in-excel-if-cell-above-and-cell-below-have-the-same/28988156#28988156", "title": "Macro to insert a blank row in Excel if cell above and cell below have the same content", "body": "<p>Something like this?</p>\n\n<pre><code>Sub StackTest()\nDim LastRow As Long\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor c = LastRow To 5 Step -1\n    If ActiveSheet.Range(\"A\" &amp; c).Value &lt;&gt; ActiveSheet.Range(\"A\" &amp; c - 1) Then\n        ActiveSheet.Range(\"A\" &amp; c).EntireRow.Insert\n    End If\nNext c\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 4654444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gkdQ.jpg?s=128&g=1", "display_name": "JMMach", "link": "https://stackoverflow.com/users/4654444/jmmach"}, "is_accepted": false, "score": 0, "last_activity_date": 1426092925, "creation_date": 1426092925, "answer_id": 28992716, "question_id": 28982970, "link": "https://stackoverflow.com/questions/28982970/macro-to-insert-a-blank-row-in-excel-if-cell-above-and-cell-below-have-the-same/28992716#28992716", "title": "Macro to insert a blank row in Excel if cell above and cell below have the same content", "body": "<p>Rather than insert a blank row, better to change the height of the row so that you preserve the ability to sort and filter.\nUse this: <code>Rows(c).RowHeight = 24.75</code> (you can change the number to your liking) in place of <code>ActiveSheet.Range(\"A\" &amp; c).EntireRow.Insert</code></p>\n"}], "owner": {"reputation": 3, "user_id": 4432625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ac2765b80dcd64112c32b4755dc054?s=128&d=identicon&r=PG&f=1", "display_name": "gxe", "link": "https://stackoverflow.com/users/4432625/gxe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2944, "favorite_count": 0, "accepted_answer_id": 28988156, "answer_count": 2, "score": -2, "last_activity_date": 1426092925, "creation_date": 1426066726, "last_edit_date": 1426089464, "question_id": 28982970, "link": "https://stackoverflow.com/questions/28982970/macro-to-insert-a-blank-row-in-excel-if-cell-above-and-cell-below-have-the-same", "title": "Macro to insert a blank row in Excel if cell above and cell below have the same content", "body": "<p>I have an Excel sheet where in column A are text values like:</p>\n\n<ul>\n<li>Italy</li>\n<li>Italy</li>\n<li>England</li>\n<li>England</li>\n<li>England</li>\n<li>Greece</li>\n<li>Germany</li>\n<li>Germany</li>\n<li>Germany</li>\n<li>Germany</li>\n</ul>\n\n<p>I need to add a blank row between each countries group to separate them and have a better view</p>\n\n<p>I already tried to match them but what I get is just TRUE/FALSE but don't know how to get the reference and where to add the blank row.</p>\n"}, {"tags": ["excel", "charts", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1521, "user_id": 1641564, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/724f62d6254a1a8b245ea725196c13a9?s=128&d=identicon&r=PG", "display_name": "daZza", "link": "https://stackoverflow.com/users/1641564/dazza"}, "is_accepted": false, "score": 1, "last_activity_date": 1426070587, "creation_date": 1426070587, "answer_id": 28984425, "question_id": 28982432, "link": "https://stackoverflow.com/questions/28982432/dynamic-range-in-excel-how-to-remove-counta-counting-blank-cellsmade-blank-by/28984425#28984425", "title": "Dynamic range in excel: How to remove Counta counting blank cells(made blank by ifferror formulas)", "body": "<p>To remove the blank cells from the count you can use the <code>COUNTBLANK</code> function of Excel.</p>\n\n<p>Simply subtract the value of <code>COUNTBLANK</code> from the result of <code>COUNTA</code></p>\n\n<p>Example:</p>\n\n<p><code>=COUNTA(yourRange)-COUNTBLANK(yourRange)</code></p>\n"}], "owner": {"reputation": 21, "user_id": 4586706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131aad3256c0d72a7c760bb329561901?s=128&d=identicon&r=PG&f=1", "display_name": "priyanka -", "link": "https://stackoverflow.com/users/4586706/priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6611, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557374886, "creation_date": 1426065126, "last_edit_date": 1531161705, "question_id": 28982432, "link": "https://stackoverflow.com/questions/28982432/dynamic-range-in-excel-how-to-remove-counta-counting-blank-cellsmade-blank-by", "title": "Dynamic range in excel: How to remove Counta counting blank cells(made blank by ifferror formulas)", "body": "<p>I have to plot a data in chart which I have made dynamic by using a named range using offset, counta(for required rows) in the chart area.</p>\n\n<p>The problem with using counta is it counts the rows which has blank cells(made blank by iferror formula),which I do not want.Moreover I cannot remove those formulas 'coz when the data is there that has to be dynamically present in the chart.</p>\n\n<pre><code>OFFSET('ABC'!$T$2,1,0,COUNTA('ABC'!$T2:$T1000),4)\n</code></pre>\n\n<p>Here; let us say the values are there for 10 rows;but the formulas are till 15 so how do I stop counta from counting the 5 rows(which have been made blank by iferror).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426065022, "post_id": 28982313, "comment_id": 46214106, "body": "On what line do you get these errors? Try stepping through your code in debug mode and watching how your variables evolve (<a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">instructions</a>). If that doesn&#39;t help, then I suggest you see this for guidance: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 99, "user_id": 3648030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5e6ca2a57c329076d4dc681b2ae07db?s=128&d=identicon&r=PG&f=1", "display_name": "Zi Kai", "link": "https://stackoverflow.com/users/3648030/zi-kai"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426065085, "post_id": 28982313, "comment_id": 46214145, "body": "ActiveSheet.OLEObjects(&quot;CheckBox&quot; &amp; i). _                     Object.Value = True"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1426065101, "post_id": 28982313, "comment_id": 46214160, "body": "Please put question clarifications in the question itself, not in comments. Your question can be edited by clicking the &quot;edit&quot; link."}], "answers": [{"tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1426066886, "creation_date": 1426066886, "answer_id": 28983024, "question_id": 28982313, "link": "https://stackoverflow.com/questions/28982313/error-1004-on-vba/28983024#28983024", "title": "Error 1004 on VBA", "body": "<p>OLEObject does <strong>not</strong> have a member called <strong>value</strong>. If you are trying to display the OLEObject, use <strong>visible</strong> instead</p>\n\n<p><code>ActiveSheet.OLEObjects(\"CheckBox\" &amp; i).Visible = True</code></p>\n\n<p>See all OLEObject members here :</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/bb242385%28v=office.12%29.aspx\" rel=\"nofollow\">OLEObject Object Members</a></p>\n"}], "owner": {"reputation": 99, "user_id": 3648030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5e6ca2a57c329076d4dc681b2ae07db?s=128&d=identicon&r=PG&f=1", "display_name": "Zi Kai", "link": "https://stackoverflow.com/users/3648030/zi-kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1426066886, "creation_date": 1426064758, "last_edit_date": 1426066572, "question_id": 28982313, "link": "https://stackoverflow.com/questions/28982313/error-1004-on-vba", "title": "Error 1004 on VBA", "body": "<p>I have five worksheet in all that are using the below code which is stored in a workbook. The first worksheet works perfectly well with the code. The second spreadsheet can check for the first item before returning the error. The subsequent third and fourth worksheet return the error immediately. The fifth worksheet on the other hand return error 400. May I know is my code the source of the problem or it's the checkbox because I copied and paste from the first worksheet. </p>\n\n<pre><code>Sub test5()\n    Dim MyFile As String\n    Dim FinalRow As Long\n    Dim Row As Long\n    Dim i As Integer\n    Dim d As Integer\n    d = 2\n    i = 0\n    FinalRow = Cells(Rows.count, \"S\").End(xlUp).Row\n    For Row = 3 To FinalRow\n         If Not IsEmpty(ActiveSheet.Cells(Row, \"S\")) Then\n                i = i + 1\n                d = d + 1\n                MyFile = ActiveSheet.Cells(Row, \"S\").Value\n                If Dir(MyFile) &lt;&gt; \"\" Then\n                    ActiveSheet.OLEObjects(\"CheckBox\" &amp; i). _\n                        Object.Value = True ' &lt;~~~~~~~~~~~~~~~~ Error occurs here\n                    With ActiveSheet.Cells(d, \"F\")\n                        .Value = Now\n                        .NumberFormat = \"dd/mm/yy\"\n                        'If (ActiveSheet.Cells(d, \"F\") - ActiveSheet.Cells(d, \"G\") &gt;= 0) Then\n                        '    ActiveSheet.Cells(d, \"F\").Font.Color = vbRed\n                        'End If\n                        If (.Value - .Offset(0, 1).Value) &gt;= 0 Then\n                            .Font.Color = vbRed\n                        Else\n                            .Font.Color = vbBlack\n                        End If\n                    End With\n                   ' i = i + 1\n                    'd = d + 1\n                End If\n         End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>The program terminates after stepping into this line of code:</p>\n\n<pre><code>ActiveSheet.OLEObjects(\"CheckBox\" &amp; i). _ Object.Value = True \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1426063605, "post_id": 28981699, "comment_id": 46213302, "body": "The functions looks correct . Could you try changing <code>cellcolor.Interior.Color</code> to <code>Range(&quot;B1&quot;).Interior.Color</code> because at the moment it appears that you are trying to assign a color to the cellcolor variable which is a <code>long</code> value rather than a range"}, {"owner": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "reply_to_user": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1426063888, "post_id": 28981699, "comment_id": 46213431, "body": "@izzymo which functions look correct? In the second example the OP is trying to assign a value to the <code>.Interior.Color</code> property of a Long, shouldn&#39;t that be raising a few alarm bells here? Pretty sure this is raising a compile-time error but the OP simply failed to include that information in their question. Lee, I&#39;m guess you&#39;re receiving an <code>invalid qualifier</code> error in your second attempt? brett gets right to the point though, Used-Defined Functions can&#39;t really affect the worksheet in this manner."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 2398, "user_id": 3725745, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bPAUN.png?s=128&g=1", "display_name": "Aiken", "link": "https://stackoverflow.com/users/3725745/aiken"}, "edited": false, "score": 0, "creation_date": 1426064451, "post_id": 28981699, "comment_id": 46213730, "body": "@aiken good pick-up, fat fingered on my behalf! I meant <a href=\"http://stackoverflow.com/questions/8520732/i-dont-want-my-excel-add-in-to-return-an-array-instead-i-need-a-udf-to-change\" title=\"i dont want my excel add in to return an array instead i need a udf to change\">stackoverflow.com/questions/8520732/&hellip;</a>"}, {"owner": {"reputation": 1321, "user_id": 4120885, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/67cbf35d9d28c5dad3891375f582776e?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/4120885/lee"}, "edited": false, "score": 0, "creation_date": 1426065749, "post_id": 28981699, "comment_id": 46214585, "body": "Thanks guys! I didn&#39;t realise that functions can&#39;t change cell colors! I&#39;ve added the fix into the original question.  Thanks again"}], "owner": {"reputation": 1321, "user_id": 4120885, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/67cbf35d9d28c5dad3891375f582776e?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/4120885/lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2348, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1426065680, "creation_date": 1426062602, "last_edit_date": 1531161705, "question_id": 28981699, "link": "https://stackoverflow.com/questions/28981699/excel-vba-custom-function-to-set-cell-color", "title": "Excel VBA custom function to set cell color", "body": "<p>I have a function like so:</p>\n\n<pre><code>Function cellcolor(r As Range) As Long\n  cellcolor = r.Interior.Color\nEnd Function\n</code></pre>\n\n<p>I then reference it in Cell B1 like so:</p>\n\n<pre><code>=cellcolor(A1)\n</code></pre>\n\n<p>The color of A1 is red, and therefore the output is 255.</p>\n\n<p>I want to set the color of B1 to match that of A1 but I'm unsure how.  Is it possible?</p>\n\n<p>I've tried:</p>\n\n<pre><code>Function cellcolor(r As Range) As Long\n  cellcolor.Interior.Color = r.Interior.Color\nEnd Function\n</code></pre>\n\n<p>But it doesn't work, any ideas?</p>\n\n<p>Thanks</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>As pointed out in the comments, a function cannot make cell format changes.  I therefore used the following:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Source As Range)\n\n  For Each ws In ActiveWorkbook.Worksheets\n    For Each cell In ws.Range(\"B1\")\n      If Len(cell.Formula) &gt; 0 Then\n        cell.Interior.ColorIndex = Range(cell.Formula).Interior.ColorIndex\n      End If\n    Next cell\n  Next ws\n\nEnd Sub\n</code></pre>\n\n<p>Basically on cell change it finds which cell B1 is looking at, gets the target cell's color and copies it.  It does this across all sheets in the workbook.</p>\n\n<p>I know it's a bit weird but serves it's purpose.  Thanks everyone!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9680, "user_id": 2054671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/egwA7.jpg?s=128&g=1", "display_name": "gaurav5430", "link": "https://stackoverflow.com/users/2054671/gaurav5430"}, "edited": false, "score": 0, "creation_date": 1426061718, "post_id": 28981422, "comment_id": 46212493, "body": "on which line does it give the error ?"}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 9680, "user_id": 2054671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/egwA7.jpg?s=128&g=1", "display_name": "gaurav5430", "link": "https://stackoverflow.com/users/2054671/gaurav5430"}, "edited": false, "score": 0, "creation_date": 1426061745, "post_id": 28981422, "comment_id": 46212507, "body": "@guarav5430 Thanks for reply, its at &quot; currentWb.Sheets(&quot;Indata&quot;).Range(&quot;A1&quot;).Value = openWs.Range(&quot;A3&quot;).Value&quot;"}, {"owner": {"reputation": 9680, "user_id": 2054671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/egwA7.jpg?s=128&g=1", "display_name": "gaurav5430", "link": "https://stackoverflow.com/users/2054671/gaurav5430"}, "edited": false, "score": 0, "creation_date": 1426061923, "post_id": 28981422, "comment_id": 46212572, "body": "have you checked that the current wrokbook has a sheet named &quot;Indata&quot; . or may be you are running it while the other workbook is active?"}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 9680, "user_id": 2054671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/egwA7.jpg?s=128&g=1", "display_name": "gaurav5430", "link": "https://stackoverflow.com/users/2054671/gaurav5430"}, "edited": false, "score": 0, "creation_date": 1426062581, "post_id": 28981422, "comment_id": 46212855, "body": "Yes it does. However I&#39;ve seen now that I have the sub KAuto, which I can find through Tools-&gt;Macros. However at the top of my current VBA Project ti says: &quot;Kal.xla.xls&quot;, can this cause problems? I&#39;ve tried to rename it but I can&#39;t find a &quot;save as&quot; but only a save"}, {"owner": {"reputation": 9680, "user_id": 2054671, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/egwA7.jpg?s=128&g=1", "display_name": "gaurav5430", "link": "https://stackoverflow.com/users/2054671/gaurav5430"}, "edited": false, "score": 1, "creation_date": 1426062792, "post_id": 28981422, "comment_id": 46212933, "body": "i dont think it might cause this error, but you may as well try saving it with correct name. to enable &quot;save as&quot; --&gt; go to menu options (a little downarrow) --&gt; more commands --&gt; save as or use keyboard shortcut Alt+F2"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1426066449, "post_id": 28981422, "comment_id": 46215024, "body": "In which workbook is the <code>KAuto</code> sub located? Is it the same as the one that has a sheet called &quot;Indata&quot;? Because that&#39;s the only possible source of this particular error."}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426067645, "post_id": 28981422, "comment_id": 46215772, "body": "@Jean-Fran&#231;oisCorbett I&#39;m not sure about this actually. When I open my workbook called &quot;Workbookxy&quot; and press Alt + F11 then I have KAuto there, and I run it. Is that what you mean? Should I rename KAuto to Workbookxy as well to &quot;include&quot; KAuto sub into the workbook?"}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426068736, "post_id": 28981422, "comment_id": 46216411, "body": "@Jean-Fran&#231;oisCorbett Added an print screen now."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 1, "creation_date": 1426071331, "post_id": 28981422, "comment_id": 46218115, "body": "I see you have a <i>sub</i> named <code>KAuto</code>, which is in a <i>module</i> which happens to also be called &quot;KAuto&quot;. Where is this module located? Can you find it in the project explorer on the left? What workbook is it in? Looks like it isn&#39;t in &quot;Workbookxy&quot;..."}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426071918, "post_id": 28981422, "comment_id": 46218546, "body": "@Jean-Fran&#231;oisCorbett Thanks for your reply! It seems as it is in one of the company&#39;s default workbooks for addins etc. I reckon that changing this would render the code feasible. How do you &quot;select&quot; which workbook to put your module in? I thought that opening the Workbook and using Alt + F11 would solve that for you, since that&#39;s been the impression I&#39;ve gotten from all the tutorials. &quot;Do this, and it will work&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1426062907, "post_id": 28981731, "comment_id": 46212985, "body": "Thanks for reply! Must go from the office now but will try that as soon as I get back. If it works for you but not me, may I lack some requisite or something?"}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1426069262, "post_id": 28981731, "comment_id": 46216744, "body": "Added those lines and got &quot;Automation fault &#39;-2147221080 (800401a8)"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1426072438, "post_id": 28981731, "comment_id": 46218869, "body": "Did you try the code <i>without</i> the <code>Application.Wait (Now + TimeValue(&quot;00:00:03&quot;))</code> first? Just switching from <code>ThisWorkbook</code> to <code>ActiveWorkbook</code>?"}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1426073387, "post_id": 28981731, "comment_id": 46219444, "body": "Thanks! This works! Have any idea as to whether it does not work with Application.Wait? Or why ActiveWorkbook works but not ThisWorkbook. Does ThisWorkbook reference in the way that Jean-Fran&#231;ois Corbett  saw that I&#39;ve done wrong, whereas ActiveWorkbook does not need this reference? Thanks again!"}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 1, "creation_date": 1426073705, "post_id": 28981731, "comment_id": 46219640, "body": "Exactly, you were on a good track there. <code>ThisWorkbook</code> is a workbook, where the code is running from. You have put it into the addin workbook and there it cannot find the <code>.Sheets(&quot;Indata&quot;)</code>. Hence the error. <code>ActiveWorkbook</code> on the other hand is run from currently active workbook, the one that has &quot;focus&quot;, so it will work, because there is the sheet <code>.Sheets(&quot;Indata&quot;)</code>. I would still recomend <b>NOT</b> putting your code into the AddIn workbook, but into your own <i>Workbookxy</i> into separate module. As for the <code>Application.Wait</code> I dont know, but that was a wild guess. Dont worry abou that. :)"}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1426073949, "post_id": 28981731, "comment_id": 46219832, "body": "Does this practice of putting code into workbooks etc have a name, or is it called something? Haven&#39;t read of this, but reckon I really should read some documentation or something on the matter."}, {"owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "reply_to_user": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 1, "creation_date": 1426074674, "post_id": 28981731, "comment_id": 46220292, "body": "I don&#39;t know about any specific term that applies to this practice. I learned it the <i>same way you did</i>. Trial and error. It is easy to overlook where you are putting your code. You will just have to pay attention. That&#39;s all. Good luck."}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1426074835, "post_id": 28981731, "comment_id": 46220403, "body": "I will definitely pay more attention to this! Thanks again!"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426075147, "post_id": 28981731, "comment_id": 46220604, "body": "I took the liberty of adding some documentation to this answer, to explain what&#39;s going on."}], "tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": true, "score": 1, "last_activity_date": 1426075429, "last_edit_date": 1426075429, "creation_date": 1426062736, "answer_id": 28981731, "question_id": 28981422, "link": "https://stackoverflow.com/questions/28981422/vba-subscript-out-of-range-code-9/28981731#28981731", "title": "VBA subscript out of range, code 9", "body": "<p>Try using <code>ActiveWorkbook</code> instead of <code>ThisWorkbook</code>.</p>\n\n<pre><code>Set currentWb = ActiveWorkbook\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193227.aspx\" rel=\"nofollow\"><code>ThisWorkbook</code></a> refers to the workbook in which the code resides. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821871.aspx\" rel=\"nofollow\"><code>ActiveWorkbook</code></a> refers to the workbook that is currently active i.e. \"on top\" in the Excel application. It looks like your case, the code resides in a different workbook; so what you want is <code>ActiveWorkbook</code>.</p>\n\n<p>And you <em>can</em> ommit the <code>.value</code> from last line.</p>\n\n<p><code>currentWb.Sheets(\"Indata\").Range(\"A1\") = openWs.Range(\"A3\")</code></p>\n\n<p>Your code worked fine for me, that`s why I cannot be sure if it will help. <br><strike>There can be an issue, when opening the openWs. The <em>error line</em> can be evaluated before the openWs is actually open. Then maybe add a line :</p>\n\n<pre><code>Application.Wait (Now + TimeValue(\"00:00:03\")) 'this is 3 seconds from now\n</code></pre>\n\n<p><strong>after</strong> the <code>Set openWb = Workbooks.Open(path)</code>.</strike></p>\n"}], "owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 28981731, "answer_count": 1, "score": 1, "last_activity_date": 1426075429, "creation_date": 1426061567, "last_edit_date": 1531161705, "question_id": 28981422, "link": "https://stackoverflow.com/questions/28981422/vba-subscript-out-of-range-code-9", "title": "VBA subscript out of range, code 9", "body": "<p>I'm conducting my very first VBA macro and I'm having some difficulties with this seemingly easy code to read data from a closed workbook into my currently opened one. </p>\n\n<pre><code>Sub KAuto()\n\n   Dim path As String\n   path = \"C:\\files\\Utfall.xlsx\"\n   Dim currentWb As Workbook\n   Set currentWb = ThisWorkbook\n   Dim openWb As Workbook\n   Set openWb = Workbooks.Open(path)\n   Dim openWs As Worksheet\n   Set openWs = openWb.Sheets(\"March\")\n   currentWb.Sheets(\"Indata\").Range(\"A1\").Value = openWs.Range(\"A3\").Value\nEnd Sub\n</code></pre>\n\n<p>The problem I'm having is that I get a code 9, subscript out of range. But I've checked that A1 and A3 is existent for the current workbook and the imported one respectively. </p>\n\n<p>What I have tried to do is to omit the \".Value\" in all combinations, as that was what the original author did. </p>\n\n<p>Googling this problem I've encountered that people misused functions which I do not use, for instance windows(), or omitted \"\" for referencing the worksheets, or  simply misspelled things. I don't Think I have any of these, and so I need further help.</p>\n\n<p>How can I correct my subscript out of range? Is there a better way to achieve this copying of cells? In the future I want to import 10 files, will this then be obsolete? (I recall someone posting something in the lines of openWb = [file1,file2,file3] and looping through them, but I cannot find it; does anyone have a link? </p>\n\n<p>EDIT: I've copied the path to the file from its properties, so it ought to be correct. </p>\n\n<p>EDIT2:  </p>\n\n<pre><code>  currentWb.Sheets(\"Indata\").Range(\"A1\").Value = openWs.Range(\"A3\").Value \n</code></pre>\n\n<p>snippet gives the error </p>\n\n<p>EDIT3: VB editor print screen:</p>\n\n<p><img src=\"https://i.stack.imgur.com/hMkev.jpg\" alt=\"VBA editor print screen\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2133, "user_id": 4636801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8WXZU.png?s=128&g=1", "display_name": "kolcinx", "link": "https://stackoverflow.com/users/4636801/kolcinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1426066281, "creation_date": 1426066281, "answer_id": 28982797, "question_id": 28981412, "link": "https://stackoverflow.com/questions/28981412/invalid-qualifier-error-in-vba-while-renaming-with-search-criteria/28982797#28982797", "title": "invalid qualifier error in VBA while renaming with search criteria", "body": "<pre><code>Sub FindAndRenameSheets()\n\nDim ws As Worksheet 'changed from Workbook\n\nFor Each ws In Worksheets\n    With ws\n        If Not .Range(\"A:A\").Find(what:=\"Summary Compensation Table\", LookIn:=xlValues) Is Nothing Then\n            .Name = \"Summary Compensation Table\"\n        ElseIf Not .Range(\"A:A\").Find(\"Components of Pay\", LookIn:=xlValues) Is Nothing Then\n            .Name = \"Components of Pay\"\n        ElseIf Not .Range(\"A:A\").Find(\"Target Bonus &amp; Most Recent Pay\") Is Nothing Then\n            .Name = \"Target Bonus &amp; Most Recent Pay\"\n        ElseIf Not .Range(\"A:A\").Find(\"Cash &amp; Equity Benchmarking\") Is Nothing Then\n            .Name = \"Cash &amp; Equity Benchmarking\"\n        Else\n            MsgBox \"Not Found on sheet: \" &amp; .Name\n        End If\n    End With\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 4073935, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/13ecac1ecbe32dbaa46774767ca953e4?s=128&d=identicon&r=PG&f=1", "display_name": "Unicorn", "link": "https://stackoverflow.com/users/4073935/unicorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 28982797, "answer_count": 1, "score": 0, "last_activity_date": 1426066281, "creation_date": 1426061497, "last_edit_date": 1531161705, "question_id": 28981412, "link": "https://stackoverflow.com/questions/28981412/invalid-qualifier-error-in-vba-while-renaming-with-search-criteria", "title": "invalid qualifier error in VBA while renaming with search criteria", "body": "<p>i am writing a code to rename the existing sheets as per search criteria.\neg. if sheet1 in A:A range contains name \"Demo\" then rename it to \"NewDemo\"\nhere is my code but i am getting invalid qualifier error.</p>\n\n<pre><code>Dim s As String\n     Dim ws As Workbook\n\n     s = ActiveWorkbook.Worksheets.Count                            'returns no of sheets in excel\n     Set ftab = Range(\"A:A\").Find(\"Summary Compensation Table\")     'find key from 1st tab\n     Set stab = Range(\"A:A\").Find(\"Components of Pay\")              'find key from 2st tab\n     Set ttab = Range(\"A:A\").Find(\"Target Bonus &amp; Most Recent Pay\") 'find key from 3st tab\n     Set fotab = Range(\"A:A\").Find(\"Cash &amp; Equity Benchmarking\")     'find key from 4st tab\n     For Each ws In Worksheets\n     s = ActiveWorkbook.Sheets(1).Activate\n       If s.Contains(ftab) Then\n       ActiveSheet.Name = \"Summary Compensation Table\"\n     s = ActiveWorkbook.Sheets(2).Activate\n       If s.Contains(stab) Then\n       ActiveSheet.Name = \"Components of Pay\"\n     s = ActiveWorkbook.Sheets(3).Activate\n       If s.Contains(ttab) Then\n       ActiveSheet.Name = \"Target Bonus &amp; Most Recent Pay\"\n     s = ActiveWorkbook.Sheets(4).Activate\n       If s.Contains(fotab) Then\n       ActiveSheet.Name = \"Cash &amp; Equity Benchmarking\"\n\n       Else\n       MsgBox \"Not Found\"\n       MsgBox ws.Name\n     Next ws\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 2, "creation_date": 1426066560, "post_id": 28980987, "comment_id": 46215097, "body": "Access default is to save, you have to do quite a lot to prevent a save. You should post the event(s) you are using."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1426074761, "creation_date": 1426074761, "answer_id": 28985943, "question_id": 28980987, "link": "https://stackoverflow.com/questions/28980987/error-handling-ms-access/28985943#28985943", "title": "Error Handling MS Access", "body": "<p>Use the BeforeUpdate event to validate and possibly to prevent an update, and the AfterUpdate event to display a confirming message.</p>\n"}], "owner": {"reputation": 1, "user_id": 3317017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a7f05dfc2dc3b5f54e987070475ce8?s=128&d=identicon&r=PG&f=1", "display_name": "user3317017", "link": "https://stackoverflow.com/users/3317017/user3317017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426074761, "creation_date": 1426059619, "last_edit_date": 1426066393, "question_id": 28980987, "link": "https://stackoverflow.com/questions/28980987/error-handling-ms-access", "title": "Error Handling MS Access", "body": "<p>Hi what I am trying to achieve is saving a record from a form with error handling:</p>\n\n<ul>\n<li><p>MSGBOX \"Success! Do you want to add a new record?\" [Yes/No] form is saved.  </p></li>\n<li><p>New record, clear field Me.Serial</p></li>\n<li>MSGBOX \"Something went wrong, please complete relevant fields\"</li>\n</ul>\n\n<p>What i have tried so far is:</p>\n\n<pre><code>On Error GoTo Err_cmdCloseForm_Click8\nDoCmd.RunCommand acCmdSaveRecord\nMsgBox \"item successfully checked out\"\nDoCmd.Close\n\nExit_cmdCloseForm_Click:\n Exit Sub\n\nErr_cmdCloseForm_Click8:\n MsgBox \"Save was unsuccessful, please try again\", vbInformation, \"Warning\"\n Resume Exit_cmdCloseForm_Click\n</code></pre>\n\n<p>Field [Serial] is required, yet when i click save with no information entered into any field i receive a success message. Any thoughts or links would be greatly appreciated.</p>\n\n<p>Regards</p>\n\n<p>J</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "edited": false, "score": 0, "creation_date": 1426064622, "post_id": 28980919, "comment_id": 46213858, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/gg264384%28v=office.14%29.aspx\" rel=\"nofollow noreferrer\"><code>=</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "is_accepted": false, "score": 1, "last_activity_date": 1426059885, "creation_date": 1426059885, "answer_id": 28981054, "question_id": 28980919, "link": "https://stackoverflow.com/questions/28980919/get-the-exact-match-of-two-text-using-instr/28981054#28981054", "title": "Get the Exact match of two text using instr", "body": "<p>Why use <code>InStr</code> ? You can easily check if 2 strings match by using the <code>=</code> .</p>\n\n<p>Anyway, let's say that you are somehow forced to use it, I would check first if a string is contained in the second, then if the second is contained in the first. That should do it, but to be totally sure you could also check if the lengths are equal:</p>\n\n<pre><code>If InStr(1, arrcallpara(i), strvarcalll) &lt;&gt; 0 And InStr(1, strvarcalll, arrcallpara(i)) &lt;&gt; 0 And Len(arrcallpara(i)) = Len(strvarcalll)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 4649868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda9c44764a7bb90c8ef16b3c8c30fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Subbu", "link": "https://stackoverflow.com/users/4649868/subbu"}, "edited": false, "score": 0, "creation_date": 1426150993, "post_id": 28982346, "comment_id": 46257204, "body": "I have tried strcomp function , but still the if loop is getting failed.  If StrComp(CStr(arrcallpara(i)), CStr(strvarcalll)) = 0 Then                 blncalling = True                End If  The Values for arrcallpara(i) = &quot;Subscription-Id-Address: 1787663273&quot; &amp; strvarcalll = &quot;Subscription-Id-Address: 1787663273&quot;.  Do i have to use any other function to compare the above strings ?  Please help thanks"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 51, "user_id": 4649868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda9c44764a7bb90c8ef16b3c8c30fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Subbu", "link": "https://stackoverflow.com/users/4649868/subbu"}, "edited": false, "score": 0, "creation_date": 1426152398, "post_id": 28982346, "comment_id": 46257903, "body": "I tested your code and couldn&#39;t reproduce your issue. The code worked as expected. You will have to give us enough information to reproduce the problem, else we can&#39;t help. See this for guidance: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 51, "user_id": 4649868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda9c44764a7bb90c8ef16b3c8c30fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Subbu", "link": "https://stackoverflow.com/users/4649868/subbu"}, "edited": false, "score": 0, "creation_date": 1426157311, "post_id": 28982346, "comment_id": 46260760, "body": "Jean , Added a watch on the above 2 variables. Found the below result .  For arrcallpara(i) , the value considering as  &quot;   Subscription-Id-Address: 1787663273&quot;  and for strvarcalll, the value considering as  &quot;  Subscription-Id-Address: 1787663273&quot;  May i know how can i change arrcallpara(i) from above mentioned style to normal syntax &quot;  Subscription-Id-Address: 1787663273&quot;."}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 51, "user_id": 4649868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda9c44764a7bb90c8ef16b3c8c30fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Subbu", "link": "https://stackoverflow.com/users/4649868/subbu"}, "edited": false, "score": 0, "creation_date": 1426159329, "post_id": 28982346, "comment_id": 46262098, "body": "Why are you making this so hard for us? What&#39;s the difference between all these strings? Did you consult the link in my previous comment?"}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": false, "score": 1, "last_activity_date": 1426064860, "creation_date": 1426064860, "answer_id": 28982346, "question_id": 28980919, "link": "https://stackoverflow.com/questions/28980919/get-the-exact-match-of-two-text-using-instr/28982346#28982346", "title": "Get the Exact match of two text using instr", "body": "<p>You could use <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264346%28v=office.14%29.aspx\" rel=\"nofollow\"><code>StrComp</code></a></p>\n\n<pre><code>If StrComp(arrcallpara(i), strvarcalll) = 0 Then\n</code></pre>\n\n<p>or just plain old <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264384%28v=office.14%29.aspx\" rel=\"nofollow\"><code>=</code></a></p>\n\n<pre><code>If arrcallpara(i) = strvarcalll Then\n</code></pre>\n\n<p>But more than that, your <code>If</code> is unnecessary clutter. Just say:</p>\n\n<pre><code>blncalling = (arrcallpara(i) = strvarcalll)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>blncalling = (StrComp(arrcallpara(i), strvarcalll) = 0)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4649868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dda9c44764a7bb90c8ef16b3c8c30fc8?s=128&d=identicon&r=PG&f=1", "display_name": "Subbu", "link": "https://stackoverflow.com/users/4649868/subbu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8519, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1426152423, "creation_date": 1426059308, "last_edit_date": 1531164843, "question_id": 28980919, "link": "https://stackoverflow.com/questions/28980919/get-the-exact-match-of-two-text-using-instr", "title": "Get the Exact match of two text using instr", "body": "<p>How can i match exactly the two texts in <code>InStr</code> function ?</p>\n\n<p>Right now my code is like below</p>\n\n<pre><code>If InStr(1, arrcallpara(i), strvarcalll) &gt; 0 Then\n  blncalling = True\nEnd If\n</code></pre>\n\n<p>arrcallpara(i) contains value \"1234\" or \"12345\" or \"1234567\" and strvarcalll contains \"1234567\"</p>\n\n<p>The \"If\" condition should be satisfied only when there is exact match between arrcallpara(i) and strvarcalll.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 258, "user_id": 2075446, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a7c1e141282bf05b739535fec7cd204?s=128&d=identicon&r=PG", "display_name": "juanchoelx", "link": "https://stackoverflow.com/users/2075446/juanchoelx"}, "edited": false, "score": 0, "creation_date": 1426509430, "post_id": 28994272, "comment_id": 46387316, "body": "It&#39;s a great idea!! Thanks!!"}], "tags": [], "owner": {"reputation": 77, "user_id": 4389518, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8398fb66030276c0d4498a544944b844?s=128&d=identicon&r=PG&f=1", "display_name": "rmh", "link": "https://stackoverflow.com/users/4389518/rmh"}, "is_accepted": true, "score": 1, "last_activity_date": 1426097516, "creation_date": 1426097516, "answer_id": 28994272, "question_id": 28980809, "link": "https://stackoverflow.com/questions/28980809/vba-access-create-a-new-button-in-a-2010-access-form/28994272#28994272", "title": "VBA Access: Create a new button in a 2010 Access form", "body": "<p>There is a much easier way to accomplish what you want. You can create the button on the form add make Visible = False on the property sheet. Then your code would just be:</p>\n\n<pre><code>Private Sub Command2_Click()\nMe.Command3.Visible = True\nEnd Sub\n</code></pre>\n\n<p>Then when you click the button it would make the button appear on the form. What are you trying to accomplish by creating the command button? Is there a reason this method is insufficient?</p>\n"}], "owner": {"reputation": 258, "user_id": 2075446, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7a7c1e141282bf05b739535fec7cd204?s=128&d=identicon&r=PG", "display_name": "juanchoelx", "link": "https://stackoverflow.com/users/2075446/juanchoelx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 28994272, "answer_count": 1, "score": 0, "last_activity_date": 1426097516, "creation_date": 1426058854, "last_edit_date": 1426059508, "question_id": 28980809, "link": "https://stackoverflow.com/questions/28980809/vba-access-create-a-new-button-in-a-2010-access-form", "title": "VBA Access: Create a new button in a 2010 Access form", "body": "<p>I am trying to create a new button on a form Access 2010. If I click on a button to create a new button on the form, but I can not create the button if the form view is different from the design view (Error 6062: You must be in Design or Layout View to create or delete controls). How I can create the button with VBA code? Thanks.</p>\n\n<pre><code>  Private Sub Command2_Click()\n     Dim boton As CommandButton\n\n     Set boton = CreateControl(Me.Name, acCommandButton, acFooter)\n        With newButton\n            .Visible = True\n            .Enabled = True\n            .Caption = \"prueba\"\n        End With\n  End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 2493, "user_id": 2146688, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/957053ea735be465a77bc786c523b5c8?s=128&d=identicon&r=PG", "display_name": "Chel", "link": "https://stackoverflow.com/users/2146688/chel"}, "edited": false, "score": 0, "creation_date": 1426059400, "post_id": 28980643, "comment_id": 46211551, "body": "You can just stick an <code>On Error GoTo 0</code> after the <code>Do Until</code> line, and that will resume default error handling. But that is also an easy way to get an infinite loop."}], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 4530736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6208429024e57400212be4e75a9cf6?s=128&d=identicon&r=PG&f=1", "display_name": "JohnCitezen", "link": "https://stackoverflow.com/users/4530736/johncitezen"}, "edited": false, "score": 0, "creation_date": 1426075336, "post_id": 28981051, "comment_id": 46220715, "body": "Thanks Heaps, I forgot that was possible."}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": true, "score": 3, "last_activity_date": 1426064420, "last_edit_date": 1426064420, "creation_date": 1426059878, "answer_id": 28981051, "question_id": 28980643, "link": "https://stackoverflow.com/questions/28980643/ignore-subscript-out-of-range-error-once-to-deal-with-first-iteration/28981051#28981051", "title": "Ignore &quot;subscript out of range&quot; error once, to deal with first iteration", "body": "<p>There are certain exceptional circumstances in which there is no choice but to use <code>On Error Resume Next</code> for flow control \u2014 but this isn't one of them. In this case it will just cause you pain. </p>\n\n<p>By moving your logic around a little bit, you can deal with the first iteration edge case much more simply. For example, the stopping criterion check can be moved to the bottom of your loop like this:</p>\n\n<pre><code>Do\n\n    '... code to calculate projectile position at this time step...\n\n    'Advance to next time step\n    t = t + h\n    i = i + 1\n\n    'Get out when projectile falls below target height AND is on descent\nLoop Until y(i - 1) &lt; TargetAlt And y(i - 1) &lt; y(i - 2)\n</code></pre>\n"}], "owner": {"reputation": 28, "user_id": 4530736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6208429024e57400212be4e75a9cf6?s=128&d=identicon&r=PG&f=1", "display_name": "JohnCitezen", "link": "https://stackoverflow.com/users/4530736/johncitezen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 990, "favorite_count": 0, "accepted_answer_id": 28981051, "answer_count": 1, "score": 1, "last_activity_date": 1593759288, "creation_date": 1426058174, "last_edit_date": 1593759288, "question_id": 28980643, "link": "https://stackoverflow.com/questions/28980643/ignore-subscript-out-of-range-error-once-to-deal-with-first-iteration", "title": "Ignore &quot;subscript out of range&quot; error once, to deal with first iteration", "body": "<p>I am making a loop that calculates the trajectory of a projectile and want the loop to stop when the projectile is at the same height as the target AND the projectile is on the decent. This is ensured by the Do Until... line. However, when the loop starts y(i-2) does not exist [y(-1)], resulting in a \"runtime error '9' - subscript out of range\". Using \"On Error Resume Next\" does allow the loop to continue but I often make mistakes and certainly will when adding more things to the loop (e.g. moving target, yaw, wind, etc.). For this reason I would like vba to ignore the runtime error only once and break on any following errors.</p>\n\n<p>The relevant section of code is as follows:</p>\n\n<pre><code>vx(0) = V * Cos(Theta)  'set the initial conditions\nvy(0) = V * Sin(Theta)\nvz(0) = 0\nx(0) = 0\ny(0) = 0\nz(0) = 0\ni = 1\nt = 0\n\nOn Error Resume Next\nDo Until y(i - 1) &lt; TargetAlt And y(i - 1) &lt; y(i - 2)   'Stop when the projectile is at the same height\n                                                                                 'as the target AND the projectile in on the\n                                                                                 'decent of its trajectory\n\n    'If the projectile is moving up then drag and gravity are working together\n    'If not drag is working against gravity.\n    If vy(i - 1) &gt; 0 Then\n            vy(i) = vy(i - 1) + h * (-g - (DragCof * (vy(i - 1) ^ 2)))\n    Else: vy(i) = vy(i - 1) + h * (-g + (DragCof * (vy(i - 1) ^ 2)))\n    End If\n\n    'The y position of the projectile\n    y(i) = y(i - 1) + h * (vy(i - 1))\n\n    'x direction velocity\n    vx(i) = vx(i - 1) + h * (-DragCof * (vx(i - 1) ^ 2))\n    'The x position of the projectile\n    x(i) = x(i - 1) + h * (vx(i - 1))\n\n    'z direction velocity\n    'The z position of the projectile\n\n    'parameters\n    t = t + h\n    i = i + 1\n\nLoop\n</code></pre>\n\n<p>Starting the loop at i = 2 and adjusting the initial conditions accordingly would potentially work however I would like to avoid this if possible.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1426062025, "post_id": 28980566, "comment_id": 46212620, "body": "First off, <code>Private Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds As Long)</code> should be <code>Declare Sub Sleep Lib &quot;kernel32&quot; (ByVal dwMilliseconds As Long)</code> and second, what are you trying to fetch? The store names?"}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1426091930, "post_id": 28980566, "comment_id": 46232771, "body": "Hi,First accept my thanks for your response.I am trying to get business names,address,telephone numbers.Kind regards"}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1426105508, "post_id": 28980566, "comment_id": 46241397, "body": "You need to figure out what tags are holding in the data you need from the source code of the page. Get those tags and strip them from everything that you don&#39;t need and display the data in the range of your desire. Most of it is pretty much done for you. I tried your code and the reason why it is not returning something is because <code>media-block clearfix media-block-large main-attributes</code> does not exist in the source code of your target page."}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1426142214, "post_id": 28980566, "comment_id": 46253472, "body": "Thanks for pointing out.Going to try it out"}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1426144050, "post_id": 28980566, "comment_id": 46254114, "body": "Still not working.Can anyone help?"}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1427017818, "post_id": 28980566, "comment_id": 46599486, "body": "Any help or any point outs??"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1426168764, "post_id": 29005082, "comment_id": 46268530, "body": "Hi,thanks for your time and efforts.Problem is still same, not getting any results.Am trying to debug.will post result if i can make it to work.Kind Regards"}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1426226345, "post_id": 29005082, "comment_id": 46293717, "body": "Not getting any errors, code seems to be running endlessly without any output."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1426233915, "post_id": 29005082, "comment_id": 46296496, "body": "It works fine bro. Is there anything blocking IE when it starts? <a href=\"http://s000.tinyupload.com/index.php?file_id=04097054447765086803\" rel=\"nofollow noreferrer\">s000.tinyupload.com/index.php?file_id=04097054447765086803</a>"}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1426242898, "post_id": 29005082, "comment_id": 46301210, "body": "Still same for me, Even using file you provided.Nothing is blocking IE. I checked it with IE visible option."}, {"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "reply_to_user": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1426244336, "post_id": 29005082, "comment_id": 46302064, "body": "How does your IE take time to load up and load up the page?"}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1426424520, "post_id": 29005082, "comment_id": 46358016, "body": "IE loads fine. Does less than in 5 seconds"}, {"owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "edited": false, "score": 0, "creation_date": 1427734578, "post_id": 29005082, "comment_id": 46889085, "body": "Thanks, I was missing a simple step.Working fine"}], "tags": [], "owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "is_accepted": true, "score": 0, "last_activity_date": 1426149375, "creation_date": 1426149375, "answer_id": 29005082, "question_id": 28980566, "link": "https://stackoverflow.com/questions/28980566/vba-code-running-but-not-fetching-data/29005082#29005082", "title": "vba code running but not fetching data", "body": "<p>There's a lot of work to be done.</p>\n\n<p>Here's something that you can start with. Hopefully, you will be able to find the other pieces of information using the same logic. This will print business names in the immediate window. I've found the business names in meta tag description.</p>\n\n<p>I've changed the sleep amount to 5 seconds. IE will be able to fully load and the rest of the code will be processed reliably. The initial 200 milliseconds gave results once every couple of runs. I guess this depends how fast your computer is so 5 seconds is pretty safe I guess.</p>\n\n<pre><code>Option Explicit\n\nDeclare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\nSub find()\n\n'Uses late binding, or add reference to Microsoft HTML Object Library\n'  and change variable Types to use intellisense\n Dim returnstring As String 'this is going to hold boutiques names\nDim ie As Object 'InternetExplorer.Application\nDim html As Object 'HTMLDocument\nDim meta As Object 'IHTMLElementCollection\nDim l As Object 'IHTMLElement\nDim r As Long\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = False\n        .Navigate \"http://www.yelp.com/search?find_desc=boutique&amp;find_loc=New+York%2C+NY&amp;ns=1&amp;ls=3387133dfc25cc99#start=10\"\n        ' Don't show window\n        'Wait until IE is done loading page\n        Do While .readyState &lt;&gt; 4\n            Application.StatusBar = \"Downloading information, Please wait...\"\n            DoEvents\n            Sleep 5000\n        Loop\n        Set html = .Document\n    End With\n    Set meta = html.GetElementsByTagName(\"META\") ' ## returns attribures\n    Dim m As Object\n\n    For Each m In meta\n    If InStr(m.Content, \"Reviews on Boutique in New York -\") &gt; 0 Then\n    returnstring = Replace(m.Content, \"Reviews on Boutique in New York -\", \"\")\n    End If\n    Next\n    Dim i As Integer\n    For i = 0 To UBound(Split(returnstring, \",\"))\n    Debug.Print (Split(returnstring, \",\")(i))\n    Next\nSet html = Nothing\nSet ie = Nothing\nEnd Sub\n</code></pre>\n\n<p>Myoutput:\n<img src=\"https://i.stack.imgur.com/NIRTY.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 55, "user_id": 3563673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5c95b38c182f2e76ea3f0cdba0d0ac?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/3563673/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 29005082, "answer_count": 1, "score": 1, "last_activity_date": 1426149375, "creation_date": 1426057896, "last_edit_date": 1531164843, "question_id": 28980566, "link": "https://stackoverflow.com/questions/28980566/vba-code-running-but-not-fetching-data", "title": "vba code running but not fetching data", "body": "<p>I am new to vba.</p>\n\n<p>I am trying to use below code by David Zemens to fetch data from yelp</p>\n\n<pre><code>Option Explicit\nPrivate Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\nSub find()\n'Uses late binding, or add reference to Microsoft HTML Object Library \n'  and change variable Types to use intellisense\nDim ie As Object 'InternetExplorer.Application\nDim html As Object 'HTMLDocument\nDim Listings As Object 'IHTMLElementCollection\nDim l As Object 'IHTMLElement\nDim r As Long\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = False\n        .Navigate \"http://www.yelp.com/search?find_desc=boutique&amp;find_loc=New+York%2C+NY&amp;ns=1&amp;ls=3387133dfc25cc99#start=10\"\n        ' Don't show window\n        'Wait until IE is done loading page\n        Do While .readyState &lt;&gt; 4\n            Application.StatusBar = \"Downloading information, Please wait...\"\n            DoEvents\n            Sleep 200\n        Loop\n        Set html = .Document\n    End With\n    Set Listings = html.getElementsByTagName(\"LI\") ' ## returns the list\n    For Each l In Listings\n        '## make sure this list item looks like the listings Div Class:\n        '   then, build the string to put in your cell\n        If InStr(1, l.innerHTML, \"media-block clearfix media-block-large main-attributes\") &gt; 0 Then\n            Range(\"A1\").Offset(r, 0).Value = l.innerText\n            r = r + 1\n        End If\n    Next\n\nSet html = Nothing\nSet ie = Nothing\nEnd Sub\n</code></pre>\n\n<p>Problem is that it's not getting any data from the source. </p>\n\n<p>Regards</p>\n"}, {"tags": ["string", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4291803, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kISaSInRRbI/AAAAAAAAAAI/AAAAAAAADt0/tTDbsrhtkxQ/photo.jpg?sz=128", "display_name": "Nitin_Alex", "link": "https://stackoverflow.com/users/4291803/nitin-alex"}, "edited": false, "score": 0, "creation_date": 1426496198, "post_id": 28981185, "comment_id": 46379825, "body": "thank you @leekaiinthesky this solution worked for me :)"}], "tags": [], "owner": {"reputation": 4731, "user_id": 1716866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/411da970ac5de2f1a0d66a10741b0e9c?s=128&d=identicon&r=PG", "display_name": "leekaiinthesky", "link": "https://stackoverflow.com/users/1716866/leekaiinthesky"}, "is_accepted": true, "score": 0, "last_activity_date": 1426060479, "creation_date": 1426060479, "answer_id": 28981185, "question_id": 28980557, "link": "https://stackoverflow.com/questions/28980557/how-to-extract-a-value-after-a-colon-that-comes-after-a-search-word-in-excel-vba/28981185#28981185", "title": "how to extract a value after a colon that comes after a search word in excel vba", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub getSourceTotalRecords()\n    target = \"Source Total Records\"\n\n    inputData = Cells(1, 1) 'or wherever your text is\n    dataLines = Split(inputData, vbNewLine)\n\n    For Each l In dataLines\n        If Left(l, Len(target)) = target Then\n            colonLocation = InStr(l, \":\")\n            MsgBox Mid(l, colonLocation + 1)\n            Exit For 'if you're not looking for multiple hits\n        End If\n    Next l\nEnd Sub\n</code></pre>\n\n<p>This will <code>MsgBox</code> the value. You might want to change that to do something else with it. You could adapt this to take the <code>target</code> as an argument as well, if you want to retrieve other data.</p>\n"}, {"tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": false, "score": 1, "last_activity_date": 1426060633, "creation_date": 1426060633, "answer_id": 28981219, "question_id": 28980557, "link": "https://stackoverflow.com/questions/28980557/how-to-extract-a-value-after-a-colon-that-comes-after-a-search-word-in-excel-vba/28981219#28981219", "title": "how to extract a value after a colon that comes after a search word in excel vba", "body": "<p>A non-VBA solution (if your source text is in cell <code>A1</code>):</p>\n\n<pre><code>A2: =SEARCH(\":\",A1,SEARCH(\"Source Total Records\",A1))\nA3: =SEARCH(CHAR(10),A1,A2)\nA4: =VALUE(MID(A1,A2+2,A3-A2-2))\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4291803, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kISaSInRRbI/AAAAAAAAAAI/AAAAAAAADt0/tTDbsrhtkxQ/photo.jpg?sz=128", "display_name": "Nitin_Alex", "link": "https://stackoverflow.com/users/4291803/nitin-alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1782, "favorite_count": 0, "accepted_answer_id": 28981185, "answer_count": 2, "score": 0, "last_activity_date": 1426066934, "creation_date": 1426057865, "last_edit_date": 1426066934, "question_id": 28980557, "link": "https://stackoverflow.com/questions/28980557/how-to-extract-a-value-after-a-colon-that-comes-after-a-search-word-in-excel-vba", "title": "how to extract a value after a colon that comes after a search word in excel vba", "body": "<p>I have the below data in a single cell in excel.\nI need to write a VBA excel macro to extract some data from the below data.</p>\n\n<pre><code>****************** AUDIT REPORT RUN STATISTICS***********\n\nEnvironment                   : PROD\n\nJob Name                      : CLM_E_CLMHUB_GDWCLM_4017_D_MAIG\n\nServer Name                   : etlprod-grid.ent.rt.csaa.com\n\nServer IP Address             : 172.26.137.11\n\nSource Success Count          ( s_m_extract_maig_req / V_GW_INT_CLS_MAIG ) : 691\n\nSource Reject Count           ( s_m_extract_maig_req / V_GW_INT_CLS_MAIG ) : 0\n\nTarget Success Count          ( s_m_extract_maig_req / CLM_E_CLMHUB_GDWCLM_4017_D_MAIG.xml ) : 691\n\nTarget  Reject Count          ( s_m_extract_maig_req / CLM_E_CLMHUB_GDWCLM_4017_D_MAIG.xml ) : 0\n\nSUMMARY\n\nSource Total Records          : 691\n\nTarget Total Records          : 691\n\nETL Start                     : 02/25/2015 21:30:00\n\nETL End                       : 02/25/2015 21:30:15\n\nETL Duration(HH:MI:SS)        : 00 days 00:00:15\n\nBusiness Day                  : 02/25/2015 21:30:16\n\nRun Day                       : 2015-02-25T00:00:00-07:00\n\nStatus                        : JOB_ENDED_SUCCESSFULLY\n</code></pre>\n\n<p>I need to fetch the values for <em>Source Total Records</em> by searching the same text and fetching the number that comes after the next colon and before the next new line.(i.e 691)\nIs there any string function that can be used to search any word(say,<em>Source Total Records</em>) and to find the position of the succeeding colon(:) and to extract the text to the right of the colon.</p>\n\n<p>I am sorry if my question is long or vague.\nAny clarification needed is welcome.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1426060568, "post_id": 28980453, "comment_id": 46212067, "body": "How exactly is <code>With Workbooks(&quot;KVP.xlsm&quot;).Worksheets(GlbVarBaseSheet) </code> not working - do you get an error?  Which one?  What is the value of <code>GlbVarBaseSheet</code> at this line when it fails (set a breakpoint there to check)?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1426069253, "post_id": 28980453, "comment_id": 46216739, "body": "Is the <code>Public GlbVarBaseSheet As String</code> routine in a worksheet code module? If so you need to either move it to a normal module, or refer to <code>Sheet1.GlbVarBaseSheet</code> when using the variable from other modules (where <code>Sheet1</code> represents the codename for your worksheet)."}, {"owner": {"reputation": 398, "user_id": 2104767, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c751c78fb9d6d3e08b6fd6b28d963420?s=128&d=identicon&r=PG", "display_name": "Daniel4711", "link": "https://stackoverflow.com/users/2104767/daniel4711"}, "edited": false, "score": 0, "creation_date": 1426154667, "post_id": 28980453, "comment_id": 46259160, "body": "Don&#180;t know why.. but now.. it works without any Problem. thx. for reply!"}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 4530736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6208429024e57400212be4e75a9cf6?s=128&d=identicon&r=PG&f=1", "display_name": "JohnCitezen", "link": "https://stackoverflow.com/users/4530736/johncitezen"}, "is_accepted": false, "score": 0, "last_activity_date": 1426058624, "creation_date": 1426058624, "answer_id": 28980757, "question_id": 28980453, "link": "https://stackoverflow.com/questions/28980453/excel2010-vba-store-and-usage-of-worksheet-variable-during-userform-session/28980757#28980757", "title": "Excel2010/VBA: Store and Usage of Worksheet Variable during Userform Session", "body": "<p>Try </p>\n\n<pre><code>dim GlbVarBaseSheet as Worksheet\n</code></pre>\n"}], "owner": {"reputation": 398, "user_id": 2104767, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/c751c78fb9d6d3e08b6fd6b28d963420?s=128&d=identicon&r=PG", "display_name": "Daniel4711", "link": "https://stackoverflow.com/users/2104767/daniel4711"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1613769848, "creation_date": 1426057444, "last_edit_date": 1613769848, "question_id": 28980453, "link": "https://stackoverflow.com/questions/28980453/excel2010-vba-store-and-usage-of-worksheet-variable-during-userform-session", "title": "Excel2010/VBA: Store and Usage of Worksheet Variable during Userform Session", "body": "<ul>\n<li>In Worksheet1 is a button that is calling a Userform</li>\n<li>I want to use the current Worksheet during the Userform Session but I'm not able to use this.</li>\n<li>I want to use a variable for further usage.</li>\n<li>The Button on Worksheet1 is Calling this Macro</li>\n</ul>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nPublic GlbVarBaseSheet As String\n------------\nSub Formularaufruf_Worksheet1()\n    GlbVarBaseSheet = ActiveSheet.Name            \n    with Userform1\n    .MultiPage1.Value = 1\n    .Show 0\nEnd With\nEnd Sub\n</code></pre>\n<p>Within the Userform, there's a Sub Called Uebernahme, which fills out the Textboxes reading the column number which is stored in the .tag of the TextBox.</p>\n<p>How can I Use the Worksheet Variable in this line to use is during the Userform Session: This is not working and I don't know why.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>With Workbooks(&quot;KVP.xlsm&quot;).Worksheets(GlbVarBaseSheet) \n</code></pre>\n<p>The Full Sub:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Uebernahme()\n\nDim Zeilenindex As Long\nDim OBcB As MSForms.Control\nDim VarTypeName As String\nSheets(GlbVarBaseSheet).Activate\n'\n'\n'\nWorkbooks(&quot;KVP.xlsm&quot;).ActiveSheet.Rows(spinbutton1.Value).Activate\nZeilenindex = spinbutton1.Value\n'\n'\nWith Workbooks(&quot;KVP.xlsm&quot;).Worksheets(GlbVarBaseSheet) \n\n    If .Cells(ActiveCell.Row, 1).Value &lt;&gt; &quot;&quot; Then\n        For Each OBcB In MultiPage1.SelectedItem.Controls\n            VarTypeName = TypeName(OBcB)\n            If OBcB.Tag &lt;&gt; &quot;&quot; Then\n                Select Case VarTypeName\n                    Case Is &lt;&gt; &quot;Checkbox&quot;\n                        'OBcB.Value = .cells(Left(OBcB.Tag, 1) &amp; ActiveCell.Row)\n                        OBcB.Value = .Cells(ActiveCell.Row, Int(Left(OBcB.Tag, 1))).Value\n                End Select\n            End If\n        Next\n    End If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 4351, "user_id": 3826232, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/odxpv.jpg?s=128&g=1", "display_name": "iKK", "link": "https://stackoverflow.com/users/3826232/ikk"}, "edited": false, "score": 0, "creation_date": 1434986459, "post_id": 28981411, "comment_id": 49997666, "body": "On the &quot;article&quot; link above, I cannot find your &quot;Worksheet_Calculate()&quot; method. Can you please give me a better link or explain better where to find it ! Thank you !"}, {"owner": {"reputation": 4351, "user_id": 3826232, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/odxpv.jpg?s=128&g=1", "display_name": "iKK", "link": "https://stackoverflow.com/users/3826232/ikk"}, "edited": false, "score": 0, "creation_date": 1434988521, "post_id": 28981411, "comment_id": 49999042, "body": "Thanks - I managed by reading again and again :) It works but is a bit on a workarround, don&#39;t you think ? Is there a &quot;more clean&quot; way really detecting Autofilter-events ??"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 4351, "user_id": 3826232, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/odxpv.jpg?s=128&g=1", "display_name": "iKK", "link": "https://stackoverflow.com/users/3826232/ikk"}, "edited": false, "score": 0, "creation_date": 1435026187, "post_id": 28981411, "comment_id": 50015075, "body": "@skuenstler I think the article has been deleted - will see if I can get it restored. Nope, the reason the workaround is needed is because there isn&#39;t a direct route :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517904551, "post_id": 28981411, "comment_id": 84272716, "body": "@brettdj Thanks for the helpful answer above. I am finding that saving a workbook will also then trigger this calculation event. Was that the case in your example please?"}, {"owner": {"reputation": 825, "user_id": 1898524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6C9A.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1898524/ben"}, "edited": false, "score": 0, "creation_date": 1556803961, "post_id": 28981411, "comment_id": 98559143, "body": "@brettdj, It looks like the EE article you are referencing is about another topic written by someone else.  The technique you describe on this page was enough for me to get it working but it&#39;s always nice to have a link to more in-depth knowledge."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 12, "last_activity_date": 1426061494, "creation_date": 1426061494, "answer_id": 28981411, "question_id": 28979396, "link": "https://stackoverflow.com/questions/28979396/excel-vba-filter-change-event-handler/28981411#28981411", "title": "Excel VBA Filter Change event handler", "body": "<p>Yes.</p>\n\n<p>From this <a href=\"http://www.experts-exchange.com/Software/Office_Productivity/Office_Suites/MS_Office/Excel/A_2804-Code-to-compile-all-worksheets-from-either-a-all-Excel-workbooks-in-a-folder-or-b-a-specific-Excel-workbook.html\">article</a> I posted on another forum</p>\n\n<p>1.A <em>dummy</em> WorkSheet is added with a single <code>SUBTOTAL</code> formula in A1 pointing back to the range being filtered on the main sheet.<br>\n 2. A <code>Worksheet_Calculate()</code> Event is added to the <em>dummy</em> WorkSheet, this Event fires when the <code>SUBTOTAL</code> formula updates when the filter is changed.</p>\n\n<pre><code>'Dummy sheet code\nPrivate Sub Worksheet_Calculate()\n'Dummy Sheet has recalculated\n    MsgBox \"Your list has been filtered\"\nEnd Sub\n</code></pre>\n\n<p><em>Catering for Manual Calculation</em></p>\n\n<p>Note that the approach above requires Workbook Calculation to be set to either Automatic (xlCalculationAutomatic in VBA), or Automatic except tables (xlCalculationSemiAutomatic). If Calculation was set to Manual (xlCalculationManual), further coding is necessary to set the WorkBook up so that only the \"dummy\" WorkSheet would be set to automatically Calculate, all other sheets having Calculation turned off.</p>\n\n<p>There is a rarely used WorkSheet property, <code>EnableCalculation</code>, that can be set via the Visual Basic Editor to True or False. The default setting is obviously True, if it is set to False then the worksheet will not calculate. </p>\n\n<p>The EnableCalculation property is not available to the regular Excel Menu or Ribbon options - so as an aside this can be a useful trick for people who are looking to secure Excel models by deliberately keeping key sheets from recalculating.</p>\n\n<ol start=\"3\">\n<li>Add a <code>Workbook_Open</code> Event to set the <code>EnableCalculation property</code> of all sheets other than \"Dummy\" to False.  </li>\n<li>Run the Workbook in <em>Calculation</em> mode.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 14124, "user_id": 25197, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/cf458a6960715c6015e5324ef18a9350?s=128&d=identicon&r=PG", "display_name": "GollyJer", "link": "https://stackoverflow.com/users/25197/gollyjer"}, "is_accepted": false, "score": 0, "last_activity_date": 1606017034, "last_edit_date": 1606017034, "creation_date": 1606014401, "answer_id": 64950286, "question_id": 28979396, "link": "https://stackoverflow.com/questions/28979396/excel-vba-filter-change-event-handler/64950286#64950286", "title": "Excel VBA Filter Change event handler", "body": "<p><em><sup>This is a more detailed version of <a href=\"https://stackoverflow.com/a/26128049/25197\">this hidden gem answer</a>. Posting here for more visibility.</sup></em></p>\n<ul>\n<li><p><strong>Works even if <code>Calculation</code> is set to <code>Manual</code>.</strong> \ud83d\udd25</p>\n</li>\n<li><p>Assumes you have a chart using the table being filtered as its data source.<br />\nIf not, you'll need one. \ud83d\ude1b</p>\n</li>\n</ul>\n<ol>\n<li>Create a <em>standard module</em> called <code>ChartSubscriber</code>.</li>\n</ol>\n<pre class=\"lang-vb prettyprint-override\"><code>Private ChartEvents As New ChartEvents\n\nSub SubscribeToChartEvents()\n  Set ChartEvents.Chart = Worksheets(&quot;Sheet with Chart&quot;).ChartObjects(&quot;Chart Name&quot;).Chart\nEnd Sub\n</code></pre>\n<ol start=\"2\">\n<li>Create a <em>class module</em> called <code>ChartEvents</code>.</li>\n</ol>\n<pre class=\"lang-vb prettyprint-override\"><code>Public WithEvents Chart As Chart\n\nPrivate Sub Chart_Calculate()\n    Debug.Print &quot;Table was filtered. Do your worst!&quot;\nEnd Sub\n</code></pre>\n<ol start=\"3\">\n<li>In the <em>ThisWorkbook module</em> subscribe to the event on <code>Workbook_Open</code>.</li>\n</ol>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Workbook_Open()\n    Call ChartSubscriber.SubscribeToChartEvents\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4579525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/260831faeb48719325c503a838e44b79?s=128&d=identicon&r=PG&f=1", "display_name": "behnam", "link": "https://stackoverflow.com/users/4579525/behnam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14021, "favorite_count": 2, "accepted_answer_id": 28981411, "answer_count": 2, "score": 9, "last_activity_date": 1606017034, "creation_date": 1426052592, "last_edit_date": 1531161705, "question_id": 28979396, "link": "https://stackoverflow.com/questions/28979396/excel-vba-filter-change-event-handler", "title": "Excel VBA Filter Change event handler", "body": "<p>Is there a way to figure out when the user has made changes to the sheets filter? </p>\n\n<p>In other words is there a <code>change_filter event</code> handler of some sort?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1121, "user_id": 914490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a29248fb64d4a84c752f43ce61e034?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/914490/mike"}, "edited": false, "score": 0, "creation_date": 1617929036, "post_id": 28977294, "comment_id": 118454443, "body": "And in case you want the full path including file name: CurrentProject.Path &amp; &quot;\\&quot; &amp; CurrentProject.Name"}], "tags": [], "owner": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "is_accepted": true, "score": 28, "last_activity_date": 1426038985, "creation_date": 1426038985, "answer_id": 28977294, "question_id": 28977285, "link": "https://stackoverflow.com/questions/28977285/how-do-i-find-the-current-path-directory-of-a-ms-access-database/28977294#28977294", "title": "How do I find the current path (directory) of a MS Access database?", "body": "<p>You will want to use the following code:</p>\n\n<pre><code>CurrentProject.Path\n</code></pre>\n\n<p>This will return a string representing the file path of the current directory.</p>\n"}], "owner": {"reputation": 660, "user_id": 3781163, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/nbfSb.jpg?s=128&g=1", "display_name": "WestAce", "link": "https://stackoverflow.com/users/3781163/westace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31629, "favorite_count": 2, "accepted_answer_id": 28977294, "answer_count": 1, "score": 17, "last_activity_date": 1426038985, "creation_date": 1426038916, "question_id": 28977285, "link": "https://stackoverflow.com/questions/28977285/how-do-i-find-the-current-path-directory-of-a-ms-access-database", "title": "How do I find the current path (directory) of a MS Access database?", "body": "<p>I am writing VBA within my Access database and I need to reference the containing directory of this database. This path could change since I will be moving the database around.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1426038076, "post_id": 28977133, "comment_id": 46205321, "body": "Which line of code throws the error?"}, {"owner": {"reputation": 99, "user_id": 3648030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5e6ca2a57c329076d4dc681b2ae07db?s=128&d=identicon&r=PG&f=1", "display_name": "Zi Kai", "link": "https://stackoverflow.com/users/3648030/zi-kai"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1426038154, "post_id": 28977133, "comment_id": 46205334, "body": "If (ActiveSheet.Cells(d, &quot;F&quot;) - ActiveSheet.Cells(d, &quot;G&quot;) &gt;= 0) Then                     ActiveSheet.Cells(d, &quot;F&quot;).Font.Color = vbRed"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1426039919, "post_id": 28977133, "comment_id": 46205803, "body": "Given that you are setting Col F, I suspect that you have an invalid value somewhere in Col G. This should be easily resolved by debugging the macro to see what the value of <code>i</code> is when the error occurs."}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 4570045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d70bfa73fea7427e9819d28f1edf6c83?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Wickett", "link": "https://stackoverflow.com/users/4570045/mark-wickett"}, "is_accepted": false, "score": 0, "last_activity_date": 1426039508, "creation_date": 1426039508, "answer_id": 28977381, "question_id": 28977133, "link": "https://stackoverflow.com/questions/28977133/encountering-vba-type-mismatch-error/28977381#28977381", "title": "Encountering VBA &quot;TYPE MISMATCH&quot; ERROR", "body": "<p>Something in either <code>Cells(d, \"F\")</code> or <code>Cells(d, \"G\")</code> is not a number - or at least, cannot be resolved to be a number; it could be that the value in one of the cells has no value, or is something textual.</p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 3648030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5e6ca2a57c329076d4dc681b2ae07db?s=128&d=identicon&r=PG&f=1", "display_name": "Zi Kai", "link": "https://stackoverflow.com/users/3648030/zi-kai"}, "edited": false, "score": 0, "creation_date": 1426056749, "post_id": 28979916, "comment_id": 46210543, "body": "Oh by the way, I changed a line of your code to this. FinalRow = Cells(Rows.count, &quot;S&quot;).End(xlUp).Row"}, {"owner": {"reputation": 99, "user_id": 3648030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5e6ca2a57c329076d4dc681b2ae07db?s=128&d=identicon&r=PG&f=1", "display_name": "Zi Kai", "link": "https://stackoverflow.com/users/3648030/zi-kai"}, "edited": false, "score": 0, "creation_date": 1426057558, "post_id": 28979916, "comment_id": 46210844, "body": "Thanks Patrick for the code. I have tested it on my program. Okay this is the scenario I see, Preconditions: I have two file directories stored starting from Row 3 column S. While debugging I realised that the problem with your code is that it does not check the first directory. In other words, it just stores and does not go into the if loop. Why?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 99, "user_id": 3648030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5e6ca2a57c329076d4dc681b2ae07db?s=128&d=identicon&r=PG&f=1", "display_name": "Zi Kai", "link": "https://stackoverflow.com/users/3648030/zi-kai"}, "edited": false, "score": 0, "creation_date": 1426113518, "post_id": 28979916, "comment_id": 46245352, "body": "What do you get for <code>MyFile</code>? And you shouldn&#39;t start another question within your answer - which line does that Err 400 stops on anyway?"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 1, "last_activity_date": 1426055014, "creation_date": 1426055014, "answer_id": 28979916, "question_id": 28977133, "link": "https://stackoverflow.com/questions/28977133/encountering-vba-type-mismatch-error/28979916#28979916", "title": "Encountering VBA &quot;TYPE MISMATCH&quot; ERROR", "body": "<p>Your <code>ActiveSheet.Cells(d, \"F\").Value = Format(Now, \"dd-mm-yy\")</code> has turned <code>ActiveSheet.Cells(d, \"F\")</code> into a text, so it cannot do arithmetic.</p>\n\n<p>You should use <code>ActiveSheet.Cells(d, \"F\").Value = Now</code> and change it's NumberFormat to \"dd-mm-yy\".</p>\n\n<p>Also you should undo changing the color from Red to Black (or default color) if it doesn't fall in <code>IF F &gt; G</code>.</p>\n\n<p>Try below:</p>\n\n<pre><code>Sub test6()\n    Dim MyFile As String\n    Dim FinalRow As Long\n    Dim Row As Long\n    Dim i As Integer\n    Dim d As Integer\n    d = 3\n    i = 1\n    FinalRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For Row = 1 To FinalRow\n         If Not IsEmpty(ActiveSheet.Cells(Row, \"S\")) Then\n                MyFile = ActiveSheet.Cells(Row, \"S\").Value\n                If Dir(MyFile) &lt;&gt; \"\" Then\n                    ActiveSheet.OLEObjects(\"CheckBox\" &amp; i). _\n                    Object.Value = True\n                    With ActiveSheet.Cells(d, \"F\")\n                        .Value = Now\n                        .NumberFormat = \"dd-mm-yy\"\n                        'If (ActiveSheet.Cells(d, \"F\") - ActiveSheet.Cells(d, \"G\") &gt;= 0) Then\n                        '    ActiveSheet.Cells(d, \"F\").Font.Color = vbRed\n                        'End If\n                        If (.Value - .Offset(0, 1).Value) &gt;= 0 Then\n                            .Font.Color = vbRed\n                        Else\n                            .Font.Color = vbBlack\n                        End If\n                    End With\n                    i = i + 1\n                    d = d + 1\n                End If\n         End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 3648030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5e6ca2a57c329076d4dc681b2ae07db?s=128&d=identicon&r=PG&f=1", "display_name": "Zi Kai", "link": "https://stackoverflow.com/users/3648030/zi-kai"}, "is_accepted": false, "score": 0, "last_activity_date": 1426063673, "last_edit_date": 1426063673, "creation_date": 1426059004, "answer_id": 28980845, "question_id": 28977133, "link": "https://stackoverflow.com/questions/28977133/encountering-vba-type-mismatch-error/28980845#28980845", "title": "Encountering VBA &quot;TYPE MISMATCH&quot; ERROR", "body": "<p>Thanks Everyone. I solved. Below is the code. Credit goes to Patrick. Thanks a million.</p>\n\n<pre><code>Sub test5()\n    Dim MyFile As String\n    Dim FinalRow As Long\n    Dim Row As Long\n    Dim i As Integer\n    Dim d As Integer\n    d = 2\n    i = 0\n    FinalRow = Cells(Rows.count, \"S\").End(xlUp).Row\n    For Row = 3 To FinalRow\n         If Not IsEmpty(ActiveSheet.Cells(Row, \"S\")) Then\n                i = i + 1\n                d = d + 1\n                MyFile = ActiveSheet.Cells(Row, \"S\").Value\n                If Dir(MyFile) &lt;&gt; \"\" Then\n                    ActiveSheet.OLEObjects(\"CheckBox\" &amp; i). _\n                    Object.Value = True\n                    With ActiveSheet.Cells(d, \"F\")\n                        .Value = Now\n                        .NumberFormat = \"dd-mm-yy\"\n                        'If (ActiveSheet.Cells(d, \"F\") - ActiveSheet.Cells(d, \"G\") &gt;= 0) Then\n                        '    ActiveSheet.Cells(d, \"F\").Font.Color = vbRed\n                        'End If\n                        If (.Value - .Offset(0, 1).Value) &gt;= 0 Then\n                            .Font.Color = vbRed\n                        Else\n                            .Font.Color = vbBlack\n                        End If\n                    End With\n                   ' i = i + 1\n                    'd = d + 1\n                End If\n         End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>But is there a way to code to bypass error 400?</p>\n"}], "owner": {"reputation": 99, "user_id": 3648030, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d5e6ca2a57c329076d4dc681b2ae07db?s=128&d=identicon&r=PG&f=1", "display_name": "Zi Kai", "link": "https://stackoverflow.com/users/3648030/zi-kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "accepted_answer_id": 28979916, "answer_count": 3, "score": 0, "last_activity_date": 1426063673, "creation_date": 1426037823, "last_edit_date": 1531164843, "question_id": 28977133, "link": "https://stackoverflow.com/questions/28977133/encountering-vba-type-mismatch-error", "title": "Encountering VBA &quot;TYPE MISMATCH&quot; ERROR", "body": "<p>I am coding a VBA project whereby I stored a column of file directory in a hidden cell and the system will loop through these cells one by one then go into the absolute directory path to check if exist. If the file exist, the checkbox is checked and a timestamp will appear. Then if the timestamp is more than the deadline, the timestamp will change to red font color. However I am encountering the above problem which I suspect it's my date format but I tried but am still lost on how to edit my code. Hence I seek your gracious to help me see what i can do. Thanks.</p>\n\n<pre><code>Sub test5()\nDim MyFile As String\nDim FinalRow As Long\nDim Row As Long\nDim i As Integer\nDim d As Integer\nd = 3\ni = 1\nFinalRow = Range(\"A65536\").End(xlUp).Row\nFor Row = 1 To FinalRow\n     If Not IsEmpty(ActiveSheet.Cells(Row, \"S\")) Then\n            MyFile = ActiveSheet.Cells(Row, \"S\").Value\n            If Dir(MyFile) &lt;&gt; \"\" Then\n                ActiveSheet.OLEObjects(\"CheckBox\" &amp; i). _\n                Object.Value = True\n                ActiveSheet.Cells(d, \"F\").Value = Format(Now, \"dd-mm-yy\")\n                If (ActiveSheet.Cells(d, \"F\") - ActiveSheet.Cells(d, \"G\") &gt;= 0) Then\n                    ActiveSheet.Cells(d, \"F\").Font.Color = vbRed\n                End If\n                i = i + 1\n                d = d + 1\n            End If\n     End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Thanks a lot all, I have resolved the issue. Instead I have added a MonthView object into the userform to simplify things. So its like a calendar pop up where user can choose their date. But now I encounter another problem. After I resolve the date issue, my check file loop can't work. It can check the first checkbox after which any subsequent files cannot be found or looped even though the file exist. Does it have anything with the object or is just my algorithm logic?</p>\n"}, {"tags": ["excel", "vba", "formulas"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1426036894, "post_id": 28976936, "comment_id": 46205010, "body": "Use the <code>Worksheet_Change</code> event handler."}, {"owner": {"reputation": 1, "user_id": 4656331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3460e71cbb992c01121a975a7cc41176?s=128&d=identicon&r=PG&f=1", "display_name": "Jamieb", "link": "https://stackoverflow.com/users/4656331/jamieb"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1426037050, "post_id": 28976936, "comment_id": 46205049, "body": "Thanks for commenting! I am actually brand new to VBA and am unsure how to write the code. I have tried many times today to find a code that basically says &quot;If you type in a cell in column a, the adjacent cell in column b will run &#39;this vlookup&#39;&quot;  Unfortunately, I am at home and don&#39;t have the exact vlookup formula on my computer at home. Do you know of a code I could use?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4656331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3460e71cbb992c01121a975a7cc41176?s=128&d=identicon&r=PG&f=1", "display_name": "Jamieb", "link": "https://stackoverflow.com/users/4656331/jamieb"}, "edited": false, "score": 0, "creation_date": 1426038389, "post_id": 28977072, "comment_id": 46205404, "body": "I encountered a code earlier today that called for mymacro. I tried entering this just now, but I think I must be doing it wrong... I made a &#39;mock&#39; spreadsheet to use while I&#39;m at home to try to get this right so I can email it to myself at work. I opened the VBA screen for the worksheet I am working in and entered the first part of the code you posted. when I am finished and I press F5, I get a box that looks like it wants me to select a macro, but nothing is listed there"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1, "user_id": 4656331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3460e71cbb992c01121a975a7cc41176?s=128&d=identicon&r=PG&f=1", "display_name": "Jamieb", "link": "https://stackoverflow.com/users/4656331/jamieb"}, "edited": false, "score": 0, "creation_date": 1426039265, "post_id": 28977072, "comment_id": 46205619, "body": "You can&#39;t run an event procedure from F5. It will run any time a cell value changes in the worksheet, but the formula will only write to column b. I&#39;m sorry I don&#39;t have the time to teach you all the nuances of VBA..."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1426037280, "creation_date": 1426037280, "answer_id": 28977072, "question_id": 28976936, "link": "https://stackoverflow.com/questions/28976936/vba-code-to-enter-formula-in-column-b-when-column-a-is-populated/28977072#28977072", "title": "VBA Code to enter formula in column b when column a is populated", "body": "<p>You can use the worksheet's <code>_Change</code> event handler to do things, based on changes in the worksheet.</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target as Range)\n\n    'Prevent infinite loops by disabling event procedures\n    Application.EnableEvents = False\n    'Make sure that at least one cell in selection is in column A:\n    If Not Intersect(Target, Range(\"A:A\")) Is Nothing Then Call MyMacro(Target)\n\n    'Turn the event procedures back on\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>In any module, put the sub that will actually <em>do</em> the dirty-work. This is a preference of mine, rathr than trying to cram <em>everything</em> in to the <code>_Change</code> event handler, I simply parse the Target and hand it off to the appropriate subroutine.</p>\n\n<pre><code>Sub MyMacro(rng as Range)\n\nDim cl as Range\n\nFor each cl in rng.Cells\n    '## Make sure we're dealing with column A only:\n    If cl.Column = 1 Then\n        '## Insert a formula in the adjacent cell (column B)\n        cl.Offset(0,1).Formula = \"=Vlookup(...\"\n\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4656331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3460e71cbb992c01121a975a7cc41176?s=128&d=identicon&r=PG&f=1", "display_name": "Jamieb", "link": "https://stackoverflow.com/users/4656331/jamieb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1403, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1426037280, "creation_date": 1426036341, "question_id": 28976936, "link": "https://stackoverflow.com/questions/28976936/vba-code-to-enter-formula-in-column-b-when-column-a-is-populated", "title": "VBA Code to enter formula in column b when column a is populated", "body": "<p>I have a spreadsheet with a tab for each month. When a customer account number is entered into column a, I want a vlookup formula to be entered into column b, directly next to the cell in column a where the customer number was entered. </p>\n\n<p>I have already set the sheets up with the vlookup formulas entered into the adjacent cells, but the sheet has become so big that the program has started to lag when the user enters data in column a. Now I am trying to reduce the size of the spreadsheet by setting up a vba code to enter this vlookup only when the cell in column a actually has data in it. </p>\n\n<p>I have even tried creating a macro that will do this, and it works great, except my co-workers who use this sheet are VERY basic computer users, and it complicates things if they have to \"do\" anything to make the formula run. </p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4656268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb204d1caa35c60574c606556a90358?s=128&d=identicon&r=PG&f=1", "display_name": "ahoe", "link": "https://stackoverflow.com/users/4656268/ahoe"}, "edited": false, "score": 0, "creation_date": 1426039823, "post_id": 28977209, "comment_id": 46205768, "body": "Unfortunately, the data in sheet1 is not in the same position on sheet2. Sheet1 simply has a table with rows Product 1,...,product x and columns 0, 100, 500, and 1000. Each cell within the table is a price based on the product and number of units ordered. I tried creating a second anchor, anchor2 and setting it to worksheets(&quot;sheet1&quot;).range(&quot;A4&quot;), but that obviously didn&#39;t work either. Is there no way that i can reference those cells in sheet1 without completely remodeling my code? I&#39;m not familiar with dynamic lookup..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 4656268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb204d1caa35c60574c606556a90358?s=128&d=identicon&r=PG&f=1", "display_name": "ahoe", "link": "https://stackoverflow.com/users/4656268/ahoe"}, "edited": false, "score": 0, "creation_date": 1426040351, "post_id": 28977209, "comment_id": 46205887, "body": "@ahoe - The term dynamic lookup means you simply define the cell to reference each time using information for that gadget to get row and column numbers. As you have no sample data, it is impossible to start making suggestions. It may be clear in your mind but I have no idea what it looks like from here."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1426038338, "creation_date": 1426038338, "answer_id": 28977209, "question_id": 28976825, "link": "https://stackoverflow.com/questions/28976825/multiplying-data-with-values-in-a-separate-worksheet-vba/28977209#28977209", "title": "Multiplying data with values in a separate worksheet - vba", "body": "<p>In your multiplication loop you are trying to multiply the value of an offset of <em>anchor</em> (a range object set to the active worksheet's A4) against an offset of <em>anchor</em> on another worksheet. You cannot arbitrarily reset the parent of <em>anchor</em> on the fly like that.</p>\n\n<p>I'm assuming that the two cells to multiply have the same position on each of their respective worksheets. You can use <em>anchor's</em> address to reference a cell on the other worksheet that has the same cell address as <em>anchor</em>.</p>\n\n<pre><code>anchorABED.Offset(i, j - 1).Value = anchor.Offset(i, j + 1) * _\n   Worksheets(\"sheet1\").Range(anchor.Address).Offset(j + 1, 1)\n</code></pre>\n\n<p>This is not the best way to do things as a requirement is that the two cells from different worksheets maintain a cell reference synchronization. It would be better to have column and row header information so that a dynamic lookup could be performed against the data matrix on the second worksheet.</p>\n"}], "owner": {"reputation": 1, "user_id": 4656268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cb204d1caa35c60574c606556a90358?s=128&d=identicon&r=PG&f=1", "display_name": "ahoe", "link": "https://stackoverflow.com/users/4656268/ahoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 677, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426038338, "creation_date": 1426035742, "question_id": 28976825, "link": "https://stackoverflow.com/questions/28976825/multiplying-data-with-values-in-a-separate-worksheet-vba", "title": "Multiplying data with values in a separate worksheet - vba", "body": "<p>I am attempting to create a macro that takes sales data for an unknown number of clients (and products) located in a worksheet \"clients\" and multiply it by a set of price breaks located in a separate worksheet \"products\". For example, say client 1 ordered 150 units of product 1. if the price break for less than 500 units is $10.00, i need to find the product of 150 and 10 and display it in the clients worksheet. I have constructed the for loops to loop through the sales data and place it in the correct place, but i run into an issue trying to multiply the sales data by the price break because they are in separate worksheets. with this code i get a \"subscript out of range\" error. I have researched and tried everything i can think of, but cannot figure out what is \"out of range\". What am i doing wrong?</p>\n\n<pre><code>    Dim anchor As Range, rngGadgets As Range, rngClients As Range, _\n    anchorABED As Range, anchorAAED As Range, _\n\n    Dim numGadgets As Integer, numClients As Integer, x As Integer, _\n    i as integer, j as integer\n\n    set anchor = range(\"A4\")\n\n    numGadgets = (Cells(4, Columns.Count).End(xlToLeft).Column - 1)\n    MsgBox numGadgets\n    numClients = (Cells(Rows.Count, 1).End(xlUp).Row - 4)\n    MsgBox numClients\n\n    'Amount before extra discount label\n    Set anchorABED = anchor.Offset(0, numGadgets + 2)\n    For x = 0 To numGadgets - 1\n        anchorABED.Offset(0, x).Value = \"Gadget \" &amp; x + 1\n    Next x\n\n    'multiplication loop \n    For j = 0 To numGadgets - 1\n      For i = 1 To numClients\n        If anchor.Offset(i, j + 1) &lt; 100 Then\n            anchorABED.Offset(i, j).Value = anchor.Offset(i, j + 1) * _\n            Worksheets(\"sheet1\").anchor.Offset(j + 1, 1)\n        ElseIf anchor.Offset(i, j + 1).Value &lt; 500 Then\n            anchorABED.Offset(i, j).Value = anchor.Offset(i, j + 1) * _\n            Worksheets(\"sheet1\").anchor.Offset(j + 1, 2)\n        ElseIf anchor.Offset(i, j + 1).Value &lt; 1000 Then\n            anchorABED.Offset(i, j) = anchor.Offset(i, j + 1) * _\n            Worksheets(\"sheet1\").anchor.Offset(j + 1, 3)\n        ElseIf anchor.Offset(i, j + 1).Value &gt;= 1000 Then\n            anchorABED.Offset(i, j).Value = anchor.Offset(i, j + 1) * _\n            Worksheets(\"sheet1\").anchor.Offset(j + 1, 4)\n        End If\n      Next i\n    Next j\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1426033126, "post_id": 28976301, "comment_id": 46203946, "body": "In your example both Source and Target are identical, so it&#39;s difficult to tell what the &quot;anything else&quot; is which should be ignored.  What <i>doesn&#39;t</i> get copied ?  You can probably use formulas to do what you want, with a mix of INDEX() and MATCH() like <a href=\"http://www.tushar-mehta.com/publish_train/xl_vba_cases/0106%202D%20lookup.shtml\" rel=\"nofollow noreferrer\">tushar-mehta.com/publish_train/xl_vba_cases/&hellip;</a>"}, {"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1426034451, "post_id": 28976301, "comment_id": 46204306, "body": "Formulas in this case cannot be used, the layouts of the spreadsheet are the same in the example, but they are radically different and large.  Doing the Index / Match would eliminate the goal of completely scripted automation."}, {"owner": {"reputation": 159, "user_id": 3618351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380923b2c8631253ec3e791e2896868a?s=128&d=identicon&r=PG&f=1", "display_name": "EvDev", "link": "https://stackoverflow.com/users/3618351/evdev"}, "edited": false, "score": 0, "creation_date": 1426035003, "post_id": 28976301, "comment_id": 46204493, "body": "Can you post your code."}, {"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1426043733, "post_id": 28976301, "comment_id": 46206700, "body": "I have added the code which I have written to do the 2D array lookup"}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1426119251, "post_id": 28978584, "comment_id": 46247426, "body": "Your code works much better than mine but for some reason, the code doesn&#39;t execute the rngdest.cells(r,c).value = srccell.value line, this tells me the find is not finding any which it can copy. I have tried to step through it and analyse where the gap is and I think the lookup is not scanning both sheets in the right manner.  The name range is all contained in the same column (Column A in the source, Column E in the target).  The date ranges are spread across columns in Row 5 on both, it doesn&#39;t seem to pick up the values against the names and dates on the source."}, {"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1426120484, "post_id": 28978584, "comment_id": 46247739, "body": "I should also mention that the source data is a pivot table, will that affect the result?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1426128711, "post_id": 28978584, "comment_id": 46249879, "body": "I based my example on your posted sample tables.  It&#39;s hard to be specific about suggested changes without knowing your exact layout."}, {"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1426136570, "post_id": 28978584, "comment_id": 46251712, "body": "When I tested the code on my sheet, the two integers do not loop, instead they stay on one cell.  I will have a play around with it and see if I can get the integers to loop.  I am aiming to get it to loop through the rows first (dates), and cycle through the dates for each name to see if it can get a match on the target spreadsheet.  Your code has helped me get a head start which is awesome, thank you for your help!"}, {"owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1426479673, "post_id": 28978584, "comment_id": 46374253, "body": "I rephrased the question using your code as an example, I failed to point out that the ranges in the source spreadsheet and target spreadsheet are different.  The dates are practically in the same rows, but the name ranges are very different, the source spreadsheet is in Column A and starts at row 5, but the Target spreadsheet contains names in Column E, and starts at Row 528"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "edited": false, "score": 0, "creation_date": 1426511742, "post_id": 28978584, "comment_id": 46388786, "body": "I&#39;m out of town and no access to a computer for next couple of weeks.  Hopefully someone else can help"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1426052788, "last_edit_date": 1426052788, "creation_date": 1426048054, "answer_id": 28978584, "question_id": 28976301, "link": "https://stackoverflow.com/questions/28976301/excel-vba-two-dimensional-loop-logic-required-through-multiple-sheets-to-achie/28978584#28978584", "title": "Excel VBA - Two dimensional loop logic required through multiple sheets to achieve a copy / paste value if two dimensions match", "body": "<p>Here's a simplistic example of a 2-D lookup:</p>\n\n<pre><code>Sub Tester()\n    MapValues Range(\"A1\").CurrentRegion, Range(\"A16\").CurrentRegion\nEnd Sub\n\nSub MapValues(rngSource As Range, rngDest As Range)\n\n    Dim r As Long, c As Long\n    Dim mr As Range, mc As Range, srcCell As Range\n\n    For r = 2 To rngDest.Rows.Count\n        For c = 2 To rngDest.Columns.Count\n            'match doesn't work on dates so using Find()\n            Set mr = rngSource.Columns(1).Find(rngDest.Cells(r, 1).Value, _\n                                       LookIn:=xlValues, Lookat:=xlWhole)\n            Set mc = rngSource.Rows(1).Find(rngDest.Cells(1, c).Value, _\n                                       LookIn:=xlValues, Lookat:=xlWhole)\n            If Not mr Is Nothing And Not mc Is Nothing Then\n                'locate the matching cell in the source block\n                Set srcCell = rngSource.Parent.Cells(mr.Row, mc.Column)\n                'copying only if there's a value in \"source\"\n                If Len(srcCell.Value) &gt; 0 Then\n                    rngDest.Cells(r, c).Value = srcCell.Value\n                End If\n            End If\n        Next c\n    Next r\nEnd Sub\n</code></pre>\n\n<p>The \"source\" and \"destination\" ranges with \"before\" and \"after\" running the test procedure:</p>\n\n<p><img src=\"https://i.stack.imgur.com/xD2V3.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 319, "user_id": 3559552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/179c203680c4f3b99729ebc0cb29ca6f?s=128&d=identicon&r=PG&f=1", "display_name": "PootyToot", "link": "https://stackoverflow.com/users/3559552/pootytoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1426479965, "creation_date": 1426032194, "last_edit_date": 1426479965, "question_id": 28976301, "link": "https://stackoverflow.com/questions/28976301/excel-vba-two-dimensional-loop-logic-required-through-multiple-sheets-to-achie", "title": "Excel VBA - Two dimensional loop logic required through multiple sheets to achieve a copy / paste value if two dimensions match", "body": "<p>For work I am developing a fully automated tool which can take an extract from our Financial Enterprise Tool (SAP) and bring the values across to a Financial Spreadsheet for reporting purposes. In order to achieve this, I have chosen to code a spreadsheet to take the extracted data from SAP, normalize it, and then shift it across to the financial Spreadsheet.</p>\n\n<p>I am 3/4 of the way there, except I cannot work out how to get the data from the normalized data sheet (source) across to the financial spreadsheet (destination) due to the complex nature of how the data is laid out.</p>\n\n<p>The source sheet which contains the SAP data is sorted as follows </p>\n\n<p><strong>1. Column A - Rows 6 to 6000 - Contains the Names of people</strong></p>\n\n<p><strong>2. Column A - AX - Row 5 - Contains the posting date</strong></p>\n\n<p><strong>3. Column B6:AX6000 - Contains the financial data (NOTE, the range is not fixed, it is a dynamic / variable range)</strong></p>\n\n<p>The target sheet which contains the financial data is sorted as follows </p>\n\n<p><strong>1. Column E - Rows 528 to 1268 - Contains the Names of people</strong> </p>\n\n<p><strong>2. Column A - AX - Row 5 - Contains the posting date</strong> </p>\n\n<p><strong>3. Column H528:AX1260 - Contains the financial data (NOTE, this range IS fixed)</strong></p>\n\n<p>What I would like the code to do, is look at the dates in the source and target spreadsheet. If it finds two matching date entries, then look through the names. If it finds a name match, then the corresponding financial figure against that name and the date should be bought across from the source cell to the target cell.  Once all the names have been scanned, then goto the next date on the source cell</p>\n\n<p>This is what I am aiming for</p>\n\n<pre><code>Source: NOTE: Micks entry in Column C, Line 8\n___|__A__||__B__| |__C__| |__D__|\n 5 |Date | 01/01| |01/02| |01/03|\n---|-----|------|-|-----|-|-----|\n 6 |Jake |      | |     | |     |\n---|-----|------|-|-----|-|-----|\n 7 |Mike |      | |     | |     |\n---|-----|------|-|-----|-|-----|\n 8 |Mick |      | |$222 | |     |\n---|-----|------|-|-----|-|-----|\n\nOriginal Target:\n___|__E__||__I__| |__J__| |__K__|\n 5 |     | 01/01| |01/02| |01/03|\n---|-----|------|-|-----|-|-----|\n528|Jake |  $540| | $444| |     |\n---|-----|------|-|-----|-|-----|\n529|Mike |  $423| | $282| |     |\n---|-----|------|-|-----|-|-----|\n530|Mick |  $452| | $523| |     |\n---|-----|------|-|-----|-|-----|\n\nNew Target: Note Micks entry in Column J, Row 530\n___|__E__||__I__| |__J__| |__K__|\n 5 |Date | 01/01| |01/02| |01/03|\n---|-----|------|-|-----|-|-----|\n528|Jake |  $540| | $444| |     |\n---|-----|------|-|-----|-|-----|\n529|Mike |  $423| | $282| |     |\n---|-----|------|-|-----|-|-----|\n530|Mick |  $452| | $222| |     |\n---|-----|------|-|-----|-|-----|\n</code></pre>\n\n<p>I have tried the following code in order to make this happen, but it doesn't produce a result, and I am stuck, any suggestions to where I might be going wrong? I have used and slightly altered the ranges of Tims answer below, this answer is getting there but the mr and mc ranges end up returning no values.</p>\n\n<p>Current code is as follows:</p>\n\n<pre><code>Sub Tester()\nMapValues Worksheets(\"Source\").Range(\"A5\").CurrentRegion,     Worksheets(\"Target\").Range(\"E528\").CurrentRegion\nEnd Sub\n\nSub MapValues(rngSource As Range, rngDest As Range)\n\nDim r As Long, c As Long\nDim mr As Range, mc As Range, srcCell As Range\n\nFor r = 2 To rngDest.Rows.Count\nFor c = 2 To rngDest.Columns.Count\n    'match doesn't work on dates so using Find()\n    Set mr = rngSource.Columns(1).Find(rngDest.Cells(r, 1).Value, _\n                               LookIn:=xlValues, Lookat:=xlWhole)\n    Set mc = rngSource.Rows(1).Find(rngDest.Cells(1, c).Value, _\n                               LookIn:=xlValues, Lookat:=xlWhole)\n    If Not mr Is Nothing And Not mc Is Nothing Then\n        'locate the matching cell in the source block\n        Set srcCell = rngSource.Parent.Cells(mr.Row, mc.Column)\n        'copying only if there's a value in \"source\"\n        If Len(srcCell.Value) &gt; 0 Then\n            rngDest.Cells(r, c).Value = srcCell.Value\n        End If\n    End If\nNext c\nNext r\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426032866, "post_id": 28976199, "comment_id": 46203879, "body": "I get error &quot;Compile Error: Next Without For&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1426033381, "post_id": 28976199, "comment_id": 46204016, "body": "You don&#39;t need the <code>Goto</code> here, and you&#39;ve duplicated the line <code>Next cell2</code>"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1426033762, "post_id": 28976199, "comment_id": 46204105, "body": "Thanks Tim! Ok, I think Im getting there. I modified the code below. Now it copies everything down to the end of the sheet                        Sub Test() Dim rowCount2 As Long rowCount2 = ThisWorkbook.Sheets(2).Range(&quot;C20&quot;).SpecialCells(xlCellTypeL&zwnj;&#8203;astCell).Row Dim rng2 As Range Set rng2 = ThisWorkbook.Sheets(2).Range(&quot;C20:C&quot; &amp; rowCount2) Dim currentRow As Long currentRow = 1  For Each cell2 In rng2.Cells  If cell2.Value &lt;&gt; &quot;&quot; Then  ThisWorkbook.Sheets(2).Rows(cell2.Row).Copy Destination:=ThisWorkbook.Sheets(3).Range(&quot;A&quot; &amp; currentRow)  currentRow = currentRow + 1  End If  Next cell2  End Sub"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426034564, "post_id": 28976591, "comment_id": 46204343, "body": "Thanks Tim, this one is doing what the last one was except its not copying the last 2 rows for some reason. However, I only need to copy rows A,C,E from the first set of data and H,J,K,L from the second data set. How would I go about cell2.EntireRow.Copy and instead do cell2.copy cellA1,C1,E1?"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426036733, "post_id": 28976591, "comment_id": 46204962, "body": "Sub Test()     Dim rowCount2 As Long, shtSrc As Worksheet     Dim shtDest As Worksheet     Dim rng2 As Range     Dim currentRow As Long     Set shtSrc = ThisWorkbook.Sheets(2)     Set shtDest = ThisWorkbook.Sheets(3)     rowCount2 = shtSrc.Cells(Rows.Count, &quot;C&quot;).End(xlUp).Row     Set rng2 = shtSrc.Range(&quot;C20:C&quot; &amp; rowCount2)     currentRow = 1     For Each cell2 In rng2.Cells         If cell2.Value &lt;&gt; &quot;&quot; Then             cell2.Offset(0, -1).Copy shtDest.Range(&quot;A&quot; &amp; currentRow)             currentRow = currentRow + 1         End If     Next cell2 End Sub"}, {"owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "edited": false, "score": 0, "creation_date": 1426036764, "post_id": 28976591, "comment_id": 46204972, "body": "I added the above, can get it to copy one row, but cannot figure out how to have it copy multiple rows then loop to the next set of data... any pointers?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1426046379, "last_edit_date": 1426046379, "creation_date": 1426034142, "answer_id": 28976591, "question_id": 28976199, "link": "https://stackoverflow.com/questions/28976199/move-specific-cells-from-one-tab-to-another-based-off-non-blank-data-in-row/28976591#28976591", "title": "Move specific cells from one tab to another based off non blank data in row", "body": "<p>EDIT: I hadn't really read your question fully, and I'm still not sure I'm following exactly what you want to do - do you want A,C and E to go into A,B,C on sheet3?  That's what I'm assuming below.</p>\n\n<pre><code>Sub Test()\n\n    Dim shtDest As Worksheet, shtSrc As Worksheet\n\n    Set shtSrc = ThisWorkbook.Sheets(2)\n    Set shtDest = ThisWorkbook.Sheets(3)\n\n    CopyUntilBlank shtSrc.Range(\"C20\"), Array(\"A\", \"C\", \"E\"), _\n                                        shtDest.Range(\"A1\")\n\n    CopyUntilBlank shtSrc.Range(\"H20\"), Array(\"H\", \"J\", \"K\", \"L\"), _\n                   shtDest.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n\nEnd Sub\n\n'Starting with \"startCell\" and continuing as long as there's a value\n'  in that cell, copy the cells with columns in \"arrCols\" over to the\n'  destination starting at \"destCell\"\nSub CopyUntilBlank(startCell As Range, arrCols, destCell As Range)\n    Dim i As Long, n\n    Do While Len(startCell.Value) &gt; 0\n        For i = LBound(arrCols) To UBound(arrCols)\n            startCell.EntireRow.Cells(1, arrCols(i)).Copy destCell.Offset(0, i)\n        Next i\n        Set startCell = startCell.Offset(1, 0)\n        Set destCell = destCell.Offset(1, 0)\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 3632551, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bKJsc.jpg?s=128&g=1", "display_name": "Daniel Strong", "link": "https://stackoverflow.com/users/3632551/daniel-strong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426046379, "creation_date": 1426031587, "last_edit_date": 1426032129, "question_id": 28976199, "link": "https://stackoverflow.com/questions/28976199/move-specific-cells-from-one-tab-to-another-based-off-non-blank-data-in-row", "title": "Move specific cells from one tab to another based off non blank data in row", "body": "<p>needing assistance. I have a file where column A-F has data and column H-M has data. I need the code to loop through A-F and copy cells A,C,E and paste them on sheet3, then once it hits the first blank cell in column A, move to column H-M and loop through, copying H,J,K,L and moving it to sheet3 in the fist blank cell after the first loop completes. Below is what I have so far, when I get to last \"next cell2\" I get an error... Am I on the right track? Any pointers?</p>\n\n<pre><code>Sub Test()\n\n\n\n Dim rowCount2 As Long\n\nrowCount2 = ThisWorkbook.Sheets(2).Range(\"C20\").SpecialCells(xlCellTypeLastCell).Row\n\n\nDim rng2 As Range\n\n\nSet rng2 = ThisWorkbook.Sheets(2).Range(\"C20:C\" &amp; rowCount2)\n\nDim currentRow As Long\n currentRow = 1\n\n\n For Each cell2 In rng2.Cells\n If cell2.Value &lt;&gt; \"\" Then\n ThisWorkbook.Sheets(2).Rows(cell.Row).Copy Destination:=ThisWorkbook.Sheets(3).Range(\"A\" &amp; currentRow)\n currentRow = currentRow + 1\n GoTo NextIteration\n\n End If\n Next cell2\nNextIteration:\n Next cell2\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1426026914, "creation_date": 1426026914, "answer_id": 28975377, "question_id": 28975311, "link": "https://stackoverflow.com/questions/28975311/vba-select-first-worksheet-in-a-csv-file/28975377#28975377", "title": "vba - select first worksheet in a csv file", "body": "<p>Refer to it by its index instead of by name:</p>\n\n<pre><code>Sheets(1).Select\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4607378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0868603fd657946d25e40f034a06a002?s=128&d=identicon&r=PG&f=1", "display_name": "as1989", "link": "https://stackoverflow.com/users/4607378/as1989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426026914, "creation_date": 1426026584, "question_id": 28975311, "link": "https://stackoverflow.com/questions/28975311/vba-select-first-worksheet-in-a-csv-file", "title": "vba - select first worksheet in a csv file", "body": "<p>I am trying to write a macro that pastes some data into a large number of csv files saved in a folder.  How do I get the macro to select the first worksheet in each csv file (csv files only have one worksheet)? If it was an Excel file I could do this:</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\n</code></pre>\n\n<p>However, each csv file has a different name for the worksheet.</p>\n"}, {"tags": ["excel", "vba", "variables", "formula", "basic"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1426025315, "post_id": 28974901, "comment_id": 46201188, "body": "<code>&quot;alpha&quot;</code> is just a string literal. VBA will only ever treat a string literal as a string literal. If you mean to concatenate <code>alpha</code>&#39;s <b>value</b> into the formula, then take it out of the string literal: <code>.Value = &quot;=E2 + &quot; &amp; alpha</code>."}, {"owner": {"reputation": 23, "user_id": 2156636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddbf43e164c92ae51d1bfbcd3bd0d675?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2156636/john"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1426026234, "post_id": 28974901, "comment_id": 46201525, "body": "@Mat&#39;sMug Ahh thank you. Exactly what I was looking for"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1426032396, "creation_date": 1426032396, "answer_id": 28976336, "question_id": 28974901, "link": "https://stackoverflow.com/questions/28974901/inserting-a-variable-in-a-formula-in-visual-basic/28976336#28976336", "title": "Inserting a variable in a formula in Visual Basic", "body": "<p>Here is a working model:</p>\n\n<pre><code>Sub poiunt()\n    Dim alpha As Double\n    alpha = 5\n    Range(\"E3\").Formula = \"=E2 +\" &amp; alpha\n    Range(\"E3\").Copy Range(\"E4:E15\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2156636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddbf43e164c92ae51d1bfbcd3bd0d675?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/2156636/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1386, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426032396, "creation_date": 1426024816, "last_edit_date": 1426025096, "question_id": 28974901, "link": "https://stackoverflow.com/questions/28974901/inserting-a-variable-in-a-formula-in-visual-basic", "title": "Inserting a variable in a formula in Visual Basic", "body": "<p>Hi I'm trying to insert a variable into a formula in Visual Basic:</p>\n\n<pre><code>Dim alpha As Double\n\nRange(\"E3:E14\").Value = \"=E2 + alpha\"\n</code></pre>\n\n<p>What I'm trying to do is insert a formula for E3 that is the number above it (E2) plus a variable (like .5) and copy that formula down to E14.</p>\n\n<p>So for E5 it would be = E4 + alpha</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "transpose"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1426024379, "post_id": 28974658, "comment_id": 46200786, "body": "Does it always contain <code>Image Name</code> in Column A for every image?"}, {"owner": {"reputation": 23, "user_id": 4655893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c30482566647fad7cea411374461233?s=128&d=identicon&r=PG&f=1", "display_name": "Zerkaden", "link": "https://stackoverflow.com/users/4655893/zerkaden"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1426028266, "post_id": 28974658, "comment_id": 46202308, "body": "Yes, every image begins with Image Name in Column A, I made sure to have at least one common element for all images in order for a macro to work."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1426028590, "post_id": 28974658, "comment_id": 46202419, "body": "Ok, I&#39;ll post a possible solution in a while."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4655893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c30482566647fad7cea411374461233?s=128&d=identicon&r=PG&f=1", "display_name": "Zerkaden", "link": "https://stackoverflow.com/users/4655893/zerkaden"}, "edited": false, "score": 0, "creation_date": 1426029057, "post_id": 28975605, "comment_id": 46202603, "body": "Wow, thank you so much! I&#39;ll have to try it at work on a bigger file to make sure, but it works perfectly. Just out of curiosity, why is the first EntireRow.Delete line doubled? I&#39;d love to understand the process of the macro to get to learn more functions and terms."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 23, "user_id": 4655893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c30482566647fad7cea411374461233?s=128&d=identicon&r=PG&f=1", "display_name": "Zerkaden", "link": "https://stackoverflow.com/users/4655893/zerkaden"}, "edited": false, "score": 0, "creation_date": 1426030017, "post_id": 28975605, "comment_id": 46202947, "body": "@Zerkaden: In your specifications, there are 2 blank lines after image name row. So, I repeat the line in the code, as there is no built-in method to remove a specific number of rows at a stretch. Actually, this macro can be further optimized, as now, I see that <code>curidx</code> is not necessary. Also, I know of a way to remove extra lines in between the records. I&#39;ve updated the code."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 0, "last_activity_date": 1426030364, "last_edit_date": 1426030364, "creation_date": 1426028168, "answer_id": 28975605, "question_id": 28974658, "link": "https://stackoverflow.com/questions/28974658/excel-macro-to-transpose-specific-cells-from-row-to-column/28975605#28975605", "title": "Excel macro to transpose specific cells from row to column", "body": "<p>This macro will do the work except for the lines between records, 3 lines will remain. The main point is that the record should start with \"Image Name\" (the check is case-insensitive). You can adjust it later to match the requirements.</p>\n\n<pre><code>Sub ReorderImageRecords()\nDim cnt As Long, curidx As Long\n\nFor i = 1 To ActiveSheet.UsedRange.Rows.Count\n cnt = 0\n If Left(LCase(Cells(i, 1)), 10) = \"image name\" Then\n   Cells(i + 1, 1).EntireRow.Delete\n   Cells(i + 1, 1).EntireRow.Delete\n   curidx = i\n   Cells(curidx + 1, 1) = \"Annotation\"\n   Cells(curidx + 1, 2) = \"Comment\"\n   Cells(curidx + 1, 3) = \"Value\"\n   Cells(curidx + 1, 4) = \"Unit\"\n   While Not IsEmpty(Cells(curidx + cnt + 2, 2))\n     cnt = cnt + 1\n     Cells(curidx + cnt + 1, 2) = Cells(curidx + cnt + 2, 3)\n     Cells(curidx + cnt + 2, 2).EntireRow.Delete\n   Wend\n   i = i + cnt + 1\n End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>And here is an optimized version without <code>curidx</code> and with the code to remove extra lines in between image records:</p>\n\n<pre><code>Sub ReorderImageRecords()\nDim cnt As Long, i As Long\n\nFor i = 1 To ActiveSheet.UsedRange.Rows.Count\n cnt = 0\n If i &gt; 1 Then ' If it is not the 1st row\n   If Application.CountA(Cells(i - 1, 1).EntireRow) = 0 Then\n     Cells(i - 1, 1).EntireRow.Delete ' Delete if the whole preceding row is empty\n   End If\n   If Application.CountA(Cells(i - 1, 1).EntireRow) = 0 Then\n     Cells(i - 1, 1).EntireRow.Delete ' Repeat row removal\n   End If\n End If\n If Left(LCase(Cells(i, 1)), 10) = \"image name\" Then ' We found an image record start\n   Cells(i + 1, 1).EntireRow.Delete ' We delete unnecessary blank rows\n   Cells(i + 1, 1).EntireRow.Delete ' Repeat removal\n   Cells(i + 1, 1) = \"Annotation\"   ' Insert headers\n   Cells(i + 1, 2) = \"Comment\"\n   Cells(i + 1, 3) = \"Value\"\n   Cells(i + 1, 4) = \"Unit\"\n   While Not IsEmpty(Cells(i + cnt + 2, 2)) ' If we are still within one and the same record\n     cnt = cnt + 1\n     Cells(i + cnt + 1, 2) = Cells(i + cnt + 2, 3) ' Copy comment\n     Cells(i + cnt + 2, 2).EntireRow.Delete        ' Remove row with comment\n   Wend\n   i = i + cnt + 1 ' Increment row index to the current value\n End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4655893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c30482566647fad7cea411374461233?s=128&d=identicon&r=PG&f=1", "display_name": "Zerkaden", "link": "https://stackoverflow.com/users/4655893/zerkaden"}, "edited": false, "score": 0, "creation_date": 1426147641, "post_id": 28977264, "comment_id": 46255613, "body": "Thank you for the suggestion! However, it doesn&#39;t work as well as the one above : the first issue is that when I export data from the imaging software the sheet1 always has a different name. I changed it to Sheet1 to make sure it would work, but now the VBA tells me that the Sheet4 variable is undefined. I tried to specifically create a Sheet4 to check if it would change anything, but the issue stays the same. Anyway, the first suggestion works perfectly, but I wanted to give you feedback on yours. Thanks again : )"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1426039285, "last_edit_date": 1426039285, "creation_date": 1426038752, "answer_id": 28977264, "question_id": 28974658, "link": "https://stackoverflow.com/questions/28974658/excel-macro-to-transpose-specific-cells-from-row-to-column/28977264#28977264", "title": "Excel macro to transpose specific cells from row to column", "body": "<p>I already mentioned I'll post a possible solution so here it goes (although kinda late).</p>\n\n<pre><code>Sub Test()\n    Dim lr As Long, r As Range\n    Application.ScreenUpdating = False\n    With Sheet1 'source worksheet; change to suit\n        lr = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n        Set r = .Range(\"A1:D\" &amp; lr)\n        r.Replace \"Length\", \"\": r.AutoFilter 1, \"&lt;&gt;\"\n        r.SpecialCells(xlCellTypeVisible).Copy Sheet4.Range(\"A1\")\n        .AutoFilterMode = False\n        r.AutoFilter 2, \"&lt;&gt;\"\n        r.Offset(0, 2).Resize(, 1).SpecialCells(xlCellTypeVisible).Copy _\n            Sheet4.Range(\"E1\")\n        .AutoFilterMode = False\n    End With\n\n    With Sheet4 'output worksheet; change to suit\n        lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        .Range(\"B1:B\" &amp; lr).Copy: .Range(\"E1:E\" &amp; lr).PasteSpecial xlPasteValues, , True\n        .Range(\"E1:E\" &amp; lr).Replace \"Attribute Name\", \"Comment\"\n        .Range(\"E1:E\" &amp; lr).Cut .Range(\"B1\")\n        .Range(\"C1:C\" &amp; lr).AutoFilter 1, \"&lt;&gt;\"\n        .Range(\"D2:D\" &amp; lr).SpecialCells(xlCellTypeVisible).Replace \"\", \"Unit\"\n        .AutoFilterMode = False\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This will work if the data is as consistent as what you've posted above.<br>\nAlso result will be something like this (no space between Image name).<bR>\nAlso it needs an <code>output worksheet</code> (in above case it is Sheet4). HTH.</p>\n\n<p><img src=\"https://i.stack.imgur.com/d6q7u.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 23, "user_id": 4655893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c30482566647fad7cea411374461233?s=128&d=identicon&r=PG&f=1", "display_name": "Zerkaden", "link": "https://stackoverflow.com/users/4655893/zerkaden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3649, "favorite_count": 0, "accepted_answer_id": 28975605, "answer_count": 2, "score": 2, "last_activity_date": 1467082224, "creation_date": 1426023834, "last_edit_date": 1429004277, "question_id": 28974658, "link": "https://stackoverflow.com/questions/28974658/excel-macro-to-transpose-specific-cells-from-row-to-column", "title": "Excel macro to transpose specific cells from row to column", "body": "<p>I am working with data from an image analysis software which exports data in the following way :</p>\n\n<p><img src=\"https://i.stack.imgur.com/5Vi3M.png\" alt=\"SampleImage\"></p>\n\n<p>In every case, two empty rows separate the Image name from the different annotations put on the Image itself. The next Image is separated from the last annotation by three empty rows. \nAll annotations are refered to by their number and consist of a measurement, its unit and a comment about which kind of measurement it is. However, this disposition is not practical. It would be much easier to manage the data if it were displayed like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/bPCE8.png\" alt=\"SampleImage2\"></p>\n\n<p>In the form of a table with \"Annotation\", \"Comment\", \"Value\" and \"Unit\" as headers, with all information about the annotation in the same row. So far I've tried to transpose the data manually, but this takes way too long when many images are involved. I also tried to use the macro recorder to automate the process, but it doesn't work since it uses fixed positions in the worksheet. Moreover, all Images don't possess the same number of annotations.</p>\n\n<p>Could anyone help me create a macro to do such a thing? I've started dabbling with the VBA code recently, but this is way out of my league.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 4317268, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e6fb90539c6f202c7bfdf415009b5572?s=128&d=identicon&r=PG&f=1", "display_name": "Archaimot", "link": "https://stackoverflow.com/users/4317268/archaimot"}, "is_accepted": true, "score": 0, "last_activity_date": 1426096460, "creation_date": 1426096460, "answer_id": 28993933, "question_id": 28974368, "link": "https://stackoverflow.com/questions/28974368/identify-duplicates-and-compare-value/28993933#28993933", "title": "Identify Duplicates and Compare Value", "body": "<p>I Fixed it, in a dirty way.</p>\n\n<p>I created a hidden column with =Counta(E:Z) (or what have you)\nSo I then got it to sort by First, the Case Number, then by the hidden column (descending). That way, when I used the remove duplicates script, he with the least data was mowed down. </p>\n\n<p>It worked for me.</p>\n\n<pre><code> Dim LR As Long\n LR = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n Range(\"D2:E2\").AutoFill Destination:=Range(\"D2:E\" &amp; LR)\n Range(\"A2:Z\" &amp; LR).Select\n ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\n ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:= _\n    Range(\"B2:B\" &amp; LR), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _\n    :=xlSortNormal\n\nActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:= _\n    Range(\"D2:D\" &amp; LR), SortOn:=xlSortOnValues, Order:=xlDescending, _\n    DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n    .SetRange Range(\"A1:AG\" &amp; LR)\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nActiveSheet.Range(\"$A$1:AG\" &amp; LR).RemoveDuplicates Columns:=Array(1, 2),    Header:=xlGuess\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4317268, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e6fb90539c6f202c7bfdf415009b5572?s=128&d=identicon&r=PG&f=1", "display_name": "Archaimot", "link": "https://stackoverflow.com/users/4317268/archaimot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 28993933, "answer_count": 1, "score": 0, "last_activity_date": 1426096460, "creation_date": 1426022688, "last_edit_date": 1531164843, "question_id": 28974368, "link": "https://stackoverflow.com/questions/28974368/identify-duplicates-and-compare-value", "title": "Identify Duplicates and Compare Value", "body": "<p>I need to search for duplicates within a contiguous range, and, if a duplicate is found, to compare the value in a separate range (analogous rows) and pick the lesser one to delete.</p>\n\n<p>It's easy enough to tell it to compare duplicates and clear x-many rows for so many columns.</p>\n\n<pre><code>Dim LR as long\nDim LR = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nActivesheet.Range(\"$A$1:\" &amp; \"G\" &amp; LR).RemoveDuplicates Columns:=Array(1,2), Header:=xlGuess\n</code></pre>\n\n<p>But one would need to use a range like Z:Z and compare the found duplicate (in A &amp; B) against the original and see if, for example Z3's cell contents (4) are greater than Z200's cell contents (6), and delete row 3.</p>\n\n<p>The idea is to go from this:</p>\n\n<p><img src=\"https://i.imgur.com/t1VUkre.png\" alt=\"Starting Info\"></p>\n\n<p>To This: </p>\n\n<p><img src=\"https://i.imgur.com/LtcdpO9.png\" alt=\"Ending Info\"></p>\n\n<p>Any and all help would be appreciated. Thank you!</p>\n"}, {"tags": ["string", "vba"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 3618351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380923b2c8631253ec3e791e2896868a?s=128&d=identicon&r=PG&f=1", "display_name": "EvDev", "link": "https://stackoverflow.com/users/3618351/evdev"}, "edited": false, "score": 0, "creation_date": 1426023385, "post_id": 28974508, "comment_id": 46200341, "body": "The &quot;&amp;&quot; will concatenate the values returned from InStr."}], "tags": [], "owner": {"reputation": 159, "user_id": 3618351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380923b2c8631253ec3e791e2896868a?s=128&d=identicon&r=PG&f=1", "display_name": "EvDev", "link": "https://stackoverflow.com/users/3618351/evdev"}, "is_accepted": true, "score": 2, "last_activity_date": 1426023275, "creation_date": 1426023275, "answer_id": 28974508, "question_id": 28974358, "link": "https://stackoverflow.com/questions/28974358/how-to-check-if-cell-contains-two-strings-in-vba/28974508#28974508", "title": "How to check if cell contains TWO strings in VBA", "body": "<p>You want the result of InStr to be great than 0.  Also use \"And\" not \"&amp;\"</p>\n\n<pre><code>ElseIf InStr(1, UCase(testVal), UCase(\"goku\"), 1) &gt; 0 AND InStr(1,     UCase(testVal), UCase(\"vegeta\"), 1) &gt; 0 Then\n        Worksheets(\"Export Worksheet\").Cells(i, 18).EntireRow.Interior.ColorIndex = \"4\"\n</code></pre>\n"}], "owner": {"reputation": 9509, "user_id": 1547174, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02984f9cba31484b86a9acab0bbbb919?s=128&d=identicon&r=PG", "display_name": "Trung Tran", "link": "https://stackoverflow.com/users/1547174/trung-tran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 28974508, "answer_count": 1, "score": 0, "last_activity_date": 1426023275, "creation_date": 1426022647, "question_id": 28974358, "link": "https://stackoverflow.com/questions/28974358/how-to-check-if-cell-contains-two-strings-in-vba", "title": "How to check if cell contains TWO strings in VBA", "body": "<p>How can I check if a cell contains two separate strings in a cell? I tried:</p>\n\n<pre><code>ElseIf InStr(1, UCase(testVal), UCase(\"goku\"), 1) And InStr(1, UCase(testVal), UCase(\"vegeta\"), 1) Then\n            Worksheets(\"Export Worksheet\").Cells(i, 18).EntireRow.Interior.ColorIndex = \"4\"\n</code></pre>\n\n<p>However, this does not work...</p>\n\n<p>If I use </p>\n\n<pre><code>ElseIf InStr(1, UCase(testVal), UCase(\"goku\"), 1) &amp; InStr(1, UCase(testVal), UCase(\"vegeta\"), 1) Then\n            Worksheets(\"Export Worksheet\").Cells(i, 18).EntireRow.Interior.ColorIndex = \"4\"\n</code></pre>\n\n<p>It will highlight the row if \"goku\" OR \"vegeta\" are in the cell. However, I need BOTH values to be in the cell.</p>\n\n<p>Please help!</p>\n"}, {"tags": ["database", "ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "is_accepted": true, "score": 1, "last_activity_date": 1426023959, "creation_date": 1426023959, "answer_id": 28974696, "question_id": 28973947, "link": "https://stackoverflow.com/questions/28973947/filtering-a-subform-table-based-on-parameters-in-a-form/28974696#28974696", "title": "Filtering a subform table based on parameters in a form", "body": "<p>I figured it out. I just put a little VBA code that requeries the subtable after update.</p>\n\n<p>Code is [subform].requery</p>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 28974696, "answer_count": 1, "score": 0, "last_activity_date": 1426023959, "creation_date": 1426021005, "question_id": 28973947, "link": "https://stackoverflow.com/questions/28973947/filtering-a-subform-table-based-on-parameters-in-a-form", "title": "Filtering a subform table based on parameters in a form", "body": "<p>I have a form with two unbounded comboboxes that work fine (one lists several age values and the other lists several region). I have a subform, which is a query that refers to the comboboxes, but I can't get it to update when I change values in the comboboxes.</p>\n\n<p>My query is:</p>\n\n<blockquote>\n  <p>Select * from mastertable where (age=[form]![masterform]![age] and region=[form]![masterform]![region]</p>\n</blockquote>\n\n<p>The query works in the sense that if I run it and input the parameters manually it works. It also works in the sense that if I create a button that runs the query on the form, it produces the correct table/query.</p>\n\n<p>My question is how do I get the query to work as a subform? I'd like to be able to select values in the combo box and see the subform update, rather than having to click on a button that runs the query separately from the form. </p>\n\n<p>I also tried creating a table that the parameters on the form can bound to, then relating those variables to the mastertable, but that also didn't work.</p>\n\n<p>How do I get a table/query subform to update as information about the parameters changes in the form? I'm guessing it will require some VBA code on the \"after update\" event associated with the comboboxes. Any idea how to do this?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "edited": false, "score": 1, "creation_date": 1426020328, "post_id": 28973609, "comment_id": 46198747, "body": "minor comment, but from a bad experience from inherited code, avoid using + to concatenate strings if there is any remote possibility the string may contain a number.   &amp; works the same, so stick to a way that should never go wrong"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "edited": false, "score": 0, "creation_date": 1426020385, "post_id": 28973609, "comment_id": 46198782, "body": "Hmm, I wasn&#39;t aware of that. Thanks for the tip."}, {"owner": {"reputation": 403, "user_id": 4547107, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/ef42f758ae6b02e6ba7c5371ff4d8738?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4547107/jason"}, "edited": false, "score": 0, "creation_date": 1426021142, "post_id": 28973609, "comment_id": 46199175, "body": "Thanks for the advice. I want to save the result in a different workbook and would like to have the result in a range or an array. Do you know of a way to do this without looping through each cell?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1426021469, "post_id": 28973609, "comment_id": 46199356, "body": "Ah, I had missed that you didn&#39;t want to loop through the ranges - sorry, I should have read the question more carefully. As far as I know that is the only way you&#39;ll be able to combine the two ranges together though."}, {"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "edited": false, "score": 1, "creation_date": 1426023762, "post_id": 28973609, "comment_id": 46200514, "body": "Is there a reason you don&#39;t want to loop?  If its a &quot;speed&quot; issue, you could read all your values into an array, loop through the array in a similar manner to what eirikdaude suggested, but writing the concatenated values out to a &quot;target&quot; array, then once finished, write your target array to your chosen destination.  Arrays are much faster especially when looping large numbers of cells, as looping cells is many I/O&#39;s where as reading an entire range into an array is 1 I/O and writing it back is also only 1 I/O"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1426020422, "last_edit_date": 1426020422, "creation_date": 1426019759, "answer_id": 28973609, "question_id": 28973420, "link": "https://stackoverflow.com/questions/28973420/easily-combine-two-ranges-and-a-string-in-excel-through-vba/28973609#28973609", "title": "Easily combine two ranges and a string in Excel through vba", "body": "<p>In order to concatenate two or more strings you can simply use <code>&amp;</code> or <code>+</code> operator. In your case, assuming the range with last names is one cell to the right of the one with first names, and the concatenated string will be one cell further to the right, you could do something like this in VBA:</p>\n\n<pre><code>Sub concatenate_names\n  Dim range_of_names As Range, c As Range, s As String\n\n  Set range_of_names = Worksheets(\"Whatever\").Range(\"Whatever\")\n\n  For Each c In range_of_names\n    s = CStr(c) &amp; \" \" &amp; CStr(c.Offset(0, 1))\n    c.Offset(0, 2) = s\n  Next\nEnd Sub\n</code></pre>\n\n<p>Of course, you don't strictly speaking need to store the string in a variable before putting it into the cell, but I find that it makes the code easier to read.</p>\n\n<p>You can also do this via the worksheet-function <a href=\"http://www.techonthenet.com/excel/formulas/concat.php\" rel=\"nofollow\"><code>CONCATENATE</code></a>, putting something like this into the cell where the combined names should be:</p>\n\n<pre><code>=CONCATENATE(A1,\" \",B1)\n</code></pre>\n"}], "owner": {"reputation": 403, "user_id": 4547107, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/ef42f758ae6b02e6ba7c5371ff4d8738?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4547107/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1214, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1426020422, "creation_date": 1426019093, "last_edit_date": 1531164843, "question_id": 28973420, "link": "https://stackoverflow.com/questions/28973420/easily-combine-two-ranges-and-a-string-in-excel-through-vba", "title": "Easily combine two ranges and a string in Excel through vba", "body": "<p>Is there a simple way to combine the values of two ranges into one? I have a column of First Names and another of last Names that I would like to add together for a range of full names to be used in another workbook. I use Union to combine them, but I would also like to add a space between the two names. </p>\n\n<pre><code>   Set UnionRange = Union(Range1, \" \", Range2)\n</code></pre>\n\n<p>Is there a way to use Union or something similar to add the space without having to loop through each row or write the results to the worksheet first?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "edited": false, "score": 0, "creation_date": 1426021148, "post_id": 28971327, "comment_id": 46199181, "body": "To me your spec and examples are confusing.  You start quoting column B then show examples using columns A and C.  How would values &quot;disappear&quot; from Sheet 2?  Your initial spec seems fairly straight forward:  Create a worksheet_Change module, in sheet 1 using intersect to detect changes in B1:B30, then loop through cells in sheet 2, column B checking if your new value exists, if not enter it in last populated cell in B2.  For ideas you could search on her for how to use intersect, how to loop through a range and how to find last cell in a column."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1426022104, "post_id": 28971327, "comment_id": 46199702, "body": "By &quot;last empty cell in column <b>B</b>&quot;, do you mean cell <b>B1048576</b> if it is empty ??"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1426029160, "post_id": 28971327, "comment_id": 46202644, "body": "Worksheet change events will run by themselves, no need to execute manually."}, {"owner": {"reputation": 12672, "user_id": 1927206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/434140a485dca639d56237db0fbeef54?s=128&d=identicon&r=PG", "display_name": "Bill Woodger", "link": "https://stackoverflow.com/users/1927206/bill-woodger"}, "edited": false, "score": 0, "creation_date": 1426072190, "post_id": 28971327, "comment_id": 46218714, "body": "@Jonwhite please don&#39;t edit answers. If you have more information, please edit your question. If you have a new question arising from what you have received so far, please ask it as a new question."}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426066149, "post_id": 28982000, "comment_id": 46214847, "body": "Checked the runtime with 30 to 10,315, it&#39;s 6 to 7 seconds on my computer. It might be too long for each data entry depending on your preferences."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426066690, "post_id": 28982000, "comment_id": 46215171, "body": "If there are no values, then it finds nothing and cannot return appropriate row number either. Other than that check for typos in sheet name."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426067161, "post_id": 28982000, "comment_id": 46215467, "body": "I made an amendment (merely runtime) and uploaded my <a href=\"https://drive.google.com/file/d/0B-773Ttgo1z6Z2ZrczZmV19JcTA/view?usp=sharing\" rel=\"nofollow noreferrer\">example file</a>. It works just fine."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426067226, "post_id": 28982000, "comment_id": 46215509, "body": "Sorry, it measures runtime too. Feel free to comment it out."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426067550, "post_id": 28982000, "comment_id": 46215717, "body": "<code>If rng.Value = Worksheets(&quot;Sheet1&quot;).Cells(i, 2).Value</code> will change to <code>If rng.Value = Worksheets(&quot;Sheet1&quot;).Cells(i, 17).Value</code> since column Q is the 17th in order. Likewise, <code>If Unique Then Worksheets(&quot;Sheet1&quot;).Cells(Lastunique + 1, 2) = rng &#39;adds if it is unique</code> changes too."}, {"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "edited": false, "score": 0, "creation_date": 1426069755, "post_id": 28982000, "comment_id": 46217053, "body": "I would still use intersect to limit your code to only run when the change is in B1:B30 <code>If Intersect(Target, Range(&quot;B1:B30&quot;)) Is Nothing Then &#39;Do nothing &#39;else process the changed value Else</code>"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1426075048, "post_id": 28982000, "comment_id": 46220535, "body": "You can then use an OnError event but it would be much better if you would just add a header in column Q like &quot;Unique IDs&quot;, then you wouldn&#39;t have to worry about this bug. Alternatively you could add the first ID manually, and it would run smoothly until you hit the c. 1,000,000 as the upper limit of this sub."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1426082699, "post_id": 28982000, "comment_id": 46225875, "body": "I am not going back to the basics. <code>Application.ScreenUpdating = False</code> ; <code>Application.StatusBar = &quot;Updating&quot;</code>"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426091860, "post_id": 28982000, "comment_id": 46232726, "body": "sorry about that user3819867. Your code worked great but now it doesn&#39;t wan tto update according to marks workchange event"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1426072119, "last_edit_date": 1426072119, "creation_date": 1426063694, "answer_id": 28982000, "question_id": 28971327, "link": "https://stackoverflow.com/questions/28971327/vba-paste-new-values-in-column-b-of-sheet-1-to-last-empty-cell-of-b-in-sheet2/28982000#28982000", "title": "VBA paste new values in column B of sheet 1 to last empty cell of B in sheet2", "body": "<p>I made a simple solution for you. If your datasets are relatively small, it will take no time to run it on each value input (Worksheet_Change event).</p>\n\n<pre><code>Sub ertdfgcvb()\nDim rng As Range\nDim Unique As Boolean\n\nFor Each rng In Worksheets(\"Sheet1\").Range(\"B1:B30\") 'for each cell in your B1 to B30 range, sheet1\n    Unique = True 'we'll assume it's unique\n    Lastunique = Worksheets(\"Sheet2\").Range(\"B:B\").Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    For i = 1 To Lastunique 'for each cell in the unique ID cache\n        If rng.Value = Worksheets(\"Sheet2\").Cells(i, 2).Value Then 'we check if it is equal\n            Unique = False 'if yes, it is not unique\n        End If\n    Next\n    If Unique Then Worksheets(\"Sheet2\").Cells(Lastunique + 1, 2) = rng 'adds if it is unique\nNext\nEnd Sub\n</code></pre>\n\n<p>The call will look like:</p>\n\n<pre><code>Private Sub WorkSheet_Change(ByVal Target As Range)\nCall ertdfgcvb\nEnd Sub\n</code></pre>\n\n<p>If you have larger datasets, you will have to refer to <em>Target</em> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426073066, "post_id": 28985219, "comment_id": 46219273, "body": "I have added an additional comment to my above answer.  Using Target potentially avoids looping your whole range, you can just query target.  Though please note that if a user pastes multiple values in B1:B30, target could still be a range, but would just be  range of the changed value.  Up to you if you think you need to cater for this scenario"}, {"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426074771, "post_id": 28985219, "comment_id": 46220356, "body": "Worksheet_Change modules run automatically when you change a value in that sheet ... as long as they are in the right place. In the VBA editor, by default, in the left hand side the project explorer is shown.  Expand the Microsoft Excel Objects, find your sheet where you want this code to run and double click it.  This should open a code window for that sheet.  This is where you need to put the worksheet_change code"}, {"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426074997, "post_id": 28985219, "comment_id": 46220507, "body": "One way of checking what&#39;s happening is to use the vba editor and add a breakpoint at the start of the worksheet_change procedure and when the code halts, step through and see if it is going where you expect it to"}, {"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426075763, "post_id": 28985219, "comment_id": 46220976, "body": "No, the yellow line is where the code has errored and you are debugging.   A breakpoint you add before the code runs.  In your code window, click the vertical left side of the code window next to the line of code where you want the code to &quot;break&quot;.   Then when your code executes it will stop at this point and jumpot to the code window.  At this point you can do lots of useful things like hover cursor over variables to see what they are.  But also on the &quot;debugging&quot; toolbar are options to step throiugh your code.  Click thiis to move the code on 1 line at a time and see where its going"}, {"owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "reply_to_user": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426075885, "post_id": 28985219, "comment_id": 46221043, "body": "In relation to your actual error, I am at work and dont have time to debug  user3819867&#39;s code.  But I would actually do it slightly differently, by using an aray to hold sheet 2&#39;s existing values and loop through the array, but also add checks for empty sheet etc"}, {"owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "edited": false, "score": 0, "creation_date": 1426092438, "post_id": 28985219, "comment_id": 46233113, "body": "I think I need to change if intersect (target, range(&quot;FS3:FS33&quot;)) no change do nothing else change do something or somethign becasue it wont update unless I select that range :("}], "tags": [], "owner": {"reputation": 520, "user_id": 4342155, "user_type": "registered", "profile_image": "https://graph.facebook.com/553839289/picture?type=large", "display_name": "Mark Moore", "link": "https://stackoverflow.com/users/4342155/mark-moore"}, "is_accepted": false, "score": 1, "last_activity_date": 1426072686, "creation_date": 1426072686, "answer_id": 28985219, "question_id": 28971327, "link": "https://stackoverflow.com/questions/28971327/vba-paste-new-values-in-column-b-of-sheet-1-to-last-empty-cell-of-b-in-sheet2/28985219#28985219", "title": "VBA paste new values in column B of sheet 1 to last empty cell of B in sheet2", "body": "<p>Adding as an answer because comments wont let me format the code section properly.  Jon am assuming you are using the code above from user3819867, all you need to do to use the intersect is change the worksheet_change module to be\n<code>\nPrivate Sub WorkSheet_Change(ByVal Target As Range)\nIf Intersect(Target, Range(\"B1:B30\")) Is Nothing Then \n    'Do nothing '\nelse\n    Call ertdfgcvb\nend if\nEnd Sub</code></p>\n\n<p>edited to add that I dont really see a need to call a seperate procedure here.  Would put the procedure code directly in here as its quite small, plus makes it easier to read if you decide to tweak and use \"target\" instead</p>\n"}], "owner": {"reputation": 11, "user_id": 4638084, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72fc5a79b2712f7920e72b499867f637?s=128&d=identicon&r=PG&f=1", "display_name": "Jon white", "link": "https://stackoverflow.com/users/4638084/jon-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1426095464, "creation_date": 1426011831, "last_edit_date": 1531164843, "question_id": 28971327, "link": "https://stackoverflow.com/questions/28971327/vba-paste-new-values-in-column-b-of-sheet-1-to-last-empty-cell-of-b-in-sheet2", "title": "VBA paste new values in column B of sheet 1 to last empty cell of B in sheet2", "body": "<p><strong>Think of my problem like this: cells <code>FS3:FS33</code> show customer receipts for customers in the restaurant seats <code>3 to 33</code> ( those are the only seats ) at the present time. As they leave their receipts leave the cells <code>FS3:FS33</code> and go to the bin. New customers come and go and as they come and go <code>FS3:FS33</code> fills downwards to the last column ( ie there will be no gaps and they will fill from <code>FS3</code> down ). Each receipt is unique and needs to be recorded and kept on the last empty row of another column on a different sheet in C:C.</strong> </p>\n\n<p><strong>This Q has been answered but I have one final problem with it not updating - see below</strong></p>\n\n<p>the combination of this sub in a module</p>\n\n<pre><code>Sub hithere3()\nDim Rng As Range\nDim Unique As Boolean\n\nFor Each Rng In Worksheets(\"Sheet8\").Range(\"FS3:FS30\") 'for each cell     in     your B1 to B30 range, sheet1\nUnique = True 'we'll assume it's unique\nLastunique = Worksheets(\"TRADES\").Range(\"C:C\").Find(\"*\",     SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nFor i = 3 To Lastunique 'for each cell in the unique ID cache\n    If Rng.Value = Worksheets(\"TRADES\").Cells(i, 3).Value Then 'we       check    if it is equal\n        Unique = False 'if yes, it is not unique\n    End If\nNext\nIf Unique Then Worksheets(\"TRADES\").Cells(Lastunique + 1, 3) = Rng 'adds    if it is unique\nNext\nEnd Sub\n</code></pre>\n\n<p>with the loop check in a worksheet change events</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Intersect(Target, Range(\"FS3:FS33\")) Is Nothing Then\n'Do nothing '\nElse\nCall hithere3\nEnd If\nEnd Sub\n</code></pre>\n\n<p>works except it only updates when I select one of the cells in FS3:FS33</p>\n\n<p>Can anyone suggest how this can be overcome?</p>\n\n<p>SOLUTION </p>\n\n<pre><code>Private Sub Worksheet_calculate()\nIf Range(\"FS3:FS33\") Is Nothing Then\n'Do nothing'\nElse\n Call hithere3\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 0, "last_activity_date": 1426018708, "creation_date": 1426018708, "answer_id": 28973311, "question_id": 28971284, "link": "https://stackoverflow.com/questions/28971284/trying-to-find-word-in-string-of-a-form-value/28973311#28973311", "title": "Trying to find word in string of a form value", "body": "<p>You can use the <a href=\"https://support.office.com/en-sg/article/InStr-Function-85d3392c-3b1c-4232-bb18-77cd0cb8a55b\" rel=\"nofollow\">InStr Function</a> or a <code>Like</code> comparison to determine whether a string is contained in another string.</p>\n\n<p><code>InStr</code> returns the position of the second string within the first string when found, or zero when not found.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>? InStr(1,\"Hello World\", \"or\")\n 8 \n? InStr(1,\"abcdef\", \"xyz\")\n 0 \n</code></pre>\n\n<p>The <code>Like</code> comparison returns True or False to indicate whether the string matches the pattern.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>? \"Hello World\" Like \"*or*\"\nTrue\n? \"abcdef\" Like \"*xyz*\"\nFalse\n</code></pre>\n\n<p>So for your <code>If</code> condition ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If [Forms]![Cover Sheet]![UnfinishedInterior].Value contains Ply in it Then\n</code></pre>\n\n<p>... choose one of these ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If InStr(1, [Forms]![Cover Sheet]![UnfinishedInterior].Value, \"Ply\") &gt; 0 Then\nIf [Forms]![Cover Sheet]![UnfinishedInterior].Value Like \"*Ply*\" Then\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4655298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5c24719871efeb93eb28880cd5f032?s=128&d=identicon&r=PG&f=1", "display_name": "Jake Williams", "link": "https://stackoverflow.com/users/4655298/jake-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 1, "accepted_answer_id": 28973311, "answer_count": 1, "score": 1, "last_activity_date": 1426018750, "creation_date": 1426011687, "last_edit_date": 1426018750, "question_id": 28971284, "link": "https://stackoverflow.com/questions/28971284/trying-to-find-word-in-string-of-a-form-value", "title": "Trying to find word in string of a form value", "body": "<p>I have a form and all my standard inputs are all PB for particleboard. however I would like to be able to search a string in a form value to report in a separate report as ply if it is plywood.</p>\n\n<p>my example with obviously wrong syntax.</p>\n\n<pre><code>Private Sub UnfinishedInterior_AfterUpdate()\n\nIf [Forms]![Cover Sheet]![UnfinishedInterior].Value contains Ply in it Then\n\n[Forms]![Cover Sheet]![CV8AppliedEnds].Value = DFirst\n(\"CV8PlyName\", \"AppliedEndsPlyReport_Query\") \n\nElse\n\nIf [Forms]![Cover Sheet]![UnfinishedInterior].Value contains PB in it Then \n\n[Forms]![Cover Sheet]![CV8AppliedEnds].Value = DFirst(\"CV8Name\", \"AppliedEndsReport_Query\")\n\nEnd Sub\n</code></pre>\n\n<p>The problem I seem to be having is finding the correct way of extracting the ply or PB string and applying my data from my table.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 1, "last_activity_date": 1426013005, "last_edit_date": 1426013005, "creation_date": 1426012685, "answer_id": 28971580, "question_id": 28971169, "link": "https://stackoverflow.com/questions/28971169/microsoft-visual-basic-run-time-error/28971580#28971580", "title": "Microsoft Visual Basic Run-time error", "body": "<p>In MS Access you can't set control values in the \"BeforeUpdate\" event.  So this line: </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.Quantity = \"\"\n</code></pre>\n\n<p>Is causing your error message. So you will need to look for an alternative way to do what you are attempting to do.  I think that the \"AfterUpdate\" event will work for what you are looking for. </p>\n"}, {"comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1426013306, "post_id": 28971667, "comment_id": 46194771, "body": "Interesting, I so infrequently see the opportunity to use Undo or Cancel that I never think to use in an answer."}, {"owner": {"reputation": 25, "user_id": 4654605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbf9b1a0e2e9798045683dd2f9f0785a?s=128&d=identicon&r=PG&f=1", "display_name": "francisjessie", "link": "https://stackoverflow.com/users/4654605/francisjessie"}, "edited": false, "score": 0, "creation_date": 1426013497, "post_id": 28971667, "comment_id": 46194876, "body": "thanks. but another problem occur. when i input greater than 1 in the quantity field it displays the message box &quot;not enough stocks left&quot;. Example the stock of this product is 100, when i input 2 or above it executes the msgbox. any ideas?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1426013626, "post_id": 28971667, "comment_id": 46194954, "body": "Does Access understand both <code>Me.Quantity</code> and <code>Me.Stock</code> are numeric data type instead of text?"}, {"owner": {"reputation": 25, "user_id": 4654605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbf9b1a0e2e9798045683dd2f9f0785a?s=128&d=identicon&r=PG&f=1", "display_name": "francisjessie", "link": "https://stackoverflow.com/users/4654605/francisjessie"}, "edited": false, "score": 0, "creation_date": 1426014039, "post_id": 28971667, "comment_id": 46195172, "body": "the datatype of fields quantity and stock are in text, should i change the datatype?"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1426014061, "post_id": 28971667, "comment_id": 46195187, "body": "If Me.Quantity is a field and not a control, wouldn&#39;t the value still be what it was the last time since this is in a before update event.  So to do this shouldn&#39;t it be something more like Me.txtQuantity (referring to a control) or am I just crazy?"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1426014345, "post_id": 28971667, "comment_id": 46195333, "body": "Though I feel that while there isn&#39;t any explicit declaration of variables access would interperate the code to be numbers on its own.  It feels like it is referring to the Table&#39;s un-updated field, whereas it should be referring to the Forms control while performing the check."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1426014654, "post_id": 28971667, "comment_id": 46195499, "body": "@Newd Re: <i>&quot;If Me.Quantity is a field and not a control&quot;</i> ... <code>Quantity_BeforeUpdate</code> means <code>Quantity</code> must be a control, right?  I suppose it could <i>also</i> be a field, but don&#39;t see why that would change anything here."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 25, "user_id": 4654605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbf9b1a0e2e9798045683dd2f9f0785a?s=128&d=identicon&r=PG&f=1", "display_name": "francisjessie", "link": "https://stackoverflow.com/users/4654605/francisjessie"}, "edited": false, "score": 0, "creation_date": 1426014718, "post_id": 28971667, "comment_id": 46195532, "body": "@francisjessie Numeric data type is generally better for handling numbers. However, if changing the data type is impractical, you can transform the text to number for your comparison: <code>If Val(Me.Quantity) &gt; Val(Me.Stock) Or Val(Me.Stock) = 0 Then</code>"}, {"owner": {"reputation": 25, "user_id": 4654605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbf9b1a0e2e9798045683dd2f9f0785a?s=128&d=identicon&r=PG&f=1", "display_name": "francisjessie", "link": "https://stackoverflow.com/users/4654605/francisjessie"}, "edited": false, "score": 0, "creation_date": 1426014760, "post_id": 28971667, "comment_id": 46195563, "body": "So the <code>Val</code> transforms the text to number? And yes changing the data type is very impractical. Thanks for your help I learned something from you."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1426014923, "post_id": 28971667, "comment_id": 46195656, "body": "Yes, <code>Val()</code> returns a number from a string.  See the Access help topic for details.  Beware <code>Val()</code> will not accept a Null input.  The <code>Nz()</code> function could be useful in that case."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1426014949, "post_id": 28971667, "comment_id": 46195669, "body": "Ya I see your point.  After doing a quick test it looks like even if the control and the field were named the same the control is what gets interpreted.  Had the control been something like txtQuantity then my comment would have been plausible.  Though clearly barking up the wrong tree."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1426015378, "last_edit_date": 1426015378, "creation_date": 1426013024, "answer_id": 28971667, "question_id": 28971169, "link": "https://stackoverflow.com/questions/28971169/microsoft-visual-basic-run-time-error/28971667#28971667", "title": "Microsoft Visual Basic Run-time error", "body": "<p>A control's <em>Before Update</em> event does not allow you to change it to just any value.  You have 2 options at that point:</p>\n\n<ol>\n<li>call <code>Cancel</code> and then call <code>Undo</code> to revert its value to whatever was there before the attempted update</li>\n<li>call <code>Cancel</code> only, leaving the new (unacceptable) value in place, but forcing the user to replace it with an acceptable value before continuing</li>\n</ol>\n\n<p>Here is tested sample code for the first option.  If you prefer the second option, discard the <code>Me.Quantity.Undo</code> line.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Quantity_BeforeUpdate(Cancel As Integer)\n    If Me.Quantity &gt; Me.Stock Or Me.Stock = 0 Then\n        MsgBox \"Not enough stocks left.\"\n        'Me.Quantity = \"\" ' &lt;-- NOT ALLOWED\n        Cancel = True\n        Me.Quantity.Undo\n    End If\nEnd Sub\n</code></pre>\n\n<p>When <code>Me.Quantity</code> and <code>Me.Stock</code> are text values which contain numbers, the situation is more complicated.  If it were me, I would prefer to change their data types to numeric.  But if that change is impractical, you can use <code>Val()</code> to transform the text values to actual numbers for your comparison.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Quantity_BeforeUpdate(Cancel As Integer)\n    If Val(Me.Quantity) &gt; Val(Me.Stock) Or Val(Me.Stock) = 0 Then\n        MsgBox \"Not enough stocks left.\"\n        'Me.Quantity = \"\" ' &lt;-- NOT ALLOWED\n        Cancel = True\n        Me.Quantity.Undo\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4654605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbf9b1a0e2e9798045683dd2f9f0785a?s=128&d=identicon&r=PG&f=1", "display_name": "francisjessie", "link": "https://stackoverflow.com/users/4654605/francisjessie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 28971667, "answer_count": 2, "score": 2, "last_activity_date": 1475522532, "creation_date": 1426011435, "last_edit_date": 1426013106, "question_id": 28971169, "link": "https://stackoverflow.com/questions/28971169/microsoft-visual-basic-run-time-error", "title": "Microsoft Visual Basic Run-time error", "body": "<p>I'm using MS Access 2007 and VBA. I have a block of code which triggers when the quantity is greater than stock or the stock is zero.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Quantity_BeforeUpdate(Cancel As Integer)\n    If Me.Quantity &gt; Me.Stock Or Me.Stock = 0 Then\n        MsgBox \"Not enough stocks left.\"\n        Me.Quantity = \"\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>The message box appears but after that an error message followed:</p>\n\n<p><code>Run-time error '2147352567 (80020009)':</code></p>\n\n<p><code>The macro or function set to BeforeUpdate or ValidationRule property for this field is preventing  Microsoft Office Access from saving the data in the field.</code></p>\n\n<p>How to stop this error?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4655221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d2bb9c11f8e7bf86e81882cf2508911?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/4655221/stefano"}, "edited": false, "score": 0, "creation_date": 1426253839, "post_id": 28971378, "comment_id": 46308146, "body": "Hi Ditto, many taking the time. It worked fine for me and I fixed my issue. I would like just to highlight something strange that happened to me as inexperienced user."}, {"owner": {"reputation": 3, "user_id": 4655221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d2bb9c11f8e7bf86e81882cf2508911?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/4655221/stefano"}, "edited": false, "score": 0, "creation_date": 1426254190, "post_id": 28971378, "comment_id": 46308420, "body": "Hi Ditto, many taking the time. It worked fine for me and I fixed my issue. I would like just to highlight something strange that happened to me as inexperienced user. By addending the real formula to the command I was running into a 1004 Error and It cost me an headache trying to understand. The issue was in the separator I have used in the formula inside the &quot;&quot; that was not right for VBA but right for Excel......in other words to set the formula to =IF($AF$5=0;0;IF($AF$5&gt;=6;$DR11;0)) I had to use &quot;,&quot; instead of &quot;;&quot;....Thnka once again. Stefano"}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "reply_to_user": {"reputation": 3, "user_id": 4655221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d2bb9c11f8e7bf86e81882cf2508911?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/4655221/stefano"}, "edited": false, "score": 0, "creation_date": 1426258389, "post_id": 28971378, "comment_id": 46311398, "body": "@stefano: Yeah, I&#39;ve always used comas &quot;,&quot; ... only started seeing semi-colons &quot;;&quot; on this site .. :)  Oh well. Remember to mark the question answered if my answer helped you ...  Cheers."}], "tags": [], "owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "is_accepted": true, "score": 0, "last_activity_date": 1426012002, "creation_date": 1426012002, "answer_id": 28971378, "question_id": 28970920, "link": "https://stackoverflow.com/questions/28970920/how-to-put-a-range-formula-into-a-loop-in-excel-vba/28971378#28971378", "title": "How to put a range.formula into a loop in Excel VBA", "body": "<p>Here's a small working sample which should show you how to go about it:</p>\n\n<pre><code>Sub test()\n   Dim LastCYMonth_RNG As Range\n    Set LastCYMonth_RNG = Range(\"B2:c4\")\n\n    LastCYMonth_RNG.Formula = \"=sum(a1:a5)\"\nEnd Sub\n</code></pre>\n\n<p>1) make sure your <code>LastCYMonth_RNG</code> variable is actually declared as a data type named <code>RANGE</code>.</p>\n\n<p>2) Set your range to whatever you need (in my test : <code>B2:C4</code>, in your sample code, <code>BX11:BX13</code> .. or whatever else you calculated. \n If you cannot calculate <code>BX11:BX13</code>, but rather end up with: <code>( row 11, col 76 )</code> : <code>( row 13, col 76 )</code>, you can use the worksheet function <code>ADDRESS</code> to build it. [edit] correction - just use <code>CELLS</code>, not <code>ADDRESS</code> ... [/edit]</p>\n\n<p>3) Once you have that, you can just stuff it into your Formula call.</p>\n"}], "owner": {"reputation": 3, "user_id": 4655221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d2bb9c11f8e7bf86e81882cf2508911?s=128&d=identicon&r=PG&f=1", "display_name": "Stefano", "link": "https://stackoverflow.com/users/4655221/stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 953, "favorite_count": 0, "accepted_answer_id": 28971378, "answer_count": 1, "score": 0, "last_activity_date": 1426012475, "creation_date": 1426010631, "last_edit_date": 1531164843, "question_id": 28970920, "link": "https://stackoverflow.com/questions/28970920/how-to-put-a-range-formula-into-a-loop-in-excel-vba", "title": "How to put a range.formula into a loop in Excel VBA", "body": "<p>first of all I would like to apologize as I am not a programmer, but I am now forced to act as in order to successfully complete a task assigned to me.\nI am building an excel dashboard and I needed to use some VBA programming. All good so far whit the hints I have got from you, but currently I am stuck in a loop...:))</p>\n\n<p>I am trying to write a specific formula, always the same in a range of cells calculated by the software. Actually in the loop below everything works:</p>\n\n<pre><code>For i = 1 To LastCYMonth_RNG.Rows.count\n    LastCYMonth_RNG.Cells(i, 1) = Application.Sum(YTDCYAll_RNG.Rows(i)) - Application.Sum(TotalCYMonth_RNG.Rows(i)) - Application.Sum(MTDCYMonth_RNG.Rows(i))\n Next i\n</code></pre>\n\n<p>What I can not manage to do is instead of making a Sum I want to write a formula in each cell of the range.....like</p>\n\n<p><code>Range(\"BX11:BX13\").Formula = \"=SUM(C2:D2)\"</code> where <code>\"BX11:BX13\"</code> must be replaced by the calculated range <code>LastCYMonth_RNG</code> in a programmatic manner......no clue about the syntax or mistake a might make.</p>\n\n<p>Thanks a lot.</p>\n\n<p>Stefano</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1426011947, "post_id": 28970970, "comment_id": 46194049, "body": "that works really great! The only problem is I&#39;m going through over 5,000 cells and it&#39;s a little slower than I would like. I&#39;ve heard the VLOOKUP tends to work faster. Is that true?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1426012320, "post_id": 28970970, "comment_id": 46194254, "body": "I am unsure about the vlookup being faster. Hopefully someone smarter than I am can answer that. How long is this taking? It may be faster to write your ranges to arrays and compare the arrays, then loop back through the arrays and delete rows."}, {"owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1426012519, "post_id": 28970970, "comment_id": 46194353, "body": "I just timed it at about 7 minutes."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1426012580, "post_id": 28970970, "comment_id": 46194383, "body": "Wow! Way too fast. I think this can be accomplished much faster with arrays. I&#39;ll put together an edited answer to show that."}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "reply_to_user": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "edited": false, "score": 0, "creation_date": 1426014694, "post_id": 28970970, "comment_id": 46195526, "body": "Please see my edit. This should work for you. If not, post back any issues. If so, please mark this answered."}], "tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1426021844, "last_edit_date": 1426021844, "creation_date": 1426010811, "answer_id": 28970970, "question_id": 28970689, "link": "https://stackoverflow.com/questions/28970689/vlookup-to-delete-values-that-dont-match-referenced-values/28970970#28970970", "title": "VLOOKUP to Delete Values That Don&#39;t Match Referenced Values", "body": "<p>This looks close. First issue, you should always loop in reverse when deleting rows/columns. Next, I prefer to use a <code>.Find()</code> rather than a worksheet function. This loops through and tries to find the value of <code>Range(\"C\" &amp; i)</code> in column F of your reference sheet. It does this by setting the the variable \"FindString\" (which I changed to a range) to the <code>Range.Find()</code> (which returns a range). If it doesn't find the value, \"FindString\" will be nothing, the If statement will evaluate to true and the entire row will be deleted from your source sheet.</p>\n\n<pre><code> Sub FiltrarCalypso()\n Dim Sourcebook As Workbook\n Dim SourceSheet As Worksheet\n Dim Referencebook As Workbook\n Dim ReferenceSheet As Worksheet\n Dim LastRowSource As Long\n Dim LastRowReference As Long\n Dim FindString As Range\n\n Application.ScreenUpdating = False\n\n Set Sourcebook = Workbooks(\"Nemail\")\n Set SourceSheet = Sourcebook.Worksheets(\"QP\")\n Set Referencebook = Workbooks(\"Op\")\n Set ReferenceSheet = Referencebook.Worksheets(\"OP\")\n LastRowSource = SourceSheet.Cells(Rows.Count, \"C\").End(xlUp).Row\n LastRowReference = ReferenceSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n For i = LastRowSource to 2 Step -1 'Step -1 tells this to loop in reverse\n     On Error Resume Next\n     Set FindString = ReferenceSheet.Range(\"F:F\").Find (SourceSheet.Range(\"C\" &amp; i)\n\nIf FindString Is Nothing Then\nSourceSheet.Range(\"A\" &amp; i).EntireRow.Delete\nEnd if\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I believe the below should be quicker. It write the values of each cell in column C to the first \"column\" in a 2-D array (SourceArray), and writes the row index of that cell to the second \"column\" of SourceArray. It then write all the values from column F in ReferenceSheet to a 1-D array called ReferenceArray. It then loops through SourceArray() in reverse (since we wrote the array going forward, we want to loop backward so we delete the highest number row first) and compares it to each value in ReferenceArray(). If the value is found, a flag (flg) is set to true, and our inner loop is exited. If flg = True, then we do nothing (the value was found), else, we delete the row associated with the value in SourceArray(i,1). </p>\n\n<p>Please mark this answered if this does in fact answer your question!</p>\n\n<pre><code> Sub FiltrarCalypso()\n Dim Sourcebook As Workbook\n Dim SourceSheet As Worksheet\n Dim Referencebook As Workbook\n Dim ReferenceSheet As Worksheet\n Dim LastRowSource As Long\n Dim LastRowReference As Long\n Dim FindString, C As Range\n Dim SourceArray() as String\n Dim ReferenceArray() as String\n Dim RowArray()\n Dim i, j as integer\n Dim flg as Boolean\n\n Set Sourcebook = Workbooks(\"Nemail\")\n Set SourceSheet = Sourcebook.Worksheets(\"QP\")\n Set Referencebook = Workbooks(\"Op\")\n Set ReferenceSheet = Referencebook.Worksheets(\"OP\")\n LastRowSource = SourceSheet.Cells(Rows.Count, \"C\").End(xlUp).Row\n LastRowReference = ReferenceSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n Redim SourceArray(0 to LastRowReference - 2,0 to 1)\n Redim ReferenceArray(0 to LastRowSource - 7)\n\n For i = 0 to Ubound(SourceArray())\n   SourceArray(i,0) = SourceSheet.Cells(i+2,3)\n   SourceArray(i,1) = SourceSheet.Cells(i+2,3).Row\n Next i\n\n For i = 0 to Ubound(ReferenceArray())\n   ReferenceArray(i,0) = ReferenceSheet.Cells(i+7,6)\n Next i\n\n For i = Ubound(SourceArray()) to 0 Step -1\n   flg = False\n   For j = 0 to  Ubound(ReferenceArray())\n      If SourceArray(i,0) =  ReferenceArray(i) Then\n         flg = True\n         Exit For\n      End if\n   Next j\n   If flg = False Then\n    SourceSheet.Range(\"A\" &amp; SourceArray(i,1)).EntireRow.Delete\n   End if\nNext i     \n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 4483889, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/08eea0bc7e9b732e1e49e59423aed31a?s=128&d=identicon&r=PG&f=1", "display_name": "New2VBA", "link": "https://stackoverflow.com/users/4483889/new2vba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 0, "accepted_answer_id": 28970970, "answer_count": 1, "score": 0, "last_activity_date": 1426021844, "creation_date": 1426009880, "last_edit_date": 1426010510, "question_id": 28970689, "link": "https://stackoverflow.com/questions/28970689/vlookup-to-delete-values-that-dont-match-referenced-values", "title": "VLOOKUP to Delete Values That Don&#39;t Match Referenced Values", "body": "<p>I'm trying to take all of the values held within SourceSheet.Range(\"C2:C\" &amp; LastRowSource) and cross reference them with all of the values held within ReferenceSheet.Range(\"F7:F\" &amp; LastRowReference). If they do not exist within that range, then I want to delete the entire row that holds that value in the C column. Problems:<br>\n1. It returns the error \"Unable to get the Vlookup property of the WorksheetFunction Class.\"\n 2. Even without this error, I'm not 100% sure I have the code written right or efficiently.\nThanks!</p>\n\n<pre><code> Sub FiltrarCalypso()\n Dim Sourcebook As Workbook\n Dim SourceSheet As Worksheet\n Dim Referencebook As Workbook\n Dim ReferenceSheet As Worksheet\n Dim LastRowSource As Long\n Dim LastRowReference As Long\n Dim FindString As String\n\n Set Sourcebook = Workbooks(\"Nemail\")\n Set SourceSheet = Sourcebook.Worksheets(\"QP\")\n Set Referencebook = Workbooks(\"Op\")\n Set ReferenceSheet = Referencebook.Worksheets(\"OP\")\n LastRowSource = SourceSheet.Cells(Rows.Count, \"C\").End(xlUp).Row\n LastRowReference = ReferenceSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n For i = 2 To LastRowSource\n     FindString = Application.WorksheetFunction.VLookup(SourceSheet.Range(\"C\" &amp; i),     ReferenceSheet.Range(\"F7:F\" &amp; LastRowReference), 1, False)\nIf FindString &lt;&gt; 1 Then\nSourceSheet.Range(\"A\" &amp; i &amp; \":z\" &amp; i).Delete\nElse: End if\n\n\n Next i\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1426010201, "post_id": 28970563, "comment_id": 46193049, "body": "So I assume the data is unsorted?  and you are unable to sort it ?  So the question becomes: &quot;How do we find the lowest string in an unsorted list ?&quot;"}, {"owner": {"reputation": 25, "user_id": 4390045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acf80d6687f7849d95b829dd6f3d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "cornking", "link": "https://stackoverflow.com/users/4390045/cornking"}, "reply_to_user": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1426012552, "post_id": 28970563, "comment_id": 46194373, "body": "@Ditto, Each column is sorted, with numerical values, lowest to highest, at the top of the column and alphanumeric values, lowest to highest, below the numeric only values. Not every column contains a given value, if it doesn&#39;t, the macro inserts a blank cell and shifts the rest of the column down. Let me know if that needs more explaining."}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1426013150, "post_id": 28970563, "comment_id": 46194691, "body": "Post some sample data, please .. (ie 3 cols, 5 rows should be enough to see/work with)"}, {"owner": {"reputation": 25, "user_id": 4390045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acf80d6687f7849d95b829dd6f3d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "cornking", "link": "https://stackoverflow.com/users/4390045/cornking"}, "reply_to_user": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1426250446, "post_id": 28970563, "comment_id": 46305781, "body": "@Ditto - Data posted above"}], "answers": [{"tags": [], "owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "is_accepted": true, "score": 0, "last_activity_date": 1426262785, "creation_date": 1426262785, "answer_id": 29036911, "question_id": 28970563, "link": "https://stackoverflow.com/questions/28970563/vba-lowest-alphanumeric-text/29036911#29036911", "title": "vba lowest alphanumeric text", "body": "<p>The data works good like that .. as a screenshot, I wouldn't be able to view it here (from work), now would I be able to copy/paste it ;)</p>\n\n<p>Here's what I came up with based on what you show ... Not sure it's the most optimal way, however, it does work. Hoping if anyone else spots an easier way (I'm actually kind of hoping there's a function I don't know about) :)</p>\n\n<pre><code>  Function f_strmin(in_range As Range) As String\n      Dim lowstr As String\n      Dim firstpass As Boolean\n      firstpass = True\n\n      For Each cell In in_range\n          If firstpass And cell.Value &lt;&gt; \"\" Then\n              lowstr = cell.Value\n              firstpass = False\n          ElseIf cell.Value = \"\" Then\n              ' do nothing\n          ElseIf cell.Value &lt; lowstr Then\n              lowstr = cell.Value\n          End If\n      Next cell\n\n      f_strmin = lowstr\n  End Function\n\n  Sub test()\n      Dim r As Integer\n      Dim vr As String\n      Dim minval As String\n      Dim chk As Boolean\n\n      r = 1\n      vr = Trim(Str(r)) &amp; \":\" &amp; Trim(Str(r))\n\n      ' as long as the current row we're on has records .. keep going until we hit a blank row\n      Do While Application.WorksheetFunction.CountA(Range(vr)) &gt; 0\n          ' get the min value in this row\n          minval = f_strmin(Range(vr))\n\n          For c = 1 To 4\n              If Cells(r, c).Value &gt; minval Then\n                  chk = Cells(r, c).Insert(xlDown, xlFormatFromLeftOrAbove)\n              End If\n          Next c\n\n          r = r + 1\n          vr = Trim(Str(r)) &amp; \":\" &amp; Trim(Str(r))\n      Loop\n\n  End Sub\n</code></pre>\n\n<p>This set:</p>\n\n<pre><code>  2807516   1153634 1153634 3332241\n  3332241   2319999 2319999 3344644\n  3344644   2420083 2420083 3347024\n  3347024   2734988 2734988 3349486\n  3349486   2807516 2807516 3353163\n</code></pre>\n\n<p>Ends up as this:</p>\n\n<pre><code>            1153634 1153634 \n            2319999 2319999 \n            2420083 2420083 \n            2734988 2734988 \n  2807516   2807516 2807516 \n  3332241                      3332241\n  3344644                      3344644\n  3347024                      3347024\n  3349486                      3349486\n                               3353163\n</code></pre>\n\n<p>This set:</p>\n\n<pre><code>  2P9864    0V5170  0V5170  2P9864\n  5N7531    2P9864  2P9864  2W8150\n  3N8572    3L0415  3L0415  3N8572\n  5N7531    5N7531  4W1704  5N7531\n  6F5985    6F5985  5N7531  6F5985\n</code></pre>\n\n<p>Results in this:</p>\n\n<pre><code>            0V5170  0V5170  \n  2P9864    2P9864  2P9864   2P9864\n                             2W8150\n            3L0415  3L0415  \n                             3N8572\n                    4W1704  \n  5N7531    5N7531  5N7531   5N7531\n  3N8572            \n  5N7531            \n  6F5985    6F5985           6F5985\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4390045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4acf80d6687f7849d95b829dd6f3d1a1?s=128&d=identicon&r=PG&f=1", "display_name": "cornking", "link": "https://stackoverflow.com/users/4390045/cornking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 29036911, "answer_count": 1, "score": 0, "last_activity_date": 1426262785, "creation_date": 1426009495, "last_edit_date": 1531164843, "question_id": 28970563, "link": "https://stackoverflow.com/questions/28970563/vba-lowest-alphanumeric-text", "title": "vba lowest alphanumeric text", "body": "<p>How can I get the lowest alphanumeric cell value from a range of cells? I don't want to sort the cells and I don't want to look at the number values only. If I have the following cells:</p>\n\n<pre><code>2A1111\n4B0011\n2Z0011\n2A0011\n</code></pre>\n\n<p>Excel should know that 2A0011 is the lowest value since it will sort them correctly as:</p>\n\n<pre><code>2A0011\n2A1111\n2Z0011\n4B0011\n</code></pre>\n\n<p>In my macro, I am comparing the values of each cell in a row to the lowest valued cell in that row.  If a cell has a higher value, a new (blank) cell is added in its place and the entire column below the cell shifts down.</p>\n\n<pre><code>For cell = 1 To rLastCell.Columns.Count\n    If Cells(row, cell) &gt; Application.WorksheetFunction.Min(rLastCell.Rows(row)) Then\n        If Not rng2 Is Nothing Then\n            Set rng2 = Union(rng2, rLastCell(row, cell))\n        Else\n            Set rng2 = rLastCell(row, cell)\n        End If\n    End If\nNext\n</code></pre>\n\n<p>This works great with all of the rows with numbers-only in my spreadsheed, but when the row contains alphanumeric text, the <code>.Min(rLastCell.Rows(row))</code> has a value of 0 and therefore moves every cell in the row down.</p>\n\n<p>As a side note - almost all of the posts I have seen related to this involve ignoring the letter in the cell which means that 2A0011 and 2Z0011 are viewed as equal.</p>\n\n<p>Edit: @Ditto I don't have enough rep to post a screenshot so I'll try to format it out below...</p>\n\n<pre><code>2807516 1153634 1153634 3332241\n\n3332241 2319999 2319999 3344644\n\n3344644 2420083 2420083 3347024\n\n3347024 2734988 2734988 3349486\n\n3349486 2807516 2807516 3353163\n</code></pre>\n\n<p>The above will get reformated to the table below.</p>\n\n<pre><code>------- 1153634 1153634 ------- \n\n------- 2319999 2319999 ------- \n\n------- 2420083 2420083 ------- \n\n------- 2734988 2734988 ------- \n\n2807516 2807516 2807516 ------- \n\n3332241 ------- ------- 3332241\n\n3344644 ------- ------- 3344644\n\n3347024 ------- ------- 3347024\n\n3349486 ------- ------- 3349486\n\n------- ------- ------- 3353163\n</code></pre>\n\n<p>Below, is an example of some alphanumeric data</p>\n\n<pre><code>2P9864  0V5170  0V5170  2P9864\n\n5N7531  2P9864  2P9864  2W8150\n\n3N8572  3L0415  3L0415  3N8572\n\n5N7531  5N7531  4W1704  5N7531\n\n6F5985  6F5985  5N7531  6F5985\n</code></pre>\n\n<p>Sorry about the terrible formatting. There is NOT a good way to post tables!</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4655107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9025461adc84bf75152d9bb85d1afe9d?s=128&d=identicon&r=PG&f=1", "display_name": "Susan", "link": "https://stackoverflow.com/users/4655107/susan"}, "edited": false, "score": 0, "creation_date": 1426294557, "post_id": 28983837, "comment_id": 46328220, "body": "Thanks Eugene, But I&#39;m still not getting it. I have References to excel 14.0 object Library. I have place all dim statements out side the sub one at a time &amp; all together. but fount the answer at <a href=\"http://stackoverflow.com/questions/21709539/excel-interactions-dont-work-after-excel-file-opened\" title=\"excel interactions dont work after excel file opened\">stackoverflow.com/questions/21709539/&hellip;</a>."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1426068975, "creation_date": 1426068975, "answer_id": 28983837, "question_id": 28970516, "link": "https://stackoverflow.com/questions/28970516/vba-using-outlook-to-open-excel-not-opening/28983837#28983837", "title": "VBA Using Outlook to open excel not opening", "body": "<p>You need to declare the Excel Applicaton at the global scope and use it to open another workbooks. Not to create a new Excel instance for opening new files. You may find the <a href=\"http://support.microsoft.com/kb/219151\" rel=\"nofollow\">How to automate Microsoft Excel from Visual Basic</a> article helpful.</p>\n\n<p>For example, declare the Application object outside the event handler:</p>\n\n<pre><code>Dim oXL As Excel.Application\n\nPrivate Sub Command1_Click()\n   Dim oWB As Excel.Workbook\n</code></pre>\n\n<p>Thus, you will be able to re-use it for closing and opening new workbooks.</p>\n"}, {"comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1426296157, "post_id": 29044352, "comment_id": 46328521, "body": "Up one for solving it yourself. Also <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">check this out</a> which discussed various ways of how you can improve the way you work with objects."}], "tags": [], "owner": {"reputation": 21, "user_id": 4655107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9025461adc84bf75152d9bb85d1afe9d?s=128&d=identicon&r=PG&f=1", "display_name": "Susan", "link": "https://stackoverflow.com/users/4655107/susan"}, "is_accepted": true, "score": 1, "last_activity_date": 1426295497, "last_edit_date": 1495540308, "creation_date": 1426295497, "answer_id": 29044352, "question_id": 28970516, "link": "https://stackoverflow.com/questions/28970516/vba-using-outlook-to-open-excel-not-opening/29044352#29044352", "title": "VBA Using Outlook to open excel not opening", "body": "<p>Great code found at <a href=\"https://stackoverflow.com/questions/21709539/excel-interactions-dont-work-after-excel-file-opened\">Excel interactions don&#39;t work after Excel file opened</a>.</p>\n\n<p>why I could not find this last week who knows. </p>\n\n<pre><code>Sub Openexcel()\n' change\n  Dim xlApp As Excel.Application\n  Dim sourceWB As Excel.Workbook\n  Dim sourceSH As Excel.Worksheet\n'change\n  Set xlApp = New Excel.Application\n      With xlApp\n      .Visible = True\n      .EnableEvents = False\n      '.UserControl = False\n       '.DisplayAlerts = False\n       '.AskToUpdateLinks = False\n\nEnd With\n\nstrFile = \"E:\\All documents\\susan\\work\\Excel projects\\saving files to directory Clean.xls\"\n'change\nSet sourceWB = xlApp.Workbooks.Open(strFile, , False, , , , , , , True)\nSet sourceSH = sourceWB.Worksheets(\"Sheet2\")\nsourceWB.Activate\n\nEnd Sub\n</code></pre>\n\n<p>Thanks guys for all your thoughts.  </p>\n"}], "owner": {"reputation": 21, "user_id": 4655107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9025461adc84bf75152d9bb85d1afe9d?s=128&d=identicon&r=PG&f=1", "display_name": "Susan", "link": "https://stackoverflow.com/users/4655107/susan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4399, "favorite_count": 0, "accepted_answer_id": 29044352, "answer_count": 2, "score": 1, "last_activity_date": 1593475212, "creation_date": 1426009310, "last_edit_date": 1593475212, "question_id": 28970516, "link": "https://stackoverflow.com/questions/28970516/vba-using-outlook-to-open-excel-not-opening", "title": "VBA Using Outlook to open excel not opening", "body": "<p>Hi Thanks for your help.</p>\n\n<p>I have the follow code in Outlook 2010 &amp; 2007:</p>\n\n<pre><code>Sub Openexcel()\n    Dim xlApp As Object\n    Dim sourceWB As Workbook\n    Dim sourceSH As Worksheet\n    Dim strFile As String\n    Set xlApp = CreateObject(\"Excel.Application\")\n    With xlApp\n        .Visible = True\n        .EnableEvents = False\n    End With\n\n    strFile = \"E:\\All documents\\susan\\work\\Excel projects\\saving files to directory Clean.xls\"\n\n    Set sourceWB = Workbooks.Open(strFile, , False, , , , , , , True)\n    Set sourceSH = sourceWB.Worksheets(\"Sheet2\")\n    sourceWB.Activate\nEnd Sub\n</code></pre>\n\n<p>This code works the first time I use it after opening outlook but if I then close the excel file I can not use it again. I need to reopen this work book about 3 times</p>\n\n<p>The Question at<br>\n<a href=\"https://stackoverflow.com/questions/5094624/outlook-vba-open-excel\">Outlook VBA open excel</a>\nseen to have the same problem but I did not understand the answer.</p>\n\n<p>\"I got it figured out. I was opening a different workbook and then closing it before I try to open the second one and that was interfering with it. To fix this I kept the excel app open and <strong><em>reset the workbook object</em></strong> to the new workbook i wanted\"</p>\n\n<p>If some someone could help with the additional code that would be great. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4653554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YeqPF.png?s=128&g=1", "display_name": "Arwel The Iridescent", "link": "https://stackoverflow.com/users/4653554/arwel-the-iridescent"}, "is_accepted": false, "score": 0, "last_activity_date": 1426083215, "last_edit_date": 1426083215, "creation_date": 1426064890, "answer_id": 28982353, "question_id": 28970424, "link": "https://stackoverflow.com/questions/28970424/execl-data-auto-express/28982353#28982353", "title": "Execl Data Auto express", "body": "<p>You've left a lot to be considered such as; will the location of the data that you want to copy be the same each time? If not will the range be named?  Will the size of the range be the same every time? </p>\n\n<p>I think you're probably best off writing your update code in the Workbook_Open() event</p>\n\n<p>To get you started, you can open the workbook by using </p>\n\n<p><code>Dim wbUpdateFromMe As Workbook\n wbUpdateFromMe = Workbooks.Open(Filename:=sFullPathIncludingFileNameAndExtention)</code>  </p>\n\n<p>The path should look something like \\\\sharepoint.mysharepointsitename.com\\locationonsp\\updatefromme.xlm</p>\n\n<p>then use</p>\n\n<p><code>wbUpdateFromMe.sheets(\"FromSheetName\").Range(\"FromRangeName\").copy  Destination:=Thisworkbook.sheets(\"ToSheetName\").Range(\"ToRangeName\")</code> </p>\n\n<p>to copy and paste, but you may want to do some clearing out of old data first.</p>\n"}], "owner": {"reputation": 43, "user_id": 4655159, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4a5e095c1b3b376100ae4f5e6cbe8ddb?s=128&d=identicon&r=PG&f=1", "display_name": "Sahaj", "link": "https://stackoverflow.com/users/4655159/sahaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426083215, "creation_date": 1426009017, "question_id": 28970424, "link": "https://stackoverflow.com/questions/28970424/execl-data-auto-express", "title": "Execl Data Auto express", "body": "<p>I have a excel workbook that contains macros, I wanted to auto update the data that it contains. Right now I have to manually copy paste the data into the workbook, because the data is coming from a different excel worksheet. Is there a way I can auto update the data that is from a worksheet located on a sharepoint site online and is updated every night. </p>\n"}, {"tags": ["excel", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 4027092, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/paKEG.jpg?s=128&g=1", "display_name": "SriLaks", "link": "https://stackoverflow.com/users/4027092/srilaks"}, "is_accepted": false, "score": 0, "last_activity_date": 1426102555, "creation_date": 1426102555, "answer_id": 28995771, "question_id": 28970338, "link": "https://stackoverflow.com/questions/28970338/check-for-edit-mode-excel-from-access/28995771#28995771", "title": "Check for edit mode excel from access", "body": "<p>If you mean the excel application is still open in your VBA code, then try these methods.\nFirstly, check if all the referenced objects, recordsets, are closed in VBA code. Also the objects  and recordsets must be set to nothing.</p>\n\n<p>Or Check your task Manager, there might be an instance of Excel application open.</p>\n\n<p>If not these, what do you really want to do? because when you write a code to fetch data from excel it prompts the user to close the Excel application automatically.</p>\n"}], "owner": {"reputation": 145, "user_id": 4230234, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0d41eb4c4715102aac0c2cec29d0a5cc?s=128&d=identicon&r=PG&f=1", "display_name": "BobBetter", "link": "https://stackoverflow.com/users/4230234/bobbetter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1426102555, "creation_date": 1426008720, "question_id": 28970338, "link": "https://stackoverflow.com/questions/28970338/check-for-edit-mode-excel-from-access", "title": "Check for edit mode excel from access", "body": "<p>I run into several issues in my Access application when Excel is in edit mode at the same time. </p>\n\n<p>How can I check if an Excel application is in edit mode from Access (VBA Code)?  (So I can stop the Access makro and tell the users to close Excel before they continue)</p>\n\n<p>Thank you very much smart people!</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1426076817, "post_id": 28969556, "comment_id": 46221615, "body": "Duplicate of <a href=\"http://stackoverflow.com/questions/28934579/how-i-can-run-macro-automatically-with-new-email-arrives-in-outlook\" title=\"how i can run macro automatically with new email arrives in outlook\">stackoverflow.com/questions/28934579/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1426069354, "creation_date": 1426069354, "answer_id": 28983976, "question_id": 28969556, "link": "https://stackoverflow.com/questions/28969556/outlook-vba-works-in-editor-but-not-under-rule/28983976#28983976", "title": "Outlook VBA works in editor but not under rule", "body": "<p>There is no need to create a new Outlook Application instance in the VBA macro:</p>\n\n<pre><code>Set outlookApp = CreateObject(\"Outlook.Application\")\n</code></pre>\n\n<p>Instead, you need to use the Application property available in the VBA module:</p>\n\n<p>Set outlookApp = Application</p>\n\n<p>Also I see that you iterate over all tasks:</p>\n\n<pre><code>'Find today's volume email\nFor Each olMail In myTasks\n</code></pre>\n\n<p>I suppose you want to get some information from the incoming email message instead. If so, you need to use the argument passed to the sub instead:</p>\n\n<pre><code>Public Sub SaveEmailBody(itm As Outlook.MailItem)\n</code></pre>\n\n<p>The <strong>itm</strong> object represents the incoming email message. Use it in the code instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 4654936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50e35024c453b99682f207287141fc26?s=128&d=identicon&r=PG&f=1", "display_name": "jason", "link": "https://stackoverflow.com/users/4654936/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1426069354, "creation_date": 1426006367, "last_edit_date": 1426007849, "question_id": 28969556, "link": "https://stackoverflow.com/questions/28969556/outlook-vba-works-in-editor-but-not-under-rule", "title": "Outlook VBA works in editor but not under rule", "body": "<p>Have cobbled some code together to extract the body of a specific email I receive daily and copy it to an excel workbook.</p>\n\n<p>It will run in editor manually, but when applying it to a rule in outlook based on the words in the subject body, it will only open a new excel workbook.</p>\n\n<p>Will not give an error as well.</p>\n\n<p>I have read and research through the forums to get it to this level to work \u201d thanks to the CODE GOD\u2019S\u201d.</p>\n\n<p>Any direction or advise on getting this to work under a rule(run a script) would be much appreciated.</p>\n\n<p>Code below:</p>\n\n<pre><code>Public Sub SaveEmailBody(itm As Outlook.MailItem)\n\n    Dim outlookApp As New Outlook.Application\n    Dim olNs As Outlook.NameSpace\n    Dim Fldr As Outlook.MAPIFolder\n    Dim olMail As Variant\n    Dim myTasks\n    Dim xlApp As Object\n    Dim myXLApp As Excel.Application\n    Dim myXLWB As Excel.Workbook\n    Dim aFile As String\n    Dim TotalRows As Long, i As Long\n\n    'Delete yesterday's file\n    aFile = \"C:\\Reporting\\Input_files\\Volume.xls\"\n    If Len(Dir$(aFile)) &gt; 0 Then\n    Kill aFile\n    End If\n\n    Set outlookApp = CreateObject(\"Outlook.Application\")\n    Set olNs = outlookApp.GetNamespace(\"MAPI\")\n    Set Fldr = olNs.GetDefaultFolder(olFolderInbox)\n    Set myTasks = Fldr.Items\n    Set myXLApp = New Excel.Application\n    myXLApp.Visible = True\n    Set myXLWB = myXLApp.Workbooks.Add\n\n    'Find today's volume email\n    For Each olMail In myTasks\n    If (InStr(1, olMail.Body, \"ListVolume\", vbTextCompare) &gt; 0) Then\n        TotalRows = Sheets(1).Range(\"A65536\").End(xlUp).Row\n        i = TotalRows + 1 - 1\n\n            With myXLWB.Worksheets(1)\n            '.Cells(i, 1) = Format(myItem.SentOn, \"mm/dd/yyyy\")\n            '.Cells(i, 2) = myItem.SenderName\n            '.Cells(i, 3) = myItem.To\n            .Cells(i, 1) = olMail.Body\n\n            'Save today's volume email\n            ActiveWorkbook.SaveAs FileName:=\"C:\\Reporting\\Input_files\\Volume.xls\", FileFormat:= _\n            xlNormal, Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False _\n            , CreateBackup:=False\n\n            Set outlookApp = Nothing\n            myXLApp.Quit\n            Set myXLApp = Nothing\n            End With\n        Exit For\n    End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2204315"}, "edited": false, "score": 1, "creation_date": 1426007213, "post_id": 28969518, "comment_id": 46191225, "body": "I think we could do with more background to this. Can you define each source of data? Is it a continuous subform? Can you be more precise rather than say &#39;I&#39;d like to print most...&#39;. Do you want to print from the parent or subform? Could you set up a query for excatly what you want then send that to a spreadsheet?"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 1804370, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/3b14538d050465e2de7cd4cf00fbd5fb?s=128&d=identicon&r=PG", "display_name": "JeffO", "link": "https://stackoverflow.com/users/1804370/jeffo"}, "edited": false, "score": 0, "creation_date": 1426024976, "post_id": 28970390, "comment_id": 46201042, "body": "sorry for the unclear description, but this response was the easiest way to solve my problem.  thanks for the help."}], "tags": [], "owner": {"reputation": 159, "user_id": 3618351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380923b2c8631253ec3e791e2896868a?s=128&d=identicon&r=PG&f=1", "display_name": "EvDev", "link": "https://stackoverflow.com/users/3618351/evdev"}, "is_accepted": false, "score": 1, "last_activity_date": 1426008885, "creation_date": 1426008885, "answer_id": 28970390, "question_id": 28969518, "link": "https://stackoverflow.com/questions/28969518/populate-a-form-before-opening-in-ms-access-vba/28970390#28970390", "title": "Populate a form before opening in MS Access/VBA", "body": "<p>In Access controls (textboxes, lables, checkboxes, etc) have a property called \"display when\".  You can set controls to be displayed \"Screen Only\" so they won't appear when you click print.</p>\n"}, {"tags": [], "owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "is_accepted": false, "score": 1, "last_activity_date": 1426010688, "creation_date": 1426010688, "answer_id": 28970945, "question_id": 28969518, "link": "https://stackoverflow.com/questions/28969518/populate-a-form-before-opening-in-ms-access-vba/28970945#28970945", "title": "Populate a form before opening in MS Access/VBA", "body": "<p>While we could do with some more of an explanation it sounds like you want to print information to do with a record you are looking at.  You could make a form that looks how you want it to print, then on click of a button from your main form you can open the record you are viewing in the print form.  Then print from there. </p>\n"}], "owner": {"reputation": 117, "user_id": 1804370, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/3b14538d050465e2de7cd4cf00fbd5fb?s=128&d=identicon&r=PG", "display_name": "JeffO", "link": "https://stackoverflow.com/users/1804370/jeffo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1426010688, "creation_date": 1426006255, "question_id": 28969518, "link": "https://stackoverflow.com/questions/28969518/populate-a-form-before-opening-in-ms-access-vba", "title": "Populate a form before opening in MS Access/VBA", "body": "<p>I have a form in MS Access 2013.  I'd like to print most, but not all, of the values on the parent form (excluding some text fields, buttons, etc).  My initial approach is to create a child form with only the fields I'd like to be printed.  Upon clicking on a \"print\" button, I'd like to populate the fields on the child form with the corresponding data from the parent form, open the form, and print it.</p>\n\n<ol>\n<li>is this the correct approach to achieve what i'm trying to do?</li>\n<li>if so, can i create an instance of the form object, populate it, and open it (much as i would do in Java, which is the base of my coding knowledge).  what would that code look like?</li>\n</ol>\n\n<p>Thanks,</p>\n\n<p>jeff</p>\n"}, {"tags": ["database", "excel", "vba"], "comments": [{"owner": {"reputation": 476, "user_id": 4479078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d70f554e2d6dc6aa42d1995e0b3b6?s=128&d=identicon&r=PG&f=1", "display_name": "Caio C&#233;sar S. Leonardi", "link": "https://stackoverflow.com/users/4479078/caio-c%c3%a9sar-s-leonardi"}, "edited": false, "score": 0, "creation_date": 1426005793, "post_id": 28969233, "comment_id": 46190268, "body": "it seems like using a real UniqueId(one that actually can&#39;t repeat) would solve your problem way faster than going around like that..."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1426006921, "post_id": 28969233, "comment_id": 46191043, "body": "Suppose both <b>HSBC</b> and <b>CHASE</b> appear 5 times.....do you want both names ??"}, {"owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "edited": false, "score": 0, "creation_date": 1426008262, "post_id": 28969233, "comment_id": 46191915, "body": "No I want either to try to find a way to decide which one is the good one checking emails (if there are 4 emails in hsbc.com for example et 3 in chase.com), or either by sending a msgbox to choose manually between different cases or otherwise by creating a multi-choice box giving the choice between the different alternatives met"}, {"owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "edited": false, "score": 0, "creation_date": 1426008405, "post_id": 28969233, "comment_id": 46192020, "body": "Caio C&#233;sar S. Leonardi, I get your point but how am i going to know what the is the good information about my contacts ? Because it is the goal of this exercise, it comes to sort out a database of contacts"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "edited": false, "score": 0, "creation_date": 1426153019, "post_id": 28970585, "comment_id": 46258227, "body": "But there is a little problem Sir, the database on which I want to apply this is constituted of almost 50 000 rows so the manual approach risks being a bit time-consuming..Hence my question"}, {"owner": {"reputation": 31, "user_id": 4654444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gkdQ.jpg?s=128&g=1", "display_name": "JMMach", "link": "https://stackoverflow.com/users/4654444/jmmach"}, "reply_to_user": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "edited": false, "score": 0, "creation_date": 1426265945, "post_id": 28970585, "comment_id": 46316320, "body": "Take a small subset of the data, like 1000 records, then you can try things manually. Once you have it working manually to your satisfaction, then you can do it on the entire database recording the macro as you go. I would suggest writing down the sequence of steps that you will need to do. If you know how to edit a recorded macro then you can record it on the small data set and then edit the macro so it works ton the full data set. It may be a bit time consuming, but if you can get it working manually then you know you can automate the task with a macro and then save tons of time."}], "tags": [], "owner": {"reputation": 31, "user_id": 4654444, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6gkdQ.jpg?s=128&g=1", "display_name": "JMMach", "link": "https://stackoverflow.com/users/4654444/jmmach"}, "is_accepted": false, "score": 0, "last_activity_date": 1426009540, "creation_date": 1426009540, "answer_id": 28970585, "question_id": 28969233, "link": "https://stackoverflow.com/questions/28969233/vba-which-generates-the-result-which-appears-the-largest-number-of-times-of-o/28970585#28970585", "title": "VBA which generates the result which appears the largest number of times (# of occurences)", "body": "<p>I would first see if I get satisfactory results with the manual approach in Excel; if I am happy with the results I get manually then I would work on the code.\nSo with that in mind, try the MODE.Single() function at the head of each column or the Advanced Filter set for Unique might be your answer.\nYou need to get to know what is possible in Excel and how; that will go a long way to working the code, especially since you can record a lot of the code and then edit it as required.</p>\n"}], "owner": {"reputation": 1, "user_id": 4498411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e498404a5723f0fb1b837674629c26?s=128&d=identicon&r=PG&f=1", "display_name": "nilmar4", "link": "https://stackoverflow.com/users/4498411/nilmar4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1436312939, "creation_date": 1426005377, "last_edit_date": 1531164843, "question_id": 28969233, "link": "https://stackoverflow.com/questions/28969233/vba-which-generates-the-result-which-appears-the-largest-number-of-times-of-o", "title": "VBA which generates the result which appears the largest number of times (# of occurences)", "body": "<p>For example If I have a database of contacts with 9 columns and 22 rows with data about these contacts (first name, name, company, email, city, country, uniqueID, initial of the person which has this contact, etc.)(I can send it to you as an example to train you)</p>\n\n<p>Let's imagine that we are looking for people in this database. But you can have for example some duplicates with same name, same first name, same country, same uniqueID as a consequence (because it is constitued by firstname.name) but different companies, emails and city for a contact. Knowing that we want to make the research by uniqueID, if look for this guy you will find by Vlookup notably the first occurence of his information, I mean if the first company which appears for this guy in Company is \"BNP\" so, doing a Vlookup to know which is his company to put it in another database, i will find \"BNP\" wheareas after we can observe 5 times that people enter \"HSBC\" as a society for this guy so if we could take into account the number of times it appears we could have a more exact answer.</p>\n\n<p>In this case as \"HSBC\" appears 5 times against 1 for \"BNP\", we would like that our research (not necessarily a Vlookup) gives us the answer \"HSBC\" because it is the company which appears the largest number of times. If it will be possible to do this for each other information (name, city, country, etc.).</p>\n\n<p>And if we only have 2 possibilities with 2 different answers i would like that the macro looks for in the other cells of the row if it cannot find information like:</p>\n\n<ol>\n<li>Check the mail to see if we cannot find its company (e.g. @gemalto.com) in it</li>\n<li>Check if the mail don't finish by .fr to deduce that its country is France and not the one we have (e.g. @gemalto.fr)</li>\n<li>If nothing enables to take a decision, send a msgbox to the user in order him to choose between both option for each information for which the macro doesn't have enough information to decide</li>\n</ol>\n\n<p>I know how to use VBA but I do not have any idea on this subject. Tell me if you want me to send you a file example to try to find a solution.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1426007895, "post_id": 28969181, "comment_id": 46191660, "body": "Here&#39;s a rather ugly formula that should get you started: <code>=IF(ISNUMBER(MATCH(&quot;Red&quot;,$A1:$A1,0)),&quot;Yes&quot;,IF(COUNTIF(A2:A4,&zwnj;&#8203;&quot;green&quot;)&gt;0,&quot;Yes&quot;,IF(&zwnj;&#8203;COUNTIF(A2:A4,&quot;blue&quot;&zwnj;&#8203;)&gt;0,&quot;Yes&quot;,&quot;No&quot;)))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1426007611, "creation_date": 1426007611, "answer_id": 28970006, "question_id": 28969181, "link": "https://stackoverflow.com/questions/28969181/excel-check-a-range-for-multiple-values/28970006#28970006", "title": "Excel check a range for multiple values", "body": "<p>Here is a UDF that will work for your specific situation. Copy this code to a module and input \"=RngVal()\" into A5 and it will populate with \"Yes\" or \"No\" based on your criteria.</p>\n\n<pre><code>Function RngVal() as String\nDim flg as Boolean\nDim c as Range\nIf Range(\"A1\") = \"red\" Then\nRngVal = \"Yes\"\nElse\nFor Each c in Range(\"A2:A4\")\n   If c = \"blue\" or c = \"green\" Then\n   flg = true\n   Exit For\n   End If\nNext c\nIf flg = True\nRngVal = \"Yes\"\nElse\nRngVal = \"No\"\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4654836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ISbn.png?s=128&g=1", "display_name": "mikr79", "link": "https://stackoverflow.com/users/4654836/mikr79"}, "is_accepted": true, "score": 0, "last_activity_date": 1426067386, "creation_date": 1426067386, "answer_id": 28983230, "question_id": 28969181, "link": "https://stackoverflow.com/questions/28969181/excel-check-a-range-for-multiple-values/28983230#28983230", "title": "Excel check a range for multiple values", "body": "<p>I've used the answer provided by Portland Runner:</p>\n\n<p>=IF(ISNUMBER(MATCH(\"Red\",$A1:$A1,0)),\"Yes\",IF(COUNTIF(A2:A4,\"green\")>0,\"Yes\",IF\u200c\u200b(COUNTIF(A2:A4,\"blue\")>0,\"Yes\",\"No\")))</p>\n"}], "owner": {"reputation": 1, "user_id": 4654836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ISbn.png?s=128&g=1", "display_name": "mikr79", "link": "https://stackoverflow.com/users/4654836/mikr79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2595, "favorite_count": 0, "accepted_answer_id": 28983230, "answer_count": 2, "score": 0, "last_activity_date": 1426067386, "creation_date": 1426005229, "question_id": 28969181, "link": "https://stackoverflow.com/questions/28969181/excel-check-a-range-for-multiple-values", "title": "Excel check a range for multiple values", "body": "<p>I've scoured Google for some assistance with this Excel problem but to no avail.</p>\n\n<p>I have four input cells A1:A4 and one output cell A5. If cell A1 contains the word \"red\" I want the output cell to be modified from \"No\" (or blank) to \"Yes\". If cells A2:A4 contain the words \"green\" or \"blue\", I want the output cell A5 to be modified from \"No\" (or blank) to \"Yes\". If the contents of cells A1:A4 change to any other value or are blank I want the output cell A5 to be changed back to blank or \"No\".  </p>\n\n<p>Once completed, the solution will be copied down a number of further rows so I need it to dynamically update either when it copies or when it executes to ensure it is referencing in the correct row. </p>\n\n<p>So far I have the following formula embedded in Cell A5 and it is working fine. </p>\n\n<p>=IF(ISNUMBER(MATCH(\"Red\",$A1:$A1,0)),\"Yes\",\"No\")</p>\n\n<p>I am struggling to incorporate the conditions I need for cells A2:A4. </p>\n\n<p>I've tried conditional formatting, VBA modules, and formulae directly embedded in the cells but am not having much luck.</p>\n\n<p>Any help would be greatly appreciated. </p>\n\n<p>-Michael </p>\n"}]