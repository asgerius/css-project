[{"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1438855333, "post_id": 31844592, "comment_id": 51625222, "body": "I tried  <code>dbs.TableDefs(strTable).Connect = &quot;Provider=Microsoft.ACE.OLEDB.12.0; &quot; &amp; &quot;DATABASE= &quot; &amp; LnkDataBase &amp; &quot;;Jet OLEDB:Database Password=123;&quot;</code> But still not able to get it working. This code is giving error."}], "answers": [{"comments": [{"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1438820039, "post_id": 31844657, "comment_id": 51611055, "body": "users will be running front-end on Access 2013, so Microsoft.ACE.OLEDB.12.0 will work? OR I should use Microsoft.ACE.OLEDB.15.0 if this is logical.?"}, {"owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "reply_to_user": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1438825904, "post_id": 31844657, "comment_id": 51612373, "body": "12 will work, but 15 should also work. Test with 15, if successful, use 15."}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1438851911, "post_id": 31844657, "comment_id": 51622856, "body": "If the location of file is not accessible (Due to PC not connected to Network). The above code crashes Access. Can we add Some timeout to above code?"}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "edited": false, "score": 0, "creation_date": 1438854938, "post_id": 31844657, "comment_id": 51624964, "body": "Tried your solution, it gives error <code>Runtime error 3170</code>. <code>Could Not find installable ISAM</code>"}], "tags": [], "owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "is_accepted": false, "score": 1, "last_activity_date": 1438818771, "creation_date": 1438818771, "answer_id": 31844657, "question_id": 31844592, "link": "https://stackoverflow.com/questions/31844592/connecting-to-access-backend-from-access-2013-frontend-using-vba/31844657#31844657", "title": "Connecting to access backend from access 2013 frontend using VBA", "body": "<p>Give this a try:</p>\n\n<pre><code>Const LnkDataBase = \"C:\\MyDB_be.accdb\"\nSub relinktables()\n'Routine to relink the tables automatically. Change the constant LnkDataBase to the desired one and run the sub\nDim dbs As DAO.Database\nDim tdf As DAO.TableDef\nDim strTable As String\nSet dbs = CurrentDb()\nFor Each tdf In dbs.TableDefs\n    If Len(tdf.Connect) &gt; 1 Then 'Only relink linked tables\n        If tdf.Connect &lt;&gt; \";DATABASE=\" &amp; LnkDataBase Then 'only relink tables if the are not linked right\n            If Left(tdf.Connect, 4) &lt;&gt; \"ODBC\" Then 'Don't want to relink any ODBC tables\n                strTable = tdf.Name\n                dbs.TableDefs(strTable).Connect = \"Provider=Microsoft.ACE.OLEDB.12.0; \" _ \n&amp; \"Data Source= \" &amp; LnkDataBase &amp; \";\" _ \n&amp; \"Jet OLEDB:Database Password=123;\"\n                dbs.TableDefs(strTable).RefreshLink\n            End If\n        End If\n    End If\nNext tdf\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "edited": false, "score": 0, "creation_date": 1438901095, "post_id": 31853268, "comment_id": 51653128, "body": "What is the error code? You could just add <code>ON ERROR GOTO err_hndl</code> and deal with it there. Otherwise you can test for network connectivity using something like <code>If (Len(Dir(&quot;MappedDriveLetterHere:\\&quot;))) Then blnConnected=True</code>"}, {"owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "reply_to_user": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "edited": false, "score": 0, "creation_date": 1438950844, "post_id": 31853268, "comment_id": 51673249, "body": "There is NO Error shown. The Access Run time just Hangs. Nothing happens, and when Close button is pressed, Access Stops working and closes."}], "tags": [], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "is_accepted": true, "score": 0, "last_activity_date": 1438856624, "creation_date": 1438856624, "answer_id": 31853268, "question_id": 31844592, "link": "https://stackoverflow.com/questions/31844592/connecting-to-access-backend-from-access-2013-frontend-using-vba/31853268#31853268", "title": "Connecting to access backend from access 2013 frontend using VBA", "body": "<p>After investing another 4 Hrs to this problem. Finally found the solution.</p>\n\n<p>This is the code which worked flawlessly.</p>\n\n<pre><code>Const LnkDataBase = \"C:\\MyDB_be.accdb\"\nConst DBPassword = \"123\"\n\nSub relinktables()\n'Routine to relink the tables automatically. Change the constant LnkDataBase to the desired one and run the sub\nDim dbs As DAO.Database\nDim tdf As DAO.TableDef\nDim strTable As String\nSet dbs = CurrentDb()\nFor Each tdf In dbs.TableDefs\n    If Len(tdf.Connect) &gt; 1 Then 'Only relink linked tables\n        If tdf.Connect &lt;&gt; \";DATABASE=\" &amp; LnkDataBase Then 'only relink tables if the are not linked right\n            If Left(tdf.Connect, 4) &lt;&gt; \"ODBC\" Then 'Don't want to relink any ODBC tables\n                strTable = tdf.Name\n                dbs.TableDefs(strTable).Connect = \"MS Access;PWD=\" &amp; DBPassword &amp; \";DATABASE=\" &amp; LnkDataBase\n                dbs.TableDefs(strTable).RefreshLink\n            End If\n        End If\n    End If\nNext tdf\nEnd Sub\n</code></pre>\n\n<p>I would encourage VBA Experts to add their comments OR Modify this code to add Error Debugging. Like - IF PC is not connected to network, and the path specified is on Network, then Access hangs. This issue is yet to be fixed.</p>\n"}], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4144, "favorite_count": 0, "accepted_answer_id": 31853268, "answer_count": 2, "score": 2, "last_activity_date": 1438856624, "creation_date": 1438818296, "last_edit_date": 1495542612, "question_id": 31844592, "link": "https://stackoverflow.com/questions/31844592/connecting-to-access-backend-from-access-2013-frontend-using-vba", "title": "Connecting to access backend from access 2013 frontend using VBA", "body": "<p>I have 5-6 clients to whom I will be selling my Access based Product. Where there is Back-end Database file (Password Protected). Access <code>accdr</code> Front-end file which saves data in back-end file. The location of the backend file will change client to client, hence want to have a VBA Code which links front-end t back-end.</p>\n\n<p>I tried the below code</p>\n\n<pre><code>sConnect = \"Provider=Microsoft.ACE.OLEDB.12.0; \" _ \n    &amp; Data Source= \" &amp; \"C:\\MyDB_be.accdb\" &amp; \";\" _ \n    &amp; \"Jet OLEDB:Database Password=123;\"\n</code></pre>\n\n<p>But, the tables are not getting reconnected.</p>\n\n<p>I Got the above code from <a href=\"https://stackoverflow.com/questions/15682332/\">this Ques on Stackoverflow</a>. </p>\n\n<p>Then I tried the below code </p>\n\n<pre><code>Const LnkDataBase = \"C:\\MyDB_be.accdb\"\nSub relinktables()\n'Routine to relink the tables automatically. Change the constant LnkDataBase to the desired one and run the sub\nDim dbs As DAO.Database\nDim tdf As DAO.TableDef\nDim strTable As String\nSet dbs = CurrentDb()\nFor Each tdf In dbs.TableDefs\n    If Len(tdf.Connect) &gt; 1 Then 'Only relink linked tables\n        If tdf.Connect &lt;&gt; \";DATABASE=\" &amp; LnkDataBase Then 'only relink tables if the are not linked right\n            If Left(tdf.Connect, 4) &lt;&gt; \"ODBC\" Then 'Don't want to relink any ODBC tables\n                strTable = tdf.Name\n                dbs.TableDefs(strTable).Connect = \";DATABASE=\" &amp; LnkDataBase\n                dbs.TableDefs(strTable).RefreshLink\n            End If\n        End If\n    End If\nNext tdf\nEnd Sub\n</code></pre>\n\n<p>This works, when the file is not password protected. This code I got from <a href=\"https://stackoverflow.com/questions/4928134\">This Ques</a>. But there is no provision of specifying password.</p>\n\n<p>Please help me out.</p>\n\n<blockquote>\n  <p>Either point out mistake in 1st code. OR How to specify password in\n  2nd Code OR New code altogether.</p>\n</blockquote>\n\n<p>Spent 4 hrs on searching for solution. New to access VBA.</p>\n\n<p>Went through <a href=\"https://www.connectionstrings.com/access-2013/\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://www.freevbcode.com/ShowCode.asp?ID=468\" rel=\"nofollow noreferrer\">this</a>, but did not understand how to implement.</p>\n"}, {"tags": ["excel", "refresh", "vba"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1438812824, "post_id": 31843596, "comment_id": 51608898, "body": "did you try <code>TimeToRun = Now + TimeValue(&quot;00:00:&quot; &amp; Sheets(&quot;DataInput&quot;).Range(&quot;A1&quot;).Value)</code> where in cell A1 users can enter number of seconds (not letters or formulas)"}, {"owner": {"reputation": 41, "user_id": 5195759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/36e1p.jpg?s=128&g=1", "display_name": "HorseBeforeTheCart", "link": "https://stackoverflow.com/users/5195759/horsebeforethecart"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1438813779, "post_id": 31843596, "comment_id": 51609261, "body": "Thank you, I tried a lot of things that were very similar, but not quite.  Yours works wonderfully, though I don&#39;t need to specify sheets because I already had it activated.  Seems to me it doesn&#39;t have to be activated, so I will tinker some more.  The basics now work, thanks to you, Paul!"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1438815962, "post_id": 31843596, "comment_id": 51609969, "body": "I&#39;m glad it helped. I provided it as answer so that the question can be closed"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1438815896, "creation_date": 1438815896, "answer_id": 31844248, "question_id": 31843596, "link": "https://stackoverflow.com/questions/31843596/excel-macro-auto-refresh-workbook-based-on-user-input-time/31844248#31844248", "title": "Excel Macro auto-refresh workbook based on user input time", "body": "<p>Use <code>TimeToRun = Now + TimeValue(\"00:00:\" &amp; Sheets(\"DataInput\").Range(\"A1\").Value)</code></p>\n"}], "owner": {"reputation": 41, "user_id": 5195759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/36e1p.jpg?s=128&g=1", "display_name": "HorseBeforeTheCart", "link": "https://stackoverflow.com/users/5195759/horsebeforethecart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4766, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1438815896, "creation_date": 1438812148, "last_edit_date": 1531164843, "question_id": 31843596, "link": "https://stackoverflow.com/questions/31843596/excel-macro-auto-refresh-workbook-based-on-user-input-time", "title": "Excel Macro auto-refresh workbook based on user input time", "body": "<p>I use a lot of WEBSERVICE calls in my workbook, which is connectionless.  Therefore, the only way to periodically refresh values is with a macro.  To do so automatically upon workbook open and every 30 seconds thereafter, the following works great:</p>\n\n<pre><code>Dim TimeToRun\n\nSub auto_open()\nSheets(\"DataInput\").Select\nSheets(\"DataInput\").Range(\"A1\").Activate\n    Application.CalculateFull\n    Call ScheduleWorkbookRefresh\nEnd Sub\n\nSub ScheduleWorkbookRefresh()\n    TimeToRun = Now + TimeValue(\"00:00:30\")\n    Application.OnTime TimeToRun, \"WorkbookRefresh\"\nEnd Sub\n\nSub WorkbookRefresh()\n    Application.CalculateFull\n    Call ScheduleWorkbookRefresh\nEnd Sub\n\nSub auto_close()\n    Application.OnTime TimeToRun, \"WorkbookRefresh\", , False\nEnd Sub\n</code></pre>\n\n<p>As usual, users claim the refresh interval of 30 seconds is somewhere between too short and too long.  So, the idea is to let users fill in the interval they want in cell B9.  However, there doesn't seem to be an acceptable way to put a cell number (or variable) into the TimeValue function.</p>\n\n<p>Any ideas on how I might modify the macro to allow users to choose their own refresh interval, other than making the macro available for user edit (similar to handing a loaded gun, safety off, to a troop of chimpanzees)?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438810589, "post_id": 31843192, "comment_id": 51608016, "body": "That doesn&#39;t work? What does the error show, if there is one? What happens if you step through the VB script and it gets to that line? (use <code>F8</code> to step through).  Check the capitalization in &quot;Good&quot; and &quot;Bad&quot; to match what the style actually has (caps or no caps)."}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 1, "last_activity_date": 1470821085, "last_edit_date": 1470821085, "creation_date": 1438810588, "answer_id": 31843269, "question_id": 31843192, "link": "https://stackoverflow.com/questions/31843192/check-cell-style-in-vba/31843269#31843269", "title": "Check Cell Style in VBA", "body": "<p>When I used the \"Record Macro\" to record me changing these this is the code generated :</p>\n\n<pre><code>Range(\"I6\").Select\nSelection.Style = \"Bad\"\nRange(\"I9\").Select\nSelection.Style = \"Good\"\n</code></pre>\n\n<p>I conclude that you need to use an upper case \"G\" ie  \"Good\"  not \"good\"</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1438843031, "creation_date": 1438843031, "answer_id": 31848434, "question_id": 31843192, "link": "https://stackoverflow.com/questions/31843192/check-cell-style-in-vba/31848434#31848434", "title": "Check Cell Style in VBA", "body": "<p>To cover options something like</p>\n\n<pre><code>Sub TellMe()\nSelect Case [f2].Style\n    Case \"Good\"\n    Debug.Print \"style = Good\"\n    Case \"Bad\"\n    Debug.Print \"style = Bad\"\n    Case Else\n    Debug.Print [f2].Style\nEnd Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4406628, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a793e1d577a85f7616e07531e8393016?s=128&d=identicon&r=PG&f=1", "display_name": "QProgram", "link": "https://stackoverflow.com/users/4406628/qprogram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4578, "favorite_count": 0, "accepted_answer_id": 31843269, "answer_count": 2, "score": 1, "last_activity_date": 1470821085, "creation_date": 1438810247, "question_id": 31843192, "link": "https://stackoverflow.com/questions/31843192/check-cell-style-in-vba", "title": "Check Cell Style in VBA", "body": "<p>I have a spreadsheet that has a number of cells styled \"Good\" and \"Bad\" From the home tab.  I would like my VBA program to check if a cell is formatted as \"Good\" or \"Bad\".  I can't find any answers on here about the style of a cell.  I can tell you what I have tried and found it not working:</p>\n\n<p>if Range(\"f2\").style = \"good\" then\ndo stuff\nend if</p>\n\n<p>Excel 2010\nThanks for any help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "edited": false, "score": 0, "creation_date": 1438866501, "post_id": 31843810, "comment_id": 51632652, "body": "I updated the code and was wondering if you could clarify what you mean? I tried applying your answer but it didn&#39;t work."}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 2, "last_activity_date": 1438869685, "last_edit_date": 1438869685, "creation_date": 1438813340, "answer_id": 31843810, "question_id": 31842675, "link": "https://stackoverflow.com/questions/31842675/moving-labels-on-chart/31843810#31843810", "title": "Moving labels on chart", "body": "<p>Here's what I had in mind:</p>\n\n<pre><code>Sub MoveLabels()\n\n    Dim objPt As Point\n    Dim LabelPosition as xlDataLabelPosition\n    LabelPosition = xlLabelPositionBelow   ' Initialize\n\n    For Each objPt In ActiveChart.SeriesCollection(1).Points\n\n            objPt.DataLabel.Position = LabelPosition \n            objPt.DataLabel.HorizontalAlignment = xlCenter         \n            objPt.DataLabel.VerticalAlignment = xlTop\n            objPt.DataLabel.Orientation = xlHorizontal\n\n            ' Toggle label position\n            LabelPosition = Iif(LabelPosition = xlLabelPositionBelow, xlLabelPositionAbove, xlLabelPositionBelow)\n    Next\nEnd Sub\n</code></pre>\n\n<p>Or you could use a FOR I = 1 to .... Points.Count and set the position based on I MOD 2</p>\n"}], "owner": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1097, "favorite_count": 0, "accepted_answer_id": 31843810, "answer_count": 1, "score": 0, "last_activity_date": 1438869685, "creation_date": 1438808178, "last_edit_date": 1531164843, "question_id": 31842675, "link": "https://stackoverflow.com/questions/31842675/moving-labels-on-chart", "title": "Moving labels on chart", "body": "<p>I am trying to move the label for every other point in the series starting at 1, below the point, and every label for every other point starting at 2, above the point. Is there a way to 'skip' like using a regular \"for..next\" loop? It works for all of points if i execute the first part of the if, but I'm not sure how to make it do only every other point.</p>\n\n<pre><code>Sub MoveLabels()\n\n  Dim objPt As Point\n\n        For Each objPt In ActiveChart.SeriesCollection(1).Points\n\n                objPt.DataLabel.Position = xlLabelPositionBelow\n                objPt.DataLabel.HorizontalAlignment = xlCenter         \n                objPt.DataLabel.VerticalAlignment = xlTop\n                objPt.DataLabel.Orientation = xlHorizontal\n\n        Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 2, "creation_date": 1438810337, "post_id": 31842629, "comment_id": 51607912, "body": "See this link: <a href=\"https://social.msdn.microsoft.com/forums/en-US/9f6891f2-d0c4-47a6-b63f-48405aae4022/powerpoint-run-macro-on-timer\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/forums/en-US/&hellip;</a> to create a timer for PowerPoint.  Then put code in to check the current time vs the time you want to go to the slide and then if the time has reached this time, go to that slide."}, {"owner": {"reputation": 2040, "user_id": 1669111, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f68d295d8eaf92abe7983da9babc3f3f?s=128&d=identicon&r=PG&f=1", "display_name": "z--", "link": "https://stackoverflow.com/users/1669111/z"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1439026921, "post_id": 31842629, "comment_id": 51700254, "body": "@OpiesDad I suggest that you move your comment to an answer...."}], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1439214586, "creation_date": 1439214586, "answer_id": 31921343, "question_id": 31842629, "link": "https://stackoverflow.com/questions/31842629/powerpoint-changing-slide-at-specific-time/31921343#31921343", "title": "Powerpoint Changing Slide at Specific Time", "body": "<p>See this link: social.msdn.microsoft.com/forums/en-US/\u2026 to create a timer for PowerPoint. </p>\n\n<p>Then put code in to check the current time vs the time you want to go to the slide and then if the time has reached this time, go to that slide.</p>\n"}], "owner": {"reputation": 53, "user_id": 4777790, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vnNn6ecel5M/AAAAAAAAAAI/AAAAAAAAAME/P947SEHJo2k/photo.jpg?sz=128", "display_name": "James519", "link": "https://stackoverflow.com/users/4777790/james519"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 784, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439214586, "creation_date": 1438808071, "question_id": 31842629, "link": "https://stackoverflow.com/questions/31842629/powerpoint-changing-slide-at-specific-time", "title": "Powerpoint Changing Slide at Specific Time", "body": "<p>I was wondering if there is a script that I can add to my powerpoint presentation to allow it to change to a specific slide at a given computer time.</p>\n\n<p>For example I would like the powerpoint to loop through some slides and then at 10am I would like it to go to a slide that is hidden from the loop and stay at that slide. I was wondering if that could be done? If possible that would be amazing and I would love it if it could :)</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1438807724, "post_id": 31842372, "comment_id": 51606602, "body": "Create <code>singer</code> as a Global variable.  It can&#39;t be a Constant though, since its value can&#39;t be known at compile time.  You&#39;ll have to populate it at some point in your code."}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 3, "last_activity_date": 1438808714, "creation_date": 1438808714, "answer_id": 31842815, "question_id": 31842372, "link": "https://stackoverflow.com/questions/31842372/user-defined-constant-types-in-vba/31842815#31842815", "title": "User-defined constant types in VBA", "body": "<p>Here is how I would do it.</p>\n\n<p>Code in a module:</p>\n\n<pre><code>Option Explicit\n\nPublic Type Person\n    Name As String\n    Age As Integer\nEnd Type\n\n\nPrivate cvsinger As Person\n\nPublic Function singer() As Person\n\n    Static ConstantHasBeenSet  As Boolean\n\n    If Not ConstantHasBeenSet Then\n        cvsinger.Name = \"John\"\n        cvsinger.Age = 37\n    End If\n\n    singer = cvsinger\n\nEnd Function\n\nPublic Sub CreatePerson()\n\n    Debug.Print singer.Name, singer.Age\n\nEnd Sub\n</code></pre>\n\n<p>This is a fairly trivial case, but when the code to find the default values takes longer to process the use of ConstantHasBeenSet becomes worthwhile</p>\n\n<p>(Note that I would also use a similar technique for setting default values for properties in a class)</p>\n"}], "owner": {"reputation": 57, "user_id": 3983013, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/67c97633bd7f1e8c012898bfa9f683ae?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Michalczyk", "link": "https://stackoverflow.com/users/3983013/piotr-michalczyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "accepted_answer_id": 31842815, "answer_count": 1, "score": 3, "last_activity_date": 1438808714, "creation_date": 1438807096, "question_id": 31842372, "link": "https://stackoverflow.com/questions/31842372/user-defined-constant-types-in-vba", "title": "User-defined constant types in VBA", "body": "<p>I would like to define a custom data type in VBA and use it to create some user-defined constants. For example:</p>\n\n<pre><code>Public Type Person\n    Name as String\n    Age as Integer\nEnd Type\n\nPublic Sub CreatePerson\n    Dim singer as Person\n    singer.Name = \"John\"\n    singer.Age = 37\nEnd Sub\n</code></pre>\n\n<p>I would like to make <code>singer</code> to be constant which will be visible in other subroutines/functions in the same module. Is it possible? If not, how is the best way to store constant values which are connected to each other (like in the example above where <code>Name</code> is connected to <code>Age</code>)?</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 2418, "user_id": 4205652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-JU-6fQpM_Xs/AAAAAAAAAAI/AAAAAAAAAFA/BmnAnM8FkMM/photo.jpg?sz=128", "display_name": "Richard Erickson", "link": "https://stackoverflow.com/users/4205652/richard-erickson"}, "edited": false, "score": 0, "creation_date": 1438807290, "post_id": 31842300, "comment_id": 51606334, "body": "Welcome to SO and thank you for posting a question. Please include a <a href=\"http://stackoverflow.com/help/mcve\">MVCE</a> as part of you post. In addition to helping us see your data, this will show us what you&#39;ve tried to do so far."}, {"owner": {"reputation": 2418, "user_id": 4205652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-JU-6fQpM_Xs/AAAAAAAAAAI/AAAAAAAAAFA/BmnAnM8FkMM/photo.jpg?sz=128", "display_name": "Richard Erickson", "link": "https://stackoverflow.com/users/4205652/richard-erickson"}, "edited": false, "score": 0, "creation_date": 1438807378, "post_id": 31842300, "comment_id": 51606385, "body": "Welcome to SO and thank you for posting a question. Please include a <a href=\"http://stackoverflow.com/help/mcve\">MVCE</a> as part of you post. In addition to helping us see your data, this will show us what you&#39;ve tried to do so far. Also, asking us &quot;Does any have an example of this they could show me?&quot; is asking for an off site resource. Please show us what you&#39;ve tried to do."}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1438807378, "creation_date": 1438807378, "answer_id": 31842453, "question_id": 31842300, "link": "https://stackoverflow.com/questions/31842300/vba-if-then-statement-multiple-filters/31842453#31842453", "title": "VBA If then statement Multiple filters", "body": "<p>Your question didn't make much sense.</p>\n\n<p>You can use </p>\n\n<pre><code>InStr( [start], string, substring, [compare] )\n</code></pre>\n\n<p>to fin if one string is in another.</p>\n"}], "owner": {"reputation": 3, "user_id": 5195635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a558b77c4a920f5a27c898a78f0164b?s=128&d=identicon&r=PG&f=1", "display_name": "HHadden", "link": "https://stackoverflow.com/users/5195635/hhadden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1438807841, "creation_date": 1438806847, "last_edit_date": 1438807841, "question_id": 31842300, "link": "https://stackoverflow.com/questions/31842300/vba-if-then-statement-multiple-filters", "title": "VBA If then statement Multiple filters", "body": "<p>I am working on a spreadsheet where I want to exclude any entries that have a zero under the hours worked field, except for those entries that have a code beginning with a \"S\". How do I accomplish this task? My plan was to use an if then statement but I haven't been able to get it too work</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438806771, "post_id": 31842240, "comment_id": 51606023, "body": "what is the difference between the 2? They both look the same to me?"}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438806963, "post_id": 31842240, "comment_id": 51606121, "body": "Fixed the mistake as soon as I saw it. Thanks!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438806988, "post_id": 31842240, "comment_id": 51606136, "body": "I have rolledback the edit as your edit merged with my edit (system glitch?) I had just added the tags"}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1438807109, "post_id": 31842322, "comment_id": 51606215, "body": "While <code>PasteSpecial</code> is a property of a cell ? Is <code>*Source*.Copy *Destination*</code> the commonly used Copy/Paste method ?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 1, "creation_date": 1438807157, "post_id": 31842322, "comment_id": 51606248, "body": "No not necessarily. I can also use <code>Range(&quot;a1&quot;).value = Range(&quot;A2&quot;).value</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 1, "creation_date": 1438807432, "post_id": 31842322, "comment_id": 51606422, "body": "I have deleted my comment and updated it in my answer"}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1438807539, "post_id": 31842322, "comment_id": 51606499, "body": "How can I find out what properties <code>Cells</code> has ? <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">This page</a> doesn&#39;t seem to list them."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 1, "creation_date": 1438807710, "post_id": 31842322, "comment_id": 51606592, "body": "If you type <code>.</code> after the Cells, intellisense can show you that or you can see <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff197454.aspx\" rel=\"nofollow noreferrer\">THIS</a>"}, {"owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 0, "creation_date": 1438807767, "post_id": 31842322, "comment_id": 51606622, "body": "Not sure if this is obvious, but it just clicked for me. <code>.Paste</code> being a property of sheets means that <code>.Paste(cells(1,1))</code> works."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "edited": false, "score": 1, "creation_date": 1438807887, "post_id": 31842322, "comment_id": 51606694, "body": "Yes it will because the syntax is <code>sheet.paste(destination)</code> Like I said <code>.paste</code> is a property of the sheet and not the cells object :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 6, "last_activity_date": 1438807414, "last_edit_date": 1438807414, "creation_date": 1438806937, "answer_id": 31842322, "question_id": 31842240, "link": "https://stackoverflow.com/questions/31842240/cells-paste-vs-cells-pastespecial/31842322#31842322", "title": "cells().paste VS cells.pastespecial?", "body": "<p>The answer is very simple <code>.Paste</code> is not a property of the <code>Cells</code> object but of the <code>Worksheet</code> Object</p>\n\n<p>If you type <code>.</code> after the <code>Cells</code>, Intellisense will confirm that fact :)</p>\n\n<p>There are various ways to copy data across.</p>\n\n<p>If you want to only copy values across and not the formatting then this is the best way</p>\n\n<pre><code>rng1.Value = rng2.Value\n</code></pre>\n\n<p>If you want to carry the formatting then either you can use </p>\n\n<pre><code>Rng1.copy Rng2 \n</code></pre>\n\n<p>or </p>\n\n<pre><code>Rng1.Copy\nrng2.pastespecial\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 3862955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a7c62e0ef10a9877c967de600ceef1c9?s=128&d=identicon&r=PG&f=1", "display_name": "newdimension", "link": "https://stackoverflow.com/users/3862955/newdimension"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13287, "favorite_count": 2, "accepted_answer_id": 31842322, "answer_count": 1, "score": 5, "last_activity_date": 1438807444, "creation_date": 1438806596, "last_edit_date": 1531161705, "question_id": 31842240, "link": "https://stackoverflow.com/questions/31842240/cells-paste-vs-cells-pastespecial", "title": "cells().paste VS cells.pastespecial?", "body": "<p>How come below code works:  </p>\n\n<pre><code>.Range(\"D4:F4\").copy\n.cells(1,1).PasteSpecial  \n</code></pre>\n\n<p>While below doesn't work:  </p>\n\n<pre><code>.Range(\"D4:F4\").copy\n.cells(1,1).Paste  \n</code></pre>\n\n<p>I realize that the correct syntax is</p>\n\n<pre><code>.Range(\"D4:F4\").copy Destination:=\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "edited": false, "score": 0, "creation_date": 1438805764, "post_id": 31841978, "comment_id": 51605478, "body": "You could do a copy to destination instead. <code>y.Sheets(&quot;Sheet1&quot;).Range(&quot;A1:F5&quot;).Copy  destination:=x.Sheets(&quot;InputSheet&quot;).Range(&quot;A1:F5&quot;)</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438805944, "post_id": 31841978, "comment_id": 51605565, "body": "<code>&#39;it doesnt like the last line</code>? What error do you get?"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438871889, "post_id": 31841978, "comment_id": 51636784, "body": "Run time error &#39;91&#39; object variable or block variable not set."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1438872870, "post_id": 31841978, "comment_id": 51637562, "body": "no matter what, you have to tell it what X is. just telling the compiler X is a workbook only gets you 1/2 way there.  Set X to be the name of the ActiveWorkbook (or whatever the name of the source workbook is) should get you closer..."}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438806064, "post_id": 31842082, "comment_id": 51605637, "body": "<code>Copy to destination instead.</code>? Why? what is wrong with OP&#39;s original approach?"}, {"owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438862582, "post_id": 31842082, "comment_id": 51629792, "body": "Without knowing the source and destination, the values won&#39;t work with merged cells, which will cause an error.  Your other option is to figure out what&#39;s actually causing the problem and address that."}], "tags": [], "owner": {"reputation": 421, "user_id": 5024658, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-md8UhJRxd_g/AAAAAAAAAAI/AAAAAAAAhyg/igUflaP6DH4/photo.jpg?sz=128", "display_name": "Liss", "link": "https://stackoverflow.com/users/5024658/liss"}, "is_accepted": false, "score": 0, "last_activity_date": 1438805922, "creation_date": 1438805922, "answer_id": 31842082, "question_id": 31841978, "link": "https://stackoverflow.com/questions/31841978/multi-step-copy-and-paste-vba-script/31842082#31842082", "title": "Multi step Copy and paste VBA script", "body": "<p>Copy to destination instead. </p>\n\n<pre><code>y.Sheets(\"Sheet1\").Range(\"A1:F5\").Copy _           \n   destination:=x.Sheets(\"InputSheet\").Range(\"A1:F5\") \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438870958, "post_id": 31842216, "comment_id": 51635999, "body": "Let me try some of the things suggested and ill get back asap. I did not open X workbook because its going to be open already. The macro run button is in the X workbook."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438876085, "post_id": 31842216, "comment_id": 51640012, "body": "If it is already open then also you need to initialize <code>x</code> For example <code>Set X = Workbooks(&quot;Blah.xlsm&quot;)</code>"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438877855, "post_id": 31842216, "comment_id": 51641246, "body": "Error &#39;9&#39; Subscript out of range     Set x = Workbooks(&quot;C:\\Users\\aholiday\\Desktop\\Test_input.xlsm&quot;)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438882715, "post_id": 31842216, "comment_id": 51643878, "body": "<code>Set x = Workbooks(&quot;Test_input.xlsm&quot;)</code>"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438885340, "post_id": 31842216, "comment_id": 51645385, "body": "Boom! Step 1 and 2 complete! Thank you so much! Any advice on the rest of what im trying to do? step 3 and 4?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438888473, "post_id": 31842216, "comment_id": 51647105, "body": "Sure but first post the code that you tried and show us where are you stuck"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438889593, "post_id": 31842216, "comment_id": 51647708, "body": "I put it in the OP under Update, Before i was just testing between 2 files now i have the actual files ill be using. I dont know how to loop the copy paste so it paste down to the next empty cells."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438889815, "post_id": 31842216, "comment_id": 51647818, "body": "Yes but that code doesn&#39;t show what have you tried for points 3rd and 4th.  Please show what have you tried and specially where are you stuck?"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438890401, "post_id": 31842216, "comment_id": 51648139, "body": "I havent tried anything yet for 3 and 4 because i dont know what i should try, Im new to this... It needs to repeat each time i press a macro linked button but with the row change. Im stuck on what to do next"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "edited": false, "score": 0, "creation_date": 1438916423, "post_id": 31842216, "comment_id": 51656767, "body": "I know you  haven&#39;t tried anything and hence I want you to try something. :) Do some research in google and stackoverflow. Try and record a macro and see how the code works out. And then when you have tried it, post a new question with the code that you tried and then we will take it from there. I am sorry but I do not give code in a platter."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 0, "last_activity_date": 1438806497, "creation_date": 1438806497, "answer_id": 31842216, "question_id": 31841978, "link": "https://stackoverflow.com/questions/31841978/multi-step-copy-and-paste-vba-script/31842216#31842216", "title": "Multi step Copy and paste VBA script", "body": "<blockquote>\n  <p>This one wont work, it opens the out put but doesn't copy the cells</p>\n</blockquote>\n\n<p>I don't see you opening the <code>X</code> Workbook.</p>\n\n<p>This works for me just fine, provided the cell in <code>y.Sheets(\"Sheet1\")</code> are unlocked.</p>\n\n<p>Also notice the use of <code>.Value</code> on both ends.</p>\n\n<pre><code>Sub DataTransfer()\n    Dim x As Workbook, y As Workbook\n\n    Set y = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\Test_output.xlsm\")\n    Set x = Workbooks.Open(\"C:\\Blah Blah\\Blah.xlsm\") '&lt;~~ Change as Applicable\n\n    y.Sheets(\"Sheet1\").Range(\"A1:F5\").Value = x.Sheets(\"InputSheet\").Range(\"A1:F5\").Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 31842216, "answer_count": 2, "score": 0, "last_activity_date": 1438965793, "creation_date": 1438805559, "last_edit_date": 1438965793, "question_id": 31841978, "link": "https://stackoverflow.com/questions/31841978/multi-step-copy-and-paste-vba-script", "title": "Multi step Copy and paste VBA script", "body": "<p>I'm trying to pull data (cells) from four test result (each a different excel file) so that the average can be calculated within the template. Then to loop and do the same thing with the next four test but have the VBA script place y cells down. I'm trying to do exactly the following,</p>\n\n<ol>\n<li>To protect the cells except for certain ones for data input.- Done</li>\n<li>Upon pushing an inserted button run a VBA script that will copy and paste certain cells from four other excel workbooks. Done</li>\n<li>After those four are copy and pasted, for the VBA script to loop but paste y amount cells down. </li>\n<li>And last to force save as for this is a public template and don't want it to be changed.</li>\n</ol>\n\n<p>I'm having trouble with 3-4, So far i have the following for code..., but i haven't done very much of this to know order/ correct code commands. </p>\n\n<p>What i Have so Far</p>\n\n<p><strong>Step 1:Done</strong></p>\n\n<pre><code>Sub ProtectSheetDataInput ()\n\nWorksheets(\"DataInput\").Cells.Locked = False\nWorksheets(\"DataInput\").Range(\"A1:B283,C1:N3\").Locked = True\nWorksheets(\"DataInput\").Protect Password:=\"----coop\", UserInterfaceOnly:=True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Step 2: Done</strong></p>\n\n<pre><code>'Separate Macro    \n\nSub DataTransfer()\n\nDim w As Workbook 'Test_Location 1\nDim x As Workbook 'Test_Location 2\nDim y As Workbook 'Test_Location 3\nDim z As Workbook 'Test_Location 4\nDim Alpha As Workbook 'Template\n\nSet w = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_1.xls\")\nSet x = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_2.xls\")\nSet y = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_3.xls\")\nSet z = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_4.xls\")\nSet Alpha = Workbooks(\"FRF_Data_Sheet_Template.xlsm\")\n\n    Alpha.Sheets(\"DataInput\").Range(\"C4:E8\").Value = w.Sheets(\"Data\").Range(\"I3:K7\").Value\n    Alpha.Sheets(\"DataInput\").Range(\"F4:H8\").Value = x.Sheets(\"Data\").Range(\"I3:K7\").Value\n    Alpha.Sheets(\"DataInput\").Range(\"I4:K8\").Value = y.Sheets(\"Data\").Range(\"I3:K7\").Value\n    Alpha.Sheets(\"DataInput\").Range(\"L4:N8\").Value = z.Sheets(\"Data\").Range(\"I3:K7\").Value\n\n    w.Close False\n    x.Close False\n    y.Close False\n    z.Close False\n\nEnd Sub\n</code></pre>\n\n<p><strong>Step 3 Update:</strong> Tired to do a If find blank in Column C then Paste... did not work. Error at </p>\n\n<pre><code> If Columns(\"C\").Value = \"\" Then \n</code></pre>\n\n<p>\"type mismatch\"</p>\n\n<pre><code>Sub DataTransfer()\n\nApplication.ScreenUpdating = False\nDim w As Workbook 'Test_Location 1\nDim x As Workbook 'Test_Location 2\nDim y As Workbook 'Test_Location 3\nDim z As Workbook 'Test_Location 4\nDim Alpha As Workbook 'Template\nDim Emptyrow As Long 'Next Empty Row\n\n    Set w = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_1.xls\")\n    Set x = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_2.xls\")\n    Set y = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_3.xls\")\n    Set z = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_4.xls\")\n    Set Alpha = Workbooks(\"FRF_Data_Sheet_Template.xlsm\")\n\n        If Columns(\"C\").Value = \"\" Then\n            Alpha.Sheets(\"DataInput\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Value = w.Sheets(\"Data\").Range(\"I3:K7\").Value\n            Alpha.Sheets(\"DataInput\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Value = x.Sheets(\"Data\").Range(\"I3:K7\").Value\n            Alpha.Sheets(\"DataInput\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Value = y.Sheets(\"Data\").Range(\"I3:K7\").Value\n            Alpha.Sheets(\"DataInput\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Value = z.Sheets(\"Data\").Range(\"I3:K7\").Value\n\n            w.Close False\n            x.Close False\n            y.Close False\n            z.Close False\n        End If\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Then i Tried a different approach, I got this to work between 2 worksheets but i cant get it to work Between Multiple Workbooks. I get 'Runtime Error '9' Subscript out of range for this line.</p>\n\n<pre><code>Alpha.Sheets(DataInput).Activate\n</code></pre>\n\n<p>'</p>\n\n<pre><code>Sub DataTransfer()\n\nApplication.ScreenUpdating = False\nDim w As Workbook 'Test_Location 1\nDim x As Workbook 'Test_Location 2\nDim y As Workbook 'Test_Location 3\nDim z As Workbook 'Test_Location 4\nDim Alpha As Workbook 'Template\nDim Emptyrow As Range\n\n    Set w = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_1.xls\")\n    Set x = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_2.xls\")\n    Set y = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_3.xls\")\n    Set z = Workbooks.Open(\"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\location_4.xls\")\n    Set Alpha = Workbooks(\"FRF_Data_Sheet_Template.xlsm\")\n    Set EmptyrowC = Range(\"C\" &amp; Sheets(\"DataInput\").UsedRange.Rows.Count + 1)\n    Set EmptyrowF = Range(\"F\" &amp; Sheets(\"DataInput\").UsedRange.Rows.Count + 1)\n    Set EmptyrowI = Range(\"I\" &amp; Sheets(\"DataInput\").UsedRange.Rows.Count + 1)\n    Set EmptyrowL = Range(\"L\" &amp; Sheets(\"DataInput\").UsedRange.Rows.Count + 1)\n\n        w.Sheets(\"Data\").Range(\"I3:K7\").Copy\n        Alpha.Sheets(DataInput).Active\n            NextRow.PasteSpecial Paste:=xlValues, Transpose:=False\n            Application.CutCopyMode = False\n            Set NextRow = Nothing\n        x.Sheets(\"Data\").Range(\"I3:K7\").Copy\n            Alpha.Sheets(DataInput).Active\n            NextRow.PasteSpecial Paste:=xlValues, Transpose:=False\n            Application.CutCopyMode = False\n            Set NextRow = Nothing\n        y.Sheets(\"Data\").Range(\"I3:K7\").Copy\n            Alpha.Sheets(DataInput).Active\n            NextRow.PasteSpecial Paste:=xlValues, Transpose:=False\n            Application.CutCopyMode = False\n            Set NextRow = Nothing\n        z.Sheets(\"Data\").Range(\"I3:K7\").Copy\n            Alpha.Sheets(DataInput).Active\n            NextRow.PasteSpecial Paste:=xlValues, Transpose:=False\n            Application.CutCopyMode = False\n            Set NextRow = Nothing\n\n        w.Close False\n        x.Close False\n        y.Close False\n        z.Close False\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "replace", "outlook", "find"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5029069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee914597373a2482f3059706ad13887?s=128&d=identicon&r=PG&f=1", "display_name": "AOtter", "link": "https://stackoverflow.com/users/5029069/aotter"}, "edited": false, "score": 0, "creation_date": 1438882418, "post_id": 31843413, "comment_id": 51643744, "body": "I get either a duplicate declaration error (If I include the input box) or a object required error if I don&#39;t..."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 1, "user_id": 5029069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee914597373a2482f3059706ad13887?s=128&d=identicon&r=PG&f=1", "display_name": "AOtter", "link": "https://stackoverflow.com/users/5029069/aotter"}, "edited": false, "score": 0, "creation_date": 1438883131, "post_id": 31843413, "comment_id": 51644086, "body": "Have you got Option Explicit at the top of your module? If not  add it.  Where else is last_week  declared?"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1438811236, "creation_date": 1438811236, "answer_id": 31843413, "question_id": 31841945, "link": "https://stackoverflow.com/questions/31841945/outlook-replacing-text-in-link/31843413#31843413", "title": "Outlook Replacing Text In {LINK} -", "body": "<p>Add </p>\n\n<pre><code> Dim last_week as string \n</code></pre>\n\n<p>Have you broken it down?</p>\n\n<p>try</p>\n\n<pre><code>body = myMessage.body\ndebug.print body\ndebug.print  Replace(body,\"07.27-08.02\",\"TRYTHIS\")\nbody = Replace(body,\"07.27-08.02\",\"TRYTHIS\")\ndebug.print body\n</code></pre>\n\n<p>as you would expect this works:</p>\n\n<pre><code>Sub Macro1()\n\n    Dim body As String\n\n    body = \"{LINK Excel.Sheet.12 \"\"\\\\tlnfile\\users\\AOtter\\Metric Mondays\\Results\\2015.xlsx\"\" 07.27-08.02!R4C9:R8C13 \\a \\f 4 \\h}\"\n    Debug.Print Replace(body, \"07.27-08.02\", \"fred\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5029069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee914597373a2482f3059706ad13887?s=128&d=identicon&r=PG&f=1", "display_name": "AOtter", "link": "https://stackoverflow.com/users/5029069/aotter"}, "is_accepted": false, "score": 0, "last_activity_date": 1438968853, "creation_date": 1438968853, "answer_id": 31883571, "question_id": 31841945, "link": "https://stackoverflow.com/questions/31841945/outlook-replacing-text-in-link/31883571#31883571", "title": "Outlook Replacing Text In {LINK} -", "body": "<p>Nevermind, y'all.</p>\n\n<pre><code>ELTMail.HTMLBody = Replace(ELTMail.HTMLBody, \"07.27-08.02\", last_week)\n</code></pre>\n\n<p>How silly of me. Of course that would be it. Sorry for the the trouble!!\nAO</p>\n"}], "owner": {"reputation": 1, "user_id": 5029069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ee914597373a2482f3059706ad13887?s=128&d=identicon&r=PG&f=1", "display_name": "AOtter", "link": "https://stackoverflow.com/users/5029069/aotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 615, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593306160, "creation_date": 1438805442, "last_edit_date": 1593306160, "question_id": 31841945, "link": "https://stackoverflow.com/questions/31841945/outlook-replacing-text-in-link", "title": "Outlook Replacing Text In {LINK} -", "body": "<p>I'm trying to find and replace part of a LINK text in the body of an outlook template.</p>\n\n<pre><code>Sub CreateFromTemplate()\n\nlast_week = InputBox(\"Enter date for last week (mm.dd-mm.dd)\")\nDim body As String\n\n' ELT\n\n  Dim ELTMail As Outlook.MailItem\n\nSet ELTMail = Application.CreateItemFromTemplate(\"F:\\AOtter\\Outlook Templates\\Metric Weeklies\\ELT.oft\")\n\nbody = myMessage.body\nbody = Replace(body,\"07.27-08.02\",last_week)\n\nELTMail.Display\nEnd Sub\n</code></pre>\n\n<p>Example link from Outlook email:</p>\n\n<p>{LINK Excel.Sheet.12 \"\\\\tlnfile\\users\\AOtter\\Metric Mondays\\Results\\2015.xlsx\" <strong>07.27-08.02</strong>!R4C9:R8C13 \\a \\f 4 \\h}</p>\n\n<p>Can anyone tell me what I'm missing? Am I unable to access the inside of the link with a find and replace/are my operations wrong to access that?</p>\n"}, {"tags": ["vba", "ms-office", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1438809360, "creation_date": 1438809360, "answer_id": 31842974, "question_id": 31841598, "link": "https://stackoverflow.com/questions/31841598/selecting-a-task-in-ms-project-with-vba/31842974#31842974", "title": "Selecting a task in MS Project with VBA", "body": "<p>Use this:</p>\n\n<pre><code>Application.Find Field:=\"UniqueID\", Test:=\"equals\", Value:=TaskUID\n</code></pre>\n\n<p>Note: Change <code>TaskUID</code> to the name of your variable containing the UID (Long):</p>\n"}], "owner": {"reputation": 153, "user_id": 4504918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6fcbe6855dc7a523bbb1b4e2c14d7cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4504918/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4937, "favorite_count": 0, "accepted_answer_id": 31842974, "answer_count": 1, "score": 1, "last_activity_date": 1593558802, "creation_date": 1438804266, "last_edit_date": 1593558802, "question_id": 31841598, "link": "https://stackoverflow.com/questions/31841598/selecting-a-task-in-ms-project-with-vba", "title": "Selecting a task in MS Project with VBA", "body": "<p>what is the syntax for selecting a task in Microsoft Project through VBA? For example, I want to be able to make any task the active task given its UID. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "passwords", "password-protection"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1438804459, "post_id": 31841572, "comment_id": 51604800, "body": "In the workbook_open event, you can have an inputbox for password but might be more effective to do an if statement for application.user?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1438804949, "post_id": 31841572, "comment_id": 51605052, "body": "I mean, this is possible, but it would be pretty easy for a user to simply disable macros, and then turn all sheets to xlSheetVisible from a different workbook, or copy the contents into a different workbook.  The point is, Excel is not, and was never designed to be, a secure program"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1438805016, "post_id": 31841572, "comment_id": 51605099, "body": "There is no simple way. You are looking at a pretty big chunk of code. This is far too large for a simple question. The first things you need to learn are: 1) How to ask for passwords (using inputboxes, for example), 2) How to protect/unprotect single cells and ranges using VBA. 3) How to create your custom protection macros (it involves, for my own, writing in a hidden sheet the specs of protection. Ex The protection level currently being used (1, 2, 3 for example). This might be referred to in your code/events, for example, and the Wb_Change refers to it to verify the user CAN modify."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1438805973, "post_id": 31841572, "comment_id": 51605589, "body": "As mentioned in the comments, there&#39;s not a very secure way to do this.  You could, on workbook open, prompt for a password, then have some statement that says &quot;If password is X, set these cells as protected.  If password is Y, set other cells as protected. If password is Z, set other cells as protected.  If not &#39;X, Y, or Z, close workbook&quot;.  The issue with that is that it&#39;s not very secure.  Anyone with even a little VB knowledge could likely get by this...so doing something like this might lull you into a false sense of security."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438805975, "post_id": 31841572, "comment_id": 51605591, "body": "Perhaps you could make three workbooks, and give each person their respective workbook and have them on some drive that all can access.  Then you can create a file that combines all their info?"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438806090, "post_id": 31841572, "comment_id": 51605652, "body": "@BruceWayne your first comment is basically what I want, it doesn&#39;t have to be overly secure so I think that&#39;d be fine"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1438807424, "post_id": 31841572, "comment_id": 51606414, "body": "This is why you use username as I pointed out. Eliminates the password insecurity. Much harder to login as someone else."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1438807896, "post_id": 31841572, "comment_id": 51606699, "body": "@findwindow Ideally both would be used, can you please show me how I could have a message box that appears and asks for user name and password?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1438808161, "post_id": 31841572, "comment_id": 51606850, "body": "I agree with @findwindow - using the windows User name would definitely be more secure than just a VB prompt."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1438808238, "post_id": 31841572, "comment_id": 51606888, "body": "@BenSmith you don&#39;t prompt for username. Just test for it. if application.username =&quot;Smith, Ben&quot; then..."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1438808560, "post_id": 31841572, "comment_id": 51607053, "body": "But the problem with that is there&#39;s going to be a lot of people accessing this file, so what I want to have three different usernames, e.g. &quot;full&quot;, &quot;partial&quot;, &quot;view&quot;, and a password for each of these usernames"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1438809491, "post_id": 31841572, "comment_id": 51607512, "body": "So do a case statement for the three cases and an else. You&#39;re just mentioning the else now... Also, I am not holding your hand because 1) I have my own work to do and 2) at SO you should make an effort before asking for help please."}], "answers": [{"comments": [{"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "edited": false, "score": 0, "creation_date": 1438806896, "post_id": 31842256, "comment_id": 51606084, "body": "Of course you can add more complex rules, like I can only type text, you can also insert lines and change formatting, but then it becomes too dependent on your situation for me to guess"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1438807346, "post_id": 31842256, "comment_id": 51606369, "body": "Ok, I&#39;ve got the code in a module, am I meant to be running the code before I shut the file? When I open the file I don&#39;t get asked for a password?"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1438809497, "post_id": 31842256, "comment_id": 51607519, "body": "@Ben without meaning to be rude.  If you read the code that Dirk wrote and expected to be prompted for a password, then to be frank this task is probably beyond you at the moment.  The above code gives you the clever bit that you will need to incorporate into other code.  The comments from others are all good advise."}, {"owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "reply_to_user": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1438810506, "post_id": 31842256, "comment_id": 51607982, "body": "@BenSmith, This code does not belong in <i>a</i> module it belongs in <i>the</i> main <i>ThisWorkbook</i> module. See edit"}], "tags": [], "owner": {"reputation": 3132, "user_id": 4385647, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/V3X9c.png?s=128&g=1", "display_name": "Dirk Horsten", "link": "https://stackoverflow.com/users/4385647/dirk-horsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1438810936, "last_edit_date": 1438810936, "creation_date": 1438806667, "answer_id": 31842256, "question_id": 31841572, "link": "https://stackoverflow.com/questions/31841572/excel-how-can-i-give-different-people-various-levels-of-protection-and-access/31842256#31842256", "title": "Excel: How can I give different people various levels of protection and access", "body": "<p><strong>First assign named ranges to the areas you want to protect</strong>, using a suffix indicating what to do with them. You can do that by  selecting the range and typing a name that is not a valid Cell address left of the formula bar.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cTw6G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cTw6G.png\" alt=\"enter image description here\"></a></p>\n\n<p>I created ranges named Someting_4U, which You and I can edit and Something_4Me, which only I can edit</p>\n\n<p><strong>Now copy the below code</strong> in the main <strong>ThisWorkbook</strong> module</p>\n\n<p><a href=\"https://i.stack.imgur.com/n7qSi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n7qSi.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim Sht As Worksheet, Nm As Name\n</code></pre>\n\n<p>' Unprotect your workbook and sheets</p>\n\n<pre><code>    ThisWorkbook.Unprotect \"onlyVbaPassWord\"\n    For Each Sht In ThisWorkbook.Sheets\n        Sht.Unprotect \"onlyVbaPassWord\"\n    Next Sht\n</code></pre>\n\n<p>' Unprotect the appropriate named ranges and protect the others</p>\n\n<pre><code>    For Each Nm In ThisWorkbook.Names\n\n        ' The next `Select Case` statement implements your business logic\n        Select Case Application.UserName\n            Case \"Me\", \"Myself\", \"I\"\n                Nm.RefersToRange.Locked = False\n            Case \"You\", \"Yourself\", \"Thou\"\n                If Nm.Name Like \"*_4U\" Then\n                    Nm.RefersToRange.Locked = False\n                Else\n                    Nm.RefersToRange.Locked = True\n                End If\n            Case Else\n                Nm.RefersToRange.Locked = True\n        End Select\n    Next Nm\n</code></pre>\n\n<p>' Protect your sheets and workbook again</p>\n\n<pre><code>    For Each Sht In ThisWorkbook.Sheets\n        Sht.Protect \"onlyVbaPassWord\"\n    Next Sht\n    ThisWorkbook.Protect \"onlyVbaPassWord\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1835, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1438810936, "creation_date": 1438804155, "question_id": 31841572, "link": "https://stackoverflow.com/questions/31841572/excel-how-can-i-give-different-people-various-levels-of-protection-and-access", "title": "Excel: How can I give different people various levels of protection and access", "body": "<p>I have an excel spreadsheet that 3 different types of people can access, I want these 3 types of people to have different access rights. I want there to be people with full access, so can change the workbook, change the cells, change the contents and formats of the cells, etc. there are people with some access, so can only change some cells and can go on any of the sheets that are visible when the spreadsheet is access, and I want there to be people with limited access so can only go on certain sheets, change cells that are necessary to retrieve the data that is associated to that value, and cannot save the file.</p>\n\n<p>Is there a way of doing this?</p>\n\n<p>What I would really like is for when the file opens to ask the user for a password, and, dependent on what the password is, different cells are locked and different levels of access is applied.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 943, "user_id": 2200576, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ac18c184ddcd606f580ae7d0fbfbb802?s=128&d=identicon&r=PG", "display_name": "spongessuck", "link": "https://stackoverflow.com/users/2200576/spongessuck"}, "edited": false, "score": 1, "creation_date": 1438803594, "post_id": 31841357, "comment_id": 51604272, "body": "Try ~/Users/... or /Volumes/Macintosh HD/..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1438804074, "post_id": 31841357, "comment_id": 51604571, "body": "The path <code>&quot;Macintosh HD:Users:dongougkim:ShareSync:Dan&#39;s stuff:Current Services:logo.png&quot;</code> is correct but I am not familiar with <code>Open()</code> syntax in MAC to open image files.. I know <code>Open &quot;testfile.txt&quot; For Output As 1</code> works in MAC?"}, {"owner": {"reputation": 278, "user_id": 1808262, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cjrx5.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1808262/dan"}, "edited": false, "score": 0, "creation_date": 1438804813, "post_id": 31841357, "comment_id": 51604979, "body": "Spongessuck &amp; Siddharth, I tried both of your syntax, and it didn&#39;t work.  Edit: Yes, maybe Open doesn&#39;t work with image file... What else should I try?"}], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 278, "user_id": 1808262, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cjrx5.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1808262/dan"}, "edited": false, "score": 0, "creation_date": 1438973606, "post_id": 31868413, "comment_id": 51687087, "body": "What are you trying to do with the image file once you have it open? It is important to know as you may require a different statement altogether and the Open syntax is incomplete. If you can give me more information I can revise my answer."}, {"owner": {"reputation": 278, "user_id": 1808262, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cjrx5.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1808262/dan"}, "edited": false, "score": 0, "creation_date": 1439166213, "post_id": 31868413, "comment_id": 51734068, "body": "Simply see (and check) the image. New to VBA (on mac btw), so not sure about a better way to debug."}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 278, "user_id": 1808262, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cjrx5.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1808262/dan"}, "edited": false, "score": 0, "creation_date": 1439166350, "post_id": 31868413, "comment_id": 51734092, "body": "There are several ways to &quot;open&quot; a file, each with different features and outcomes.  You have to be more specific. Are you simply checking if the file exists or are you trying to read the contents of the image?"}, {"owner": {"reputation": 278, "user_id": 1808262, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cjrx5.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1808262/dan"}, "edited": false, "score": 0, "creation_date": 1439255136, "post_id": 31868413, "comment_id": 51774793, "body": "I&#39;m trying to see the picture itself in a little window. Make sure I got the right image and all."}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 278, "user_id": 1808262, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cjrx5.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1808262/dan"}, "edited": false, "score": 0, "creation_date": 1439255443, "post_id": 31868413, "comment_id": 51774861, "body": "Then you should be using an <code>Image</code> control and assign the file path to the <code>Picture</code> property.  This will display the image.  The method you are using to open the file is used for read/writing manually."}], "tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": false, "score": 0, "last_activity_date": 1438911566, "creation_date": 1438911566, "answer_id": 31868413, "question_id": 31841357, "link": "https://stackoverflow.com/questions/31841357/opening-a-image-file/31868413#31868413", "title": "Opening a image file", "body": "<p>You need to prefix <code>Users</code> with a slash, otherwise the path is relative.</p>\n\n<p>Try this:-</p>\n\n<pre><code>Sub OpenFile()\n    Open (/Users/dongougkim/ShareSync/Dan's stuff/Current Services/logo.png)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 278, "user_id": 1808262, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/cjrx5.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1808262/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 899, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593729354, "creation_date": 1438803369, "last_edit_date": 1593729354, "question_id": 31841357, "link": "https://stackoverflow.com/questions/31841357/opening-a-image-file", "title": "Opening a image file", "body": "<p>I am having trouble figuring out the VBA syntax to open a file for MAC OS</p>\n\n<p>Here is my code</p>\n\n<pre><code>Sub OpenFile()\n    Open (Users/dongougkim/ShareSync/Dan's stuff/Current Services/logo.png)\nEnd Sub\n</code></pre>\n\n<p>I have also tried</p>\n\n<pre><code>Open (\"Users/dongougkim/ShareSync/Dan's stuff/Current Services/logo.png\")\nOpen (\"Macintosh HD/Users/dongougkim/ShareSync/Dan's stuff/Current Services/logo.png\")\nOpen (\"Macintosh HD:Users:dongougkim:ShareSync:Dan's stuff:Current Services:logo.png\")\n</code></pre>\n\n<p>Please help. Driving me crazay</p>\n"}, {"tags": ["vba", "copy", "runtime-error"], "comments": [{"owner": {"reputation": 134, "user_id": 3286402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e02bb2c3902a05ceaefb099523f564?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan.s", "link": "https://stackoverflow.com/users/3286402/ivan-s"}, "edited": false, "score": 1, "creation_date": 1438805664, "post_id": 31841307, "comment_id": 51605429, "body": "C2:C it is correct range?"}], "answers": [{"comments": [{"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "reply_to_user": {"reputation": 51, "user_id": 4950069, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hBIvZQNkVZY/AAAAAAAAAAI/AAAAAAAAANM/i3kW1Iwjijk/photo.jpg?sz=128", "display_name": "Bessie Lee", "link": "https://stackoverflow.com/users/4950069/bessie-lee"}, "edited": false, "score": 0, "creation_date": 1438805992, "post_id": 31841373, "comment_id": 51605595, "body": "After reading the comment from Ivan.s, I realized that there is no ending row reference in the range you are copying."}], "tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": false, "score": 0, "last_activity_date": 1438803412, "creation_date": 1438803412, "answer_id": 31841373, "question_id": 31841307, "link": "https://stackoverflow.com/questions/31841307/copy-values-from-columns-to-another-worksheet/31841373#31841373", "title": "copy values from columns to another worksheet", "body": "<p>Make sure you have tabs named \"Detail\" and \"Sheet1\", then try this: </p>\n\n<pre><code>Sub copy()\nWorksheets(\"Detail\").Range(\"C2:C\").copy Destination:=Worksheets(\"Sheet1\").Range(\"C2\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4950069, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hBIvZQNkVZY/AAAAAAAAAAI/AAAAAAAAANM/i3kW1Iwjijk/photo.jpg?sz=128", "display_name": "Bessie Lee", "link": "https://stackoverflow.com/users/4950069/bessie-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438804608, "creation_date": 1438803189, "last_edit_date": 1438804608, "question_id": 31841307, "link": "https://stackoverflow.com/questions/31841307/copy-values-from-columns-to-another-worksheet", "title": "copy values from columns to another worksheet", "body": "<p>I'm trying to write a macro that copies the content of column c from Detail to C on sheet 1. </p>\n\n<pre><code>Sub copy()\nWorksheets(\"Detail\").Range(\"C2:C\").copy Destination:=Worksheets   (\"Sheet1\").Range(\"C2:C\")\nEnd Sub\n</code></pre>\n\n<p>I got run time error 1004, application defined or object defined error</p>\n\n<p>I have also tried this</p>\n\n<pre><code>Sub OneCell()\n    Sheets(\"Detail\").Select\n    Range(\"C2:C\").copy\n    Sheets(\"Sheet1\").Select\n    Range(\"c2:c\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>its the same problem and error line is <code>Range(\"C2:C\").copy</code> </p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438803676, "post_id": 31841267, "comment_id": 51604329, "body": "You can do this with VBA. Research these VBA topics: Cell References, If, and Loops. It&#39;s also possible with cell formulas. I think the VBA approach is cleaner and definitely easier to re-run in the future (it sounds like you need to do this on a regular basis)."}, {"owner": {"reputation": 2549, "user_id": 1615031, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j8zg4.jpg?s=128&g=1", "display_name": "pedram", "link": "https://stackoverflow.com/users/1615031/pedram"}, "edited": false, "score": 0, "creation_date": 1438803686, "post_id": 31841267, "comment_id": 51604335, "body": "It&#39;s definitely possible with VBA. Start with the cells in range A1:AXXX. Copy the first value that is a number. Fill in the subsequent cells until a number is found. Two loops shoud be able to accomplish it."}, {"owner": {"reputation": 345, "user_id": 5134203, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1d59f6c36f3affb882ec87ec07153a47?s=128&d=identicon&r=PG&f=1", "display_name": "schnydszch", "link": "https://stackoverflow.com/users/5134203/schnydszch"}, "edited": false, "score": 0, "creation_date": 1438836466, "post_id": 31841267, "comment_id": 51614975, "body": "Hi! Yeah a number with blank values to the right starts all the sequences"}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 5134203, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1d59f6c36f3affb882ec87ec07153a47?s=128&d=identicon&r=PG&f=1", "display_name": "schnydszch", "link": "https://stackoverflow.com/users/5134203/schnydszch"}, "edited": false, "score": 0, "creation_date": 1438806824, "post_id": 31841779, "comment_id": 51606050, "body": "Hi! I tried the script but I got the following: &quot;Application defined or object-defined error.&quot; Trying to debug it but I only know how to put the macro. TIA!"}, {"owner": {"reputation": 56, "user_id": 3608384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b9b998a05839aa44359288c37be2a9?s=128&d=identicon&r=PG&f=1", "display_name": "user3608384", "link": "https://stackoverflow.com/users/3608384/user3608384"}, "reply_to_user": {"reputation": 345, "user_id": 5134203, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1d59f6c36f3affb882ec87ec07153a47?s=128&d=identicon&r=PG&f=1", "display_name": "schnydszch", "link": "https://stackoverflow.com/users/5134203/schnydszch"}, "edited": false, "score": 0, "creation_date": 1438904391, "post_id": 31841779, "comment_id": 51654094, "body": "Give me your data/a subset of your data in whatever format you have, and I may be able to help."}, {"owner": {"reputation": 345, "user_id": 5134203, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1d59f6c36f3affb882ec87ec07153a47?s=128&d=identicon&r=PG&f=1", "display_name": "schnydszch", "link": "https://stackoverflow.com/users/5134203/schnydszch"}, "edited": false, "score": 0, "creation_date": 1438932423, "post_id": 31841779, "comment_id": 51661961, "body": "Hi! here is the file: <a href=\"http://128.199.159.143/serials_forregex_20150805_1052_fin_.xlsx\" rel=\"nofollow noreferrer\">128.199.159.143/serials_forregex_20150805_1052_fin_.xlsx</a>"}, {"owner": {"reputation": 56, "user_id": 3608384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b9b998a05839aa44359288c37be2a9?s=128&d=identicon&r=PG&f=1", "display_name": "user3608384", "link": "https://stackoverflow.com/users/3608384/user3608384"}, "reply_to_user": {"reputation": 345, "user_id": 5134203, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1d59f6c36f3affb882ec87ec07153a47?s=128&d=identicon&r=PG&f=1", "display_name": "schnydszch", "link": "https://stackoverflow.com/users/5134203/schnydszch"}, "edited": false, "score": 0, "creation_date": 1438970563, "post_id": 31841779, "comment_id": 51685573, "body": "schnydszch: You can fix this by starting the loop from row number 2 (replace &quot;for i = 1&quot; with &quot;for i =2&quot;). The problem is there is no row number 0, so when you the loop start with row number 1, it will look at low number 0 for reference, which doesn&#39;t exist."}, {"owner": {"reputation": 345, "user_id": 5134203, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1d59f6c36f3affb882ec87ec07153a47?s=128&d=identicon&r=PG&f=1", "display_name": "schnydszch", "link": "https://stackoverflow.com/users/5134203/schnydszch"}, "edited": false, "score": 0, "creation_date": 1440753957, "post_id": 31841779, "comment_id": 52414078, "body": "Thanks a lot on this. Already finished with the project. But this code be helpful in the future. Cheers! :)"}], "tags": [], "owner": {"reputation": 56, "user_id": 3608384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5b9b998a05839aa44359288c37be2a9?s=128&d=identicon&r=PG&f=1", "display_name": "user3608384", "link": "https://stackoverflow.com/users/3608384/user3608384"}, "is_accepted": true, "score": 3, "last_activity_date": 1438805155, "last_edit_date": 1438805155, "creation_date": 1438804831, "answer_id": 31841779, "question_id": 31841267, "link": "https://stackoverflow.com/questions/31841267/excel-vba-or-regex-to-copy-values-downwards-based-on-repeated-values/31841779#31841779", "title": "excel, vba or regex to copy values downwards based on repeated values", "body": "<p>I assume this data is from an Excel spreadsheet, with both the numerical values and the value \"STARTHERE\" are on the first column (column A). The other data are on column B, C, etc.</p>\n\n<p>Basically, I will loop through the first column from the top to the bottom row. If the value within the selector cell is not a number, it will be equal to the one right above it. If it is, then we skip to the next cell.</p>\n\n<pre><code>  Sub help()\n        ActiveSheet.Columns(1).NumberFormat = \"0\"\n        For i = 1 To ActiveSheet.UsedRange.Rows.count\n            If Not Information.IsNumeric(Cells(i, 1)) Then Cells(i, 1).value = Cells(i - 1, 1).value\n        Next i\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 5134203, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1d59f6c36f3affb882ec87ec07153a47?s=128&d=identicon&r=PG&f=1", "display_name": "schnydszch", "link": "https://stackoverflow.com/users/5134203/schnydszch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 31841779, "answer_count": 1, "score": -1, "last_activity_date": 1438805155, "creation_date": 1438803067, "question_id": 31841267, "link": "https://stackoverflow.com/questions/31841267/excel-vba-or-regex-to-copy-values-downwards-based-on-repeated-values", "title": "excel, vba or regex to copy values downwards based on repeated values", "body": "<p>I have the following records:</p>\n\n<pre><code>62      \nSTARTHERE   1.1 vol. 84 no. 1 1996  01.1 A 0 1 1996 04 24 0\nSTARTHERE   1.2 vol. 84 no. 2 1996  01.2 A 0 1 1996 05 23 0\nSTARTHERE   1.3 vol. 84 no. 3 1996  01.3 A 1 1 1996 08 13 0\nSTARTHERE   1.4 vol. 84 no. 4 1996  01.4 A 0 1 1996 10 15 0\nSTARTHERE   1.5 vol. 84 no. 5 1996  01.5 A 0 1 1997 01 22 0\nSTARTHERE   1.6 vol. 84 no. 6 1996  01.6 A 0 1 1997 02 10 0\n63      \nSTARTHERE   1.1 95:1 Feb 2002   1.1 A 0 1 2002 06 03 0\nSTARTHERE   1.2 95:2 Apr 2002   1.2 A 0 1 2002 06 17 0\nSTARTHERE   1.3 95:3 Jun 2002   1.3 A 0 1 2002 07 18 0\nSTARTHERE   1.4 95:4 Aug 2002   1.4 A 0 1 2003 02 24 0\nSTARTHERE   1.5 95:5 Oct 2002   1.5 A 0 1 2003 02 24 0\n64\n65\nSTARTHERE   1.1 34:1 Mar 1996   1.1 A 0 1 1996 07 16 0\nSTARTHERE   1.2 34:2 Jun 1996   1.2 A 0 1 1996 09 19 0\nSTARTHERE   1.3 34:3 Sep 1996   1.3 A 0 1 1996 12 17 0\n</code></pre>\n\n<p>I don't know if this is possible in excel, vba in excel or even through regex. I want to fill the lowest numerical value (e.g. 62) and replace the lower rows with values \"STARTHERE\" up until the next numerical value (63). Right now, it's done manually but I was thinking if there is a way of doing this mechanically. Through excel formula, VBA, or regex, as these are what I'm familiar with. So that I can get below, it's okay also that the 62 with blank value to the right are stripped but I'm fine even if it's not:</p>\n\n<pre><code>62  \n62  1.1 vol. 84 no. 1 1996  01.1 A 0 1 1996 04 24 0\n62  1.2 vol. 84 no. 2 1996  01.2 A 0 1 1996 05 23 0\n62  1.3 vol. 84 no. 3 1996  01.3 A 1 1 1996 08 13 0\n62  1.4 vol. 84 no. 4 1996  01.4 A 0 1 1996 10 15 0\n62  1.5 vol. 84 no. 5 1996  01.5 A 0 1 1997 01 22 0\n62  1.6 vol. 84 no. 6 1996  01.6 A 0 1 1997 02 10 0\n62\n62  1.1 95:1 Feb 2002   1.1 A 0 1 2002 06 03 0\n63  1.2 95:2 Apr 2002   1.2 A 0 1 2002 06 17 0\n63  1.3 95:3 Jun 2002   1.3 A 0 1 2002 07 18 0\n63  1.4 95:4 Aug 2002   1.4 A 0 1 2003 02 24 0\n63  1.5 95:5 Oct 2002   1.5 A 0 1 2003 02 24 0\n64\n65\n65  1.1 34:1 Mar 1996   1.1 A 0 1 1996 07 16 0\n65  1.2 34:2 Jun 1996   1.2 A 0 1 1996 09 19 0\n65  1.3 34:3 Sep 1996   1.3 A 0 1 1996 12 17 0\n</code></pre>\n\n<p>Many thanks!</p>\n"}, {"tags": ["excel", "vba", "textbox", "scrollbar"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438803864, "post_id": 31841143, "comment_id": 51604438, "body": "You could just have one textbox on the sheet and move it around in response to the selected row changing."}, {"owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438804362, "post_id": 31841143, "comment_id": 51604755, "body": "hmmm, So if a user presses on the row for example the text box will follow? Only issue is that say the users want to see more than one issue I will need multiple boxes. How would I implement the one textbox idea? Does my spreadsheet make the issue I am having anymore understandable? Its hard to explain."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438807627, "post_id": 31841143, "comment_id": 51606547, "body": "I tried to look at your file but it consistently crashes my Excel...  As to how you&#39;d move the textbox, you can use the selection_change event."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 0, "creation_date": 1438807330, "post_id": 31842281, "comment_id": 51606357, "body": "Hi Harvey, Thanks for the response and looking at my really messy spreadsheet. How would I do it so I can select the row and it appears in a big tall row? (sounds like a really good idea that but unsure how to implement it). Also would I implement the single text box in the big row above so its just 1 text box? How does that code know which row I have select to implent into the text box? Sorry for all the questions"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 0, "creation_date": 1438807690, "post_id": 31842281, "comment_id": 51606582, "body": "The code I added changes the formula of the textbox you are using to display values that sits over the query column of the tall row.  You could have multiple textboxes, one for each column OR you could use formulas in the cells of the tall row and write similar code to change the formula in the big row&#39;s cells.  It&#39;s worth noting that users will not be able to edit"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 0, "creation_date": 1438808071, "post_id": 31842281, "comment_id": 51606812, "body": "@user  Sorry I had a better idea.  See latest code in answer"}, {"owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 0, "creation_date": 1438808424, "post_id": 31842281, "comment_id": 51606994, "body": "Kinda confused here. So how does this work? I make a tall row in column 2 that bring in the information from below? Only issue is The query column gets a lot of data so unsure it will all be viewable."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 0, "creation_date": 1438808821, "post_id": 31842281, "comment_id": 51607182, "body": "Yes you make a tall &quot;summary&quot; row in ROW 2.  You can put a text box over the query column if you want to have scroll bars."}, {"owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 0, "creation_date": 1438809908, "post_id": 31842281, "comment_id": 51607716, "body": "Excellent. This is kick ass man. Say when a user fills in the reply and their Case Owner in the Summery row can I make that auto update in the rows below? If so how?"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 1, "last_activity_date": 1438810449, "last_edit_date": 1438810449, "creation_date": 1438806773, "answer_id": 31842281, "question_id": 31841143, "link": "https://stackoverflow.com/questions/31841143/is-there-a-fast-way-to-add-multiple-text-boxes-with-scrollbars/31842281#31842281", "title": "Is There A Fast Way To Add Multiple Text boxes With Scrollbars?", "body": "<p>A few things:</p>\n\n<ol>\n<li><p>You should change the cell formatting to \"Top Align\" the text in the cells.  This will cause the cell to show the first line of the long text in the Query cells.</p></li>\n<li><p>Instead of using the \"send email\" text in a cell why not add a single button to email the currently selected row.  (use insert on the ribbon in the developer tab (you have to change the excel options to show the developer tab).</p></li>\n<li><p>The code to send an email might be better if it updated a new column with the date it was sent, and in the event that it has already been sent, it could prompt the user to confirm.</p>\n\n<p>if not isempty(cells(r, ColNumberWithSentdate) ) then \n    if vbno = msgbox (\"Are you sure you want to send the email again?\", VbYesno) then<br>\n        Exit sub\n    end if\nend if</p></li>\n<li><p>All the textboxes you have added are really slowing down the spreadsheet.\nwhy not just have one tall row at the top above the table with the filters.  The tall row would show the data from the currently selected row in the table.  Your table rows could then probably be less high.</p></li>\n<li><p>Add a single text box.\nUse ALT+click and drag to resize text boxes to fit cell exactly.\nChange or view the name of the textbox in the named range area to \"TextBoxQuery\".</p></li>\n<li><p>Add code to change the text in the summary row</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    ' Say the tall row is in row 2\n    If Target.Row &lt;= 2 Then\n        Exit Sub\n    End If\n\n    Dim i As Integer\n    For i = 1 To 8\n        Cells(2, i) = Cells(Target.Row, i)\n    Next i\n\n\nEnd Sub\n</code></pre></li>\n<li><p>You could even allow the user to edit the text in the tall row and add a button to save the changes they entered:</p></li>\n</ol>\n\n<p>A. Add  an ACTIVEX button in the summary row labelled \"SAVE\"\n   (Then you can edit the vba in the sheets module for the button) </p>\n\n<p>B. Add a cell somewhere that records which row is being displayed in the summary row.</p>\n\n<p>C. When the save button is clicked, write code that copies all the values in row to back to the row recorded.</p>\n\n<p>NOTE that if the user deletes a row in the table or sorts the data in the table the row stored will be wrong. So before copying the data, you might like to check to see whether the row has moved. ie check a KEY value (ie ones that never changes) is the saem in both rows.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\n    Dim i As Integer\n    For i = 1 To 8\n        Cells(Cells(1, 1).Value, i) = Cells(2, i)\n    Next i\n\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    ' Say the tall row is in row 2\n    If Target.Row &lt;= 2 Then\n        Exit Sub\n    End If\n\n    ' Cell A1 is used to store which row is displayed\n    Cells(1, 1) = Target.Row\n\n    Dim i As Integer\n    For i = 1 To 8\n        Cells(2, i) = Cells(Target.Row, i)\n    Next i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1614, "favorite_count": 0, "accepted_answer_id": 31842281, "answer_count": 1, "score": 0, "last_activity_date": 1442056376, "creation_date": 1438802703, "last_edit_date": 1442056376, "question_id": 31841143, "link": "https://stackoverflow.com/questions/31841143/is-there-a-fast-way-to-add-multiple-text-boxes-with-scrollbars", "title": "Is There A Fast Way To Add Multiple Text boxes With Scrollbars?", "body": "<p>Because the cells in my project contain so much data I have had to insert textboxes that have scrollbars to see all the data (they are linked to the cell which sit behind them on the spreadsheet). Is there any fast way to do the same thing on a column of 1000 records or will I have to go through manually and link the textbox to the specific cell? Is there a faster way?</p>\n\n<p>Also If an issue comes in that is a reply to the original issue I need it to use the original ID (I have used auto IDS, which can be seen in the spreadsheet). Any recommendations?</p>\n\n<p>Slowly I am getting better at excel and VBA but I need a hand sometimes ^_^</p>\n\n<p>I have attached the spreadsheet which contains an example of 2 records I made. The final sheet will have 1000 records. (Please download the spreadsheet and open in excel)</p>\n\n<p><a href=\"https://drive.google.com/open?id=0B8OtUevU1V5sVkdndDd2UldxMHM\" rel=\"nofollow\">LINK To Spreadsheet</a></p>\n"}, {"tags": ["ms-access", "error-handling", "vba"], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "is_accepted": true, "score": 0, "last_activity_date": 1438814775, "creation_date": 1438814775, "answer_id": 31844063, "question_id": 31841128, "link": "https://stackoverflow.com/questions/31841128/how-do-i-prevent-this-error-message/31844063#31844063", "title": "How do I prevent this Error Message", "body": "<p>This is a windows feature. Microsoft have KB on removing it here.\n<a href=\"https://support.microsoft.com/en-us/kb/925757\" rel=\"nofollow\" title=\"here\">https://support.microsoft.com/en-us/kb/925757</a></p>\n\n<p>It is possible to use VBA to change the registry settings, but follow the KB instructions first to ensure it solves your issue.</p>\n"}], "owner": {"reputation": 21, "user_id": 2939610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/557beef3f6009ce50e6d59dfeeddfd9c?s=128&d=identicon&r=PG&f=1", "display_name": "adam", "link": "https://stackoverflow.com/users/2939610/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 31844063, "answer_count": 1, "score": 0, "last_activity_date": 1594655920, "creation_date": 1438802653, "last_edit_date": 1594655920, "question_id": 31841128, "link": "https://stackoverflow.com/questions/31841128/how-do-i-prevent-this-error-message", "title": "How do I prevent this Error Message", "body": "<p>I have created a VBA access application to find a PDF file in a folder by doing one sweep to get all the sub-folders in the root folder. Then another sweep to collect and compare all the file names to the one that is selected. We are then using the following code to open the file when it is found:</p>\n\n<pre><code>Private Sub Command132_Click()\nOn Error GoTo Err_Command132_Click\n\nDim rootFolder  As String\nDim subFolder   As String\nDim fileSpec    As String\nDim filename    As String\nDim foundfile   As String\nDim filepath    As String\nDim subfolders() As String\nDim co As String\nDim intSubFolderCount As Integer\n\nrootFolder = \"T:\\Scanned Work Orders (Archives)\\\"\nsubFolder = Dir(rootFolder &amp; \"*.*\", vbDirectory)\n\n'*** Get subfolders in array ***\nWhile subFolder &lt;&gt; \"\"\n    If subFolder &lt;&gt; \".\" And subFolder &lt;&gt; \"..\" Then\n        ReDim Preserve subfolders(intSubFolderCount)\n        subfolders(intSubFolderCount) = subFolder\n        intSubFolderCount = intSubFolderCount + 1\n\n        Debug.Print subFolder\n    End If\n    subFolder = Dir()\nWend\n\n'*** Loop over array and find files ***\n    For intSubFolderCount = 0 To UBound(subfolders)\n    fileSpec = Trim(Me.Combo_History) &amp; \"*.pdf\"\n    co = subfolders(intSubFolderCount)\n    filename = Dir(rootFolder &amp; subfolders(intSubFolderCount) &amp; \"\\\" &amp; fileSpec)\n   Do While filename &lt;&gt; \"\"\n        filepath = rootFolder &amp; subfolders(intSubFolderCount)\n        foundfile = filepath &amp; \"\\\" &amp; filename\n        Application.FollowHyperlink foundfile\n        GoTo Exit_Command132_Click\n        Exit Do\n    Loop\n\nNext intSubFolderCount\n\nMsgBox \"No Scanned work order found for \" &amp; Me.Combo_History &amp; \"!\"\n\n\nExit_Command132_Click:\n   Exit Sub\n\nErr_Command132_Click:\n\nSelect Case Err.Number\n    Case 52\n        MsgBox \"No Scanned work order found for \" &amp; Me.Combo_History &amp; \"!\"\n    Case Else\n        MsgBox Err.Number &amp; \"-\" &amp; Err.Description\n  End Select\nEnd Sub\n</code></pre>\n\n<p>But on some of the computers in my office they get this error message:</p>\n\n<p>\"Some Files can contain viruses or otherwise be harmful to your computer.\nIt is important to be certain that this file is from a trustworthy source.</p>\n\n<p>Would you like to open this file?\"</p>\n\n<p>Is it possible to suppress this? We are running windows 7 professional.</p>\n"}, {"tags": ["vba", "function", "excel", "duplicates"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "edited": false, "score": 0, "creation_date": 1438806554, "post_id": 31840917, "comment_id": 51605893, "body": "this wouldn&#39;t be case sensitive would it?"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "edited": false, "score": 0, "creation_date": 1438806606, "post_id": 31840917, "comment_id": 51605927, "body": "Yes. But we can change that. Which one are you using?"}, {"owner": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "edited": false, "score": 0, "creation_date": 1438807020, "post_id": 31840917, "comment_id": 51606155, "body": "The second one, I already have everything separated by a space. Would I just put &quot;LCase()&quot; on the strText and strRemove? Also, If I wanted to include more cells to the strRemove (list of words needing removal) would I just add &quot;&amp;&quot; &quot;&amp;&quot; and the additional cell"}, {"owner": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "edited": false, "score": 0, "creation_date": 1438807865, "post_id": 31840917, "comment_id": 51606678, "body": "or is there a way to keep the word case? &amp;&quot; &quot;&amp; does what I had hoped! BTW - Thank You"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "edited": false, "score": 0, "creation_date": 1438814976, "post_id": 31840917, "comment_id": 51609675, "body": "@BrennanCasler - I removed the first option since the second one seems to meet your needs. I also edited the line <code>a = Filter(a, w, False)</code> to include a 4th parameter (<code>vbTextCompare</code>). That will do a case-insensitive comparison."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 3, "last_activity_date": 1438814905, "last_edit_date": 1438814905, "creation_date": 1438801884, "answer_id": 31840917, "question_id": 31840789, "link": "https://stackoverflow.com/questions/31840789/excel-vba-custom-function-remove-words-appearing-in-one-string-from-another-stri/31840917#31840917", "title": "Excel VBA Custom Function Remove Words Appearing in One String From Another String", "body": "<p>If you can guarantee that your words in both strings will be separated by spaces (no comma, ellipses, etc), you could just <code>Split()</code> both strings then <code>Filter()</code> out the words:</p>\n\n<pre><code>Function WORDREMOVE(ByVal strText As String, strRemove As String) As String\n\n    Dim a, w\n    a = Split(strText)             ' Start with all words in an array\n\n    For Each w In Split(strRemove)\n        a = Filter(a, w, False, vbTextCompare)  ' Remove every word found\n    Next\n\n    WORDREMOVE = Join(a, \" \")      ' Recreate the string\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68, "user_id": 4830260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca54cef01a64c757fd38ac64d87e33a9?s=128&d=identicon&r=PG&f=1", "display_name": "azera", "link": "https://stackoverflow.com/users/4830260/azera"}, "is_accepted": false, "score": 0, "last_activity_date": 1438803488, "last_edit_date": 1438803488, "creation_date": 1438803053, "answer_id": 31841264, "question_id": 31840789, "link": "https://stackoverflow.com/questions/31840789/excel-vba-custom-function-remove-words-appearing-in-one-string-from-another-stri/31841264#31841264", "title": "Excel VBA Custom Function Remove Words Appearing in One String From Another String", "body": "<p>My example is certainly not the best code, but it should work</p>\n\n<pre><code>Function WORDREMOVE(FirstCell As String, SecondCell As String)\n\nDim FirstArgument As Variant, SecondArgument As Variant\nDim FirstArgumentCounter As Integer, SecondArgumentCounter As Integer\nDim Checker As Boolean\n\nWORDREMOVE = \"\"\n\nFirstArgument = Split(FirstCell, \" \")\nSecondArgument = Split(SecondCell, \" \")\n\nFor SecondArgumentCounter = 0 To UBound(SecondArgument)\n    Checker = False\n\n    For FirstArgumentCounter = 0 To UBound(FirstArgument)\n\n        If SecondArgument(SecondArgumentCounter) = FirstArgument(FirstArgumentCounter) Then\n            Checker = True\n        End If\n\n    Next FirstArgumentCounter\n\n    If Checker = False Then WORDREMOVE = WORDREMOVE &amp; SecondArgument(SecondArgumentCounter) &amp; \" \"\n\nNext SecondArgumentCounter\n\n    WORDREMOVE = Left(WORDREMOVE, Len(WORDREMOVE) - 1) \nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1438830099, "creation_date": 1438830099, "answer_id": 31846122, "question_id": 31840789, "link": "https://stackoverflow.com/questions/31840789/excel-vba-custom-function-remove-words-appearing-in-one-string-from-another-stri/31846122#31846122", "title": "Excel VBA Custom Function Remove Words Appearing in One String From Another String", "body": "<p>You can also do this using Regular Expressions in VBA.  The version below is case insensitive and assumes all words are separated only by <code>space</code>.  If there is other punctuation, more examples would aid in crafting an appropriate solution:</p>\n\n<pre><code>Option Explicit\nFunction WordRemove(Str As String, RemoveWords As String) As String\n    Dim RE As Object\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .ignorecase = True\n    .Global = True\n    .Pattern = \"(?:\" &amp; Join(Split(WorksheetFunction.Trim(RemoveWords)), \"|\") &amp; \")\\s*\"\n    WordRemove = .Replace(Str, \"\")\nEnd With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4897688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1002543013089245/picture?type=large", "display_name": "Brennan Casler", "link": "https://stackoverflow.com/users/4897688/brennan-casler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1438830099, "creation_date": 1438801446, "last_edit_date": 1438815007, "question_id": 31840789, "link": "https://stackoverflow.com/questions/31840789/excel-vba-custom-function-remove-words-appearing-in-one-string-from-another-stri", "title": "Excel VBA Custom Function Remove Words Appearing in One String From Another String", "body": "<p>I am trying to remove words appearing in one string from a different string using a custom function. For instance:</p>\n\n<hr>\n\n<p>A1: </p>\n\n<blockquote>\n  <p>the was why blue hat</p>\n</blockquote>\n\n<p><br>\nA2: </p>\n\n<blockquote>\n  <p>the stranger wanted to know why his blue hat was turning orange</p>\n</blockquote>\n\n<p>The ideal outcome in this example would be:<br>\nA3: </p>\n\n<blockquote>\n  <p>stranger wanted to know his turning orange</p>\n</blockquote>\n\n<p>I need to have the cells in reference open to change so that they can be used in different situations.\nThe function will be used in a cell as:</p>\n\n<blockquote>\n  <p>=WORDREMOVE(<em>\"cell with words needing remove\", \"cell with list of words being removed\"</em>)</p>\n</blockquote>\n\n<p>I have a list of 20,000 rows and have managed to find a custom function that can remove duplicate words (below) and thought there may be a way to manipulate it to accomplish this task.</p>\n\n<pre><code>Function REMOVEDUPEWORDS(txt As String, Optional delim As String = \" \") As String\nDim x\n'Updateby20140924\nWith CreateObject(\"Scripting.Dictionary\")\n    .CompareMode = vbTextCompare\n    For Each x In Split(txt, delim)\n        If Trim(x) &lt;&gt; \"\" And Not .exists(Trim(x)) Then .Add Trim(x), Nothing\n    Next\n    If .Count &gt; 0 Then REMOVEDUPEWORDS = Join(.keys, delim)\nEnd With\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 1, "creation_date": 1438801296, "post_id": 31840649, "comment_id": 51602972, "body": "Hi and welcome to StackOverflow! As you may have skipped the intro for this site: \u201cCode this for me\u201d questions are generally frowned upon around here, however, we\u2019d love to help you learn! If you could, please post any code you have already tried. For further information on posting a question, you might want to have a look at this: stackoverflow.com/help/how-to-ask"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1438801304, "post_id": 31840649, "comment_id": 51602978, "body": "VBA can access the formatting of a cell. If your <code>If</code> statement approach didn&#39;t work chances are that you didn&#39;t formulate the condition clearly enough. You haven&#39;t formulated it clearly here either, for that matter. Just what sort of format determines if the data is to be extracted?"}, {"owner": {"reputation": 1, "user_id": 5195356, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203621987750315/picture?type=large", "display_name": "Ryan K", "link": "https://stackoverflow.com/users/5195356/ryan-k"}, "reply_to_user": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 1, "creation_date": 1439388554, "post_id": 31840649, "comment_id": 51842336, "body": "@Dr.Trey My mistake, I didn&#39;t mean to come across as a &#39;code this for me guy&#39;. I just didn&#39;t think it was necessary to copy and paste code that Excel generated when recording a macro. Nevertheless, I&#39;ll be sure to post code from now on! Thanks for the link!"}], "answers": [{"tags": [], "owner": {"reputation": 2549, "user_id": 1615031, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j8zg4.jpg?s=128&g=1", "display_name": "pedram", "link": "https://stackoverflow.com/users/1615031/pedram"}, "is_accepted": false, "score": 0, "last_activity_date": 1438801323, "creation_date": 1438801323, "answer_id": 31840756, "question_id": 31840649, "link": "https://stackoverflow.com/questions/31840649/is-there-a-way-to-only-copy-text-in-a-certain-format-while-ignoring-the-rest/31840756#31840756", "title": "Is there a way to only copy text in a certain format, while ignoring the rest?", "body": "<p>Consider three cells:</p>\n\n<p>A1: <strong>BOLD</strong></p>\n\n<p>A2: Regular</p>\n\n<p>A3: <em>Italic</em></p>\n\n<p>With code:</p>\n\n<pre><code>Sub CheckFormat()\nDim cell As Range\n\nFor Each cell In Range(\"A1:A3\")\n    If cell.Font.Bold = True Then\n        Debug.Print \"Cell: \" + cell.Address + \" is bold\"\n    End If\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>Output: <code>Cell :$A$1 is bold</code></p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1438811479, "last_edit_date": 1438811479, "creation_date": 1438802863, "answer_id": 31841195, "question_id": 31840649, "link": "https://stackoverflow.com/questions/31840649/is-there-a-way-to-only-copy-text-in-a-certain-format-while-ignoring-the-rest/31841195#31841195", "title": "Is there a way to only copy text in a certain format, while ignoring the rest?", "body": "<p>This shows bold characters in a cell (numbers or letters):</p>\n\n<pre><code>Option Explicit\n\nPublic Sub extractBoldText()\n\n    Dim i As Long, boldStart As Long, boldTotal As Long, cel As Range, sz As Long\n\n    Set cel = Cells(1, 1)   'A1 contains \"146976 12323 8448948 983893\"; 12323 is bold\n    sz = Len(cel)\n\n    If sz &gt; 0 Then\n        While Not cel.Characters(Start:=i, Length:=1).Font.Bold And i &lt; sz\n            i = i + 1\n        Wend\n        boldStart = IIf(i = 0, 1, i)\n        While cel.Characters(Start:=i, Length:=1).Font.Bold And i &lt; sz\n            i = i + 1\n        Wend\n        boldTotal = IIf(i = sz, i, i - boldStart)\n    End If\n\n    If boldTotal &gt; 0 Then MsgBox Mid(cel, boldStart, boldTotal) 'Will output \"12323\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5195356, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203621987750315/picture?type=large", "display_name": "Ryan K", "link": "https://stackoverflow.com/users/5195356/ryan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1438811479, "creation_date": 1438800975, "question_id": 31840649, "link": "https://stackoverflow.com/questions/31840649/is-there-a-way-to-only-copy-text-in-a-certain-format-while-ignoring-the-rest", "title": "Is there a way to only copy text in a certain format, while ignoring the rest?", "body": "<p>I have data in a cell which mean different things in different formats. It is similar to the following: <strong>146976 12323</strong> <em>8448948 983893</em>. I need to only extract the data that is bolded (it is also red, if that matters), while ignoring the italicized data. </p>\n\n<p>Originally I tried to use an If Statement, however that only works if the conditions are 100% met, and I tried using the text-to-columns feature to split the cell, however the format of the text isn't carried over to the new cell. </p>\n\n<p>I will be running this in a macro that isn't supposed to require user action. Is there a way this is possible? Much appreciated!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2549, "user_id": 1615031, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j8zg4.jpg?s=128&g=1", "display_name": "pedram", "link": "https://stackoverflow.com/users/1615031/pedram"}, "edited": false, "score": 0, "creation_date": 1438801856, "post_id": 31840781, "comment_id": 51603308, "body": "That&#39;s weird.  Why wouldn&#39;t it I be able to access it through ws.Checkbox1 but it works fine through Worksheets(ws.Name).Checkbox1?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 2549, "user_id": 1615031, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j8zg4.jpg?s=128&g=1", "display_name": "pedram", "link": "https://stackoverflow.com/users/1615031/pedram"}, "edited": false, "score": 0, "creation_date": 1438802111, "post_id": 31840781, "comment_id": 51603449, "body": "I can give you the answer but I want you to find it yourself ;). Do this. In your <code>Sub Works()</code>, Put a <code>Watch</code> on the the object <code>ws</code> and then see what is the type of <code>ws</code> during runtime."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 2549, "user_id": 1615031, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j8zg4.jpg?s=128&g=1", "display_name": "pedram", "link": "https://stackoverflow.com/users/1615031/pedram"}, "edited": false, "score": 1, "creation_date": 1438802453, "post_id": 31840781, "comment_id": 51603642, "body": "You may want to see <a href=\"http://stackoverflow.com/questions/21386768/why-am-i-having-issues-assigning-a-range-to-an-array-of-variants/21411922#21411922\">THIS</a> on how to add a <code>Watch</code>"}, {"owner": {"reputation": 2549, "user_id": 1615031, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j8zg4.jpg?s=128&g=1", "display_name": "pedram", "link": "https://stackoverflow.com/users/1615031/pedram"}, "edited": false, "score": 0, "creation_date": 1438803522, "post_id": 31840781, "comment_id": 51604232, "body": "I was following the locals window which did show the difference between the two. So I can see that <code>Dim ws As Worksheet</code> gives me a <code>Worksheet&#47;Sheet1 type</code>. And <code>Dim wsObj as Object</code> gives me a <code>Object&#47;Sheet1</code> type. But when I expand both <code>ws</code> and <code>wsObj</code> in the Locals Window, they both list <code>CheckBox1</code> as a property...so it must have something to do with forcing a worksheet into a <code>Worksheet</code> type vs. <code>Object</code>, but I&#39;m still missing something with Excel&#39;s object model..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 2549, "user_id": 1615031, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j8zg4.jpg?s=128&g=1", "display_name": "pedram", "link": "https://stackoverflow.com/users/1615031/pedram"}, "edited": false, "score": 1, "creation_date": 1438804459, "post_id": 31840781, "comment_id": 51604799, "body": "<code>Checkbox1</code> shows only for Variant/Object/Worksheets/Sheet1(in this case) and not for <code>Worksheet</code>. If you use intellisense, you will not get the <code>.Checkbox1</code> option when you declare ws as worksheet"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 4, "last_activity_date": 1438801714, "last_edit_date": 1438801714, "creation_date": 1438801410, "answer_id": 31840781, "question_id": 31840548, "link": "https://stackoverflow.com/questions/31840548/method-or-data-member-not-found-when-diming-worksheet-as-worksheet-but-not-va/31840781#31840781", "title": "&quot;Method or Data Member Not Found&quot; when Dim&#39;ing Worksheet as Worksheet but not Variant", "body": "<p>The problem is with the line <code>ws.CheckBox1.Value</code>. You can't use it like this and hence you are getting that error. Try this</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim objole As OLEObject\n\n    Set ws = Worksheets(1)\n\n    Set objole = ws.OLEObjects(\"CheckBox1\")\n\n    MsgBox \"Checkbox state is: \" &amp; objole.Object.Value\nEnd Sub\n</code></pre>\n\n<p>If you want to use the Object directly then you can also use this</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n\n    Set ws = Worksheets(1)\n\n    MsgBox \"Checkbox state is: \" &amp; Worksheets(ws.Name).CheckBox1.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2549, "user_id": 1615031, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/j8zg4.jpg?s=128&g=1", "display_name": "pedram", "link": "https://stackoverflow.com/users/1615031/pedram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1316, "favorite_count": 1, "accepted_answer_id": 31840781, "answer_count": 1, "score": 3, "last_activity_date": 1438801714, "creation_date": 1438800673, "question_id": 31840548, "link": "https://stackoverflow.com/questions/31840548/method-or-data-member-not-found-when-diming-worksheet-as-worksheet-but-not-va", "title": "&quot;Method or Data Member Not Found&quot; when Dim&#39;ing Worksheet as Worksheet but not Variant", "body": "<p>Consider this simple example. In a new sheet create a ActiveX Checkbox called Checkbox1</p>\n\n<p>Try the following two subroutines. The first does not compile with a \"Method or Data Member Not Found\" error, the second one works fine.</p>\n\n<p>Why doesn't the first example work?</p>\n\n<pre><code>Option Explicit\n\nSub DoesntWork()\nDim ws As Worksheet\nSet ws = Worksheets(1)\n\nMsgBox \"Checkbox state is: \" + CStr(ws.CheckBox1.Value)\n\nEnd Sub\n\nSub Works()\nDim ws As Variant\nSet ws = Worksheets(1)\n\nMsgBox \"Checkbox state is: \" + CStr(ws.CheckBox1.Value)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "is_accepted": true, "score": 0, "last_activity_date": 1438808128, "creation_date": 1438808128, "answer_id": 31842654, "question_id": 31840272, "link": "https://stackoverflow.com/questions/31840272/microsoft-word-2013-macro-adding-content-controls-to-multiple-items/31842654#31842654", "title": "Microsoft Word 2013 Macro - Adding Content Controls to Multiple Items", "body": "<p>You were quite close:</p>\n\n<pre><code>Sub StandardLanguageVariableSearch()\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\n\nWith Selection.Find\n    .Text = \"xx\"\n    '.Replacement.Text = \"xx\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\n\nDo While Selection.Find.Execute\n\n    'Selection.Text = \"\" 'uncomment if you want to remove xx\n    Selection.Range.ContentControls.Add (wdContentControlRichText)\n\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5195158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cde3a93f575de9b9a4565a11048ec3d3?s=128&d=identicon&r=PG&f=1", "display_name": "JoeG", "link": "https://stackoverflow.com/users/5195158/joeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 0, "accepted_answer_id": 31842654, "answer_count": 1, "score": 0, "last_activity_date": 1441511631, "creation_date": 1438799826, "last_edit_date": 1441511631, "question_id": 31840272, "link": "https://stackoverflow.com/questions/31840272/microsoft-word-2013-macro-adding-content-controls-to-multiple-items", "title": "Microsoft Word 2013 Macro - Adding Content Controls to Multiple Items", "body": "<p>What I need to do is add a Rich Text Content Control to all \"xx\"'s in a large word document.</p>\n\n<p>I saw a similar thread on highlighting multiple instances. I based the solution that I've tried so far on this:</p>\n\n<pre><code>    Options.DefaultHighlightColorIndex = wdYellow\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nSelection.Find.Replacement.Highlight = True\nWith Selection.Find\n    .Text = \"target1\"\n    .Replacement.Text = \"target1\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\n</code></pre>\n\n<p>Now just testing in word to see what command it uses to add the content controls individually I found this command:</p>\n\n<pre><code>Selection.Range.ContentControls.Add (wdContentControlRichText)\n</code></pre>\n\n<p>What I came up with was:</p>\n\n<pre><code>    Sub StandardLanguageVariableSearch()\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nSelection.Range.ContentControls.Add (wdContentControlRichText)\nWith Selection.Find\n    .Text = \"xx\"\n    .Replacement.Text = \"xx\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll\nEnd Sub\n</code></pre>\n\n<p>Swapping out <code>Selection.Range</code> with <code>Selection.Find</code> simply resulted in a \"method or data field not found\" or something like that. I think <code>Range</code> refers to the currently highlighted range of characters, whereas <code>find</code> refers to whatever the <code>with</code> block... well, finds.</p>\n\n<p>Whatever <code>find</code> is doesn't appear to have the ability to throw some content controls onto it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4966, "user_id": 3605497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mV6Nc.jpg?s=128&g=1", "display_name": "Tripp Kinetics", "link": "https://stackoverflow.com/users/3605497/tripp-kinetics"}, "edited": false, "score": 0, "creation_date": 1438799684, "post_id": 31840193, "comment_id": 51601954, "body": "It would be hard to tell without seeing the actual code."}, {"owner": {"reputation": 877, "user_id": 4934426, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e99370675c465147f9a2d15d862f8a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4934426/max"}, "reply_to_user": {"reputation": 4966, "user_id": 3605497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mV6Nc.jpg?s=128&g=1", "display_name": "Tripp Kinetics", "link": "https://stackoverflow.com/users/3605497/tripp-kinetics"}, "edited": false, "score": 0, "creation_date": 1438800178, "post_id": 31840193, "comment_id": 51602258, "body": "@TrippKinetics  ok, I added the code to the question"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438800257, "post_id": 31840193, "comment_id": 51602322, "body": "When you say &quot;...it doesn&#39;t work&quot;, what do you mean? Do you get an error? If so, what does the error say, and what line (click &quot;Debug&quot;)?"}, {"owner": {"reputation": 877, "user_id": 4934426, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e99370675c465147f9a2d15d862f8a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4934426/max"}, "edited": false, "score": 0, "creation_date": 1438800805, "post_id": 31840193, "comment_id": 51602689, "body": "It doesn&#39;t give any error. The output in the cell should be either 0 or 1. but it shows only 0 when it is actually 1."}], "answers": [{"comments": [{"owner": {"reputation": 877, "user_id": 4934426, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e99370675c465147f9a2d15d862f8a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4934426/max"}, "edited": false, "score": 0, "creation_date": 1438801606, "post_id": 31840599, "comment_id": 51603174, "body": "I am sorry, but I didn&#39;t understand what you tried to suggest."}], "tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": true, "score": 2, "last_activity_date": 1438802759, "last_edit_date": 1438802759, "creation_date": 1438800827, "answer_id": 31840599, "question_id": 31840193, "link": "https://stackoverflow.com/questions/31840193/adding-an-existing-module-to-a-worksheet-in-excel/31840599#31840599", "title": "Adding an existing module to a worksheet in excel", "body": "<p>You should be able to add this function to a code module, remove it from your sheet modules, and it can then be used on any sheet.</p>\n\n<p>To add a code module:</p>\n\n<ul>\n<li>In the VBE (coding window), go to the menu item \"Insert\"</li>\n<li>Select \"Module\"</li>\n<li>Cut and Paste your function into this module</li>\n<li>Remove any other instances of your function from other sheets</li>\n<li>Ensure you are good by selecting \"Debug\" -> \"Compile VBA Project\"</li>\n</ul>\n\n<p>You will only get negative feedback if there is a problem. If it compiled successfully, then the \"Compile VBA Project\" menu item will be greyed out now.</p>\n\n<p>You should be able to use your function in any sheet's cells now (within this Workbook).</p>\n"}], "owner": {"reputation": 877, "user_id": 4934426, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e99370675c465147f9a2d15d862f8a0c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4934426/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "accepted_answer_id": 31840599, "answer_count": 1, "score": 0, "last_activity_date": 1438802759, "creation_date": 1438799517, "last_edit_date": 1438800146, "question_id": 31840193, "link": "https://stackoverflow.com/questions/31840193/adding-an-existing-module-to-a-worksheet-in-excel", "title": "Adding an existing module to a worksheet in excel", "body": "<p>I got a worksheet with a vba module. It works fine. I copied this worksheet and created a second worksheet so I would use different data here. but on this new worksheet module doesn't work. How should I add it to the new worksheet or is there anything else I should do? thanks.</p>\n\n<p>VBA code: </p>\n\n<pre><code> Function Super_match(fin As Range, LOD As Range)\n   Dim test_arr As Variant\n   fin_arr =   Application.WorksheetFunction.Transpose(Application.WorksheetFunction.Transpose(fin))\nlod_arr = LOD\n\nReDim test_arr(1 To UBound(fin_arr))\nFor l = 1 To UBound(fin_arr)\n    test_arr(l) = 0\nNext l\n\n\nFor i = 1 To UBound(lod_arr, 1)\n    For j = 1 To UBound(lod_arr, 2)\n         For k = 1 To UBound(fin_arr)\n           If fin_arr(k) = lod_arr(i, j) Then\n             test_arr(k) = 1\n           End If\n         Next k\n    Next j\n\nIf Application.WorksheetFunction.And(test_arr) Then\n    Super_match = 1\n    Exit Function\nEnd If\n\nFor l = 1 To UBound(fin_arr)\n    test_arr(l) = 0\nNext l\n\nNext i\nSuper_match = 0\n\n\nDebug.Print Super_match1\nEnd Function\n</code></pre>\n\n<p>and the formula for the module:</p>\n\n<pre><code>=Super_match(A2:B2,$H$2:$M$41)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3822304, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5636f4571c7f83f355936ba91f88916f?s=128&d=identicon&r=PG&f=1", "display_name": "user3822304", "link": "https://stackoverflow.com/users/3822304/user3822304"}, "edited": false, "score": 0, "creation_date": 1438805640, "post_id": 31840251, "comment_id": 51605412, "body": "Works perfectly thanks Siddharth! (just had to change the a -1 to a + 1 for the loop direction change)  Much appreciated!"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1438800076, "last_edit_date": 1495540678, "creation_date": 1438799729, "answer_id": 31840251, "question_id": 31840091, "link": "https://stackoverflow.com/questions/31840091/deleting-unioned-range-error/31840251#31840251", "title": "Deleting Unioned Range Error", "body": "<blockquote>\n  <p>I am getting the error \"Object or With block variable not set\" on the rng_select.Delete line</p>\n</blockquote>\n\n<p>You are getting that error because <code>rng_select</code> is nothing. And that is probably because the code never entered inside the <code>If/EndIF</code> inside the <code>For</code> loop</p>\n\n<p>To check, change this <code>rng_select.Delete</code> to </p>\n\n<pre><code>If Not rng_select Is Nothing Then\n    rng_select.Delete\nElse\n    MsgBox \"Range not valid\"\nEnd If\n</code></pre>\n\n<p>Also, avoid the use of <code>.Activate</code>. You may want to see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">This</a></p>\n\n<p>Your code can be written as</p>\n\n<pre><code>Sub Delete()\n    Dim wkb As Workbook\n    Dim Command As Worksheet, Data As Worksheet, Transfer As Worksheet\n    Dim Accredited As Worksheet, FollowUp As Worksheet\n    Dim LcellData As Long, LcellTransfer As Long, LcellFollowUp As Long\n    Dim LcellAccredited As Long, a As Long, b As Long\n    Dim rng_select As Range\n\n    Set wkb = Application.ActiveWorkbook\n    Set Command = wkb.Sheets(\"Command\")\n    Set Data = wkb.Sheets(\"Data\")\n    Set Transfer = wkb.Sheets(\"Transfers\")\n    Set FollowUp = wkb.Sheets(\"FollowUp\")\n    Set Accredited = wkb.Sheets(\"Accredited\")\n\n    With FollowUp\n        LcellFollowUp = FollowUp.Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        For a = 2 to LcellFollowUp '&lt;~~ No need for reverse loop\n           If .Cells(a, 8).Value = .Cells(a - 1, 8).Value Then\n                If rng_select Is Nothing Then\n                    Set rng_select = .Cells(a, 1).EntireRow\n                Else\n                    Set rng_select = Union(rng_select, .Cells(a, 1).EntireRow)\n                End If\n           End If\n        Next a\n    End With\n\n    If Not rng_select Is Nothing Then\n        rng_select.Delete\n    Else\n        MsgBox \"Range not valid. No Matching range found\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 3822304, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5636f4571c7f83f355936ba91f88916f?s=128&d=identicon&r=PG&f=1", "display_name": "user3822304", "link": "https://stackoverflow.com/users/3822304/user3822304"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438800076, "creation_date": 1438799180, "last_edit_date": 1531161705, "question_id": 31840091, "link": "https://stackoverflow.com/questions/31840091/deleting-unioned-range-error", "title": "Deleting Unioned Range Error", "body": "<p>I am getting the error \"Object or With block variable not set\" on the rng_select.Delete line. I tried Debug.Print.rng_select.address with no luck. My sheet is activated - any ideas?</p>\n\n<pre><code>Sub Delete()\n\nDim wkb As Workbook\nDim Command As Worksheet, Data As Worksheet, Transfer AsWorksheet, Accredited As Worksheet, FollowUp As Worksheet\nDim LcellData As Long, LcellTransfer As Long, LcellFollowUp As Long, LcellAccredited As Long, a As Long, b As Long\nDim rng_select As Range\n\n\nSet wkb = Application.ActiveWorkbook\nSet Command = wkb.Sheets(\"Command\")\nSet Data = wkb.Sheets(\"Data\")\nSet Transfer = wkb.Sheets(\"Transfers\")\nSet FollowUp = wkb.Sheets(\"FollowUp\")\nSet Accredited = wkb.Sheets(\"Accredited\")\n\nLcellFollowUp = FollowUp.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFollowUp.Activate\n\nFor a = LcellFollowUp To 2 Step -1\n   If Cells(a, 8).Value = Cells(a - 1, 8).Value Then\n        If rng_select Is Nothing Then\n            Set rng_select = Cells(a, 1).EntireRow\n        Else\n            Set rng_select = Union(rng_select, Cells(a, 1).EntireRow)\n        End If\n   End If\nNext a\n\nrng_select.Delete\n\nExit Sub\n</code></pre>\n"}, {"tags": ["vba", "date", "filepath", "userform"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5095082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57497321f34ce44a2b9d6cffb4f1b9b8?s=128&d=identicon&r=PG&f=1", "display_name": "laurence", "link": "https://stackoverflow.com/users/5095082/laurence"}, "edited": false, "score": 0, "creation_date": 1438864764, "post_id": 31840294, "comment_id": 51631346, "body": "Thanks for your assitance on this. Unfortunately the macro is not working for me. It&#39;s failing recognise the date that I&#39;m inputing in the inputbox. The file path exists as I&#39;ve checked this in the immediate window, so I tried another bit of code but now have a new problem. Its failing to recognise the date format I am entering."}, {"owner": {"reputation": 17, "user_id": 5095082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57497321f34ce44a2b9d6cffb4f1b9b8?s=128&d=identicon&r=PG&f=1", "display_name": "laurence", "link": "https://stackoverflow.com/users/5095082/laurence"}, "edited": false, "score": 0, "creation_date": 1438865096, "post_id": 31840294, "comment_id": 51631589, "body": "&#39;Sub OpenLatest() Dim strDate As Date strDate = Format(strDate, &quot;ddmmyyyy&quot;) strDate = InputBox(&quot;Enter a date:&quot;)  If Not IsDate(strDate) Then     MsgBox &quot;Not a date&quot;     Exit Sub End If  &#39; Create the file path...  Dim strPath As String strPath = C:\\Users\\Laurence\\Documents\\Firstmacro_dtetime1 &quot; &amp; Format(strDate, &quot;ddmmyyyy&quot;) &amp; &quot;.xlsx&quot;  &#39; Make sure it exists... With CreateObject(&quot;Scripting.FileSystemObject&quot;)     If .FileExists(strPath) Then         Workbooks.Open strPath     End If End With End Sub&#39;"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 17, "user_id": 5095082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57497321f34ce44a2b9d6cffb4f1b9b8?s=128&d=identicon&r=PG&f=1", "display_name": "laurence", "link": "https://stackoverflow.com/users/5095082/laurence"}, "edited": false, "score": 0, "creation_date": 1438865134, "post_id": 31840294, "comment_id": 51631614, "body": "You can&#39;t use <code>Format()</code> beforehand to specify how the date should be entered. The user will have to enter the date in a traditional format (<code>1&#47;2&#47;15</code>,  <code>1-2-15</code>, <code>2015&#47;1&#47;2</code>, etc.). Otherwise, it will just be treated as a string. But if you need to do it that way, we can parse the string to create a date from it."}, {"owner": {"reputation": 17, "user_id": 5095082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57497321f34ce44a2b9d6cffb4f1b9b8?s=128&d=identicon&r=PG&f=1", "display_name": "laurence", "link": "https://stackoverflow.com/users/5095082/laurence"}, "edited": false, "score": 0, "creation_date": 1438868657, "post_id": 31840294, "comment_id": 51634351, "body": "Thank you very much Bond. I will try and parse the date with a String."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 0, "last_activity_date": 1438799885, "creation_date": 1438799885, "answer_id": 31840294, "question_id": 31840085, "link": "https://stackoverflow.com/questions/31840085/create-a-macro-with-a-file-path-that-has-a-date-variable/31840294#31840294", "title": "Create a macro with a file path that has a date variable", "body": "<p>You can use the <code>InputBox()</code> function to request a date from the user.</p>\n\n<pre><code>Dim strDate As String\nstrDate = InputBox(\"Enter a date:\")\n\nIf Not IsDate(strDate) Then\n    MsgBox \"Not a date\"\n    Exit Sub\nEnd If\n\n' Create the file path...\nDim strPath As String\nstrPath = \"C:\\Users\\Laurence\\Documents\\Firstmacro_dtetime1 \" &amp; Format$(strDate, \"ddmmyyyy\") &amp; \".xlsx\"\n\n' Make sure it exists...\nWith CreateObject(\"Scripting.FileSystemObject\")\n    If .FileExists(strPath) Then\n        Workbooks.Open strPath\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5095082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57497321f34ce44a2b9d6cffb4f1b9b8?s=128&d=identicon&r=PG&f=1", "display_name": "laurence", "link": "https://stackoverflow.com/users/5095082/laurence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1773, "favorite_count": 1, "accepted_answer_id": 31840294, "answer_count": 1, "score": 1, "last_activity_date": 1438800034, "creation_date": 1438799150, "last_edit_date": 1438800034, "question_id": 31840085, "link": "https://stackoverflow.com/questions/31840085/create-a-macro-with-a-file-path-that-has-a-date-variable", "title": "Create a macro with a file path that has a date variable", "body": "<p>I would like to open an Excel file which has a date variable at the end. To date I have created an okay code to retrieve the file based on working backwards from the current date. I would prefer a userform or input box to specify the exact date needed. The date is in the <code>ddmmyyyy</code> format and is at the end of the filename. Any help is much appreciated.</p>\n\n<pre><code>Sub OpenLatest()\n  ---Opens a sheet based on date, searches backward from today til it finds   a  matching date\nDim TestDate As Date\nDim StartWB As String\n\nConst sPath As String = \"C:\\Users\\Laurence\\Documents\\\"\nConst dtEarliest = #6/1/2015#  '--to stop loop if file not found by earliest valid date.\n\nTestDate = Date\nStartWB = ActiveWorkbook.Name\n\nWhile ActiveWorkbook.Name = StartWB And TestDate &gt;= dtEarliest\n    On Error Resume Next\n    Workbooks.Open sPath &amp; \"Firstmacro_dtetime1 \" &amp; Format(TestDate, \"ddmmyyyy\") &amp; \".xlsx\"\n    TestDate = dtTestDate - 1\n    On Error GoTo 0\nWend\n\nIf ActiveWorkbook.Name = sStartWB Then MsgBox \"Earlier file not found.\"\nEnd Sub'\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4966, "user_id": 3605497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mV6Nc.jpg?s=128&g=1", "display_name": "Tripp Kinetics", "link": "https://stackoverflow.com/users/3605497/tripp-kinetics"}, "edited": false, "score": 0, "creation_date": 1438798965, "post_id": 31840014, "comment_id": 51601558, "body": "I <b>highly</b> recommend not creating SQL statements through string concatenation.  You open yourself up to SQL injection later."}, {"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438800561, "post_id": 31840014, "comment_id": 51602533, "body": "If you use the posted code to get data already, then how do you want to modify it for your new requirement?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438800767, "post_id": 31840014, "comment_id": 51602668, "body": "Why 80 tables all with the same fields?  If you added one more field you could just have a single table, and your queries would be more straightforward...."}, {"owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "edited": false, "score": 0, "creation_date": 1438802367, "post_id": 31840014, "comment_id": 51603598, "body": "i had to add each table as a zone as i am tracking defects in certain zones of a product.  with evry zone there was specific info that needs to be added, so at the end i would have needed about 400 fields.  Yes i agree i was hoping to have all in same table.  So the need to query all my table at once would be ideal"}, {"owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "edited": false, "score": 0, "creation_date": 1438807770, "post_id": 31840014, "comment_id": 51606624, "body": "So is it possible to &#39;SELECT* FROM [ALL TABLES] WHERE [CAR_PART]=?&#39;  or is there another way"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1438812540, "post_id": 31840014, "comment_id": 51608788, "body": "You can create view/query which joins all of the tables using <code>UNION ALL</code> and run your SQL against that."}], "answers": [{"comments": [{"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 1, "creation_date": 1438815149, "post_id": 31843917, "comment_id": 51609731, "body": "There is a limit on the number of UNION clauses that Access can handle. I don&#39;t know precisely what that limit is, but it is certainly far lower than 80."}, {"owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "edited": false, "score": 0, "creation_date": 1438869429, "post_id": 31843917, "comment_id": 51634902, "body": "I am having trouble understanding how to put this SQL statement into my current code.  I tried removing my original SQL=Select....Statement and insert above but no luck.  Could you please help me create my statement.  I am trying to do the code above doing 10 tables at a time, thanks in advance for taking the time to help"}, {"owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "edited": false, "score": 0, "creation_date": 1438873411, "post_id": 31843917, "comment_id": 51638018, "body": "I have added the code to the top of my post, thanks in advance]"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "edited": false, "score": 0, "creation_date": 1438874245, "post_id": 31843917, "comment_id": 51638664, "body": "@INOH I have fixed your code in your answer.  because you have used zone1.*   it relies on zone1 and zone2 having an identical number of columns and those that are there having the same data types.  Which I have repeated here:   SQL = &quot;&quot; SQL = SQL &amp; &quot; SELECT * FROM &quot; SQL = SQL &amp; &quot; ( &quot; SQL = SQL &amp; &quot; SELECT &#39;Zone1&#39; AS MyTableName, * FROM Zone1 WHERE [Auditor_Name] = &#39;&quot; &amp; user &amp; &quot;&#39;&quot; SQL = SQL &amp; &quot; UNION ALL&quot; SQL = SQL &amp; &quot; SELECT &#39;Zone2&#39; AS MyTableName, * FROM Zone2 WHERE [Auditor_Name] = &#39;&quot; &amp; user &amp; &quot;&#39;&quot; SQL = SQL &amp; &quot; ) AS First2Tables&quot;"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 1, "last_activity_date": 1438815800, "last_edit_date": 1438815800, "creation_date": 1438813956, "answer_id": 31843917, "question_id": 31840014, "link": "https://stackoverflow.com/questions/31840014/query-entire-access-database-from-excel/31843917#31843917", "title": "Query entire Access Database from Excel", "body": "<p>Change the SQL to use a UNION query which will get all the data from all tables </p>\n\n<pre><code>SQL = \"\"\nSQL = SQL &amp; \" SELECT 'Table1' AS MyTableName, * FROM Table1 WHERE .....\nSQL = SQL &amp; \" UNION ALL\"\nSQL = SQL &amp; \" SELECT 'Table2' AS MyTableName, * FROM Table2 WHERE .....\nSQL = SQL &amp; \" UNION ALL\"\netc....\n</code></pre>\n\n<p>Why in gods name do you have 80 tables with identical fields.</p>\n\n<p>I would have expected one common table with all the common fields and a \"row type\" field (which could store 80 different type values) and then linked to this table from 80 other tables having the extra columns for each row type.</p>\n\n<p>(This has it's benefits, but there are justifiable reasons to do it the way you did)</p>\n\n<p>Anyway, the above query will work BUT you will need to replace  * in each query to only get the common fields. (fields in a union query must have the same data type in each column - i think)</p>\n\n<p>If you want to add an order by you would write it using the column position number  eg</p>\n\n<pre><code>  ORDER BY 4,10,12,1\n</code></pre>\n\n<p>IF you exceed the limit on the number of UNIONS allowed try this:</p>\n\n<pre><code>SQL = \" SELECT * FROM (\"\nSQL = SQL &amp; \" SELECT 'Table1' AS MyTableName, * FROM Table1 WHERE .....\nSQL = SQL &amp; \" UNION ALL\"\nSQL = SQL &amp; \" SELECT 'Table2' AS MyTableName, * FROM Table2 WHERE .....\nSQL = SQL &amp; \" UNION ALL\"\netc....\nSQL = SQL &amp; \" ) AS First10Tables\"\n\nSQL = SQL &amp; \" UNION ALL\"\n\nSQL = SQL &amp; \" SELECT * FROM (\"\nSQL = SQL &amp; \" SELECT 'Table1' AS MyTableName, * FROM Table1 WHERE .....\nSQL = SQL &amp; \" UNION ALL\"\nSQL = SQL &amp; \" SELECT 'Table2' AS MyTableName, * FROM Table2 WHERE .....\nSQL = SQL &amp; \" UNION ALL\"\netc....\nSQL = SQL &amp; \" ) AS Next10Tables\"\n</code></pre>\n\n<p>If this is a problem:</p>\n\n<p>You might be able to get away with using UNION instead of UNION ALL.</p>\n\n<p>restructure you database, or use named queries or temp tables (ie insert rows into a table from 10 tabels at a time)</p>\n\n<p>Harvey</p>\n"}], "owner": {"reputation": 307, "user_id": 2928055, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/a8d9dc81569deb183245bb7e4058e1c9?s=128&d=identicon&r=PG&f=1", "display_name": "INOH", "link": "https://stackoverflow.com/users/2928055/inoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 31843917, "answer_count": 1, "score": 0, "last_activity_date": 1438874186, "creation_date": 1438798878, "last_edit_date": 1531164843, "question_id": 31840014, "link": "https://stackoverflow.com/questions/31840014/query-entire-access-database-from-excel", "title": "Query entire Access Database from Excel", "body": "<p>I have a database with 80 tables with all the same fields.  What i am trying o do is search entire database for specific data.  Here is the code i have been previously using to get data</p>\n\n<pre><code>strTable = \"Table3\"\nuser = frm1.Label2.Caption\n\nSet con = CreateObject(\"ADODB.connection\")\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox \"Connection was not created!\", vbCritical, \"Connection Error\"\n    Exit Sub\nEnd If\nOn Error GoTo 0\n 'Open the connection.\ncon.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; AccessFile\n\nSQL = \"SELECT* FROM \" &amp; strTable &amp; \" WHERE [JCI_Con] = '\" &amp; user &amp; \"' AND Time_out is null\"\n</code></pre>\n\n<p>this is my full actual code i am using</p>\n\n<pre><code>Option Explicit\n\n Sub RunQuery14()\n Application.DisplayAlerts = False\nDim con         As Object\nDim rs          As Object\nDim AccessFile  As String\nDim strTable    As String\nDim SQL         As String\nDim i           As Integer\nDim user        As String\n\nOn Error GoTo Errhandler\n\nApplication.ScreenUpdating = False\nSheets(\"DATA\").Cells.Clear\nAccessFile = \"H:\\APPLICATIONS\\SEAT AUDIT\\DATABASE\\trial.accdb\"\n\nstrTable = \"Table1\"\nuser = \"????\"\n'Create the ADODB connection object.\nSet con = CreateObject(\"ADODB.connection\")\n'Check if the object was created.\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox \"Connection was not created!\", vbCritical, \"Connection Error\"\n    Exit Sub\nEnd If\nOn Error GoTo 0\n 'Open the connection.\ncon.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; AccessFile\n'Create the SQL statement to retrieve the data from table.\n'Get the necessary information (first name etc.) for all the Canadian customers.\nSQL = \"\"\nSQL = SQL &amp; \" SELECT * FROM \"\nSQL = SQL &amp; \" ( \"\nSQL = SQL &amp; \" SELECT 'Zone1' AS MyTableName, * FROM Zone1 WHERE [Auditor_Name] = '\" &amp; user &amp; \"'\"\nSQL = SQL &amp; \" UNION ALL\"\nSQL = SQL &amp; \" SELECT 'Zone2' AS MyTableName, * FROM Zone2 WHERE [Auditor_Name] = '\" &amp; user &amp; \"'\"\nSQL = SQL &amp; \" ) AS First2Tables\"\n\n    On Error Resume Next\n   'Create the ADODB recordset object.\n    Set rs = CreateObject(\"ADODB.Recordset\")\n    'Check if the object was created.\nIf Err.Number &lt;&gt; 0 Then\n    'Error! Release the objects and exit.\n    Set rs = Nothing\n    Set con = Nothing\n    'Display an error message to the user.\n    Exit Sub\nEnd If\nOn Error GoTo 0\n'Set thee cursor location.\nrs.CursorLocation = 3 'adUseClient on early  binding\nrs.CursorType = 1 'adOpenKeyset on early  binding\n\n'Open the recordset.\nrs.Open SQL, con\n\n'Check if the recordet is empty.\nIf rs.EOF And rs.BOF Then\n    'Close the recordet and the connection.\n    rs.Close\n    con.Close\n    'Release the objects.\n    Set rs = Nothing\n    Set con = Nothing\n    'Enable the screen.\n    Application.ScreenUpdating = True\n    'In case of an empty recordset display an error.\n    Exit Sub\nEnd If\n\n'Copy the recordset headers.\nFor i = 0 To rs.Fields.Count - 1\n    Sheets(\"DATA\").Cells(1, i + 1) = rs.Fields(i).Name\n\nNext i\n\n'Write the query values in the sheet.\nSheets(\"DATA\").Range(\"A2\").CopyFromRecordset rs\n\n'Close the recordet and the connection.\nrs.Close\ncon.Close\n\n'Release the objects.\nSet rs = Nothing\nSet con = Nothing\n\n'Adjust the columns' width.\nSheets(\"DATA\").Columns(\"A:Z\").AutoFit\n\n'Enable the screen.\nApplication.ScreenUpdating = True\nExit Sub\nErrhandler:\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "postgresql", "amazon-redshift"], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1438800005, "post_id": 31840094, "comment_id": 51602146, "body": "Good thought. I tried your suggestion just now and the same error was thrown. Maybe its not a spacing issue and there&#39;s something wrong with the GO command?"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1438800094, "post_id": 31840094, "comment_id": 51602208, "body": "Don&#39;t use <code>GO</code>. Like in the answer above, you just want to separate your two commands with a newline (<code>vbCrLf</code>)."}, {"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1438800180, "post_id": 31840094, "comment_id": 51602261, "body": "So that was my original approach but for some reason redshift won&#39;t pull a record set following any sort of insert/update statement without a GO in place. Not sure why this is.   My previous code was:      Select *     into xyz     From abc;      select *      from xyz  But this failed to pull any recordset at all, even in Aquadata studio."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1438800329, "post_id": 31840094, "comment_id": 51602369, "body": "But have you tried it like I suggested above with <code>vbCrLf</code>?"}, {"owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1438800397, "post_id": 31840094, "comment_id": 51602411, "body": "Yeah just tried that with and without a GO.  <code>sql = c.Value &amp; vbCrLf  sql = sql &amp; c.Offset(1, 0).Value</code>"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1438801207, "post_id": 31840094, "comment_id": 51602919, "body": "This seems to work only with <code>select</code> statements that return rows. You&#39;ll probably need to execute your commands separately. You can run your <code>select into</code> with <code>cmd.Execute</code>. No need to use a <code>Recordset</code> there."}, {"owner": {"reputation": 585, "user_id": 1864841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495f0105e1810609c5af0f1baac24b84?s=128&d=identicon&r=PG", "display_name": "tariq", "link": "https://stackoverflow.com/users/1864841/tariq"}, "reply_to_user": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "edited": false, "score": 0, "creation_date": 1438839855, "post_id": 31840094, "comment_id": 51616083, "body": "@Fubudis: You can control the statement separator in Aqua Data Studio under File&gt;Options&gt;Scripts&gt;Amazon Redshift. By default, in Aqua Data Studio, the statement separator is a &quot;go&quot; or &quot;/&quot;"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 0, "last_activity_date": 1438799195, "creation_date": 1438799195, "answer_id": 31840094, "question_id": 31839902, "link": "https://stackoverflow.com/questions/31839902/vba-data-pull-from-redshift-cant-seem-to-pass-go-command-in-query-string/31840094#31840094", "title": "VBA Data pull from Redshift. Can&#39;t seem to pass &quot;GO&quot; command in Query String", "body": "<p>Use <code>vbCrLf</code> to separate your SQL statements.</p>\n\n<p>For example:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim strSql\nstrSql = \"select col1 from table1\" &amp; vbCrLf\nstrSql = strSql &amp; \"select col1 from table2\"\n\nWith cmd\n    ....\n    .CommandText = strSql\nEnd With\n</code></pre>\n\n<p>And then use <code>Recordset.NextRecordset</code> to load the results of your second <code>select</code> statment:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>rsPubs.Open cmd, , , , adCmdText\n....\nrsPubs.NextRecordset\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 5149646, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/651fe4f019a74bfe7df61d3af7dbaaa7?s=128&d=identicon&r=PG&f=1", "display_name": "Fubudis", "link": "https://stackoverflow.com/users/5149646/fubudis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 726, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438800283, "creation_date": 1438798463, "last_edit_date": 1438800283, "question_id": 31839902, "link": "https://stackoverflow.com/questions/31839902/vba-data-pull-from-redshift-cant-seem-to-pass-go-command-in-query-string", "title": "VBA Data pull from Redshift. Can&#39;t seem to pass &quot;GO&quot; command in Query String", "body": "<p>I'm trying to pass a query string through VBA to pull data from a redshift server. </p>\n\n<p>The query works fine in the DB environment, and I'm sure my DB connection is set up correctly in the VBA Code.</p>\n\n<p>I'm getting this error:\nSyntax Error at or near \"GO\";</p>\n\n<p>I'm guessing its a spacing issue with the \"GO\" in the query and the next Select statement but I can't figure out how to work around this. Again, the query runs just fine in Aqua Data Studio.</p>\n\n<p>VBA:</p>\n\n<pre><code>Sub LoadQuery1(intRow, intCol, strWSheet, strConnection, intConnection)\n\nDim cmd As ADODB.Command\nDim rsPubs As ADODB.Recordset\nDim i As Integer\nDim Rowcount As Long\nDim irows As Integer\n\nSet cmd = New ADODB.Command\n\n\nIf intConnection = 14 Then\n    If OpenConnection1() Then\n    'Set up the command object and execute\n    Set rsPubs = New ADODB.Recordset\n    With cmd\n        .ActiveConnection = conn1\n        .CommandText = strConnection\n        .CommandType = adCmdText\n        .CommandTimeout = 0\n    End With\n    rsPubs.Open cmd, , , , adCmdText\n    'rsPubs.Open cmd, , adOpenStatic, adLockReadOnly\nEnd If\nEnd If\n\nirows = intRow + 1\n\nDo While Not rsPubs.EOF\n    'update header\n    For i = 0 To rsPubs.Fields.Count - 1\n            Worksheets(strWSheet).Cells(intRow, intCol + i) =            rsPubs.Fields(i).Name\n    Next i\n\n    For i = 0 To rsPubs.Fields.Count - 1\n            Worksheets(strWSheet).Cells(irows, intCol + i) =     rsPubs.Fields(i).Value\n    Next i\n\n    rsPubs.MoveNext\n    irows = irows + 1\n\n\nLoop\n\n\nEnd Sub\n</code></pre>\n\n<p>SQL: (Sample)</p>\n\n<pre><code> Select Distinct\nsessionid\n,dorderid\n,userid\n,customerid\n,bookings\n,dtmcreated\n\ninto #FinalMetrics\nFrom #RawMetrics \n\nGO  /*This is the GO throwing the error.*/\n\nselect \nsearchengine\n,count(distinct sessionid) as Sessions\n,count(distinct userid) as Visitors\n,count(distinct orderid) as Orders\n,cast(sum(bookings) as float)/100 as bookings\n,cast(count(orderid) as float)/count(sessionid) as CR\nfrom #FinalMetrics\nGroup by \nsearchengine;\n</code></pre>\n\n<p>Other notes:\nI tried replacing GO with a semicolon, but then the query stops before the final select statement and doesn't actually pull a recordset. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "inputbox", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438799213, "post_id": 31839861, "comment_id": 51601714, "body": "<code>Is this possible or am I thinking too big</code>? What do you think?"}], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": false, "score": 0, "last_activity_date": 1438801100, "creation_date": 1438801100, "answer_id": 31840689, "question_id": 31839861, "link": "https://stackoverflow.com/questions/31839861/excel-inputbox-function-with-conditions/31840689#31840689", "title": "Excel Inputbox Function with conditions", "body": "<p>You can use the <code>WorkSheet_Change()</code> event to check what was input and do a <code>Select Case</code> statement to handle each selection differently.</p>\n"}], "owner": {"reputation": 1, "user_id": 5195212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4507aba01f6f3d3db9d1bca22cc8cfd0?s=128&d=identicon&r=PG&f=1", "display_name": "JAFO", "link": "https://stackoverflow.com/users/5195212/jafo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1438801100, "creation_date": 1438798302, "last_edit_date": 1531161705, "question_id": 31839861, "link": "https://stackoverflow.com/questions/31839861/excel-inputbox-function-with-conditions", "title": "Excel Inputbox Function with conditions", "body": "<p>Background info:</p>\n\n<ul>\n<li>Column A = Last Names,</li>\n<li>Column B = First Names,</li>\n<li>Column C = a drop down box with a list of options determining whether\nthe person listed in A1B1 has a certain status(active rep,\ndisaffiliated, etc) there are 5 or 6</li>\n</ul>\n\n<p>In column D, I would like an input box to prompt the user depending on what the answer choice is in Column C. If for example <code>'C2' = \"Active Rep\"</code>, I'd like the prompt to ask for a date <code>mmddyy</code>, or if they hit cancel to allow them to enter something manually (text)</p>\n\n<p>If <code>'C2' = Disaffiliated</code>, I would like to to provide a drop down box giving them a list of options from the control page.</p>\n\n<p>This would need to happen for each named person in Column A for which there are about 100</p>\n\n<p>Is this possible or am I thinking too big and just need to simplify things.</p>\n"}, {"tags": ["excel", "vba", "recordset", "nothing"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1438798558, "post_id": 31839834, "comment_id": 51601306, "body": "what is strsqlrq? also try this set rcset = db.OpenRecordset(&quot;Select * from RealQuery&quot;)"}, {"owner": {"reputation": 1, "user_id": 5195205, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f619aca928770617064b676de405b563?s=128&d=identicon&r=PG&f=1", "display_name": "andruemily", "link": "https://stackoverflow.com/users/5195205/andruemily"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1438798899, "post_id": 31839834, "comment_id": 51601514, "body": "strsqlrq is just the SQL query in a string. It&#39;s a line above this block of code, and it is definitely working correctly. Tried the &quot;Select * from RealQuery&quot; but rcset is still Nothing."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 1, "creation_date": 1438802391, "post_id": 31839834, "comment_id": 51603609, "body": "1) try not closing the database 2) remove your On Error Resume Next and see what errors you get. 3) confirm qdef is a reference to a Querydef when you call it."}, {"owner": {"reputation": 1, "user_id": 5195205, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f619aca928770617064b676de405b563?s=128&d=identicon&r=PG&f=1", "display_name": "andruemily", "link": "https://stackoverflow.com/users/5195205/andruemily"}, "edited": false, "score": 0, "creation_date": 1438806408, "post_id": 31839834, "comment_id": 51605814, "body": "YES. That worked, and with a few more modifications it is working now. Thank you so much"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6826762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f8f1ddf285dec5b297f074c35df168b?s=128&d=identicon&r=PG", "display_name": "Przypadkiem", "link": "https://stackoverflow.com/users/6826762/przypadkiem"}, "is_accepted": false, "score": 1, "last_activity_date": 1473772866, "creation_date": 1473772866, "answer_id": 39471194, "question_id": 31839834, "link": "https://stackoverflow.com/questions/31839834/vba-openrecordset/39471194#39471194", "title": "VBA openRecordSet", "body": "<pre><code>Option Explicit\n    Public Const strQry = \"insert sql select command here\"\n    Public Const conStr = \"insertconnectionstringhere\";\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n\nSub sql2excell()\nSet cn = New ADODB.Connection\nSet rs = New ADODB.Recordset\ncn.Open (conStr)\nrs.Open strQry, cn\n\nIf Not rs.EOF Then\nActiveSheet.Range(\"A1\").CopyFromRecordset rs\nEnd If\n\nrs.Close\ncn.Close\nEnd Sub\n</code></pre>\n\n<p>Simplest SQL to excel vba i can get</p>\n"}], "owner": {"reputation": 1, "user_id": 5195205, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f619aca928770617064b676de405b563?s=128&d=identicon&r=PG&f=1", "display_name": "andruemily", "link": "https://stackoverflow.com/users/5195205/andruemily"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3681, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473772866, "creation_date": 1438798235, "last_edit_date": 1438806361, "question_id": 31839834, "link": "https://stackoverflow.com/questions/31839834/vba-openrecordset", "title": "VBA openRecordSet", "body": "<p>All I want to do is use VBA to get the results of some query into an Excel workbook instead. The main issue is that the openRecordSet method appears to not be working. Every time when I try debugging it I see that the recordset (rcset) is Nothing. When I just run the query so it is viewed in the Access viewer, it seems to work just fine (see last line of code). I get no errors when I run the code, so I'm having a very hard time understanding why my recordset would return Nothing. I've searched around the internet quite a bit, but haven't found anyone in this particular situation. Thanks in advance for any help! </p>\n\n<pre><code> Dim db As DAO.Database\n  Dim qdef As DAO.QueryDef\n  Dim rcset As DAO.Recordset\n   Dim i As Integer\n\n\n'Identify the database and query\nSet db = CurrentDb\nOn Error Resume Next\n  With db\n    .QueryDefs.Delete (\"RealQuery\")\n    Set qdef = .CreateQueryDef(\"RealQuery\", strSQLRQ)\n    .Close\nEnd With\n\n 'The problem child line\n Set rcset = qdef.OpenRecordset()\n\n'Clear previous contents\nDim xlApp As Object\nSet xlApp = CreateObject(\"Excel.Application\")\nWith xlApp\n  .Visible = True\n  .Workbooks.Add\n  .Sheets(\"Sheet1\").Select\n  'Copy the recordset to Excel\n  .ActiveSheet.Range(\"A2\").CopyFromRecordset rcset\n'Add column heading names to spreadsheet\nFor i = 1 To rcset.Fields.Count\n    xlApp.ActiveSheet.Cells(1, i).Value = MyRecordset.Fields(i - 1).Name\nNext i\nxlApp.Cells.EntireColumn.AutoFit\nEnd With\nqdef.Close\nSet qdef = Nothing\nSet db = Nothing\nDoCmd.OpenQuery \"RealQuery\", acViewNormal\n</code></pre>\n"}, {"tags": ["excel", "csv", "export-to-csv", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438797406, "post_id": 31839470, "comment_id": 51600622, "body": "<a href=\"http://www.mcgimpsey.com/excel/textfiles.html\" rel=\"nofollow noreferrer\">mcgimpsey.com/excel/textfiles.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1438798053, "last_edit_date": 1438798053, "creation_date": 1438797531, "answer_id": 31839614, "question_id": 31839470, "link": "https://stackoverflow.com/questions/31839470/vba-to-write-csv-format-to-text-file-2-snagging-points/31839614#31839614", "title": "VBA To Write CSV Format to Text File - 2 Snagging Points", "body": "<p>Try something like this.</p>\n\n<pre><code>If j = rng.Columns.Count Then\n    Write #1, \"\"\"\" &amp; cellValue &amp; \"\"\"\"\nElse\n    Write #1, \"\"\"\" &amp; cellValue &amp; \"\"\"\",\nEnd If\n</code></pre>\n\n<p>if the text cells are somehow already getting the double quotes and you don't want to get \"\"text\"\" then you may need to check to see if they are null or a number.</p>\n\n<pre><code>If j = rng.Columns.Count Then\n    if IsEmpty(cellValue) = true or isnumeric(cellValue) = true then\n        Write #1, \"\"\"\" &amp; cellValue &amp; \"\"\"\"\n    else\n        Write #1,cellValue\n    End if\nElse\n    if IsEmpty(cellValue) = true or isnumeric(cellValue) = true then\n        Write #1, \"\"\"\" &amp; cellValue &amp; \"\"\"\", \n    else\n        Write #1, cellValue, \n    End if\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1438798858, "post_id": 31839964, "comment_id": 51601490, "body": "Glad to help you out. Sometimes it is two double quotes to get a single and sometimes it is four. I think it depends on what your doing with it."}], "tags": [], "owner": {"reputation": 13, "user_id": 5195111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2634831736bb5790f8ba2a726e17820?s=128&d=identicon&r=PG&f=1", "display_name": "richdem", "link": "https://stackoverflow.com/users/5195111/richdem"}, "is_accepted": false, "score": 0, "last_activity_date": 1438798671, "creation_date": 1438798671, "answer_id": 31839964, "question_id": 31839470, "link": "https://stackoverflow.com/questions/31839470/vba-to-write-csv-format-to-text-file-2-snagging-points/31839964#31839964", "title": "VBA To Write CSV Format to Text File - 2 Snagging Points", "body": "<p>MatthewD, brilliant. </p>\n\n<p>I changed:</p>\n\n<pre><code>If j = rng.Columns.Count Then\nWrite #1, \"\"\"\" &amp; cellValue &amp; \"\"\"\"\nElse\nWrite #1, \"\"\"\" &amp; cellValue &amp; \"\"\"\",\nEnd If\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>If j = rng.Columns.Count Then\nWrite #1, \"\" &amp; cellValue &amp; \"\"\nElse\nWrite #1, \"\" &amp; cellValue &amp; \"\",\nEnd If\n</code></pre>\n\n<p>and it worked perfectly. Thanks for your help and pointing out the obvious. </p>\n"}], "owner": {"reputation": 13, "user_id": 5195111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2634831736bb5790f8ba2a726e17820?s=128&d=identicon&r=PG&f=1", "display_name": "richdem", "link": "https://stackoverflow.com/users/5195111/richdem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 31839614, "answer_count": 2, "score": 1, "last_activity_date": 1438798671, "creation_date": 1438797071, "last_edit_date": 1531161705, "question_id": 31839470, "link": "https://stackoverflow.com/questions/31839470/vba-to-write-csv-format-to-text-file-2-snagging-points", "title": "VBA To Write CSV Format to Text File - 2 Snagging Points", "body": "<p>Currently trying to generate a text file as CSV format from excel. </p>\n\n<p>The code below does that just fine to my highlighted range. However, I've now discovered that there are two snagging points which make the request slightly different to a standard CSV text file. </p>\n\n<p>Is it possible to enclose numbers in double quotes and also any non-populated fields?</p>\n\n<p>eg. desired result:</p>\n\n<p>\"Test\",\"\",\"1\",\"2\",\"3\"</p>\n\n<p>Rather than:</p>\n\n<p>\"Test\",,1,2,3</p>\n\n<p>Current VBA below. I'm not sure a change to this will necessarily be the answer but I'm truly stuck. </p>\n\n<pre><code>Dim myFile As String\nDim rng As Range\nDim cellValue As Variant\nDim i As Integer\nDim j As Integer\n\nmyFile = Application.DefaultFilePath &amp; \"\\test.txt\"\nSet rng = Selection\nOpen myFile For Output As #1\n\nFor i = 1 To rng.Rows.Count\nFor j = 1 To rng.Columns.Count\n\ncellValue = rng.Cells(i, j).Value\n\nIf j = rng.Columns.Count Then\nWrite #1, cellValue\nElse\nWrite #1, cellValue,\n\nEnd If\n\nNext j\nNext i\n\nClose #1\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438797464, "post_id": 31839401, "comment_id": 51600655, "body": "Do you want to insert a column or a row? You start by saying you want to insert a column, then you end by saying you want to insert a row."}, {"owner": {"reputation": 143, "user_id": 5085303, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b3303eadbf98768afc3c809817e22049?s=128&d=identicon&r=PG&f=1", "display_name": "VBAnoob", "link": "https://stackoverflow.com/users/5085303/vbanoob"}, "reply_to_user": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438797576, "post_id": 31839401, "comment_id": 51600725, "body": "Whoops sorry, column"}, {"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438797664, "post_id": 31839401, "comment_id": 51600774, "body": "Do you want the new column to be to the left or right of the existing one?"}, {"owner": {"reputation": 143, "user_id": 5085303, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b3303eadbf98768afc3c809817e22049?s=128&d=identicon&r=PG&f=1", "display_name": "VBAnoob", "link": "https://stackoverflow.com/users/5085303/vbanoob"}, "reply_to_user": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438797857, "post_id": 31839401, "comment_id": 51600905, "body": "I wasn&#39;t aware one could insert a column to the right, but If that&#39;s the case (and if it would make it easier) the inserted column needs to go to the right, but should start at P1 not P2 then."}], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": true, "score": 2, "last_activity_date": 1438798242, "creation_date": 1438798242, "answer_id": 31839837, "question_id": 31839401, "link": "https://stackoverflow.com/questions/31839401/excel-vba-finding-a-string-and-inserting-a-column-on-loop/31839837#31839837", "title": "Excel VBA Finding a string and inserting a column on loop", "body": "<p>This assumes your first sheet has the headers you are looking to use as a baseline in the first row. This will insert new columns to the right of the existing column and resize it.</p>\n\n<pre><code>Public Sub addColumns()\n    Dim intHeaderRow as Integer\n    intHeaderRow = 1\n    For i = sheets(1).usedrange.columns.count to 1 step -1\n        addColumn(sheets(1).cells(intHeaderRow, i))\n    Next\nEnd Sub\n\nPublic Sub addColumn(byval SearchString as string)\n    Dim intColumnFound as integer\n\n    Application.FindFormat.Clear\n    ' loop through all sheets\n    For Each sh In Worksheets\n        'Find first instance on sheet\n        Set cl = sh.Cells.Find(What:=SearchString, _\n        After:=sh.Cells(1, 1), _\n        LookIn:=xlValues, _\n        LookAt:=xlPart, _\n        SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, _\n        MatchCase:=False, _\n        SearchFormat:=False)\n        If Not cl Is Nothing Then\n            intColumnFound = cl.Column\n            sh.Columns(intColumnFound + 1).Insert\n            ' if found, remember location\n            sh.Columns(intColumnFound + 1).ColumnWidth = 6\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>You had a comment to \"remember location\" when the value was found. I'm not sure if you needed that, so I stored it in intColumnFound, but it will be overwritten on the next sheet and not used in this code.</p>\n"}], "owner": {"reputation": 143, "user_id": 5085303, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b3303eadbf98768afc3c809817e22049?s=128&d=identicon&r=PG&f=1", "display_name": "VBAnoob", "link": "https://stackoverflow.com/users/5085303/vbanoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 31839837, "answer_count": 1, "score": 1, "last_activity_date": 1438798242, "creation_date": 1438796812, "last_edit_date": 1438797588, "question_id": 31839401, "link": "https://stackoverflow.com/questions/31839401/excel-vba-finding-a-string-and-inserting-a-column-on-loop", "title": "Excel VBA Finding a string and inserting a column on loop", "body": "<p>I have a table that has headers that can go from P1 to P# (whatever that number is).</p>\n\n<p>I want to build a macro that starts out by finding P2 and inserts a column and will continue doing this for all the P's(until it hits P#). It will then take those created columns and make the cells width: 6. I  reused a formula to find the cell, but I don't know where to go from there. </p>\n\n<p>'Find P1 in sheet 1</p>\n\n<pre><code>SearchString = \"P2\"\n    Application.FindFormat.Clear\n            ' loop through all sheets\n            For Each sh In ActiveWorkbook\n                    'Find first instance on sheet\n                    Set cl = sh.Cells.Find(What:=SearchString, _\n                    After:=sh.Cells(1, 1), _\n                    LookIn:=xlValues, _\n                    LookAt:=xlPart, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False, _\n                    SearchFormat:=False)\n                If Not cl Is Nothing Then\n                    selectcell\n                    ' if found, remember location\n                  With ActiveCell.insertcolumn\n                End If\n            Next\n</code></pre>\n\n<p>How do I make this formula select and insert a column, then do it on repeat for all Ps?</p>\n"}, {"tags": ["ms-access", "vba", "odbc", "ms-access-2003"], "comments": [{"owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "edited": false, "score": 1, "creation_date": 1438798961, "post_id": 31839147, "comment_id": 51601556, "body": "My guess is that you set up the DSN via Administrative Tools &gt; Data Sources (ODBC). That is for 64 bit data sources. You need 32 bit, which should be at C:\\Windows\\SysWOW64\\odbcad32.exe. Then use the linked table manager to relink the tables."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1438799490, "post_id": 31839147, "comment_id": 51601858, "body": "try using file DNS adding database name"}, {"owner": {"reputation": 16, "user_id": 3965808, "user_type": "registered", "profile_image": "https://graph.facebook.com/320100049/picture?type=large", "display_name": "Aaron B. Chancey", "link": "https://stackoverflow.com/users/3965808/aaron-b-chancey"}, "edited": false, "score": 0, "creation_date": 1438800134, "post_id": 31839147, "comment_id": 51602233, "body": "The DSN was already set up, and I&#39;ve tried both the SysWOW64 and the system32 versions of odbcad32. I opened the linked table manager and it&#39;s able to see my data source, and I&#39;ve even created a new one, however, it still doesn&#39;t see the database that I selected and just uses the DSN. Unfortunately, I don&#39;t have access to a working version of the application, as the old server isn&#39;t working currently."}, {"owner": {"reputation": 16, "user_id": 3965808, "user_type": "registered", "profile_image": "https://graph.facebook.com/320100049/picture?type=large", "display_name": "Aaron B. Chancey", "link": "https://stackoverflow.com/users/3965808/aaron-b-chancey"}, "edited": false, "score": 0, "creation_date": 1438800842, "post_id": 31839147, "comment_id": 51602715, "body": "Annnnd after deleting all the DSNs, rebooting, and adding them again through the linked table manager, it fixed it. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 3965808, "user_type": "registered", "profile_image": "https://graph.facebook.com/320100049/picture?type=large", "display_name": "Aaron B. Chancey", "link": "https://stackoverflow.com/users/3965808/aaron-b-chancey"}, "is_accepted": false, "score": 0, "last_activity_date": 1438800968, "creation_date": 1438800968, "answer_id": 31840646, "question_id": 31839147, "link": "https://stackoverflow.com/questions/31839147/ms-access-2003-currentdb-tabledefstablename-connect-database-is-nothing/31840646#31840646", "title": "MS-Access 2003 CurrentDb.TableDefs(&quot;tablename&quot;).Connect Database is nothing", "body": "<p>AVG solved my question in the comments. The DSN was already set up, but I wound up deleting it</p>\n\n<p>I rebooted after, launched the application, kicked off the Linked Table Manager with this command in the immediate window in VB: </p>\n\n<p>Application.Run \"acwztool.att_Entry\"</p>\n\n<p>I readded the DSN from there, restarted again and fired access back up and it connected sucessfully! Thanks!</p>\n"}], "owner": {"reputation": 16, "user_id": 3965808, "user_type": "registered", "profile_image": "https://graph.facebook.com/320100049/picture?type=large", "display_name": "Aaron B. Chancey", "link": "https://stackoverflow.com/users/3965808/aaron-b-chancey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 509, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438800968, "creation_date": 1438795942, "last_edit_date": 1438798047, "question_id": 31839147, "link": "https://stackoverflow.com/questions/31839147/ms-access-2003-currentdb-tabledefstablename-connect-database-is-nothing", "title": "MS-Access 2003 CurrentDb.TableDefs(&quot;tablename&quot;).Connect Database is nothing", "body": "<p>So I've inherited this project at work that runs in Access 2003, we're upgrading to a newer version of windows (from Windows Server to Windows 7).</p>\n\n<p>It uses a DSN to connect to our MySQL database, however, Access isn't seeing the database name from the DSN settings.</p>\n\n<p>I already determined the ODBC error, which is as follows: \n[MySQL][ODBC 5.1 Driver][mysqld-5.6.22-log]No database selected</p>\n\n<p>When I run ?myDB.TableDefs(\"tblusers\").Connect in the immediate window, I get this response:\nODBC;DSN=bnr-rolodex;DATABASE=</p>\n\n<p>I've been wracking my brain for a day or two now and was wondering if anyone else had run into this.</p>\n\n<p>Thanks!</p>\n\n<p>Edit: I should also note that ?CurrentDb.Connect returns blank and highlighting over it has a tooltip saying \"Nothing = Nothing\"</p>\n"}, {"tags": ["vba", "split"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5000232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/401d6d7d8aa29c95f03a9290fc728405?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/5000232/cameron"}, "edited": false, "score": 0, "creation_date": 1438888239, "post_id": 31840285, "comment_id": 51646958, "body": "wow thanks Don, Sorry for the late reply I&#39;ve been working on somthing else.  Again thanks for the time put into this, I will need some time to go through and understand the code, your comments are very appreciated and helpful, still a novice at all this.  Again thanks."}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 0, "last_activity_date": 1438799866, "creation_date": 1438799866, "answer_id": 31840285, "question_id": 31839084, "link": "https://stackoverflow.com/questions/31839084/adding-a-delimiter-to-a-memo-field-in-access/31840285#31840285", "title": "Adding a Delimiter to a memo field in Access", "body": "<p>I wrote something like this recently to pull dated notes out of a memo field. This code may not work exactly as is, but will get you closer and give you some ideas.</p>\n\n<p><strong>Some initial notes</strong>: Don't expect the routine to do the full job on the first sweep. Create a temp table to write your results to, and each time you run the routine, clear the temp table first. After each run, tweak your code to catch everything it missed in the previous run. This way, you will refine the routine until you capture all your data accurately. You may also have to hand edit some notes to get them to work</p>\n\n<pre><code>+----------+------------+\n|  Field   |  DataType  |\n+----------+------------+\n| NoteId   | AutoNumber |\n| ParentId | Long       |\n| NoteDate | Date/Time  |\n| NoteNext | Memo       |\n+----------+------------+\n</code></pre>\n\n<p>Also, I highly recommend not using multiple note fields in the same table. Your Notes table should look like my temp_Notes table above. After your routine is successful, its a simple matter of running against your Notes table rather than temp_Notes.</p>\n\n<pre><code>Public Sub MigrateNotes()\n\n    Dim db As DAO.Database\n    Dim rsDest As DAO.Recordset\n    Dim rsSource As DAO.Recordset\n    Dim nId As Long\n    Dim aNotes() As String\n    Dim n As Long\n    Dim dtDate As Date\n    Dim sNote As String\n\n    On Error GoTo EH\n\n    DoCmd.Hourglass True\n\n    Set db = CurrentDb\n\n    db.Execute \"DELETE * FROM temp_Notes\"\n\n    Set rsDest = db.OpenRecordset(\"SELECT * FROM temp_Notes\")\n    Set rsSource = db.OpenRecordset(\"SELECT RowId,Diary FROM SourceNotes\")\n\n    With rsSource\n        Do Until .EOF\n            nId = .Fields(\"RowId\").Value\n\n            aNotes = parseNotes(.Fields(\"Diary\").Value)\n            For n = 0 To UBound(aNotes)\n\n                dtDate = CDate(Left(aNotes(n), 10))\n                sNote = Right(aNotes(n), Len(aNotes(n)) - 11)\n\n                With rsDest\n                    .AddNew\n                    .Fields(\"RowId\").Value = nId\n                    .Fields(\"NoteDate\").Value = dtDate\n                    .Fields(\"NoteText\").Value = sNote\n                    .Update\n                End With\n\n            Next 'n\n\n            .MoveNext\n        Loop\n    End With\n\n    MsgBox \"Complete\"\n\n    GoTo FINISH\n\nEH:\n\n    With Err\n        MsgBox .Number &amp; vbCrLf &amp; .Source &amp; vbCrLf &amp; .Description\n        .Clear\n    End With\n\n    'for debugging purposes\n    Debug.Assert 0\n    GoTo FINISH\n    Resume\n\nFINISH:\n    DoCmd.Hourglass False\n\n    On Error Resume Next\n    'release resources\n\n    If Not rsDest Is Nothing Then\n        rsDest.Close\n        Set rsDest = Nothing\n    End If\n\n    If Not rsSource Is Nothing Then\n        rsSource.Close\n        Set rsSource = Nothing\n    End If\n\nEnd Sub\n\nPrivate Function parseNotes(ByVal sRaw As String) As String()\n\n    Dim nYear As Long\n    Dim sYearToken As String\n    Dim nIndex As Long\n    Dim nSkip As Long\n\n    For nYear = 1999 To Year(Date)\n\n        sYearToken = \"/\" &amp; nYear &amp; \" \"\n\n        'use 12 to skip past first date (\"mm/dd/yyyy \" = 11)\n        nSkip = 12\n\n        Do\n            'find the end of the date\n            nIndex = InStr(nSkip, sRaw, sYearToken)\n\n            If nIndex &gt; 0 Then\n\n                'find the start of the date\n                nIndex = nIndex - 6\n\n                sRaw = Left(sRaw, nIndex) &amp; vbCrLf &amp; Right(sRaw, Len(sRaw) - nIndex)\n\n                'use 12 to skip past next date\n                nSkip = nIndex + 12\n\n            End If\n\n        Loop Until nIndex &lt;= 0\n\n    Next 'n\n\n    parseNotes = Split(sRaw, vbCrLf)\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 5000232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/401d6d7d8aa29c95f03a9290fc728405?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/5000232/cameron"}, "edited": false, "score": 0, "creation_date": 1438888402, "post_id": 31840410, "comment_id": 51647060, "body": "Thanks Diego, I will take a look at your code after I look over Dons, he was the first to reply.  Thank also for responding."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1438889218, "post_id": 31840410, "comment_id": 51647513, "body": "Good call moving the split out of the rs Edit and nice use of regex =o)"}, {"owner": {"reputation": 63, "user_id": 5000232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/401d6d7d8aa29c95f03a9290fc728405?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/5000232/cameron"}, "edited": false, "score": 0, "creation_date": 1445357129, "post_id": 31840410, "comment_id": 54285533, "body": "Hello Diego, thanks your code worked.  Apologies for the long delay, I got side tracked on something else."}], "tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": true, "score": 2, "last_activity_date": 1438802229, "last_edit_date": 1438802229, "creation_date": 1438800208, "answer_id": 31840410, "question_id": 31839084, "link": "https://stackoverflow.com/questions/31839084/adding-a-delimiter-to-a-memo-field-in-access/31840410#31840410", "title": "Adding a Delimiter to a memo field in Access", "body": "<pre><code>Public Function AddPipesBeforeDates(ByVal strText As String) As String\n    Dim regex As RegExp\n    Dim matches As Object\n\n    Set regex = CreateObject(\"VBScript.RegExp\")\n    regex.Global = True\n    regex.Pattern = \"\\d{2}/\\d{2}/\\d{4}\"\n    Set matches = regex.Execute(strText)\n    For Each m In matches\n        strText = Replace(strText, m, \"|\" &amp; m)\n    Next\n    AddPipesBeforeDates = strText\n\n    Set matches = Nothing\n    Set regex = Nothing\nEnd Function\n\nSub Example()\n\nOn Error GoTo err_Handler\n\nDim rsD As DAO.Recordset\nDim results as variant\nSet rsD = CurrentDb.OpenRecordset(\"tbl_Example\")\n\n Do While Not rsD.EOF\n    results = split(AddPipesBeforeDates(rsD!Tx_Example), \"|\")\n    rsD.Edit\n    rsD!F1 = Trim(results(1))\n    rsD!F2 = Trim(results(2))\n    rsD!F3 = Trim(results(3))\n    rsD.Update\n    rsD.MoveNext\nLoop\n\n\nsub_Exit:\n\nrsD.Close\nSet rsD = Nothing\nExit Sub\n\nerr_Handler:\n\nIf Err.Number = 9 Then\n    Resume Next\nElse\n    MsgBox \"Err: \" &amp; Err.Number &amp; vbNewLine &amp; Err.Description\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5000232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/401d6d7d8aa29c95f03a9290fc728405?s=128&d=identicon&r=PG&f=1", "display_name": "Cameron", "link": "https://stackoverflow.com/users/5000232/cameron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 31840410, "answer_count": 2, "score": 1, "last_activity_date": 1438802229, "creation_date": 1438795707, "question_id": 31839084, "link": "https://stackoverflow.com/questions/31839084/adding-a-delimiter-to-a-memo-field-in-access", "title": "Adding a Delimiter to a memo field in Access", "body": "<p>I am trying to delimit a memo field.  The field has within it multiple notes that I need to parse out into different columns.  Each note however follows the same logic, starts with mm/dd/yyyy then the note itself followed by a space.</p>\n\n<p>So an example for one memo field would be</p>\n\n<p>01/25/2000 worked on Rack-ID 03/03/2010 contracted Rack-ID 05/15/2014 updated Rack-ID</p>\n\n<p>I need each note parsed out into a different column in Access.</p>\n\n<p>I was working on the Split function in VBA, they had originally had \"|\" as a delimiter but removed it, now I have to pull on the dates</p>\n\n<p>Note \"tbl_example\" is the table in my test access database\n\"Tx_example\" is the name of the column holding the data to be delimited in my test access database</p>\n\n<pre><code>Sub Example()\n\nOn Error GoTo err_Handler\n\nDim rsD As DAO.Recordset\nSet rsD = CurrentDb.OpenRecordset(\"tbl_Example\")\n\n Do While Not rsD.EOF\n    rsD.Edit\n    rsD!F1 = Trim(Split(rsD!Tx_Example, \"|\")(0))\n    rsD!F2 = Trim(Split(rsD!Tx_Example, \"|\")(1))\n    rsD!F3 = Trim(Split(rsD!Tx_Example, \"|\")(2))\n    rsD.Update\n    rsD.MoveNext\nLoop\n\n\nsub_Exit:\n\nrsD.Close\nSet rsD = Nothing\nExit Sub\n\nerr_Handler:\n\nIf Err.Number = 9 Then\n    Resume Next\nElse\n    MsgBox \"Err: \" &amp; Err.Number &amp; vbNewLine &amp; Err.Description\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Not certain how I replace the \"|\" with a date search.\nAlso I'm not against doing a replace and inserting \"|\" right before each date so I would have my delimiter back.</p>\n\n<p>Problem is I'm not sure how to find the date in a text memo field, otherwise I would be able to use the replace function, or an update query.</p>\n\n<p>Any help is appreciated, thanks.</p>\n"}, {"tags": ["vba", "excel", "if-statement", "formula"], "comments": [{"owner": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "edited": false, "score": 0, "creation_date": 1438793694, "post_id": 31838363, "comment_id": 51598564, "body": "Are you looking for a VBA solution or an excel formula?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438793975, "post_id": 31838363, "comment_id": 51598731, "body": "<code>...add the previous cell number...</code> How is <code>I94</code> previous to <code>G95</code>?"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438794790, "post_id": 31838363, "comment_id": 51599209, "body": "@SiddharthRout - Assuming the formula is being entered in <code>I95</code>, he&#39;s checking column <code>G</code> for text and, if found, he wants the count from the cell above (<code>I94</code>) plus one."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438794964, "post_id": 31838363, "comment_id": 51599298, "body": "@eudeirys - I think it may make more sense to just post a sample of your data and explain what you&#39;re trying to accomplish. There may be a better way to get what you want than by using the formula you&#39;re trying to write."}, {"owner": {"reputation": 15, "user_id": 4518751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6399acba16e81c502dc101949bfa6945?s=128&d=identicon&r=PG&f=1", "display_name": "eudeirys", "link": "https://stackoverflow.com/users/4518751/eudeirys"}, "edited": false, "score": 0, "creation_date": 1438801428, "post_id": 31838363, "comment_id": 51603051, "body": "Thank you for your help but someone else has solved this problem for me . Again thank you."}], "answers": [{"comments": [{"owner": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "edited": false, "score": 0, "creation_date": 1438794443, "post_id": 31838604, "comment_id": 51599005, "body": "That won&#39;t reset for each month."}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "reply_to_user": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "edited": false, "score": 0, "creation_date": 1438794898, "post_id": 31838604, "comment_id": 51599260, "body": "I don&#39;t think the OP wants to set the value back to 1.  @Brian"}, {"owner": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "edited": false, "score": 0, "creation_date": 1438795461, "post_id": 31838604, "comment_id": 51599562, "body": "Then how do you satisfy the third criteria that is asked for?"}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "reply_to_user": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "edited": false, "score": 0, "creation_date": 1438796504, "post_id": 31838604, "comment_id": 51600086, "body": "@BrianCohan Sorry, i didn&#39;t understand the 3rd criteria that way the first 10 times a read through it."}], "tags": [], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "is_accepted": false, "score": 0, "last_activity_date": 1438793974, "creation_date": 1438793974, "answer_id": 31838604, "question_id": 31838363, "link": "https://stackoverflow.com/questions/31838363/if-statement-in-excel-adding-1-if-cell-with-text-but/31838604#31838604", "title": "if statement in excel, adding 1 if cell with text but", "body": "<p>It sounds like you want to keep a running total for the month count in the column and put a 0 if there is not text. If that is the case, you can put this formula in I95.</p>\n\n<pre><code>=IF(ISTEXT(G95),MAX($I$2:I94)+1, 0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 4518751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6399acba16e81c502dc101949bfa6945?s=128&d=identicon&r=PG&f=1", "display_name": "eudeirys", "link": "https://stackoverflow.com/users/4518751/eudeirys"}, "edited": false, "score": 0, "creation_date": 1438877587, "post_id": 31838718, "comment_id": 51641071, "body": "Hey quick question, how would  I create a similar formula that does not reset every month and would give me a yearly count. Thanks in advance"}, {"owner": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "reply_to_user": {"reputation": 15, "user_id": 4518751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6399acba16e81c502dc101949bfa6945?s=128&d=identicon&r=PG&f=1", "display_name": "eudeirys", "link": "https://stackoverflow.com/users/4518751/eudeirys"}, "edited": false, "score": 0, "creation_date": 1438878129, "post_id": 31838718, "comment_id": 51641417, "body": "Just update the references to column B to the year column. If you have your columns as <code>Detail | month | year | CountMonth | CountYear</code>, you would have <code>CountMonth</code> as described above, and for <code>Count</code>Year, you would change any reference to column B to C."}, {"owner": {"reputation": 15, "user_id": 4518751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6399acba16e81c502dc101949bfa6945?s=128&d=identicon&r=PG&f=1", "display_name": "eudeirys", "link": "https://stackoverflow.com/users/4518751/eudeirys"}, "edited": false, "score": 0, "creation_date": 1438881870, "post_id": 31838718, "comment_id": 51643498, "body": "well I don&#39;t want the years to reset, I just want the formula to look at the detail column and to add one to the year column to get the yearly count and if it&#39;s zero not add 1 to the following cell. This is for one year count."}, {"owner": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "reply_to_user": {"reputation": 15, "user_id": 4518751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6399acba16e81c502dc101949bfa6945?s=128&d=identicon&r=PG&f=1", "display_name": "eudeirys", "link": "https://stackoverflow.com/users/4518751/eudeirys"}, "edited": false, "score": 0, "creation_date": 1438882932, "post_id": 31838718, "comment_id": 51643993, "body": "Well, assuming you only have one year in a given  column, you could just use <code>=COUNTA($A$1:A2)</code>"}], "tags": [], "owner": {"reputation": 3809, "user_id": 3447515, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/cPyHf.png?s=128&g=1", "display_name": "Cohan", "link": "https://stackoverflow.com/users/3447515/cohan"}, "is_accepted": true, "score": 3, "last_activity_date": 1438795126, "last_edit_date": 1438795126, "creation_date": 1438794403, "answer_id": 31838718, "question_id": 31838363, "link": "https://stackoverflow.com/questions/31838363/if-statement-in-excel-adding-1-if-cell-with-text-but/31838718#31838718", "title": "if statement in excel, adding 1 if cell with text but", "body": "<p>The formula for the count column should be as follows.</p>\n\n<pre><code>=IF(A2&lt;&gt;\"\",COUNTIF($B$1:B2,B2)-COUNTIFS($A$1:A2,\"\",$B$1:B2,B2),0)\n</code></pre>\n\n<p>Breakdown of how this works:</p>\n\n<ul>\n<li><code>A2&lt;&gt;\"\"</code> Will check if the detail column is populated</li>\n<li><code>COUNTIF($B$1:B2,B2)</code> will figure out how many entries are above this row that reference the same month.</li>\n<li><code>COUNTIFS($A$1:A2,\"\",$B$1:B2,B2)</code> Will find how many cells are blank provided that it also matches the month. This subtracted from the  previous section gives you how many are not blank.</li>\n<li>The <code>IF</code> will return 0 if the detail is empty.</li>\n</ul>\n\n<p>Which returned the following data</p>\n\n<pre><code>Orderly             Random\nDet Mon Count       Det Mon Count\nX   1   1               2   0\nX   1   2           X   1   1\nX   1   3           X   1   2\n    1   0               2   0\nX   1   4           X   2   1\nX   2   1           X   1   3\nX   2   2           X   1   4\n    2   0               1   0\n    2   0               1   0\n    2   0               2   0\n    3   0               3   0\nX   3   1           X   3   1\n    3   0               1   0\nX   3   2               3   0\nX   3   3           X   1   5\n    3   0           X   2   2\nX   3   4           X   3   2\n    3   0               3   0\nX   3   5               3   0\nX   3   6               2   0\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4518751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6399acba16e81c502dc101949bfa6945?s=128&d=identicon&r=PG&f=1", "display_name": "eudeirys", "link": "https://stackoverflow.com/users/4518751/eudeirys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 0, "accepted_answer_id": 31838718, "answer_count": 2, "score": 1, "last_activity_date": 1438795126, "creation_date": 1438793159, "last_edit_date": 1438794515, "question_id": 31838363, "link": "https://stackoverflow.com/questions/31838363/if-statement-in-excel-adding-1-if-cell-with-text-but", "title": "if statement in excel, adding 1 if cell with text but", "body": "<p>I am creating an excel sheet that has three columns. Detail, month and month count</p>\n\n<p>1 -- I would like for the formula to look at the detail column and if there is text add the previous cell number plus 1 to new month count, if not insert 0   </p>\n\n<p>2-- I would like the formula to add the previous cell before the cell with 0 and for the cell with 0 not to impact the other cells or reset the cells back to 1 witch is the problem am having </p>\n\n<p>3-- I also need the formula to reset for every month from what ever number it was back to 0 or 1 depending if the new month first cell has text or not. for this I need the formula to look at the month column</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>=IF(ISTEXT(G95), I94+ 1, 0)\n</code></pre>\n"}, {"tags": ["excel", "vba", "replace", "ms-word", "find"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438793491, "post_id": 31838276, "comment_id": 51598452, "body": "What happens when you walk through the Macro? In VBA, put the mouse cursor anywhere in your code, and press <code>F8</code>.  After <code>wdApp.Visible = True</code>, what happens? Does it just jump to <code>End Sub</code>?"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 2, "creation_date": 1438794197, "post_id": 31838276, "comment_id": 51598870, "body": "Your Find is looking for the string &quot;Excel.Application.ws.Cells(i, 40).Value&amp;&quot; which isn&#39;t what you want. Try removing the quotes and the ampersands."}, {"owner": {"reputation": 3, "user_id": 5194932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b9bde2d5e4bddee1690abb4c72468f?s=128&d=identicon&r=PG&f=1", "display_name": "M Lang", "link": "https://stackoverflow.com/users/5194932/m-lang"}, "edited": false, "score": 0, "creation_date": 1438881756, "post_id": 31838276, "comment_id": 51643438, "body": "I have walked through it. It loops through the find code, but it does not do anything. I have played around with it since, and just told it to find a string (&quot;Name&quot;) and replace it with another string. It Finds &quot;Name&quot; in my document, but then does not replace it. (Before it did not find anything)."}, {"owner": {"reputation": 3, "user_id": 5194932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b9bde2d5e4bddee1690abb4c72468f?s=128&d=identicon&r=PG&f=1", "display_name": "M Lang", "link": "https://stackoverflow.com/users/5194932/m-lang"}, "edited": false, "score": 0, "creation_date": 1438882092, "post_id": 31838276, "comment_id": 51643601, "body": "Also, made one change to the code, I had Content.Find.Execute at the end of the find code. I had meant to remove the Content.Find, but missed it before I pasted the code."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5194932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b9bde2d5e4bddee1690abb4c72468f?s=128&d=identicon&r=PG&f=1", "display_name": "M Lang", "link": "https://stackoverflow.com/users/5194932/m-lang"}, "edited": false, "score": 0, "creation_date": 1438882265, "post_id": 31843109, "comment_id": 51643679, "body": "This helps, it now finds the strings, but then it does not replace them. If I click the through the code just keeps moving through the document, finding each string, but not doing anything else."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 3, "user_id": 5194932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b9bde2d5e4bddee1690abb4c72468f?s=128&d=identicon&r=PG&f=1", "display_name": "M Lang", "link": "https://stackoverflow.com/users/5194932/m-lang"}, "edited": false, "score": 0, "creation_date": 1438890509, "post_id": 31843109, "comment_id": 51648203, "body": "please tick my answer and use the up arrow to like it."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 0, "last_activity_date": 1438882985, "last_edit_date": 1438882985, "creation_date": 1438809898, "answer_id": 31843109, "question_id": 31838276, "link": "https://stackoverflow.com/questions/31838276/vba-code-keeps-skipping-my-find-execute-code/31843109#31843109", "title": "VBA code keeps skipping my Find.Execute Code", "body": "<p>Very stinky code</p>\n\n<pre><code> .Text = \"&amp;Excel.Application.ws.Cells(i, 40).Value&amp;\"\n .Replacement.Text = \"&amp;Excel.Application.ws.Cells(i, 39).Value&amp;\"\n</code></pre>\n\n<p>It should probably be something like </p>\n\n<pre><code> .Text = ws.Cells(i, 40).Value\n .Replacement.Text = ws.Cells(i, 39).Value\n</code></pre>\n\n<p>Also When i record a macro to do a find an repalce it give the following code \nThe lines marked '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;   need adjusting and adding to your code</p>\n\n<pre><code>Selection.Find.ClearFormatting    '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\nSelection.Find.Replacement.ClearFormatting   '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\nWith Selection.Find\n    .Text = \"d\"\n    .Replacement.Text = \"XXXX\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = False  '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n    .MatchSoundsLike = False  '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n    .MatchAllWordForms = False  '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\nEnd With\nSelection.Find.Execute Replace:=wdReplaceAll  '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5194932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12b9bde2d5e4bddee1690abb4c72468f?s=128&d=identicon&r=PG&f=1", "display_name": "M Lang", "link": "https://stackoverflow.com/users/5194932/m-lang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 31843109, "answer_count": 1, "score": 0, "last_activity_date": 1438882985, "creation_date": 1438792908, "last_edit_date": 1438882024, "question_id": 31838276, "link": "https://stackoverflow.com/questions/31838276/vba-code-keeps-skipping-my-find-execute-code", "title": "VBA code keeps skipping my Find.Execute Code", "body": "<p>I am new to VBA and I and working on a code to copy data from Excel to Word by finding keywords and replacing them. My problem is the code creates a new version of the document I want to copy, but then ignores my code to find and replace. I think my issue is with my declarations, but I really have no idea. Here is my code: </p>\n\n<pre><code>Sub CopyDatatoWord()\nDim wb As Workbook\nDim ws As Worksheet\n\nDim wdDoc As Word.Documents\nDim wdApp As Word.Application\nDim myrange As Range\n\nSet wb = Workbooks(\"Create Health Fair Forms.xlsm\")\nSet ws = wb.Worksheets(\"Data\")\n\nSet wdApp = CreateObject(\"Word.Application\")\nSet sel = wdApp.Selection\n\nMkDir (\"\" &amp; ws.Range(\"FilePath\").Value &amp; \"\")\n\nwdApp.DisplayAlerts = wdAlertsNone\nwdApp.Documents.Open(\"\\\\hfd\\repository\\Screenings and Health Fair Forms\\Basic Health Fair Templates\\013 - CW - Template.docm\", Visible = True, ReadOnly = False).SaveAs (\"\" &amp; ws.Range(\"FilePath\").Value &amp; \"\\CW.docm\")\nwdApp.DisplayAlerts = wdAlertsAll\nwdApp.Visible = True\n\n'Code works fine until this point, and then seems to ignore everything past this point.\n\nFor i = 13 To 30\n\nWith wdApp.Selection.Find\n .Text = \"&amp;Excel.Application.ws.Cells(i, 40).Value&amp;\"\n .Forward = True\n .Wrap = wdFindContinue\n .MatchWholeWord = True\n .Format = False\n .Replacement.Text = \"&amp;Excel.Application.ws.Cells(i, 39).Value&amp;\"\n .Execute\n End With\n\nNext i\nEnd Sub\n</code></pre>\n\n<p>I have seen other posts online where people have successfully created a code like mine, and I have been trying to recreate it, but have so far failed.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 248, "user_id": 4978922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LtnkY.jpg?s=128&g=1", "display_name": "PractLogical", "link": "https://stackoverflow.com/users/4978922/practlogical"}, "edited": false, "score": 0, "creation_date": 1438798896, "post_id": 31838041, "comment_id": 51601511, "body": "The only time I&#39;ve had issues like that, the problem was something in the coding. Are you sure that the Excel macro isn&#39;t changing the data that was exported from Access? What&#39;s going on before and after the segment of code that you posted? If you run a make-table in access from the queries, do you get the same recordcount that the original queries have in select view? If not, at least you can narrow the issue to Access."}, {"owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "reply_to_user": {"reputation": 248, "user_id": 4978922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LtnkY.jpg?s=128&g=1", "display_name": "PractLogical", "link": "https://stackoverflow.com/users/4978922/practlogical"}, "edited": false, "score": 0, "creation_date": 1438800962, "post_id": 31838041, "comment_id": 51602772, "body": "@PractLogical I thought the same thing at first, and checked me pre and post-import macros. Nothing touches that worksheet at all! I changed the workbook to self-import the data rather than using access to export the data and it works fine now."}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 4780490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZuVSP.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/4780490/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1439007887, "creation_date": 1439007887, "answer_id": 31889624, "question_id": 31838041, "link": "https://stackoverflow.com/questions/31838041/transferspreadsheet-misses-200-records-access-vba/31889624#31889624", "title": "TransferSpreadsheet Misses ~200 Records - Access VBA", "body": "<p>Seems like something is going wrong with your where statement, not the export transaction.</p>\n\n<p>Should the iif statement not be on your select line and your where statement just evaluate Closed or Open ?</p>\n\n<p>What happens when closedstatus is null or empty or contains a blank ?</p>\n"}], "owner": {"reputation": 181, "user_id": 5120530, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4b44ef868afbfff63a2b25b5215b202a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Welsh", "link": "https://stackoverflow.com/users/5120530/ryan-welsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594643907, "creation_date": 1438792112, "last_edit_date": 1594643907, "question_id": 31838041, "link": "https://stackoverflow.com/questions/31838041/transferspreadsheet-misses-200-records-access-vba", "title": "TransferSpreadsheet Misses ~200 Records - Access VBA", "body": "<p>I am writing a script to export two queries to excel spreadsheets. From there, I run a macro in another workbook that handles the data. Everything works fine, except that the data that is originally exported has missing records (around 200 each time).</p>\n\n<p>My Code:</p>\n\n<pre><code>'Step 1: Run qry_OpenKaizens and ouput data to OpenKaizens.xlsx\n    myQueryName = \"qry_OpenKaizens\"\n    myExportFileName = CurrentProject.Path &amp; \"\\OpenKaizens.xlsx\"\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, myQueryName, myExportFileName, True\n'Step 2: Rim qry_closed Kaizens and output data to ClosedKaizens.xlsx\n    myQueryName = \"qry_ClosedKaizens\"\n    myExportFileName = CurrentProject.Path &amp; \"\\ClosedKaizens.xlsx\"\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, myQueryName, myExportFileName, True\n</code></pre>\n\n<p>qry_OpenKaizens (should have 79 records, has 71):</p>\n\n<pre><code>SELECT KaizenData.TrackingNumber, KaizenData.KaizenLevel, KaizenData.Plant, KaizenData.Year1, KaizenData.[Tracking No], KaizenData.MainPillar, KaizenData.Area AS Dept, KaizenData.Team AS Area, KaizenData.[OP/STA] AS [Machine/Station], KaizenData.ProjectName AS [Project Name], KaizenData.IssueDescription AS [Description Phenomena], KaizenData.SolutionDescription AS [Solution Description], KaizenData.[Project Board], KaizenData.[Loss Category], KaizenData.[Loss Type], KaizenData.EnteredDate AS [Entered Date], KaizenData.StartingDate AS [Starting Date], KaizenData.EndDate AS [Completion Data], KaizenData.Notes, KaizenData.EstimatedSavings, KaizenData.EstimatedCost, KaizenData.BC, [EstimatedSavings]-[EstimatedCost] AS [Estimated Benefit], IIf([openstatus]=True,\"Open\") AS Status\nFROM KaizenData\nWHERE (((IIf([openstatus]=True,\"Open\")) Is Not Null)); \n</code></pre>\n\n<p>qry_ClosedKaizens (should have 7514 records, but has 7239):</p>\n\n<pre><code>SELECT KaizenData.TrackingNumber, KaizenData.KaizenLevel, KaizenData.Plant, KaizenData.Year1, KaizenData.[Tracking No], KaizenData.MainPillar, KaizenData.Area AS Dept, KaizenData.Team AS Area, KaizenData.[OP/STA] AS [Machine/Station], KaizenData.ProjectName AS [Project Name], KaizenData.IssueDescription AS [Description Phenomena], KaizenData.SolutionDescription AS [Solution Description], KaizenData.[Project Board], KaizenData.[Loss Category], KaizenData.[Loss Type], KaizenData.EnteredDate AS [Entered Date], KaizenData.StartingDate AS [Starting Date], KaizenData.EndDate AS [Completion Data], KaizenData.[Wk Comp], KaizenData.Benefit, KaizenData.Cost, KaizenData.BC, KaizenData.Savings, IIf([closedstatus]=True,\"Closed\") AS Status\nFROM KaizenData\nWHERE (((IIf([closedstatus]=True,\"Closed\")) Is Not Null));\n</code></pre>\n"}, {"tags": ["string", "vba", "text"], "comments": [{"owner": {"reputation": 1, "user_id": 5194869, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E2-EaudYNY4/AAAAAAAAAAI/AAAAAAAAAJw/ie1KHnl96qQ/photo.jpg?sz=128", "display_name": "Thomas Tian Qiu", "link": "https://stackoverflow.com/users/5194869/thomas-tian-qiu"}, "edited": false, "score": 0, "creation_date": 1438867903, "post_id": 31837985, "comment_id": 51633780, "body": "Well. I mean Excel VBA to read txt/csv files."}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1438811644, "creation_date": 1438811644, "answer_id": 31843494, "question_id": 31837985, "link": "https://stackoverflow.com/questions/31837985/reading-large-text-file-250mb-line-by-line-in-vba/31843494#31843494", "title": "Reading large text file (250MB++) line by line in VBA", "body": "<p>In Access I usually attached a file as a linked table then use SQL to process the rows into another table.</p>\n\n<p>What are you trying to do?  How large is your file.  Are you looking to load data into excel, access or what?</p>\n\n<p>If you are using excel you might consider loading the file into the new PowerPivot data model as this is designed to compress data and give superfast aggregations as it is a columnar database.   You can use DAX.</p>\n\n<p>H</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1438818659, "creation_date": 1438818659, "answer_id": 31844644, "question_id": 31837985, "link": "https://stackoverflow.com/questions/31837985/reading-large-text-file-250mb-line-by-line-in-vba/31844644#31844644", "title": "Reading large text file (250MB++) line by line in VBA", "body": "<p>I risk being downvoted for this if it is wrong but wanted to throw it out there anyway.</p>\n\n<p>I notice there doesn't seem to be much posted about using ADO for this, is it considered slow or bad practice?</p>\n\n<pre><code>Sub TestRead()\n    MsgBox ReadTextFile(\"C:\\Testdir\\\", \"TEST.txt\", 2)\nEnd Sub\n\nFunction ReadTextFile(Path As String, MyFile As String, RowNum As Long)\nDim conn As New ADODB.Connection\nDim rs As New ADODB.Recordset\nDim adcomm As New ADODB.Command\n    conn.Open \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; Path &amp; \";Extended Properties='text;HDR=YES;FMT=Delimited'\"\n    rs.Open \"Select * From \" &amp; MyFile, conn, adOpenStatic, adLockReadOnly, adCmdText\n    rs.AbsolutePosition = RowNum\n    If rs.EOF Then\n        ReadTextFile = \"Row \" &amp; RowNum &amp; \" is higher than the rowcount of the data\"\n    Else\n        ReadTextFile = rs(0)\n    End If\nEnd Function\n</code></pre>\n\n<p>test.txt file:</p>\n\n<pre><code>My Header\nThis text file is for testing ADO reading\nThis is a rather long line of text in comparison to the other lines of text in this text file\nShort line\n</code></pre>\n\n<p>Schema.ini file:</p>\n\n<pre><code>[TEST.txt]\nFormat=FixedLength\n\nCol1=Column1 Text Width 999\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5194869, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-E2-EaudYNY4/AAAAAAAAAAI/AAAAAAAAAJw/ie1KHnl96qQ/photo.jpg?sz=128", "display_name": "Thomas Tian Qiu", "link": "https://stackoverflow.com/users/5194869/thomas-tian-qiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2507, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1462365083, "creation_date": 1438791956, "last_edit_date": 1495542703, "question_id": 31837985, "link": "https://stackoverflow.com/questions/31837985/reading-large-text-file-250mb-line-by-line-in-vba", "title": "Reading large text file (250MB++) line by line in VBA", "body": "<p>Inspired by the post \"<a href=\"https://stackoverflow.com/questions/1376756/superfast-way-to-read-large-files-line-by-line-in-vba-please-critique\">Superfast way to read large files line-by-line in VBA. Please critique</a>\", I'm experimenting the three methods. But the \"superfast\" method using Get cannot handle files larger than 250MB, because the Space(myFileLen) is subject to the max length of String in VBA. Based on my test, the max length of a string in VBA is 263,749,613, which is roughly 251 MB. And the other two methods are really running slow. Currenly I guess I could only go for the Line Input method. So, dear friends, could you advise how to handle such a big file in VBA? Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438792674, "post_id": 31837935, "comment_id": 51597881, "body": "What is the value say in Col A and in Col B?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438792767, "post_id": 31837935, "comment_id": 51597958, "body": "open the excel file and see what is the value say in row 2 so A2 and B2?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2097371"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438792807, "post_id": 31837935, "comment_id": 51597988, "body": "<a href=\"https://www.mbopartners.com/documents/10186/41474/calculator.jpg\" rel=\"nofollow noreferrer\">mbopartners.com/documents/10186/41474/calculator.jpg</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2097371"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438792819, "post_id": 31837935, "comment_id": 51598001, "body": "That is for both row 2 A2 and B2"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438792934, "post_id": 31837935, "comment_id": 51598070, "body": "you can&#39;t have the pic name as hyperlink as &quot;/&quot; is not a valid charater for a file name. You have to extract &quot;calculator.jpg&quot; from col A and then use it in the code"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438793205, "post_id": 31837935, "comment_id": 51598237, "body": "See the answer that I posted"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1438793193, "creation_date": 1438793193, "answer_id": 31838375, "question_id": 31837935, "link": "https://stackoverflow.com/questions/31837935/excel-downloading-pictures-from-hyperlink/31838375#31838375", "title": "Excel downloading pictures from hyperlink", "body": "<blockquote>\n  <p>However, I would like the picture name to be the hyperlink I am using to download the images, aka something like www.hyperlink.com/calculator.jpg</p>\n</blockquote>\n\n<p>Like I said in the comments above, \"You can't have the pic name as hyperlink as \"/\" is not a valid character for a file name. You have to extract \"calculator.jpg\" from col A and then use it in the code\"</p>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function URLDownloadToFile Lib \"urlmon\" _\nAlias \"URLDownloadToFileA\" (ByVal pCaller As Long, _\nByVal szURL As String, ByVal szFileName As String, _\nByVal dwReserved As Long, ByVal lpfnCB As Long) As Long\n\nDim Ret As Long\n\n'~~&gt; This is where the images will be saved. Change as applicable\nConst FolderName As String = \"D:\\Temp\\\"\n\nSub Sample()\n    Dim ws As Worksheet\n    Dim LastRow As Long, i As Long\n    Dim strPath As String\n    Dim MyAr\n\n    '~~&gt; Name of the sheet which has the list\n    Set ws = Sheets(\"Sheet1\")\n\n    LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 2 To LastRow '&lt;~~ 2 because row 1 has headers\n        MyAr = Split(ws.Range(\"A\" &amp; i).Value, \"/\")\n\n        '~~&gt; C:\\Temp\\Calculator.jpg\n        strPath = FolderName &amp; MyAr(UBound(MyAr))\n\n        Ret = URLDownloadToFile(0, ws.Range(\"B\" &amp; i).Value, strPath, 0, 0)\n\n        If Ret = 0 Then\n            ws.Range(\"C\" &amp; i).Value = \"File successfully downloaded\"\n        Else\n            ws.Range(\"C\" &amp; i).Value = \"Unable to download the file\"\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2097371"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438793193, "creation_date": 1438791829, "question_id": 31837935, "link": "https://stackoverflow.com/questions/31837935/excel-downloading-pictures-from-hyperlink", "title": "Excel downloading pictures from hyperlink", "body": "<p>I am currently using this code using the developer console to try to mass download all of the images off the hyperlinks I have in my excel document.  </p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function URLDownloadToFile Lib \"urlmon\" _\nAlias \"URLDownloadToFileA\" (ByVal pCaller As Long, _\nByVal szURL As String, ByVal szFileName As String, _\nByVal dwReserved As Long, ByVal lpfnCB As Long) As Long\n\nDim Ret As Long\n\n'~~&gt; This is where the images will be saved. Change as applicable\nConst FolderName As String = \"C:\\Temp\\\"\n\nSub Sample()\n    Dim ws As Worksheet\n    Dim LastRow As Long, i As Long\n    Dim strPath As String\n\n    '~~&gt; Name of the sheet which has the list\n    Set ws = Sheets(\"Sheet1\")\n\n    LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    For i = 2 To LastRow '&lt;~~ 2 because row 1 has headers\n        strPath = FolderName &amp; ws.Range(\"A\" &amp; i).Value &amp; \".jpg\"\n\n        Ret = URLDownloadToFile(0, ws.Range(\"B\" &amp; i).Value, strPath, 0, 0)\n\n        If Ret = 0 Then\n            ws.Range(\"C\" &amp; i).Value = \"File successfully downloaded\"\n        Else\n            ws.Range(\"C\" &amp; i).Value = \"Unable to download the file\"\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>It seems that it will download the images if the pic name column I have in column A is something like this - \"calculator.jpg\"  </p>\n\n<p>However, I would like the picture name to be the hyperlink I am using to download the images, aka something like www.hyperlink.com/calculator.jpg</p>\n\n<p>My code seems to not download the images when the hyperlink is in the picture name column, even though it does print in column C \"download successful.\"  </p>\n\n<p>If someone could help me I would really appreciate it!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1438792707, "post_id": 31837809, "comment_id": 51597912, "body": "Does your code compile properly if you do something with the value returned by <code>UBound</code>, perhaps like this?  <code>MsgBox UBound(Key, 1)</code>"}, {"owner": {"reputation": 23, "user_id": 5193110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e34c387be6f9b40672e739fd2fb125?s=128&d=identicon&r=PG&f=1", "display_name": "jbebar", "link": "https://stackoverflow.com/users/5193110/jbebar"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1438846049, "post_id": 31837809, "comment_id": 51619258, "body": "Yes it works like that thanks :) HansUp"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5193110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e34c387be6f9b40672e739fd2fb125?s=128&d=identicon&r=PG&f=1", "display_name": "jbebar", "link": "https://stackoverflow.com/users/5193110/jbebar"}, "edited": false, "score": 0, "creation_date": 1438845955, "post_id": 31838191, "comment_id": 51619198, "body": "Thank you MatthewD, as soon as I put the &quot;=&quot; in front of the Ubound the compiler eventually recognised it."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 5, "last_activity_date": 1438824650, "last_edit_date": 1438824650, "creation_date": 1438792636, "answer_id": 31838191, "question_id": 31837809, "link": "https://stackoverflow.com/questions/31837809/i-cant-use-the-ubound-function-in-vba-access-seems-like-its-not-recognised/31838191#31838191", "title": "I can&#39;t use the UBound() function in VBA Access. Seems like it&#39;s not recognised", "body": "<p>It is a function that you need to assign it's return to something.</p>\n\n<pre><code>Dim i As Integer\ni = UBound(Key, 1)\n</code></pre>\n\n<p>You can also use it's return as a variable</p>\n\n<pre><code>For i = 1 to UBound(Key, 1)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5193110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e34c387be6f9b40672e739fd2fb125?s=128&d=identicon&r=PG&f=1", "display_name": "jbebar", "link": "https://stackoverflow.com/users/5193110/jbebar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 0, "accepted_answer_id": 31838191, "answer_count": 1, "score": 2, "last_activity_date": 1438824650, "creation_date": 1438791477, "question_id": 31837809, "link": "https://stackoverflow.com/questions/31837809/i-cant-use-the-ubound-function-in-vba-access-seems-like-its-not-recognised", "title": "I can&#39;t use the UBound() function in VBA Access. Seems like it&#39;s not recognised", "body": "<p>I work on access 2013 and I have a problem using UBound(). The compiler doesn't recognise the function. Maybe there is a specific library this function is from, but it wasn't mentionned on microsoft website.\nHere is the code I used :</p>\n\n<pre><code>Dim Key(2)  As String\n\nKey(0) = \"0\"\nKey(1) = \"1\"\nKey(2) = \"2\"\n\nUBound(Key,1)\n</code></pre>\n\n<p>Does anyone has the same issue?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "reference", "project"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1438792763, "post_id": 31837764, "comment_id": 51597955, "body": "See here.  <a href=\"http://stackoverflow.com/questions/9879825/how-to-add-a-reference-programmatically-in-excel-vba\" title=\"how to add a reference programmatically in excel vba\">stackoverflow.com/questions/9879825/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 0, "last_activity_date": 1438798543, "last_edit_date": 1438798543, "creation_date": 1438798228, "answer_id": 31839827, "question_id": 31837764, "link": "https://stackoverflow.com/questions/31837764/adding-reference-to-vba/31839827#31839827", "title": "Adding reference to VBA", "body": "<p><code>VBAProject</code> is actually a special type of library, not a variable type. If you hit <code>F2</code> to bring up the Object Browser, you can select it from the library dropdown. So you can't create variables of type <code>VBAProject</code>. However, it's not necessary to, nor for <code>ThisWorkbook</code>, unless you just want a shorter alias. Just use the workbook's <code>VBProject</code> property to gain access to the current project instance and add/remove components. Your code could be simplified to:</p>\n\n<pre><code>Sub tester()\n\n    Dim SolverPath As String\n    SolverPath = Application.LibraryPath &amp; \"\\SOLVER\\SOLVER.XLA\"\n\n    ThisWorkbook.VBProject.References.AddFromFile SolverPath\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438798543, "creation_date": 1438791395, "question_id": 31837764, "link": "https://stackoverflow.com/questions/31837764/adding-reference-to-vba", "title": "Adding reference to VBA", "body": "<p>I am trying to automatically add a reference while running a sub. \nBut I get <strong>\"User defined-type not defined</strong>\" for <strong>project As VBAProject</strong>\nWhat's wrong? </p>\n\n<pre><code>  Sub tester()\n\n    Dim SolverPath As String\n    SolverPath = Application.LibraryPath &amp; \"\\SOLVER\\SOLVER.XLA\"\n\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n\n    Dim project As VBAProject\n    project = wb.VBProject\n\n    wb.project.References.AddFromFile SolverPath\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "switch-statement"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1438789637, "post_id": 31837102, "comment_id": 51595920, "body": "boolean? (need more chars..XD)"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1438790495, "post_id": 31837102, "comment_id": 51596509, "body": "This type of toggle is usually referred to as a flag. The flag is usually a boolean value (i.e. 0 or 1; which can also be referred to as FALSE, TRUE or OFF, ON)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1438790561, "post_id": 31837102, "comment_id": 51596553, "body": "are you referring to conditional compilation based on mode (#If SIMTYPE_KEY = 1 Then ... #Else ... #End If)?"}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1438793215, "post_id": 31837102, "comment_id": 51598249, "body": "Flag is the word I was looking for. Thanks. When would you use the word &quot;key&quot;? Assuming there were 3 or more toggles, then they couldn&#39;t be referred to as boolean values anymore could they?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1438796553, "post_id": 31837102, "comment_id": 51600111, "body": "I usually use a Boolean flag when the state can be turned &quot;on or off&quot;. For example, <code>IS_ADMIN</code> can be used to indicate whether a user is an admin or not an admin. In your case, where you are using different simulation types, I may possibly stick with an <code>Integer</code>, especially if I can foresee a situation where you&#39;d use more than 2 states at some point in the future."}, {"owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "edited": false, "score": 0, "creation_date": 1438797625, "post_id": 31837102, "comment_id": 51600758, "body": "Thanks, good advice. In this case, the constants assigned with these integer values would be called what?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1438801262, "last_edit_date": 1525816189, "creation_date": 1438801262, "answer_id": 31840737, "question_id": 31837102, "link": "https://stackoverflow.com/questions/31837102/what-are-public-constants-named-which-toggle-between-values/31840737#31840737", "title": "What are public constants named which toggle between values?", "body": "<p>You might be looking for an Enum</p>\n\n<pre><code>Public Enum SIMTYPE_KEY\n    A = 1\n    B = 2\n    C = 3\nEnd Enum\n</code></pre>\n\n<p>now you can use (e.g)</p>\n\n<pre><code>Dim stk as SIMTYPE_KEY\nstk = SIMTYPE_KEY.B\n</code></pre>\n\n<p><a href=\"http://www.cpearson.com/excel/Enums.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/Enums.aspx</a></p>\n"}], "owner": {"reputation": 2266, "user_id": 2566283, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/d31870a244e4ccc088e541142ad4ebc2?s=128&d=identicon&r=PG", "display_name": "teepee", "link": "https://stackoverflow.com/users/2566283/teepee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438801262, "creation_date": 1438789541, "question_id": 31837102, "link": "https://stackoverflow.com/questions/31837102/what-are-public-constants-named-which-toggle-between-values", "title": "What are public constants named which toggle between values?", "body": "<p>My program is set up to function in two different modes. I have accomplished this by setting a toggle value and some public constants like this:</p>\n\n<pre><code>Public SIMTYPE_KEY As Integer\nPublic Const SIMTYPE_A As Integer = 1\nPublic Const SIMTYPE_B As Integer = 2\n</code></pre>\n\n<p>Using a userform, I have the user set <strong>SIMTYPE_KEY</strong> as either <strong>SIMTYPE_A</strong> or <strong>SIMTYPE_B</strong>. Almost all functions run a check on SIMTYPE_KEY (using <strong>Select Case</strong> statements) to know which simulation mode the program should run in. What is the terminology for this type of set up? And what would you call each of these constants and this toggled value?</p>\n"}, {"tags": ["excel", "user-defined-functions", "vba"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1438790001, "post_id": 31837081, "comment_id": 51596154, "body": "What other code do you have in the WB?"}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 1, "creation_date": 1438790361, "post_id": 31837081, "comment_id": 51596412, "body": "My guess would be there is a volatile formula in some other cell causing a recalculation of the workbook, and it is throwing this odd error out.  <a href=\"http://www.decisionmodels.com/calcsecretsi.htm\" rel=\"nofollow noreferrer\">decisionmodels.com/calcsecretsi.htm</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1438790402, "post_id": 31837081, "comment_id": 51596437, "body": "@Raystafarian - it&#39;s a few other <code>Sub</code>s and one or two other UDFs.  What&#39;s the best way to post them all? If I added to OP, it might just clutter everything...but I will if it&#39;s okay..."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 1, "creation_date": 1438790485, "post_id": 31837081, "comment_id": 51596497, "body": "As long as none of them run on change events then we don&#39;t need them"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 0, "creation_date": 1438790501, "post_id": 31837081, "comment_id": 51596512, "body": "@legendjr - is there any way to track down where the volatile formulas are? I&#39;ll look through that link you posted, thanks!  I know about Volatility in Excel, and even tried adding <code>Application.Volatile (False)</code> to my UDFs, but that didn&#39;t stop the refreshing."}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 1, "creation_date": 1438790671, "post_id": 31837081, "comment_id": 51596622, "body": "Only way I know is to use find and search the entire workbook for those formulas in that article.  Good hunting!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438790946, "post_id": 31837081, "comment_id": 51596801, "body": "The only thing I found was an <code>Indirect</code>.  However, it&#39;s in a &quot;placeholder&quot; cell, which stores my formula.  This is because as I use it, I paste the value it resolves to, but want to keep the formula somewhere so I can just drop it in if needed...Ah! I&#39;ll just add <code>&#39;</code> before the placeholder, to see if that helps."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438791546, "post_id": 31837081, "comment_id": 51597168, "body": "Hm, removed the <code>indirect</code> references, still get the refreshing &quot;error&quot;.  Also, what would explain my non UDF function to return <code>#Value</code>? No cell in that formula refers to a cell with a UDF.  It seems like this happens especially when I delete a chart from a separate sheet?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1438815580, "post_id": 31837081, "comment_id": 51609856, "body": "Move your function to a new workbook (alone) and see what happens."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1438961703, "post_id": 31837081, "comment_id": 51680579, "body": "@Raystafarian - I moved it to another workbook and I can&#39;t seem to get it to reproduce the error I&#39;m getting in my other WS.  I&#39;ll have a look through my UDFs and see what could be going on."}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438792813, "creation_date": 1438789494, "last_edit_date": 1531161705, "question_id": 31837081, "link": "https://stackoverflow.com/questions/31837081/udf-not-always-working-gets-refreshed-to-empty-cell", "title": "UDF not always working - gets refreshed to [empty cell]", "body": "<p>I have the below UDF saved in a module in a workbook:</p>\n\n<pre><code>Function sumAbove(cel As Range) As Double\nDim firstCell As Long\nDim i As Integer\n\n'Application.Volatile '(False)\nfirstCell = cel.Row\n\nWhile Not cel.Offset((cel.Row - firstCell) * -1, 0).NumberFormat = \"0.00%\"\n    firstCell = firstCell - 1\nWend\nsumAbove = WorksheetFunction.Sum(Range(Cells(firstCell + 1, cel.Column), cel))\n\nActiveSheet.EnableCalculation = True\nEnd Function\n</code></pre>\n\n<p>The function does work properly, however my issue is that the workbook somehow seems to \"remove\" the <code>sumAbove</code> from the worksheet.  I.e. I put <code>=SumAbove(b4)</code> and this calculates to <code>68</code>.  Great!  Then if I go into another sheet in the spreadsheet, add a chart, do things, etc. then go back, the cell will show <code></code> or <code>#Value!</code>   What's going on, why might it be doing this?</p>\n\n<p>My workbook calculation is set to Auto, I added that <code>.EnableCalculation</code> which should help.  </p>\n\n<p>What's a little weird too, is that when the above UDF doesn't calculate properly, the following formula gives a <code>#Value</code> error:\n<code>=IF(AND(A69&lt;&gt;\"\",D70&lt;&gt;\"\"),TEXT(A69,\"m/dd/yyyy\")&amp;\" Average Row\",\"\")</code>  even though nothing in that formula is related to the <code>sumAbove</code> cell.  I have to go to the cell, hit <code>F2</code>, <code>Enter</code> and then it resolves to the right output.  </p>\n\n<p>What is possibly going on in my workbook?  Thanks for any ideas/advice!</p>\n\n<p>Edit: Just to note - I do have two other UDFs, but none run on worksheet change or cell changes, they're just \"regular\" functions.  I've added <code>Application.Volatile (false)</code> to my UDFs, which doesn't change anything.  As @legendjr points out, I think it's due to Volatility somewhere...but the data in my page isn't changing at all, so even if a function was volatile, wouldn't the function just reset to its value? </p>\n\n<p>Edit2: Maybe worth noting - when I am able to get <code>sumAbove</code> to work, only the cell I clicked into refreshed to the value...the other <code>sumAbove</code> cells just stay <code>#Value</code></p>\n"}, {"tags": ["vba", "excel", "output"], "comments": [{"owner": {"reputation": 35385, "user_id": 173773, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e09251f97ace7198ecf804f79b602885?s=128&d=identicon&r=PG", "display_name": "blueberryfields", "link": "https://stackoverflow.com/users/173773/blueberryfields"}, "edited": false, "score": 0, "creation_date": 1438789617, "post_id": 31837076, "comment_id": 51595906, "body": "please provide a full snippet of the code, showing how you open/close both files"}, {"owner": {"reputation": 3630, "user_id": 1281120, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/13de5ad72b8b2b9afc3ccd9adca7d57d?s=128&d=identicon&r=PG", "display_name": "Arturas M", "link": "https://stackoverflow.com/users/1281120/arturas-m"}, "reply_to_user": {"reputation": 35385, "user_id": 173773, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e09251f97ace7198ecf804f79b602885?s=128&d=identicon&r=PG", "display_name": "blueberryfields", "link": "https://stackoverflow.com/users/173773/blueberryfields"}, "edited": false, "score": 0, "creation_date": 1438790129, "post_id": 31837076, "comment_id": 51596247, "body": "@blueberryfields alright, it&#39;s there now."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 1, "creation_date": 1438790668, "post_id": 31837076, "comment_id": 51596620, "body": "It looks like insertOutputFile and deleteOutputFile are the same --- both are &quot;/something&quot; + ... . Shouldn&#39;t there be a difference so you get two different file names?"}, {"owner": {"reputation": 3630, "user_id": 1281120, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/13de5ad72b8b2b9afc3ccd9adca7d57d?s=128&d=identicon&r=PG", "display_name": "Arturas M", "link": "https://stackoverflow.com/users/1281120/arturas-m"}, "reply_to_user": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1438790960, "post_id": 31837076, "comment_id": 51596812, "body": "@xidgel Yes! Exactly! That was the problem, thank you very much! Indeed, it&#39;s one of those errors where you could probably sit alone for days, never noticing the problem while somebody else sees it. I had forgotten to change the insert part to delete there... Thanks again, you are the hero today. :)"}], "owner": {"reputation": 3630, "user_id": 1281120, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/13de5ad72b8b2b9afc3ccd9adca7d57d?s=128&d=identicon&r=PG", "display_name": "Arturas M", "link": "https://stackoverflow.com/users/1281120/arturas-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1083, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1438790068, "creation_date": 1438789481, "last_edit_date": 1438790068, "question_id": 31837076, "link": "https://stackoverflow.com/questions/31837076/how-to-open-multiple-files-for-output-in-vba", "title": "How to open multiple files for output in VBA?", "body": "<p>How to open multiple files for output in VBA? If I use the </p>\n\n<blockquote>\n  <p>Open OutFile For Output As outputFile</p>\n</blockquote>\n\n<p>before closing the file that I opened before, I get the </p>\n\n<blockquote>\n  <p>Run-time error '55':</p>\n  \n  <p>File already open.</p>\n</blockquote>\n\n<p>But I need to write to both files simultaneously... Otherwise I'd need to have some kind of a buffer before writing to the file, which I have no idea how to create as I am not a VBA developer...</p>\n\n<p>Edit:</p>\n\n<pre><code>' insert file\n    insertOutputFile = ThisWorkbook.Path &amp; (\"/something\" + \".insert_emergency\" + emergencyNumber + \"_\" + getConnectionAsString(connection) + fileExtension)\n    'set and open file for output\n    insertFile = FreeFile()\n    Open insertOutputFile For Output As insertFile\n\n\n    ' delete file\n    deleteOutputFile = ThisWorkbook.Path &amp; (\"/something\" + \".insert_emergency\" + emergencyNumber + \"_\" + getConnectionAsString(connection) + fileExtension)\n    'set and open file for output\n    deleteFile = FreeFile()\n    Open deleteOutputFile For Output As deleteFile\n\n\n    ' do logic with both files simultaneously\n\n    'save\n    Close #deleteFile\n    Close #insertFile\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 95, "user_id": 5194744, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152971582513038/picture?type=large", "display_name": "Juan Sebasti&#225;n Calder&#243;n", "link": "https://stackoverflow.com/users/5194744/juan-sebasti%c3%a1n-calder%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1438789261, "post_id": 31836945, "comment_id": 51595672, "body": "I missed this:   TableInfoProduit = myrange.Value"}, {"owner": {"reputation": 733, "user_id": 5090061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0606664fdb307c96c1c39066af9386be?s=128&d=identicon&r=PG&f=1", "display_name": "KFichter", "link": "https://stackoverflow.com/users/5090061/kfichter"}, "edited": false, "score": 0, "creation_date": 1438795137, "post_id": 31836945, "comment_id": 51599393, "body": "Could you post more of your code? It&#39;s hard to see what exactly is happening without it."}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 1, "last_activity_date": 1438813335, "last_edit_date": 1495540282, "creation_date": 1438812491, "answer_id": 31843679, "question_id": 31836945, "link": "https://stackoverflow.com/questions/31836945/unionrange-value-fails-vba/31843679#31843679", "title": "Union(range) value fails vba", "body": "<p>A couple of things. Your code </p>\n\n<pre><code>    With WBInfoProduit.Sheets(1)\n        Set myrange = Union( _\n                  ActiveSheet.Range(Cells(1, ProdNameCol), Cells(Rows, ProdNameCol)) _\n                , ActiveSheet.Range(Cells(1, FundNameCol), Cells(Rows, FundNameCol)) _\n                , ActiveSheet.Range(Cells(1, CompagnieCol), Cells(Rows, CompagnieCol)) _\n                )\n    End With\n</code></pre>\n\n<p>Be aware that every \"Cells\" is referring to the cells on the activesheet.\nSo </p>\n\n<p>With WBInfoProduit.Sheets(1) </p>\n\n<p>does nothing!</p>\n\n<p>I tried this:</p>\n\n<pre><code>Sub xxx()\n\n\n    Dim myrange As Range\n\n    With ActiveSheet\n        Set myrange = Union( _\n                  .Range(.Cells(1,  5), .Cells(100,  5)) _\n                , .Range(.Cells(1, 10), .Cells(100, 10)) _\n                , .Range(.Cells(1, 20), .Cells(100, 20)) _\n                )\n    End With\n\n    Debug.Print myrange.Address\n\nEnd Sub\n</code></pre>\n\n<p>It resulted in this output</p>\n\n<pre><code> $E$1:$E$100,$J$1:$J$100,$T$1:$T$100\n</code></pre>\n\n<p>So as long as ProdNameCol, FundNameCol, CompagnieCol in your code are set to different values it should work but possibly only on the active sheet.</p>\n\n<p>HOWEVER,</p>\n\n<p>If you are trying to assign ranges to an array you need to be aware of range areas!</p>\n\n<p>See the code below which will help</p>\n\n<pre><code>Sub xxx()\n\n\n    Dim myrange As Range\n    Dim MyArray() As Variant\n\n    Dim MyArray1() As Variant\n    Dim MyArray2() As Variant\n    Dim MyArray3() As Variant\n    Dim MyArray4() As Variant\n\n    With ActiveSheet\n        Set myrange = Union( _\n                  .Range(.Cells(1,  5), .Cells(100,  5)) _\n                , .Range(.Cells(1, 10), .Cells(100, 10)) _\n                , .Range(.Cells(1, 20), .Cells(100, 20)) _\n                )\n    End With\n\n\n    Debug.Print myrange.Address\n    Debug.Print myrange.Areas(1).Address\n    Debug.Print myrange.Areas(2).Address\n    Debug.Print myrange.Areas(3).Address\n\n    MyArray = myrange\n    MyArray1 = myrange.Areas(1)\n    MyArray2 = myrange.Areas(2)\n    MyArray3 = myrange.Areas(3)\n\n\n    ' MyArray4 = Union(MyArray1, MyArray2, MyArray3)\n\nEnd Sub\n</code></pre>\n\n<p>The MyArray4 line will nto work see <a href=\"https://stackoverflow.com/questions/1588913/how-do-i-merge-two-arrays-in-vba\">here</a> for help with this!</p>\n"}], "owner": {"reputation": 95, "user_id": 5194744, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152971582513038/picture?type=large", "display_name": "Juan Sebasti&#225;n Calder&#243;n", "link": "https://stackoverflow.com/users/5194744/juan-sebasti%c3%a1n-calder%c3%b3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 0, "accepted_answer_id": 31843679, "answer_count": 1, "score": 0, "last_activity_date": 1438813335, "creation_date": 1438789146, "question_id": 31836945, "link": "https://stackoverflow.com/questions/31836945/unionrange-value-fails-vba", "title": "Union(range) value fails vba", "body": "<p>I'm trying to set an array to the values of non consecutive arrays.</p>\n\n<p>My code</p>\n\n<pre><code>With WBInfoProduit.Sheets(1)\nSet myrange = Union(ActiveSheet.Range(Cells(1, ProdNameCol), Cells(rows, ProdNameCol)), ActiveSheet.Range(Cells(1, FundNameCol), Cells(rows, FundNameCol)), ActiveSheet.Range(Cells(1, CompagnieCol), Cells(rows, CompagnieCol)))\n</code></pre>\n\n<p>End With\nSo the array is supossed to have 3 columns , but it only has 2 when I check with the debbuger.</p>\n\n<p>Thank you guys.</p>\n"}, {"tags": ["vba", "excel", "input"], "comments": [{"owner": {"reputation": 11, "user_id": 5194703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-21v-gyqO6fU/AAAAAAAAAAI/AAAAAAAAALw/KPm_6Hevk3k/photo.jpg?sz=128", "display_name": "Karol Kowalczyk", "link": "https://stackoverflow.com/users/5194703/karol-kowalczyk"}, "reply_to_user": {"reputation": 2896, "user_id": 5031339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82ce3852cc31d052ce2568e3a777875a?s=128&d=identicon&r=PG", "display_name": "NightShadeQueen", "link": "https://stackoverflow.com/users/5031339/nightshadequeen"}, "edited": false, "score": 0, "creation_date": 1438789280, "post_id": 31836906, "comment_id": 51595690, "body": "unfortunately since im using a company work desk in the office i can not add pictures online due to confidentiality"}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 0, "creation_date": 1438789636, "post_id": 31836906, "comment_id": 51595919, "body": "It looks like username.value is set to &quot;&quot; when you initialize the form, but I don&#39;t see it get saved with a value at any other point.  I would assume it should go in the CommandButton1_Click"}, {"owner": {"reputation": 11, "user_id": 5194703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-21v-gyqO6fU/AAAAAAAAAAI/AAAAAAAAALw/KPm_6Hevk3k/photo.jpg?sz=128", "display_name": "Karol Kowalczyk", "link": "https://stackoverflow.com/users/5194703/karol-kowalczyk"}, "reply_to_user": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 0, "creation_date": 1438789740, "post_id": 31836906, "comment_id": 51595980, "body": "comand button 1 is just submit"}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 0, "creation_date": 1438790001, "post_id": 31836906, "comment_id": 51596155, "body": "Ok.  To me, I just don&#39;t see where Username.Value gets updated.  It looks like it is set to &quot;&quot; in initialize.  It likely needs to be saved from that user form before you run the macro."}, {"owner": {"reputation": 11, "user_id": 5194703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-21v-gyqO6fU/AAAAAAAAAAI/AAAAAAAAALw/KPm_6Hevk3k/photo.jpg?sz=128", "display_name": "Karol Kowalczyk", "link": "https://stackoverflow.com/users/5194703/karol-kowalczyk"}, "reply_to_user": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 0, "creation_date": 1438790253, "post_id": 31836906, "comment_id": 51596332, "body": "I dont quite understand what you mean. Maybe this will help The username is already on the spreadsheet and all the holiday entry needs to do is find the username which is does but then all i need to do is output the holiday dates into the same row. Where the calendar starts from column K. and every cell accounts for one day so cell K3 is 01/01/2015 and L3 is 02/01/2015 and so on till the end of the 2015 calendar"}, {"owner": {"reputation": 11, "user_id": 5194703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-21v-gyqO6fU/AAAAAAAAAAI/AAAAAAAAALw/KPm_6Hevk3k/photo.jpg?sz=128", "display_name": "Karol Kowalczyk", "link": "https://stackoverflow.com/users/5194703/karol-kowalczyk"}, "reply_to_user": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 0, "creation_date": 1438790283, "post_id": 31836906, "comment_id": 51596363, "body": "im pretty basic with vba this is the first thing i have ever done so any technical stuff could you explain to me first"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5194703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-21v-gyqO6fU/AAAAAAAAAAI/AAAAAAAAALw/KPm_6Hevk3k/photo.jpg?sz=128", "display_name": "Karol Kowalczyk", "link": "https://stackoverflow.com/users/5194703/karol-kowalczyk"}, "edited": false, "score": 0, "creation_date": 1438791335, "post_id": 31837486, "comment_id": 51597056, "body": "code in itself works it just doesnt find the start date and put &quot;AL&quot; or &quot;WFH&quot; into it it just puts it in ROW F whereas the calendar in itself starts from ROW K if it makes it easier could you give me your email and i could send over a screenshot of what i currently have. Im going out of the office atm so i could send it tomorrow"}, {"owner": {"reputation": 11, "user_id": 5194703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-21v-gyqO6fU/AAAAAAAAAAI/AAAAAAAAALw/KPm_6Hevk3k/photo.jpg?sz=128", "display_name": "Karol Kowalczyk", "link": "https://stackoverflow.com/users/5194703/karol-kowalczyk"}, "edited": false, "score": 0, "creation_date": 1438791373, "post_id": 31837486, "comment_id": 51597074, "body": "Cells(NextRow, 5).Value = (EndDate.Value) + 1 - (StartDate.Value) is ment to calculate the amount the person is going on holiday for so i was wandering if i can use that value to input the same amount of &quot;AL&quot; or &quot;WFH&quot; into the calendar accordingly"}], "tags": [], "owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1438790593, "creation_date": 1438790593, "answer_id": 31837486, "question_id": 31836906, "link": "https://stackoverflow.com/questions/31836906/vba-issue-with-finding-cells/31837486#31837486", "title": "VBA issue with finding cells", "body": "<p>Based on our comments from above, I would like if you could give this code snippet a try first and let me know if it still isn't working.</p>\n\n<pre><code>Private Sub ComboBox2_Change()\n\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nDim emptyRow As Long\n\n'Make Sheet1 active\n'Holiday Calendar.Activate\n\n'Determine emptyRow\n'ActiveCell = (A5)\n'emptyRow = WorksheetFunction.CountA(Range(\"Employees\")) + 1\n\nUsername.Value = UsernameTextBox.Value\nNextRow = 5\nDo Until Sheets(\"Holiday Calendar\").Cells(NextRow, 4) = Username.Value\n    NextRow = NextRow + 1\nLoop\n\n'Transfer information\n\nCells(NextRow, 6).Value = TypeOfLeave.Value\nCells(NextRow, 5).Value = (EndDate.Value) + 1 - (StartDate.Value)\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nCall UserForm_Initialize\nEnd Sub\n\nPrivate Sub CommandButton3_Click()\nUnload Me\nEnd Sub\n\n\n\n\nPrivate Sub DTPicker1_CallbackKeyDown(ByVal KeyCode As Integer, ByVal Shift As \nInteger, ByVal CallbackField As String, CallbackDate As Date)\n\nEnd Sub\n\nPrivate Sub UserForm_Click()\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n'Empty UsernameTextBox\nUsername.Value = \"\"\n\n'Empty TypeOfLeave ComboBox\nTypeOfLeave.Clear\n\n'Fill TypeOfLeaveComboBox\n    With TypeOfLeave\n    .AddItem \"AL - Anual Leave\"\n    .AddItem \"WFH - Work From Home\"\n    '.AddItem \"\"\nEnd With\n\n'Set Focus on UsernameTextBox\nUsername.SetFocus\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5194703, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-21v-gyqO6fU/AAAAAAAAAAI/AAAAAAAAALw/KPm_6Hevk3k/photo.jpg?sz=128", "display_name": "Karol Kowalczyk", "link": "https://stackoverflow.com/users/5194703/karol-kowalczyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439021822, "creation_date": 1438789046, "last_edit_date": 1439021822, "question_id": 31836906, "link": "https://stackoverflow.com/questions/31836906/vba-issue-with-finding-cells", "title": "VBA issue with finding cells", "body": "<p>So I've been working on a Holiday calendar for employees and I've got a problem which I cannot seem to find a solution for. </p>\n\n<p>I have two buttons which are assigned to a VBA script and I'm having an issue with a holiday entry for it. I can't seem to be able to select a specific cell from the user form inputs to output the data. The code looks like this:</p>\n\n<pre><code>Private Sub ComboBox2_Change()\n\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nDim emptyRow As Long\n\n'Make Sheet1 active\n'Holiday Calendar.Activate\n\n'Determine emptyRow\n'ActiveCell = (A5)\n'emptyRow = WorksheetFunction.CountA(Range(\"Employees\")) + 1\nNextRow = 5\nDo Until Sheets(\"Holiday Calendar\").Cells(NextRow, 4) = Username.Value\n    NextRow = NextRow + 1\nLoop\n\n'Transfer information\n\nCells(NextRow, 6).Value = TypeOfLeave.Value\nCells(NextRow, 5).Value = (EndDate.Value) + 1 - (StartDate.Value)\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nCall UserForm_Initialize\nEnd Sub\n\nPrivate Sub CommandButton3_Click()\nUnload Me\nEnd Sub\n\n\n\n\nPrivate Sub DTPicker1_CallbackKeyDown(ByVal KeyCode As Integer, ByVal Shift As \nInteger, ByVal CallbackField As String, CallbackDate As Date)\n\nEnd Sub\n\nPrivate Sub UserForm_Click()\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n'Empty UsernameTextBox\nUsername.Value = \"\"\n\n'Empty TypeOfLeave ComboBox\nTypeOfLeave.Clear\n\n'Fill TypeOfLeaveComboBox\n    With TypeOfLeave\n    .AddItem \"AL - Anual Leave\"\n    .AddItem \"WFH - Work From Home\"\n    '.AddItem \"\"\nEnd With\n\n'Set Focus on UsernameTextBox\nUsername.SetFocus\nEnd Sub\n</code></pre>\n\n<p>This is how the code for the whole user form looks. </p>\n\n<p>Now what I need help with is when the user <code>inputs</code> the start and end date of their holiday it will then look for the <code>username</code> within the <code>spreadsheet</code> and place \"<strong>AL-Anual Leave</strong>\" and \"<strong>WFH - Work From Home</strong>\" accordingly in the dates that the user has provided. </p>\n\n<p>So what I need is a piece of code that will find the date within the <code>spreadsheet</code> from the user form and <code>input</code> the values \"<strong>Al</strong>\" or \"<strong>WFH</strong>\"</p>\n\n<p>If any of this is unclear please let me know and ill explain. I tried including pictures but don't have enough reputation so it's much harder. I can send the images in email if needed to explain better.</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5194704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ssWCtxpEajA/AAAAAAAAAAI/AAAAAAAAAHM/bZJyK5JWg9o/photo.jpg?sz=128", "display_name": "user5194704", "link": "https://stackoverflow.com/users/5194704/user5194704"}, "edited": false, "score": 0, "creation_date": 1438789674, "post_id": 31837019, "comment_id": 51595941, "body": "It&#39;s clearing 3 columns of cells several times (I have tons of columns of data). At least that&#39;s what I&#39;m trying to do. The code you posted gave the same error."}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "reply_to_user": {"reputation": 1, "user_id": 5194704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ssWCtxpEajA/AAAAAAAAAAI/AAAAAAAAAHM/bZJyK5JWg9o/photo.jpg?sz=128", "display_name": "user5194704", "link": "https://stackoverflow.com/users/5194704/user5194704"}, "edited": false, "score": 0, "creation_date": 1438789865, "post_id": 31837019, "comment_id": 51596058, "body": "I missed that last offset at the bottom, my mistake.  I tried your code on a new blank workbook where I through some random values in it, and it is working for me.  Does VBA tell you where specifically you&#39;re having this error pop up?"}, {"owner": {"reputation": 1, "user_id": 5194704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ssWCtxpEajA/AAAAAAAAAAI/AAAAAAAAAHM/bZJyK5JWg9o/photo.jpg?sz=128", "display_name": "user5194704", "link": "https://stackoverflow.com/users/5194704/user5194704"}, "edited": false, "score": 0, "creation_date": 1438789937, "post_id": 31837019, "comment_id": 51596107, "body": "It highlights the line Do While ActiveCell.Value &lt;&gt; &quot;&quot;, I&#39;ll try moving the data to a blank workbook. Edit: Blank Workbook didn&#39;t work for me."}, {"owner": {"reputation": 1, "user_id": 5194704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ssWCtxpEajA/AAAAAAAAAAI/AAAAAAAAAHM/bZJyK5JWg9o/photo.jpg?sz=128", "display_name": "user5194704", "link": "https://stackoverflow.com/users/5194704/user5194704"}, "edited": false, "score": 0, "creation_date": 1438790301, "post_id": 31837019, "comment_id": 51596374, "body": "Got it working! I had some non-numerical place holders for data that didn&#39;t exist that i replaced with 0, after that it worked. Thanks for your help!"}], "tags": [], "owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1438789307, "creation_date": 1438789307, "answer_id": 31837019, "question_id": 31836873, "link": "https://stackoverflow.com/questions/31836873/run-time-error-13-type-mismatch-vba/31837019#31837019", "title": "Run time error 13: Type Mismatch (VBA)", "body": "<p>I am not sure why you are using a loop to do something what appears to be just one time. Try this:</p>\n\n<pre><code>Sub Blanker()\n\nSheets(\"Sheet1\").Select\nRange(\"BCF3\").Select\nIf ActiveCell.Value &lt;&gt; vbNullString Then\n    Range(ActiveCell.Offset(0, 0), ActiveCell.Offset(106, 2)).Select\n    Selection.Clear\n    ActiveCell.Offset(0, 6).Select\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5194704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ssWCtxpEajA/AAAAAAAAAAI/AAAAAAAAAHM/bZJyK5JWg9o/photo.jpg?sz=128", "display_name": "user5194704", "link": "https://stackoverflow.com/users/5194704/user5194704"}, "is_accepted": false, "score": 0, "last_activity_date": 1438790383, "creation_date": 1438790383, "answer_id": 31837409, "question_id": 31836873, "link": "https://stackoverflow.com/questions/31836873/run-time-error-13-type-mismatch-vba/31837409#31837409", "title": "Run time error 13: Type Mismatch (VBA)", "body": "<p>The code didn't work with non-numerical values. Specifically #VALUE!. I changed all instances of #VALUE! to 0 and the code worked.</p>\n"}], "owner": {"reputation": 1, "user_id": 5194704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ssWCtxpEajA/AAAAAAAAAAI/AAAAAAAAAHM/bZJyK5JWg9o/photo.jpg?sz=128", "display_name": "user5194704", "link": "https://stackoverflow.com/users/5194704/user5194704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 452, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461149667, "creation_date": 1438788965, "last_edit_date": 1461149667, "question_id": 31836873, "link": "https://stackoverflow.com/questions/31836873/run-time-error-13-type-mismatch-vba", "title": "Run time error 13: Type Mismatch (VBA)", "body": "<p>I'm getting a Run Time Error 13: Type Mismatch every time I run this code. It's supposed to clear three columns of cells, move over the next three columns and then clear another three until it runs out of columns with values. The Error is appearing on the <code>Do While ActiveCell.Value &lt;&gt; \"\"</code> line.</p>\n\n<pre><code>Sub Blanker()\n    Sheets(\"Sheet1\").Select\n    Range(\"BCF3\").Select\n    Do While ActiveCell.Value &lt;&gt; \"\"\n        Range(ActiveCell.Offset(0, 0), ActiveCell.Offset(106, 2)).Select\n        Selection.Clear\n        ActiveCell.Offset(0, 6).Select        \n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007", "tabcontrol"], "answers": [{"tags": [], "owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1438800481, "creation_date": 1438800481, "answer_id": 31840479, "question_id": 31836865, "link": "https://stackoverflow.com/questions/31836865/tab-control-and-field-check-on-form/31840479#31840479", "title": "Tab Control and Field Check on Form", "body": "<p><code>IS NULL</code> is for use in query expressions, from VBA use the <code>IsNull()</code> VBA function.</p>\n\n<pre><code>If Me.TabCtl34.Value = 1 AND IsNull([FORMS]![FORMNAME]![NAME]) Then\n</code></pre>\n\n<p>As you are running this from the form's module you can use <code>Me</code> to refer to the current form-instance:</p>\n\n<pre><code>If Me.TabCtl34.Value = 1 AND IsNull(Me.[NAME]) Then\n</code></pre>\n\n<p>You should also consider that the value may be an empty string, rather than NULL. You can combine both checks using:</p>\n\n<pre><code>If Me.TabCtl34.Value = 1 And Len(Me.[NAME].Value &amp; \"\") = 0 Then\n</code></pre>\n\n<p>Concatenating the empty string \"\" coerces a NULL value to a string.</p>\n\n<p>(It is preferable to explicitly identify the property <code>Value</code> rather than assume it as the default property.)</p>\n"}], "owner": {"reputation": 1010, "user_id": 5017379, "user_type": "registered", "accept_rate": 92, "profile_image": "https://lh4.googleusercontent.com/-NoompVWF3X0/AAAAAAAAAAI/AAAAAAAAG7Y/tzq9_MEr0_s/photo.jpg?sz=128", "display_name": "epv", "link": "https://stackoverflow.com/users/5017379/epv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 31840479, "answer_count": 1, "score": 0, "last_activity_date": 1438800481, "creation_date": 1438788932, "question_id": 31836865, "link": "https://stackoverflow.com/questions/31836865/tab-control-and-field-check-on-form", "title": "Tab Control and Field Check on Form", "body": "<p>MS ACCESS 2007\nVBA CODE BUILDER </p>\n\n<p>I am able to show a MsgBox in VBA code when a Tab is selected with </p>\n\n<pre><code>Private Sub TabCtl34_Change()\nIf Me.TabCtl34.Value = 1 Then 'First Page\nMsgBox \"Hi\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>But I also want to check if the second tab is selected and a field(Name) on the form IS NULL (not on tab), msgbox or cancel event to require Name to be entered before they see the second tab. </p>\n\n<p>When I add in: </p>\n\n<pre><code>Private Sub TabCtl34_Change()\nIf Me.TabCtl34.Value = 1 AND [FORMS]![FORMNAME]![NAME] IS NULL Then \nMsgBox \"Hi\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>It just goes directly to the second tab even if the name is null. How do i write the vba code so it can do what I want?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 1, "creation_date": 1438789180, "post_id": 31836767, "comment_id": 51595620, "body": "In VBA it should just be Format(ws1.Range(&quot;B&quot; &amp; pos), &quot;#,###,##0&quot;) and not FormatNumber.  Give that a try."}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "edited": false, "score": 0, "creation_date": 1438828397, "post_id": 31836767, "comment_id": 51612985, "body": "That is simply not true @legendjr.  <code>FormatNumber</code> is available, supported and useful.  See  <a href=\"https://support.office.com/en-in/article/FormatNumber-Function-91030eab-2887-43d4-9c17-311ab6ebf43b\" rel=\"nofollow noreferrer\">support.office.com/en-in/article/&hellip;</a>"}, {"owner": {"reputation": 286, "user_id": 2988534, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xbVwr.jpg?s=128&g=1", "display_name": "legendjr", "link": "https://stackoverflow.com/users/2988534/legendjr"}, "reply_to_user": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "edited": false, "score": 0, "creation_date": 1438867441, "post_id": 31836767, "comment_id": 51633403, "body": "thanks @joehanna.  I learned something new today."}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "edited": false, "score": 0, "creation_date": 1438891006, "post_id": 31836767, "comment_id": 51648499, "body": "It&#39;s always good to learn something new :-). If my answer below solved your problem, please mark it as accepted for future visitors to this post."}], "answers": [{"tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": false, "score": 0, "last_activity_date": 1438828316, "creation_date": 1438828316, "answer_id": 31845877, "question_id": 31836767, "link": "https://stackoverflow.com/questions/31836767/listview-formatting/31845877#31845877", "title": "Listview formatting", "body": "<p>There is nothing wrong with using <code>FormatNumber</code> in VBA.  Its job is to take your number and apply the locale-based rules for formatting (000's separators etc) as defined in the Regional Settings Number tab.  You can optionally supply the number of decimal places to this function.</p>\n\n<p>Your function call should be simply:-</p>\n\n<pre><code>'Format number according to system locale and ensure zero decimal places\nFormatNumber(ws1.Range(\"B\" &amp; pos), 0)\n</code></pre>\n\n<p>Check this Microsoft Support page out for more information: <a href=\"https://support.office.com/en-in/article/FormatNumber-Function-91030eab-2887-43d4-9c17-311ab6ebf43b\" rel=\"nofollow\">https://support.office.com/en-in/article/FormatNumber-Function-91030eab-2887-43d4-9c17-311ab6ebf43b</a></p>\n"}], "owner": {"reputation": 115, "user_id": 5103111, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/81d8854c847ac9a8976f5edd04294387?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5103111/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 981, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483372066, "creation_date": 1438788658, "last_edit_date": 1531164843, "question_id": 31836767, "link": "https://stackoverflow.com/questions/31836767/listview-formatting", "title": "Listview formatting", "body": "<p>Can some one please advise as to what is wrong in my code. I want to format the amount column (Column B).</p>\n\n<pre><code>ListItems(lv_item).ListSubItems.Add , , FormatNumber(ws1.Range(\"B\" &amp; pos), \"#,###,##0\")\n</code></pre>\n"}, {"tags": ["vba", "excel", "formula"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5194589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46fbb23972c9df26d833f5808db088df?s=128&d=identicon&r=PG&f=1", "display_name": "K Hill", "link": "https://stackoverflow.com/users/5194589/k-hill"}, "edited": false, "score": 0, "creation_date": 1438790411, "post_id": 31836687, "comment_id": 51596445, "body": "Thank you for your quick response. I did post an answer as well that works. Again - I should have researched more."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1438820300, "post_id": 31836687, "comment_id": 51611113, "body": "Make sure you wrap this in a trim statement if you use the formulaic version, Find will find the space, it returns <code>&quot;72381 &quot;</code> trim will remove it or you can put <code>-1</code> after the <code>find(&quot; &quot;,C3)</code> part. Being that you mentioned this is a code, it is probably very important to do this."}], "tags": [], "owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "is_accepted": true, "score": 1, "last_activity_date": 1438789185, "last_edit_date": 1438789185, "creation_date": 1438788456, "answer_id": 31836687, "question_id": 31836615, "link": "https://stackoverflow.com/questions/31836615/how-to-extract-numbers-until-a-space-is-reached-in-a-string-using-excel-2010/31836687#31836687", "title": "How to extract numbers UNTIL a space is reached in a string using Excel 2010?", "body": "<p>You're looking for the find function.. Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QpQYE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QpQYE.png\" alt=\"enter image description here\"></a></p>\n\n<p>or in VBA <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow noreferrer\">instr()</a>  and <a href=\"https://msdn.microsoft.com/en-us/library/y050k1wb(v=vs.90).aspx\" rel=\"nofollow noreferrer\">left()</a>\n<a href=\"https://i.stack.imgur.com/lMtUF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lMtUF.png\" alt=\"enter image description here\"></a></p>\n\n<p>Since you know the pattern is always code followed by space just use <code>left</code> of the string for the number of characters to the first space found using <code>instr</code>. Sample in immediate window above.  Loop is going to be slow, and while it may validate they are numeric why bother if you know pattern is code then space?</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 4142441, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jwY2dIagLcg/AAAAAAAAAAI/AAAAAAAAE6k/q_tNbDhuxpA/photo.jpg?sz=128", "display_name": "Robert Sharp", "link": "https://stackoverflow.com/users/4142441/robert-sharp"}, "is_accepted": false, "score": 0, "last_activity_date": 1438788870, "creation_date": 1438788870, "answer_id": 31836840, "question_id": 31836615, "link": "https://stackoverflow.com/questions/31836615/how-to-extract-numbers-until-a-space-is-reached-in-a-string-using-excel-2010/31836840#31836840", "title": "How to extract numbers UNTIL a space is reached in a string using Excel 2010?", "body": "<p>In similar situations in C# code, I leave the loop early after finding the first instance of a space character (32). In VBA, you'd use Exit For.</p>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1438820092, "post_id": 31844758, "comment_id": 51611072, "body": "I have never seen this before, noted for future use :)"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 2, "creation_date": 1438820203, "post_id": 31844758, "comment_id": 51611092, "body": "I find it in<code>val</code>uable. Pun intended."}], "tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 3, "last_activity_date": 1438819440, "creation_date": 1438819440, "answer_id": 31844758, "question_id": 31836615, "link": "https://stackoverflow.com/questions/31836615/how-to-extract-numbers-until-a-space-is-reached-in-a-string-using-excel-2010/31844758#31844758", "title": "How to extract numbers UNTIL a space is reached in a string using Excel 2010?", "body": "<p>If the first character in the description part of your string is never numeric, you could use the VBA <code>Val(string)</code> function to return all of the numeric characters before the first non-numeric character.</p>\n\n<pre><code>Function GetNum(sWord As String)\n    GetNum = Val(sWord)\nEnd Function\n</code></pre>\n\n<p>See the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264296(v=office.15).aspx\" rel=\"nofollow\">syntax</a> of the <code>Val(string)</code> function for full details of it's usage.</p>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1438819855, "creation_date": 1438819855, "answer_id": 31844807, "question_id": 31836615, "link": "https://stackoverflow.com/questions/31836615/how-to-extract-numbers-until-a-space-is-reached-in-a-string-using-excel-2010/31844807#31844807", "title": "How to extract numbers UNTIL a space is reached in a string using Excel 2010?", "body": "<p>You can get rid of the function altogether and use this:</p>\n\n<pre><code>split(\"72381 Test 4Dx for Worms\",\" \")(0)\n</code></pre>\n\n<p>This will split the string into an array using \" \" as the split char. Then it shows us address 0 in the array (the first element)</p>\n\n<p>In the context of your function if you are dead set on using one it is this:</p>\n\n<pre><code>Function OnlyNums(sWord As String)\n    OnlyNums = Split(sWord, \" \")(0)\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1438843571, "creation_date": 1438843571, "answer_id": 31848603, "question_id": 31836615, "link": "https://stackoverflow.com/questions/31836615/how-to-extract-numbers-until-a-space-is-reached-in-a-string-using-excel-2010/31848603#31848603", "title": "How to extract numbers UNTIL a space is reached in a string using Excel 2010?", "body": "<p>While I like the simplicity of Mark's solution, you could use an efficient parser below to improve your character by character search (to cope with strings that don't start with numbers).</p>\n\n<p><em>test</em></p>\n\n<pre><code>Sub test()\nMsgBox StrOut(\"72381 Test 4Dx\")\nEnd Sub\n</code></pre>\n\n<p><em>code</em></p>\n\n<pre><code>Function StrOut(strIn As String)\nDim objRegex As Object\nSet objRegex = CreateObject(\"vbscript.regexp\")\nWith objRegex\n    .Pattern = \"^(\\d+)(\\s.+)$\"\n    If .test(strIn) Then\n        StrOut = .Replace(strIn, \"$1\")\n    Else\n        StrOut = \"no match\"\n    End If\nEnd With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5194589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46fbb23972c9df26d833f5808db088df?s=128&d=identicon&r=PG&f=1", "display_name": "K Hill", "link": "https://stackoverflow.com/users/5194589/k-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4377, "favorite_count": 1, "accepted_answer_id": 31836687, "answer_count": 5, "score": 2, "last_activity_date": 1438845972, "creation_date": 1438788266, "last_edit_date": 1438845972, "question_id": 31836615, "link": "https://stackoverflow.com/questions/31836615/how-to-extract-numbers-until-a-space-is-reached-in-a-string-using-excel-2010", "title": "How to extract numbers UNTIL a space is reached in a string using Excel 2010?", "body": "<p>I need to pull the code from the following string: 72381 Test 4Dx for Worms.  The code is 72381 and the function that I'm using does a wonderful job of pulling ALL the numbers from a string and gives me back 723814, which pulls the 4 from the description of the code. The actual code is only the 72381. The codes are of varying length and are always followed by a space before the description begins; however there are spaces in the descriptions as well. This is the function I am using that I found from a previous search:</p>\n\n<pre><code>Function OnlyNums(sWord As String)          \n    Dim sChar As String         \n    Dim x As Integer            \n    Dim sTemp As String         \n\n    sTemp = \"\"          \n    For x = 1 To Len(sWord)         \n        sChar = Mid(sWord, x, 1)            \n        If Asc(sChar) &gt;= 48 And _           \n          Asc(sChar) &lt;= 57 Then         \n            sTemp = sTemp &amp; sChar           \n        End If          \n    Next            \n    OnlyNums = Val(sTemp)           \nEnd Function        \n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1438788781, "post_id": 31836430, "comment_id": 51595356, "body": "Check out this post: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>  If you quit using .Select and then working with the Selection, your code will run dramatically faster."}, {"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1438791316, "post_id": 31836430, "comment_id": 51597041, "body": "I&#39;ve checked but I want to know how to change it to this WorksheetFunction.CountA(Range(&quot;A1:D500&quot;)) = &quot;NA&quot;"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1438792356, "post_id": 31836430, "comment_id": 51597697, "body": "CountA &quot;Counts the number of cells in a range that are not empty&quot;. It will return a count of every cell that contains a value...be it NA or something else. You would use it by passing it your range object: rng or <code>WorksheetFunction.CountA(rng)</code> Adding the <code>= &quot;NA&quot;</code> on the end will make it a Boolean comparison which is always going to resolve to <code>FALSE</code>. I have no idea how to add <code>FALSE</code> to your code to make it faster. If you can point out where you would like to use <code>FALSE</code>, I can try to help."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1438822448, "post_id": 31836430, "comment_id": 51611590, "body": "Do you want to check if your ranges contain the string &quot;NA&quot; or the &quot;#N/A&quot; error returned by a function?"}], "answers": [{"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 0, "last_activity_date": 1438849720, "creation_date": 1438849720, "answer_id": 31850606, "question_id": 31836430, "link": "https://stackoverflow.com/questions/31836430/store-selection-in-a-variable/31850606#31850606", "title": "Store selection in a variable", "body": "<p>Sorry about not incorporating the CountA function but I'm fairly sure you will be happy with the vast improvement in \"efficiency\" with an approximately <strong>555,000% speed increase!</strong> (calculated using time to execute your code against time to execute mine). It's a long read but hopefully worthwhile and educational.</p>\n\n<p>If you feel the \"need for speed\" in your code, it's a good idea to use:</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n    'your code here\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n</code></pre>\n\n<p>in your procedures unless continuous calculation is required or you specifically want event procedures to run. If you're displaying message boxes or UserForms you may want to briefly allow ScreenUpdating.</p>\n\n<p>To demonstrate this, I created a workbook with 18 identical sheets containing mostly values in A1:D500 plus 66 Vlookups evaluating to #N/A per sheet. I put your code in a procedure named DeleteErrorsUsingLoops(). I made sure C6:D500 was selected on each sheet and ran your code as it stands but with a timer added.</p>\n\n<pre><code>Sub DeleteErrorsUsingLoops()\nRange(\"C6\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\n\nDim StartTime As Date\nStartTime = Now()\nDim N As Long\nFor N = 3 To 15\nSheets(N).Activate\n    Dim rng As Range\n    For Each rng In Selection\n        If IsError(rng) Then\n        rng.ClearContents\n        Else\n        rng.Select\n        Selection.Copy\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        End If\n       Next rng\nNext N\nMsgBox Format(Now() - StartTime, \"hh:mm:ss.000000\")\nEnd Sub\n</code></pre>\n\n<p>It took 11 minutes, 1 second to run on an i7-3820 quad core running at 3.6Ghz with 8GB RAM. I feel your pain!</p>\n\n<p>Running it again with screen updating turned off,  it took 39 seconds which is a <strong>1,692% improvement</strong>.</p>\n\n<p>Disabling calculation and events in this case made no difference because the cells being deleted have no dependents, so no recalculation required, and there are no event procedures in my workbook.</p>\n\n<p><strong>Use Loops sparingly</strong></p>\n\n<p>Sometimes you have to use loops to cycle through a Collection of books or sheets for example. That isn't usually a problem because the numbers are relatively small.</p>\n\n<p>When you start looping through every cell in a range and perform several actions (select, evaluate, clear, copy, paste) takes time even if you aren't forced to watch it all happen.</p>\n\n<p>Instead of looping through all 990 cells on 13 sheets you could use the equivalent of Find &amp; Select...Go To...Special...Formulas...Errors (only) which would select all your \"#N/A\"'s if you did it on sheet. I recorded a macro doing just that:</p>\n\n<pre><code>Sub SelectErrors()\n'\n' SelectErrors Macro\n'\n\n'\n    Selection.SpecialCells(xlCellTypeFormulas, 16).Select\nEnd Sub\n</code></pre>\n\n<p>You could then clear the selection with <code>Selection.ClearContents</code> but I don't like using Selections, Select (unless it's followed by Case) or Activate. So instead of the recorded macro code I'd use something like:</p>\n\n<pre><code>[C6:D500].SpecialCells(xlCellTypeFormulas, xlErrors).ClearContents\n</code></pre>\n\n<p><strong>Avoid Activate and Select</strong></p>\n\n<ul>\n<li>they cause a speed hit (i.e. slow things down)</li>\n<li>can result in errors and unpredictable results. For example, in your code, if cell A1 is selected in all but your first sheet then only A1 is tested on those sheets. You may feel good when your procedure runs faster but it hasn't deleted the errors in sheets 4 to 15.</li>\n</ul>\n\n<p><strong>Use <code>With...End With</code> constructs instead</strong>\nThese reduce repetition. You could write</p>\n\n<pre><code>Sheets(x).[C6:D500].SpecialCells(xlCellTypeFormulas, xlErrors).ClearContents\nSheets(x).[C6:D500].Copy\nSheets(x).[C6:D500].PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Or you could take out the common expression <code>Sheets(x).[C6:D500]</code> and put in a With:</p>\n\n<pre><code>With Sheets(x).[C6:D500] 'define range you want to work on\n    .SpecialCells(xlCellTypeFormulas, xlErrors).ClearContents\n    .Copy\n    .PasteSpecial xlPasteValues\nEnd With\n</code></pre>\n\n<p>Note that each expression within the With...End With starts with a dot (.).</p>\n\n<p>Put all of the above together to get the <strong>blindingly fast</strong>:</p>\n\n<pre><code>Sub FindAndDeleteErrors()\n'Clears contents in cells returning errors while leaving formats\n'within a defined range on all sheets within a workbook.\n'Assumes no Chart sheets in workbook else use Worksheets collection.\n\nDim ErrorMsg As String 'just in case!\nDim ws As Worksheet\nDim StartTime\nDim x As Long 'arguably faster than Integer - Google it.\n    On Error GoTo Ender:\n    StartTime = MicroTimer 'An API function appended below.\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n    For x = 3 To 15 'set up Sheet loop boundaries\n        With Sheets(x).[C6:D500] 'define range you want to work on\n            'test that there will be error cells to work on to avoid error\n            On Error Resume Next 'will error in no xlErrors in range\n            If Err &gt; 0 Then\n                ErrorMsg = \"An \" &amp; Err.Number &amp; \" error (\" &amp; Error &amp; \") occurred in sheet \" &amp; Sheets(x).Name\n            End If\n            .SpecialCells(xlCellTypeFormulas, xlErrors).ClearContents\n            On Error GoTo Ender:\n            .Copy\n            .PasteSpecial xlPasteValues\n            Application.CutCopyMode = False 'clear the clipboard\n        End With\n    Next x\n    StartTime = MicroTimer - StartTime 'calculate elapsed time\n    StartTime = Round(StartTime, 5) 'show it to 5 decimals\n    MsgBox CDbl(StartTime)\nEnder:     'runs On Error to restore normal operation\n    If ErrorMsg &lt;&gt; \"\" Then 'display error\n        MsgBox ErrorMsg, vbCritical\n    End If\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>The MicroTimer function was copied from <a href=\"https://msdn.microsoft.com/en-us/library/office/ff700515(v=office.14).aspx\" rel=\"nofollow\">Office development > Office clients > Office 2010 > Excel 2010 > Technical Articles > Excel 2010 Performance: Improving Calculation Performance</a></p>\n\n<pre><code>Private Declare Function getFrequency Lib \"kernel32\" _\nAlias \"QueryPerformanceFrequency\" (cyFrequency As Currency) As Long\nPrivate Declare Function getTickCount Lib \"kernel32\" _\nAlias \"QueryPerformanceCounter\" (cyTickCount As Currency) As Long\nFunction MicroTimer() As Double\n'\n\n' Returns seconds.\n    Dim cyTicks1 As Currency\n    Static cyFrequency As Currency\n    '\n    MicroTimer = 0\n\n' Get frequency.\n    If cyFrequency = 0 Then getFrequency cyFrequency\n\n' Get ticks.\n    getTickCount cyTicks1\n\n' Seconds\n    If cyFrequency Then MicroTimer = cyTicks1 / cyFrequency\nEnd Function\n</code></pre>\n\n<p>Sorry about not incorporating the CountA function but I'm fairly sure you will be happy with the vast improvement in \"efficiency\"!!</p>\n"}], "owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1093, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438849720, "creation_date": 1438787702, "last_edit_date": 1438822301, "question_id": 31836430, "link": "https://stackoverflow.com/questions/31836430/store-selection-in-a-variable", "title": "Store selection in a variable", "body": "<p>I want to increase the  efficiency of my macro by using <code>If WorksheetFunction.CountA(Range(\"A1:D500\")) = \"NA\" Then</code> to clear contents if a cell in that range has \"NA\". </p>\n\n<p>I need to store the current selection of my macro because values in sheets are stored in different locations.</p>\n\n<p>I am using this code </p>\n\n<pre><code>Range(\"C6\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\n\nFor N = 3 To 15\nSheets(N).Activate\n    Dim rng As Range\n    For Each rng In Selection\n        If IsError(rng) Then\n        rng.ClearContents\n        Else\n        rng.Select\n        Selection.Copy\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n        End If\n       Next rng\nNext N\n</code></pre>\n\n<p>This loop looks in every cell for the current selection but I have 15 sheets in which to look for and erase every \"NA\" value so it takes too long.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 5186996, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r6V0u_PeMp4/AAAAAAAAAAI/AAAAAAAACk4/A22lhfI5ApU/photo.jpg?sz=128", "display_name": "JoeB", "link": "https://stackoverflow.com/users/5186996/joeb"}, "is_accepted": false, "score": 0, "last_activity_date": 1438791856, "creation_date": 1438791856, "answer_id": 31837946, "question_id": 31836296, "link": "https://stackoverflow.com/questions/31836296/filtering-data-from-one-sheet-to-another-in-excel/31837946#31837946", "title": "Filtering data from one sheet to another in excel", "body": "<p>The closest that I've used was actually a kinda clunky equation:</p>\n\n<p><br>Hidden_Sheet: Hidden table\n<br>B5978: Product Filter\n<br>$A$2:$A$5997: Full range on hidden table where 'Product filter' will look. I don't think you can make it simply $a:$a.\n<br>$E$2:$E$5997: Value you want to return\n<br><b>$A$2: This does need to change in each row of your final sheet (i.e. \"$A$2,\" $A$3,\" etc.).</b></p>\n\n<pre><code>=IF(B5978=0,\"\",IFERROR(INDEX(Hidden_Sheet!$E$2:$E$5997,SMALL(INDEX((B5978=Hidden_Sheet!$A$2:$A$5997)*(MATCH(ROW(Hidden_Sheet!$A$2:$A$5997),ROW(Hidden_Sheet!$A$2:$A$5997)))+(B5978&lt;&gt;Hidden_Sheet!$A$2:$A$5997)*1048577,0,0),ROW(Hidden_Sheet!$A$2))),\"\"))\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2220653, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bc46d7a30ef397196fc9bb233f0dcdaf?s=128&d=identicon&r=PG", "display_name": "user2220653", "link": "https://stackoverflow.com/users/2220653/user2220653"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438791856, "creation_date": 1438787342, "question_id": 31836296, "link": "https://stackoverflow.com/questions/31836296/filtering-data-from-one-sheet-to-another-in-excel", "title": "Filtering data from one sheet to another in excel", "body": "<p>I need to have data stored on one sheet like a database, and then one displayed on another sheet based filtered by product. I am not familiar with visual basic at all, yet my boss tasked me with this project. </p>\n\n<p>Basically we have a variable name, variable type, and a product that those will be associated with. New names, types, and even products will most likely be added in the future. I can't seem to find a solution online that will allow me to filter on one page while pulling data from another.</p>\n\n<p>This is how the data sheet looks like at the moment. This was the best way we could think of for future expansion of the data sheet as multiple products would be associated with one new variable.</p>\n\n<pre><code>Name | Type | Product | Product | Product...|\ntest | var  | Product |         | Product   |\ntest2| txt  | Product |         |           |\ntest3| char |         | Product | Product   |\n</code></pre>\n\n<p>I hope this makes sense and if anyone can help that would be great. Below is some code we have found online and have tried to modify it to work with no luck.</p>\n\n<pre><code>Dim myButton As OptionButton\nDim MyVal As Long\nDim ButtonName As String\nDim sht As Worksheet\nDim myField As Long\nDim DataRange As Range\nDim mySearch As Variant\n\n'Load Sheet into A Variable\n\n  Set sht = ActiveSheet\n  ThisWorkbook.Sheets(\"Sheet3\").Activate\n\n'Unfilter Data (if necessary)\n  On Error Resume Next\n    sht.ShowAllData\n  On Error GoTo 0\n\n'Filtered Data Range (include column heading cells)\n\n  Set DataRange = sht.Range(\"A1:Z1000\") 'Cell Range\n  'Set DataRange = sht.ListObjects(\"Table1\").Range 'Table\n\n'Retrieve User's Search Input\n  mySearch = sht.Shapes(\"UserSearch\").TextFrame.Characters.Text 'Control Form\n  'mySearch = sht.OLEObjects(\"UserSearch\").Object.Text 'ActiveX Control\n  'mySearch = sht.Range(\"A1\").Value 'Cell Input\n\n'Loop Through Option Buttons\n  For Each myButton In ActiveSheet.OptionButtons\n      If myButton.Value = 1 Then\n        ButtonName = myButton.Text\n        Exit For\n      End If\n  Next myButton\n\n'Determine Filter Field\n  On Error GoTo HeadingNotFound\n    myField = Application.WorksheetFunction.Match(ButtonName, DataRange.Rows(1), 0)\n  On Error GoTo 0\n\n'Filter Data\n  DataRange.AutoFilter _\n    Field:=myField, _\n    Criteria1:=\"=*\" &amp; mySearch &amp; \"*\", _\n    Operator:=xlAnd\n\n'Clear Search Field\n  sht.Shapes(\"UserSearch\").TextFrame.Characters.Text = \"\" 'Control Form\n  'sht.OLEObjects(\"UserSearch\").Object.Text = \"\" 'ActiveX Control\n  'sht.Range(\"A1\").Value = \"\" 'Cell Input\n\nExit Sub\n\n'ERROR HANDLERS\nHeadingNotFound:\n  MsgBox \"The column heading [\" &amp; ButtonName &amp; \"] was not found in cells \" &amp; DataRange.Rows(1).Address &amp; \". \" &amp; _\n    vbNewLine &amp; \"Please check for possible typos.\", vbCritical, \"Header Name Not Found!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": true, "score": 1, "last_activity_date": 1438788268, "creation_date": 1438788268, "answer_id": 31836616, "question_id": 31836212, "link": "https://stackoverflow.com/questions/31836212/access-vba-adding-up-minsec-field-to-total-seconds/31836616#31836616", "title": "Access VBA - Adding up Min:Sec field to total seconds", "body": "<p>Change \"HrSec\" to match your field's name:</p>\n\n<p><code>Sum(Left([HrSec],InStr(1,[HrSec],\":\")-1)*60+Right([HrSec],2))</code></p>\n\n<p>If all entries in your column are formatted 00:00 and not 0:00, then you can use the following which is slightly simplier:</p>\n\n<p><code>Sum(Left([HrSec],2)*60+Right([HrSec],2))</code></p>\n"}], "owner": {"reputation": 585, "user_id": 3162099, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/R4imn.jpg?s=128&g=1", "display_name": "wribit", "link": "https://stackoverflow.com/users/3162099/wribit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 31836616, "answer_count": 1, "score": 0, "last_activity_date": 1438788268, "creation_date": 1438787118, "question_id": 31836212, "link": "https://stackoverflow.com/questions/31836212/access-vba-adding-up-minsec-field-to-total-seconds", "title": "Access VBA - Adding up Min:Sec field to total seconds", "body": "<p>I have a duration field in my database table, that has a duration in this format \"00:00\" minutes and seconds respectively. The field is a short text.</p>\n\n<p>I need to tally up these durations in a report, into a sum of seconds. I tried doing a sum of the field as is, but it didn't return the right value.</p>\n\n<p>I'm at a loss - I don't know how to go about doing this in Access. Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1438789397, "post_id": 31836766, "comment_id": 51595762, "body": "This looks to be on the right track. Can you elaborate a little on what the Dim key line means, and how that relates to what the output is? Thanks."}, {"owner": {"reputation": 358, "user_id": 5042442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21c40fa5a3ec804e543cb7d510a3d9?s=128&d=identicon&r=PG", "display_name": "Latch", "link": "https://stackoverflow.com/users/5042442/latch"}, "reply_to_user": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 1, "creation_date": 1438793990, "post_id": 31836766, "comment_id": 51598745, "body": "They dim key was just for the &quot;for each key&quot; a little bit later, you don&#39;t have to use it, but I find it nicer than doing something like &quot;for i=0 to dict.count-1&quot; especially if you are not sure what your keys might be. It lets you iterate over all keys what ever they are."}], "tags": [], "owner": {"reputation": 358, "user_id": 5042442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee21c40fa5a3ec804e543cb7d510a3d9?s=128&d=identicon&r=PG", "display_name": "Latch", "link": "https://stackoverflow.com/users/5042442/latch"}, "is_accepted": true, "score": 2, "last_activity_date": 1438794619, "last_edit_date": 1438794619, "creation_date": 1438788658, "answer_id": 31836766, "question_id": 31836206, "link": "https://stackoverflow.com/questions/31836206/in-vba-is-it-possible-to-set-a-range-to-be-relative-to-another-range/31836766#31836766", "title": "In VBA, is it possible to set a range to be relative to another range?", "body": "<p>You could use a dictionary.</p>\n\n<pre><code>Sub ex()\nDim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\nDim i As Integer, y As Integer\nDim key\ny = 4\nFor i = 0 To 2\n    dict.Add i, Range(\"D2\").Offset(, y * i)\nNext\nFor Each key In dict\n    dict(key).Value = \"test\" &amp; key\nNext\nEnd Sub\n</code></pre>\n\n<p>dict(i) will be a range and you can do whatever you normaly would with it. </p>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 31836766, "answer_count": 1, "score": 2, "last_activity_date": 1438794619, "creation_date": 1438787107, "question_id": 31836206, "link": "https://stackoverflow.com/questions/31836206/in-vba-is-it-possible-to-set-a-range-to-be-relative-to-another-range", "title": "In VBA, is it possible to set a range to be relative to another range?", "body": "<p>I'm writing a very long script, and I'm trying to find as many shortcuts as possible. I need to set up a lot of ranges before starting. Would it be possible to replace something like:</p>\n\n<pre><code>Dim Range1 As Range\nDim Range2 As Range \nDim Range3 As Range\nDim i As Long\n\ni = 2\n\nSet Range1 = (\"D\" &amp; i)\nSet Range2 = (\"H\" &amp; i)\nSet Range3 = (\"L\" &amp; i)\n</code></pre>\n\n<p>With some like </p>\n\n<pre><code>Dim Range1 As Range\nDim Range2 As Range \nDim Range3 As Range\nDim i As Long\nDim y As Long \n\ni = 2\ny = 4\n\nSet Range1 = (\"D\" &amp; i)\nSet Range2 = (Range1.Offset(,y))\nSet Range3 = (Range2.Offset(,y))\n</code></pre>\n\n<p>It would be very helpful if I have 100 ranges to set, all equal distances from one another. If I were to use 100 ranges, would I need to Dim each one as I have here? Or can I do something like \"Set RangeN as Range where N is every integer between 1 and 100?\"</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 733, "user_id": 5090061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0606664fdb307c96c1c39066af9386be?s=128&d=identicon&r=PG&f=1", "display_name": "KFichter", "link": "https://stackoverflow.com/users/5090061/kfichter"}, "edited": false, "score": 0, "creation_date": 1438787212, "post_id": 31836071, "comment_id": 51594257, "body": "Would you like to return just the row number where the value is found or the values of the row itself?"}, {"owner": {"reputation": 77, "user_id": 5178680, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bcfb7cbe8ebd6a5363127f776454928a?s=128&d=identicon&r=PG&f=1", "display_name": "jason bourne", "link": "https://stackoverflow.com/users/5178680/jason-bourne"}, "reply_to_user": {"reputation": 733, "user_id": 5090061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0606664fdb307c96c1c39066af9386be?s=128&d=identicon&r=PG&f=1", "display_name": "KFichter", "link": "https://stackoverflow.com/users/5090061/kfichter"}, "edited": false, "score": 0, "creation_date": 1438787465, "post_id": 31836071, "comment_id": 51594425, "body": "Just the row number. I am doing further processing afterwards"}], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1438787729, "creation_date": 1438787729, "answer_id": 31836440, "question_id": 31836071, "link": "https://stackoverflow.com/questions/31836071/finding-a-row-in-excel-vba-issue/31836440#31836440", "title": "finding a row in excel vba issue", "body": "<p>You can use an array to hold the range, and then search the array to find the values. Once the values are found, it will output the row number which they have been found on.</p>\n\n<pre><code>Option Explicit\nSub matchCriteria()\n    Dim arrValues() As Variant\n    Dim lrow As Long, i As Long\n    Dim valOne As String, valTwo As String, valThree As String\n\n    valOne = \"x\" 'Update to reflect the values you want to find\n    valTwo = \"y\"\n    valThree = \"z\"\n    lrow = Cells(Rows.Count, 1).End(xlUp).Row\n    arrValues = Range(\"A1:C\" &amp; lrow)\n\n    For i = 1 To UBound(arrValues, 1)\n        If arrValues(i, 1) = valOne _\n        And arrValues(i, 2) = valTwo _\n        And arrValues(i, 3) = valThree Then\n            MsgBox (\"Row \" &amp; i &amp; \" contains the three specified values.\")\n            Exit For\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>The array currently will contain columns A:C. Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 77, "user_id": 5178680, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/bcfb7cbe8ebd6a5363127f776454928a?s=128&d=identicon&r=PG&f=1", "display_name": "jason bourne", "link": "https://stackoverflow.com/users/5178680/jason-bourne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17, "favorite_count": 0, "accepted_answer_id": 31836440, "answer_count": 1, "score": 1, "last_activity_date": 1438787729, "creation_date": 1438786749, "question_id": 31836071, "link": "https://stackoverflow.com/questions/31836071/finding-a-row-in-excel-vba-issue", "title": "finding a row in excel vba issue", "body": "<p>I have an excel spreadsheet with 3 columns. <code>Column 1, Column 2, Column 3</code>. I want to do a find criteria so I can get back the position of the Row. How is this possible?. </p>\n\n<p>To find one criteria I can do ... but do not know how to extend so it finds the row that matches e.g. value 1, value 2 , value 3. </p>\n\n<pre><code>Columns(\"A\").Find(value, Range(A:A), xlValues, xlWhole)\n</code></pre>\n"}, {"tags": ["excel", "call", "wait", "vba"], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 2253290, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3fb61a991ec4d32280cf9e4702bff868?s=128&d=identicon&r=PG", "display_name": "Benoit", "link": "https://stackoverflow.com/users/2253290/benoit"}, "edited": false, "score": 0, "creation_date": 1438788711, "post_id": 31836214, "comment_id": 51595316, "body": "Well it doesn&#39;t work for my situation, the code <b>never</b> enters the <code>Do Until</code>"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 363, "user_id": 2253290, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3fb61a991ec4d32280cf9e4702bff868?s=128&d=identicon&r=PG", "display_name": "Benoit", "link": "https://stackoverflow.com/users/2253290/benoit"}, "edited": false, "score": 0, "creation_date": 1438800424, "post_id": 31836214, "comment_id": 51602427, "body": "Weird, it just skips straight over it into the <code>Call</code> line? Btw, did you know you don&#39;t need the word <code>Call</code> anymore, you can just put the function name? Sorry I couldn&#39;t be of more help."}], "tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": false, "score": 0, "last_activity_date": 1438787123, "creation_date": 1438787123, "answer_id": 31836214, "question_id": 31835464, "link": "https://stackoverflow.com/questions/31835464/excel-vba-order-grouping-of-call/31836214#31836214", "title": "Excel VBA order/grouping of &quot;Call&quot;", "body": "<p>I'm not very experienced with what you have here, but I had a somewhat similar problem with a macro that zipped files and also needed a wait added to work correctly. Maybe what helped me could help you. Here's what I used to sync it:</p>\n\n<pre><code>Do Until Object1.Namespace(Variant1).items.Count = 1\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\nLoop\n</code></pre>\n\n<p>and here's how you might apply it (untested):</p>\n\n<pre><code>Private Sub CheckBoxAllDirectionTerritoriale_Click()\n    If Me.CheckBoxAllDirectionTerritoriale.Value = True Then\n        CheckBoxAllDirectionTerritoriale.Font.Bold = True\n        Do Until CheckBoxAllDirectionTerritoriale.Font.Bold = True\n            Application.Wait (Now + 0.000001)\n        Loop\n        Call SelectAlldtList\n    Else\n        CheckBoxAllDirectionTerritoriale.Font.Bold = False\n        Do Until CheckBoxAllDirectionTerritoriale.Font.Bold = False\n            Application.Wait (Now + 0.000001)\n        Loop\n        Call UnselectAlldtList\n    End If\nEnd Sub\n</code></pre>\n\n<p>I set it for one millisecond, but if you get some error with it being partially bolded or whatever, you might want to increase it to two. Note that you will still probably end up having the slight delay, but this way if it's 5, 7, etc. milliseconds you'll still be covered, I think.</p>\n"}], "owner": {"reputation": 363, "user_id": 2253290, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3fb61a991ec4d32280cf9e4702bff868?s=128&d=identicon&r=PG", "display_name": "Benoit", "link": "https://stackoverflow.com/users/2253290/benoit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438787123, "creation_date": 1438785101, "last_edit_date": 1531164843, "question_id": 31835464, "link": "https://stackoverflow.com/questions/31835464/excel-vba-order-grouping-of-call", "title": "Excel VBA order/grouping of &quot;Call&quot;", "body": "<p>Probably not the best title, but it will be better with this exemple.</p>\n\n<p>Here's a function inside a <code>userform</code> of a <code>checkbox</code>. I was trying to change the font to <code>bold</code> <em>before</em> the call to <code>SelectAlldtList</code>(which takes a few seconds to do).</p>\n\n<p>What is happening is that the font doesn't change until <em>after</em> the <code>SelectAlldtList</code> is finished.</p>\n\n<pre><code>Private Sub CheckBoxAllDirectionTerritoriale_Click()\n    If Me.CheckBoxAllDirectionTerritoriale.Value = True Then\n        CheckBoxAllDirectionTerritoriale.Font.Bold = True\n        Call SelectAlldtList\n    Else\n        CheckBoxAllDirectionTerritoriale.Font.Bold = False\n        Call UnselectAlldtList\n    End If\nEnd Sub\n</code></pre>\n\n<p>If I add a <code>Wait</code> of <strong>6</strong> milliseconds, the behavior is the one I want. \nIf I add a <code>Wait</code> of <strong>5</strong> milliseconds, the behavior is the same as without the <code>Wait</code> at all. </p>\n\n<pre><code>Private Sub CheckBoxAllDirectionTerritoriale_Click()\n    If Me.CheckBoxAllDirectionTerritoriale.Value = True Then\n        CheckBoxAllDirectionTerritoriale.Font.Bold = True\n        Application.Wait (Now + 0.000006)\n        Call SelectAlldtList\n    Else\n        CheckBoxAllDirectionTerritoriale.Font.Bold = False\n        Application.Wait (Now + 0.000006)\n        Call UnselectAlldtList\n    End If\nEnd Sub\n</code></pre>\n\n<p>Why is that? Is it something like without the <code>Wait</code>, <code>SelectAlldtList</code> is called before having time to <code>bold</code> and taking all the ressources?</p>\n\n<p>While I'm at it, would there be a better way to do this? Some kind of synchronization?</p>\n"}, {"tags": ["vba", "excel", "loops", "repeat"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1438784840, "post_id": 31835270, "comment_id": 51592507, "body": "Concatenate the values of I:L, use Instr for all of them, copy A; or If with four Or condition items, I, J, K, L."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1438785646, "post_id": 31835270, "comment_id": 51593106, "body": "Are the names going to be in any order? Can it be nameA nameB nameA or will it be nameA nameA nameB?"}, {"owner": {"reputation": 13, "user_id": 5194450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9076ac5e2a9f069a7df1f72bc6503e43?s=128&d=identicon&r=PG&f=1", "display_name": "patriotsredsox37", "link": "https://stackoverflow.com/users/5194450/patriotsredsox37"}, "edited": false, "score": 0, "creation_date": 1438786175, "post_id": 31835270, "comment_id": 51593551, "body": "The names in I:L are in no order. It could be NameA in I, Name A in J, Name B in K, Name A in L"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5194450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9076ac5e2a9f069a7df1f72bc6503e43?s=128&d=identicon&r=PG&f=1", "display_name": "patriotsredsox37", "link": "https://stackoverflow.com/users/5194450/patriotsredsox37"}, "edited": false, "score": 0, "creation_date": 1438797322, "post_id": 31835483, "comment_id": 51600572, "body": "This fixes the double counting problem, but for some reason it now skips rows and doesn&#39;t paste all the values of column A. Any reason why?"}, {"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "reply_to_user": {"reputation": 13, "user_id": 5194450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9076ac5e2a9f069a7df1f72bc6503e43?s=128&d=identicon&r=PG&f=1", "display_name": "patriotsredsox37", "link": "https://stackoverflow.com/users/5194450/patriotsredsox37"}, "edited": false, "score": 0, "creation_date": 1439277870, "post_id": 31835483, "comment_id": 51782104, "body": "I forgot to reset the value of <code>j</code>: Add <code>j=1</code> after <code>i=i+1</code> to start searching in column 1 again!"}], "tags": [], "owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "is_accepted": false, "score": 0, "last_activity_date": 1438785145, "creation_date": 1438785145, "answer_id": 31835483, "question_id": 31835270, "link": "https://stackoverflow.com/questions/31835270/vba-counting-twice-loop/31835483#31835483", "title": "VBA Counting Twice Loop?", "body": "<p>As long as you're only looking for one name at a time, you can simply increment your row counter <code>i</code> as soon as you find it:</p>\n\n<pre><code>If Vin(i, j) = Target.Value Then\n    ct = ct + 1\n    S = i + 1\n    Vout(ct) = Sheets(\"Master List\").Range(\"A\" &amp; S).Value\n    i = i + 1\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5194450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9076ac5e2a9f069a7df1f72bc6503e43?s=128&d=identicon&r=PG&f=1", "display_name": "patriotsredsox37", "link": "https://stackoverflow.com/users/5194450/patriotsredsox37"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 748, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438785145, "creation_date": 1438784633, "question_id": 31835270, "link": "https://stackoverflow.com/questions/31835270/vba-counting-twice-loop", "title": "VBA Counting Twice Loop?", "body": "<p>So I have my code which looks at names in columns I:L, and if the entry matches a name, it pastes the value of that row column A in another sheet. However, if a name appears twice in the same row in I:L it pastes the value in Column A twice. How can I fix this so that it only pastes Column A once if this happens?\nThanks!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)Dim r As Range, Vin As Variant, Vout As Variant, i As Long, j As Long, ct As Long, S As Long\nSet Target = Target(1)\nIf Not Intersect(Range(\"M3\"), Target) Is Nothing Then\n    Application.EnableEvents = False\n    Set r = Range(\"I14:I59\")\n    r.ClearContents\n    With Sheets(\"Master List\").Range(\"I2:L1000\" &amp; Sheets(\"Master List\").Cells(Rows.Count, 1).End(xlUp).Row)\n        Vin = .Value\n        ReDim Vout(1 To UBound(Vin, 1))\n        For i = 1 To UBound(Vin, 1)\n            For j = 1 To UBound(Vin, 2)\n                If Vin(i, j) = Target.Value Then\n                    ct = ct + 1\n                     S = i + 1\n                    Vout(ct) = Sheets(\"Master List\").Range(\"A\" &amp; S).Value\n                End If\n            Next j\n        Next i\n    End With\n    If ct &gt; 0 Then\n        ReDim Preserve Vout(1 To ct)\n        r.Resize(ct).Value = Application.Transpose(Vout)\n    End If\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 733, "user_id": 5090061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0606664fdb307c96c1c39066af9386be?s=128&d=identicon&r=PG&f=1", "display_name": "KFichter", "link": "https://stackoverflow.com/users/5090061/kfichter"}, "edited": false, "score": 0, "creation_date": 1438783668, "post_id": 31834749, "comment_id": 51591598, "body": "In your example the brown area is only showing the first row of the green area&#39;s values. Is that what you want? Are you looking for an average? I don&#39;t quite understand what you mean."}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "reply_to_user": {"reputation": 733, "user_id": 5090061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0606664fdb307c96c1c39066af9386be?s=128&d=identicon&r=PG&f=1", "display_name": "KFichter", "link": "https://stackoverflow.com/users/5090061/kfichter"}, "edited": false, "score": 0, "creation_date": 1438784369, "post_id": 31834749, "comment_id": 51592116, "body": "I need the second row of the green area to join into the end of the brown area values....There is no math, just copy those numbers. Notice the range of the green area. There could be more numbers in either green area rows."}, {"owner": {"reputation": 298, "user_id": 5164330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8f3ce9073c9b9753cfc7a903d17263d?s=128&d=identicon&r=PG&f=1", "display_name": "Peut22", "link": "https://stackoverflow.com/users/5164330/peut22"}, "edited": false, "score": 0, "creation_date": 1438784670, "post_id": 31834749, "comment_id": 51592356, "body": "Copy the second row next to the first raw (0.111 under DUI BAC 6) ? Or concatenate 0.110 and 0.111 in a single array ? (resulting in a string for example)"}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1438785492, "post_id": 31834749, "comment_id": 51592988, "body": "Each number in its own cell across the brown area without any blank cells between them. So copy each value of the green area into the brown row, So 0.111 under DUI BAC 6 in this example. But if there are more numbers in the first row of the green area, I need it to accommodate those numbers then row 2 in the green area with no blank cells in between the brown cells."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1438788606, "post_id": 31836039, "comment_id": 51595252, "body": "Something is not right. It will not give me the second row at all. By the way my range starts at BH5 to BS6. I made the adjustments for the column/row. This is what I have for an adjusted formula.         =IF(IF(BH5 = &quot;&quot;,INDIRECT(ADDRESS(6,COUNTIF($BH$5:BH5,&quot;&quot;))),BH5)=0,&quot;&quot;,IF(B&zwnj;&#8203;H5 = &quot;&quot;,INDIRECT(ADDRESS(6,COUNTIF($BH$5:BH5,&quot;&quot;))),BH5))"}, {"owner": {"reputation": 733, "user_id": 5090061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0606664fdb307c96c1c39066af9386be?s=128&d=identicon&r=PG&f=1", "display_name": "KFichter", "link": "https://stackoverflow.com/users/5090061/kfichter"}, "reply_to_user": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1438789385, "post_id": 31836039, "comment_id": 51595751, "body": "You were correct. It was a mistake on my part that arose due to creating the formula on column A and not thinking ahead. My bad!"}], "tags": [], "owner": {"reputation": 733, "user_id": 5090061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0606664fdb307c96c1c39066af9386be?s=128&d=identicon&r=PG&f=1", "display_name": "KFichter", "link": "https://stackoverflow.com/users/5090061/kfichter"}, "is_accepted": true, "score": 1, "last_activity_date": 1438789359, "last_edit_date": 1438789359, "creation_date": 1438786664, "answer_id": 31836039, "question_id": 31834749, "link": "https://stackoverflow.com/questions/31834749/how-can-i-copy-these-numbers-in-a-range-across-row-2/31836039#31836039", "title": "how can I copy these numbers in a range across row 2", "body": "<p>I created the following formula which seems to achieve the goal you are looking for:</p>\n\n<pre><code>=IF(IF(A4 = \"\",INDIRECT(ADDRESS(5,1 + COUNTIF($A$4:A4,\"\") - 1)),A4)=0,\"\",IF(A4 = \"\",INDIRECT(ADDRESS(5,1 + COUNTIF($A$4:A4,\"\") - 1)),A4))\n</code></pre>\n\n<p>This is assuming that the first row in the green area starts at A4 (replace with your information). You should replace your brown row values with this formula. </p>\n\n<p>This formula <em>looks</em> complicated but is in fact quite simple. The outermost IF statement checks if the result is zero - if so, it will return a blank cell. You can keep zeroes by simply using the inner:</p>\n\n<pre><code>=IF(A4 = \"\",INDIRECT(ADDRESS(5,COUNTIF($A$4:A4,\"\"))),A4)\n</code></pre>\n\n<p>The formula then checks if the cell of the first green row below it is nothing - if so, it will read from the second green line (assuming it is on line <em>5</em>) by counting how many blank cells in the first green row there have already been and  converting this number to a column name. It then converts the column name and the row (<em>5</em>) to an address, and indirectly access that address. If the first green cell below it is not blank, it will simply copy that cell.  </p>\n\n<p>Edit: This formula had an error in it that was a result of me using A as my starting column. For your specific request you want to use:</p>\n\n<pre><code>=IF(IF(BH5 = \"\",INDIRECT(ADDRESS(6,60 + COUNTIF($BH$5:BH5,\"\") - 1)),BH5)=0,\"\",IF(BH5 = \"\",INDIRECT(ADDRESS(6,60 + COUNTIF($BH$5:BH5,\"\") - 1)),BH5))\n</code></pre>\n\n<p>At BH5-6. I added the \"60\" in the countif because column BH is column #60. If you move around your data you will have to update this number (although I'm sure there's a formula for it). The \"-1\" after the countif is necessary and easier than always typing in the column number -1 instead of replacing the column number. </p>\n"}], "owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 31836039, "answer_count": 1, "score": -1, "last_activity_date": 1438789359, "creation_date": 1438783333, "last_edit_date": 1531161705, "question_id": 31834749, "link": "https://stackoverflow.com/questions/31834749/how-can-i-copy-these-numbers-in-a-range-across-row-2", "title": "how can I copy these numbers in a range across row 2", "body": "<p>What function in excel 2010 will let me look in the green area and copy the values in the brown area without any blank cells in between them. \nThe first row in the green area is data from worksheet1 and the data in the second row of the green are is from worksheet2. \nI need to have the brown row show the green area values. Sometimes there might be 2 or 3 values in the first row of the green area and then nothing in the second row and then maybe nothing in the first row and a few in the second row. I hope I explained this well enough. Thank you.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8eTvb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8eTvb.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1438785929, "creation_date": 1438785929, "answer_id": 31835784, "question_id": 31834673, "link": "https://stackoverflow.com/questions/31834673/outlook-macro-vba-to-compare-from-and-reply-to-address-and-alert-if-different/31835784#31835784", "title": "Outlook Macro/VBA to compare FROM and REPLY TO address and alert if different?", "body": "<p>You can handle the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863686(v=office.15).aspx\" rel=\"nofollow\">NewMailEx</a> event of the Application class.</p>\n\n<p>This event fires once for every received item that is processed by Microsoft Outlook. The item can be one of several different item types, for example, MailItem, MeetingItem, or SharingItem. The EntryIDsCollection string contains the Entry ID that corresponds to that item. </p>\n\n<p>The NewMailEx event fires when a new message arrives in the Inbox and before client rule processing occurs. You can use the Entry ID returned in the EntryIDCollection array to call the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869893.aspx\" rel=\"nofollow\">NameSpace.GetItemFromID</a> method and process the item. </p>\n\n<p>Also you may create a rule which may call a VBA sub. The sub should look like the following one:</p>\n\n<pre><code> Public Sub Test(mail as MailItem)\n  ' test\n End Sub\n</code></pre>\n\n<p>Finally, you may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> article helpful. </p>\n"}, {"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1438795143, "post_id": 31837155, "comment_id": 51599402, "body": "Did you mean to use the ReplyRecipients collection instead of Recipients?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1438853650, "post_id": 31837155, "comment_id": 51624065, "body": "Yes, I probably did. :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1438790006, "last_edit_date": 1438790006, "creation_date": 1438789676, "answer_id": 31837155, "question_id": 31834673, "link": "https://stackoverflow.com/questions/31834673/outlook-macro-vba-to-compare-from-and-reply-to-address-and-alert-if-different/31837155#31837155", "title": "Outlook Macro/VBA to compare FROM and REPLY TO address and alert if different?", "body": "<p>In the ThisOutlookSession add the following code - you'll need to update the Inbox location, or whichever folder you're watching.<br>\nI don't think I'm looking at the right property with <code>Item.Recipients</code> - you'll need to find ReplyTo.<br>\nAlso the recipient address may not always show the correct email address - search the internet for a function called <code>ResolveDisplayNameToSMTP</code></p>\n\n<p>Also - I haven't tested it. :)</p>\n\n<p>The procedure will become active when you run the Application_StartUp routine, or by closing and reopening Outlook.</p>\n\n<pre><code>Dim WithEvents MyInboxFolder As Items\n\nPrivate Sub Application_Startup()\n\n    Dim ns As Outlook.NameSpace\n\n    Set ns = Application.GetNamespace(\"MAPI\")\n    Set MyInboxFolder = ns.Folders.item(\"Mailbox - Darren Bartrup-Cook\").Folders.item(\"Inbox\").Items\n\nEnd Sub\n\nSub MyInboxFolder_ItemAdd(ByVal item As Object)\n\n    Dim sSenderEmailAddress As String\n    Dim vReplyRecipient As Variant\n\n    sSenderEmailAddress = item.SenderEmailAddress\n\n    For Each vReplyRecipient In item.Recipients\n        If vReplyRecipient.Address = sSenderEmailAddress Then\n            MsgBox \"The same\"\n        End If\n    Next vReplyRecipient\n\nEnd Sub\n\nPrivate Sub Application_Quit()\n\n    Dim ns As Outlook.NameSpace\n    Set MyInboxFolder = Nothing\n    Set ns = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Edit after looking up NewMailEx that Eugene Astafiev mentions - <strong>This event fires once for every received item that is processed by Microsoft Outlook</strong> - definitely worth looking further into as it will capture all folders, not just the Inbox.</p>\n"}], "owner": {"reputation": 321, "user_id": 1755914, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/cea24346d31cf6917738d8678ff33809?s=128&d=identicon&r=PG", "display_name": "finisterre", "link": "https://stackoverflow.com/users/1755914/finisterre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 718, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593306177, "creation_date": 1438783127, "last_edit_date": 1593306177, "question_id": 31834673, "link": "https://stackoverflow.com/questions/31834673/outlook-macro-vba-to-compare-from-and-reply-to-address-and-alert-if-different", "title": "Outlook Macro/VBA to compare FROM and REPLY TO address and alert if different?", "body": "<p>Is this doable in an Outlook 2013 macro/VBA? I'm not sure where to start. Ideally it would trigger for every incoming email, and pop up an alert if the FROM and REPLY TO addresses are different.</p>\n"}, {"tags": ["excel", "date", "vba"], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1438784564, "creation_date": 1438784564, "answer_id": 31835249, "question_id": 31834236, "link": "https://stackoverflow.com/questions/31834236/excel-vba-need-date-as-integer-value-like-in-excels-datevalue/31835249#31835249", "title": "excel vba need date as integer value like in excels datevalue()", "body": "<p>Try changing the full-stops (periods) to slashes, then convert to date, then convert to double.<br>\nWatch out for regional variations in date formatting though - not sure how it will affect the result - test with a date such as 01/02/2015 and see if it returns 1st Feb or 2nd Jan.</p>\n\n<pre><code>Sub test()\n\n    Dim strdate As String\n\n    strdate = \"19.01.2015\"\n    MsgBox CDbl(CDate(Replace(strdate, \".\", \"/\")))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 510, "user_id": 3398853, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c99b8975fefdcd0ff7556e1b17c6cae9?s=128&d=identicon&r=PG&f=1", "display_name": "Kazschuri", "link": "https://stackoverflow.com/users/3398853/kazschuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 31835249, "answer_count": 1, "score": 0, "last_activity_date": 1438784564, "creation_date": 1438781986, "last_edit_date": 1531164843, "question_id": 31834236, "link": "https://stackoverflow.com/questions/31834236/excel-vba-need-date-as-integer-value-like-in-excels-datevalue", "title": "excel vba need date as integer value like in excels datevalue()", "body": "<p>I try to get a date that is available as a string in \"DD.MM.YYYY\" fashion, changed to the value that excel normally applies to dates.</p>\n\n<p>I tried <code>CDbl(strDate)</code> as was suggested a lot. But instead of giving back 42023 as <code>=DATVALUE(\"19.01.2015\")</code> does, in my case it returns 19012015.</p>\n\n<pre><code>strDate = \"19.01.2015\"\nMsgBox CDbl(strDate)\n</code></pre>\n\n<p>How can I change that?</p>\n\n<p>thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1438782200, "post_id": 31834156, "comment_id": 51590456, "body": "No, it is not possible without opening them."}, {"owner": {"reputation": 1, "user_id": 5188798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e8a7d2a582f04dea412633aac777f8?s=128&d=identicon&r=PG&f=1", "display_name": "Rados\u0142aw Zakrzewski", "link": "https://stackoverflow.com/users/5188798/rados%c5%82aw-zakrzewski"}, "reply_to_user": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1438854137, "post_id": 31834156, "comment_id": 51624416, "body": "Thanks everyone, found a piece code that allows to choose a folder from which I&#39;m getting files. Now I&#39;m getting a problem with file names, but it shouldn&#39;t be too hard to solve."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5188798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e8a7d2a582f04dea412633aac777f8?s=128&d=identicon&r=PG&f=1", "display_name": "Rados\u0142aw Zakrzewski", "link": "https://stackoverflow.com/users/5188798/rados%c5%82aw-zakrzewski"}, "edited": false, "score": 0, "creation_date": 1438841492, "post_id": 31834635, "comment_id": 51616815, "body": "Getting an error quite often. Unknown error while executing. Row 17, symbol 5 (translating to english so it may not be accurate). I could have made an error somewhere in directory paths.   I Made 3 changes to the above: <code>objStartFolder = &quot;\\\\192.168.0.70\\Betstal\\WZ\\2015\\08.sierpie\u0144&quot; xlApp.VBE.ActiveVBProject.VBComponents.Import &quot;C:\\Users\\rzakrzewski\\Documents\\Module2.bas&quot;     xlApp.Run &quot;Przeroby&quot;</code>  Maybe &quot;&quot; are wrong ?"}, {"owner": {"reputation": 1, "user_id": 5188798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e8a7d2a582f04dea412633aac777f8?s=128&d=identicon&r=PG&f=1", "display_name": "Rados\u0142aw Zakrzewski", "link": "https://stackoverflow.com/users/5188798/rados%c5%82aw-zakrzewski"}, "edited": false, "score": 0, "creation_date": 1438861177, "post_id": 31834635, "comment_id": 51628942, "body": "Got it working via someother means. But I could still use the above for running the script from outside excel window. I tried deleting all parts regarding to obj, cold and filePath, but I can&#39;t get it working (Basically removing the need to move through different files)."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "reply_to_user": {"reputation": 1, "user_id": 5188798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e8a7d2a582f04dea412633aac777f8?s=128&d=identicon&r=PG&f=1", "display_name": "Rados\u0142aw Zakrzewski", "link": "https://stackoverflow.com/users/5188798/rados%c5%82aw-zakrzewski"}, "edited": false, "score": 0, "creation_date": 1438869918, "post_id": 31834635, "comment_id": 51635244, "body": "The changes you&#39;ve mentioned in your first comment is exactly what you have make. You have to make those changes and that&#39;s the reason, I&#39;ve kept the file path and name like that. Let me know if you are still facing issues."}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": true, "score": 0, "last_activity_date": 1438783045, "creation_date": 1438783045, "answer_id": 31834635, "question_id": 31834156, "link": "https://stackoverflow.com/questions/31834156/running-a-macro-through-multiple-files/31834635#31834635", "title": "Running a macro through multiple files", "body": "<p>You can create small .vbs file which you can run (by double click) and it will run your macro automatically on all your files in a specified folder.</p>\n\n<p>First of all export your working macro to some location. And then copy paste below lines in a text file and save it as .vbs file.</p>\n\n<pre><code>Dim objFSO, objStartFolder, objFolder, colFiles, filePath\nDim xlApp, xlBook\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nobjStartFolder = \"Your folder path\"\n\nSet objFolder = objFSO.GetFolder(objStartFolder)\nSet colFiles = objFolder.Files\nFor Each objFile in colFiles\n    filePath = objStartFolder &amp; \"\\\" &amp; objFile.Name\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    xlApp.Visible = False\n\n    Set xlBook = xlApp.Workbooks.Open(filePath)\n    xlApp.VBE.ActiveVBProject.VBComponents.Import \"Path to your .bas file\"\n    xlApp.Run \"Name of your Sub\"\n    xlBook.Save\n    xlBook.Close\n    xlApp.Quit\nNext\n\nSet colFiles = Nothing : Set objFolder = Nothing : Set objFSO = Nothing\nSet xlBook = Nothing : Set xlApp = Nothing : Set fso = Nothing   \n</code></pre>\n\n<p>Just change the path in the file.</p>\n"}, {"tags": [], "owner": {"reputation": 712, "user_id": 3243922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFTEb.jpg?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3243922/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1438783490, "creation_date": 1438783490, "answer_id": 31834829, "question_id": 31834156, "link": "https://stackoverflow.com/questions/31834156/running-a-macro-through-multiple-files/31834829#31834829", "title": "Running a macro through multiple files", "body": "<p>Instead of creating a vbs file you could also create an Excel Addin. This addin can contain the macro that you need to run for every workbook. Workbooks do need to be opened to execute the macro, but they can be opened (and later closed) without them being visible. I would also advise you to set any Workbook objects you create to nothing when you are finished with them. (Set wbk = Nothing)</p>\n"}, {"tags": [], "owner": {"reputation": 74, "user_id": 4040187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32f9d119dc16350e54cde4183e120ef?s=128&d=identicon&r=PG", "display_name": "Wil Wang", "link": "https://stackoverflow.com/users/4040187/wil-wang"}, "is_accepted": false, "score": 0, "last_activity_date": 1438783922, "creation_date": 1438783922, "answer_id": 31834990, "question_id": 31834156, "link": "https://stackoverflow.com/questions/31834156/running-a-macro-through-multiple-files/31834990#31834990", "title": "Running a macro through multiple files", "body": "<p>You can use the Dir() function in VBA to get a list of all the files in a particular directory. Then it's just a matter of looping through each of the files to open, run macro, save, and then close. </p>\n\n<p>Here is some code:</p>\n\n<pre><code>sPath = \"U:\\ZBROJARNIA\\_WSPOLNE\\\"\nsFile = Dir(sPath)\nDo While sFile &lt;&gt; \"\"\n  sFilePath = sPath + sFile\n  Set wkBk = Workbook.Open(sFilePath)\n\n  sName = sFile + \"!Przeroby\"\n  Application.Run sName\n\n  wkBk.Save\n  wkBk.Close\n  sFile = Dir()\nLoop\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5188798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5e8a7d2a582f04dea412633aac777f8?s=128&d=identicon&r=PG&f=1", "display_name": "Rados\u0142aw Zakrzewski", "link": "https://stackoverflow.com/users/5188798/rados%c5%82aw-zakrzewski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 31834635, "answer_count": 3, "score": 0, "last_activity_date": 1441291420, "creation_date": 1438781790, "last_edit_date": 1441291420, "question_id": 31834156, "link": "https://stackoverflow.com/questions/31834156/running-a-macro-through-multiple-files", "title": "Running a macro through multiple files", "body": "<p>I've got a folder with ~300-600 files (depends on month), with various names.</p>\n\n<p>I want to run a macro in each file, without opening them separately. Is that possible ?</p>\n\n<p>Below is the macro I want to run. It does work when I open the files one by one, but with so many of them, I would like to cut some time.</p>\n\n<pre><code>Sub Przeroby()\n\nDim wbk1 As Workbook\nDim wbk2 As Workbook\nDim y As Variant\nDim sht As Worksheet\nDim LA As Integer\nDim Z As Variant\n\nSet wbk1 = ActiveWorkbook\nSet wbk2 = Workbooks.Open(\"U:\\ZBROJARNIA\\_WSPOLNE\\Przeroby-podsumowanie.xlsx\")\nwbk1.Activate\n\nSet sht = wbk2.Sheets(1)\n\ny = sht.Columns(\"A\").Find(\"\", sht.Cells(sht.Rows.Count, \"A\"), xlValues, xlWhole, , xlNext).Row\nx = Application.Sheets.Count\n\n LA = 2\n\nDo While LA &lt; x\n\nZ = wbk1.Sheets(LA).Range(\"D12\").Formula\nsht.Cells(y, 1).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"N12\").Formula\nsht.Cells(y, 2).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"D14\").Formula\nsht.Cells(y, 3).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"D11\").Formula\nsht.Cells(y, 4).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"D10\").Formula\nsht.Cells(y, 6).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U60\").Value\nsht.Cells(y, 8).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U59\").Value\nsht.Cells(y, 9).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U58\").Value\nsht.Cells(y, 10).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U57\").Value\nsht.Cells(y, 11).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U56\").Value\nsht.Cells(y, 12).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U55\").Value\nsht.Cells(y, 13).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U54\").Value\nsht.Cells(y, 14).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U53\").Value\nsht.Cells(y, 15).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U54\").Value\nsht.Cells(y, 16).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U53\").Value\nsht.Cells(y, 17).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U52\").Value\nsht.Cells(y, 18).Formula = Z\n\nZ = wbk1.Sheets(LA).Range(\"U51\").Value\nsht.Cells(y, 19).Formula = Z\n\n\nLA = LA + 1\ny = y + 1\nRange(\"U49:U60\").Copy\n\n\nLoop\n\nwbk2.Save\nwbk2.Close\n\n\nEnd Sub\n</code></pre>\n\n<p>I know it's not perfect, but it gets the job done. Also, any tips with the above will be appreciated.</p>\n\n<p>Edit: The target directory is on another computer, to which I connect via internal network. \nFile with sorted data is on yet another network drive. </p>\n"}, {"tags": ["vba", "excel", "indexing", "match"], "answers": [{"tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1438784269, "creation_date": 1438784269, "answer_id": 31835134, "question_id": 31834137, "link": "https://stackoverflow.com/questions/31834137/putting-a-string-from-a-cell-into-the-middle-of-my-index-match-vba-script/31835134#31835134", "title": "putting a string from a cell into the middle of my index-match VBa script", "body": "<p>You need to use the <strong>Range</strong> member of worksheet\nso use 'test sheet two'!Range(\"J2:J2369\") rather than 'test sheet two'!(\"J2:J2369\").</p>\n\n<p>The following runs</p>\n\n<pre><code>ActiveCell.Formula = _\n    \"=INDEX('test sheet two'!Range(\"\"\" &amp; Range(\"J3\") &amp; \"\"\") _ \n      ,MATCH(Sheet1!A5,'test sheet two'!Range(\"\"\" &amp; Range(\"J1\") &amp; \"\"\"),0))\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1438784792, "creation_date": 1438784792, "answer_id": 31835332, "question_id": 31834137, "link": "https://stackoverflow.com/questions/31834137/putting-a-string-from-a-cell-into-the-middle-of-my-index-match-vba-script/31835332#31835332", "title": "putting a string from a cell into the middle of my index-match VBa script", "body": "<p>Your formula was not including the column criteria for the <code>INDEX</code> Function.</p>\n\n<p>Try:</p>\n\n<pre><code>Range(\"B7\").Select\nActiveCell.Formula = \"=INDEX('test sheet two'!\" &amp; Range(\"J3\") &amp; \",\" &amp;  _\n\"MATCH(Sheet1!A5,'test sheet two'!\" &amp; Range(\"J1\") &amp; \",0), 1)\"\n</code></pre>\n\n<p>Notice the additional <code>, 1)\"</code> on the end of the formula.</p>\n\n<p>Also, you do not have to first <code>Select</code> the cell which you want to enter the formula in, you could just use:</p>\n\n<pre><code>Range(\"B7\").Formula = \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5194138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25c392f8471e36ec2daecf434cc03a78?s=128&d=identicon&r=PG&f=1", "display_name": "Fahvs", "link": "https://stackoverflow.com/users/5194138/fahvs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1438846007, "creation_date": 1438781743, "last_edit_date": 1438846007, "question_id": 31834137, "link": "https://stackoverflow.com/questions/31834137/putting-a-string-from-a-cell-into-the-middle-of-my-index-match-vba-script", "title": "putting a string from a cell into the middle of my index-match VBa script", "body": "<p>I am trying to use the index-match formula to reorganize data such that all of the names in column J that have a matching value in column A will be placed in the same spot. I'm going to do this for 5 different columns so that the 5 names on a team will be in the same row as the name of the corresponding client. </p>\n\n<p>My issue is that the index-match formula needs to be able to dynamically shorten or lengthen the size the arrays it uses based on how many clients there are when the VBA script is run. </p>\n\n<p>I can dynamically determine what numbers I need in the formula using <code>COUNTA</code>, but the code will not compile when I try to put it in my formula. My formula is below </p>\n\n<pre><code>Range(\"B7\").Select\nActiveCell.Formula = \"=INDEX('test sheet two'!\" &amp; Range(\"J3\") &amp; \",MATCH(Sheet1!A5,'test sheet two'!\" &amp; Range(\"J1\") &amp; \",0)\"\n</code></pre>\n\n<p>As you can see I need the strings in cells J3 and J1 to be used as the arrays for the index match. <code>J3 = $J$2:$J$2369</code> and <code>J1 = $A$2:$A$1113</code></p>\n\n<p>When I run the code it gives me a \"Application-Defined or Object-defined error.\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1096, "user_id": 5144555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0f1046a519313e19ad3929479ec85?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S Priz", "link": "https://stackoverflow.com/users/5144555/michael-s-priz"}, "edited": false, "score": 0, "creation_date": 1438785612, "post_id": 31834058, "comment_id": 51593080, "body": "In the future I recommend poking around the microsoft documentation before posting here. Sometimes it is difficult to know exactly what you are looking for but in this case you could have found your answer by googling &quot;vba datalabel&quot;. :)"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "edited": false, "score": 0, "creation_date": 1438789170, "post_id": 31835584, "comment_id": 51595611, "body": "Thank you. And I have poked around but I have a lot to do and there are so many people who give great answers on here."}], "tags": [], "owner": {"reputation": 1096, "user_id": 5144555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1c0f1046a519313e19ad3929479ec85?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S Priz", "link": "https://stackoverflow.com/users/5144555/michael-s-priz"}, "is_accepted": true, "score": 1, "last_activity_date": 1438785389, "last_edit_date": 1592644375, "creation_date": 1438785389, "answer_id": 31835584, "question_id": 31834058, "link": "https://stackoverflow.com/questions/31834058/orientation-of-datalabels/31835584#31835584", "title": "Orientation of DataLabels", "body": "<p>A <code>Point</code> object has a <code>DataLabel</code> member. Each <code>DataLabel</code> has a member called <code>orientation</code>. According to <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff822933.aspx\" rel=\"nofollow noreferrer\">Microsoft Documentation</a></p>\n<blockquote>\n<p>The value of this property can be set to an integer value from \u201390 to 90 degrees or to one of the following constants:</p>\n<p>xlDownward</p>\n<p>xlHorizontal</p>\n<p>xlUpward</p>\n<p>xlVertical</p>\n</blockquote>\n<p>So the solution to your problem is simpy:</p>\n<pre><code>mySrs.Points(nPts).DataLabel.Orientation = 90\n</code></pre>\n<p>Should be simple as that :)</p>\n"}, {"comments": [{"owner": {"reputation": 662, "user_id": 10576762, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03aade45664029c6be4845d2785f979a?s=128&d=identicon&r=PG&f=1", "display_name": "AbsoluteSpace", "link": "https://stackoverflow.com/users/10576762/absolutespace"}, "edited": false, "score": 1, "creation_date": 1565577161, "post_id": 57455055, "comment_id": 101384348, "body": "Generally, answers are more helpful if they include an explanation of what the code is intended to do, and why that solves the problem without introducing others."}], "tags": [], "owner": {"reputation": 1, "user_id": 11915650, "user_type": "registered", "profile_image": "https://graph.facebook.com/2371316986283617/picture?type=large", "display_name": "Ricardo F G Silva", "link": "https://stackoverflow.com/users/11915650/ricardo-f-g-silva"}, "is_accepted": false, "score": 0, "last_activity_date": 1565576878, "creation_date": 1565576878, "answer_id": 57455055, "question_id": 31834058, "link": "https://stackoverflow.com/questions/31834058/orientation-of-datalabels/57455055#57455055", "title": "Orientation of DataLabels", "body": "<p>This worked to me,</p>\n\n<pre><code>Dim cht As Chart\nSet cht = Sheets(\"MySheet\").Shapes.AddChart2.Chart\nDim rng As Range\ncht.SetSourceData Source:=Range(\"MySheet!B3:G3\")\n'Many other chart formatting options...\n\ncht.FullSeriesCollection(1).Select\ncht.FullSeriesCollection(1).ApplyDataLabels\ncht.FullSeriesCollection(1).DataLabels.Select\nSelection.Orientation = xlUpward\nSelection.Format.TextFrame2.Orientation = msoTextOrientationUpward\n\n'In my case this will put the labels in the middle of the bars\nSelection.Position = xlLabelPositionCenter\n\n' From here it is just more formatting\nWith Selection.Format.TextFrame2.TextRange.Font.Fill\n   .Visible = msoTrue\n   .ForeColor.ObjectThemeColor = msoThemeColorBackground1\n   .ForeColor.TintAndShade = 0\n   .ForeColor.Brightness = 0\n   .Transparency = 0\n   .Solid\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 5152545, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2a915e73e126408742609a3da5e5938e?s=128&d=identicon&r=PG&f=1", "display_name": "Alex664", "link": "https://stackoverflow.com/users/5152545/alex664"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2234, "favorite_count": 0, "accepted_answer_id": 31835584, "answer_count": 2, "score": 0, "last_activity_date": 1565576878, "creation_date": 1438781553, "last_edit_date": 1531164843, "question_id": 31834058, "link": "https://stackoverflow.com/questions/31834058/orientation-of-datalabels", "title": "Orientation of DataLabels", "body": "<p>I have this code that I found on the internet to add the name from the legend to the point on the series in the chart. My problem has been trying to rotate the label so it is rotated 90 degrees. Would anybody know how to incorporate the orientation property into this code?</p>\n\n<p>Thank you</p>\n\n<pre><code>Dim mySrs As Series\nDim nPts As Long\n\n    For Each mySrs In ActiveChart.SeriesCollection\n        With mySrs\n            nPts = .Points.Count\n            mySrs.Points(nPts).ApplyDataLabels _\n            Type:=xlDataLabelsShowValue, _\n            AutoText:=True, LegendKey:=False\n            mySrs.Points(nPts).DataLabel.Text = mySrs.Name\n        End With\n    Next\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 1, "creation_date": 1438782320, "post_id": 31833509, "comment_id": 51590553, "body": "Fill 3 separate 2D arrays and then loop to combine them into one. Looping through arrays are much faster than through cells in a range."}], "answers": [{"comments": [{"owner": {"reputation": 1359, "user_id": 2962937, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/fqCK7.jpg?s=128&g=1", "display_name": "CaffeinatedMike", "link": "https://stackoverflow.com/users/2962937/caffeinatedmike"}, "edited": false, "score": 0, "creation_date": 1455380689, "post_id": 31834776, "comment_id": 58469265, "body": "This is brilliant and exactly what I&#39;ve been looking for in order to dump 4 non-contingent ranges (columns), run a countif on all the rows, then highlight the necessary (duplicate) rows. Thank you!"}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 3, "last_activity_date": 1438783401, "creation_date": 1438783401, "answer_id": 31834776, "question_id": 31833509, "link": "https://stackoverflow.com/questions/31833509/putting-separate-ranges-into-2d-array/31834776#31834776", "title": "Putting separate ranges into 2D array", "body": "<p>As described in the comments, you can fill three 2-D arrays. You can then populate a fourth array from the three arrays, like below.</p>\n\n<pre><code>Sub populateArray()\n    Dim arrColOne() As Variant, arrColTwo() As Variant, arrColThree() As Variant\n    Dim arrAllData() As Variant\n    Dim i As Long\n\n    arrColOne = Range(\"A2:A\" &amp; lrow(1)) 'amend column number\n    arrColTwo = Range(\"D2:D\" &amp; lrow(4))\n    arrColThree = Range(\"G2:G\" &amp; lrow(7))\n\n    ReDim arrAllData(1 To UBound(arrColOne, 1), 2) As Variant\n    For i = 1 To UBound(arrColOne, 1)\n        arrAllData(i, 0) = arrColOne(i, 1)\n        arrAllData(i, 1) = arrColTwo(i, 1)\n        arrAllData(i, 2) = arrColThree(i, 1)\n    Next i\nEnd Sub\n\nPublic Function lrow(colNum As Integer) As Long\n    lrow = Cells(Rows.Count, colNum).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p>The above will require all 3 columns to be the same length (otherwise populating the last array will not work); this is due to the fourth array being redimensioned to contain the number of elements contained in the first array.</p>\n\n<blockquote>\n  <p>Testing with 250,000 rows of data, the fourth array populated in 0.43 seconds.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 335, "user_id": 4966360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-PcORqx6kLj0/AAAAAAAAAAI/AAAAAAAAAd8/yNiL7WdTgmE/photo.jpg?sz=128", "display_name": "Dunn", "link": "https://stackoverflow.com/users/4966360/dunn"}, "edited": false, "score": 0, "creation_date": 1438786058, "post_id": 31834812, "comment_id": 51593473, "body": "I don&#39;t think I can use it that way in this case, but it&#39;s a usefull idea, so I&#39;m saving your code for future reference. Thanks!"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 1, "last_activity_date": 1438784426, "last_edit_date": 1438784426, "creation_date": 1438783461, "answer_id": 31834812, "question_id": 31833509, "link": "https://stackoverflow.com/questions/31833509/putting-separate-ranges-into-2d-array/31834812#31834812", "title": "Putting separate ranges into 2D array", "body": "<p>How lenient are you with the array you get in return? I can get you a <code>Array(col)(row)</code>-style array, without having to loop to get it, if that works. Note that's not <code>Array(col, row)</code>, by the way. It's a single-dimensional array of columns, with each element containing a single-dimensional array of row values. If you're okay with that, you can do this:</p>\n\n<pre><code>Dim a(1 To 3)\na(1) = WorksheetFunction.Index(WorksheetFunction.Transpose(Range(\"AA2:AA10\")), 1, 0)\na(2) = WorksheetFunction.Index(WorksheetFunction.Transpose(Range(\"K2:K10\"  )), 1, 0)\na(3) = WorksheetFunction.Index(WorksheetFunction.Transpose(Range(\"L2:L10\"  )), 1, 0)\n</code></pre>\n\n<p>Then you could access your array items like so:</p>\n\n<pre><code>Debug.Print UBound(a)     ' Number of columns (3)\nDebug.Print UBound(a(1))  ' Number of rows in column 1\nDebug.Print a(1)(3)       ' Value of column 1 (AA), row 3\n</code></pre>\n\n<p>The <code>Index()</code> function can return a 1D array but only in the <em>rows</em> direction. So, you need to combine it with <code>Transpose()</code> to return a 1D column array. That's all the code above is doing.</p>\n"}, {"comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438785904, "post_id": 31835356, "comment_id": 51593343, "body": "This is what I do in my answer, too. You can actually get rid of that 2D array, however (and the need to always specify the <code>1</code> column index for it), with a combination of <code>Index()</code> and <code>Transpose()</code>."}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438786131, "post_id": 31835356, "comment_id": 51593525, "body": "@Bond Sorry, I was writing while you answered. I&#39;m not a pro and my goal is just to reciprocate the help received."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1438786226, "post_id": 31835356, "comment_id": 51593577, "body": "Absolutely. Wasn&#39;t trying to imply that you shouldn&#39;t have posted this. Just wanted to high-five for both coming up with similar solutions!"}], "tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": false, "score": 1, "last_activity_date": 1438785434, "last_edit_date": 1438785434, "creation_date": 1438784852, "answer_id": 31835356, "question_id": 31833509, "link": "https://stackoverflow.com/questions/31833509/putting-separate-ranges-into-2d-array/31835356#31835356", "title": "Putting separate ranges into 2D array", "body": "<p>What about an array of arrays?</p>\n\n<pre><code>Sub NoLoop()\nDim R1 As Range, R2 As Range, R3 As Range\nDim Arr1() As Variant, Arr2() As Variant, Arr3() As Variant\n\nDim LR As Long\nLR1 = Cells(Rows.Count, \"AA\").End(xlUp).Row\nLR2 = Cells(Rows.Count, \"K\").End(xlUp).Row\nLR3 = Cells(Rows.Count, \"L\").End(xlUp).Row\n\nSet R1 = Range(Cells(1, \"AA\"), Cells(LR1, \"AA\"))\nSet R2 = Range(Cells(1, \"K\"), Cells(LR2, \"K\"))\nSet R3 = Range(Cells(1, \"L\"), Cells(LR3, \"L\"))\n\nArr1 = R1.Value\nArr2 = R2.Value\nArr3 = R3.Value\n\nArrArr = Array(Arr1, Arr2, Arr3)\n\nEnd Sub\n</code></pre>\n\n<p>With this you can call your values using:</p>\n\n<pre><code>MyVal = ArrArr(0)(1,1)\nMyVal = ArrArr(0)(2,1)\nMyVal = ArrArr(1)(1,1)\n</code></pre>\n\n<p>Where the first number is for the array (starts from 0 and ends with 2) and the second number is for row/cell of the range used to fill array.\nThe third number is always 1 (because adding a range to an array returns a bidimensional array)</p>\n\n<p>With this code you can also have different dimensions for each column so to save memory.</p>\n"}], "owner": {"reputation": 335, "user_id": 4966360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-PcORqx6kLj0/AAAAAAAAAAI/AAAAAAAAAd8/yNiL7WdTgmE/photo.jpg?sz=128", "display_name": "Dunn", "link": "https://stackoverflow.com/users/4966360/dunn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3565, "favorite_count": 1, "accepted_answer_id": 31834776, "answer_count": 3, "score": 3, "last_activity_date": 1438785651, "creation_date": 1438780147, "last_edit_date": 1531164843, "question_id": 31833509, "link": "https://stackoverflow.com/questions/31833509/putting-separate-ranges-into-2d-array", "title": "Putting separate ranges into 2D array", "body": "<p>I'm trying to get a 2D array of size <code>[x][3]</code> filled. <code>X</code> is just the size of the sheet (number of rows) and there are 3 columns which I am interested in. The columns are not near each other, for instance <code>arr[i][0]</code> should be filled from column AA, <code>arr[i][1]</code> should come from column K, and <code>arr[i][2]</code> needs to be from columns L.</p>\n\n<p>I tried assigning it the following way, but got an error in the array value assignment.</p>\n\n<p>Any help on this would be greatly appreciated!</p>\n\n<p>Code:</p>\n\n<pre><code>Sub SOC_work()\n'Trying to sort each of the disciplines further, by Stage of Construction\n\nDim ar_SOC() As Variant\nDim int_NumRows As Long\nDim i_counter As Long\nDim j_Counter As Long\nDim lite As Range\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\nSheets(\"AVEVA_PBOM_PARTS\").Select\n\n\n'Redimension the array size to the amount of parts in the PBOM\nint_NumRows = ActiveSheet.UsedRange.Rows.count - 1\nReDim ar_SOC(int_NumRows, 3)\n\n'now assignt he range into the array space\nlite = Range(\"AA2\", Range(\"AA2\").End(xlDown))\n\n\nar_SOC[][1]=lite\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Is there any way to do this without looping through the entire column?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1438785192, "post_id": 31833493, "comment_id": 51592769, "body": "The Application.IfError part is not helping you get the correct value there, but that might not be the only problem."}], "answers": [{"tags": [], "owner": {"reputation": 1031, "user_id": 3953397, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/A5kkW.jpg?s=128&g=1", "display_name": "TheFullResolution", "link": "https://stackoverflow.com/users/3953397/thefullresolution"}, "is_accepted": false, "score": 0, "last_activity_date": 1438785749, "creation_date": 1438785749, "answer_id": 31835713, "question_id": 31833493, "link": "https://stackoverflow.com/questions/31833493/excel-vba-index-match-function-not-working-when-indexing-another-workbook/31835713#31835713", "title": "Excel VBA Index/Match function not working when indexing another workbook", "body": "<p>When I am using Index/Match in Macro I am typing formula like this:</p>\n\n<pre><code>Folder = Sheets(\"Overview\").Range(\"F4\")\nfilename = Sheets(\"Overview\").Range(\"G4\")\nfiletype = Sheets(\"Overview\").Range(\"H4\")\ntabname = Sheets(\"Overview\").Range(\"I4\")\nstyle = Sheets(\"Overview\").Range(\"J4\")\nSAPsizecode = Sheets(\"Overview\").Range(\"K4\")\n\n  ActiveCell.Formula = \"=INDEX('\" &amp; Folder &amp; \"\\[\" &amp; filename &amp; filetype &amp; \"]\" &amp; tabname &amp; \"'!$\" &amp; SAPsizecode &amp; \":$\" &amp; SAPsizecode &amp; \",MATCH(C2,'\" &amp; Folder &amp; \"\\[\" &amp; filename &amp; filetype &amp; \"]\" &amp; tabname &amp; \"'!$\" &amp; style &amp; \":$\" &amp; style &amp; \",0))\"\n</code></pre>\n\n<p>And this works for me. I think the problem in your code is how you are assigning the workbooks. With the approach above you don't need to open another workbook.</p>\n"}], "owner": {"reputation": 11, "user_id": 5194094, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73e5237e0f05cae0d1a540423d9c7bd?s=128&d=identicon&r=PG&f=1", "display_name": "Deon", "link": "https://stackoverflow.com/users/5194094/deon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 612, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438845516, "creation_date": 1438780123, "last_edit_date": 1438845516, "question_id": 31833493, "link": "https://stackoverflow.com/questions/31833493/excel-vba-index-match-function-not-working-when-indexing-another-workbook", "title": "Excel VBA Index/Match function not working when indexing another workbook", "body": "<p>I have a template that fills certain cells with sales data from another workbook but the other workbook has a new name for each month. When I try to assign a variable as the workbook name so that it finds it each time, I can't get the index/match function to work. Not sure where the error is but is the point where the VBA script fails...</p>\n\n<pre><code>Sub GetNetSales()\n\n    Dim Period As String\n    Dim NS As Workbook\n    Dim Can As Workbook\n    Dim BookName As String\n    Period = Range(\"Per\").Value\n\n    Set Can = ThisWorkbook\n\n    ChDir \"C:\\Users\\dlibby\\Documents\\\" &amp; Period\n    Workbooks.Open Filename:= _\n        \"C:\\Users\\dlibby\\Documents\\\" &amp; Period &amp; \"\\Net Sales \" &amp; Period &amp; \".xlsx\"\n\n\n    Set NS = ThisWorkbook\n\n    Can.Activate\n    Range(\"C10\").Select\n    ActiveCell = _\n        Application.IfError(Application.Index(NS.Sheets(\"CM Sales\").Columns(\"E:E\"), Application.Match(Can.Range(\"H10\").Value, NS.Sheets(\"CM Sales\").Columns(\"A:A\"), 0)), 0).Value\n    Range(\"C10\").Select\n    Selection.Copy\n    Range(\"C11:C12\").Select\n    ActiveSheet.Paste\n    Range(\"C16:C22\").Select\n    ActiveSheet.Paste\n\n    Application.Calculate\n\n    Range(\"C10:C12\").Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"C16:C22\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "recordset"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438779923, "post_id": 31833320, "comment_id": 51588660, "body": "&quot;<i>Does not work</i>&quot; is not a specific problem statement."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1438781870, "creation_date": 1438781870, "answer_id": 31834191, "question_id": 31833320, "link": "https://stackoverflow.com/questions/31833320/vba-on-click-delete-records-of-a-table/31834191#31834191", "title": "VBA on click_ delete records of a table", "body": "<p>In your for loop you are not comparing the right elements. When you do:</p>\n\n<pre><code>Set PE_ID = rs_date.Fields(\"Pricing_Element_ID\")\n</code></pre>\n\n<p>you set PE_ID to the value of the Pricing_Element_ID of the first record. You intend to set a reference to it, and everytime the recordset advances to the next record, you want this reference to be updated. But that's not how it works. You have to get the field in the <em>current record</em> every time you advance the recordset. So you have to write:</p>\n\n<pre><code>If Me!Pricing_Element_ID = rs_date.Fields(\"Pricing_Element_ID\") Then\n</code></pre>\n\n<p>Note: from experience I found the count of a recordset is not always accurate. So rather than a for loop, use a while loop:</p>\n\n<pre><code>While (Not EOF(rs_date))\n    If Me!Pricing_Element_ID = rs_date.Fields(\"Pricing_Element_ID\") Then\n        rs_date.DELETE\n    Else\n        rs_date.MoveNext\n    End If\nWend\n</code></pre>\n\n<p>Note also that there is no need to proces the recordset from last to first; just advance to next until EOF.</p>\n"}], "owner": {"reputation": 1, "user_id": 4805455, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/41a8b9ff6ca515bef342a340150ffe5a?s=128&d=identicon&r=PG&f=1", "display_name": "CHARUEL Damien", "link": "https://stackoverflow.com/users/4805455/charuel-damien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 448, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438803633, "creation_date": 1438779671, "last_edit_date": 1438803633, "question_id": 31833320, "link": "https://stackoverflow.com/questions/31833320/vba-on-click-delete-records-of-a-table", "title": "VBA on click_ delete records of a table", "body": "<p>I am trying to delete the records of a table rather than deleting the records of a form. I have the following code, which does not work:</p>\n\n<p>please can someone help.</p>\n\n<pre><code>Private Sub Cmd_X_Click()\n\nDim db As DAO.Database\nDim rs As DAO.Recordset\nDim rsCount As Integer\n\nDim BizNO As Field\nDim Bank_Role As Field\n\nDim i, j As Integer\n\nSet db = CurrentDb()\nSet rs_date = db.OpenRecordset(\"TRD_Pricing-In date_REAL\")\n\nSet PE_ID = rs_date.Fields(\"Pricing_Element_ID\")\nrs_date.MoveLast\nrs_dateCount = rs_date.RecordCount\n\nMsgBox (rs_dateCount)\nMsgBox (Me.Pricing_Element_ID)\nMsgBox (PE_ID.Value)\n\nrs_date.MoveLast\n\n\nFor i = 1 To rs_dateCount\n\n    If Me!Pricing_Element_ID = PE_ID Then\n    rs_date.DELETE\n    Else\n    rs_date.MovePrevious\n    End If\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 4, "last_activity_date": 1438779043, "creation_date": 1438779043, "answer_id": 31833059, "question_id": 31832969, "link": "https://stackoverflow.com/questions/31832969/print-sheetnames-on-separate-sheet/31833059#31833059", "title": "Print sheetnames on separate sheet", "body": "<p>Try this:</p>\n\n<pre><code>For i = 1 To Sheets.Count\n    Worksheets(\"Blad2\").Range(\"A1\").Offset(RowOffset:=i) = Sheets(i).Name\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": false, "score": 3, "last_activity_date": 1438779044, "creation_date": 1438779044, "answer_id": 31833060, "question_id": 31832969, "link": "https://stackoverflow.com/questions/31832969/print-sheetnames-on-separate-sheet/31833060#31833060", "title": "Print sheetnames on separate sheet", "body": "<pre><code>Sub namesSheet()\n\nFor i = 1 To Sheets.Count\n    Var = Sheets(i).Name\n    Worksheets(\"Blad2\").Range(\"A\" &amp; i) = Var\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": true, "score": 3, "last_activity_date": 1438779085, "creation_date": 1438779085, "answer_id": 31833083, "question_id": 31832969, "link": "https://stackoverflow.com/questions/31832969/print-sheetnames-on-separate-sheet/31833083#31833083", "title": "Print sheetnames on separate sheet", "body": "<p>you have to set the counter for the cell too\n    Sub namesSheet()</p>\n\n<pre><code>For i = 1 To Sheets.Count\n    Var = Sheets(i).Name\n    Worksheets(\"Blad2\").cells(i,1) = Var\nNext i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 5033775, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4b8d96db097c6c7f22c0ec9fa68e6f3e?s=128&d=identicon&r=PG&f=1", "display_name": "Marc van der Peet", "link": "https://stackoverflow.com/users/5033775/marc-van-der-peet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 31833083, "answer_count": 3, "score": 1, "last_activity_date": 1483005036, "creation_date": 1438778818, "last_edit_date": 1531164843, "question_id": 31832969, "link": "https://stackoverflow.com/questions/31832969/print-sheetnames-on-separate-sheet", "title": "Print sheetnames on separate sheet", "body": "<p>I have created some VBA code through which I create a list of all sheet names in my excel. Now I would like to print all the values in sheet \"Blad2\" in cell A1, A2, A3 etc...</p>\n\n<p>Anybody some thoughts on how I can do this? Already got code below working but then its just overwriting the code in cell A2...</p>\n\n<pre><code>Sub namesSheet()\n\nFor i = 1 To Sheets.Count\n    Var = Sheets(i).Name\n    Worksheets(\"Blad2\").Range(\"A2\") = Var\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": true, "score": 4, "last_activity_date": 1438778772, "creation_date": 1438778772, "answer_id": 31832957, "question_id": 31832903, "link": "https://stackoverflow.com/questions/31832903/immediate-box-debug-window-display-separately/31832957#31832957", "title": "Immediate Box (Debug window) Display Separately", "body": "<p>Use the status bar:</p>\n\n<pre><code>Application.StatusBar = \"Row \" &amp; rowNum &amp; \" of \" &amp; rowCount\n</code></pre>\n\n<p>At the end, to clear the status bar:</p>\n\n<pre><code>Application.StatusBar = False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1438783519, "post_id": 31834463, "comment_id": 51591508, "body": "thank you very much for this code! it is much appreciated - however I went with the above answer until I finalize the function, then I will be trying to incorporate this code for end users!"}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 1, "last_activity_date": 1438782542, "creation_date": 1438782542, "answer_id": 31834463, "question_id": 31832903, "link": "https://stackoverflow.com/questions/31832903/immediate-box-debug-window-display-separately/31834463#31834463", "title": "Immediate Box (Debug window) Display Separately", "body": "<p>You can do it by displaying <strong>modeless user form</strong>. Below is an example how to do this.</p>\n\n<p>In order to make this example working properly <strong>you need to add new, empty UserForm to your project and change it name to <code>frmProgress</code></strong>.</p>\n\n<pre><code>Sub test()\n    Dim form As frmProgress\n    Dim lblProgress As Object\n    Dim i As Long\n    '-------------------------------------------------\n\n    'Create an instance of user form and show it modeless on the screen.\n    Set form = New frmProgress\n    With form\n        .Width = 200\n        .Height = 60\n        .Caption = \"Progress\"\n\n        'Add label for displaying text...\n        Set lblProgress = .Controls.Add(\"Forms.Label.1\", \"lblProgress\")\n        '... and format it to meet your requirements.\n        With lblProgress\n            .Width = 200\n            .Height = 60\n            .TextAlign = fmTextAlignCenter\n            .Font.Size = 12\n            .Top = 6\n        End With\n\n        Call .Show(vbModeless)\n\n    End With\n\n\n\n\n    For i = 1 To 100000\n\n        '(Some code ...)\n\n        DoEvents\n\n        'Here the new text is inserted on the message box.\n        lblProgress.Caption = i\n\n    Next i\n\n\n    Call form.Hide\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 31832957, "answer_count": 2, "score": 1, "last_activity_date": 1438782542, "creation_date": 1438778606, "last_edit_date": 1438779326, "question_id": 31832903, "link": "https://stackoverflow.com/questions/31832903/immediate-box-debug-window-display-separately", "title": "Immediate Box (Debug window) Display Separately", "body": "<p>I am really sorry if this is a silly question. I would like to display a message box similar to the <code>Immediate</code> window that will sit \"always on top\" and scroll a countdown while not interrupting the VBA program.</p>\n\n<p>I am essentially crunching numbers for 40,000 rows and each run takes about 15 minutes. I don't know if it's still running or when the current VBA code will complete.</p>\n\n<p>Does anyone have suggestions?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1422, "user_id": 3179747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf7fbd47419df571480f649e0b9c4b0?s=128&d=identicon&r=PG&f=1", "display_name": "ankh-morpork", "link": "https://stackoverflow.com/users/3179747/ankh-morpork"}, "edited": false, "score": 1, "creation_date": 1438775804, "post_id": 31831546, "comment_id": 51585620, "body": "The wording of your question is exceeding unclear. Please clarify what you are trying to do and show what have already attempted including any code."}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "reply_to_user": {"reputation": 1422, "user_id": 3179747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf7fbd47419df571480f649e0b9c4b0?s=128&d=identicon&r=PG&f=1", "display_name": "ankh-morpork", "link": "https://stackoverflow.com/users/3179747/ankh-morpork"}, "edited": false, "score": 0, "creation_date": 1438778946, "post_id": 31831546, "comment_id": 51587875, "body": "Hi, in an excel file I have 4 columns header. 1st column is named as Overall status, 2nd column as Cost, 3rd column as benefits &amp; 4th column  as resources. Each column will have values in it such as either R means Red, G means Green &amp; A means Amber. Only the Overall Status column remained empty unless one of the 3 other columns contain the value R in any of its rows. thus,the overall status column will appear as value A. for eg: if in row 2 in column resources contains value R while both columns on benefit and cost contain value &quot;G&quot; the &quot;overall status&quot; column in row 2 will appear as value &quot;A&quot;"}, {"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "reply_to_user": {"reputation": 1422, "user_id": 3179747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf7fbd47419df571480f649e0b9c4b0?s=128&d=identicon&r=PG&f=1", "display_name": "ankh-morpork", "link": "https://stackoverflow.com/users/3179747/ankh-morpork"}, "edited": false, "score": 0, "creation_date": 1438779041, "post_id": 31831546, "comment_id": 51587963, "body": "I have deleted the previous coding that I have done because it doesn&#39;t work at all"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1438828456, "post_id": 31833537, "comment_id": 51612997, "body": "Thank you for your help! it works!"}, {"owner": {"reputation": 341, "user_id": 5023744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb6a7bb1753d5cfa94ab260807ff68ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitish", "link": "https://stackoverflow.com/users/5023744/nitish"}, "reply_to_user": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "edited": false, "score": 0, "creation_date": 1438855906, "post_id": 31833537, "comment_id": 51625659, "body": "If it helps you please vote or accept the answer"}], "tags": [], "owner": {"reputation": 341, "user_id": 5023744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb6a7bb1753d5cfa94ab260807ff68ce?s=128&d=identicon&r=PG&f=1", "display_name": "Nitish", "link": "https://stackoverflow.com/users/5023744/nitish"}, "is_accepted": true, "score": 2, "last_activity_date": 1438790649, "last_edit_date": 1438790649, "creation_date": 1438780215, "answer_id": 31833537, "question_id": 31831546, "link": "https://stackoverflow.com/questions/31831546/input-values-in-a-column-according-to-the-reference-from-another-column-of-the-s/31833537#31833537", "title": "Input values in a column according to the reference from another column of the same sheet", "body": "<p>You don't need vba for this you can write a simple formula like </p>\n\n<pre><code>=IF(ISERROR(MATCH(\"R\",B2:D2,0)),\"\",\"A\")\n</code></pre>\n\n<p>If You want code please try this </p>\n\n<pre><code>Sub rgb()\nDim lstrow As Long\nDim i As Long\nDim LastCol As Long\nDim j As Long\n\nlstrow = Range(\"B\" &amp; Sheets(\"Sheet1\").Rows.Count).End(xlUp).Row\nLastCol = Sheets(\"Sheet1\").Cells(1, Sheets(\"Sheet1\").Columns.Count).End(xlToLeft).Column\nFor i = 2 To lstrow\n    For j = 2 To LastCol\n        If ActiveSheet.Cells(i, j).Value = \"R\" Then\n            Range(\"A\" &amp; i).Value = \"A\"\n        End If\n    Next j\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 211, "user_id": 5187872, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3011a8c67635babd2781b18bb5320b6c?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5187872/nabilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1438785175, "accepted_answer_id": 31833537, "answer_count": 1, "score": 0, "last_activity_date": 1438790649, "creation_date": 1438774973, "last_edit_date": 1531164843, "question_id": 31831546, "link": "https://stackoverflow.com/questions/31831546/input-values-in-a-column-according-to-the-reference-from-another-column-of-the-s", "closed_reason": "Needs details or clarity", "title": "Input values in a column according to the reference from another column of the same sheet", "body": "<p>hi I have a problem in inputting values into a column with conditions and referring to the other 2 or more columns to determine the input of the other column using VBA. for example there are 3 columns called RAG cost (C), RAG Resources (R) and RAG Benefits (B). this 3 columns will determine the input value in a column called Overall RAG using VBA.\nfor example if column (C) or column (B) contains the value\"R\" , then the overall RAG Status will be input as \"A\" in the respective rows. I tried using the if else statement but it doesn't seems to work.\nto make it clearer this is the example: if RAG Cost(C) OR RAG Resources(R) VALUES = \"R\" then Overall RAG status= \"A\".</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 248, "user_id": 4978922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LtnkY.jpg?s=128&g=1", "display_name": "PractLogical", "link": "https://stackoverflow.com/users/4978922/practlogical"}, "edited": false, "score": 0, "creation_date": 1438776435, "post_id": 31831528, "comment_id": 51586073, "body": "What you are trying to do is possible but seems unnecessary and taxing on the surface. Why not use AutoNumber to have Access generate a unique id for you?"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 248, "user_id": 4978922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LtnkY.jpg?s=128&g=1", "display_name": "PractLogical", "link": "https://stackoverflow.com/users/4978922/practlogical"}, "edited": false, "score": 0, "creation_date": 1438776731, "post_id": 31831528, "comment_id": 51586262, "body": "For the old database that is in place, the supplier code is entered manually and is used away from the database. To avoid confusion, or the user entering a wrong supplier code, I would like the new database to generate this code so the user doesn&#39;t have to."}, {"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438777121, "post_id": 31831528, "comment_id": 51586550, "body": "What is the name of the field you are storing the Supplier_Code? Are you appending these entries to the Suppliers table? If not, then what other table are you using to store the records that contain this new Supplier_Code?"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1438777734, "post_id": 31831528, "comment_id": 51586959, "body": "yes I would like to save supplier_Code to suppliers table. very amateur of me, but, I have realised that I will need to save the record first. correct? I was distracted by the supplier_ID showing up on the form. However, I don&#39;t think it is in the table at this point because I am able to cancel the form and the supplier_ID isn&#39;t saved."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1438778134, "post_id": 31831528, "comment_id": 51587273, "body": "There must be a different approach but I don&#39;t know how to go about it"}, {"owner": {"reputation": 248, "user_id": 4978922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LtnkY.jpg?s=128&g=1", "display_name": "PractLogical", "link": "https://stackoverflow.com/users/4978922/practlogical"}, "edited": false, "score": 0, "creation_date": 1438779446, "post_id": 31831528, "comment_id": 51588279, "body": "While someone can/will help you create a &#39;GetNextSupCod(strName as String) as String&#39; function, I can see some issues with the way you have the code in the AfterUpdate of the Supplier textbox. (can potentially create erroneous suppliers if the user edits the name after initial input; also, user might be entering the same supplier more than once, by mistake...so you might want to notify them before they commit.) I would suggest an [Add New Supplier] Button instead of AfterUpdate."}], "answers": [{"tags": [], "owner": {"reputation": 248, "user_id": 4978922, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LtnkY.jpg?s=128&g=1", "display_name": "PractLogical", "link": "https://stackoverflow.com/users/4978922/practlogical"}, "is_accepted": false, "score": 0, "last_activity_date": 1438787824, "last_edit_date": 1438787824, "creation_date": 1438781919, "answer_id": 31834206, "question_id": 31831528, "link": "https://stackoverflow.com/questions/31831528/creating-a-concatenated-code-from-another-field-value-with-unique-number-in-acce/31834206#31834206", "title": "Creating a Concatenated Code from another field value with unique number In Access VBA", "body": "<p>Here is something to get you started based on a button called cmdAddNewSupplier. You should have enough to adapt the example to your needs. <em>(Sorry, I edited because I forgot to mention that the example code is using a fictitious table called [SUPPLIERS] with a fictitious column name of [SUPPLIER_NAME]; you'll need to replace with the name of your table and column.)</em></p>\n\n<pre><code>Private Sub cmdAddNewSupplier_Click()\n  'TODO: create some error handling\n  'TODO: check for null value of SupplierName Textbox; notify user and exit if its null\n  'TODO: check for less than 2 chars for supplier name; notify user and exit if it's less than 2 chars (seems impossible, but can happen)\n  Dim strSupCode As String 'the eventual unique id of the new supplier\n\n  'make sure the user wants to add the supplier if the name already exists\n  'all we are doing is utilizing DLookup so we don't have to deal with recordset object\n  If Not IsNull(DLookup(\"[SUPPLIER_NAME]\", \"[SUPPLIERS]\", \"[SUPPLIER_NAME] = \" &amp; Chr(34) &amp; Me.Supplier_Name &amp; Chr(34))) Then\n    If MsgBox(Me.Supplier_Name &amp; \" Already Exists!\" &amp; vbCrLf &amp; \"Are you sure that you want to add them?\", vbYesNoCancel Or vbQuestion, \"Please Confirm\") &lt;&gt; vbYes Then\n      Exit Sub\n    End If\n  End If\n\n  strSupCode = GetSupplierCode(Me.Supplier_Name)\n\n  MsgBox Me.Supplier_Name &amp; vbCrLf &amp; strSupCode 'test it out to make sure it's working before doing anything for real\nEnd Sub\n\nFunction GetSupplierCode(strSupplierName As String) As String\n  Dim nLoop As Long\n  Dim strCode As String\n\n  strCode = UCase(Left(strSupplierName, 2))\n\n  'The supplier name is unique or the user means to add another supplier with the same name\n  For nLoop = 1 To 100 '100 same names is unlikely, eh?\n\n    'create a temp supplier code starting with 1 and increment\n    'the return value is being set, so all we have to do is jump out of function when unique is found\n    GetSupplierCode = strCode &amp; Format(nLoop, \"00\")\n\n    'TODO: utilize DLookup to check for existence; will leave this part to you;\n    'dont forget you are looking at CODE and not NAME here as we did in the button click function\n\n    '      if isnull(DLookup(&lt;enter the required parameters&gt;)) then\n    '         exit function 'jump out of the function because this one should be the next unique\n    '      end if\n\n  Next\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": true, "score": 0, "last_activity_date": 1438854241, "last_edit_date": 1438854241, "creation_date": 1438844344, "answer_id": 31848832, "question_id": 31831528, "link": "https://stackoverflow.com/questions/31831528/creating-a-concatenated-code-from-another-field-value-with-unique-number-in-acce/31848832#31848832", "title": "Creating a Concatenated Code from another field value with unique number In Access VBA", "body": "<p>I have managed to work out my issue with the following code:</p>\n\n<pre><code> Private Sub Supplier_Name_LostFocus()\n\nIf IsNull([Supplier_Code]) Then\n   Dim DB As Database\n   Dim RS As Recordset\n   Dim var2 As String\n   Dim var1 As String\n   Dim var3 As String\n\n\n   var1 = Left(Me.Supplier_Name, 2)\n\n   var2 = \"SELECT count(*) AS CountSupplier \" &amp; _\n          \"FROM Suppliers \" &amp; _\n          \"WHERE left(Suppliers.[Supplier_Name],2)='\" &amp; var1 &amp; \"';\"\n'   MsgBox (var2)\n\n\n\n   Set DB = CurrentDb\n   Set RS = DB.OpenRecordset(var2, dbOpenDynaset)\n   var3 = RS!CountSupplier + 1\n   Me.Supplier_Code = UCase(var1) &amp; Format(var3, \"00\")\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 31848832, "answer_count": 2, "score": 0, "last_activity_date": 1445511108, "creation_date": 1438774925, "last_edit_date": 1445511108, "question_id": 31831528, "link": "https://stackoverflow.com/questions/31831528/creating-a-concatenated-code-from-another-field-value-with-unique-number-in-acce", "title": "Creating a Concatenated Code from another field value with unique number In Access VBA", "body": "<p>I am generating a supplier form, where I will add the <code>Supplier_Name</code> and the <code>Supplier_Code</code> is auto-generated by taking the first two characters of <code>Supplier_Name</code> and adding a unique number for when 2 suppliers have the same first 2 characters e.g.:</p>\n\n<ul>\n<li>SundriesSupplier 1 = SU01;</li>\n<li>SugarSupplier 1 = SU02</li>\n</ul>\n\n<p>I am new to VBA and tried the following but it doesn't work:</p>\n\n<pre><code>Private Sub Supplier_Name_AfterUpdate()\n    Dim DB As Database\n    Dim RS As Recordset\n    Dim SQL As String\n    Dim var1 As String\n\n    var1 = Left(Me.Supplier_Name.Value, 2)\n\n    SQL = \"SELECT Supplier_ID, LEFT(Supplier_Name,2) AS charsupplier, count (Supplier_Name) AS countSupplier \" _\n        &amp; \"FROM Suppliers \" _\n        &amp; \"WHERE charsupplier = var1 \" _\n        &amp; \"ORDER BY Supplier_ID\"\n\n     Set DB = CurrentDb\n     Set RS = DB.OpenRecordset(SQL, dbOpenDynaset)\n\n    Me.Supplier_Code = var1 &amp; Format$(RS!countSupplier, \"00\")\n\n    End Sub\n</code></pre>\n\n<p>If anyone can help or suggest an alternative method that would be great thanks.</p>\n\n<blockquote>\n  <p>EDIT: I think the flaw in my approach may be that if this is on the new record, the supplier_ID is not saved to the table and will not be available for query?</p>\n</blockquote>\n"}, {"tags": ["vba", "loops", "if-statement"], "comments": [{"owner": {"reputation": 3537, "user_id": 326807, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/EQtEs.jpg?s=128&g=1", "display_name": "Reporter", "link": "https://stackoverflow.com/users/326807/reporter"}, "edited": false, "score": 0, "creation_date": 1438774012, "post_id": 31831154, "comment_id": 51584432, "body": "Does your code not work?"}], "answers": [{"tags": [], "owner": {"reputation": 455, "user_id": 3287424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KkDR4.jpg?s=128&g=1", "display_name": "sulhadin", "link": "https://stackoverflow.com/users/3287424/sulhadin"}, "is_accepted": true, "score": 2, "last_activity_date": 1438774194, "creation_date": 1438774194, "answer_id": 31831278, "question_id": 31831154, "link": "https://stackoverflow.com/questions/31831154/if-statement-in-loop-else-else-if/31831278#31831278", "title": "If Statement in loop - Else, Else If", "body": "<p>Try this;</p>\n\n<pre><code>    If (cell.offset(, -3) = cell.offset(1, -3)) Then\n        cell.value = cell.offset(, -1)\n    ElseIf (cell.offset(, -3) = cell.offset(-1, -3)) Then\n            cell.value = 0\n    Else\n        cell.valye = cell.offset(, -1)\n    End If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 1, "last_activity_date": 1438774496, "creation_date": 1438774496, "answer_id": 31831386, "question_id": 31831154, "link": "https://stackoverflow.com/questions/31831154/if-statement-in-loop-else-else-if/31831386#31831386", "title": "If Statement in loop - Else, Else If", "body": "<p>If you are not aware of the help availbale online regarding the syntax of commands you really should get familiar with it.</p>\n\n<p>eg if <a href=\"https://msdn.microsoft.com/en-us/library/752y8abs.aspx\" rel=\"nofollow\">here</a></p>\n\n<p>and generally <a href=\"https://msdn.microsoft.com/en-us/library/sh9ywfdk.aspx\" rel=\"nofollow\">here</a></p>\n\n<pre><code>For Each cell In Range(Cells(2, 5), Cells(lastrow1, 5))\n\n    If cell.Offset(, -3) = cell.Offset(1, -3) Then\n            cell.Value = cell.Offset(, -1)\n\n    ElseIf cell.Offset(, -3) = cell.Offset(-1, -3) Then\n\n        cell.Value = 0\n\n    Else\n\n        cell.Value = cell.Offset(, -1)\n\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5138496, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh6.googleusercontent.com/-tQCm5-14sgE/AAAAAAAAAAI/AAAAAAAAAC0/SdzQKzTsA18/photo.jpg?sz=128", "display_name": "Alex Walton", "link": "https://stackoverflow.com/users/5138496/alex-walton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 31831278, "answer_count": 2, "score": 1, "last_activity_date": 1438774496, "creation_date": 1438773889, "last_edit_date": 1438773965, "question_id": 31831154, "link": "https://stackoverflow.com/questions/31831154/if-statement-in-loop-else-else-if", "title": "If Statement in loop - Else, Else If", "body": "<p>I'm wondering if anyone could help with the below simple code:</p>\n\n<pre><code>For Each cell In Range(Cells(2, 5), Cells(lastrow1, 5))\n    If(cell.offset(, -3)=cell.offset(1,-3)) then cell.value = cell.offset(,-1),else if(cell.offset(, -3)=cell.offset(-1,-3),cell.value = 0,else     cell.valye = cell.offset(,-1))\nNext\n</code></pre>\n\n<p>I'm basically trying to replicate the if statement giving me 3 different outcomes depending on wether the IF statement is true or not.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "edited": false, "score": 0, "creation_date": 1438775591, "post_id": 31831119, "comment_id": 51585478, "body": "Excellent. Thanks for the help!"}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 2, "last_activity_date": 1438774225, "last_edit_date": 1438774225, "creation_date": 1438773795, "answer_id": 31831119, "question_id": 31830883, "link": "https://stackoverflow.com/questions/31830883/in-vba-i-want-to-make-an-if-statement-for-when-more-than-one-cell-in-a-range-co/31831119#31831119", "title": "In VBA, I want to make an If statement for when more than one cell in a range contains a value", "body": "<p>Here is how you can check if there are more than one non-empty cell in the given range:</p>\n\n<pre><code>If Application.WorksheetFunction.CountA(Rng.Offset(, 2).Resize(, 7)) &gt; 1 Then\n</code></pre>\n\n<hr>\n\n<p>Few additional tips to your code:</p>\n\n<ul>\n<li><p>If you know exactly the initial and final value of <code>i</code> you should use <code>For ... Next</code> loop instead of <code>While ... Wend</code>. So you could replace this code:</p>\n\n<pre><code>i = 3\n'(...)\n\nWhile i &lt;= 133\n    '(...)\n    i = i + 1\n\nWend\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>For i = 3 To 133\n    '(...)\nNext i\n</code></pre></li>\n<li><p>I think this line of code will cause <strong>Type mismatch</strong> error:</p>\n\n<pre><code>If Rng.Offset(, 2).Resize(, 7) &lt;&gt; \"\" Then\n</code></pre>\n\n<p>because you are trying to compare an object of <code>Range</code> type with a primitive value (empty string). To avoid this issue you can use the similar code as above:</p>\n\n<pre><code>If Application.WorksheetFunction.CountA(Rng.Offset(, 2).Resize(, 7)) = 0 Then\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 1, "last_activity_date": 1438774108, "creation_date": 1438774108, "answer_id": 31831245, "question_id": 31830883, "link": "https://stackoverflow.com/questions/31830883/in-vba-i-want-to-make-an-if-statement-for-when-more-than-one-cell-in-a-range-co/31831245#31831245", "title": "In VBA, I want to make an If statement for when more than one cell in a range contains a value", "body": "<p>you might like to add code along these lines</p>\n\n<pre><code>Select case  Application.WorksheetFunction.CountA(Rng.Offset(, 2).Resize(, 7))\n      case 0\n          Rng.Offset(, 1).value = \"Blank\"\n      case 1\n          Rng.Offset(, 1).value = \"Only One\"\n      case &gt;2\n          Rng.Offset(, 1).value = \"More than 1\"\nend select\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1996971, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ebc5e297b066c01afb04d7f64dcf77e8?s=128&d=identicon&r=PG", "display_name": "user1996971", "link": "https://stackoverflow.com/users/1996971/user1996971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 31831119, "answer_count": 2, "score": 2, "last_activity_date": 1438844775, "creation_date": 1438773179, "last_edit_date": 1438844775, "question_id": 31830883, "link": "https://stackoverflow.com/questions/31830883/in-vba-i-want-to-make-an-if-statement-for-when-more-than-one-cell-in-a-range-co", "title": "In VBA, I want to make an If statement for when more than one cell in a range contains a value", "body": "<p>So I have the following VBA loop set up, but want to add a line that says \"If there are two cells within this range that have a value, do this. If there are three cells within a range that have a value, do that.\" What I have so far is:</p>\n\n<pre><code>Sub Test1()\n\n    Dim Rng As Range\n    Dim i As Long\n    i = 3\n    Application.ScreenUpdating = True\n\n    While i &lt;= 133\n        Set Rng = Range(\"C\" &amp; i)\n\n        If Rng.Offset(, 2).Resize(, 7) &lt;&gt; \"\" Then\n            Rng.Offset(, 1).FormulaR1C1 = \"Blank\"\n            i = i + 1\n        Else: Stop\n        End If\n    Wend\n\n\nEnd Sub\n</code></pre>\n\n<p>So I have the VBA script print the word \"Blank\" into the appropriate cell if this range is empty. But how can I add more lines to say \"If one cell in this range contains a value,\" or \"if two cells in this range contain a value\" </p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 3916379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/747712a2235d05a33f2f2821580ae30d?s=128&d=identicon&r=PG&f=1", "display_name": "JCro", "link": "https://stackoverflow.com/users/3916379/jcro"}, "is_accepted": false, "score": 0, "last_activity_date": 1438817145, "creation_date": 1438817145, "answer_id": 31844433, "question_id": 31830852, "link": "https://stackoverflow.com/questions/31830852/multiple-values-for-a-field-link-master-fields/31844433#31844433", "title": "Multiple Values for a field (Link Master fields)", "body": "<p>You will need to do this via VBA.</p>\n\n<p>Use the Change event on the list box to update the subforms recordsource.\nAlso make sure you execute the code in the forms Current event, so that it will display correctly when moving records, and on initial opening.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 5156193, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/75f98b473ba8939a492dc99e109ea260?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran", "link": "https://stackoverflow.com/users/5156193/kamran"}, "is_accepted": false, "score": 0, "last_activity_date": 1438863354, "creation_date": 1438863354, "answer_id": 31855527, "question_id": 31830852, "link": "https://stackoverflow.com/questions/31830852/multiple-values-for-a-field-link-master-fields/31855527#31855527", "title": "Multiple Values for a field (Link Master fields)", "body": "<p>So with a bit of research and trying out different ways, an easy way is to use some hidden textboxes in the form and loop through the selected values and give each textbox one of the selected values in the listbox.\nFrom there you can write a SQL for your chart specifying the condition so your field = Condition 1 or field = Condition 2.</p>\n"}], "owner": {"reputation": 63, "user_id": 5156193, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/75f98b473ba8939a492dc99e109ea260?s=128&d=identicon&r=PG&f=1", "display_name": "Kamran", "link": "https://stackoverflow.com/users/5156193/kamran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1594643936, "creation_date": 1438773097, "last_edit_date": 1594643936, "question_id": 31830852, "link": "https://stackoverflow.com/questions/31830852/multiple-values-for-a-field-link-master-fields", "title": "Multiple Values for a field (Link Master fields)", "body": "<p>I am trying to use Link Master Fields to get a value from my form in order to filter some of my data and then show the remaining on my chart. Everything works perfectly fine but when I want to select more than one value (using a listbox to select multiple values for a field), my chart returns nothing.</p>\n\n<p>I would like to know how can I address multiple values for a field in my chart so it filters the values on my chart as an \"Or\" function in SQL.</p>\n\n<blockquote>\n  <p>Imagine I want to have an SQL with: WHERE [MyTable].[Field1]= Selected values in listbox.</p>\n</blockquote>\n\n<p>It seems that my SQL selects all the values in the listbox as One Value/And function.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1438772171, "post_id": 31830448, "comment_id": 51583271, "body": "Before <code>ChDir</code> call <code>ChDrive</code> function."}, {"owner": {"reputation": 11359, "user_id": 1624450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Lfzcq.png?s=128&g=1", "display_name": "Pieter Geerkens", "link": "https://stackoverflow.com/users/1624450/pieter-geerkens"}, "edited": false, "score": 0, "creation_date": 1438772315, "post_id": 31830448, "comment_id": 51583359, "body": "Check out the value of the environment variable <code>USERPROFILE</code> for the current user."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1438776604, "post_id": 31830448, "comment_id": 51586185, "body": "I don&#39;t see where <code>e</code> is being used."}], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": true, "score": 1, "last_activity_date": 1438777431, "creation_date": 1438777431, "answer_id": 31832434, "question_id": 31830448, "link": "https://stackoverflow.com/questions/31830448/how-to-do-save-as-using-vba/31832434#31832434", "title": "How to do &#39;Save As&#39; using VBA", "body": "<p>Does this work for you?</p>\n\n<pre><code>Dim b, c, d, e As String\n\nb = MsgBox(\"This file has to be saved. Click OK.\", vbOKCancel, \"Save to SharePoint\")\n\nActiveWorkbook.Save\n\nc = MsgBox(\"Save this file to local\", vbOKOnly, \"Save to Local\")\n\nd = InputBox(\"This shift record falls on what week?\", \"Save Shift Record\", \"YYYYMMDD-YYYYMMDD\")\n\ne = InputBox(\"Enter your EID\", \"Save Shift Record\", \"EID\")\n\nActiveWorkbook.SaveAs Filename:= \"C:\\Users\\\" &amp; environ(\"username\") &amp; \"\\Desktop\\MANILA_ShiftRecord_\" + d + \".xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 4025565, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/13ba3984f46eb06d51c72a63c2b02c73?s=128&d=identicon&r=PG&f=1", "display_name": "xtina1231", "link": "https://stackoverflow.com/users/4025565/xtina1231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 31832434, "answer_count": 1, "score": 0, "last_activity_date": 1438777431, "creation_date": 1438771949, "last_edit_date": 1438777252, "question_id": 31830448, "link": "https://stackoverflow.com/questions/31830448/how-to-do-save-as-using-vba", "title": "How to do &#39;Save As&#39; using VBA", "body": "<p>I would like to ask for helping my code below. I got this when I recorded a macro upon saving a new file to my desktop. </p>\n\n<p>I am having issues with the <strong>Change Directory</strong> line. This changes will happen every time a different user is using this macro which can also depend on the value of <code>e</code>. </p>\n\n<p>Also, part of the filename varies which depends on the value of <code>d</code>. </p>\n\n<p>Please help me improve my codes. Thanks!</p>\n\n<pre><code>Dim b, c, d, e As String\n\nb = MsgBox(\"This file has to be saved. Click OK.\", vbOKCancel, \"Save to SharePoint\")\n\nActiveWorkbook.Save\n\nc = MsgBox(\"Save this file to local\", vbOKOnly, \"Save to Local\")\n\nd = InputBox(\"This shift record falls on what week?\", \"Save Shift Record\", \"YYYYMMDD-YYYYMMDD\")\n\ne = InputBox(\"Enter your EID\", \"Save Shift Record\", \"EID\")\n\n'this line give error ~~~~~ \nChDir \"C:\\Users\\ma.cristina.i.gumato\\Desktop\"\n\nActiveWorkbook.SaveAs Filename:= \"C:\\Users\\d\\Desktop\\MANILA_ShiftRecord_\" + d + \".xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n"}, {"tags": ["excel", "vba", "repeat"], "comments": [{"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1438771931, "post_id": 31830276, "comment_id": 51583113, "body": "You want to check if there&#39;s a duplicate in the whole column, or just whether duplicate values are next to one another? What do you want to do if you find a duplicate? Just update the variable &#39;ok&#39; to <code>False</code>?"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1438772027, "post_id": 31830276, "comment_id": 51583161, "body": "You need to explain the problem more.  eg  Are you using the array to store the data held in an excel sheet by any chance?  When you say &quot;so values that are next to each other &quot; does next to include &quot;cells&quot; that are to the left right , above and below a cell.  When about diagonally above and right?"}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1438772367, "post_id": 31830276, "comment_id": 51583390, "body": "at the moment it looks like your &#39;if&#39; statement is trying to match each cell with the 5 below it. is this what you&#39;re intending?"}, {"owner": {"reputation": 11, "user_id": 5193515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca7c96154c0ef4125254d58713bd6cc8?s=128&d=identicon&r=PG&f=1", "display_name": "blgibson9", "link": "https://stackoverflow.com/users/5193515/blgibson9"}, "edited": false, "score": 0, "creation_date": 1438773886, "post_id": 31830276, "comment_id": 51584341, "body": "Just duplicates next to each other in a column. The data is coming from a machine collecting data automatically, if the same value is repeated over and over we need to know if something is wrong with the data collection device."}, {"owner": {"reputation": 11, "user_id": 5193515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca7c96154c0ef4125254d58713bd6cc8?s=128&d=identicon&r=PG&f=1", "display_name": "blgibson9", "link": "https://stackoverflow.com/users/5193515/blgibson9"}, "edited": false, "score": 0, "creation_date": 1438773912, "post_id": 31830276, "comment_id": 51584366, "body": "and yes the if statement is trying to see if the cell matches the 5 below it"}], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1438776932, "last_edit_date": 1438776932, "creation_date": 1438776371, "answer_id": 31832048, "question_id": 31830276, "link": "https://stackoverflow.com/questions/31830276/vba-repeating-numbers-next-to-each-other/31832048#31832048", "title": "vba repeating numbers next to each other", "body": "<p>If you're just wanting to check if there are duplicates next to one another in the column, the below will do what you're after.</p>\n\n<pre><code>Sub arrayDuplicateCheck()\n    Dim arrValues() As Variant\n    Dim lrow As Long, i As Long, ok As Boolean\n\n    ok = False\n    lrow = Cells(Rows.Count, 1).End(xlUp).Row\n    arrValues = Range(Cells(1, 1), Cells(lrow, 1))\n\n    For i = 1 To UBound(arrValues, 1) - 1\n        If arrValues(i, 1) = arrValues(i + 1, 1) Then\n            ok = True\n            Exit For\n        End If\n    Next i\n\n    MsgBox (ok)\nEnd Sub\n</code></pre>\n\n<p>This is currently checking values within column A, you will have to adjust the range which is assigned to the array if you wish to check a different column. The do this, update the <code>arrValues = Range(Cells(1, 1), Cells(lrow, 1))</code> to the column number you want to evaluate. If you're changing the array column, you will need to update the <code>lrow</code> variable to the same column number.</p>\n\n<p>For example, <code>arrValues = Range(Cells(1, 4), Cells(lrow, 4))</code> would now create the array from <code>Column D</code>.</p>\n\n<p><strong>Edit:</strong> If you want to check if all 5 rows below match, then you can just change the <code>For</code> and <code>If</code> statement to this:</p>\n\n<pre><code>For i = 1 To UBound(arrValues, 1) - 5\n    If arrValues(i, 1) = arrValues(i + 1, 1) _\n    And arrValues(i, 1) = arrValues(i + 2, 1) _\n    And arrValues(i, 1) = arrValues(i + 3, 1) _\n    And arrValues(i, 1) = arrValues(i + 4, 1) _\n    And arrValues(i, 1) = arrValues(i + 5, 1) Then\n        ok = True\n        Exit For\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 1, "last_activity_date": 1438777710, "creation_date": 1438777710, "answer_id": 31832539, "question_id": 31830276, "link": "https://stackoverflow.com/questions/31830276/vba-repeating-numbers-next-to-each-other/31832539#31832539", "title": "vba repeating numbers next to each other", "body": "<p>If you just want to flag rows that immediately repeat, just check the value in the row above to see if it's the same. If so, flag the column. For example:</p>\n\n<pre><code>With Range(\"B2:B24\")\n    .Formula = \"=IF(A2=A1,\"\"X\"\",\"\"\"\")\"\n    .Value = .Value\nEnd With\n</code></pre>\n\n<p>This is how it would appear for the following dataset:</p>\n\n<pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Col A  \u2551 Col B \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551     17 \u2551       \u2551\n\u2551     44 \u2551       \u2551\n\u2551     44 \u2551 X     \u2551\n\u2551     44 \u2551 X     \u2551\n\u2551     15 \u2551       \u2551\n\u2551     93 \u2551       \u2551\n\u2551     93 \u2551 X     \u2551\n\u2551     16 \u2551       \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5193515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca7c96154c0ef4125254d58713bd6cc8?s=128&d=identicon&r=PG&f=1", "display_name": "blgibson9", "link": "https://stackoverflow.com/users/5193515/blgibson9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1438777872, "creation_date": 1438771488, "last_edit_date": 1438777872, "question_id": 31830276, "link": "https://stackoverflow.com/questions/31830276/vba-repeating-numbers-next-to-each-other", "title": "vba repeating numbers next to each other", "body": "<p>Okay so I have a variable sized array in Excel. Using vba I'd like to find if there are any repeating values, so values that are next to each other that are the same, not just in the whole column.</p>\n\n<p>I know just in excel you could use an if statement, but how could you just spread that out to the whole sheet using for loops.</p>\n\n<p>Im extremely novice to vba. This was my first attempt, it didn't work though and I don't know how to continue.</p>\n\n<p>total is a value entered in by the user</p>\n\n<pre><code>ok = True\nFor j = 2 To 24\n    For l =1 to total\n        If ActiveCell.Offset(j, l).Select = ActiveCell.Offset(j + 5, l)\n        And ActiveCell.Offset(j + 4, l) And ActiveCell.Offset(j + 3, l) \n        And ActiveCell.Offset(j + 2, l) And ActiveCell.Offset(j + 1, l) Then\n            ok = False\n        End if\n    Next\nNext\n</code></pre>\n"}, {"tags": ["mysql", "vba"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1438780139, "post_id": 31830222, "comment_id": 51588810, "body": "How are you trying to preserve the formatting?"}, {"owner": {"reputation": 113, "user_id": 5193513, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/51bd705960c0ab6081db309942d5f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Savage", "link": "https://stackoverflow.com/users/5193513/daniel-savage"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1438780856, "post_id": 31830222, "comment_id": 51589352, "body": "Well I need the text to be in the same format as it was in the Word Document (looking at Bold, Underlined, Tables etc) and I&#39;m hoping VBA will do this automatically?"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1438781507, "post_id": 31830222, "comment_id": 51589911, "body": "Not automatically. You would need to read the formatting codes/html and store them as part of the text."}, {"owner": {"reputation": 113, "user_id": 5193513, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/51bd705960c0ab6081db309942d5f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Savage", "link": "https://stackoverflow.com/users/5193513/daniel-savage"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1438782465, "post_id": 31830222, "comment_id": 51590665, "body": "Okay, I&#39;ll try that. Thank you :)"}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5193513, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/51bd705960c0ab6081db309942d5f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Savage", "link": "https://stackoverflow.com/users/5193513/daniel-savage"}, "edited": false, "score": 0, "creation_date": 1438780945, "post_id": 31833351, "comment_id": 51589422, "body": "I&#39;ve taken it out and VBA still doesn&#39;t like it. Shouldn&#39;t it be easy to just send a statement into MySQL using ADODB?"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 113, "user_id": 5193513, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/51bd705960c0ab6081db309942d5f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Savage", "link": "https://stackoverflow.com/users/5193513/daniel-savage"}, "edited": false, "score": 0, "creation_date": 1438781127, "post_id": 31833351, "comment_id": 51589568, "body": "What do you mean by &quot;taken it out&quot;? I&#39;ve added code to my answer."}, {"owner": {"reputation": 113, "user_id": 5193513, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/51bd705960c0ab6081db309942d5f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Savage", "link": "https://stackoverflow.com/users/5193513/daniel-savage"}, "edited": false, "score": 0, "creation_date": 1438782432, "post_id": 31833351, "comment_id": 51590642, "body": "As in I removed the Spaces either side of 2 and 2 itself ( and the obviously the idparts part further up). And thank you for the code, and forgive me if I&#39;m wrong, but it doesn&#39;t seem any different from mine? (Other than UID  which I will try)"}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 1, "last_activity_date": 1438782749, "last_edit_date": 1438782749, "creation_date": 1438779732, "answer_id": 31833351, "question_id": 31830222, "link": "https://stackoverflow.com/questions/31830222/executing-a-query-to-insert-data-from-vba-to-mysql-and-what-will-said-data-look/31833351#31833351", "title": "Executing a Query to Insert Data from VBA to MySQL and What Will Said Data Look Like", "body": "<p>The .Net connector uses <code>UID</code> but the ODBC connector used by VBA uses <code>User</code>. I've only ever used <code>Option=3</code> as well.</p>\n\n<pre><code>conn.Open \"DRIVER={MySQL ODBC 3.51 Driver}\" _\n    &amp; \";SERVER=\" &amp; Server_Name _\n    &amp; \";DATABASE=\" &amp; Database_Name _\n    &amp; \";User=\" &amp; User_ID _\n    &amp; \";PWD=\" &amp; Password _\n    &amp; \";OPTION=16427\" ' Option 16427 = Convert LongLong to Int:\n</code></pre>\n\n<p>You can test the connection by running a simple sql query.</p>\n\n<pre><code>strSQL = \"SELECT * FROM parts;\"\nconn.Execute strSQL\n</code></pre>\n\n<p>If this throws an error, you still have an issue.</p>\n\n<p>Also, in your code you have spaces either side of the <code>2</code>. Is that correct?</p>\n\n<blockquote>\n  <p>\"VALUES (' \" &amp; 2 &amp; \" ' ,</p>\n</blockquote>\n"}], "owner": {"reputation": 113, "user_id": 5193513, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/51bd705960c0ab6081db309942d5f8e8?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Savage", "link": "https://stackoverflow.com/users/5193513/daniel-savage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3254, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438782749, "creation_date": 1438771356, "question_id": 31830222, "link": "https://stackoverflow.com/questions/31830222/executing-a-query-to-insert-data-from-vba-to-mysql-and-what-will-said-data-look", "title": "Executing a Query to Insert Data from VBA to MySQL and What Will Said Data Look Like", "body": "<p>I'm trying to insert snippets of a word document into a MySQL database. I did this in Java, but I lost all formatting of the Microsoft document, so I'm now trying to do the same in VBA (I'm hoping that this will keep the formatting?!).\nBut to find out if it will, I need to try.. I've set up the connection and the table in MySQL but I can't insert any values. It throws up a syntax error on the \"conn.Execute\" line. </p>\n\n<pre><code>Sub ConnectToDataBase()\n\n'\n'\n Dim conn As New ADODB.Connection\n Dim Server_Name As String\n Dim Database_Name As String\n Dim User_ID As String\n Dim Password As String\n '\n Dim i As Long ' counter\n Dim SQLStr As String ' SQL to perform various actions\n Dim table1 As String, table2 As String\n Dim field1 As String, field2 As String\n Dim rs As ADODB.Recordset\n Dim vtype As Variant\n '\n\n\n Server_Name = \"127.0.0.1\" ' Enter your server name here -\n Database_Name = \"rmp\" ' Enter your database name here\n User_ID = \"root\" ' enter your user ID here\n Password = \"Password1\" ' Enter your password here\n\n Set conn = New ADODB.Connection\nconn.Open \"DRIVER={MySQL ODBC 3.51 Driver}\" _\n &amp; \";SERVER=\" &amp; Server_Name _\n &amp; \";DATABASE=\" &amp; Database_Name _\n &amp; \";UID=\" &amp; User_ID _\n &amp; \";PWD=\" &amp; Password _\n &amp; \";OPTION=16427\" ' Option 16427 = Convert LongLong to Int: \n\n strSQL = \"INSERT INTO  parts(idParts, Part 1, Part 2, Part 3, Part 4, \n Part 5) \" &amp; _\n            \"VALUES (' \" &amp; 2 &amp; \" ' , '\" &amp; one &amp; \"' , '\" &amp; two &amp; \"' , '\" &amp;  \n  three &amp; \"' , '\" &amp; four &amp; \"' , '\" &amp; five &amp; \"' )\"\n\nconn.Execute strSQL\n\n\nClose connections\nOn Error Resume Next\nrs.Close\nSet rs = Nothing\nconn.Close\nSet conn = Nothing\nOn Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "percentage", "vba"], "comments": [{"owner": {"reputation": 29, "user_id": 3983869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/KhK7j.jpg?s=128&g=1", "display_name": "BenC", "link": "https://stackoverflow.com/users/3983869/benc"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1438773367, "post_id": 31829426, "comment_id": 51584011, "body": "Thank you @pnuts though this does not always give a correct answer, I have however corrected my coding so that the two values are totaled and then a percentage equation can be derived from that."}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 3983869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/KhK7j.jpg?s=128&g=1", "display_name": "BenC", "link": "https://stackoverflow.com/users/3983869/benc"}, "is_accepted": false, "score": 0, "last_activity_date": 1438772217, "creation_date": 1438772217, "answer_id": 31830541, "question_id": 31829426, "link": "https://stackoverflow.com/questions/31829426/compare-two-values-and-generate-a-percentage-excel/31830541#31830541", "title": "compare two values and generate a percentage (excel)", "body": "<p>Not to worry I have found a solution which works a treat. The above code now looks like this for the work to be checked:-</p>\n\n<pre><code>Private Sub pdf_loading()\n\nRange(\"K5:L6\").ClearContents\nRange(\"M5\").ClearContents\n' Clear cell contents on open\n\nDim FolderPath As String, path As String, count As Integer\nFolderPath = \"C:\\filepath\\folder\\\"\n' looks in spercific folder\npath = FolderPath &amp; \"*.pdf\"\n' for file type this time it is pdf files, though if you change this is could be word files, or psd's\nFilename = Dir(path)\n\nDo While Filename &lt;&gt; \"\"\n' checks for filename &lt;less than or &gt;greater than \"filename\" as \"\" is empty does not look for spercific file\n    count = count + 1\n' counts amount of pdf files, add 1 to the last known number\n    Filename = Dir()\n' contiunes count until it reaches the end of the directory\nLoop\n\n\nRange(\"M5\").Value = count\n' puts final count value in cell\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>and the work checked folder is now like this:-</p>\n\n<pre><code>Private Sub checked_loading()\n\nRange(\"M6\").ClearContents\n\nDim FolderPath As String, path As String, count As Integer\nFolderPath = \"C:\\filepath\\folder\\\"\n\npath = FolderPath &amp; \"*.pdf\"\n\nFilename = Dir(path)\n\nDo While Filename &lt;&gt; \"\"\n    count = count + 1\n        Filename = Dir()\nLoop\n\nRange(\"M6\").Value = count\n\n\nRange(\"N5\").Formula = \"=Sum(M5,M6)\"\nRange(\"K5\").Formula = \"=SUM(M6/N5*1)\"\n' adds formulas to selected cells to give percentage\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3983869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/KhK7j.jpg?s=128&g=1", "display_name": "BenC", "link": "https://stackoverflow.com/users/3983869/benc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438773254, "creation_date": 1438769333, "last_edit_date": 1531161705, "question_id": 31829426, "link": "https://stackoverflow.com/questions/31829426/compare-two-values-and-generate-a-percentage-excel", "title": "compare two values and generate a percentage (excel)", "body": "<p>I am currently trying to create a spreadsheet which keeps track of how many files have been quality checked against those that haven't and then displays the amount left to be checked as a percentage. </p>\n\n<p>Currently on open the spreadsheet pulls the details from a checked folder and a work to be checked folder as follows:-</p>\n\n<pre><code>Private Sub pdf_loading()\n\nRange(\"M5\").Clear\n\nDim FolderPath As String, path As String, count As Integer\nFolderPath = \"C:\\path to folder\\\"\n' looks in spercific folder\npath = FolderPath &amp; \"*.pdf\"\n' for file type this time it is pdf files, though if you change this is could be word files, or psd's\nFilename = Dir(path)\n\nDo While Filename &lt;&gt; \"\"\n' checks for filename &lt;less than or &gt;greater than \"filename\" as \"\" is empty does not look for spercific file\n    count = count + 1\n' counts amount of pdf files, add 1 to the last known number\n    Filename = Dir()\n' contiunes count until it reaches the end of the directory\nLoop\n\n\nRange(\"M5\").Value = count\n' puts final count value in cell\n\nFor Each Cell In [M:M]\nIf Cell.Value = \"0\" Then\nCell.ClearContents\nElseIf Range(\"M5\").Value &gt;= 1 Then\nEnd If\nNext Cell\n\nEnd Sub\n</code></pre>\n\n<p>Then for the checked folder:-</p>\n\n<pre><code>Private Sub checked_loading()\n\nRange(\"M6\").Clear\n\nDim FolderPath As String, path As String, count As Integer\nFolderPath = \"C:\\path to folder\\\"\n\npath = FolderPath &amp; \"*.pdf\"\n\nFilename = Dir(path)\n\nDo While Filename &lt;&gt; \"\"\n    count = count + 1\n        Filename = Dir()\nLoop\n\nRange(\"M6\").Value = count\n\nFor Each Cell In [M:M]\nIf Cell.Value = \"0\" Then\nCell.ClearContents\nElseIf Range(\"M5\").Value &gt;= 1 Then\nEnd If\nNext Cell\n\nEnd Sub\n</code></pre>\n\n<p>This works fine, though currently the formula I have tried to generate the percentage is as follows:-</p>\n\n<pre><code>=IF(M5=M6,\"50%\",IF(M5=0,\"100%\",IF(M6=0,\"0%\",SUM(M5*M6/100*1))))\n</code></pre>\n\n<p>This brings back incorrect results like 144.00% when the files to be check result is 9 and the files checked result is 16.</p>\n\n<p>I would prefer to have the percentage calculation to be in vba so that end users could not accidentally delete the underlying formula.</p>\n\n<p>Any help on this issue or if there is a more efficient code structure would be most appreciate. </p>\n"}, {"tags": ["ms-access", "sql-server-2012", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1438769313, "post_id": 31829365, "comment_id": 51581405, "body": "They are quite the same as views ..."}, {"owner": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "reply_to_user": {"reputation": 62126, "user_id": 5089204, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xGm6I.jpg?s=128&g=1", "display_name": "Shnugo", "link": "https://stackoverflow.com/users/5089204/shnugo"}, "edited": false, "score": 0, "creation_date": 1438769547, "post_id": 31829365, "comment_id": 51581535, "body": "Thank you..whether it is used to increase the performance"}], "answers": [{"comments": [{"owner": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "edited": false, "score": 0, "creation_date": 1438779496, "post_id": 31830149, "comment_id": 51588319, "body": "by any chance SQL query take more time to load than front end loading the same query result data?"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 2, "last_activity_date": 1438771131, "creation_date": 1438771131, "answer_id": 31830149, "question_id": 31829365, "link": "https://stackoverflow.com/questions/31829365/what-is-the-use-of-querydefs-in-msaccess-vba/31830149#31830149", "title": "what is the use of QueryDefs in MSAccess (VBA)", "body": "<p>You can think of QueryDefs as being like views on a SQL server. They are a stored SQL query.  A QueryDef is a query that appears on the navigation pane under Queries.</p>\n\n<p>If you are using certain types of conditional formatting in forms then the form MUST be based on a QueryDef  (eg barcharts in a control).</p>\n\n<p>Instead of using a built SQL statement, by creating a querydef if can help debugging.</p>\n\n<p>The performance benefits depend mainly on the structure of your SQL query, which is greatly influenced by whether you are using DAO, ADO or pass though queries to access SQL Server data and mainly on whether you use parameters (to enable the execution plan to be re-used).</p>\n\n<p>General advise is to use pass through queries and leverage the use of the SQL Server stored procedures, functions and views.</p>\n\n<p>Harvey</p>\n"}], "owner": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1247, "favorite_count": 0, "accepted_answer_id": 31830149, "answer_count": 1, "score": 1, "last_activity_date": 1594643944, "creation_date": 1438769179, "last_edit_date": 1594643944, "question_id": 31829365, "link": "https://stackoverflow.com/questions/31829365/what-is-the-use-of-querydefs-in-msaccess-vba", "title": "what is the use of QueryDefs in MSAccess (VBA)", "body": "<p>we are using MS access as front end and Sql server as back end.I want to know the use of QueryDefs Temporary table.What is the Advantage of using QueryDefs ?</p>\n"}, {"tags": ["vba", "button", "outlook", "outlook-2007"], "comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1438772894, "post_id": 31829139, "comment_id": 51583714, "body": "How do you customize the Ribbon in Outlook? Do you add a QAT button? You may find the <a href=\"http://www.slipstick.com/outlook/customize-toolbar-ribbon-or-qat/\" rel=\"nofollow noreferrer\">Customize the Outlook Toolbar, Ribbon or QAT</a> article helpful."}, {"owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1438777773, "post_id": 31829139, "comment_id": 51586989, "body": "I do it with the (rigth click) &#39;customize commands&#39; -&gt; macro command (I am using the German version, so names might be slightly different), select macro and drag the macro to the place (an existing Menue) I want it to show. It works as expected, but if I close and reopen OL the button is gone. So it seems to me that something is not permanently stored. But I have no idea where, and what the reason could be."}, {"owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1438777970, "post_id": 31829139, "comment_id": 51587146, "body": "btw, I doning what the in the above link is shown in the video. A have such a button alread done in the past for contacts. But this time it shall bei in the main main window. There I have also some tools which show as expected."}, {"owner": {"reputation": 519, "user_id": 4228410, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/TLOdI.gif?s=128&g=1", "display_name": "Bart", "link": "https://stackoverflow.com/users/4228410/bart"}, "edited": false, "score": 0, "creation_date": 1440588934, "post_id": 31829139, "comment_id": 52333545, "body": "We are having the exact same issue as you described, but only on my collegue&#39;s workstation. On my own PC where the macro was developed, everything works as intended. In our particular case, it looks to be machine related. Both PC&#39;s are windows 7 64 bit."}, {"owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "edited": false, "score": 0, "creation_date": 1440668764, "post_id": 31829139, "comment_id": 52372513, "body": "Is there a difference in the antivir Systems or settings? I have not tried it yet, but I have some &quot;feeling&quot; that this has something to do with some of the security systems running in the background. E.g. I cant also change settings in some of the gadgets (sidebar), so I suppose that the settings are not written back to disk or so."}], "owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1593248019, "creation_date": 1438768548, "last_edit_date": 1593248019, "question_id": 31829139, "link": "https://stackoverflow.com/questions/31829139/macro-button-disappears-following-restart", "title": "Macro button disappears following restart", "body": "<p>Quick:</p>\n\n<p>A button to execute VBA code disappears after OL2007 is restarted.</p>\n\n<p>Detail:</p>\n\n<p>I have code to mark multiple mails as SPAM from <a href=\"http://www.vboffice.net/de/developers/mehrere-emails-gleichzeitig-als-spam-markieren/\" rel=\"nofollow\">here</a>. It works as expected.</p>\n\n<p>When I create a button in a ribbon I can use the button as expected.</p>\n\n<p>When I close and restart Outlook the button disappears.</p>\n\n<p>There is just one noticeable effect: when I try to recreate the button, there are no macros listed under the topic macros. But when I open the VB-Editor, I see all the macros. I can re-create the button, again everything works as expected.</p>\n\n<p>I tried to execute Outlook as an administrator: no change - same effect. I thought that it might have to do with writing back some data.</p>\n\n<p>I have other macros, they still operate, also with buttons.</p>\n\n<p>System: win7-64 Home</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1438776914, "post_id": 31828746, "comment_id": 51586400, "body": "You could do something on filter to count <code>.visible</code> cells and then &#39;.clear` if there aren&#39;t enough"}], "answers": [{"tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": false, "score": 0, "last_activity_date": 1438779330, "creation_date": 1438779330, "answer_id": 31833190, "question_id": 31828746, "link": "https://stackoverflow.com/questions/31828746/excel-2013-filter-limit-minimum-number-of-rows-returned/31833190#31833190", "title": "Excel 2013 - Filter limit minimum number of rows returned", "body": "<p>Here is something you could try:</p>\n\n<pre><code>    Private Sub Worksheet_Calculate()\nIf ActiveSheet.FilterMode = True Then\n\n    Rcount = ActiveSheet.AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.Count - 1\n\n        If Rcount &lt; 10 Then\n            ActiveSheet.AutoFilterMode = False\n        Else\n        End If\n\nElse\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This would only work in the sheet you are working on, but still could come in handy. There will also need to be one volatile formula such as Countif on the sheet - to trigger.</p>\n\n<p>Otherwise, this works to a point quite well.</p>\n\n<p>Unfortunately, however, if you choose a result with less than 10 - it disables the filter as a whole. I've tried adding the code to turn it back on, but it errors in this case - you might have some luck on that front.</p>\n\n<p>I hope that this is something like you were looking for none the less</p>\n"}], "owner": {"reputation": 3037, "user_id": 322131, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/77da88ca1aed968b2598c08fd52ce653?s=128&d=identicon&r=PG", "display_name": "Homer_J", "link": "https://stackoverflow.com/users/322131/homer-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438779330, "creation_date": 1438767524, "last_edit_date": 1531161705, "question_id": 31828746, "link": "https://stackoverflow.com/questions/31828746/excel-2013-filter-limit-minimum-number-of-rows-returned", "title": "Excel 2013 - Filter limit minimum number of rows returned", "body": "<p>Using the <code>Filter</code> tool in Excel - is there anyway in which to place a minimum limit on the number of rows returned.</p>\n\n<p>For example,  if I place a filter and the number of rows returned is less than 10 then the rows aren't shown and/ or the filter doesn't take place?</p>\n"}, {"tags": ["java", "excel", "ms-word", "mailmerge", "vba"], "answers": [{"tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": true, "score": 1, "last_activity_date": 1438768725, "creation_date": 1438768725, "answer_id": 31829202, "question_id": 31828709, "link": "https://stackoverflow.com/questions/31828709/how-to-get-symbols-from-excel-to-word-using-mail-merge/31829202#31829202", "title": "How to get Symbols from Excel to Word using Mail Merge", "body": "<p>I imagine this might be down to the font you are using and because Word is very finicky when it comes to transferring over symbols in this way.</p>\n\n<p>I would suggest using a Wingdings font value that matches the symbol you need - and filling in the Excel document with that value. This may be already how Excel is dealing with the issue</p>\n\n<p>In Wingdings 2 - the symbols you want are capital R &amp; S - so you simply need to change the part in word that should be ticks/crosses to match this font I would imagine.</p>\n"}], "owner": {"reputation": 5559, "user_id": 4977669, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1e4701298169d4e32a3b952ef941ab8e?s=128&d=identicon&r=PG&f=1", "display_name": "dev90", "link": "https://stackoverflow.com/users/4977669/dev90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1342, "favorite_count": 0, "accepted_answer_id": 31829202, "answer_count": 1, "score": 1, "last_activity_date": 1438768725, "creation_date": 1438767433, "last_edit_date": 1531161705, "question_id": 31828709, "link": "https://stackoverflow.com/questions/31828709/how-to-get-symbols-from-excel-to-word-using-mail-merge", "title": "How to get Symbols from Excel to Word using Mail Merge", "body": "<p>I have an <code>Excel</code> sheet which contains lots of data..Some fields contains Symbol data, while other contains String and integer Data.</p>\n\n<p>I have a written a java program that takes Data from EXCEL sheet and puts it into the Word File using <code>Mail Merge</code>. The Whole thing works fine but when it comes to <code>Symbols</code> Images it takes their value but does not pick up the actual image that i need to put into the document. </p>\n\n<p>Kindly guide me how to pick up the image that is visible in Excel sheet rather than its actual Value.</p>\n\n<p>The Word File shows <code>\u00fe</code> rather than the <code>Tick or Cross</code> image that is visible in the Excel Sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/73WNi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/73WNi.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1438778628, "post_id": 31830952, "comment_id": 51587631, "body": "I have solved the problem on my own already, but your answer should work as it is very similar to mine. I will post my answer below too. Thanks for the help =)."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 1, "last_activity_date": 1438773351, "last_edit_date": 1495541173, "creation_date": 1438773351, "answer_id": 31830952, "question_id": 31828311, "link": "https://stackoverflow.com/questions/31828311/vba-fetch-picture-from-a-folder-based-on-a-string-name-contains-wildcard/31830952#31830952", "title": "VBA fetch picture from a folder based on a string name. Contains wildcard", "body": "<p>Regarding \"locking\" a picture into a specific cell.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/8189317/link-cell-with-excel-shape\">here</a> for info about how to link a shape to a cell.</p>\n\n<p>Essentially you need to:</p>\n\n<ol>\n<li><p>Position the picture over a cell. This can be done by setting the pictures (ie shape) .Top and .Left properties to be the same the cell you are linking the picture to.</p></li>\n<li><p>Set the formula of the shape to equal the cell reference (this will also resize the shape to be the same size as the cell, and cause it to resize if the cell size is changed).  See <a href=\"https://stackoverflow.com/questions/16038893/vba-to-add-a-shape-at-a-specific-cell-location-in-excel\">here</a></p></li>\n</ol>\n\n<p>The code below taken from <a href=\"https://stackoverflow.com/questions/555776/list-files-of-certain-pattern-using-excel-vba\">here</a>  will help you find a file in a folder that matches a \"findstring\".  (It will need to be adapted!)</p>\n\n<pre><code>Sub FindPatternMatchedFiles()\n\n    Dim objFSO As Object\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim objRegExp As Object\n    Set objRegExp = CreateObject(\"VBScript.RegExp\")\n    objRegExp.pattern = \".*xlsx\"\n    objRegExp.IgnoreCase = True\n\n    Dim colFiles As Collection\n    Set colFiles = New Collection\n\n    RecursiveFileSearch \"C:\\Path\\To\\Your\\Directory\", objRegExp, colFiles, objFSO\n\n    For Each f In colFiles\n        Debug.Print (f)\n        'Insert code here to do something with the matched files\n    Next\n\n    'Garbage Collection\n    Set objFSO = Nothing\n    Set objRegExp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 0, "last_activity_date": 1438778765, "creation_date": 1438778765, "answer_id": 31832954, "question_id": 31828311, "link": "https://stackoverflow.com/questions/31828311/vba-fetch-picture-from-a-folder-based-on-a-string-name-contains-wildcard/31832954#31832954", "title": "VBA fetch picture from a folder based on a string name. Contains wildcard", "body": "<p>Have your existing code call a function that accepts the name of the article (<code>articleCode</code>) and returns the path of the image file:</p>\n\n<pre><code>strImage = FindImage(articleCode)\nIf Len(strImage) &gt; 0 Then ActiveSheet.Pictures.Insert strImage\n</code></pre>\n\n<p>Then you can write your function like so:</p>\n\n<pre><code>Function FindImage(strArticle As String) As String\n\n    Dim objFile As Object\n    With CreateObject(\"Scripting.FileSystemObject\")\n        For Each objFile In .GetFolder(\"c:\\path\\to\\images\").Files\n            If StrComp(Left$(objFile.Name, Len(strArticle)), strArticle, vbTextCompare) = 0 Then\n\n                ' Found an image file that begins with the article code.\n                FindImage = objFile.Path\n                Exit Function\n\n            End If\n        Next\n    End With\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "is_accepted": true, "score": 0, "last_activity_date": 1438778919, "creation_date": 1438778919, "answer_id": 31833009, "question_id": 31828311, "link": "https://stackoverflow.com/questions/31828311/vba-fetch-picture-from-a-folder-based-on-a-string-name-contains-wildcard/31833009#31833009", "title": "VBA fetch picture from a folder based on a string name. Contains wildcard", "body": "<p>The function below takes articleCode which is the name of the picture, row and column into which the picture should be input.</p>\n\n<pre><code>Function picInsert(articleCode As String, row As Integer, column As Integer)\nDim objFSO As Object\nDim objFolder As Object\nDim objFile As Object\nDim i As Integer\nDim ws As Worksheet\nSet ws = Workbooks(1).Worksheets(2) 'your worksheet where the pictures will be put\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.GetFolder(\"...path...\")\n\ni = 1\nFor Each objFile In objFolder.Files\n    If objFile.name Like (articleCode &amp; \"*\") Then 'finds a picture with similar name to the one searched\n        With ActiveSheet.Pictures.Insert(objFile.Path)\n            With .ShapeRange\n                .LockAspectRatio = msoTrue\n                .Width = 5\n                .Height = 15\n            End With\n            .Left = ActiveSheet.Cells(row, column).Left\n            .Top = ActiveSheet.Cells(row, column).Top\n            .Placement = 1 'locks the picture to a cell\n        End With\n    End If\n    i = i + 1\nNext objFile\nEnd Function\n</code></pre>\n\n<p>This is a test sub with which I tried the function above. Basically a simple loop which goes over the rows, takes the articleCode from first column and inputs a picture into third column using the function above.</p>\n\n<pre><code>Public Sub test()\nDim ws As Worksheet\nDim i As Integer\nDim articleCode As String\nSet ws = Workbooks(1).Worksheets(2)\n\nFor i = 1 To ws.UsedRange.Rows.Count\n    articleCode = ws.Cells(i, 1)\n    Call picInsert(articleCode, i, 3)\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1821, "favorite_count": 0, "accepted_answer_id": 31833009, "answer_count": 3, "score": 0, "last_activity_date": 1438778919, "creation_date": 1438766338, "last_edit_date": 1438766678, "question_id": 31828311, "link": "https://stackoverflow.com/questions/31828311/vba-fetch-picture-from-a-folder-based-on-a-string-name-contains-wildcard", "title": "VBA fetch picture from a folder based on a string name. Contains wildcard", "body": "<p>I have an excel file with 160 rows and 2 columns of data - article name, price.\nI also have a folder which contains photos for those articles.</p>\n\n<p>The problem is that that picture names are not EXACTLY the same as the article names in my excel sheet.</p>\n\n<p>For example in my sheet I have article name: \"3714-012-P140\" but in the folder it would be \"3714-012-P140-<strong><em>-</em></strong>-****\".</p>\n\n<p>However, after the initial 3 blocks of code (3714; 012; P140 in the example) there will always show up only 1 picture in the search.</p>\n\n<p>How would one go about selecting the picture with a wildcard in it?</p>\n\n<p>Additionally, how would I go about locking the picture into a specific cell in excel? What I mean to say is that when I resize or delete some rows/columns, the pictures move along the cells they are assigned to.</p>\n\n<pre><code>Dim ws As Worksheet\nDim articleCode As String, _\n    findStr     As String\nSet ws = Workbooks(1).Worksheets(1)\n\nFor i = 1 to ws.UsedRange.Rows.Count\n    articleCode = ws.Cells(i,1)\n    findStr = 'some code\n    ActiveSheet.Pictures.Insert( _\n        \"C:\\...path...\\\" &amp; findStr &amp; \".jpg\").Select\nNext i\n</code></pre>\n\n<p>Edit: I need to insert the photo into a third column in each row of data. </p>\n"}, {"tags": ["c#", "vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5193123"}, "edited": false, "score": 0, "creation_date": 1438774561, "post_id": 31830328, "comment_id": 51584790, "body": "unfortunately it doesn&#39;t work, still I don&#39;t see in my excel file any modules and any macros. I haven&#39;t any ideas to solve this problem. Is it enough to create module: <code>VBIDE.VBProject VBProj = xlWorkBook.VBProject;             VBIDE.VBComponent VBComp = VBProj.VBComponents.Add(VBIDE.vbext_ComponentType.vbext_ct_S&zwnj;&#8203;tdModule);             VBIDE.CodeModule CodeMod = VBComp.CodeModule;             VBComp.Name = &quot;NewModule&quot;;</code>"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1438775139, "post_id": 31830328, "comment_id": 51585163, "body": "@Robert did you check out the help available in the link.  It guides you through creating such code.  Are you getting any errors?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5193123"}, "edited": false, "score": 0, "creation_date": 1438776518, "post_id": 31830328, "comment_id": 51586132, "body": "I am not getting any errors. But if I add in code this line: <code>xlApp.Run(odswiezCykleZBazyLineCycle);</code> then macro will execute once (while app is executting), but still I don&#39;t see this macro on the list of macros in excel file."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5193123"}, "edited": false, "score": 0, "creation_date": 1438779761, "post_id": 31830328, "comment_id": 51588530, "body": "I discovered that before using method <code>xlApp.close()</code> macro exists in excel file, but after <code>close()</code> it disappears."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1438787691, "post_id": 31830328, "comment_id": 51594611, "body": "There is no close on the code you posted. Are you saving the file before closing it? Silly question?"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1438771629, "last_edit_date": 1525816150, "creation_date": 1438771629, "answer_id": 31830328, "question_id": 31828300, "link": "https://stackoverflow.com/questions/31828300/how-to-create-an-excel-vba-script-by-using-automation-from-visual-c/31830328#31830328", "title": "How to create an Excel VBA script by Using Automation from Visual C#", "body": "<p>There are other ways fo doing this that I have used which are more fully described <a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Here's how to add code to a module.</p>\n\n<pre><code>Dim CodePan As VBIDE.CodeModule\nDim S As String\nSet CodePan = ThisWorkbook.VBProject.VBComponents(\"Module2\").CodeModule\nS = _\n\"Sub ABC()\" &amp; vbNewLine &amp; _\n\"    MsgBox \"\"Hello World\"\",vbOkOnly\" &amp; vbNewLine &amp; _\n\"End Sub\" &amp; vbNewLine\nWith CodePan\n    .InsertLines .CountOfLines + 1, S\nEnd With\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5193123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438929243, "creation_date": 1438766316, "last_edit_date": 1438929243, "question_id": 31828300, "link": "https://stackoverflow.com/questions/31828300/how-to-create-an-excel-vba-script-by-using-automation-from-visual-c", "title": "How to create an Excel VBA script by Using Automation from Visual C#", "body": "<p>I wanna create an Excel VBA script to refresh data from database, so I have written this code:</p>\n\n<pre><code>xlModule = xlWorkBook.VBProject.VBComponents.Add(VBIDE.vbext_ComponentType.vbext_ct_StdModule);\nxlModule.Name = \"Module3\";\n\nString macroCode = \"' Makro 1\\r\\n\" +\n                \"Sub odswiezCykleZBazyLineCycle()\\r\\n\" +\n                \"   Application.StatusBar = \\\"Refreshing sheet Cycle_from_DB\\\" \\r\\n\" +\n                \"   ActiveWorkbook.Connections(\\\"Connection\\\").refresh \\r\\n\" +\n                \"   Application.StatusBar = \\\"\\\" \\r\\n\" +\n                \"End Sub\";\nxlModule.CodeModule.AddFromString(macroCode);\n</code></pre>\n\n<p>But after executing this code, I don't see any VBA scripts in my Excel file. What have I done wrong?</p>\n"}, {"tags": ["vba", "excel", "pdf", "shrink"], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 5049784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5oJ5s.png?s=128&g=1", "display_name": "ManInTheMiddle", "link": "https://stackoverflow.com/users/5049784/maninthemiddle"}, "edited": false, "score": 0, "creation_date": 1438773209, "post_id": 31829889, "comment_id": 51583910, "body": "Hey Trum, unfortunately not. Its the same Output, here a screenshot: <a href=\"http://www.bilder-upload.eu/show.php?file=612b8d-1438773890.jpg\" rel=\"nofollow noreferrer\">bilder-upload.eu/show.php?file=612b8d-1438773890.jpg</a> Its not hiding the blank space."}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "reply_to_user": {"reputation": 128, "user_id": 5049784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5oJ5s.png?s=128&g=1", "display_name": "ManInTheMiddle", "link": "https://stackoverflow.com/users/5049784/maninthemiddle"}, "edited": false, "score": 0, "creation_date": 1438775943, "post_id": 31829889, "comment_id": 51585730, "body": "Is the white space true blank? If its spaces or something it may not work. It exported correctly using the code when I tried it."}], "tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": true, "score": 1, "last_activity_date": 1438770524, "creation_date": 1438770524, "answer_id": 31829889, "question_id": 31827934, "link": "https://stackoverflow.com/questions/31827934/export-pdf-from-excelsheet-in-landscape-format-without-blank-space/31829889#31829889", "title": "Export PDF from Excelsheet in Landscape format without blank space", "body": "<p>I think this is what you are after: </p>\n\n<p>Private Sub CommandButton1_Click()\n    Dim mySheets As Variant, sh</p>\n\n<pre><code>mySheets = Array(\"Tabelle1\")\nFor Each sh In mySheets\n    Sheets(sh).PageSetup.Orientation = xlLandscape\n\nNext\n\nFor Each the_cell In Range(\"A1:A33\")\n    If the_cell.Value = \"\" Then\n        the_cell.EntireRow.Hidden = True\n    Else\n        Exit For\n    End If\nNext the_cell\n\nRange(\"A1:CR33\").Select\n\n\nSelection.ExportAsFixedFormat Type:=xlTypePDF, fileName:=ThisWorkbook.Path &amp; \"\\export.pdf\", _\n    quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\nRange(\"A1:A33\").EntireRow.Hidden = False\n\nEnd Sub\n</code></pre>\n\n<p>Essentially, I've added a loop - which will hide the cells before the first filled in row (and unhide after)</p>\n\n<p>Hope that this works for you as intended</p>\n"}], "owner": {"reputation": 128, "user_id": 5049784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5oJ5s.png?s=128&g=1", "display_name": "ManInTheMiddle", "link": "https://stackoverflow.com/users/5049784/maninthemiddle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "accepted_answer_id": 31829889, "answer_count": 1, "score": 2, "last_activity_date": 1438770524, "creation_date": 1438765263, "question_id": 31827934, "link": "https://stackoverflow.com/questions/31827934/export-pdf-from-excelsheet-in-landscape-format-without-blank-space", "title": "Export PDF from Excelsheet in Landscape format without blank space", "body": "<p>need a solution for my misery. This following Code works, but the Problem is it Shows me the blank space as a full site. I would like to know if its possible to \"shrink\" that? </p>\n\n<p><strong><em>The shrinking should start @ Column \"F\"</em></strong></p>\n\n<p>This is the code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim mySheets As Variant, sh\n\n    mySheets = Array(\"Tabelle1\")\n    For Each sh In mySheets\n        Sheets(sh).PageSetup.Orientation = xlLandscape\n\n    Next\n    Range(\"A1:CR33\").Select\n\n    Selection.ExportAsFixedFormat Type:=xlTypePDF, Filename:=ThisWorkbook.Path &amp; \"\\export.pdf\", _\n        Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=True\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>For Illustration here the Pictures.\nThis is what i get:  <a href=\"http://www.bilder-upload.eu/show.php?file=e31421-1438765650.jpg\" rel=\"nofollow\">http://www.bilder-upload.eu/show.php?file=e31421-1438765650.jpg</a></p>\n\n<p>This is what i want:  <a href=\"http://www.bilder-upload.eu/show.php?file=a9f566-1438765707.jpg\" rel=\"nofollow\">http://www.bilder-upload.eu/show.php?file=a9f566-1438765707.jpg</a></p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "scope", "global-variables", "is-empty"], "comments": [{"owner": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "edited": false, "score": 0, "creation_date": 1438767369, "post_id": 31827864, "comment_id": 51580207, "body": "I&#39;ve also tried seting starttime as global and public, but it still does&#39;nt work. I&#39;ve set it as private because it makes sence that the scope is within the module in my mind."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "edited": false, "score": 0, "creation_date": 1438767019, "post_id": 31828046, "comment_id": 51579979, "body": "I&#39;ve tried it, but it does&#39;nt work. When TimerStop() is called starttime is empty."}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "reply_to_user": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "edited": false, "score": 0, "creation_date": 1438767181, "post_id": 31828046, "comment_id": 51580090, "body": "I&#39;m assuming you called TimerStart first? Running the sub &#39;test&#39; works for me... (except it obv runs so quickly that the time is 0)"}, {"owner": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "edited": false, "score": 0, "creation_date": 1438768740, "post_id": 31828046, "comment_id": 51581086, "body": "Ok. Maybe i did&#39;nt ask the question right. I get the time different, but i want the resault to be the seconds elapsed from when i call timerstart untill timerstop. If I put &#180;Application.Wait (Now + #12:00:02 AM#)&#180; between &#180;Call TimerStart&#180; and &#180;MsgBox TimerStop()&#180; in &#180;Sub Test()&#180;, I want the output to be around 2 seconds."}, {"owner": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "edited": false, "score": 0, "creation_date": 1438769699, "post_id": 31828046, "comment_id": 51581640, "body": "Then it&#39;s not my logic however, but it still doesnt work. It is so frustrating... Can it be because of some settings in my VBA version or something?"}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "reply_to_user": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "edited": false, "score": 0, "creation_date": 1438771859, "post_id": 31828046, "comment_id": 51583061, "body": "struggling to work out why that could be. have you stepped through the code line by line using F8? and you can watch in the locals window to try and see where it&#39;s not doing what you think it is."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1438779365, "post_id": 31828046, "comment_id": 51588208, "body": "Are you placing the public variable in a standard code module? If it is placed in a userform module for example then the variable remains in memory only while the userform is active."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1438779408, "post_id": 31828046, "comment_id": 51588247, "body": "Also, if you have &quot;End&quot; on its own in a line anywhere in the code then that will cause all public variables to lose their values."}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": true, "score": 0, "last_activity_date": 1438768986, "last_edit_date": 1438768986, "creation_date": 1438765596, "answer_id": 31828046, "question_id": 31827864, "link": "https://stackoverflow.com/questions/31827864/global-variables-are-empty-even-though-theyve-been-set-within-a-sub-vba/31828046#31828046", "title": "Global variables are empty even though they&#39;ve been set within a sub vba", "body": "<p>Try:</p>\n\n<pre><code>Global starttime As Double \n</code></pre>\n\n<p>At the top of your module\n(instead of <code>Private starttime As Double</code>)</p>\n\n<p><strong>EDIT</strong></p>\n\n<pre><code>Global starttime As Double\n\nSub test()\n    Call TimerStart\n    Application.Wait (Now + #12:00:02 AM#)\n    MsgBox TimerStop()\nEnd Sub\n\nSub TimerStart()\n    starttime = Timer\nEnd Sub\n\nFunction TimerStop() As Double\n    Dim i As Double\n    i = starttime\n    starttime = 0\n    TimerStop = Round(Timer - i, 2)\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "edited": false, "score": 0, "creation_date": 1438767004, "post_id": 31828410, "comment_id": 51579970, "body": "I&#39;ve tried it, but it does&#39;nt work. When TimerStop() is called starttime is empty."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "edited": false, "score": 0, "creation_date": 1438767300, "post_id": 31828410, "comment_id": 51580171, "body": "I tested with <code>Public</code>, I got right message. Yes, starttime will be 0 because <code>starttime = 0</code>. But you will get the time different."}, {"owner": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "edited": false, "score": 0, "creation_date": 1438768654, "post_id": 31828410, "comment_id": 51581045, "body": "Ok. Maybe i did&#39;nt ask the question right. I get the time different, but i want the resault to be the seconds elapsed from when i call timerstart untill timerstop. If I put &#180;Application.Wait (Now + #12:00:02 AM#)&#180;  between &#180;Call TimerStart&#180; and &#180;MsgBox TimerStop()&#180; in &#180;Sub Test()&#180;, I want the output to be around 2 seconds."}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 1, "last_activity_date": 1438766907, "last_edit_date": 1438766907, "creation_date": 1438766606, "answer_id": 31828410, "question_id": 31827864, "link": "https://stackoverflow.com/questions/31827864/global-variables-are-empty-even-though-theyve-been-set-within-a-sub-vba/31828410#31828410", "title": "Global variables are empty even though they&#39;ve been set within a sub vba", "body": "<p>You can use in two way: </p>\n\n<pre><code>Global starttime As Double \n</code></pre>\n\n<p>And</p>\n\n<pre><code>Public starttime As Double \n</code></pre>\n\n<p>Use one of them instead of <code>Private</code>. The main different is:</p>\n\n<blockquote>\n  <p><strong>Global</strong> can only be used in standard modules, whereas <strong>Public</strong> can be used in all contexts (modules, classes, controls, forms etc.) <br><strong>Global</strong> comes from older versions of VB and was likely kept for backwards compatibility, but has been wholly superseded by <strong>Public</strong>.</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 3451066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ecf545f5690cd3df859e67a1027ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/3451066/vegard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1704, "favorite_count": 0, "accepted_answer_id": 31828046, "answer_count": 2, "score": 0, "last_activity_date": 1438768986, "creation_date": 1438765061, "last_edit_date": 1438767536, "question_id": 31827864, "link": "https://stackoverflow.com/questions/31827864/global-variables-are-empty-even-though-theyve-been-set-within-a-sub-vba", "title": "Global variables are empty even though they&#39;ve been set within a sub vba", "body": "<p>Tried to create a timer in VBA. My intetion is to be able to call <code>TimerStart</code>, <code>TimerLaps</code> and <code>TimerStop</code> within other funcitions to estimate how long it takes a code block to finish. But I'm having problems with my global variable being empty.</p>\n\n<pre><code>Private starttime As Double   \n\nSub TimerStart()\n    starttime = Timer\nEnd Sub\n\nFunction TimerLaps() As Double\n    TimerLaps = Timer - starttime\nEnd Function\n\nFunction TimerStop() As Double\n    i = starttime\n    starttime = 0\n    TimerStop = Round(Timer - i, 2)\nEnd Function\n\nSub test()\n    Call TimerStart\n\n    MsgBox TimerStop()\nEnd Sub\n</code></pre>\n\n<p>Thanks guys!</p>\n"}, {"tags": ["regex", "vba"], "comments": [{"owner": {"reputation": 78237, "user_id": 2025923, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zYYVM.png?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/2025923/tushar"}, "edited": false, "score": 4, "creation_date": 1438764188, "post_id": 31827527, "comment_id": 51578120, "body": "Use word boundary flag <code>\\b</code>"}, {"owner": {"reputation": 417, "user_id": 3535152, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef077a8a6d8117f310d535f985d5c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "Trm", "link": "https://stackoverflow.com/users/3535152/trm"}, "reply_to_user": {"reputation": 78237, "user_id": 2025923, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zYYVM.png?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/2025923/tushar"}, "edited": false, "score": 0, "creation_date": 1438767605, "post_id": 31827527, "comment_id": 51580358, "body": "@Tushar that actually seem to work. I swear I tried it as first option, but it looked like it captured only if pattern started or ended in whole string.  I think i did a mistake adding spaces, but \\bHYD\\b seem to work! thank you"}], "answers": [{"comments": [{"owner": {"reputation": 417, "user_id": 3535152, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef077a8a6d8117f310d535f985d5c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "Trm", "link": "https://stackoverflow.com/users/3535152/trm"}, "edited": false, "score": 0, "creation_date": 1438765948, "post_id": 31827629, "comment_id": 51579282, "body": "problem with Instr is it will return position of any word that has HYD in it. so MYHYDOK will return it and I don&#39;t want that. I only want HYD or nothing"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 417, "user_id": 3535152, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef077a8a6d8117f310d535f985d5c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "Trm", "link": "https://stackoverflow.com/users/3535152/trm"}, "edited": false, "score": 1, "creation_date": 1438769153, "post_id": 31827629, "comment_id": 51581309, "body": "In which case, a regular expression with word boundaries is the way to go."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1438764456, "creation_date": 1438764456, "answer_id": 31827629, "question_id": 31827527, "link": "https://stackoverflow.com/questions/31827527/how-can-i-match-an-exact-word-in-a-string-with-a-regex/31827629#31827629", "title": "How can I match an exact word in a string with a regex?", "body": "<p>Use <code>InStr(s, \"HYD\")</code> instead: <code>InStr</code> is a language keyword in VBA and this approach will be faster than using regular expressions.</p>\n\n<p>This will return the position of the first occurrence of <code>\"HYD\"</code> in the <code>String s</code>, or 0 if <code>\"HYD\"</code> is not contained.</p>\n"}, {"comments": [{"owner": {"reputation": 417, "user_id": 3535152, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef077a8a6d8117f310d535f985d5c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "Trm", "link": "https://stackoverflow.com/users/3535152/trm"}, "edited": false, "score": 0, "creation_date": 1438766249, "post_id": 31827656, "comment_id": 51579473, "body": "Unfortunately neither of examples work. /*HYD/* still finds similar text that I want to ignore. for example: HYDROtext2.  the second example finds a lot more patterns with word HYD in it."}], "tags": [], "owner": {"reputation": 259, "user_id": 3462988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/844c00735842ad9dcbabc10c1883a099?s=128&d=identicon&r=PG&f=1", "display_name": "Willem", "link": "https://stackoverflow.com/users/3462988/willem"}, "is_accepted": false, "score": 2, "last_activity_date": 1438764822, "last_edit_date": 1495541639, "creation_date": 1438764521, "answer_id": 31827656, "question_id": 31827527, "link": "https://stackoverflow.com/questions/31827527/how-can-i-match-an-exact-word-in-a-string-with-a-regex/31827656#31827656", "title": "How can I match an exact word in a string with a regex?", "body": "<p>I've tested with the regex below and got the results you seem to need :) </p>\n\n<p><code>/*HYD/*</code></p>\n\n<p>I've tested via <a href=\"http://regexpal.com/\" rel=\"nofollow noreferrer\">http://regexpal.com/</a></p>\n\n<p>-EDIT:</p>\n\n<p>The real answer you are looking for (i think) is <a href=\"https://stackoverflow.com/a/18936642/3462988\">https://stackoverflow.com/a/18936642/3462988</a></p>\n\n<p>The pattern mentioned there selects the whole word containing HYD.\n<code>\\b(?=\\w*[HYD])\\w+\\b</code></p>\n"}, {"comments": [{"owner": {"reputation": 4809, "user_id": 4423545, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/dRPDg.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4423545/andrew"}, "edited": false, "score": 0, "creation_date": 1585069831, "post_id": 45440100, "comment_id": 107634574, "body": "try to search <code>[\\b \u2026\u2026 \\b]*</code> and it will not found exact phrase in string =("}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 4809, "user_id": 4423545, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/dRPDg.jpg?s=128&g=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4423545/andrew"}, "edited": false, "score": 1, "creation_date": 1586853606, "post_id": 45440100, "comment_id": 108273564, "body": "@Andrew <code>\\b</code> inside character classes is a backspace char matching pattern, not a word boundary. <code>\\bHYD\\b</code> is a valid example of matching <code>HYD</code> not enclosed with letters, digits or <code>_</code>."}], "tags": [], "owner": {"reputation": 18939, "user_id": 2756409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/UIrGI.jpg?s=128&g=1", "display_name": "TylerH", "link": "https://stackoverflow.com/users/2756409/tylerh"}, "is_accepted": false, "score": 5, "last_activity_date": 1501596297, "creation_date": 1501596297, "answer_id": 45440100, "question_id": 31827527, "link": "https://stackoverflow.com/questions/31827527/how-can-i-match-an-exact-word-in-a-string-with-a-regex/45440100#45440100", "title": "How can I match an exact word in a string with a regex?", "body": "<p>From the comments:</p>\n\n<p>Use <code>\\b</code> word boundary flags for your solution:</p>\n\n<pre><code>objRegEx.Pattern = \"\\bHYD\\b\"\n</code></pre>\n\n<p>Will hit only strings whose whole value is HYD, not strings where there is HYD embedded with some other characters.</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1501596849, "last_edit_date": 1501596849, "creation_date": 1501596494, "answer_id": 45440159, "question_id": 31827527, "link": "https://stackoverflow.com/questions/31827527/how-can-i-match-an-exact-word-in-a-string-with-a-regex/45440159#45440159", "title": "How can I match an exact word in a string with a regex?", "body": "<p>You don't even need the <code>RegExp</code> object - VBA's native <code>Like</code> operator can handle this:</p>\n\n<pre><code>Const allowedSymbols As String = \" ,.\\/\\-\"\n\nIf myText Like \"*[\" &amp; allowedSymbols &amp; \"]HYD[\" &amp; allowedSymbols &amp; \"]*\" Then\n    Debug.Print \"Found\"\nElse\n    Debug.Print \"Not Found\"\nEnd If\n</code></pre>\n\n<p>If you're absolutely sold on regex though then use this pattern:</p>\n\n<pre><code>(^|\\b)HYD\\b\n</code></pre>\n\n<p>With <code>MultiLine</code> and <code>Global</code> set to <code>True</code> - this pattern will match spaces and symbols, but will also match if \"HYD\" is the first word in the string:</p>\n\n<pre><code>'// These will all match:\ntext1 HYD text2 \ntext1,HYD.text2\nHYD test1\n</code></pre>\n"}], "owner": {"reputation": 417, "user_id": 3535152, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ef077a8a6d8117f310d535f985d5c6e2?s=128&d=identicon&r=PG&f=1", "display_name": "Trm", "link": "https://stackoverflow.com/users/3535152/trm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21130, "favorite_count": 1, "answer_count": 4, "score": 6, "last_activity_date": 1501596849, "creation_date": 1438764139, "last_edit_date": 1501596311, "question_id": 31827527, "link": "https://stackoverflow.com/questions/31827527/how-can-i-match-an-exact-word-in-a-string-with-a-regex", "title": "How can I match an exact word in a string with a regex?", "body": "<p>I've been struggling to find solution to what sounds like a simple problem.</p>\n\n<p>I need to find a word \"HYD\" (capital letters) in a text string. I need match to be exact. To clarify, any word/text that has \"HYD\" in it, but does not equal should <strong>not</strong> be matched. Exception are spaces and symbols.</p>\n\n<p><br>Find in below examples:\n<br>text1 HYD text2\n<br>text1,HYD.text2</p>\n\n<p>Ignore in below examples:\n<br>text1 HYDROtext2\n<br>text1 MYHYD text2</p>\n\n<p>The closest I was able to get was following pattern:</p>\n\n<blockquote>\n  <p>objRegEx.Pattern = \"[^a-z]HYD[^a-z]\"</p>\n</blockquote>\n\n<p>Problem with that is that it will not find \"HYD\" if string starts or ends with it.</p>\n"}, {"tags": ["excel", "vba", "powerpivot"], "answers": [{"comments": [{"owner": {"reputation": 1358, "user_id": 4114591, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aIySb.jpg?s=128&g=1", "display_name": "Michael Z.", "link": "https://stackoverflow.com/users/4114591/michael-z"}, "edited": false, "score": 0, "creation_date": 1464292226, "post_id": 31828030, "comment_id": 62438255, "body": "Thank you! It was killing me trying to figure this out. Every tutorial I&#39;ve seen does not use <code>SlicerCacheLevels</code>."}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": true, "score": 5, "last_activity_date": 1438765542, "creation_date": 1438765542, "answer_id": 31828030, "question_id": 31827145, "link": "https://stackoverflow.com/questions/31827145/application-defined-or-object-defined-error-with-excel-slicer/31828030#31828030", "title": "Application-defined or object-defined error with Excel Slicer", "body": "<p>OK, I think that <strong>you can't get SlicerItems straightly from SlicerCaches</strong> according to this <a href=\"https://paultebraak.wordpress.com/2012/02/24/accessing-the-slicer-through-vba/\" rel=\"noreferrer\">reference</a>.</p>\n\n<p>So, you got error. Here my suggestion, try as follow:</p>\n\n<pre><code>Sub TestSclicer()\n\nDim sC As SlicerCache\nDim sI As SlicerItem\nDim index As Integer\n\nSet sC = ActiveWorkbook.SlicerCaches(\"Slicer_Courses2\")\n\nsC.ClearManualFilter\n\nFor index = 1 To sC.SlicerCacheLevels.count\n\n    For Each sI In sC.SlicerCacheLevels(index).SlicerItems\n\n        If sI.Name = \"Introduction To Slicer\" Then\n            sI.Selected = True\n        Else\n            sI.Selected = False\n        End If\n\n    Next sI\n\nNext index \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 5192866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39c3255ce535c49a02f2cb6cf06d607?s=128&d=identicon&r=PG&f=1", "display_name": "FredC", "link": "https://stackoverflow.com/users/5192866/fredc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3191, "favorite_count": 2, "accepted_answer_id": 31828030, "answer_count": 1, "score": 4, "last_activity_date": 1568419529, "creation_date": 1438763006, "last_edit_date": 1568419529, "question_id": 31827145, "link": "https://stackoverflow.com/questions/31827145/application-defined-or-object-defined-error-with-excel-slicer", "title": "Application-defined or object-defined error with Excel Slicer", "body": "<p>In a KPI dashboard on course attendance, I have a dropdown list with course names.  A user picks a course and a macro must select the picked course in a slicer (connected to a cube).</p>\n\n<p>When using the macro recorder, I see that the recorder uses a kind of index to pick up the course the user wants, and not the name (&amp;[18] in my example):</p>\n\n<pre><code>ActiveWorkbook.SlicerCaches(\"Slicer_Course2\").VisibleSlicerItemsList = Array(\"[Course].[Course].&amp;[18]\")\n</code></pre>\n\n<p>I want to browse through the different slicer items and only select the item which corresponds to the choice of the user in my dropdown list, but based on the name of the course.  For example, if user chooses the course \"Introduction To Slicer\":</p>\n\n<pre><code>Sub TestSclicer()\nDim i\n\nActiveWorkbook.SlicerCaches(\"Slicer_Courses2\").ClearManualFilter\n\nFor i = 1 To ActiveWorkbook.SlicerCaches(\"Slicer_Courses2\").SlicerItems.Count\n     If ActiveWorkbook.SlicerCaches(\"Slicer_Courses2\").SlicerItems(i).Name = \"Introduction To Slicer\" Then\n        ActiveWorkbook.SlicerCaches(\"Slicer_Courses2\").SlicerItems(i).Selected = True\n    Else\n        ActiveWorkbook.SlicerCaches(\"Slicer_Courses2\").SlicerItems(i).Selected = False\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>It bugs on  <code>ActiveWorkbook.SlicerCaches(\"Slicer_Courses2\").SlicerItems.Count</code> with message</p>\n\n<blockquote>\n  <p>application-defined of object-defined error</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1438764119, "post_id": 31827009, "comment_id": 51578078, "body": "This code only splits cells that are not empty. Which is also what it should do, since it should split at chr(10), which can&#39;t be done when the cell is empty. Perhaps you need to check first if there are multiple Chr(10) right after each other. The same thing as the build in dialogue for splitting cells can do: treat consequitive delimiters as one."}, {"owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438764834, "post_id": 31827009, "comment_id": 51578557, "body": "@Luuklag There is, and I need to delete the empty rows with any empty cells too."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438765045, "post_id": 31827009, "comment_id": 51578690, "body": "perhaps you can show us a print screen of where exactly empty cells end up, and what the original input was for that row."}, {"owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438765824, "post_id": 31827009, "comment_id": 51579201, "body": "@Luuklag Actually now the biggest problem is the empty row, cuz it stops the loop. I will upload the print screen soon."}, {"owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438767153, "post_id": 31827009, "comment_id": 51580071, "body": "@Luuklag Hi just uploaded the screenshot"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438767531, "post_id": 31827009, "comment_id": 51580303, "body": "Does it delete the first empty cell or not? If yes, it could be that by deleting the cell the order in which cells are handled is corrupted. I usually do this kind of work with a For loop, and then reference to the rows as rows, and the cells as Cell(row,column). Then when one row gets deleted you need to do that same row again, so after cell delete you need to have something like <code>row = row-1</code>"}, {"owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438767753, "post_id": 31827009, "comment_id": 51580476, "body": "@Luuklag no, the problem is it&#39;s not deleting any empty cells, should I try with <code>row = row-1</code> now? But my condition should already delete the whole row"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438769233, "post_id": 31827009, "comment_id": 51581351, "body": "Yes it deletes rows, but please run the code step by step and see if it deletes the first row that contains an empty cell or not."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1438771412, "post_id": 31827009, "comment_id": 51582751, "body": "@Luuklag if you are deleting rows in a for loop, you can avoid complicating things by iterating over the range in reverse order. E.g.  <code>For i = SomeRange.Rows.Count to 1 Step -1</code>"}, {"owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "reply_to_user": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438775659, "post_id": 31827009, "comment_id": 51585516, "body": "@CBRF23 I&#39;m putting in a For loop, wondering why it can&#39;t identify and delete the empty cells"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1438842374, "post_id": 31827009, "comment_id": 51617261, "body": "@CBRF23: Thanks for the tip, that would indeed save a lot of work :)"}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1438776680, "post_id": 31832059, "comment_id": 51586230, "body": "If my solution does not solve the problem of identifying &quot;empty cells&quot;, maybe this code can: <a href=\"http://stackoverflow.com/questions/16246078/remove-line-breaks-return-carriages-and-all-leading-space-in-excel-cell\" title=\"remove line breaks return carriages and all leading space in excel cell\">stackoverflow.com/questions/16246078/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1438776403, "creation_date": 1438776403, "answer_id": 31832059, "question_id": 31827009, "link": "https://stackoverflow.com/questions/31827009/split-cells-at-line-breaks-with-content-with-in-vba/31832059#31832059", "title": "split cells at line breaks with content with in VBA", "body": "<p>Maybe the cells aren't really empty as proposed in an earlier comment. Did you verify that these cells are really empty?</p>\n\n<pre><code>If Replace(Replace(Trim(cell.value2), chr(10), \"\"), vbNewLine, \"\") &lt;&gt; vbNullString Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "edited": false, "score": 0, "creation_date": 1438852948, "post_id": 31837480, "comment_id": 51623560, "body": "Hi thanks for your efforts on this answer, however it didn&#39;t either skip the blank cells or delete the rows with empty cells."}, {"owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "edited": false, "score": 0, "creation_date": 1438853196, "post_id": 31837480, "comment_id": 51623742, "body": "And fyi, some empty cells are created in the for loop, so you can&#39;t identify them beforehand."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "edited": false, "score": 0, "creation_date": 1438857906, "post_id": 31837480, "comment_id": 51626948, "body": "I didn&#39;t know you wanted to skip blank cells - can you further explain the requirement? I though you wanted all blanks deleted. If blanks are created from the extraction process, you can simply move the delete portion of code to after the loop. If a row is not deleted, the cell is not empty. Select the cell in question, in the immediate window type <code>?IsEmpty(Selection)</code> - do you get true or false?"}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "edited": false, "score": 0, "creation_date": 1438869257, "post_id": 31837480, "comment_id": 51634772, "body": "I still don&#39;t know what you mean by skipping blank cells - but I&#39;ve edited my answer to deal with what I think your problem is.   Before running this - I&#39;d still like you to perform the test I commented about above in the immediate window.   If you get a return of <code>False</code> then try <code>?InStr(1,Selection.Value,chr(10))</code> and I&#39;m going to guess you get something greater than 0."}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "edited": false, "score": 0, "creation_date": 1439291308, "post_id": 31837480, "comment_id": 51790298, "body": "At OP - has your problem been solved? Did you try any of the things I suggested in the immediate window?"}], "tags": [], "owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "is_accepted": false, "score": 0, "last_activity_date": 1438870219, "last_edit_date": 1438870219, "creation_date": 1438790585, "answer_id": 31837480, "question_id": 31827009, "link": "https://stackoverflow.com/questions/31827009/split-cells-at-line-breaks-with-content-with-in-vba/31837480#31837480", "title": "split cells at line breaks with content with in VBA", "body": "<p>Try this code. \nI've commented it to explain what I'm doing, but let me know if you need a further breakdown of how it works.  I've added error handling to deal with expected and unexpected conditions. </p>\n\n<p><strong>EDIT:</strong>  I've added a function for cleaning cells created from concurrent delimiters in the split/transpose loop, and moved the delete empty rows step to after the do loop do clean these up. </p>\n\n<pre><code>Sub SplitMultipleHostnames()\n    'I've added some error handling. \n    On Error GoTo UnexpectedErr\n\n    'Get the last used cell.\n    With Range(\"D:D\")\n        Dim LastDataCell As Range\n        Set LastDataCell = .Find(\"*\", .Cells(1, 1), xlFormulas, xlPart, xlByRows, xlPrevious, False, False, False)\n    End With\n\n    'We need to have some data to work upon beyond the first row\n    If LastDataCell Is Nothing Then Exit Sub\n    If LastDataCell.Row &lt; 2 Then Exit Sub\n\n    'I set a range variable here to make it easier to work with later\n    Dim WorkingRange As Range\n    Set WorkingRange = Range(\"D2\", LastDataCell)\n\n    'You can avoid expensive loop overhead by just finding the cells containing _\n    the character you wish to split upon, and acting upon only these cells\n    Dim FoundCell As Range\n    Dim FirstAddress As String\n    Set FoundCell = WorkingRange.Find(Chr(10), LastDataCell, xlValues, xlPart, xlByRows, xlNext, False, False, False)\n\n    'Another benefit of this approach: if there are no line breaks we can exit early\n    If FoundCell Is Nothing Then Exit Sub\n\n    'We are going to use .FindNext to loop through all the cells containing our _\n    delmiiter character.  Store first found cell's address so we know when we're done\n    FirstAddress = FoundCell.Address\n\n    'Since we know our data type we should declare are variable as such\n    Dim tmpArr() As String\n    Do\n        tmpArr = Split(FoundCell, Chr(10))\n        'Use a With block if you're lazy like me ;)\n        With FoundCell\n            .Offset(1, 0).Resize(UBound(tmpArr), 1).EntireRow.Insert xlShiftDown\n            Set FoundCell = FoundCell.Resize(UBound(tmpArr) + 1, 1)\n            FoundCell = Application.Transpose(tmpArr)\n        End With\n\n        'A cell could contain mulitple concurrent delimiters.\n        'We can handle this by finding all concurrent delimiters and replacing with a _\n        single delimiter before splitting the cell contents.\n        ' - OR -\n        'We can split the cell contents and then remove any remaining delimiters afterward\n\n        'I've elected to do the latter as I think it's the simplest route in this application\n        Dim CheckCell As Range\n        For Each CheckCell In FoundCell\n            RemoveDelimiters CheckCell, Chr(10), True\n        Next\n\n        'Find the next cell to work upon\n        Set FoundCell = WorkingRange.FindNext\n        'If we don't find another match, we are done\n        If FoundCell Is Nothing Then Exit Do\n    Loop While FoundCell.Address &lt;&gt; FirstAddress\n\n    'Now that we are done, we will delete any rows with blank cells\n    Dim BlankCells As Range\n\n    'It is possible there are not any empty cells - we should anticipate this error and provide a way to handle it:\n    On Error GoTo CatchErr001\n    Set BlankCells = WorkingRange.SpecialCells(xlCellTypeBlanks)\n    On Error GoTo UnexpectedErr\n\n    'We check condition to see if BlankCells is allocated, as we know it won't be if no blank cells were found\n    If Not BlankCells Is Nothing Then BlankCells.EntireRow.Delete\n\nExit Sub\n\nCatchErr001:\n    '1004 is a generic runtime error. It could be because no blank cells found, or something else.\n    'If it's due to no blank cells our code is built to deal with this condition so we can safely swallow the error\n    If (err.Number = 1004) And (InStr(1, err.Description, \"No cells were found\", vbTextCompare) &gt; 0) Then\n        Resume Next\n    'If it's due to something else, our program is in an unknonw state.  This is unexpected\n    Else\n        GoTo UnexpectedErr\n    End If\n\nUnexpectedErr:\n    Dim CaughtErr As ErrObject\n    Set CaughtErr = err\n    On Error GoTo 0\n    err.Raise CaughtErr.Number, CaughtErr.Source, CaughtErr.Description, CaughtErr.HelpFile, CaughtErr.HelpContext\nEnd Sub\n\nPrivate Sub RemoveDelimiters(ByRef CheckCell As Range, ByRef Delimiter As String, Optional ByVal RemoveSpaces As Boolean = False)\n    Dim CheckValue As String\n    CheckValue = CheckCell.value\n    'If the cell is already empty we don't do anything further\n    If Len(CheckCell) &lt;= 0 Then Exit Sub\n    'Remove spaces if the calling procedure specified to do so\n    If RemoveSpaces Then CheckValue = Trim(CheckValue)\n    'Remove all delimiter characters\n    CheckValue = Replace(CheckCell, Delimiter, \"\")\n    'Replace the cell's value with our modified value\n    CheckCell.value = CheckValue\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4502871, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/caab609e3d6f324b0e47908e22506943?s=128&d=identicon&r=PG&f=1", "display_name": "vivi xu", "link": "https://stackoverflow.com/users/4502871/vivi-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1026, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1438870219, "creation_date": 1438762637, "last_edit_date": 1438853296, "question_id": 31827009, "link": "https://stackoverflow.com/questions/31827009/split-cells-at-line-breaks-with-content-with-in-vba", "title": "split cells at line breaks with content with in VBA", "body": "<p>I have a macro which splits cells with multiple lines of data at line breaks, it works smoothly. However I've hit a bump that the macro leaves some blank cells while splitting. I have certain code to identify the blank cells and delete them, but somehow it doesn't work. So I wonder do I put the testing blank code at the right position? They seem to be correct code for checking blank code though.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub SplitMultipleHostnames()\nDim tmpArr As Variant\n\n\nFor Each cell In Range(\"D2\", Range(\"D3\").End(xlDown))\nIf cell &lt;&gt; \"\" Then\n    If InStr(1, cell, Chr(10)) &lt;&gt; 0 Then\n        tmpArr = Split(cell, Chr(10))\n\n        cell.EntireRow.Copy\n\n        cell.Offset(1, 0).Resize(UBound(tmpArr), 1).EntireRow.Insert xlShiftDown\n\n\n\n        cell.Resize(UBound(tmpArr) + 1, 1) = Application.Transpose(tmpArr)\n\n\n    End If\nElse\n    cell.EntireRow.Delete\nEnd If\nNext\nApplication.CutCopyMode = False\n\n\nEnd Sub\n</code></pre>\n\n<p>Here's a print screen of the sample, usually hostnames and ip addresses will be line by line, but if in between there's a empty line, it will be split as a blank cell. And the blank cell will stop the whole loop working.</p>\n\n<p>Edit:\nNoted that some blank cells are created while the code running.\n<a href=\"https://i.stack.imgur.com/idqTi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/idqTi.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 930, "user_id": 4600127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc7345ceed5fb91c40faebc880ae994?s=128&d=identicon&r=PG&f=1", "display_name": "Verzweifler", "link": "https://stackoverflow.com/users/4600127/verzweifler"}, "edited": false, "score": 0, "creation_date": 1438764693, "post_id": 31826753, "comment_id": 51578440, "body": "I&#39;m not sure how you want to condense four Columns into only one Cell. But you can iterate over rows via <code>for each cell in Rangeobject.Rows.Cells</code>, where Rangeobject should be you four columns in one object."}], "answers": [{"tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1438767691, "creation_date": 1438767691, "answer_id": 31828813, "question_id": 31826753, "link": "https://stackoverflow.com/questions/31826753/excel-vba-loop-on-multiple-ranges/31828813#31828813", "title": "Excel VBA Loop on multiple ranges", "body": "<p>Still a bit unclear about what you're trying to do, but this might get you started:</p>\n\n<pre><code>Sub FootballPredict()\n\n    Dim GuessResRange As Range\n    Dim rngLoop As Range\n    Dim dblSum As Double\n\n    Set GuessResRange = Range(\"B2\", Range(\"B2\").End(xlDown))\n\n'    For Each rngLoop In GuessResRange\n'        'could use this loop to do something\n'    Next rngLoop\n\n    dblSum = WorksheetFunction.Sum(GuessResRange)\n    Range(\"B14\").Value = dblSum\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4213880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be328e0ccfc9394ec03ce1e7b5f3bcb6?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Lavercombe", "link": "https://stackoverflow.com/users/4213880/jon-lavercombe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438767691, "creation_date": 1438761850, "question_id": 31826753, "link": "https://stackoverflow.com/questions/31826753/excel-vba-loop-on-multiple-ranges", "title": "Excel VBA Loop on multiple ranges", "body": "<p>Hi im looking for some help on a loop i've been trying to work out. Its only for a football prediction spreadsheet.</p>\n\n<p>Basically i have rows of peoples name where the guess the result and the score.</p>\n\n<p>then i have the first 2 rows as the actual result and score.</p>\n\n<p>I've created a function to calculate it but i need to loop through each row in ranges to add up the totals.</p>\n\n<pre><code> `ResultRange = Range(\"B2\", Range(\"A2\").End(xlDown)).Rows.Count\n ScoreRange = Range(\"C2\", Range(\"C2\").End(xlDown)).Rows.Count\n GuessResRange = Range(\"D2\", Range(\"D2\").End(xlDown)).Rows.Count\n GuessScoreRange = Range(\"E2\", Range(\"E2\").End(xlDown)).Rows.Count\n\nRange(\"B14\").Value = ScorePoints(InResultRows, InScoreRows,      InGuessResult, InGuessScore)\n</code></pre>\n\n<p>This is what I have so far.</p>\n\n<p>Basically for 10 games ResultRows, ScoreRows, GuessResult, GuessScore</p>\n\n<p>would go from B2,C2,D2,E2 to B3,C3,D3,E3 and so on until it hits the end of the scores. Then the total would be tallied up in Range B14. Then continuing this onto the next player?</p>\n"}, {"tags": ["vba", "excel", "dynamic-arrays", "string-search"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1438763635, "post_id": 31826352, "comment_id": 51577791, "body": "Say, how store your build code in your excel sheet. I means, what range or what column. So, I can give more."}], "answers": [{"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 1, "last_activity_date": 1438763420, "last_edit_date": 1438763420, "creation_date": 1438762162, "answer_id": 31826845, "question_id": 31826352, "link": "https://stackoverflow.com/questions/31826352/in-string-search-for-number-to-determine-next-in-sequence/31826845#31826845", "title": "In string search for number to determine next in sequence?", "body": "<p>Here is a small piece of code for getting new build no for inputted build no.</p>\n\n<p>I already tested the code. It give me right answer. So, you can use this code.</p>\n\n<pre><code>Public Sub getBuildNo()\n\n    Dim machineCode, lastBuildCode, newBuildCode As String\n    Dim buildNo As Integer\n\n    'Set machine code\n    machineCode = \"R1079\"\n\n    'Set last build code\n    lastBuildCode = Range(\"A1\")\n\n    'Get last build no\n    buildNo = Right(lastBuildCode, 3)\n\n    'Increase 1\n    buildNo = buildNo + 1\n\n    'Get new build No\n    newBuildCode = machineCode &amp; \"-AAA-\"\n\n    'adding prefix 0s for getting like (001, 002, 025, etc.)\n    If buildNo &lt; 10 Then\n        newBuildCode = newBuildCode &amp; \"00\" &amp; buildNo\n    ElseIf buildNo &lt; 100 Then\n        newBuildCode = newBuildCode &amp; \"0\" &amp; buildNo\n    Else\n        newBuildCode = newBuildCode &amp; buildNo\n    End If\n\n    'show new code\n    Range(\"C1\") = newBuildCode\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5192717, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--oPWQCp0zgQ/AAAAAAAAAAI/AAAAAAAAAEg/ymXx2mu31Gs/photo.jpg?sz=128", "display_name": "Charlie McGuinness", "link": "https://stackoverflow.com/users/5192717/charlie-mcguinness"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438763420, "creation_date": 1438760650, "last_edit_date": 1531164843, "question_id": 31826352, "link": "https://stackoverflow.com/questions/31826352/in-string-search-for-number-to-determine-next-in-sequence", "title": "In string search for number to determine next in sequence?", "body": "<p>I have a list of build numbers (e.g. R1079-AAA-001, ...-002 etc.) in which the value of \"R1079\" changes depending on the machine being used. What I want to do is search through the list to determine the last used build number (the last 3 digits) in relation to the specific machine I intend to use. I then need to add one and create a new log for the new build i.e. the last R1079 build was 056, therefore the new one is 057.</p>\n\n<p>Currently the THEORY I have is an in string search for the machine number followed by a number search and store in the string and converted to integer. This is then added into a dynamic array and the maximum found when the loop is complete. One is added to this integer and the new name placed into a cell.</p>\n\n<p>However, the code I have doesn't work so I assume I am missing things/got it all wrong. </p>\n\n<p>Code below:</p>\n\n<pre><code>Sub test()\n\nDim x As String\nDim n As Integer\nDim i As Integer\nDim Machine_EBM As String\nDim retval As String\nDim retvalint As Integer\nDim LastBuild As Integer\nDim NextBuild As Integer\nDim myarr() As Integer\n\nMachine = \"R1079\"\n\nx = Cells(\"A1\").Value 'get the first string in the list\n    n = 1\n    Do Until x = \"\"\n        If InStr(x, Machine) &gt; 0 Then 'search for machine in string\n            For i = 6 To Len(Str) 'search for numbers at end of string\n                If Mid(x, i, 1) &gt;= \"0\" And Mid(x, i, 1) &lt;= \"9\" Then\n                    retval = retval + Mid(s, i, 1) 'store numbers\n                End If\n            Next i\n            retvalint = CInt(retval) ' convert to integer\n            ReDim Preserve myarr(n)\n            myarr(n) = retvalint ' store integer value in array\n            n = n + 1\n        End If\n    Loop\n\n    LastBuild = Worksheet.Function.Max(myarr(n)) ' determine maximum array value\n    NewBuild = LastBuild + 1 'add one to the value\n\n    Range(\"C1\").Select\n    ActiveCell = Machine = \"-AAA-\" + NewBuild 'input new build number\n\nEnd Sub\n</code></pre>\n\n<p>I am fairly new to VBA and self taught so I realise there may be a lot of errors here that I am missing. Any help is appreciated!</p>\n\n<p>Thanks,</p>\n\n<p>Charlie</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1438760788, "post_id": 31826079, "comment_id": 51575999, "body": "For Q2, You should say more like, which sheets for which user and password because you code is enough for your question."}], "answers": [{"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": true, "score": 2, "last_activity_date": 1438761245, "last_edit_date": 1438761245, "creation_date": 1438760732, "answer_id": 31826384, "question_id": 31826079, "link": "https://stackoverflow.com/questions/31826079/hide-specific-sheets-when-closing-workbook/31826384#31826384", "title": "Hide specific sheets when closing workbook", "body": "<p>Here for setting visible false, you can use <code>Workbook_BeforeClose</code> method as follow:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    Worksheets(\"Team_1\").Visible = False\n    Worksheets(\"Team_1_sub\").Visible = False\n\n    'must save, if not save, it is not effect.\n    Me.Save\n\nEnd Sub\n</code></pre>\n\n<p>Reference for that method is <a href=\"https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0CB4QFjAAahUKEwj3voHTuJHHAhVJA44KHczFAzU&amp;url=https%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Foffice%2Fff194765.aspx&amp;ei=U77BVbfJCcmGuATMi4-oAw&amp;usg=AFQjCNH8ekz4DQtWu_pjMfM3pD4YaLXdTA&amp;sig2=rvZ6F7Nm7oYHA1kcLkADEQ&amp;bvm=bv.99261572,d.c2E&amp;cad=rja\" rel=\"nofollow\">here</a>.</p>\n\n<p>One thing is that this method must have in the <code>ThisWorkBook</code> module.</p>\n\n<p>For next question, you should say more like, which sheets for which user and password. Because you code is enough for your question. It can use for your requirement.</p>\n"}, {"tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 0, "last_activity_date": 1438760960, "creation_date": 1438760960, "answer_id": 31826457, "question_id": 31826079, "link": "https://stackoverflow.com/questions/31826079/hide-specific-sheets-when-closing-workbook/31826457#31826457", "title": "Hide specific sheets when closing workbook", "body": "<p>ad 1)</p>\n\n<p>you best use a <code>Workbook_BeforeSave()</code> routine to code the hiding of all sheets ... in the VBAProject view you find this under <code>ThisWorkbook</code></p>\n\n<p>ad 2)</p>\n\n<p>The code you post looks very nice - my point of concern would be the hard coding of user names vs. sheet names. I would consider putting this in a sheet/table using headers /code/ /sheetname/ ... this way you can adapt your logic at any time without having to modify the code.</p>\n\n<p>With such a table at hand (in an all time hidden sheet if need be) you traverse it (one single piece of code) and - upon code entering - you unhide <code>If CodeInTable = CodeEntered</code> ... in the other case you unconditionally hide that sheet ... because hiding/unhiding differs only by 2 simple conditions.</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1438845302, "creation_date": 1438845302, "answer_id": 31849137, "question_id": 31826079, "link": "https://stackoverflow.com/questions/31826079/hide-specific-sheets-when-closing-workbook/31849137#31849137", "title": "Hide specific sheets when closing workbook", "body": "<p>As you aren't using passwords you should at least make the sheets <code>VeryHidden</code> rather than <code>Hidden</code> - much harder for the average user to unhide.</p>\n\n<p>The <code>Me.Save</code> proposed by the other answer also isn't necessary. </p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nOn Error Resume Next\n    Worksheets(\"Team_1\").Visible = VeryHidden\n    Worksheets(\"Team_1_sub\").Visible = VeryHidden\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 5033775, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4b8d96db097c6c7f22c0ec9fa68e6f3e?s=128&d=identicon&r=PG&f=1", "display_name": "Marc van der Peet", "link": "https://stackoverflow.com/users/5033775/marc-van-der-peet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7647, "favorite_count": 0, "accepted_answer_id": 31826384, "answer_count": 3, "score": 2, "last_activity_date": 1438856548, "creation_date": 1438759846, "last_edit_date": 1531164843, "question_id": 31826079, "link": "https://stackoverflow.com/questions/31826079/hide-specific-sheets-when-closing-workbook", "title": "Hide specific sheets when closing workbook", "body": "<p>I'm creating some VBA code which should do the following:</p>\n\n<ol>\n<li>Users press a button a are required to input a code. </li>\n<li>When the input the correct code the team relevant code they get access to certain sheets.</li>\n</ol>\n\n<p>The sheets they get access to differs according to the team number and code they enter. So when they enter he password \"banana\": the sheets \"Team_1\" &amp; <code>Team_1_sub</code> become visible.</p>\n\n<p>I now created the following code to achieve this:</p>\n\n<pre><code> Sub filter_tabs()\n\n  Dim answer As String\n  answer = InputBox(\"Please enter your password\")\n\n   If answer = \"Password\" Then\n    MsgBox \"Correct, je krijgt nu de goede tabs te zien!\"\n    Worksheets(\"Team_1\").Visible = True\n    Worksheets(\"Team_1_sub\").Visible = True\n\n  Else\n   MsgBox \"Wrong password\"\n  End If\n\n End Sub\n</code></pre>\n\n<p>Two questions about the code above:</p>\n\n<ol>\n<li><p>When the users close the document all sheet should \"disappear\" again. Does anybody know how to do this? So when opening the document sheets \"Team_1\" and \"Team_1_sub\" should be be standard</p>\n\n<pre><code>Worksheets(\"Team_1\").Visible = False\nWorksheets(\"Team_1_sub\").Visible = False\n</code></pre></li>\n<li><p>Could you guys give me some feedback on whether the procedure I follow above (different if statements where users are prompted for a password and then get to see certain tabs) is the most efficient one to reach my goal? End goal is to make sure certain team leader can only see certain sheets. </p></li>\n</ol>\n"}, {"tags": ["vba", "foreach", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4873141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3bb99f7e50f487cdc861c3917f0989?s=128&d=identicon&r=PG&f=1", "display_name": "dtk142", "link": "https://stackoverflow.com/users/4873141/dtk142"}, "is_accepted": true, "score": 0, "last_activity_date": 1438762640, "creation_date": 1438762640, "answer_id": 31827011, "question_id": 31825816, "link": "https://stackoverflow.com/questions/31825816/vba-look-up-in-loop/31827011#31827011", "title": "vba - Look up in Loop", "body": "<p>Cause you put the variables j and I inside the mark \"\" , therefore VBA understand it is the text, and doesnt pass any value into these variables. As the result, your formula will be error.</p>\n\n<p>You can try this for your formula:</p>\n\n<pre><code>\"=VLOOKUP(\" &amp; j.Address &amp; \",\" &amp; Worksheets(I).Name &amp; \"!B:C,2,0)\"\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5184875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48fde34bad52d2d64bfc88afbe2b9672?s=128&d=identicon&r=PG&f=1", "display_name": "ANNEH", "link": "https://stackoverflow.com/users/5184875/anneh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 31827011, "answer_count": 1, "score": 0, "last_activity_date": 1438762640, "creation_date": 1438759009, "question_id": 31825816, "link": "https://stackoverflow.com/questions/31825816/vba-look-up-in-loop", "title": "vba - Look up in Loop", "body": "<p>i try to do a vLookup for each cell, but it doesn't seem to work</p>\n\n<pre><code>Sub Extern()\n\n    Dim WS_Count As Integer\n    Dim I As Integer\n    Dim c As Integer\n    Dim j As Range\n    Dim e As Range\n\n    lRow = Worksheets(\"\u00dcbersicht\").Range(\"A65536\").End(xlUp).Row\n    WS_Count = ActiveWorkbook.Worksheets.Count\n    c = 41\n\n    For Each j In Worksheets(\"\u00dcbersicht\").Range(\"A41:A\" &amp; lRow)\n\n        Set Rng = Worksheets(\"\u00dcbersicht\").Range(\"B\" &amp; c)\n\n        For I = 3 To WS_Count\n            If Worksheets(I).Name Like \"*uslastu*\" Then\n\n                Rng.Formula = \"=VLOOKUP(j,Worksheets(I)!B:C,2)\"\n\n            End If\n        Next I\n\n        c = c + 1\n    Next j\nEnd Sub\n</code></pre>\n\n<p>Please help, if you notice any errors.When I try to debug it, it says the Lookup formular, is the problem.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1438764039, "post_id": 31826331, "comment_id": 51578022, "body": "Hi there sorry but i dont  quite get the part one (lrow,2) what is the 2 actually? and also the the (rows.count,) @Iturner"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1438764926, "post_id": 31826331, "comment_id": 51578619, "body": "I added an explanation to the bottom of the answer. I hope this makes sense. @Niva"}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 1, "last_activity_date": 1438764872, "last_edit_date": 1438764872, "creation_date": 1438760605, "answer_id": 31826331, "question_id": 31825665, "link": "https://stackoverflow.com/questions/31825665/updating-cell-value-according-to-values-from-other-column/31826331#31826331", "title": "Updating cell value according to values from other column", "body": "<p>You could use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\"><code>.Find()</code> Method</a>, and then use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840060.aspx\" rel=\"nofollow\"><code>.Offset</code> Property</a> to enter a value into the cell 1 column to the right.</p>\n\n<pre><code>Option Explicit\nSub findValue()\n    Dim rngCol As Range, rngFound As Range\n    Set rngCol = Columns(\"A:A\")\n\n    Set rngFound = rngCol.Find(What:=\"F\", LookIn:=xlValues)\n    If Not rngFound Is Nothing Then\n        rngFound.Offset(0, 1).Value = \"B\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>This only finds the first string which matches the defined value, within the given range. If there are multiple matches within the range, you would need to incorporate this into a loop.</p>\n\n<p><strong>EDIT:</strong> Having read your question again, it sounds like there will be multiple values within the column. In this scenario it would probably be easier to enter your range into an array and then search the array for any matching values.</p>\n\n<p>You can either input the value into the cell whilst looping through.</p>\n\n<pre><code>Sub arrayFindValue2()\n    Dim rngValues() As Variant\n    Dim lrow As Long, i As Long\n\n    lrow = Cells(Rows.Count, 1).End(xlUp).Row\n    rngValues = Range(Cells(1, 1), Cells(lrow, 2))\n    For i = 1 To UBound(rngValues, 1)\n        If rngValues(i, 1) = \"F\" Then\n            Cells(i, 2).Value = \"B\"\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>On 60,480 rows of data, with 6048 matches, the above took 0.84 seconds to run. Even when turning off screen updating this only reduced to 0.80 seconds.</p>\n</blockquote>\n\n<p>Or you can assign the value to the array and then populate the worksheet with the contents of the array at the end.</p>\n\n<pre><code>Sub arrayFindValue()\n    Dim rngValues() As Variant\n    Dim lrow As Long, i As Long\n\n    lrow = Cells(Rows.Count, 1).End(xlUp).Row\n    rngValues = Range(Cells(1, 1), Cells(lrow, 2))\n    For i = 1 To UBound(rngValues, 1)\n        If rngValues(i, 1) = \"F\" Then\n            rngValues(i, 2) = \"B\"\n        End If\n    Next i\n    Range(\"A1\").Resize(UBound(rngValues, 1), 2).Value = rngValues\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Following the same test criteria, the above took 0.13 seconds to run.</p>\n</blockquote>\n\n<p><strong>EDIT: EXPLANATION</strong></p>\n\n<p><code>lrow = Cells(Rows.Count, 1).End(xlUp).Row</code> This will find the last row in column A. <code>Rows.Count</code> finds out how many rows are on the worksheet, and the <code>1</code> represents column A. <code>.End(xlUp)</code> goes up in column A, from the bottom row which was found. By performing this we know the last row with data in, within column A.</p>\n\n<p><code>Range(Cells(1, 1), Cells(lrow, 2))</code> We then use the last known row to create the array with values. <code>Cells(1,1)</code> represents <code>Range(\"A1\")</code> and then <code>Cells(lrow,2)</code> will represent the last row which had data in, within column A, but assigning column B also to the array (so that we can populate the array with values to assign to column B). It effectively equates to <code>Range(\"A1:B60480\")</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 5126595, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5f49e9ce781768595ffe9f455c6daf69?s=128&d=identicon&r=PG&f=1", "display_name": "Looker", "link": "https://stackoverflow.com/users/5126595/looker"}, "is_accepted": false, "score": 0, "last_activity_date": 1438855099, "last_edit_date": 1438855099, "creation_date": 1438761044, "answer_id": 31826486, "question_id": 31825665, "link": "https://stackoverflow.com/questions/31825665/updating-cell-value-according-to-values-from-other-column/31826486#31826486", "title": "Updating cell value according to values from other column", "body": "<p>Try this?</p>\n\n<pre><code>Dim lastrow as Long    \nlastrow = Cells(Rows.Count, 2).End(xlUp).Row\n\nFor i = 1 to lastrow\n  If Cells(i, 2).Value = \"F\" Then\n      Cells(i, 3).Value = \"B\"\n  End If\nNext i\n</code></pre>\n\n<p>So from the first row of the sheet to last row of sheet containing data, if a cell in column B contains \"F\", column C will show \"B\" (since those are the columns that the cells from your friend's code are currently showing).</p>\n\n<p>Although if it's specifically from column A to column B, you can just change the If to:</p>\n\n<pre><code>  If Cells(i, 1).Value = \"F\" Then\n      Cells(i, 2).Value = \"B\"\n  End If\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT</strong>: Although the above answer has been accepted, I came back and realized where the type mismatch error came from. I forgot to check that the column number on the line <code>lastrow = Cells(Rows.Count, 2).End(xlUp).Row</code> matched with the column that was being searched through.</p>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1413, "favorite_count": 0, "accepted_answer_id": 31826331, "answer_count": 2, "score": 1, "last_activity_date": 1438855099, "creation_date": 1438758498, "question_id": 31825665, "link": "https://stackoverflow.com/questions/31825665/updating-cell-value-according-to-values-from-other-column", "title": "Updating cell value according to values from other column", "body": "<p>friend of mine needs help with this code</p>\n\n<pre><code>    Sub autoUpdate()\n    Dim R As String\n    Dim A As String\n    Dim G As String\n\n    Dim myrange As Range\n    Dim givenrng As Range\n\n    Set myrange = Sheets(\"Sheet1\").Cells(2, 2)\n    Set givenrng = Sheets(\"Sheet1\").Cells(2, 3)\n\n\n\n\n    'If Worksheets(\"Project Details\").Range(\"L\") = R And Worksheets(\"Project Detials\").Range(\"M\") = R Then\n    'Worksheets(\"Project Details\").Range(\"K\") = R\n\n    If myrange.Value = \"F\" Then\n    givenrng.Value = \"B\"\nEnd sub\n</code></pre>\n\n<p>Instead of having myrange as a particular cell isit possible to change it to a column range? Means  for example if any of the cells in  column A is F then the corresponding row in column B will input value as  B. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1438758397, "post_id": 31824595, "comment_id": 51574599, "body": "You should say by posting any sample picture and code what you tried. Visit <a href=\"http://stackoverflow.com/tour\">tour</a> page for more information."}], "answers": [{"tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1438770627, "last_edit_date": 1495541030, "creation_date": 1438770627, "answer_id": 31829934, "question_id": 31824595, "link": "https://stackoverflow.com/questions/31824595/data-copy-to-2-different-sheets-depending-on-cell-value/31829934#31829934", "title": "Data copy to 2 different sheets depending on cell value", "body": "<p>Your question is not conveying total situation of your problem as mentioned by @Nicolas. However to help you with your problem go to the code posted by @fbonetti in the following thread to remove duplicates.</p>\n\n<p>[delete-all-duplicate-rows-excel-vba:]<a href=\"https://stackoverflow.com/questions/16988816/\">Delete all duplicate rows Excel vba</a> </p>\n\n<p>Further to transfer Copy Data to Another Excel WorkBook Based on Criteria Using VBA to do is the following:\n1.  Identify data in a workbook sheet based on a text criterium and a date criterium or condition using a looping process\n2.  Select the specific data which meets the two or multiple conditions\n3.  Copy the identified data\n4.  Open another workbook\n5.  Find the first blank row in a specific worksheet in the workbook\n6.  Paste the data in the identified blank or empty row \u2013 erow\n7.  Save the workbook\n8.  Close the workbook\nGo through the link mentioned below.\n  <a href=\"http://www.exceltrainingvideos.com/copy-data-to-another-excel-workbook-based-on-criteria-using-vba/\" rel=\"nofollow noreferrer\">http://www.exceltrainingvideos.com/copy-data-to-another-excel-workbook-based-on-criteria-using-vba/</a></p>\n\n<p>HTH</p>\n"}], "owner": {"reputation": 9, "user_id": 5192444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1049f80088c07991bf16251b3249712a?s=128&d=identicon&r=PG&f=1", "display_name": "caseyc", "link": "https://stackoverflow.com/users/5192444/caseyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446899826, "creation_date": 1438754938, "last_edit_date": 1531164843, "question_id": 31824595, "link": "https://stackoverflow.com/questions/31824595/data-copy-to-2-different-sheets-depending-on-cell-value", "title": "Data copy to 2 different sheets depending on cell value", "body": "<p>I have 2 main sheets ( \"kids\" and \"parents\") and another 3 sheets that I use for data input. What I want the code to do is to copy the values of the 3 sheets from column A TO L and transfer them to the main sheets depending on the value chosen in column D. So if I insert data to one of the 3 sheets and I have as a value in column D \"kids\" it should transfer it to SHEET \"KIDS\" if I choose value \"parents\" the data should go to sheet \"parents\". In any case, I do want it to remove duplicates and not copy the same data each time I open the file. </p>\n\n<pre><code>Private Sub Workbook_Open()\n Dim i As Long, lastRow As Long, ws As Worksheet\nSheets(\"Kids\").Range(\"A3:L500\").ClearContents\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; (\"Kids\") Then\n        ws.Activate\n        lastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n            For i = 2 To lastRow\n                If ws.Cells(i, \"D\").Value = \"Kids\" Then\n                    Rows(i).Copy Destination:=Sheets(\"Kids\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n                    ElseIf ws.Cells(i, \"D\").Value = \"Parents\" Then\n                    Rows(i).Copy Destination:=Sheets(\"Parents\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n\n\n                End If\n            Next i\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>So this is the code I have used but it doesn't remove duplicates for main sheet \"parents\". Something is wrong...</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1438755410, "post_id": 31824530, "comment_id": 51573071, "body": "In this moment, there is no UDF, just multiple formulas. I will be happy if i can solve this without VBA."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1438755574, "post_id": 31824530, "comment_id": 51573154, "body": "you could try to make a matrix-formular out of it. press <code>ctrl-shift-enter</code> instead of <code>enter</code> when you entered the formula"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 1, "creation_date": 1438755839, "post_id": 31824530, "comment_id": 51573271, "body": "i dont see point in using <code>ctrl-shift-enter</code>. Formulas are working, till i try to resave sheet. So if i rewrite all formulas with <code>ctrl-shift-enter</code> you think it will help? It souns like some dark magic to me :/"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1438756404, "post_id": 31824530, "comment_id": 51573563, "body": "because you defined a matrix within your formula. check out this explanation from MS <a href=\"https://support.office.com/en-in/article/Guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7#__learn_about_array\" rel=\"nofollow noreferrer\">Array formulars</a> In case you could also provide us sampledata so we&#39;re able to try it on our own =)"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1438758487, "post_id": 31824530, "comment_id": 51574645, "body": "I figured out that <code>spline</code> function is defined in module and inserted code into main question. unfortunately <code>ctrl-shift-enter</code> not worked for me"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5463108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21b5eea8fdd46ef5da1df4f9fcc0ebfc?s=128&d=identicon&r=PG&f=1", "display_name": "Niels", "link": "https://stackoverflow.com/users/5463108/niels"}, "is_accepted": false, "score": 0, "last_activity_date": 1445267495, "creation_date": 1445267495, "answer_id": 33217962, "question_id": 31824530, "link": "https://stackoverflow.com/questions/31824530/formula-error-after-file-save-from-network-to-local/33217962#33217962", "title": "Formula error after file save from network to local", "body": "<p>Try to add:</p>\n\n<p>Application.Volatile</p>\n\n<p>to your VBA code. Add this just below the Function statement to force a renewed calculation as soon as anything changes.</p>\n"}], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1445267943, "creation_date": 1438754652, "last_edit_date": 1445267943, "question_id": 31824530, "link": "https://stackoverflow.com/questions/31824530/formula-error-after-file-save-from-network-to-local", "title": "Formula error after file save from network to local", "body": "<p>I have issue with an Excel worksheet that contains the formula:</p>\n\n<pre><code>=Spline($D$9:$D$34,$J$9:$J$34,$D43)\n</code></pre>\n\n<p>Sheet works fine until I open this sheet on network drive and save it on local drive. Then this formula throws #NAME? error. Strange is, that error is gone when I click on line with formula to edit it and press enter (nothing changes in formula).</p>\n\n<p>Have someone met similar issue?</p>\n\n<p>I just found another information. Formula <code>spline</code> is defined in VBA module, not internal in Excel. It looks like. But issue is still here.</p>\n\n<pre><code>Function spline(periodcol As Range, ratecol As Range, x As Range)\nDim period_count As Integer\nDim rate_count As Integer\nperiod_count = periodcol.Rows.Count\nrate_count = ratecol.Rows.Count\nIf period_count &lt;&gt; rate_count Then\n    spline = \"Error: Range count does not match\"\n    GoTo endnow\nEnd If\n\n\nReDim xin(period_count) As Single\nReDim yin(period_count) As Single\nDim c As Integer\nFor c = 1 To period_count\nxin(c) = periodcol(c)\nyin(c) = ratecol(c)\nNext c\nDim n As Integer\nDim i, k As Integer\nDim p, qn, sig, un As Single\nReDim u(period_count - 1) As Single\nReDim yt(period_count) As Single\nn = period_count\nyt(1) = 0\nu(1) = 0\nFor i = 2 To n - 1\n    sig = (xin(i) - xin(i - 1)) / (xin(i + 1) - xin(i - 1))\n    p = sig * yt(i - 1) + 2\n    yt(i) = (sig - 1) / p\n    u(i) = (yin(i + 1) - yin(i)) / (xin(i + 1) - xin(i)) - (yin(i) - yin(i - 1)) / (xin(i) - xin(i - 1))\n    u(i) = (6 * u(i) / (xin(i + 1) - xin(i - 1)) - sig * u(i - 1)) / p\n\n    Next i\n\nqn = 0\nun = 0\nyt(n) = (un - qn * u(n - 1)) / (qn * yt(n - 1) + 1)\nFor k = n - 1 To 1 Step -1\n    yt(k) = yt(k) * yt(k + 1) + u(k)\nNext k\nDim klo, khi As Integer\nDim h, b, a As Single\nklo = 1\nkhi = n\nDo\nk = khi - klo\nIf xin(k) &gt; x Then\nkhi = k\nElse\nklo = k\nEnd If\nk = khi - klo\nLoop While k &gt; 1\nh = xin(khi) - xin(klo)\na = (xin(khi) - x) / h\nb = (x - xin(klo)) / h\ny = a * yin(klo) + b * yin(khi) + ((a ^ 3 - a) * yt(klo) + (b ^ 3 - b) * yt(khi)) * (h ^ 2) / 6\n\nspline = y\nendnow:\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5022805, "user_type": "registered", "profile_image": "https://graph.facebook.com/1436188216703277/picture?type=large", "display_name": "Kenneth Li", "link": "https://stackoverflow.com/users/5022805/kenneth-li"}, "edited": false, "score": 0, "creation_date": 1438758260, "post_id": 31824718, "comment_id": 51574533, "body": "What do u mean fully qualified? As far as i know im only providing C:\\Users\\SiliconPlus\\Desktop\\Si+ Contact Lists\\Contact_Si+ as the file path."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 89, "user_id": 5022805, "user_type": "registered", "profile_image": "https://graph.facebook.com/1436188216703277/picture?type=large", "display_name": "Kenneth Li", "link": "https://stackoverflow.com/users/5022805/kenneth-li"}, "edited": false, "score": 0, "creation_date": 1438758321, "post_id": 31824718, "comment_id": 51574560, "body": "Is that the value of the thisFile variable? The error message only contains the file name with no path component."}, {"owner": {"reputation": 89, "user_id": 5022805, "user_type": "registered", "profile_image": "https://graph.facebook.com/1436188216703277/picture?type=large", "display_name": "Kenneth Li", "link": "https://stackoverflow.com/users/5022805/kenneth-li"}, "edited": false, "score": 0, "creation_date": 1438759990, "post_id": 31824718, "comment_id": 51575548, "body": "lol i still don&#39;t get what you are trying to say. Can u elaborate with examples please. thanks!"}, {"owner": {"reputation": 89, "user_id": 5022805, "user_type": "registered", "profile_image": "https://graph.facebook.com/1436188216703277/picture?type=large", "display_name": "Kenneth Li", "link": "https://stackoverflow.com/users/5022805/kenneth-li"}, "edited": false, "score": 0, "creation_date": 1438760714, "post_id": 31824718, "comment_id": 51575949, "body": "yes that is the value of the thisFile variable since i specified the file path."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 89, "user_id": 5022805, "user_type": "registered", "profile_image": "https://graph.facebook.com/1436188216703277/picture?type=large", "display_name": "Kenneth Li", "link": "https://stackoverflow.com/users/5022805/kenneth-li"}, "edited": false, "score": 0, "creation_date": 1438786887, "post_id": 31824718, "comment_id": 51594051, "body": "Again, is that what you see in the debugger? AFAIK Dir() only returns the file name with no path component. You must use inPath :       Set Msg = objOL.OpenSharedItem(inPath &amp; &quot;\\&quot;  &amp; thisFile)"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1535515854, "last_edit_date": 1535515854, "creation_date": 1438755369, "answer_id": 31824718, "question_id": 31824393, "link": "https://stackoverflow.com/questions/31824393/opening-an-outlook-msg-file-with-excel-vba/31824718#31824718", "title": "Opening an Outlook .msg file with Excel VBA", "body": "<p><code>OpenSharedItem</code> method is exposed by the <code>Namespace</code> object, not <code>Application</code>.</p>\n\n<pre><code>Set objOL = CreateObject(\"Outlook.Application\")\nset objNs = objOL.GetNamespace(\"MAPI\")\nobjNs.Logon\n...\nSet Msg = objNs .OpenSharedItem(thisFile)\n</code></pre>\n\n<p>As for the second error, it is pretty unambiguous - the file cannot be found. You must provider a fully qualified file name with the folder path. You are only providing the file name.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7291429, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_DFTnGUbBjc/AAAAAAAAAAI/AAAAAAAAA0M/6-RP_4ewsjQ/photo.jpg?sz=128", "display_name": "Robert Trent", "link": "https://stackoverflow.com/users/7291429/robert-trent"}, "is_accepted": false, "score": 0, "last_activity_date": 1494436107, "last_edit_date": 1494436107, "creation_date": 1483986297, "answer_id": 41554467, "question_id": 31824393, "link": "https://stackoverflow.com/questions/31824393/opening-an-outlook-msg-file-with-excel-vba/41554467#41554467", "title": "Opening an Outlook .msg file with Excel VBA", "body": "<p>I'm not 100% on what you're trying to get at with the code, but try this:</p>\n\n<pre><code>Sub LiminalMsgbx()\n\n    Dim outappp, outmaill As Object\n    Dim pthh As String\n    pthh = \"C:\\DeskTop\\MyTemplate.oft\"\n\n  Set outappp = CreateObject (\"Outlook.Application\")\n  Set outmaill = outapp.CreateItemFromTemplate(pthh)   \n\n                With outmaill\n                    .display\n\n                    End With\nSet outappp = Nothing\nSet outmaill = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>You can also use <code>.send</code> instead of <code>.display</code>.</p>\n"}], "owner": {"reputation": 89, "user_id": 5022805, "user_type": "registered", "profile_image": "https://graph.facebook.com/1436188216703277/picture?type=large", "display_name": "Kenneth Li", "link": "https://stackoverflow.com/users/5022805/kenneth-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3079, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1535515854, "creation_date": 1438754022, "last_edit_date": 1535512880, "question_id": 31824393, "link": "https://stackoverflow.com/questions/31824393/opening-an-outlook-msg-file-with-excel-vba", "title": "Opening an Outlook .msg file with Excel VBA", "body": "<p>I have the following code </p>\n\n<pre><code>Sub Kenneth_Li()\n    Dim objOL As Outlook.Application\n    Dim Msg As Outlook.MailItem\n\n    Set objOL = CreateObject(\"Outlook.Application\")\n    inPath = \"C:\\Users\\SiliconPlus\\Desktop\\Si+ Contact Lists\\Contact_Si+\"\n\n    thisFile = Dir(inPath &amp; \"\\*.msg\")\n    Do While thisFile &lt;&gt; \"\"\n\n        'Set Msg = objOL.CreateItemFromTemplate(thisFile)\n        'Or\n        Set Msg = objOL.OpenSharedItem(thisFile)\n\n        Msg.display\n\n        MsgBox Msg.Subject\n        thisFile = Dir\n    Loop\n\n\n    Set objOL = Nothing\n    Set Msg = Nothing\nEnd Sub\n</code></pre>\n\n<p>When I use <code>OpenSharedItem</code> it gives a run-time error 438 Object doesn't support this property or method. </p>\n\n<p>When I use <code>CreateItemFromTemplate</code> I get the following error: </p>\n\n<blockquote>\n  <p>Cannot open file: AUTO Andy Low Yong Cheng is out of the office (returning 22 09 2014).msg.<br>\n  The file may not exist, you may not have permission to open it, or it may be open in another program.<br>\n  Right-click the folder that contains the file, and then click properties to check your permissions for the folder.</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1438751572, "post_id": 31823845, "comment_id": 51571717, "body": "<code>1</code> First open the 2nd workbook. <code>2</code> In the first workbook, manually type the Vlookup formula. <code>3</code> Close the 2nd workbook <code>4</code> Now the Vlookup formula will show paths. Copy that formula as it is <code>5</code> strFormula = that formula which you copied"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1438751630, "post_id": 31823845, "comment_id": 51571732, "body": "<code>currentWs.Range(&quot;B2&quot;)</code> inside quotes doesn&#39;t make any sense :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1438752224, "post_id": 31823845, "comment_id": 51571926, "body": "Something like this I guess (Don&#39;t have MAC to test it) <code>strFormula = &quot;=VLOOKUP(B2,&#39;Macintosh HD:Users:myself:Documents:l[Master_Terms_Users.xlsm]Master_T&zwnj;&#8203;erms_Users.csv&#39;!A1:B&zwnj;&#8203;222,2,false)&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 2, "last_activity_date": 1438752651, "last_edit_date": 1495542117, "creation_date": 1438752651, "answer_id": 31824102, "question_id": 31823845, "link": "https://stackoverflow.com/questions/31823845/how-to-access-a-closed-excel-workbook-using-vlookup-vba/31824102#31824102", "title": "How to access a closed Excel Workbook using vlookup vba", "body": "<p>Reference from <a href=\"https://stackoverflow.com/users/1140579/siddharth-rout\">Siddharth Rout's</a> comments.</p>\n\n<p>The main problem in your code is this line:</p>\n\n<pre><code>strFormula = \"=VLOOKUP(currentWs.Range(\"B2\"),'Macintosh HD:Users:myself:Documents:l[Master_Terms_Users.xlsm]Master_Terms_Users.csv'!A1:B222,2,false)\"\n</code></pre>\n\n<p>because of this code <code>currentWs.Range(\"B2\")</code>. We know that you want to indicate <strong>Range(\"B2\") of Current Sheet(same sheet)</strong>. So, you can use as follow:</p>\n\n<pre><code>strFormula = \"=VLOOKUP(B2,'Macintosh HD:Users:myself:Documents:l[Master_Terms_Users.xlsm]Master_Terms_Users.csv'!A1:B\u200c\u200b222,2,false)\"\n</code></pre>\n\n<p>Why? It can use just <code>B2</code> because you set formula to a cell which is in the same sheet. So, it is not need to indicate the <strong>Sheet Name</strong>.</p>\n\n<p>And If you want to set a cell which is from other sheet, you need to indicate <strong>Sheet Name</strong> in that case. So, should use as follow:</p>\n\n<pre><code>strFormula = \"=VLOOKUP(\" &amp; currentWs.name &amp; \"!B2,'Macintosh HD:Users:myself:Documents:l[Master_Terms_Users.xlsm]Master_Terms_Users.csv'!A1:B222,2,false)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 1098815, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/AnoUy.jpg?s=128&g=1", "display_name": "M_66", "link": "https://stackoverflow.com/users/1098815/m-66"}, "is_accepted": true, "score": 0, "last_activity_date": 1438904317, "last_edit_date": 1438904317, "creation_date": 1438902360, "answer_id": 31867209, "question_id": 31823845, "link": "https://stackoverflow.com/questions/31823845/how-to-access-a-closed-excel-workbook-using-vlookup-vba/31867209#31867209", "title": "How to access a closed Excel Workbook using vlookup vba", "body": "<p>This looks nothing like what I had previously, but it works.</p>\n\n<pre><code>Sub Check_Master_Values()\n\n    Dim newCurWb As Workbook\n    Set newCurWb = Workbooks(2)\n    newCurWb.Activate\n\n    newCurWb.Sheets(1).Range(\"C2\").Formula = \"=VLOOKUP(B2,'Macintosh HD:Users:myself:Documents:[Master_Terms_Users.xlsm]Master_Terms_Users.csv'!$A$1:$B$269,2,FALSE)\"\n\nEnd Sub\n</code></pre>\n\n<p>In my first attempt, I didn't follow the chain of assignments from workbook, to sheets, to ranges. As you can see in this code, I Dim a new Workbook - then the big ah-ha moment, I needed to assign it to the correct open workbook. Then, I activated the workbook, and finally accessed the Sheets object and Range.</p>\n\n<p>I also know now that my workbook selection number will vary depending on how many other workbooks are open. The ThisBook didn't work because somehow in the process, the workbook that ThisBook referenced, changed. That is probably also why my initial code didn't work, in addition to the improper coding in the VLOOKUP.</p>\n\n<p>It would be good if there was a way to specify which workbook on the fly.</p>\n\n<p>Thanks to everyone who gave help on the VLOOKUP part.</p>\n"}], "owner": {"reputation": 139, "user_id": 1098815, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/AnoUy.jpg?s=128&g=1", "display_name": "M_66", "link": "https://stackoverflow.com/users/1098815/m-66"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7215, "favorite_count": 0, "accepted_answer_id": 31867209, "answer_count": 2, "score": 1, "last_activity_date": 1438904317, "creation_date": 1438751198, "last_edit_date": 1438768092, "question_id": 31823845, "link": "https://stackoverflow.com/questions/31823845/how-to-access-a-closed-excel-workbook-using-vlookup-vba", "title": "How to access a closed Excel Workbook using vlookup vba", "body": "<p>I'm trying to create a Excel VBA macro that uses VLOOKUP to access a range of cells in a closed workbook. I'm not too good at using the VBA editor, but it doesn't seem to show a lot of useful information about errors.</p>\n\n<pre><code>Sub WorkBookWithData()\n    Dim currentWb As Workbook\n    Set currentWb = ThisWorkbook\n    Dim currentWs As Worksheet\n    Set currentWs = currentWb.Sheets(1)\n    Dim strFormula As String\n    strFormula = \"=VLOOKUP(currentWs.Range(\"B2\"),'Macintosh HD:Users:myself:Documents:l[Master_Terms_Users.xlsm]Master_Terms_Users.csv'!A1:B222,2,false)\"\n    currentWs.Range(\"C2\").Formula = strFormula\n\nEnd Sub\n</code></pre>\n\n<p>Excel VBA editor is hanging up on the \"strFormula = \"=VLOOKUP...\" section.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1438754951, "post_id": 31823266, "comment_id": 51572881, "body": "Hey thanks for getting back to me so fast! @CustodianOfCode. Please check my post again as I just updated it. thanks again."}, {"owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "reply_to_user": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1438818697, "post_id": 31823266, "comment_id": 51610713, "body": "No worries mate. Yeah, you can have one button linked to 6 different procedures. Have the button linked to a procedure which calls one of the 6 procedures, and keeps track of which one you&#39;re up to, for example by setting Range(&quot;whereamIupto&quot;).value=&quot;step 5&quot;"}, {"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1438835559, "post_id": 31823266, "comment_id": 51614773, "body": "I don&#39;t follow.. how do you link 6 different modules to 1 button? do I use activeX or Form ? @CustodianOfCode"}, {"owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "edited": false, "score": 0, "creation_date": 1439455922, "post_id": 31823266, "comment_id": 51872413, "body": "I finally understood what you are saying. thank you. @CustodianOfCode"}], "tags": [], "owner": {"reputation": 664, "user_id": 2977281, "user_type": "registered", "profile_image": "https://graph.facebook.com/561723379/picture?type=large", "display_name": "CustodianOfCode", "link": "https://stackoverflow.com/users/2977281/custodianofcode"}, "is_accepted": true, "score": 1, "last_activity_date": 1438747587, "creation_date": 1438747587, "answer_id": 31823266, "question_id": 31823039, "link": "https://stackoverflow.com/questions/31823039/pausing-a-module-until-user-clicks-submit-to-continue-running-the-module/31823266#31823266", "title": "Pausing a module, until user clicks submit to continue running the module", "body": "<p>Split the functionality into two seperate procedures like this, and have the submit button linked to FlowRateSubmit(). </p>\n\n<pre><code>Sub FlowRate()\n\n    Set chwflow_rate1 = Application.InputBox(\"Please select 1st cell with\n    Chilled Water Flowrate.\", Type:=8)\n    Range(chwflow_rate1, chwflow_rate1.Offset(20159)).Select\n    Selection.Copy\nEnd Sub\n\nSub FlowRateSubmit()\n\n  ' Program pause until user clicks submit button\n  ' user click submit, program continues\n    Workbooks(1).Activate\n    Sheets(\"Data\").Activate\n    Range(\"C8\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    ActiveCell.EntireColumn.Offset(0, 1).Insert\n    With ActiveSheet\n        For I = 7 To Cells(.Rows.Count, \"C\").End(xlUp).Row\n            aSplit = Split(Cells(I, \"C\"), \" \", 8)\n            Cells(I, \"C\") = aSplit(0)\n            Cells(I, \"D\") = aSplit(1)\n        Next I\n    End With\n    Range(\"D8\").Select\n    ActiveCell.EntireColumn.Delete \n End Sub\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 4944040, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-Igyx53TP2zo/AAAAAAAAAAI/AAAAAAAAABA/gSRqTDeNOjw/photo.jpg?sz=128", "display_name": "Nur Atiqah Hassan", "link": "https://stackoverflow.com/users/4944040/nur-atiqah-hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 31823266, "answer_count": 1, "score": 0, "last_activity_date": 1438754804, "creation_date": 1438745793, "last_edit_date": 1531164843, "question_id": 31823039, "link": "https://stackoverflow.com/questions/31823039/pausing-a-module-until-user-clicks-submit-to-continue-running-the-module", "title": "Pausing a module, until user clicks submit to continue running the module", "body": "<p>I'm creating a user interface whereby the user clicks the \"click to select\" button on the worksheet and it call and run Module 1 to a certain point, stores the information, pause the module. Module 1 should only continue running after user clicks the submit button on the worksheet. </p>\n\n<hr>\n\n<p><strong>UPDATE!!</strong></p>\n\n<p>its not only 1 Module. its actually 6 modules. In which,  the submit button has to continue, where it paused/stopped. its there anyway that I could link the submit button to 6 different modules?</p>\n\n<p><a href=\"https://i.stack.imgur.com/QfMjE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QfMjE.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub FlowRate()\n\n    Set chwflow_rate1 = Application.InputBox(\"Please select 1st cell with\n    Chilled Water Flowrate.\", Type:=8)\n    Range(chwflow_rate1, chwflow_rate1.Offset(20159)).Select\n    Selection.Copy\n\n  ' Program pause until user clicks submit button\n  ' user click submit, program continues\n    Workbooks(1).Activate\n    Sheets(\"Data\").Activate\n    Range(\"C8\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    ActiveCell.EntireColumn.Offset(0, 1).Insert\n    With ActiveSheet\n        For I = 7 To Cells(.Rows.Count, \"C\").End(xlUp).Row\n            aSplit = Split(Cells(I, \"C\"), \" \", 8)\n            Cells(I, \"C\") = aSplit(0)\n            Cells(I, \"D\") = aSplit(1)\n        Next I\n    End With\n    Range(\"D8\").Select\n    ActiveCell.EntireColumn.Delete \n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1438745316, "post_id": 31822797, "comment_id": 51570175, "body": "To improve code that works as intended, I suggest you take the 5-minute tour over at <a href=\"https://codereview.stackexchange.com\">Code Review</a>."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1438744944, "creation_date": 1438744944, "answer_id": 31822886, "question_id": 31822797, "link": "https://stackoverflow.com/questions/31822797/copy-paste-depending-on-cell-values-in-two-ranges/31822886#31822886", "title": "Copy-Paste Depending on Cell Values in Two Ranges", "body": "<p>Something like this perhaps? (Untested)</p>\n\n<pre><code>Sub Sample()\n    '\n    '~~&gt; Rest of your code\n    '\n    For Each ColourCell In CopyRange\n        If ColourCell.Value = \"Blue\" Then copyAndPaste ColourCell, \"Aqua\"\n        If ColourCell.Value = \"Red\" Then copyAndPaste ColourCell, \"Pink\"\n        If ColourCell.Value = \"Yellow\" Then copyAndPaste ColourCell, \"Orange\"\n    Next\n    '\n    '~~&gt; Rest of your code\n    '\nEnd Sub\n\nSub copyAndPaste(rng As Range, strSearch As String)\n    Dim PasteRange As Range\n    Dim aCell As Range\n\n    '~~&gt; Change this to the releavnt range\n    Set PasteRange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1:A10\")\n\n    '~~&gt; Try and find the Aqua, Pink, orange or whatever\n    Set aCell = PasteRange.Find(What:=strSearch, LookIn:=xlValues, _\n    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n\n    '~~&gt; If found\n    If Not aCell Is Nothing Then\n        rng.Offset(, 1).Copy\n        aCell.Offset(, 1).PasteSpecial xlPasteValues\n    End If\nEnd Sub\n</code></pre>\n\n<p>Whenever you are you using <code>.Find</code>, check if the cell was found else you will get an error.</p>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438745167, "post_id": 31822896, "comment_id": 51570134, "body": "Do not use <code>.Find</code> like that :)"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1438745354, "post_id": 31822896, "comment_id": 51570188, "body": "OK..I will modify. This is for Just suggestion."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1438745777, "post_id": 31822896, "comment_id": 51570293, "body": "&#39;+1 great :) Now one thing, the <code>.Find</code> will still run if the <code>ColourCell.value</code> doesn&#39;t match Aqua,Pink or Orange ;) and hence a separate sub would have been nice"}, {"owner": {"reputation": 230, "user_id": 4619325, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WugEP.png?s=128&g=1", "display_name": "MJV", "link": "https://stackoverflow.com/users/4619325/mjv"}, "edited": false, "score": 0, "creation_date": 1438746044, "post_id": 31822896, "comment_id": 51570355, "body": "Cheers, only problem is in my real-world application of this procedure, I&#39;m working with source ranges that contain many more cells than the ones I need to copy; I only want to copy the relevant ones."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1438746648, "post_id": 31822896, "comment_id": 51570491, "body": "Right Siddharth Rout, It need checking."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1438746935, "post_id": 31822896, "comment_id": 51570545, "body": "The main different between Siddharth and Me is using IF..ELSE and SELECT .. CASE. So, MJV you can use both answer."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1438747622, "post_id": 31822896, "comment_id": 51570693, "body": "No that is not the &quot;main&quot; difference :) the main difference is that I am copying and pasting only when it is required :)"}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 2, "last_activity_date": 1438746793, "last_edit_date": 1438746793, "creation_date": 1438744977, "answer_id": 31822896, "question_id": 31822797, "link": "https://stackoverflow.com/questions/31822797/copy-paste-depending-on-cell-values-in-two-ranges/31822896#31822896", "title": "Copy-Paste Depending on Cell Values in Two Ranges", "body": "<p>Here my suggestion:</p>\n\n<pre><code>Dim findWord As String\nDim aCell As Range\n\nFor Each ColourCell In CopyRange\n\n    Select Case ColourCell.value\n\n        Case \"Blue\"\n            findWord = \"Aqua\"\n\n        Case \"Red\"\n            findWord = \"Pink\"\n\n        Case \"Yellow\"\n            findWord = \"Orange\"\n\n        Case Else\n            findWord = \"\"\n\n    End Select\n\n    If findWord &lt;&gt; \"\" Then\n\n        Set aCell = PasteRange.Find(What:=findWord, LookIn:=xlValues, _\n                    LookAt:=xlWhole, SearchOrder:=xlByRows,SearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n\n        If Not aCell Is Nothing Then \n            ColourCell.Offset(, 1).Copy      \n            aCell.Offset(, 1).PasteSpecial xlPasteValues\n        End If\n\n    End If\n\nNext ColourCell\n</code></pre>\n"}], "owner": {"reputation": 230, "user_id": 4619325, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/WugEP.png?s=128&g=1", "display_name": "MJV", "link": "https://stackoverflow.com/users/4619325/mjv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 1, "accepted_answer_id": 31822886, "answer_count": 2, "score": 3, "last_activity_date": 1438746793, "creation_date": 1438744291, "question_id": 31822797, "link": "https://stackoverflow.com/questions/31822797/copy-paste-depending-on-cell-values-in-two-ranges", "title": "Copy-Paste Depending on Cell Values in Two Ranges", "body": "<p>I would like to write a procedure that copies and pastes data from one workbook to another, contingent on 'labels' in two ranges. </p>\n\n<p>Basically I would like to loop through one range, copy data next to each cell, then paste it elsewhere based on a corresponding cell value in the second range. I can do this with a bunch of IF statements, but if someone could suggest a more efficient option using variables or arrays, that would be much appreciated, as it obviously becomes tedious with large data sets. </p>\n\n<p>Thank you.</p>\n\n<pre><code>For Each ColourCell In CopyRange\n\n    If ColourCell.Value = \"Blue\" Then\n    ColourCell.Offset(, 1).Copy\n    PasteRange.Find(\"Aqua\").Offset(, 1).PasteSpecial xlPasteValues\n    Else\n    End If\n\n    If ColourCell.Value = \"Red\" Then\n    ColourCell.Offset(, 1).Copy\n    PasteRange.Find(\"Pink\").Offset(, 1).PasteSpecial xlPasteValues\n    Else\n    End If\n\n    If ColourCell.Value = \"Yellow\" Then\n    ColourCell.Offset(, 1).Copy\n    PasteRange.Find(\"Orange\").Offset(, 1).PasteSpecial xlPasteValues\n    Else\n    End If\n\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 1, "creation_date": 1438741430, "post_id": 31822345, "comment_id": 51569276, "body": "Do you have any code that you have recorded to do this? If so, please post it."}, {"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438741503, "post_id": 31822345, "comment_id": 51569295, "body": "By drop down menu, do you mean the Data Validation setting, drop down control object, ActiveX control?"}, {"owner": {"reputation": 131, "user_id": 5188430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0cf1a2a7bc69397fa1b486d0f92bf11?s=128&d=identicon&r=PG&f=1", "display_name": "jwoff", "link": "https://stackoverflow.com/users/5188430/jwoff"}, "reply_to_user": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438741663, "post_id": 31822345, "comment_id": 51569327, "body": "Data Validation. I&#39;ve tried recording but I get an error after the second time because of the overlapping sheet names."}, {"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438742265, "post_id": 31822345, "comment_id": 51569448, "body": "&quot;after a button is pressed&quot; What button do you mean? Do you want them to select a value from the drop down, and then remove the validation?"}, {"owner": {"reputation": 131, "user_id": 5188430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0cf1a2a7bc69397fa1b486d0f92bf11?s=128&d=identicon&r=PG&f=1", "display_name": "jwoff", "link": "https://stackoverflow.com/users/5188430/jwoff"}, "reply_to_user": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438742304, "post_id": 31822345, "comment_id": 51569453, "body": "Sorry for the misunderstanding. Its just a one of those form control buttons."}, {"owner": {"reputation": 131, "user_id": 5188430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0cf1a2a7bc69397fa1b486d0f92bf11?s=128&d=identicon&r=PG&f=1", "display_name": "jwoff", "link": "https://stackoverflow.com/users/5188430/jwoff"}, "reply_to_user": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438742396, "post_id": 31822345, "comment_id": 51569479, "body": "Once the button is clicked, I want excel to duplicate and ask the user to rename the file. Then when the new file is created I want the data validation drop down list on cell C4 to be deleted so the user can&#39;t mess with it after all is said and done."}, {"owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438743684, "post_id": 31822345, "comment_id": 51569767, "body": "Just to make sure I understand completely. The button starts the macro which prompts the user to give the new file a new name. It will delete the data validation in cell C4. It will then save a copy of the file with this new name that the user previously provided. Can you post the code you have recorded already?"}, {"owner": {"reputation": 131, "user_id": 5188430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0cf1a2a7bc69397fa1b486d0f92bf11?s=128&d=identicon&r=PG&f=1", "display_name": "jwoff", "link": "https://stackoverflow.com/users/5188430/jwoff"}, "reply_to_user": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438744496, "post_id": 31822345, "comment_id": 51569962, "body": "Yes, but the data validation will only be deleted in the new sheet."}, {"owner": {"reputation": 131, "user_id": 5188430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0cf1a2a7bc69397fa1b486d0f92bf11?s=128&d=identicon&r=PG&f=1", "display_name": "jwoff", "link": "https://stackoverflow.com/users/5188430/jwoff"}, "reply_to_user": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "edited": false, "score": 0, "creation_date": 1438744543, "post_id": 31822345, "comment_id": 51569977, "body": "With some tutorials I&#39;ve got the duplicating and renaming part, but I still can&#39;t get it to delete the data validation Heres what I have:  <code>Sub rename()     Dim sName As String     Dim wks As Worksheet     Worksheets(&quot;Summary&quot;).Copy after:=Sheets(Worksheets.Count)     Set wks = ActiveSheet     Do While sName &lt;&gt; wks.Name         sName = Application.InputBox _           (Prompt:=&quot;Enter new worksheet name&quot;)         On Error Resume Next         wks.Name = sName         On Error GoTo 0     Loop     Set wks = Nothing End Sub</code>"}], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": true, "score": 1, "last_activity_date": 1438746826, "creation_date": 1438746826, "answer_id": 31823179, "question_id": 31822345, "link": "https://stackoverflow.com/questions/31822345/excel-macro-to-duplicate-sheet-prompt-user-to-rename-it-and-get-rid-of-dropdow/31823179#31823179", "title": "Excel Macro to Duplicate Sheet, Prompt User to Rename it, and Get Rid of Dropdown Menu", "body": "<p>This will save the workbook in the same containing folder as the file containing this code. It will use the name provided by the user. If a file already exists with that name, then it will prompt if the user wants to overwrite the old file or not.</p>\n\n<pre><code>Sub rename()\n    Dim sName As String\n    sName = Application.InputBox _\n      (Prompt:=\"Enter new worksheet name\")\n    Range(\"C4\").Validation.Delete\n    On Error Resume Next\n    ActiveWorkbook.SaveAs ActiveWorkbook.Path &amp; \"\\\" &amp; sName &amp; \".xlsm\", ConflictResolution:=xlUserResolution\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5188430, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c0cf1a2a7bc69397fa1b486d0f92bf11?s=128&d=identicon&r=PG&f=1", "display_name": "jwoff", "link": "https://stackoverflow.com/users/5188430/jwoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 0, "accepted_answer_id": 31823179, "answer_count": 1, "score": -1, "last_activity_date": 1438747612, "creation_date": 1438741063, "last_edit_date": 1438747612, "question_id": 31822345, "link": "https://stackoverflow.com/questions/31822345/excel-macro-to-duplicate-sheet-prompt-user-to-rename-it-and-get-rid-of-dropdow", "title": "Excel Macro to Duplicate Sheet, Prompt User to Rename it, and Get Rid of Dropdown Menu", "body": "<p>As the title says, I am looking for a way to create a macro that can duplicate the sheet the user is on, prompt them to rename it, and in addition, get rid of the drop down menu in cell C4 after a button is pressed. How would I go about doing this? I am very new to VBA and macros and I've only done simple ones through the record macro function, so if you could go into detail or post the code that would be super helpful:)</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>Sub rename()\n    Dim sName As String\n    Dim wks As Worksheet\n    Worksheets(\"Summary\").Copy after:=Sheets(Worksheets.Count)\n    Set wks = ActiveSheet\n    Do While sName &lt;&gt; wks.Name\n        sName = Application.InputBox _\n          (Prompt:=\"Enter new worksheet name\")\n        On Error Resume Next\n        wks.Name = sName\n        On Error GoTo 0\n    Loop\n    Set wks = Nothing\nEnd Sub\n</code></pre>\n\n<p>Thank you for your time!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 72931, "user_id": 2538939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/876f7ddaf27a16c17a62b8a9705b45f1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Different", "link": "https://stackoverflow.com/users/2538939/code-different"}, "edited": false, "score": 0, "creation_date": 1438740083, "post_id": 31822206, "comment_id": 51568994, "body": "Show your effort! Hint: the <code>MID</code> and <code>FIND</code> functions can help."}], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": false, "score": 0, "last_activity_date": 1438741368, "creation_date": 1438741368, "answer_id": 31822379, "question_id": 31822206, "link": "https://stackoverflow.com/questions/31822206/parsing-data-for-multiple-cells-in-excel/31822379#31822379", "title": "parsing data for multiple cells in Excel", "body": "<p>Find and replace your static values of \"Employee Name\", \"Department\", \"Title\", etc. one at a time. They should be replaced with nothing. To make the data cleaner, you can also replace instances of \" : \" with just \":\". You can also replace \": \" with nothing to drop the first colon (which you won't need). Your example should now look like the following:</p>\n\n<p>xxxxxx xxxxxxxx:xxxxx:xxxxxxx:xxxx xxxx xxxx:xxxx xxxxx:8/10/2015:Seattle</p>\n\n<p>You can now perform a \"Text to Columns\" operation:</p>\n\n<ul>\n<li>Select the \"Data\" tab in the ribbon</li>\n<li>Select \"Text to Columns\"</li>\n<li>Change the radio button to \"Delimited\"</li>\n<li>Click \"Next\"</li>\n<li>In the \"Other\" field, input a colon \":\"</li>\n<li>Click \"Next\"</li>\n<li>Select your \"MDY\" date field</li>\n<li>Select \"Date\" as the \"Column Data Format\"</li>\n<li>Click \"Finish\"</li>\n</ul>\n\n<p>The colon in the middle of Department causes a problem. If you need department to be in a single field, then you can insert a new column D. You can concatenate columns B and C with the following:</p>\n\n<p><code>=B1 &amp; C1</code></p>\n\n<ul>\n<li>Put that formula into cell D1</li>\n<li>Double-click on the fill handle</li>\n<li>Right-click on Column D</li>\n<li>Select Copy</li>\n<li>Right-Click on D1</li>\n<li>Select Paste Special</li>\n<li>Choose Values</li>\n<li>Click OK</li>\n<li>Delete Columns B and C</li>\n</ul>\n\n<p>If you need this as a VBA function that you can quickly repeat, then just record it.</p>\n"}], "owner": {"reputation": 1, "user_id": 5191908, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WPaDxDNnOoI/AAAAAAAAAAI/AAAAAAAAADA/DPnS_zrTHgs/photo.jpg?sz=128", "display_name": "Matt Wiese", "link": "https://stackoverflow.com/users/5191908/matt-wiese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": -7, "last_activity_date": 1438743265, "creation_date": 1438739911, "last_edit_date": 1531161705, "question_id": 31822206, "link": "https://stackoverflow.com/questions/31822206/parsing-data-for-multiple-cells-in-excel", "title": "parsing data for multiple cells in Excel", "body": "<p>if the following example in a cell:</p>\n\n<p>Employee Name: <strong>xxxxxx xxxxxxxx</strong>\nDepartment: <strong>xxxxx:xxxxxxx</strong>\nTitle: <strong>xxxx xxxx xxxx</strong>\nManager: <strong>xxxx xxxxx</strong>\nStart Date: <strong>8/10/2015</strong>\nLocation: <strong>Seattle</strong></p>\n\n<p>can anyone help me parse these values(bold) out into multiple cells? Thanks for looking!</p>\n\n<p>PS I know nothing about VBA. Is that my best bet? I understand boolean as I have a little background in Python.</p>\n"}, {"tags": ["vba", "integer", "decimal", "rounding", "long-integer"], "comments": [{"owner": {"reputation": 92827, "user_id": 369, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DHcF2.png?s=128&g=1", "display_name": "Blorgbeard", "link": "https://stackoverflow.com/users/369/blorgbeard"}, "edited": false, "score": 0, "creation_date": 1438738419, "post_id": 31821988, "comment_id": 51568622, "body": "What programming language? Looks like VBA?"}], "answers": [{"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1438738919, "post_id": 31822064, "comment_id": 51568750, "body": "Beat me to it by 1 min, it&#39;s amazing how often this one comes up."}], "tags": [], "owner": {"reputation": 72931, "user_id": 2538939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/876f7ddaf27a16c17a62b8a9705b45f1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Different", "link": "https://stackoverflow.com/users/2538939/code-different"}, "is_accepted": false, "score": 3, "last_activity_date": 1438738767, "creation_date": 1438738767, "answer_id": 31822064, "question_id": 31821988, "link": "https://stackoverflow.com/questions/31821988/converting-and-rounding-large-decimal-values/31822064#31822064", "title": "Converting and rounding Large decimal values", "body": "<p>Welcome to one of the syntactic quirks of VB. This line:</p>\n\n<pre><code>Dim sales, comm, conj As Long\n</code></pre>\n\n<p>Means only <code>conj</code> is <code>Long</code>. The first two are of type <code>Variant</code>. You can try this:</p>\n\n<pre><code>Dim sales as Long, comm as Long, conj as Long\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5191853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5bafb12b2d44e2c21486acc9926e7ef?s=128&d=identicon&r=PG&f=1", "display_name": "priya ", "link": "https://stackoverflow.com/users/5191853/priya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438738767, "creation_date": 1438738211, "last_edit_date": 1438738474, "question_id": 31821988, "link": "https://stackoverflow.com/questions/31821988/converting-and-rounding-large-decimal-values", "title": "Converting and rounding Large decimal values", "body": "<p>I have a form where user inputs the Sales Price and vba calculates the commission based on a fixed percentage and then calculates advertisement fees (again a percentage). The advertisement fees is deducted from the commission to arrive at the net commission. I have written the following code:</p>\n\n<pre><code>Dim sales, comm, conj As Long\n\ncomm = 0\n\nconj = 0\n\nsales = 0\n\nsales = [Forms]![Frmaddnewsales]![txtsales]\n\ncomm = sales * .019 \n\nconj = comm * .09 \n\nExit Sub\n</code></pre>\n\n<p>As an example, I enter sales price as $650000028, it calculates commission=12350000.532 and then conj=1111500.\nI need both the comm and conj variable to store only rounded values(without decimals). My question is since my variables are declared as Long why is it storing decimals. Why is comm showing in decimal whereas and conj variable is only showing the rounded figure.</p>\n"}]