[{"tags": ["arrays", "vba", "excel", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1491436533, "post_id": 43243219, "comment_id": 73556934, "body": "I&#39;ll have a solution shortly after I retype all of your sample data."}, {"owner": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491439231, "post_id": 43243219, "comment_id": 73557649, "body": "Thank you so much!"}, {"owner": {"reputation": 510, "user_id": 7425879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9c7fcc95cfeab92cb4b524efe837b0?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysData", "link": "https://stackoverflow.com/users/7425879/alwaysdata"}, "edited": false, "score": 1, "creation_date": 1491448413, "post_id": 43243219, "comment_id": 73559893, "body": "where does Mikes Auto Shop number 7 go? It is in your first image but not in list 1 or 2 of the second image"}, {"owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1491451171, "post_id": 43243219, "comment_id": 73560576, "body": "@PrincessPeach2091 Don&#39;t hold your breath, I&#39;m guessing Jeeped was being sarcastic as you took an image rather then providing a CSV or something."}, {"owner": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "reply_to_user": {"reputation": 510, "user_id": 7425879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9c7fcc95cfeab92cb4b524efe837b0?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysData", "link": "https://stackoverflow.com/users/7425879/alwaysdata"}, "edited": false, "score": 0, "creation_date": 1491454428, "post_id": 43243219, "comment_id": 73561486, "body": "@don_freem It would go on List 3"}], "answers": [{"tags": [], "owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "is_accepted": false, "score": 0, "last_activity_date": 1491451262, "creation_date": 1491451262, "answer_id": 43245474, "question_id": 43243219, "link": "https://stackoverflow.com/questions/43243219/looping-through-an-array-while-grabbing-certain-elements/43245474#43245474", "title": "Looping through an array while grabbing certain elements", "body": "<p>When you record your macro, ensure that \"Use Relative References\" on the Developer Ribbon tab is enabled, :)</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kd417.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kd417.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491454545, "post_id": 43245479, "comment_id": 73561530, "body": "Actually my real dataset is hundreds of companies long so I would want dozens of different lists (still grabbing 3 from every company though!) I am going to try this code. Thank you"}, {"owner": {"reputation": 510, "user_id": 7425879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9c7fcc95cfeab92cb4b524efe837b0?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysData", "link": "https://stackoverflow.com/users/7425879/alwaysdata"}, "reply_to_user": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491481014, "post_id": 43245479, "comment_id": 73578487, "body": "@PrincessPeach2091 are all the new list on one sheet side by side,  stacked on top of each other, or different sheets?"}, {"owner": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491502614, "post_id": 43245479, "comment_id": 73594237, "body": "Since there would be up to 100 different ones, I&#39;d think the side by side on one sheet is the easiest."}, {"owner": {"reputation": 510, "user_id": 7425879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9c7fcc95cfeab92cb4b524efe837b0?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysData", "link": "https://stackoverflow.com/users/7425879/alwaysdata"}, "reply_to_user": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491597809, "post_id": 43245479, "comment_id": 73641737, "body": "I edited this code. Try this out now. It should keep adding additional list until it runs out of columns."}], "tags": [], "owner": {"reputation": 510, "user_id": 7425879, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a9c7fcc95cfeab92cb4b524efe837b0?s=128&d=identicon&r=PG&f=1", "display_name": "AlwaysData", "link": "https://stackoverflow.com/users/7425879/alwaysdata"}, "is_accepted": true, "score": 1, "last_activity_date": 1493176086, "last_edit_date": 1493176086, "creation_date": 1491451296, "answer_id": 43245479, "question_id": 43243219, "link": "https://stackoverflow.com/questions/43243219/looping-through-an-array-while-grabbing-certain-elements/43245479#43245479", "title": "Looping through an array while grabbing certain elements", "body": "<p>See if something like this works for you.  I only ran one scenario through it so you will want to test it more.</p>\n\n<ul>\n<li>This makes the assumption that the data is sorted by column B on the original sheet</li>\n<li>This procedure makes an assumption that there is either headers or no data on row 1. </li>\n<li><p>You will need to change the \"Sheet1\" in this line <code>Set ws1 = ActiveWorkbook.Worksheets(\"Sheet1\")</code> to the name of the sheet you are starting with.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub MoveData()\n\n    Dim ws1 As Worksheet\n    Set ws1 = ActiveWorkbook.Worksheets(\"Sheet1\")\n\n    Dim ws2 As Worksheet\n    Set ws2 = ActiveWorkbook.Worksheets.Add()\n\n\n    Dim rw As Long\n    Dim match_count As Integer\n    Dim list_multiplier As Integer\n    list_multiplier = 7\n    Dim list_row() As Long\n    ReDim list_row(0)\n    list_row(0) = 2\n\n    For rw = 2 To ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Row\n\n\n        If ws1.Range(\"B\" &amp; rw).Value &lt;&gt; ws1.Range(\"B\" &amp; rw).Offset(-1, 0).Value Then\n            match_count = 0\n        Else\n            match_count = match_count + 1\n        End If\n\n        Dim list_num As Integer\n        list_num = match_count \\ 3\n\n        If list_num &gt; UBound(list_row, 1) Then\n            ReDim Preserve list_row(list_num)\n            list_row(list_num) = 2\n        End If\n\n        ws2.Cells(list_row(list_num), 1 + list_multiplier * list_num).Value = ws1.Range(\"A\" &amp; rw).Value\n        ws2.Cells(list_row(list_num), 2 + list_multiplier * list_num).Value = ws1.Range(\"B\" &amp; rw).Value\n        ws2.Cells(list_row(list_num), 3 + list_multiplier * list_num).Value = ws1.Range(\"C\" &amp; rw).Value\n        ws2.Cells(list_row(list_num), 4 + list_multiplier * list_num).Value = ws1.Range(\"D\" &amp; rw).Value\n        ws2.Cells(list_row(list_num), 5 + list_multiplier * list_num).Value = ws1.Range(\"E\" &amp; rw).Value\n        list_row(list_num) = list_row(list_num) + 1\n\n    Next rw\n\nEnd Sub\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491503480, "post_id": 43262588, "comment_id": 73594718, "body": "Hmm I keep getting a &quot;Run time 1004 error. &quot;Unable to get the Max property of the WorksheetFunction class&quot;  <a href=\"http://imgur.com/a/dVf4o\" rel=\"nofollow noreferrer\">imgur.com/a/dVf4o</a>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491507983, "post_id": 43262588, "comment_id": 73597361, "body": "Your data in the link are different than those in your question where column A has progressive numbering for every different company: you can&#39;t ask help showing example data of a kind and then marvel at a provided solution not working with data of a completely different kind! So please edit your question with the final version of data to work with. Thank you"}, {"owner": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491510696, "post_id": 43262588, "comment_id": 73598937, "body": "Apologies! The numbers were just there for reference, but I added them in my real data set and it some what worked. It pulled some weird data out <a href=\"http://imgur.com/a/cOg8P\" rel=\"nofollow noreferrer\">imgur.com/a/cOg8P</a>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491515783, "post_id": 43262588, "comment_id": 73601380, "body": "why are they weird?"}, {"owner": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491522511, "post_id": 43262588, "comment_id": 73603665, "body": "It grabs randomized versions of companies, not the 3 per company I am trying to get at :/"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "edited": false, "score": 0, "creation_date": 1491561080, "post_id": 43262588, "comment_id": 73619468, "body": "I tested with data like that you provided in your question and it worked with no random selection. BTW I edited code to change the statement that defines how many &quot;Lists&quot; are going to be generated where I forced the <code>\\3</code> operation be evaluated before the  <code>3*</code> one. Let me know"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1491560959, "last_edit_date": 1491560959, "creation_date": 1491501671, "answer_id": 43262588, "question_id": 43243219, "link": "https://stackoverflow.com/questions/43243219/looping-through-an-array-while-grabbing-certain-elements/43262588#43262588", "title": "Looping through an array while grabbing certain elements", "body": "<p>assuming row 3 has your data headers, you could try this:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim nLists As Long, iList As Long\n    Dim data As Variant\n    Dim dataToDelete As Range\n\n    With Range(\"F3\", Cells(Rows.Count, 1).End(xlUp))\n        data = .Value\n        nLists = WorksheetFunction.Max(.Resize(,1))\n        nLists = nLists \\ 3 + IIf(nLists - 3 * (nLists \\ 3) = 0, -1, 0)\n    End With\n\n    With Range(\"A3\").Resize(, 6)\n        For iList = 0 To nLists\n            Set dataToDelete = Nothing\n            With .Offset(, iList * 6).Resize(UBound(data))\n                .Value = data\n                .AutoFilter Field:=1, Criteria1:=\"&lt;=\" &amp; iList * 3, Criteria2:=\"&gt;\" &amp; (iList + 1) * 3, Operator:=xlOr\n                If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then Set dataToDelete = .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible)\n                .Parent.AutoFilterMode = False\n                If Not dataToDelete Is Nothing Then dataToDelete.Delete xlShiftUp\n            End With\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1491614236, "last_edit_date": 1491614236, "creation_date": 1491538201, "answer_id": 43269475, "question_id": 43243219, "link": "https://stackoverflow.com/questions/43243219/looping-through-an-array-while-grabbing-certain-elements/43269475#43269475", "title": "Looping through an array while grabbing certain elements", "body": "<p>Your task is actually slightly trickier than your online advice suggests. Basically, you have to do the following:</p>\n\n<ol>\n<li>Find out how many unique 'keys' (ie unique items in column B) you have. This will tell you the total number of rows you need (ie number of unique keys * 3)</li>\n<li>Count the number of items for each 'key'. This will tell you how many columns you need (ie max item count / 3 * number of columns in array [A:E = 5])</li>\n<li>Loop through each line of data and it put on appropriate row for that 'key'. Once three has been reached, jump the column for that key 6 columns to the right, and continue.</li>\n</ol>\n\n<p>If you were to use a <code>Class</code> object and <code>Collection</code> type of object, this could be really quite concise code, but judging by your post you are at the beginning of your programming journey in VBA. Therefore, I've broken down each task into separate chunks of code so you will hopefully see how arrays can work for you. Once you practise with arrays a little, perhaps you could have a go at making this code more efficient by combining some of the loops:</p>\n\n<pre><code>Public Sub RunMe()\n    Dim data As Variant\n    Dim r As Long, c As Long, i As Long, dataRows As Long, dataCols As Long, keyLen As Long, maxCount As Long\n    Dim keys As String\n    Dim k As Variant\n    Dim keyArray() As String\n    Dim keyCount() As Long, threeCount() As Long, rowNum() As Long, colNum() As Long\n    Dim output() As Variant\n\n    'Read the data - change \"Sheet1\" to your sheet name.\n    'Shows how to write range values into a variant to\n    'create an array of variants.\n    data = ThisWorkbook.Worksheets(\"Sheet1\").UsedRange.Value2\n    dataRows = UBound(data, 1)\n    dataCols = UBound(data, 2)\n\n    'Create a list of unique keys.\n    'Note: not the most efficient way, but shows how to\n    'create an array from a value-separated string.\n    For r = 1 To dataRows\n        If InStr(keys, CStr(data(r, 2))) = 0 Then\n            If Len(keys) &gt; 0 Then keys = keys &amp; \"|\"\n            keys = keys &amp; CStr(data(r, 2))\n        End If\n    Next\n    keyArray = Split(keys, \"|\")\n    keyLen = UBound(keyArray)\n\n    'Initialise the row and column numbers for each key.\n    'Shows how to iterate an array using For Each loop.\n    ReDim rowNum(keyLen)\n    ReDim colNum(keyLen)\n    r = 1\n    i = 0\n    For Each k In keyArray\n        rowNum(i) = r\n        colNum(i) = 1\n        r = r + 3\n        i = i + 1\n    Next\n\n    'Count the number of items for each key.\n    'Shows how to iterate an array using For [index] loop.\n    ReDim keyCount(keyLen)\n    For r = 1 To dataRows\n        i = IndexOfKey(keyArray, CStr(data(r, 2)))\n        keyCount(i) = keyCount(i) + 1\n        If keyCount(i) &gt; maxCount Then maxCount = keyCount(i)\n    Next\n\n    'Size the output array.\n    c = WorksheetFunction.Ceiling(maxCount / 3, 1)\n    ReDim output(1 To (keyLen + 1) * 3, 1 To c * dataCols + c - 1)\n\n    'Populate the output array.\n    ReDim threeCount(keyLen)\n    For r = 1 To dataRows\n        i = IndexOfKey(keyArray, CStr(data(r, 2)))\n        'Copy the columns for this row.\n        For c = 1 To dataCols\n            output(rowNum(i), colNum(i) + c - 1) = data(r, c)\n        Next\n        'Increment the count and if it's equals 3 then\n        'reset the row num and increase the column number.\n        threeCount(i) = threeCount(i) + 1\n        rowNum(i) = rowNum(i) + 1\n        If threeCount(i) = 3 Then\n            rowNum(i) = rowNum(i) - 3\n            colNum(i) = colNum(i) + dataCols + 1\n            threeCount(i) = 0\n        End If\n    Next\n\n    'Write the data - change \"Sheet2\" to your sheet name.\n    'Shows how to write an array to a Range.\n    ThisWorkbook.Worksheets(\"Sheet2\").Range(\"A3\") _\n        .Resize(UBound(output, 1), UBound(output, 2)).Value = output\nEnd Sub\n\nPrivate Function IndexOfKey(list() As String, key As String) As Long\n    Dim i As Long\n    Dim k As Variant\n\n    'Helper function to find index position of key in array.\n    For Each k In list\n        If key = k Then\n            IndexOfKey = i\n            Exit Function\n        End If\n        i = i + 1\n    Next\n\n    IndexOfKey = -1\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 7822508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e08b0a23383249957a4d58b08aa7d99e?s=128&d=identicon&r=PG&f=1", "display_name": "PrincessPeach2091", "link": "https://stackoverflow.com/users/7822508/princesspeach2091"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 43245479, "answer_count": 4, "score": 1, "last_activity_date": 1499119079, "creation_date": 1491434761, "last_edit_date": 1499119079, "question_id": 43243219, "link": "https://stackoverflow.com/questions/43243219/looping-through-an-array-while-grabbing-certain-elements", "title": "Looping through an array while grabbing certain elements", "body": "<p>I have a giant dataset that looks like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/lvhFr.png\" alt=\"enter image description here\"></p>\n\n<p>I am trying to go down the list of different companies and grab 3 per company and combine them. Based on the photo above, I would have 2 different lists with 3 companies each (except TH Repair which will have 2 in the final list). </p>\n\n<p>My real dataset contains hundreds of different companies, each with dozens/hundreds of entries so I would finish with dozens of lists (each potentially hundreds long).</p>\n\n<p>I tried to record a macro and ended up with this code</p>\n\n<pre><code>Sub Loop1()\n'\n' Loop1 Macro\n'\n\n'\n    Range(\"A4:E6\").Select\n    Selection.Copy\n    Sheets(\"Sheet3\").Select\n    Range(\"A18\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet2\").Select\n    Range(\"A11:E13\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet3\").Select\n    Range(\"A21\").Select\n    ActiveSheet.Paste\n    Sheets(\"Sheet2\").Select\n    Range(\"A17:E19\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Sheet3\").Select\n    Range(\"A24\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>However, this turned out to be WAY more complicated then I expected.</p>\n\n<p>I am looking for the end result to look like this</p>\n\n<p><img src=\"https://i.stack.imgur.com/TjoHy.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 7768333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f7cce11ce24e31bf12979796130099?s=128&d=identicon&r=PG&f=1", "display_name": "Josh2566", "link": "https://stackoverflow.com/users/7768333/josh2566"}, "is_accepted": false, "score": 0, "last_activity_date": 1491450023, "creation_date": 1491450023, "answer_id": 43245281, "question_id": 43243066, "link": "https://stackoverflow.com/questions/43243066/want-to-copy-from-t2-through-ac2-and-paste-down-into-the-next-open-row-and-then/43245281#43245281", "title": "Want to Copy from T2 through AC2 and Paste down into the next open row, and then keep doing that until Coulmn A is blank", "body": "<p>I usually reference cells in VBA using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194567.aspx\" rel=\"nofollow noreferrer\">cells</a> property with <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221540(v=office.11).aspx\" rel=\"nofollow noreferrer\">index numbers</a>, so that's how I have it in the sub below. I'm sure the code below could be modified to use <code>A1</code> notation instead. But here's how I would do it:</p>\n\n<pre><code>Sub Find_next_BLANK_A_andPaste()\n\n    Dim CurrentRow As Long\n    Dim CurrentWS As Worksheet\n\n    'Set the current worksheet as a variable just so it can be referenced \n    'easier. If your worksheet isn't the first worksheet of the workbook, \n    'you'll need to replace Worksheets(1) below with the proper reference\n    'to your sheet (i.e. Worksheets(2) or Worksheets(\"Sheet3\"))\n    Set CurrentWS = ActiveWorkbook.Worksheets(1)\n\n    With CurrentWS\n\n        'Start at row 1\n        CurrentRow = 1\n\n        'Loop until the cell in column A of the next row is blank\n        While .Cells(CurrentRow + 1, 1) &lt;&gt; \"\"\n\n            'Copy everything from column T to column AC of the current row\n            .Range(.Cells(CurrentRow, 20), .Cells(CurrentRow, 29)).Copy\n\n            'Select column T of the next row\n            .Cells(CurrentRow + 1, 20).Select\n\n            'Paste the copied data\n            ActiveSheet.Paste\n\n            'Increment the CurrentRow variable to check the next row\n            CurrentRow = CurrentRow + 1\n\n        Wend\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This assumes the first blank cell we find in column A is the \"end\". If there could be blank cells in column A before we've actually reached the end of the data in column A we'll have to modify the above code a little.</p>\n"}, {"tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": false, "score": 0, "last_activity_date": 1491458227, "last_edit_date": 1491458227, "creation_date": 1491457553, "answer_id": 43246648, "question_id": 43243066, "link": "https://stackoverflow.com/questions/43243066/want-to-copy-from-t2-through-ac2-and-paste-down-into-the-next-open-row-and-then/43246648#43246648", "title": "Want to Copy from T2 through AC2 and Paste down into the next open row, and then keep doing that until Coulmn A is blank", "body": "<p>If you're looking to copy from row 3 all the way to the last row in column \"A\", you can do this:</p>\n\n<pre><code>Sub CopyAll()\n  Dim lastRow As Integer\n  With Sheets(1)\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).row\n    .Range(\"T2:AC2\").Copy Destination:=.Range(\"T3:AC\" &amp; lastRow)\n  End With\nEnd Sub\n</code></pre>\n\n<p>But you mention that you want to copy \"T2:AC2\" into any <em>open cells</em> in the range given above, then you're more likely after this:</p>\n\n<pre><code>Sub CopyOnlyToBlankRows()\n  With Sheets(1):\n    Dim lastRow As Integer\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).row\n\n    Dim rng As Range\n    Dim r As Integer\n    For r = 2 To lastRow:\n      Set rng = .Cells(r, \"T\").Resize(, 9)\n      If WorksheetFunction.CountA(rng) = 0 Then\n        .Range(\"T2:AC2\").Copy Destination:=rng\n      End If\n    Next\n  End With\nEnd Sub\n</code></pre>\n\n<p>What it will do is to only copy T2:AC2 to a row when there's nothing in columns T to AC of that row.</p>\n"}], "owner": {"reputation": 1, "user_id": 7823525, "user_type": "registered", "profile_image": "https://graph.facebook.com/641296232722412/picture?type=large", "display_name": "TSP", "link": "https://stackoverflow.com/users/7823525/tsp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491458227, "creation_date": 1491433697, "last_edit_date": 1531161705, "question_id": 43243066, "link": "https://stackoverflow.com/questions/43243066/want-to-copy-from-t2-through-ac2-and-paste-down-into-the-next-open-row-and-then", "title": "Want to Copy from T2 through AC2 and Paste down into the next open row, and then keep doing that until Coulmn A is blank", "body": "<p>What I have is some data in Column A, from rows 1 to some unknown end row. I have some data in row 2 Column T through AC that I want to copy into any open cells in those same rows, and then stop pasting when looking at Row A and seeing the first blank row.</p>\n\n<p>I have the code to copy, find the next open row in T and paste once. What I need is to figure out how to loop until Row A has the first blank cell.</p>\n\n<pre><code>Sub Find_next_BLANK_A_andPaste()\n'\n' Find_next_BLANK_A_andPaste Macro\n'\n\n  Range(\"T2:AC2\").Select\n    Selection.Copy\n' Copy the formulas in T2 to AC2\n\n\n    Range(\"T1\").End(xlDown).Offset(1, 0).Select\nActiveSheet.Paste\n\n\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1491451079, "post_id": 43243217, "comment_id": 73560551, "body": "So there isn&#39;t any way to escape the variable, so that it&#39;s interpreted as a variable and not a hard coded string argument?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1491462171, "post_id": 43243217, "comment_id": 73565210, "body": "@RyanTheLeach yes, yes there is. That&#39;s what <code>Me.VBProject.References.Item(str)</code> is doing."}, {"owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1491477263, "post_id": 43243217, "comment_id": 73575638, "body": "The question asks specifically about the bang operator, you provide useful info, but it doesn&#39;t answer OP&#39;s question."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 1, "creation_date": 1491478508, "post_id": 43243217, "comment_id": 73576524, "body": "@RyanTheLeach What part doesn&#39;t answer the OP&#39;s question? I explain how the bang operator works, and what an exact alternative is that will achieve the outcome he is seeking. There is no other way to get the reference other than enumerating the references and checking each name. That <i>might</i> work with the references collection, but it won&#39;t work with the Workbooks or Worksheets collections. Passing the variable as an index will allow the OP to achieve his desired outcome."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 1, "creation_date": 1491479351, "post_id": 43243217, "comment_id": 73577175, "body": "@RyanTheLeach if this doesn&#39;t answer OP&#39;s question, then OP&#39;s question is not answerable. The bang operator is not magic."}, {"owner": {"reputation": 305, "user_id": 5485062, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/RBpt2.jpg?s=128&g=1", "display_name": "IronX", "link": "https://stackoverflow.com/users/5485062/ironx"}, "edited": false, "score": 0, "creation_date": 1491500401, "post_id": 43243217, "comment_id": 73592961, "body": "Well, Bang it! ;) My question was indeed targeted more towards Bang itself. It is odd to me that it does not seem to permit a variable as its string literal."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 5, "last_activity_date": 1491480401, "last_edit_date": 1491480401, "creation_date": 1491434755, "answer_id": 43243217, "question_id": 43242985, "link": "https://stackoverflow.com/questions/43242985/assign-bang-argument-programmatically/43243217#43243217", "title": "Assign Bang argument programmatically?", "body": "<p>No, you can't do that.</p>\n\n<p>The bang operator is just a shortcut for calling the default member of the object, and passing the text after the bang as a string to the first parameter of the default member:</p>\n\n<p>The bang notation:</p>\n\n<pre><code>Me.VBProject.References!Excel\n</code></pre>\n\n<p>is exactly equivalent to:</p>\n\n<pre><code>Me.VBProject.References.Item(\"Excel\")\n</code></pre>\n\n<p>and, because it is the default member, you can omit the <code>Item</code> function call:</p>\n\n<pre><code>Me.VBProject.References(\"Excel\")\n</code></pre>\n\n<p>So, to use your (really badly named) variable <code>str</code>:</p>\n\n<pre><code>str = \"Excel\"\nDebug.Print Me.VBProject.References.Item(str).Name\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1491508728, "post_id": 43258294, "comment_id": 73597838, "body": "Bang notation is for passing a string literal <code>argument</code> as the 1st parameter to the default member of <b>any</b> <code>object</code>, not just collections. <i>Some</i> collections expose a default member that accepts an index, so bang notation is often <i>interpreted</i> as being a collection feature, but not all collections have a default member, and some have a default member that is <i>not</i> an indexer. A non-collection object can have a default member that accepts a string parameter, and using bang notation when working with those objects is perfectly valid. <a href=\"http://bytecomb.com/the-bang-exclamation-operator-in-vba/\" rel=\"nofollow noreferrer\">bytecomb.com/the-bang-exclamation-operator-in-vba</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1491508882, "post_id": 43258294, "comment_id": 73597932, "body": "@ThunderFrame Waaattttt???!?!!!! Gosh this is terrible. &quot;Perfectly valid&quot;, sure - and <i>perfectly insipid</i> too. May that knowledge be lost forever."}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 1, "creation_date": 1491510706, "post_id": 43258294, "comment_id": 73598949, "body": "VBA would be so much less insipid if <code>:</code>, <code>!</code> and ` _` were illegal characters."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1491512880, "last_edit_date": 1491512880, "creation_date": 1491489391, "answer_id": 43258294, "question_id": 43242985, "link": "https://stackoverflow.com/questions/43242985/assign-bang-argument-programmatically/43258294#43258294", "title": "Assign Bang argument programmatically?", "body": "<p>This is an X-Y problem.</p>\n\n<h3>Bang notation is a means to an end.</h3>\n\n<p>It's one of the tools made available to you, to <strong>retrieve an item from a collection</strong>.</p>\n\n<p>Nothing more, nothing less. </p>\n\n<blockquote>\n  <p>What you want isn't to <em>use the bang operator with a variable</em>.<br>\n  What you want is to <em>retrieve an item from a collection using a variable</em>.</p>\n</blockquote>\n\n<p>Collection types have a <em>default member</em>, typically named <code>Item</code>. Default members can be specified explicitly, or implicitly accessed:</p>\n\n<pre><code>Dim foo As New Collection\nfoo.Add Item:=42, Key:=\"test\"\n</code></pre>\n\n\n\n<pre><code>Debug.Print foo.Item(\"test\") 'explicit reference to the default member\nDebug.Print foo(\"test\") 'implicit reference to the same default member\n</code></pre>\n\n<p>The bang operator is just another way to make an implicit call to the collection's default member:</p>\n\n<pre><code>Debug.Print foo!test\n</code></pre>\n\n<p>All 3 <code>Debug.Print</code> statements above will call the <code>foo.Item</code> default member to output the <code>42</code> associated with the key <code>\"test\"</code>.</p>\n\n<h3>Square brackets</h3>\n\n<p>As you can see, what comes immediately after the <code>!</code> operator is really a <strong>string literal</strong>. Because a string literal can contain whitespace, the VB6/VBA parser needed a way to support them.</p>\n\n<p>That's what the <code>[square brackets]</code> are for:</p>\n\n<pre><code>foo.Add 72, \"spaces in the key\"\nDebug.Print foo![spaces in the key]\n</code></pre>\n\n<p>When they're not delimiting a string literal for bang notation, square brackets are <em>usually</em><sup>1</sup> interpreted as a run-time expression for the host application to evaluate. For example this is legal (though questionably advisable) in Excel VBA:</p>\n\n<pre><code>Debug.Print [A1]\n</code></pre>\n\n<p>The VBA parser identifies a <em>bracketed expression</em> and defers its evaluation to the host application - here Excel; <strong>at run-time</strong>, the instruction ultimately equates to:</p>\n\n<pre><code>Debug.Print ActiveSheet.Range(\"A1\").Value\n</code></pre>\n\n<p>If you don't believe the evaluation of a <em>bracketed expression</em> is deferred to the host application, consider what needs to happen for this instruction to print <code>4</code>:</p>\n\n<pre><code>Debug.Print [Sum(2,2)]\n</code></pre>\n\n<p>Therefore, every single one of the attempts/permutations in your post missed the mark and made <em>Excel</em> try to evaluate an expression that only VBA would be able to resolve, because <code>Me.VBProject.References</code> means absolutely nothing to Excel.</p>\n\n<p>Square-bracket expressions should usually be avoided, because you lose compile-time checks and any error can only be caught at run-time.</p>\n\n<hr>\n\n<p><sup>1</sup><em>Usually</em>, because they can also be used in <em>some</em> identifiers,\n for example in <code>Enum</code> types, to make a <code>[_hidden]</code> enum member.</p>\n\n<hr>\n\n<h1>Bottom Line</h1>\n\n<p>Bang notation is a way to retrieve an item from a collection by leveraging <em>default members</em> and making string literals <em>look</em> like an identifier. You can't make it work without \"hard-coding\" the string literal, because it <strong>requires a <em>string literal</em></strong>.</p>\n\n<p><strong>If you want to parameterize the collection retrieval, you can't use the bang operator.</strong></p>\n\n<p>It's useful for <em>typing the code faster</em>. If you don't know <em>exactly</em> how it works and what it does for you though, it's a double-edged blade that <strong>hides what's really going on</strong> and ultimately makes the code harder to read and understand. Code shouldn't be written just to be <em>run</em>. Code should be written to be <em>read</em> and <em>understood</em>.</p>\n\n<hr>\n\n<p>Note: Bang notation isn't <em>actually</em> only for collections. It actually passes its argument as a string literal to the first parameter of anything that has a default <em>member</em>. I would strongly advise avoiding it for anything other than a collection class though (e.g. <code>Collection.Item</code>, <code>Workbooks.Item</code>, <code>Worksheets.Item</code>, <code>Recordset.Fields</code>, etc.), for the sake of future maintainers' sanity.</p>\n"}], "owner": {"reputation": 305, "user_id": 5485062, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/RBpt2.jpg?s=128&g=1", "display_name": "IronX", "link": "https://stackoverflow.com/users/5485062/ironx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 43243217, "answer_count": 2, "score": 3, "last_activity_date": 1491512880, "creation_date": 1491433107, "last_edit_date": 1531164843, "question_id": 43242985, "link": "https://stackoverflow.com/questions/43242985/assign-bang-argument-programmatically", "title": "Assign Bang argument programmatically?", "body": "<p>I'm not successful in using the Bang (!) operator without it's argument being hardcoded, i.e., <code>Me.VBProject.References!Excel</code>. In this example, the <em>Excel</em> reference is hardcoded.\nOut of frustration I've tried all permutations I can think of in an attempt to utilize it:</p>\n\n<pre><code>[Me.VBProject.References!(str)]\n[Me.VBProject.References! &amp; (str)]\n[\"Me.VBProject.References!\" &amp; str]\n[\"Me.VBProject.References!\" &amp; (str)]\n</code></pre>\n\n<p>and many more with parens added to ensure proper pre-evaluation including the longhand <code>Application.evaluate</code> method. Nada!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 585, "user_id": 7689006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JH9Nj.png?s=128&g=1", "display_name": "Winterknell", "link": "https://stackoverflow.com/users/7689006/winterknell"}, "edited": false, "score": 0, "creation_date": 1491476862, "post_id": 43242873, "comment_id": 73575389, "body": "Showing us your current code would be a good start."}], "owner": {"reputation": 11, "user_id": 7823421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bddd239500e0c4b816a59245a31e853?s=128&d=identicon&r=PG&f=1", "display_name": "Dberends", "link": "https://stackoverflow.com/users/7823421/dberends"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1491432446, "creation_date": 1491432446, "last_edit_date": 1531164843, "question_id": 43242873, "link": "https://stackoverflow.com/questions/43242873/copy-information-from-variable-sheets-to-sheet1", "title": "Copy information from variable sheets to sheet1", "body": "<p>I'm not sure where to begin, I have found codes for finding information and selecting it so that the information can be modified. However I'm not sure how to even begin to start a string that I need as I am new to vba. </p>\n\n<p>I will begin by explain what my current \"macro1\" does. I have 2 main sheets in excel, the first is \"template\" and the other is \"log\". \"Macro\" copies information from \"template\" sheet and pastes it on \"form\" after it has created a new row. Then it copies it's self and renames the sheet to value \"A1\". It then reassigns a macro to the button (macro2). </p>\n\n<p>Over time you have multiple sheets with macro2. What I'm trying to do is have macro2 copy the information in a cell range on the active sheet to \"log\" sheet. It needs to find the cell \"A1\" from the previously active sheet and replace the information.</p>\n\n<p>Any help pointing me in the right direction would be greatful.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 2, "creation_date": 1491430615, "post_id": 43242387, "comment_id": 73555228, "body": "you prolly need another singler quote before me.cbowavefilter"}, {"owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1491595231, "post_id": 43242387, "comment_id": 73640568, "body": "Close, this was what I eventually had to do.  Thank you for your help!  <code>Me.Filter = &quot;[wavename]=&#39;&quot; &amp; Me.cboWaveFilter &amp; &quot;&#39;&quot; </code>"}], "owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1491429707, "creation_date": 1491429707, "question_id": 43242387, "link": "https://stackoverflow.com/questions/43242387/trying-to-filter-a-form-by-combo-box-value-error-syntax-error-missing-operato", "title": "Trying to Filter a Form by Combo Box Value Error: &quot;Syntax error (missing operator) in query expression", "body": "<p>I am trying to filter a form based off of the value that is selected in a combo box.  The field that I am trying to filter is called \"wave\" and the combo box is called cboWaveFilter.  I am using the VBA code below to apply the filter.  I tried both the uncommented code and the commented out code and I still receive the same error message.  I keep receiving the error message \"Syntax error (missing operator) in query expression\" when I try to select a value in the combo box.  I can't figure out what is causing this error.  I went back and checked the query that the form is built on (and the subqueries that that query is built from) and I can't find any issue with a space in a field name (which seems to be a common solution to the problem).  Any help would be greatly appreciated!  Thank you!</p>\n\n<pre><code>Private Sub cboWaveFilter_AfterUpdate()\n\n'DoCmd.ApplyFilter , \"[wave] =\" &amp; Me.cboWaveFilter\n\nMe.Filter = \"wave =\" &amp; Me.cboWaveFilter &amp; \"'\" \nMe.FilterOn = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos", "button"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491430159, "post_id": 43242144, "comment_id": 73555037, "body": "&quot;... so can someone change the code to allow opening of files from a Mac environment instead of a Windows one?&quot; What have you tried so far? What line is the error occuring on? Also, you can greatly &quot;tighten up&quot; your code by <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoiding the use of <code>.Select</code>/<code>.Activate</code></a>."}, {"owner": {"reputation": 1, "user_id": 6667941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a7e5daf6ff7e75017f0a1b61f7423e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnyenv", "link": "https://stackoverflow.com/users/6667941/johnnyenv"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491431666, "post_id": 43242144, "comment_id": 73555574, "body": "I haven&#39;t tried anything. Im not at all a programmer. This was something that was built for me. I get the error &#39;Compile Error: Named Argument not found."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491431706, "post_id": 43242144, "comment_id": 73555589, "body": "what pine does it occur on? (Click &quot;Debug&quot; when the error window pops up)"}, {"owner": {"reputation": 1, "user_id": 6667941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a7e5daf6ff7e75017f0a1b61f7423e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnyenv", "link": "https://stackoverflow.com/users/6667941/johnnyenv"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491432394, "post_id": 43242144, "comment_id": 73555788, "body": "Debug isn&#39;t an option. It just displays that error. The only thing that is highlighted when it runs (in VB) is TrailingMinusNumbers:="}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491433275, "post_id": 43242144, "comment_id": 73556088, "body": "If you remove that part, <code>, TrailingMinusNumbers:=True</code>, does it function as you expect?"}, {"owner": {"reputation": 1, "user_id": 6667941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a7e5daf6ff7e75017f0a1b61f7423e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnyenv", "link": "https://stackoverflow.com/users/6667941/johnnyenv"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491433466, "post_id": 43242144, "comment_id": 73556138, "body": "No it doesn&#39;t work by removing that. IT was designed to open a PC document. That needs changing for a Mac environment."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491434220, "post_id": 43242144, "comment_id": 73556341, "body": "Try changing the <code>Origin:=xlWindows</code> to <code>xlMacintosh</code>"}, {"owner": {"reputation": 1, "user_id": 6667941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a7e5daf6ff7e75017f0a1b61f7423e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnyenv", "link": "https://stackoverflow.com/users/6667941/johnnyenv"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491434952, "post_id": 43242144, "comment_id": 73556525, "body": "Nope, Same error."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491495460, "post_id": 43242144, "comment_id": 73589864, "body": "Does <a href=\"https://www.rondebruin.nl/mac/mac015.htm\" rel=\"nofollow noreferrer\">this page</a> help? Or perhaps <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195814%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">this one</a>?"}], "owner": {"reputation": 1, "user_id": 6667941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92a7e5daf6ff7e75017f0a1b61f7423e?s=128&d=identicon&r=PG&f=1", "display_name": "Johnnyenv", "link": "https://stackoverflow.com/users/6667941/johnnyenv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593678747, "creation_date": 1491428572, "last_edit_date": 1593678747, "question_id": 43242144, "link": "https://stackoverflow.com/questions/43242144/macro-built-on-pc-designed-to-select-folder-needs-to-work-on-mac", "title": "Macro Built on PC designed to select folder. Needs to work on Mac", "body": "<p>I've had this Macro button built. I'm getting an error immediately after pressing the button as this was designed to work on a PC.</p>\n\n<p>The file is just asking for the location of the excel file to format. I just need this to work on a Mac so can someone change the code to allow opening of files from a Mac environment instead of a Windows one?</p>\n\n<p>This is the Visual Basic editor;</p>\n\n<pre><code>Sub Johnny_Calculations()\n\n    Dim TotalRow As String\n    Dim wb As String\n    Dim ws As String\n\n\n    With Application.FileDialog(msoFileDialogOpen)\n        .Show\n        .Title = \"Choose File\"\n        .AllowMultiSelect = False\n    If .SelectedItems.Count = 1 Then\n        Path = .SelectedItems(1)\n    End If\n    End With\n\n    Workbooks.OpenText Filename:= _\n        Path _\n        , Origin:=xlWindows, StartRow:=1, DataType:=xlDelimited, TextQualifier _\n        :=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:= _\n        True, Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(Array( _\n        1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1), Array(8, _\n        1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1), Array(14, 1), Array _\n        (15, 1), Array(16, 1), Array(17, 1), Array(18, 1), Array(19, 1), Array(20, 1), Array(21, 1), _\n        Array(22, 1), Array(23, 1)), TrailingMinusNumbers:=True\n\n    wb = ActiveWindow.Caption\n    ws = ActiveSheet.Name\n\n    TotalRow = WorksheetFunction.Match(\"Total\", Range(\"A:A\"), 0)\n\n    Rows(TotalRow &amp; \":\" &amp; TotalRow).Select\n    Selection.ClearContents\n\n       File = \"Johnny Calculations.xlsm\"\n\n    Workbooks(File).Worksheets(\"Sheet2\").Activate\n    Workbooks(File).Worksheets(\"Sheet1\").Range(\"B2:C22\").Copy\n\n\n    Windows(wb). _\n        Activate\n    Sheets.Add After:=ActiveSheet\n    Range(\"B2\").Select\n    ActiveSheet.Paste\n    Columns(\"B:C\").Select\n    Selection.ColumnWidth = 16.86\n    Range(\"C3\").Select\n    Application.CutCopyMode = False\n\n\n\n    'calculations\n    ActiveCell.FormulaR1C1 = \"=SUM('\" &amp; wb &amp; \"'!C)\"\n    Range(\"C6\").Select\n    ActiveCell.FormulaR1C1 = \"=SUM('\" &amp; wb &amp; \"'!C[3])\"\n    Range(\"C7\").Select\n\n    ActiveCell.FormulaR1C1 = \"=R[-1]C/R[-4]C\"\n    Range(\"C7\").Select\n\n    Range(\"C8\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=SUM('\" &amp; wb &amp; \"'!C[4])/SUM('\" &amp; wb &amp; \"'!C)\"\n    Range(\"C10\").Select\n    ActiveCell.FormulaR1C1 = \"=SUM('\" &amp; wb &amp; \"'!C[5])\"\n\n\n    Range(\"C11\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=SUM('\" &amp; wb &amp; \"'!C[5])/SUM('\" &amp; wb &amp; \"'!C[4])\"\n    Range(\"C12\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=SUM('\" &amp; wb &amp; \"'!C[6])/SUM('\" &amp; wb &amp; \"'!C[3])\"\n    Range(\"C13\").Select\n    ActiveCell.FormulaR1C1 = \"=R[-3]C/R[-7]C\"\n    Range(\"C15\").Select\n    ActiveCell.FormulaR1C1 = \"=SUM('\" &amp; wb &amp; \"'!C[7])\"\n    Range(\"C16\").Select\n    ActiveCell.FormulaR1C1 = \"=R[-1]C/R[-6]C\"\n    Range(\"C17\").Select\n    ActiveCell.FormulaR1C1 = \"=SUM('\" &amp; wb &amp; \"'!C[10])\"\n    Range(\"C19\").Select\n    ActiveCell.FormulaR1C1 = \"=SUM('\" &amp; wb &amp; \"'!C[8])\"\n    Range(\"C20\").Select\n    ActiveCell.FormulaR1C1 = \"=IFERROR(R[-1]C/R[-5]C,\"\"No Complaints\"\")\"\n    Range(\"C21\").Select\n    ActiveCell.FormulaR1C1 = \"=SUM('\" &amp; wb &amp; \"'!C[9])\"\n    Range(\"C22\").Select\n\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"=R[-1]C/R[-19]C\"\n    Range(\"C23\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "logging", "append"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491429542, "post_id": 43241812, "comment_id": 73554819, "body": "For the first approach - you can buffer lines in a static variable within <code>Log_to_file</code> - when you&#39;ve accumulated a certain number of lines then write them out and clear the buffer.  For the second approach: use a global boolean to indicate if the file is open - check that before writing to the file, and open the file if not already open."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491439348, "post_id": 43241812, "comment_id": 73557683, "body": "If you&#39;re opening a file for appending I don&#39;t think it will load the whole file - it will seek to the end of the file and just write the new content."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491608717, "post_id": 43241812, "comment_id": 73645174, "body": "As mention by Rich, I&#39;m using the log for debugging, so I&#39;d rather not buffer the Append. I also tested with 100 000 * Open/Append/Close ; it takes 18s. That&#39;s much worse than doing 100 000* Append (and only 1 Open and 1 Close), which takes 1s. But I&#39;d say it&#39;s performant enough for me, so it&#39;s not worth for me to have to manage closing the file (which will probably fail if the macro fail)."}], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1491608412, "post_id": 43244512, "comment_id": 73645111, "body": "I tested with 100 000 * Open/Append/Close ; it takes 18s. That&#39;s much worse than doing 100 000* Append (and only 1 Open and 1 Close), which takes 1s. But I&#39;d say it&#39;s performant enough for me, so it&#39;s not worth for me to have to manage closing the file (which will probably fail if the macro fail)."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1491608574, "post_id": 43244512, "comment_id": 73645145, "body": "Good point about the log file growing. I&#39;m indeed using the date in the log and killing old logs when necessary."}], "tags": [], "owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "is_accepted": true, "score": 2, "last_activity_date": 1491444706, "creation_date": 1491444706, "answer_id": 43244512, "question_id": 43241812, "link": "https://stackoverflow.com/questions/43241812/logging-strategies-with-open-myfile-for-append-vba-excel/43244512#43244512", "title": "Logging strategies with &#39;Open myFile For Append&#39; (VBA Excel)", "body": "<p>There is no problem opening more than one file at a time. Just make sure your file numbers are different and you don't confuse them.</p>\n\n<p>Your first method, opening the file, appending to it, and closing with each call to log_to_file can be a useful way to do it, especially if you're concerned about losing logging data if the program crashes or is externally terminated. If you do buffer the output, as Tim Williams suggested, you would lose what's in the buffer at the moment of the crash/termination.</p>\n\n<p>There will be some performance cost, but how much depends on a number of factors, like the configuration of the computer system, what type of drive the log file is located on, etc. It may be worth trying to see what sort of performance hit you take. (One test is worth a thousand expert opinions...)</p>\n\n<p>The other approach, where you open the log file at the start and close it at the end is also a good approach. As Tim suggested, just create a global boolean variable, something like <code>logfileOpened</code>and add a check to the log_to_file sub.</p>\n\n<pre><code>Public Const log_file_nb = 1\nprivate log_file_open as boolean\n\nPublic Sub Open_log_file(byval log_file_nb)\n    Open \"C:\\Temp\\Log myMacro.txt\" For Append As #log_file_nb\n    log_file_open = True\nEnd Sub\n\nPublic Sub Log_to_file(byval message as string)\n    if not log_file_open then Open_log_file log_file_nb\n    Print #log_file_nb, message\nEnd Sub\n\nPublic Sub Close_log_file()\n    Close #log_file_nb\n    log_file_open = False\nEnd Sub\n</code></pre>\n\n<p>A detail this leaves hanging is the need to close the log file at some point. By setting log_file_open to false as part of the Close_log_file sub, you could do this more than once through the course of running the program. But you would need to do it at least once, after all of the Log_to_file calls.</p>\n\n<p>One final note: By always opening the log file in append mode, the file will grow each time the program is run. Depending on the situation, this may be acceptable, or you may have to include some code to keep the log file from becoming huge. Some possible solutions:</p>\n\n<ol>\n<li>Give the log file a name based on the date. This results in many smaller log files. You could also delete log files with dates that are too old, keeping the total number in check.</li>\n<li>Write code to delete the oldest (topmost) lines in the file once the file gets too large. This is very possible, but not trivial.</li>\n<li>The first time you open the log file during a particular run of the program, delete the existing log file first. You end up with a log file that only includes the logging of the last program run.</li>\n</ol>\n"}], "owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1929, "favorite_count": 0, "accepted_answer_id": 43244512, "answer_count": 1, "score": 2, "last_activity_date": 1491444706, "creation_date": 1491427139, "last_edit_date": 1531164843, "question_id": 43241812, "link": "https://stackoverflow.com/questions/43241812/logging-strategies-with-open-myfile-for-append-vba-excel", "title": "Logging strategies with &#39;Open myFile For Append&#39; (VBA Excel)", "body": "<p>I need to log the actions of a VBA macro running in Excel (100 subs and functions, 10 main sub). I'm already using a \"Workflow\" sheet as a very light log (mains sub) readable by the user.</p>\n\n<p>But I'd like to log what is currently printed in the Immediate Window by <code>Debug.Print</code>, which can generate a lot since it's much more comprehensive log. I'm thus considering something like :</p>\n\n<pre><code>Open \"C:\\Temp\\Log.txt\" For Append As #1\nPrint #1, \"This need to be logged\"\nClose #1\n</code></pre>\n\n<p>How should I use the <code>Open</code> and <code>Close</code> commands ?</p>\n\n<h2>Open / Append / Close for each line, as necessary</h2>\n\n<p>Something like :   </p>\n\n<pre><code>Public Sub Log_to_file(byval message as string)\n    log_file_nb = FreeFile \n    Open \"C:\\Temp\\Log.txt\" For Append As #log_file_nb\n    Print #log_file_nb, message\n    Close #log_file_nb\nEnd Sub\n\nLog_to_file (\"This need to be logged\")\n</code></pre>\n\n<p>Much simpler to implement, but I'm concerned about the performance of opening/closing the file 1000's times.</p>\n\n<h2>Open at the beginning of the Main sub / Append as necessary / Close at the end of the Main sub</h2>\n\n<p>Something like :</p>\n\n<pre><code>Public Const log_file_nb = 1\n\nPublic Sub Open_log_file(byval log_file_nb)\n    Open \"C:\\Temp\\Log myMacro.txt\" For Append As #log_file_nb\nEnd Sub\n\nPublic Sub Log_to_file(byval message as string)\n    Print #log_file_nb, message\nEnd Sub\n\nPublic Sub Close_log_file()\n    Close #log_file_nb\nEnd Sub\n\nLog_to_file (\"This need to be logged\")\n</code></pre>\n\n<ul>\n<li><p>How would you check if the file is already open before trying to log ? (Some subs can be launch directly by a button, or recursively by a main sub)</p></li>\n<li><p>Can I <code>Open For Output</code> a second file (my macro also need to output data to csv files) while file n\u00b01 is still open ?</p></li>\n<li><p>Will keeping the file open have a big impact on memory (assuming 100 000 lines in the files) ?</p></li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491427510, "post_id": 43241793, "comment_id": 73553992, "body": "If the macros are disabled from the start, how do you expect your macro to run the first time?  Correct me if I&#39;m wrong, but if the Excel macro security settings are set to not allow macros by default, I&#39;m pretty sure that no matter what they do in the first instance of Excel (turning macros on/off), when they completely exit Excel, and then re-open it, it&#39;ll have macros disabled."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491427593, "post_id": 43241793, "comment_id": 73554032, "body": "@BruceWayne I think what he&#39;s suggesting is you have a macro enabled workbook and you save it with all sheets hidden except for one sheet that says &quot;You must enable macros to use this workbook&quot; or something. If they have macros enabled though, when it runs, it unhides all the sheets and hides the &quot;You must enable macros to use this workbook&quot; sheet. As described, it can work that way."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1491429365, "post_id": 43242041, "comment_id": 73554742, "body": "Aha, nicely done! I may have to use this sometime too."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491429469, "post_id": 43242041, "comment_id": 73554789, "body": "Thanks! Yea, I&#39;m not really a fan of it, but I have seen some big worksheets that use a method like this to ensure that macros are enabled. I can see it being useful for sure"}, {"owner": {"reputation": 81, "user_id": 7782447, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-Q-FfViAOOM8/AAAAAAAAAAI/AAAAAAAAABg/j0apkAMudOg/photo.jpg?sz=128", "display_name": "SDK Engineering", "link": "https://stackoverflow.com/users/7782447/sdk-engineering"}, "edited": false, "score": 0, "creation_date": 1491506049, "post_id": 43242041, "comment_id": 73596168, "body": "I have this part of it working properly. What I need to know is if there is a way that once the macros are &quot;enabled&quot;, can a form be auto loaded and continue from there? The way my software is going to work, is display a &quot;splash&quot; screen, then ask a question before making the workbook visible. The workbook is invisible, unless the macros are disabled. Does this make sense? TIA"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 81, "user_id": 7782447, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-Q-FfViAOOM8/AAAAAAAAAAI/AAAAAAAAABg/j0apkAMudOg/photo.jpg?sz=128", "display_name": "SDK Engineering", "link": "https://stackoverflow.com/users/7782447/sdk-engineering"}, "edited": false, "score": 0, "creation_date": 1491506433, "post_id": 43242041, "comment_id": 73596408, "body": "@SDKEngineering Yes - it&#39;s absolutely possible - Just add the <code>UserForm.Show</code> in the <code>Workbook_Open()</code> routine (which will run if/when macros are enabled as demonstrated above)."}, {"owner": {"reputation": 81, "user_id": 7782447, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-Q-FfViAOOM8/AAAAAAAAAAI/AAAAAAAAABg/j0apkAMudOg/photo.jpg?sz=128", "display_name": "SDK Engineering", "link": "https://stackoverflow.com/users/7782447/sdk-engineering"}, "edited": false, "score": 1, "creation_date": 1491506833, "post_id": 43242041, "comment_id": 73596632, "body": "Ok. Looks like I may have it correct now lol. Thanks for all the help!"}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 2, "last_activity_date": 1491428516, "last_edit_date": 1491428516, "creation_date": 1491428107, "answer_id": 43242041, "question_id": 43241793, "link": "https://stackoverflow.com/questions/43241793/display-userform-before-unhiding-worksheets/43242041#43242041", "title": "Display userform before unhiding worksheets", "body": "<p>I believe you're looking for something like this.</p>\n\n<p>Modify as needed.</p>\n\n<p>Place in <code>ThisWorkbook</code></p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nSheets(\"Warning\").Visible = xlSheetVisible\nDim ws\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Warning\" Then ws.Visible = xlVeryHidden\nNext ws\nThisWorkbook.Save\nEnd Sub\nPrivate Sub Workbook_Open()\nDim ws\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Warning\" Then ws.Visible = xlSheetVisible\nNext ws\nSheets(\"Warning\").Visible = xlVeryHidden\nEnd Sub\n</code></pre>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zh3Hm.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zh3Hm.gif\" alt=\"Demo\"></a></p>\n"}], "owner": {"reputation": 81, "user_id": 7782447, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-Q-FfViAOOM8/AAAAAAAAAAI/AAAAAAAAABg/j0apkAMudOg/photo.jpg?sz=128", "display_name": "SDK Engineering", "link": "https://stackoverflow.com/users/7782447/sdk-engineering"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1576167508, "creation_date": 1491427037, "last_edit_date": 1576167508, "question_id": 43241793, "link": "https://stackoverflow.com/questions/43241793/display-userform-before-unhiding-worksheets", "title": "Display userform before unhiding worksheets", "body": "<p>I have code that displays a worksheet that tells the user to turn on macros, with other sheets being kept hidden. Once the workbook is re-opened, the remaining worksheets are displayed and the sheet that tells the user to turn on macros is hidden.</p>\n\n<p>I want to display a userform before displaying the hidden worksheets.</p>\n\n<pre><code>Option Explicit\nConst origsave As String = \"C:\\SDK Engineering\\iMudCalc Software\"\nConst origwrkbksave As String = \"C:\\SDK Engineering\\iMudCalc Software\\iMudCalc.xlsm\"\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\nDim ws As Worksheet\n\n'don't display workbook\nApplication.Visible = False\n\n'Unhide the Starting Sheet\nSheets(\"Warning\").Visible = xlSheetVisible\n\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Warning\" Then\n        ws.Visible = xlVeryHidden\n    End If\nNext ws\n\nIf Len(Dir(origsave)) &gt; 0 Then\n    MkDir (origsave)\nElse\n    ActiveWorkbook.SaveCopyAs (origwrkbksave)\nEnd If\nEnd Sub\n\nPrivate Sub WorkBook_Open()\nDim ws As Worksheet\n\nApplication.Visible = False\n\n    For Each ws In ThisWorkbook.Worksheets\n        ws.Visible = xlSheetVisible\n    Next ws\n\n    Sheets(\"Warning\").Visible = xlVeryHidden\n\n    'this is where I need the workbook to stay invisible and display a userform if macros are enabled...\n    frmOnLoad.Show\n\nEnd Sub\n</code></pre>\n\n<p>I am using Excel 2013.</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1491429248, "post_id": 43241791, "comment_id": 73554679, "body": "<i>something fundamentally wrong</i>... <i>I&#39;m having a difficult time figuring out what that is</i>...can you post any error to precisely figure out issue?"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1491453308, "post_id": 43241791, "comment_id": 73561144, "body": "Perhaps this has nothing to do with your problem, but the code has <i>End Function</i> in the Sub, and it looks like the MsgBox will always be shown whether there is an error or not.  As Parfait already said, you need to post what the actual problem... error codes and descriptions, unexpected behavior, etc."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7331521, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d1d3d80d211517f36d292e4efbc3dca9?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/7331521/william"}, "edited": false, "score": 0, "creation_date": 1491485201, "post_id": 43242346, "comment_id": 73581764, "body": "I gave this a shot and received Run-time error &#39;3061&#39;: Too few parameters. Expected 2.The following line of code was highlighted: dbNewInitiatives.Execute strSQL, dbFailOnError"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 33, "user_id": 7331521, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d1d3d80d211517f36d292e4efbc3dca9?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/7331521/william"}, "edited": false, "score": 0, "creation_date": 1491487843, "post_id": 43242346, "comment_id": 73583944, "body": "Are those two fields <i>Mitigation ID</i> and <i>Control ID</i> in the <i>New Control IDs</i> table with those exact names? If they do not exist in the table you will receive such an error. I assumed how you wrote it was correct."}, {"owner": {"reputation": 33, "user_id": 7331521, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d1d3d80d211517f36d292e4efbc3dca9?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/7331521/william"}, "edited": false, "score": 0, "creation_date": 1491496469, "post_id": 43242346, "comment_id": 73590551, "body": "You&#39;re right, Control ID had a syntax error, but after fixing that I still get the same run-time error, but Too few parameters. Expected 1. I have triple checked the rest of the names. Would Text55 being an unbound text box have anything to do with it?"}, {"owner": {"reputation": 33, "user_id": 7331521, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d1d3d80d211517f36d292e4efbc3dca9?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/7331521/william"}, "edited": false, "score": 0, "creation_date": 1491497049, "post_id": 43242346, "comment_id": 73590924, "body": "[Text55] needs single apostrophe before and after the quotation marks due to it being a string and not an integer."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 33, "user_id": 7331521, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d1d3d80d211517f36d292e4efbc3dca9?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/7331521/william"}, "edited": false, "score": 0, "creation_date": 1491500733, "post_id": 43242346, "comment_id": 73593130, "body": "So there you have it. Recall I grabbed exactly as your original <code>SELECT</code> query. Only you know your data. String variables do need quote enclosure."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1491500758, "last_edit_date": 1491500758, "creation_date": 1491429470, "answer_id": 43242346, "question_id": 43241791, "link": "https://stackoverflow.com/questions/43241791/delete-record-from-table-in-access/43242346#43242346", "title": "Delete record from table in Access", "body": "<p>Consider running a <code>DELETE</code> action query using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197654.aspx\" rel=\"nofollow noreferrer\">Database.Execute</a> method without the need of a DAO recordset:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set dbNewInitiatives = CurrentDb\nstrSQL = \"DELETE FROM [New Control IDs]\" _\n           &amp; \" WHERE ([Mitigation ID] = \" &amp; Me.[Mitigation ID].Value &amp; \")\" _\n           &amp; \" AND ([Control ID] = '\" &amp; Me.[Text55].Value &amp; \"')\"\n\ndbNewInitiatives.Execute strSQL, dbFailOnError\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7331521, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d1d3d80d211517f36d292e4efbc3dca9?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/7331521/william"}, "edited": false, "score": 0, "creation_date": 1491485629, "post_id": 43246110, "comment_id": 73582097, "body": "[New Control IDs].[ID] is a unique key on that table. I am looking to delete the record from [New Control IDs] where [New Control IDs].[Mitigation ID] and [New Control IDs].[Control ID] match [Mitigations].[Mitigation ID] and [Mitigations].[Text55] respectively. Trying your suggestion above produced the same run-time error that Parfait&#39;s suggest did. &quot;Too few parameters. Expected 2.&quot;"}], "tags": [], "owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "is_accepted": false, "score": 0, "last_activity_date": 1491455097, "creation_date": 1491455097, "answer_id": 43246110, "question_id": 43241791, "link": "https://stackoverflow.com/questions/43241791/delete-record-from-table-in-access/43246110#43246110", "title": "Delete record from table in Access", "body": "<p>Definitely consider Parfait's answer, but it is always good to understand what the problem was in the first place.  To me it looks like the logic in your loop is probably incorrect.</p>\n\n<p>Unless you provide more detail, I'll first assume that [New Control IDs].[ID] is a unique key on that table.  If that is the case, then you are storing that unique ID in the variable strID but then moving to the next record before actually attempting to delete the record.  In this case, the If statement in the loop will <strong>always be false</strong> since the current record's [ID] would not equal the previous record's [ID] value.</p>\n\n<pre><code>...\nDo While Not rstMitigations.EOF\n    '* This compares the previous row's [ID] with the current row's [ID]  '\n    If rstMitigations![ID] = strID Then\n        rstMitigations.Delete\n...\n</code></pre>\n\n<p>If the [ID] values are <em>not unique</em>, then your code would only delete subsequent rows that matched the first in a series of identical [ID] values.  It would leave the first row of each unique [ID] value untouched (i.e. not deleted). If there is only one of a particular [ID] value, that row will never be deleted.  Is that what you want?</p>\n\n<p>Notice that Parfait's action query will delete all of the same records returned by your SELECT query.  Just for the record, to accomplish this with the recordset, just simplify it to be</p>\n\n<pre><code>....\nSet dbNewInitiatives = CurrentDb\nstrSQL = \"SELECT * FROM [New Control IDs] WHERE ([Mitigation ID] = \" _\n        &amp; Me.[Mitigation ID].Value &amp; \") AND ([Control ID] = \" _\n        &amp; Me.[Text55].Value &amp; \") ORDER BY [ID]\"\nSet rstMitigations = dbNewInitiatives.OpenRecordset(strSQL, dbOpenDynaset)\n\nDo While Not rstMitigations.EOF\n    rstMitigations.Delete\n    rstMitigations.MoveNext\nLoop\n....\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7331521, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d1d3d80d211517f36d292e4efbc3dca9?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/7331521/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14829, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1491500758, "creation_date": 1491427029, "last_edit_date": 1491497681, "question_id": 43241791, "link": "https://stackoverflow.com/questions/43241791/delete-record-from-table-in-access", "title": "Delete record from table in Access", "body": "<p>I am working with two tables <em>Mitigations</em> and <em>New Control IDs</em> in an Access database. The <em>Mitigations</em> table has a form. As part of that form, a control <em>ID</em> can be added to the <em>New Control IDs</em> table. My code for that works fine. I am trying to add the ability to delete a record from the <em>New Control IDs</em> table via the <em>Mitigations</em> form.</p>\n\n<p>The user will enter a string in <em>Text55</em> and after updating that field, the corresponding record in the <em>New Control IDs</em> table should be deleted.</p>\n\n<p>Here is the code I have for that:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Text55_AfterUpdate()\n\n'removing record with Archer Control ID from New Control IDs table\nDim dbNewInitiatives As DAO.Database\nDim rstMitigations As DAO.Recordset\nDim strSQL As String\n\n    Set dbNewInitiatives = CurrentDb\n    strSQL = \"SELECT * FROM [New Control IDs] WHERE ([Mitigation ID] = \" &amp; Me.[Mitigation ID].Value &amp; \") AND ([Archer Control ID] = '\" &amp; Me.[Text55].Value &amp; \"') ORDER BY [ID]\"\n    Set rstMitigations = dbNewInitiatives.OpenRecordset(strSQL, dbOpenDynaset)\n\n    Do While Not rstMitigations.EOF\n        rstMitigations.Delete\n        rstMitigations.MoveNext\n    Loop\n\nrstMitigations.Close\n\nSet rstMitigations = Nothing\nSet dbNewInitiatives = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The above code successfully finds all of the records in <em>New Control IDs</em> table that meet the criteria and deletes them. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1491424633, "post_id": 43241058, "comment_id": 73552451, "body": "You need to fully qualify all uses of a range. See how you did <code>Data.Range(...)</code>? Do the same with <code>Cells</code>. I.e. <code>Data.Range(Data.Cells(x + 2, 1), Data.Cells(x + a, 3)).Copy</code>.  And in your <code>With</code> statement, you need to add the <code>.</code> before <code>Cells</code>"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1491425736, "post_id": 43241403, "comment_id": 73553078, "body": "The <code>Worksheets.Add</code> line always makes the newly-added sheet the Activesheet - there&#39;s nothing in the code which would switch to another sheet, so that would explain why it never fails if the Topline sheet needs to be added,"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491430319, "post_id": 43241403, "comment_id": 73555105, "body": "Right. I had that backward. Thanks for the correction."}, {"owner": {"reputation": 23, "user_id": 7822971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/910f491c1b359250d80e88d8ca39c098?s=128&d=identicon&r=PG&f=1", "display_name": "Erick M-J", "link": "https://stackoverflow.com/users/7822971/erick-m-j"}, "edited": false, "score": 0, "creation_date": 1491481780, "post_id": 43241403, "comment_id": 73579068, "body": "I knew it was something exceptionally simple. I&#39;ve added the Topline. qualifier to the relevant cell references and it&#39;s working like a charm now. Thank you very much."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 2, "last_activity_date": 1491425469, "creation_date": 1491425469, "answer_id": 43241403, "question_id": 43241058, "link": "https://stackoverflow.com/questions/43241058/vba-cannot-refer-to-range-in-sheet-that-exists-prior-to-code/43241403#43241403", "title": "VBA Cannot Refer To Range In Sheet That Exists Prior To Code", "body": "<p>The problem is that you have unqualified Range references. When you refer to any Range object without first specifying the worksheet, it's unqualified. Those references follow rules behind the scenes and use objects with underscores in them. So you might get errors referring to <code>_Worksheets</code> or <code>_Global</code>.</p>\n\n<p>An unqualified reference in a sheet's class module will refer to that sheet. All other unqualified references (ThisWorkbook, standard module, userform) will refer to the Activesheet. This</p>\n\n<pre><code>With Topline\n    .Range(Cells(1, 1), Cells(7, 3)).Interior.Color = RGB(100, 100, 100)\nEnd With\n</code></pre>\n\n<p>is like saying</p>\n\n<pre><code>Topline.Range(Activesheet.Cells(1, 1), Activesheet.Cells(7, 3)).Interior.Color = RGB(100, 100, 100)\n</code></pre>\n\n<p>Since there is not range on Topline that includes cells from the Activesheet, you get an error.</p>\n\n<p>Why does it happen when a sheet already exists? Probably because while troubleshooting your code you went to the UI, created the sheet, then back to the code to run it. You left that newly created Topline sheet active and when Topline and Activesheet are the same thing, no error.</p>\n"}, {"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1555331135, "post_id": 43241458, "comment_id": 98061244, "body": "Did not Downvote, but the first half of this answer is <b><i>wrong</i></b>.  <code>Range</code> <i>does</i> accept another <code>Range</code> as arguments, not just an address string.  <code>Range(Cells(1,1),Cells(2,2))</code> is perfectly valid, and is the same as <code>Range(&quot;A1&quot;,&quot;B2&quot;)</code> or <code>Range(&quot;A1:B2&quot;)</code>.  The second half is only quarter-right:  the <i>fully qualified</i> reference would be <code>Data.Range(Data.Cells(x + 2, 1), Data.Cells(x + a, 3)).Copy</code> or <code>.Range(.Cells(x + 2, 1), .Cells(x + a, 3)).Copy</code> - you need to define the Worksheet for the <code>Cells</code> as well as the <code>Range</code>, but within a <code>With Data</code> you only need the <code>.</code> and not <code>Data.</code>"}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": -1, "last_activity_date": 1491425749, "creation_date": 1491425749, "answer_id": 43241458, "question_id": 43241058, "link": "https://stackoverflow.com/questions/43241058/vba-cannot-refer-to-range-in-sheet-that-exists-prior-to-code/43241458#43241458", "title": "VBA Cannot Refer To Range In Sheet That Exists Prior To Code", "body": "<p>The first issue was at:-</p>\n\n<pre><code>.Range(Cells(1, 1), Cells(7, 3)).Interior.Color = RGB(100, 100, 100)\n</code></pre>\n\n<p>And the issue was that <code>Cells(1, 1)</code> returns a range but <code>.Range(x, y)</code> expects just an address, i.e. <code>Cells(1,1).AddressLocal</code>.</p>\n\n<p>If you amend all your: - </p>\n\n<pre><code>.Range(Cells(x, y), Cells(x, y))\n</code></pre>\n\n<p>entries to: - </p>\n\n<pre><code>    .Range(Cells(x, y).AddressLocal, Cells(x, y).AddressLocal))\n</code></pre>\n\n<p>You should get closer to a working answer. I came to another issue at:-</p>\n\n<pre><code>Data.Range(Cells(x + 2, 1).AddressLocal, Cells(x + a, 3).AddressLocal).Copy\n</code></pre>\n\n<p>But I believe this is a separate issue caused by only getting a snippet of code or lack of option explicit with definition over <code>x</code> and <code>a</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 7822971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/910f491c1b359250d80e88d8ca39c098?s=128&d=identicon&r=PG&f=1", "display_name": "Erick M-J", "link": "https://stackoverflow.com/users/7822971/erick-m-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 43241403, "answer_count": 2, "score": 2, "last_activity_date": 1491433270, "creation_date": 1491424265, "last_edit_date": 1491433270, "question_id": 43241058, "link": "https://stackoverflow.com/questions/43241058/vba-cannot-refer-to-range-in-sheet-that-exists-prior-to-code", "title": "VBA Cannot Refer To Range In Sheet That Exists Prior To Code", "body": "<p>I am currently building some code that creates a bunch of formatted data in one worksheet, the active worksheet, then transfers that data to a new worksheet.</p>\n\n<p>The problem is that when I try to specify the sheets by name, it doesn't work if the sheet existed prior to the code running. </p>\n\n<p>So, in the code below, I get the error \"'Range' of obect '_Worksheet' failed\" at the line \".Range(Cells(1,1), Cells(7,3)).Interior.Color = RGB(100,100,100)\" only if the \"Topline\" worksheet existed before running the code. If I delete the worksheet and let the code add and name the \"Topline\" worksheet, I get the same error but at line \"Data.Range(Cells(x + 2, 1), Cells(x + a, 3)).Copy\"</p>\n\n<p>I've tried googling around but am completely at a loss for why this code only works on worksheets that didn't exist before running it. Any help is greatly appreciated. I'm almost willing to bet the answer is something obvious.</p>\n\n<p>Here's the code that's troubling me:</p>\n\n<pre><code>For i = 1 To Worksheets.Count\n    If Worksheets(i).Name = \"Topline\" Then TE = True\n    If Worksheets(i).Name = \"Data\" Then DE = True\nNext i\n\nIf TE = False Then Worksheets.Add(After:=Worksheets(1)).Name = \"Topline\"\nIf DE = False Then ActiveSheet.Name = \"Data\"\n\nFor i = 1 To Worksheets.Count\n    If Worksheets(i).Name = \"Topline\" Then Set Topline = Worksheets(i)\n    If Worksheets(i).Name = \"Data\" Then Set Data = Worksheets(i)\nNext i\n\nWith Topline\n    .Range(Cells(1, 1), Cells(7, 3)).Interior.Color = RGB(100, 100, 100)\n    With .Range(Cells(3, 1), Cells(3, 3))\n        .Merge\n        .Font.Bold = True\n        .Value = \"Total\"\n    End With\n    With .Range(Cells(4, 2), Cells(5, 3))\n        .Font.Bold = True\n    End With\n    .Cells(1, 1) = \"Topline\"\n    .Cells(1, 1).Font.Bold = True\n    .Cells(4, 2) = \"Count\"\n    .Cells(4, 3) = \"Percent\"\nEnd With\n\nData.Range(Cells(x + 2, 1), Cells(x + a, 3)).Copy\nTopline.Range(Cells(8, 1), Cells(a + 6, 3)).PasteSpecial (xlPasteAll)\n</code></pre>\n"}, {"tags": ["excel", "csv", "import", "vba"], "comments": [{"owner": {"reputation": 35, "user_id": 2634391, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cc7b64a3651243b26d3b83a43a22c138?s=128&d=identicon&r=PG&f=1", "display_name": "Dreamwatcher", "link": "https://stackoverflow.com/users/2634391/dreamwatcher"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491423369, "post_id": 43240765, "comment_id": 73551805, "body": "using the import function of excel, but i am open to any solution"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 1, "creation_date": 1491423527, "post_id": 43240765, "comment_id": 73551889, "body": "You can try Find/Replace <code>,Name: </code> with <code>,[New Line]Name: </code>"}, {"owner": {"reputation": 35, "user_id": 2634391, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cc7b64a3651243b26d3b83a43a22c138?s=128&d=identicon&r=PG&f=1", "display_name": "Dreamwatcher", "link": "https://stackoverflow.com/users/2634391/dreamwatcher"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491423585, "post_id": 43240765, "comment_id": 73551921, "body": "i am really inexperience with VBA"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 1, "creation_date": 1491423610, "post_id": 43240765, "comment_id": 73551936, "body": "No problem - just find/replace <code>,Name:</code> with a new line before <code>Name:</code> and it brings it over correctly"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491423652, "post_id": 43240765, "comment_id": 73551957, "body": "Then you can use Text to Columns (in the Data tab), with a comma delimiter, to separate everything without VBA.  That should help get you started"}], "answers": [{"tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 1, "last_activity_date": 1491424916, "creation_date": 1491424916, "answer_id": 43241247, "question_id": 43240765, "link": "https://stackoverflow.com/questions/43240765/how-to-signal-a-new-row-using-delimiters-in-a-text-file-that-will-be-imported-in/43241247#43241247", "title": "How to signal a new row using delimiters in a text file that will be imported in excel after", "body": "<p>As I said in my comments, you can replace <code>,Name:</code> with <code>\\nName:</code> (new line/carriage return).</p>\n\n<p>This is very easy to do in Notepad++ (a free program)</p>\n\n<p><a href=\"https://notepad-plus-plus.org/\" rel=\"nofollow noreferrer\">https://notepad-plus-plus.org/</a></p>\n\n<p>Make sure you set the <code>Search Mode</code> to <code>Extended</code></p>\n\n<p>Use Find: <code>,Name:</code></p>\n\n<p>Replace With: <code>\\nName:</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/jRXXI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jRXXI.png\" alt=\"Demo\"></a></p>\n\n<p>It comes over looking like this when you set it to <code>Delimited</code> using <code>Comma</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/9cKCT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9cKCT.png\" alt=\"Demo2\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1491427090, "creation_date": 1491427090, "answer_id": 43241800, "question_id": 43240765, "link": "https://stackoverflow.com/questions/43240765/how-to-signal-a-new-row-using-delimiters-in-a-text-file-that-will-be-imported-in/43241800#43241800", "title": "How to signal a new row using delimiters in a text file that will be imported in excel after", "body": "<ul>\n<li>Open a new blank workbook.</li>\n<li>Click the Sheet1 name tab and choose <strong>View Code</strong>.</li>\n<li>When the VBE opens, paste the following into the code sheet titled <em>Sheet1 (Code)</em>.</li>\n</ul>\n\n<blockquote>\n  <p>\u00a0\u00a0Code:</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Parent.UsedRange.Cells.Count = 1 And _\n       Target.Cells.Count = 1 And _\n       Target.Address(0, 0) = \"A1\" Then\n        On Error GoTo safe_exit\n        Application.EnableEvents = False\n        Dim a As Long, b As Long, arr1 As Variant, arr2 As Variant, hdr As Variant, tmp As Variant\n        arr1 = Split(Replace(Target.Value2, \",Name:\", vbLf &amp; \"Name:\"), vbLf)\n        For a = LBound(arr1) To UBound(arr1)\n            arr2 = Split(arr1(a), Chr(44))\n            For b = LBound(arr2) To UBound(arr2)\n                tmp = Split(arr2(b), Chr(58))\n                hdr = Application.Match(tmp(0), Rows(1), 0)\n                If IsError(hdr) Then\n                    Cells(1, Columns.Count).End(xlToLeft).Offset(0, 1) = tmp(0)\n                    hdr = Application.Match(tmp(0), Rows(1), 0)\n                End If\n                Cells(2 + a, hdr) = tmp(1)\n            Next b\n        Next a\n        Columns(1).EntireColumn.Delete\n    End If\n\nsafe_exit:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>\u00a0\u00a0\n - Tap Ctrl+Q to return to your new, blank worksheet.\n - Open the TXT file in notepad or some other text editor and copy the whole thing.\n - Go back to your new, blank Sheet1 and paste the text into A1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/k6WGA.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k6WGA.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 35, "user_id": 2634391, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cc7b64a3651243b26d3b83a43a22c138?s=128&d=identicon&r=PG&f=1", "display_name": "Dreamwatcher", "link": "https://stackoverflow.com/users/2634391/dreamwatcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 43241800, "answer_count": 2, "score": 1, "last_activity_date": 1491428110, "creation_date": 1491423129, "last_edit_date": 1531161705, "question_id": 43240765, "link": "https://stackoverflow.com/questions/43240765/how-to-signal-a-new-row-using-delimiters-in-a-text-file-that-will-be-imported-in", "title": "How to signal a new row using delimiters in a text file that will be imported in excel after", "body": "<p>for the following text format from a text file:</p>\n\n<blockquote>\n  <p>Name: Test1,Email: Test1@email.com,Phone: 81273807,Age: 22,Gender:\n  Male,Name: Test2,Email: Test2@email.com,Phone: 81453807,Age:\n  32,Gender: Female..... etc</p>\n</blockquote>\n\n<p>Id like to import in excel so that it looks like this:</p>\n\n<pre><code>&gt; Name  |    Email        |  Phone   |  Age |  Gender |\n&gt; Test1 | Test1@email.com | 81273807 |  22  |  Male   | \n&gt; Test2 | Test2@email.com | 81453807 |  32  |  Female | \n&gt; etc\n</code></pre>\n\n<p>is there anyway to do this by formatting the text file in a certain way ? can VBA be avoided ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491421569, "post_id": 43239800, "comment_id": 73550740, "body": "Do you have some test data I can try it with? I wrote a <code>VLOOKUP</code> function that uses Levenshtein distance and lets you use a percentage match parameter instead of the standard true/false parameter. <a href=\"http://stackoverflow.com/a/30903011/1274820\">stackoverflow.com/a/30903011/1274820</a>"}, {"owner": {"reputation": 131, "user_id": 2917409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ea9d4c8f990fb53df031c6e3dbafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Sol_Kralj", "link": "https://stackoverflow.com/users/2917409/sol-kralj"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491422535, "post_id": 43239800, "comment_id": 73551288, "body": "I do have test data, but I&#39;m unable to share. I would need to put together a set of dummy test data. I used the following Levenshtein Distance Function (reworked for VBA) and did not have good results: <a href=\"https://bytes.com/topic/access/insights/909002-levenshtein-approximate-string-matching\" rel=\"nofollow noreferrer\">bytes.com/topic/access/insights/&hellip;</a>"}], "owner": {"reputation": 131, "user_id": 2917409, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ea9d4c8f990fb53df031c6e3dbafd2?s=128&d=identicon&r=PG&f=1", "display_name": "Sol_Kralj", "link": "https://stackoverflow.com/users/2917409/sol-kralj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1148, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1491419770, "creation_date": 1491419770, "last_edit_date": 1531161705, "question_id": 43239800, "link": "https://stackoverflow.com/questions/43239800/excel-vba-weighted-jaccard-similarity-fuzzy-lookup", "title": "Excel VBA: Weighted Jaccard Similarity (Fuzzy Lookup)", "body": "<p>Currently, I'm working on a project that involves a lot of data clean-up and combining like data.</p>\n\n<p>The data I'm working with includes an Account Name and Address Information (Address 1, Address 2, City, State, Zip Code). I've been using the Excel Fuzzy Lookup Add-In to locate like records greater than or equal to a 90% Similarity Threshold. I'm ready to move forward with automating my process, but, unfortunately, there isn't any way to access the Add-In via VBA.</p>\n\n<p>I've found a number of different functions (Weighted Damerlau-Levenshtein, Jaro-Winkler Similarity, etc), but none of them seem to be as accurate as the Microsoft Add-In. Since the Add-In uses Weighted Jaccard Similarity, I'm wondering if anyone has found or developed a function to accomplish this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1491419509, "post_id": 43239660, "comment_id": 73549544, "body": "It is taking so long because you are looping through every row, all 1 Million +,  That is over 17 million loops.  That will take some time,  Find the last row with data on each sheet and loop to that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1491419528, "post_id": 43239660, "comment_id": 73549558, "body": "You get that you are writing and rewriting <code>&quot;233&quot;</code> into the same cell on the last worksheet evertime, right?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1491419951, "post_id": 43239660, "comment_id": 73549802, "body": "You also have <code>Rows.Count</code>, which is unqualified. It&#39;s only counting the rows on the active sheet. You need to qualify that, and <code>Cells()</code> later, with <code>WS</code>, i.e. <code>For A = 1 to WS.Rows.Count</code>, and <code>...Left(WS.Cells(A,33),...</code>"}, {"owner": {"reputation": 33, "user_id": 7822665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7933c7ba771264283715b0c03e37a76?s=128&d=identicon&r=PG&f=1", "display_name": "Tato", "link": "https://stackoverflow.com/users/7822665/tato"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491514160, "post_id": 43239660, "comment_id": 73600713, "body": "@BruceWayne Adding WS in Rows and Cells fixed it! I can&#39;t believe I missed that. Thank you so much, man!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7822665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7933c7ba771264283715b0c03e37a76?s=128&d=identicon&r=PG&f=1", "display_name": "Tato", "link": "https://stackoverflow.com/users/7822665/tato"}, "edited": false, "score": 0, "creation_date": 1491514259, "post_id": 43239842, "comment_id": 73600753, "body": "Don&#39;t worry about the 233, let me worry about the 233. And I&#39;ll try this method as well, you avoid using one extra variable, which is great for future reference. Thanks, man."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1491419906, "creation_date": 1491419906, "answer_id": 43239842, "question_id": 43239660, "link": "https://stackoverflow.com/questions/43239660/search-for-specific-string-in-an-excel-workbook/43239842#43239842", "title": "Search for specific string in an Excel Workbook", "body": "<p>Use a With ... End With to focus the parent worksheet for each iteration of the loop.</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n    Dim a As Long, Coniburo As String, ws As Worksheet\n\n    Coniburo = \"My String\"\n\n    For Each ws In Worksheets\n        With ws\n            For a = 1 To .Cells(.Rows.Count, \"C\").End(xlUp).Row\n                If CBool(InStr(Left(.Cells(a, 3), 100), Coniburo, vbTextCompare)) Then\n                    Worksheets(\"Last Sheet\").Cells(21, 2).Value = 233\n                End If\n            Next a\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>You need to prefix Rows, Range and Cells calls with a period like <code>.Rows...</code> or <code>.Range(...)</code> or <code>.Cells(...)</code> when inside a With ... End With block. This identifies them with the parent worksheet described by the With .. End With.</p>\n\n<p>I also made the comparison case-insensitive with <code>vbTextCompare</code>.</p>\n\n<p>There is the remaining problem of writing and rewriting 233 into the same cell on the same worksheet but that is another matter.</p>\n"}, {"tags": [], "owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "is_accepted": false, "score": 1, "last_activity_date": 1491424340, "creation_date": 1491424340, "answer_id": 43241085, "question_id": 43239660, "link": "https://stackoverflow.com/questions/43239660/search-for-specific-string-in-an-excel-workbook/43241085#43241085", "title": "Search for specific string in an Excel Workbook", "body": "<p>I've bent the rules a little here but I want to show how we could use the built in FIND function to speed things up dramatically. Simply, we'll work through each sheet within column C only; we'll use the FIND function to find the ROW number where column C contains your search string.... then we'll double-check that cell to see if your search string is within the first 100 characters, per your requirement. If it is, we'll consider that a match. In addition to your result of logging \"233\" into the sheet \"Last Page\" I've included some bright green highlighting just to help see what's going on...</p>\n\n<pre><code>Sub findConiburo()\n    Coniburo = \"My String\"\n    For Each ws In Worksheets\n        With ws.Range(\"C:C\")\n            myName = ws.Name 'useful for debugging\n\n            queue = 1 'will be used to queue the FIND function\n\n            x = 0 'loop counter\n\n            Do 'loop to find multiple results per sheet\n\n                On Error Resume Next 'Disable error handling\n\n                'FIND Coniburo within ws column C, log row number:\n                'Note \".Cells(queue, 1)\" is a relative reference to the current WS, column C\n                foundRow = .Find(What:=Coniburo, After:=.Cells(queue, 1), LookIn:=xlFormulas, LookAt _\n                    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n                    False, SearchFormat:=False).Row\n\n                'If no result found then an error number is stored. Perform error handling:\n                If Err.Number &lt;&gt; 0 Then\n                    'No results found, don't do anything, exit DO to skip to next sheet:\n                    Exit Do\n                End If\n                On Error GoTo 0 'Re-enable error handling\n\n                If x = 0 Then\n                    'first loop - log the first row result:\n                    originalFoundRow = foundRow\n                ElseIf foundRow = originalFoundRow Then\n                    'Not the first loop. Same result as original loop = we're back at the start, so exit loop:\n                    Exit Do\n                End If\n\n                'Update queue so next loop will search AFTER the previous result:\n                queue = foundRow\n\n                'check if the string is not only SOMEWHERE in the cell,\n                'but specifically within the first 100 characters:\n                ToCompare = Left(.Cells(foundRow, 1), 100)\n                If InStr(ToCompare, Coniburo) &gt; 0 Then\n                    .Cells(foundRow, 1).Interior.ColorIndex = 4 'highlight green\n                    Sheets(\"Last Sheet\").Cells(21, 2).Value = \"233\"\n                End If\n\n                'Update loop counter:\n                x = x + 1\n            Loop\n        End With\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7822665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7933c7ba771264283715b0c03e37a76?s=128&d=identicon&r=PG&f=1", "display_name": "Tato", "link": "https://stackoverflow.com/users/7822665/tato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 43239842, "answer_count": 2, "score": 3, "last_activity_date": 1491424340, "creation_date": 1491419281, "last_edit_date": 1491419600, "question_id": 43239660, "link": "https://stackoverflow.com/questions/43239660/search-for-specific-string-in-an-excel-workbook", "title": "Search for specific string in an Excel Workbook", "body": "<p>So, I need to make an Excel Macro in VBA that will search for a string, then compare it with a pre-set string of my choice and then change the value of a cell in another Sheet.</p>\n\n<p>It goes like this:</p>\n\n<pre><code>Sub Macro1()\n\nDim A As Integer\nDim WS As Worksheet\n\nDim ToCompare, Coniburo As String\n\nConiburo = \"My String\"\n\nFor Each WS In Worksheets\n    For A = 1 To Rows.Count\n    ToCompare = Left(Cells(A, 3), 100)\n        If InStr(ToCompare, Coniburo) &gt; 0 Then\n            Sheets(\"Last Sheet\").Cells(21, 2).Value = \"233\"\n        End If\n    Next A\nNext\n</code></pre>\n\n<p>The macro works....... If I remove the first For (the one that search through sheets) and as long as I'm in a sheet where \"My string\" is present. Otherwise, it doesn't work. It takes a long time to process, over a minute since there are 17 sheets.</p>\n\n<p>Why isn't working? I read a lot of posts here, the Microsoft Dev forum, a site called Tech on the Net, and still there is something I'm missing, but I don't know why.</p>\n\n<p>Can anybody point me in the right direction?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 3, "creation_date": 1491418966, "post_id": 43239519, "comment_id": 73549222, "body": "Try doing &#39;Debug.Print ThisWorkbook.Worksheets.Count&#39; to make sure there is more than one worksheet. &#39;ThisWorkbook&#39; refers to the workbook that the code is in, not the activeworkbook."}, {"owner": {"reputation": 11, "user_id": 7822533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48e5747caed5e0985acaca45e0589958?s=128&d=identicon&r=PG&f=1", "display_name": "Anon95366", "link": "https://stackoverflow.com/users/7822533/anon95366"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491420529, "post_id": 43239519, "comment_id": 73550134, "body": "So this got me thinking and I changed ThisWorkbook.Worksheets to ActiveWorkbook.Worksheets in the code and it seems to run fine now.  Thanks!"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491420781, "post_id": 43239519, "comment_id": 73550279, "body": "Did that fix the problem? Keep in mind though that ActiveWorkbook and ActiveWorksheet (as well as Activate, Select, Selection) should all be avoided where possible (and rarely is there a case where you can&#39;t replace these items with a more robust solution). If you are just doing this as a temporary thing then that&#39;s fine, but if youre going to be using this macro in a more consistent sense I would recommend learning how to avoid the above noted items."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1491421093, "post_id": 43239519, "comment_id": 73550462, "body": "I&#39;m curious what the selection.autofilter does?  Does it just add dropdown lists on the top row?"}, {"owner": {"reputation": 11, "user_id": 7822533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48e5747caed5e0985acaca45e0589958?s=128&d=identicon&r=PG&f=1", "display_name": "Anon95366", "link": "https://stackoverflow.com/users/7822533/anon95366"}, "edited": false, "score": 0, "creation_date": 1491423043, "post_id": 43239519, "comment_id": 73551602, "body": "Brandon - Yes, that seemed to fix the problem... This is just a fragment of a macro that I will be using on a monthly basis. I&#39;ll certainly have to learn more in order to avoid such scenarios."}, {"owner": {"reputation": 11, "user_id": 7822533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48e5747caed5e0985acaca45e0589958?s=128&d=identicon&r=PG&f=1", "display_name": "Anon95366", "link": "https://stackoverflow.com/users/7822533/anon95366"}, "edited": false, "score": 0, "creation_date": 1491423088, "post_id": 43239519, "comment_id": 73551629, "body": "John - yeah, it simply applies a filter to the selected columns"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6872596, "user_type": "registered", "profile_image": "https://graph.facebook.com/10101169500144589/picture?type=large", "display_name": "Dustin Greelis", "link": "https://stackoverflow.com/users/6872596/dustin-greelis"}, "is_accepted": false, "score": 0, "last_activity_date": 1491420453, "creation_date": 1491420453, "answer_id": 43239997, "question_id": 43239519, "link": "https://stackoverflow.com/questions/43239519/excel-vba-will-not-loop-through-worksheets-exclude-worksheet/43239997#43239997", "title": "Excel VBA will not loop through worksheets (Exclude Worksheet)", "body": "<p>I created a dataset to test this out and found that the code worked just fine.  So it must be something related to your specific data/worksheets.  I would see if 2 sheets works, or try making a smaller sample on another workbook and see if it works.  Sorry I'm not more helpful.  </p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1499824333, "creation_date": 1499824333, "answer_id": 45047046, "question_id": 43239519, "link": "https://stackoverflow.com/questions/43239519/excel-vba-will-not-loop-through-worksheets-exclude-worksheet/45047046#45047046", "title": "Excel VBA will not loop through worksheets (Exclude Worksheet)", "body": "<p>Consider this approach.</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet\n\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Sheet1\" Then\n            With ws.UsedRange\n                .Resize(.Rows.Count-1).Offset(1, 0).ClearContents\n            End With\n        End If\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7822533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48e5747caed5e0985acaca45e0589958?s=128&d=identicon&r=PG&f=1", "display_name": "Anon95366", "link": "https://stackoverflow.com/users/7822533/anon95366"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 475, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1499824333, "creation_date": 1491418816, "last_edit_date": 1531164843, "question_id": 43239519, "link": "https://stackoverflow.com/questions/43239519/excel-vba-will-not-loop-through-worksheets-exclude-worksheet", "title": "Excel VBA will not loop through worksheets (Exclude Worksheet)", "body": "<p>The macro appears to loops through all of the worksheets fine now.  However, is there a way that I can make it so the macro does not get applied to a specific worksheet in my workbook, but does get applied to all other worksheets?</p>\n\n<pre><code>Sub FormatSheet()\n\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    ws.Activate\n        Columns(\"A:J\").Select\n        Selection.AutoFilter\n        Columns(\"A:J\").EntireColumn.AutoFit\n        With Selection\n            .HorizontalAlignment = xlCenter\n        End With\n        With ActiveWindow\n            .SplitColumn = 0\n            .SplitRow = 1\n        End With\n        ActiveWindow.FreezePanes = True\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2847, "user_id": 382588, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f52bc4ad81523f13d2275097f925a367?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/382588/asaf"}, "edited": false, "score": 0, "creation_date": 1491419613, "post_id": 43239512, "comment_id": 73549606, "body": "try to put this query in access as a view and than query the new view from vba"}, {"owner": {"reputation": 23, "user_id": 6767464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/01q1c.jpg?s=128&g=1", "display_name": "Humberto Faria", "link": "https://stackoverflow.com/users/6767464/humberto-faria"}, "reply_to_user": {"reputation": 2847, "user_id": 382588, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f52bc4ad81523f13d2275097f925a367?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/382588/asaf"}, "edited": false, "score": 0, "creation_date": 1491420140, "post_id": 43239512, "comment_id": 73549904, "body": "I use a field in the form to make the &quot;select&quot;. Even if I put the query in access can I continue using the form field to make the &quot;select&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6767464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/01q1c.jpg?s=128&g=1", "display_name": "Humberto Faria", "link": "https://stackoverflow.com/users/6767464/humberto-faria"}, "edited": false, "score": 1, "creation_date": 1491484568, "post_id": 43240289, "comment_id": 73581279, "body": "Your answer helped me a lot. Excel can&#39;t accepted the sql statement. Gives me an error on FROM clause. I searched in the web and I found it another sql statement that works fine with the code.  sql = &quot;SELECT * INTO [Excel 12.0;Database=&quot; &amp; path_To_XLSX &amp; &quot;].&quot; &amp; name_of_sheet &amp; &quot; FROM controle WHERE BP = &#39;&quot; &amp; controlectform.nmbpbox.Value &amp; &quot;&#39;;&quot; Thank you very much."}, {"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "reply_to_user": {"reputation": 23, "user_id": 6767464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/01q1c.jpg?s=128&g=1", "display_name": "Humberto Faria", "link": "https://stackoverflow.com/users/6767464/humberto-faria"}, "edited": false, "score": 0, "creation_date": 1491487823, "post_id": 43240289, "comment_id": 73583926, "body": "I had INTO twice.  Will edit my answer with your fix.  Glad this is helping!"}], "tags": [], "owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1491487847, "last_edit_date": 1491487847, "creation_date": 1491421465, "answer_id": 43240289, "question_id": 43239512, "link": "https://stackoverflow.com/questions/43239512/how-to-export-sql-statement-results-to-an-excel-file/43240289#43240289", "title": "How to export SQL statement results to an Excel File", "body": "<p>I don't believe Access supports the OPENROWSET, dynamic table you're working with there.  I have a lot of old projects that do this though, so here's my method</p>\n\n<pre><code>Public Function Relatorio()\n\n    Dim sql As String\n    Dim cn  As ADODB.Connection\n    Dim rs  As ADODB.Recordset\n    Dim rel As String\n\n\n    Set cn = New ADODB.Connection\n\n    cn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; enderecoDB &amp; \";Jet OLEDB:Database\"\n\n    cn.Open\n\n    Set rs = New ADODB.Recordset\n\n    dim path_To_XLSX\n    dim name_of_sheet\n    path_To_XLSX = \"c:\\temp\\output.xlsx\"\n    name_of_sheet = \"Planilha1\"\n    sql = sql = \"SELECT * INTO [Excel 12.0;Database=\" &amp; path_To_XLSX &amp; \"].\" &amp; name_of_sheet &amp; \" FROM controle WHERE BP = '\" &amp; controlectform.nmbpbox.Value &amp; \"';\" \n\n    rs.Open sql, cn\n\n    'If this application is in an unsecure environment, use the following code instead!  This is to prevent a SQL injection, security concern here.\n    'As it is an Access Database, this is likely overkill for this project\n    'Create Command Object.\n    Set Cmd1 = New ADODB.Command\n    Cmd1.ActiveConnection = cn\n    cmd1.CommandText = \"SELECT * FROM controle INTO [Excel 12.0;Database=\" &amp; path_To_XLSX &amp; \"].\" &amp; name_of_sheet &amp; \" WHERE BP = ?\"\n    ' Create Parameter Object.\n    Set Param1 = Cmd1.CreateParameter(, adInteger, adParamInput, 5) 'use adVarchar for strings(versus adInteger), https://www.w3schools.com/asp/met_comm_createparameter.asp\n    Param1.Value = controlectform.nmbpbox.Value\n    Cmd1.Parameters.Append Param1\n    Set Param1 = Nothing\n    Set Rs = Cmd1.Execute()\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1491487993, "post_id": 43244305, "comment_id": 73584065, "body": "This is definitely a good way to do a parameterized query in C#, but in this case he&#39;s working within Access which uses VBA (VB6 era, not VB.NET).  I&#39;m actually just about to write one of these queries for a VB.NET app (minus the curly braces of course lol)"}, {"owner": {"reputation": 2847, "user_id": 382588, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f52bc4ad81523f13d2275097f925a367?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/382588/asaf"}, "reply_to_user": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 0, "creation_date": 1491490344, "post_id": 43244305, "comment_id": 73585980, "body": "I believe the command string is the trichy part... if i&#39;m right (not sure)... taking a c# oledb-with command function and embed this query might wotk... this is what i woyld try"}], "tags": [], "owner": {"reputation": 2847, "user_id": 382588, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f52bc4ad81523f13d2275097f925a367?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/382588/asaf"}, "is_accepted": false, "score": 0, "last_activity_date": 1491443004, "last_edit_date": 1495542339, "creation_date": 1491443004, "answer_id": 43244305, "question_id": 43239512, "link": "https://stackoverflow.com/questions/43239512/how-to-export-sql-statement-results-to-an-excel-file/43244305#43244305", "title": "How to export SQL statement results to an Excel File", "body": "<p>I had this challenge so many years ago that I cant remember but this link ring the bell. check if it help. </p>\n\n<p><a href=\"https://stackoverflow.com/a/28889774/382588\">https://stackoverflow.com/a/28889774/382588</a></p>\n\n<p>try { connw.Open(); OleDbCommand command; command = new OleDbCommand( \"Update Deliveries \" + \"SET Deliveries.EmployeeID = ?, Deliveries.FIN = ?, Deliveries.TodaysOrders = ? , connw); command.Parameters.Add(new OleDbParameter(\"@EMPID\", Convert.ToDecimal(empsplitIt[1]))); command.Parameters.Add(new OleDbParameter(\"@FIN\", truckSplit[1].ToString())); command.Parameters.Add(new OleDbParameter(\"@TodaysOrder\", \"R\")); catchReturnedRows = command.ExecuteNonQuery();//Commit connw.Close(); } catch (OleDbException exception) { MessageBox.Show(exception.Message, \"OleDb Exception\"); }</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1492174366, "creation_date": 1492174366, "answer_id": 43411912, "question_id": 43239512, "link": "https://stackoverflow.com/questions/43239512/how-to-export-sql-statement-results-to-an-excel-file/43411912#43411912", "title": "How to export SQL statement results to an Excel File", "body": "<p>you can use this, to print the actual SQL.</p>\n\n<pre><code>Private Sub Command2_Click()\n\nDim db As Database\nDim qr As QueryDef\n\nSet db = CurrentDb\n\nFor Each qr In db.QueryDefs\n  TextOut (qr.Name)\n  TextOut (qr.SQL)\n  TextOut (String(100, \"-\"))\nNext\n\nEnd Sub\n\nPublic Sub TextOut(OutputString As String)\n\n    Dim fh As Long\n\n    fh = FreeFile\n    Open \"C:\\Users\\rs17746\\Desktop\\Text_Files\\sample.txt\" For Append As fh\n    Print #fh, OutputString\n    Close fh\n\nEnd Sub\n</code></pre>\n\n<p>Here is one more version for you. This will export the results of each query, each to a separate text file.</p>\n\n<pre><code>Private Sub Command0_Click()\n\n\nDim qdf As QueryDef\nDim strFileName As String\nFor Each qdf In CurrentDb.QueryDefs\nIf Left(qdf.Name, 1) &lt;&gt; \"~\" Then\n\n'you need to figure out TransferText command. Maybe\n'you won't be lazy and expect people to read it to\n'you and tutor you on how it works.\nstrFileName = qdf.Name\n\n'Docmd.TransferText ....\nDoCmd.TransferText transferType:=acExportDelim, TableName:=strFileName, FileName:=\"C:\\test\\\" &amp; strFileName &amp; \".txt\", hasfieldnames:=True\n\nEnd If\nNext qdf\nMsgBox \"Done\"\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6767464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/01q1c.jpg?s=128&g=1", "display_name": "Humberto Faria", "link": "https://stackoverflow.com/users/6767464/humberto-faria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1461, "favorite_count": 0, "accepted_answer_id": 43240289, "answer_count": 3, "score": 2, "last_activity_date": 1593954132, "creation_date": 1491418779, "last_edit_date": 1593954132, "question_id": 43239512, "link": "https://stackoverflow.com/questions/43239512/how-to-export-sql-statement-results-to-an-excel-file", "title": "How to export SQL statement results to an Excel File", "body": "<p>I have an Access DataBase and a form in Excel VBA. All the data I input into the DB is input through the VBA form.</p>\n\n<p>This DB contains all the benefits cards we already received this year in the company. But the same employee can ask for the card twice or more, so we'll have more than one record on the DB for him. </p>\n\n<p>What I need is when the number of records is greater than one, the SQL statement result should appear in a Excel report. </p>\n\n<p>I use the <code>SELECT (*) COUNT</code> statement to know when there is more than one record that is compatible with the search criterion. But I can't make the result appear in an Excel file. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>Public Function Relatorio()\n    Dim sql As String\n    Dim cn  As ADODB.Connection\n    Dim rs  As ADODB.Recordset\n    Dim rel As String\n\n    Set cn = New ADODB.Connection\n    cn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; enderecoDB &amp; \";Jet OLEDB:Database\"\n    cn.Open\n    Set rs = New ADODB.Recordset\n    sql = \"INSERT INTO OPENROWSET('Microsoft.ACE.OLEDB.12.0', 'Excel 12.0;Database=\" &amp; enderecoDB &amp; \";', 'SELECT * FROM [Planilha1$]') SELECT * FROM controle WHERE BP = \" &amp; controlectform.nmbpbox.Value &amp; \";\"\n    rs.Open sql, cn\nEnd Function\n</code></pre>\n\n<p>When I run this code it gives me a message saying something like:</p>\n\n<blockquote>\n  <p>Can't locate the OPENROWSET Table exit</p>\n</blockquote>\n\n<p>I'm not able to install new programs, so I need to do this using only Excel VBA and the Access DB.</p>\n\n<p>How can I make this work?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1491421612, "post_id": 43239233, "comment_id": 73550769, "body": "CSV files are text files that are delimited.  &quot;Comma Separated Values&quot;.  In other words, the file would read &quot;Jerry, 528&quot; on one line, and &quot;Jane, 621&quot; on the next line, and so on and so forth.  You can think of them as cells, but they&#39;re not actually cells.  You can read them one line at a time and use a split function to put them into a small array, which allows you to search any sheet for those names.  To go through all the files, try <a href=\"http://stackoverflow.com/questions/30981601/open-all-files-with-a-partial-name-in-subfolders-vba\" title=\"open all files with a partial name in subfolders vba\">stackoverflow.com/questions/30981601/&hellip;</a>"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1491421961, "post_id": 43239233, "comment_id": 73550966, "body": "Personally I like using delimited text files to store data because it is more efficient than storing an entire Excel Spreadsheet with the data on it.  You can get as complex as you like, rows and columns per se, and use any delimiter.  I like the pipe character because it&#39;s never used.  ie &quot;John|Jerry|Jill|June|Jennifer&quot;.  You read that line into a variable &quot;aLine&quot; like &quot;Line Input #fileNum, dataLine&quot; and then aLine = split(dataLine,&quot;|&quot;).  You will have an array of 5 names.  aLine(1) = &quot;John&quot; aLine(2) = &quot;Jerry&quot; , etc."}], "owner": {"reputation": 21, "user_id": 3236992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce791c6d2efa91012c1db3f74c7f28f5?s=128&d=identicon&r=PG&f=1", "display_name": "user3236992", "link": "https://stackoverflow.com/users/3236992/user3236992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491417830, "creation_date": 1491417830, "last_edit_date": 1531164843, "question_id": 43239233, "link": "https://stackoverflow.com/questions/43239233/how-to-copy-data-from-the-contents-of-a-set-of-files-matching-a-naming-conventio", "title": "How to Copy Data from the Contents of a set of files matching a naming convention in a specified folder to their matching rows in another workbook", "body": "<p>I have a folder with many files, some ending with \"*_todaysvalues.csv\"\nThey are a simple two-cell sheet where A1 is a Name and B1 is their Score - Like:<br>\nA1: Jerry <br>\nB1: 528 <br></p>\n\n<p>I have another sheet where cell Range C16:C56 holds the names that I need to match to the A1 cell in the previous file, and I need to insert the value in the range D16:D56.</p>\n\n<p>I need to go through every file in the folder ending with \"*_todaysvalues.csv\". <br>I'm still a bit new to VBA and am at a bit of a loss as to where to start... Any guidance is <i>greatly</i> appreciated!!</p>\n"}, {"tags": ["vba", "excel", "user-defined-functions", "data-conversion"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491417384, "post_id": 43239079, "comment_id": 73548289, "body": "What is in the error window?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491417701, "post_id": 43239079, "comment_id": 73548467, "body": "Error &#39;13&#39; and the EXTRACTELEMENT function is highlighted."}], "answers": [{"comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1491418024, "post_id": 43239180, "comment_id": 73548670, "body": "But why it works on smaller quantity of datas?  And when it gets long the program just breaks?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 2, "creation_date": 1491418154, "post_id": 43239180, "comment_id": 73548731, "body": "I can only assume that when it gets long, it tries to bring the variable as a range.  Because if I switch <code>Application.Trim(Txt)</code> to <code>Application.Trim(Txt.Value)</code> it also works."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 2, "creation_date": 1491418280, "post_id": 43239180, "comment_id": 73548819, "body": "Generally speaking, any number of things could happen when you arent declaring the variables up front. When a type isn&#39;t declared a type has to be assumed. The variables all start off as &#39;Variant&#39; inputs, but then get a type assigned as the program runs. It is always best practice to declare variable types to avoid potential issues during run-time."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1491418398, "post_id": 43239180, "comment_id": 73548887, "body": "I have changed and the function is now working, thx I will just have to make some changes on the main code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1491418676, "post_id": 43239180, "comment_id": 73549058, "body": "@ScottCraner -that&#39;s what the VBE&#39;s Watch window reports."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1491417622, "creation_date": 1491417622, "answer_id": 43239180, "question_id": 43239079, "link": "https://stackoverflow.com/questions/43239079/split-function-for-long-text-fails-with-value-error/43239180#43239180", "title": "Split function for long text fails with VALUE! error", "body": "<p>You need to declare the variables, you are getting a Type mismatch, at least the first needs to be declared.</p>\n\n<pre><code>Function EXTRACTELEMENT(Txt As String, n As Long, Separator As String) As String\n EXTRACTELEMENT = Split(Application.Trim(Txt), Separator)(n - 1)\n End Function\n</code></pre>\n"}], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 1, "accepted_answer_id": 43239180, "answer_count": 1, "score": 4, "last_activity_date": 1507919825, "creation_date": 1491417276, "last_edit_date": 1507919825, "question_id": 43239079, "link": "https://stackoverflow.com/questions/43239079/split-function-for-long-text-fails-with-value-error", "title": "Split function for long text fails with VALUE! error", "body": "<p>I am using a function that i saw here on Stackoverflow:</p>\n\n<pre><code>Function EXTRACTELEMENT(Txt, n, Separator) As String\n EXTRACTELEMENT = Split(Application.Trim(Txt), Separator)(n - 1)\nEnd Function\n</code></pre>\n\n<p>It was spliting an array of data, like this: </p>\n\n<blockquote>\n  <p>sRN LMDscandata sRA LMDscandata 1 1 F97BBF 0 0 6D2A 6D2D 71F5A0FA 71F5FD85 0 0 7 0 0 1388 168 0 1 DIST1 3F800000 00000000 D9490 1388 5 6E2 6DC 6E3 6ED 6E1 0 0 0 0 0 0</p>\n</blockquote>\n\n<p>But when i tried to increase the amount of data:</p>\n\n<blockquote>\n  <p>sRN LMDscandata sRA LMDscandata 1 1 F97BBF 0 0 FCDF FCE2 9DC90606 9DC9637B 0 0 7 0 0 1388 168 0 1 DIST1 3F800000 00000000 C3500 1388 3D 525 50B 518 508 51D 50A 51A 502 514 50F 502 51C 50E 51C 50E 4FF 509 505 50B 4F9 505 51B 513 516 501 50F 509 4FE 505 508 50C 507 50C 50E 51A 511 514 528 511 519 524 52E 526 522 524 535 534 52E 527 52F 52E 53D 52F 550 535 547 548 559 551 557 558 0 0 0 0 0 0</p>\n</blockquote>\n\n<p>An error is occuring and the VBA returns an error window and no data is split. How can I fix it?</p>\n\n<p>This is the full code, I am coding it to test a sensor output, where I receive some important data in hex &amp; ascii and then transform to dec and make some graphs. This is the function that convert the values.\nIf someone can also give some tips on the Sub, I would appreciate it.</p>\n\n<pre><code>    Sub ler()\n\nDim ncell\nDim vArr, col\nDim counter, elem_end As Integer\nDim rng1, rng2 As String\n\n Set ascii = ThisWorkbook.Worksheets(\"ASCII\")\nSet medidas = ThisWorkbook.Worksheets(\"Medidas\")\n'Valor da \u00faltima linha preenchida da coluna A'\n    ncell = ascii.Range(\"A65536\").End(xlUp).Row\n    'N\u00famero de elementos'\n    elem_end = ascii.Range(\"B\" &amp; ncell).Value\n\n    For counter = 1 To elem_end\n\n    counterplus = counter + 2\n    vArr = Split(Cells(1, counterplus).Address(True, False), \"$\")\nCol_Letter = vArr(0)\n col = Col_Letter\nLet rng1 = col &amp; ncell\nLet rng2 = \"A\" &amp; ncell\n   ascii.Range(rng1).NumberFormat = \"@\"\n    ele = EXTRACTELEMENT(ascii.Range(rng2), counter, \" \")\n    ascii.Range(rng1).FormulaR1C1 = ele\n\n\n    Next\n\n\n    With ascii.Range(Cells(ncell, 1), Cells(ncell, counterplus))\n Set dist = .Find(\"DIST1\", LookIn:=xlValues)\n    If Not dist Is Nothing Then\n        firstAddress = dist.Address\n        Do\n            dist1 = firstAddress\n            Set dist = .FindNext(dist)\n        Loop While Not dist Is Nothing And dist.Address &lt;&gt; firstAddress\n    End If\nEnd With\n\n\n   data_col = ascii.Range(dist1).Column + 5\n  data_num = ascii.Cells(ncell, data_col).Value\n  dec_num = CLng(\"&amp;H\" &amp; data_num)\n  medidas.Range(\"A\" &amp; ncell).Value = dec_num\n\n  For counter2 = 1 To data_num\n  asc_value = ascii.Cells(ncell, data_col + counter2).Value\n  Dec = CLng(\"&amp;H\" &amp; asc_value)\n  medidas.Cells(ncell, counter2 + 1).Value = Dec\n\n  Next\n\n\nEnd Sub\n</code></pre>\n\n<p>In Column B, there is a function that calculates the number of elements of the data in column A</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1491417453, "post_id": 43238985, "comment_id": 73548332, "body": "Try just <code>msgbox nm.Name</code>.  The message box, as you have it, is literally showing &quot;nm.name&quot;, yeah?"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1491417708, "post_id": 43238985, "comment_id": 73548471, "body": "You may want &#39;ActiveSheet&#39; and not &#39;ActiveSheets&#39; as well."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491418730, "post_id": 43238985, "comment_id": 73549096, "body": "You need to use <code>ActiveWorkbook.Names</code> and drop the quotes as others have said"}, {"owner": {"reputation": 339, "user_id": 7729135, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cc2fe7ece9c05a23f2427a1e2d5fcfb3?s=128&d=identicon&r=PG&f=1", "display_name": "user7729135", "link": "https://stackoverflow.com/users/7729135/user7729135"}, "edited": false, "score": 0, "creation_date": 1491418878, "post_id": 43238985, "comment_id": 73549178, "body": "I tried &#39;Activesheet&#39; and remove the quotes. they don&#39;t work. and also there are other named ranges which I don&#39;t want to touch as well. hence the need to use the current sheet and not the whole workbook"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491418916, "post_id": 43238985, "comment_id": 73549201, "body": "Please see my edit - I think it will answer your question."}, {"owner": {"reputation": 339, "user_id": 7729135, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cc2fe7ece9c05a23f2427a1e2d5fcfb3?s=128&d=identicon&r=PG&f=1", "display_name": "user7729135", "link": "https://stackoverflow.com/users/7729135/user7729135"}, "edited": false, "score": 0, "creation_date": 1491419077, "post_id": 43238985, "comment_id": 73549297, "body": "your edit gives an error of run-time error &#39;1004&#39;"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491421435, "post_id": 43238985, "comment_id": 73550663, "body": "@user7729135 I tested it without issue and included a demo gif in my post. What version of excel are you using? Are you putting the code into a module? Let me know if there&#39;s anything I can do to help"}, {"owner": {"reputation": 339, "user_id": 7729135, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cc2fe7ece9c05a23f2427a1e2d5fcfb3?s=128&d=identicon&r=PG&f=1", "display_name": "user7729135", "link": "https://stackoverflow.com/users/7729135/user7729135"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491422078, "post_id": 43238985, "comment_id": 73551039, "body": "@user1274820 i tried to copy and post that whole thing in. it still gives me the error. i am using excel 2016 on windows. tried on mac as well"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491422818, "post_id": 43238985, "comment_id": 73551465, "body": "@user7729135 can u open a blank workbook, paste the code in, and run it - confirm that it works without the other code? I imagine you have something else messing it up - I can&#39;t get it to give me a <code>1004</code> error using option explicit (which would mean you need <code>Dim nm</code>) or anything else. Can you post any code that is running alongside it?"}], "answers": [{"tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 10, "last_activity_date": 1587681647, "last_edit_date": 1587681647, "creation_date": 1491417909, "answer_id": 43239251, "question_id": 43238985, "link": "https://stackoverflow.com/questions/43238985/looping-through-all-named-ranges-in-excel-vba-in-current-active-sheet/43239251#43239251", "title": "Looping through all named ranges in excel VBA in current active sheet", "body": "<p>If you only want to get names from the active worksheet, use this:</p>\n\n<pre><code>Sub Test()\nFor Each nm In ActiveWorkbook.Names\n    If nm.RefersToRange.Parent.Name = ActiveSheet.Name Then MsgBox nm.Name\nNext nm\nEnd Sub\n</code></pre>\n\n<p>^ This code will only return named ranges that refer to ranges on the active worksheet.</p>\n\n<p><code>nm.RefersToRange.Parent</code> will return the worksheet associated with the range.</p>\n\n<p>We can then retrieve its name using <code>.Name</code> and compare it to the ActiveWorksheet name.</p>\n\n<p>Here you can see I have 2 Named Ranges on <code>Sheet4</code> and 1 on <code>Sheet3</code></p>\n\n<p>When I run this code, it only returns <code>MyName1</code> and <code>MyName2</code> - it does not include <code>MyName3</code> as it is not on the active sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/YILoH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YILoH.png\" alt=\"Ranges\"></a></p>\n\n<p>This macro will only return the ones on my <code>ActiveSheet</code> (<code>Sheet4</code>)</p>\n\n<p><a href=\"https://i.stack.imgur.com/5aAN6.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5aAN6.gif\" alt=\"Names\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 4, "last_activity_date": 1491419031, "creation_date": 1491419031, "answer_id": 43239585, "question_id": 43238985, "link": "https://stackoverflow.com/questions/43238985/looping-through-all-named-ranges-in-excel-vba-in-current-active-sheet/43239585#43239585", "title": "Looping through all named ranges in excel VBA in current active sheet", "body": "<p>This macro will loop through all named ranges in your workbook.  It takes the comments above into consideration and shows how you can do things with specific ranges.</p>\n\n<pre><code>Sub nameLoop()\nDim nm\nDim wb As Workbook\nSet wb = ActiveWorkbook\nFor Each nm In wb.Names\n    If InStr(1, nm.Name, \"data\") Then\n        ' Do stuff with the named range.\n        Debug.Print nm.Name\n    End If\nNext nm\nEnd Sub\n</code></pre>\n\n<p>Note, using <code>InStr()</code> will find \"data\" <em>anywhere</em> in the name. So if you have <code>data1</code>, <code>datas1</code>, and <code>myData1</code>, it'll run the \"do stuff here\" code for all of those.  If you just want ranges <em>starting</em> with <code>data</code>, then change the <code>InStr()</code> line to: <code>If Left(nm.Name,4) = \"data\" Then</code></p>\n\n<p>Edit: You can couple this with the <code>If nm.RefersToRange.Parent.Name = ActiveSheet.Name</code>  line suggested by @user1274820 below.  (Just make the <code>If</code> statement include an <code>And</code> operator).</p>\n"}], "owner": {"reputation": 339, "user_id": 7729135, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cc2fe7ece9c05a23f2427a1e2d5fcfb3?s=128&d=identicon&r=PG&f=1", "display_name": "user7729135", "link": "https://stackoverflow.com/users/7729135/user7729135"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16325, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1605473565, "creation_date": 1491416994, "last_edit_date": 1605473565, "question_id": 43238985, "link": "https://stackoverflow.com/questions/43238985/looping-through-all-named-ranges-in-excel-vba-in-current-active-sheet", "title": "Looping through all named ranges in excel VBA in current active sheet", "body": "<p>I am looking to loop through all named ranges found in a <code>activeworksheet</code> and then do something to them. I've used the code below but it does not seem to produce anything. Also, it will be good if I can loop through named ranges that contain certain words. For example, my named ranges are named data1, data2, data3 and so on. I would only like to work on them if they contain the word data.</p>\n<pre><code>For Each nm In Activesheets.Names\n    MsgBox &quot;nm.name&quot;\nNext nm\n</code></pre>\n"}, {"tags": ["c#", "vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1491416329, "post_id": 43238687, "comment_id": 73547659, "body": "Without your code how can we help? Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>"}, {"owner": {"reputation": 21, "user_id": 7822356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X8tP5Pw-Cn8/AAAAAAAAAAI/AAAAAAAAAXo/NNgVwnTUBik/photo.jpg?sz=128", "display_name": "Arun kumar", "link": "https://stackoverflow.com/users/7822356/arun-kumar"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1491417248, "post_id": 43238687, "comment_id": 73548206, "body": "Please check now. Thanks"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491417948, "post_id": 43238687, "comment_id": 73548624, "body": "If you&#39;re automating excel on the server, that is not a good direction to take: it&#39;s really not designed to be used that way."}, {"owner": {"reputation": 21, "user_id": 7822356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X8tP5Pw-Cn8/AAAAAAAAAAI/AAAAAAAAAXo/NNgVwnTUBik/photo.jpg?sz=128", "display_name": "Arun kumar", "link": "https://stackoverflow.com/users/7822356/arun-kumar"}, "edited": false, "score": 0, "creation_date": 1491429870, "post_id": 43238687, "comment_id": 73554936, "body": "Your suggestion please"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491451035, "post_id": 43238687, "comment_id": 73560537, "body": "I guess it would be to find a library which can be run server-side and port your VBA to C#"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7822356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X8tP5Pw-Cn8/AAAAAAAAAAI/AAAAAAAAAXo/NNgVwnTUBik/photo.jpg?sz=128", "display_name": "Arun kumar", "link": "https://stackoverflow.com/users/7822356/arun-kumar"}, "edited": false, "score": 0, "creation_date": 1491429847, "post_id": 43240917, "comment_id": 73554927, "body": "This is not I need. Please help how to call a sub function when the main function is called from C#"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1491423683, "creation_date": 1491423683, "answer_id": 43240917, "question_id": 43238687, "link": "https://stackoverflow.com/questions/43238687/calling-excel-macro-from-c-throwing-compile-error-sub-or-function-not-defined/43240917#43240917", "title": "Calling Excel Macro from C# throwing Compile Error : Sub Or Function not defined", "body": "<p>Let's say you have an Excel Macro which looks like this</p>\n\n<pre><code>Sub ShowMsg(msg As String, title As String)\n    MsgBox msg, vbInformation, title\nEnd Sub\n</code></pre>\n\n<p>Here is the C# code to pass arguments to that macro and then call it. (TRIED AND TESTED with VS2010 + Excel 2010)</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing Excel = Microsoft.Office.Interop.Excel;\n\nnamespace WindowsFormsApplication2\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            //~~&gt; Define your Excel Objects\n            Excel.Application xlApp = new Excel.Application();\n\n            Excel.Workbook xlWorkBook;\n\n            //~~&gt; Start Excel and open the workbook.\n            xlWorkBook = xlApp.Workbooks.Open(\"E:\\\\Users\\\\Siddharth Rout\\\\Desktop\\\\book1.xlsm\");\n\n            //~~&gt; Run the macros by supplying the necessary arguments\n            xlApp.Run(\"ShowMsg\", \"Hello from C# Client\", \"Demo to run Excel macros from C#\");\n\n            //~~&gt; Clean-up: Close the workbook\n            xlWorkBook.Close(false);\n\n            //~~&gt; Quit the Excel Application\n            xlApp.Quit();\n\n            //~~&gt; Clean Up\n            releaseObject(xlApp);\n            releaseObject(xlWorkBook);\n        }\n\n        //~~&gt; Release the objects\n        private void releaseObject(object obj)\n        {\n            try\n            {\n                System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n                obj = null;\n            }\n            catch (Exception ex)\n            {\n                obj = null;\n            }\n            finally\n            {\n                GC.Collect();\n            }\n        }\n    }\n}\n</code></pre>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/Lync/en-US/2e33b8e5-c9fd-42a1-8d67-3d61d2cedc1c/how-to-call-excel-macros-programmatically-in-c?forum=exceldev\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/Lync/en-US/2e33b8e5-c9fd-42a1-8d67-3d61d2cedc1c/how-to-call-excel-macros-programmatically-in-c?forum=exceldev</a></p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7822356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X8tP5Pw-Cn8/AAAAAAAAAAI/AAAAAAAAAXo/NNgVwnTUBik/photo.jpg?sz=128", "display_name": "Arun kumar", "link": "https://stackoverflow.com/users/7822356/arun-kumar"}, "edited": false, "score": 0, "creation_date": 1491501996, "post_id": 43243835, "comment_id": 73593895, "body": "You better shutdown your computer"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1491439431, "creation_date": 1491439431, "answer_id": 43243835, "question_id": 43238687, "link": "https://stackoverflow.com/questions/43238687/calling-excel-macro-from-c-throwing-compile-error-sub-or-function-not-defined/43243835#43243835", "title": "Calling Excel Macro from C# throwing Compile Error : Sub Or Function not defined", "body": "<p>What was the problem?  It didn't work?  I can't test those things when I'm at work; everything on my machine is completely locked down.  I'm lucky if the computer even turns on...</p>\n\n<p>I know, for sure, the script below works.</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Windows.Forms;\nusing Excel = Microsoft.Office.Interop.Excel;\n\n\nnamespace WindowsFormsApplication5\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n\n            //\"http://programmingeveryday.wordpress.com/2013/02/20/run-excel-macro-programmatically-in-c/\"\n            //~~&gt; Define your Excel Objects\n            Excel.Application xlApp = new Excel.Application();\n\n            Excel.Workbook xlWorkBook;\n\n            //~~&gt; Start Excel and open the workbook.\n            xlWorkBook = xlApp.Workbooks.Open(\"C:\\\\Users\\\\Ryan\\\\Desktop\\\\RunMacro.xlsb\");\n\n            //~~&gt; Run the macros by supplying the necessary arguments\n            xlApp.Run(\"ShowMessage\");\n\n\n            //~~&gt; Clean-up: Close the workbook\n            xlWorkBook.Close(false);\n\n            //~~&gt; Quit the Excel Application\n            xlApp.Quit();\n\n            //~~&gt; Clean Up\n            releaseObject(xlApp);\n            releaseObject(xlWorkBook);\n        }\n\n        //~~&gt; Release the objects\n        private void releaseObject(object obj)\n        {\n            try\n            {\n                System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n                obj = null;\n            }\n            catch (Exception ex)\n            {\n                obj = null;\n            }\n            finally\n            {\n                GC.Collect();\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "is_accepted": false, "score": 1, "last_activity_date": 1491441449, "last_edit_date": 1491441449, "creation_date": 1491440986, "answer_id": 43244040, "question_id": 43238687, "link": "https://stackoverflow.com/questions/43238687/calling-excel-macro-from-c-throwing-compile-error-sub-or-function-not-defined/43244040#43244040", "title": "Calling Excel Macro from C# throwing Compile Error : Sub Or Function not defined", "body": "<p>I wrote some software not too long ago that runs a macro before closing.</p>\n\n<p><code>Microsoft.Office.Interop.Excel.Document.ActiveDocument.Application.Run(\"macroName\")</code></p>\n\n<p>See:\n<a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.aspx</a></p>\n\n<p>Here is some trimmed up VB using Interop.Word that should be easily portable.</p>\n\n<pre><code>Imports Word = Microsoft.Office.Interop.Word\n\n    Dim objWordApp As New Word.Application\n    Dim objDoc As Word.Document\n\n    Private Sub Form1_Load(ByVal sender As System.Object, e As System.EventArgs) Handles MyBase.Load\n\n        'Establish application path, replace appPath on deployment\n        Dim appPath As String = Application.StartupPath()\n\n        'Run application in foreground or background.  \n        'If in background (false), be sure to add objDoc.close() and objWordApp.Quit()\n        objWordApp.Visible = False\n\n        Dim objDoc As Word.Document = objWordApp.Documents.Open(appPath &amp; \"path.to.file\", [ReadOnly]:=True)\n\n        objDoc = objWordApp.ActiveDocument\n\n        With objDoc\n        ...Manipulate document...\n        End With\n\n        'clear objDoc object\n        objDoc = Nothing\n\n        'quit msWord\n        lblStatus.Text = \"Quitting MS Word\"\n        objWordApp.Quit()\n\n        'clear objWord object\n        objWordApp = Nothing\n\n        'close com objects on parent system\n        lblStatus.Text = \"Releasing COM objects\"\n        If Not objDoc Is Nothing Then\n            System.Runtime.InteropServices.Marshal.ReleaseComObject(objDoc)\n        End If\n        If Not objWordApp Is Nothing Then\n            System.Runtime.InteropServices.Marshal.ReleaseComObject(objWordApp)\n        End If\n\n        'set filename\n        lblStatus.Text = \"Sending BLOB to DB\"\n        Dim filename As String = Path.GetFileName(saveString)\n\n        'open a filestream\n        Dim fs As FileStream = New FileStream(saveString, FileMode.Open, FileAccess.Read)\n\n        'open a binary reader stream\n        Dim br As BinaryReader = New BinaryReader(fs)\n\n        'create array to store the BLOB\n        Dim bytes As Byte() = br.ReadBytes(Convert.ToInt32(fs.Length))\n\n        'Write the BLOB to the DB and set box as unselected\n        Dim cmdStoreBlob As SqlCommand = New SqlCommand(\"UPDATE TABLENAME SET\n            COLUMN = @VAR, [SELECTED] = @VAR2 WHERE [SELECTED] = 'True'\", connection)\n        cmdStoreBlob.Parameters.Add(\"@VAR1\", SqlDbType.VarBinary).Value = bytes\n        cmdStoreBlob.Parameters.Add(\"@VAR2\", SqlDbType.Bit).Value = 0\n        cmdStoreBlob.ExecuteNonQuery()\n\n        'close binary reader and file stream\n        lblStatus.Text = \"Cleaning Up\"\n        br.Close()\n        fs.Close() 'close file stream\n\n        'close SQL server connection\n        connection.Close()\n\n        'exit application\n        Application.Exit()\n    End Sub\nEnd Class\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7822356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-X8tP5Pw-Cn8/AAAAAAAAAAI/AAAAAAAAAXo/NNgVwnTUBik/photo.jpg?sz=128", "display_name": "Arun kumar", "link": "https://stackoverflow.com/users/7822356/arun-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1491441449, "creation_date": 1491416021, "last_edit_date": 1491417844, "question_id": 43238687, "link": "https://stackoverflow.com/questions/43238687/calling-excel-macro-from-c-throwing-compile-error-sub-or-function-not-defined", "title": "Calling Excel Macro from C# throwing Compile Error : Sub Or Function not defined", "body": "<p>I am creating a web application to replace the current Excel Macro Application. The Excel macro has several forms and modules in it. When I call a macro function in the C# using xlApp.Run method, the function is getting called but throwing error when the function calls other sub functions and uses global public variables. </p>\n\n<p>Errors : \n1. Compile Error : Sub Or Function not defined - at \"Set svd = m_queries(GetSheetRootName(Sheet1))\"\n2. Runtime Error 424 : Object Required - at \"CompareWorksheetsToCombined\"</p>\n\n<p>Code : </p>\n\n<pre><code>Public Function CompareExcels(filePath1 As String, filePath2 As String)\nCall MsgBox(\"Done comparing sheets1.\", vbInformation, \"Compare Complete\")\nOn Error GoTo CompErr\nCall MsgBox(\"Done comparing sheets2.\", vbInformation, \"Compare Complete\")\nDim compBook As Workbook\nDim book1 As Workbook, book2 As Workbook\nDim sheet, Sheet1 As Worksheet, Sheet2 As Worksheet\nDim svd As ScriptViewDescription, obj\nDim l As Long\nDim sheetName As String\nDim a As Integer\n\n'// Check to make sure we have valid options selected for compare\nIf ValidateOptions = False Then Exit Function\n\ncmdCompare.Enabled = True\n\n'// Create the comparison output workbook\nSet compBook = OpenCompareOutput()\n\n'// Get the workbooks we're comparing\nSet book1 = Workbooks(filePath1)\nSet book2 = Workbooks(filePath2)\n\n'// Verify if the Summary Sheet Exists and compare the libraries.\n'//If (WorksheetExists(\"[\" &amp; filePath1 &amp; \"]Summary\")) And (WorksheetExists(\"[\" &amp; filePath2 &amp; \"]Summary\")) Then\n\n    Set Sheet1 = book1.Sheets(\"Summary\")\n    Set Sheet2 = book2.Sheets(\"Summary\")\n\n    '//If Sheet1.Cells(2, 3) = Sheet2.Cells(2, 3) Then\n       '// a = MsgBox(\"Attention: You are comparing the data from Same Environment\", vbCritical, \"Critical Warning\")\n    '//End If\n'//Else\n    '//a = MsgBox(\"Summary Tab does not exist in either Workbook A or B and the Libraries are not compared\", vbCritical, \"Critical Warning\")\n'//End If\n\n'// Look for selected sheets and then compare them\nFor l = 0 To lstSheets.ListCount - 1\n    If lstSheets.selected(l) = True Then\n        '// reset vars to make sure we don't accidentally re-use from last loop\n        Set Sheet1 = Nothing\n        Set Sheet2 = Nothing\n        Set svd = Nothing\n\n        '// Attempt to load up the vars with the new stuff\n        sheetName = lstSheets.list(l)\n        Set Sheet1 = book1.Sheets(sheetName)\n        Set Sheet2 = book2.Sheets(sheetName)\n        Set svd = m_queries(GetSheetRootName(Sheet1))\n\n        '// Check vars and if we're good then compare\n        If Not (Sheet1 Is Nothing) _\n        And Not (Sheet2 Is Nothing) _\n        And Not (svd Is Nothing) Then\n            Call CompareWorksheetsToCombined(Sheet1, Sheet2, compBook, svd, txtPrefixA.Text, txtPrefixB.Text)\n        End If\n    End If\nNext l\n\ncmdCompare.Enabled = True\nCall MsgBox(\"Done comparing sheets.\", vbInformation, \"Compare Complete\")\n\nExit Function\nCompErr:\nCall MsgBox(\"Error while attempting to process compares.\" &amp; vbCrLf &amp; vbCrLf &amp; \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description, vbCritical, \"Error During Compare\")\ncmdCompare.Enabled = True\nEnd Function\n</code></pre>\n\n<p>Please help out.</p>\n"}, {"tags": ["html", "excel", "vba", "tags"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7822373, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212438768868169/picture?type=large", "display_name": "Paul Webb", "link": "https://stackoverflow.com/users/7822373/paul-webb"}, "edited": false, "score": 0, "creation_date": 1491430816, "post_id": 43240963, "comment_id": 73555300, "body": "Thanks Ryszard. I haven&#39;t got this working just yet but still working on it."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1491423846, "creation_date": 1491423846, "answer_id": 43240963, "question_id": 43238654, "link": "https://stackoverflow.com/questions/43238654/vba-extracting-values-by-tag-attribute/43240963#43240963", "title": "VBA - Extracting values by tag attribute", "body": "<p>Try adding something like this:</p>\n\n<pre><code>Dim htmlEle1 as IHTMLElement\n\nOn Error Resume Next\nFor Each htmlEle1 in Doc.All\n    If htmlEle1.getAttribute(\"title\") = \"Priority\" then Debug.Print htmlEle1.innertext   \nNext htmlEle1\nOn Error GoTo 0\n</code></pre>\n\n<p>Also change <code>IE.readyState = READYSTATE_COMPLETE</code> to <code>IE.readyState = READYSTATE_COMPLETE And IE.Busy = False</code></p>\n"}], "owner": {"reputation": 11, "user_id": 7822373, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212438768868169/picture?type=large", "display_name": "Paul Webb", "link": "https://stackoverflow.com/users/7822373/paul-webb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 959, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1491423846, "creation_date": 1491415919, "question_id": 43238654, "link": "https://stackoverflow.com/questions/43238654/vba-extracting-values-by-tag-attribute", "title": "VBA - Extracting values by tag attribute", "body": "<p>I have been using the following code to pull values from a web page.</p>\n\n<pre><code>Private Sub Update()\n\n  Dim IE As New InternetExplorer\n  IE.Visible = False\n  IE.navigate \"cisco.com/\" &amp; Range(\"srNum\").Value\n  Do\n    DoEvents\n  Loop Until IE.readyState = READYSTATE_COMPLETE\n  Dim Doc As HTMLDocument\n  Set Doc = IE.document\n  Dim sTag As String\n  sTag = Doc.getElementById(\"caseheader\").innerText\n\n  Sheets.Add\n  ActiveCell.Value = sTag\n\nEnd Sub\n</code></pre>\n\n<p>I am now on a new page where I need to pull the value by the attribute \"title\". In the example below I need to find the attribute \"title\" with the value of \"Priority\" and then return the value of \"P3\".</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;div class=\"con-LFloat con-RAlign con-Priority Width25\"&gt;\n  &lt;span class=\"con-text-bold Width20 con-RAlign\"&gt;Priority :&lt;/span&gt;\n  &lt;span class=\"con-text-bold con-LMargin5\" title=\"Priority\"&gt;P3&lt;/span&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>\nI have tried using .item(0) or .Children(0) with no luck and I haven't found any documentation to walk me through it. </p>\n\n<p>I need some assistance with this one or a site that can help me set it up.</p>\n\n<p>-Thanks</p>\n"}, {"tags": ["excel", "function", "add-in", "user-defined-functions", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1491415183, "post_id": 43238172, "comment_id": 73547006, "body": "Your <code>-</code> are not actual minus, code 150 vs code 45.  highlight each and replace it with an actually typed <code>-</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1491415979, "post_id": 43238172, "comment_id": 73547427, "body": "btw, those <code>(y2\u2013y1)</code>, etc <b>should</b> have autocorrected to <code>(y2 - y1)</code> if the VBE had recognized the maths operation."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1491418977, "post_id": 43238172, "comment_id": 73549229, "body": "Also with Option Explicit you get a compile error (variable not defined)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1491416217, "post_id": 43238572, "comment_id": 73547576, "body": "btw&#178; - Removing WorksheetFunction and passing the returned value back to a variant allows you to check for errors like <code>If IsError(x1) Then</code>. Keeping WorksheetFunction removes this ability for error-handling."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1491415612, "creation_date": 1491415612, "answer_id": 43238572, "question_id": 43238172, "link": "https://stackoverflow.com/questions/43238172/value-error-using-custom-function-in-excel/43238572#43238572", "title": "#Value error using custom function in Excel", "body": "<p>My sampling of your formula and data threw an error on the hyphens not being interpreted as 'minus signs'. In fact, they come up as unicode 8211. Retyping them, declaring the vars as variants and removing the <code>...WorksheetFunction...</code> fixed the problem.</p>\n\n<pre><code>Function LININTERP(x, xvalues, yvalues)\n    Dim x1 As Variant, x2 As Variant, y1 As Variant, y2 As Variant\n\n    'x and y values must be in ascending order from top to bottom.\n    'x must be within the range of available data.\n\n    x1 = Application.Index(xvalues, Application.Match(x, xvalues, 1))\n    x2 = Application.Index(xvalues, Application.Match(x, xvalues, 1) + 1)\n\n    y1 = Application.Index(yvalues, Application.Match(x, xvalues, 1))\n    y2 = Application.Index(yvalues, Application.Match(x, xvalues, 1) + 1)\n\n    LININTERP = y1 + (y2 - y1) * (x - x1) / (x2 - x1)\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/PlEwm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PlEwm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Moral of the story: Don't trust everything you find on the internet.</p>\n"}], "owner": {"reputation": 155, "user_id": 5294214, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a5579ad540f24a9f2d2f1b8aaecb9aae?s=128&d=identicon&r=PG&f=1", "display_name": "BunnyKnitter", "link": "https://stackoverflow.com/users/5294214/bunnyknitter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 43238572, "answer_count": 1, "score": 2, "last_activity_date": 1491416098, "creation_date": 1491414301, "last_edit_date": 1531161705, "question_id": 43238172, "link": "https://stackoverflow.com/questions/43238172/value-error-using-custom-function-in-excel", "title": "#Value error using custom function in Excel", "body": "<p>I'm getting a #VALUE error when I try to call my custom function. All it is supposed to do is a bit of math. Does anyone see what could be wrong here?</p>\n\n<p>I copied this one off the internet:</p>\n\n<p>Source: </p>\n\n<blockquote class=\"spoiler\">\n  <p> <a href=\"http://www.engineerexcel.com/linear-interpolation-vba-function-in-excel/\" rel=\"nofollow noreferrer\">http://www.engineerexcel.com/linear-interpolation-vba-function-in-excel/</a></p>\n</blockquote>\n\n<pre><code>Function LININTERP(x, xvalues, yvalues)\n\n'x and y values must be in ascending order from top to bottom.\n'x must be within the range of available data.\n\nx1 = Application.WorksheetFunction.Index(xvalues, Application.WorksheetFunction.Match(x, xvalues, 1))\nx2 = Application.WorksheetFunction.Index(xvalues, Application.WorksheetFunction.Match(x, xvalues, 1) + 1)\n\ny1 = Application.WorksheetFunction.Index(yvalues, Application.WorksheetFunction.Match(x, xvalues, 1))\ny2 = Application.WorksheetFunction.Index(yvalues, Application.WorksheetFunction.Match(x, xvalues, 1) + 1)\n\nLININTERP = y1 + (y2\u2013y1) * (x\u2013x1) / (x2\u2013x1)\nEnd Function\n</code></pre>\n\n<p>This is a simplified version I made thinking that the worksheet function calls may be causing the error:</p>\n\n<pre><code>Function LININTERP(x, x1, x2, y1, y2)\n  LININTERP = y1 + (y2\u2013y1) * (x\u2013x1) / (x2\u2013x1)\nEnd Function\n</code></pre>\n\n<p>my test data in an unrelated workbook:\n(All formatted as \"General\")</p>\n\n<pre><code>A1: 633\nA2: 634\nB1: 14.968\nB2: 15.024\nC1 (my x): 633.6\n</code></pre>\n\n<p>Just plugging the actual math into a cell works as expected. Calling the function throws the #VALUE error.</p>\n\n<p>My function is saved in a module in a workbook that I have saved and added to Excel as an Add-In.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1491413269, "post_id": 43237659, "comment_id": 73545773, "body": "I fail to see a clear question and this is most definitely <b>not</b> a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "edited": false, "score": 0, "creation_date": 1491413729, "post_id": 43237659, "comment_id": 73546079, "body": "The routines work flawlessly for me, the only thing that I would like to improve upon is the quality of the resulted image. It is not bad but definitely could be better.   That is my question. I want to improve upon the quality of the image."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1491416448, "post_id": 43237659, "comment_id": 73547731, "body": "<i>The routines work flawlessly for me, the only thing that I would like to improve upon</i> - Perhaps question is better suited for <a href=\"http://codereview.stackexchange.com/\">Code Review</a>"}], "owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491414132, "creation_date": 1491412616, "last_edit_date": 1531161705, "question_id": 43237659, "link": "https://stackoverflow.com/questions/43237659/creating-a-highly-customized-header-and-footer-f-excel", "title": "Creating a Highly Customized Header and Footer F/ Excel", "body": "<p>Hopefully this helps anyone who struggled with the restrictive header-footer options in Excel. Below is a routine that I am using to create a highly customized header and footer for excel. I found a routine on a forum to save cells to an image <a href=\"http://www.ozgrid.com/forum/showthread.php?t=45682\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/forum/showthread.php?t=45682</a>. </p>\n\n<p>I have a hidden sheet for that purpose \"Header and Footer Developer\". There is a set of cells that I have graphics such as company logos, and text that define the header and footer. The routines work flawlessly for me. <strong><em>My question: I am looking to improve upon is the quality of the resulted image.</em></strong> It is not bad but definitely could be better. </p>\n\n<p>Regards,</p>\n\n<p>Mahmoud</p>\n\n<pre><code>Sub PrintFomatter()\nDim HeaderTitle As String\nDim PrintSheet As String\nDim AddiTioNal_InFo_Check As Boolean\n\nIf ActiveSheet.Name Like \"*PRINT*\" Then Exit Sub\nCall miscellaneous.Initializer\n\n\n'Gets the header title\nSelect Case True\n    Case ActiveSheet.Name Like \"*Bill*\"\n        HeaderTitle = \"Bill of Materials\"\n        PrintSheet = ActiveSheet.Name\nEnd Select\n\n'Informs the user of the next action\nMsgBox (\"This tool generates a printer-friendly version of \" &amp; HeaderTitle &amp; \" Sheet.\" &amp; vbNewLine &amp; _\n        \"Do Not use this sheet for editing inputs. The Sheet would automatically be DELETED after printing.\"), vbInformation\n\n'Generates the Header/Footer Banner\nCall HeaderFooterDeveloper.HeaderFooter(HeaderTitle, AddiTioNal_InFo_Check)\n\n'Formats Sheet\nCall miscellaneous.PrintSheetDeveloper(HeaderTitle, PrintSheet, AddiTioNal_InFo_Check)\n\n\n\nDim myPassword As String\n'myPassword = \"password\"\nFor Each WS In ActiveWorkbook.Worksheets\n    If WS.Name Like \"*PRINT*\" Then\n    Else\n        WS.Protect 'Password:=myPassword\n    End If\nNext WS\n    With Application\n    .EnableEvents = True\n    .ScreenUpdating = True\n    .StatusBar = False\nEnd With\n\nEnd Sub\nSub HeaderFooter(Header As String, AddiTioNal_InFo_Check As Boolean)\n\nDim i As Long ' i: Counter\nDim AddiTioNal_InFo As String\nWorksheets(\"Header_Footer_Developer\").Range(\"F6\").Font.Color = RGB(255, 255, 255)\nWorksheets(\"Header_Footer_Developer\").Range(\"J6\").Font.Color = RGB(255, 255, 255)\n\n'Gets additional info is USED by user\nAddiTioNal_InFo = BOM.Cells(BOM.Range(\"ToolMatNum\").Row - 1, BOM.Range(\"ToolMatNum\").Column)\n\n'Check is user added additonal info\nIf Not AddiTioNal_InFo = \"\" And Not AddiTioNal_InFo = \"-\" And Not AddiTioNal_InFo = \"N/A\" And Not AddiTioNal_InFo = \"n/a\" And _\n        Not AddiTioNal_InFo = \" \" And Not AddiTioNal_InFo = \"NA\" And Not AddiTioNal_InFo = \"na\" Then AddiTioNal_InFo_Check = True\n\n\nSelect Case True\n    Case ActiveSheet.Name = BOM.Name\n        Worksheets(\"Header_Footer_Developer\").Range(\"AB5\") = \"Checked By:\"\n        Worksheets(\"Header_Footer_Developer\").Range(\"AB6\") = \"Approved By:\"\n        Worksheets(\"Header_Footer_Developer\").Range(\"AC5\") = BOM.Range(\"Checker\").Value\n        Worksheets(\"Header_Footer_Developer\").Range(\"AC6\") = BOM.Range(\"Approver\").Value\n        Worksheets(\"Header_Footer_Developer\").Range(\"AE6\") = \"Date:\"\n        Worksheets(\"Header_Footer_Developer\").Range(\"AF5\") = BOM.Cells(Range(\"Checker\").Row, Range(\"Checker\").Column + 2).Value\n        Worksheets(\"Header_Footer_Developer\").Range(\"AF6\") = BOM.Cells(Range(\"Approver\").Row, Range(\"Approver\").Column + 2).Value\nEnd Select\n\n\nWorksheets(\"Header_Footer_Developer\").Range(\"A2\") = Header &amp; \": \" &amp; BOM.Range(\"D1\")\n\n'Calls SAVE_PICTURE to save Header and Footer banner\nFor i = 0 To 1\n    Select Case True\n        Case i = 0 'First Page Header Generator\n            Select Case True\n                Case Is = AddiTioNal_InFo_Check = False\n                    Set HeadFoot = Worksheets(\"Header_Footer_Developer\").Range(\"A1:AF6\")\n                Case AddiTioNal_InFo_Check = True\n                    Set HeadFoot = Worksheets(\"Header_Footer_Developer\").Range(\"A1:AF7\")\n            End Select\n\n            HeaderFileName = \"FirstHeaderFileFor_Bill of Materials.png\"\n            SAVE_PICTURE   'Calls routine to save picture\n\n        Case i = 1 'Footer Generator\n            Set HeadFoot = Worksheets(\"Header_Footer_Developer\").Range(\"A33:AF35\")\n            HeaderFileName = \"FooterFileFor_Bill of Materials.png\"\n            SAVE_PICTURE   'Calls routine to save picture\n    End Select\nNext i\n\nEnd Sub\n'=============================================================================\n'- COPY PICTURES FROM A WORKSHEET TO .BMP FILES\n'- VERSION 2 : uses code to save file instead of SendKeys/MS Paint\n'---------------------------------------------------------------------\n'- Thanks to the code attributed to JAAFAR of MrExcel forum (with no messages present now)\n'- Ref : http://www.ozgrid.com/forum/showthread.php?t=45682\n'---------------------------------------------------------------------\n'- Picks up Embedded objects (OLEObjects) and Pictures (Picture objects)\n'=============================================================================\n'- *** AMEND THESE CONST VALUES AND RUN THE MACRO FROM THE SHEET\nConst BitmapFileName As String = \"XLpicture\" 'file name without \"_00x.bmp\"\nConst MyPictureFolder As String = \"C:\\Users\\marzmah\\Videos\\Cylinder Fixture __ Prototype Cost2_files\" ' target folder for files\n'-------------------------------------------------------------------------\n'- 1. Copies all pictures from sheet.\n'- 2. Gets next file name in the series (filenames format like \"xxx_001.bmp\")\n'- 3. Saves file in target folder.\n'- Brian Baulsom November 2008\n'=============================================================================\n'- VERSION 1 : Userform Screen copy July 2008 using SendKeys/MS Paint\n'- Save Userform as BMP\n'=============================================================================\n'- DECLARATIONS &amp; VARIABLES TO SAVE PICTURE FILE FROM CLIPBOARD\nPrivate Declare Function OpenClipboard Lib \"user32\" (ByVal hwnd As Long) As Long\nPrivate Declare Function GetClipboardData Lib \"user32\" (ByVal wFormat As Integer) As Long\nPrivate Declare Function CloseClipboard Lib \"user32\" () As Long\nPrivate Declare Function OleCreatePictureIndirect Lib \"olepro32.dll\" _\n    (PicDesc As uPicDesc, RefIID As GUID, ByVal fPictureOwnsHandle As Long, IPic As IPicture) As Long\n'------------------------------------------------------------------------------\n'- IPicture OLE Interface\nPrivate Type GUID\nData1 As Long\nData2 As Integer\nData3 As Integer\nData4(0 To 7) As Byte\nEnd Type\n'-store the bitmap information\nPrivate Type uPicDesc\nSize As Long\nType As Long\n    hPic As Long\n    hPal As Long\nEnd Type\n'-------------------------------------------------------------------------------\nConst CF_BITMAP = 2\nConst CF_PALETTE = 9\nConst IMAGE_BITMAP = 0\nConst LR_COPYRETURNORG = &amp;H4\nConst PICTYPE_BITMAP = 1\nDim IID_IDispatch As GUID\nDim uPicinfo As uPicDesc\nDim IPic As IPicture\nDim hPtr As Long\n'=============================================================================\n'- WORKSHEET/PICTURE VARIABLES\nDim HeadFoot As Range\nDim MyPicture As Object        ' PICTURES IN SHEET\nDim PictureCount As Integer\n'-----------------------------------------------------------------------------\n'- BITMAP FILE : FULL PATH &amp; FILE NAME\nDim HeaderFileName As String\nDim FullFileName As String '= MyPictureFolder &amp; HeaderFileName &amp; \"_00x.bmp\"\n'-----------------------------------------------------------------------------\n'- GET NEXT FILE NAME (Uses FileSystemObject)\nDim fso As Object\nDim FileNumber As Integer\nDim LastFileNumber As Integer\n'-- end of declarations ------------------------------------------------------\n\n'- SUBROUTINE : SAVE PICTURE FROM CLIPBOARD AS A BITMAP FILE (JAAFAR'S CODE)\n'- Called from main routine\n'=============================================================================\nPrivate Sub SAVE_PICTURE()\n    ActiveSheet.Range(\"A1\").Select  ' focus from button or picture to sheet\n    LastFileNumber = 0              ' counter\n    Set fso = CreateObject(\"Scripting.FileSystemObject\") ' FOR NEXTFILENAME\n\n    FullFileName = \"C:\\Users\\Public\\Pictures\\\" &amp; HeaderFileName\n\n    'Sheet2.Range (\"A1:AL5\")\n    Application.ScreenUpdating = True\n    HeadFoot.CopyPicture Appearance:=xlScreen, Format:=xlBitmap       ' MyPicture.Copy\n    Application.ScreenUpdating = False\n    '-----------------------------------------------------------------\n    OpenClipboard 0\n    hPtr = GetClipboardData(CF_BITMAP)\n    CloseClipboard\n\n    '-------------------------------------------------------------------------\n     'Create the interface GUID for the picture\n    With IID_IDispatch\n        .Data1 = &amp;H7BF80980\n        .Data2 = &amp;HBF32\n        .Data3 = &amp;H101A\n        .Data4(0) = &amp;H8B\n        .Data4(1) = &amp;HBB\n        .Data4(2) = &amp;H0\n        .Data4(3) = &amp;HAA\n        .Data4(4) = &amp;H0\n        .Data4(5) = &amp;H30\n        .Data4(6) = &amp;HC\n        .Data4(7) = &amp;HAB\n    End With\n    '------------------------------------------------------------------------\n     '  Fill uPicInfo with necessary parts.\n    With uPicinfo\n\n        .Size = Len(uPicinfo) ' Length of structure.\n        .Type = PICTYPE_BITMAP ' Type of Picture\n        .hPic = hPtr ' Handle to image.\n        .hPal = 0 ' Handle to palette (if bitmap).\n    End With\n    '------------------------------------------------------------------------\n     'Create the Picture Object\n    OleCreatePictureIndirect uPicinfo, IID_IDispatch, True, IPic\n    '------------------------------------------------------------------------\n     'Save Picture\n    stdole.SavePicture IPic, FullFileName\n    '------------------------------------------------------------------------\n     'fix the clipboard (it seems to go messed up)\n    Selection.CopyPicture Appearance:=xlScreen, Format:=xlBitmap\n    '------------------------------------------------------------------------\nEnd Sub\n\n\n\nSub PrintSheetDeveloper(HeaderTitle As String, PrintSheet As String, AddiTioNal_InFo_Check As Boolean) 'This Routine Develops a Printer-Friendly WorkSheet.\n\nDim PrintSheetTitle As String\nDim nm As Name, WS As Worksheet\nDim LastUsedRow(1 To 4) As Long\nDim FirstRow As Long, LastCol As Long, i As Long, LastRow As Long, LastRowRng As Range, MergeRng(1 To 2) As Range\nDim DPI_SettingFactor As Double, DPI_Setting As String\nPrintSheetTitle = \"PRINT SHEET--\" &amp; HeaderTitle\n\nOn Error Resume Next\nApplication.DisplayAlerts = False\nFor Each WS In ActiveWorkbook.Worksheets\n    If WS.Name Like \"*PRINT*\" Then WS.Delete\nNext WS\nApplication.DisplayAlerts = True\nOn Error GoTo 0\n\n'Creats A Copy of Active Spreadsheet\nWorksheets(PrintSheet).Copy before:=BOM\n\n'Gets Screen DPI Settings to Adjust Print Options Accordingly\nDPI_Setting = GetDpi()\nIf DPI_Setting Like \"96\" Then\n    DPI_SettingFactor = 0.97385\nElse\n    DPI_SettingFactor = 1\nEnd If\n\n\n'Changes Name of ActiveSheet\nActiveSheet.Name = PrintSheetTitle\n\n'Changes Sheet Tab color to grey\nWorksheets(PrintSheetTitle).Tab.ColorIndex = xlNone\n\nActiveWindow.View = xlPageBreakPreview 'xlPageLayoutView\n\nSelect Case True\n    'Formats Bill of Materials Sheet\n        Case HeaderTitle = \"Bill of Materials\"\n            FirstRow = BOM.Range(\"ItemNo_BOM\").Row\n            LastCol = BOM.Range(\"Comment_BOM\").Column\n        'Changes the color of rows (Alternating Grey and White rows)\n            For i = FirstRow + 1 To 150 Step 2\n                Worksheets(PrintSheetTitle).Range(Cells(i, 1), Cells(i, LastCol)).Interior.ColorIndex = xlNone\n                Worksheets(PrintSheetTitle).Range(Cells(i + 1, 1), Cells(i + 1, LastCol)).Interior.Color = RGB(228, 228, 228)\n            Next i\n            Worksheets(PrintSheetTitle).Range(Cells(151, 1), Cells(151, LastCol)).Interior.ColorIndex = xlNone\n            'Hides existing header on sheet (will be replaced by header banner)\n            Worksheets(PrintSheetTitle).Rows(\"1:4\").Hidden = True\n\n            'Gets last row from specific columns\n            LastUsedRow(1) = BOM.Columns(\"A\").Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\n            LastUsedRow(2) = BOM.Columns(\"C\").Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\n            LastUsedRow(3) = BOM.Columns(\"E\").Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\n            LastUsedRow(4) = WorksheetFunction.Max(LastUsedRow(1), LastUsedRow(2), LastUsedRow(3))\nEnd Select\n\n'Adjust the Print Setup for Bill of Materials\nWith Worksheets(PrintSheetTitle).PageSetup\n    .ScaleWithDocHeaderFooter = False\n    Select Case True\n    'FORMATS BoM SHEET\n        Case HeaderTitle = \"Bill of Materials\"\n            .PaperSize = xlPaperLetter\n            .LeftHeaderPicture.Filename = \"C:\\Users\\Public\\Pictures\\FirstHeaderFileFor_Bill of Materials.png\"\n            .LeftHeader = \"&amp;G\"\n            .LeftHeaderPicture.LockAspectRatio = True\n            .CenterFooterPicture.Filename = \"C:\\Users\\Public\\Pictures\\FooterFileFor_Bill of Materials.png\"\n            .CenterFooter = \"&amp;G\"\n            .LeftHeaderPicture.Width = Application.InchesToPoints(9.5 * DPI_SettingFactor)\n            .CenterFooterPicture.Width = Application.InchesToPoints(9.6 * DPI_SettingFactor)\n            'Checks if there is additional info - and accounts for additional header margin\n            Select Case True\n                Case AddiTioNal_InFo_Check = False\n                    .TopMargin = Application.InchesToPoints(1.1)\n                Case AddiTioNal_InFo_Check = True\n                    .TopMargin = Application.InchesToPoints(1.24)\n            End Select\n            .BottomMargin = Application.InchesToPoints(0.65)\n            .HeaderMargin = Application.InchesToPoints(0.3)\n            .FooterMargin = Application.InchesToPoints(0.3)\n            .LeftMargin = Application.InchesToPoints(0.5)\n            .RightMargin = Application.InchesToPoints(0.5)\n            .PrintQuality = 600\n            .AlignMarginsHeaderFooter = True\n            .CenterHorizontally = True\n            .CenterFooterPicture.LockAspectRatio = True\n            .LeftFooter = \"&amp;\" &amp; Chr(34) &amp; \"Arial, regular\" &amp; Chr(34) &amp; \"&amp;7\" &amp; \"&amp;B Print Date: &amp;B &amp;D \" &amp; \"    \" &amp; Chr(13) &amp; Chr(13) '&amp; Chr(13) 'vbCrLf &amp; vbCrLf\n            .RightFooter = \"&amp;\" &amp; Chr(34) &amp; \"Arial &amp;8\" &amp; Chr(34) &amp; \"&amp;7\" &amp; \"Page &amp;P of &amp;N \" &amp; Chr(13) &amp; Chr(13) '&amp; Chr(13)\n            .PrintArea = Range(Cells(FirstRow - 1, 1), Cells(LastUsedRow(4), LastCol)).Address\n    End Select\n    Application.PrintCommunication = True\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1491412351, "post_id": 43237426, "comment_id": 73545199, "body": "Why on Earth would you use an <code>InputBox</code> to prompt for a path/filename? Use <code>Application.GetOpenFilename</code> to present a full-featured browse box to the user."}, {"owner": {"reputation": 19, "user_id": 7822110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e11f1bdf0f6c10c16f91a6216013ffb?s=128&d=identicon&r=PG&f=1", "display_name": "isaac", "link": "https://stackoverflow.com/users/7822110/isaac"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1491414863, "post_id": 43237426, "comment_id": 73546820, "body": "Is there a way to select the folder and then have it Kill .RTF files? maybe in a IF statement?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1504206326, "post_id": 43237426, "comment_id": 78937034, "body": "<a href=\"https://meta.stackexchange.com/a/5235/289619\">meta.stackexchange.com/a/5235/289619</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7822110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e11f1bdf0f6c10c16f91a6216013ffb?s=128&d=identicon&r=PG&f=1", "display_name": "isaac", "link": "https://stackoverflow.com/users/7822110/isaac"}, "edited": false, "score": 0, "creation_date": 1491414236, "post_id": 43237722, "comment_id": 73546414, "body": "Is there a way to select the folder and then have it Kill .RTF files? maybe in a IF statement?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 19, "user_id": 7822110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e11f1bdf0f6c10c16f91a6216013ffb?s=128&d=identicon&r=PG&f=1", "display_name": "isaac", "link": "https://stackoverflow.com/users/7822110/isaac"}, "edited": false, "score": 0, "creation_date": 1491414976, "post_id": 43237722, "comment_id": 73546887, "body": "@isaac well you have the folder with <code>path = folderDialog.SelectedItems(1)</code>, so you just need to verify that a folder was indeed selected, and then do <code>Kill path &amp; &quot;\\*.rtf&quot;</code> and call it a day. BTW get rid of <code>On Error Resume Next</code> if you want to be able to troubleshoot your code."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1491415266, "post_id": 43237722, "comment_id": 73547059, "body": "@Mat&#39;sMug - updated (but I went the long way around deleting the files...)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1491415224, "last_edit_date": 1491415224, "creation_date": 1491412818, "answer_id": 43237722, "question_id": 43237426, "link": "https://stackoverflow.com/questions/43237426/code-in-vba-to-have-an-inputbox-pop-up-choose-a-folder-and-have-docx-files-del/43237722#43237722", "title": "Code in VBA to have an InputBox pop up, choose a folder, and have DOCX files deleted", "body": "<p>You can use something like this to allow the user to pick a folder in a more user-friendly way:</p>\n\n<p><strong>EDIT</strong> - added deleting the files</p>\n\n<pre><code>Sub Tester()\n\n    Dim folderDialog As FileDialog, fld As String, numDel\n    Set folderDialog = Application.FileDialog(msoFileDialogFolderPicker)\n    folderDialog.AllowMultiSelect = False\n    'user picked a folder?\n    If folderDialog.Show() Then\n        fld = folderDialog.SelectedItems(1)\n        numDel = DeleteFiles(fld, \"*.rtf\")\n        MsgBox numDel &amp; \" files deleted from: \" &amp; vbLf &amp; fld\n    End If\n\nEnd Sub\n\nFunction DeleteFiles(theFolder As String, fileType As String) As Long\n    Dim f, col As New Collection, rv As Long\n    If Right(theFolder, 1) &lt;&gt; Application.PathSeparator Then\n        theFolder = theFolder &amp; Application.PathSeparator\n    End If\n    'collect all matching files in the folder\n    f = Dir(theFolder &amp; fileType, vbNormal)\n    Do While f &lt;&gt; \"\"\n        col.Add theFolder &amp; f\n        f = Dir()\n    Loop\n    rv = col.Count\n    For Each f In col\n       Kill f\n    Next f\n    DeleteFiles = rv '&lt;&lt;return number of files deleted\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7822110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e11f1bdf0f6c10c16f91a6216013ffb?s=128&d=identicon&r=PG&f=1", "display_name": "isaac", "link": "https://stackoverflow.com/users/7822110/isaac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491415224, "creation_date": 1491411830, "last_edit_date": 1491411985, "question_id": 43237426, "link": "https://stackoverflow.com/questions/43237426/code-in-vba-to-have-an-inputbox-pop-up-choose-a-folder-and-have-docx-files-del", "title": "Code in VBA to have an InputBox pop up, choose a folder, and have DOCX files deleted", "body": "<p>I am trying to make a small program that converts .RTF files to .DOCX. I have managed to do this part. Now, I want to add an Input box to delete the .RTF files in that same folder. </p>\n\n<p>I do not want to input the location manually every time I have to do a new folder. </p>\n\n<p>Is there any way to have the .RTF files from the same folder deleted when I run the program </p>\n\n<p>OR</p>\n\n<p>is there a way to choose the location in a Input Box.</p>\n\n<p>CODE:</p>\n\n<pre><code>Sub ChangeRTFTODOCXOrTxtOrRTFOrHTML()\n'with export to PDF in Word 2007\n    Dim fs As Object\n    Dim oFolder As Object\n    Dim tFolder As Object\n    Dim oFile As Object\n    Dim strDocName As String\n    Dim intPos As Integer\n    Dim locFolder As String\n    Dim fileType As String\n    Dim locFolderKill As String\n\n    On Error Resume Next\n    locFolder = InputBox(\"Enter the folder path to RTFs\", \"File Conversion\", \"\")\n    Select Case Application.Version\n        Case Is &lt; 12\n            Do\n                fileType = UCase(InputBox(\"Change rtf to TXT, RTF, HTML, DOCX\", \"File Conversion\", \"DOCX\"))\n            Loop Until (fileType = \"TXT\" Or fileType = \"RTF\" Or fileType = \"HTML\" Or fileType = \"DOCX\")\n        Case Is &gt;= 12\n            Do\n                fileType = UCase(InputBox(\"Change rtf to TXT, RTF, HTML, DOCX or PDF(2007+ only)\", \"File Conversion\", \"DOCX\"))\n            Loop Until (fileType = \"TXT\" Or fileType = \"RTF\" Or fileType = \"HTML\" Or fileType = \"PDF\" Or fileType = \"DOCX\")\n    End Select\n    Application.ScreenUpdating = False\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFolder = fs.GetFolder(locFolder)\n    'Set tFolder = fs.CreateFolder(locFolder &amp; \"Converted\")\n    'Set tFolder = fs.GetFolder(locFolder &amp; \"Converted\")\n    For Each oFile In oFolder.Files\n        Dim d As Document\n        Set d = Application.Documents.Open(oFile.Path)\n        strDocName = ActiveDocument.Name\n        intPos = InStrRev(strDocName, \".\")\n        strDocName = Left(strDocName, intPos - 1)\n        ChangeFileOpenDirectory tFolder\n        Select Case fileType\n        Case Is = \"DOCX\"\n            strDocName = strDocName &amp; \".DOCX\"\n            ActiveDocument.SaveAs FileName:=strDocName, FileFormat:=wdFormatXMLDocument\n        Case Is = \"TXT\"\n            strDocName = strDocName &amp; \".txt\"\n            ActiveDocument.SaveAs FileName:=strDocName, FileFormat:=wdFormatText\n        Case Is = \"RTF\"\n            strDocName = strDocName &amp; \".rtf\"\n            ActiveDocument.SaveAs FileName:=strDocName, FileFormat:=wdFormatRTF\n        Case Is = \"HTML\"\n            strDocName = strDocName &amp; \".html\"\n            ActiveDocument.SaveAs FileName:=strDocName, FileFormat:=wdFormatFilteredHTML\n        Case Is = \"PDF\"\n            strDocName = strDocName &amp; \".pdf\"\n\n            ' *** Word 2007 users - remove the apostrophe at the start of the next line ***\n            'ActiveDocument.ExportAsFixedFormat OutputFileName:=strDocName, ExportFormat:=wdExportFormatPDF\n\n        End Select\n        d.Close\n        ChangeFileOpenDirectory oFolder\n    Next oFile\n    Application.ScreenUpdating = True\n\n'This is where I want to insert the InputBox to delete the .RFT files.\n\n\n    On Error Resume Next\n    Kill \"C:\\Users\\maciasa\\Desktop\\main test\\test RFTs\\*.rtf\"\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<ol>\n<li>List item</li>\n</ol>\n"}, {"tags": ["excel", "string", "vba", "function", "uppercase"], "comments": [{"owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "edited": false, "score": 3, "creation_date": 1491411788, "post_id": 43237341, "comment_id": 73544876, "body": "Have a look here: <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">Excel Regex</a>."}], "answers": [{"comments": [{"owner": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "edited": false, "score": 0, "creation_date": 1491413441, "post_id": 43237572, "comment_id": 73545887, "body": "It worked perfectly! Thank you for the quick response!"}, {"owner": {"reputation": 187, "user_id": 7765140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vThNB.jpg?s=128&g=1", "display_name": "Rajesh S", "link": "https://stackoverflow.com/users/7765140/rajesh-s"}, "reply_to_user": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "edited": false, "score": 0, "creation_date": 1491414317, "post_id": 43237572, "comment_id": 73546480, "body": "Nice to see hear from you Tash. Keep asking."}, {"owner": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "edited": false, "score": 0, "creation_date": 1491483060, "post_id": 43237572, "comment_id": 73580080, "body": "Rajesh... could you please show me where should I adjust the code to add the spaces AFTER the uppercase letter instead? I&#39;ve tried to analyze and figure out for myself, by this functions are still too advanced to me!"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 0, "creation_date": 1491485729, "post_id": 43237572, "comment_id": 73582184, "body": "<code>xOut = xOut &amp; &quot; &quot; &amp; VBA.Mid(PValue, i, 1)</code> this line adds a space and then writes the uppercase letter. If you want to add the space <b>after</b>, which I&#39;m not sure why you would want <code>J ohnW illiamsS mith</code>, but the line would be <code>xOut = xOut &amp; VBA.Mid(PValue, i, 1) &amp; &quot; &quot;</code>"}, {"owner": {"reputation": 187, "user_id": 7765140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vThNB.jpg?s=128&g=1", "display_name": "Rajesh S", "link": "https://stackoverflow.com/users/7765140/rajesh-s"}, "edited": false, "score": 0, "creation_date": 1491585602, "post_id": 43237572, "comment_id": 73635786, "body": "Hey Trash, Gabriel has solved the problem.   This code will put space after each character.   Function InsertSpaces(S As String) As String   InsertSpaces = Trim(Replace(StrConv(S, vbUnicode), Chr(0), &quot; &quot;))  End Function"}], "tags": [], "owner": {"reputation": 187, "user_id": 7765140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vThNB.jpg?s=128&g=1", "display_name": "Rajesh S", "link": "https://stackoverflow.com/users/7765140/rajesh-s"}, "is_accepted": true, "score": 2, "last_activity_date": 1491412703, "last_edit_date": 1491412703, "creation_date": 1491412279, "answer_id": 43237572, "question_id": 43237341, "link": "https://stackoverflow.com/questions/43237341/vba-put-a-space-after-or-before-a-upppercase-letter-in-a-string/43237572#43237572", "title": "VBA: Put a space after or before a upppercase letter in a string", "body": "<pre><code>Function AddSpaces(PValue As String) As String\n\n  Dim xOut As String\n  xOut = VBA.Left(PValue, 1)\n\n  For i = 2 To VBA.Len(PValue)\n    xAsc = VBA.Asc(VBA.Mid(PValue, i, 1))\n\n    If xAsc &gt;= 65 And xAsc &lt;= 90 Then\n      xOut = xOut &amp; \" \" &amp; VBA.Mid(PValue, i, 1)\n    Else\n      xOut = xOut &amp; VBA.Mid(PValue, i, 1)\n    End If\n\n  Next\n  AddSpaces = xOut\nEnd Function\n</code></pre>\n\n<p>NB: Use this Function formula is =Addspace(A1). </p>\n"}, {"tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": false, "score": 1, "last_activity_date": 1491412734, "last_edit_date": 1592644375, "creation_date": 1491412734, "answer_id": 43237702, "question_id": 43237341, "link": "https://stackoverflow.com/questions/43237341/vba-put-a-space-after-or-before-a-upppercase-letter-in-a-string/43237702#43237702", "title": "VBA: Put a space after or before a upppercase letter in a string", "body": "<p>In addition to @Forty3's comment to your question, the answer on how to use Regular Expressions in VBA is <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">here</a>.</p>\n<p>With that being said you are then looking for the regular expression to match <code>John</code>, <code>Williams</code>, <code>Smith</code> which is <strong><code>([A-Z])([a-z]+.*?)</code></strong></p>\n<pre><code>Dim regex As New RegExp\nDim matches As MatchCollection\nDim match As match\nDim name As String\n\n\nregex.Global = True\nregex.Pattern = &quot;([A-Z])([a-z]+.*?)&quot;\nname = &quot;JohnWilliamsSmith&quot;\nSet matches = regex.Execute(name)\n\nFor Each match In matches\n    name = Replace(name, match.Value, match.Value + &quot; &quot;)\nNext match\n\nname = Trim(name)\n</code></pre>\n<p>This gives me <code>John Williams Smith</code>. Of course, additional coding will be needed to account for cases like <code>WillWilliamsWilliamson</code>.</p>\n"}], "owner": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "accepted_answer_id": 43237572, "answer_count": 2, "score": 1, "last_activity_date": 1491412734, "creation_date": 1491411547, "question_id": 43237341, "link": "https://stackoverflow.com/questions/43237341/vba-put-a-space-after-or-before-a-upppercase-letter-in-a-string", "title": "VBA: Put a space after or before a upppercase letter in a string", "body": "<p>I have a sequence of texts that represent customers names, but they do not have spaces between each word/name (for example: <em>JohnWilliamsSmith</em>). However the words can be differentiated because the first letter of each word is uppercase.</p>\n\n<p>So I need to transpose this list of customers strings to their regular format, with spaces between each word. So I want <em>JohnWilliamsSmith</em> to become <em>John Williams Smith</em>. However, I couldn't think of an immediate way to achieve this, and I believe that no combination of Excel formulas can offer this result.</p>\n\n<p>Thus, I think the only solution would be to set up a Macro. It might be a <code>Function</code> to be used as a formula, or a code in module to work the data in a certain range (imagine that the list is in <code>Range (\"A2: A100\")</code>).</p>\n\n<p>Does anyone have any idea how I can do this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1491411546, "creation_date": 1491411546, "answer_id": 43237340, "question_id": 43237072, "link": "https://stackoverflow.com/questions/43237072/including-a-variable-in-an-r1c1-formula/43237340#43237340", "title": "including a variable in an R1C1 formula", "body": "<p>you could use:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=CONCATENATE(IF(RC[-1]&lt;R[-1]C[-1],R[-1]C[-1]-RC[-1] &amp;\"\" less\"\", IF(RC[-1]&gt;R[-1]C[-1],RC[-1]-R[-1]C[-1]&amp;\"\" More\"\",\"\" same as last week\"\")), \"\" wands = \"\",\" &amp; RelCov &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7237384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe7beeea585a2498de81036e5ec0934d?s=128&d=identicon&r=PG&f=1", "display_name": "aoswald", "link": "https://stackoverflow.com/users/7237384/aoswald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 43237340, "answer_count": 1, "score": 1, "last_activity_date": 1491411546, "creation_date": 1491410733, "question_id": 43237072, "link": "https://stackoverflow.com/questions/43237072/including-a-variable-in-an-r1c1-formula", "title": "including a variable in an R1C1 formula", "body": "<p>This code retrieves the number of filtered data - RelCov.  It then counts the number of \"wands\" in that group of RelCov.  The R1C1 formula compares the weeks number of RelCov last week and returns the the differnce as \"?more\", \"?less\" or \"Same as last week\"   I then wnat to append on the end of that formula, the number of \"wands\" that are RelCov.  Whenever i include &amp; wands in the formula, I get a \"NAME\" error.  This is what I have:</p>\n\n<pre><code>    Windows(\"usertemp.xls\").Activate\n    Sheets(\"Sheet1\").Select\n    Dim RelCov As Integer\n    RelCov = Application.CountIf(Range(\"ah:ah\"), \"Relevant Covered\")\n    ActiveSheet.Range(\"$A$1:$AO$18690\").AutoFilter Field:=34, Criteria1:=\"Relevant Covered\"\n    Dim wands As Integer\n    wands = Application.CountIf(Range(\"b:b\"), \"WAND*\")\n'    MsgBox wands\n    Windows(\"User File Analysis test.xlsm\").Activate\n    Sheets(\"Sheet1\").Select\n    Range(\"ReleventCovered\").Select\n    ActiveCell = RelCov '&amp; Chr(10) &amp; wands &amp; \" wands\"\n    ActiveCell.Offset(rowOffset:=0, columnOffset:=1).Activate\n    ActiveCell.FormulaR1C1 = \"=if(rc[-1]&lt;r[-1]c[-1],r[-1]c[-1]-rc[-1]&amp;\"\" less\"\",if(rc[-1]&gt;r[-1]c[-1],rc[-1]-r[-1]c[-1]&amp;\"\" More\"\",\"\" same as last week\"\"))&amp; \"\" wands = \"\"\"\n</code></pre>\n\n<p>When I include &amp; wands &amp; after \"\"Wands = \"\" at the end of the formula, I get a \"Name\" error.  How do I include the \"wands\" variable at the end of the forumula with getting the error?</p>\n"}, {"tags": ["excel", "combobox", "controls", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7805290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2693b5fef88c9dcf9ef51688f89ad0af?s=128&d=identicon&r=PG&f=1", "display_name": "D. Dickinson", "link": "https://stackoverflow.com/users/7805290/d-dickinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1491412766, "last_edit_date": 1495535450, "creation_date": 1491412766, "answer_id": 43237709, "question_id": 43236725, "link": "https://stackoverflow.com/questions/43236725/combobox-on-a-userform-no-values-from-spreadsheet-how-to-get-value-of-combob/43237709#43237709", "title": "Combobox on a userform (no values from spreadsheet)...how to get value of combobox user has selected at runtime?", "body": "<p>Nevermind; I got it:</p>\n\n<pre><code>Private Sub Draw_Member_Shapes()\n\nDim con As Control\nDim ArrValUe\nDim i\n\nFor Each con In Me.Controls\ni = 1\n    If TypeName(con) = \"ComboBox\" Then\n        If con.Name = \"MemberSectionList\" &amp; i Then\n        ArrValUe = IsInArray(con.value, AISC_Manual_Label)\n        MsgBox con &amp; \" corresponds to AISC_Manual_Label: \" &amp; ArrValUe\n        End If\n    End If\ni = i + 1\nNext\n\nEnd Sub\n</code></pre>\n\n<p>A few notes based on what I figured out:</p>\n\n<ul>\n<li>The combobox I needed to find (\"MemberSectionList\" &amp; i) had previously been generated in another sub, as a OBJECT, not CONTROL</li>\n<li>IsInArray() came from another user on this forum, JimmyPena, from here: <a href=\"https://stackoverflow.com/questions/10951687/how-to-search-for-string-in-an-array\">How to search for string in an array</a> ...with some minor tweaking on my end, so props to him for a solid answer...</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 7805290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2693b5fef88c9dcf9ef51688f89ad0af?s=128&d=identicon&r=PG&f=1", "display_name": "D. Dickinson", "link": "https://stackoverflow.com/users/7805290/d-dickinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491412766, "creation_date": 1491409536, "last_edit_date": 1531164843, "question_id": 43236725, "link": "https://stackoverflow.com/questions/43236725/combobox-on-a-userform-no-values-from-spreadsheet-how-to-get-value-of-combob", "title": "Combobox on a userform (no values from spreadsheet)...how to get value of combobox user has selected at runtime?", "body": "<p>Ok, I think this should be a much more simple question: I am working within a userform, and I need to get the value of any and all comboboxes on that userform. </p>\n\n<p>Note that none of the dropdown list values in the comboboxes have come from an excel spreadsheet (the only examples I have seen always reference cells in a sheet, but my values are added at runtime, so these are no good for a n00b like me to understand).</p>\n\n<p>I have this as far as code:</p>\n\n<pre><code>Dim con As Controls\nDim ArrValUe\nDim i\n\nFor Each con In Me.Controls\ni = 1\n    If TypeName(con) = \"ComboBox\" Then\n        If con.Name = \"MemberSectionList\" &amp; i Then\n        ArrValUe = IsInArray(Me.Controls(con).Text, AISC_Manual_Label)\n        MsgBox con &amp; \" corresponds to AISC_Manual_Label: \" &amp; ArrValUe\n        Else\n        MsgBox \"This control name was not named MemberSectionList &amp; i: \" &amp; con.Name\n        End If\n        Else\n        MsgBox \" I cannot find a control with TypeName = 'Combobox', Dave!\"\n    End If\ni = i + 1\nNext\n</code></pre>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "edited": false, "score": 0, "creation_date": 1491410059, "post_id": 43236714, "comment_id": 73543864, "body": "I&#39;m sure about it.. how it should be looks like? I tried and nothing happened. in addition can you edit the &quot;TO&quot; to &quot;aaa@aa.com&quot;. thanks."}, {"owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "edited": false, "score": 0, "creation_date": 1491550158, "post_id": 43236714, "comment_id": 73612465, "body": "I tired to edit it to my code but I got compiler error. any more ideas?"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1491410343, "last_edit_date": 1491410343, "creation_date": 1491409497, "answer_id": 43236714, "question_id": 43236649, "link": "https://stackoverflow.com/questions/43236649/vba-code-for-multiply-ranges-from-more-than-one-sheet/43236714#43236714", "title": "VBA code for multiply ranges from more than one Sheet", "body": "<pre><code>        dim myVariable as string\n        dim newRange as string\n        newRange = Range.Value \n        myVariable = myVariable + newRange\n\n        With .Item\n            .To = \"aaa@aa.com\"\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"My subject\"\n            .Body = myVariable\n            .Send\n        End With\n</code></pre>\n\n<p>Does this help you figure out what youre trying to do?</p>\n"}], "owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491410343, "creation_date": 1491409315, "last_edit_date": 1531164843, "question_id": 43236649, "link": "https://stackoverflow.com/questions/43236649/vba-code-for-multiply-ranges-from-more-than-one-sheet", "title": "VBA code for multiply ranges from more than one Sheet", "body": "<p>I'm training to write VBA code that combine two sheets data rage to one email and send it.\nI used below code for my debug but I failed to do so time after time.\nBelow code send one sheet range data and I want to add it additional rage from sheet2 <code>(Worksheets(\"Sheet2\").Range(\"b3:b30\")</code></p>\n\n<pre><code>Sub Mail_take_2()\n\n    Dim AWorksheet As Worksheet\n    Dim Sendrng As Range\n    Dim rng As Range\n\n    On Error GoTo StopMacro\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n    Set Sendrng = Worksheets(\"Sheet1\").Range(\"c2:j45\")\n\n    Set AWorksheet = ActiveSheet\n\n    With Sendrng\n\n        .Parent.Select\n\n        Set rng = ActiveCell\n\n        .Select\n\n        ActiveWorkbook.EnvelopeVisible = True\n        With .Parent.MailEnvelope\n\n            .Introduction = \"This is test mail 2.\"\n\n            With .Item\n                .To = \"aaa@aa.com\"\n                .CC = \"\"\n                .BCC = \"\"\n                .Subject = \"My subject\"\n                .Send\n            End With\n\n        End With\n\n        rng.Select\n    End With\n\n    AWorksheet.Select\n\nStopMacro:\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n    ActiveWorkbook.EnvelopeVisible = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "inputbox"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1491410967, "post_id": 43236529, "comment_id": 73544418, "body": "Watch out for implicit <code>ActiveSheet</code> references: unqualified <code>Range</code> calls implicitly refer to the active worksheet - this is the reason behind several hundreds of Stack Overflow questions. Always qualify <code>Range</code>, <code>Rows</code>, <code>Columns</code>, <code>Names</code> and <code>Cells</code> calls with an explicit <code>Worksheet</code> object."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1491410291, "post_id": 43236564, "comment_id": 73544000, "body": "never mind I added the workbook and sheet and it worked. THANKS"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1491410521, "post_id": 43236564, "comment_id": 73544138, "body": "The <code>Sheets</code> collection can contain <code>Chart</code> objects. When retrieving a <code>Worksheet</code> you should always use the <code>Worksheets</code> collection, otherwise you&#39;re making an implicit assumption. Also, OP didn&#39;t &quot;not fully qualify where the range is&quot;, OP was testing whether a string literal was empty! Edit your answer and I&#39;ll upvote it and delete mine =)"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1491410614, "post_id": 43236564, "comment_id": 73544193, "body": "@Mat&#39;sMug fair enough. That&#39;s something Ill keep in mind. I keep forgetting to leave strategic typos for you &lt;3"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1491410788, "post_id": 43236564, "comment_id": 73544307, "body": "@Mat&#39;sMug I edited my answer to be more factual. Thanks for keeping me in check - i do learn quite a bit form you :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1491411062, "post_id": 43236564, "comment_id": 73544482, "body": "While it is generally not considered &#39;best practice&#39; to inherit a parent worksheet, that <i>could</i> have been written as <code>If IsEmpty([C37]) Then</code> but better as above or like <code>If IsEmpty([Sheet1!C37]) Then</code>, the latter inferring the parent workbook as the ActiveWorbook."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1491411347, "post_id": 43236564, "comment_id": 73544649, "body": "@Jeeped indeed! Square bracket expressions are late-bound (slower) calls with no compile-time checks though."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1491411439, "post_id": 43236564, "comment_id": 73544700, "body": "Agreed @Mat&#39;sMug, just throwing other possibilities out there. I never use them myself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1491411532, "post_id": 43236564, "comment_id": 73544744, "body": "&#39;<i>...  which is a string literal and not a range object.</i>&#39; and <b>never</b> &#39;empty&#39;!"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 3, "last_activity_date": 1491410833, "last_edit_date": 1491410833, "creation_date": 1491409054, "answer_id": 43236564, "question_id": 43236529, "link": "https://stackoverflow.com/questions/43236529/if-statement-with-an-inputbox-not-working/43236564#43236564", "title": "If Statement with an InputBox - Not Working", "body": "<pre><code> If IsEmpty(ThisWorkbook.Worksheets(\"Sheet1\").Range(\"C37\"))\n</code></pre>\n\n<p>The issue is you did not tell the <code>IsEmpty</code> function to check for a range. You told it to check for \"C37\" which is a string literal and not a range object. </p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1491416061, "post_id": 43238518, "comment_id": 73547477, "body": "This answer doesn&#39;t bring anything new to the table."}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1491496147, "post_id": 43238518, "comment_id": 73590332, "body": "So now it&#39;s not asking for the inputbox even if the cell is empty"}, {"owner": {"reputation": 187, "user_id": 7765140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vThNB.jpg?s=128&g=1", "display_name": "Rajesh S", "link": "https://stackoverflow.com/users/7765140/rajesh-s"}, "reply_to_user": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1491583191, "post_id": 43238518, "comment_id": 73634543, "body": "@Ladymrt,, I&#39;ve posted only a portion you please write complete code,, mine codes are tested, please do it again."}, {"owner": {"reputation": 187, "user_id": 7765140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vThNB.jpg?s=128&g=1", "display_name": "Rajesh S", "link": "https://stackoverflow.com/users/7765140/rajesh-s"}, "edited": false, "score": 0, "creation_date": 1491583834, "post_id": 43238518, "comment_id": 73634891, "body": "@Ladymart additionally you can use this one,   If isEmpty(Range(&quot;A1&quot;).Value) = True Then  Var=Inputbox(&quot;Enter Value&quot;)   Worksheets (&quot;Sheet1&quot;). Value = var  Else"}], "tags": [], "owner": {"reputation": 187, "user_id": 7765140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vThNB.jpg?s=128&g=1", "display_name": "Rajesh S", "link": "https://stackoverflow.com/users/7765140/rajesh-s"}, "is_accepted": false, "score": -1, "last_activity_date": 1491415418, "creation_date": 1491415418, "answer_id": 43238518, "question_id": 43236529, "link": "https://stackoverflow.com/questions/43236529/if-statement-with-an-inputbox-not-working/43238518#43238518", "title": "If Statement with an InputBox - Not Working", "body": "<p>If IsEmpty(Range( \"C37\" )) = True Then </p>\n\n<p>SIGN = InputBox( \"Enter Your Name:\") </p>\n\n<p>Range( \"C37\" ).Value = SIGN</p>\n\n<p>Else </p>\n\n<p>Your code </p>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "is_accepted": false, "score": 0, "last_activity_date": 1491507666, "creation_date": 1491507666, "answer_id": 43264379, "question_id": 43236529, "link": "https://stackoverflow.com/questions/43236529/if-statement-with-an-inputbox-not-working/43264379#43264379", "title": "If Statement with an InputBox - Not Working", "body": "<p>Okay. I've solved my problem.</p>\n\n<p>I have a button that resets this form to clear contents of the cells and start over.</p>\n\n<p>Unfortunately, I couldn't find a way to easily clear contents of a merged cell, so instead, I used </p>\n\n<pre><code>Range(\"MERGEDCELL\").Value = \" \"\n</code></pre>\n\n<p>to essentially make the cell blank. HOWEVER, my IsEmpty is not going to see those cells as empty because they have a space in them, thus why when it looks empty to me (but it's not) the InputBox doesn't pop up...</p>\n\n<p>I've looked around for alternatives to clear contents of merged cell with little to no success. If anyone has suggestions in that area, let me know. Thanks again for everything everyone.</p>\n"}], "owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 43236564, "answer_count": 3, "score": 2, "last_activity_date": 1491507666, "creation_date": 1491408957, "last_edit_date": 1491506116, "question_id": 43236529, "link": "https://stackoverflow.com/questions/43236529/if-statement-with-an-inputbox-not-working", "title": "If Statement with an InputBox - Not Working", "body": "<p>I am trying to write a macro that looks at a cell and tells me if it's empty, and if it is, open up an input box to fill in the cell. The below code is not opening the message box regardless if the cell is empty or not. C37 IS A MERGED CELL which I know could be mucking things up. What am I missing here?   </p>\n\n<pre><code>If IsEmpty(\"C37\") Then\n\n\nDim SIGN As String          'Sign-off\n\nSIGN = InputBox(\"Enter Your Name:\", \"Dispositioned By:\")\n\nRange(\"C37\").Value = SIGN\nRange(\"G37\").Value = Format(Now(), \"MM/DD/YYYY\")\n\nElse\n\nRange(\"B26\").Select\n\nEnd If\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>With ActiveSheet</p>\n\n<pre><code> If IsEmpty(ActiveWorkbook.ActiveSheet.Range(\"C23\")) Then\n\n Dim SIGN As String          'Sign-off\n\n SIGN = InputBox(\"Enter Your Name:\", \"Dispositioned By:\")\n\n Range(\"C23\").Value = SIGN\n Range(\"G23\").Value = Format(Now(), \"MM/DD/YYYY\")\n\n Else\n\n Range(\"B13\").Select\n\n End If\n End With\n</code></pre>\n\n<p>Is the new code I've ended up with. This is not opening the inputbox even when the cell is \"empty\"</p>\n\n<p>Is there a different phrase I should be using than IsEmpty?</p>\n"}, {"tags": ["vba", "excel", "pdf"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1491420578, "post_id": 43236526, "comment_id": 73550168, "body": "This exports them all because you do <code>For Each ws in Worksheets</code>. This loops through each worksheet in the workbook and exports it."}, {"owner": {"reputation": 33, "user_id": 7821859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39f65d32938ed0f56c23fd281826e480?s=128&d=identicon&r=PG&f=1", "display_name": "Scott B.", "link": "https://stackoverflow.com/users/7821859/scott-b"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1491430985, "post_id": 43236526, "comment_id": 73555364, "body": "What would you suggest I use in place of that?"}], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": true, "score": 1, "last_activity_date": 1491434152, "creation_date": 1491434152, "answer_id": 43243130, "question_id": 43236526, "link": "https://stackoverflow.com/questions/43236526/macro-to-export-certain-excel-sheets-to-separate-pdf/43243130#43243130", "title": "Macro to Export Certain Excel Sheets to Separate PDF", "body": "<p>You need to fill the array <code>sheets_to_select</code> with the names of the sheets you want this to export. Otherwise, this will work for you.</p>\n\n<pre><code>Sub ExportToPDFs()  \n' PDF Export Macro  \n' C:\\ *location*  \n' Sheets(Array(\"*selected sheets*\")).Select  \n\nDim nm As String  \nDim ws As Worksheet  \nDim i as Variant, sheets_to_select as Variant\n\nsheets_to_select = Array(\"Sheet1\",\"Sheet2\",\"Sheet3\")\n\nFor Each i in sheets_to_select  \n   Thisworkbook.Sheets(i).ExportAsFixedFormat Type:=xlTypePDF, _  \n      Filename:=\"C:\\*location*\" &amp; \"*Report Title*\" &amp; i &amp; Thisworkbook.Sheets(\"*The sheet you need the value of D8 from\").Range(\"D8\").Value &amp; \".pdf\", _  \n      Quality:=xlQualityStandard, IncludeDocProperties:=True, _  \n      IgnorePrintAreas:=False, OpenAfterPublish:=True  \n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1499824939, "creation_date": 1499824939, "answer_id": 45047130, "question_id": 43236526, "link": "https://stackoverflow.com/questions/43236526/macro-to-export-certain-excel-sheets-to-separate-pdf/45047130#45047130", "title": "Macro to Export Certain Excel Sheets to Separate PDF", "body": "<p>Great question!  I think this should do what you want...jsut modify the script to suit your needs...</p>\n\n<pre><code>Sub ExportToPDFs()\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\nws.Select\nnm = ws.Name\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\nFilename:=\"C:\\your_path_here\\\" &amp; nm &amp; \".pdf\", _\nQuality:=xlQualityStandard, IncludeDocProperties:=True, _\nIgnorePrintAreas:=False, OpenAfterPublish:=False\n\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7821859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39f65d32938ed0f56c23fd281826e480?s=128&d=identicon&r=PG&f=1", "display_name": "Scott B.", "link": "https://stackoverflow.com/users/7821859/scott-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3607, "favorite_count": 1, "accepted_answer_id": 43243130, "answer_count": 2, "score": 2, "last_activity_date": 1538177604, "creation_date": 1491408945, "last_edit_date": 1538177604, "question_id": 43236526, "link": "https://stackoverflow.com/questions/43236526/macro-to-export-certain-excel-sheets-to-separate-pdf", "title": "Macro to Export Certain Excel Sheets to Separate PDF", "body": "<p>I have a macro to export certain sheets in a workbook to separate PDF's (for reporting purposes). It works properly for me in one workbook, however, in a different workbook it is exporting ALL sheets. I can't figure out where I am going wrong. To make things easier, I italicized the spots where I would customize it for my purposes.</p>\n\n<pre><code>Sub ExportToPDFs()  \n' PDF Export Macro  \n' C:\\ *location*  \n' Sheets(Array(\"*selected sheets*\")).Select  \n\nDim nm As String  \nDim ws As Worksheet  \n\nFor Each ws In Worksheets  \nws.Select  \nnm = ws.Name  \n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _  \nFilename:=\"C:\\*location*\" &amp; \"*Report Title*\" &amp; nm &amp; Range(\"D8\").Value &amp; \".pdf\", _  \nQuality:=xlQualityStandard, IncludeDocProperties:=True, _  \nIgnorePrintAreas:=False, OpenAfterPublish:=True  \n\nNext ws  \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1491408539, "post_id": 43236194, "comment_id": 73542867, "body": "Excel formula is enough to achieve this. Would you prefer to do it by <code>VBA</code> or regular excel formulas?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1491408609, "post_id": 43236194, "comment_id": 73542922, "body": "No attempt at a formula nor even row and column headings in the image of sample data."}, {"owner": {"reputation": 11, "user_id": 7821197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463a2fee3a0942c62c4c0afaec8755cd?s=128&d=identicon&r=PG", "display_name": "brendes", "link": "https://stackoverflow.com/users/7821197/brendes"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1491408988, "post_id": 43236194, "comment_id": 73543177, "body": "@harun24hr I appreciate the follow-up. There would be no difference to me, but I think VBA might be better so there is less of a chance of the formula being accidentally fudged by other users."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1491409635, "creation_date": 1491409635, "answer_id": 43236755, "question_id": 43236194, "link": "https://stackoverflow.com/questions/43236194/search-column-in-one-sheet-for-cells-containing-string-then-reference-them-anot/43236755#43236755", "title": "Search column in one sheet for cells containing string, then reference them another sheet", "body": "<p>Here is a single sheet example, without VBA, that you can adapt to your needs:</p>\n\n<p>In <strong>D1</strong> enter:</p>\n\n<p>Acme</p>\n\n<p>In <strong>D2</strong> enter the <strong>array formula</strong>:</p>\n\n<pre><code>=IFERROR(INDEX($A$1:$B$9,SMALL(IF($A$1:$A$9=$D$1,ROW($A$1:$A$9)),ROW(1:1)),2),\"\")\n</code></pre>\n\n<p>and copy down.</p>\n\n<p><strong>Array formulas</strong> must be entered with <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> rather than just the <kbd>Enter</kbd> key.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JvzDe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JvzDe.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1491411341, "last_edit_date": 1491411341, "creation_date": 1491410483, "answer_id": 43236989, "question_id": 43236194, "link": "https://stackoverflow.com/questions/43236194/search-column-in-one-sheet-for-cells-containing-string-then-reference-them-anot/43236989#43236989", "title": "Search column in one sheet for cells containing string, then reference them another sheet", "body": "<p>This will find the first row of sheet1 with customer \"Acme\".  It will find the first row of sheet2 with the customer name \"Acme\" and add the contents of sheet1 \"Acme\" row column C to whatever is in sheet2 Acme row column \"C\".  It assumes these numbers are values, not strings.  You can change that by deleting the addition.  You can also change columns or anything else to suit your needs.</p>\n\n<pre><code>Sub updateSheet2()\nDim customerNameColumnSheet1 As String, customerNameColumnSheet2 As String    \nDim lastRowSheet1 As Long\nDim lastRowSheet2 As Long\nDim customerName As String\nDim Sheet1Row As Long\nDim Sheet2Row As Long\n\ncustomerNameColumnSheet1 = \"A\"\ncustomerNameColumnSheet2 = \"A\"\ncustomerName = \"Acme\" ' or customerName = Sheet1.Range(\"A12\").value, etc\n\nlastRowSheet1 = Sheet1.Cells(Rows.Count, customerNameColumnSheet1).End(xlUp).row\nlastRowSheet2 = Sheet2.Cells(Rows.Count, customerNameColumnSheet2).End(xlUp).row\n\nWith Sheet1.Range(customerNameColumnSheet1 &amp; \"1:\" &amp; customerNameColumnSheet1 &amp; lastRowSheet1)\n    Set c = .Find(customerName, LookIn:=xlValues, lookat:=xlPart)\n    If Not c Is Nothing Then\n        Sheet1Row = c.row\n        With Sheet2.Range(customerNameColumnSheet2 &amp; \"1:\" &amp; customerNameColumnSheet2 &amp; lastRowSheet2)\n            Set D = .Find(customerName, LookIn:=xlValues, lookat:=xlPart)\n            If Not D Is Nothing Then\n                Sheet2Row = D.row\n                Sheet2.Range(\"C\" &amp; Sheet2Row).Value = Sheet1.Range(\"C\" &amp; Sheet1Row).Value' + Sheet2.Range(\"C\" &amp; Sheet2Row).Value  ' assuming values, not string\n            End If\n        End With\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7821197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463a2fee3a0942c62c4c0afaec8755cd?s=128&d=identicon&r=PG", "display_name": "brendes", "link": "https://stackoverflow.com/users/7821197/brendes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1491411341, "creation_date": 1491408035, "last_edit_date": 1491408771, "question_id": 43236194, "link": "https://stackoverflow.com/questions/43236194/search-column-in-one-sheet-for-cells-containing-string-then-reference-them-anot", "title": "Search column in one sheet for cells containing string, then reference them another sheet", "body": "<p>What I'd like to do is search for a specific string in a column in one sheet (let's call it Sheet 1), and reference the values in a column <em>adjacent</em> to those matched cells in another sheet (Sheet 2).</p>\n\n<p>To make it more clear, here's a diagram illustrating what I'm trying to do:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tmMR2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tmMR2.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I'd like to do is search the Customer column in Sheet 1 for \"Acme\", then populate a column in Sheet 2 with each Acme entry's corresponding sample, ignoring any non-Acme entries.</p>\n\n<p>I'm going to guess that this would be more complex than a regular Excel macro and would require a VBA function. Either way, I would be immensely grateful if someone could at least point me in the right direction as to where to begin searching.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1491420186, "post_id": 43236117, "comment_id": 73549929, "body": "It is certainly possible to do.  It will also be easier for someone to show you how to amend your existing code if they can see the existing code.  Please paste the code into the question or you will find that your question gets downvoted for not providing it."}], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 1832175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6559a21eddd2c8d44c816c0601d78d6e?s=128&d=identicon&r=PG", "display_name": "Marius Katinas", "link": "https://stackoverflow.com/users/1832175/marius-katinas"}, "is_accepted": false, "score": 2, "last_activity_date": 1491423122, "creation_date": 1491423122, "answer_id": 43240760, "question_id": 43236117, "link": "https://stackoverflow.com/questions/43236117/save-pdf-from-excel-dynamically/43240760#43240760", "title": "Save PDF from excel dynamically", "body": "<p>There are few ways to do this.</p>\n\n<p>First you can save each sheets print area to PDF using this function:</p>\n\n<p>This function takes in fileName, which can be parsed from cell values as you want, the folder path for PDF's to be saved and sheet, from which the print area is taken.</p>\n\n<pre><code>Function PrintToPDF(fileName As String, folderPath As String, ByVal currentSheet As Worksheet)\n\ncurrentSheet.Range(currentSheet.PageSetup.PrintArea).ExportAsFixedFormat Type:=xlTypePDF, fileName:= _\nfolderPath &amp; fileName &amp; \"_SKU.pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n\nEnd Function\n</code></pre>\n\n<p>Now you can edit the code a bit to print only custom ranges by adding additional argument to function:</p>\n\n<pre><code>Function PrintToPDF(fileName As String, folderPath As String, ByVal currentSheet As Worksheet, printRange As String)\n\ncurrentSheet.Range(printRange).ExportAsFixedFormat Type:=xlTypePDF, fileName:= _\nfolderPath &amp; fileName &amp; \"_SKU.pdf\", Quality:=xlQualityStandard, _\nIncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n\nEnd Function\n</code></pre>\n\n<p>To use this function do something like this:</p>\n\n<pre><code>Sub test()\n    Call PrintToPDF(\"name\", \"C:/Path/To/Folder/\", Worksheets(1))\nEnd Sub\n</code></pre>\n\n<p>Or in second case:</p>\n\n<pre><code>Sub test()\n    Call PrintToPDF(\"1\", \"C:/Path/To/Folder/\", Worksheets(1), \"A1:C20\")\nEnd Sub\n</code></pre>\n\n<p>Now lets say you have a table with name values and sheet numbers (and ranges if you don't want to use print area):</p>\n\n<pre><code>TEST1    1\nTEST2    2\nTEST3    3\n</code></pre>\n\n<p>Then loop through your values in this table and call the function with cell values as arguments:</p>\n\n<pre><code>Sub test()\n    For i = 1 To Sheets(1).UsedRange.Rows.Count\n        Call PrintToPDF(Sheets(1).Cells(i, 1).Value, \"C:/Path/To/Folder/\", Worksheets(Sheets(1).Cells(i, 2).Value))\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Or as how you like to define your names/sheets/ranges range.</p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 21, "user_id": 7818088, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154916068061208/picture?type=large", "display_name": "Sona", "link": "https://stackoverflow.com/users/7818088/sona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491423122, "creation_date": 1491407789, "last_edit_date": 1491419969, "question_id": 43236117, "link": "https://stackoverflow.com/questions/43236117/save-pdf-from-excel-dynamically", "title": "Save PDF from excel dynamically", "body": "<p>I have a table in Excel and have a macro to save the ActiveSheet as pdf. Is there anyway I can:  </p>\n\n<ul>\n<li>Select the columns to be printed. Right now I just hide them.</li>\n<li>Save multiple pdf with the same name, concatenated by unique SKU: name_SKU.pdf</li>\n<li>A way to filter the column \"SKU\" and save the pdf for that SKU and automatically go to the next unique SKU and save the pdf and so on.  </li>\n</ul>\n\n<p>Currently I filter the SKU column manually and click on \"Save PDF\" macro each time. I want to reduce this task to a single click.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1491407161, "post_id": 43235777, "comment_id": 73541896, "body": "<code>Private</code> or <code>Public Column As Range</code>  then use <code>column</code>  <a href=\"http://www.vb6.us/tutorials/vb6-variable-scope\" rel=\"nofollow noreferrer\">vb6.us/tutorials/vb6-variable-scope</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1491412592, "post_id": 43237633, "comment_id": 73545343, "body": "You could also pass it the worksheet to generalize the function for different applications.  like"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1491412527, "creation_date": 1491412527, "answer_id": 43237633, "question_id": 43235777, "link": "https://stackoverflow.com/questions/43235777/vba-referencing-a-range-stored-as-variable-in-a-sorting-sub/43237633#43237633", "title": "VBA: Referencing a Range stored as variable in a Sorting sub", "body": "<p>It's probably not a good idea to use the word \"Column\" as a variable.  That should be a saved word.  Use Column1 instead and turn your sub into a function, passing it the range parameter.</p>\n\n<pre><code>Function SortCodeDsc(columnRange As Range)\n        ActiveWorkbook.Worksheets(\"Benchmark Data\").Sort.SortFields.Clear\n        ActiveWorkbook.Worksheets(\"Benchmark Data\").Sort.SortFields.Add Key:=columnRange, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Benchmark Data\").Sort\n    .SetRange Range(\"A4:HH100\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\n    End With\nEnd Function\n\nPrivate Sub Year_Click()\nDim column1 As Range\n\nSet column1 = ActiveWorkbook.Worksheets(\"Benchmark Data\").Range(\"A1:A100\")\n    Run SortCodeDsc(column1)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7821620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da9a56e2cdcee0a16fcf6fc22ce30bc?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Holland", "link": "https://stackoverflow.com/users/7821620/chris-holland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491412527, "creation_date": 1491406715, "last_edit_date": 1491407742, "question_id": 43235777, "link": "https://stackoverflow.com/questions/43235777/vba-referencing-a-range-stored-as-variable-in-a-sorting-sub", "title": "VBA: Referencing a Range stored as variable in a Sorting sub", "body": "<p>Very novice programmer so hope my question isn't too dumb. I'm trying to set make a common sorting subroutine that I can call, but where the sorting subroutine looks at a variable for the range. This way I can set the range elsewhere (such as the button where I call the subroutine) and not have it hard-coded into the sorting routine.</p>\n\n<p>So far my train of thought is this:</p>\n\n<pre><code>Dim Column As Range\nSub SortCodeDsc()\n        ActiveWorkbook.Worksheets(\"Benchmark Data\").Sort.SortFields.Clear\n        ActiveWorkbook.Worksheets(\"Benchmark Data\").Sort.SortFields.Add Key:=Range(\"A4:A100\").Value, SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Benchmark Data\").Sort\n    .SetRange Range(\"A4:HH100\")\n    .Header = xlGuess\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\n    End With\nEnd Sub\n\nPrivate Sub Year_Click()\n    Set Column = ActiveSheet.Range(\"A4:A100\")\n    Call SortCodeDsc\nEnd Sub\n</code></pre>\n\n<p>So where <code>Range(\"A4:A100\")</code> is in the Sub <code>SortCodeDsc</code> I would instead like to call variable Column which I Set to the range from <code>A4</code> to <code>A100</code>. How do I properly call that variable when calling the subroutine?</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1491406400, "post_id": 43235601, "comment_id": 73541350, "body": "remove the first <code>.ListColumns(1).Range,</code> It is used in SUMIFS but not COUNTIFS"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1491406420, "post_id": 43235601, "comment_id": 73541364, "body": "your syntax is wrong, should be range, criteria as many as you need.  <a href=\"https://support.office.com/en-gb/article/COUNTIFS-function-dda3dc6e-f74e-4aee-88bc-aa8c2a866842\" rel=\"nofollow noreferrer\">support.office.com/en-gb/article/&hellip;</a>"}, {"owner": {"reputation": 313, "user_id": 7554944, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/86cb2e523c06d16d1e582ec7f05f7bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Yohan Greenburg", "link": "https://stackoverflow.com/users/7554944/yohan-greenburg"}, "edited": false, "score": 0, "creation_date": 1491407049, "post_id": 43235601, "comment_id": 73541821, "body": "AH - such a simple fix.  Thank you both!"}], "owner": {"reputation": 313, "user_id": 7554944, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/86cb2e523c06d16d1e582ec7f05f7bd5?s=128&d=identicon&r=PG&f=1", "display_name": "Yohan Greenburg", "link": "https://stackoverflow.com/users/7554944/yohan-greenburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 676, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1491406199, "creation_date": 1491406199, "question_id": 43235601, "link": "https://stackoverflow.com/questions/43235601/type-mismatch-when-using-vba-countif", "title": "Type Mismatch When Using VBA CountIF()", "body": "<p>I am attempting to use the Countif() formula to get a count, but I keep getting an error of</p>\n\n<blockquote>\n  <p>Type mismatch</p>\n</blockquote>\n\n<p>What is incorrect in this VBA syntax that is causing the issue?</p>\n\n<pre><code>With Sheets(\"Symbiot\").ListObjects(\"Symbiot\")\n  salecount  = Application.WorksheetFunction.CountIfs(.ListColumns(1).Range, .ListColumns(1).Range, venuename, .ListColumns(5).Range, \"&gt;=\" &amp; entryd, .ListColumns(5).Range, \"&lt;=\" &amp; exitd)\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1491412994, "post_id": 43235544, "comment_id": 73545589, "body": "Does it have to be a proper check box? It might be easier if you did this with an &quot;x&quot; or something like that in a cell. It&#39;s possible otherwise, but not as easy. Unless I&#39;m missing something."}, {"owner": {"reputation": 37, "user_id": 5990345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e6e29f0b24157726b83d91f1cf2606e?s=128&d=identicon&r=PG&f=1", "display_name": "pmgibs", "link": "https://stackoverflow.com/users/5990345/pmgibs"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1491415359, "post_id": 43235544, "comment_id": 73547102, "body": "It does not need to be a check box, if it is easier with &quot;x&quot; thats fine. While trying different things I did associate each check box to the neighboring cell, so if its checked the cell value is &quot;True&quot; if not checked=&quot;False&quot;. This would fall in line with your &quot;x&quot; value in a cell, no?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1491416550, "post_id": 43235544, "comment_id": 73547804, "body": "If you need any more help or have any questions, feel free to let me know."}], "answers": [{"tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 1, "last_activity_date": 1491416731, "last_edit_date": 1491416731, "creation_date": 1491415898, "answer_id": 43238644, "question_id": 43235544, "link": "https://stackoverflow.com/questions/43235544/excel-vba-code-to-change-add-1-year-to-a-column-if-the-check-box-in-the-row-is-c/43238644#43238644", "title": "Excel VBA code to change add 1 year to a column if the check box in the row is checked", "body": "<p>Demo:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WxKuD.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WxKuD.gif\" alt=\"Demo\"></a></p>\n\n<p>The code to add a year to a range is pretty trivial</p>\n\n<p>You can use this sub and just pass it a range</p>\n\n<pre><code>Sub AddYearToRange(TheRange As Range)\nDim c\nFor Each c In TheRange\n    If IsDate(c.Value) Then c.Value = DateAdd(\"yyyy\", 1, c.Value)\nNext c\nEnd Sub\n</code></pre>\n\n<p>Example usage:</p>\n\n<p><code>AddYearToRange [C2:C5]</code></p>\n\n<p><code>AddYearToRange Range(\"C2:C5\")</code></p>\n\n<p><code>AddYearToRange Selection</code></p>\n\n<p><code>AddYearToRange Sheets(\"Sheet1\").Range(\"C2:C5\")</code></p>\n\n<p>If you want to do something like put an X next to the cell when it is changed, you can add this:</p>\n\n<pre><code>Sub AddYearToRange(TheRange As Range)\nDim c\nFor Each c In TheRange\n    If IsDate(c.Value) Then\n        c.Value = DateAdd(\"yyyy\", 1, c.Value)\n        c.offset(0,1).Value = \"X\"\n    End If\nNext c\nEnd Sub\n</code></pre>\n\n<p>If you only want to do it if a checkbox is checked, you can add this:</p>\n\n<pre><code>Sub AddYearToRange(TheRange As Range, CheckboxValue As Integer)\n'Unchecked = xlOff = -4146\n'Checked = 1\n'Multi-check checkbox = 2\nIf CheckboxValue &lt;&gt; 1 Then Exit Sub\nDim c\nFor Each c In TheRange\n    If IsDate(c.Value) Then\n        c.Value = DateAdd(\"yyyy\", 1, c.Value)\n        c.Offset(0, 1).Value = \"X\" 'This line places an X one column to the right\n    End If\nNext c\nEnd Sub\n</code></pre>\n\n<p>Then, just pass the checkbox value to it</p>\n\n<p>Example Usage:</p>\n\n<p><code>AddYearToRange [C2:C5], CheckBoxes(\"Check Box 1\").Value</code></p>\n\n<p>^ This example will only add a year to the range if the check box is checked.</p>\n"}], "owner": {"reputation": 37, "user_id": 5990345, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3e6e29f0b24157726b83d91f1cf2606e?s=128&d=identicon&r=PG&f=1", "display_name": "pmgibs", "link": "https://stackoverflow.com/users/5990345/pmgibs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 43238644, "answer_count": 1, "score": 2, "last_activity_date": 1491416731, "creation_date": 1491406014, "last_edit_date": 1491407787, "question_id": 43235544, "link": "https://stackoverflow.com/questions/43235544/excel-vba-code-to-change-add-1-year-to-a-column-if-the-check-box-in-the-row-is-c", "title": "Excel VBA code to change add 1 year to a column if the check box in the row is checked", "body": "<p>I need help writing a code that will add 1 year to the date in Column C(starting at C2) only if a check box(Form Control) in the same column is checked, then clear all check boxes, all this accomplished by clicking a button(Form Control).</p>\n\n<p>This is my current code for the button, which just adds 1 year to C2:</p>\n\n<pre><code>Sub Button211_Click()\nRange(\"$C2\").Value = DateAdd(\"yyyy\", 1, CDate(Range(\"$C2\")))\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "foreach"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 2, "creation_date": 1491405122, "post_id": 43235166, "comment_id": 73540466, "body": "<code>keyRangeSh1 = &quot;C&quot; &amp; rowSh1 keyRangeSh2 = &quot;C&quot; &amp; rowSh2 keyRangeSh3 = &quot;C&quot; &amp; rowSh3</code> These are all a single cell (<code>C2</code>), so there is no loop to occur."}, {"owner": {"reputation": 219, "user_id": 6791322, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/2RgQr.png?s=128&g=1", "display_name": "Alessandro95", "link": "https://stackoverflow.com/users/6791322/alessandro95"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1491405319, "post_id": 43235166, "comment_id": 73540598, "body": "I increase keyRangeSh1: rowsh1 = rowsh1 + 1 keyRangeSh1 = &quot;C&quot; &amp; rowsh1"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1491405431, "post_id": 43235166, "comment_id": 73540665, "body": "But when you set the loop with <code>For Each cellSh1 In Sh1.Range(keyRangeSh1)</code>, <code>keyRangeSh1</code> is already set to <code>&quot;C&quot; &amp; rowSh1</code> so your incrementing does nothing."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491405554, "post_id": 43235166, "comment_id": 73540755, "body": "Also, your if block has no condition. So it should through a compile time error. An if block should be &quot;If THIS then THAT&quot;. But Kyle is spot on, your loop starts off with one iteration to complete. If you want it to be able to increment itself within the loop then you need a WHILE loop."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1491405654, "post_id": 43235166, "comment_id": 73540822, "body": "Also, even if you increment keyRangeSh1, you are still referring to one cell. C2 is one cell, so is C3, and C4 and C5 and so on."}, {"owner": {"reputation": 486, "user_id": 6377101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/06cc0df790dd4134fffbd1a86751243a?s=128&d=identicon&r=PG&f=1", "display_name": "anonymous", "link": "https://stackoverflow.com/users/6377101/anonymous"}, "edited": false, "score": 0, "creation_date": 1491405665, "post_id": 43235166, "comment_id": 73540828, "body": "When you perform a loop, the <code>For Each</code> statement is <i>not</i> reevaluated on the next loop. Therefore, when you loop around again, it is not changing the range. Not to mention, that would make an infinite loop since you increase <code>rowSh1</code> each time, it doesn&#39;t know when to stop."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1491405720, "post_id": 43235166, "comment_id": 73540863, "body": "the naming convention is pretty weird. doesnt read so well IMO"}, {"owner": {"reputation": 219, "user_id": 6791322, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/2RgQr.png?s=128&g=1", "display_name": "Alessandro95", "link": "https://stackoverflow.com/users/6791322/alessandro95"}, "edited": false, "score": 0, "creation_date": 1491406002, "post_id": 43235166, "comment_id": 73541062, "body": "so is better compare the actual row and calculate the last row in the sheet and increase the actual until the first reach the last with a WHILE?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1491406347, "post_id": 43235166, "comment_id": 73541306, "body": "Better to work out the range before you start the loop. If you know it starts in row 2 and ends at a point held in a variable <code>rowSh1</code>, you could use <code>keyRangeSh1 = &quot;C2:C&quot; &amp; rowSh1</code> and <i>then</i> <code>For Each cellSh1 In Sh1.Range(keyRangeSh1)</code>"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491408050, "post_id": 43235166, "comment_id": 73542499, "body": "Yes, definitely find the last row for use in determining your range. You may want to consider using &#39;UsedRange&#39; here. It is worth noting that there are some instances where &#39;UsedRange&quot; isn&#39;t completely correct (often sized too large), but it should work for most purposes."}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491408086, "post_id": 43236180, "comment_id": 73542531, "body": "Why set the value of UsedRange to its own value?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491408141, "post_id": 43236180, "comment_id": 73542576, "body": "to get rid of formulas and leave only their result"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491408174, "post_id": 43236180, "comment_id": 73542599, "body": "Makes sense, I didnt think of that!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491408232, "post_id": 43236180, "comment_id": 73542636, "body": "If you want to keep formulas, just get rid of that code line! And if it solves your question you may want to mark answer as accepted. Thank you!"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491408293, "post_id": 43236180, "comment_id": 73542690, "body": "I would, but I&#39;m not the asker, I was just curious :)."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491409824, "post_id": 43236180, "comment_id": 73543724, "body": "@Alessandro95, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1491477822, "post_id": 43236180, "comment_id": 73576023, "body": "@Alessandro95, any chance to get feedback from you?"}, {"owner": {"reputation": 219, "user_id": 6791322, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/2RgQr.png?s=128&g=1", "display_name": "Alessandro95", "link": "https://stackoverflow.com/users/6791322/alessandro95"}, "edited": false, "score": 0, "creation_date": 1491556244, "post_id": 43236180, "comment_id": 73616217, "body": "Hi, i didn&#39;t understand your code and i didn&#39;t get it. I solve the problem with a simple while, thanks anyway"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1491556360, "post_id": 43236180, "comment_id": 73616288, "body": "You just have to follow the comment: to change the 3 names I used (&quot;sh1&quot;, &quot;sh2&quot; and &quot;sh3&quot;) to your actual worksheets names and then run it. nothing more"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1491556467, "post_id": 43236180, "comment_id": 73616378, "body": "you may want  to try my code anyway, since you&#39;d avoid loops and make all comparisons and calculations in one single shot"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1491408011, "creation_date": 1491408011, "answer_id": 43236180, "question_id": 43235166, "link": "https://stackoverflow.com/questions/43235166/for-each-vba-excel-it-makes-just-1-loop/43236180#43236180", "title": "For Each Vba excel it makes just 1 loop", "body": "<p>you could use this:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim sh1 As Worksheet, sh2 As Worksheet\n\n    Set sh1 = Worksheets(\"Sh1\") '&lt;--| change \"Sh1\" to your actual first sheet name\n    Set sh2 = Worksheets(\"Sh2\") '&lt;--| change \"Sh2\" to your actual second sheet name\n\n    With Worksheets(\"sh3\") '&lt;--| change \"Sh3\" to your actual third sheet name\n        .Range(Union(.Range(sh1.UsedRange.SpecialCells(xlCellTypeConstants, xlNumbers).Address), .Range(sh2.UsedRange.SpecialCells(xlCellTypeConstants, xlNumbers).Address)).Address).FormulaR1C1 = \"='\" &amp; sh1.Name &amp; \"'!RC - '\" &amp; sh2.Name &amp; \"'!RC\"\n        .UsedRange.Value = .UsedRange.Value\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 219, "user_id": 6791322, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/2RgQr.png?s=128&g=1", "display_name": "Alessandro95", "link": "https://stackoverflow.com/users/6791322/alessandro95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1491408011, "creation_date": 1491405039, "question_id": 43235166, "link": "https://stackoverflow.com/questions/43235166/for-each-vba-excel-it-makes-just-1-loop", "title": "For Each Vba excel it makes just 1 loop", "body": "<p>I have 3 sheets, and i have to compare values of cells in the first and the second sheet and write differents in the third.</p>\n\n<p>Here the code </p>\n\n<pre><code>Dim keyRangeSh1 As String\nDim keyRangeSh2 As String\nDim keyRangeSh3 As String\nDim cellSh1 As Range\nDim cellSh2 As Range\nDim cellSh3 As Range\n\nrowSh1 = 2\nrowSh2 = 2\nrowSh3 = 2\n\nkeyRangeSh1 = \"C\" &amp; rowSh1\nkeyRangeSh2 = \"C\" &amp; rowSh2\nkeyRangeSh3 = \"C\" &amp; rowSh3\nFor Each cellSh1 In Sh1.Range(keyRangeSh1)\n   For Each cellSh2 In Sh2.Range(keyRangeSh2)\n   'if\n   'rowsh1 = rowsh1 + 1\n   'keyRangeSh1 = \"C\" &amp; rowsh1 \n   'endif\n  Next cellSh2\nNext cellSh1\n</code></pre>\n\n<p>it makes the first round but it doesn't back to the second cell</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1491405270, "post_id": 43235117, "comment_id": 73540566, "body": "I can&#39;t see that you&#39;re putting any values back on the sheet.  Somewhere you&#39;ll need something like <code>ws.Cells(x + n, 5) = sumX</code>"}, {"owner": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1491406048, "post_id": 43235117, "comment_id": 73541096, "body": "Thanks a lot for the reply. It worked, I am getting the output, however it is just multiplying the column by 2, mayb the logic I used is not working.  Can you see the image I have attached with the question, it shows what output I want  Thanks a lot in advance"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1491407340, "post_id": 43235117, "comment_id": 73542027, "body": "It&#39;s a bit hard to understand your image - is Input/Output on the same sheet?  Is it showing columns A:E with column C mostly black?"}, {"owner": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1491407839, "post_id": 43235117, "comment_id": 73542335, "body": "sorry for that,  1. the output we can keep on the other sheet( sheet 2) 2. I kept column C black because we do not need it"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1491408283, "post_id": 43235117, "comment_id": 73542679, "body": "Your example output is a Pivot of the example input, with &#39;Repeat all item labels&#39; on - is there any reason you&#39;re reinventing the wheel to create something Excel can do automatically?"}, {"owner": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "edited": false, "score": 0, "creation_date": 1491470648, "post_id": 43235117, "comment_id": 73570913, "body": "Yes, there is the need because I want the output in the exactly same column order as we have to upload this file directly to the software, so the column order has to be the same."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1491407779, "creation_date": 1491407779, "answer_id": 43236113, "question_id": 43235117, "link": "https://stackoverflow.com/questions/43235117/not-getting-any-compilation-error-however-neither-getting-any-output-as-well/43236113#43236113", "title": "not getting any compilation error, however, neither getting any output as well", "body": "<p>The first problem I can see is that you don't put the values back on the sheet, as mentioned in my first comment.<br>\nMaybe after your <code>End If</code> you need something like:<br>\n<code>ws.Cells(x,2) = sumX</code></p>\n\n<p>The logic in your loop is also incorrect.  As far as I can see this is what it's doing:  </p>\n\n<p><strong>Loop 1</strong><br>\n<code>x</code> = 2<br>\n<code>sumX</code> = 78  (cells (2, 5) = range E2)<br>\n<code>n</code> = 0</p>\n\n<p>Using these values your IF condition is stating:  </p>\n\n<pre><code>If cell B2 = cell B2 AND cell D2 = cell D2 then  &lt;this is always true&gt;\n     sumX = 78 + 78\nelse\n     n = 1\nend if\n</code></pre>\n\n<p>As the condition is true then <code>n</code> hasn't increased, so loop 2 is stating:  </p>\n\n<pre><code>   sumX = 64\n   If cell B3 = cell B3 and cell D3 = cell D3 then &lt;again true&gt;\n        sumX = 64 + 64\n   else\n        n = n +1\n   end if  \n</code></pre>\n\n<p>Maybe use <code>n=1</code> before your loop?</p>\n"}], "owner": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 43236113, "answer_count": 1, "score": -1, "last_activity_date": 1491470779, "creation_date": 1491404916, "last_edit_date": 1531164843, "question_id": 43235117, "link": "https://stackoverflow.com/questions/43235117/not-getting-any-compilation-error-however-neither-getting-any-output-as-well", "title": "not getting any compilation error, however, neither getting any output as well", "body": "<p><a href=\"https://i.stack.imgur.com/B8Nxe.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B8Nxe.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub dowhileloop()\n\nDim x As Long\nDim sumX As Long\nDim ws As Worksheet\nDim n As Integer\n\nSet ws = ThisWorkbook.Worksheets(\"test data\")\n\nFor x = 2 To ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\nsumX = ws.Cells(x, 5).Value2\nn = 1\n\nIf ws.Cells(x, 2) = ws.Cells(x + n, 2) And ws.Cells(x, 4) = ws.Cells(x + n, \n4) Then\n    sumX = sumX + ws.Cells(x + n, 5).Value\n    ws.Cells(x + n, 6) = sumX\nElse\n    n = n + 1\n\nEnd If\nNext x\n\nEnd Sub\n</code></pre>\n\n<p>The logic I am using is not correct to get the Output I want. This is the first time I am writing a VBA.</p>\n\n<p>Please suggest on it.</p>\n"}, {"tags": ["vba", "excel", "excel-2013", "string-concatenation"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 1, "creation_date": 1491429077, "post_id": 43235063, "comment_id": 73554601, "body": "I think the problem is with how Excel saves to text files, not with the formulas you&#39;re using. See <a href=\"https://superuser.com/questions/867101/excel-adds-double-quotes-on-csv-export\">HERE</a>. You may need to use VBA to write the text file the way you want, or do some other hack (e.g., use $$$ as placeholders for quotes, then do a search/replace on the text file)."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1491405683, "last_edit_date": 1491405683, "creation_date": 1491405315, "answer_id": 43235251, "question_id": 43235063, "link": "https://stackoverflow.com/questions/43235063/vba-replacing-two-quotation-marks-with-one-generating-txt-files/43235251#43235251", "title": "vba replacing two quotation marks with one / generating txt files", "body": "<p>Try it as one of these,</p>\n\n<pre><code>With wsTemp.Cells(6, 1)\n    .Value = Format(wsSource.Cells(r, 3).Value2, \"\\T\\h\\e \\\"\"\\N\\u\\m\\b\\e\\r\\\"\" \\i\\s 0\")\n    .Offset(1, 0) = \"The \"\"Number\"\" is \" &amp; wsSource.Cells(r, 3).Value2\n    .Offset(2, 0) = \"The \" &amp; Chr(34) &amp; \"Number\" &amp; Chr(34) &amp; \" is \" &amp; wsSource.Cells(r, 3).Value2\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 2463808, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/899eef916f8649306df0542b8a5611c5?s=128&d=identicon&r=PG", "display_name": "user2463808", "link": "https://stackoverflow.com/users/2463808/user2463808"}, "is_accepted": true, "score": 0, "last_activity_date": 1491813633, "creation_date": 1491813633, "answer_id": 43318472, "question_id": 43235063, "link": "https://stackoverflow.com/questions/43235063/vba-replacing-two-quotation-marks-with-one-generating-txt-files/43318472#43318472", "title": "vba replacing two quotation marks with one / generating txt files", "body": "<p>So i did it as @xidgel suddgested, with FindAndReplaceText (fart)</p>\n\n<p>I replaced all <code>\"</code> with <code>$$$$</code> </p>\n\n<p>I created a file replace.bat</p>\n\n<pre><code>fart -r \"MYLOCATION*.txt\" $$$$ \\\"\n</code></pre>\n\n<p>And added shell execute command at the end of vba macro</p>\n\n<pre><code>Call Shell(\"C:\\LOCATION\\replace.bat\", vbNormalFocus)\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 2463808, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/899eef916f8649306df0542b8a5611c5?s=128&d=identicon&r=PG", "display_name": "user2463808", "link": "https://stackoverflow.com/users/2463808/user2463808"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 43318472, "answer_count": 2, "score": 2, "last_activity_date": 1491813633, "creation_date": 1491404778, "last_edit_date": 1491420558, "question_id": 43235063, "link": "https://stackoverflow.com/questions/43235063/vba-replacing-two-quotation-marks-with-one-generating-txt-files", "title": "vba replacing two quotation marks with one / generating txt files", "body": "<p>I have created a macro that generates txt files with data from every row in excel. I have problem with \" (quotation marks)</p>\n\n<p>Here is a line from VBA that makes problems:</p>\n\n<pre><code>wsTemp.Cells(6, 1).Value = \"The \"\"Number\"\" is \" &amp; wsSource.Cells(r, 3).Value\n</code></pre>\n\n<p>I need this: <code>The \"Number\" is MYNUMBER</code></p>\n\n<p>Instead of i get this: <code>\" The \"\"Number\"\" is\" MYNUMBER</code></p>\n\n<p>This does not work either:</p>\n\n<p><code>wsTemp.Cells(6, 1).Value = \"The\" &amp; Chr(34) &amp; \"Number\"\" is \" &amp; Chr(34) &amp; wsSource.Cells(r, 3).Val</code> (got the same output)</p>\n\n<p>I tried replacing <code>\"\"</code> with <code>Chr(34)</code> (didn't worked)</p>\n\n<p>I also tried replace function at the end:</p>\n\n<p><code>wsTemp.Cells(6, 1).Value = Replace(wsTemp.Cells(6, 1).Value, \"\"\"\", \"\"\")</code> (didn't worked) and\n<code>wsTemp.Cells(6, 1).Value = Replace(wsTemp.Cells(6, 1).Value, \"\"\"\", Chr(34))</code> (didn't worked as well)</p>\n\n<p>Replace() does works with other <code>Chr()</code> or with <code>Replace(wsTemp.Cells(6, 1).Value, \"\"\"\", \"\")</code> but not with Chr(34)</p>\n\n<p>Anyway, i need one \", not two ' or anything else</p>\n\n<p>I am saving generated files as xlCurrentPlatformText and .txt, I have also tried other formats</p>\n\n<p>Also, I have noticed this when I manually saved the same text from excel as txt</p>\n\n<p>I have tried almost everything and nothing worked</p>\n\n<p>I am using Win 7 and Excel 2013</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1491403289, "post_id": 43234354, "comment_id": 73538946, "body": "Remove the <code>Rows.</code> : <code>x.SpecialCells(xlCellTypeVisible).Address</code>"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1491403407, "post_id": 43234354, "comment_id": 73539035, "body": "Tried that @ScottCraner, no change unfortunately."}], "answers": [{"comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 2, "creation_date": 1491407291, "post_id": 43235642, "comment_id": 73541991, "body": "Thanks @CallumDA, that&#39;s perfect. Looks like Microsoft have a bug to fix and no appetite to do it."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 8, "last_activity_date": 1491406709, "last_edit_date": 1491406709, "creation_date": 1491406360, "answer_id": 43235642, "question_id": 43234354, "link": "https://stackoverflow.com/questions/43234354/specialcellsxlcelltypevisible-not-working-in-udf/43235642#43235642", "title": "SpecialCells(xlCellTypeVisible) not working in UDF", "body": "<p>It seems that <code>SpecialCells</code> is known to fail in UDFs. <em>A few sources: <a href=\"https://answers.microsoft.com/en-us/office/forum/office_2010-customize/udf-not-working-properly-count-comments/d586fa6b-5d44-405b-9471-946ddd2250e6\" rel=\"noreferrer\">1</a>, <a href=\"http://www.excelforum.com/excel-programming-vba-macros/863981-vba-range-specialcells-xlcelltypevisible-not-working-as-a-udf-print.html\" rel=\"noreferrer\">2</a>, <a href=\"https://www.mrexcel.com/forum/excel-questions/671676-specialcells-xlcelltypevisible-not-working-function.html\" rel=\"noreferrer\">3</a></em></p>\n\n<p>You'd have to create your own function. Perhaps something like this:</p>\n\n<pre><code>Function VisiblePercentRank(x As Range, RankVal As Double)\n    Debug.Print x.Address, VisibleCells(x).Address\n    VisiblePercentRank = WorksheetFunction.PercentRank(VisibleCells(x), RankVal)\nEnd Function\n\nPrivate Function VisibleCells(rng As Range) As Range\n    Dim r As Range\n    For Each r In rng\n        If r.EntireRow.Hidden = False Then\n            If VisibleCells Is Nothing Then\n                Set VisibleCells = r\n            Else\n                Set VisibleCells = Union(VisibleCells, r)\n            End If\n        End If\n    Next r\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 43235642, "answer_count": 1, "score": 8, "last_activity_date": 1491406709, "creation_date": 1491403098, "last_edit_date": 1495539998, "question_id": 43234354, "link": "https://stackoverflow.com/questions/43234354/specialcellsxlcelltypevisible-not-working-in-udf", "title": "SpecialCells(xlCellTypeVisible) not working in UDF", "body": "<p>Based on the <a href=\"https://stackoverflow.com/questions/43232697\">question</a> posed by @Chips Ahoy, I decided to create a UDF to find the PercentRank of visible cells in a range.</p>\n\n<p>While @Chips seems happy with my syntax correction, I am actually unable to get my UDF to work correctly.</p>\n\n<p>When I run the below, the two addresses output read identical. In my example using a formula of <code>=VisiblePercentRank($A$2:$A$41,0.5)</code> , both addresses output to the immediate window read <code>$A$2:$A$41</code>, despite rows 3 to 11 being hidden by an autofilter.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Function VisiblePercentRank(x As Range, RankVal As Double)\n    Debug.Print x.Address, x.Rows.SpecialCells(xlCellTypeVisible).Address\n    VisiblePercentRank = WorksheetFunction.PercentRank(x.Rows.SpecialCells(xlCellTypeVisible), RankVal)\nEnd Function\n</code></pre>\n\n<p><strong>Also</strong> tried removing <code>.Rows</code>:</p>\n\n<pre><code>Function VisiblePercentRank(x As Range, RankVal As Double)\n    Debug.Print x.Address, x.SpecialCells(xlCellTypeVisible).Address\n    VisiblePercentRank = WorksheetFunction.PercentRank(x.SpecialCells(xlCellTypeVisible), RankVal)\nEnd Function\n</code></pre>\n\n<p>Should the second output not read <code>$A$2,$A$12:$A$41</code> or have I missed something?</p>\n\n<p>Using Excel/Office 2013, 64bit on Win7, 64bit.</p>\n\n<p><strong>BRAIN FRYING UPDATE</strong></p>\n\n<p>I have found that my UDF works if I run it from the immediate window:</p>\n\n<pre><code>?VisiblePercentRank(range(\"A2:A41\"),0.5)\n$A$2:$A$41    $A$2:$A$11,$A$39:$A$41\n 0.207 \n</code></pre>\n\n<p>But if run from an in-cell formula of <code>=VisiblePercentRank(A2:A41,0.5)</code>:</p>\n\n<pre><code>$A$2:$A$41    $A$2:$A$41\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7821215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e44165ecd993acbbdc874064d0b889e?s=128&d=identicon&r=PG&f=1", "display_name": "Teo", "link": "https://stackoverflow.com/users/7821215/teo"}, "edited": false, "score": 0, "creation_date": 1492196802, "post_id": 43234345, "comment_id": 73894413, "body": "Sivaprasath V  With the code you gave me above, I was able to highlight Windings, but the code won&#39;t replace them? Regardless, your help is greatly appreciated!"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 11, "user_id": 7821215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e44165ecd993acbbdc874064d0b889e?s=128&d=identicon&r=PG&f=1", "display_name": "Teo", "link": "https://stackoverflow.com/users/7821215/teo"}, "edited": false, "score": 0, "creation_date": 1492224502, "post_id": 43234345, "comment_id": 73902214, "body": "You have to use the .Font object to replace the font. Interior object only changes the interior formats. You can use the .Font object with .Name property to change the font"}, {"owner": {"reputation": 11, "user_id": 7821215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e44165ecd993acbbdc874064d0b889e?s=128&d=identicon&r=PG&f=1", "display_name": "Teo", "link": "https://stackoverflow.com/users/7821215/teo"}, "edited": false, "score": 0, "creation_date": 1492437924, "post_id": 43234345, "comment_id": 73961381, "body": "My VBA knowledge is very limited. I will try research and see what I come up with. The code above is great and will suffice for now. My hope is to have the ability to replace Windings and highlight. We use the checkmarks for edit check purposes etc. Thanks again."}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 11, "user_id": 7821215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e44165ecd993acbbdc874064d0b889e?s=128&d=identicon&r=PG&f=1", "display_name": "Teo", "link": "https://stackoverflow.com/users/7821215/teo"}, "edited": false, "score": 0, "creation_date": 1492439567, "post_id": 43234345, "comment_id": 73962322, "body": "I have edited my answer. I am changing the font from windings 2 to Arial and highlighting to yellow.. you can record macros from your developer tab and get the codes."}, {"owner": {"reputation": 11, "user_id": 7821215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e44165ecd993acbbdc874064d0b889e?s=128&d=identicon&r=PG&f=1", "display_name": "Teo", "link": "https://stackoverflow.com/users/7821215/teo"}, "edited": false, "score": 0, "creation_date": 1493815335, "post_id": 43234345, "comment_id": 74561835, "body": "I will give it a try. Thanks for your help and support!"}, {"owner": {"reputation": 11, "user_id": 7821215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e44165ecd993acbbdc874064d0b889e?s=128&d=identicon&r=PG&f=1", "display_name": "Teo", "link": "https://stackoverflow.com/users/7821215/teo"}, "edited": false, "score": 0, "creation_date": 1507132669, "post_id": 43234345, "comment_id": 80092213, "body": "Thanks for your help."}], "tags": [], "owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "is_accepted": false, "score": 1, "last_activity_date": 1492439467, "last_edit_date": 1492439467, "creation_date": 1491403081, "answer_id": 43234345, "question_id": 43234074, "link": "https://stackoverflow.com/questions/43234074/how-to-find-font-and-replace-with-highlight/43234345#43234345", "title": "How to find font and replace with highlight", "body": "<pre><code>   With Application.FindFormat.Font\n        .Name = \"Wingdings 2\"\n        .Subscript = False\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontNone\n    End With\n    With Application.ReplaceFormat.Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    With application.replaceformat.font\n        .Name=\"Arial\"\n     End With\n    Cells.Replace What:=\"\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:= _\n        xlByRows, MatchCase:=False, SearchFormat:=True, ReplaceFormat:=True\n</code></pre>\n\n<p>try this you could have got this by recording macro in your excel.</p>\n"}], "owner": {"reputation": 11, "user_id": 7821215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e44165ecd993acbbdc874064d0b889e?s=128&d=identicon&r=PG&f=1", "display_name": "Teo", "link": "https://stackoverflow.com/users/7821215/teo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492439467, "creation_date": 1491402436, "question_id": 43234074, "link": "https://stackoverflow.com/questions/43234074/how-to-find-font-and-replace-with-highlight", "title": "How to find font and replace with highlight", "body": "<p>I have a question regarding Application.Findformat.font I am trying to find font <strong>Winding2</strong> and highlight yellow. I was able to put something together to find and delete windings. The next step is to highlight wherever a winding exists. Your help is greatly appreciated! </p>\n\n<pre><code>Cells.Select\n    With Application.FindFormat.Font\n        .Name = \"Wingdings 2\"\n        .Subscript = False\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontNone\n    End With\n       Selection.Replace What:=\"P\", Replacement:=\"\", LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=True, _\n        ReplaceFormat:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vlookup", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491401927, "post_id": 43233828, "comment_id": 73537755, "body": "Have you tried a multiple criteria <code>Index&#47;Match</code> with <code>Max()</code> perhaps?"}, {"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1491402490, "post_id": 43233828, "comment_id": 73538239, "body": "for mike1 it does ok but form mike2 it gives me the mike7254 case"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1491402119, "answer_count": 0, "score": 0, "last_activity_date": 1491402756, "creation_date": 1491401779, "last_edit_date": 1531161705, "question_id": 43233828, "link": "https://stackoverflow.com/questions/43233828/get-adjacent-cell-for-the-largest-time-if-value-found-in-column", "closed_reason": "Duplicate", "title": "Get adjacent cell for the largest time if value found in column", "body": "<p>I have 3 columns with about 4000 rows and 4 other columns with about 60000 rows. I have to search for every name and get the last recorded exit from release column. I have tried with vlookup and max but it doesn't show the right record. </p>\n\n<pre><code>=MAX(LOOKUP(B2,H1:H6,OFFSET(I1:I6,0,1)))\n</code></pre>\n\n<p>SO if the name mike1 is found in column H and the date for mike 1 is the same as the found results then D2 must be equal with the case for the biggest hour for the results found. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ItjS9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ItjS9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "edited": false, "score": 0, "creation_date": 1491403358, "post_id": 43233752, "comment_id": 73539003, "body": "If you put the target table name in the list of tables to query, it shouldn&#39;t be hard to use CREATE TABLE without hardcoding each table name."}, {"owner": {"reputation": 57, "user_id": 7297087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-6upC1Lyx2Z0/AAAAAAAAAAI/AAAAAAAAAAA/w4A1QfWP_rQ/photo.jpg?sz=128", "display_name": "Michael Amos", "link": "https://stackoverflow.com/users/7297087/michael-amos"}, "reply_to_user": {"reputation": 1330, "user_id": 2340071, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b7df7b14d4acb8db0ae1931c4ecce27?s=128&d=identicon&r=PG", "display_name": "Don George", "link": "https://stackoverflow.com/users/2340071/don-george"}, "edited": false, "score": 0, "creation_date": 1491403813, "post_id": 43233752, "comment_id": 73539388, "body": "I have that. All the examples I&#39;ve seen so far explicitly create that table, field by field:    CREATE TABLE foo (       indexfield CHAR(50)      ,secondfield INT    )  rather than      CREATE TABLE foo AS(         SELECT * FROM bar     )  can you help me get over that syntax hurdle?"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7297087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-6upC1Lyx2Z0/AAAAAAAAAAI/AAAAAAAAAAA/w4A1QfWP_rQ/photo.jpg?sz=128", "display_name": "Michael Amos", "link": "https://stackoverflow.com/users/7297087/michael-amos"}, "edited": false, "score": 0, "creation_date": 1491404365, "post_id": 43234827, "comment_id": 73539883, "body": "Oh, this looks promising. I&#39;ll go play with this and get back to you shortly."}, {"owner": {"reputation": 57, "user_id": 7297087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-6upC1Lyx2Z0/AAAAAAAAAAI/AAAAAAAAAAA/w4A1QfWP_rQ/photo.jpg?sz=128", "display_name": "Michael Amos", "link": "https://stackoverflow.com/users/7297087/michael-amos"}, "edited": false, "score": 0, "creation_date": 1491406413, "post_id": 43234827, "comment_id": 73541361, "body": "Can you validate that I have this laid out right?     Call DoCmd.TransferDatabase(TransferType:=acImport, DatabaseType:=&quot;Microsoft Access&quot;, _      DatabaseName:=selfRecordset.Fields.Item(&quot;dataLocation&quot;), ObjectType:=acTable, _      Source:=selfRecordset.Fields.Item(&quot;tableName&quot;), Destination:=selfRecordset.Fields.Item(&quot;tableName&quot;))  When I run that I get that the table does not exists. However, when I run this, I get results: &quot;SELECT  &quot; &amp; selfRecordset.Fields.Item(&quot;columnName&quot;) &amp; &quot; FROM &quot; &amp; selfRecordset.Fields.Item(&quot;tableName&quot;)   I&#39;m running this from the destination database."}, {"owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "reply_to_user": {"reputation": 57, "user_id": 7297087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-6upC1Lyx2Z0/AAAAAAAAAAI/AAAAAAAAAAA/w4A1QfWP_rQ/photo.jpg?sz=128", "display_name": "Michael Amos", "link": "https://stackoverflow.com/users/7297087/michael-amos"}, "edited": false, "score": 1, "creation_date": 1491407162, "post_id": 43234827, "comment_id": 73541899, "body": "looks like you are creating the query on the fly, for that to work, you need an actual query. so create a query on the fly, and then use the name of that query. i will modify the answer to clarify in a minute"}, {"owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "reply_to_user": {"reputation": 57, "user_id": 7297087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-6upC1Lyx2Z0/AAAAAAAAAAI/AAAAAAAAAAA/w4A1QfWP_rQ/photo.jpg?sz=128", "display_name": "Michael Amos", "link": "https://stackoverflow.com/users/7297087/michael-amos"}, "edited": false, "score": 0, "creation_date": 1491407977, "post_id": 43234827, "comment_id": 73542437, "body": "made one more correction, please look at edits in answer"}, {"owner": {"reputation": 57, "user_id": 7297087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-6upC1Lyx2Z0/AAAAAAAAAAI/AAAAAAAAAAA/w4A1QfWP_rQ/photo.jpg?sz=128", "display_name": "Michael Amos", "link": "https://stackoverflow.com/users/7297087/michael-amos"}, "edited": false, "score": 0, "creation_date": 1491410634, "post_id": 43234827, "comment_id": 73544206, "body": "I haven&#39;t yet given your above answer a shot but I wanted to ask, is it possible to do it from the destination? (documentation seems really lacking on this when I google). The whole reason for jumping through these hoops is that the owners of the source don&#39;t want me doing anything to their files. They&#39;re essentially using a LAN based Access file as their production system and are super freaked out by me opening the file, running a query and exporting the results. I&#39;m trying to make them more comfortable by writing a query that can&#39;t change their files.   Now off to play with what you sent."}, {"owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "reply_to_user": {"reputation": 57, "user_id": 7297087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-6upC1Lyx2Z0/AAAAAAAAAAI/AAAAAAAAAAA/w4A1QfWP_rQ/photo.jpg?sz=128", "display_name": "Michael Amos", "link": "https://stackoverflow.com/users/7297087/michael-amos"}, "edited": false, "score": 0, "creation_date": 1491411374, "post_id": 43234827, "comment_id": 73544664, "body": "i thought the config was in the source database. you can do the reverse, surely now you are importing. the sql created in the editsql will need the correct syntax, meaning, it needs to be able to reference the external file, so that you should be able to figure out."}], "tags": [], "owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "is_accepted": true, "score": 1, "last_activity_date": 1491407995, "last_edit_date": 1491407995, "creation_date": 1491404275, "answer_id": 43234827, "question_id": 43233752, "link": "https://stackoverflow.com/questions/43233752/i-have-an-ado-recordset-now-i-want-to-create-a-table-from-it-but-not-at-its-con/43234827#43234827", "title": "I have an ADO recordset, now I want to create a table from it but not at its connection location. How?", "body": "<p>Why don't you just use the docmd.TransferDatabase to copy over the table you want. your issue is not clear, so i am making assumptions here. if  you don't want to export an entire table, then create a query that just reads the columns you want to export, and store the name of that query in your datasources table. then, just call this as you are looping through, and pass it the query name and target db.</p>\n\n<p>Note, this expects that the target database already exists, if it doesn't then you need to create it, google for that. and this will also over-write the existing table in your target db, so if you want to append, then it won't work.</p>\n\n<p>Create a query on the fly by adding this sub:</p>\n\n<pre><code>Sub EditQuery(sqlText As String)\n On Error Resume Next\n  DoCmd.DeleteObject acQuery, \"qTemp\"\n  CurrentDb.CreateQueryDef \"qTemp\", sqlText\nEnd Sub\n</code></pre>\n\n<p>then call the above:</p>\n\n<pre><code> EditQuery (\"SELECT \" &amp; selfRecordset.Fields.Item(\"columnName\") &amp; \" FROM \" &amp; selfRecordset.Fields.Item(\"tableName\"))\n</code></pre>\n\n<p>finally call:</p>\n\n<pre><code> Call DoCmd.TransferDatabase(TransferType:=acExport, _\n                            DatabaseType:=\"Microsoft Access\", _\n                            databaseName:=selfRecordset.Fields.Item(\"dataLocation\"), _\n                            ObjectType:=acTable, _\n                            Source:=\"qTemp\", Destination:=selfRecordset.Fields.Item(\"tableName\"))\n</code></pre>\n\n<p>by the way, this should be run from the source database, not destination.</p>\n"}], "owner": {"reputation": 57, "user_id": 7297087, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-6upC1Lyx2Z0/AAAAAAAAAAI/AAAAAAAAAAA/w4A1QfWP_rQ/photo.jpg?sz=128", "display_name": "Michael Amos", "link": "https://stackoverflow.com/users/7297087/michael-amos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 0, "accepted_answer_id": 43234827, "answer_count": 1, "score": 1, "last_activity_date": 1491419654, "creation_date": 1491401606, "last_edit_date": 1491419654, "question_id": 43233752, "link": "https://stackoverflow.com/questions/43233752/i-have-an-ado-recordset-now-i-want-to-create-a-table-from-it-but-not-at-its-con", "title": "I have an ADO recordset, now I want to create a table from it but not at its connection location. How?", "body": "<p>I've been googling this for a couple days and am failing. I know I did something like this years ago but it's been a long time.</p>\n\n<p>The idea is that I am querying a table in one Access file, breaking the connection then want to drop it in a different Access file. I'm doing this multiple times so I don't want to hardcode each create table statement.</p>\n\n<pre><code>dim sql as string\n\nSet selfconnection = CreateObject(\"ADODB.Connection\")\nSet objconnection = CreateObject(\"ADODB.Connection\")\nSet selfRecordset = CreateObject(\"ADODB.Recordset\")\nSet objrecordset = CreateObject(\"ADODB.Recordset\")\n\nselfconnection.Open \"Provider = Microsoft.ACE.OLEDB.12.0; \" &amp; \"Data Source = C:\\this File.accdb\"\nselfRecordset.Open \"SELECT * FROM datasources\", selfconnection, 0, 1\n'''At this point I have a recordset of multiple tables I need to query and what fields.\n\nDo Until selfRecordset.EOF '''this loop should query every table listed in my datasources table\n  sql = \"SELECT  \" &amp; selfRecordset.Fields.Item(\"columnName\") &amp; \" FROM \" &amp; selfRecordset.Fields.Item(\"tableName\")\n  objconnection.Open \"Provider = Microsoft.ACE.OLEDB.12.0; \" &amp; \"Data Source = \" &amp; selfRecordset.Fields.Item(\"dataLocation\")\n  objrecordset.Open sql, objconnection, 0, 1\n  objconnection.Close\n  '''I have now pulled in a recordset that contains only the fields I want and have broken the connection. \n  '''I'd like to offload this recordset into selfconnention\n\n  '''I have tried this\n  With objrecordset\n    Set .ActiveConnection = selfconnection\n    objrecordset.updatebatch\n  End With\n  '''If I don't close objconnection I get \"can not do when connection is open\" \n  '''if I do close it I get \"can not do when connection is closed\"\n</code></pre>\n\n<p>Looking around, the general answer seems to be something like creating an INSERT query which is great but I need an existing table for the that to work and as I mentioned, I don't want to hardcode a CREATE TABLE for each one of these. I've seen the recommendation of SELECT INTO but given that I'm changing which file it's in, I don't think I can do this. </p>\n\n<p>Any help is appreciated.</p>\n\n<p>EDIT: After the help below I switch to a doCmd.transferdatabase. The curious part of me still wonders about the question as asked however, this addresses my issue by getting table into my Access file without manually opening the other file and I can then manipulate my copy as needed without any risk to the source data. </p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491402918, "post_id": 43233700, "comment_id": 73538624, "body": "Use <code>Select Case Target.Column</code> instead of your multiple <code>If</code>s."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1491402920, "creation_date": 1491402920, "answer_id": 43234281, "question_id": 43233700, "link": "https://stackoverflow.com/questions/43233700/private-sub-worksheet-events-with-different-ranges/43234281#43234281", "title": "Private sub worksheet events with different ranges", "body": "<p>Select Case will certainly tidy up your code. You might also want to build in a check that Target is not more than a single cell.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim cell As Range\nDim controlRng As Range, nRng As Range\n\nSet cell = Range(\"AK9:AR50\")\nSet controlRng = Range(\"AF9:AF1000\")\nSet nRng = Intersect(controlRng, Target)\n\nApplication.EnableEvents = False\n\nIf Not Application.Intersect(cell, Target) Is Nothing Then\n    Select Case Target.Column\n        Case 37, 39, 41, 43\n            Target.Offset(, 1).Value = Target.Value / Range(\"V\" &amp; Target.Row).Value\n        Case 38, 40, 42, 44\n            Target.Offset(, -1).Value = WorksheetFunction.RoundUp((Target.Value * Range(\"V\" &amp; Target.Row).Value), -2)\n    End Select\nEnd If\n\nIf Not nRng Is Nothing Then\n    Select Case Target.Value\n        Case \"No Promotion\"\n            Target.Offset(0, 1) = Range(\"M\" &amp; Target.Row).Value\n        Case \"Promotion\", \"Demotion\", \"Partner\", \"\"\n            Target.Offset(0, 1).ClearContents\n    End Select\nEnd If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7752500, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5125bc374d1b177a5253422aa023052c?s=128&d=identicon&r=PG&f=1", "display_name": "Kelsie", "link": "https://stackoverflow.com/users/7752500/kelsie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491402920, "creation_date": 1491401469, "last_edit_date": 1531164843, "question_id": 43233700, "link": "https://stackoverflow.com/questions/43233700/private-sub-worksheet-events-with-different-ranges", "title": "Private sub worksheet events with different ranges", "body": "<p>I know that you can have only one private sub worksheet change event however I am struggling to combine code for the events I need. I am new to VBA so any assistance or recommendations are appreciated. Would it be more efficient to use select case?</p>\n\n<p>First code needed: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\n\nDim cell As Range\nSet cell = Range(\"AK9:AR50\")\n\nApplication.EnableEvents = False\nIf Not Application.Intersect(cell, target) Is Nothing Then\nIf target.Column = 37 Then\n    target.Offset(, 1).Value = target.Value / Range(\"V\" &amp; target.Row).Value\nElseIf target.Column = 38 Then\n    target.Offset(, -1).Value = WorksheetFunction.RoundUp((target.Value * Range(\"V\" &amp; target.Row).Value), -2)\nEnd If\nIf target.Column = 39 Then\n    target.Offset(, 1).Value = target.Value / Range(\"V\" &amp; target.Row).Value\nElseIf target.Column = 40 Then\n    target.Offset(, -1).Value = WorksheetFunction.RoundUp((target.Value * Range(\"V\" &amp; target.Row).Value), -2)\nEnd If\nIf target.Column = 41 Then\n    target.Offset(, 1).Value = WorksheetFunction.RoundUp((target.Value * Range(\"V\" &amp; target.Row).Value), -2)\nElseIf target.Column = 42 Then\n    target.Offset(, -1).Value = target.Value / Range(\"V\" &amp; target.Row).Value\nEnd If\nIf target.Column = 43 Then\n    target.Offset(, 1).Value = target.Value / Range(\"V\" &amp; target.Row).Value\nElseIf target.Column = 44 Then\n    target.Offset(, -1).Value = WorksheetFunction.RoundUp((target.Value * Range(\"V\" &amp; target.Row).Value), -2)\nEnd If\nEnd If\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Second code needed:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim controlRng, nRng As Range\nSet controlRng = Range(\"AF9:AF1000\")\nSet nRng = Intersect(controlRng, Target)\n\nIf nRng Is Nothing Then Exit Sub\n\nIf Target.Value = \"No Promotion\" Then\n    Target.Offset(0, 1) = Range(\"M\" &amp; Target.Row).Value\nElseIf Target.Value = \"Promotion\" Then\n    Target.Offset(0, 1) = \"\"\nElseIf Target.Value = \"Demotion\" Then\n    Target.Offset(0, 1) = \"\"\nElseIf Target.Value = \"Partner\" Then\n    Target.Offset(0, 1) = \"\"\nElseIf Target.Value = \"\" Then\n    Target.Offset(0, 1) = \"\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1491401593, "post_id": 43233684, "comment_id": 73537492, "body": "Us conditional formatting, Clear and create the rule each time it is run, or you will need to loop through the range using find highlighting each row.  Find only finds the first."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6451375"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1491401632, "post_id": 43233684, "comment_id": 73537523, "body": "I don&#39;t want to highlight, I want to &#39;select&#39; the row"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1491401700, "post_id": 43233684, "comment_id": 73537570, "body": "Look up <code>.FindNext</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1491401704, "post_id": 43233684, "comment_id": 73537573, "body": "Then put the row in a unionized range and select after looping through the whole range."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6451375"}, "edited": false, "score": 0, "creation_date": 1491401731, "post_id": 43233684, "comment_id": 73537593, "body": "how do i do that ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1491401810, "post_id": 43233684, "comment_id": 73537661, "body": "Look up <code>.FindNext</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491401819, "post_id": 43233684, "comment_id": 73537673, "body": "You mean you want the row to be highlighted every time a word is found in that row?  You don&#39;t actually need them to be selected, correct?  Why don&#39;t you want to use Conditional Formatting?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6451375"}, "edited": false, "score": 0, "creation_date": 1491401866, "post_id": 43233684, "comment_id": 73537706, "body": "I want the row to be selected because after the search, i want the document to be the same as the original. I want a search box to help me find data more easily"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1491401896, "post_id": 43233684, "comment_id": 73537733, "body": "Look up <code>.FindNext</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1491402068, "post_id": 43233684, "comment_id": 73537873, "body": "After you lookup what @Jeeped has suggested three times, look up <code>Union</code> and it will help you create a unionized range."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491402277, "post_id": 43233684, "comment_id": 73538070, "body": "Sorry, why do you need the rows to be selected? I&#39;m asking because it&#39;s best to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoid using <code>.Select</code>/<code>.Activate</code></a>. Is the word you&#39;re looking for in <i>any</i> column, or is it always in the same one or two?"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491402305, "post_id": 43233684, "comment_id": 73538096, "body": "do something like applying a filter with the value selecting the cells and removing the filter"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491402396, "post_id": 43233684, "comment_id": 73538176, "body": "cells.autofilter field:=1, criteria:=w  cells.specialcells(xlcelltypevisible).select   cells.autofilter"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6451375"}, "edited": false, "score": 0, "creation_date": 1491402889, "post_id": 43233684, "comment_id": 73538591, "body": "My document has a lot of repetitve words. I do not necessarily need the row to be selected but I have to be able to iterate through all of them. Like a next button on which ou can click until you see the one you want. but it seems too complex for me to write that"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6451375"}, "edited": false, "score": 0, "creation_date": 1491402928, "post_id": 43233684, "comment_id": 73538627, "body": "like the same thing as control F but with a button"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6451375"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1491404350, "post_id": 43233684, "comment_id": 73539866, "body": "@ScottCraner thank you it worked"}], "owner": {"user_type": "does_not_exist", "display_name": "user6451375"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1491402675, "answer_count": 0, "score": 0, "last_activity_date": 1491401812, "creation_date": 1491401423, "last_edit_date": 1491401812, "question_id": 43233684, "link": "https://stackoverflow.com/questions/43233684/vba-code-to-select-rows-containing-a-word", "closed_reason": "Duplicate", "title": "VBA code to select rows containing a word", "body": "<p>How can we create a search function on excel? I want to be able to put a word in a search box and the rows containing it should be 'selected'.</p>\n\n<p>I have this : </p>\n\n<pre><code>Sub find_highlight() \n\nw = InputBox(\"What to find?\") \n\nCells.Find(What:=(w), After:=ActiveCell, LookIn:=xlFormulas, _ \nLookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _ \nMatchCase:=False).Activate \n 'Rows(\"51:51\").Select\nWith Selection.Interior \n    .ColorIndex = 6 \n    .Pattern = xlSolid \n    .PatternColorIndex = xlAutomatic \nEnd With \nEnd Sub \n</code></pre>\n\n<p>This only highlights one word and only one. I want all of the rows containing that word to be selected.</p>\n"}, {"tags": ["html", "vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1491404872, "post_id": 43233671, "comment_id": 73540262, "body": "Is this your actual code?  It would not compile..."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 9, "user_id": 3799152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000539677980/picture?type=large", "display_name": "georgian1990", "link": "https://stackoverflow.com/users/3799152/georgian1990"}, "edited": false, "score": 0, "creation_date": 1491405516, "post_id": 43233857, "comment_id": 73540733, "body": "@georgian1990 Are you getting an error message? fixing the code in the OP so that it contains a compilable <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> would also help people help you. &quot;is not working&quot; simply isn&#39;t a constructive comment."}], "tags": [], "owner": {"reputation": 133, "user_id": 7327542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fd031733aa7692ffdbdef0ed6907bf4?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/7327542/scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1491404347, "last_edit_date": 1491404347, "creation_date": 1491401861, "answer_id": 43233857, "question_id": 43233671, "link": "https://stackoverflow.com/questions/43233671/send-enter-key-using-vba-to-an-outside-ie-object/43233857#43233857", "title": "send Enter(~) key using vba to an outside IE object", "body": "<p>It looks like youre missing a closing bracket here:</p>\n\n<pre><code>Set objIE = GetIeByTitle(\"https://exampletest.com\", True, True ***)***\n</code></pre>\n\n<p>Try putting braces around the tilde:</p>\n\n<pre><code>    Application.SendKeys \"{~}\"\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>It sounds like perhaps there is code associated with the change of the text box; perhaps try:</p>\n\n<pre><code>objIE.document.getelementbyid(\"id1\").fireevent (\"onchange\")\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 3799152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000539677980/picture?type=large", "display_name": "georgian1990", "link": "https://stackoverflow.com/users/3799152/georgian1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1503957616, "creation_date": 1491401396, "last_edit_date": 1531164843, "question_id": 43233671, "link": "https://stackoverflow.com/questions/43233671/send-enter-key-using-vba-to-an-outside-ie-object", "title": "send Enter(~) key using vba to an outside IE object", "body": "<p>I'm stuck with the following task: from an excel file I send data (for a certain column into the sheet I send the cell values) to a specific IE object predefined.</p>\n\n<p>The data is sent onto the website in a textarea field (identified onto the website through an ID:id1) using a macro. For each cell value/data added into the textarea field of the website Enter key/command need to be done/appended automatically as this will generate some of the empty input fields to be completed automatically onto the website (the code is listed below:)</p>\n\n<p>I'm struggling with a method of automatically send the ENTER key onto the website into the textarea after the data is inserted  </p>\n\n<p>Code updated..</p>\n\n<pre><code>Sub adddata()\n\n    Dim objIE As Object\n    Dim objTR As Object\n    Dim i, j, counter As Integer\n    Dim lastRow As Long\n    counter = 1\n\n    Set objIE = GetIeByTitle(\"https://exampletest.com\", True, True)\n\n    Dim lastRow2 As Integer\n    lastRow2 = Workbooks(path1).Worksheets(\"Test\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Workbooks(path1).Worksheets(\"Test\").Activate\n\n    contor = 1\n\n    'First of all the unhidden files have to be take from the target excel file\n    'Selecting the unhidden lines from the excel file\n    For j = 1 To lastRow2\n        If Rows(j).EntireRow.Hidden = False Then\n            Workbooks(path1).Worksheets(\"Test\").Range(\"A\" &amp; j &amp; \":Z\" &amp; j).Select\n            Selection.Copy\n            ThisWorkbook.Worksheets(\"Test2\").Range(\"A\" &amp; counter).PasteSpecial\n            counter = counter + 1\n        End If\n    Next j\n\n    'look into the new excel file containing just the unhidden lines\n    'Afterwards a look up through new excel file cells\n    For i = 2 To counter\n        objIE.document.getelementbyid(\"id1\").Value = Worksheets(\"Test2\").Range(\"C\" &amp; i).Value ' taking the value from the cell and adding it on the text area field\n        objIE.document.getelementbyid(\"id1\").SetFocus\n        Application.SendKeys \"~\" ' sending the enter key\n        Application.Wait (7)     ' add the delay of 7 seconds\n\n        '2nd field\n        objIE.document.getelementbyid(\"id2\").Value = Worksheets(\"Test2\").Range(\"D\" &amp; i).Value\n\n        '3rd field\n        objIE.document.getelementbyid(\"id3\").Value = Worksheets(\"Test2\").Range(\"E\" &amp; i).Value\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28707, "user_id": 125981, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f2077dbed28ae040719cbe698800ec29?s=128&d=identicon&r=PG", "display_name": "Mark Schultheiss", "link": "https://stackoverflow.com/users/125981/mark-schultheiss"}, "edited": false, "score": 0, "creation_date": 1491401199, "post_id": 43233526, "comment_id": 73537168, "body": "The answer to this is &quot;what changed&quot;, Worked before, stopped working so What changed?  Isolate that change and you should be able to resolve this."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1491401260, "post_id": 43233526, "comment_id": 73537213, "body": "<code>c.EntireRow.Hidden = cbool(c.Value = vbNullString)</code>once and skip the second loop maybe?"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1491401355, "post_id": 43233526, "comment_id": 73537286, "body": "Does Excel crash if you manually delete the data?  Is it always the same row/column/cell?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1491401378, "post_id": 43233526, "comment_id": 73537314, "body": "Should <code>Worksheet_SelectionChange</code> be <code>Worksheet_Change</code>? Do you really want to run that every time you <i>select</i> a cell or just when something in A3:A49 changes?"}, {"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1491401626, "post_id": 43233526, "comment_id": 73537518, "body": "That is a fantastic point regarding the selection change. I am still relatively new and self taught. So much of my code, I am sure is very sloppy.    Also, I did change Worksheet_SelectionChange to Worksheet_Change and that seems to have fixed it. As far as &quot;What changed?&quot; The code that is causing the crash is the first code I put in. everything else I have added little by little since that point. I had not bothered checking the functionality of it until now because I had assumed that everything would work fine as they don&#39;t interact with eachother."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1491404407, "creation_date": 1491404407, "answer_id": 43234887, "question_id": 43233526, "link": "https://stackoverflow.com/questions/43233526/excel-keeps-crashing-with-worksheet-selectionchange/43234887#43234887", "title": "Excel keeps crashing with Worksheet_selectionChange", "body": "<p>Change the event driven Worksheet_SelectionChange to Worksheet_Change and isolate further by only processing when something changes in A3:A49.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"A3:A49\")) Is Nothing Then\n        On Error GoTo safe_exit\n        Application.EnableEvents = False\n        Application.ScreenUpdating = False\n        Dim c As Range\n        For Each c In Intersect(Target, Range(\"A3:A49\"))\n            c.EntireRow.Hidden = CBool(c.Value = vbNullString)\n        Next c\n    End If\n\nsafe_exit:\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Caveat:</strong> A Worksheet_Change is not triggered on the change in a cell from the cell's formula. Only by typing, deleting or dragging a cell's contents. Adding or removing a formula will trigger it but not when a formula's result changes from another value somewhere in the workbook changing. This should not affect you as no formula can return vbNullString but it is worth mentioning for others.</p>\n"}], "owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 43234887, "answer_count": 1, "score": 1, "last_activity_date": 1491422657, "creation_date": 1491401088, "last_edit_date": 1491422657, "question_id": 43233526, "link": "https://stackoverflow.com/questions/43233526/excel-keeps-crashing-with-worksheet-selectionchange", "title": "Excel keeps crashing with Worksheet_selectionChange", "body": "<p>I am running two VBA formulas.</p>\n\n<p>The first hides all cells with empty information the first column.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n     Dim c As Range\n     On Error Resume Next\n\n     Application.ScreenUpdating = False\n\n     For Each c In Range(\"A3:A49\")\n        If c.Value = vbNullString Then\n            c.EntireRow.Hidden = True\n        End If\n    Next c\n\n    For Each c In Range(\"A3:A47\")\n        If c.Value &lt;&gt; vbNullString Then\n            c.EntireRow.Hidden = False\n        End If\n    Next c\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The second Formula strings data together and placeses this information in the next cell that is empty (aka the first hidden cell) when the button is clicked.</p>\n\n<pre><code>Option Explicit\n\n    Dim iwsh As Worksheet\n    Dim owsh As Worksheet\n    Dim output As String\n    Dim i As Integer\n\n    Sub Copy()\n\n    Set iwsh = Worksheets(\"Budget\")\n    Set owsh = Worksheets(\"Release Burnup\")\n\n    i = 3\n\n    While owsh.Cells(i, 1) &lt;&gt; \"\"\n\n    i = i + 1\n\n    Wend\n\n    output = \"R\" &amp; iwsh.Cells(13, 2).Value &amp; \"-S\" &amp; iwsh.Cells(14, 2).Value\n\n    owsh.Cells(i, 1) = output\n\n    ActiveSheet.EnableCalculation = False\n    ActiveSheet.EnableCalculation = True\n\nEnd Sub\n</code></pre>\n\n<p>Previously, this has been causing no problem... Something has happened that is causing the workbook to crash anytime I try to delete information out of one of the cells with the new data.</p>\n\n<p>PS: This is the list of my other formulas. maybe there is something in these that is interacting with the formentioned code?</p>\n\n<pre><code>Private Sub NewMemberBut_Click()\n\n    'causes userform to appear\n    NewMember.Show\n\n    'reformats button because button kept changing size and font\n    NewMemberBut.AutoSize = False\n    NewMemberBut.AutoSize = True\n    NewMemberBut.Height = 40.25\n    NewMemberBut.Left = 303.75\n    NewMemberBut.Width = 150\n\nEnd Sub\n\n'Similar code to the problematic code in question, but this one works fine\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Dim c As Range\n    On Error Resume Next\n\n    Application.ScreenUpdating = False\n\n    For Each c In Range(\"A3:A35,A41:A80\")\n        If c.Value = vbNullString Then\n            c.EntireRow.Hidden = True\n        End If\n    Next c\n\n    For Each c In Range(\"A3:A35,A41:A80\")\n        If c.Value &lt;&gt; vbNullString Then\n            c.EntireRow.Hidden = False\n        End If\n    Next c\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\n\n'Code for UserForm\n\nOption Explicit\n\n    Dim mName As String\n    Dim cName As String\n    Dim mRole As String\n    Dim cRole As String\n    Dim i As Integer\n    Dim x As Integer\n    Dim Perc As Integer\n    Dim Vac As Integer\n    Dim Prj As Worksheet\n    Dim Bud As Worksheet\n\nPrivate Sub NewMember_Initialize()\n\n    txtName.Value = \"\"\n\n    cboRoleList.Clear\n\n    Scrum.Value = False\n\n    txtPercent.Value = \"\"\n\n    txtVacation.Value = \"\"\n\n    txtName.SetFocus\n\nEnd Sub\n\nPrivate Sub AddMember_Click()\n\n    If Me.txtName.Value = \"\" Then\n        MsgBox \"Please enter a Member name.\", vbExclamation, \"New Member\"\n        Me.txtName.SetFocus\n    Exit Sub\n    End If\n\n    If Me.cboRoleList = \"Other\" And Me.txtCustomRole = \"\" Then\n        MsgBox \"Please provide a role name.\", vbExclamation, \"Other Role\"\n    Exit Sub\n    End If\n\n    If Me.cboRoleList.Value = \"\" Then\n        MsgBox \"Please select a Role.\", vbExclamation, \"Member Role\"\n        Me.cboRoleList.SetFocus\n    Exit Sub\n    End If\n\n    If Me.cboRoleList &lt;&gt; \"Other\" And Me.txtPercent = \"\" Then\n        MsgBox \"Please select a valid percentage to be applied to this sprint.\", vbExclamation, \"Sprint Percent\"\n        Me.txtPercent.SetFocus\n    Exit Sub\n    End If\n\n    If Me.txtPercent.Value &gt; 100 And Me.txtPercent &lt;&gt; \"\" Then\n        MsgBox \"Please select a valid percentage to be applied to this sprint.\", vbExclamation, \"Sprint Percent\"\n        Me.txtPercent.SetFocus\n    Exit Sub\n    End If\n\n    If Me.txtVacation.Value = \"\" Then\n        Me.txtVacation.Value = 0\n    End If\n\n    Dim i As Long\n\n    Set Prj = Worksheets(\"Project Team\")\n    Set Bud = Worksheets(\"Budget\")\n\n    Prj.Activate\n\n    i = 5\n    x = 1\n    If Me.cboRoleList.Value = \"Other\" Then\n        i = 46\n    End If\n\n\n    While Prj.Cells(i, 1) &lt;&gt; \"\"\n        i = i + 1\n    Wend\n\n    If cboRoleList = \"Other\" Then\n        Cells(i, x).Value = txtCustomRole.Value\n    End If\n\n    If cboRoleList &lt;&gt; \"Other\" Then\n        Cells(i, x).Value = cboRoleList.Value\n    End If\n    x = x + 1\n\n    Cells(i, x).Value = txtName.Value\n    x = x + 1\n\n    If Me.cboRoleList.Value &lt;&gt; \"Other\" Then\n        Cells(i, x).Value = txtPercent.Value\n    End If\n\n    Unload Me\nEnd Sub\n\n\nPrivate Sub CloseBut_Click()\n\n    Unload Me\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "array-formulas"], "answers": [{"comments": [{"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "edited": false, "score": 0, "creation_date": 1498871888, "post_id": 43234680, "comment_id": 76693674, "body": "For some reason <code>If r.FormulaArray Like &quot;={*}&quot; Then</code> doesn&#39;t work for me (Excel 2010) and I had to replace this line with <code>If r.HasArray Then</code>."}, {"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1602663097, "post_id": 43234680, "comment_id": 113788535, "body": "Thanks, this answer saved me the creation of one thread. :)"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1602674821, "post_id": 43234680, "comment_id": 113793961, "body": "Yes!  Glad this helped."}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": true, "score": 2, "last_activity_date": 1602674949, "last_edit_date": 1602674949, "creation_date": 1491403898, "answer_id": 43234680, "question_id": 43233517, "link": "https://stackoverflow.com/questions/43233517/how-to-loop-through-formulaarrays-in-an-excel-sheet/43234680#43234680", "title": "How to loop through FormulaArrays in an Excel Sheet", "body": "<p>This wasn't as easy as I hoped.  Excel doesn't appear to expose a collection of array formulas for you to loop over.  That means you have to check every cell.  At a high level this code:</p>\n<ol>\n<li><p>Scans every cell.</p>\n</li>\n<li><p>If the cell contains an array formula it extracts the address.</p>\n</li>\n<li><p>If the address is new, it is added to the addresses variable.</p>\n</li>\n<li><p>Outputs all address to the screen.</p>\n<pre><code> ' Returns the address of array formula in the current worksheet.\n Sub GetArrayFormulaRangeAddresses()\n     Dim r As Range              ' Used to loop over active cells.\n     Dim addresses() As String   ' Holds each found address.\n     Dim address As String       ' Used to avoid duplicate entries.\n     Dim foundCount As Integer   ' Count of found array formulas.\n\n     ' Initialise vars.\n     foundCount = -1\n\n     ' Check every active cell, in currently selected tab.\n     ' Ideally you would loop over a formula collection but\n     ' the Excel object model does not appear to expose this.\n     For Each r In ActiveSheet.UsedRange.Cells\n\n         ' Found one.\n         ' WARNING: Array formula contains values,\n         ' even when cell is not part of an array formula.\n         If r.FormulaArray Like &quot;={*}&quot; Then\n\n             ' WARNING: Cannot pass array until after firt redim statement.\n             ' To avoid check found count, then addresses array.\n             If foundCount = -1 Then\n\n                 ' Not found, add to list.\n                 foundCount = foundCount + 1\n                 ReDim Preserve addresses(foundCount)\n                 addresses(foundCount) = r.CurrentArray.address\n\n             Else\n                 ' Check if address already found.\n                 If Not CheckArrayContains(addresses, r.CurrentArray.address) Then\n\n                     ' Not found, add to list.\n                     foundCount = foundCount + 1\n                     ReDim Preserve addresses(foundCount)\n                     addresses(foundCount) = r.CurrentArray.address\n                 End If\n             End If\n         End If\n     Next\n\n\n     ' TODO: What do you want to do with found addresses?\n     For foundCount = LBound(addresses) To UBound(addresses)\n         MsgBox addresses(foundCount)\n     Next\n End Sub\n\n ' Returns true if the passed array contains a value.\n ' Otherwise returns false.\n Public Function CheckArrayContains(ByRef CheckArray() As String, ByVal CheckValue As String) As Boolean\n     Dim i As Integer        ' Counter, used to check each element of the array.\n\n     ' Check existing members.\n     For i = LBound(CheckArray) To UBound(CheckArray)\n         If CheckArray(i) = CheckValue Then\n\n             ' Match found.\n             CheckArrayContains = True\n             Exit Function\n         End If\n     Next\n\n     ' No match found.\n     CheckArrayContains = False\n End Function\n</code></pre>\n</li>\n</ol>\n<p>I think this code could be improved:</p>\n<ol>\n<li>Redim is expensive.  It would probably be better to resize the array in batches of 1000.</li>\n<li>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194068.aspx\" rel=\"nofollow noreferrer\">Excel Object Model</a> <em>might</em> expose a collection you could loop over.</li>\n<li>For larger workbooks, it would be faster to extract all addresses and then deduplicate the results.</li>\n</ol>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 43234680, "answer_count": 1, "score": 0, "last_activity_date": 1602674949, "creation_date": 1491401071, "question_id": 43233517, "link": "https://stackoverflow.com/questions/43233517/how-to-loop-through-formulaarrays-in-an-excel-sheet", "title": "How to loop through FormulaArrays in an Excel Sheet", "body": "<p>Excel 2010. I need to find out where the FormulaArrays are in a sheet. In particular I need to get their address. </p>\n\n<p>I am not after knowing if a given (1x1) cell is \"part of\" a FormulaArray but rather know where the FormulaArray \"blocks\" are located. Eg if a FormulaArray is entered in A1:B2, I'd like to get the information that the FormulaArray area is over the range A1:B2, as opposed to knowing that the individual cells A1, A2, B1, B2 are part of \"a\" FormulaArray.</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["vba", "ms-access", "barcode-scanner", "msgbox"], "answers": [{"tags": [], "owner": {"reputation": 253, "user_id": 1168160, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/75c746005702f67c78c0b0f916e95e88?s=128&d=identicon&r=PG", "display_name": "Mjall2", "link": "https://stackoverflow.com/users/1168160/mjall2"}, "is_accepted": false, "score": 0, "last_activity_date": 1491401048, "creation_date": 1491401048, "answer_id": 43233511, "question_id": 43233386, "link": "https://stackoverflow.com/questions/43233386/access-vba-msgbox/43233511#43233511", "title": "Access VBA - Msgbox", "body": "<p>Force the user to enter a value like 'Yes' or a checkbox (form).</p>\n"}], "owner": {"reputation": 45, "user_id": 3746296, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c15fbd375635b3952f36adfddb3d170c?s=128&d=identicon&r=PG&f=1", "display_name": "Brock", "link": "https://stackoverflow.com/users/3746296/brock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 709, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593956344, "creation_date": 1491400768, "last_edit_date": 1593956344, "question_id": 43233386, "link": "https://stackoverflow.com/questions/43233386/access-vba-msgbox", "title": "Access VBA - Msgbox", "body": "<p>Looking for a workaround here. One that preferably doesn't involve making a bunch of user forms.</p>\n\n<p>Background: I've got an Access DB used for scanning items in and out of the office. After each item is scanned, it verifies that the item is okay to leave the office. If it is not, a msgbox is called and says \"This item is out of calibration, are you sure you want to take it?\" (vbyesno)</p>\n\n<p>Issue: When an item is scanned, the system sees the numbers from the bar code and a carriage return. This works great with the scanning form. However, if the user isn't paying attention when a msgbox appears and scans the next item, the carriage return will click the default value from the msgbox, close it and the user is none the wiser. </p>\n\n<p>My temp solution: I added a third button (cancel) after the yes/no that becomes the new default value. Scanning a new item will click that and it just reopens the msgbox. Therefore the user should eventually notice. It's not really a good solution though.  </p>\n\n<pre><code> Dim ans As Integer\n\n '2 is vbCancel\n ans = 2\n\n Do While ans = 2\n\n    ans = MsgBox(\"Test\", vbYesNoCancel + vbDefaultButton3 + vbSystemModal + vbExclamation)\n    if ans = 2 then\n      'Restart Loop\n    elseif ans = vbYes\n      'Do something\n    elseif ans = vbNo\n      'Do something else\n    end if\n Loop\n</code></pre>\n\n<p>There are many different cases in which a msgbox can appear, so making an individual user form each one is something I'd hope to avoid.</p>\n\n<p>Thanks,</p>\n\n<p>Brock</p>\n"}, {"tags": [".net", "vba", "charts", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 6761655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f364ad694eb5ac059d776fb60a519d?s=128&d=identicon&r=PG&f=1", "display_name": "Jelmer", "link": "https://stackoverflow.com/users/6761655/jelmer"}, "is_accepted": false, "score": 0, "last_activity_date": 1491403935, "creation_date": 1491403935, "answer_id": 43234690, "question_id": 43233292, "link": "https://stackoverflow.com/questions/43233292/vba-word-method-workbook-of-object-chartdata-failed/43234690#43234690", "title": "VBA (Word) method workbook of object chartdata failed", "body": "<p>The error is not a bug. ChartData must be Activated before you use it. Otherwise, bad things happen.</p>\n\n<pre><code> Private Sub CommandButton1_Click()\n    Dim chartWorksheet As Excel.Worksheet\n    Dim salesChart As Word.Chart\n    Set salesChart = ActiveDocument.Shapes.AddChart.Chart\n\n\n  End Sub\n\n    Private Sub CommandButton2_Click()\n        For Each objShape In ActiveDocument.Shapes\n            If objShape.HasChart Then\n'----------------------------------------- the bugfix ----------------------\n                objShape.Chart.ChartData.Activate \n'---------------------------------------------------------------------------\n                With objShape.Chart.ChartData.Workbook.WorkSheets(1)\n                    .ListObjects(\"Table1\").Resize .Range(\"A1:B10\")\n                    For i = 1 To 10\n                        .Cells(i, 1).FormulaR1C1 = CStr(i)\n                        .Cells(i, 2).FormulaR1C1 = CStr(10 * i)\n                    Next\n                End With\n            End If\n        Next\n    End Sub\n</code></pre>\n\n<p>Hope it helps someone!</p>\n"}], "owner": {"reputation": 125, "user_id": 6761655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f364ad694eb5ac059d776fb60a519d?s=128&d=identicon&r=PG&f=1", "display_name": "Jelmer", "link": "https://stackoverflow.com/users/6761655/jelmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 642, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491582835, "creation_date": 1491400533, "last_edit_date": 1491582835, "question_id": 43233292, "link": "https://stackoverflow.com/questions/43233292/vba-word-method-workbook-of-object-chartdata-failed", "title": "VBA (Word) method workbook of object chartdata failed", "body": "<p>I think I encountered a bug in VBA for word 2013 and I'd like to find a workaround. In the following example, there is one button to create a graph, and one button to add data to it. The code works fine until the a file with a graph is saved and then loaded again. Then, CommandButton2_Click() gives the error: \"method workbook of object chartdata failed\". </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim chartWorksheet As Excel.Worksheet\n    Dim salesChart As Word.Chart\n    Set salesChart = ActiveDocument.Shapes.AddChart.Chart\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    For Each objShape In ActiveDocument.Shapes\n        If objShape.HasChart Then\n            With objShape.Chart.ChartData.Workbook.WorkSheets(1)\n                .ListObjects(\"Table1\").Resize .Range(\"A1:B10\")\n                For i = 1 To 10\n                    .Cells(i, 1).FormulaR1C1 = CStr(i)\n                    .Cells(i, 2).FormulaR1C1 = CStr(10 * i)\n                Next\n            End With\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>The code is based on <a href=\"https://msdn.microsoft.com/en-us/library/office/ff629397(v=office.14).aspx\" rel=\"nofollow noreferrer\">Microsoft's own example</a> and I've tried to take into account some solutions from Stack Overflow but they do not solve the problem. I Hope anyone can help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1491400500, "post_id": 43233084, "comment_id": 73536551, "body": "A simple vlookup will retrieve column data from a closed workbook and that is all you require. KISS."}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491401105, "post_id": 43233084, "comment_id": 73537077, "body": "doesn&#39;t deleting a row also triggers the macro?....can you post the error shown?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491401180, "post_id": 43233084, "comment_id": 73537145, "body": "Also, <code>If Not Intersect(Target, Range(&quot;B:B&quot;)) Is Nothing Then &#39; &lt;-- run this code only if a value in column I has changed</code> ...You have column &quot;B&quot;? I might be misreading that, but how does that ensure that something in Column <code>I</code> has changed?"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491401228, "post_id": 43233084, "comment_id": 73537190, "body": "@SivaprasathV there&#39;s no error. Even when i remove error handling. The macro just seems to time out."}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1491401295, "post_id": 43233084, "comment_id": 73537245, "body": "@BruceWayne sorry thats me stealing the code from an earlier code template i used. I didn&#39;t update the comment but the correct column is column B. See updated question"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491401661, "post_id": 43233084, "comment_id": 73537537, "body": "on deleting a row check whether the macro completes running or stopped midway. if its stopped midway the next the worksheet action wont occur as the previous macro is still running. you have to either close the workbook and open it again or stop the macro manually so that the next time worksheet change occurs it will work"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491414780, "creation_date": 1491399982, "last_edit_date": 1491414780, "question_id": 43233084, "link": "https://stackoverflow.com/questions/43233084/vba-lookup-value-from-other-workbook-and-copy-corresponding-values", "title": "vba lookup value from other workbook and copy corresponding values?", "body": "<p>I have two workbooks.</p>\n\n<p>Workbook A</p>\n\n<pre><code>Item number     Item description     Supplier name        \n1234            x                    c\n123             y                    r\n1111            b                    e\n</code></pre>\n\n<p>Workbook B:</p>\n\n<pre><code>1234      \n123\n1111\n</code></pre>\n\n<p>When the user types or pastes in an item number in workbook B, the item description and supplier name should be pulled through from workbook A.</p>\n\n<p>This works. But sometimes its a bit temperamental. Sometimes the code works, but then as the user makes changes to the workbook, like when they delete a row in workbook B, this will stop the code from executing for the next time the user types in an item number.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nOn Error GoTo Message\nOn Error Resume Next\n\nActiveSheet.DisplayPageBreaks = False        \n\n'Insert Depot Memo Data for user\n Dim oCell As Range, targetCell As Range\n    Dim ws2 As Worksheet\n    On Error GoTo Message\n    If Not Intersect(Target, Range(\"B:B\")) Is Nothing Then ' &lt;-- run this code only if a value in column B has changed\n        If Not GetWb(\"Depot Memo\", ws2) Then Exit Sub\n\n        With ws2\n            For Each targetCell In Target\n                Set oCell = .Range(\"J1\", .Cells(.Rows.Count, \"J\").End(xlUp)).Find(What:=targetCell.Value, LookIn:=xlValues, LookAt:=xlWhole)\n                If Not oCell Is Nothing Then\n                    Application.EnableEvents = False                                                                        \n                    'Set Format of cell\n                    targetCell.ClearFormats\n                    targetCell.Font.Name = \"Arial\"\n                    targetCell.Font.Size = \"10\"\n                    targetCell.Font.Color = RGB(128, 128, 128)\n                    targetCell.HorizontalAlignment = xlCenter\n                    targetCell.VerticalAlignment = xlCenter\n                    targetCell.Borders(xlEdgeBottom).LineStyle = xlContinuous\n                    targetCell.Borders(xlEdgeTop).LineStyle = xlContinuous\n                    targetCell.Borders.Color = RGB(166, 166, 166)\n                    targetCell.Borders.Weight = xlThin                                                                        \n                    targetCell.Offset(0, -1).Value = Now()\n                    targetCell.Offset(0, 1).Value = oCell.Offset(0, 1)\n                    targetCell.Offset(0, 2).Value = oCell.Offset(0, -2)\n                    targetCell.Offset(0, 3).Value = oCell.Offset(0, -7)\n\n                    Application.EnableEvents = True\n                End If\n            Next\n        End With\n    End If                       \n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True                                \nExit Sub        \n\nMessage:\nApplication.DisplayAlerts = False\nExit Sub\n\nEnd Sub\n\n'=================================================================\n\nFunction GetWb(wbNameLike As String, WS As Worksheet) As Boolean\n    Dim Wb As Workbook\n    For Each Wb In Workbooks\n        If Wb.Name Like \"*\" &amp; wbNameLike &amp; \"*\" Then '&lt;-- check if workbook name contains \"Depot Memo\"\n            Set WS = Wb.Worksheets(1)\n            Exit For\n        End If\n    Next\n    GetWb = Not WS Is Nothing\nEnd Function\n</code></pre>\n\n<p>Please can someone show me where i am going wrong?</p>\n"}, {"tags": ["vba", "vlookup"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1491399407, "post_id": 43232724, "comment_id": 73535609, "body": "WorksheetFunction.VLookup(range(&quot;O2&quot;).value,range(&quot;A1:B10&quot;),&zwnj;&#8203;1)"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1491399570, "creation_date": 1491399570, "answer_id": 43232910, "question_id": 43232724, "link": "https://stackoverflow.com/questions/43232724/finding-a-cell-with-variable-data-inside/43232910#43232910", "title": "finding a cell with variable data inside", "body": "<p>If you try to use value from a range in a VBA VLookup formula, try something like this:</p>\n\n<pre><code>With Activesheet\n    .Range(\"C1\") = WorksheetFunction.VLookup(.Range(\"O2\").value,.Range(\"A1:B10\"),\u200c\u200b1)\nEnd with\n</code></pre>\n\n<p>The With Activesheet, couldbe changed to the sheet you need to use. If you are using only one sheet, try this:</p>\n\n<p><code>Range(\"C1\") = WorksheetFunction.VLookup(range(\"O2\").value,range(\"A1:B10\"),\u200c\u200b1)</code></p>\n"}], "owner": {"reputation": 151, "user_id": 5928968, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10154572512542519/picture?type=large", "display_name": "Yigit Tanverdi", "link": "https://stackoverflow.com/users/5928968/yigit-tanverdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491399570, "creation_date": 1491399075, "question_id": 43232724, "link": "https://stackoverflow.com/questions/43232724/finding-a-cell-with-variable-data-inside", "title": "finding a cell with variable data inside", "body": "<p>This might be too easy for you but I can not find a solution.</p>\n\n<p>I have a value in column O2 which has a variable number inside. I am trying to use the vlookup to see in which column i have the duplicate of the value inside of O2. </p>\n\n<p>If the the value in O2 would be the same, then it would be easy to use vlookup. But the value inside of O2 varies as following. </p>\n\n<p>O2= Company (variable value)is not defined</p>\n\n<p>So how can i put this in a formula to be able to find matching cell with O2?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1491399283, "post_id": 43232697, "comment_id": 73535501, "body": "1. you are getting that error because you are including the second criterion in the range, the <code>)</code> is in the wrong space. 2. <code>x</code> is already a range object so you do not need the Range(): <code>WorksheetFunction.PercentRank(x, *value to be ranked* )</code> 3. I do not think Percent Rank will work with a disjointed range.  So you may need to write out the code to do the work long hand in the vba, You may need to loop through the range."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1491399424, "post_id": 43232697, "comment_id": 73535621, "body": "An alternate to having vba to do the work long hand (if needed) is to copy the disjointed range to a random column in the worksheet to make it contiguous and then call the <code>PercentRank</code> against that. Still a work around, but probably cleaner and less code."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1491399675, "post_id": 43232697, "comment_id": 73535837, "body": "@ScottHoltzman I don&#39;t know, it is a simple loop to count the number below the second criterion and divided it by the count of cells in the range.  Or, as I think of it, Loop trough the groups and use countif() to get the count and divide by the total number of cells.  Either method will be pretty quick."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1491399883, "post_id": 43232697, "comment_id": 73536005, "body": "@ScottCraner - I was thinking more in terms of lines of code. But it&#39;s probably 6 one way and 1/2 dozen the other :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1491399964, "post_id": 43232697, "comment_id": 73536070, "body": "@ScottHoltzman or if the criteria for the filter is simple, a COUNTIFS() divided by a COUNTIF() will do it also."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1491400765, "post_id": 43232697, "comment_id": 73536763, "body": "and there is a typo in <code>x1CellTypeVisible</code> which should be <code>xlCellTypeVisible</code>. Means second character should be a lower case <code>L</code> not a one."}, {"owner": {"reputation": 11, "user_id": 7820870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e36f0f51f5af8a4a561b30edd35fc85?s=128&d=identicon&r=PG&f=1", "display_name": "Chips Ahoy", "link": "https://stackoverflow.com/users/7820870/chips-ahoy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1491401065, "post_id": 43232697, "comment_id": 73537045, "body": "@Scott Craner I should note that while the worksheet is filtered, the criterion by which it is filtered is already sorted such that each filtered result is a continuous range of rows. So for example the first autofilter result returns rows 1-40, the second autofilter returns rows 41-100, etc. Do you think that would still pose an issue for PercentRank?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1491401183, "post_id": 43232697, "comment_id": 73537148, "body": "@ChipsAhoy nope, I was in error on the disjointed range, see the answer below."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1491400219, "post_id": 43232985, "comment_id": 73536306, "body": "I do not believe that the PercentRank will work with a disjointed range."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1491401041, "post_id": 43232985, "comment_id": 73537015, "body": "@ScottCraner It does."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491401140, "post_id": 43232985, "comment_id": 73537103, "body": "@peh so it does."}, {"owner": {"reputation": 11, "user_id": 7820870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e36f0f51f5af8a4a561b30edd35fc85?s=128&d=identicon&r=PG&f=1", "display_name": "Chips Ahoy", "link": "https://stackoverflow.com/users/7820870/chips-ahoy"}, "edited": false, "score": 0, "creation_date": 1491401175, "post_id": 43232985, "comment_id": 73537138, "body": "@CLR thank you I tried this and it fixed the syntax issue, but I&#39;m now getting a run time error 1004 &quot;Unable to get the SpecialCells property of the Range class&quot;. Any insight as to that issue?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 11, "user_id": 7820870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e36f0f51f5af8a4a561b30edd35fc85?s=128&d=identicon&r=PG&f=1", "display_name": "Chips Ahoy", "link": "https://stackoverflow.com/users/7820870/chips-ahoy"}, "edited": false, "score": 0, "creation_date": 1491401246, "post_id": 43232985, "comment_id": 73537201, "body": "@ChipsAhoy did you replace your line with his, you had a typo in the <code>xlCellTypeVisible</code>  See Peh&#39;s comment above."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 11, "user_id": 7820870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e36f0f51f5af8a4a561b30edd35fc85?s=128&d=identicon&r=PG&f=1", "display_name": "Chips Ahoy", "link": "https://stackoverflow.com/users/7820870/chips-ahoy"}, "edited": false, "score": 0, "creation_date": 1491401267, "post_id": 43232985, "comment_id": 73537224, "body": "@ChipsAhoy This error occurs when the <code>*value to be ranked*</code> is not found within the <code>Range(&quot;K1:K6027&quot;)</code>."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491401548, "post_id": 43232985, "comment_id": 73537455, "body": "@Peh, I&#39;ve just tried this myself (was building a UDF to fill out my answer) and I&#39;m hitting a problem where <code>x.SpecialCells(xlCellTypeVisible)</code> doesn&#39;t give me a different range to <code>x</code> - I&#39;ve tried manually hiding and using a filter.. Any clues?"}, {"owner": {"reputation": 11, "user_id": 7820870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e36f0f51f5af8a4a561b30edd35fc85?s=128&d=identicon&r=PG&f=1", "display_name": "Chips Ahoy", "link": "https://stackoverflow.com/users/7820870/chips-ahoy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491401781, "post_id": 43232985, "comment_id": 73537637, "body": "@Peh It works! Using the code CLR posted and correcting the typo in xlCellTypeVisible fixed the issue. Thank you all so much! You are geniuses"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491402066, "post_id": 43232985, "comment_id": 73537871, "body": "@CLR not clear about how to understand your question but if you <code>Set x = ActiveSheet.Range(&quot;K1:K6027&quot;).Rows.SpecialCells(xlCellTypeVi&zwnj;&#8203;sible)</code> and <code>Debug.Print x.Address</code> gives you <code>$K$1:$K$6027</code>. If I use the group data (don&#39;t know the correct term in english, sorry) and hide row 6+7  I get <code>$K$1:$K$5,$K$8:$K$6027</code>."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491402280, "post_id": 43232985, "comment_id": 73538074, "body": "That&#39;s most odd @Peh - as when I try that I get <code>$K$1:$K$6027</code> for both, despite some rows being hidden by a filter."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491402331, "post_id": 43232985, "comment_id": 73538121, "body": "Did you clear out the typo in <code>xlCellTypeVisible</code> I mentioned in the comments of the question (I edited that in your answer already)? Therefore I always use <code>Option Explicit</code> to prevent typos like that."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1491402401, "post_id": 43232985, "comment_id": 73538180, "body": "I did, and thank-you for spotting that. I might post my UDF in a new question for all to look at."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 2, "last_activity_date": 1491400653, "last_edit_date": 1491400653, "creation_date": 1491399745, "answer_id": 43232985, "question_id": 43232697, "link": "https://stackoverflow.com/questions/43232697/vba-function-over-visible-range-only/43232985#43232985", "title": "VBA function over visible range only", "body": "<p>You need to <code>Set</code> x and use that. Also, your brackets need shifting around:</p>\n\n<pre><code>Set x = ActiveSheet.Range(\"K1:K6027\").Rows.SpecialCells(xlCellTypeVisible)\nMyPercentRank  = WorksheetFunction.PercentRank(x, *value to be ranked*)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7820870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e36f0f51f5af8a4a561b30edd35fc85?s=128&d=identicon&r=PG&f=1", "display_name": "Chips Ahoy", "link": "https://stackoverflow.com/users/7820870/chips-ahoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491400653, "creation_date": 1491399011, "last_edit_date": 1531164843, "question_id": 43232697, "link": "https://stackoverflow.com/questions/43232697/vba-function-over-visible-range-only", "title": "VBA function over visible range only", "body": "<p>I'm trying to run the PercentRank function over an autofiltered spreadsheet such that it only runs over visible cells. I tried defining a range object ie:</p>\n\n<pre><code>Dim x As Range\nx = ActiveSheet.Range(\"K1:K6027\").Rows.SpecialCells(x1CellTypeVisible)\n</code></pre>\n\n<p>And then tried using that range the function ie:</p>\n\n<pre><code>PercentRank = WorksheetFunction.PercentRank(Range(x, *value to be ranked*) )\n</code></pre>\n\n<p>But that code returns a \"compile error : argument not optional\" message. I'm assuming it's due to the syntax of the percentrank function requiring two arguments to set yhe range of values it runs over, but I'm just not clear conceptually then on how to translate that into code. Any help would be much appreciated.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 2658, "user_id": 6593031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jHJwa.jpg?s=128&g=1", "display_name": "ScoutEU", "link": "https://stackoverflow.com/users/6593031/scouteu"}, "edited": false, "score": 0, "creation_date": 1491407863, "post_id": 43235217, "comment_id": 73542355, "body": "Excellent, I will try this when I am back in the office tomorrow! Just curious, can I pass an argument to the code so instead of writing &#39;1&#39;, I can pass whatever they put in the text box."}, {"owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "reply_to_user": {"reputation": 2658, "user_id": 6593031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jHJwa.jpg?s=128&g=1", "display_name": "ScoutEU", "link": "https://stackoverflow.com/users/6593031/scouteu"}, "edited": false, "score": 1, "creation_date": 1491408076, "post_id": 43235217, "comment_id": 73542525, "body": "sure, you can do all that, say your textbox is called textbox1, then simply: [value1] = me.textbox1.value"}, {"owner": {"reputation": 2658, "user_id": 6593031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jHJwa.jpg?s=128&g=1", "display_name": "ScoutEU", "link": "https://stackoverflow.com/users/6593031/scouteu"}, "edited": false, "score": 0, "creation_date": 1491830382, "post_id": 43235217, "comment_id": 73712752, "body": "Hey, been working on this all day, and am getting stuck. I am not sure exactly where I am meant to put this code. I can successfully get the value from the combo box into a textbox, but when I try and get the value into the filter on the subform table, it does nothing. I can get it to work when loading by using the value idea above, but it refuses to take the combobox value :/"}], "tags": [], "owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "is_accepted": true, "score": 1, "last_activity_date": 1491405210, "creation_date": 1491405210, "answer_id": 43235217, "question_id": 43232567, "link": "https://stackoverflow.com/questions/43232567/combo-box-on-form-to-filter-table-i-imported-into-access-from-excel/43235217#43235217", "title": "Combo Box on form to filter table I imported into Access from Excel", "body": "<p>You can use the form's filter method to programatically filter the rows. careful though, as you probably are going to need a mechanism to remove the filter, like a separate button as it won't be obvious. OR, you may still want to keep the form's \"Navigation Buttons\" property to true. this would then have allow the user to see that the rows are filtered, and also allow them to remove the filter.</p>\n\n<p>Use the form's filter methods to filter. so say they want to filter on a field called \"value1\" with value of 1, it would be like this. if your filter condition is text, then use single qoutes around them.</p>\n\n<pre><code> Me.Filter = \"[value1] = 1\"\n Me.FilterOn = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2658, "user_id": 6593031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jHJwa.jpg?s=128&g=1", "display_name": "ScoutEU", "link": "https://stackoverflow.com/users/6593031/scouteu"}, "edited": false, "score": 0, "creation_date": 1491638609, "post_id": 43268489, "comment_id": 73650598, "body": "Hey, thank you. Yes it is about Access, I am waiting to go back to work on Monday to fix the tool, but I will look at your and Gungors comments then see if I can get it to work. Thank you again for the support! :)"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1491530612, "creation_date": 1491530612, "answer_id": 43268489, "question_id": 43232567, "link": "https://stackoverflow.com/questions/43232567/combo-box-on-form-to-filter-table-i-imported-into-access-from-excel/43268489#43268489", "title": "Combo Box on form to filter table I imported into Access from Excel", "body": "<p>I think your question is more about a ComboBox updating a view, right.  I don't think this really has anything to do with Excel, right.  If this is correct, please see the link below.</p>\n\n<p><a href=\"http://www.fontstuff.com/access/acctut17.htm\" rel=\"nofollow noreferrer\">http://www.fontstuff.com/access/acctut17.htm</a></p>\n\n<p>Also, see this.</p>\n\n<p><a href=\"http://www.fontstuff.com/access/acctut18.htm\" rel=\"nofollow noreferrer\">http://www.fontstuff.com/access/acctut18.htm</a></p>\n"}], "owner": {"reputation": 2658, "user_id": 6593031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/jHJwa.jpg?s=128&g=1", "display_name": "ScoutEU", "link": "https://stackoverflow.com/users/6593031/scouteu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 43235217, "answer_count": 2, "score": 1, "last_activity_date": 1594022688, "creation_date": 1491398663, "last_edit_date": 1594022688, "question_id": 43232567, "link": "https://stackoverflow.com/questions/43232567/combo-box-on-form-to-filter-table-i-imported-into-access-from-excel", "title": "Combo Box on form to filter table I imported into Access from Excel", "body": "<p>I have been searching for a couple of hours but I can only see examples of combo boxes on forms filtering tables that are based from queries.</p>\n\n<p>My table (which I have put on a subForm) is from a static datasheet that I imported into Access from Excel so therefore does not come from a query.</p>\n\n<p>I want to use a combobox (or a textbox) so that the user can enter in the reference number and it will filter the table (rather than using the filters already provided (as they just get confused))</p>\n\n<p>Is this even possible? I should add, the reason why I want the table showing (and not a query from it) is that I want the user to be able to edit the table once they have found the reference number they are looking for.</p>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba", "locking"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1491400055, "post_id": 43232452, "comment_id": 73536151, "body": "You don&#39;t do anything with the selection you make. Also it is not wise to use select. It&#39;s better to use the cells explicit adress and use that to lock them. So for example Range(&quot;A:A&quot;).Locked = true"}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 5401968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/85b412ccbef1a01538e309fad23561ac?s=128&d=identicon&r=PG&f=1", "display_name": "Forumer", "link": "https://stackoverflow.com/users/5401968/forumer"}, "is_accepted": true, "score": 0, "last_activity_date": 1491406430, "creation_date": 1491406430, "answer_id": 43235670, "question_id": 43232452, "link": "https://stackoverflow.com/questions/43232452/excel-vba-lock-columns-containing-specific-value-in-a-cell/43235670#43235670", "title": "Excel VBA Lock columns containing specific value in a cell", "body": "<p>My problem was that the worksheet was already locked and cell-locking statement wouldn't work. Below is what is working. Nevertheless, I welcome more elegant solutions.</p>\n\n<pre><code>Sub LockSelectedCells(sheetName As String)\n  Dim cell As Range\n  Dim sheetProtectPassword As String\n  sheetProtectPassword = Range(\"Reports!sheetProtectPassword\")\n'  Debug.Print \"sheetProtectPassword=\" &amp; sheetProtectPassword\n  Worksheets(sheetName).Unprotect Password:=sheetProtectPassword\n  For Each cell In Worksheets(sheetName).Range(\"A1\", Range(\"A1\").End(xlToRight))\n    If cell.Value Like \"COM_*\" Then\n'      Debug.Print \"Cell value = \" &amp; cell\n'      Debug.Print \"Cell Column = \" &amp; cell.Column\n'      Debug.Print \"A\" &amp; cell.Column\n      cell.EntireColumn.Locked = False\n    End If\n  Next\nWorksheets(sheetName).Protect Password:=sheetProtectPassword\nDebug.Print \"Done ...\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5401968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/85b412ccbef1a01538e309fad23561ac?s=128&d=identicon&r=PG&f=1", "display_name": "Forumer", "link": "https://stackoverflow.com/users/5401968/forumer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 43235670, "answer_count": 1, "score": 0, "last_activity_date": 1491406430, "creation_date": 1491398375, "question_id": 43232452, "link": "https://stackoverflow.com/questions/43232452/excel-vba-lock-columns-containing-specific-value-in-a-cell", "title": "Excel VBA Lock columns containing specific value in a cell", "body": "<p>I have a need to lock all columns containing a specific value in column heading. I've tried the following without success. I realize that I'll have to lock the worksheet after locking the columns. There is something wrong in selecting the column.</p>\n\n<p>I'd appreciate your help.</p>\n\n<pre><code>    Sub MultipleFindLike()\n  For Each cell In Worksheets(\"LockTest\").Range(\"A1\", Range(\"A1\").End(xlToRight))\n    If cell Like \"COM_*\" Then\n      Debug.Print \"Cell value = \" &amp; cell\n      Debug.Print \"Cell Column = \" &amp; cell.Column\n      Range(cell, Range(cell).End(xlDown)).Select\n    End If\n  Next\nWorksheets(\"LockTest\").Protect Password:=\"mypass\"\nDebug.Print \"Done ...\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1491400320, "post_id": 43232234, "comment_id": 73536401, "body": "Welcome to StackOverflow. This community site is based on a question/answer system. Meaning people come here with a <b>specific</b> question to code they have written themselves. Your question is very broad and more likely a question for a forum based site where discussion and teaching are possible. If you have a specific question to your code, you are welcome to show your code and ask a more specific question."}], "owner": {"reputation": 951, "user_id": 7819673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1ebba53f69bfd5880d9bd56971cc06c7?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/7819673/varun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1491399874, "creation_date": 1491397802, "last_edit_date": 1491399874, "question_id": 43232234, "link": "https://stackoverflow.com/questions/43232234/increment-alphanumeric-code-based-on-values-in-another-excel-file", "title": "Increment alphanumeric code based on values in another Excel file", "body": "<p>I am very new to VBA and have been stuck while working on an automation in Excel using VBA.</p>\n\n<p><strong>The Automation Problem</strong></p>\n\n<p>The idea is to automate the generation of an alpha-numeric code in my Excel file, based on values that can be found in <strong>another Excel file</strong>. </p>\n\n<p>For simplicity sake, we'll call these two files the <strong>Original file</strong> (my file) and the <strong>Target file</strong> (where values can be found). Both have exactly the same format i.e. the same column headings.</p>\n\n<p>In order to tackle this problem, I've split it into 4 parts:</p>\n\n<p>1) Identify the directory that contains the Target files.</p>\n\n<p>I have found some code online that can help me with this -</p>\n\n<pre><code>Sub getdirectory() \n\nDim xRow As Long \nDim xDirect$, xFname$, InitialFoldr$ \n\nInitialFoldr$ = \"G:\\\" '&lt;&lt;&lt; Begins searching from here\n\nWith Application.FileDialog(msoFileDialogFolderPicker) \n    .InitialFileName = Application.DefaultFilePath &amp; \"\\\" \n    .Title = \"Please select a folder to list Files from\" \n    .InitialFileName = InitialFoldr$ \n    .Show \n    If .SelectedItems.Count &lt;&gt; 0 Then \n        xDirect$ = .SelectedItems(1) &amp; \"\\\" \n        xFname$ = Dir(xDirect$, 7) \n        Do While xFname$ &lt;&gt; \"\" \n            ActiveCell.Offset(xRow) = xFname$ \n            xRow = xRow + 1 \n            xFname$ = Dir \n        Loop \n    End If \nEnd With \nEnd Sub \n</code></pre>\n\n<p>2) Select the Target file that is most recent (based on its date)</p>\n\n<p><a href=\"https://i.stack.imgur.com/wfJFd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wfJFd.png\" alt=\"enter image description here\"></a></p>\n\n<p>In this case (as shown in the photo), the file right at the bottom is the most recent, and should be selected.</p>\n\n<p>3) Once selected this Target file, we select the code in column 1 of this Target file with the highest value, based on some conditions-</p>\n\n<p>Condition 1: In the Original file, if 'Account Type'= Site and Segment='Operations', then the code in the Target file starting with 'OSM' that has the <strong>highest value</strong>: i.e. OSM_SITE_0006805 is <strong>returned to the Original file</strong>, and the code is incremented by 1. Then subsequent codes respecting the same condition are incremented by 1.</p>\n\n<p>Condition 2: In the Original file, if 'Account Type'= Site and Segment='Sales', then the code in the Target file starting with 'OSE' that has the <strong>highest value</strong>: i.e. OSE_SITE_0006105 is <strong>returned to the Original file</strong>, and the code in incremented by 1. Then subsequent codes respecting the same condition are incremented by 1.</p>\n\n<p>The process continues till all rows have been complete in the Original file.</p>\n\n<p><strong>Final Result</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/CfENv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CfENv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any input I can get from this community will be very helpful and will prove to be a good learning for me.</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1491398313, "post_id": 43231596, "comment_id": 73534674, "body": "<i>but I&#39;m willing to give it a try</i> - please show the efforts you&#39;ve tried and where it&#39;s failing. Then we can help you solve them. SO is not a &quot;write code for me&quot; service."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491399424, "post_id": 43231596, "comment_id": 73535620, "body": "A hint to start with: Loop through all rows. Use use  <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow noreferrer\"><code>yourArray = split()</code></a> to split them into an array by the delimiter <code>,</code>. Get the array size with <code>x = UBound(yourArray)</code> and duplicate the actual line x-times. Then write the values from the array into the actual and generated rows."}, {"owner": {"reputation": 1, "user_id": 7295218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce3e648709c370dd7f162133acb5ee5a?s=128&d=identicon&r=PG&f=1", "display_name": "B0ombo0mp0w", "link": "https://stackoverflow.com/users/7295218/b0ombo0mp0w"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1491478019, "post_id": 43231596, "comment_id": 73576175, "body": "@Scott,  What I&#39;m doing now is manual. Step 1: Move Column B to the End of the Column Step 2: Split by Column by delimited ( ,  ) Step 3: Copy Whatever that is split from Column D onward and transport to the last row Step 4: Drag the Information of Column A - C down"}, {"owner": {"reputation": 1, "user_id": 7295218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce3e648709c370dd7f162133acb5ee5a?s=128&d=identicon&r=PG&f=1", "display_name": "B0ombo0mp0w", "link": "https://stackoverflow.com/users/7295218/b0ombo0mp0w"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1491478092, "post_id": 43231596, "comment_id": 73576222, "body": "@Peh, are you doing a VBA? I&#39;m new to VBA so i&#39;m trying to figure out everything"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7295218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce3e648709c370dd7f162133acb5ee5a?s=128&d=identicon&r=PG&f=1", "display_name": "B0ombo0mp0w", "link": "https://stackoverflow.com/users/7295218/b0ombo0mp0w"}, "edited": false, "score": 0, "creation_date": 1491477683, "post_id": 43234608, "comment_id": 73575926, "body": "Thanks @Sangbok Lee,  I tried what you&#39;re doing on Excel before and this is okay if im going it across.  What i need is with each New Id created by the split from Cell B, i need to create a new record below and replaced it with all the other information. Not too sure if you know what i mean"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1491489481, "post_id": 43234608, "comment_id": 73585322, "body": "DV for providing a solution outside the requested application."}], "tags": [], "owner": {"reputation": 1826, "user_id": 6153990, "user_type": "registered", "profile_image": "https://graph.facebook.com/955879401185683/picture?type=large", "display_name": "Sangbok  Lee", "link": "https://stackoverflow.com/users/6153990/sangbok-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1491404092, "last_edit_date": 1491404092, "creation_date": 1491403711, "answer_id": 43234608, "question_id": 43231596, "link": "https://stackoverflow.com/questions/43231596/how-to-create-new-row-of-data-in-excel-automatically-after-splitting-up-data-wit/43234608#43234608", "title": "How to create new row of data in Excel automatically after splitting up data within a cell", "body": "<p>I made this done by Google Sheets after adding 5 + 2 helper colmuns, just for some fun. It heavily uses <code>arrayformula()</code>, <code>filter()</code>, <code>split()</code>, <code>join()</code>, <code>regexreplace()</code>, which are not supported naitively or provided as built-in formulas in Excel.</p>\n\n<ol>\n<li>First, get 5 <code>pid</code>s for each record by <code>=split(B2, \",\")</code> on <code>K:K</code>. It will expand to column <code>O:O</code>.</li>\n<li>Get one line of all records for each <code>uid</code>s by <code>=regexreplace(join(\"/\", arrayformula(if(K2:O2&lt;&gt;\"\",$A2&amp;\",\"&amp;K2:O2&amp;\",\"&amp;$C2&amp;\",\"&amp;$D2,\"\"))), \"/+$\" , \"\")</code> on <code>Q:Q</code>. It joins every column with <code>,</code> and each record with <code>/</code>.\n(You may use <code>substitute()</code>, etc instead of <code>regexreplace()</code>.)</li>\n<li>Now joining <code>Q2:Q</code> will give all records. Just one formula <code>=transpose(split(join(\"/\", filter(Q2:Q, Q2:Q&lt;&gt;\"\")), \"/\"))</code> on <code>R2</code>.</li>\n<li>Now split each record on <code>R:R</code> with <code>,</code> by one formula <code>=arrayformula(split(filter(R2:R, R2:R&lt;&gt;\"\"), \",\"))</code> on <code>F2</code>.</li>\n</ol>\n\n<p>Sample sheet is <a href=\"https://docs.google.com/spreadsheets/d/1xZ1FwsnTHvcTA8a9syss3r5LgE9mP7MB4FB78LK_oqg/\" rel=\"nofollow noreferrer\">here</a> and below is its scrrenshot.\n<a href=\"https://i.stack.imgur.com/9vDJA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9vDJA.png\" alt=\"enter image description here\"></a></p>\n\n<p>Another screenshot showing cells with formulas.\n<a href=\"https://i.stack.imgur.com/qm61X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qm61X.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 7295218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce3e648709c370dd7f162133acb5ee5a?s=128&d=identicon&r=PG&f=1", "display_name": "B0ombo0mp0w", "link": "https://stackoverflow.com/users/7295218/b0ombo0mp0w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491404092, "creation_date": 1491396299, "last_edit_date": 1491398102, "question_id": 43231596, "link": "https://stackoverflow.com/questions/43231596/how-to-create-new-row-of-data-in-excel-automatically-after-splitting-up-data-wit", "title": "How to create new row of data in Excel automatically after splitting up data within a cell", "body": "<p>I've this data set that contain 100K+ of records. \nAnd in 1 row of cell, its contained multiple products code, separated by comma (,). The cell might contained between 1 - 5 products codes separated by comma.</p>\n\n<p>There a Unique Id no. tag to each product codes.\nHere is the tricky part:</p>\n\n<ol>\n<li>I need to split so each cell only contain 1 items</li>\n<li>and create a new column below for every product code</li>\n<li>then populate the new column with data contained in other rows</li>\n</ol>\n\n<p>Meaning to say</p>\n\n<pre><code>Row A     | Row B      | Row C   | Row D|\nUnique ID | Product ID | Price   | MSRP |\n1232      | 123,342,432| $5      | $10  |\n</code></pre>\n\n<p>And I need to transform this record into,</p>\n\n<pre><code>Row A     | Row B      | Row C   | Row D|\nUnique ID | Product ID | Price   | MSRP |\n1232      | 123        | $5      | $10  |\n1232      | 342        | $5      | $10  |\n1232      | 432        | $5      | $10  |\n</code></pre>\n\n<p>Is there anyway to do it beside, \"Text to column\" and copy and paste the other data with the records?\nI'm totally new to VBA but I'm willing to give it a try.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491393929, "post_id": 43230653, "comment_id": 73531161, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and aspirants) writing their own code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>. You might also want to <a href=\"http://stackoverflow.com/tour\">take the tour</a> and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve. We will be here waiting for you. Ready to assist and help you finalize <i>your code</i>."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1491393943, "post_id": 43230653, "comment_id": 73531175, "body": "So what is your question? (Post your code, state where it goes wrong, and we will be happy to help! Surely you don&#39;t expect us to do your job for you.)"}, {"owner": {"reputation": 1, "user_id": 2489681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae642b6953fbab784a7669411c55a2f9?s=128&d=identicon&r=PG", "display_name": "user2489681", "link": "https://stackoverflow.com/users/2489681/user2489681"}, "edited": false, "score": 0, "creation_date": 1491394283, "post_id": 43230653, "comment_id": 73531456, "body": "Thank you so much Vacip, i am not familiar to vba and code...i have tried certain code that is available on google but i am not able to develop it ...i would really appreciate if you could please help me thank you peace"}, {"owner": {"reputation": 1, "user_id": 2489681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae642b6953fbab784a7669411c55a2f9?s=128&d=identicon&r=PG", "display_name": "user2489681", "link": "https://stackoverflow.com/users/2489681/user2489681"}, "edited": false, "score": 0, "creation_date": 1491394388, "post_id": 43230653, "comment_id": 73531526, "body": "My question is i need filtered data into new sheet . what i usually do is put the filter on 5 columns  1)Virtual - NO (2)Server - NO (3)LCM Status- 0 and 1 (4)Status - Active and Quarantine (5)Most frequent User - Only name with test in it and then put the filterd data into new sheet and now i want to automate this process"}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1491395068, "creation_date": 1491395068, "answer_id": 43231124, "question_id": 43230653, "link": "https://stackoverflow.com/questions/43230653/macro-to-filter-and-copy-data-in-new-tab/43231124#43231124", "title": "Macro to filter and copy data in new tab", "body": "<p>From your Excel Workbook, go to the page with your data to be filtered.  Click on the \"Developer\" tab.  If you do not see a developer tab on the ribbon, check <a href=\"https://support.office.com/en-us/article/Show-the-Developer-tab-e1192344-5e56-4d45-931b-e5fd9be\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Show-the-Developer-tab-e1192344-5e56-4d45-931b-e5fd9be</a></p>\n\n<p>On the left side of the developer ribbon you will see a link for \"Record Macro.\"  Click that link.  Every action you take now will be automatically recorded to a macro.</p>\n\n<p>Sort the data on your sheet exactly the way you need it sorted.  Create a new sheet on the bottom by clicking on the new sheet \"+\" plus sign.  Return to your data sheet.  Select the data you want to copy to the new sheet.  Copy by Cntrl-C.  Go to your new sheet and select the cell you want the data to start copying to.  Paste the copied data with Cntrl-V.  </p>\n\n<p>Go to the developer tab and hit \"Stop Recording.\"  Go to the VBA editor by simultaneously clicking ALT-F11.  On the left side click \"Modules\".  There should be a module with your recorded macro in it.  </p>\n\n<p>The macro will do everything you asked us to do.  You can use it as often as you like.  to use it again simply go to the Developer Tab and click \"Macros.\"  A list of macros will pop up, including the one you just made.  Clicking on it will make it perform the same actions again.  You can change the name of the macro to anything you like.  You musat start the name with a letter and it can have no blank spaces.</p>\n\n<p>The automatic macro is your friend if you are trying to learn VBA.  It will help you learn the very basics.  Once you get the basics down you can then get a little fancier with VBA, which is the best language I've come across.  For now, though, what you asked to do is a very simple procedure that can be handled with the macro recorder.</p>\n"}], "owner": {"reputation": 1, "user_id": 2489681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae642b6953fbab784a7669411c55a2f9?s=128&d=identicon&r=PG", "display_name": "user2489681", "link": "https://stackoverflow.com/users/2489681/user2489681"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 694, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1491395068, "creation_date": 1491393804, "last_edit_date": 1531164843, "question_id": 43230653, "link": "https://stackoverflow.com/questions/43230653/macro-to-filter-and-copy-data-in-new-tab", "title": "Macro to filter and copy data in new tab", "body": "<p>I need a macro to filter the data (have 5-6 filter) and copy the data into the new sheet in the same workbook . \nHere is the example <a href=\"https://i.stack.imgur.com/xfza4.png\" rel=\"nofollow noreferrer\">there are multiple columns , the data which i need in to new tab is \nVirtual - NO\nServer - NO\nLCM Status- 0 and 1\nStatus - Active and Quarantine \nMost frequent User - Only name with test in it </a></p>\n\n<p>Thank you so much in Advance</p>\n"}, {"tags": ["vba", "excel", "commandbutton"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491394054, "post_id": 43230609, "comment_id": 73531283, "body": "not sure what is your question ? you want to know how to assign multiple <code>Sub</code> code to array of <code>CommandButton</code> ? where is the list of values you want ?"}, {"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491394310, "post_id": 43230609, "comment_id": 73531472, "body": "@ShaiRado I want to assign the code for each of the command button created at runtime. If the RevCounter=5, so 5 command buttons will be created and 5 codes is needed."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491394423, "post_id": 43230609, "comment_id": 73531556, "body": "Have you tried <a href=\"http://stackoverflow.com/a/2783413/1153513\">ctlTXT.OnAction = &quot;nameOfMacroToRun&quot;</a>?"}, {"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491396044, "post_id": 43230609, "comment_id": 73532817, "body": "@Ralph I tried already but im not sure whether the code doesn&#39;t work or I wrote the wrong code. Can you give me the example"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "edited": false, "score": 0, "creation_date": 1491396157, "post_id": 43230877, "comment_id": 73532907, "body": "The command button is in the user form, what I want to do is, when the user click on the created button, it will show another form with the correct information for the clicked button"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1491394400, "creation_date": 1491394400, "answer_id": 43230877, "question_id": 43230609, "link": "https://stackoverflow.com/questions/43230609/how-to-assign-code-for-the-command-button-created-at-runtime/43230877#43230877", "title": "How to assign code for the command button created at runtime?", "body": "<p>The process you want to use is to:</p>\n\n<ul>\n<li><p>add the button in a sheet</p></li>\n<li><p>add the related code using the <code>sub buttonname_click()</code> format</p></li>\n</ul>\n\n<p>You have the first part, so we'll deal with the second here.  The code needs to be added to the relevant worksheet's code module; so this code would add code to the active sheet's code module, which is likely what you need.</p>\n\n<pre><code>Sub addcode()\n    Dim subtext As String\n    subtext = \"Sub PrintStuff\" &amp; vbCrLf &amp; \"msgbox \"\"Hello World\"\"\" &amp; vbCrLf &amp; \"End Sub\"\n    With Workbooks(ThisWorkbook.Name).VBProject.VBComponents(ActiveSheet.CodeName).CodeModule\n        .InsertLines .CountOfLines + 1, subtext\n    End With\nEnd Sub\n</code></pre>\n\n<p>There's not really enough information in your question  to make this scaleable: what do you want the buttons to do?  Can you add the sub that you'd like to add?</p>\n"}], "owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 768, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491394440, "creation_date": 1491393684, "last_edit_date": 1531164843, "question_id": 43230609, "link": "https://stackoverflow.com/questions/43230609/how-to-assign-code-for-the-command-button-created-at-runtime", "title": "How to assign code for the command button created at runtime?", "body": "<p>I am trying to create the code for the command button created at runtime. The command button created based on the dynamic input. I found the solution here</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10224511/assign-code-to-a-button-created-dynamically][1]\">Assign code to a button created dynamically</a></p>\n\n<p>The problem is this code is used for one command button only, I have several command button created at runtime. This is my code.</p>\n\n<pre><code>For i = 1 To RevCounter\n\nSet ctlTXT = Me.Controls.Add(\"Forms.CommandButton.1\")\nctlTXT.name = \"Rev\" &amp; i\nctlTXT.Caption = Sheet4.Range(\"D\" &amp; i + 5).value\nctlTXT.Left = 18\nctlTXT.Height = 18: ctlTXT.Width = 72\nctlTXT.Top = 15 + ((i - 1) * 25)\n\nNext\n</code></pre>\n\n<p>The question is, how to assign the code for command button created at runtime. For example if RevCount=5, there will be 5 command buttons created at runtime. I need to assign the code for each of the command buttons created.</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1491393741, "post_id": 43230460, "comment_id": 73531003, "body": "you want to look into lastcolumn. Also this probably is a recorded macro, if you really want to move further you want to stop using .select and activecell. Instead you should reference cells explicitly."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1491398298, "post_id": 43230823, "comment_id": 73534655, "body": "Hi Robin. Thank you for taking the time to respond. the code you supplied me has only populated cell B2. I need the code to keep looking across. the headers for blanks, can the code be amended. The last column with data in it is not the same every time. So i can say it stops at Q or Z or something"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1491398712, "post_id": 43230823, "comment_id": 73534984, "body": "Hi - no problem. See the edited code sample. You can set the row that the headers are on. In your original post the picture showed the headers on row 1 but maybe your headers are on row 2 per your comment. You need to pass in the correct row otherwise it won&#39;t automatically find the last column. HTH"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1491399387, "post_id": 43230823, "comment_id": 73535591, "body": "Hi Rob my mistake with B2. I need coffee. row 2 is irrelevant. So the edited code you gave me is not functioning. The previous code was giving me what i needed the copy of A1 into B1 with the 2 attached. but it did not continue along to the next blank cell in row 1 it just stopped at B1."}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1491400193, "post_id": 43230823, "comment_id": 73536271, "body": "Hi Robin. Your code worked perfectly my E2 cell was populated with a . which meant the code would not work. Thank you again for the support and help much respect from Dublin :-)"}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1491398648, "last_edit_date": 1491398648, "creation_date": 1491394284, "answer_id": 43230823, "question_id": 43230460, "link": "https://stackoverflow.com/questions/43230460/vba-find-blank-cells-in-column-headings/43230823#43230823", "title": "VBA Find Blank cells in Column Headings", "body": "<p>Try the code below - the comments indicate what each important line is doing:</p>\n\n<pre><code>Option Explicit\n\nSub FillInHeaders()\n\n    Dim ws As Worksheet\n    Dim lngRowWithHeaders As Long\n    Dim rngHeader As Range\n    Dim rngCell As Range\n\n    ' get a reference to your worksheet\n    Set ws = ThisWorkbook.Worksheets(\"SHeet1\")\n\n    ' set the row that the headers are on\n    lngRowWithHeaders = 2\n\n    ' get the range from A1 to ??1 where ?? is last column\n    Set rngHeader = ws.Cells(lngRowWithHeaders, 1) _\n        .Resize(1, ws.Cells(lngRowWithHeaders, ws.Columns.Count) _\n        .End(xlToLeft).Column)\n\n    ' iterate the range and look for blanks\n    For Each rngCell In rngHeader\n        ' if blank then ...\n        If IsEmpty(rngCell.Value) Then\n            ' get cell value from left and a 2\n            rngCell.Value = rngCell.Offset(0, -1).Value &amp; \"2\"\n        End If\n    Next rngCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "accepted_answer_id": 43230823, "answer_count": 1, "score": 0, "last_activity_date": 1491398648, "creation_date": 1491393297, "last_edit_date": 1491395140, "question_id": 43230460, "link": "https://stackoverflow.com/questions/43230460/vba-find-blank-cells-in-column-headings", "title": "VBA Find Blank cells in Column Headings", "body": "<p>I hope you can help. I have a piece of code below, and its working somewhat. I just need it to do more. </p>\n\n<p>It currently looks along the first row from A1 to H1. If it finds a blank cell then it copies the cell value to the left of the blank cell, then pastes this value into the blank cell and then moves along. </p>\n\n<p>As the range can change from day to day A1 to H1 will not suffice. I now need the code to look along the first row, until it finds the last cell with data in it then look for the blanks and start the copy and paste process. </p>\n\n<p>I also need the code to then add a 2 to the pasted cell so that I can perform a pivot and differentiate between the copied cells and the pasted. </p>\n\n<p>I have provided a picture below for better understanding. The end result should be that cell B2 contains the text <strong><em>24 - Company: Hier 2</em></strong> and E2 contains the text <strong><em>07 - Product: Family Hier 2</em></strong></p>\n\n<p>My code is below and as always any and all help is greatly appreciated. </p>\n\n<p>Pic 1</p>\n\n<p><a href=\"https://i.stack.imgur.com/tzSda.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tzSda.png\" alt=\"enter image description here\"></a></p>\n\n<p>MY CODE </p>\n\n<pre><code>Public Sub BorderForNonEmpty()\n    Dim myRange As Range\n    Set myRange = Sheet1.Range(\"A1:H1\")\n    For Each MyCell In myRange\n        If MyCell.Text = \"\" Then\n            MyCell.Offset(0, -1).Select\n        ActiveCell.Copy\n        ActiveCell.Offset(0, 1).PasteSpecial (xlPasteAll)\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "udf"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1491392930, "post_id": 43229902, "comment_id": 73530404, "body": "including your code is always a good practice. Even if it is not needed it shows that you put effort into making your question the best it can be."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1491395497, "post_id": 43229902, "comment_id": 73532391, "body": "post your code."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1491400274, "post_id": 43229902, "comment_id": 73536360, "body": "@tompreston posted, although I don&#39;t know how much it will help because I already outlined all I knew in the question!"}], "answers": [{"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1491401885, "creation_date": 1491401885, "answer_id": 43233863, "question_id": 43229902, "link": "https://stackoverflow.com/questions/43229902/parsing-a-function-for-its-arguments/43233863#43233863", "title": "Parsing a function for its arguments", "body": "<p>If you had a proper formula parser you could solve all of these problems except the one of handling multiple calls to CONCATIF in a single formula: I don't know of a way of finding out 100% which instance of CONCATIF is currently being called.</p>\n\n<p>There are various Formula parsers around you could maybe adapt: start here\n<a href=\"http://ewbi.blogs.com/develops/2004/12/excel_formula_p.html\" rel=\"nofollow noreferrer\">http://ewbi.blogs.com/develops/2004/12/excel_formula_p.html</a></p>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491401885, "creation_date": 1491391738, "last_edit_date": 1491396160, "question_id": 43229902, "link": "https://stackoverflow.com/questions/43229902/parsing-a-function-for-its-arguments", "title": "Parsing a function for its arguments", "body": "<p>I have a UDF in written in VBA, which I call from my sheet. The function takes 3 arguments: <code>Function CONCATIF(arg1 As Range, arg2 As Boolean, Optional arg3 As Range) As Variant</code></p>\n\n<p>The UDF needs to know the <em>formula</em> of arg2, i.e. to intercept arg2 before it has been evaluated to <code>TRUE</code> or <code>FALSE</code>. To do this I use <code>Application.Caller.Formula</code>, which gives me (in its simplest form) <code>\"=CONCATIF(arg1, arg2, arg3)\"</code> (or in place of <code>,arg3)</code> either <code>)</code> or<code>,)</code>)\nI can then get arg 2 by simply using <code>Split(Application.Caller.Formula, \",\")</code></p>\n\n<p>There are several problems I'd like to deal with though</p>\n\n<ul>\n<li>Splitting at commas means that none of my arguments can contain commas, which they may have to</li>\n<li>The formula may be nested, e.g <code>=SUM(1,IF(CONCATIF(arg1, arg2, arg3)=\"a\",1,0))</code>, so I don't know which item of my split array is arg2. (I think this should be fairly easy to fix: find <code>CONCATIF</code> in the string and chop off the start, count the open/close brackets which follow it until open = close, and then chop off the end.</li>\n<li>The arguments may be formulae themselves; <code>arg1</code> could be a reference to a range, not an actual range.</li>\n<li>Tricky: <code>CONCATIF</code> may come up multiple times in 1 formula, but with standard string searches I'll always pick up the first one (I may just have to return an error if there are multiple in 1 formula, as I can't think how to get around this at all)</li>\n</ul>\n\n<p><strong>So what I want:</strong> A generic way of obtaining the correct <code>CONTCATIF()</code> formula from the caller cell, and then parsing out the three arguments as 3 strings in an array. For reference, here's my code (sorry, naming is a little different from question)</p>\n\n<pre><code>Public Function CONCATIF(checkRange As Range, testFunction As Boolean, Optional concatRange As Range) As Variant\n\nDim concatArray() As Variant\nDim formulaText As String, formulaParts() As String, formulaTest As String\nDim topLeft As Range, subCell As Range\nDim newTest As String\nDim results() As Boolean, result As Boolean\nDim loopval As Long\n'''\n'input checking\n'''\nIf concatRange Is Nothing Then\n    concatArray = checkRange\nElseIf Not (checkRange.Cells.Count = concatRange.Cells.Count And checkRange.Rows.Count = concatRange.Rows.Count And checkRange.Rows.Count = 1) Then\n    CONCATIF = CVErr(xlErrValue)\n    Exit Function\nElse\n    concatArray = concatRange.Value2\nEnd If\n'''\n'Extract test function\n'''\nformulaText = Application.Caller.Formula\nformulaParts = Split(formulaText, \",\") 'Assumes 1)no commas 2) formula isn't nested 3) formula doesn't contain nested functions\nformulaTest = formulaParts(1) 'get the test function as a string to be evaluated\nSet topLeft = checkRange.Cells(1, 1) 'This is the 'reference' cell - substitute each of the values in the check range for this to test each one\nReDim results(0)\nOn Error GoTo Err\n'''\n'Run test on each of the cells in checkRange\n'''\nFor Each subCell In checkRange\n    newTest = Replace(formulaTest, topLeft.Address(0, 0), subCell.Address)\n    If Count(newTest, \"(\") &lt; Count(newTest, \")\") Then 'when optional parameter is missed out, sometimes you get a ,) and sometimes a ) after formulaTest, so we must check\n        newTest = Left(newTest, Len(newTest) - 1)\n    End If\n    result = (Evaluate(newTest))\nskip:\n    results(UBound(results)) = result\n    ReDim Preserve results(UBound(results) + 1)\nNext subCell\n'''\n'Then use array of Booleans for UDF function\n'''\nCONCATIF = \"test\"\nExit Function\n\nErr:\nresult = False 'if the evaluate results in an error, it means the input was invalid, so probably won't meet the criteria, therefore can be ignored\nloopval = loopval + 1\nIf loopval &gt; checkRange.Cells.Count Then CONCATIF = CVErr(xlErrNA): Exit Function 'exit error loop gracefully if I've missed some edge case\nResume skip\n\nEnd Function\n</code></pre>\n\n<p>And then referenced in my UDF is this:</p>\n\n<pre><code>Function Count(str As String, chr As String) As Long 'counts the number of instances of a character in a string\n     Count = Len(str) - Len(Replace(str, chr, \"\"))\nEnd Function\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "onclick", "intranet"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1491392128, "post_id": 43229839, "comment_id": 73529795, "body": "<code>getElementsByXpath</code> isn&#39;t in my Microsoft HTML Object Library - is it in yours?"}, {"owner": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1491392534, "post_id": 43229839, "comment_id": 73530115, "body": "Yes I have, If you don&#39;t have <i>HTML Object Library</i> so what about <b>OnClick event</b>"}, {"owner": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1491392928, "post_id": 43229839, "comment_id": 73530403, "body": "MS office 2012."}], "answers": [{"comments": [{"owner": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "edited": false, "score": 0, "creation_date": 1491521076, "post_id": 43230518, "comment_id": 73603202, "body": "Giving error and highlight last instruction <code>objElement.Click</code>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "edited": false, "score": 0, "creation_date": 1491526852, "post_id": 43230518, "comment_id": 73604725, "body": "Unfortunately that means the <code>querySelector</code> did not work and <code>objElement</code> will be <code>Nothing</code>. I updated the code to alert if that is the case. Do you have a public URL that I can use so I can test the code?"}, {"owner": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "edited": false, "score": 0, "creation_date": 1491569250, "post_id": 43230518, "comment_id": 73624935, "body": "Yes, I have public Url: (<a href=\"http://www.ke.com.pk/complaints-services/duplicate-bill/\" rel=\"nofollow noreferrer\">ke.com.pk/complaints-services/duplicate-bill</a>)  But it has <b>Captcha</b> (Characters Image) also."}, {"owner": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "edited": false, "score": 0, "creation_date": 1491734786, "post_id": 43230518, "comment_id": 73676403, "body": "Any solution ? @Robin"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "edited": false, "score": 0, "creation_date": 1491734967, "post_id": 43230518, "comment_id": 73676447, "body": "That URL you referenced doesn&#39;t have a table with an id of <code>GridView1</code>... so I can&#39;t test. I posted the sample code to offer a solution but unfortunately there is not much more to offer unless we can see the HTML you are working with."}, {"owner": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "edited": false, "score": 0, "creation_date": 1491735681, "post_id": 43230518, "comment_id": 73676631, "body": "You will have to copy paste this number <b>0400003730342</b> into <b>Account Number field</b> then fill <b>Captcha Field</b> and then it will display <b>Table</b> @Robin"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "edited": false, "score": 0, "creation_date": 1491737333, "post_id": 43230518, "comment_id": 73677081, "body": "OK, I got there. I gave an update on the selector. HTH"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "edited": false, "score": 0, "creation_date": 1491747362, "post_id": 43230518, "comment_id": 73680021, "body": "Check <a href=\"http://caniuse.com/#feat=queryselector\" rel=\"nofollow noreferrer\">caniuse.com/#feat=queryselector</a> - which suggests it is implemented since IE11."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "edited": false, "score": 0, "creation_date": 1491834095, "post_id": 43230518, "comment_id": 73715687, "body": "I took another look and the content you are trying to access is in an <code>&lt;iframe&gt;</code> with <code>src=&quot;http:&#47;&#47;www.staging.ke.com.pk:24555&#47;ReBrand&#47;DuplicateBil&zwnj;&#8203;l.aspx&quot;</code>. I&#39;m getting <b><i>Access denied</i></b> errors everywhere trying to automate the elements in the <code>&lt;iframe&gt;</code> so assume there is a cross site scripting problem somewhere. Suggest you need to produce a MCVE (<a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>) and perhaps post another question. Good luck."}], "tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1491737304, "last_edit_date": 1491737304, "creation_date": 1491393436, "answer_id": 43230518, "question_id": 43229839, "link": "https://stackoverflow.com/questions/43229839/find-button-from-onclick-attribute-and-click/43230518#43230518", "title": "Find button from onclick attribute and click", "body": "<p>Interestingly you are calling <code>getElementsByXPath</code> but I can't find this method in my Microsoft HTML Object Library (Win10/ Excel 2013).</p>\n\n<p>Perhaps you could try using a CSS selector instead which you can use with the <code>querySelector</code> method of the <code>HTMLDocument</code> class:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uPjYs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uPjYs.png\" alt=\"enter image description here\"></a></p>\n\n<p>And then, instead of using:</p>\n\n<pre><code>htmlDoc.getElementsByXpath(\"input[type=\"\"button\"\"]\")(0).Click  &lt;--(Not Working)\n</code></pre>\n\n<p>You could try this (untested):</p>\n\n<pre><code>Dim strSelector As String\nDim objElement As Object\n\nstrSelector = \"table#GridView1 &gt; tbody &gt; tr &gt; td &gt; input[onclick=\"\"javascript:__doPostBack('GridView1','Account_number$0')\"\"]\"\n\nSet objElement = htmlDoc.querySelector(strSelector)\nIf Not objElement Is Nothing Then\n    objElement.Click\nElse\n    MsgBox \"Selector did not work!\"\nEnd If\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>Having had a look at the page source, and in line with the OP statement that:</p>\n\n<blockquote>\n  <p>More than one Download button exists on this page and I want to click on the first one.</p>\n</blockquote>\n\n<p>Then we can simplify the select to just this:</p>\n\n<pre><code>table#GridView1 &gt; tbody &gt; tr &gt; td &gt; input[onclick]\n</code></pre>\n\n<p>Which translates to find the first <code>&lt;input&gt;</code> with an <code>onclick</code> attribute in the table body.</p>\n\n<p>So the updated VBA is:</p>\n\n<pre><code>Dim strSelector As String\nDim objElement As Object\n\nstrSelector = \"table#GridView1 &gt; tbody &gt; tr &gt; td &gt; input[onclick]\"\n\nSet objElement = htmlDoc.querySelector(strSelector)\nIf Not objElement Is Nothing Then\n    objElement.Click\nElse\n    MsgBox \"Selector did not work!\"\nEnd If\n</code></pre>\n\n<p>The selector is tested in Chrome console, so my assumption is that it should work in the VBA in a similar fashion. HTH.</p>\n\n<p><a href=\"https://i.stack.imgur.com/r8QPL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r8QPL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 74, "user_id": 5335058, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-1ufBRjl67KA/AAAAAAAAAAI/AAAAAAAAACw/sNJ6ChMOXiI/photo.jpg?sz=128", "display_name": "sam m", "link": "https://stackoverflow.com/users/5335058/sam-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1231, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594153583, "creation_date": 1491391561, "last_edit_date": 1594153583, "question_id": 43229839, "link": "https://stackoverflow.com/questions/43229839/find-button-from-onclick-attribute-and-click", "title": "Find button from onclick attribute and click", "body": "<p>I'm using VBA and stuck on a way to trigger a <strong>Download</strong> button in <em>HTML PAGE</em> which inspects below codes:</p>\n\n<pre><code>&lt;input onClick=\"javascript:__dopostback('GridView1','Accountnumber$0')\" type=\"button\" value=\"Download\"&gt;&lt;/input&gt;\n</code></pre>\n\n<p>More than one <strong>Download button</strong> exists on this page and I want to click on the first one.</p>\n\n<p><a href=\"https://i.stack.imgur.com/egws2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/egws2.png\" alt=\"enter image description here\"></a></p>\n\n<p>In these elements the unique <em>Attribute</em> is:</p>\n\n<pre><code>\"OnClick=javascript:__dopostback('GridView1','Accountnumber$0')\"\n</code></pre>\n\n<p>But I don't know how to trigger with below VBA:</p>\n\n<pre><code>On Error GoTo Err_Clear\n myURL = \"Enter your url\"\n Set MyBrowser = New InternetExplorer\n MyBrowser.Silent = True\n MyBrowser.Navigate myURL\n MyBrowser.Visible = True\n Do\n Loop Until MyBrowser.ReadyState = READYSTATE_COMPLETE\n Set htmlDoc = MyBrowser.Document\n htmlDoc.all.txtAccNo.Value = \"\"\n htmlDoc.all.ddlReasons.Value = \"\"\n htmlDoc.all.txtRequester.Value = \"\" \n htmlDoc.all.txtMobNo.Value = \"\"\n htmlDoc.all.txtLandLine.Value = \"\"\n htmlDoc.all.txtEmailAdd.Value = \"\"\n htmlDoc.all.ddlRelation.Value = \"\"\n htmlDoc.all.button1.Click\n\n '**OnClick event required here **\n\n htmlDoc.getElementsByXpath(\"input[type=\"\"button\"\"]\")(0).Click  '&lt;--(Not Working)\n\n Err_Clear:\n If Err &lt;&gt; 0 Then\n Err.Clear\n Resume Next\n End If \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1491391737, "post_id": 43229705, "comment_id": 73529515, "body": "Excel has built in functionality - have a look at using a pivot table before you try and do it with a macro. <a href=\"https://support.office.com/en-us/article/Create-a-PivotTable-to-analyze-worksheet-data-a9a84538-bfe9-40a9-a8e9-f99134456576\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1491393049, "post_id": 43229705, "comment_id": 73530493, "body": "I would suggest making use of index(match()) functionality. Then this problem can be resolved using excel formula."}, {"owner": {"reputation": 3, "user_id": 4420666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364d3f8d9c9f2b7a7498ed1e3a5f7123?s=128&d=identicon&r=PG&f=1", "display_name": "Claire Kinclaven", "link": "https://stackoverflow.com/users/4420666/claire-kinclaven"}, "edited": false, "score": 0, "creation_date": 1491405596, "post_id": 43229705, "comment_id": 73540776, "body": "Great - thank you very much for the input - my table is now complete!  Thanks for making me see it much more clearly than I was thinking!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4420666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364d3f8d9c9f2b7a7498ed1e3a5f7123?s=128&d=identicon&r=PG&f=1", "display_name": "Claire Kinclaven", "link": "https://stackoverflow.com/users/4420666/claire-kinclaven"}, "edited": false, "score": 0, "creation_date": 1491405634, "post_id": 43230816, "comment_id": 73540802, "body": "Very helpful - thank you so much for taking the time to answer my question - very much appreciated.  C"}], "tags": [], "owner": {"reputation": 36, "user_id": 5579108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e49b39ecc899e24a87557c0bf105a219?s=128&d=identicon&r=PG&f=1", "display_name": "supergdify", "link": "https://stackoverflow.com/users/5579108/supergdify"}, "is_accepted": true, "score": 0, "last_activity_date": 1491394246, "creation_date": 1491394246, "answer_id": 43230816, "question_id": 43229705, "link": "https://stackoverflow.com/questions/43229705/macro-to-input-a-1-in-new-column-if-row-matches-unique-id-and-contains-text-of/43230816#43230816", "title": "Macro to input a &#39;1&#39; in new column if row matches unique ID and contains text of column header", "body": "<p>You could also use a vlookup that returns a 1 or a 0, based on whether or not the value was present:\n=IF(IFERROR(VLOOKUP(A1,$A$2:$B$20,1,FALSE),0)>0,1,0)</p>\n\n<p>If you have all your unique c_ID values in a column (say A1), then copy the formula above into column B2. You will need to change the code to reference the range of values that you are performing looking up against though; so $A$2:$B$20 needs to be replaced with the full range of these values spanned by your original dataset (make sure to keep the dollar symbols) on Sheet 1.</p>\n\n<p>Another option is to just replace $A$2:$B$20 with a named range. You can read about creating a simple range online and it is quite easy. Once you've named the range, you can just replace $A$2:$B$20 with your name and the formula should work.</p>\n\n<p>Hope this helps :)</p>\n"}], "owner": {"reputation": 3, "user_id": 4420666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364d3f8d9c9f2b7a7498ed1e3a5f7123?s=128&d=identicon&r=PG&f=1", "display_name": "Claire Kinclaven", "link": "https://stackoverflow.com/users/4420666/claire-kinclaven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 43230816, "answer_count": 1, "score": 0, "last_activity_date": 1491394246, "creation_date": 1491391252, "last_edit_date": 1491393413, "question_id": 43229705, "link": "https://stackoverflow.com/questions/43229705/macro-to-input-a-1-in-new-column-if-row-matches-unique-id-and-contains-text-of", "title": "Macro to input a &#39;1&#39; in new column if row matches unique ID and contains text of column header", "body": "<p>I would be very grateful if anyone could help me formulate a spreadsheet.  I have a simple spreadsheet with multiple repeated IDs per row in column 1, all containing a type of diagnosis in column 2 - each patient could have between 1 and 20 different variations.</p>\n\n<p>(Sorry I'm not allowed to post an image)</p>\n\n<p>Sheet 1 </p>\n\n<pre><code>c_ID | Diagnosis\n-----| ---------\n1    | a\n1    | c\n2    | a\n3    | a\n3    | s\n4    | h\n4    | g\n4    | f\n</code></pre>\n\n<p>I would like to make it so that each patient is only on one row, so I have created a new Table with each patient ID only once, and then a column header for each diagnosis.</p>\n\n<p>Sheet 2</p>\n\n<pre><code>c_ID | a | b | c | d | e ... | s\n</code></pre>\n\n<p>In each row, I would like to return a '1' where the patient ID matches and one of the specified diagnoses for that patient ID matches the column header, and a '0' where it does not.</p>\n\n<p>i.e. I want to write something in Sheet 2 like: If the c_ID in column 1 in Sheet 2 matches the c_ID in column 1 in Sheet 1, then for that c_ID search sheet 1 column 2 to see if any of the data for that c_ID matches any of the column headers columns 2-21 in sheet 2, and if yes return a 1 and if no return a 0.</p>\n\n<p>I have no experience in writing macros, or VBA, but I wondered if it is possible to do so?  I would be very grateful for any help, or advice as to a better way to go about this.</p>\n"}, {"tags": ["arrays", "vba", "excel", "listbox", "populate"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491391900, "post_id": 43229255, "comment_id": 73529636, "body": "You need a 2 dimensional array."}], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 8183648, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1e077c4aa48feab8b76c2142b1abf3eb?s=128&d=identicon&r=PG&f=1", "display_name": "JimT", "link": "https://stackoverflow.com/users/8183648/jimt"}, "edited": false, "score": 0, "creation_date": 1543866155, "post_id": 43248739, "comment_id": 94063922, "body": "Not sure if you ever got to your answer, but you should be able to &quot;ReDim Preserve auftrpos4&quot;"}], "tags": [], "owner": {"reputation": 21, "user_id": 6668890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060309bfe396161848c66bef0806298b?s=128&d=identicon&r=PG&f=1", "display_name": "Mally", "link": "https://stackoverflow.com/users/6668890/mally"}, "is_accepted": false, "score": 0, "last_activity_date": 1491468391, "last_edit_date": 1491468391, "creation_date": 1491464459, "answer_id": 43248739, "question_id": 43229255, "link": "https://stackoverflow.com/questions/43229255/populating-a-listbox-with-array-containing-more-than-10-columns-getting-rows-i/43248739#43248739", "title": "Populating a Listbox with array containing more than 10 columns - getting rows instead of columns", "body": "<p>Ok this did the trick ^^ :) thanks for showing me the right path!\nBut i am not there yet, when i want to add a second position the first entry gets replaced by the new one instead of being added, how can one achieve this?</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Dim auftrpos4(0, 12) As String\r\n\r\n                    auftrpos4(0, 0) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"A\").Value\r\n                    auftrpos4(0, 1) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"C\").Value\r\n                    auftrpos4(0, 2) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"D\").Value\r\n                    auftrpos4(0, 3) = size\r\n                    auftrpos4(0, 4) = amount\r\n                    auftrpos4(0, 5) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"E\").Value\r\n                    auftrpos4(0, 6) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"S\").Value\r\n                    auftrpos4(0, 7) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"T\").Value\r\n                    auftrpos4(0, 8) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"U\").Value\r\n                    auftrpos4(0, 9) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"V\").Value\r\n                    auftrpos4(0, 10) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"W\").Value\r\n                    auftrpos4(0, 11) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"R\").Value\r\n                    \r\nWith UserForm1.ListBox2\r\n  .ColumnCount = 12\r\n  .List = auftrpos4\r\nEnd With</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 21, "user_id": 6668890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060309bfe396161848c66bef0806298b?s=128&d=identicon&r=PG&f=1", "display_name": "Mally", "link": "https://stackoverflow.com/users/6668890/mally"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1223, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491469813, "creation_date": 1491390016, "last_edit_date": 1491469813, "question_id": 43229255, "link": "https://stackoverflow.com/questions/43229255/populating-a-listbox-with-array-containing-more-than-10-columns-getting-rows-i", "title": "Populating a Listbox with array containing more than 10 columns - getting rows instead of columns", "body": "<p>I am using a Listbox to show order data in an inventory management system.</p>\n\n<p>The Ordernumber is typed into the textbox. Hitting CommandButton1 Searches for the corresponding value in the Table. Then the Row number of the found record is being used to fill the array with values</p>\n\n<p>the following option does not work, since the Listbox Element in VBA is limited to 10 columns</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>With ListBox2\r\n  ListBox2.ColumnCount = 10\r\n  .AddItem\r\n  .List(listBoxPos, 0) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"A\").Value \r\n  .List(listBoxPos, 1) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"C\").Value\r\n  '... \r\n  .List(listBoxPos, 9) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"R\").Value\r\nEnd With</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Unfortunately i need more than 10 columns. These columns are not within a Range (not next to each other, some are not needed) </p>\n\n<p>I need the following columns A,C,D,E,S,T,U,V,W,R (F to P are processed by other method and written into 2 variables)</p>\n\n<p>For now i tried to form an Array and write the values</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Dim rZelle        As Range\r\nDim sSuchbegriff  As String\r\nDim listBoxPos  As Integer\r\nDim matchcodeLs As String\r\nDim matchcodeNew As String\r\n\r\n\r\n\r\n'Variables for each item that is going to be added to ListBox\r\nDim matchcodePos As String\r\nDim bestnr As String\r\nDim artnr As String\r\nDim farbcode As String\r\nDim bemerkung As String\r\nDim ordertyp As String\r\nDim lieferdat As String\r\nDim hzlt As String\r\nDim kommision As String\r\nDim fnr As String\r\nDim size As String\r\nDim amount As String\r\n\r\n'Arrays that i tried to use to populate ListBox\r\nDim auftrpos(12) As String\r\nDim auftrpos2() As Variant\r\n\r\n\r\n'Checks if value exists in TextBox\r\nIf Trim$(TextBox1.Value) &lt;&gt; \"\" Then\r\n    sSuchbegriff = Trim$(TextBox1.Value)\r\nElse\r\n    MsgBox \"Sie m\u00fcssen einen Suchbegiff eingeben!\", _\r\n    48, \"   Hinweis f\u00fcr \" &amp; Application.UserName\r\n    Exit Sub\r\nEnd If\r\n'Search in the Column A of Table for Value from TextBox\r\nWith ThisWorkbook.Worksheets(\"Tabelle1\").Columns(1)\r\n\r\n'sets variable rZelle with found value\r\nSet rZelle = .Find(What:=sSuchbegriff, LookAt:=xlWhole, LookIn:=xlValues)\r\n    'when value is found\r\n    If Not rZelle Is Nothing Then\r\n\r\n\r\n        '(other code and stuff....)\r\n        \r\n        \r\n                    'Going through column F to P and filling Variable Amount and Size\r\n                    \r\n                    If Not Sheets(\"Tabelle1\").Cells(rZelle.Row, \"F\").Value = \"\" Then\r\n                        'Sheets(\"Sheet1\").Cells(ind + 3, \"C\").Value = 34\r\n                        size = \"34\"\r\n                        amount = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"F\").Value\r\n                    End If\r\n                    \r\n                    '(........ ....... ....)\r\n                    \r\n                    If Not Sheets(\"Tabelle1\").Cells(rZelle.Row, \"P\").Value = \"\" Then\r\n                        'Sheets(\"Sheet1\").Cells(ind + 3, \"C\").Value = \"\"\r\n                        size = \"X\"\r\n                        amount = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"P\").Value\r\n                    End If\r\n                    \r\n            \r\n            \r\n                    'Populating the first array\r\n                    auftrpos(0) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"A\").Value\r\n                    auftrpos(1) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"C\").Value\r\n                    auftrpos(2) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"D\").Value\r\n                    auftrpos(3) = size\r\n                    auftrpos(4) = amount\r\n                    auftrpos(5) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"E\").Value\r\n                    auftrpos(6) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"S\").Value\r\n                    auftrpos(7) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"T\").Value\r\n                    auftrpos(8) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"U\").Value\r\n                    auftrpos(9) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"V\").Value\r\n                    auftrpos(10) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"W\").Value\r\n                    auftrpos(11) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"R\").Value\r\n                    \r\n                    \r\n                   'populating the second array\r\n                    \r\n                    auftrpos2 = Array(Sheets(\"Tabelle1\").Cells(rZelle.Row, \"A\").Value, Sheets(\"Tabelle1\").Cells(rZelle.Row, \"C\").Value, Sheets(\"Tabelle1\").Cells(rZelle.Row, \"D\").Value, size, amount, Sheets(\"Tabelle1\").Cells(rZelle.Row, \"E\").Value, Sheets(\"Tabelle1\").Cells(rZelle.Row, \"S\").Value, Sheets(\"Tabelle1\").Cells(rZelle.Row, \"T\").Value, Sheets(\"Tabelle1\").Cells(rZelle.Row, \"U\").Value, Sheets(\"Tabelle1\").Cells(rZelle.Row, \"V\").Value, auftrpos(10) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"W\").Value, auftrpos(11) = Sheets(\"Tabelle1\").Cells(rZelle.Row, \"R\").Value)\r\n                    \r\n                  \r\n                    \r\n                    With UserForm1.ListBox2\r\n                        .ColumnCount = 12\r\n                        \r\n                        '.List = Application.Transpose(auftrpos2)\r\n                        '.List = Application.Transpose(auftrpos)\r\n                        '.List = auftrpos2\r\n                        '.List = auftrpos\r\n                    End With\r\n                                \r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>i tried populating the ListBox in several ways but i always end up getting rows instead of columns</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1491390266, "post_id": 43229156, "comment_id": 73528444, "body": "Please make this clearer. Are you trying to aggregate the different prices, or are these alternatives? See more <a href=\"https://stackoverflow.com/help/how-to-ask\">here</a> on how to make the question clearer."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1491390634, "post_id": 43229156, "comment_id": 73528711, "body": "There may be a way.  <b>But</b> you need to show what you have tried for us to help you.  Review <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to see what a good question looks like."}], "answers": [{"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 1, "last_activity_date": 1491391225, "last_edit_date": 1592644375, "creation_date": 1491391225, "answer_id": 43229692, "question_id": 43229156, "link": "https://stackoverflow.com/questions/43229156/excel-compare-cells-in-same-column-and-calculate-value/43229692#43229692", "title": "EXCEL: compare cells in same column and calculate value", "body": "<p>The easiest way to do this would be using a PivotTable. The PivotTable will group the items together for you based on the product name, and can display the max and min for each name.</p>\n<p>This would remove the need for the &quot;BS&quot;/&quot;PB&quot; column you have, and give you profit per product nice and neatly!</p>\n<p>You would lay it out like so:</p>\n<p><a href=\"https://i.stack.imgur.com/Y2V9K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y2V9K.png\" alt=\"pivot table\" /></a></p>\n<p>To insert a pivot table, select your data and click Insert &gt; PivotTable.</p>\n<p>To populate the &quot;Row Labels&quot; and &quot;Values&quot; sections, simply drag the fields (top of the PivotTable window) into the sections as shown in my example.</p>\n<p>By default, the &quot;Values&quot; items will be a sum. You can change this by clicking the small arrow by each item and choosing &quot;Value Field Settings...&quot; then either min or max.</p>\n<p>You can then add the difference (or &quot;profit&quot;) column yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1491392408, "creation_date": 1491392408, "answer_id": 43230150, "question_id": 43229156, "link": "https://stackoverflow.com/questions/43229156/excel-compare-cells-in-same-column-and-calculate-value/43230150#43230150", "title": "EXCEL: compare cells in same column and calculate value", "body": "<p>You may try these <strong>Array Formulas</strong> which will require special key stroke <strong>Ctrl+Shift+Enter</strong> instead of Enter alone.</p>\n\n<p>In E2 (This will return PB or BS based on prices available for a product)</p>\n\n<pre><code>=IF(B2=MIN(IF($A$2:$A$12=A2,$B$2:$B$12)),\"BS\",IF(B2=MAX(IF($A$2:$A$12=A2,$B$2:$B$12)),\"PB\",\"\"))\n</code></pre>\n\n<p>In F2 (This will return the profit based on BS and PB)</p>\n\n<pre><code>=IF(B2=MAX(IF($A$2:$A$12=A2,$B$2:$B$12)),D2-MIN(IF($A$2:$A$12=A2,$B$2:$B$12)),\"\")\n</code></pre>\n\n<p>Remember to confirm both the above formulas with <strong>Ctrl+Shift+Enter</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7819982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccda790d576108c1ec0665806cbdb621?s=128&d=identicon&r=PG&f=1", "display_name": "JFerreira", "link": "https://stackoverflow.com/users/7819982/jferreira"}, "is_accepted": false, "score": 0, "last_activity_date": 1491483187, "creation_date": 1491483187, "answer_id": 43255802, "question_id": 43229156, "link": "https://stackoverflow.com/questions/43229156/excel-compare-cells-in-same-column-and-calculate-value/43255802#43255802", "title": "EXCEL: compare cells in same column and calculate value", "body": "<p>Thanks for your help. :D \nI used the IFSUM function, that also worked.</p>\n\n<pre><code>=SUMIFS($D$2:$D$12,$A$2:$A$12,A15,$E$2:$E$12,\"PB\")-SUMIFS($D$2:$D$12,$A$2:$A$12,A15,$E$2:$E$12,\"BS\")\n</code></pre>\n\n<p>I will test both your suggestions! </p>\n\n<p>Regards</p>\n"}], "owner": {"reputation": 11, "user_id": 7819982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccda790d576108c1ec0665806cbdb621?s=128&d=identicon&r=PG&f=1", "display_name": "JFerreira", "link": "https://stackoverflow.com/users/7819982/jferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1491483187, "creation_date": 1491389760, "last_edit_date": 1531161705, "question_id": 43229156, "link": "https://stackoverflow.com/questions/43229156/excel-compare-cells-in-same-column-and-calculate-value", "title": "EXCEL: compare cells in same column and calculate value", "body": "<p>I need to calculate the profit based on the price from the supplier with the lowest price, and the price from the supplier with the biggest price. The assumption is that I will base my sale prices on the highest supplier prices.</p>\n\n<p>As you can see in the table below, I have the columns </p>\n\n<ul>\n<li>Products</li>\n<li>Buy (price from my supplier)</li>\n<li>Sale % (the margin that I put on the supplier price to sell)</li>\n<li>The final price </li>\n<li>Finally, where I choose from which supplier I buy (BS) and which value I use as base to sell (PB).</li>\n</ul>\n\n<p>Is there any way to calculate the profit for products A/B/C/... using PB-BS?</p>\n\n<p><img src=\"https://i.stack.imgur.com/rfXcC.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1491389995, "post_id": 43229149, "comment_id": 73528236, "body": "There must be a difference between the two values. Perhaps a leading or trailing space, or a char(160) rather than a true space in the name."}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491391100, "post_id": 43229149, "comment_id": 73529058, "body": "and how can I figure it out and/or fix it?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491391227, "post_id": 43229149, "comment_id": 73529129, "body": "Start by checking the values on the worksheet carefully"}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491392634, "post_id": 43229149, "comment_id": 73530193, "body": "everything seems okay"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491392720, "post_id": 43229149, "comment_id": 73530247, "body": "What does this display: <code>msgbox Worksheets(&quot;Sales&quot;).Range(&quot;A1&quot;).Value = &quot;Shop 1&quot;</code>"}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491393349, "post_id": 43229149, "comment_id": 73530705, "body": "it returns &quot;not correct&quot;"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491393451, "post_id": 43229149, "comment_id": 73530776, "body": "Which confirms my initial answer. What do these return: <code>msgbox Worksheets(&quot;Sales&quot;).Range(&quot;A1&quot;).Value</code>, <code>msgbox len(Worksheets(&quot;Sales&quot;).Range(&quot;A1&quot;).Value)</code>, <code>msgbox ascw(mid$(Worksheets(&quot;Sales&quot;).Range(&quot;A1&quot;).Value, 5, 1))</code>"}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491394157, "post_id": 43229149, "comment_id": 73531356, "body": "1st returns: message box &quot;Assignment group&quot;"}, {"owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491394175, "post_id": 43229149, "comment_id": 73531375, "body": "2nd and 3rd return numbers"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1491397821, "post_id": 43229149, "comment_id": 73534241, "body": "So which cell should contain &quot;shop 1&quot;?"}], "owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491389730, "creation_date": 1491389730, "last_edit_date": 1531161705, "question_id": 43229149, "link": "https://stackoverflow.com/questions/43229149/hlookup-function-returns-n-a-when-lookup-value-exists", "title": "HLookup function returns N/A when Lookup value exists", "body": "<p>I have the following table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0Y7ss.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0Y7ss.png\" alt=\"enter image description here\"></a></p>\n\n<p>with the help of HLookup I'm trying to find a value related to each shop</p>\n\n<pre><code>Dim V1 As Variant\nWith Worksheets(\"Sales\")\nSet Lookup_Range = .Range(\"A1:H6\")\n\n    V1 = Application.HLookup(\"Shop 1\", Lookup_Range, 2, False)\n\n--checking if the value exists        \n If IsError(V1) Then\n    .Cells(1, 20) = 0\n Else\n    .Cells(1, 20) = V1\n End If\n End With\n</code></pre>\n\n<p>The function doesn't find the value, even though the \"Shop 1\" exists. Without \"IsError(V1)\" I get N/A. I don't understand what is wrong and where could be a problem?</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1491389347, "creation_date": 1491389347, "answer_id": 43229008, "question_id": 43228798, "link": "https://stackoverflow.com/questions/43228798/convert-excel-formula-to-vba-code-return-location-of-duplicate-cell/43229008#43229008", "title": "Convert Excel formula to VBA code (return location of duplicate cell)", "body": "<p>Assuming you want to place this Array formula in E2 and then drag it to N2, try this...</p>\n\n<pre><code>Range(\"E2\").FormulaArray = \"=IF(COLUMNS($D2:D2)&gt;$C2,\"\"\"\",SMALL(IF($B$2:$B$20=$B2,ROW(B$2:B$20)),COLUMNS($D2:D2)))\"\nRange(\"E2\").AutoFill Destination:=Range(\"E2:N2\"), Type:=xlFillDefault\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7818882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5429c0ac15873895f0a20034329f86b?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/7818882/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1491390371, "creation_date": 1491390371, "answer_id": 43229402, "question_id": 43228798, "link": "https://stackoverflow.com/questions/43228798/convert-excel-formula-to-vba-code-return-location-of-duplicate-cell/43229402#43229402", "title": "Convert Excel formula to VBA code (return location of duplicate cell)", "body": "<pre><code> Sub checkDuplicate()\n Dim sduplicate As String\n Dim lastrow As Long\n Dim iCount As Long\n Dim j As Long\n   'To Find the Last Row of the Sheet\n lastrow = Sheets(\"sheetname\").Cells(Rows.Count, \"A\").End(xlUp).Row\n   'To get the input from the user\n sduplicate = InputBox(\"Please enter the Name:\")\n   'Looping\n j = 1\n  For iCount = 1 To lastrow\n        'Assuming the \"name\" is in column 1 so checking in column 1\n        If Sheets(\"sheetname\").Cells(iCount, 1).Value = sduplicate Then\n           'if the duplicate is found then put the value in column 5\n           Sheets(\"sheetname\").Cells(j, 5).Value = iCount\n           j = j + 1\n        End If\n\n    Next iCount\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7819512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/786501a101266163a64657c074deb56f?s=128&d=identicon&r=PG&f=1", "display_name": "James Deng", "link": "https://stackoverflow.com/users/7819512/james-deng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1491391474, "creation_date": 1491388810, "last_edit_date": 1491391474, "question_id": 43228798, "link": "https://stackoverflow.com/questions/43228798/convert-excel-formula-to-vba-code-return-location-of-duplicate-cell", "title": "Convert Excel formula to VBA code (return location of duplicate cell)", "body": "<p>I have this Excel formula</p>\n\n<pre><code>=IF(COLUMNS($D2:D2)&gt;$C2,\"\",SMALL(IF($B$2:$B$20=$B2,ROW(B$2:B$20)),COLUMNS($D2:D2)))\n</code></pre>\n\n<p>Basically what this formula does is look through a list of names (with duplicates), then returns the position of the name I'm looking for.</p>\n\n<p>For example if my data looks something like this:</p>\n\n<pre><code>A\nB\nD\nA\n</code></pre>\n\n<p>and if I'm looking for A then my formula will return 1 and 4 (in two different cells)</p>\n\n<p>My question is how to convert this formula into VBA code? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1491388848, "post_id": 43228686, "comment_id": 73527387, "body": "You can dispense with the brackets <code>importCSV fileName, TRUE</code> otherwise Excel tries to evaluate the contents of the brackets."}, {"owner": {"reputation": 1, "user_id": 7818882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5429c0ac15873895f0a20034329f86b?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/7818882/matt"}, "edited": false, "score": 0, "creation_date": 1491388854, "post_id": 43228686, "comment_id": 73537011, "body": "Check if &quot;a&quot; Variable is Boolean"}], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 1832175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6559a21eddd2c8d44c816c0601d78d6e?s=128&d=identicon&r=PG", "display_name": "Marius Katinas", "link": "https://stackoverflow.com/users/1832175/marius-katinas"}, "is_accepted": true, "score": 15, "last_activity_date": 1491389026, "creation_date": 1491389026, "answer_id": 43228887, "question_id": 43228686, "link": "https://stackoverflow.com/questions/43228686/vba-call-function-without-return-variable/43228887#43228887", "title": "VBA - call function without return variable", "body": "<p>To avoid assigning the return value to any variable you can use <code>call</code> keyword</p>\n\n<pre><code>call importCSV(fileName As Variant, TRUE)\n</code></pre>\n\n<p>Additionally you can call the function this way:</p>\n\n<pre><code>importCSV fileName:=\"File name\", linkToHeader:=TRUE\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6165914, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pzgGXgVQoUI/AAAAAAAAAAI/AAAAAAAAAEo/sS84PoObiR0/photo.jpg?sz=128", "display_name": "Miroslav Kolouch", "link": "https://stackoverflow.com/users/6165914/miroslav-kolouch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17634, "favorite_count": 0, "accepted_answer_id": 43228887, "answer_count": 1, "score": 4, "last_activity_date": 1491389026, "creation_date": 1491388454, "question_id": 43228686, "link": "https://stackoverflow.com/questions/43228686/vba-call-function-without-return-variable", "title": "VBA - call function without return variable", "body": "<p>i have function:</p>\n\n<pre><code>Function importCSV(fileName As Variant) As Boolean\n\n' some code\n' no importCSV = TRUE\n\nend Function\n</code></pre>\n\n<p>i call this function</p>\n\n<pre><code>importCSV (fileName As Variant)\n</code></pre>\n\n<p>every do OK, bud when a modific function.</p>\n\n<pre><code>Function importCSV(fileName As Variant, linkToHeader As Boolean) As Boolean\n    ' some code\n    ' no importCSV = TRUE\n\nend Function\n</code></pre>\n\n<p>i cant call function like this</p>\n\n<pre><code>importCSV (fileName As Variant, TRUE)\n</code></pre>\n\n<p>VBA detect syntax error and a must call</p>\n\n<pre><code>a = importCSV(fileName As Variant, TRUE)\n</code></pre>\n\n<p>Why?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1491387862, "post_id": 43228393, "comment_id": 73526647, "body": "Correct this line <code>Set rng = .Range(.Cells(1, 2), .Cells(50, LColI))</code> and tell us which line errors. You should use a similar formulation for <code>LColO</code>."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1491387864, "post_id": 43228393, "comment_id": 73526648, "body": "Where exactly does the error occur? What value is held in <code>LColO</code> and <code>LColI</code> when it happens?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7819770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc00e37db4a7d7b24b106ac964cd8169?s=128&d=identicon&r=PG&f=1", "display_name": "LBenson", "link": "https://stackoverflow.com/users/7819770/lbenson"}, "edited": false, "score": 0, "creation_date": 1491395079, "post_id": 43228516, "comment_id": 73532049, "body": "Thanks so much SJR. The code does run now but each new sheet overwrites the next one. So I need to copy the data from each used column in each of the input worksheets and copy those data into the output sheet starting at the first empty column. Could you point me in the right direction with fixing this?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 7819770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc00e37db4a7d7b24b106ac964cd8169?s=128&d=identicon&r=PG&f=1", "display_name": "LBenson", "link": "https://stackoverflow.com/users/7819770/lbenson"}, "edited": false, "score": 0, "creation_date": 1491397524, "post_id": 43228516, "comment_id": 73533984, "body": "Sorry, I didn&#39;t follow my own logic and forgot to change the destination range. Amended now."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1491397504, "last_edit_date": 1491397504, "creation_date": 1491388050, "answer_id": 43228516, "question_id": 43228393, "link": "https://stackoverflow.com/questions/43228393/extracting-data-from-multiple-tabs-into-next-available-column-in-output-sheet-us/43228516#43228516", "title": "Extracting data from multiple tabs into next available column in output sheet using VBA", "body": "<p>Try this. I've corrected the syntax as above (your assignation of LColO didn't make sense because A is a column and range wants a row and a column). I have also declared all your variables, which is good practice even if it probably didn't cause an error in this instance.</p>\n\n<pre><code>Sub ExtractSamples()\n\nDim wsOutput As Worksheet, wsInput As Worksheet\nDim LColI As Long, LColO As Long\n\nSet wsOutput = ActiveWorkbook.Sheets(\"Samples\")\n\nFor Each wsInput In ActiveWorkbook.Worksheets\n    If wsInput.Name &lt;&gt; wsOutput.Name Then\n        With wsInput\n            LColI = .Cells(1, .Columns.Count).End(xlToLeft).Column\n            Set Rng = .Range(.Cells(1, 2), .Cells(50, LColI))\n            Rng.Copy\n            With wsOutput\n                LColO = .Cells(1, .Columns.Count).End(xlToLeft).Column + 1\n                .Cells(1, LColO).PasteSpecial Paste:=xlPasteAllUsingSourceTheme, _\n                Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            End With\n        End With\n    End If\nNext wsInput\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7819770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc00e37db4a7d7b24b106ac964cd8169?s=128&d=identicon&r=PG&f=1", "display_name": "LBenson", "link": "https://stackoverflow.com/users/7819770/lbenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491397504, "creation_date": 1491387720, "question_id": 43228393, "link": "https://stackoverflow.com/questions/43228393/extracting-data-from-multiple-tabs-into-next-available-column-in-output-sheet-us", "title": "Extracting data from multiple tabs into next available column in output sheet using VBA", "body": "<p>I have a lot of different workbooks that have multiple tabs that I need to extract data from to summarise. Unfortunately they are all in columns so each data point is in its own column with the categories in rows down to 50. </p>\n\n<p>I need to be able to copy all of the used columns bar column A in each sheet into an output sheet named \"Samples\". So for each new tab I need the data to be pasted to the next available column in the output sheet. </p>\n\n<p>The following is the code that I have written but on the second loop I get an object defined error.</p>\n\n<p>Can anyone point me in the right direction? I'm pretty new to all this!</p>\n\n<pre><code>Sub ExtractSamples()\n    Set wsOutput = ActiveWorkbook.Sheets(\"Samples\")\n\n\nFor Each wsInput In ActiveWorkbook.Worksheets\n\n    If wsInput.Name &lt;&gt; wsOutput.Name Then\n\n        With wsInput\n\n            LColI = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n            Set rng = .Range(.Cells(1, 2) &amp; .Cells(50, LColI))\n\n            rng.Copy\n\n            With wsOutput\n\n                LColO = .Range(\"A\" &amp; .Columns.Count).End(xlToLeft).Column + 1\n\n\n                .Range(\"A\" &amp; LColO).PasteSpecial Paste:=xlPasteAllUsingSourceTheme, _\n                Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            End With\n        End With\n    End If\nNext wsInput\n\nEnd Sub\n</code></pre>\n\n<p>Thanks so much!</p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1491387588, "post_id": 43228206, "comment_id": 73526435, "body": "I&#39;d guess you&#39;d want to include a reference to <code>Microsoft Excel 15.0 Object Library</code> if you want to refer to <code>Workbook</code> <i>from</i> Outlook."}, {"owner": {"reputation": 31, "user_id": 7819692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7945c2afabe0142a5714645353277d1?s=128&d=identicon&r=PG&f=1", "display_name": "G. Young", "link": "https://stackoverflow.com/users/7819692/g-young"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1491581756, "post_id": 43228206, "comment_id": 73633743, "body": "Thanks! That did the job."}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 1, "last_activity_date": 1491666869, "creation_date": 1491666869, "answer_id": 43296185, "question_id": 43228206, "link": "https://stackoverflow.com/questions/43228206/using-sub-that-proceses-excel-objects-from-within-outlook/43296185#43296185", "title": "Using Sub, that proceses Excel objects, from within Outlook", "body": "<p>Include a reference to <code>Microsoft Excel 15.0 Object Library</code> if you want to refer to <code>Workbook</code> from Outlook.</p>\n"}], "owner": {"reputation": 31, "user_id": 7819692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7945c2afabe0142a5714645353277d1?s=128&d=identicon&r=PG&f=1", "display_name": "G. Young", "link": "https://stackoverflow.com/users/7819692/g-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491718810, "creation_date": 1491387206, "last_edit_date": 1531164843, "question_id": 43228206, "link": "https://stackoverflow.com/questions/43228206/using-sub-that-proceses-excel-objects-from-within-outlook", "title": "Using Sub, that proceses Excel objects, from within Outlook", "body": "<p>I am using the CreateCSV() public sub within Outlook 15.0 however obtain the error message \"Compile Error: User Defined Type Not Defined\" at the second line below.</p>\n\n<pre><code>Public Sub CreateCSV(dataWbFile As String, Optional InputDt As String)    \nDim dataWb As Workbook\n</code></pre>\n\n<p>For context, I am using CreateCSV within this piece of code:</p>\n\n<pre><code>For Each Item In SubFolder.Items\n    For Each Atmt In Item.Attachments\n        If LCase(Right(Atmt.filename, Len(ExtString))) = LCase(ExtString) Then\n            filename = DestFolder &amp; Atmt.filename\n            Atmt.SaveAsFile filename\n            ReceivedTime = DateSerial(Year(Item.ReceivedTime), Month(Item.ReceivedTime), Day(Item.ReceivedTime))\n            Call CreateCSV(filename, ReceivedTime)\n            i = i + 1\n        End If\n    Next Atmt\n    Item.Delete\nNext Item\n</code></pre>\n\n<p>Which I am using to sort through a file of emails, save the attachments and delete the email after doing so.</p>\n\n<p>I'm new to this. I've downloaded the Tools->References package Microsoft Outlook 15.0 Object Library which I read was one potential problem.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1491388264, "post_id": 43228134, "comment_id": 73526952, "body": "Aside from not changing <code>x</code>, what is the purpose of your loop? Why select some cells?"}, {"owner": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1491390173, "post_id": 43228134, "comment_id": 73528388, "body": "eg. x=2,  If value in cell B2=B3 and D2=D3, then I want the output as E2+E3, and the value will get stored in another cell eg F2  then, if B3=B4 and D3=D4, then output is E3+E4  I will remove the select statment"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1491390518, "post_id": 43228134, "comment_id": 73528622, "body": "But there is no output anywhere. You do not place <code>sumx</code> in a cell."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "edited": false, "score": 0, "creation_date": 1491389591, "post_id": 43228222, "comment_id": 73527923, "body": "I changed it, added (x = x + 1) before (Else)  however it is still not giving any output and it still a never ending code"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "edited": false, "score": 1, "creation_date": 1491390187, "post_id": 43228222, "comment_id": 73528400, "body": "Did you see @Matt&#39;s comment about changing the <code>Do While Cells(x, 2) &lt;&gt; &quot;[SPACE]&quot;</code> to <code>Do While Cells(x, 2) &lt;&gt; &quot;&quot;</code> ? That said, @Ralph appears to have rewritten the whole thing for you which I&#39;m sure will work :)"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1491387256, "creation_date": 1491387256, "answer_id": 43228222, "question_id": 43228134, "link": "https://stackoverflow.com/questions/43228134/never-ending-vba-neither-getting-the-result-please-tell-me-the-error-in-this-c/43228222#43228222", "title": "Never ending VBA, neither getting the result. Please tell me the error in this code", "body": "<p>You're not incrementing <code>x</code> - so it never changes.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7818882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5429c0ac15873895f0a20034329f86b?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/7818882/matt"}, "is_accepted": false, "score": -1, "last_activity_date": 1491398074, "last_edit_date": 1491398074, "creation_date": 1491387755, "answer_id": 43228399, "question_id": 43228134, "link": "https://stackoverflow.com/questions/43228134/never-ending-vba-neither-getting-the-result-please-tell-me-the-error-in-this-c/43228399#43228399", "title": "Never ending VBA, neither getting the result. Please tell me the error in this code", "body": "<p>Two things:</p>\n\n<p>a) Space you need to remove in  - <code>Do While Cells(x, 2) &lt;&gt; \"\"</code></p>\n\n<p>B) increment <code>x = x + 1</code></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "edited": false, "score": 0, "creation_date": 1491401565, "post_id": 43229045, "comment_id": 73537470, "body": "Thanks a lot for the explanation, I tried the code, however did not get any output(it didn&#39;t give any compilation error though)"}, {"owner": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "edited": false, "score": 0, "creation_date": 1491402038, "post_id": 43229045, "comment_id": 73537846, "body": "Thanks a lot for the explanation, I tried the code, however, did not get any output(it didn&#39;t give any compilation error though)   Option Explicit    Sub dowhileloop()  Dim x As Long Dim sumX As Long Dim ws As Worksheet Dim n As Integer  Set ws = ThisWorkbook.Worksheets(&quot;test data&quot;)  For x = 2 To ws.Cells(ws.Rows.Count, &quot;B&quot;).End(xlUp).Row     sumX = ws.Cells(x, 5).Value2     If ws.Cells(x, 2) = ws.Cells(x + n, 2) And ws.Cells(x, 4) = ws.Cells(x + n, 4) Then         sumX = sumX + ws.Cells(x + n, 5).Value     Else         n = n + 1              End If Next x  End Sub"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 2, "last_activity_date": 1491396626, "last_edit_date": 1491396626, "creation_date": 1491389452, "answer_id": 43229045, "question_id": 43228134, "link": "https://stackoverflow.com/questions/43228134/never-ending-vba-neither-getting-the-result-please-tell-me-the-error-in-this-c/43229045#43229045", "title": "Never ending VBA, neither getting the result. Please tell me the error in this code", "body": "<p>I am guessing that you are looking for something like this:</p>\n\n<pre><code>Option Explicit\n\nSub dowhileloop()\n\nDim x As Long\nDim sumX As Long\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"test data\")\n\nFor x = 2 To ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n    sumX = ws.Cells(x, 5).Value2\n    If ws.Cells(x, 2) = ws.Cells(x + 1, 2) And ws.Cells(x, 4) = ws.Cells(x + 1, 4) Then\n        sumX = sumX + ws.Cells(x + 1, 5).Value\n    Else\n        ' ...do something else?\n    End If\nNext x\n\nws.Activate\nws.Range(\"F2:G100\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Changes:</p>\n\n<ol>\n<li>There is no need to <code>select</code> anything just to manipulate the data on that sheet. It is especially not necessary to <code>select</code> something multiple times in a <code>Loop</code>. But if you want to make sure that a certain range is selected at the end of your program then you might as well put it to the end of your code.</li>\n<li>I changed the <code>Do while ... Loop</code> for a <code>For ... Next</code> loop. This loop is definite while the <code>Do while ... Loop</code> has a tendency to get infinite if you are not careful. Hence, I always try to avoid them.</li>\n<li>The code is now more explicit and fully qualified using <code>Set ws = ...</code> in the beginning and then using <code>ws.</code> in all the <code>Cells</code> and <code>Range</code> refernces afterwards.</li>\n<li>The line <code>DoEvents</code> does not strike me as being necessary in this context. Hence, I removed it.</li>\n</ol>\n\n<p>The rest is pretty much the same. Still, if you have questions then don't hesitate to ask.</p>\n"}], "owner": {"reputation": 3, "user_id": 7819716, "user_type": "registered", "profile_image": "https://graph.facebook.com/1372884739445648/picture?type=large", "display_name": "Shreya Dubey", "link": "https://stackoverflow.com/users/7819716/shreya-dubey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 43228222, "answer_count": 3, "score": 0, "last_activity_date": 1491398074, "creation_date": 1491387047, "last_edit_date": 1531164843, "question_id": 43228134, "link": "https://stackoverflow.com/questions/43228134/never-ending-vba-neither-getting-the-result-please-tell-me-the-error-in-this-c", "title": "Never ending VBA, neither getting the result. Please tell me the error in this code", "body": "<pre><code>Option Explicit\n\nSub dowhileloop()\n\nDim x As Long\nDim sumx As Long\nSheets(\"test data\").Select\nx = 2\nDo While Cells(x, 2) &lt;&gt; \" \"\nDoEvents\nsumx = Cells(x, 5).Value\nIf Cells(x, 2) = Cells(x + 1, 2) And Cells(x, 4) = Cells(x + 1, 4) Then\nsumx = sumx + Cells(x + 1, 5).Value\nRange(\"F2:G100\").Select\nElse\nEnd If\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>Never ending VBA, neither getting the result. Please tell me the error in this code.</p>\n"}, {"tags": ["vba", "excel", "for-loop", "charts"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1491393513, "post_id": 43228010, "comment_id": 73530820, "body": "where is your relevant code that creats the <code>Chart</code>, and the <code>SeriesCollection</code> ?"}, {"owner": {"reputation": 41, "user_id": 7801748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67952fbd023f980b39725d5e7c3fd290?s=128&d=identicon&r=PG&f=1", "display_name": "Eirik", "link": "https://stackoverflow.com/users/7801748/eirik"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491394866, "post_id": 43228010, "comment_id": 73531910, "body": "The chart has been created not using macros. I am pretty new to VBA programming, so not sure what SeriesCollection is. Sorry.  The chart I want to add the new series to is in a separate sheet called Prt"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491394981, "post_id": 43228010, "comment_id": 73531985, "body": "Maybe add a screen-shot of your existing chart, and where you want to take the data from to add more <code>Series</code> (not sur exactly where is yout <code>P(m)</code> vector ?"}, {"owner": {"reputation": 41, "user_id": 7801748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67952fbd023f980b39725d5e7c3fd290?s=128&d=identicon&r=PG&f=1", "display_name": "Eirik", "link": "https://stackoverflow.com/users/7801748/eirik"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1491401487, "post_id": 43228010, "comment_id": 73537404, "body": "Screenshots have been added. Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7801748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67952fbd023f980b39725d5e7c3fd290?s=128&d=identicon&r=PG&f=1", "display_name": "Eirik", "link": "https://stackoverflow.com/users/7801748/eirik"}, "edited": false, "score": 0, "creation_date": 1491734808, "post_id": 43252698, "comment_id": 73676410, "body": "Thank you so much! This helped a lot :)"}], "tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 0, "last_activity_date": 1491474911, "creation_date": 1491474911, "answer_id": 43252698, "question_id": 43228010, "link": "https://stackoverflow.com/questions/43228010/automated-chart-generation-vba/43252698#43252698", "title": "Automated chart generation VBA", "body": "<p>A few days ago I had the same problem. I used the code below.</p>\n\n<p>This is not a direct answer to your question but you can use it as a starting point.</p>\n\n<p>My code creates four scatter charts (InsertOptionChart is called four times), and for each scatter chart, it adds dataseries one-by one and sets their formatting (marker, line, etc.)</p>\n\n<pre><code>Option Explicit\n\nPublic Sub InsertOptionChartWrapper()\n    Dim ewsOption As Worksheet: Set ewsOption = ThisWorkbook.Worksheets(\"Option\")\n    Dim r As Long: For r = 0 To 3\n        InsertOptionChart _\n            ewsOption.Range(\"B30:S65\").Offset(37 * r, 0), _\n            ewsOption.Range(\"BD179:CC179\").Offset(25 * r, 0), _\n            ewsOption.Range(\"BD180:CC180\").Offset(25 * r, 0), _\n            ewsOption.Range(\"B182:B202\").Offset(25 * r, 0), _\n            ewsOption.Range(\"BD182:CC202\").Offset(25 * r, 0)\n    Next r\nEnd Sub\n\nPublic Sub InsertOptionChart(rngPlace As Range, rngParty As Range, rngOptionName As Range, rngRisk As Range, rngEv As Range)\n    Dim chtTarget As Chart: Set chtTarget = rngParty.Worksheet.ChartObjects.Add(rngPlace.Left, rngPlace.Top, rngPlace.Width, rngPlace.Height).Chart\n    chtTarget.ChartType = xlXYScatterSmooth\n\n    Dim c As Long: For c = 1 To rngParty.Columns.Count\n        Dim serActual As Series: Set serActual = chtTarget.SeriesCollection.NewSeries()\n        serActual.XValues = rngRisk\n        serActual.Values = rngEv.Columns(c)\n        serActual.Name = rngParty.Cells(1, c) &amp; \" \" &amp; rngOptionName.Cells(1, c)\n\n        serActual.Format.Line.Visible = msoFalse\n        serActual.Format.Line.Visible = msoTrue\n        serActual.Format.Line.Weight = 1\n\n        serActual.MarkerSize = 5\n        If rngParty.Cells(1, c).Value = \"MT\" Then\n            serActual.MarkerStyle = xlMarkerStyleCircle\n        Else\n            serActual.MarkerStyle = xlMarkerStylePlus\n        End If\n\n        Select Case Left(rngOptionName.Cells(1, c).Value, 1)\n        Case \"S\" ' Spot\n            serActual.MarkerForegroundColor = RGB(0, 0, 0)\n        Case \"A\"\n            serActual.MarkerForegroundColor = RGB(237, 169, 90)\n        Case \"B\"\n            serActual.MarkerForegroundColor = RGB(159, 76, 151)\n        Case \"C\"\n            serActual.MarkerForegroundColor = RGB(100, 185, 228)\n        Case \"D\"\n            serActual.MarkerForegroundColor = RGB(64, 143, 154)\n        Case \"N\" ' None\n            serActual.MarkerForegroundColor = RGB(226, 0, 116)\n        End Select\n\n        Select Case Right(rngOptionName.Cells(1, c).Value, 4)\n        Case \"2019\"\n            serActual.Format.Line.DashStyle = msoLineSolid\n        Case \"2020\"\n            serActual.Format.Line.DashStyle = msoLineLongDash\n        Case \"2021\"\n            serActual.Format.Line.DashStyle = msoLineDash\n        Case \"2022\"\n            serActual.Format.Line.DashStyle = msoLineSquareDot\n        Case Else\n            serActual.Format.Line.DashStyle = msoLineSolid\n        End Select\n\n        serActual.MarkerBackgroundColorIndex = 2\n        serActual.Format.Line.ForeColor.RGB = serActual.MarkerForegroundColor\n    Next c\n\n    chtTarget.Axes(xlValue).MajorGridlines.Delete\n    chtTarget.Axes(xlValue).TickLabelPosition = xlLow\n    chtTarget.Axes(xlCategory).MajorGridlines.Delete\n    chtTarget.Axes(xlCategory).TickLabelPosition = xlLow\n\n    chtTarget.Legend.Font.Size = 8\n    chtTarget.Legend.Top = 0\n    chtTarget.Legend.Height = chtTarget.Parent.Height\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7801748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67952fbd023f980b39725d5e7c3fd290?s=128&d=identicon&r=PG&f=1", "display_name": "Eirik", "link": "https://stackoverflow.com/users/7801748/eirik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491474911, "creation_date": 1491386708, "last_edit_date": 1491474511, "question_id": 43228010, "link": "https://stackoverflow.com/questions/43228010/automated-chart-generation-vba", "title": "Automated chart generation VBA", "body": "<p>I would like to automate generation new series in a chart that I have created. </p>\n\n<p>I have a vector <code>P(m)</code> that goes from <code>1</code> to <code>n_r</code>. this vector is updated in \"time steps\" in a for loop that goes from <code>1</code> to <code>Ntime</code> (<code>j</code> counter variable as shown in the code below) I would like to create new series in the same chart for every time my <code>j</code> increases, preferably a \"scatter with straight lines\" chart. </p>\n\n<pre><code>for j = 1 to Ntime    \n    for m = 1 to n_r\n        'calculating the vector P(m)    \n    next m\n\n    'code below writes vector P(m) to new columns for every new time step\n    'stating in column D    \n    For m = 1 To n_r\n        Cells(2 + m, 3 + j) = P(m)\n    Next m\nNext j\n</code></pre>\n\n<p>my P(m) vector writes to the cells shown in the figure below, writes one column to the right for every new j\n<a href=\"https://i.stack.imgur.com/20nVr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/20nVr.png\" alt=\"enter image description here\"></a></p>\n\n<p>the chart where I want to add more series is shown below:\n<a href=\"https://i.stack.imgur.com/ijReL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ijReL.png\" alt=\"enter image description here\"></a>\nAny help in the matter is greatly appreciated</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1491386372, "post_id": 43227643, "comment_id": 73525581, "body": "Your error suggests that the named range <code>Crosstab1</code> can&#39;t be found. Qualifying the sheet might help, but check the range exists first."}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1491386621, "creation_date": 1491386621, "answer_id": 43227972, "question_id": 43227643, "link": "https://stackoverflow.com/questions/43227643/duplicate-blank-column-headers-in-analysis-for-office/43227972#43227972", "title": "Duplicate blank Column Headers in analysis for Office", "body": "<p>Shouldn't this be like</p>\n\n<pre><code>With Sheets(\"Crosstab1\")\n    Set DS1_C = .Range.Columns(.Columns.Count)\nEnd With\n</code></pre>\n\n<p>Your code <code>DS1_C = Range(\"Crosstab1\").Columns.Count</code> seems to specify a range which is an object and requires the code word \"Set\". To specify a column as a range the syntax is like <code>ActiveSheet.Columns(3)</code>. In your code the column number is represented by the result of <code>Activesheet.Columns.Count</code>.</p>\n\n<p>You seem to have a similar error when specifying a rows range.</p>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1491387143, "creation_date": 1491387143, "answer_id": 43228173, "question_id": 43227643, "link": "https://stackoverflow.com/questions/43227643/duplicate-blank-column-headers-in-analysis-for-office/43228173#43228173", "title": "Duplicate blank Column Headers in analysis for Office", "body": "<p><strong>Once you're confident that the <code>Crosstab1</code> name exists:</strong></p>\n\n<p>As per my comment, try:</p>\n\n<pre><code>DS1_C = Worksheets(DS1).Range(\"Crosstab1\").Columns.Count\nDS1_R = Worksheets(DS1).Range(\"Crosstab1\").Rows.Count\n</code></pre>\n\n<p>You could also instead of referring to the DS1 variable each time, create objects to refer to with:</p>\n\n<pre><code>Dim DS1Sht As Worksheet\nDim CTab1 As Range\nSet DS1Sht = Sheets(\"Sheet1\")\nSet CTab1 = DS1Sht.Range(\"Crosstab1\")\n\nDS1_C = CTab1.Columns.Count\nDS1_R = CTab1.Rows.Count\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7819551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d96ff554c11289f0ca18f9b4ab7a3c6d?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Barrett", "link": "https://stackoverflow.com/users/7819551/thomas-barrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491387143, "creation_date": 1491385730, "last_edit_date": 1491386712, "question_id": 43227643, "link": "https://stackoverflow.com/questions/43227643/duplicate-blank-column-headers-in-analysis-for-office", "title": "Duplicate blank Column Headers in analysis for Office", "body": "<p>I have a piece of code and it is bugging out on the below line the error I am getting is </p>\n\n<blockquote>\n  <p>'Run Time error 1004' method Range object Global Failed </p>\n</blockquote>\n\n<pre><code>DS1_C = Range(\"Crosstab1\").Columns.Count\n</code></pre>\n\n<p>So what I am trying to achieve with the code is anywhere that I have blank column header take the preceding column header paste that into the blank column and add a 2 to differentiate so I can pivot easily </p>\n\n<p>My code is below any and all help is greatly appreciated </p>\n\n<p>I have also provided a picture for better understanding see pic 1 </p>\n\n<p>CODE </p>\n\n<pre><code>Sub Headers()\nDim DS1_C, DS1_R, lResult As Long\n\nDim DS1 As String\n\n\n\n\nDS1 = \"Sheet1\"\n\n\n\nlResult = Application.Run(\"SAPGetProperty\", \"IsDataSourceActive\", \"DS_1\")\n\nIf lResult = True Then\n\n   DS1_C = Range(\"Crosstab1\").Columns.Count\n\n   DS1_R = Range(\"Crosstab1\").Rows.Count\n\n\n\n   For i = 1 To DS1_C - 1\n\n       If Worksheets(DS1).Range(\"A5\").Offset(0, i + 1) = \"\" Then\n\n          Worksheets(DS1).Range(\"A5\").Offset(0, i + 1) = Worksheets(DS1).Range(\"A5\").Offset(0, i) &amp; \"2\"\n\n       End If\n\n   Next i\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Pic 1</p>\n\n<p><a href=\"https://i.stack.imgur.com/49ap6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/49ap6.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1491383838, "post_id": 43226672, "comment_id": 73523678, "body": "Can you show how you created them?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1491385516, "post_id": 43226672, "comment_id": 73524900, "body": "<code>Items.Find(&quot;[Subject] = &#39;Test&#39;&quot;)</code> or <code>Items.Restrict(&quot;[Subject] = &#39;Test&#39;&quot;)</code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1491385517, "post_id": 43226672, "comment_id": 73524901, "body": "Did you try <code>Set rdvs = ns.GetDefaultFolder(olFolderCalendar).Items.Restrict([Tag]=&#39;&zwnj;&#8203;auto-generated&#39;)</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 2867, "user_id": 3554065, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/AvgX1.png?s=128&g=1", "display_name": "Alsatian", "link": "https://stackoverflow.com/users/3554065/alsatian"}, "edited": false, "score": 0, "creation_date": 1491390263, "post_id": 43228865, "comment_id": 73528438, "body": "Something curious: it works when the property name is <b>Tag</b> but not when it is <b>tag</b>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 2867, "user_id": 3554065, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/AvgX1.png?s=128&g=1", "display_name": "Alsatian", "link": "https://stackoverflow.com/users/3554065/alsatian"}, "edited": false, "score": 1, "creation_date": 1491392319, "post_id": 43228865, "comment_id": 73529943, "body": "@Alsatian : This is most probably case sensitive. Do you create it with <code>tag</code> too?"}, {"owner": {"reputation": 2867, "user_id": 3554065, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/AvgX1.png?s=128&g=1", "display_name": "Alsatian", "link": "https://stackoverflow.com/users/3554065/alsatian"}, "edited": false, "score": 0, "creation_date": 1491393837, "post_id": 43228865, "comment_id": 73531088, "body": "yes, yes, if I set it as tag and search on tag, nothing found ... It&#39;s not a problem, I will use Tag, but it is so ..."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 2867, "user_id": 3554065, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/AvgX1.png?s=128&g=1", "display_name": "Alsatian", "link": "https://stackoverflow.com/users/3554065/alsatian"}, "edited": false, "score": 1, "creation_date": 1491395681, "post_id": 43228865, "comment_id": 73532510, "body": "@Alsatian : Awkward indeed... :/"}, {"owner": {"reputation": 2867, "user_id": 3554065, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/AvgX1.png?s=128&g=1", "display_name": "Alsatian", "link": "https://stackoverflow.com/users/3554065/alsatian"}, "edited": false, "score": 1, "creation_date": 1491396178, "post_id": 43228865, "comment_id": 73532924, "body": "That&#39;s why I didn&#39;t found it alone ^^"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1491388980, "creation_date": 1491388980, "answer_id": 43228865, "question_id": 43226672, "link": "https://stackoverflow.com/questions/43226672/how-to-tag-a-macro-created-item-to-find-it-later/43228865#43228865", "title": "How to tag a macro created item to find it later?", "body": "<p>You'll need to use <code>Restrict</code> method to get only the items that you tagged :</p>\n\n<pre><code>Set rdvs = ns.GetDefaultFolder(olFolderCalendar).Items.Restrict([Tag]='\u200c\u200bauto-generated')\n</code></pre>\n"}], "owner": {"reputation": 2867, "user_id": 3554065, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/AvgX1.png?s=128&g=1", "display_name": "Alsatian", "link": "https://stackoverflow.com/users/3554065/alsatian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 43228865, "answer_count": 1, "score": 1, "last_activity_date": 1593413663, "creation_date": 1491383279, "last_edit_date": 1593413663, "question_id": 43226672, "link": "https://stackoverflow.com/questions/43226672/how-to-tag-a-macro-created-item-to-find-it-later", "title": "How to tag a macro created item to find it later?", "body": "<p>In MS <a href=\"/questions/tagged/outlook\" class=\"post-tag\" title=\"show questions tagged &#39;outlook&#39;\" rel=\"tag\">outlook</a>, I create some mails or appointments with VBA.</p>\n\n<p>I want to mark them with some kind of tag, to retrieve them later.</p>\n\n<p>I tried it using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff864785.aspx\" rel=\"nofollow noreferrer\">ItemProperties</a> property, but I don't know how to use it by <code>find</code> or <code>restrict</code> :</p>\n\n<pre><code>    Set ns = GetNamespace(\"MAPI\")\n    Set rdvs = ns.GetDefaultFolder(olFolderCalendar).Items.Find(\"[ItemProperties('Tag')] = 'auto-generated'\")\n</code></pre>\n\n<p>How I create an appointment (from MS Excel) :</p>\n\n<pre><code>Sub createAppointment()\n\n    Dim apptm As Outlook.AppointmentItem\n\n    Set apptm = Outlook.Application.CreateItem(olAppointmentItem)\n    apptm.Subject = \"Test\"\n    apptm.Start = Now\n    apptm.Duration = 60\n\n    apptm.ItemProperties.Add \"Tag\", Outlook.olText\n    apptm.ItemProperties.Item(\"Tag\").Value = \"auto-generated\"\n\n    apptm.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1491383541, "post_id": 43226621, "comment_id": 73523451, "body": "Your code is copying entire rows - do you actually use all 16384 columns?"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491383786, "post_id": 43226621, "comment_id": 73523635, "body": "yowE3K is right try selecting only the used column instead of the entire row"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1491383917, "post_id": 43226621, "comment_id": 73523710, "body": "This command <code>Sheet2.Range(&quot;A1:GZ16000&quot;).Value = Sheet1.Range(&quot;A1:GZ16000&quot;).Value</code> will copy 33,280,000 cell values in about 3-4 seconds. So try and work with explicit ranges and not entire rows."}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491384047, "post_id": 43226621, "comment_id": 73523806, "body": "similar to getting row numbers get column numbers once....and use range(cells(),cells()) method to copy the values. you dont need to get the column number everytime if you have the same number of column."}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1491469313, "last_edit_date": 1491469313, "creation_date": 1491385894, "answer_id": 43227703, "question_id": 43226621, "link": "https://stackoverflow.com/questions/43226621/different-ways-of-copypaste-rows/43227703#43227703", "title": "Different ways of copy&amp;paste rows", "body": "<p>Your coding is a horror (@Sivaprasath was more polite, but I try to be more helpful :-)). Make it look like this.</p>\n\n<pre><code>DataCell.Range(Cells(R, C), Cells(R, C)).Value = Cellsheet.Range(Cells(R, C), Cells(R, C)).Value\n</code></pre>\n\n<p>Here R stands for a \"Row\" and C for \"Column\". Each can be a number or a variable presenting a number. A range like <code>Range(\"A1:B4\")</code> would be written like <code>Range(Cells(1, 1), Cells(4, 2))</code> which looks an awful lot of effort in direct comparison but it is more readable than <code>Range((f + 1) &amp; \":\" &amp; (f + f2))</code> and it is really easy to manipulate, once you get the hang of it. To speed up your task it is vital that you have exact control over your range specifications and that will elude you while you have no clear syntax.</p>\n\n<p>I ran this test in response to your comment.</p>\n\n<pre><code>Private Sub CopyAndPaste()\n\n    Dim Rng As Range\n    Dim f As Long, f2 As Long\n    Dim C As Long\n\n    f = 4\n    f2 = 2046\n    C = 185\n\n'    Set Rng = Cellsheet.Range(Cells(2, 1), Cells(f2, C))\n    Set Rng = ActiveSheet.Range(Cells(2, 1), Cells(f2, C))\n    Debug.Print Rng.Address, Rng.Cells.Count\n\n'    Set Rng = DataCell.Range(Cells((f + 1), 1), Cells(f + f2, C))\n    Set Rng = ActiveSheet.Range(Cells((f + 1), 1), Cells(f + f2, C))\n    Debug.Print Rng.Address, Rng.Cells.Count\nEnd Sub\n</code></pre>\n\n<p>The result is printed to the Immediate window and shows that the number of cells in the two ranges isn't the same. Therefore the two ranges can't be of the same size and dimension, and therefore you should get an error in the past operation. I suggest you invest a little bit more time in controlling your variables. However, using the Destination to copy to it is sufficient to specify a single cell (top left) and Excel will paste the entire copied range correctly in relation to the specified cell.</p>\n"}], "owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491469313, "creation_date": 1491383158, "question_id": 43226621, "link": "https://stackoverflow.com/questions/43226621/different-ways-of-copypaste-rows", "title": "Different ways of copy&amp;paste rows", "body": "<p>I am trying to speed up a VBA programm which basically copy rows of data from a couple of workbooks into 3 main workbooks and refresh all the graphics in them.</p>\n\n<p>I have already use this, which I mainly do in all my programms.</p>\n\n<pre><code>'Speed up\nWith Excel.Application\n    .ScreenUpdating = False\n    .DisplayStatusBar = True\n    .Calculation = Excel.xlCalculationManual\n    .EnableEvents = False\nEnd With\n</code></pre>\n\n<p>Debugging my code I realised the copy&amp;paste part is taking more time than the rest and I am trying to recode It and test so I can reach the fastest solution. Initially it was like this across 3 differen Subs. I post one because all the others are the mainly de same.</p>\n\n<pre><code>Cellsheet.Range(\"2:\" &amp; f2).Copy DataCell.Range((f + 1) &amp; \":\" &amp; (f + f2))\nDataCluster.Rows((f3 + 1) &amp; \":\" &amp; (f3 + f4 - 1)).Hidden = False\nClustersheet.Range(\"2:\" &amp; f4).Copy DataCluster.Range((f3 + 1) &amp; \":\" &amp; (f3 + f4 - 1))\n</code></pre>\n\n<p>I am trying to avoid using the clipboard which I know It would be the slowest solution. Now, Im trying the .Value = .Value approach like this:</p>\n\n<pre><code>DataCell.Range((f + 1) &amp; \":\" &amp; (f + f2)).Value = Cellsheet.Range(\"2:\" &amp; f2).Value\nDataCluster.Range((f3 + 1) &amp; \":\" &amp; (f3 + f4 - 1)).Value = Clustersheet.Range(\"2:\" &amp; f4).Value\n</code></pre>\n\n<p><em>In this example I'm trying to copy 2.000 rows more or less when the error appears.</em></p>\n\n<p>The problem is with this approach the programm more or less in the middle of the execution shows the \"Insufficient memory error\" and I would like to know why this happens and If there is a faster solution than the .Copy Destination. thing.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user180100"}, "edited": false, "score": 3, "creation_date": 1491381010, "post_id": 43225840, "comment_id": 73521720, "body": "<code>counter = counter1 + 1</code> should <b>maybe</b> be <code>counter1 = counter1 + 1</code> (etc)"}, {"owner": {"reputation": 93, "user_id": 7286656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0975bd5f33d7a8da63bf27e0fb62764?s=128&d=identicon&r=PG&f=1", "display_name": "leon Hill", "link": "https://stackoverflow.com/users/7286656/leon-hill"}, "edited": false, "score": 0, "creation_date": 1491381309, "post_id": 43225840, "comment_id": 73521931, "body": "@RC. no the counter is working for me when i am trying one if, its when i bring in the other ifs that my counter goes wrong"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1491383116, "post_id": 43225840, "comment_id": 73523172, "body": "Re your comment (to an answer) &quot;I a still having a problem with the counter but not sure what it is. Ill see if i can solve it&quot; - see the comment by @RC."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 7286656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0975bd5f33d7a8da63bf27e0fb62764?s=128&d=identicon&r=PG&f=1", "display_name": "leon Hill", "link": "https://stackoverflow.com/users/7286656/leon-hill"}, "edited": false, "score": 0, "creation_date": 1491382578, "post_id": 43226123, "comment_id": 73522782, "body": "Hey thank you so much for your in-depth answer, i have a much better understanding of it now once reading it. I a still having a problem with the counter but not sure what it is. Ill see if i can solve it"}, {"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "reply_to_user": {"reputation": 93, "user_id": 7286656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0975bd5f33d7a8da63bf27e0fb62764?s=128&d=identicon&r=PG&f=1", "display_name": "leon Hill", "link": "https://stackoverflow.com/users/7286656/leon-hill"}, "edited": false, "score": 0, "creation_date": 1491382916, "post_id": 43226123, "comment_id": 73523040, "body": "@leonHill I think your problem might be that counter1, counter2 and counter3 are never set to anything. Are you getting any more errors?"}, {"owner": {"reputation": 93, "user_id": 7286656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0975bd5f33d7a8da63bf27e0fb62764?s=128&d=identicon&r=PG&f=1", "display_name": "leon Hill", "link": "https://stackoverflow.com/users/7286656/leon-hill"}, "edited": false, "score": 0, "creation_date": 1491383198, "post_id": 43226123, "comment_id": 73523232, "body": "@steveES yeah your right man i forgot to set the counter for 1,2 and 3. I set one half but forgot to do the other half. One last question say if i want the values of the counter to be displayed in a cell instead of in a message box any idea how i would do that ??"}, {"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1491383200, "post_id": 43226123, "comment_id": 73523234, "body": "Thanks @YowE3K, I&#39;ve added it in :)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 93, "user_id": 7286656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0975bd5f33d7a8da63bf27e0fb62764?s=128&d=identicon&r=PG&f=1", "display_name": "leon Hill", "link": "https://stackoverflow.com/users/7286656/leon-hill"}, "edited": false, "score": 2, "creation_date": 1491383241, "post_id": 43226123, "comment_id": 73523266, "body": "@leonHill - you should really ask further questions in a new question."}, {"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "reply_to_user": {"reputation": 93, "user_id": 7286656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0975bd5f33d7a8da63bf27e0fb62764?s=128&d=identicon&r=PG&f=1", "display_name": "leon Hill", "link": "https://stackoverflow.com/users/7286656/leon-hill"}, "edited": false, "score": 0, "creation_date": 1491383455, "post_id": 43226123, "comment_id": 73523395, "body": "@leonHill - That is something you should easily be able to find through a web search :)"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491383943, "post_id": 43226123, "comment_id": 73523734, "body": "@SteveES You might want to convert your answer into an article for the documentation site of SO: <a href=\"http://stackoverflow.com/documentation/excel-vba/topics\">stackoverflow.com/documentation/excel-vba/topics</a>"}, {"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491384267, "post_id": 43226123, "comment_id": 73523952, "body": "@Ralph Good idea, do you think it would go in getting started, or require a new topic?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1491386199, "post_id": 43226123, "comment_id": 73525454, "body": "@SteveES I am not even sure they will accept it as an article. But I&#39;d give it a try. Don&#39;t worry. These guys are pretty straight forward and will let you know soon enough if they like it (up-votes) or not (down-votes) and how they think you should revise it (comments) or even expand upon it."}], "tags": [], "owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "is_accepted": true, "score": 5, "last_activity_date": 1491383533, "last_edit_date": 1491383533, "creation_date": 1491381677, "answer_id": 43226123, "question_id": 43225840, "link": "https://stackoverflow.com/questions/43225840/multiple-if-statements-in-a-loop-vba/43226123#43226123", "title": "Multiple if statements in a loop vba", "body": "<p>In VBA there are several ways to write an <code>If</code> statement:</p>\n\n<pre><code>If [some condition] Then [Do something]\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>If [some condition] Then [Do something] Else [Do something else]\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>If [some condition] Then\n   [Do something]\nEnd If\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>If [some condition] Then\n   [Do something]\nElse\n   [Do something else]\nEnd If\n</code></pre>\n\n<p>Or, finally</p>\n\n<pre><code>If [some condition] Then\n   [Do something]\nElseIf [some other condition] Then\n   [Do something different]\nElse\n   [Do something else]\nEnd If\n</code></pre>\n\n<p>In your code your <code>If</code> statements are all on one line and therefore don't need a corresponding <code>End If</code>, but also can't take a corresponding <code>Else</code> statement on a following line. If you want to use an <code>Else</code> or an <code>ElseIf</code>, you must use the final <code>If</code> statement block pattern and close the <code>If</code> block with a corresponding <code>EndIf</code>.</p>\n\n<p>In your case, as you are always testing the same thing (<code>classyear(ActiveCell.Value)</code>), I would advise taking advantage of the <code>Select Case</code> construction, which will shorten your code.</p>\n\n<pre><code>Select Case classyear(ActiveCell.Value)\nCase 0\n   counter = counter + 1   ' classyear is a function i am calling from above\n\nCase 1\n   counter = counter1 + 1\n\nCase 2\n   counter = counter2 + 1\n\nCase 3\n   counter = counter3 + 1\n\nCase Else\n   'Oops, this shouldn't happen, but handle the error anyway\n\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 7286656, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b0975bd5f33d7a8da63bf27e0fb62764?s=128&d=identicon&r=PG&f=1", "display_name": "leon Hill", "link": "https://stackoverflow.com/users/7286656/leon-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9784, "favorite_count": 1, "accepted_answer_id": 43226123, "answer_count": 1, "score": 0, "last_activity_date": 1491383533, "creation_date": 1491380867, "last_edit_date": 1531164843, "question_id": 43225840, "link": "https://stackoverflow.com/questions/43225840/multiple-if-statements-in-a-loop-vba", "title": "Multiple if statements in a loop vba", "body": "<p>I am trying to run a simple if statement but can not get it to run for me without getting an error. Basically, I am trying to have multiple if statements within a loop, im guessing i have a minor error but cannot spot it, maybe with the else statements. Any help is appreciated </p>\n\n<pre><code>Sub ex13()\n\nDim rgtimetable As Range, rgR As Range, counter As Integer\nDim counter1 As Integer, counter2 As Integer, counter3 As Integer\n\nSet rgtimetable = Range(\"timetable\")\nFor Each rgR In rgtimetable\n    rgR.Activate\n    If classyear(ActiveCell.Value) = 0 Then counter = counter + 1   ' classyear is a function i am calling from above\n\n    Else\n    If classyear(ActiveCell.Value) = 1 Then counter = counter1 + 1\n\n    Else\n    If classyear(ActiveCell.Value) = 2 Then counter = counter2 + 1\n\n    Else\n    If classyear(ActiveCell.Value) = 3 Then counter = counter3 + 1\n\nNext rgR\n\nMsgBox counter\nMsgBox counter1\nMsgBox counter2\nMsgBox counter3\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1491380101, "post_id": 43225507, "comment_id": 73521055, "body": "vlookup is the tool that you need.  A vba approach will be more complicated than this"}, {"owner": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1491380150, "post_id": 43225507, "comment_id": 73521102, "body": "yes but i need to do it with vba,thus the struggle"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1491380359, "post_id": 43225507, "comment_id": 73521246, "body": "why do you have to do it with vba?  the most simple way to do this in vba would be harder, more work intensive, and probably use a lookup anyway"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1491380463, "post_id": 43225507, "comment_id": 73521302, "body": "here&#39;s a tutorial if you&#39;re really set on this: <a href=\"http://www.cpearson.com/excel/TablesAndLookups.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/TablesAndLookups.aspx</a>"}, {"owner": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1491380783, "post_id": 43225507, "comment_id": 73521530, "body": "Haha, thanks but its for work.. and i intend to use .Find not vlookup"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 2, "creation_date": 1491380868, "post_id": 43225507, "comment_id": 73521591, "body": "just out of interest, what do you mean it&#39;s for work?  do your work not like vlookups?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1491381617, "post_id": 43225507, "comment_id": 73522131, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/43221414/vlookup-to-compare-data-in-2-different-workbooks-with-vba\">VLOOKUP to compare data in 2 different workbooks with VBA</a> - that question is almost identical to this one, and includes a VBA solution which is said to have &quot;work perfectly&quot;."}, {"owner": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "edited": false, "score": 0, "creation_date": 1491382264, "post_id": 43225507, "comment_id": 73522560, "body": "yes that is it , but now i jut want to use .find...."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1491382482, "post_id": 43225507, "comment_id": 73522708, "body": "You can use <code>COUNTIF</code> or <code>MATCH</code> functions if you don&#39;t like <code>VLOOKUP</code>. If you know nothing about VBA, this is going to be very hard for you to do. And don&#39;t expect us to do it for you, though we will gladly help if you try and get stuck. Just post the code you have tried in the question."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 2, "creation_date": 1491382638, "post_id": 43225507, "comment_id": 73522830, "body": "So apparently someone already did your job for you in another question of yours: <a href=\"https://stackoverflow.com/questions/43221414/vlookup-to-compare-data-in-2-different-workbooks-with-vba\" title=\"vlookup to compare data in 2 different workbooks with vba\">stackoverflow.com/questions/43221414/&hellip;</a> Is this some kind of entry-exam or what?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1491383884, "post_id": 43225507, "comment_id": 73523695, "body": "If your employer won&#39;t let you use a <code>VLOOKUP</code>, they will take a very dim view of using a macro (whether it uses a <code>Find</code> statement or not).  Employers would rather have solutions that do not require as much specialist knowledge to maintain, and <code>VLOOKUP</code> is built-in to Excel itself so they have already paid for it."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1491424516, "post_id": 43226968, "comment_id": 73552388, "body": "Please try running your code, then correct the errors, e.g. the references to column RC instead of B, and C instead of D (both due to using R1C1 notation in an A1 notation formula), and returning #N/A and #VALUE! errors (both due to assuming that <code>VLOOKUP</code> will return a <code>TRUE</code> or <code>FALSE</code> result)."}], "tags": [], "owner": {"reputation": 396, "user_id": 7796810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f8b5deb296124be4aa1e86d92250d66?s=128&d=identicon&r=PG&f=1", "display_name": "Digvijay", "link": "https://stackoverflow.com/users/7796810/digvijay"}, "is_accepted": false, "score": 1, "last_activity_date": 1491384085, "creation_date": 1491384085, "answer_id": 43226968, "question_id": 43225507, "link": "https://stackoverflow.com/questions/43225507/using-match-funtion-for-2-different-workbooks/43226968#43226968", "title": "using match funtion for 2 different workbooks", "body": "<p>To run this code you should be on your your first workbook and second work-book should be open in background, I find this as an easier method than to call workbook using it's address, you may change that if you like</p>\n\n<pre><code>Sub vl()\nDim lastrow As Long   \n\nSheets(\"Items\").Select    \nlastrow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n\n\nRange(\"C2:C\" &amp; lastrow).Formula = \"=IF(VLOOKUP(RC2,[Book2]Data!C4,1,FALSE),  \"\"OK\"\",\"\"\"\")\"\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Here I assumed that <em>Name of your second book</em> is <strong>Book2</strong>.\nChange it to whatever it is in the code.\nHope this helps :) </p>\n"}], "owner": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1491441014, "creation_date": 1491379995, "last_edit_date": 1491441014, "question_id": 43225507, "link": "https://stackoverflow.com/questions/43225507/using-match-funtion-for-2-different-workbooks", "title": "using match funtion for 2 different workbooks", "body": "<p>i have been assigned to use the .match function in vba, to compare 2 different columns in 2 different workbooks.</p>\n\n<p>here is my code so far.. how do i use the match function to my goal ?</p>\n\n<pre><code>    Sub Ob_match()\n    Dim swb As Workbook, dwb As Workbook\n    Dim sws As Worksheet, dws As Worksheet\n    Dim oCell As Range, oMatch As Range\n\n\n\nSet swb = ActiveWorkbook\nSet sws = swb.Sheets(\"Item\")\n\nSet dwb = Workbooks.Open(swb.Path &amp; \"\\EPC_EndItem.xlsm\", ReadOnly:=True)\nSet dws = dwb.Sheets(\"Data\")\n\n\n    If Not oMatch Is Nothing Then\n        oCell.Offset(0, 1) = \"Y\"\n    Else\n        oCell.Offset(0, 1) = \"\"\n    End If\nNext oCell\nMsgBox \"Processing completed\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "cad", "nano"], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 6057392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eW5XF.jpg?s=128&g=1", "display_name": "Satheesh K", "link": "https://stackoverflow.com/users/6057392/satheesh-k"}, "edited": false, "score": 0, "creation_date": 1491594616, "post_id": 43245397, "comment_id": 73640258, "body": "Works like a charm! Thank you so much vlalexey! I need to explore many of the commands I need!"}, {"owner": {"reputation": 118, "user_id": 6057392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eW5XF.jpg?s=128&g=1", "display_name": "Satheesh K", "link": "https://stackoverflow.com/users/6057392/satheesh-k"}, "edited": false, "score": 0, "creation_date": 1491597383, "post_id": 43245397, "comment_id": 73641583, "body": "Can you recommend a book or a website to get to know the VBA commands for NanoCAD?"}], "tags": [], "owner": {"reputation": 46, "user_id": 2949311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/553e8f85ea13d1b4c3863a3448bc81c7?s=128&d=identicon&r=PG", "display_name": "vlalexey", "link": "https://stackoverflow.com/users/2949311/vlalexey"}, "is_accepted": true, "score": 0, "last_activity_date": 1491450708, "creation_date": 1491450708, "answer_id": 43245397, "question_id": 43225200, "link": "https://stackoverflow.com/questions/43225200/excel-vba-to-open-nanocad-application/43245397#43245397", "title": "excel VBA to open NanoCAD application", "body": "<p>You have to use such code:</p>\n\n<pre><code>Dim app As nanoCAD.Application\nSet app = GetObject(\"\", \"nanoCAD.Application\")\n</code></pre>\n\n<p>Also don't forget to include nanoCAD type lib (NCAuto.dll) into your project (menu Tools - Reference..)</p>\n"}], "owner": {"reputation": 118, "user_id": 6057392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eW5XF.jpg?s=128&g=1", "display_name": "Satheesh K", "link": "https://stackoverflow.com/users/6057392/satheesh-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 43245397, "answer_count": 1, "score": 0, "last_activity_date": 1491450708, "creation_date": 1491379016, "question_id": 43225200, "link": "https://stackoverflow.com/questions/43225200/excel-vba-to-open-nanocad-application", "title": "excel VBA to open NanoCAD application", "body": "<p>I wanted to try out automating multiple drawings generation in NanoCAD. there are many sources to help with AutoCAD, but not much with NanoCAD. \nfor Example, can some one give me a equivalent code for below (which we can use to open Autocad) to open NanoCAD ? </p>\n\n<p>I have the references to the NanoCAD commands done properly. like we do for Autocad. </p>\n\n<pre><code>Sub opencad()\n    Dim ACAD As AcadApplication 'Create ACAD variable of type AcadApplication\n    On Error Resume Next \n    Set ACAD = GetObject(, \"AutoCAD.Application\") \n    On Error GoTo 0 \n    If ACAD Is Nothing Then \n        Set ACAD = New AcadApplication \n        ACAD.Visible = True \n    End If\n    ACAD.ActiveDocument.Utility.Prompt \"ZOOM ALL \" \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "word-field"], "answers": [{"comments": [{"owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1491437474, "post_id": 43226055, "comment_id": 73557167, "body": "Oh wow, Object Browser is amazing.  I&#39;d mark your answer as the answer, but I have a couple of remaining unanswered questions: &quot;can a formfield&#39;s range ever contain more then one &quot;general&quot; field?&quot;  and  &quot;Will changing these away from FORMTEXT have any unintended side effects, or are these basically nice and friendly linking id&#39;s / display values allowing you to view them and swap between them with ease?&quot;"}, {"owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1491551455, "post_id": 43226055, "comment_id": 73613245, "body": "When I used alt+f9 to see the fieldcodes, FORMTEXT appeared. I tried editing these just to see what happens but they get replaced by INVALID bookmark.  I&#39;m not really sure what the text FORMTEXT is supposed to represent in the fieldcode still. But I&#39;ve accepted your answer due to effort + good faith."}, {"owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1491551501, "post_id": 43226055, "comment_id": 73613270, "body": "To Clarify, place a legacy (formfield) field in a document, press alt+f9 , you see FORMTEXT appear in brackets."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1491552259, "post_id": 43226055, "comment_id": 73613720, "body": "@RyanTheLeach : I don&#39;t which version you are using but <code>FORMTEXT</code> doesn&#39;t seems to be a field since at least 2010... So yeah, really legacy!^^ Check lists of <code>Fields</code> in tag info of <a href=\"https://stackoverflow.com/questions/tagged/word-field\">word-field</a>. And my FormFields don&#39;t toggle into Field code like regular ones, even with Alt+F9"}, {"owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "edited": false, "score": 0, "creation_date": 1491784883, "post_id": 43226055, "comment_id": 73691751, "body": "Strange. Thanks for the help, it&#39;s really appreciated."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1491551183, "last_edit_date": 1495535452, "creation_date": 1491381463, "answer_id": 43226055, "question_id": 43225155, "link": "https://stackoverflow.com/questions/43225155/what-is-the-difference-between-fields-and-formfields/43226055#43226055", "title": "What is the difference between fields and formfields?", "body": "<p>Fields are general objects, they can be :</p>\n\n<ul>\n<li>document's properties (built-in or custom), </li>\n<li>mailing / mergemail,</li>\n<li>calculation, </li>\n<li>form fields, </li>\n<li>... </li>\n</ul>\n\n<p>A form fields is an field for inputs.</p>\n\n<p>Take a look at the links in the tag info of <a href=\"/questions/tagged/word-field\" class=\"post-tag\" title=\"show questions tagged &#39;word-field&#39;\" rel=\"tag\">word-field</a>, there is a lot of interesting things!</p>\n\n<p>And you can access them by their own collections (press F2 in VBE to use Object Browser).</p>\n\n<p>For Fields the general collection is in <code>Application.ActiveDocument.Fields</code>, <br>\nbut you can find them in a lot of objects (check with Object Browser!).<br>\nTake a look at <a href=\"https://stackoverflow.com/q/30958172/4628637\">that answer</a> to have an idea of the other objects in which you can find it! ;)</p>\n\n<hr>\n\n<p>To my knowledge, there is no possibility nest something inside a <code>FormField</code>, <br> like you can do in a <code>Field</code>.</p>\n\n<p>I'm not sure to understand that question :</p>\n\n<pre><code>\"Will changing these away from FORMTEXT have any unintended side effects, \nor are these basically nice and friendly linking id's / display values\nallowing you to view them and swap between them with ease?\"\n</code></pre>\n\n<p>If you want to create a Form that users can fill, you'll need to stick with <code>FormFields</code>.</p>\n\n<p>If you want to display values at specific places in a document, <code>Fields</code> is the way to go.<br>\nI'd even suggest Custom Document Properties for a general use, and MergeMail for Mailings. ;)</p>\n"}], "owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 43226055, "answer_count": 1, "score": 1, "last_activity_date": 1491551183, "creation_date": 1491378897, "last_edit_date": 1491381483, "question_id": 43225155, "link": "https://stackoverflow.com/questions/43225155/what-is-the-difference-between-fields-and-formfields", "title": "What is the difference between fields and formfields?", "body": "<p>in word pressing alt+F9 can display \"FieldCodes\"\n<a href=\"https://i.stack.imgur.com/7zKSA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7zKSA.png\" alt=\"enter image description here\"></a></p>\n\n<p>How can  I access this programmatically using vba and pair them with the formfields?</p>\n\n<p>You can access the field code by ? Application.ActiveDocument.Fields(1).Code</p>\n\n<p>And you can access the form fields by Application.ActiveDocument.FormFields(1)</p>\n\n<p>But is there any guarantee's about the indices matching?\nCan a formfield ever not be a Field? can a Field ever not be a formfield?</p>\n\n<p>Will changing these away from FORMTEXT have any unintended side effects, or are these basically nice and friendly linking id's / display values allowing you to view them and swap between them with ease?</p>\n\n<p>Edit: I've come up with the following to get the fields Code. I'm still unsure if it's a good idea to edit them or not, or what they represent.</p>\n\n<pre><code>    Application.ActiveDocument.FormFields(1).Range.Fields(1).Code\n</code></pre>\n"}, {"tags": ["excel", "vba", "db2"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1491378881, "post_id": 43225078, "comment_id": 73520249, "body": "are you using that exact connection string?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1491379046, "post_id": 43225078, "comment_id": 73520362, "body": "well, in summary, the error message tells you that you need to check your data source name (as it hasn&#39;t been found) and specify the default driver.  You will also need to add your username and password in the relevant places, and an sql query"}, {"owner": {"reputation": 10375, "user_id": 154726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d8be3efd353f127c356698ff9e2d33?s=128&d=identicon&r=PG", "display_name": "Ian Bjorhovde", "link": "https://stackoverflow.com/users/154726/ian-bjorhovde"}, "edited": false, "score": 0, "creation_date": 1491430893, "post_id": 43225078, "comment_id": 73555339, "body": "Shouldn&#39;t the provider be <code>IBMDADB2</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 834, "user_id": 7959837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u9C9j.jpg?s=128&g=1", "display_name": "Suliman Farzat", "link": "https://stackoverflow.com/users/7959837/suliman-farzat"}, "is_accepted": false, "score": 0, "last_activity_date": 1528266153, "last_edit_date": 1528266153, "creation_date": 1528265839, "answer_id": 50713338, "question_id": 43225078, "link": "https://stackoverflow.com/questions/43225078/db2-database-open-with-excel-macro/50713338#50713338", "title": "DB2 database open with Excel Macro", "body": "<p><strong>you can use this code:</strong></p>\n\n<pre><code>Sub DB2connect()\n\n  'Create the Connection String with Provider and Data Source options\n\n   dim sSQLQry As String\n   dim ReturnArray\n\n   dim conn As New ADODB.Connection\n   dim mrs As New ADODB.Recordset\n   dim DBPath As String, sconnect As String\n\n   Set wb = ThisWorkbook\n   Set ws = wb.Sheets(1)\n\n    ws.Activate\n\n    DBPath = ThisWorkbook.FullName 'Refering the sameworkbook as Data Source\n\n    sconnect = \"Provider=MSDASQL.1;DSN=MyODBC connection name;UID=myuid;PWD=myPass;DBQ=myDatabase\" &amp; DBPath &amp; \";HDR=Yes';\"\n\n    conn.ConnectionTimeout = 30\n    conn.Open sconnect\n\n    sSQLSting = \" select * from table where ....\"\n\n    mrs.Open sSQLSting, conn\n\n    'Import Headers\n    For i = 0 To mrs.Fields.Count - 1\n       ws.Range(\"B15\").Offset(0, i) = mrs.Fields(i).Name\n    Next i\n\n    Range(\"B15\").Offset(1, 0).CopyFromRecordset mrs\n\n    mrs.Close\n    conn.Close\n    Set mrs = Nothing\n    Set conn = Nothing\n\n\n\nEnd Sub\n</code></pre>\n\n<p><strong><a href=\"https://github.com/sulimanfarzat/Excal_vba/blob/master/SQLDatabase_VBA.bas\" rel=\"nofollow noreferrer\">hier is the code in Github</a></strong></p>\n"}], "owner": {"reputation": 568, "user_id": 5964111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JMst9.jpg?s=128&g=1", "display_name": "tmsbrndz", "link": "https://stackoverflow.com/users/5964111/tmsbrndz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 876, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528266153, "creation_date": 1491378707, "question_id": 43225078, "link": "https://stackoverflow.com/questions/43225078/db2-database-open-with-excel-macro", "title": "DB2 database open with Excel Macro", "body": "<p>I want to open Db2 database with Excel macro and fill datas into sheet.</p>\n\n<pre><code>Sub db()\nDim conn As Object\nDim rs As Object\nDim sqls As String\nSet conn = CreateObject(\"ADODB.Connection\")\nconn.Open \"Provider=MSDASQL;Database=SAMPLE;Hostname=localhost;             \nProtocol=TCPIP;Port=50000;Uid=myuid;Pwd=mypw;\"\nSet rs = CreateObject(\"ADODB.Recordset\")\nrs.Open sqls, conn\nSheets(\"Sheet1\").Range(\"A1\").CopyFromRecordset rs\nrs.Close\nEnd Sub\n</code></pre>\n\n<p>but i got the following error</p>\n\n<p><a href=\"https://i.stack.imgur.com/vIHxK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vIHxK.png\" alt=\"\"></a></p>\n\n<p>I want to open sample table which was created in db2. \nWhat i should do? thx</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1491377816, "post_id": 43224714, "comment_id": 73519601, "body": "start substituting <code>rows = bereich.Rows.Count</code> with <code>rows = bereich.UsedRange.Rows.Count</code> and process only <i>used</i> rows instead of <i>all</i> rows (i.e. some 1 million). BTW: I assume <code>bereich</code> is referring to some sheet object"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1491378247, "post_id": 43224714, "comment_id": 73519888, "body": "Could you also add <code>Application.Calculation = xlCalculationManual</code> and  <code>Application.Calculation = xlCalculationAutomatic</code> to your code (initial and final respectively)? If your workbook has some calculation to do, this will improve the performance of your routine..."}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491378486, "post_id": 43224714, "comment_id": 73520025, "body": "i dont think you need to create variables for everything...you can reference the cell value as cell(i,j).value. you can use it when set once...but when its reassigned regularly in the execution then better to reference it as such instead setting a varaible every time"}, {"owner": {"reputation": 1, "user_id": 7818788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495e004cca48492e39c242573183e8b0?s=128&d=identicon&r=PG", "display_name": "MorphhproM", "link": "https://stackoverflow.com/users/7818788/morphhprom"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1491379670, "post_id": 43224714, "comment_id": 73520784, "body": "Thanks a lot so far. @user3598756 you are right bereich should be <code>area</code>."}, {"owner": {"reputation": 1, "user_id": 7818788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495e004cca48492e39c242573183e8b0?s=128&d=identicon&r=PG", "display_name": "MorphhproM", "link": "https://stackoverflow.com/users/7818788/morphhprom"}, "reply_to_user": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1491380145, "post_id": 43224714, "comment_id": 73521093, "body": "<code>rows = bereich.UsedRange.Rows.Count</code> doesn&#39;t work, since <code>area = ActiveSheet.UsedRange</code> already. @Pspl There are no calculations in this file @SivaprasathV I removed &quot;celltext&quot; but the performance is still horrible"}, {"owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "edited": false, "score": 0, "creation_date": 1491420974, "post_id": 43224714, "comment_id": 73550397, "body": "If <code>input</code> is not found in column A and B then delete row?                            is this what you want?"}], "answers": [{"tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 0, "last_activity_date": 1491382025, "creation_date": 1491382025, "answer_id": 43226235, "question_id": 43224714, "link": "https://stackoverflow.com/questions/43224714/delete-special-rows-in-every-sheet-via-vba/43226235#43226235", "title": "Delete special rows in every sheet via VBA", "body": "<p>Could you try something simpler like:</p>\n\n<pre><code>Dim wksSheet As Worksheet, i As Integer, j As Integer\nDim lastrow As Long\nDim Var As String\nVar = InputBox(\"Input\", \"Input\")\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n'Loop over every Worksheet in this Workbook\nFor Each wksSheet In ThisWorkbook.Worksheets\n    With wksSheet\n        lastrow = 0\n        On Error Resume Next\n        lastrow = .Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\n        If lastrow &gt; 0 And Var &lt;&gt; \"\" Then\n            For i = lastrow To 2 Step -1\n                If InStr(.Cells(i, 1).Text, Var) &gt; 0 Or InStr(.Cells(i, 2).Text, Var) &gt; 0 Then\n                    .rows(i).Delete\n                End If\n            Next i\n        End If\n    End With\nNext\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 434, "user_id": 7238313, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5be671c0eceb0d44305cdf1d4ffc2084?s=128&d=identicon&r=PG&f=1", "display_name": "MTBthePRO", "link": "https://stackoverflow.com/users/7238313/mtbthepro"}, "is_accepted": false, "score": 0, "last_activity_date": 1491423420, "creation_date": 1491423420, "answer_id": 43240849, "question_id": 43224714, "link": "https://stackoverflow.com/questions/43224714/delete-special-rows-in-every-sheet-via-vba/43240849#43240849", "title": "Delete special rows in every sheet via VBA", "body": "<p>You can try this, I believe this should work for you. It has not been tested yet.</p>\n\n<pre><code>Sub dontDeleteRowWithInput()\n         Dim sht As Worksheet\n         Dim nlast As Long\n         For Each sht In Sheets\n\n\n                nlast = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n                For n = nlast To 1 Step -1\n                    If sht.Cells(n, 1).Value &lt;&gt; \"Input\" And sht.Cells(n, 2).Value &lt;&gt; \"Input\" Then\n                    sht.Rows(n).EntireRow.Delete\n                    End If\n                    Next n\n\n              Next sht\n     End Sub\n</code></pre>\n\n<p>`</p>\n"}], "owner": {"reputation": 1, "user_id": 7818788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/495e004cca48492e39c242573183e8b0?s=128&d=identicon&r=PG", "display_name": "MorphhproM", "link": "https://stackoverflow.com/users/7818788/morphhprom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491423420, "creation_date": 1491377661, "last_edit_date": 1491379384, "question_id": 43224714, "link": "https://stackoverflow.com/questions/43224714/delete-special-rows-in-every-sheet-via-vba", "title": "Delete special rows in every sheet via VBA", "body": "<p>I tried to write some code to search for a word and if this word isn't found in the first an second column I delete the row.</p>\n\n<p>This code runs through every Sheet.</p>\n\n<p>Unfortunately this script takes like forever and Excel stops working. It works for one sheet but even if there are just 2 rows, it takes like 10 seconds.</p>\n\n<p>Maybe you can help me to work on the performance, because I never learned VBA and this code is the best I was able to write.</p>\n\n<pre><code>Option Explicit\n\nSub dontDeleteRowWithInput()\nDim wksSheet As Worksheet\nDim area As Range, i As Integer, j As Integer\nDim rows As Long\nDim Var As String\nDim bool As Boolean\nDim celltxt As String\n\nVar = InputBox(\"Input\", \"Input\")\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n'Loop over every Worksheet in this Workbook\nFor Each wksSheet In ActiveWorkbook.Worksheets\n    Set area = wksSheet.UsedRange\n    rows = area.Rows.Count\n    'Loop the rows backwards until it reaches row 2 (Row 1 should be ignored)\n    For j = rows To 2 Step -1\n        'Search vor the input in Column 1 and 2\n        For i = 1 To 2 Step 1\n            'Get the content of the reached cell in string format\n            celltxt = Cells(j, i).Value\n            'Compare the saved string with the input\n            If InStr(celltxt, Var) &gt; 0 Then\n                'If the input is found in this cell don't delete the row\n                bool = False\n                Exit For\n            End If\n            'Delete the row if the input wasn't found in its columns\n            If bool = True Then\n                Rows(j).Delete\n            End If\n            'Reset the bool\n            bool = True\n        Next i\n    Next j\nNext wksSheet\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1491378819, "post_id": 43224733, "comment_id": 73520206, "body": "You don&#39;t need the <code>EnableEvents</code> flags around the paste unless you also have sheet change code in the &quot;data&quot; sheet..."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1491385777, "post_id": 43224733, "comment_id": 73525126, "body": "Good catch Wolfie! :)"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1491385819, "last_edit_date": 1491385819, "creation_date": 1491377710, "answer_id": 43224733, "question_id": 43224352, "link": "https://stackoverflow.com/questions/43224352/paste-special-not-working-more-than-1-time-vba/43224733#43224733", "title": "Paste Special Not Working more than 1 time: VBA", "body": "<p>Not sure what is being copied as you have used Selection and that depends upon how you input value in column C, whether by hitting Enter or Ctrl+Enter.\nSay if you input a value in B2 and press Enter to submit it, cell B3 will get selected and as per your code a range from row3 will be copied to Data sheet. Whereas if you hit Ctrl+Enter, the selection will remain in B2 so a range from row2 will be copied to data sheet.\nBut that you can tweak yourself.</p>\n\n<p>See if the tweaked code works for you.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Location As Range\nIf Target.Column &lt;&gt; 3 Then Exit Sub\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nCells(Target.Row, 4) = Now\nApplication.EnableEvents = True\nSelection.End(xlToLeft).Select\nRange(Selection, Selection.End(xlToRight)).Select\nSheets(\"data\").Unprotect\nSelection.Copy\nSheets(\"Data\").Range(\"A\" &amp; Rows.Count).End(3)(2).PasteSpecial xlPasteValues\nSheets(\"data\").Protect\nRange(\"a1\").Select\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 0, "last_activity_date": 1491378712, "creation_date": 1491378712, "answer_id": 43225082, "question_id": 43224352, "link": "https://stackoverflow.com/questions/43224352/paste-special-not-working-more-than-1-time-vba/43225082#43225082", "title": "Paste Special Not Working more than 1 time: VBA", "body": "<p>The problem was that unprotecting the sheet was clearing the clipboard, meaning there was nothing to paste! Here is adapted code, which I've also changed in a couple of other ways to greatly improve it, see the comments for details.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim Location As Range\n    ' Use &lt;&gt; to mean \"not equal to\"\n    If Target.Column &lt;&gt; 3 Then Exit Sub\n    Application.EnableEvents = False\n    ' Fully qualify the cells object\n    ThisWorkbook.Sheets(\"Sheet1\").Cells(Target.Row, 4).Value = Now\n    Application.EnableEvents = True\n    ' Avoid using .Select and Selection, the user could have clicked anywhere after the value change\n    ' Use a With block to fully qualify your range objects\n    With ThisWorkbook.Sheets(\"data\")\n        .Unprotect\n        ' Copy immediately before paste\n        Target.EntireRow.Copy\n        .Range(\"A1\").End(xlDown).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n        .Protect\n    End With\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Currently, this just overwrites the same line on the \"data\" sheet, because the data you're pasting has nothing in column A, so the <code>End(xlDown)</code> in column A returns the same position. You may need to change this to column C, or use</p>\n\n<pre><code>.Cells(Rows.Count,\"C\").End(xlUp).Offset(1, 0).PasteSpecial\n</code></pre>\n\n<p>Which is still column dependant but goes up to get the last row. There is a dot <code>.</code> before <code>Cells</code> because that line would be within the <code>With</code> block.</p>\n"}], "owner": {"reputation": 1, "user_id": 7818739, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hv3exQ0DiWI/AAAAAAAAAAI/AAAAAAAAASM/Wouc0RxsPDs/photo.jpg?sz=128", "display_name": "Shiv Gurung", "link": "https://stackoverflow.com/users/7818739/shiv-gurung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1491385819, "creation_date": 1491376581, "last_edit_date": 1491381911, "question_id": 43224352, "link": "https://stackoverflow.com/questions/43224352/paste-special-not-working-more-than-1-time-vba", "title": "Paste Special Not Working more than 1 time: VBA", "body": "<p>I have 2 sheets in my workbook, \"Sheet1\" and \"Data\". In Sheet1 I have used a <code>Worksheet_Change</code> macro so that when a change happens in column C:</p>\n\n<ol>\n<li>A timestamp appears in column D </li>\n<li>That range will get copied into the \"Data\" sheet. </li>\n</ol>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim Location As Range\n    If Target.Column &gt; 3 Or Target.Column &lt; 3 Then Exit Sub\n    Application.EnableEvents = False\n    Cells(Target.Row, 4) = Now\n    Application.EnableEvents = True\n    Selection.End(xlToLeft).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(\"data\").Unprotect\n    Sheets(\"data\").Range(\"a1\").End(xlDown).Offset(1, 0).PasteSpecial _\n        Paste:=xlPasteValues, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n    Sheets(\"data\").Protect\n    Range(\"a1\").Select\nEnd Sub\n</code></pre>\n\n<p>My problem is that the <code>PasteSpecial</code> is not working more than one time.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7014223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8f80513a94264079e0bb36c303ebbb6?s=128&d=identicon&r=PG", "display_name": "daQuincy", "link": "https://stackoverflow.com/users/7014223/daquincy"}, "edited": false, "score": 0, "creation_date": 1491377761, "post_id": 43224538, "comment_id": 73519557, "body": "learnt something new today! thanks for the tip, will give it a go"}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 0, "last_activity_date": 1491377139, "creation_date": 1491377139, "answer_id": 43224538, "question_id": 43224077, "link": "https://stackoverflow.com/questions/43224077/how-to-restrict-a-user-from-editing-an-excel-workbook-in-a-network-shared-folder/43224538#43224538", "title": "How to restrict a user from editing an Excel workbook in a network shared folder when it is being edited (open) by another user?", "body": "<p>The function <code>Application.UserName</code> will return you a string with the name of the user so you can use it on your VBA code on something like <code>If Application.UserName = \"Name Of The User\" then</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 7014223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8f80513a94264079e0bb36c303ebbb6?s=128&d=identicon&r=PG", "display_name": "daQuincy", "link": "https://stackoverflow.com/users/7014223/daquincy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491377139, "creation_date": 1491375818, "last_edit_date": 1531161705, "question_id": 43224077, "link": "https://stackoverflow.com/questions/43224077/how-to-restrict-a-user-from-editing-an-excel-workbook-in-a-network-shared-folder", "title": "How to restrict a user from editing an Excel workbook in a network shared folder when it is being edited (open) by another user?", "body": "<p>Can it be done through VBA, since I have some VBA code running, maybe I can add into it, or it's just a simple setting in a menu that I didn't realize? Pretty new to Excel, thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "excel-2016"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 1, "creation_date": 1491375660, "post_id": 43223969, "comment_id": 73518247, "body": "One way is to use late binding so that you won&#39;t need to add the library reference."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1491376419, "post_id": 43223969, "comment_id": 73518720, "body": "This may help <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_winother/set-default-references-for-all-vba-projects/23f196d0-d168-40f1-a64b-b549dd7df073\" rel=\"nofollow noreferrer\">answers.microsoft.com/en-us/msoffice/forum/&hellip;</a>"}], "owner": {"reputation": 549, "user_id": 1186038, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/745e1525b2be094623eb1b31f9ab6206?s=128&d=identicon&r=PG", "display_name": "compski", "link": "https://stackoverflow.com/users/1186038/compski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 1, "closed_date": 1491382818, "answer_count": 0, "score": 0, "last_activity_date": 1491375476, "creation_date": 1491375476, "question_id": 43223969, "link": "https://stackoverflow.com/questions/43223969/is-there-a-way-to-auto-check-the-check-box-microsoft-scripting-runtime-for-all", "closed_reason": "Duplicate", "title": "Is there a way to auto check the check-box &#39;Microsoft Scripting Runtime&#39; for all excel files?", "body": "<p>Right now, every time I need open a new/existing Microsoft Excel workbook, I find that in:</p>\n\n<blockquote>\n  <p>Developer > Visual Basic > Tools > References</p>\n</blockquote>\n\n<p>I have to manually scroll down the list to check the 'Microsoft Scripting Runtime' so I can use the Macro functions which is a pain in the arse.</p>\n\n<p><a href=\"https://i.stack.imgur.com/h2xMo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h2xMo.png\" alt=\"enter image description here\"></a></p>\n\n<p>Anyone got any ideas?</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1491375946, "post_id": 43223619, "comment_id": 73518432, "body": "Can you share an example spreadhsheet?"}, {"owner": {"reputation": 133, "user_id": 6633301, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-3FTx74t3OXc/AAAAAAAAAAI/AAAAAAAAAFE/MGWCSzXiIIc/photo.jpg?sz=128", "display_name": "Revan Erraboina", "link": "https://stackoverflow.com/users/6633301/revan-erraboina"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1491378790, "post_id": 43223619, "comment_id": 73520185, "body": "I am unable to find any option to share a spreadsheet, I don&#39;t think there is one. Let me know for further options."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1491388423, "post_id": 43223619, "comment_id": 73527062, "body": "Post the code you&#39;ve tried."}, {"owner": {"reputation": 133, "user_id": 6633301, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-3FTx74t3OXc/AAAAAAAAAAI/AAAAAAAAAFE/MGWCSzXiIIc/photo.jpg?sz=128", "display_name": "Revan Erraboina", "link": "https://stackoverflow.com/users/6633301/revan-erraboina"}, "edited": false, "score": 0, "creation_date": 1491389500, "post_id": 43223619, "comment_id": 73527835, "body": "I used this formula : =INDEX($A$2:$A$6,SMALL(IF(NOT(ISERROR(SEARCH(&quot;-&quot; &amp; $C$1 &amp; &quot;-&quot;,$A$2:$A$6))),ROW($A$2:$A$6)-1),ROWS($D$1:D1))) but its not working."}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1491391943, "creation_date": 1491391943, "answer_id": 43229976, "question_id": 43223619, "link": "https://stackoverflow.com/questions/43223619/how-to-get-multiple-results-with-one-vlookup-in-vba-where-vlookup-is-the-part-o/43229976#43229976", "title": "How to get multiple results with one vlookup in VBA, Where vlookup is the part of the whole string (vlookup value)", "body": "<p>Subject to a few conditions the following code will do what you want. Install it in a standard code module (by default \"Module1\", but you can name it as you like) in the workbook where you have your data.</p>\n\n<pre><code>Option Explicit\n\nEnum Nws                                        ' Worksheet navigation\n    NwsFirstDataRow = 2                         ' presumed the same for all worksheets\n    NwsCode = 1                                 ' 1 = column A (change as required)\n    NwsSubCode                                  ' No value means previous + 1\n    NwsNumer\nEnd Enum\n\nSub NumerList()\n    ' 05 Apr 2017\n\n    Dim Wb As Workbook                          ' all sheets are in the same workbook\n    Dim WsCodes As Worksheet                    ' Register codes\n    Dim WsNum As Worksheet                      ' Sub-code values\n    Dim WsOut As Worksheet                      ' Output worksheet\n    Dim RegName As String, RegCode As String\n    Dim Sp() As String\n    Dim Rs As Long                              ' Source row in WsNum\n    Dim Rt As Long                              ' Target row in WsOut\n    Dim R As Long, Rl As Long                   ' rows / Last row in WsCodes\n\n    Set Wb = ActiveWorkbook                     ' Make sure it is active!\n    Set WsCodes = Wb.Worksheets(\"Reg Codes\")    ' Change name to your liking\n    Set WsNum = Wb.Worksheets(\"Code Values\")    ' Change name to your liking\n\n    On Error Resume Next\n    Set WsOut = Wb.Worksheets(\"Output\")         ' Change name to your liking\n    If Err Then\n        Set WsOut = Wb.Worksheets.Add(After:=WsNum)\n        WsOut.Name = \"Output\"                   ' create the worksheet if it doesn't exist\n    End If\n    On Error GoTo 0\n\n    Rt = NwsFirstDataRow\n    With WsCodes\n        Rl = .Cells(.Rows.Count, NwsCode).End(xlUp).Row\n        For R = NwsFirstDataRow To Rl\n            RegName = .Cells(R, NwsCode).Value\n            Sp = Split(RegName, \"-\")\n            If UBound(Sp) &gt; 1 Then              ' must find at least 2 dashes\n                RegCode = Trim(Sp(1))\n            Else\n                RegCode = \"\"\n            End If\n\n            If Len(RegCode) Then\n                On Error Resume Next\n                Rs = WorksheetFunction.Match(RegCode, WsNum.Columns(NwsCode), 0)\n                If Err Then Rs = 0\n                On Error GoTo 0\n\n                If Rs Then\n                    Do\n                        WsOut.Cells(Rt, NwsCode).Value = RegName\n                        WsOut.Cells(Rt, NwsSubCode).Value = WsNum.Cells(Rs, NwsSubCode).Value\n                        WsOut.Cells(Rt, NwsNumer).Value = WsNum.Cells(Rs, NwsNumer).Value\n                        Rt = Rt + 1\n                        Rs = Rs + 1\n                    Loop While WsNum.Cells(Rs, NwsCode).Value = RegCode\n                Else\n                    RegCode = \"\"\n                End If\n            End If\n\n            If Len(RegCode) = 0 Then\n                WsOut.Cells(Rt, NwsCode).Value = RegName\n                WsOut.Cells(Rt, NwsSubCode).Value = \"No sub-code found\"\n                Rt = Rt + 1\n            End If\n        Next R\n    End With\nEnd Sub\n</code></pre>\n\n<p>And here are the conditions.</p>\n\n<ol>\n<li>All 3 sheets must be in the same workbook. If you have them in different workbooks the code must be adapted to handle more than one workbook.</li>\n<li>The two worksheets with data must exist. They must be named as the code prescribes or the code must be modified to match the names they have. The same goes for the Output worksheet, but that sheet will be created by the code if it doesn't exist. You can change its name in the code.</li>\n<li>The enumeration at the top of the code presumes that all 3 sheets are identically formatted with no data in row 1 (captions) and data in columns A, B and C. Changes aren't difficult but must be made if you want a different input or output. You can change the columns in the existing code by assigning other values to the columns in the enum, but the code requires the same arrangement in all sheets.</li>\n<li>The extracted codes in the Codes sheet aren't used. The code does its own extraction. It will mark an error in the output list if a code can't be extracted or if it isn't found in the Sub-code list.</li>\n<li>The sub-codes in the Numer sheet must be sorted like the picture you posted. The code will look for the first occurrence of \"image\" and find the subcodes in the following rows while the code is \"image\" in column A. It will not find further occurrences of \"image\" that might follow after an intermission.</li>\n<li>The code doesn't do any colouring. Adding it wouldn't be difficult, but you would have to specify some rules, such as \"20 different colours for the first 20 codes and then repeat the same sequence\".</li>\n<li>Other cell formatting could be added without much effort because each cell is already individually named. More properties can be added easily.</li>\n</ol>\n"}], "owner": {"reputation": 133, "user_id": 6633301, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-3FTx74t3OXc/AAAAAAAAAAI/AAAAAAAAAFE/MGWCSzXiIIc/photo.jpg?sz=128", "display_name": "Revan Erraboina", "link": "https://stackoverflow.com/users/6633301/revan-erraboina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491391943, "creation_date": 1491374347, "last_edit_date": 1491375742, "question_id": 43223619, "link": "https://stackoverflow.com/questions/43223619/how-to-get-multiple-results-with-one-vlookup-in-vba-where-vlookup-is-the-part-o", "title": "How to get multiple results with one vlookup in VBA, Where vlookup is the part of the whole string (vlookup value)", "body": "<p>I have 3 sheets, in sheet one I have a column \"Register Codes\" and I have extracted the unique codes in next column. Please check the below image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/acpc6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/acpc6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Based on these unique codes, sub-codes are allocated in sheet 2. please check the below image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OoItx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OoItx.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now what I am trying here is that in sheet 3 I need every <strong>\"Register code\"</strong> with the relevant <strong>\"sub-code\"</strong> which is allocated in sheet2 based on the <strong>\"unique ID\"</strong> given in Sheet1. please check the below image for expected output. </p>\n\n<p><a href=\"https://i.stack.imgur.com/zejEv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zejEv.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have been using various combinations of formulas but could not get a proper solution. What is the best way to do it in VBA as I just started learning in this field.</p>\n"}, {"tags": ["excel", "csv", "dropdown", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1491396675, "post_id": 43223543, "comment_id": 73533292, "body": "For Q1: <code>If Not Application.Intersect(Target, Me.Range(&quot;C5:E7&quot;)) Is Nothing Then</code>"}, {"owner": {"reputation": 7, "user_id": 7541689, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Onb7jASMKXc/AAAAAAAAAAI/AAAAAAAABko/ilVMElGxMGs/photo.jpg?sz=128", "display_name": "Abhishek Rath", "link": "https://stackoverflow.com/users/7541689/abhishek-rath"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1491483740, "post_id": 43223543, "comment_id": 73580582, "body": "Thanks Robin...that definitely solves the 1st issue. :)"}], "owner": {"reputation": 7, "user_id": 7541689, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Onb7jASMKXc/AAAAAAAAAAI/AAAAAAAABko/ilVMElGxMGs/photo.jpg?sz=128", "display_name": "Abhishek Rath", "link": "https://stackoverflow.com/users/7541689/abhishek-rath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491381968, "creation_date": 1491374112, "last_edit_date": 1531164843, "question_id": 43223543, "link": "https://stackoverflow.com/questions/43223543/drop-values-saved-comma-separated-in-a-cell-in-excel", "title": "Drop values saved comma separated in a cell in excel", "body": "<p>I have a metadatasheet from which I am setting some parameters from which I am generating pivots. I am selecting these parameters through dropdown lists. </p>\n\n<p><a href=\"https://i.stack.imgur.com/KaPQi.jpg\" rel=\"nofollow noreferrer\">Here is what my metadata sheet looks like.</a></p>\n\n<p>I am saving the values of dropdown in a comma separated manner in the corresponding cell. For that I have a macro on that sheet which is :</p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As Range)\n\n'Set automatic formula calculation ON\nApplication.Calculation = xlAutomatic\n\nDim Oldvalue As String\nDim Newvalue As String\nApplication.EnableEvents = True\nOn Error GoTo Exitsub\nIf Target.Address = \"$C$5\" Or Target.Address = \"$C$6\" Or Target.Address = \"$C$7\" Or Target.Address = \"$D$5\" Or Target.Address = \"$D$6\" Or Target.Address = \"$D$7\" Or Target.Address = \"$E$5\" Or Target.Address = \"$E$6\" Or Target.Address = \"$E$7\" Then\n  If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n    GoTo Exitsub\n  Else: If Target.Value = \"\" Then GoTo Exitsub Else\n    Application.EnableEvents = False\n    Newvalue = Target.Value\n    Application.Undo\n    Oldvalue = Target.Value\n      If Oldvalue = \"\" Then\n        Target.Value = Newvalue\n      Else\n        If InStr(1, Oldvalue, Newvalue) = 0 Then\n            Target.Value = Oldvalue &amp; \",\" &amp; Newvalue\n      Else:\n        Target.Value = Oldvalue\n      End If\n    End If\n  End If\nEnd If\nApplication.EnableEvents = True\nExitsub:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><strong>My issues:</strong></p>\n\n<p>1) Rather than defining individual cells in the 10th line of macro, is there a way define a range? Basically I am defining all the cells of the range C5:E7 as individual cells using \"Or\"</p>\n\n<p>2) I am not able to delete individual comma separated values, because while doing so it give me the following error.<a href=\"https://i.stack.imgur.com/JALB2.jpg\" rel=\"nofollow noreferrer\">A user has restricted values that can be entered into the cell</a>\nI have to entire cell and then select the values again.  Is there a way I can delete only single value?</p>\n"}, {"tags": ["html", "excel", "vba", "button", "click"], "comments": [{"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1491374016, "post_id": 43223464, "comment_id": 73517292, "body": "Change the line &quot;Element.Click&quot; with &quot;Element.NextSibling.Click&quot; and try to execute."}, {"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1491374432, "post_id": 43223464, "comment_id": 73517494, "body": "You can also try to get element by &quot;ID&quot; they both have different id."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1491376780, "post_id": 43223464, "comment_id": 73518947, "body": "<code>allInputs</code> will be an collection, so <code>allInputs(2).click</code> or <code>set e=allinputs(2):e.click</code> something along those lines."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 7773845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8340163faa9078f56228a1b654a84a?s=128&d=identicon&r=PG&f=1", "display_name": "Suhr415", "link": "https://stackoverflow.com/users/7773845/suhr415"}, "is_accepted": true, "score": 0, "last_activity_date": 1491499877, "creation_date": 1491499877, "answer_id": 43262061, "question_id": 43223464, "link": "https://stackoverflow.com/questions/43223464/click-the-second-button-of-an-img-in-vba/43262061#43262061", "title": "Click the second button of an img in VBA", "body": "<p>Thanks for all of your help!</p>\n\n<p>I did it with code here: </p>\n\n<pre><code>Set allInputs = IE.Document.getElementsByTagName(\"img\")\nallInputs(2).click\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7773845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d8340163faa9078f56228a1b654a84a?s=128&d=identicon&r=PG&f=1", "display_name": "Suhr415", "link": "https://stackoverflow.com/users/7773845/suhr415"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 791, "favorite_count": 0, "accepted_answer_id": 43262061, "answer_count": 1, "score": 2, "last_activity_date": 1491499877, "creation_date": 1491373823, "question_id": 43223464, "link": "https://stackoverflow.com/questions/43223464/click-the-second-button-of-an-img-in-vba", "title": "Click the second button of an img in VBA", "body": "<p>I'm trying to click an imagebutton on IE by using getAttribute(\"src\"), but there are to identical buttons with the same src-code, so when I use this code, it clicks the first and I want to click the second. Can somebody help me?</p>\n\n<p><strong>I'm thinking of creating a loop to search through and choose the second one, but I have no idea how to write the code! Can somebody help me out?</strong></p>\n\n<p>This is the code I use to click the first button:</p>\n\n<pre><code>Set allInputs = IE.Document.getElementsByTagName(\"img\")\nFor Each Element In allInputs\nIf Element.getAttribute(\"src\") = \"/forms/Content/Images/0006.gif\" Then    \nElement.Click     \nExit For    \nEnd If     \nNext Element    \n</code></pre>\n\n<p>The HTML code for the buttons are:</p>\n\n<pre><code>&lt;tr class=\"jqgfirstrow\" role=\"row\"      \n&lt;tr tabindex=\"-1\" class=\"ui-widget-content jqgrow ui-row-ltr\" id=\"1\"     role=\"row\"\n&lt; img src=\"/forms/Content/Images/0006.gif\"  \n\n&lt;tr tabindex=\"-1\" class=\"ui-widget-content jqgrow ui-row-ltr\" id=\"2\" role=\"row\n&lt; img src=\"/forms/Content/Images/0006.gif\"\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1491381002, "last_edit_date": 1491381002, "creation_date": 1491380032, "answer_id": 43225526, "question_id": 43223153, "link": "https://stackoverflow.com/questions/43223153/how-to-create-pie-chart-for-each-record-in-ms-access-report/43225526#43225526", "title": "How to create PIE chart for each record in MS Access Report", "body": "<p>Need at least two values in series for pie chart. In your case you need \"complete\" and \"incomplete\". Build a UNION query to generate the \"incomplete\" value. UNION queries must be built in SQLView of query designer.</p>\n\n<pre><code>SELECT ID, [Percentage], \"Complete\" AS Category FROM table\nUNION SELECT ID, 100-[Percentage], \"Incomplete\" FROM table;\n</code></pre>\n\n<p>Now use that query as source for graph RowSource.</p>\n\n<p>Use the Chart Wizard to build the graph RowSource and set the Master/Child Link properties. Then if you want to can edit the RowSource to be a simpler query (no grouping).<br>\n<code>SELECT [Category], [Rate] FROM [UnionQuery];</code></p>\n"}], "owner": {"reputation": 11, "user_id": 5766142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc2588857e698bc1cf4b4bdf22bf5d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Thareja", "link": "https://stackoverflow.com/users/5766142/mohit-thareja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491381002, "creation_date": 1491372705, "question_id": 43223153, "link": "https://stackoverflow.com/questions/43223153/how-to-create-pie-chart-for-each-record-in-ms-access-report", "title": "How to create PIE chart for each record in MS Access Report", "body": "<p>I have created a report using report Wizard.There is a column named as percentage complete.I want to generate  Pie chart for each record for this column. \nPlease help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1491372298, "post_id": 43222967, "comment_id": 73516378, "body": "<a href=\"http://stackoverflow.com/a/30393989/4539709\">stackoverflow.com/a/30393989/4539709</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1491372306, "post_id": 43222967, "comment_id": 73516381, "body": "have you tried anything?  LIke recording yourself doing it/google?"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491372488, "post_id": 43222967, "comment_id": 73516452, "body": "you can use something like thisworkbook.worksheets(array(sheet1,sheet2,sheet3)).copy before saving the file."}, {"owner": {"reputation": 23, "user_id": 7807348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3ac2375723cf4b9c408df37899260b?s=128&d=identicon&r=PG&f=1", "display_name": "Crimson Alchemist", "link": "https://stackoverflow.com/users/7807348/crimson-alchemist"}, "edited": false, "score": 0, "creation_date": 1491372516, "post_id": 43222967, "comment_id": 73516466, "body": "I tried google. I used some codes I found, adapted, but it either doesn&#39;t work with my previous code, either it doesn&#39;t work as I intend to."}, {"owner": {"reputation": 23, "user_id": 7807348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3ac2375723cf4b9c408df37899260b?s=128&d=identicon&r=PG&f=1", "display_name": "Crimson Alchemist", "link": "https://stackoverflow.com/users/7807348/crimson-alchemist"}, "reply_to_user": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491372794, "post_id": 43222967, "comment_id": 73516612, "body": "@Sivaprasath: it is giving me and error 9, subscript out of range."}], "answers": [{"tags": [], "owner": {"reputation": 273, "user_id": 7326431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1981b6b6f9d1b7cd9e822c7b822e3a8?s=128&d=identicon&r=PG&f=1", "display_name": "Impuls3H", "link": "https://stackoverflow.com/users/7326431/impuls3h"}, "is_accepted": false, "score": 0, "last_activity_date": 1491372752, "creation_date": 1491372752, "answer_id": 43223161, "question_id": 43222967, "link": "https://stackoverflow.com/questions/43222967/how-can-i-export-using-vba-specific-sheets-in-my-main-workbook-to-a-new-excel/43223161#43223161", "title": "How can I export, using VBA, specific sheets in my main workbook, to a new excel file?", "body": "<p>Try the below? I haven't tried yet though.</p>\n\n<pre><code>Sub NOUDOC()\nDim wbTemplate as Workbook\nSet wbTemplate = ActiveWorkbook\nDim wbNew As Workbook\nDim data As Date\ndata = Range(\"H3\").Value\nSet wbNew = Workbooks.Add()\nsheet_count = 1\nFor Each each_sheet in wbTemplate.Sheets\n    each_sheet.Copy Before:= wbNew.Sheets(sheet_count)\n    sheet_count = sheet_count + 1\nNext\nwbNew.SaveAs (\"C:\\Users\\Alina\\Desktop\\Carburant \" &amp; Format(data, \"MMMM YYYY\") &amp; \".xlsx\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491372921, "post_id": 43223194, "comment_id": 73516691, "body": "i suggested the same thing. but for some reason there seems to be an script out of range error."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491373194, "post_id": 43223194, "comment_id": 73516845, "body": "@SivaprasathV, you are missing quotation marks (<code>&quot;&quot;</code>) surrounding each sheet name"}, {"owner": {"reputation": 23, "user_id": 7807348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3ac2375723cf4b9c408df37899260b?s=128&d=identicon&r=PG&f=1", "display_name": "Crimson Alchemist", "link": "https://stackoverflow.com/users/7807348/crimson-alchemist"}, "edited": false, "score": 0, "creation_date": 1491373337, "post_id": 43223194, "comment_id": 73516936, "body": "WIthout this line &#39;Set wbNew = Workbooks.Add()&#39; it works. I don&#39;t know why though."}, {"owner": {"reputation": 23, "user_id": 7807348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3ac2375723cf4b9c408df37899260b?s=128&d=identicon&r=PG&f=1", "display_name": "Crimson Alchemist", "link": "https://stackoverflow.com/users/7807348/crimson-alchemist"}, "edited": false, "score": 0, "creation_date": 1491373401, "post_id": 43223194, "comment_id": 73516969, "body": "Thank you very much user3598756!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 23, "user_id": 7807348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3ac2375723cf4b9c408df37899260b?s=128&d=identicon&r=PG&f=1", "display_name": "Crimson Alchemist", "link": "https://stackoverflow.com/users/7807348/crimson-alchemist"}, "edited": false, "score": 0, "creation_date": 1491373514, "post_id": 43223194, "comment_id": 73517023, "body": "@CrimsonAlchemist, You are welcome. I omitted that statement (along with the one <i>dimming</i> <code>wbNew</code> variable) because you don&#39;t need it at all: <code>.Copy</code> method is taking care to create the new <code>workbook</code> which can be referenced to by means of <code>ActiveWorkbook</code> property of <code>Application</code> (i.e. Excel)  object"}, {"owner": {"reputation": 23, "user_id": 7807348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3ac2375723cf4b9c408df37899260b?s=128&d=identicon&r=PG&f=1", "display_name": "Crimson Alchemist", "link": "https://stackoverflow.com/users/7807348/crimson-alchemist"}, "edited": false, "score": 0, "creation_date": 1491384105, "post_id": 43223194, "comment_id": 73523844, "body": "@user3598756: Hey again! Can you please tell me if I want to copy only the values, not the formulas, what I need to do? I tried with &quot;.PasteSpecial xlPasteValues&quot; but I cannot adapt it to my code. P.S. I also need to copy the formulas for just one sheet."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1491389025, "post_id": 43223194, "comment_id": 73527510, "body": "It&#39;s not a simple little tweak of my code: post a specific new question along with your code attempts"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1491372853, "creation_date": 1491372853, "answer_id": 43223194, "question_id": 43222967, "link": "https://stackoverflow.com/questions/43222967/how-can-i-export-using-vba-specific-sheets-in-my-main-workbook-to-a-new-excel/43223194#43223194", "title": "How can I export, using VBA, specific sheets in my main workbook, to a new excel file?", "body": "<p>you could use the <em>Array</em> \"flavour\" of <code>Worksheets</code> object:</p>\n\n<pre><code>Sub NOUDOC()\n    Dim data As Date\n    data = Range(\"H3\").Value\n\n    Worksheets(Array(\"Sh1\", \"Sh2\", \"Sh3\")).Copy '&lt;--| this will copy listed sheets into a new (and Active) workbook\n    ActiveWorkbook.SaveAs \"C:\\Users\\Alina\\Desktop\\Carburant \" &amp; Format(data, \"MMMM YYYY\") &amp; \".xlsx\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7807348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b3ac2375723cf4b9c408df37899260b?s=128&d=identicon&r=PG&f=1", "display_name": "Crimson Alchemist", "link": "https://stackoverflow.com/users/7807348/crimson-alchemist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1355, "favorite_count": 0, "accepted_answer_id": 43223194, "answer_count": 2, "score": 0, "last_activity_date": 1491381995, "creation_date": 1491371985, "last_edit_date": 1491381995, "question_id": 43222967, "link": "https://stackoverflow.com/questions/43222967/how-can-i-export-using-vba-specific-sheets-in-my-main-workbook-to-a-new-excel", "title": "How can I export, using VBA, specific sheets in my main workbook, to a new excel file?", "body": "<p>I have a main excel file that contains my macros. In this one I created the sheets as a template for future excel files that I need to work with and modify. Now I need to copy specific sheets and their contents to a new workbook.</p>\n\n<p>I also create this workbook using VBA:</p>\n\n<pre><code>Sub NOUDOC()\n    Dim wbNew As Workbook\n    Dim data As Date\n    data = Range(\"H3\").Value\n    Set wbNew = Workbooks.Add()\n    ActiveWorkbook.SaveAs (\"C:\\Users\\Alina\\Desktop\\Carburant \" &amp; Format(data, \"MMMM YYYY\") &amp; \".xlsx\") \nEnd Sub\n</code></pre>\n\n<p>(H3 is a date that I input to filter the data I import from an SQL server)</p>\n\n<p>So I want to use a VBA in my main excel file to create a new excel document that contains specific sheets from my main. </p>\n\n<p>I thank you in advance!    </p>\n"}, {"tags": ["vba", "xmlhttprequest"], "comments": [{"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1491380611, "post_id": 43222542, "comment_id": 73521392, "body": "The code you posted is not VBScript. Also, what is your question? Does something not work?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1491402195, "post_id": 43222542, "comment_id": 73537997, "body": "Can&#39;t open the provided URL since I have no credentials. What finally do you want to achieve by clicking the button? Please add the expected output to the question. The only relevant data I can see within your HAR is an HTML webpage in 2nd response containing a table, see the <a href=\"https://i.stack.imgur.com/C8Y8F.png\" rel=\"nofollow noreferrer\">screenshot by the link</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7348606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SOFtVlLl8f0/AAAAAAAAAAI/AAAAAAAAABY/x7IbQqC1AfM/photo.jpg?sz=128", "display_name": "mehdi parastar", "link": "https://stackoverflow.com/users/7348606/mehdi-parastar"}, "is_accepted": true, "score": 0, "last_activity_date": 1491571051, "last_edit_date": 1491571051, "creation_date": 1491565891, "answer_id": 43277424, "question_id": 43222542, "link": "https://stackoverflow.com/questions/43222542/clicking-on-buttom-using-httprequest-in-vbs/43277424#43277424", "title": "Clicking on buttom using httprequest in VBS", "body": "<p>finally i could resolve problem :)\nby replacing </p>\n\n<pre><code>    Function SaveGraphImageFromURLs( fileUrl, filePath)\n\nDim FileNum As Long\nDim FileData() As Byte\nDim WHTTP As Object\n\nfileUrl = \"http://80.191.214.122/Orion/Charts/CustomChartData.ashx?Calculate95thPercentile=True&amp;CalculateTrendLine=True&amp;ChartDateSpan=1&amp;ChartInitialZoom=yesterday&amp;ChartName=MMAvgBps&amp;ChartSubTitle=%24%7bZoomRange%7d&amp;ChartTitle=%24%7bCaption%7d&amp;Height=0&amp;NetObject=I%3a21067&amp;ResourceID=69&amp;SampleSize=30&amp;Width=640&amp;DataFormat=ChartData&amp;NetObjectIds=21067\"\n\ndisplaydata = \"DisplayDetails=eyJkYXRhVXJsIjoiL09yaW9uL0ludGVyZmFjZXMvU2VydmljZXMvSW50ZXJmYWNlQ2hhcnREYXRhLmFzbXgvTU1BdmdCcHMiLCJ0aXRsZSI6IkZhc3RFdGhlcm5ldDEvMC80OCA%2FICMjIyBVUExJTksgLSAoIExpbmstMiApIC0gQ09OTkVDVEVELVRPLU9SVU1JRUgtUEFZQU0tRklCRVJIT01FLTMiLCJzdWJ0aXRsZSI6IiRbWm9vbVJhbmdlXSIsInNob3dUaXRsZSI6dHJ1ZSwibmV0T2JqZWN0SWRzIjpbIjIxMDY3Il0sInNhbXBsZVNpemVJbk1pbnV0ZXMiOjMwLCJyZW5kZXJUbyI6ImN0bDAwX2N0bDAwX0JvZHlDb250ZW50X0NvbnRlbnRQbGFjZUhvbGRlcjFfY3RsODJfY3RsMDBfV3JhcHBlcl9jdGwwMSIsIkNhbGN1bGF0ZVRyZW5kTGluZSI6dHJ1ZSwiQ2FsY3VsYXRlU3VtIjpmYWxzZSwiQ2FsY3VsYXRlOTV0aFBlcmNlbnRpbGUiOnRydWUsImluaXRpYWxab29tIjoieWVzdGVyZGF5IiwiUmVzb3VyY2VQcm9wZXJ0aWVzIjp7ImNoYXJ0bmFtZSI6Ik1NQXZnQnBzIiwiY2hhcnRpbml0aWFsem9vbSI6Inllc3RlcmRheSIsIm5ldG9iamVjdHByZWZpeCI6IkkiLCJjaGFydHN1YnRpdGxlIjoiJHtab29tUmFuZ2V9IiwiY2FsY3VsYXRldHJlbmRsaW5lIjoiMSIsImNoYXJ0ZGF0ZXNwYW4iOiIxIiwic2hvd3RpdGxlIjoiMSIsInNhbXBsZXNpemUiOiIzMCIsImNhbGN1bGF0ZTk1dGhwZXJjZW50aWxlIjoiMSIsImNhbGN1bGF0ZXN1b\"\ndisplaydata = displaydata &amp; \"SI6IjAiLCJjaGFydHRpdGxlIjoiJHtDYXB0aW9ufSJ9LCJ0aXRsZVdpZHRoIjo2NDAsInN1YlRpdGxlV2lkdGgiOjY0MCwiRGF0ZUZyb21VdGMiOiIwMDAxLTAxLTAxVDAwOjAwOjAwWiIsIkRhdGVUb1V0YyI6IjAwMDEtMDEtMDFUMDA6MDA6MDBaIiwidGltZXNwYW5JbkRheXMiOjEsImxlZ2VuZEluaXRpYWxpemVyIjoiY29yZV9zdGFuZGFyZExlZ2VuZEluaXRpYWxpemVyX19jdGwwMF9jdGwwMF9Cb2R5Q29udGVudF9Db250ZW50UGxhY2VIb2xkZXIxX2N0bDgyX2N0bDAwX1dyYXBwZXJfY3RsMDRfbGVnZW5kIiwiQ2hhcnRFZGl0VXJsIjoiL09yaW9uL0NoYXJ0cy9DdXN0b21DaGFydC5hc3B4P1Jlc291cmNlSUQ9NjlcdTAwMjZOZXRPYmplY3Q9SToyMTA2NyIsImxvYWRpbmdNb2RlIjowfQ%3D%3D\"\n\nWHTTP.Open \"post\", fileUrl, False\nWHTTP.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nWHTTP.send displaydata\n\nFileData = WHTTP.responseBody\nSet WHTTP = Nothing\n\n'Save the file\nFileNum = FreeFile\n\nOpen filePath For Binary Access Write As #FileNum\nPut #FileNum, 1, FileData\nClose #FileNum\nDebug.Print \"File has been saved!\", vbInformation, \"Success\"\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7348606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SOFtVlLl8f0/AAAAAAAAAAI/AAAAAAAAABY/x7IbQqC1AfM/photo.jpg?sz=128", "display_name": "mehdi parastar", "link": "https://stackoverflow.com/users/7348606/mehdi-parastar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 43277424, "answer_count": 1, "score": -2, "last_activity_date": 1491571051, "creation_date": 1491370190, "last_edit_date": 1491382936, "question_id": 43222542, "link": "https://stackoverflow.com/questions/43222542/clicking-on-buttom-using-httprequest-in-vbs", "title": "Clicking on buttom using httprequest in VBS", "body": "<p>I want to simulate <code>ie.document.getElementbyId(\"buttom_id\").(0).click</code> in <code>XMLHTTPREQUEST</code>.</p>\n\n<p>Therefore in clicking the button:</p>\n\n<ol>\n<li><p>Right click on the webpage and select 'INSPECT'</p></li>\n<li><p>Select network tab</p></li>\n<li><p>Copy all as HAR</p></li>\n</ol>\n\n<p>This interaction is below:\n<a href=\"http://textuploader.com/dr1bt\" rel=\"nofollow noreferrer\">HAR FILE</a></p>\n\n<p>My code is below:</p>\n\n<pre><code>Function SaveGraphImageFromURLs( fileUrl, filePath)\n\nDim FileNum As Long\nDim FileData() As Byte\nDim WHTTP As Object\n\nfileUrl = \"http://80.191.214.122/Orion/Charts/CustomChartData.ashx?Calculate95thPercentile=True&amp;CalculateTrendLine=True&amp;ChartDateSpan=1&amp;ChartInitialZoom=yesterday&amp;ChartName=MMAvgBps&amp;ChartSubTitle=%24%7bZoomRange%7d&amp;ChartTitle=%24%7bCaption%7d&amp;Height=0&amp;NetObject=I%3a21067&amp;ResourceID=69&amp;SampleSize=30&amp;Width=640&amp;DataFormat=ChartData&amp;NetObjectIds=21067\"\n\nWHTTP.Open \"post\", fileUrl, False\nWHTTP.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\nWHTTP.send\n\nFileData = WHTTP.responseBody\nSet WHTTP = Nothing\n\n'Save the file\nFileNum = FreeFile\n\nOpen filePath For Binary Access Write As #FileNum\nPut #FileNum, 1, FileData\nClose #FileNum\nDebug.Print \"File has been saved!\", vbInformation, \"Success\"\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491370004, "post_id": 43222425, "comment_id": 73515394, "body": "how have you tried?"}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1491375127, "creation_date": 1491375127, "answer_id": 43223839, "question_id": 43222425, "link": "https://stackoverflow.com/questions/43222425/vb-macro-to-group-by-one-column-and-sum-based-on-row-values-on-another-column/43223839#43223839", "title": "VB macro to group by one column and sum based on row values on another column", "body": "<p>You may try something like below and tweak it as per your need.</p>\n\n<pre><code>Sub SummarizeData()\nDim sws As Worksheet, dws As Worksheet\nDim x, y, dict, it\nDim i As Long\n\nApplication.ScreenUpdating = False\n\nSet sws = Sheets(\"Sheet1\")\nOn Error Resume Next\nSet dws = Sheets(\"Summary\")\ndws.Cells.Clear\n\nIf dws Is Nothing Then\n    Sheets.Add(after:=sws).Name = \"Summary\"\n    Set dws = ActiveSheet\nEnd If\n\nsws.Range(\"A1:C1\").Copy dws.Range(\"A1\")\nx = sws.Range(\"A1\").CurrentRegion.Value\n\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nFor i = 2 To UBound(x, 1)\n    If x(i, 2) = \"A\" Or x(i, 2) = \"C\" Then\n        If Not dict.exists(x(i, 1) &amp; \";AC\") Then\n            dict.Item(x(i, 1) &amp; \";AC\") = x(i, 3)\n        Else\n            dict.Item(x(i, 1) &amp; \";AC\") = dict.Item(x(i, 1) &amp; \";AC\") + x(i, 3)\n        End If\n    ElseIf x(i, 2) = \"B\" Or x(i, 2) = \"D\" Then\n        If Not dict.exists(x(i, 1) &amp; \";BD\") Then\n            dict.Item(x(i, 1) &amp; \";BD\") = x(i, 3)\n        Else\n            dict.Item(x(i, 1) &amp; \";BD\") = dict.Item(x(i, 1) &amp; \";BD\") + x(i, 3)\n        End If\n    End If\nNext i\nReDim y(1 To dict.Count, 1 To 3)\n\ni = 1\n\nFor Each it In dict.keys\n    y(i, 1) = Split(it, \";\")(0)\n    y(i, 2) = Split(it, \";\")(1)\n    y(i, 3) = dict.Item(it)\n    i = i + 1\nNext it\n\ndws.Range(\"A2\").Resize(UBound(y, 1), 3).Value = y\ndws.UsedRange.Columns.AutoFit\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7818276, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154671810799514/picture?type=large", "display_name": "Shilpa Vishwanath", "link": "https://stackoverflow.com/users/7818276/shilpa-vishwanath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 479, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1491382019, "creation_date": 1491369632, "last_edit_date": 1531164843, "question_id": 43222425, "link": "https://stackoverflow.com/questions/43222425/vb-macro-to-group-by-one-column-and-sum-based-on-row-values-on-another-column", "title": "VB macro to group by one column and sum based on row values on another column", "body": "<p>I have an Excel with 3 columns:</p>\n\n<pre><code>date,       code, sales\n-----------------------\n1-1-2016,   A,    10\n\n1-1-2016,   B,    20\n\n1-1-2016,   C,    30\n\n1-1-2016,   D,    40\n\n1-2-2016,   A,    50\n\n1-2-2016,   B,    60\n\n1-2-2016,   C,    70\n\n1-2-2016,   D,    80\n-----------------------\n</code></pre>\n\n<p>So the code A, B, C, D repeats for multiple dates. Above is just a sample.</p>\n\n<p>For each date, I need to add the sales for A and C as one row. And the sales for B and D as another row.</p>\n\n<p>So my output should look like:</p>\n\n<pre><code>1-1-2016,AC,40\n\n1-1-2016,BD,60\n\n1-2-2016,AC,120\n\n1-2-2016,BD,140\n</code></pre>\n\n<p>How can I create a VB macro to accomplish this? </p>\n"}, {"tags": ["vba", "ms-access", "sequence"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 7527078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9e0f9d7091108a4916699bd15f09?s=128&d=identicon&r=PG&f=1", "display_name": "Santu", "link": "https://stackoverflow.com/users/7527078/santu"}, "is_accepted": false, "score": 1, "last_activity_date": 1491378877, "creation_date": 1491378877, "answer_id": 43225150, "question_id": 43222241, "link": "https://stackoverflow.com/questions/43222241/access-vba-sequence-id-from-other-table/43225150#43225150", "title": "Access Vba Sequence ID from other Table", "body": "<p>the issue is Resolved by the new code i could work out.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Function SequenceNewLevel()\nDim strSQL As String\nDim strSQL1 As String\nDim db As Database\nDim rs As DAO.Recordset\nDim rs1 As DAO.Recordset2\nDim a, initNo As Integer\na = 0\nstrSQL = \"SELECT * FROM MasterTable\"\nstrSQL1 = \"SELECT * FROM ID\"\nSet db = CurrentDb\nSet rs1 = CurrentDb.OpenRecordset(strSQL1)\nIf rs1.RecordCount &gt; 0 Then\nrs1.MoveFirst\nDo While Not rs1.EOF\n    rs1.Edit\n    Set rs = CurrentDb.OpenRecordset(strSQL)\n    If rs.RecordCount &gt; 0 Then\n    rs.MoveFirst\n    Do While Not rs.EOF\n    rs.Edit\n        If rs![TypeOfDrawing] = rs1![Activity] And rs![Project] = rs1![Project] And rs![LevelName] = rs1![Level] And rs![IDGiven] = \"Not Given\" Then\n        a = a + 1\n        rs!Sequence = rs1!StartID + a\n        rs1!StartID = rs!Sequence\n        a = 0\n        rs![IDGiven] = \"GIVEN\"\n        End If\n    rs.Update\n    rs.MoveNext\n    Loop\nEnd If\n rs1.Update\nrs1.MoveNext\nLoop\nrs1.Close\nrs.Close\nSet db = Nothing\nElse\nMsgBox \" No records Found\"\nrs.Close\nSet db = Nothing\nEnd If\nEnd Function\n\n\nPublic Function SequenceNewWithOutLevel()\nDim strSQL As String\nDim strSQL1 As String\nDim db As Database\nDim rs As DAO.Recordset\nDim rs1 As DAO.Recordset2\nDim a, initNo As Integer\na = 0\nstrSQL = \"SELECT * FROM MasterTable\"\nstrSQL1 = \"SELECT * FROM IDWithoutlevel\"\nSet db = CurrentDb\nSet rs1 = CurrentDb.OpenRecordset(strSQL1)\nIf rs1.RecordCount &gt; 0 Then\nrs1.MoveFirst\nDo While Not rs1.EOF\n    rs1.Edit\n    Set rs = CurrentDb.OpenRecordset(strSQL)\n    If rs.RecordCount &gt; 0 Then\n    rs.MoveFirst\n    Do While Not rs.EOF\n    rs.Edit\n        If rs![TypeOfDrawing] = rs1![Activity] And rs![Project] = rs1![Project] And rs![IDGiven] = \"Not Given\" Then\n        a = a + 1\n        rs!Sequence = rs1!StartID + a\n        rs1!StartID = rs!Sequence\n        a = 0\n        rs![IDGiven] = \"GIVEN\"\n        End If\n    rs.Update\n    rs.MoveNext\n    Loop\nEnd If\n rs1.Update\nrs1.MoveNext\nLoop\nrs1.Close\nrs.Close\nSet db = Nothing\nElse\nMsgBox \" No records Found\"\nrs.Close\nSet db = Nothing\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 7527078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6a9e0f9d7091108a4916699bd15f09?s=128&d=identicon&r=PG&f=1", "display_name": "Santu", "link": "https://stackoverflow.com/users/7527078/santu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594022696, "creation_date": 1491368771, "last_edit_date": 1594022696, "question_id": 43222241, "link": "https://stackoverflow.com/questions/43222241/access-vba-sequence-id-from-other-table", "title": "Access Vba Sequence ID from other Table", "body": "<p>I have two tables, ID table and Mastertable. In ID table i have level and activity which is given a start number, let us say 1000. In Mastertable i have many drawings associated to the same activity and level. I have to provide numbering to them starting from the ID table value 1000 and increment it by 1. After finishing, the max value from the mastertable has to be replugged to ID table.</p>\n\n<p>Also, if there is Level and Activity, the ID has to be picked looking up for level and activity both, if no level is mentioned then it has to only lookup activity.</p>\n\n<p>I tried a lot but could not succeed.</p>\n\n<p>I used the Code below, but it looks up only Activity and not level. Also it does not go back to id table and update the max ID from the master Table.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Function SequenceNew()\nDim strSQL As String\nDim db As Database\nDim rs As DAO.Recordset\nDim a, initNo As Integer\nDim b As Integer\n\n\nstrSQL = \"SELECT * FROM MasterTable ORDER BY LevelID\"\n'Set db = CurrentDb\nSet rs = CurrentDb.OpenRecordset(strSQL)\nIf rs.RecordCount &gt; 0 Then\nrs.MoveFirst\nDo While Not rs.EOF\n\nrs.Edit\nIf rs![DrawingTypeName] = \"Concrete\" And rs![ProjectName] = Forms!frm_Publish!CboProject And rs!IDGiven = \"Not Given\" Then\na = a + 1\nrs!Sequence = DLookup(\"CONCRETE\", \"Qry_ID_Selected\") + a\n\nElseIf rs![DrawingTypeName] = \"Reinforcement\" And rs![ProjectName] = Forms!frm_Publish!CboProject And rs!IDGiven = \"Not Given\" Then\nb = b + 1\nrs!Sequence = DLookup(\"REINFORCEMENT\", \"Qry_ID_Selected\") + b\n\nElseIf rs![DrawingTypeName] = \"Steel structural works\" And rs![ProjectName] = Forms!frm_Publish!CboProject And rs!IDGiven = \"Not Given\" Then\n\nEnd If\nrs.Update\nrs.MoveNext\nLoop\nrs.Close\nSet db = Nothing\nElse\nMsgBox \" No records Found\"\nrs.Close\nSet db = Nothing\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>There should be some other better way to do it.\n<a href=\"https://i.stack.imgur.com/3eGuN.jpg\" rel=\"nofollow noreferrer\">MasterTable</a>\n<a href=\"https://i.stack.imgur.com/Y5fIG.jpg\" rel=\"nofollow noreferrer\">ID Table</a></p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1491370072, "post_id": 43222200, "comment_id": 73515425, "body": "And what happens when you run that?"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1491370679, "post_id": 43222200, "comment_id": 73515658, "body": "you can try transferspreadsheet instead of the output to method. i think it has an optional worksheet name argument"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 11820228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d71c3fcb38f2720fff218aee7c94e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Kiran", "link": "https://stackoverflow.com/users/11820228/kiran"}, "is_accepted": false, "score": 0, "last_activity_date": 1581285554, "creation_date": 1581285554, "answer_id": 60141736, "question_id": 43222200, "link": "https://stackoverflow.com/questions/43222200/2-access-queries-on-same-excel-workbook-different-sheets/60141736#60141736", "title": "2 Access queries on same Excel WorkBook different Sheets", "body": "<p>One over-writes the other. Try this:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acExport, , \"TRERequired_Summary\", \"C:\\Users\\OWNER\\Desktop\\Test\\TRERequired_Summary.xls\", True\nDoCmd.TransferSpreadsheet acExport, , \"TRERequired\", \"C:\\Users\\OWNER\\Desktop\\Test\\TRERequired_Summary.xls\", True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7818187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b07167d68926969ea157b59f99fccc45?s=128&d=identicon&r=PG&f=1", "display_name": "Magsteph08", "link": "https://stackoverflow.com/users/7818187/magsteph08"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593954477, "creation_date": 1491368602, "last_edit_date": 1593954477, "question_id": 43222200, "link": "https://stackoverflow.com/questions/43222200/2-access-queries-on-same-excel-workbook-different-sheets", "title": "2 Access queries on same Excel WorkBook different Sheets", "body": "<p>I want to export 2 <code>Access</code> queries to the same <code>Excel</code> <code>WorkBook</code> so query 1 goes to <code>Sheet1</code> and query 2 goes to <code>Sheet2</code>.  I am using <code>Access</code> &amp; <code>Excel</code> 2010</p>\n\n<p>I am using the following code</p>\n\n<pre><code>'------------------------------------------------------------\n' ExportToExcel\n'\n'------------------------------------------------------------\nFunction ExportToExcel()\nOn Error GoTo ExportToExcel_Err\n\n    DoCmd.OutputTo acOutputQuery, \"TRERequired_Summary\", \"Excel97-Excel2003Workbook(*.xls)\", \"C:\\Users\\OWNER\\Desktop\\Test\\TRERequired_Summary.xls\", False, \"\", , acExportQualityScreen\n    DoCmd.OutputTo acOutputQuery, \"TRERequired\", \"Excel97-Excel2003Workbook(*.xls)\", \"C:\\Users\\OWNER\\Desktop\\Test\\TRERequired_Summary.xls\", False, \"\", , acExportQualityScreen\n\n\nExportToExcel_Exit:\n    Exit Function\n\nExportToExcel_Err:\n    MsgBox Error$\n    Resume ExportToExcel_Exit\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "export-to-csv"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1491369176, "post_id": 43221933, "comment_id": 73515084, "body": "no need for copy, just saveas CSV see if that helps"}], "answers": [{"tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": false, "score": 0, "last_activity_date": 1491368865, "creation_date": 1491368865, "answer_id": 43222260, "question_id": 43221933, "link": "https://stackoverflow.com/questions/43221933/how-can-i-export-usedrange-of-values-without-exporting-formulas-in-visual-basic/43222260#43222260", "title": "How can I export usedrange of values without exporting formulas in Visual Basic Excel", "body": "<p>Instead of copying and pasting the entire used range, you can copy from your starting row to the last row that doesn't have a formula in it.  That last row can be found by using this:</p>\n\n<pre><code>  Dim i As Integer\n  With Sheets(1).Columns(\"A\").SpecialCells(xlCellTypeConstants)\n    i = .Cells(.Cells.Count).row\n  End With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1491407246, "post_id": 43223082, "comment_id": 73541957, "body": "@AaronMartin, did you get through it?"}, {"owner": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491407767, "post_id": 43223082, "comment_id": 73542300, "body": "I inserted that just after With ActiveWorkBook and am still getting the commas for the rows containing formulas.  I removed the With ActiveWorkBook and the associated End With and it still errored out.  I moved the End With down below the .SaveAs phrase and just before the End Sub line and it still crashes but it generates the file, just doesn&#39;t save it.  I can see that the Excel file generated has the rows removed I just can&#39;t get it to export to csv now...  Any suggestions?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491408103, "post_id": 43223082, "comment_id": 73542543, "body": "you have to insert it <i>before</i>  <code>With ActiveWorkBook</code>, i.e. replace your <code>With ActiveSheet.UsedRange ... End With</code> block"}, {"owner": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491408395, "post_id": 43223082, "comment_id": 73542753, "body": "It looks like it would work, the part when it asks if you want to overwrite the file even the formatting is removed and I only see two lines below the header, but once you overwrite the file (and I deleted the file to make sure the file was actually being written to) it still has the rows with commas."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491408591, "post_id": 43223082, "comment_id": 73542905, "body": "I can&#39;t follow you: I tested the code before posting it and it worked. be sure you are opening the same file in the same folder produced by the code"}, {"owner": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491409005, "post_id": 43223082, "comment_id": 73543189, "body": "This is the only VB code I have in the file:  Sub CopyToCSV()  &#39; Copy and Paste Active Sheet ActiveSheet.Copy Dim i As Integer   With Sheets(1).Columns(&quot;A&quot;).SpecialCells(xlCellTypeConstants)     i = .Cells(.Cells.Count).Row   End With   &#39;The new workbook becomes Activeworkbook: With ActiveWorkbook         &#39;Saves the new workbook to given folder / filename:      .SaveAs Filename:= _      &quot;C:\\upload\\19meat-kl.csv&quot;, _      FileFormat:=xlCSV, _      CreateBackup:=False       &#39;Closes the file      .Close False   End With End Sub"}, {"owner": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1491409066, "post_id": 43223082, "comment_id": 73543227, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/139998/discussion-between-aaron-martin-and-user3598756\">continue this discussion in chat</a>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491409278, "post_id": 43223082, "comment_id": 73543388, "body": "you were mixing up two codes (mine and Amorpheuses&#39;s one) . see edited code"}, {"owner": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491409657, "post_id": 43223082, "comment_id": 73543625, "body": "I copied the edited code and the same output.  Maybe the issue is that it is saving the original file rather than the new workbook?  At the prompt to save the file I cancel then check within the cells of the newly created workbook and there are no formulas below the two rows anymore so the new file looks good, I think it is still exporting the original file that&#39;s the only way I can see that it could export empty rows any more."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491409739, "post_id": 43223082, "comment_id": 73543679, "body": "at the prompt you must click &quot;YES&quot;!!"}, {"owner": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491409827, "post_id": 43223082, "comment_id": 73543726, "body": "Yes I know, I did that I only clicked no so that I could check out the Book1 file that gets generated for the output so I could make sure the newly generated file did not still include the formulas.  That was a troubleshooting step I took, not normal operation.  When I click yes it generates the same output.  Can I send you the original file?  Perhaps something will jump out at you that I am omitting."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491409955, "post_id": 43223082, "comment_id": 73543802, "body": "I wouldn&#39;t open any excel file from internet. You can link an image."}, {"owner": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491410304, "post_id": 43223082, "comment_id": 73544012, "body": "Fair enough.  Here is file, selected cell has formula (all dark shaded contain formulas) [IMG]<a href=\"http://i63.tinypic.com/2ng8qvo.jpg[/IMG]\" rel=\"nofollow noreferrer\">i63.tinypic.com/2ng8qvo.jpg[/IMG]</a>  Here is the Visual Basic on the Module  [IMG]<a href=\"http://i65.tinypic.com/4to5za.jpg[/IMG]\" rel=\"nofollow noreferrer\">i65.tinypic.com/4to5za.jpg[/IMG]</a>  Here is what it looks like when it processes the file [IMG]<a href=\"http://i67.tinypic.com/358axzo.jpg[/IMG]\" rel=\"nofollow noreferrer\">i67.tinypic.com/358axzo.jpg[/IMG]</a>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491410804, "post_id": 43223082, "comment_id": 73544311, "body": "try edited answer. if it solves your question then please mark answer as accepted. thank you!"}, {"owner": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "edited": false, "score": 0, "creation_date": 1491411181, "post_id": 43223082, "comment_id": 73544554, "body": "Fantastic!  Thank you so much!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1491410768, "last_edit_date": 1491410768, "creation_date": 1491372449, "answer_id": 43223082, "question_id": 43221933, "link": "https://stackoverflow.com/questions/43221933/how-can-i-export-usedrange-of-values-without-exporting-formulas-in-visual-basic/43223082#43223082", "title": "How can I export usedrange of values without exporting formulas in Visual Basic Excel", "body": "<p><strong>edited</strong> to include the whole code</p>\n\n<p>just Clear the <em>nearly-blank</em> cells</p>\n\n<pre><code>Sub CopyToCSV()\n    ' Copy and Paste Active Sheet\n    ActiveSheet.Copy\n    With ActiveSheet.UsedRange\n        .Value = .Value\n        .SpecialCells(xlCellTypeBlanks).EntireRow.Delete\n    End With\n\n    'The new workbook becomes Activeworkbook:\n    With ActiveWorkbook\n        'Saves the new workbook to given folder / filename:\n        .SaveAs Filename:=\"C:\\upload\\19meat-kl.csv\", FileFormat:=xlCSV, CreateBackup:=False\n        'Closes the file and discard changes (no needed any more)\n        .Close False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 4629432, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh6.googleusercontent.com/-H4WuCSijSMQ/AAAAAAAAAAI/AAAAAAAAGIo/5ufrLHpwEQI/photo.jpg?sz=128", "display_name": "Aaron Martin", "link": "https://stackoverflow.com/users/4629432/aaron-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 0, "accepted_answer_id": 43223082, "answer_count": 2, "score": 2, "last_activity_date": 1491410768, "creation_date": 1491367079, "question_id": 43221933, "link": "https://stackoverflow.com/questions/43221933/how-can-i-export-usedrange-of-values-without-exporting-formulas-in-visual-basic", "title": "How can I export usedrange of values without exporting formulas in Visual Basic Excel", "body": "<p>I have tried multiple variations, and keep getting the same result.  The most recent iteration is this:</p>\n\n<pre><code>Sub CopyToCSV()\n\n' Copy and Paste Active Sheet\nActiveSheet.Copy\nWith ActiveSheet.UsedRange\n    .Value = .Value\nEnd With\n\n 'The new workbook becomes Activeworkbook:\nWith ActiveWorkbook\n\n\n      'Saves the new workbook to given folder / filename:\n     .SaveAs Filename:= _\n     \"C:\\upload\\19meat-kl.csv\", _\n     FileFormat:=xlCSV, _\n     CreateBackup:=False\n      'Closes the file\n     .Close False\n  End With\nEnd Sub\n</code></pre>\n\n<p>My output keeps looking like this:</p>\n\n<pre><code>Store,Department,Date,Category,Item Count,Retail Price,Dollars,Reduced Retail,Total Loss,Reason for loss\n18,90,2017-04-04,Meat,2,3,6,1,4,Out of Date\n18,90,2017-04-04,Pork,2,1.5,3,0.99,1.02,Other\n,,,,,,,,,\n,,,,,,,,,\n,,,,,,,,,\n,,,,,,,,,\n,,,,,,,,,\n</code></pre>\n\n<p>The reason is that my Excel file contains some formulas like this:</p>\n\n<pre><code>=IF(D5&gt;0,TODAY(),\"\")\n</code></pre>\n\n<p>This auto fills some of the cells if they enter anything into certain cells. This causes Excel to think that the cells are \"used\" and includes them.  I attempted several variations of Worksheet.usedrange.values and I either get the same output or I get a debug prompt due to bad code.  How can I remove the commas from the output?</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 181, "user_id": 7807244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d14dd5e6b15054e64c5284dc06caaa?s=128&d=identicon&r=PG", "display_name": "Kade M.", "link": "https://stackoverflow.com/users/7807244/kade-m"}, "edited": false, "score": 0, "creation_date": 1491365170, "post_id": 43221591, "comment_id": 73513710, "body": "I don&#39;t see where you are passing the path and filename of the &quot;WorkFlowMaxFile&quot; document, being my first guess. Otherwise, could you share the errors you are receiving?"}, {"owner": {"reputation": 27, "user_id": 5964953, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154540909491521/picture?type=large", "display_name": "Andy Donaldson", "link": "https://stackoverflow.com/users/5964953/andy-donaldson"}, "reply_to_user": {"reputation": 181, "user_id": 7807244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d14dd5e6b15054e64c5284dc06caaa?s=128&d=identicon&r=PG", "display_name": "Kade M.", "link": "https://stackoverflow.com/users/7807244/kade-m"}, "edited": false, "score": 0, "creation_date": 1491365608, "post_id": 43221591, "comment_id": 73513834, "body": "is a named range in a front Control Worksheet in the weorkbook"}, {"owner": {"reputation": 27, "user_id": 5964953, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154540909491521/picture?type=large", "display_name": "Andy Donaldson", "link": "https://stackoverflow.com/users/5964953/andy-donaldson"}, "reply_to_user": {"reputation": 181, "user_id": 7807244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d14dd5e6b15054e64c5284dc06caaa?s=128&d=identicon&r=PG", "display_name": "Kade M.", "link": "https://stackoverflow.com/users/7807244/kade-m"}, "edited": false, "score": 0, "creation_date": 1491365723, "post_id": 43221591, "comment_id": 73513869, "body": "i want the routine to open that file (saved CSV file output) which it does and then copy and paste special values only into the same sheet that has the names range in at as above ..then shut the csv file"}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 7807244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d14dd5e6b15054e64c5284dc06caaa?s=128&d=identicon&r=PG", "display_name": "Kade M.", "link": "https://stackoverflow.com/users/7807244/kade-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1491366172, "last_edit_date": 1491366172, "creation_date": 1491365767, "answer_id": 43221708, "question_id": 43221591, "link": "https://stackoverflow.com/questions/43221591/i-am-trying-to-write-a-vba-routine-to-open-a-csv-file-copy-and-paste-values-into/43221708#43221708", "title": "I am trying to write a VBA routine to open a csv file copy and paste values into another workbook but seem to keep falling over", "body": "<p>This should do what you are asking after you set the provided variables to the appropriate values.</p>\n\n<pre><code>Sub GetWorkFlowMaxData()\n    Dim copyFrom, copyTo As Workbook\n    Dim copyFromPath, copyToPath As String\n    Dim copyFromSheet, copyToSheet As String\n    Dim copyFromRange, copyToRange As Range\n\n    Set copyFrom = Workbooks.Open(copyFromPath)\n    Set copyTo = Workbooks.Open(copyToPath)\n\n    copyFrom.Sheets(copyFromSheet).Range(copyFromRange).Copy\n    copyTo.Sheets(copyToSheet).Range(copyToRange).PasteSpecial\n    copyFrom.Close\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 5964953, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154540909491521/picture?type=large", "display_name": "Andy Donaldson", "link": "https://stackoverflow.com/users/5964953/andy-donaldson"}, "edited": false, "score": 0, "creation_date": 1491367438, "post_id": 43221719, "comment_id": 73514464, "body": "ta i will give that a crack txvm"}, {"owner": {"reputation": 27, "user_id": 5964953, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154540909491521/picture?type=large", "display_name": "Andy Donaldson", "link": "https://stackoverflow.com/users/5964953/andy-donaldson"}, "edited": false, "score": 0, "creation_date": 1491369712, "post_id": 43221719, "comment_id": 73515288, "body": "so we have 2 sheets here: the active workbook which has all sorts of sheets in it and one is called WFM_detail ....the CopyFromPath file is easy that would be the path specified as a named range in my front sheet...also CopyToPath..what about the CopyFromSheet and the copyFromRange..how will they work...eg the CSV output file i wish to copy eg for ydays data is called this but will change daily ...20170405-Time Report_All__Consu...and the CopyToSheet will be a sheet called &quot;WFM_Detail&quot; in the original sheet...the ranges will be InpDataSheet.Range(&quot;A1:G10000&quot;).Copy etc"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 27, "user_id": 5964953, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154540909491521/picture?type=large", "display_name": "Andy Donaldson", "link": "https://stackoverflow.com/users/5964953/andy-donaldson"}, "edited": false, "score": 0, "creation_date": 1491371824, "post_id": 43221719, "comment_id": 73516162, "body": "I have added the code in my solution, modify it as per your requirement."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1491371788, "last_edit_date": 1491371788, "creation_date": 1491365832, "answer_id": 43221719, "question_id": 43221591, "link": "https://stackoverflow.com/questions/43221591/i-am-trying-to-write-a-vba-routine-to-open-a-csv-file-copy-and-paste-values-into/43221719#43221719", "title": "I am trying to write a VBA routine to open a csv file copy and paste values into another workbook but seem to keep falling over", "body": "<p>Once you set the workbook and Sheet variables correctly in the code you can directly use them like below...</p>\n\n<pre><code>InpDataSheet.Range(\"A1:G10000\").Copy\n</code></pre>\n\n<p>Modify the following code as per your requirement...</p>\n\n<pre><code>Sub GetWorkFlowMaxData()\n    Dim wbDest As Workbook, wbSource As Workbook\n    Dim wsDest As Worksheet, wsSource As Worksheet\n    Dim WorkFlowMaxFileName As String\n    Dim vResponse As String\n\n    Application.ScreenUpdating = False\n\n    vResponse = MsgBox(\"This action can not be undone. Are you sure you want to clear Historic WorkFlowMax Data ?\", vbYesNo, \"Clear Data?\")\n\n    If vResponse = vbNo Then Exit Sub\n\n    Set wbDest = ThisWorkbook\n    Set wsDest = wbDest.Sheets(\"WFM_Detail\")\n\n    WorkFlowMaxFileName = Range(\"WorkFlowMaxFile\").Value\n\n    wsDest.Range(\"A1\").ClearContents\n\n    Workbooks.Open Filename:=WorkFlowMaxFileName\n    Set wbSource = ActiveWorkbook\n    Set wsSource = ActiveSheet\n\n    wsSource.Range(\"A1\").CurrentRegion.Copy wsDest.Range(\"A1\")\n\n    wbSource.Close False\n    Application.ScreenUpdating = ture\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5964953, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154540909491521/picture?type=large", "display_name": "Andy Donaldson", "link": "https://stackoverflow.com/users/5964953/andy-donaldson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 43221719, "answer_count": 2, "score": 2, "last_activity_date": 1491371788, "creation_date": 1491365034, "last_edit_date": 1491367931, "question_id": 43221591, "link": "https://stackoverflow.com/questions/43221591/i-am-trying-to-write-a-vba-routine-to-open-a-csv-file-copy-and-paste-values-into", "title": "I am trying to write a VBA routine to open a csv file copy and paste values into another workbook but seem to keep falling over", "body": "<p>I am trying to write a VBA routine to open a <code>csv</code> file  copy and paste values into another workbook but seem to keep falling over</p>\n\n<pre><code>Sub GetWorkFlowMaxData()\n\n Dim DataSheet As Object\n Dim InpDataBook As Object\n Dim InpDataSheet As Object\n Dim WorkFlowMaxFileName As String\n Dim vResponse As Variant\n Dim sCurrSheet As String\n Dim main As String\n\n\nApplication.ScreenUpdating = False\nsCurrSheet = ActiveSheet.Name\n\nActiveSheet.Calculate\n\n\n\n\nvResponse = MsgBox(\"This action can not be undone. Are you sure you want to clear Historic WorkFlowMax Data ?\", vbYesNo, \"Clear Data\")\n\nIf vResponse = vbYes Then\n\nmain = ActiveWorkbook.Name\n\nWorkbooks(main).Sheets(\"WFM_Detail\").Range(\"A1:G10000\").ClearContents\n\n\n\n\n        WorkFlowMaxFileName = Range(\"WorkFlowMaxFile\")\n\n\n\n            Workbooks.Open Filename:=WorkFlowMaxFileName\n\n            Set InpDataBook = ActiveWorkbook\n            Set InpDataSheet = ActiveSheet\n            InpDataBook.Activate\n\n'            other = ActiveWorkbook.Name\n'            Workbooks(InpDataBook).Sheets(\"InpDataSheet\").Range(\"A1:G10000\").Copy\n\n\n'            ActiveWorkbook.Close SaveChanges:=False\n       End If\n\n\n' Application.Calculate\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1491383572, "post_id": 43221589, "comment_id": 73523471, "body": "The FormField&#39;s range has the colour you give it. If you want another colour you must be outside its range or you should find an event that triggers code that changes the colour. Content controls offer such an event. Try ActiveDocument.ContentControls.Add wdContentControlRichText, Selection.Range and the Document_ContentControlOnEnter event."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1491383801, "post_id": 43221589, "comment_id": 73523651, "body": "Here is another solution, probably exactly what you need. I have it at the top of the right column, next to your question. <a href=\"http://stackoverflow.com/questions/1043307/word-vba-if-cursor-is-in-cell-bookmark-run-code?rq=1\" title=\"word vba if cursor is in cell bookmark run code\">stackoverflow.com/questions/1043307/&hellip;</a>"}, {"owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1491437279, "post_id": 43221589, "comment_id": 73557124, "body": "1. If &quot;ContentControl&quot; is the new way of doing fields, then I can&#39;t use it for legacy reasons. 2. I don&#39;t understand how that&#39;s applicable."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1491446559, "post_id": 43221589, "comment_id": 73559411, "body": "It&#39;s applicable because you need an &quot;event&quot; to do what you want, like &quot;run this code when I click this place&quot;. I believe content controls were introduced in 2007, maybe 2010. If your legacy has to go back further the application event described in the link I posted can do the job. An application event must be programmed more precisely than one that affects a single document only, but with its help the range&#39;s colour can be changed to wdAuto when you click in your form field."}], "owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491365018, "creation_date": 1491365018, "question_id": 43221589, "link": "https://stackoverflow.com/questions/43221589/move-cursor-before-formatting-in-word-programmatically", "title": "Move cursor before formatting in word, programmatically", "body": "<p>In a macro, I'm using </p>\n\n<pre><code>x.Range.HighlightColorIndex = wdBrightGreen\n</code></pre>\n\n<p>in order to highlight the current formfield that a userform is editing, because the default selection doesn't show up well.</p>\n\n<p>if I use <code>Application.Selection.StartOf</code> then the cursor returns to before the formfield which is what I want.</p>\n\n<p>However the styling gets applied to any text that gets typed.</p>\n\n<p>Is there a way to set the cursor to \"before\" the styling, so any text entered would be before the style marker? Or do I need to make assumptions on the current text style and set the text at that position to <code>wdAuto</code>?</p>\n\n<p>I.E. if this was pseudo HTML(xml) I want</p>\n\n<pre><code>&lt;div&gt;XXXX&lt;span color=green&gt;&lt;Input id=blah&gt;&lt;/input&gt;&lt;/span&gt;&lt;/div&gt;\n</code></pre>\n\n<p>as opposed to</p>\n\n<pre><code>&lt;div&gt;&lt;span color=green&gt;XXXX&lt;Input id=blah&gt;&lt;/input&gt;&lt;/span&gt;&lt;/div&gt;\n</code></pre>\n\n<p>Where XXXX is the cursor position.</p>\n\n<pre><code>'Remember the last formatted field on select, lets us fix it when the userform is closed.\nDim prevField As formField\n\nFunction SelectField(ByVal neww As formField)\nIf Not prevField Is Nothing Then\n    prevField.Range.HighlightColorIndex = wdAuto\nEnd If\nneww.Range.HighlightColorIndex = wdBrightGreen\nneww.Select\nApplication.Selection.StartOf\nApplication.Selection.Range.HighlightColorIndex = wdAuto\nSet prevField = neww\nEnd Function\n</code></pre>\n\n<p>This example doesn't work. it still has any written text as green.</p>\n"}, {"tags": ["excel", "add-in", "excel-addins", "vba"], "comments": [{"owner": {"reputation": 181, "user_id": 7807244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d14dd5e6b15054e64c5284dc06caaa?s=128&d=identicon&r=PG", "display_name": "Kade M.", "link": "https://stackoverflow.com/users/7807244/kade-m"}, "edited": false, "score": 0, "creation_date": 1491365037, "post_id": 43221545, "comment_id": 73513678, "body": "If the excel file is created on demand when the user opens the lecture, couldn&#39;t you pass the id through in a cell reference on a sheet? Another option I&#39;d consider would be a RESTful method in the add-in to request the lecture content based upon the generated excel file."}, {"owner": {"reputation": 31, "user_id": 1098352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25cffba4762919b94c4ae8a028b89dc0?s=128&d=identicon&r=PG", "display_name": "nhanpv", "link": "https://stackoverflow.com/users/1098352/nhanpv"}, "reply_to_user": {"reputation": 181, "user_id": 7807244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d14dd5e6b15054e64c5284dc06caaa?s=128&d=identicon&r=PG", "display_name": "Kade M.", "link": "https://stackoverflow.com/users/7807244/kade-m"}, "edited": false, "score": 0, "creation_date": 1491496016, "post_id": 43221545, "comment_id": 73590234, "body": "Thanks Kade M, your idea is great! I am going to set name file excel contain id of lecture"}], "owner": {"reputation": 31, "user_id": 1098352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25cffba4762919b94c4ae8a028b89dc0?s=128&d=identicon&r=PG", "display_name": "nhanpv", "link": "https://stackoverflow.com/users/1098352/nhanpv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491364727, "creation_date": 1491364727, "last_edit_date": 1531161705, "question_id": 43221545, "link": "https://stackoverflow.com/questions/43221545/how-to-pass-param-from-my-website-file-excel-online-office-add-in", "title": "How to pass param from my website -&gt; file excel online -&gt; office add in", "body": "<p>I'm building an office add-in that helps people learn excel by interacting directly with excel files online. User will access the courses on my website, each course has about 20 - 50 lectures in it.</p>\n\n<p>When a user clicks on a lecture, an excel file is created and a pre-installed add-in is created, in which anyone can edit it without signing in. Lecture will open that excel file, addin will then connect to the website to get information about the lecture.</p>\n\n<p>The problem is, I do not know how to pass id lecture from my website -> excel file -> add in</p>\n\n<p>I have reference through some functions like \"Office.context.document.url\", but still have not found the answer. May everyone help, solve this problem.</p>\n"}, {"tags": ["vba", "excel", "find", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "edited": false, "score": 0, "creation_date": 1491365477, "post_id": 43221635, "comment_id": 73513787, "body": "Hi, I understand this, but i need to do it in vba code not excel thus why i am struggling."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "edited": false, "score": 0, "creation_date": 1491365661, "post_id": 43221635, "comment_id": 73513850, "body": "Do you have a starting code or share whatever you have tried so far? If yes, what issues you are having with it?"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "edited": false, "score": 0, "creation_date": 1491367167, "post_id": 43221635, "comment_id": 73514372, "body": "I have added a code in my solution, see if that does what you are trying to achieve."}, {"owner": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "edited": false, "score": 0, "creation_date": 1491371572, "post_id": 43221635, "comment_id": 73516059, "body": "@sktnerr thank you, work perfectly.And again thanks alot now i understand"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "edited": false, "score": 0, "creation_date": 1491371917, "post_id": 43221635, "comment_id": 73516210, "body": "You&#39;re welcome Panscer! Glad it worked. Also don&#39;t forget to upvote the solution. :)"}, {"owner": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "edited": false, "score": 0, "creation_date": 1491372716, "post_id": 43221635, "comment_id": 73516573, "body": "Ya sure, but it says lesser than 15 reputation won&#39;t work :&#39;(, but yes thanks a lot really helped."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 1, "last_activity_date": 1491367121, "last_edit_date": 1491367121, "creation_date": 1491365317, "answer_id": 43221635, "question_id": 43221414, "link": "https://stackoverflow.com/questions/43221414/vlookup-to-compare-data-in-2-different-workbooks-with-vba/43221635#43221635", "title": "VLOOKUP to compare data in 2 different workbooks with VBA", "body": "<p>You may try this..</p>\n\n<p>Assuming the name of your second workbook is Book2.xlsx, then try this...</p>\n\n<p>On First workbook\nIn C2</p>\n\n<pre><code>=IF(ISNUMBER(MATCH(B2,'[Book2.xlsx]Data'!$D:$D,0)),\"OK\",\"\")\n</code></pre>\n\n<p>and copy it down.</p>\n\n<p>If you require a VBA solution, one approach to get the desired output is as below...\nThe following code assumes that both the Book1.xlsm (which will contain the below code) and Book2.xlsx are saved in the same folder.\nIf they are saved at different location, change the path and name of Book2.xlsx in the following lines of code.</p>\n\n<pre><code>sourceFilePath = dwb.Path &amp; \"\\\"\nsourceFileName = \"Book2.xlsx\"\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>Sub CompareData()\nDim swb As Workbook, dwb As Workbook\nDim sws As Worksheet, dws As Worksheet\nDim slr As Long, dlr As Long, i As Long\nDim sourceFilePath As String, sourceFileName As String\nDim x, y, z, dict\nApplication.ScreenUpdating = False\n\nSet dwb = ThisWorkbook\nSet dws = dwb.Sheets(\"Items\")\ndlr = dws.Cells(Rows.Count, 2).End(xlUp).Row\nx = dws.Range(\"B2:B\" &amp; dlr).Value\nReDim z(1 To dlr)\nsourceFilePath = dwb.Path &amp; \"\\\"\nsourceFileName = \"Book2.xlsx\"\n\nWorkbooks.Open sourceFilePath &amp; sourceFileName\n\nSet swb = ActiveWorkbook\nSet sws = swb.Sheets(\"Data\")\nslr = sws.Cells(Rows.Count, 4).End(xlUp).Row\ny = sws.Range(\"D2:D\" &amp; slr).Value\n\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nFor i = 1 To UBound(y, 1)\n    dict.Item(y(i, 1)) = \"\"\nNext i\nswb.Close False\n\nFor i = 1 To UBound(x, 1)\n    If dict.exists(x(i, 1)) Then\n        z(i) = \"OK\"\n    Else\n        z(i) = \"\"\n    End If\nNext i\ndws.Range(\"C2\").Resize(UBound(x, 1), 1).Value = Application.Transpose(z)\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7817933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fKflEHpnYrA/AAAAAAAAAAI/AAAAAAAAADI/y2DTAlT8-is/photo.jpg?sz=128", "display_name": "panscer hampi", "link": "https://stackoverflow.com/users/7817933/panscer-hampi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1138, "favorite_count": 2, "accepted_answer_id": 43221635, "answer_count": 1, "score": -1, "last_activity_date": 1491367121, "creation_date": 1491363728, "last_edit_date": 1491364295, "question_id": 43221414, "link": "https://stackoverflow.com/questions/43221414/vlookup-to-compare-data-in-2-different-workbooks-with-vba", "title": "VLOOKUP to compare data in 2 different workbooks with VBA", "body": "<p>I am somewhat new to VBA/Excel, so I was wondering if someone would help me out.</p>\n\n<p>My question:<br>\nI have two different workbooks but in these workbooks two of the columns have common data. Thus I wanted to use <code>VLOOKUP</code> to compare the two columns and see if there are common data.</p>\n\n<p>Details:<br>\n1st workbook : has 3 different sheets, I only need to use the sheet \"Items\" which has the data in column 2.</p>\n\n<p>2nd workbook: has only 1 sheet called \"Data\" and has data in column 4.</p>\n\n<p>Thus my goal is to compare the 2 columns. In workbook1 there is an empty column next to the data column so, if there is a match I want to say \"ok\" in it. If no match then \"\".</p>\n\n<p>I tried <code>VLOOKUP</code> but really could not understand it.  Plus this is for work.</p>\n"}, {"tags": ["vba", "excel", "windows-media-player", "wmp"], "answers": [{"tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": true, "score": 0, "last_activity_date": 1491735687, "creation_date": 1491735687, "answer_id": 43305945, "question_id": 43221261, "link": "https://stackoverflow.com/questions/43221261/how-to-display-windows-media-player-closed-captions-on-vba-userform/43305945#43305945", "title": "How to display windows media player closed captions on VBA userform", "body": "<p>Didn't find a solution that works for me, but eventually I went for the sanity check.  </p>\n\n<p>Tested WMP in full screen mode and still was unable to play the subtitle file at all; I should have done that before posting.  Apparently this is something to do with the video format being mp4...  </p>\n\n<p>The real sanity check was switching to VLC and subtitles displayed no problem, so not a problem with the smi file - but also not a solution for me.</p>\n\n<p>If you stumbled across this and want subtitles, a solution appears to be downloading a special set of [non-MS] codecs that do allow WMP to display subtitles, but I've not tried this as it is also not a viable solution for me.  </p>\n\n<p>How MS missed this is beyond me - seems so basic, so trivial but there you have it.</p>\n"}], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 43305945, "answer_count": 1, "score": 1, "last_activity_date": 1491735687, "creation_date": 1491362720, "last_edit_date": 1531164843, "question_id": 43221261, "link": "https://stackoverflow.com/questions/43221261/how-to-display-windows-media-player-closed-captions-on-vba-userform", "title": "How to display windows media player closed captions on VBA userform", "body": "<p>I have embedded a windows media player control onto a VBA userform as an active X control. I can control the video (start, stop, pause etc.) but am unable to display closed captions / subtitles.</p>\n\n<p>It looks like I have to use smi / sami files, however I am unable to get that working...  MS documentation seems lacking, more focused on webpages  :-( </p>\n\n<p>The following are the 4 (required?) elements for provided by intellisense, all are strings:</p>\n\n<pre><code>me.WindowsMediaPlayer1.closedCaption.captioningId\nme.WindowsMediaPlayer1.closedCaption.SAMIFileName = path &amp; \"cut.smi\" ' Got this one\nme.WindowsMediaPlayer1.closedCaption.SAMILang\nme.WindowsMediaPlayer1.closedCaption.SAMIStyle\n</code></pre>\n\n<p>So given the following SAMI file, how should I configure WMP so closed captions will display?</p>\n\n<pre><code>&lt;SAMI&gt;\n\n&lt;HEAD&gt;\n&lt;TITLE&gt;SAMI Example&lt;/TITLE&gt;\n\n&lt;SAMIParam&gt;\n  Media {cut.mp4}\n  Metrics {time:ms;}\n  Spec {MSFT:1.0;}\n&lt;/SAMIParam&gt;\n\n&lt;STYLE TYPE=\"text/css\"&gt;\n&lt;!--\n  P { font-family: Arial; font-weight: normal; color: white; background-color: black; text-align: center; }\n\n  #Source {color: red; background-color: blue; font-family: Courier; font-size: 12pt; font-weight: normal; text-align: left; }\n\n  .ENUSCC { name: English; lang: en-US ; SAMIType: CC ; }\n  .FRFRCC { name: French;  lang: fr-FR ; SAMIType: CC ; }\n--&gt;\n&lt;/STYLE&gt;\n\n&lt;/HEAD&gt;\n\n&lt;BODY&gt;\n\n&lt;!-- Open play menu, choose Captions and Subtiles, On if available --&gt;\n&lt;!-- Open tools menu, Security, Show local captions when present --&gt;\n\n&lt;SYNC Start=0&gt;\n  &lt;P Class=ENUSCC ID=Source&gt;The Speaker&lt;/P&gt;\n  &lt;P Class=ENUSCC&gt;SAMI 0000 text&lt;/P&gt;\n\n  &lt;P Class=FRFRCC ID=Source&gt;French The Speaker&lt;/P&gt;\n  &lt;P Class=FRFRCC&gt;French SAMI 0000 text&lt;/P&gt;\n&lt;/SYNC&gt;\n\n&lt;SYNC Start=1000&gt;\n  &lt;P Class=ENUSCC&gt;SAMI 1000 text&lt;/P&gt;\n  &lt;P Class=FRFRCC&gt;French SAMI 1000 text&lt;/P&gt;\n&lt;/SYNC&gt;\n\n&lt;SYNC Start=2000&gt;\n  &lt;P Class=ENUSCC&gt;SAMI 2000 text&lt;/P&gt;\n  &lt;P Class=FRFRCC&gt;French SAMI 2000 text&lt;/P&gt;\n&lt;/SYNC&gt;\n\n&lt;SYNC Start=3000&gt;\n  &lt;P Class=ENUSCC&gt;SAMI 3000 text&lt;/P&gt;\n  &lt;P Class=FRFRCC&gt;French SAMI 3000 text&lt;/P&gt;\n&lt;/SYNC&gt;\n\n&lt;/BODY&gt;\n&lt;/SAMI&gt;\n</code></pre>\n\n<p>Help much appreciated, thanks.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1506018665, "last_edit_date": 1506018665, "creation_date": 1491361686, "answer_id": 43221091, "question_id": 43220822, "link": "https://stackoverflow.com/questions/43220822/how-to-insert-new-row-in-excel-if-found-specific-letter/43221091#43221091", "title": "How to insert new row in Excel if found specific letter", "body": "<p>This should do it, See example below</p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim i&amp;\n\n    With ThisWorkbook.Worksheets(\"Sheet2\")\n        For i = Cells(Rows.Count, [\"A\"]).End(xlUp).Row To 2 Step -1\n            If Cells(i - 1, [\"A\"]) &lt;&gt; Cells(i, [\"A\"]) Then Rows(i).Insert\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><em>To add 2 or more rows use Rows(i).Resize(2).Insert</em></p>\n\n<hr>\n\n<p>Helpful links</p>\n\n<p><em><a href=\"http://blog.excelhero.com/2010/06/05/when_working_in_vba_we/\" rel=\"nofollow noreferrer\">Excel VBA Shortcut Range References</a></em></p>\n\n<p><em><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193274.aspx\" rel=\"nofollow noreferrer\">Range.Resize Property (Excel)</a></em></p>\n\n<hr>\n\n<blockquote>\n  <p><sub><em><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193274.aspx\" rel=\"nofollow noreferrer\">Range.Resize Property (Excel)</a> Resizes the specified range. Returns a Range object that represents the resized range.</em></sub></p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7817650"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 43221091, "answer_count": 1, "score": 2, "last_activity_date": 1506018665, "creation_date": 1491359510, "last_edit_date": 1491359986, "question_id": 43220822, "link": "https://stackoverflow.com/questions/43220822/how-to-insert-new-row-in-excel-if-found-specific-letter", "title": "How to insert new row in Excel if found specific letter", "body": "<p>I am fairly new to Excel especially in macro vba and I am trying to setup a macro that adds a row above a specific point of the worksheet. </p>\n\n<p>The other example show in loop method which doesn't what i want. I want to inserting new row above a first specific letter but not repetitive. i will show you the example.</p>\n\n<p><a href=\"https://i.stack.imgur.com/fh8Ad.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/yvxb1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yvxb1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is this possible? How?</p>\n\n<p>Thanks for all the possible help.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "is_accepted": true, "score": 0, "last_activity_date": 1491359538, "creation_date": 1491359538, "answer_id": 43220825, "question_id": 43220786, "link": "https://stackoverflow.com/questions/43220786/how-can-i-compare-2-formfields-for-referential-equality-in-vba-word/43220825#43220825", "title": "How can I compare 2 FormFields for referential equality in vba word?", "body": "<p>This is my hacky solution. I will award a better solution with the answer.</p>\n\n<pre><code>Function addFields(field As formField)\n    Dim orig As String\n    Dim detect As String\n    orig = field.Result\n    field.Result = Rnd(100000)\n    Set oApp = GetObject(, \"Word.Application\")\n    oApp.Visible = True\n    Set oDoc = oApp.ActiveDocument\n    Dim dFormField As formField\n    Dim i As Integer\n    For i = 1 To oDoc.FormFields().Count\n        Set dFormField = oDoc.FormFields(i)\n        If (dFormField.Result = field.Result) Then\n            field.Result = orig\n            Set Item = NavigatorForm.LBFields.ListItems.Add(i, , i)\n            Set Item.tag = dFormField\n            Exit For\n        End If\n    Next\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3645, "user_id": 306036, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4c1dfd4d4e83c6cdec5ea7045b32bc05?s=128&d=identicon&r=PG", "display_name": "Ryan The Leach", "link": "https://stackoverflow.com/users/306036/ryan-the-leach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 43220825, "answer_count": 1, "score": 2, "last_activity_date": 1491359538, "creation_date": 1491359246, "question_id": 43220786, "link": "https://stackoverflow.com/questions/43220786/how-can-i-compare-2-formfields-for-referential-equality-in-vba-word", "title": "How can I compare 2 FormFields for referential equality in vba word?", "body": "<p>I have a ListView that represents all FormFields in a word document, like a table of contents.</p>\n\n<pre><code>Function addFields(field As formField)\n    Set oApp = GetObject(, \"Word.Application\")\n    oApp.Visible = True\n    Set oDoc = oApp.ActiveDocument\n    Dim dFormField As formField\n    Dim i As Integer\n    For i = 1 To oDoc.FormFields().Count\n        Set dFormField = oDoc.FormFields(i)\n        If (dFormField Is field) Then\n            Set Item = NavigatorForm.LBFields.ListItems.Add(i, , i)\n            Set Item.tag = dFormField\n            Exit For\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>How can I compare whether the FormField I'm adding, is at a certain index in the object model, and insert it in the correct place in the list?</p>\n\n<pre><code>            If (dFormField Is field) Then\n</code></pre>\n\n<p>Is how you compare object referential equality in vba, but it appears the DOM is creating a new formfield object each time. So either I've made an error, or I need some other method of determining whether they are the same formfield piece.</p>\n\n<p>I would use the auto generated bookmark text, but it can't be relied upon to not have empty text or duplicates due to copy and paste, which doesn't update the bookmark names.</p>\n"}, {"tags": ["ms-access", "combobox", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 887, "user_id": 2129763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/S70HV.jpg?s=128&g=1", "display_name": "Eric Anthony", "link": "https://stackoverflow.com/users/2129763/eric-anthony"}, "edited": false, "score": 0, "creation_date": 1491505121, "post_id": 43220213, "comment_id": 73595632, "body": "It DOES work intuitively like I said, and also like the answer provided. Somewhere deep down in my form there&#39;s a setting checked that keeps bugging out. I couldn&#39;t find it, replicated a whole new form and it works like it&#39;s supposed to."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1491361790, "last_edit_date": 1491361790, "creation_date": 1491360654, "answer_id": 43220950, "question_id": 43220213, "link": "https://stackoverflow.com/questions/43220213/why-cant-i-specify-criteria-for-a-conditional-query-as-a-form-component/43220950#43220950", "title": "Why can&#39;t I specify criteria for a conditional query as a form component?", "body": "<p>Assuming the controls are on same form, don't need to reference the Forms collection and form name. In ComboB RowSource:<br>\n<code>SELECT [City] FROM [Cities] WHERE [State]=[ComboA];</code></p>\n\n<p>I recommend the requery code be in ComboB GotFocus event.</p>\n\n<p>Be aware cascading comboboxes don't work nice with continuous or datasheet form if ComboB RowSource includes lookup alias.</p>\n"}], "owner": {"reputation": 887, "user_id": 2129763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/S70HV.jpg?s=128&g=1", "display_name": "Eric Anthony", "link": "https://stackoverflow.com/users/2129763/eric-anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 43220950, "answer_count": 1, "score": 1, "last_activity_date": 1491361790, "creation_date": 1491354772, "question_id": 43220213, "link": "https://stackoverflow.com/questions/43220213/why-cant-i-specify-criteria-for-a-conditional-query-as-a-form-component", "title": "Why can&#39;t I specify criteria for a conditional query as a form component?", "body": "<p>I have two drop downs, Combo_A and Combo_B.\nI'm attempting to achieve a \"cascading combo box\" or \"synchronous combo box\" where a selection from Combo A (say, a US State) would populate Combo B (say a particular list of cities which belong to said state).</p>\n\n<p>I understand using the VBA code to do this, and the reason you'd prefer to use VBA, but my question is WHY must I use VBA.</p>\n\n<p>Simply making a conditional query with criteria of:</p>\n\n<blockquote>\n  <p>[Forms]![Main_Form]![State_Dropdown]</p>\n</blockquote>\n\n<p>Doesn't seem to work.\nThere IS a requery (of the City_Dropdown) performed AfterUpdate (of the State_Dropdown).\nThen I'm asked to provide the values for </p>\n\n<blockquote>\n  <p><code>Form!Main_Form!State_Dropdown</code></p>\n</blockquote>\n\n<p>...after manipulating the State_Dropdown.</p>\n\n<p>Why doesn't this work intuitively?\nSecurity?\nFunction?</p>\n"}]