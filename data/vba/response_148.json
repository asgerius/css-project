[{"tags": ["vba", "ms-publisher"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510183787, "post_id": 47191403, "comment_id": 81332360, "body": "Are you using Publisher 2010?"}, {"owner": {"reputation": 225, "user_id": 800322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/83c6073eb13af141eda5de9af0ce8800?s=128&d=identicon&r=PG", "display_name": "Mickey D", "link": "https://stackoverflow.com/users/800322/mickey-d"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510186472, "post_id": 47191403, "comment_id": 81333088, "body": "Publisher 2013. But I have a newer version at work."}, {"owner": {"reputation": 225, "user_id": 800322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/83c6073eb13af141eda5de9af0ce8800?s=128&d=identicon&r=PG", "display_name": "Mickey D", "link": "https://stackoverflow.com/users/800322/mickey-d"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510188726, "post_id": 47191403, "comment_id": 81333693, "body": "Tried it earlier in 2016 and still the same problem. Nothing happens when I run the code. it just displays the dialog box with no height adjustment."}], "owner": {"reputation": 225, "user_id": 800322, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/83c6073eb13af141eda5de9af0ce8800?s=128&d=identicon&r=PG", "display_name": "Mickey D", "link": "https://stackoverflow.com/users/800322/mickey-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573384287, "creation_date": 1510183325, "question_id": 47191403, "link": "https://stackoverflow.com/questions/47191403/how-to-enable-grow-text-box-to-fit-in-ms-publisher-using-vba", "title": "How to enable Grow Text Box To Fit in MS Publisher using VBA", "body": "<p>Hi MS Publisher VBA programmers :-)</p>\n\n<p>What seems so simple is actually not documented.\nAll I need to do is be able to insert text programmatically into a text box then have the text resize vertically expanding itself as I add more text.</p>\n\n<p>This works fine if I do it manually by inserting TextBox and choosing the \"Grow Text Box To Fit\" option in the Text Fit drop-down in the Format tab of the TextBox.</p>\n\n<p>This code doesn't work:</p>\n\n<pre><code>Sub myGrowToFit()\n        Set myTextBox = ActiveDocument.Pages(1).Shapes.AddTextbox _\n             (Orientation:=pbTextOrientationHorizontal, _\n             Left:=0, Top:=0, _\n             Width:=100, Height:=40)\n        myTextBox.TextFrame.TextRange.text = \"Line1\" &amp; vbLf &amp; \"Line2\" &amp; vbLf &amp; \"Line3\" &amp; vbLf &amp; \"Line4\"\n        myTextBox.TextFrame.AutoFitText = pbTextAutoFitGrowToFit\n        MsgBox (\"Press OK to Continue After You View The Result\")\n        myTextBox.Delete\nEnd Sub\n</code></pre>\n\n<p>Any ideas? Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510183531, "post_id": 47191374, "comment_id": 81332288, "body": "<a href=\"https://support.microsoft.com/en-us/help/142126/macro-to-loop-through-all-worksheets-in-a-workbook\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/142126/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 8363960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e0bc97348f4f7328d244de065bf2f2?s=128&d=identicon&r=PG&f=1", "display_name": "B Sumner", "link": "https://stackoverflow.com/users/8363960/b-sumner"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510184186, "post_id": 47191374, "comment_id": 81332462, "body": "I didn&#39;t want to go through all the worksheets.  I had found that but it didn&#39;t work for what I needed.  Thanks though."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8363960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e0bc97348f4f7328d244de065bf2f2?s=128&d=identicon&r=PG&f=1", "display_name": "B Sumner", "link": "https://stackoverflow.com/users/8363960/b-sumner"}, "edited": false, "score": 0, "creation_date": 1510184219, "post_id": 47191468, "comment_id": 81332474, "body": "This looks like it will do exactly what I need.  I will try it out and let you know.  Thanks."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1, "user_id": 8363960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e0bc97348f4f7328d244de065bf2f2?s=128&d=identicon&r=PG&f=1", "display_name": "B Sumner", "link": "https://stackoverflow.com/users/8363960/b-sumner"}, "edited": false, "score": 0, "creation_date": 1510184328, "post_id": 47191468, "comment_id": 81332510, "body": "@BSumner - Do you have a bunch of other sheets in there? If you have say 3 sheets (or any number <i>less</i> than the amount in that array), you can do another way...<code>For each ws in ThisWorkbook.Worksheets &#47;&#47; if ws.Name &lt;&gt; &quot;999&quot; and ws.Name &lt;&gt; &quot;000&quot; Then ...</code>."}, {"owner": {"reputation": 1, "user_id": 8363960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e0bc97348f4f7328d244de065bf2f2?s=128&d=identicon&r=PG&f=1", "display_name": "B Sumner", "link": "https://stackoverflow.com/users/8363960/b-sumner"}, "edited": false, "score": 0, "creation_date": 1510185037, "post_id": 47191468, "comment_id": 81332697, "body": "That worked so much faster than I expected.  Thanks so much."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1, "user_id": 8363960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e0bc97348f4f7328d244de065bf2f2?s=128&d=identicon&r=PG&f=1", "display_name": "B Sumner", "link": "https://stackoverflow.com/users/8363960/b-sumner"}, "edited": false, "score": 0, "creation_date": 1510201618, "post_id": 47191468, "comment_id": 81336822, "body": "(@BSumner - You&#39;re very welcome! If it worked for you, you can mark it as the answer by clicking the check mark left of the post, below the up/down arrows)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1510183674, "creation_date": 1510183674, "answer_id": 47191468, "question_id": 47191374, "link": "https://stackoverflow.com/questions/47191374/how-to-cycle-through-many-worksheets/47191468#47191468", "title": "How to cycle through many worksheets", "body": "<p>Instead of declaring all of those as worksheets, an option would be to load them into an array, then loop through the array.</p>\n\n<p>This isn't exactly your macro, but it shows how you can use a loop through an array to do what you're looking for:</p>\n\n<pre><code>Sub Journal()\nDim wsArray() As Variant\nDim k As Long, i As Long\nDim rw As Range, ColL As Range\nDim TempCel As Range\nDim wsLoc   As Worksheet: Set wsLoc = ThisWorkbook.Sheets(\"Locker JE\")\nDim wsCof   As Worksheet: Set wsCof = ThisWorkbook.Sheets(\"Coffee JE\")\n\nwsArray = Array(\"120\", \"121\", \"122\", \"123\", \"124\", \"125\", \"126\", \"127\", \"128\", \"220\", \"221\", \"402\", \"403\", \"Locker JE\", \"Coffee JE\")\nSet ColL = wsLoc.Cells(4, \"O\")\nSet ColC = wsCof.Cells(4, \"O\")\n\nFor k = LBound(wsArray) To UBound(wsArray)\n    With ThisWorkbook.Worksheets(wsArray(k))\n        ' Do things with the worksheet.\n        For i = 4 To 41\n            Set rw = .Rows(i)\n            Set TempCel = rw.Cells(31)\n            Select Case TempCel.Value\n                Case \"\"\n                     ' Do something...\n                Case Else\n                    CopyLocker rw, ColL\n            End Select\n        Next i\n    End With\nNext k\nEnd Sub\n</code></pre>\n\n<p>Note: This all assumed that you have other worksheets in the workbook you <em>don't</em> want this run on.  Otherwise, you can just do <code>For each ws in ActiveWorkbook.Worksheets</code> and skip the whole array thing.</p>\n"}], "owner": {"reputation": 1, "user_id": 8363960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e0bc97348f4f7328d244de065bf2f2?s=128&d=identicon&r=PG&f=1", "display_name": "B Sumner", "link": "https://stackoverflow.com/users/8363960/b-sumner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510183674, "creation_date": 1510183129, "question_id": 47191374, "link": "https://stackoverflow.com/questions/47191374/how-to-cycle-through-many-worksheets", "title": "How to cycle through many worksheets", "body": "<p>I have the following code.</p>\n\n<pre><code>Sub Journal()\n    Dim ColL As Range, ColC  As Range\n    Dim ws120 As Worksheet: Set ws120 = ThisWorkbook.Sheets(\"120\")\n    Dim ws121 As Worksheet: Set ws121 = ThisWorkbook.Sheets(\"121\")\n    Dim ws122 As Worksheet: Set ws122 = ThisWorkbook.Sheets(\"122\")\n    Dim ws123 As Worksheet: Set ws123 = ThisWorkbook.Sheets(\"123\")\n    Dim ws124 As Worksheet: Set ws124 = ThisWorkbook.Sheets(\"124\")\n    Dim ws125 As Worksheet: Set ws125 = ThisWorkbook.Sheets(\"125\")\n    Dim ws126 As Worksheet: Set ws126 = ThisWorkbook.Sheets(\"126\")\n    Dim ws127 As Worksheet: Set ws127 = ThisWorkbook.Sheets(\"127\")\n    Dim ws128 As Worksheet: Set ws128 = ThisWorkbook.Sheets(\"128\")\n    Dim ws220 As Worksheet: Set ws220 = ThisWorkbook.Sheets(\"220\")\n    Dim ws221 As Worksheet: Set ws221 = ThisWorkbook.Sheets(\"221\")\n    Dim ws402 As Worksheet: Set ws402 = ThisWorkbook.Sheets(\"402\")\n    Dim ws403 As Worksheet: Set ws403 = ThisWorkbook.Sheets(\"403\")\n    Dim wsLoc As Worksheet: Set wsLoc = ThisWorkbook.Sheets(\"Locker JE\")\n    Dim wsCof As Worksheet: Set wsCof = ThisWorkbook.Sheets(\"Coffee JE\")\n    Dim Eval, rw As Range\n    Dim i As Long '&lt;&lt; use long in place on Integer\n\n    With wsLoc\n        Set ColL = .Cells(4, \"O\")\n    End With\n    With wsCof\n        Set ColC = .Cells(4, \"O\")\n    End With\n\n    For i = 4 To 41\n        Set rw = ws120.Rows(i)\n        Temp = rw.Cells(31).Value\n        Select Case rw.Cells(31).Value\n            Case \"\"\n            Case Else\n                CopyLocker rw, ColL\n        End Select\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I am wanting to do the same thing in the for next loop for each of the defined worksheets.  Is this possible with a variable of some sort?  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510184718, "post_id": 47191274, "comment_id": 81332617, "body": "I&#39;ll give you my vote, not because of the indentation, but because you gave the &quot;short&quot; answer too. :D"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510184958, "post_id": 47191274, "comment_id": 81332674, "body": "BTW - Looking at your profile I guess you must be nearly my vintage - I started using a Trash-80 about a year after I started programming at work."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510186602, "post_id": 47191274, "comment_id": 81333130, "body": "I was 9 at the time :D"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510187068, "post_id": 47191274, "comment_id": 81333260, "body": "9 when the TRS80 came out?  That means I have a decade on you then, so make sure you respect your elders!!  I was 21 when it came out (checking wikipedia for the release date), which also means that it was released about 3 years after I started programming"}, {"owner": {"reputation": 35, "user_id": 8909788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66bc9a9c27ae957f1c0b1c4e2ed2a60?s=128&d=identicon&r=PG&f=1", "display_name": "Christelle", "link": "https://stackoverflow.com/users/8909788/christelle"}, "edited": false, "score": 0, "creation_date": 1510252050, "post_id": 47191274, "comment_id": 81367195, "body": "Thank you so very kindly! It worked!!!! I pointed to the variable directly instead of the actual workbook based on the &quot;better&quot; route/practice you have suggested. Just learned something new!"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 35, "user_id": 8909788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66bc9a9c27ae957f1c0b1c4e2ed2a60?s=128&d=identicon&r=PG&f=1", "display_name": "Christelle", "link": "https://stackoverflow.com/users/8909788/christelle"}, "edited": false, "score": 0, "creation_date": 1510252197, "post_id": 47191274, "comment_id": 81367293, "body": "@Christelle, the best way to thank us is to upvote helpful posts and mark the best answer using the big green checkmark."}, {"owner": {"reputation": 35, "user_id": 8909788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66bc9a9c27ae957f1c0b1c4e2ed2a60?s=128&d=identicon&r=PG&f=1", "display_name": "Christelle", "link": "https://stackoverflow.com/users/8909788/christelle"}, "edited": false, "score": 0, "creation_date": 1510254055, "post_id": 47191274, "comment_id": 81368287, "body": "Got it @Excelosaurus! Given that you and @SJR had the same answer, I chose your answer as the best that solved my problem as it was the first one that was posted. :P ..Thanks 4 the tips!"}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 2, "last_activity_date": 1510182585, "creation_date": 1510182585, "answer_id": 47191274, "question_id": 47191218, "link": "https://stackoverflow.com/questions/47191218/excel-leaving-data-source-workbook-open-after-copy-paste-data-macro-is-run/47191274#47191274", "title": "Excel Leaving Data Source Workbook Open After Copy/Paste Data Macro is run", "body": "<p>Short answer is:</p>\n\n<p><code>Workbooks(\"SHARNY.xlsx\").Close</code></p>\n\n<p>The better answer is to work with variables that directly point to workbooks:</p>\n\n<pre><code>Sub CopyingRange()\n    Dim CopyFromBook As Workbook\n    Dim CopyToWbk As Workbook\n    Dim ShToCopy As Worksheet\n\n    Set CopyFromBook = Workbooks.Open(\"C:\\Users\\MIRAR\\Desktop\\AD HOC\\DEMO FILE - WIP\\SHARNY.xlsx\")\n    Set ShToCopy = CopyFromBook.Worksheets(\"Sheet1\")\n    Set CopyToWbk = Workbooks(\"Consolidated Tracker File.xlsx\")\n\n    CopyFromBook.Close\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510183012, "post_id": 47191310, "comment_id": 81332097, "body": "we took the exact same track but <i>I&#39;ve</i> indented the code in my (updated) answer :P"}, {"owner": {"reputation": 35, "user_id": 8909788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66bc9a9c27ae957f1c0b1c4e2ed2a60?s=128&d=identicon&r=PG&f=1", "display_name": "Christelle", "link": "https://stackoverflow.com/users/8909788/christelle"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510252166, "post_id": 47191310, "comment_id": 81367273, "body": "Thanks for the help! I used @Excelosaurus answer which matches yours!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1510182724, "creation_date": 1510182724, "answer_id": 47191310, "question_id": 47191218, "link": "https://stackoverflow.com/questions/47191218/excel-leaving-data-source-workbook-open-after-copy-paste-data-macro-is-run/47191310#47191310", "title": "Excel Leaving Data Source Workbook Open After Copy/Paste Data Macro is run", "body": "<p>Assign it to your workbook variable and use that to close (or any other operation).</p>\n\n<pre><code>Sub CopyingRange()\n\nDim CopyFromBook As Workbook\nDim CopyToWbk As Workbook\nDim ShToCopy As Worksheet\n\nSet CopyFromBook = Workbooks.Open(\"C:\\Users\\MIRAR\\Desktop\\AD HOC\\DEMO FILE - WIP\\SHARNY.xlsx\")\nSet ShToCopy = CopyFromBook.Worksheets(\"Sheet1\")\nSet CopyToWbk = Workbooks(\"Consolidated Tracker File.xlsx\")\n\nCopyFromBook.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8909788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66bc9a9c27ae957f1c0b1c4e2ed2a60?s=128&d=identicon&r=PG&f=1", "display_name": "Christelle", "link": "https://stackoverflow.com/users/8909788/christelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "accepted_answer_id": 47191274, "answer_count": 2, "score": 1, "last_activity_date": 1510209825, "creation_date": 1510182279, "last_edit_date": 1510209825, "question_id": 47191218, "link": "https://stackoverflow.com/questions/47191218/excel-leaving-data-source-workbook-open-after-copy-paste-data-macro-is-run", "title": "Excel Leaving Data Source Workbook Open After Copy/Paste Data Macro is run", "body": "<p>I am very, very new to VBA.\nI am trying to automatically copy data through a macro from 8 dynamic \"individual\" workbooks to paste into one master workbook all layered on 8 tabs as those individual books will be continuously updated by various team members. </p>\n\n<p>I have the macro below which runs fine but excel afterwards leaves the data source workbook open so that won't work with 8 individual files.</p>\n\n<p>What code can I add to tell excel to close the data source file automatically after the micro is ran? Adding \"Workbooks(\"C:\\Users\\MIRAR\\Desktop\\AD HOC\\DEMO FILE - WIP\\SHARNY.xlsx\").Close\" at the end of the code before End sub is not working and issuing error 9.</p>\n\n<p>Code Below is to copy past data from 1 of the 8 workbooks on 1 tab. </p>\n\n<p>Much appreciated! </p>\n\n<pre><code>Sub CopyingRange()\nWorkbooks.Open \"C:\\Users\\MIRAR\\Desktop\\AD HOC\\DEMO FILE - WIP\\SHARNY.xlsx\"\n\nDim CopyFromBook As Workbook\nDim CopyToWbk As Workbook\nDim ShToCopy As Worksheet\n\nSet CopyFromBook = Workbooks(\"SHARNY.xlsx\")\nSet ShToCopy = CopyFromBook.Worksheets(\"Sheet1\")\nSet CopyToWbk = Workbooks(\"Consolidated Tracker File.xlsx\")\n\nWorkbooks(\"C:\\Users\\MIRAR\\Desktop\\AD HOC\\DEMO FILE - WIP\\SHARNY.xlsx\").Close \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "boolean"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510181207, "post_id": 47190952, "comment_id": 81331427, "body": "<code>If er Then</code> can be rewritten as <code>If True Then</code> - it&#39;s completely unconditional, compile-time constant, regardless of whether or not an error occurred. <code>On Error Resume Next</code> means exactly what it says: if there&#39;s an error, the next line executes regardless - so you need to check <code>Err.Number</code> <i>somewhere</i> in order to have a useful condition."}], "answers": [{"tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 2, "last_activity_date": 1510181505, "last_edit_date": 1510181505, "creation_date": 1510181128, "answer_id": 47190998, "question_id": 47190952, "link": "https://stackoverflow.com/questions/47190952/if-sheet-exists-run-sub-if-not-display-message-and-exit-sub/47190998#47190998", "title": "If Sheet Exists, run sub. If not, display message and exit sub", "body": "<p>Your idea is to attempt to activate the worksheet, and if this fails, take note than an error has occurred.</p>\n\n<p>You can modify your code as shown below. The modification pertains to the way your <code>er</code> variable gets its value. After the <code>Activate</code> method fails, the <code>Err</code> object will contain the error number (and other details) until another error occurs or another <code>On Error</code> statement is encountered (among other things). Setting <code>er</code>, a boolean, to the logical test <code>Err.Number &lt;&gt; 0</code> will detect that an error has occurred.</p>\n\n<pre><code>Sub Double_Transfer_Report()\n    Dim er As Boolean\n\n    er = False\n    On Error Resume Next\n    Worksheets(\"Transfers\").Activate\n    er = (Err.Number &lt;&gt; 0)\n    On Error GoTo 0\n\n    If er Then\n        MsgBox \"Please make sure that you renamed your data sheet : Transfers)\"\n    Else\n        ActiveSheet.Move After:=ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count)\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510181471, "post_id": 47191049, "comment_id": 81331545, "body": "That works, but is uselessly inefficient if the workbook contains many, many sheets. Kudos for abstracting away the logic into its own dedicated function though."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1510181691, "post_id": 47191049, "comment_id": 81331635, "body": "Agreed, it does add a layer of execution. But with 1200 sheets, its taking no time to find sheet&#39;s existence. If we have more sheets than that, then there are bigger problems to deal with. :)"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 3, "creation_date": 1510181765, "post_id": 47191049, "comment_id": 81331656, "body": "It&#39;s a pity the Excel collections don&#39;t expose an Exists method."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510181849, "post_id": 47191049, "comment_id": 81331694, "body": "@Excelosaurus it&#39;s the excel&#39;s limitations that keep the job interesting. :)"}, {"owner": {"reputation": 13, "user_id": 8901875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0fd826cc9d71390bcc2a7e0a0b4a8e?s=128&d=identicon&r=PG", "display_name": "Mark O&#39;Donnell", "link": "https://stackoverflow.com/users/8901875/mark-odonnell"}, "edited": false, "score": 0, "creation_date": 1510182418, "post_id": 47191049, "comment_id": 81331892, "body": "There will only be four or five sheets, so this will work.  Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510182931, "post_id": 47191049, "comment_id": 81332067, "body": "@Excelosaurus to be fair, implementing a collection class that does and can be used as a replacement for <code>VBA.Collection</code>, isn&#39;t all that hard either... but yeah ;-)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1510183267, "post_id": 47191049, "comment_id": 81332198, "body": "The function can be even simpler if you use the <code>On Error Resume Next</code> logic in the function. No looping. Just one quick check and turn back error handling to normal state."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510183419, "post_id": 47191049, "comment_id": 81332251, "body": "@Mat&#39;s Mug: I was thinking about the built-in ones: Workbooks, Worksheets, etc. In my .NET projects, I&#39;ve created extension methods. @Scott Holtzman: agree, besides you can generalize with something like  <code>ItemExists(coll As Object, itemName As String) As Boolean</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510183672, "post_id": 47191049, "comment_id": 81332337, "body": "@Excelosaurus right. except .net has it covered already: <code>using System.Linq;</code> -&gt; <code>Enumerable.Contains</code> ;-)"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510183881, "post_id": 47191049, "comment_id": 81332384, "body": "@Mat&#39;s Mug well I prefer <code>Exists</code> Mr. Smarty pants :D"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 4, "last_activity_date": 1510181409, "creation_date": 1510181409, "answer_id": 47191049, "question_id": 47190952, "link": "https://stackoverflow.com/questions/47190952/if-sheet-exists-run-sub-if-not-display-message-and-exit-sub/47191049#47191049", "title": "If Sheet Exists, run sub. If not, display message and exit sub", "body": "<p>Don't do the gymnastic with error object. Just check if the sheet exists or not through looping. </p>\n\n<hr>\n\n<pre><code>Sub Double_Transfer_Report()\n    Dim found As Boolean\n\n    found = SheetExists(\"Transfers\")\n\n    If Not found Then\n        MsgBox \"Please make sure that you renamed your data sheet : Transfers\"\n    Else\n        ActiveSheet.Move After:=ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count)\n    End If\nEnd Sub\n\nFunction SheetExists(strSheetName As String) As Boolean\n\n    Dim wks As Worksheet\n\n    For Each wks In ThisWorkbook.Worksheets\n\n        If wks.Name = strSheetName Then\n            SheetExists = True\n            Exit Function\n        End If\n    Next\n\n    SheetExists = False\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510184115, "post_id": 47191480, "comment_id": 81332440, "body": "Interesting approach! The fact that <code>INDIRECT()</code> is a volatile function turns me down somewhat, though."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510184798, "post_id": 47191480, "comment_id": 81332638, "body": "@Excelosaurus I agree.........I just posted as an alternative to the usual methods."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1510186601, "post_id": 47191480, "comment_id": 81333129, "body": "You could save two of those two cells by checking <code>Evaluate(&quot;ISNUMBER(ROWS(&#39;&quot; &amp; worksheetName &amp; &quot;&#39;!A1))&quot;)</code> where <code>worksheetName</code> is a variable containing the name of the worksheet. ;)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510186889, "post_id": 47191480, "comment_id": 81333218, "body": "@YowE3K  That is a great idea!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1510183724, "creation_date": 1510183724, "answer_id": 47191480, "question_id": 47190952, "link": "https://stackoverflow.com/questions/47190952/if-sheet-exists-run-sub-if-not-display-message-and-exit-sub/47191480#47191480", "title": "If Sheet Exists, run sub. If not, display message and exit sub", "body": "<p>If you can spare two cells somewhere, you can avoid both looping and error handling, say we use <strong>B1</strong> and <strong>B2</strong>.  In <strong>B1</strong> place the proposed worksheet name and fill <strong>B2</strong> using:</p>\n\n<pre><code>Range(\"B2\").Value = \"=ISNUMBER(ROWS(INDIRECT(\"\"'\"\"&amp;B1&amp;\"\"'!A1\"\")))\"\n</code></pre>\n\n<p>Then check the Boolean result in <strong>B2</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tlu32.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tlu32.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 382, "user_id": 6697723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dc05443c714c0d271e7791db5c08829b?s=128&d=identicon&r=PG&f=1", "display_name": "teddy2", "link": "https://stackoverflow.com/users/6697723/teddy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1510185364, "creation_date": 1510185364, "answer_id": 47191746, "question_id": 47190952, "link": "https://stackoverflow.com/questions/47190952/if-sheet-exists-run-sub-if-not-display-message-and-exit-sub/47191746#47191746", "title": "If Sheet Exists, run sub. If not, display message and exit sub", "body": "<p>Just another approach, not saying that it is any better than Cyboashu's (or else's answer). </p>\n\n<p>Create a named Range with Xl4Macro such as <code>SheetExists</code> and put this in the Refersto:  <code>=SUBSTITUTE(GET.WORKBOOK(1),\"[\" &amp;GET.WORKBOOK(16)&amp;\"]\",\"\")</code></p>\n\n<p>Now on any sheet you can add this (array) formula and it will return back the sheet's actual index if its available.</p>\n\n<p><code>{=MATCH(\"Sheet1091\",TRANSPOSE(SheetExists),0)}</code></p>\n\n<p>Just another way of doing things.:)</p>\n"}], "owner": {"reputation": 13, "user_id": 8901875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0fd826cc9d71390bcc2a7e0a0b4a8e?s=128&d=identicon&r=PG", "display_name": "Mark O&#39;Donnell", "link": "https://stackoverflow.com/users/8901875/mark-odonnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1428, "favorite_count": 0, "accepted_answer_id": 47190998, "answer_count": 4, "score": 1, "last_activity_date": 1510185364, "creation_date": 1510180901, "question_id": 47190952, "link": "https://stackoverflow.com/questions/47190952/if-sheet-exists-run-sub-if-not-display-message-and-exit-sub", "title": "If Sheet Exists, run sub. If not, display message and exit sub", "body": "<p>I am stuck despite looking up this topic on other threads.  I would like help with the following:</p>\n\n<p>If the macro can find a sheet named \"Transfers,\" I would like it to activate that sheet and run the rest of the sub, which makes \"Transfers\" the last sheet.</p>\n\n<p>If it can't find a sheet named \"Transfers\", I would like it so put up a message (Please make sure that you renamed your data sheet : 'Transfers'\") and exit the sub.  My code below is not working.</p>\n\n<pre><code>Sub Double_Transfer_Report()\nDim er As Boolean\ner = False\n\nOn Error Resume Next\n'Worksheets(\"Transfers\").Activate\ner = true\n\nIf er Then\nMsgBox (\"Please make sure that you renamed your data sheet : Transfers)\nExit Sub\nEnd If\n\nActiveSheet.Move _\nAfter:=ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1510188110, "post_id": 47190926, "comment_id": 81333525, "body": "Dangerous. Someone later inserts or deletes a Table column, and the macro does the wrong thing. Best not hardcode references into VBA like this."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1510189546, "post_id": 47190926, "comment_id": 81333893, "body": "While I agree wholeheartedly, the question was quite clear and I chose to believe OP knew what he/she was doing."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1510190230, "post_id": 47190926, "comment_id": 81334032, "body": "Yeah, I realise you gave the op exactly what they asked for. It&#39;s just that what they asked for might be hazardous to their health. In cases like this I like to explicitly point out the pitfalls of what they&#39;re asking to them, and to anyone else whom Google brings here in future. Might save someone an embarrassing, career-limiting mistake in future."}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 2, "last_activity_date": 1510180786, "creation_date": 1510180786, "answer_id": 47190926, "question_id": 47190848, "link": "https://stackoverflow.com/questions/47190848/excel-vba-fill-tablelistobject-column-with-result-of-operation-between-other-t/47190926#47190926", "title": "Excel VBA Fill Table(ListObject) Column With Result of Operation Between Other Table Columns", "body": "<pre><code>lo.ListColumns(10).DataBodyRange = \"=[\" &amp; lo.ListColumns(5).Name &amp; \"]-[\" &amp; lo.ListColumns(7).Name &amp; \"]\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1510188706, "last_edit_date": 1510188706, "creation_date": 1510188359, "answer_id": 47192139, "question_id": 47190848, "link": "https://stackoverflow.com/questions/47190848/excel-vba-fill-tablelistobject-column-with-result-of-operation-between-other-t/47192139#47192139", "title": "Excel VBA Fill Table(ListObject) Column With Result of Operation Between Other Table Columns", "body": "<p>Is there a specific reason why you want to use an INDEX rather than the column header? Using hard coded index numbers doesn't make for robust code...it means that if you (or someone else) later change the layout of your table, you have to go through your code and amend those hard coded references. Which is precisely what the ListObject reference was designed to avoid (both in terms of VBA and Formulas).</p>\n\n<p>It's far better to use Column headers, like in your example. If there's a chance that someone will change the column names, then set up a Named Range to point at the ListColumns concerned, and reference those named ranges in your code.  </p>\n\n<p>If all you want to do is find the INDEX number for some reason, then just do something like this:</p>\n\n<pre><code>Dim lo as ListObject\nDim lc as ListColumn\n\nOn Error Resume Next\nSet lc = lo.ListColumns(\"sName\")\nOn Error GoTo 0\n</code></pre>\n\n<p>...and then you can test if it was found</p>\n\n<pre><code>If Not lc Is Nothing Then Msgbox(lc.Index)\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 4309647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5d07a6be62a2c11f57daa6c1a6a5ad7?s=128&d=identicon&r=PG&f=1", "display_name": "fmc100", "link": "https://stackoverflow.com/users/4309647/fmc100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "accepted_answer_id": 47190926, "answer_count": 2, "score": 0, "last_activity_date": 1510188706, "creation_date": 1510180380, "question_id": 47190848, "link": "https://stackoverflow.com/questions/47190848/excel-vba-fill-tablelistobject-column-with-result-of-operation-between-other-t", "title": "Excel VBA Fill Table(ListObject) Column With Result of Operation Between Other Table Columns", "body": "<p>In Excel VBA, I cannot find a way to fill a column(ListColumns) in a Table(ListObjects) with an operation on two or more of the table's columns using the index number instead of using the headers in a string. So for example, I know this works when using :</p>\n\n<pre><code>lo.ListColumns(\"Spread\").DataBodyRange = \"=[Current]-[Historic]\"\n</code></pre>\n\n<p>But say \"Spread\" is column 10, and \"Current\" is column 5 and \"Historic\" is column 7. Is there a way to do something like the following to populate the column? I know this does not work, but am hoping there is something similar that does as I have tried various methods and cannot find it in a search.</p>\n\n<pre><code>lo.ListColumns(10).DataBodyRange = lo.ListColumns(9).DataBodyRange - _ \n                                   lo.ListColumns(10)\n</code></pre>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1510181454, "post_id": 47190269, "comment_id": 81331538, "body": "What&#39;s not working? Do you get an error? Also, in your <code>Test()</code>, you have <code>Range(&quot;C32:C70&quot; &amp; lastRow)</code> ...I believe you just mean <code>Range(&quot;C32:C&quot; &amp; lastRow)</code>, no?  Also, you can&#39;t do <code>workbook.Range()</code>, assuming <code>workbook</code> is a <code>Workbook</code> variable.  You need a <i>sheet</i> reference before a <code>Range</code> type, not workbook."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "is_accepted": false, "score": 0, "last_activity_date": 1510231242, "creation_date": 1510231242, "answer_id": 47202134, "question_id": 47190269, "link": "https://stackoverflow.com/questions/47190269/create-a-alloweditrange-conditional-to-a-value-on-a-column-range/47202134#47202134", "title": "Create a AllowEditRange conditional to a value on a column range", "body": "<p>As it was giving me a huge headache and consuming loads of time, I gave up of the AllowEditRanges and came up with a a work around. I just split the code in two and used the good old lock and unlock cells. I'm leaving the code below if anybody got decides to go for it too. Also, the code I came up with is very slow and after a couple of hours I decided to ask if anybody has a faster alternative. </p>\n\n<pre><code>Sub LockRow()\n\nDim rChk As Range, r1st As Range\n\nSet r1st = Columns(\"B\").Find(What:=\"Ok\", _\nafter:=Cells(Rows.Count, \"B\"), _\nLookIn:=xlValues, lookat:=xlPart, _\nsearchdirection:=xlNext)\n\nIf Not r1st Is Nothing Then \nSet rChk = r1st\nDo\nActiveSheet.Unprotect Password:=\"Maze\"\nrChk.EntireRow.Locked = True\nActiveSheet.Protect Password:=\"Maze\"\nSet rChk = Columns(\"B\").FindNext(after:=rChk)\nLoop While rChk.Address &lt;&gt; r1st.Address \nEnd If\n\nSet r1st = Nothing\nSet rChk = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510231242, "creation_date": 1510177693, "last_edit_date": 1510181394, "question_id": 47190269, "link": "https://stackoverflow.com/questions/47190269/create-a-alloweditrange-conditional-to-a-value-on-a-column-range", "title": "Create a AllowEditRange conditional to a value on a column range", "body": "<p>I have the code below which allow me to unprotect a sheet with an AllowEditRange, verify which rows of a range in column C has data on it and write the work \"Ok\" on column B in the rows where data was found in column C. The code also protects the sheet in the end returning to normal with my AllowEditRange but I need that the rows where the \"Ok\" was stamped are taken out of the AllowEditRange, blocking them for further edition. In other words I'm looking for a way to cancel these rows from the AllowEditRange or delete the range and create a new one excluding the rows with \"Ok\" in column B.\nI'm trying to incorporate something like:</p>\n\n<pre><code>Dim aer As AllowEditRange\nFor Each aer In ActiveSheet.Protection.AllowEditRanges\n    aer.Delete\n\n    If InStr(-1, cell.Value, \"\") &lt;&gt; 0 Then\n        Set aer = workbook.Protection.AllowEditRanges.Add(\"Edition\", workbook.Range(\"A1:D4\"))\n        aer.Users.Add \"Power Users\", True\n    End If\n</code></pre>\n\n<p>But it's not working no matter what I do. Any help?</p>\n\n<pre><code>Sub Test()\n\nActiveSheet.Unprotect Password:=\"Maze\"\n\nDim mainworkBook As Workbook\nSet mainworkBook = ActiveWorkbook\n\nApplication.ScreenUpdating = False\n\nDim lastRow As Long\nDim cell As Range\n\nlastRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nFor Each cell In Range(\"C32:C70\" &amp; lastRow)\n\n    If InStr(1, cell.Value, \"\") &lt;&gt; 0 Then\n        cell.Offset(, -1).Value = \"Ok\"\n    End If\n\nNext\n\nApplication.ScreenUpdating = True\n\nActiveSheet.Protect Password:=\"Maze\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "microsoft-graph-api", "office-js", "vba"], "comments": [{"owner": {"reputation": 27872, "user_id": 105518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e47ca9372faad8084cbaf9f90c6a75?s=128&d=identicon&r=PG", "display_name": "Marc LaFleur", "link": "https://stackoverflow.com/users/105518/marc-lafleur"}, "edited": false, "score": 0, "creation_date": 1510177947, "post_id": 47190109, "comment_id": 81329999, "body": "Welcome to Stack Overflow! Since you are new user, I recommend you read <a href=\"https://stackoverflow.com/help/how-to-ask\">&quot;How to Ask a Good Question&quot;</a>. You&#39;re referencing a VBA Macro language, a REST API and a JavaScript library. These are 3 entirely different things and it isn&#39;t very clear what you&#39;re asking."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510181516, "post_id": 47190109, "comment_id": 81331566, "body": "Isn&#39;t this easily answerable by just trying it?  If the macros run, then the answer is &quot;yes, they will run&quot;.  If they don&#39;t run, the answer is &quot;no, they won&#39;t run&quot;.  Or am I missing something?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1510178603, "creation_date": 1510178603, "answer_id": 47190466, "question_id": 47190109, "link": "https://stackoverflow.com/questions/47190109/will-auto-vba-macro-run-in-excel-online-automatically-when-you-open-refreshing-t/47190466#47190466", "title": "Will auto VBA macro run in excel online automatically when you open/refreshing the session", "body": "<p>This is the answer from Microsoft:\n<strong>\"Currently, you can't work with macros in Excel Online.\"</strong></p>\n\n<blockquote>\n  <p><a href=\"https://support.office.com/en-gb/article/Work-with-macros-in-Excel-Online-98784ad0-898c-43aa-a1da-4f0fb5014343\" rel=\"nofollow noreferrer\">https://support.office.com/en-gb/article/Work-with-macros-in-Excel-Online-98784ad0-898c-43aa-a1da-4f0fb5014343</a></p>\n  \n  <p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_other-mso_online/macro-enabled-excel-files-in-excel-online/00e982dc-688a-47ee-abe7-4d1f01a4ca04\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_other-mso_online/macro-enabled-excel-files-in-excel-online/00e982dc-688a-47ee-abe7-4d1f01a4ca04</a></p>\n  \n  <p><a href=\"https://technet.microsoft.com/en-us/library/excel-online-service-description.aspx\" rel=\"nofollow noreferrer\">https://technet.microsoft.com/en-us/library/excel-online-service-description.aspx</a></p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 8909805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42763b9c9b836f22e2c0ec26dc9e42ed?s=128&d=identicon&r=PG&f=1", "display_name": "Nanda", "link": "https://stackoverflow.com/users/8909805/nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2270, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510178603, "creation_date": 1510177006, "last_edit_date": 1531164843, "question_id": 47190109, "link": "https://stackoverflow.com/questions/47190109/will-auto-vba-macro-run-in-excel-online-automatically-when-you-open-refreshing-t", "title": "Will auto VBA macro run in excel online automatically when you open/refreshing the session", "body": "<p>I have a VBA macro enabled excel .xlsm file uploaded in oneDrive. The macros run automatically when you open the excel in desktop. Though we cannot operate on macros in online excel, will the auto macros get executed automatically if you open it online.</p>\n\n<p>All the macros operate on excel cells, Is refreshing excel session thru excel graph API equivalent to open the excel?</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510179002, "post_id": 47189996, "comment_id": 81330486, "body": "Create a class and add <code>MailItem</code> as the event enabled property of that class. Handle the events such as Open/Write/Send/Save etc. to have custom control on the e-mail life-cycle. <code>EntryID</code> is the unique property for each mail item."}], "answers": [{"comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1510180944, "post_id": 47190855, "comment_id": 81331317, "body": "No need for <code>Dim outlobj As Outlook.Application</code> simply use <code>Set mailobj = Application.CreateItem(olMailItem)</code>"}, {"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1510239293, "post_id": 47190855, "comment_id": 81358464, "body": "Is the <code>Dim outlobj As Outlook.Application</code> the reason it tries too start Outlook, and throws up errors like &quot;462: Remote server unavailable.&quot; if Outlook doesn&#39;t start quickly enough..? I&#39;ve been assuming there is a way to create/send the email without starting Outlook, but I hadn&#39;t researched it yet.."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 2, "last_activity_date": 1510180414, "creation_date": 1510180414, "answer_id": 47190855, "question_id": 47189996, "link": "https://stackoverflow.com/questions/47189996/track-email-through-the-draft-send-sent-process/47190855#47190855", "title": "Track email through the draft/send/sent process", "body": "<p>Create a class and add MailItem as the event enabled property of that class. Handle the events such as Open/Write/Send/Save etc. to have custom control on the e-mail life-cycle. EntryID is the unique property for each mail item.</p>\n\n<hr>\n\n<p>Be cautious of the fact that Entry Id is only generated after the first save of the item and changes implicitly when user <strong>manually</strong> moves the item between folders.</p>\n\n<hr>\n\n<p>Following a is an example to get you started:</p>\n\n<p>Add a class <code>Class1</code> like this</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents mItem As MailItem\nPublic id               As String\n\nPrivate Sub mItem_Open(Cancel As Boolean)\n    MsgBox \"Mail item will be displayed.\"\n    id = mItem.EntryID\nEnd Sub\n</code></pre>\n\n<p>Add a module with following code:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim cls As New Class1\n    Dim id  As String\n\n    Dim outlobj As Outlook.Application\n    Dim mailobj As Outlook.MailItem\n    Set outlobj = Outlook.Application\n    Set mailobj = outlobj.CreateItem(olMailItem)\n\n    Set cls.mItem = mailobj\n\n    With mailobj\n    .Recipients.Add \"xx@yy.zz\"\n    .Subject = \"Test\"\n    .Body = \"Test Content of the e-mail.\"\n    .Save\n    .Display\n    id = cls.id '/ Store ID for later use.\n    Debug.Print id\n    End With\n\n\n  '/ Search that e-mail and display its body contents\n  Call Retrieve(id)\n\n\nEnd Sub\n\n\nSub Retrieve(sEntryId As String)\n    Dim mailobj As Outlook.MailItem\n    Dim ns As NameSpace\n\n    Set ns = GetNamespace(\"MAPI\")\n    Set mailobj = ns.GetItemFromID(sEntryId)\n    MsgBox mailobj.Body\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Run the sub <code>test</code></p>\n"}], "owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1609083254, "creation_date": 1510176582, "last_edit_date": 1609083254, "question_id": 47189996, "link": "https://stackoverflow.com/questions/47189996/track-email-through-the-draft-send-sent-process", "title": "Track email through the draft/send/sent process", "body": "<p>I'd like to follow the status of an email as it passes through the phases and folders of its life cycle, through &quot;Drafts&quot;, &quot;Outbox&quot;, and &quot;Sent&quot;.</p>\n<p>Of related interest is the ability to access existing emails to gather property info, such as sent time.</p>\n<p>I've started with the included block of code. The Do Loop fails the moment the email is sent, because the variable disconnects from the email.</p>\n<p>This causes the runtime error</p>\n<blockquote>\n<p>The item has been moved or deleted.</p>\n</blockquote>\n<p>The error number (Err.Number) is different every time, and I wonder what the design purpose is.</p>\n<p>How can I stay connected to sending emails as they move through Drafts, Outbox, and Sent?</p>\n<p>I see many mentions of the variable disconnecting from the mailitem, but no solutions that rely on the object hierarchy and avoid late-binding to address the issue. I thought perhaps there would be a GUID or UUID that identifies the message, but as indicated in the documentation, all properties such as EntryID can change if the item is moved, and such properties should not be relied on.</p>\n<p>With deeper examination, this makes sense because an email is just a record in a database table. And if you duplicate/delete records between tables, the info might be the same or similar, but the record number probably won't be.<br />\nAlso, that hits other nails: the same email can be sent multiple times, and also can be copied/pasted into different folders, and even different accounts. Now what's unique or not?</p>\n<p>Aside from staying &quot;connected&quot; to a email, what properties or techniques can be used to ID one?</p>\n<p>If there's no &quot;proper&quot; way to identify a mailitem as described, about the only thing I can think of is to use an existing or custom field, like the &quot;Tag&quot; property of OCX controls, to insert a UUID. Some companies use this sort of technique by putting a call/order/support number in the subject line to make then easier to track.</p>\n<pre><code>Dim outlobj As Outlook.Application\nDim mailobj As Outlook.MailItem\nSet outlobj = Outlook.Application\nSet mailobj = outlobj.CreateItem(olMailItem)\nWith mailobj\n    .Recipients.Add &quot;wonderwoman@hallofjustice.com&quot;\n    .Subject = &quot;Invisible Jet Scheduled Maintenance Reminder&quot;\n    .Body = &quot;Your invisible jet need to be polished.&quot;\n    .Attachments.Add zipFilename\n    .Display\n    .Send\nEnd With\n\nDo\n    'next line fails due to email moving through Drafts, Outbox, &amp; Sent\n    'notably, the VBA runtime Err.Num is different each time\n    'how do i keep the variable connected to a moving target?\n    If mailobj.Sent = False Then\n        Sleep 100\n    Else\n        MsgBox &quot;The email has been sent.&quot;\n        'other code\n        Exit Do\n    End If\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1510174017, "post_id": 47189318, "comment_id": 81328036, "body": "It looks like I can use greater than 2000000000 to get the numbers beginning with 2&#39;s but I would rather not do it like that because there are also numbers higher than that that I do not want."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 3, "creation_date": 1510174823, "post_id": 47189318, "comment_id": 81328501, "body": "easiest way will be to have a helper column and filter the data on that."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1510174913, "post_id": 47189318, "comment_id": 81328563, "body": "&quot;Begins with a &#39;2&#39;&quot; is something you&#39;d say of a <code>String</code>, not of a number. Make another column with <code>=TEXT(A2,&quot;@&quot;)</code> for a formula (or <code>=&quot;&#39;&quot; &amp; A2</code>), fill down, and filter on <i>that</i> column."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1510175189, "post_id": 47189318, "comment_id": 81328711, "body": "Filter on &gt;= 2000000000 and &lt; 3000000000.  (Using the macro recorder shows me that can be done as <code>Criteria1:=&quot;&gt;=2000000000&quot;, Operator:=xlAnd, Criteria2:=&quot;&lt;3000000000&quot;</code>)"}, {"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510175980, "post_id": 47189318, "comment_id": 81329077, "body": "@YowE3K Hey there. Yeah I actually ended up doing it like that and I believe that will actually work just fine. It has so far and I don&#39;t think anything should break it."}, {"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510176569, "post_id": 47189318, "comment_id": 81329340, "body": "@Mat&#39;sMug Thanks for your help. That makes a lot of sense and I will keep that in mind for the future. I was just surprised that it didn&#39;t work, but then I could filter using a custom rule inbetween 2000000000 and 3000000000 and it worked for that. But I guess that makes sense about it being a string. It looks like it works now by putting it into another column and putting it into text. If you want to make it an answer I will mark it correct : )"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1510176629, "post_id": 47189318, "comment_id": 81329381, "body": "Meh, @cyboashu had the idea 2 whole minutes before I did :)"}, {"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1510176700, "post_id": 47189318, "comment_id": 81329414, "body": "Eh maybe but I didn&#39;t understand his answer as well as yours. I would not have known to put it into text just from his answer."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1510175896, "post_id": 47189664, "comment_id": 81329044, "body": "my UsdRws is declared farther up sorry about that. But someone else recommended that it is because it is a string like you mentioned and I think that probably makes sense."}], "tags": [], "owner": {"reputation": 441, "user_id": 8492815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3471534d4aba8f3c18c2ee90416efe?s=128&d=identicon&r=PG&f=1", "display_name": "Carol", "link": "https://stackoverflow.com/users/8492815/carol"}, "is_accepted": false, "score": 1, "last_activity_date": 1510175002, "creation_date": 1510175002, "answer_id": 47189664, "question_id": 47189318, "link": "https://stackoverflow.com/questions/47189318/issue-trying-to-filter-long-numbers/47189664#47189664", "title": "Issue trying to filter long numbers", "body": "<p>In your With statement you use UsdRws but don't give UsdRws a value until within the 'With'. May this be causing your problem?</p>\n\n<p>You could also try treating the numbers as strings (change format to text?). This way Excel shouldn't get confused by what it thinks you should or shouldn't be able to do with numbers.</p>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1510176841, "post_id": 47189940, "comment_id": 81329486, "body": "I did not use this code exactly but the idea of filtering inbetween those numbers did work for me. Thank you for writing the whole code out. The other answer of copying the column into text then filtering using that also works. But I think filtering in between these numbers will actually be easier."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1510177728, "post_id": 47189940, "comment_id": 81329895, "body": "Glad to help. If the numbers are not equal length, then a simple filter won&#39;t work, although you could use an Advanced Filter"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1510176312, "creation_date": 1510176312, "answer_id": 47189940, "question_id": 47189318, "link": "https://stackoverflow.com/questions/47189318/issue-trying-to-filter-long-numbers/47189940#47189940", "title": "Issue trying to filter long numbers", "body": "<p>If all of your numbers are 10 digit numbers, then the following seems to work:</p>\n\n<pre><code>Option Explicit\nSub FilterTwos()\n    Dim ws1 As Worksheet\n    Dim r As Range\n\nSet ws1 = Worksheets(\"sheet1\")\nWith ws1\n    Set r = .Range(\"a2\", Cells(.Rows.Count, \"A\").End(xlUp))\nEnd With\n\nws1.AutoFilterMode = False\n\nr.AutoFilter Field:=1, Criteria1:=\"&gt;=2000000000\", Operator:=xlAnd, _\n    Criteria2:=\"&lt;3000000000\"\n\nSet r = r.SpecialCells(xlCellTypeVisible)\nr.Copy Worksheets(\"sheet2\").Range(\"B2\")\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1510177030, "post_id": 47190057, "comment_id": 81329562, "body": "Thank you for your time. This is a very interesting approach. I did not end up using this but I will keep it in mind for the future. Thank you for your help and time."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "edited": false, "score": 0, "creation_date": 1510177125, "post_id": 47190057, "comment_id": 81329616, "body": "No problem, it is particularly useful when you have more complicated criteria. For example the filtering suggested by others wouldn&#39;t have worked if some of your numbers weren&#39;t 10 digits long (as also noted by others)."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 1, "last_activity_date": 1510176797, "creation_date": 1510176797, "answer_id": 47190057, "question_id": 47189318, "link": "https://stackoverflow.com/questions/47189318/issue-trying-to-filter-long-numbers/47190057#47190057", "title": "Issue trying to filter long numbers", "body": "<p>This works regardless of how many digits your numbers contain. Your <code>inputRange</code> should just be the column with the long numbers in, include headers too.</p>\n\n<pre><code>Sub Remove2()\n    Dim inputRange As Range\n    Dim v As Variant\n    Dim i As Long, deleteCount As Long, min As Long\n\n    Set inputRange = Sheet1.Range(\"A1:A10001\")\n    v = inputRange.Value\n    min = Application.WorksheetFunction.min(inputRange) - 1\n\n    For i = 1 To UBound(v)\n        If Left(v(i, 1), 1) = \"2\" Then\n            v(i, 1) = min\n            deleteCount = deleteCount + 1\n        End If\n    Next i\n\n    With inputRange\n        .Value = v\n        .Sort key1:=.Resize(1, 1), order1:=xlAscending, Header:=xlYes 'xlNo if no headers\n        .Resize(deleteCount, 1).Offset(1, 0).EntireRow.Delete 'remove offset if no headers\n    End With\nEnd Sub\n</code></pre>\n\n<p><em>tested with 10,000 numbers taking 0.4 seconds</em></p>\n"}], "owner": {"reputation": 107, "user_id": 8543617, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d002bf83d705262162d766f5de1d98de?s=128&d=identicon&r=PG&f=1", "display_name": "Robillard", "link": "https://stackoverflow.com/users/8543617/robillard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 47189940, "answer_count": 3, "score": 0, "last_activity_date": 1510176797, "creation_date": 1510173807, "question_id": 47189318, "link": "https://stackoverflow.com/questions/47189318/issue-trying-to-filter-long-numbers", "title": "Issue trying to filter long numbers", "body": "<p>I have a column with lots of longer numbers in it. I want to filter my column for all numbers that DO NOT begin with 2. I tried writing it in code to select all of the 2's first, but that didn't work. Then I tried to do it by hand in Excel by saying filter, custom rule, does not begin with 2. But nothing changes. I don't see, for example, a zero before the numbers either. I tried to reformat them into numbers but they were already numbers. I am not sure why it isn't selecting either all the numbers that start with 2 or all the numbers that DON'T start with 2.</p>\n\n<p>Here is the code I tried to get numbers that START with 2.</p>\n\n<pre><code>With ws1.Range(\"A1:Z\" &amp; UsdRws)\n    .autofilter Field:=6, Criteria1:=\"2*\", Operator:=xlFilterValues\n    On Error Resume Next\n\n    UsdRws = ws1.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n    If UsdRws &gt; 1 Then\n        Range(\"A2:A\" &amp; UsdRws).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End If\n    On Error GoTo 0\n    .autofilter Field:=9\n    Cells.EntireColumn.AutoFit\nEnd With\n</code></pre>\n\n<p>The filter does not change anything even though I have a lot of numbers beginning with 2. Here is a sample of the numbers I am using.</p>\n\n<pre><code>2190190000\n1410650400\n1410720000\n1410511900\n1410650000\n1410511900\n1410650500\n1410680100\n1410650300\n2190160000\n1410650100\n2190160000\n2020110008\n1410511900\n1410650400\n2020110002\n2020180000\n2010110100\n1410671000\n2190190000\n1410650200\n2020180000\n2190190000\n1410650400\n1410720000\n1410511900\n1410650000\n1410511900\n1410650500\n</code></pre>\n\n<p>So like I said, I am trying to get either all the numbers beginning with 2 or all the other ones, but it seems like neither is working, even when doing it by hand using a custom filter rule.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1510174169, "post_id": 47189227, "comment_id": 81328132, "body": "have you tried to put in your <code>DoubleClick</code> event set <code>Cancel = True</code>?"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510174372, "post_id": 47189227, "comment_id": 81328244, "body": "@David G. Won&#39;t work; it&#39;s MouseUp..."}], "answers": [{"comments": [{"owner": {"reputation": 829, "user_id": 8874545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c12a02d9db7220f4706846d46e9f36?s=128&d=identicon&r=PG&f=1", "display_name": "E. Villiger", "link": "https://stackoverflow.com/users/8874545/e-villiger"}, "edited": false, "score": 0, "creation_date": 1510174075, "post_id": 47189341, "comment_id": 81328067, "body": "Good idea, but doesn&#39;t work. Apparently the MouseDown is only called once per double-click."}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 2, "last_activity_date": 1510173865, "creation_date": 1510173865, "answer_id": 47189341, "question_id": 47189227, "link": "https://stackoverflow.com/questions/47189227/vba-disable-double-click-on-form-control-button/47189341#47189341", "title": "VBA: Disable double-click on form control (button)", "body": "<p>Intercept the <code>MouseUp</code> event instead.</p>\n"}, {"comments": [{"owner": {"reputation": 829, "user_id": 8874545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c12a02d9db7220f4706846d46e9f36?s=128&d=identicon&r=PG&f=1", "display_name": "E. Villiger", "link": "https://stackoverflow.com/users/8874545/e-villiger"}, "edited": false, "score": 0, "creation_date": 1510174522, "post_id": 47189400, "comment_id": 81328320, "body": "Good point with the spin button; I&#39;ll look into that - and yes, calling the click event from double click works fine."}], "tags": [], "owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "is_accepted": false, "score": 0, "last_activity_date": 1510174070, "creation_date": 1510174070, "answer_id": 47189400, "question_id": 47189227, "link": "https://stackoverflow.com/questions/47189227/vba-disable-double-click-on-form-control-button/47189400#47189400", "title": "VBA: Disable double-click on form control (button)", "body": "<p>Regular command buttons might not be the best control; what you're doing sounds like it calls more for a spin button (the one with the next/back control).</p>\n\n<p>If that doesn't cut it, the stupidly simple solution would be to have the double click even simply call the click event twice.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1510175025, "post_id": 47189494, "comment_id": 81328624, "body": "Invoking event handlers &quot;manually&quot; like this is a very strong sign that you&#39;re doing something wrong. Event handlers aren&#39;t normal procedures, they <i>handle events</i>."}, {"owner": {"reputation": 829, "user_id": 8874545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c12a02d9db7220f4706846d46e9f36?s=128&d=identicon&r=PG&f=1", "display_name": "E. Villiger", "link": "https://stackoverflow.com/users/8874545/e-villiger"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1510175519, "post_id": 47189494, "comment_id": 81328878, "body": "True; ideally I would call a function like &quot;GoToNextImage&quot; from both event handlers. (I was just too lazy for my purposes to create a separate function)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510175567, "post_id": 47189494, "comment_id": 81328895, "body": "Yet handling the proper event makes a much more robust and elegant solution doesn&#39;t it :)"}], "tags": [], "owner": {"reputation": 829, "user_id": 8874545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c12a02d9db7220f4706846d46e9f36?s=128&d=identicon&r=PG&f=1", "display_name": "E. Villiger", "link": "https://stackoverflow.com/users/8874545/e-villiger"}, "is_accepted": false, "score": 0, "last_activity_date": 1510174400, "creation_date": 1510174400, "answer_id": 47189494, "question_id": 47189227, "link": "https://stackoverflow.com/questions/47189227/vba-disable-double-click-on-form-control-button/47189494#47189494", "title": "VBA: Disable double-click on form control (button)", "body": "<p>I actually figured out a pretty easy workaround for this:</p>\n\n<p>In the DoubleClick event, I can simply call the Click event like so:</p>\n\n<pre><code>Private Sub NextBtn_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    NextBtn_Click\nEnd Sub\n</code></pre>\n\n<p>I am now able to click the button as fast as I want and after each click the same code is executed.</p>\n"}], "owner": {"reputation": 829, "user_id": 8874545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c12a02d9db7220f4706846d46e9f36?s=128&d=identicon&r=PG&f=1", "display_name": "E. Villiger", "link": "https://stackoverflow.com/users/8874545/e-villiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1652, "favorite_count": 0, "accepted_answer_id": 47189341, "answer_count": 3, "score": 1, "last_activity_date": 1510174400, "creation_date": 1510173547, "last_edit_date": 1531164843, "question_id": 47189227, "link": "https://stackoverflow.com/questions/47189227/vba-disable-double-click-on-form-control-button", "title": "VBA: Disable double-click on form control (button)", "body": "<p>I have a VBA form in Excel with \"Next\" and \"Previous\" buttons that update an Image control's picture source.</p>\n\n<p>I would like to be able to click these buttons very quickly in succession in order to loop through the images. However, when I click twice in short succession (double click) I only get one response.</p>\n\n<p>I suspect that this is the case because there is a double click event on the button that gets triggered instead of the click event when two clicks are very close to each other.</p>\n\n<p>My goal would be to disable the double-click event altogether, allowing me to click the button as quickly as I want. Is there a way to do that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1510172589, "post_id": 47188924, "comment_id": 81327277, "body": "It works for me, what is the value of <code>LastRow</code> when it errors?"}, {"owner": {"reputation": 103, "user_id": 5938178, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/KA6Is.png?s=128&g=1", "display_name": "charwayne", "link": "https://stackoverflow.com/users/5938178/charwayne"}, "edited": false, "score": 0, "creation_date": 1510172666, "post_id": 47188924, "comment_id": 81327315, "body": "I believe the last time I saw this, it was do to the documentation I was referencing was for a different version of Excel. You might want to double check. Function naming has changed with each iteration of Excel."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1510174101, "post_id": 47188924, "comment_id": 81328085, "body": "The code does work for me if <code>LastRow</code> is an actual value, if it has no value, then I get the same error."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510174343, "post_id": 47188924, "comment_id": 81328232, "body": "<code>LastRow</code> would be <code>0</code>. FWIW you should qualify that <code>Range</code> call with a proper <code>Worksheet</code> object instance - unqualified like this, it points to the hidden <code>_Global</code> module which essentially redirects to <code>ActiveSheet</code>, so <code>ActiveSheet.Range(...)</code> would already be an improvement."}, {"owner": {"reputation": 71, "user_id": 8651669, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LEoAy.jpg?s=128&g=1", "display_name": "ln29st", "link": "https://stackoverflow.com/users/8651669/ln29st"}, "edited": false, "score": 0, "creation_date": 1510175269, "post_id": 47188924, "comment_id": 81328749, "body": "That is strange, I do have values in the last row and am still getting error. I also changed it to &quot;ActiveSheet.Range(...)&quot; and it didn&#39;t work. I&#39;ll have to go with another approach here. Thanks for checking guys!"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510175600, "post_id": 47188924, "comment_id": 81328907, "body": "Put a breakpoint on your line and tell us what LastRow contains just before the code fails - we&#39;re all eager to hear about this."}], "answers": [{"tags": [], "owner": {"reputation": 441, "user_id": 8492815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f3471534d4aba8f3c18c2ee90416efe?s=128&d=identicon&r=PG&f=1", "display_name": "Carol", "link": "https://stackoverflow.com/users/8492815/carol"}, "is_accepted": false, "score": 0, "last_activity_date": 1510175708, "creation_date": 1510175708, "answer_id": 47189823, "question_id": 47188924, "link": "https://stackoverflow.com/questions/47188924/vba-apply-formula-to-all-cells-not-working/47189823#47189823", "title": "VBA Apply Formula to All Cells not Working", "body": "<p>You could try setting the formula into the first cell, then copying and pasting into the rest as per this answer here: <a href=\"https://stackoverflow.com/questions/15522538/set-formula-to-a-range-of-cells\">Set formula to a range of cells</a></p>\n"}], "owner": {"reputation": 71, "user_id": 8651669, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LEoAy.jpg?s=128&g=1", "display_name": "ln29st", "link": "https://stackoverflow.com/users/8651669/ln29st"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510175708, "creation_date": 1510172445, "question_id": 47188924, "link": "https://stackoverflow.com/questions/47188924/vba-apply-formula-to-all-cells-not-working", "title": "VBA Apply Formula to All Cells not Working", "body": "<p>I need to apply the formula to all cells on Sheet2 and am getting the \"Method'Range' of object'_Global' failed\" error. </p>\n\n<p>Here's the VBA code I'm using: </p>\n\n<pre><code>Range(\"D2:AJ\" &amp; LastRow).Formula = \"=OFFSET(Sheet1!$D$2,(ROW(1:1)-1)+INT((ROW(1:1)-1)/2)*8,COLUMN(A:A)-1)\"\n</code></pre>\n\n<p>The formula copies every 2 rows from Sheet1 and skips 8 rows and it's working when I manually enter it. </p>\n\n<p>Could you please let me know what I'm doing wrong? </p>\n\n<p>Thanks much! </p>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1510170639, "post_id": 47188259, "comment_id": 81326207, "body": "<i>if any of you know how to see if we can implement</i> - what have <i>you</i> tried to do to implement this and what&#39;s not working? that is something we can help with."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1510174342, "post_id": 47188259, "comment_id": 81328231, "body": "Why people are not forced to take the tutorial and read  <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> before write the first question?"}, {"owner": {"reputation": 1, "user_id": 8909334, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156802209948082/picture?type=large", "display_name": "James An", "link": "https://stackoverflow.com/users/8909334/james-an"}, "edited": false, "score": 1, "creation_date": 1510176360, "post_id": 47188259, "comment_id": 81329241, "body": "I re-edit based on some of the asking tips. I hope it helps! Let me know if there is an issue. Thank you stack team!"}], "answers": [{"tags": [], "owner": {"reputation": 531, "user_id": 6254149, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1UvBh.jpg?s=128&g=1", "display_name": "Moreno", "link": "https://stackoverflow.com/users/6254149/moreno"}, "is_accepted": false, "score": 0, "last_activity_date": 1510174402, "creation_date": 1510174402, "answer_id": 47189495, "question_id": 47188259, "link": "https://stackoverflow.com/questions/47188259/using-google-map-into-excel/47189495#47189495", "title": "Using google map into excel", "body": "<p>I hope it helps.</p>\n\n<p>This works by using an API so that you are able to get Google map's information through those functions.</p>\n\n<pre><code>' Usage :\n' GetGoogleTravelTime (strFrom, strTo) returns a string containing journey duration : hh:mm\n' GetGoogleDistance (strFrom, strTo) returns a string containing journey distance in either miles or km (as defined by strUnits)\n' GetGoogleDirections (strFrom, strTo) returns a string containing the directions\n'\n' where strFrom/To are address search terms recognisable by Google\n' i.e. Postcode, address etc.\n'\n' by Desmond Oshiwambo\n\nConst strUnits = \"imperial\" ' imperial/metric (miles/km)\n\nFunction CleanHTML(ByVal strHTML)\n'Helper function to clean HTML instructions\nDim strInstrArr1() As String\nDim strInstrArr2() As String\nDim s As Integer\n\nstrInstrArr1 = Split(strHTML, \"&lt;\")\nFor s = LBound(strInstrArr1) To UBound(strInstrArr1)\n strInstrArr2 = Split(strInstrArr1(s), \"&gt;\")\n   If UBound(strInstrArr2) &gt; 0 Then\n        strInstrArr1(s) = strInstrArr2(1)\n   Else\n        strInstrArr1(s) = strInstrArr2(0)\n   End If\nNext\n\nCleanHTML = Join(strInstrArr1)\nEnd Function\n\n\nPublic Function formatGoogleTime(ByVal lngSeconds As Double)\n'Helper function. Google returns the time in seconds, so this converts it into time format hh:mm\n\nDim lngMinutes As Long\nDim lngHours As Long\n\nlngMinutes = Fix(lngSeconds / 60)\nlngHours = Fix(lngMinutes / 60)\nlngMinutes = lngMinutes - (lngHours * 60)\n\nformatGoogleTime = Format(lngHours, \"00\") &amp; \":\" &amp; Format(lngMinutes, \"00\")\nEnd Function\n\n\nFunction gglDirectionsResponse(ByVal strStartLocation, ByVal strEndLocation, ByRef strTravelTime, ByRef strDistance, ByRef strInstructions, Optional ByRef strError = \"\") As Boolean\nOn Error GoTo errorHandler\n' Helper function to request and process XML generated by Google Maps.\n\nDim strURL As String\nDim objXMLHttp As Object\nDim objDOMDocument As Object\nDim nodeRoute As Object\nDim lngDistance As Long\n\nSet objXMLHttp = CreateObject(\"MSXML2.XMLHTTP\")\nSet objDOMDocument = CreateObject(\"MSXML2.DOMDocument.6.0\")\n\nstrStartLocation = Replace(strStartLocation, \" \", \"+\")\nstrEndLocation = Replace(strEndLocation, \" \", \"+\")\n\nstrURL = \"http://maps.googleapis.com/maps/api/directions/xml\" &amp; _\n            \"?origin=\" &amp; strStartLocation &amp; _\n            \"&amp;destination=\" &amp; strEndLocation &amp; _\n            \"&amp;sensor=false\" &amp; _\n            \"&amp;units=\" &amp; strUnits   'Sensor field is required by google and indicates whether a Geo-sensor is being used by the device making the request\n\n'Send XML request\nWith objXMLHttp\n    .Open \"GET\", strURL, False\n    .setRequestHeader \"Content-Type\", \"application/x-www-form-URLEncoded\"\n    .send\n    objDOMDocument.LoadXML .responseText\nEnd With\n\nWith objDOMDocument\n    If .SelectSingleNode(\"//status\").Text = \"OK\" Then\n        'Get Distance\n        lngDistance = .SelectSingleNode(\"/DirectionsResponse/route/leg/distance/value\").Text ' Retrieves distance in meters\n        Select Case strUnits\n            Case \"imperial\": strDistance = Round(lngDistance * 0.00062137, 1)  'Convert meters to miles\n            Case \"metric\": strDistance = Round(lngDistance / 1000, 1) 'Convert meters to miles\n        End Select\n\n        'Get Travel Time\n        strTravelTime = .SelectSingleNode(\"/DirectionsResponse/route/leg/duration/value\").Text  'returns in seconds from google\n        strTravelTime = formatGoogleTime(strTravelTime) 'converts seconds to hh:mm\n\n        'Get Directions\n        For Each nodeRoute In .SelectSingleNode(\"//route/leg\").ChildNodes\n            If nodeRoute.BaseName = \"step\" Then\n                strInstructions = strInstructions &amp; nodeRoute.SelectSingleNode(\"html_instructions\").Text &amp; \" - \" &amp; nodeRoute.SelectSingleNode(\"distance/text\").Text &amp; vbCrLf\n            End If\n        Next\n\n        strInstructions = CleanHTML(strInstructions) 'Removes MetaTag information from HTML result to convert to plain text.\n\n    Else\n        strError = .SelectSingleNode(\"//status\").Text\n        GoTo errorHandler\n    End If\nEnd With\n\ngglDirectionsResponse = True\nGoTo CleanExit\n\nerrorHandler:\n    If strError = \"\" Then strError = Err.Description\n    strDistance = -1\n    strTravelTime = \"00:00\"\n    strInstructions = \"\"\n    gglDirectionsResponse = False\n\nCleanExit:\n    Set objDOMDocument = Nothing\n    Set objXMLHttp = Nothing\n\nEnd Function\n\n\nFunction getGoogleTravelTime(ByVal strFrom, ByVal strTo) As String\n'Returns the journey time between strFrom and strTo\n\nDim strTravelTime As String\nDim strDistance As String\nDim strInstructions As String\nDim strError As String\n\nIf gglDirectionsResponse(strFrom, strTo, strTravelTime, strDistance, strInstructions, strError) Then\n    getGoogleTravelTime = strTravelTime\nElse\n    getGoogleTravelTime = strError\nEnd If\n\nEnd Function\n\n\nFunction getGoogleDistance(ByVal strFrom, ByVal strTo) As String\n'Returns the distance between strFrom and strTo\n'where strFrom/To are address search terms recognisable by Google\n'i.e. Postcode, address etc.\n\nDim strTravelTime As String\nDim strDistance As String\nDim strError As String\nDim strInstructions As String\n\nIf gglDirectionsResponse(strFrom, strTo, strTravelTime, strDistance, strInstructions, strError) Then\n    getGoogleDistance = strDistance\nElse\n    getGoogleDistance = strError\nEnd If\n\nEnd Function\n\n\nFunction getGoogleDirections(ByVal strFrom, ByVal strTo) As String\n'Returns the directions between strFrom and strTo\n'where strFrom/To are address search terms recognisable by Google\n'i.e. Postcode, address etc.\n\nDim strTravelTime As String\nDim strDistance As String\nDim strError As String\nDim strInstructions As String\n\nIf gglDirectionsResponse(strFrom, strTo, strTravelTime, strDistance, strInstructions, strError) Then\n    getGoogleDirections = strInstructions\nElse\n    getGoogleDirections = strError\nEnd If\n\nEnd Function\nPublic Function ACOF(Rango As Range) As Variant\n Dim x(), y(), z() As Variant\n Dim i, n, mu, k, j As Double\n  n = Rango.Rows.Count\n  mu = Application.Average(Rango)\n  k = 1\n  ReDim z(n - k)\n Do Until k = n - 1\n ReDim x(n - k), y(n - k)\n   For i = 1 To n - k Step 1\n    x(i) = Rango(i) - mu\n    y(i) = Rango(i + k) - mu\n   Next i\nz(k) = Application.Correl(x, y) 'Application.SumProduct(x, y) / Application.DevSq(Rango)\n k = k + 1\nLoop\nACOF = Application.Transpose(z)\nEnd Function\n\nPublic Function JBTEST(Rango As Range, p As Double) As Variant\n If IsNull(Rango) Then\n  MsgBox prompt:=\"Introduce un rango v\u00e1lido\"\n   End If\n Dim s, k, n As Double\n  s = Application.Skew(Rango)\n  k = Application.Kurt(Rango)\n  n = Rango.Rows.Count\n   JBTEST = Application.ChiDist((n - p + 1) / 6 * (s ^ 2 + 1 / 4 * (k - 3) ^ 2), 2)\n\nEnd Function\n\nFunction IFERROR(ByRef ToEvaluate As Variant, ByRef Default As Variant) As Variant\n    If IsError(ToEvaluate) Then\n        IFERROR = Default\n    Else\n        IFERROR = ToEvaluate\n    End If\nEnd Function\n\nSub RegisterUDF()\n    Dim s As String\n    s = \"Provides a shortcut replacement for the common worksheet construct\" &amp; vbLf _\n    &amp; \"IF(ISERROR(&lt;expression&gt;, &lt;default&gt;, &lt;expression&gt;)\"\n\n    Application.MacroOptions Macro:=\"IFERROR\", Description:=s, Category:=9\nEnd Sub\n\nSub UnregisterUDF()\n    Application.MacroOptions Macro:=\"IFERROR\", Description:=Empty, Category:=Empty\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8909334, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156802209948082/picture?type=large", "display_name": "James An", "link": "https://stackoverflow.com/users/8909334/james-an"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 275, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1538748572, "creation_date": 1510169854, "last_edit_date": 1510176325, "question_id": 47188259, "link": "https://stackoverflow.com/questions/47188259/using-google-map-into-excel", "title": "Using google map into excel", "body": "<p>This is my first question so I am re-editing to better suit the culture here in stack overflow!\nI recently found the API below that helps me plan out my trips/stops for a wide range of activities. It gives me the distance, directions, and time on excel! I have a wide variety of address that I use and I need the data of each in an excel format. </p>\n\n<p>Problem: I have a problem where I want to find out my time/duration to get to a certain location to the next based on the time and day. For example if i want to depart toronto at 4:00pm to get to chicago, how long will that take based on the average traffic records. </p>\n\n<p>This is pretty relevant to others who are in need of geocoding information on their excel! I am not very familiar with programming,vba, and sql but i definitely want to get into it so this is a good stepping stone to learn some cool stuff!</p>\n\n<pre><code>' Usage :\n' GetGoogleTravelTime (strFrom, strTo) returns a string containing journey duration : hh:mm\n' GetGoogleDistance (strFrom, strTo) returns a string containing journey distance in either miles or km (as defined by strUnits)\n' GetGoogleDirections (strFrom, strTo) returns a string containing the directions\n'\n' where strFrom/To are address search terms recognisable by Google\n' i.e. Postcode, address etc.\n'\n'\nConst strUnits = \"imperial\" ' imperial/metric (miles/km)\n\nFunction CleanHTML(ByVal strHTML)\n'Helper function to clean HTML instructions\nDim strInstrArr1() As String\nDim strInstrArr2() As String\nDim s As Integer\n\nstrInstrArr1 = Split(strHTML, \"&lt;\")\nFor s = LBound(strInstrArr1) To UBound(strInstrArr1)\n   strInstrArr2 = Split(strInstrArr1(s), \"&gt;\")\n   If UBound(strInstrArr2) &gt; 0 Then\n        strInstrArr1(s) = strInstrArr2(1)\n   Else\n        strInstrArr1(s) = strInstrArr2(0)\n   End If\nNext\n\nCleanHTML = Join(strInstrArr1)\nEnd Function\n\nPublic Function formatGoogleTime(ByVal lngSeconds As Double)\n'Helper function. Google returns the time in seconds, so this converts it into time format hh:mm\n\nDim lngMinutes As Long\nDim lngHours As Long\n\nlngMinutes = Fix(lngSeconds / 60)\nlngHours = Fix(lngMinutes / 60)\nlngMinutes = lngMinutes - (lngHours * 60)\n\nformatGoogleTime = Format(lngHours, \"00\") &amp; \":\" &amp; Format(lngMinutes, \"00\")\nEnd Function\n\n\n\n\nFunction gglDirectionsResponse(ByVal strStartLocation, ByVal strEndLocation, ByRef strTravelTime, ByRef strDistance, ByRef strInstructions, Optional ByRef strError = \"\") As Boolean\nOn Error GoTo errorHandler\n' Helper function to request and process XML generated by Google Maps.\n\nDim strURL As String\nDim objXMLHttp As Object\nDim objDOMDocument As Object\nDim nodeRoute As Object\nDim lngDistance As Long\n\nSet objXMLHttp = CreateObject(\"MSXML2.XMLHTTP\")\nSet objDOMDocument = CreateObject(\"MSXML2.DOMDocument.6.0\")\n\nstrStartLocation = Replace(strStartLocation, \" \", \"+\")\nstrEndLocation = Replace(strEndLocation, \" \", \"+\")\n\nstrURL = \"http://maps.googleapis.com/maps/api/directions/xml\" &amp; _\n            \"?origin=\" &amp; strStartLocation &amp; _\n            \"&amp;destination=\" &amp; strEndLocation &amp; _\n            \"&amp;sensor=false\" &amp; _\n            \"&amp;units=\" &amp; strUnits   'Sensor field is required by google and indicates whether a Geo-sensor is being used by the device making the request\n\n'Send XML request\nWith objXMLHttp\n    .Open \"GET\", strURL, False\n    .setRequestHeader \"Content-Type\", \"application/x-www-form-URLEncoded\"\n    .Send\n    objDOMDocument.LoadXML .ResponseText\nEnd With\n\nWith objDOMDocument\n    If .SelectSingleNode(\"//status\").Text = \"OK\" Then\n        'Get Distance\n        lngDistance = .SelectSingleNode(\"/DirectionsResponse/route/leg/distance/value\").Text ' Retrieves distance in meters\n        Select Case strUnits\n            Case \"imperial\": strDistance = Round(lngDistance * 0.00062137, 1)  'Convert meters to miles\n            Case \"metric\": strDistance = Round(lngDistance / 1000, 1) 'Convert meters to miles\n        End Select\n\n        'Get Travel Time\n        strTravelTime = .SelectSingleNode(\"/DirectionsResponse/route/leg/duration/value\").Text  'returns in seconds from google\n        strTravelTime = formatGoogleTime(strTravelTime) 'converts seconds to hh:mm\n\n        'Get Directions\n        For Each nodeRoute In .SelectSingleNode(\"//route/leg\").ChildNodes\n            If nodeRoute.BaseName = \"step\" Then\n                strInstructions = strInstructions &amp; nodeRoute.SelectSingleNode(\"html_instructions\").Text &amp; \" - \" &amp; nodeRoute.SelectSingleNode(\"distance/text\").Text &amp; vbCrLf\n            End If\n        Next\n\n        strInstructions = CleanHTML(strInstructions) 'Removes MetaTag information from HTML result to convert to plain text.\n\n    Else\n        strError = .SelectSingleNode(\"//status\").Text\n        GoTo errorHandler\n    End If\nEnd With\n\ngglDirectionsResponse = True\nGoTo CleanExit\n\nerrorHandler:\n    If strError = \"\" Then strError = Err.Description\n    strDistance = -1\n    strTravelTime = \"00:00\"\n    strInstructions = \"\"\n    gglDirectionsResponse = False\n\nCleanExit:\n    Set objDOMDocument = Nothing\n    Set objXMLHttp = Nothing\n\nEnd Function\n\n\nFunction getGoogleTravelTime(ByVal strFrom, ByVal strTo) As String\n'Returns the journey time between strFrom and strTo\n\nDim strTravelTime As String\nDim strDistance As String\nDim strInstructions As String\nDim strError As String\n\nIf gglDirectionsResponse(strFrom, strTo, strTravelTime, strDistance, strInstructions, strError) Then\n    getGoogleTravelTime = strTravelTime\nElse\n    getGoogleTravelTime = strError\nEnd If\n\nEnd Function\n\nFunction getGoogleDistance(ByVal strFrom, ByVal strTo) As String\n'Returns the distance between strFrom and strTo\n'where strFrom/To are address search terms recognisable by Google\n'i.e. Postcode, address etc.\n\nDim strTravelTime As String\nDim strDistance As String\nDim strError As String\nDim strInstructions As String\n\nIf gglDirectionsResponse(strFrom, strTo, strTravelTime, strDistance, strInstructions, strError) Then\n    getGoogleDistance = strDistance\nElse\n    getGoogleDistance = strError\nEnd If\n\nEnd Function\n\nFunction getGoogleDirections(ByVal strFrom, ByVal strTo) As String\n'Returns the directions between strFrom and strTo\n'where strFrom/To are address search terms recognisable by Google\n'i.e. Postcode, address etc.\n\nDim strTravelTime As String\nDim strDistance As String\nDim strError As String\nDim strInstructions As String\n\nIf gglDirectionsResponse(strFrom, strTo, strTravelTime, strDistance, strInstructions, strError) Then\n    getGoogleDirections = strInstructions\nElse\n    getGoogleDirections = strError\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Anything would help.</p>\n"}, {"tags": ["vba", "colors"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1510170110, "post_id": 47188211, "comment_id": 81325931, "body": "Not sure what you want to achieve... If you want to change background color of CodePane editor, you should use Tools-&gt;Options, bookmark: Editor format."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1510170176, "post_id": 47188211, "comment_id": 81325966, "body": "Those are for Visual Studio, not VBA."}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1510178963, "post_id": 47188211, "comment_id": 81330476, "body": "Removed greeting and thanks -- these are discouraged as they add nothing to the question. Formatted link properly, and stated the question explicitly."}, {"owner": {"reputation": 31, "user_id": 7207107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91c8cacb4d1a7f468c2be88e3a8d266d?s=128&d=identicon&r=PG&f=1", "display_name": "MC_B", "link": "https://stackoverflow.com/users/7207107/mc-b"}, "edited": false, "score": 0, "creation_date": 1510257342, "post_id": 47188211, "comment_id": 81370169, "body": "Thanks Maciej Los and braX  :) ! Bob Dalgleish , I just tried to be polite and thankful..."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7207107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91c8cacb4d1a7f468c2be88e3a8d266d?s=128&d=identicon&r=PG&f=1", "display_name": "MC_B", "link": "https://stackoverflow.com/users/7207107/mc-b"}, "edited": false, "score": 0, "creation_date": 1510257300, "post_id": 47189061, "comment_id": 81370142, "body": "Thanks for the precision of the file. I will change manually in Tools &gt; Options menu; thanks"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31, "user_id": 7207107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91c8cacb4d1a7f468c2be88e3a8d266d?s=128&d=identicon&r=PG&f=1", "display_name": "MC_B", "link": "https://stackoverflow.com/users/7207107/mc-b"}, "edited": false, "score": 0, "creation_date": 1510257503, "post_id": 47189061, "comment_id": 81370264, "body": "@MC_B you&#39;re welcome. Feel free to read <a href=\"https://stackoverflow.com/help/someone-answers\">this</a>, for this question, the previous ones, and any future one you might ask on this site."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1510173007, "creation_date": 1510173007, "answer_id": 47189061, "question_id": 47188211, "link": "https://stackoverflow.com/questions/47188211/how-to-install-a-theme-color-in-vba/47189061#47189061", "title": "How to install a theme color in vba", "body": "<p>You can't use a <code>.vssetting</code> file, that's a Visual Studio thing - the VBE wouldn't know what to do with it.</p>\n\n<p>Its colors are \"configurable\" through the Tools > Options menu; they're the same rather limited 16-bit colors from 1997... and there's no file you can import that will make a \"theme\" (<a href=\"https://superuser.com/a/315695/165271\">a .reg file could act like it, perhaps</a>)</p>\n\n<p>There <em>is</em> a hack, though - you can <a href=\"https://github.com/dimitropoulos/VBECustomColors\" rel=\"nofollow noreferrer\">hex-edit VBE7.DLL and change the available colors to whatever you like</a>. Obviously the risk is that you completely wreck VBA in every single VBA host application at once, but hey shiny colors are worth it eh?</p>\n\n<p><a href=\"https://github.com/dimitropoulos/VBECustomColors/blob/master/README.md\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ORfuI.png\" alt=\"image from https://github.com/dimitropoulos/VBECustomColors/blob/master/README.md\"></a></p>\n\n<p>The only thing I'm seeing that's remotely close to \"theming\" the VBE (and doesn't involve rewriting VBA itself) is what we want to achieve in <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> (an OSS VBIDE add-in project I manage) by version 3.0 (we just kicked off the v2.1.x cycle), when we inject our own AvalonEdit WPF code pane into the VBE, implement our own <em>IntelliSense</em> and take full control of the VBE code panes' appearance and functionality - but there's <strong>a lot</strong> of work to be done before we can even dream of shipping that wet dream of a feature - so if you know a bit of C# and WPF, by all means join the Rubberduck dev team and help us do it!</p>\n"}], "owner": {"reputation": 31, "user_id": 7207107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91c8cacb4d1a7f468c2be88e3a8d266d?s=128&d=identicon&r=PG&f=1", "display_name": "MC_B", "link": "https://stackoverflow.com/users/7207107/mc-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1604, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542875810, "creation_date": 1510169717, "last_edit_date": 1510178963, "question_id": 47188211, "link": "https://stackoverflow.com/questions/47188211/how-to-install-a-theme-color-in-vba", "title": "How to install a theme color in vba", "body": "<p>I just downloaded a color theme on <a href=\"https://stackoverflow.com/questions/503103/best-background-color-for-your-editor\">that link</a> (a vssetting file) and would like to know how to install it in VBA.</p>\n\n<p>I have the file but no option to put it into VBA. How do I do that?</p>\n"}, {"tags": ["vba", "excel", "excel-charts"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1510170630, "post_id": 47188151, "comment_id": 81326199, "body": ".SetSourceData i think belongs to the Chart e.g. myChart.SetSourceData <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/chart-setsourcedata-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510170809, "post_id": 47188151, "comment_id": 81326288, "body": "might it be something like Worksheets(sheet).ChartObjects(charts).SeriesCollection(1).X&zwnj;&#8203;Values = NewRng.Value or as above in prior comment? Are charts and series parameters singular? So when used would be something like Chartobjects(Chart1), SeriesCollection(1) ........"}, {"owner": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510171448, "post_id": 47188151, "comment_id": 81326635, "body": "Yes they&#39;re singular variables, the thing is the charts themselves contain multiple series being graphed therefore i have to do a seriesCollecetion  Also i tried the second meathod you posted Worksheets(sheet).ChartObjects(charts).SeriesCollection(1).X&zwnj;&#8203;\u200c\u200bValues = NewRng.Value same error"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510174610, "post_id": 47188151, "comment_id": 81328372, "body": "XValues is for the series labels."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "edited": false, "score": 0, "creation_date": 1510177607, "post_id": 47190112, "comment_id": 81329832, "body": "Might i ask what the diffrence is with FullSeriesCollection vs SeriesCollection? Because when i use FullSeriesCollection i get the error <i>Compile error: Method or data member not found</i> and it highlights .FullSeriesCollection(sers) This might have something to do with me using Excel 2010 though"}, {"owner": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "edited": false, "score": 0, "creation_date": 1510177808, "post_id": 47190112, "comment_id": 81329945, "body": "Also changing to .SeriesCollection gives me <i>Run-time error &#39;1004&#39;: Application-defined or object-defined error</i>"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "edited": false, "score": 0, "creation_date": 1510246417, "post_id": 47190112, "comment_id": 81363799, "body": "2010... hmmm.  That could be the problem.  I am using 2016.  Is this a line chart, bar chart, etc?"}, {"owner": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "edited": false, "score": 0, "creation_date": 1510247070, "post_id": 47190112, "comment_id": 81364274, "body": "Welcome to the life of a Government intern XD. lol its a basic line chart. with 6 data points. I just want to move the seires over to using the 6 most recent data points."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "edited": false, "score": 0, "creation_date": 1510247423, "post_id": 47190112, "comment_id": 81364493, "body": "Could you try recording a macro while you change it manually?"}, {"owner": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "edited": false, "score": 0, "creation_date": 1510248748, "post_id": 47190112, "comment_id": 81365356, "body": "Sub ChangeRange() &#39; &#39; ChangeRange Macro &#39;  &#39;     ActiveSheet.ChartObjects(&quot;Graphique 3&quot;).Activate     ActiveChart.PlotArea.Select     ActiveChart.SeriesCollection(1).Values = &quot;=&#39;Stewardship-Online&#39;!$AP$29:$AU$29&quot; End Sub   This is what i got so i how do i incorperate my variables into that? I tried doing this:        Worksheets(sht).ChartObjects(cht).Activate       ActiveChart.PlotArea.Select       ActiveChart.SeriesCollection(sers).Values = &quot;=sht NewRng&quot;"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "edited": false, "score": 0, "creation_date": 1510250324, "post_id": 47190112, "comment_id": 81366236, "body": "This will get the address of the cell 5 columns to the left of the active cell (ActiveCell.Offset(0, -5)), is that what you want?  if active cell is x=AU29 then y is AP29 and the range needs to be AP29:AU29.  which is y.address &amp; &quot;:&quot; &amp; x.address.  You need to check all your variables to make sure they are getting the correct values you expect them to."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "edited": false, "score": 0, "creation_date": 1510250743, "post_id": 47190112, "comment_id": 81366465, "body": "ActiveChart.SeriesCollection(sers).Values = NewRng, since you build this as a text variable.  See addition to answer"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1510250939, "last_edit_date": 1510250939, "creation_date": 1510177017, "answer_id": 47190112, "question_id": 47188151, "link": "https://stackoverflow.com/questions/47188151/having-trouble-updating-a-chart-series-using-vba/47190112#47190112", "title": "Having Trouble updating a chart Series using VBA", "body": "<p>New Answer</p>\n\n<p>Change variable names for sheet to sht, charts to cht and series to sers\nSheet, Charts and Series are all reserved words for VBA/Excel.</p>\n\n<p>Make the NewRng a text variable that holds the sheet name and range</p>\n\n<pre><code>NewRng = \"=\" &amp; sht &amp; \"!\" &amp; x.Address &amp; \":\" &amp; y.Address\n\nWorksheets(sht).ChartObjects(cht).Activate\nActiveChart.FullSeriesCollection(sers).Values = NewRng\n</code></pre>\n\n<p>I scaled this down to :</p>\n\n<pre><code>Sheets(sht).ChartObjects(cht).Activate\nActiveChart.SeriesCollection(sers).Values = \"='\" &amp; sht &amp; \"'!\" &amp; ActiveCell.Address &amp; \":\" &amp; ActiveCell.Offset(0, -5).Address\n</code></pre>\n\n<p>As long as sht get a value like 'Stewardship-Online', chart gets a text value of Graphique 3 and sers is an integer of 1 through 6 (you have 6 lines in your chart.</p>\n"}], "owner": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 780, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510250939, "creation_date": 1510169521, "last_edit_date": 1510169536, "question_id": 47188151, "link": "https://stackoverflow.com/questions/47188151/having-trouble-updating-a-chart-series-using-vba", "title": "Having Trouble updating a chart Series using VBA", "body": "<p>Pretty much I've written a function that when run goes and fetches the most recent data from another sheet and then goes about adjusting the series of a chart so that it graphs the last 6months worth of data. Every thing works until it gets to updating the Chart. I get</p>\n\n<blockquote>\n  <p>Run-time error '438' Object doesn't support this property or method</p>\n</blockquote>\n\n<p>Here's my code</p>\n\n<pre><code>Sub Update(startCell, data, sheet, charts, series)\n    ActiveWorkbook.Sheets(sheet).Activate\n    Range(startCell).Select\n    Do While (Not IsEmpty(ActiveCell))\n        ActiveCell.Offset(0, 1).Select\n    Loop\n    Dim x As Range\n    Dim y As Range\n    Dim NewRng As Range\n\n    Set x = ActiveCell\n    Set y = ActiveCell.Offset(0, -5)\n    Set NewRng = Range(x.Address &amp; \":\" &amp; y.Address)\n\n    ActiveCell.Value() = data\n    Worksheets(sheet).ChartObjects(charts).SeriesCollection(series).SetSourceData     Source:=NewRng.Address()\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1510169605, "post_id": 47188092, "comment_id": 81325632, "body": "Set a boolean variable to true if there is a match, after the loop if its false then ws2.Rows(lastRowWs2 + 1).Cells(1).Value = &quot;No match&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 13687, "user_id": 1136527, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/LpVhn.jpg?s=128&g=1", "display_name": "Alex McMillan", "link": "https://stackoverflow.com/users/1136527/alex-mcmillan"}, "is_accepted": true, "score": 0, "last_activity_date": 1510169577, "creation_date": 1510169577, "answer_id": 47188168, "question_id": 47188092, "link": "https://stackoverflow.com/questions/47188092/excel-vba-output-string-if-search-not-found/47188168#47188168", "title": "Excel VBA Output String If Search Not Found", "body": "<p>Keep track of whether or not you found matches, and add the text after your loop.</p>\n\n<p>Eg: </p>\n\n<pre><code>Dim foundMatches as Boolean\nfoundMatches = False\n\nFor i = firstRowWs1 To lastRowWs1\n    For Each check In strSearch\n        If check = ws1.Cells(i, searchColumnWs1).Value Then\n            foundMatches = True\n            ... etc\n        End If\n    Next check\nNext i\n\nIf Not foundMatches then\n  ' print \"no rows found\" somewhere\nend if\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4816757, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab5dca59532a451aca3bae0ee684187?s=128&d=identicon&r=PG&f=1", "display_name": "ac1243", "link": "https://stackoverflow.com/users/4816757/ac1243"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 47188168, "answer_count": 1, "score": 0, "last_activity_date": 1510169577, "creation_date": 1510169274, "last_edit_date": 1531164843, "question_id": 47188092, "link": "https://stackoverflow.com/questions/47188092/excel-vba-output-string-if-search-not-found", "title": "Excel VBA Output String If Search Not Found", "body": "<p>My code currently searches through Sheet1 and copies rows into Sheet2 if it matches the array of strings in strSearch. How can I make it so that it outputs \"No Search Found\" as a row on Sheet2 if there are no rows that contain the strSearch?</p>\n\n<pre><code>Dim ws1 As Worksheet, ws2 As Worksheet\nDim firstRowWs1 As Long\nDim lastRowWs1 As Long\nDim lastRowWs2 As Long\nDim searchColumnWs1 As Integer\nDim i As Integer\nDim check As Variant\nDim strSearch As Variant\nSet ws1 = Worksheets(\"Sheet1\")\n\n\nSet ws2 = Worksheets(\"Sheet2\")\nWith ws2\nlastRowWs1 = ws1.UsedRange.Rows.Count\nlastRowWs2 = ws2.UsedRange.Rows.Count\nfirstRowWs1 = 1\nsearchColumnWs1 = 10\nstrSearch = Array(\"John\", \"Jim\")\n\nFor i = firstRowWs1 To lastRowWs1\n    For Each check In strSearch\n        If check = ws1.Cells(i, searchColumnWs1).Value Then\n            ws1.Rows(i).Copy (ws2.Rows(lastRowWs2 + 1))\n            ws2.Rows(lastRowWs2 + 1).Columns(\"A:B\").Insert xlToRight\n            lastRowWs2 = lastRowWs2 + 1\n            ws1.Rows(i).Delete shift:=xlUp\n            i = i - 1\n            Exit For\n        End If\n    Next check\nNext i\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1510168844, "creation_date": 1510168844, "answer_id": 47187973, "question_id": 47187824, "link": "https://stackoverflow.com/questions/47187824/how-do-i-fix-the-following-to-make-it-sequential/47187973#47187973", "title": "How do I fix the following to make it sequential?", "body": "<p>Something like:</p>\n\n<pre><code>Sub poiuyt()\n    Range(\"M19:M20\").Formula = \"=IFNA(INDEX('beach'!B:B,MATCH(F19,'beach'!$G:$G,0)),0)\"\nEnd Sub\n</code></pre>\n\n<p>will auto-adjust the <strong>F</strong> index:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KMY3J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KMY3J.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1510169479, "last_edit_date": 1510169479, "creation_date": 1510168989, "answer_id": 47188009, "question_id": 47187824, "link": "https://stackoverflow.com/questions/47187824/how-do-i-fix-the-following-to-make-it-sequential/47188009#47188009", "title": "How do I fix the following to make it sequential?", "body": "<p>You can also use <code>R1C1</code> style.</p>\n\n<p>Say you want that formula to apply in range <code>M19:M20</code> with your <code>F19</code> reference updating to each row:</p>\n\n<pre><code>Range(\"M19:M20\").FormulaR1C1 = \"=IFNA(INDEX(beach!C[-11],MATCH(RC[-7],beach!C7,0)),0)\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8909194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eceaeff8ac5b6aa0aee56194f79cc4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Adam ", "link": "https://stackoverflow.com/users/8909194/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510171411, "creation_date": 1510168389, "last_edit_date": 1510171411, "question_id": 47187824, "link": "https://stackoverflow.com/questions/47187824/how-do-i-fix-the-following-to-make-it-sequential", "title": "How do I fix the following to make it sequential?", "body": "<p>I was wondering if you could help with the following. I have just started using VBA but I am having an issue with applying the following formula to the dataset. </p>\n\n<pre><code>Selection.Formula = \"=IFNA(INDEX('beach'!B:B,MATCH(F19,'beach'!$G:$G,0)),0)\" \n</code></pre>\n\n<p>F19 is a set cell, however, I need F19 to be sequential, as in that when the calculation is completed in cell <code>M20</code> rather than <code>M19</code>, the formula is updated to calculate using <code>F20</code>. </p>\n\n<p>Also, following on from that how do I edit the above formula to allow the macros to be applied to all cells in a Column?</p>\n"}, {"tags": ["excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1510171176, "post_id": 47187587, "comment_id": 81326470, "body": "You have to Do Until data-page is = &quot;1&quot;, because it starts on 2 and go to 1 when is completely loaded. <code>&lt;a href=&quot;&quot; class=&quot;link-bordered-load&quot; id=&quot;load-more-practice&quot; data-page=&quot;1&quot;&gt;Show More&lt;&#47;a&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8909016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nslpmXIP8ME/AAAAAAAAAAI/AAAAAAAADxk/JAkxQpa3-H4/photo.jpg?sz=128", "display_name": "Ahmad Ijaz", "link": "https://stackoverflow.com/users/8909016/ahmad-ijaz"}, "edited": false, "score": 1, "creation_date": 1510252105, "post_id": 47200063, "comment_id": 81367240, "body": "danieltakeshi got your point. program just went well. hats off to you dear (Y)"}, {"owner": {"reputation": 23, "user_id": 8909016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nslpmXIP8ME/AAAAAAAAAAI/AAAAAAAADxk/JAkxQpa3-H4/photo.jpg?sz=128", "display_name": "Ahmad Ijaz", "link": "https://stackoverflow.com/users/8909016/ahmad-ijaz"}, "edited": false, "score": 0, "creation_date": 1510253146, "post_id": 47200063, "comment_id": 81367776, "body": "Set ShowMore = htmlDoc.getElementById(&quot;load-more-practice&quot;)  everything is perfect but sometimes excel vba stuck at this line and asks for debugging and sometimes it went well. can you please tell what is wrong in here?"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "reply_to_user": {"reputation": 23, "user_id": 8909016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nslpmXIP8ME/AAAAAAAAAAI/AAAAAAAADxk/JAkxQpa3-H4/photo.jpg?sz=128", "display_name": "Ahmad Ijaz", "link": "https://stackoverflow.com/users/8909016/ahmad-ijaz"}, "edited": false, "score": 0, "creation_date": 1510254035, "post_id": 47200063, "comment_id": 81368276, "body": "You ie is not loading it completely, try to give more time to load <code>WaitIE IE, 2000</code> to <code>WaitIE IE, 5000</code>, if it continues, increase the time of wait between Clicks."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "reply_to_user": {"reputation": 23, "user_id": 8909016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nslpmXIP8ME/AAAAAAAAAAI/AAAAAAAADxk/JAkxQpa3-H4/photo.jpg?sz=128", "display_name": "Ahmad Ijaz", "link": "https://stackoverflow.com/users/8909016/ahmad-ijaz"}, "edited": false, "score": 0, "creation_date": 1510255584, "post_id": 47200063, "comment_id": 81369132, "body": "You can refer to <a href=\"https://stackoverflow.com/questions/47182132/navigating-through-websites/47183925#47183925\">this</a> issue, that was the same as yours. If you step the program with F8, it won&#39;t bug."}, {"owner": {"reputation": 23, "user_id": 8909016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nslpmXIP8ME/AAAAAAAAAAI/AAAAAAAADxk/JAkxQpa3-H4/photo.jpg?sz=128", "display_name": "Ahmad Ijaz", "link": "https://stackoverflow.com/users/8909016/ahmad-ijaz"}, "edited": false, "score": 0, "creation_date": 1510329158, "post_id": 47200063, "comment_id": 81403250, "body": "yup that was it .... my IE was loading properly ... much appreciated dear ... (Y)"}], "tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": true, "score": 0, "last_activity_date": 1510225100, "creation_date": 1510225100, "answer_id": 47200063, "question_id": 47187587, "link": "https://stackoverflow.com/questions/47187587/clicking-button-on-a-webpage-multiple-times-in-excel-vba/47200063#47200063", "title": "clicking button on a webpage multiple times in excel vba", "body": "<p>Try this code that  Do Until data-page is = \"1\", because it starts on 2 and go to 1 when is completely loaded, with all Show More clicked.</p>\n\n<pre><code>Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nSub test()\nDim IE As Object\nDim county As String\nDim htmlDoc As Object\nDim sURL As String\n\n' CREATING OBJECT\nSet IE = CreateObject(\"internetexplorer.application\")\n\nsURL = \"http://www.physiofirst.org.uk/find-physio/search-physio.html\"\n' WEBPAGE NAVIGATION\nWith IE\n.navigate (sURL)\n.Visible = True\nEnd With\n\nWaitIE IE, 2000\n\n' SEARCHING ALL THE THE INDIVIDUAL STATE PHYSICIANS\nSet htmlDoc = IE.document\nSet searchbarvalue = htmlDoc.getElementsByClassName(\"form-control mod-text-display\")\ni = 0\nFor Each classSearch In searchbarvalue\n    searchbarvalue(i).Value = \"BRISTOL\"\nNext classSearch\n\nWaitIE IE, 1000\n\nSet buttonclick = htmlDoc.getElementsByClassName(\"btn btn-search\")\n\nbuttonclick(0).Click\nWaitIE IE, 1000\nSet ShowMore = htmlDoc.getElementById(\"load-more-practice\")\n\nDo\nShowMore.Click\nWaitIE IE, 2000\nLoop Until ShowMore.getAttribute(\"data-page\") = 1\n\n'IE.Quit\n'Set IE = Nothing\nEnd Sub\n\nSub WaitIE(IE As Object, Optional time As Long = 250)\n'Code from: https://stackoverflow.com/questions/33808000/run-time-error-91-object-variable-or-with-block-variable-not-set\nDim i As Long\nDo\n    Sleep time\n    Debug.Print CStr(i) &amp; vbTab &amp; \"Ready: \" &amp; CStr(IE.readyState = 4) &amp; _\n                vbCrLf &amp; vbTab &amp; \"Busy: \" &amp; CStr(IE.Busy)\n    i = i + 1\nLoop Until IE.readyState = 4 Or Not IE.Busy\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8909016, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nslpmXIP8ME/AAAAAAAAAAI/AAAAAAAADxk/JAkxQpa3-H4/photo.jpg?sz=128", "display_name": "Ahmad Ijaz", "link": "https://stackoverflow.com/users/8909016/ahmad-ijaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "accepted_answer_id": 47200063, "answer_count": 1, "score": 2, "last_activity_date": 1510225100, "creation_date": 1510167482, "last_edit_date": 1531164843, "question_id": 47187587, "link": "https://stackoverflow.com/questions/47187587/clicking-button-on-a-webpage-multiple-times-in-excel-vba", "title": "clicking button on a webpage multiple times in excel vba", "body": "<p>I'm trying to click a button multiple times to get my page loaded fully. Webpage contains a button <code>SHOW MORE</code> instead of next page so in html coding behind the button remains same.</p>\n\n<p>I am using the following excel-vba code to hit that button. It actually did click that button, but instead of showing the next results it shows the same result over and over again.</p>\n\n<p>Could you please kindly show me how to make it right. Thanks in advance!</p>\n\n<pre><code>    **' VARIABLE DECLARATION\n    Dim IE As Object\n    Dim county As String\n    Dim htmlDoc As Object\n\n    ' CREATING OBJECT\n    Set IE = CreateObject(\"internetexplorer.application\")\n\n    ' WEBPAGE NAVIGATION\n    With IE\n    .navigate (\"http://www.physiofirst.org.uk/find-physio/search-physio.html\")\n    .Visible = True\n    End With\n\n    ' WAITING FOR WEBPAGE TO LOAD\n    Do\n    DoEvents\n    Loop Until IE.readystate = 4\n\n    ' SEARCHING ALL THE THE INDIVIDUAL STATE PHYSICIANS\n    Set htmlDoc = IE.document\n    Set searchbarvalue = htmlDoc.getelementsbyclassname(\"form-control mod-text-display\")\n    i = 0\n    For Each classSearch In searchbarvalue\n        searchbarvalue(i).Value = \"BRISTOL\"\n    Next classSearch\n    While IE.busy\n        DoEvents\n    Wend\n\n    Set buttonclick = htmlDoc.getelementsbyclassname(\"btn btn-search\")\n    i = 0\n    For Each buttonsearch In buttonclick\n        buttonclick(i).Click\n    Next buttonsearch\n    While IE.busy\n        DoEvents\n    Wend\n    Do\n    htmlDoc.getelementbyid(\"load-more-practice\").Click\n    While IE.busy\n    DoEvents\n    Wend\n    Loop Until htmlDoc.getelementbyid(\"load-more-practice\").Click = True\nEnd Sub**\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 1, "creation_date": 1510167001, "post_id": 47187368, "comment_id": 81324018, "body": "You just have to replace ThisWorkbook with objWorkbook."}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 3861726, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f64efd01a8ddfeb65cf06031d333f4b6?s=128&d=identicon&r=PG&f=1", "display_name": "dc4teg", "link": "https://stackoverflow.com/users/3861726/dc4teg"}, "is_accepted": false, "score": 0, "last_activity_date": 1510170689, "last_edit_date": 1510170689, "creation_date": 1510167223, "answer_id": 47187511, "question_id": 47187368, "link": "https://stackoverflow.com/questions/47187368/convert-vba-unmerge-and-fil-to-vbscript-unmerge-and-fill/47187511#47187511", "title": "Convert VBA unmerge and fil to VBscript unmerge and fill", "body": "<p>VBscript Code:</p>\n\n<pre><code>'Microsoft Excel Automation\n':: Open, unmerge cells and fill then save\n'---------------------------------\n'create the excel object\n    Set objExcel = CreateObject(\"Excel.Application\") \n\n'view the excel program and file, set to false to hide the whole process\n    objExcel.Visible = True \n\n'open an excel file (make sure to change the location) .xls for 2003 or earlier\n    Set objWorkbook = objExcel.Workbooks.Open(\"C:\\Users\\Desktop\\Book3.xlsx\")\n\nDim cell\nDim joinedCells\n\nFor Each cell In objWorkbook.ActiveSheet.UsedRange\n    If cell.MergeCells Then\n        Set joinedCells = cell.MergeArea\n        cell.MergeCells = False\n        joinedCells.Value = cell.Value\n    End If\nNext\n\n'save the existing excel file\n    objWorkbook.Save\n\n'close the workbook\n    objWorkbook.Close \n\n'exit the excel program\n    objExcel.Quit\n\n'release objects\n    Set objExcel = Nothing\n    Set objWorkbook = Nothing\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 3861726, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/f64efd01a8ddfeb65cf06031d333f4b6?s=128&d=identicon&r=PG&f=1", "display_name": "dc4teg", "link": "https://stackoverflow.com/users/3861726/dc4teg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 465, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510170689, "creation_date": 1510166734, "question_id": 47187368, "link": "https://stackoverflow.com/questions/47187368/convert-vba-unmerge-and-fil-to-vbscript-unmerge-and-fill", "title": "Convert VBA unmerge and fil to VBscript unmerge and fill", "body": "<p>Hello I am trying to convert VBA to VBscript but having trouble as I do not know where to start. Any help is appreciated.</p>\n\n<p><strong>VBA:</strong> Un-merging cells and then filling data to those cells from original merged data cell.</p>\n\n<pre><code>Sub UnMergeFill()\n\nDim cell As Range, joinedCells As Range\n\nFor Each cell In ThisWorkbook.ActiveSheet.UsedRange\n    If cell.MergeCells Then\n        Set joinedCells = cell.MergeArea\n        cell.MergeCells = False\n        joinedCells.Value = cell.Value\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p><strong>VBScript:</strong> I have the start of the code to open the correct excel file and save and close but not the modification the VBA script is doing.</p>\n\n<pre><code>'create the excel object\n    Set objExcel = CreateObject(\"Excel.Application\") \n\n'view the excel program and file, set to false to hide the whole process\n    objExcel.Visible = True \n\n'open an excel file (make sure to change the location) .xls for 2003 or earlier\n    Set objWorkbook = objExcel.Workbooks.Open(\"C:\\Users\\Desktop\\vbsTest.xlsx\")\n\n'save the existing excel file\n    objWorkbook.Save\n\n'close the workbook\n    objWorkbook.Close \n\n'exit the excel program\n    objExcel.Quit\n\n'release objects\n    Set objExcel = Nothing\n    Set objWorkbook = Nothing\n</code></pre>\n"}, {"tags": ["string", "vba", "date", "formatting"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1510166757, "post_id": 47187249, "comment_id": 81323870, "body": "Yes, it&#39;s possible in the <code>Do Until</code> loop; there&#39;s no reason to process the file twice. What specific problem are you having? I don&#39;t see anything that indicates you&#39;ve made an effort to solve this problem yourself at all."}, {"owner": {"reputation": 10781, "user_id": 447901, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/11ea5dd4ad290e75422e32e1e340772e?s=128&d=identicon&r=PG", "display_name": "lit", "link": "https://stackoverflow.com/users/447901/lit"}, "edited": false, "score": 0, "creation_date": 1510167014, "post_id": 47187249, "comment_id": 81324030, "body": "Please copy and paste as text the header row and a few records of the source .csv file."}, {"owner": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1510167094, "post_id": 47187249, "comment_id": 81324065, "body": "@KenWhite All I have is an idea on how to go about doing this. My thought is to go through each line, as I already have this, and look for the slash symbols, and based on how far apart they are, add a zero? As I said, only a thought as I don&#39;t have experience doing file manipulation other than changing the delimiter"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1510167309, "post_id": 47187249, "comment_id": 81324217, "body": "You have four relatively simple tasks to accomplish here: 1) Locate the date. 2) Copy it into a variable. 3) Modify it to the format you need. 4) Put it back into the string. So start with the first task. When you&#39;ve got code that completes it, add the second, then the third, and then the last. Programming is all about breaking something down into small tasks, writing code to complete those tasks, and putting them together to do the job. So start with task #1.Figure out how you&#39;re going to locate the date value in code."}, {"owner": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1510167828, "post_id": 47187249, "comment_id": 81324554, "body": "@KenWhite Thanks for the advise, I have been programming for a while now, but still can get lost in the steps to take when it&#39;s language/situation I have not come across yet, I will try to work through it"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 6100466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98057cf7ed52d73a4b08175ffa19e9fa?s=128&d=identicon&r=PG&f=1", "display_name": "AssemblyRequired", "link": "https://stackoverflow.com/users/6100466/assemblyrequired"}, "is_accepted": false, "score": 0, "last_activity_date": 1510170665, "last_edit_date": 1510170665, "creation_date": 1510170255, "answer_id": 47188380, "question_id": 47187249, "link": "https://stackoverflow.com/questions/47187249/locate-dates-within-txt-file-and-format-them/47188380#47188380", "title": "Locate Dates within .txt file and Format them", "body": "<p>Have you thought about running a \"text to column\" function, simply altering the formats to the date columns, then outputting the file? This might be a lot easier than searching for characters and altering them the way you are doing. </p>\n\n<pre><code>With Range(pass the range here)\n.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\"|\", FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(..., ...),_\n    TrailingMinusNumbers:=True\n\nColumns(\"x:x\").NumberFormat = \"mm/dd/yyyy\"\n</code></pre>\n\n<p>From here you can save the file.</p>\n\n<p>EDIT: </p>\n\n<p>One caveat: you need to hard code the number of columns you will end up with into the array.</p>\n\n<p>For example, if each row of the file contains 4 sections, you would use:</p>\n\n<pre><code>Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1)), TrailingMinusNumbers:=True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510172166, "post_id": 47188462, "comment_id": 81327030, "body": "The Split function is exactly what I need, thanks! The only unfortunate thing is that some of the fields do contain commas and quotations, preventing me from Splitting by the comma. Also, every field has quotations around it, which are removed by the 2 replace lines"}, {"owner": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510172255, "post_id": 47188462, "comment_id": 81327073, "body": "This being said, should I run a second Do Until loop, splitting by the Pipe? this way, No extra commas or quotations are removed that shouldn&#39;t be"}, {"owner": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510172909, "post_id": 47188462, "comment_id": 81327423, "body": "just realized that the line: strLine = Replace(strLine, chr(34), &quot;&quot;)  will probably cause an issue and remove quotations that are in the field, is there a way around this? would the lines: strReplacer = Chr(34) &amp; &quot;,&quot; &amp; Chr(34)    &amp;     strLine = Replace(strLine, strReplacer, &quot;|&quot;) take care of it for me and remove the second Replace line? (sorry for the barrage of comments)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510174321, "post_id": 47188462, "comment_id": 81328213, "body": "Ahh - I had missed that - you are currently changing the string <code>&quot;,&quot;</code> to <code>|</code> - I had read that as you were just changing <code>,</code> to <code>|</code>.  I think I just need to resequence some lines.  Give me a second and I will post an update to the answer."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510174601, "post_id": 47188462, "comment_id": 81328365, "body": "@johno - OK, I had to put most of your code back in. :D  And then the split / convert / join just gets tacked onto the end of your code."}, {"owner": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510176029, "post_id": 47188462, "comment_id": 81329102, "body": "This all looks extremely promising. I will have to play with things to make it work once I get in tomorrow since I am using VBScript on UFT, which doesn&#39;t like me specifying a variable As String or anything, cauing hickups. Marking this as solution however since it gives me all of the info I should need"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510177603, "post_id": 47188462, "comment_id": 81329828, "body": "I have updated my answer to include a VBScript version of the code as well as the VBA version.  (I was going to edit your question to replace the [vba] tag with a [vbscript] one, but that would invalidate the answer by @AssemblyRequired so I have left it alone.)"}, {"owner": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510232839, "post_id": 47188462, "comment_id": 81353553, "body": "The funny thing is I originally had it as VBScript, but someone edited my question and changed it to VBA -_-"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510252097, "post_id": 47188462, "comment_id": 81367235, "body": "@johno I just looked at the edit history - the question started off with both [vba] and [vbscript] tags, but mentioned VBScript in the question.  The person who edited it to fix the tags probably should have guessed from that mention that it was the [vba] tag that was wrong, but the code is so similar to VBA that they appear to have thought that it wasn&#39;t VBScript.  (The only statement in the code that wouldn&#39;t work in VBA is the <code>Print</code> statement.  And the only other clue is probably the <code>vbCrLF</code> instead of <code>vbCrLf</code>.)  Oh well, the question got answered anyway, so hopefully all is good."}, {"owner": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "edited": false, "score": 0, "creation_date": 1510253272, "post_id": 47188462, "comment_id": 81367838, "body": "ah yes, I do vaguely remember putting both tags, I apologize for that mixup. I&#39;m new to VBScript, so these slight differences can be confusing to me. As for the answer, yes, everything is working as it should. Thanks again for the help!!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1510177549, "last_edit_date": 1510177549, "creation_date": 1510170603, "answer_id": 47188462, "question_id": 47187249, "link": "https://stackoverflow.com/questions/47187249/locate-dates-within-txt-file-and-format-them/47188462#47188462", "title": "Locate Dates within .txt file and Format them", "body": "<p>One thing you could do is split the original line into the columns, then you only need to consider the 10th and 11th columns:</p>\n\n<pre><code>Dim myArray() As String\n'...\nstrLine = objFile.ReadLine\n'Current delimiter is quote-comma-quote\nstrReplacer = Chr(34) &amp; \",\" &amp; Chr(34)\n'Replace current delimiter with a pipe delimiter\nstrLine = Replace(strLine, strReplacer, \"|\")\n'Remove any remaining quote marks\nstrLine = Replace(strLine, Chr(34), \"\")\n'Split line using pipe delimiter\nmyArray = Split(strLine, \"|\")\n'Convert column 10\nmyArray(9) = Format(CDate(Left(myArray(9), InStr(myArray(9), \" \") - 1)), \"mm/dd/yyyy\")\n'Convert column 11\nmyArray(10) = Format(CDate(Left(myArray(10), InStr(myArray(10), \" \") - 1)), \"mm/dd/yyyy\")\n'Join line back together with pipe delimiter\nstrLine = Join(myArray, \"|\")\n'Create one huge string containing all lines in file\nstrNewText = strNewText &amp; strLine &amp; vbCrLF\n'...\n</code></pre>\n\n<hr>\n\n<p>To use this as VBScript will require a few minor changes:</p>\n\n<pre><code>'Dim myArray() As String\nDim myArray\n'...\nstrLine = objFile.ReadLine\n'Current delimiter is quote-comma-quote\nstrReplacer = Chr(34) &amp; \",\" &amp; Chr(34)\n'Replace current delimiter with a pipe delimiter\nstrLine = Replace(strLine, strReplacer, \"|\")\n'Remove any remaining quote marks\nstrLine = Replace(strLine, Chr(34), \"\")\n'Split line using pipe delimiter\nmyArray = Split(strLine, \"|\")\n'Convert column 10\n'myArray(9) = Format(CDate(Left(myArray(9), InStr(myArray(9), \" \") - 1)), \"mm/dd/yyyy\")\nmyArray(9) = FormatDateTime(CDate(Left(myArray(9), InStr(myArray(9), \" \") - 1)), 0)\n'Convert column 11\n'myArray(10) = Format(CDate(Left(myArray(10), InStr(myArray(10), \" \") - 1)), \"mm/dd/yyyy\")\nmyArray(10) = FormatDateTime(CDate(Left(myArray(10), InStr(myArray(10), \" \") - 1)), 0)\n'Join line back together with pipe delimiter\nstrLine = Join(myArray, \"|\")\n'Create one huge string containing all lines in file\nstrNewText = strNewText &amp; strLine &amp; vbCrLF\n'...\n</code></pre>\n\n<p>I don't use VBScript myself, but I <strong>believe</strong> the <code>FormatDateTime</code> function will give you what you want as output.  It seems to be locale-specific, but I assume you use <code>mm/dd/yyyy</code> format as standard in your location.</p>\n"}], "owner": {"reputation": 17, "user_id": 8844312, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caf55ea41a21f0b7f7e4e9ab8fbe5278?s=128&d=identicon&r=PG&f=1", "display_name": "johno", "link": "https://stackoverflow.com/users/8844312/johno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 47188462, "answer_count": 2, "score": -1, "last_activity_date": 1510177549, "creation_date": 1510166310, "last_edit_date": 1510167704, "question_id": 47187249, "link": "https://stackoverflow.com/questions/47187249/locate-dates-within-txt-file-and-format-them", "title": "Locate Dates within .txt file and Format them", "body": "<p>First off, I know there's a million questions about formatting dates, but I have not found a solution that works with my situation.</p>\n\n<p>We are given a .csv file, and due to requirements, we must modify the file in a couple of ways.</p>\n\n<p>Firstly, we run a VBA on the file in order to change the delimiter from \",\" to \"|\" (we have this working) using:</p>\n\n<pre><code>Const ForReading = 1\nConst ForWriting = 2\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\nSet objFile = objFSO.OpenTextFile(\"C:\\Users\\Z00393885\\Desktop\\csvStuff\\\"&amp;myVar, ForReading)\n\ncount = 0\nDo Until objFile.AtEndOfStream\n    strLine = objFile.ReadLine\n    strReplacer = Chr(34) &amp; \",\" &amp; Chr(34)\n    strLine = Replace(strLine, strReplacer, \"|\")\n    strLine = Replace(strLine, chr(34), \"\")\n    strNewText = strNewText &amp; strLine &amp; vbCrLF\n    count = count + 1\nLoop\nPrint (count - 1)\nobjFile.Close\n\nSet objFile = objFSO.OpenTextFile(\"C:\\Users\\Z00393885\\Desktop\\csvStuff\\\"&amp;myVar, ForWriting)\n\nobjFile.WriteLine \"BOF\" &amp; vbCrLF &amp; now() &amp; vbCrLF &amp; (count - 1) &amp; vbCrLF &amp; strNewText &amp; \"EOF\"\n\nobjFile.Close\n</code></pre>\n\n<p>The second requirement is the one that's giving me trouble, I have to look for every Date that is present (they are formatted: 11/8/2017 1:30 EST and lie within the 10th and 11th columns) and format the date so that it would be 11/08/2017 (we need to remove the Time as well as make sure that the day and month has a 0 if its only a single digit)</p>\n\n<p>Is this doable within the Do Until loop? or would it be better to have a separate function to take care of that part. Either way, I am not even sure where to start with manipulating Dates within a file like this and not just a variable</p>\n\n<p>EDIT: here is some of the .csv file</p>\n\n<p>BOF</p>\n\n<p>11/1/2017 12:08:21 PM</p>\n\n<p>3</p>\n\n<p>Course Code|Home Org|...|Release Date|Effective Date|...|Web Address</p>\n\n<p>123|TAD Sites|...|10/31/2017 00:00:00 EDT|11/14/2017 00:00:00 EDT|...|<a href=\"http://URL\" rel=\"nofollow noreferrer\">http://URL</a></p>\n\n<p>456|DAT Sites|...|11/5/2017 00:00:00 EDT|11/5/2017 00:00:00 EDT|...|<a href=\"http://URL\" rel=\"nofollow noreferrer\">http://URL</a></p>\n\n<p>EOF</p>\n"}, {"tags": ["vba", "image", "excel", "aspect-ratio"], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1510217352, "post_id": 47187290, "comment_id": 81343545, "body": "Thanks! Worked perfectly"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 3, "last_activity_date": 1510166433, "creation_date": 1510166433, "answer_id": 47187290, "question_id": 47187148, "link": "https://stackoverflow.com/questions/47187148/resizing-image-in-vba-maintaining-aspect-ratio/47187290#47187290", "title": "Resizing image in VBA maintaining aspect ratio", "body": "<p>Try it like this:</p>\n\n<pre><code>With ActiveSheet.Pictures.Insert(PicPath)\n    .ShapeRange.LockAspectRatio = msoTrue\n    .Width = 350\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11352, "favorite_count": 0, "accepted_answer_id": 47187290, "answer_count": 1, "score": 0, "last_activity_date": 1510166433, "creation_date": 1510165877, "question_id": 47187148, "link": "https://stackoverflow.com/questions/47187148/resizing-image-in-vba-maintaining-aspect-ratio", "title": "Resizing image in VBA maintaining aspect ratio", "body": "<p>I have a VBA macro that goes for an image in a file and sticks it into an Excel spreadsheet, in a worksheet called \"Country Profile\".\nI would like to resize the image so that it has a width of 350px, while maintaining its aspect ratio.</p>\n\n<p>This is the code that I wrote:</p>\n\n<pre><code>Public Sub Macro15()\n\nDim picname As String\nDim shp As Shape\nDim present As String\n\nSheets(\"Country Profile\").Activate\nSheets(\"Country Profile\").Select\nActiveSheet.Pictures.Delete\n\nCells(19, 40).Select 'This is where picture will be inserted (column)\n\npicname = Sheets(\"REPORT ON\").Range(\"A2\").Value 'This is the picture name\n\nCells(19, 46).Select\n\n            Call ActiveSheet.Shapes.AddPicture(\"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\Maps with Cities\\\" &amp; picname &amp; \".png\", _\n            LockAspectRatio = msoTrue, msoCTrue, Left:=Cells(19, 40).Left, Top:=Cells(19, 46).Top, Width:=350, Height:=-1).Select\n\nEnd Sub\n</code></pre>\n\n<p>The code works and the image is inserted in the desired file. However, the aspect ratio is not maintained. What can I do to correct this?</p>\n"}, {"tags": ["arrays", "excel", "vba", "validation"], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1510170380, "post_id": 47188206, "comment_id": 81326076, "body": "Hi Jeffreyweir- thank you for your comment. I forgot to mention another reason that I am trying to use VBA, as it wasnt in this peice of the code. I wanted to gain autocomplete functionality within this Excel &quot;form&quot; of sorts, so I found a way to overlay comboboxes on a cell that is selected if it contains data validation. (<a href=\"http://http://www.contextures.com/xlDataVal14.html\" rel=\"nofollow noreferrer\">http://www.contextures.com/xlDataVal14.html</a>)"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1510170383, "post_id": 47188206, "comment_id": 81326080, "body": "Using the methods to create tables and reference the named ranges with =indirect does not work, as comboboxes cannot take the =indirect. I figured out the array solution with VBA that I was looking for (and I&#39;ll post it here in a minute) but unfortunately, it too, doesnt work with comboboxes, so I am unable to utilize it. It would be nice if Excel could simply allow autocomplete for the datavalidation lists!"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1510169700, "creation_date": 1510169700, "answer_id": 47188206, "question_id": 47186911, "link": "https://stackoverflow.com/questions/47186911/excel-vba-accessing-arrays-that-are-populated-with-named-ranges/47188206#47188206", "title": "Excel VBA - Accessing Arrays that are Populated with Named Ranges", "body": "<p>If you google \"Array of Arrays\" you'll find lots of information on how to accomplish this, including this SO example: <a href=\"https://stackoverflow.com/questions/9435608/how-do-i-set-up-a-jagged-array-in-vba\">How do I set up a &quot;jagged array&quot; in VBA?</a></p>\n\n<p>But again, as per my comment at your other thread, why use VBA at all? Without good reason, it's simply not a good approach. You're over-complicating it. Use Dynamic Named Ranges, and look at the example I linked to in your other thread.</p>\n"}, {"tags": [], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "is_accepted": true, "score": 0, "last_activity_date": 1510170471, "creation_date": 1510170471, "answer_id": 47188428, "question_id": 47186911, "link": "https://stackoverflow.com/questions/47186911/excel-vba-accessing-arrays-that-are-populated-with-named-ranges/47188428#47188428", "title": "Excel VBA - Accessing Arrays that are Populated with Named Ranges", "body": "<p>I sorted out a solution, albeit, without using named ranges, but simply using arrays created within vba. But as far as the referencing I wanted, it works without issue! :)</p>\n\n<pre><code>Sub Test()\n\n    Dim Array_DV1 As Variant\n    Array_DV1 = Array(\"Array X\", \"Array Y\", \"Array Z\")\n\n        Range(\"DV_1\").Offset(1, 0).Select\n        With Selection.Validation\n            .Delete\n            .Add Type:=xlValidateList, Formula1:=Join(Array_DV1, \",\")\n            .IgnoreBlank = True\n            .InCellDropdown = True\n        End With\n\n    Dim Array_X As Variant\n    Array_X = Array(\"X1\", \"X2\", \"X3\")\n\n    Dim Array_Y As Variant\n    Array_Y = Array(\"Y1\", \"Y2\", \"Y3\", \"Y4\")\n\n    Dim Array_Z As Variant\n    Array_Z = Array(\"Z1\", \"Z2\", \"Z3\", \"Z4\", \"Z5\")\n\n        Dim Array_XYZ As Variant\n        Array_XYZ = Array(Array_X, Array_Y, Array_Z)\n\n        For i = LBound(Array_DV1) To UBound(Array_DV1)\n\n            If Range(\"DV_1\").Offset(1, 0).Value = Array_DV1(i) Then\n\n                Range(\"DV_2\").Offset(1, 0).Select\n                With Selection.Validation\n                    .Delete\n                    .Add Type:=xlValidateList, Formula1:=Join(Array_XYZ(i), \",\")\n                    .IgnoreBlank = True\n                    .InCellDropdown = True\n                End With\n\n            End If\n\n        Next\n\nEnd Sub\n</code></pre>\n\n<p>Side Note: The code will need something to update this code, should the user pick a different choice in the first dv list.</p>\n"}], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 47188428, "answer_count": 2, "score": 0, "last_activity_date": 1510170471, "creation_date": 1510165015, "question_id": 47186911, "link": "https://stackoverflow.com/questions/47186911/excel-vba-accessing-arrays-that-are-populated-with-named-ranges", "title": "Excel VBA - Accessing Arrays that are Populated with Named Ranges", "body": "<p>I have been struggling with an array issue, see here: (<a href=\"https://stackoverflow.com/questions/47163910/excel-vba-arrays-for-data-validation-reference/47166034?noredirect=1#comment81282288_47166034\">Excel VBA - Arrays for Data Validation Reference</a>)</p>\n\n<p>I want to try and simplify to see if it would make more sense.</p>\n\n<p>Lets say I have a set of ranges, each with a name; Range1, Range2, etc. I set each named range to an array; MyArray1, MyArray2, etc. I then put these arrays within an array; ContainerArray</p>\n\n<p>I have another array called ReferenceArray, which is based on the named range; RangeRef; which contains values Ref1, Ref2, Ref3</p>\n\n<p>Reference Array populates Data Validation List 1.</p>\n\n<p><strong>Problem Statement:</strong></p>\n\n<p>If the user selects (for example) Ref1 in Data Validation List 1, I want to trigger Data Validation List 2 to fill with the respective array within the ContainerArray (so it would fill with the values from MyArray1)...</p>\n\n<p>Something like:</p>\n\n<pre><code>If Data Validation List 1.Selection = ReferenceArray(i) then\n    Data Validation List 2 Options = ContainerArray(i)\nEndif\n</code></pre>\n\n<p>Any help is appreciated. Thank you in advance!</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510164245, "post_id": 47186566, "comment_id": 81322398, "body": "@braX <code>LOF</code>, no. But <code>Input</code>-ing twice the file size would."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510164322, "post_id": 47186566, "comment_id": 81322442, "body": "Well my original idea was to have the user input data into the TextBox and then it would save to the spreadsheet however it was exceeding it&#39;s cells limit. So I thought if I stored it in a text file instead it might solve my issue but it seems as though that I think I&#39;m still having the same issue here... This text file I&#39;m using is for testing purposes right now until I find a solution"}], "answers": [{"comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1510166044, "post_id": 47186750, "comment_id": 81323473, "body": "Simple mistake and your suggestion fixed it perfectly! One last question for you, is there a limit for characters in the TextBox? That&#39;s the only thing that has me a little worried; I&#39;ve tried Googling it and all that came up were limits to cells and nothing related to forms... even when I search exclusively for forms. Also, very well explained, much appreciated"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 1, "creation_date": 1510167957, "post_id": 47186750, "comment_id": 81324624, "body": "@Maldred From quick experimenting with <code>Me.TextBox1.Text = String(9999999, &quot;A&quot;)</code> I think it&#39;s safe to assume the upper limit would be whatever the maximum length of a <code>String</code> is. I get &quot;out of string space&quot; with <code>String((2 ^ 31 - 1), &quot;A&quot;)</code> (that would be a <code>Long</code> integer&#39;s max value), but that&#39;s likely just a limitation of the <code>String</code> function - by concatenating them I got over 3 million characters into it, so I&#39;m pretty sure you can fit everything you need in there."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1510180879, "post_id": 47186750, "comment_id": 81331293, "body": "Perfect, that makes me feel at ease... Appreciate all your help sir"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1510342893, "post_id": 47186750, "comment_id": 81410605, "body": "@Mat&#39;sMug, appreciated your helpful hints to textbox lengths (apparently not restricted by the limitation of the <code>String</code> function)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1510164459, "creation_date": 1510164459, "answer_id": 47186750, "question_id": 47186566, "link": "https://stackoverflow.com/questions/47186566/input-text-file-into-excel-form/47186750#47186750", "title": "Input Text File into Excel Form", "body": "<p><code>Input</code> moves the \"pointer\" as it reads the file.</p>\n\n<p>You read the entire file here:</p>\n\n<pre><code>FileContent = Input(LOF(TextFile), TextFile)\n</code></pre>\n\n<p>Then once again here:</p>\n\n<pre><code>UserForm1.TextBox1 = Input(LOF(TextFile), TextFile)\n</code></pre>\n\n<p>But by then <code>FileContent</code> already has your entire content, and file handle#<code>TextFile</code> is already at EOF. So when you try to input again, you're <em>inputting past the end of the file</em>.</p>\n\n<p>Just close the file immediately after reading it, and then do <code>UserForm1.TextBox1 = FileContent</code>.</p>\n\n<p>No need to [try to] read the file twice: you <em>did</em> read the whole contents into <code>FileContent</code>. The reason why a <code>MsgBox</code> truncates it is because, well, a <code>MsgBox</code> (just like a cell) isn't made for this, and has a maximum content length. <code>TextBox1</code> should be able to handle it (unless you gave it a <code>MaxLength</code> value).</p>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 0, "accepted_answer_id": 47186750, "answer_count": 1, "score": 2, "last_activity_date": 1510164459, "creation_date": 1510163825, "last_edit_date": 1531164843, "question_id": 47186566, "link": "https://stackoverflow.com/questions/47186566/input-text-file-into-excel-form", "title": "Input Text File into Excel Form", "body": "<p>I have a text file that contains anywhere from 30 lines to 1000 lines of data in there with each line containing anywhere from 10 to 200 characters. I'm trying to input this data into a text box on a user form when it initializes.</p>\n\n<p>Code that I'm using now...</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Dim TextFile As Integer\n    Dim FilePath As String\n    Dim FileContent As String\n\n    FilePath = \"C:\\PATH\\MyText.txt\"\n\n    TextFile = FreeFile\n\n    Open FilePath For Input As TextFile\n\n    FileContent = Input(LOF(TextFile), TextFile)\n\n    'MsgBox FileContent\n    UserForm1.TextBox1 = Input(LOF(TextFile), TextFile)\n\n    Close TextFile\n\nEnd Sub\n</code></pre>\n\n<p>It works fine when I try outputting the data to a MsgBox (however doesn't show ALL data), but when I try to output it to the TextBox I get the error...</p>\n\n<blockquote>\n  <p>Run-time error '62':</p>\n  \n  <p>Input past end of file</p>\n</blockquote>\n\n<p>I'm guessing it's not ready the <code>EOF</code> flag here... How would I go about doing this? Maybe it's because the input file is too large?</p>\n\n<p>Any ideas or suggestions would be great!</p>\n"}, {"tags": ["excel", "runtime-error", "out-of-memory", "vba"], "comments": [{"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1510166016, "post_id": 47186491, "comment_id": 81323454, "body": "I dont think you&#39;re iterating over the dictionary correctly see: <a href=\"https://stackoverflow.com/a/1296250/212869\">stackoverflow.com/a/1296250/212869</a> ."}, {"owner": {"reputation": 177, "user_id": 7937219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a82c61712f04fc0c5afe2627d7e8f93a?s=128&d=identicon&r=PG&f=1", "display_name": "Sescopeland", "link": "https://stackoverflow.com/users/7937219/sescopeland"}, "reply_to_user": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1510173481, "post_id": 47186491, "comment_id": 81327729, "body": "@NickSlash If I change the code to <code>If oCell.Value = key Then</code> the code works fine provided that there is a match. But I want the opposite effect, if the value is not equal to the key, I want to paste it."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 7937219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a82c61712f04fc0c5afe2627d7e8f93a?s=128&d=identicon&r=PG&f=1", "display_name": "Sescopeland", "link": "https://stackoverflow.com/users/7937219/sescopeland"}, "edited": false, "score": 0, "creation_date": 1510237867, "post_id": 47191826, "comment_id": 81357374, "body": "I&#39;m still getting the same result as before: The code pastes the first row <code>A-FUL &quot;A&quot; FULL SHIM KIT (2&quot; x2&quot;)</code> over and over instead of pasting that row once and moving on to the next item (i.e. &quot;A-MINI&quot;)."}, {"owner": {"reputation": 177, "user_id": 7937219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a82c61712f04fc0c5afe2627d7e8f93a?s=128&d=identicon&r=PG&f=1", "display_name": "Sescopeland", "link": "https://stackoverflow.com/users/7937219/sescopeland"}, "edited": false, "score": 0, "creation_date": 1510350635, "post_id": 47191826, "comment_id": 81414054, "body": "Greatly appreciated. Had to wrangle to code a little bit, but your pseudo-code was extremely helpful for a framework."}], "tags": [], "owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "is_accepted": true, "score": 1, "last_activity_date": 1510355733, "last_edit_date": 1510355733, "creation_date": 1510185912, "answer_id": 47191826, "question_id": 47186491, "link": "https://stackoverflow.com/questions/47186491/update-vba-error-6-overflow-when-iterating-over-key-in-dictionary/47191826#47191826", "title": "Update: VBA error 6 Overflow when iterating over key in dictionary", "body": "<p>To iterate over the keys in a dictionary you need to use the .Keys() method, using just <code>Dic</code> wont/shouldnt work.</p>\n\n<pre><code>Option Explicit\n\nSub RefreshData()\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayStatusBar = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n\n    ' Set workbook definitions\n    Dim wbk As Workbook\n    Set wbk = ThisWorkbook\n    ' Set worksheet definitions\n    Dim shtData As Worksheet\n    Set shtData = wbk.Sheets(\"Data\")\n    Dim shtCC As Worksheet\n    Set shtCC = wbk.Sheets(\"Cycle Count Database\")\n\n\n    ' Refresh SQL query for data from AS400\n    'wbk.RefreshAll\n\n    ' Create dictionary of items\n    Dim Dic As Object, key As Variant, oCell As Range, i&amp;\n    Set Dic = CreateObject(\"Scripting.Dictionary\")\n\n    ' Calculate number of rows in Data sheet\n    i = shtData.Cells.SpecialCells(xlCellTypeLastCell).Row\n\n    ' Store Data key, values in Dictionary\n    For Each oCell In shtData.Range(\"B2:B\" &amp; i)\n        If Not Dic.Exists(oCell.Value) Then\n            Dic.Add oCell.Value, oCell.Offset(, 1).Value\n        End If\n    Next\n\n    'Debug.Print (Dic.Count)\n\n    ' Calculate number of rows in Dic + number of rows in database\n    i = Dic.Count + shtCC.Cells.SpecialCells(xlCellTypeLastCell).Row + 1\n\n'-------------THIS---------------------\n    ' If dictionary key not present, paste into database\n    For Each oCell In shtCC.Range(\"B2:B\" &amp; i)\n        For Each key In Dic.Keys\n            If Not Dic.Exists(oCell.Value) Then\n                    oCell.Value = key\n                    oCell.Offset(, 1).Value = Dic(key)\n            End If\n        Next\n    Next\n'-----------------------------------------\n\n    With Application\n        .ScreenUpdating = True\n        .DisplayStatusBar = True\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Update - I don't know if I completely understand what you are trying to do, so the following pseudo-code might not help at all.</p>\n\n<pre><code>' Populate Dictionary with data from CCD\nDim CCDic as Dictionary\nFor Each Cell In CCD.Range\n    If Not CCDic.Exists(Cell.Value) Then\n        CCDic.Add Cell.Value, Cell.Offset(,1).Value\n    End If\nNext\n\n' Populate another dictionary from Data\nDim DDic as Dictionary\nFor Each Cell in Data.Range\n    If Not DDic.Exists(Cell.Value) Then\n        DDic.Add Cell.Value, Cell.Offset(,1).Value\n    End If\nEnd If\n\n' Remove any duplicate items from DDic (leaving only new items)\nDim Key As Variant\nFor Each Key In DDic.Keys\n    If CCDic.Exists(Key) Then\n        DDic.Remove Key\n    End If\nNext    \n\n' Iterate over DDic and append data to CCD\nFor Each Key In DDic.Keys\n    ' Code to do that\nNext\n</code></pre>\n\n<p>Update 2 - I thought about it a little more and realised that you don't need to create a dictionary for both CCD and Data sheets.</p>\n\n<pre><code>' Populate Dictionary with data from CCD\nDim CCDic as Dictionary\nFor Each Cell In CCD.Range\n    If Not CCDic.Exists(Cell.Value) Then\n        CCDic.Add Cell.Value, Cell.Offset(,1).Value\n    End If\nNext\n\n' Look for and keep new records\nDim NewDic as Dictionary\nFor Each Cell In Data.Range\n    If Not CCDic.Exists(Cell.Value) Then\n        If Not NewDic.Exists(Cell.Value) Then\n            NewDic.Add Cell.Value, Cell.Offset(,1).Value\n        End If\n    End If  \nNext\n\n' Iterate over NewDic and append data to CCD\nFor Each Key In NewDic.Keys\n    ' Code to do that\nNext\n</code></pre>\n\n<p>If you add a reference to \"Microsoft Scripting Runtime\" in the script editor it will add the Dictionary object to VBA so you can do <code>Dim X As Dictionary</code> and it adds Intellisense bits for them too which is helpful when debugging. Changing it back to <code>CreateObject('Scripting.Dictionary')</code> in the end helps with portability</p>\n"}], "owner": {"reputation": 177, "user_id": 7937219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a82c61712f04fc0c5afe2627d7e8f93a?s=128&d=identicon&r=PG&f=1", "display_name": "Sescopeland", "link": "https://stackoverflow.com/users/7937219/sescopeland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 47191826, "answer_count": 1, "score": 2, "last_activity_date": 1510355733, "creation_date": 1510163622, "last_edit_date": 1531161705, "question_id": 47186491, "link": "https://stackoverflow.com/questions/47186491/update-vba-error-6-overflow-when-iterating-over-key-in-dictionary", "title": "Update: VBA error 6 Overflow when iterating over key in dictionary", "body": "<p>Good morning,</p>\n\n<p>I have to worksheets \"Data\" and \"Cycle Count Database\" in an Excel workbook. Essentially, I refresh the \"Data\" sheet with a SQL query from our network files (which works perfectly). </p>\n\n<p>After the refresh, I want to paste any new values into the \"Cycle Count Database\" sheet. If the information is already present, I don't want to copy over it; I only want to add new data. Practically, I want to make sure that if we add a new item that we are performing a cycle count of that item but not erase the data from the \"Cycle Count Database\" from old items. </p>\n\n<p>Generally, speaking, there shouldn't be many new items. However, in populating the spreadsheet for the first time, there are 23080 items.</p>\n\n<p>Here's the head of my \"Data\" sheet:</p>\n\n<pre><code>    A       B          C                                D\n 1  Active  Item       Description                      ABC\n 2  A       A-FUL      \"A\" FULL SHIM KIT (2\" X 2\")      B\n 3  A       A-MINI     \"A\" MINI SHIM KIT (2\" X 2\")      C\n 4  A       A-SHIMBOX  BLACK BOX FOR 2X2 SHIM KIT       X\n 5  A       A-001      A (2\" X 2\").001\" SHIM PACK/20    C\n 6  S       A-002      A (2\" X 2\").002\" SHIM PACK/20    C\n</code></pre>\n\n<p>Ideally I would like to copy over only rows that have \"A\" in the \"Active\" (Column A) column. (\"S\" denotes the item is suspended. In the future if an item has changed to \"S\" from \"A\" I would like the \"A\" on the \"Cycle Count Database\" sheet to be replaced with \"S\", but that's a separate issue.) </p>\n\n<p>So essentially, if the \"Item\" (Column B) value is present in the \"Cycle Count Database\", I don't want to do anything; however if the \"Item\" is not present, I'd like to paste Columns A:D onto the bottom row of the \"Cycle Count Database\" sheet. Then I would put in a filter to filter alphabetically by column B. </p>\n\n<p>Here's what I have going so far:</p>\n\n<pre><code>Option Explicit\n\nSub RefreshData()\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayStatusBar = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n\n    ' Set workbook definitions\n    Dim wbk As Workbook\n    Set wbk = ThisWorkbook\n    ' Set worksheet definitions\n    Dim shtData As Worksheet\n    Set shtData = wbk.Sheets(\"Data\")\n    Dim shtCC As Worksheet\n    Set shtCC = wbk.Sheets(\"Cycle Count Database\")\n\n\n    ' Refresh SQL query for data from AS400\n    wbk.RefreshAll\n\n    ' Create dictionary of items\n    Dim Dic As Object, key As Variant, oCell As Range, i&amp;\n    Set Dic = CreateObject(\"Scripting.Dictionary\")\n\n    ' Calculate number of rows in Data sheet\n    i = shtData.Cells.SpecialCells(xlCellTypeLastCell).Row\n\n    ' Store Data key, values in Dictionary\n    For Each oCell In shtData.Range(\"B2:B\" &amp; i)\n        If Not Dic.exists(oCell.Value) Then\n            Dic.Add oCell.Value, oCell.Offset(, 1).Value\n        End If\n    Next\n\n    'Debug.Print (Dic.Count)\n\n    ' Calculate number of rows in Dic + number of rows in database\n    i = Dic.Count + shtCC.Cells.SpecialCells(xlCellTypeLastCell).Row + 1\n\n    ' If dictionary key not present, paste into database\n    For Each oCell In shtCC.Range(\"B2:B\" &amp; i)\n        For Each key In Dic\n            If oCell.Value &lt;&gt; key Then\n                oCell.Value = key\n                oCell.Offset(, 1).Value = Dic(key)\n            End If\n        Next\n    Next\n\n    With Application\n        .ScreenUpdating = True\n        .DisplayStatusBar = True\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>With a Run-time error 6 on line:</p>\n\n<pre><code>If oCell.Value &lt;&gt; key Then\n</code></pre>\n\n<p>I realize I don't have all the bells and whistles, nor am I looking for you to create those. I just wanted to give you the whole picture for some context. I really just need help on copying the new information over without receiving this overflow code...</p>\n\n<p>Thanks!</p>\n\n<p><strong>Update: I can now repeat/paste the first entry of the dictionary. But the for loop doesn't go on to the additional rows and duplicates the first row over and over. So, I suspect I have an issue with the order of the for loops somewhere:</strong></p>\n\n<pre><code>Option Explicit\n\nSub RefreshData()\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayStatusBar = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n\n    ' Set workbook definitions\n    Dim wbk As Workbook\n    Set wbk = ThisWorkbook\n    ' Set worksheet definitions\n    Dim shtData As Worksheet\n    Set shtData = wbk.Sheets(\"Data\")\n    Dim shtCC As Worksheet\n    Set shtCC = wbk.Sheets(\"Cycle Count Database\")\n\n\n    ' Refresh SQL query for data from AS400\n    'wbk.RefreshAll\n\n    ' Create dictionary of items\n    Dim Dic As Object, key As Variant, oCell As Range, i&amp;\n    Set Dic = CreateObject(\"Scripting.Dictionary\")\n\n    ' Calculate number of rows in Data sheet\n    i = shtData.Cells.SpecialCells(xlCellTypeLastCell).Row\n\n    ' Store Data key, values in Dictionary\n    For Each oCell In shtData.Range(\"B2:B\" &amp; i)\n        If Not Dic.Exists(oCell.Value) Then\n            Dic.Add oCell.Value, oCell.Offset(, 1).Value\n        End If\n    Next\n\n    'Debug.Print (Dic.Count)\n\n    ' Calculate number of rows in Dic + number of rows in database\n    i = Dic.Count + shtCC.Cells.SpecialCells(xlCellTypeLastCell).Row + 1\n\n    ' If dictionary key not present, paste into database\n    For Each oCell In shtCC.Range(\"B2:B\" &amp; i)\n        For Each key In Dic\n            If Not Dic.Exists(oCell.Value) Then\n                    oCell.Value = key\n                    oCell.Offset(, 1).Value = Dic(key)\n            End If\n        Next\n    Next\n\n    With Application\n        .ScreenUpdating = True\n        .DisplayStatusBar = True\n        .EnableEvents = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>With the result:</strong></p>\n\n<pre><code>  A      B      C                            D\n1 Active Item   Description                  ABC\n2        A-FUL  \"A\" FULL SHIM KIT (2\" X 2\") \n3        A-FUL  \"A\" FULL SHIM KIT (2\" X 2\") \n4        A-FUL  \"A\" FULL SHIM KIT (2\" X 2\") \n5        A-FUL  \"A\" FULL SHIM KIT (2\" X 2\") \n...\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "textbox", "multiple-value"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1510162862, "post_id": 47186236, "comment_id": 81321555, "body": "This sounds like a good use for a <code>Listbox</code> instead, honestly."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1510169879, "post_id": 47186236, "comment_id": 81325799, "body": "Cross posted <a href=\"http://www.accessforums.net/showthread.php?t=69024\" rel=\"nofollow noreferrer\">accessforums.net/showthread.php?t=69024</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1510170763, "post_id": 47186236, "comment_id": 81326263, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18940038/concatrelated-function-in-a-query\">ConcatRelated function in a query</a>"}, {"owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "edited": false, "score": 0, "creation_date": 1510237895, "post_id": 47186236, "comment_id": 81357401, "body": "I don&#39;t get how this is a &quot;possible duplicate&quot;. Can you please explain how you got to that conclusion?"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510331863, "post_id": 47186236, "comment_id": 81404953, "body": "you used the term &quot;query&quot; and you want to concatenate the result of the query"}, {"owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "edited": false, "score": 0, "creation_date": 1510424756, "post_id": 47186236, "comment_id": 81433143, "body": "Someone helped me with my WHERE statement from that AllenBrowne.comblink. It needed to look something like this:"}], "answers": [{"tags": [], "owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "is_accepted": false, "score": 1, "last_activity_date": 1510244667, "creation_date": 1510244667, "answer_id": 47206854, "question_id": 47186236, "link": "https://stackoverflow.com/questions/47186236/store-multiple-values-in-a-single-textbox-in-microsoft-access/47206854#47206854", "title": "Store Multiple Values in a Single Textbox in Microsoft Access", "body": "<p>I received a ton of help here: <a href=\"http://www.accessforums.net/showthread.php?t=69024&amp;page=2&amp;p=377240#post377240\" rel=\"nofollow noreferrer\">AccessForums</a> which made reference to <a href=\"http://allenbrowne.com/func-concat.html\" rel=\"nofollow noreferrer\">this post on AllenBrowne.com</a>. Thank you to all that helped!</p>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "is_accepted": false, "score": 1, "last_activity_date": 1510425418, "creation_date": 1510425418, "answer_id": 47241471, "question_id": 47186236, "link": "https://stackoverflow.com/questions/47186236/store-multiple-values-in-a-single-textbox-in-microsoft-access/47241471#47241471", "title": "Store Multiple Values in a Single Textbox in Microsoft Access", "body": "<p>Someone helped me with my WHERE statement from that AllenBrowne.comblink. It needed to look something like this:</p>\n\n<p>I needed to add this to the control source of the textbox:\n=ConcatRelated(\"Day\", \"qry_PerToConfByDay\", \"PersonID=\" &amp; [PersonID] &amp; \" AND Conference ID=\" &amp; [ConferenceID]</p>\n\n<p>Whereby:</p>\n\n<p><strong>Start of Function is:</strong> ConcatRelated(</p>\n\n<p><strong>Field I want to see all values is:</strong> \"Day\",</p>\n\n<p><strong>Table (or in this case the Query) I want to pull the data from:</strong> \"qry_PerToConfByDay\",</p>\n\n<p><strong>Where criteria, setting up which fields I want to pull from:</strong> \"PersonID=\" &amp; [PersonID] &amp; \" AND ConferenceID=\" &amp; [ConferenceID]</p>\n\n<p><strong>End the function:</strong> )</p>\n\n<p>I didn't need to do an ORDER BY nor did I need to change my delimiter, so the last two arguments I didn't put in. But that's what worked for me.</p>\n\n<p>I hope this is helpful to someone else!</p>\n"}], "owner": {"reputation": 309, "user_id": 5105773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10155726797595231/picture?type=large", "display_name": "Will Dutcher", "link": "https://stackoverflow.com/users/5105773/will-dutcher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 996, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1510425418, "creation_date": 1510162753, "last_edit_date": 1510230218, "question_id": 47186236, "link": "https://stackoverflow.com/questions/47186236/store-multiple-values-in-a-single-textbox-in-microsoft-access", "title": "Store Multiple Values in a Single Textbox in Microsoft Access", "body": "<p>I've searched a lot of forums but can't find the exact answer I need.</p>\n\n<p>My db is a Conference Scheduling DB whereby I have four tables to consider:\nPersons / Person-to-Conference / Conference_Main / Conference_Day</p>\n\n<p>I am unable to post images because when I try to do so on my work computer, it craps out, so I'm sorry for the lack of visual.</p>\n\n<p>This db will allow someone to create a conference, where it will automatically populate data for Day 1. Not all conferences are multiple days, but some are.</p>\n\n<p>Let's say there's a three-day conference (Conference X), and it's attended by three people (A, B, C).</p>\n\n\n\n<pre class=\"lang-none prettyprint-override\"><code>Person A is going Day 1\nPerson B is going Day 1 &amp; 3\nPerson C is going Day 2 &amp; 3\n</code></pre>\n\n<p>I have a query where I want to show what days of the conference people attended and I want to populate a textbox on a form with that information. Is there a simple concatenation I can do, or do I need a For Each loop, because of the question of whether or not a conference will even have multiple days or not?</p>\n\n<p>I want to see something like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Attendee   Days Attended\nPerson A   1\nPerson B   1, 3\nPerson C   2, 3\n</code></pre>\n\n<p>*Note \"Days Attended\" would be the textbox in question where I'd want to see the multiple values, e.g. \"2, 3\"</p>\n\n<p>I'd rather not store this in another table, but rather just make it Dynamic based on whatever days I know my person is going to for the conference. Can anyone help me with some vba?</p>\n\n<p>Or should this instead be a Query that will concatenate the Days attended? Is that possible? </p>\n\n<p>My answer has nothing to do with it being entered in correctly (it is), but rather is a question of where I should be calling the variable arguments for the WHERE statement.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1510162900, "post_id": 47186177, "comment_id": 81321574, "body": "Are there formulas in range <code>A20:D20</code>?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510162906, "post_id": 47186177, "comment_id": 81321580, "body": "I think you have to loop through each cell. Alternatively, depending on what you&#39;re trying to do you could use worksheet functions COUNTBLANK or COUNTA."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1510163204, "post_id": 47186177, "comment_id": 81321764, "body": "<b><i>UNCLEAR</i></b>........Are you trying to test if ALL the cells in the range are empty or are you trying to see if ANY of the cells in the range are empty??"}, {"owner": {"reputation": 11, "user_id": 8907279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4308a15e03e18beec336016c366684?s=128&d=identicon&r=PG&f=1", "display_name": "theenglishman", "link": "https://stackoverflow.com/users/8907279/theenglishman"}, "edited": false, "score": 0, "creation_date": 1510163313, "post_id": 47186177, "comment_id": 81321832, "body": "Just verified that there are no formulas in A20:D20.  I am trying to copy a row of data in between 2 columns onto another sheet.  I am looking for all cells empty in the range"}], "answers": [{"tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": false, "score": 2, "last_activity_date": 1510169363, "last_edit_date": 1510169363, "creation_date": 1510163229, "answer_id": 47186386, "question_id": 47186177, "link": "https://stackoverflow.com/questions/47186177/isempty-and-variables-in-range/47186386#47186386", "title": "isempty and variables in Range", "body": "<p>You're passing <code>IsEmpty</code> a multi-celled range (A20:D20), which it interprets as a 2D Variant array, which <em>isn't empty</em> because it's an initialized array of empty variants. <code>IsEmpty</code> would work with a single-celled range that doesn't contain a formula.</p>\n\n<p>Example for IsEmpty and a single cell:</p>\n\n<pre><code>If IsEmpty(Worksheets(\"Example\").Cells(1, 1).Value2) Then ...\n</code></pre>\n\n<p>As mentioned by @SJR, to check for the emptiness of a range covering multiple cells, you want to look at <code>COUNTA</code>:</p>\n\n<pre><code>If Application.WorksheetFunction.CountA(Worksheets(\"Vacation Schedule\").Range(therange)) &gt; 0 Then\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>A recurring issue is that you sometimes want to consider cells containing a zero-length string as being empty; <code>Application.WorksheetFunction.CountA</code> counts such cells, whether they contain constants (e.g. <code>'</code>) or formulas resulting in <code>\"\"</code>.</p>\n\n<p>The following function optionally skips zero-length strings when considering the emptiness of a range:</p>\n\n<pre><code>Public Function IsRangeEmpty(ByVal prngTest As Excel.Range, pbZeroLengthStringIsEmpty As Boolean) As Boolean\n    IsRangeEmpty = prngTest.Find(\"*\", LookIn:=IIf(pbZeroLengthStringIsEmpty, xlValues, xlFormulas), LookAt:=xlPart, SearchDirection:=xlNext, MatchCase:=False, MatchByte:=False, SearchFormat:=False) Is Nothing\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510169787, "post_id": 47186884, "comment_id": 81325746, "body": "You should exit the loop as soon as you hit a value; imagine if the range was huge and the first cell was not &quot;empty&quot; - the code would continue scanning the whole range for nothing. See the IsRangeEmpty function in my answer for an alternative."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510171278, "post_id": 47186884, "comment_id": 81326534, "body": "Replace the <code>CheckRange = False</code> you&#39;ve just added by <code>Exit For</code>."}, {"owner": {"reputation": 59, "user_id": 7086708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf5327e44a24996f52ee37f6c05fc75?s=128&d=identicon&r=PG&f=1", "display_name": "Schr&#246;dinger&#39;s cat", "link": "https://stackoverflow.com/users/7086708/schr%c3%b6dingers-cat"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510171633, "post_id": 47186884, "comment_id": 81326743, "body": "I replaced it; an u explain why it is better to exit the loop, instead of just exit the function?"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510171789, "post_id": 47186884, "comment_id": 81326828, "body": "Setting <code>CheckRange = False</code> within the loop won&#39;t exit the function. You can check that by putting this code line back and setting a breakpoint on it, then calling the function."}, {"owner": {"reputation": 59, "user_id": 7086708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf5327e44a24996f52ee37f6c05fc75?s=128&d=identicon&r=PG&f=1", "display_name": "Schr&#246;dinger&#39;s cat", "link": "https://stackoverflow.com/users/7086708/schr%c3%b6dingers-cat"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510172295, "post_id": 47186884, "comment_id": 81327093, "body": "I&#39;m not able to test it right now but that makes sense. So the return value just sets the function and doesn&#39;t exit it immediately."}], "tags": [], "owner": {"reputation": 59, "user_id": 7086708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf5327e44a24996f52ee37f6c05fc75?s=128&d=identicon&r=PG&f=1", "display_name": "Schr&#246;dinger&#39;s cat", "link": "https://stackoverflow.com/users/7086708/schr%c3%b6dingers-cat"}, "is_accepted": false, "score": 0, "last_activity_date": 1510171564, "last_edit_date": 1510171564, "creation_date": 1510164941, "answer_id": 47186884, "question_id": 47186177, "link": "https://stackoverflow.com/questions/47186177/isempty-and-variables-in-range/47186884#47186884", "title": "isempty and variables in Range", "body": "<p>To be honest I had kind of the same problem this week.</p>\n\n<p>Because <code>IsEmpty</code>and <code>CountA</code> didn't return the correct result I ended up writing my own method:</p>\n\n<pre><code>Function CheckRange(passedRange As range) As Boolean\n\nDim cell As range\nDim rangeCounter As Integer\n\nrangeCounter = 0\n\nFor Each cell In passedRange\n\n    If cell.Value &lt;&gt; \"\" Then\n        rangeCounter = rangeCounter + 1\n        Exit For\n    End If\n\nNext cell\n\nIf rangeCounter = 0 Then\n    CheckRange = True\nElse\n    CheckRange = False\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>Dim columnletterstart As String\nDim columnletterend As String\nDim concatenateString As String\n\nDim testRange As range\n\ncolumnletterstart = \"A\"\ncolumnletterend = \"D\"\nconcatenateString = columnletterstart &amp; \"20\" &amp; \":\" &amp; columnletterend &amp; \"20\"\n\nSet testRange = range(concatenateString)\n\nIf CheckRange(testRange) Then\n    MsgBox \"empty\"\nElse\n    MsgBox \"not empty\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8907279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4308a15e03e18beec336016c366684?s=128&d=identicon&r=PG&f=1", "display_name": "theenglishman", "link": "https://stackoverflow.com/users/8907279/theenglishman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1059, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1510171564, "creation_date": 1510162571, "last_edit_date": 1531164843, "question_id": 47186177, "link": "https://stackoverflow.com/questions/47186177/isempty-and-variables-in-range", "title": "isempty and variables in Range", "body": "<p>This code always returns cells is not empty.  Why is this?  Is my range incorrect?  This code is in a command button on another sheet.  I also intend to make the row numbers execute in a for loop but need to get this code working properly before proceeding.  Please note I have the column address, number and letter.</p>\n\n<p>Any help appreciated- thanks\nJerry</p>\n\n<pre><code>columnletterstart = \"A\"\ncolumnletterend = \"D\"\n\nLet therange = columnletterstart &amp; \"20\" &amp; \":\" &amp; columnletterend &amp; \"20\"\nCells(6, 6) = therange\nIf IsEmpty(Worksheets(\"Vacation Schedule\").Range(therange)) = False Then\n    'Cell A2 is not blank\n    MsgBox \"Cell is not empty\"\nElse\n    'Cell A2 is blank\n    MsgBox \"Cell is empty\"\nEnd If  \n</code></pre>\n"}, {"tags": ["html", "vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1510160850, "post_id": 47185605, "comment_id": 81320320, "body": "So when you run it normally, does anything appear to happen?"}, {"owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "reply_to_user": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1510160935, "post_id": 47185605, "comment_id": 81320393, "body": "I get &#39;424&#39; object required run time error after loading the yahoo search"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510161180, "post_id": 47185605, "comment_id": 81320559, "body": "Consider using a better API: <a href=\"https://stackoverflow.com/a/17481643/1188513\">stackoverflow.com/a/17481643/1188513</a>"}, {"owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "edited": false, "score": 0, "creation_date": 1510166161, "post_id": 47185605, "comment_id": 81323543, "body": "Thanks for the suggestion. I am not familiar with that, but it seems much faster. I will have to check it out!"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 2, "last_activity_date": 1510163263, "last_edit_date": 1510163263, "creation_date": 1510162324, "answer_id": 47186099, "question_id": 47185605, "link": "https://stackoverflow.com/questions/47185605/code-works-during-f8-step-through-but-not-when-run-normally/47186099#47186099", "title": "Code works during F8 step through, but not when run normally", "body": "<p>Because this is an issue where the object is not yet available, the <em>easiest</em> way to fix your problem is to set <code>logo</code> as an object first - looping until it is <code>Not Nothing</code>, then click it.</p>\n\n<pre><code>Option Explicit\n\nSub InternetPractice()\n\n    Dim ie As New InternetExplorer, logoBtn As Object\n\n    With ie\n        .Visible = True\n        .navigate \"https://www.yahoo.com\"\n        Do While .Busy Or .readyState &lt;&gt; 4: DoEvents: Loop\n        .document.getElementById(\"uh-search-box\").Value = \"Earth\"\n        .document.getElementById(\"uh-search-button\").Click\n        Do While .Busy = True Or .readyState &lt;&gt; 4: DoEvents: Loop\n        On Error Resume Next\n        Do While logoBtn Is Nothing\n            Set logoBtn = .document.getElementById(\"logo\")\n            DoEvents\n        Loop\n        On Error Goto 0\n    End With\n    logoBtn.Click\n\nEnd Sub\n</code></pre>\n\n<p>So you are essentially replacing this line:<br>\n<code>ie.document.getElementById(\"logo\").Click</code></p>\n\n<p>with this:   </p>\n\n<pre><code>    Dim logoBtn As Object\n    Do While logoBtn Is Nothing\n        Set logoBtn = ie.document.getElementById(\"logo\")\n        DoEvents\n    Loop\n    logoBtn.Click\n</code></pre>\n\n<p>Even after <code>readyState = Complete</code>, in some cases objects are not fully initialized. This can be due in part to having multiple iFrames that do their own thing apart from the main HTML page you see.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": false, "score": 1, "last_activity_date": 1510163962, "creation_date": 1510163962, "answer_id": 47186598, "question_id": 47185605, "link": "https://stackoverflow.com/questions/47185605/code-works-during-f8-step-through-but-not-when-run-normally/47186598#47186598", "title": "Code works during F8 step through, but not when run normally", "body": "<p>I agree with K.Davis, the Ready State is not always reliable.\nTry this: </p>\n\n<pre><code>Do While ie.Busy = True Or ie.readyState &lt;&gt; 4: DoEvents: Loop\nSleep(100)\nDo While ie.Busy = True Or ie.readyState &lt;&gt; 4: DoEvents: Loop\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 47186099, "answer_count": 2, "score": 1, "last_activity_date": 1510163962, "creation_date": 1510160721, "last_edit_date": 1510161239, "question_id": 47185605, "link": "https://stackoverflow.com/questions/47185605/code-works-during-f8-step-through-but-not-when-run-normally", "title": "Code works during F8 step through, but not when run normally", "body": "<pre><code>Sub InternetPractice()\n\n    Dim ie As InternetExplorer\n\n    Set ie = New InternetExplorer\n\n    ie.Visible = True\n\n    ie.navigate \"https://www.yahoo.com\"\n\n    Do While ie.Busy = True Or ie.readyState &lt;&gt; 4: DoEvents: Loop\n\n    ie.document.getElementById(\"uh-search-box\").Value = \"Earth\"\n    ie.document.getElementById(\"uh-search-button\").Click\n\n    Do While ie.Busy = True Or ie.readyState &lt;&gt; 4: DoEvents: Loop\n\n    ie.document.getElementById(\"logo\").Click\n\n    Set ie = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The code works when I step through it line by line, but not when run normally. I have tried inserting up to 45 second breaks in certain parts with no success. </p>\n\n<p>Running normally, the code breaks during <code>ie.document.getElementById(\"logo\").Click</code> and gives me a</p>\n\n<blockquote>\n  <p>'424' object required error</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "filter"], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 1, "last_activity_date": 1510160443, "creation_date": 1510160443, "answer_id": 47185518, "question_id": 47185347, "link": "https://stackoverflow.com/questions/47185347/filter-function-getting-compile-error/47185518#47185518", "title": "Filter function getting compile error", "body": "<p>This seems to work just fine:</p>\n\n<pre><code>Sub DelShtsNotInList()\n    Dim Arr\n    Dim Sht As Worksheet\n\n    Arr = Array(\"A\", \"B\", \"C\")\n\n    Application.DisplayAlerts = False\n    For Each Sht In Worksheets\n        If Not UBound(Filter(Arr, Sht.Name, True, vbTextCompare)) &gt;= 0 Then\n            Sht.Delete\n        End If\n    Next Sht\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>NB: Note that you are not allowed to delete the last worksheet so if all names match, a runtime error will occur.</p>\n"}, {"comments": [{"owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1510163131, "post_id": 47185554, "comment_id": 81321714, "body": "Vityata, no matter what I do the <code>filter</code> gets highlighted <code>blue</code> and I get the error msg.  Any idea what will cause this?.  Thanks.    I am using excel 2016"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1510164044, "post_id": 47185554, "comment_id": 81322271, "body": "@Tim - nope, sry. What happens if you simply create a new workbook and run it?"}, {"owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1510246752, "post_id": 47185554, "comment_id": 81364056, "body": "You called it <code>I think that the compile error comes from some other Sub or Function</code> I renamed the function everything works now.  Thank you"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1510160553, "creation_date": 1510160553, "answer_id": 47185554, "question_id": 47185347, "link": "https://stackoverflow.com/questions/47185347/filter-function-getting-compile-error/47185554#47185554", "title": "Filter function getting compile error", "body": "<p>I think that the compile error comes from some other <code>Sub</code> or <code>Function</code>, this one should be ok. However, try like this:</p>\n\n<pre><code>Sub DelShtsNotInList()\n\n    Dim Arr As Variant\n    Dim Sht As Worksheet\n\n    Arr = Array(\"A\", \"B\", \"C\")\n\n    Application.DisplayAlerts = False\n    For Each Sht In Worksheets\n        If Not UBound(Filter(Arr, Sht.Name, True, vbTextCompare)) &gt;= 0 Then\n            If Worksheets.Count = 1 Then\n                MsgBox \"Error is coming\"\n                Exit Sub\n            End If\n            Sht.Delete\n        End If\n    Next Sht\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>If you try to delete the last worksheet, if will give you a msgbox.</p>\n"}], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 47185554, "answer_count": 2, "score": 1, "last_activity_date": 1510160742, "creation_date": 1510159935, "last_edit_date": 1531164843, "question_id": 47185347, "link": "https://stackoverflow.com/questions/47185347/filter-function-getting-compile-error", "title": "Filter function getting compile error", "body": "<p>I am trying to use the filter function to delete all sheets <code>not</code> in the list\nbut I get the error</p>\n\n<p><code>Compile error:\nWrong number of arguments or invalid property assignment</code></p>\n\n<p>I cant see what is wrong</p>\n\n<p>Thanks for any help on this</p>\n\n<pre><code>Sub DelShtsNotInList()\nDim Arr\nDim Sht As Worksheet\n\nArr = Array(\"A\", \"B\", \"C\")\n\nApplication.DisplayAlerts = False\n    For Each Sht In Worksheets\n        If Not UBound(filter(Arr, \"A\", True, vbTextCompare)) &gt;= 0 Then \n           Sht.Delete\n        End if\n    Next Sht\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1510159063, "post_id": 47184979, "comment_id": 81319104, "body": "Just write <code>AddAmountForm.AddName.Caption = &quot;Assoc. Dues&quot; | AddAmountForm.Show</code>. I do this all the time in a recent app I built and it works perfectly. (Pipe is line break)."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1510159322, "post_id": 47184979, "comment_id": 81319278, "body": "@ScottHoltzman That was it, I had them in the wrong order. Switching the order so that I&#39;m showing after I update the caption did it. Put that in an answer and I&#39;ll accept it."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1510160884, "post_id": 47184979, "comment_id": 81320341, "body": "Mike. Accept @Mat&#39;sMug answer. It&#39;s a more detailed how and why of what I was suggesting."}], "answers": [{"comments": [{"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 1, "creation_date": 1510162759, "post_id": 47185313, "comment_id": 81321494, "body": "Thank you! I will take most of your answer and use it. However, I am setting the caption of this label with a different caption depending on which of 12 buttons are clicked so I can&#39;t just set the caption in the label&#39;s properties."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1510163442, "post_id": 47185313, "comment_id": 81321912, "body": "@Mike yeah I figured your code was simplified. If you want to learn more advanced concepts and eventually write proper, unit-testable, object-oriented code in VBA, read that article I linked to =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1510163481, "last_edit_date": 1510163481, "creation_date": 1510159833, "answer_id": 47185313, "question_id": 47184979, "link": "https://stackoverflow.com/questions/47184979/how-to-update-a-labels-caption-on-another-user-form/47185313#47185313", "title": "How to update a label&#39;s caption on another user form?", "body": "<pre><code>AddAmountForm.Show\n</code></pre>\n\n<p>This <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">displays the <em>default instance</em></a> of the <code>AddAmountForm</code> form, modally. This means the next instruction will only execute <strong>after</strong> the form is closed.</p>\n\n<p>You probably mean to change its label <em>before</em> you show it:</p>\n\n<pre><code>With AddAmountForm\n    .AddName.Caption = \"Assoc. Dues\"\n    .Show\nEnd With\n</code></pre>\n\n<p>That said, using a form's <em>default instance</em> is going to bite you in the rear end, one day or another. Forms are objects, treat them as such:</p>\n\n<pre><code>With New AddAmountForm\n    .AddName.Caption = \"Assoc. Dues\"\n    .Show\nEnd With\n</code></pre>\n\n<p>If the caption is a compile-time constant (a string literal is a compile-time constant expression), there's no reason to assign it at runtime - just set the label's caption in the form designer's <em>Properties</em> toolwindow (F4).</p>\n"}], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 0, "accepted_answer_id": 47185313, "answer_count": 1, "score": 0, "last_activity_date": 1510163481, "creation_date": 1510158889, "question_id": 47184979, "link": "https://stackoverflow.com/questions/47184979/how-to-update-a-labels-caption-on-another-user-form", "title": "How to update a label&#39;s caption on another user form?", "body": "<p>I am using VBA to <code>Show</code> a <code>userform</code>.\nOn this form, I have buttons to open another <code>userform</code> (<code>AddAmountForm</code>).\nWhen I click on the button to open <code>AddAmountForm</code> I also want to update the caption for a label that is on <code>AddAmountForm</code>. </p>\n\n<p>Here is what I've tried this on the first userform:</p>\n\n<pre><code>Private Sub AssocDuesAddbtn_Click()\n    AddAmountForm.Show\n    With AddAmountForm\n        .AddName.Caption = \"Assoc. Dues\"\n        .Repaint\n    End With\nEnd Sub\n</code></pre>\n\n<p>However, this doesn't update the caption, it remains the same.</p>\n\n<p>There will be several buttons that will open this second userform and each one will need to update the label to something different based on what each button is supposed to be updating.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510158529, "post_id": 47184694, "comment_id": 81318748, "body": "This line has 2 equal signs in it: <code>Set LAOQWeekday = CurrentDb.QueryDefs(&quot;LAOQWeekdayQRY&quot;).SQL = LAOQWeekdaySQL</code> What are you expecting that to do?"}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1510158668, "post_id": 47184694, "comment_id": 81318842, "body": "I don&#39;t understand why you are using a predefined query in such a way. as @braX said, your first compile error is trying to set LAOQWeekday to an object reference and trying to modify the object at the same time. You need to first set the reference, and then modify the object."}, {"owner": {"reputation": 5, "user_id": 8908028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11da9823b0f385c24819b8134472df?s=128&d=identicon&r=PG&f=1", "display_name": "Envertex", "link": "https://stackoverflow.com/users/8908028/envertex"}, "edited": false, "score": 0, "creation_date": 1510159323, "post_id": 47184694, "comment_id": 81319279, "body": "Absolutely right, an oversight on my part. I&#39;ve changed it and it works as intended"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8908028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11da9823b0f385c24819b8134472df?s=128&d=identicon&r=PG&f=1", "display_name": "Envertex", "link": "https://stackoverflow.com/users/8908028/envertex"}, "edited": false, "score": 0, "creation_date": 1510159100, "post_id": 47184870, "comment_id": 81319125, "body": "Thank you for the speedy response, I am please to say that worked. Sorry if this was a silly question you have been a big help!"}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": true, "score": 2, "last_activity_date": 1510159336, "last_edit_date": 1510159336, "creation_date": 1510158566, "answer_id": 47184870, "question_id": 47184694, "link": "https://stackoverflow.com/questions/47184694/access-vba-sql-complie-error-type-mismatch/47184870#47184870", "title": "Access VBA SQL Complie Error: Type Mismatch", "body": "\n\n<p>The following line evaluates to a Boolean:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set LAOQWeekday = CurrentDb.QueryDefs(\"LAOQWeekdayQRY\").SQL = LAOQWeekdaySQL\n</code></pre>\n\n<p>Try changing it to this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set LAOQWeekday = CurrentDb.QueryDefs(\"LAOQWeekdayQRY\")\nLAOQWeekday.SQL = LAOQWeekdaySQL\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8908028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e11da9823b0f385c24819b8134472df?s=128&d=identicon&r=PG&f=1", "display_name": "Envertex", "link": "https://stackoverflow.com/users/8908028/envertex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 47184870, "answer_count": 1, "score": 0, "last_activity_date": 1510165337, "creation_date": 1510158107, "last_edit_date": 1510165337, "question_id": 47184694, "link": "https://stackoverflow.com/questions/47184694/access-vba-sql-complie-error-type-mismatch", "title": "Access VBA SQL Complie Error: Type Mismatch", "body": "<p>This following bit of code is placed in the <code>On Load</code> event of a form:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim LAOQWeekdaySQL As String\nDim LAOQWeekday As QueryDef\nDim EnqIDTest As String\nEnqIDTest = Me.txt_EnquiryID.Value\n\nLAOQWeekdaySQL = \"SELECT tbl_Costing_Labour.EnquiryID, tbl_Costing_Labour.PhaseLabour, tbl_Costing_Labour.TotalPhaseLabourHours \" &amp; _\n                 \"FROM tbl_Costing_Labour \" &amp; _\n                 \"WHERE (((tbl_Costing_Labour.EnquiryID)= \" &amp; EnqIDTest &amp; \") AND ((tbl_Costing_Labour.PhaseLabour) Like \"\"*weekday*\"\"));\"\n\nSet LAOQWeekday = CurrentDb.QueryDefs(\"LAOQWeekdayQRY\").SQL = LAOQWeekdaySQL\n\nMe.txt_LAOQ_Weekday.Value = DSum(\"TotalPhaseLabourHours\", \"LAOQWeekdayQRY\")\n</code></pre>\n\n<p>Essentially it returns records matching the Inquiry Number and sums the final column in the query and outputs it to a textbox on the form.</p>\n\n<p>However, when I got run the form it gives me a </p>\n\n<blockquote>\n  <p>compile error: type mismatch</p>\n</blockquote>\n\n<p>Prior to this I did try and use a temporary query but then the Dsum has no name to reference when performing its function so I changed it <code>.CreateQueryDef</code>, which work fine the first time. Thereafter, obviously, it threw an error saying the query already exists so I went down the route of <code>.QueryDefs</code> to update the SQL instead and now I get the mismatch error.</p>\n\n<p>I cannot see anything obvious, what am I missing here?</p>\n\n<p>Thank you in advance for any help you can provide!</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1510158311, "post_id": 47184545, "comment_id": 81318583, "body": "You need to <code>Resume</code>, see <a href=\"https://stackoverflow.com/questions/7653287/vba-error-handling-in-loop\" title=\"vba error handling in loop\">stackoverflow.com/questions/7653287/vba-error-handling-in-lo&zwnj;&#8203;op</a> &amp; <a href=\"https://stackoverflow.com/questions/11998836/excel-vba-on-error-goto-statement-not-working-inside-for-loop\" title=\"excel vba on error goto statement not working inside for loop\">stackoverflow.com/questions/11998836/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 0, "last_activity_date": 1510158315, "creation_date": 1510158315, "answer_id": 47184769, "question_id": 47184545, "link": "https://stackoverflow.com/questions/47184545/unreliable-behavior-excel-vba-code-precedents-count-statement/47184769#47184769", "title": "Unreliable behavior - Excel VBA Code - Precedents.Count Statement", "body": "<p>The issue is with your error handling</p>\n\n<pre><code>Public Sub CheckRef()\n\nDim Cell As Range\n\nFor Each Cell In Selection\n    On Error GoTo MyNext\n    If IsNumeric(Cell.Precedents.Count) Then\n        MsgBox (Cell.Address)\n    End If\nMyNext:\nResume MyNext2:\nMyNext2:\nNext Cell\n\nEnd Sub\n</code></pre>\n\n<p>Your error handling has already been used on the first loop, so the above is fix to 'reset' it using <code>resume</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1510158351, "creation_date": 1510158351, "answer_id": 47184785, "question_id": 47184545, "link": "https://stackoverflow.com/questions/47184545/unreliable-behavior-excel-vba-code-precedents-count-statement/47184785#47184785", "title": "Unreliable behavior - Excel VBA Code - Precedents.Count Statement", "body": "<p>Another way:</p>\n\n<pre><code>Public Sub CheckRef()\n\n    Dim Cell As Range, qwerty As Range\n\n    For Each Cell In Selection\n        Set qwerty = Nothing\n        On Error Resume Next\n            Set qwerty = Cell.Precedents\n        On Error GoTo 0\n        If Not qwerty Is Nothing Then\n            MsgBox (Cell.Address)\n        End If\n    Next Cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 8621585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d7a1b9ffe23ed538cbb4d4fd9114e?s=128&d=identicon&r=PG&f=1", "display_name": "rajeev", "link": "https://stackoverflow.com/users/8621585/rajeev"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "closed_date": 1510158315, "accepted_answer_id": 47184769, "answer_count": 2, "score": -1, "last_activity_date": 1528784394, "creation_date": 1510157667, "last_edit_date": 1592644375, "question_id": 47184545, "link": "https://stackoverflow.com/questions/47184545/unreliable-behavior-excel-vba-code-precedents-count-statement", "closed_reason": "Duplicate", "title": "Unreliable behavior - Excel VBA Code - Precedents.Count Statement", "body": "<p>I have this apparently a very simple Excel VBA Sub.</p>\n<pre><code>Public Sub CheckRef()\n\nDim Cell As Range\n\nFor Each Cell In Selection\n    On Error GoTo MyNext\n    If IsNumeric(Cell.Precedents.Count) Then\n        MsgBox (Cell.Address)\n    End If\n\nMyNext:\nNext Cell\n\nEnd Sub\n</code></pre>\n<p>If a cell in selection has Precedents, Message Box Cell address. If it errors out just proceed to Next Cell in For loop.</p>\n<p>This code gives</p>\n<blockquote>\n<p>run time error 1004 'No Cells were found'</p>\n</blockquote>\n<p>despite On Error statement. Ironically for the first instance it correctly skips, but errors out on next as seen in this Screenshot to GIF.</p>\n<p><code>Selection C2:C4 C2 =SUM(A1+A2)</code> (Msgbox),  <code>C3 =7+9</code> (Escapes correctly) <code>C4 =7+9</code></p>\n<blockquote>\n<p>(Run time error 1004)</p>\n</blockquote>\n<p>I am puzzled on what mistake am I making here. Just to mention it's Excel 2013 SP1 and in VBA Tools--&gt;Options--&gt;General--&gt;Error Trapping--&gt;Break on unhandled errors is selected by default. Any further help would be great.  Thanks.</p>\n<h3>Screenshot to GIF</h3>\n<p><img src=\"https://i.stack.imgur.com/renr7.gif\" alt=\"Screenshot to GIF\" /></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1510157778, "post_id": 47184458, "comment_id": 81318203, "body": "Did you tried hiding the columns you don&#39;t need to print, print and finally unhide the columns?"}, {"owner": {"reputation": 1, "user_id": 8784733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fce81b1f86628a2af53153fa996cc1?s=128&d=identicon&r=PG&f=1", "display_name": "Anne B", "link": "https://stackoverflow.com/users/8784733/anne-b"}, "edited": false, "score": 0, "creation_date": 1510158085, "post_id": 47184458, "comment_id": 81318428, "body": "When I tried hiding the columns then the data is not copied into the sheet. I want the data on the sheet just not the print out. That&#39;s why I wondered if I can have it executed in the macro. Is this possible? Sorry I am not an advanced Excel user."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1510158353, "post_id": 47184458, "comment_id": 81318626, "body": "Anne, it&#39;s really hard to me to understand what do you need, how you are trying to do and what is the real problem. Maybe other guys had the same problem because you have 12 views and no answer or comment."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1510158933, "post_id": 47184458, "comment_id": 81319021, "body": "Agree with @DavidG. Description and code are kind of different, but maybe because you are new. I suggest a non-vba solution. Add a 2nd page and set it up with formula references to just the columns of data you need printed, then set up print format as needed. This is like a presentation layer that feeds from data calculated elsewhere."}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1510158968, "post_id": 47184458, "comment_id": 81319039, "body": "Excel doesn&#39;t allow you to make a smooth print range from non-contiguous ranges. You&#39;ll have to make a macro that copies your data into a temporary sheet, make the print range, print, then deletes the sheet."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8784733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fce81b1f86628a2af53153fa996cc1?s=128&d=identicon&r=PG&f=1", "display_name": "Anne B", "link": "https://stackoverflow.com/users/8784733/anne-b"}, "edited": false, "score": 0, "creation_date": 1510160248, "post_id": 47185106, "comment_id": 81319895, "body": "Can I specify a range in my macro to print specific columns?"}, {"owner": {"reputation": 472, "user_id": 6899593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/000e1cc8d4874fb425a2508604baac39?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad", "link": "https://stackoverflow.com/users/6899593/mohamad"}, "reply_to_user": {"reputation": 1, "user_id": 8784733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fce81b1f86628a2af53153fa996cc1?s=128&d=identicon&r=PG&f=1", "display_name": "Anne B", "link": "https://stackoverflow.com/users/8784733/anne-b"}, "edited": false, "score": 0, "creation_date": 1510225797, "post_id": 47185106, "comment_id": 81349013, "body": "If your range is contiguous, I will say you YES. You can specify your range (with contiguous columns) like this : <code>Range(&quot;A1:E10&quot;).Select</code> in this we specify cells in the range that starts with cell A1 and ends with cell E10. You can specify your own cells.YES"}], "tags": [], "owner": {"reputation": 472, "user_id": 6899593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/000e1cc8d4874fb425a2508604baac39?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad", "link": "https://stackoverflow.com/users/6899593/mohamad"}, "is_accepted": false, "score": 0, "last_activity_date": 1510159185, "creation_date": 1510159185, "answer_id": 47185106, "question_id": 47184458, "link": "https://stackoverflow.com/questions/47184458/print-non-contiguous-columns-in-excel/47185106#47185106", "title": "Print non contiguous columns in Excel", "body": "<p>You can create a new page to receive your selected columns for printing Like this code below. Mu non-contiguous columns are in MySourceSheet. You have to copy them in MytargetSheet and print it.</p>\n\n<pre><code>Sub CopyInAdjacentColumnsForPrinting()\n\n    Sheets(\"MySourceSheet\").Select\n    Range(\"A:A,C:C,E:E\").Select 'We select A, C and E columns for example,     you can specify your own columns\n    Range(\"E1\").Activate\n    Selection.Copy\n    Sheets(\"MyTargetSheet\").Select ' This sheet is for receiving selected     columns in contiguous columns.\n    Range(\"A1\").Select\n    ActiveSheet.Paste ' We copied selected columns in this sheet.\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>Hope this can help!</p>\n"}, {"tags": [], "owner": {"reputation": 472, "user_id": 6899593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/000e1cc8d4874fb425a2508604baac39?s=128&d=identicon&r=PG&f=1", "display_name": "Mohamad", "link": "https://stackoverflow.com/users/6899593/mohamad"}, "is_accepted": false, "score": 0, "last_activity_date": 1510162361, "creation_date": 1510162361, "answer_id": 47186110, "question_id": 47184458, "link": "https://stackoverflow.com/questions/47184458/print-non-contiguous-columns-in-excel/47186110#47186110", "title": "Print non contiguous columns in Excel", "body": "<p>Sorry @Anne B, I cannot add my code in comment bloc, then I add a new answer :)\nBased on the fact that you copied your non-contiguous columns in the sheet named MyTargetSeet (in this example).\nYou can use this.</p>\n\n<pre><code>Sub ZoneImp()\n Dim FirstCol As Integer, LastCol As Integer, FirstLin As Integer, FirstLin As Integer\n\n FirstCol = 1\n LastCol = 3\n FirstLin = 1\n LastLin = 6\n 'Here I create my Area for printing\n Sheets(\"MyTargetSheet\").PageSetup.PrintArea = Range(Cells(FirstLin, FirstCol), Cells(LastLin, LastCol)).Address\nEnd Sub\n</code></pre>\n\n<p>Hope this can help!</p>\n"}], "owner": {"reputation": 1, "user_id": 8784733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90fce81b1f86628a2af53153fa996cc1?s=128&d=identicon&r=PG&f=1", "display_name": "Anne B", "link": "https://stackoverflow.com/users/8784733/anne-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510162361, "creation_date": 1510157413, "last_edit_date": 1510158872, "question_id": 47184458, "link": "https://stackoverflow.com/questions/47184458/print-non-contiguous-columns-in-excel", "title": "Print non contiguous columns in Excel", "body": "<p>I am trying to print several non-contiguous columns on one sheet of paper. I am using the set print area in page layout. However it has created a page break after each column range. I have a macro that allows you to paste a range of data, and then it clears the data and prints the page. So hiding the columns isn't working. Can someone tell me how to print just the columns I need on one piece of paper. Here is the macro where I would like to include the printing code.</p>\n\n<pre><code>Sub cleardatanotformulas()\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1\n    On Error Resume Next\n    Cells.SpecialCells(xlCellTypeConstants).ClearContents\n    ActiveWorkbook.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1510157219, "post_id": 47184160, "comment_id": 81317813, "body": "Concerning the log math formulas - <code>Debug.Print Math.Log(10)</code> Or even better - check <a href=\"https://stackoverflow.com/a/31618564/5448626\">stackoverflow.com/a/31618564/5448626</a>"}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 8859693, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a9ff67719a6a19c67e9e1d31c6c1566d?s=128&d=identicon&r=PG&f=1", "display_name": "JayJayAbrams", "link": "https://stackoverflow.com/users/8859693/jayjayabrams"}, "edited": false, "score": 0, "creation_date": 1510158316, "post_id": 47184484, "comment_id": 81318591, "body": "Perfect! And how do I change in formula C4, B4 and A4 to  row below them in followin run? @garys-student"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 199, "user_id": 8859693, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a9ff67719a6a19c67e9e1d31c6c1566d?s=128&d=identicon&r=PG&f=1", "display_name": "JayJayAbrams", "link": "https://stackoverflow.com/users/8859693/jayjayabrams"}, "edited": false, "score": 0, "creation_date": 1510158483, "post_id": 47184484, "comment_id": 81318719, "body": "@J  See the picture in the answer...........the formula automatically adjusts during the fill-down process."}, {"owner": {"reputation": 199, "user_id": 8859693, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a9ff67719a6a19c67e9e1d31c6c1566d?s=128&d=identicon&r=PG&f=1", "display_name": "JayJayAbrams", "link": "https://stackoverflow.com/users/8859693/jayjayabrams"}, "edited": false, "score": 0, "creation_date": 1510159386, "post_id": 47184484, "comment_id": 81319318, "body": "@garys-student my bad, I wanted to apply it to my example w/ absolute cell =ref!$C$2*4 or better this one =($\u0421$4+$B$4)/LOG10($A$4) + 12. As it can be seen from the beginning  <code>For Each cycle In Sheets(&quot;ref&quot;).Range(&quot;A2:A4&quot;)</code> there are 3 values in cycle so there will be 3 runs. What I what to do is to for each run automatically move absolute cells a row down or column left or wherever."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1510157502, "creation_date": 1510157502, "answer_id": 47184484, "question_id": 47184160, "link": "https://stackoverflow.com/questions/47184160/excel-vba-change-absolute-cells-in-loop/47184484#47184484", "title": "excel vba | change absolute cells in loop", "body": "<p>Use <strong><em>Formula</em></strong> rather than <strong><em>FormulaR1C1</em></strong></p>\n\n<pre><code>Sub dural()\n    With Range(\"D2\")\n        .Formula = \"=(C4+B4)/LOG10(A4) + 12\"\n        .AutoFill Destination:=Range(\"D2:D3\")\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note the arguments will auto-adjust in the fill-down:</p>\n\n<p><a href=\"https://i.stack.imgur.com/G5HFz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G5HFz.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 199, "user_id": 8859693, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a9ff67719a6a19c67e9e1d31c6c1566d?s=128&d=identicon&r=PG&f=1", "display_name": "JayJayAbrams", "link": "https://stackoverflow.com/users/8859693/jayjayabrams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510159767, "creation_date": 1510156611, "last_edit_date": 1510159767, "question_id": 47184160, "link": "https://stackoverflow.com/questions/47184160/excel-vba-change-absolute-cells-in-loop", "title": "excel vba | change absolute cells in loop", "body": "<p>Hiyall!</p>\n\n<p>How to change formula absolute cells in loop?\nLets say I have link <code>=ref!$C$2*4</code>, how to move in 1 row lower for next run in the loop <code>=ref!$C$3*4</code>? Do I need to split it and add counter? Or there is an easier way?</p>\n\n<p>sample code</p>\n\n<pre><code>Dim cycle As Range\nFor Each cycle In Sheets(\"ref\").Range(\"A2:A4\")\n    ...\n    Range(\"D2\").Select\n    ActiveCell.FormulaR1C1 = \"=ref!R2C2\" + \"*4\"\n    Selection.AutoFill Destination:=Range(\"D2:D3\")\n    ...\nEnd Sub\n</code></pre>\n\n<p>Also I am curious how to add math formulas in VBA like =(\u04214+B4)/LOG10(A4) + 12, using quote marks did not help at all :&lt;</p>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1510156183, "post_id": 47183983, "comment_id": 81317041, "body": "Have you tried recording a macro? It&#39;s literally just <code>Selection.NumberFormat = &quot;dd&#47;mm&#47;yyyy&quot;</code>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510156374, "post_id": 47183983, "comment_id": 81317170, "body": "You can just format the whole column at once. No need for VBA or doing it one by one."}, {"owner": {"reputation": 315, "user_id": 5822096, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d5ab014cd7c3b58fa8eb2098837aa537?s=128&d=identicon&r=PG&f=1", "display_name": "Tianna Wrona", "link": "https://stackoverflow.com/users/5822096/tianna-wrona"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510157100, "post_id": 47183983, "comment_id": 81317711, "body": "To expand on what @braX said, all you need to do is (1) highlight the whole column then (2) in the Home tab, in the Number group in the drop down, change the format to &quot;Short Date&quot;."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1510160735, "post_id": 47183983, "comment_id": 81320248, "body": "If you want to actually change the value and remove the time portion then you can use <code>=INT(A1)</code> and then format as everyone has suggested."}, {"owner": {"reputation": 9, "user_id": 8907859, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OnvGHJh9kD8/AAAAAAAAAAI/AAAAAAAA61U/2OlgnYv_Xrs/photo.jpg?sz=128", "display_name": "Hassan Arshad", "link": "https://stackoverflow.com/users/8907859/hassan-arshad"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1510218769, "post_id": 47183983, "comment_id": 81344334, "body": "@dwirony how and where can I apply this Selection.NumberFormat = &quot;dd/mm/yyyy&quot;? Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8907859, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OnvGHJh9kD8/AAAAAAAAAAI/AAAAAAAA61U/2OlgnYv_Xrs/photo.jpg?sz=128", "display_name": "Hassan Arshad", "link": "https://stackoverflow.com/users/8907859/hassan-arshad"}, "edited": false, "score": 0, "creation_date": 1510218334, "post_id": 47184344, "comment_id": 81344113, "body": "Hi, thanks for writing back to me but I really don&#39;t know how to do it, because I never worked used VBA before. Currently I am selecting whole range c:c and using replace option to replace the whole range ( *) to short date and then changing dd/mm/yyyy hh:mm:ss to dd/mm/yyyy. I thought VBA might change the range automatically whenever I opened the excel or add new entries in the cell. I am sorry but no clue about VBA :("}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 9, "user_id": 8907859, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OnvGHJh9kD8/AAAAAAAAAAI/AAAAAAAA61U/2OlgnYv_Xrs/photo.jpg?sz=128", "display_name": "Hassan Arshad", "link": "https://stackoverflow.com/users/8907859/hassan-arshad"}, "edited": false, "score": 0, "creation_date": 1510244387, "post_id": 47184344, "comment_id": 81362323, "body": "Unfortunately, most people here on SO won&#39;t provide you code to it... Maybe it might be best for you to do a little research? There are tons of tutorials and resources online that you can utilize that can help you with what you need"}], "tags": [], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "is_accepted": false, "score": 0, "last_activity_date": 1510157085, "creation_date": 1510157085, "answer_id": 47184344, "question_id": 47183983, "link": "https://stackoverflow.com/questions/47183983/change-dd-mm-yyyy-hhmmss-to-dd-mm-yyyy-using-vba-macro/47184344#47184344", "title": "Change dd/mm/yyyy hh:mm:ss to dd/mm/yyyy using VBA Macro", "body": "<p>If you're interested in formatting it using VBA, here is a great resource that can help you directly from the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">Microsoft</a> <em>VBA Language Reference</em> webpage. From here you can either format it using the entire range, or you can loop through your data. Below are some great references to get you started</p>\n\n<p><a href=\"http://www.excelhowto.com/macros/formatting-a-range-of-cells-in-excel-vba/\" rel=\"nofollow noreferrer\">Formatting by range</a></p>\n\n<p><a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">How to use loops</a></p>\n\n<p>Try these methods out, and if you're still having issues, come back and we can help with your code</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 8907859, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OnvGHJh9kD8/AAAAAAAAAAI/AAAAAAAA61U/2OlgnYv_Xrs/photo.jpg?sz=128", "display_name": "Hassan Arshad", "link": "https://stackoverflow.com/users/8907859/hassan-arshad"}, "edited": false, "score": 0, "creation_date": 1510218554, "post_id": 47184363, "comment_id": 81344231, "body": "Thanks mate, thats what I am doing manually but I am looking for something whenver I open the workbook, cell format will change as I am expected instead of changing manually. Thank you"}], "tags": [], "owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1510157135, "creation_date": 1510157135, "answer_id": 47184363, "question_id": 47183983, "link": "https://stackoverflow.com/questions/47183983/change-dd-mm-yyyy-hhmmss-to-dd-mm-yyyy-using-vba-macro/47184363#47184363", "title": "Change dd/mm/yyyy hh:mm:ss to dd/mm/yyyy using VBA Macro", "body": "<p>If you are returning the formatted result to a cell, as is, then it will likely re-format itself to the original format due to the cell format.</p>\n\n<p>You can change the format of the cell (or the entire column if your data is in a single column) to display in your desired format.</p>\n\n<p>Select the column, open the context menu from the header and select \"Format Cells\".</p>\n\n<p>In the dialog that opens, select \"custom\" in the category list then on the right hand side select your desired format from the list.</p>\n\n<p>Edit:\nAs for the original question, you need the <code>Format()</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 8850338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfd1be50e68d2010d882b84c208b525?s=128&d=identicon&r=PG", "display_name": "Jimber", "link": "https://stackoverflow.com/users/8850338/jimber"}, "is_accepted": false, "score": 0, "last_activity_date": 1510166770, "creation_date": 1510166770, "answer_id": 47187386, "question_id": 47183983, "link": "https://stackoverflow.com/questions/47183983/change-dd-mm-yyyy-hhmmss-to-dd-mm-yyyy-using-vba-macro/47187386#47187386", "title": "Change dd/mm/yyyy hh:mm:ss to dd/mm/yyyy using VBA Macro", "body": "<pre><code>`DateValue(Range(\"A1\"))`\n</code></pre>\n\n<p>That is a built in function that will do the trick in most cases. </p>\n"}], "owner": {"reputation": 9, "user_id": 8907859, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OnvGHJh9kD8/AAAAAAAAAAI/AAAAAAAA61U/2OlgnYv_Xrs/photo.jpg?sz=128", "display_name": "Hassan Arshad", "link": "https://stackoverflow.com/users/8907859/hassan-arshad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 904, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1510166770, "creation_date": 1510156142, "last_edit_date": 1510157449, "question_id": 47183983, "link": "https://stackoverflow.com/questions/47183983/change-dd-mm-yyyy-hhmmss-to-dd-mm-yyyy-using-vba-macro", "title": "Change dd/mm/yyyy hh:mm:ss to dd/mm/yyyy using VBA Macro", "body": "<p>Need help :)</p>\n\n<p>I need your help to change the dd/mm/yyyy hh:mm:ss to dd/mm/yyyy using VBA so I don't have to do it manually everytime.</p>\n\n<p>StartDateTime</p>\n\n<pre><code>05/07/2017 07:17:44\n30/06/2017 23:44:46\n30/06/2017 23:16:03\n30/06/2017 23:02:33\n01/07/2017 09:56:38\n30/06/2017 23:15:50\n01/07/2017 10:45:53\n01/07/2017 12:18:01\n01/07/2017 13:14:53\n01/07/2017 14:06:37\n01/07/2017 11:57:16\n01/07/2017 15:12:39\n01/07/2017 12:03:47\n</code></pre>\n\n<p>Thank you</p>\n\n<hr>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 1, "creation_date": 1510157917, "post_id": 47183771, "comment_id": 81318306, "body": "One reason to use .worksheet is you&#39;ll have intellisense auto complete for .name"}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": false, "score": 2, "last_activity_date": 1510155470, "creation_date": 1510155470, "answer_id": 47183771, "question_id": 47183737, "link": "https://stackoverflow.com/questions/47183737/return-the-sheet-name-of-a-dynamic-name-range-in-vba/47183771#47183771", "title": "Return the sheet name of a dynamic name range in vba", "body": "<pre><code>Range(\"TestDym\").Worksheet.Name\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510156203, "post_id": 47183772, "comment_id": 81317055, "body": "Any particular reason for not using .Worksheet, @braX?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510156640, "post_id": 47183772, "comment_id": 81317349, "body": "Either will work. What you will discover about VBA is that there are many different ways of doing the same thing."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1510155474, "creation_date": 1510155474, "answer_id": 47183772, "question_id": 47183737, "link": "https://stackoverflow.com/questions/47183737/return-the-sheet-name-of-a-dynamic-name-range-in-vba/47183772#47183772", "title": "Return the sheet name of a dynamic name range in vba", "body": "<p>This will give you the name of the sheet your range is on.</p>\n\n<pre><code>Range(\"TestDym\").Parent.Name\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510158820, "post_id": 47184871, "comment_id": 81318944, "body": "Kudos for going through the way-underused <code>Names</code> collection, which is <i>the</i> right way to do this and end up with explicit code that reads like it&#39;s accessing a defined name."}, {"owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "edited": false, "score": 0, "creation_date": 1510219074, "post_id": 47184871, "comment_id": 81344502, "body": "Thanks! I was only typing Names(&quot;TestDym&quot;).Parent and not Names(&quot;TestDym&quot;).Parent.Name."}], "tags": [], "owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "is_accepted": true, "score": 2, "last_activity_date": 1510158566, "creation_date": 1510158566, "answer_id": 47184871, "question_id": 47183737, "link": "https://stackoverflow.com/questions/47183737/return-the-sheet-name-of-a-dynamic-name-range-in-vba/47184871#47184871", "title": "Return the sheet name of a dynamic name range in vba", "body": "<p>If you wish to return the \"Scope\" of the name range, you can use:</p>\n\n<pre><code>Names(\"TestDym\").Parent.Name\n</code></pre>\n\n<ul>\n<li>If TestDym is a workbook level name, then the result will return the workbook name.</li>\n<li>If TestDym is a worksheet level name, then the result will return the worksheet name.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/ugiQS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ugiQS.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/AsPLd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AsPLd.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/OOrIE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OOrIE.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 47184871, "answer_count": 3, "score": 0, "last_activity_date": 1510158566, "creation_date": 1510155368, "question_id": 47183737, "link": "https://stackoverflow.com/questions/47183737/return-the-sheet-name-of-a-dynamic-name-range-in-vba", "title": "Return the sheet name of a dynamic name range in vba", "body": "<p>I have the following problem:</p>\n\n<p>I have a dynamic namerange named <strong>TestDym</strong>.</p>\n\n<p>I am trying to retrieve the name of the worksheet that this namerange belongs through vba.</p>\n\n<p>I know that you can only refer to a namerange with the following structure:</p>\n\n<pre><code>Range(\"TestDym\")\n</code></pre>\n\n<p>However, I cannot get the sheet name of this namerange.</p>\n\n<p>Is it possible?</p>\n\n<p>Regards</p>\n\n<p>Thanasis</p>\n"}, {"tags": ["excel", "variables", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1510153343, "post_id": 47182924, "comment_id": 81314795, "body": "You are declaring Rg1 through Rg6 as variants not ranges.  The only variable that is being declared a range is the last one.  You can do <code>Dim Rg1 As Range, Rg2 As Range, ...</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1510155012, "post_id": 47182924, "comment_id": 81316216, "body": "That is a curious error to get just from changing a variable declaration though. I suspect there is something wrong with your code, such as the omission of a <code>Set</code> statement."}], "answers": [{"comments": [{"owner": {"reputation": 1006, "user_id": 6903657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KNLNv.jpg?s=128&g=1", "display_name": "Pierre", "link": "https://stackoverflow.com/users/6903657/pierre"}, "edited": false, "score": 0, "creation_date": 1510154513, "post_id": 47183061, "comment_id": 81315771, "body": "precision: in VB.NET, both lines do the same, while VBA has this dumb behaviour"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 2, "last_activity_date": 1510153585, "creation_date": 1510153585, "answer_id": 47183061, "question_id": 47182924, "link": "https://stackoverflow.com/questions/47182924/excel-vba-different-methods-of-declaring-variables/47183061#47183061", "title": "Excel VBA - Different methods of declaring variables", "body": "<p>If you declare your variables this way:</p>\n\n<pre><code>Dim Rg1, Rg2, Rg3, Rg4, Rg5, Rg6, Rg7 As Range\n</code></pre>\n\n<p>Only Rg7 will be <code>Range</code>, all others variables will be <code>Variant</code>\nIf you want only one line, the only option will be </p>\n\n<pre><code>Dim Rg1 As Range, Rg2 As Range, Rg3 As Range, Rg4 As Range, Rg5 As Range, Rg6 As Range, Rg7 As Range\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1510154604, "creation_date": 1510154604, "answer_id": 47183451, "question_id": 47182924, "link": "https://stackoverflow.com/questions/47182924/excel-vba-different-methods-of-declaring-variables/47183451#47183451", "title": "Excel VBA - Different methods of declaring variables", "body": "<p>Declaring all the values on one line works perfectly with <code>VB.Net</code>, but with VBA it is problematic. Thus, declaring <code>Dim Rg1, Rg4, Rg7 as Range</code> makes only the last declared value as <code>Range</code> and the others are <code>Variant</code>.</p>\n\n<p>However, in your case, once you set the other <code>Rg1</code> and <code>Rg4</code> to ranges, they start acting like a range. E.g., you may ask for <code>rg4.Address</code> and you will get it, because the new Type is <code>Variant/Object/Range</code> and if you declare it explicitly it will be <code>Range</code> - see the VBA monitor for the types:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jpl9z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jpl9z.png\" alt=\"enter image description here\"></a></p>\n\n<p>Furthermore, once you declare the values as <code>Variant</code>, they may change type easily. See the following code, where the types change from <code>Integer</code> to <code>String</code> once you redeclare it:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim rg1\n    Dim rg2\n    Dim bornRange   As Range\n\n    Range(\"A1\") = \"TEST\"\n\n    Debug.Print VarType(rg1) = vbEmpty      'true\n    Debug.Print VarType(rg2) = vbEmpty      'true\n\n    Set rg1 = Range(\"A1\")\n    rg2 = 2\n\n    Debug.Print VarType(rg1) = vbString     'true\n    Debug.Print VarType(rg2) = vbInteger    'true\n\n    Set rg2 = Range(\"A1\")\n    Debug.Print rg2.Address                 '$A$1\n\n    Debug.Print VarType(rg2) = vbInteger    'false\n    Debug.Print VarType(rg2) = vbString     'true    \n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1510163813, "creation_date": 1510163813, "answer_id": 47186561, "question_id": 47182924, "link": "https://stackoverflow.com/questions/47182924/excel-vba-different-methods-of-declaring-variables/47186561#47186561", "title": "Excel VBA - Different methods of declaring variables", "body": "<p>You could use an array of ranges, if you'd like:</p>\n\n<pre><code>Dim Rng(1 To 7) As Range\n\nSet Rng(1) = ws.Range(\"A1\")\nSet Rng(2) = ws.Range(\"B1\")\n' Etc....\n</code></pre>\n\n<p>As others have stated, with your declaration:<br>\n<code>Dim Rg1, Rg2, Rg3, Rg4, Rg5, Rg6, Rg7 As Range</code><br>\n<strong>Rg1-6</strong> are type <code>Variant</code>, while <strong>Rg7</strong> is type <code>Range</code></p>\n"}], "owner": {"reputation": 215, "user_id": 5244615, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ad068c341805464626762aee390d44b4?s=128&d=identicon&r=PG&f=1", "display_name": "Dullspark", "link": "https://stackoverflow.com/users/5244615/dullspark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 47183451, "answer_count": 3, "score": 2, "last_activity_date": 1510163813, "creation_date": 1510153229, "last_edit_date": 1531164843, "question_id": 47182924, "link": "https://stackoverflow.com/questions/47182924/excel-vba-different-methods-of-declaring-variables", "title": "Excel VBA - Different methods of declaring variables", "body": "<p>I'm trying to declare 7 variables as Ranges. I'm currently using this format</p>\n\n<pre><code>Dim Rg1 As Range\nDim Rg2 As Range\nDim Rg3 As Range\nDim Rg4 As Range\nDim Rg5 As Range\nDim Rg6 As Range\nDim Rg7 As Range\n</code></pre>\n\n<p>But i want to use this format</p>\n\n<pre><code>Dim Rg1, Rg2, Rg3, Rg4, Rg5, Rg6, Rg7 As Range\n</code></pre>\n\n<p>I thought there'd be no difference in this but apparently there is. Using the top format, the macro works perfectly. When i change and use the second format, i get the following error</p>\n\n<p>Runtime error '424'\nObject Required</p>\n\n<p>It makes this error when the range Rg4 is empty. It doesn't give an error when i use the first format though. Why?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1510153941, "post_id": 47182681, "comment_id": 81315318, "body": "If you&#39;re referencing a previous question, would you kindly include a link to that question?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1510154122, "post_id": 47182681, "comment_id": 81315481, "body": "@E.Merckx I have hyperlinked the word Post to my previous post."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510155312, "post_id": 47182681, "comment_id": 81316437, "body": "You have posted two images that are not aligned in terms of columns. Can you post a single image where the columns are aligned? If in same sheet, hide some of the intermediate rows before screenshot."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510155432, "post_id": 47182681, "comment_id": 81316514, "body": "@QHarr, The columns are correct for both, just the second image has wider column widths"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510155559, "post_id": 47182681, "comment_id": 81316594, "body": "Apologies for my ambiguous terminology. I am not saying they are wrong. Simply very difficult to follow as they are not aligned (have different widths). This difference in widths also obscures some text making it difficult to tell if the columns in the top pic have the same values as columns in the bottom pic for a given column."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510155696, "post_id": 47182681, "comment_id": 81316686, "body": "@QHarr, I will fix that, thank you."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510155811, "post_id": 47182681, "comment_id": 81316759, "body": "@QHarr, it should look better now"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510155872, "post_id": 47182681, "comment_id": 81316796, "body": "What differentiates contract from subsequent contracts? And also how does one determine one line contracts as it seems every line says One year contract for validity.?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510156158, "post_id": 47182681, "comment_id": 81317023, "body": "@QHarr, This works only for the first contract.  The subsequent contracts are differentiated by the <code>Column A</code>.  Where a new contract number begins.   The  goal is to have the last value from <code>Column I</code> for each contract.  For example, the contract that is the area <code>A11:L15</code>, the value in <code>J11</code> should equal the value in <code>K15</code>.  And this should be true for later contracts including contracts that are only one year like <code>A126</code> in the second image."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1510156381, "post_id": 47182681, "comment_id": 81317177, "body": "I suggest you edit your question and include that information rather than put in comments so others can easily find it."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510156694, "post_id": 47182681, "comment_id": 81317397, "body": "K15 is text whereas J11 is numeric so is J11 actually supposed to be K15?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1510156791, "post_id": 47182681, "comment_id": 81317481, "body": "My apologies, I meant <code>I15</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510157361, "post_id": 47182681, "comment_id": 81317924, "body": "Please show column I in image. If necessary, hide any irrelevant columns."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510157431, "post_id": 47182681, "comment_id": 81317974, "body": "@QHarr, it is in the images, which are aligned as well."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1510157461, "post_id": 47182681, "comment_id": 81317994, "body": "Apologies.Tired!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510157617, "post_id": 47182681, "comment_id": 81318091, "body": "So J11 should be 0 if set to I15?"}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510157780, "post_id": 47182681, "comment_id": 81318207, "body": "@QHarr, Correct, however my code is grabbing <code>I14</code>, which is the issue.  And every contract below is doing the same thing. Except for one year contracts which are blank."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510164710, "post_id": 47182681, "comment_id": 81322659, "body": "Here is an   example of some logic that would assign as we have discussed. <a href=\"https://pastebin.com/7vjwuQSG\" rel=\"nofollow noreferrer\">pastebin.com/7vjwuQSG</a>  You would need to amend the sheet name."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510168307, "post_id": 47182681, "comment_id": 81324816, "body": "@QHarr,  I found a solution, thank you though"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1510169038, "post_id": 47182681, "comment_id": 81325258, "body": "Great. Happy coding."}], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1510158319, "post_id": 47184657, "comment_id": 81318595, "body": "I apologize, I actually meant <code>Column I</code> I edited it in the post.  Also, This is one small example of a huge data file in which the data goes down to Row 56,000.  So I need a longer range."}, {"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "reply_to_user": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1510158803, "post_id": 47184657, "comment_id": 81318925, "body": "Just increase the range as needed. Or use the range you&#39;ve already defined. This will input the last value from <code>Column I</code> for a given contract block into the first cell in <code>Column J</code> for a given contract block. That&#39;s what it appears you are trying to achieve. If this is not what you&#39;re trying to accomplish, please edit your question to make it clear <i>what</i> you are trying to achieve."}, {"owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "edited": false, "score": 0, "creation_date": 1510159282, "post_id": 47184657, "comment_id": 81319251, "body": "I am currently away from my computer, but I will test it later. Thank you"}], "tags": [], "owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "is_accepted": true, "score": 1, "last_activity_date": 1510158034, "creation_date": 1510158034, "answer_id": 47184657, "question_id": 47182681, "link": "https://stackoverflow.com/questions/47182681/vba-set-range-from-max-in-range-2/47184657#47184657", "title": "VBA - Set Range from Max in range 2", "body": "<p>From what I understand, you want the first row of the contract to show the last contract value. Additionally, it appears that the contract description (column K) is consistent for a given contract. If I understand your question correctly, simply loop through the description to look for changes. Then input the value into the first unique cell corresponding to the given description.</p>\n\n<pre><code>Dim Rng As Range\nSet Rng = Range(\"k2:k146\")\nDim NextCell As Range\n\nFor Each Cell In Rng\n    Set NextCell = Cell\n    Do Until NextCell.Text &lt;&gt; Cell.Text\n        Set NextCell = NextCell.Offset(1, 0)\n    Loop\n    Set NextCell = NextCell.Offset(-1, 0)\n    If Cell.Offset(-1, 0).Text &lt;&gt; Cell.Text Then\n        Cell.Offset(0, -1).Value = NextCell.Offset(0, -2).Value\n    End If\nNext Cell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "is_accepted": false, "score": 0, "last_activity_date": 1510166657, "creation_date": 1510166657, "answer_id": 47187354, "question_id": 47182681, "link": "https://stackoverflow.com/questions/47182681/vba-set-range-from-max-in-range-2/47187354#47187354", "title": "VBA - Set Range from Max in range 2", "body": "<p>I was able to solve it.  Thanks to @E.Merckx for helping point me in the right direction.  Although it wasn't exactly what I wanted, it works just fine for its purpose.</p>\n\n<pre><code>Sub NetValue()\n\nDim lngLastRow As Long, raw As Worksheet, data As Worksheet, rng As Range\n\nlngLastRow = lastRow(column_to_check:=2)\n\nSet raw = Worksheets(\"Raw\")\nSet data = Worksheets(\"Data\")\nSet rng = raw.Range(raw.Cells(3, 6), raw.Cells(lngLastRow + 1, 6))\n\nraw.Range(\"J:J\").EntireColumn.Insert\nraw.Range(\"C:E\").EntireColumn.NumberFormat = \"mm/dd/yyyy\"\n\nFor Each Cell In rng\n    If Cell.Value &lt;&gt; \"\" Then\n        Cell.Offset(-1, 4) = Cell.Offset(-1, 3).Value\n    End If\nNext Cell\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RboGL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RboGL.png\" alt=\"Final Product\"></a></p>\n\n<p>Thanks again!</p>\n"}], "owner": {"reputation": 458, "user_id": 8396248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cd6414a82f4c99bcb0760c3e305164ea?s=128&d=identicon&r=PG&f=1", "display_name": "A Cohen", "link": "https://stackoverflow.com/users/8396248/a-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 47184657, "answer_count": 2, "score": 0, "last_activity_date": 1510166657, "creation_date": 1510152565, "last_edit_date": 1510156805, "question_id": 47182681, "link": "https://stackoverflow.com/questions/47182681/vba-set-range-from-max-in-range-2", "title": "VBA - Set Range from Max in range 2", "body": "<p>I edited my orignal <a href=\"https://stackoverflow.com/questions/47079162/vba-set-range-from-max-in-range\">post</a>, it seems to be working for the most part, but only for the contract, and subsequent contracts it pulls the second to last number, not the last number. Also it will not work for one line contracts, ie. 1 year.  This works only for the first contract.</p>\n\n<p>The subsequent contracts are differentiated by the <code>Column A</code>. Where a new contract number begins. The goal is to have the last value from <code>Column I</code> for each contract. For example, the contract that is the area <code>A11:L15</code>, the value in <code>J11</code> should equal the value in <code>I15</code>. And this should be true for later contracts including contracts that are only one year like <code>A126</code> in the second image</p>\n\n<p><a href=\"https://i.stack.imgur.com/y5LF0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y5LF0.png\" alt=\"Top\"></a>\n<a href=\"https://i.stack.imgur.com/f3YZU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f3YZU.png\" alt=\"One Year\"></a>.  </p>\n\n<p>If someone has any suggestions, it would be much appreciated.</p>\n\n<pre><code>Dim lngLastRow As Long, rngCell As Range, rngRange As Range, _\nlngMin As Long, lngMax As Long, lngPreviousRow As Long, _\nraw As Worksheet, data As Worksheet, dLRow As Double, endDate As Double, _\nr As Range, n As Long\n\nlngLastRow = lastRow(column_to_check:=2)\n\nSet raw = Worksheets(\"Raw\")\nSet data = Worksheets(\"Data\")\nSet rngRange = raw.Range(raw.Cells(2, 1), raw.Cells(lngLastRow + 1, 1))\ndLRow = data.Range(\"A1\", data.Range(\"A1\").End(xlDown)).Rows.Count\n\nraw.Range(\"J:J\").EntireColumn.Insert\nraw.Range(\"C:E\").EntireColumn.NumberFormat = \"mm/dd/yyyy\"\n\nFor Each rngCell In rngRange\n\n    If Len(rngCell) &gt; 0 Then\n\n        If lngPreviousRow &gt; 0 And (rngCell.Row - 1 &lt;&gt; lngPreviousRow) Then\n            raw.Cells(lngPreviousRow, 10) = s.Cells(n).Offset(0, 6)\n        End If\n\n        If (rngCell.Row = 1) Or lngPreviousRow = (rngCell.Row - 1) Then\n            Set r = raw.Range(rngCell.Offset(0, 1), rngCell(0, 2))\n            Set s = raw.Range(rngCell.Offset(0, 2), rngCell(0, 3))\n            lngMin = WorksheetFunction.Min(r)\n            lngMax = WorksheetFunction.Max(s)\n            m = Application.Match(lngMin, r, 0)\n            n = Application.Match(lngMax, s, 0)\n            raw.Cells(rngCell.Row, 10) = s.Cells(n).Offset(0, 6)\n        End If\n\n        lngPreviousRow = rngCell.Row\n        Set r = raw.Range(rngCell.Offset(0, 1), rngCell(0, 2))\n        Set s = raw.Range(rngCell.Offset(0, 2), rngCell(0, 3))\n        lngMin = WorksheetFunction.Min(r)\n        lngMax = WorksheetFunction.Max(s)\n        m = Application.Match(lngMin, r, 0)\n        n = Application.Match(lngMax, s, 0)\n\n    Else\n        Set r = raw.Range(rngCell.Offset(0, 1), rngCell(0, 2))\n        Set s = raw.Range(rngCell.Offset(0, 2), rngCell(0, 3))\n        lngMin = WorksheetFunction.Min(r)\n        lngMax = WorksheetFunction.Max(s)\n    End If\nNext rngCell\n\nCells(lngPreviousRow, 10) = s.Cells(n).Offset(0, 6)\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8906899, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L8vXsittvVU/AAAAAAAAAAI/AAAAAAAABZ8/mC60ri4NXuQ/photo.jpg?sz=128", "display_name": "Matt R", "link": "https://stackoverflow.com/users/8906899/matt-r"}, "edited": false, "score": 0, "creation_date": 1510157717, "post_id": 47183144, "comment_id": 81318161, "body": "Thanks Rik, But it didn&#39;t work! &quot;Run-time error &#39;5&#39;: Invalid procedure call or argument&quot; is comes up ..."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 11, "user_id": 8906899, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L8vXsittvVU/AAAAAAAAAAI/AAAAAAAABZ8/mC60ri4NXuQ/photo.jpg?sz=128", "display_name": "Matt R", "link": "https://stackoverflow.com/users/8906899/matt-r"}, "edited": false, "score": 0, "creation_date": 1510158557, "post_id": 47183144, "comment_id": 81318766, "body": "Try omitting the version parameter in the PivotCaches.Create method. That one is specific to your Excel version."}, {"owner": {"reputation": 11, "user_id": 8906899, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L8vXsittvVU/AAAAAAAAAAI/AAAAAAAABZ8/mC60ri4NXuQ/photo.jpg?sz=128", "display_name": "Matt R", "link": "https://stackoverflow.com/users/8906899/matt-r"}, "edited": false, "score": 0, "creation_date": 1510160760, "post_id": 47183144, "comment_id": 81320260, "body": "Nope! The error message changed to Run-Time error &#39;-2147024809 (80070057)&#39;"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 11, "user_id": 8906899, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L8vXsittvVU/AAAAAAAAAAI/AAAAAAAABZ8/mC60ri4NXuQ/photo.jpg?sz=128", "display_name": "Matt R", "link": "https://stackoverflow.com/users/8906899/matt-r"}, "edited": false, "score": 0, "creation_date": 1510163304, "post_id": 47183144, "comment_id": 81321825, "body": "Is the referenced range valid for functioning as a pivot cache? E.g. continuous range with unique column headers? Also are you sure about the indices of the sheets?"}, {"owner": {"reputation": 11, "user_id": 8906899, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L8vXsittvVU/AAAAAAAAAAI/AAAAAAAABZ8/mC60ri4NXuQ/photo.jpg?sz=128", "display_name": "Matt R", "link": "https://stackoverflow.com/users/8906899/matt-r"}, "edited": false, "score": 0, "creation_date": 1510165379, "post_id": 47183144, "comment_id": 81323104, "body": "Yes, I rechecked all those! I did one more test. I copied the whole Source out of the one with fixed value, which works properly: &quot;C:\\Users\\Matt\\Desktop&#91;FY19_Proposed_Sheet_V2.xlsm]Propo&zwnj;&#8203;sed Projects!R5C1:R29C18&quot; and put it into the variable you introduced &quot;sourceDataStr &quot; and used the variable in Sheets(4).PivotTables(&quot;PivotTable1&quot;).ChangePivotCache ThisWorkbook. _ PivotCaches.Create(SourceType:=xlDatabase, SourceData:=sourceDataStr , Version:=xlpivotversion14) .... It doesn&#39;t work! isn&#39;t it strange?"}, {"owner": {"reputation": 11, "user_id": 8906899, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L8vXsittvVU/AAAAAAAAAAI/AAAAAAAABZ8/mC60ri4NXuQ/photo.jpg?sz=128", "display_name": "Matt R", "link": "https://stackoverflow.com/users/8906899/matt-r"}, "edited": false, "score": 0, "creation_date": 1510168384, "post_id": 47183144, "comment_id": 81324867, "body": "Yaay!! Found the root cause of error! Actually we need to use RngAddress = S.Address(ReferenceStyle:=xlR1C1) and it works ..."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 11, "user_id": 8906899, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L8vXsittvVU/AAAAAAAAAAI/AAAAAAAABZ8/mC60ri4NXuQ/photo.jpg?sz=128", "display_name": "Matt R", "link": "https://stackoverflow.com/users/8906899/matt-r"}, "edited": false, "score": 0, "creation_date": 1511790152, "post_id": 47183144, "comment_id": 81980430, "body": "Only the root cause if your reference style is set like that for the workbook I think. Just passing the range as listed in answer works on my end. I&#39;d have to test it with the different setting too."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1510153823, "creation_date": 1510153823, "answer_id": 47183144, "question_id": 47182677, "link": "https://stackoverflow.com/questions/47182677/how-can-i-use-a-pre-defined-range-as-my-pivot-table-data-source/47183144#47183144", "title": "How can I use a &quot;pre-defined Range&quot; as my Pivot table data source", "body": "<p>It's because you have to provide a string referencing the <code>Range</code> you wish to set as <code>SourceData</code>. The following will work:</p>\n\n<pre><code>Sub Test()\nDim S As Range\n\nDim shName as string\nDim rngAddress as string\nDim sourceDataStr as string 'Has to hold both sheetname and address.\n\nSet S = Range(Sheets(1).Cells(4, 2), Sheets(1).Cells(18, 9))\n\nshName = Sheets(1).Name 'Capture sheet name of where the range is in your case\nrngAddress = S.Address 'Get the address for reference.\nsourceDataStr = shName &amp; \"!\" &amp; rngAddress 'Get the correct sourceData string\n\nSheets(4).PivotTables(\"PivotTable1\").ChangePivotCache ThisWorkbook. _\nPivotCaches.Create(SourceType:=xlDatabase, SourceData:=sourceDataStr , Version:=xlpivotversion14) 'Tadaaaaa...\nEnd Sub\n</code></pre>\n\n<p>Not the shortest possible / most optimezed code, but it's a sample after all.</p>\n"}], "owner": {"reputation": 11, "user_id": 8906899, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-L8vXsittvVU/AAAAAAAAAAI/AAAAAAAABZ8/mC60ri4NXuQ/photo.jpg?sz=128", "display_name": "Matt R", "link": "https://stackoverflow.com/users/8906899/matt-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510153823, "creation_date": 1510152547, "last_edit_date": 1531161705, "question_id": 47182677, "link": "https://stackoverflow.com/questions/47182677/how-can-i-use-a-pre-defined-range-as-my-pivot-table-data-source", "title": "How can I use a &quot;pre-defined Range&quot; as my Pivot table data source", "body": "<p>I have the following code </p>\n\n<pre><code>Dim S As Range\n\nSet S = Range(Sheets(1).Cells(4, 2), Sheets(1).Cells(18, 9))\n\nSheets(4).PivotTables(\"PivotTable1\").ChangePivotCache ThisWorkbook. _\nPivotCaches.Create(SourceType:=xlDatabase, SourceData:=S, Version:=xlpivotversion14)\n</code></pre>\n\n<p>This gives me an \"Invalid procedure or argument\" error!</p>\n\n<p>however when I use the range instead of \"S\" like the following:</p>\n\n<pre><code>Sheets(4).PivotTables(\"PivotTable1\").ChangePivotCache ThisWorkbook. _\n        PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"C:\\Users\\Matt\\Desktop\\[FY19_Proposed_Sheet_V2.xlsm]Proposed Projects!R5C1:R29C18\" _\n        , Version:=xlPivotTableVersion14)\n</code></pre>\n\n<p>I get no errors!</p>\n\n<p>I want to use \"S\" so that I can actively change and update it. the specified fixed range in the code is hypothetical.</p>\n\n<p>Thanks,\nMatt!</p>\n"}, {"tags": ["vba", "text-files", "wildcard"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1510152977, "post_id": 47182563, "comment_id": 81314533, "body": "Your thinking is correct. Take a look at <code>Instr</code> function. Or if you want wildcard then take a look at <code>Like</code> operator."}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1510663487, "post_id": 47182563, "comment_id": 81522169, "body": "If an answer has solved your question please consider <a href=\"https://meta.stackexchange.com/q/5234/179419\">accepting it</a> by clicking the check-mark and upvoting by clicking the up arrow. This indicates to the wider community that you&#39;ve found a solution. There is no obligation to do this."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8590889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607124379361856/picture?type=large", "display_name": "SkeXyz", "link": "https://stackoverflow.com/users/8590889/skexyz"}, "edited": false, "score": 0, "creation_date": 1510214491, "post_id": 47182863, "comment_id": 81342049, "body": "I tried that too, but it doesn&#39;t work. Even if I have a working code, and apply &#39;Like&#39; operator and replace a letter with an asterisk I get a runtime error &#39;62&#39; at said line."}, {"owner": {"reputation": 1, "user_id": 8590889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607124379361856/picture?type=large", "display_name": "SkeXyz", "link": "https://stackoverflow.com/users/8590889/skexyz"}, "edited": false, "score": 0, "creation_date": 1510215337, "post_id": 47182863, "comment_id": 81342442, "body": "I figured it out. I should&#39;ve replaced the first &#39;#&#39; also with an asterisk sign, it sort of messed up the code appartently. Thanks!"}], "tags": [], "owner": {"reputation": 1054, "user_id": 2146761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d3bc29238e60d795bd6644a548358d?s=128&d=identicon&r=PG", "display_name": "chris-crush-code", "link": "https://stackoverflow.com/users/2146761/chris-crush-code"}, "is_accepted": false, "score": 0, "last_activity_date": 1510153076, "creation_date": 1510153076, "answer_id": 47182863, "question_id": 47182563, "link": "https://stackoverflow.com/questions/47182563/read-varying-part-from-text-file-vba/47182863#47182863", "title": "Read varying part from text file (VBA)", "body": "<p>Like this <a href=\"https://www.mrexcel.com/forum/excel-questions/420472-string-starts-vba.html\" rel=\"nofollow noreferrer\">link</a> shows you want to use 'like'.</p>\n\n<pre><code>Do Until ts.ReadLine Like \"#COLUMN= *\" &amp; [?]\nLoop\n</code></pre>\n\n<p>This will let you use asterisk as a wildcard</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8590889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607124379361856/picture?type=large", "display_name": "SkeXyz", "link": "https://stackoverflow.com/users/8590889/skexyz"}, "edited": false, "score": 0, "creation_date": 1510218557, "post_id": 47183126, "comment_id": 81344232, "body": "I used your comment and that of the other respondants to add in a a &#39;Do While Loop&#39;, but it&#39;s not working properly yet. I&#39;ve added the complete code in my editted post, could you give me a push in the right direction to making it work?"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "reply_to_user": {"reputation": 1, "user_id": 8590889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607124379361856/picture?type=large", "display_name": "SkeXyz", "link": "https://stackoverflow.com/users/8590889/skexyz"}, "edited": false, "score": 0, "creation_date": 1510230064, "post_id": 47183126, "comment_id": 81351729, "body": "With your modified code, if the first line of your file does not contain <code>COLUMNINFO</code> then you will not go into the loop.  Is that the case here?  Irregardless, if you structure your modified code like I showed above it should give you what you need."}, {"owner": {"reputation": 1, "user_id": 8590889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607124379361856/picture?type=large", "display_name": "SkeXyz", "link": "https://stackoverflow.com/users/8590889/skexyz"}, "edited": false, "score": 0, "creation_date": 1510309012, "post_id": 47183126, "comment_id": 81390274, "body": "I&#180;ve implemented your suggestion (see most recent edit). Though, it structurally skips one line. So, while the condition is met: the 1st, 3rd and 5th line are not extracted, but the 2nd, 4th and 6th are."}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "reply_to_user": {"reputation": 1, "user_id": 8590889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607124379361856/picture?type=large", "display_name": "SkeXyz", "link": "https://stackoverflow.com/users/8590889/skexyz"}, "edited": false, "score": 0, "creation_date": 1510319619, "post_id": 47183126, "comment_id": 81396869, "body": "It&#39;s because you have an extra <code>ReadLine</code>.  Remove <code>textline = ts.ReadLine</code> (and replace every <code>textline</code> reference with <code>data</code>)  and you should be good."}], "tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 0, "last_activity_date": 1510153761, "creation_date": 1510153761, "answer_id": 47183126, "question_id": 47182563, "link": "https://stackoverflow.com/questions/47182563/read-varying-part-from-text-file-vba/47183126#47183126", "title": "Read varying part from text file (VBA)", "body": "<p>If I understand your problem correctly, try something like the following:</p>\n\n<pre><code>Do While Not ts.AtEndofStream\n   data = ts.ReadLine\n\n   If InStr(1, UCase(data), \"#COLUMNINFO\") &gt; 0 then\n      'do something\n   End If\nLoop\n\nts.close\n</code></pre>\n\n<p>I assume you are using <code>FileSystemObject</code> to read the file.</p>\n"}], "owner": {"reputation": 1, "user_id": 8590889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1607124379361856/picture?type=large", "display_name": "SkeXyz", "link": "https://stackoverflow.com/users/8590889/skexyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510308790, "creation_date": 1510152204, "last_edit_date": 1510308790, "question_id": 47182563, "link": "https://stackoverflow.com/questions/47182563/read-varying-part-from-text-file-vba", "title": "Read varying part from text file (VBA)", "body": "<p>From the following two example files I would like to only have all lines that start with #COLUMNINFO to be read into an excelfile, and each line be seperated using a comma as deliminator. </p>\n\n<p>I'm having trouble to just read only those lines, since the line numbers change per file. My attempt so far was to use a piece of code similar to: </p>\n\n<pre><code>Do Until ts.ReadLine = \"#COLUMN= \" &amp; [?]\nLoop\n</code></pre>\n\n<p>And read the file from that line on, but I can't seem to use wildcards in combination with .ReadFile.</p>\n\n<p>Any help is welcome.</p>\n\n<p><a href=\"https://drive.google.com/open?id=149i9hm4VG6-Szni2UZoIAmdRo0X1cqGB\" rel=\"nofollow noreferrer\">Example 1</a></p>\n\n<p><a href=\"https://drive.google.com/open?id=1rhe0cRrxczcXf2gGxe54Xeq42sNpXPiu\" rel=\"nofollow noreferrer\">Example 2</a></p>\n\n<p>I've eddited my code and this is the updated result. Somehow the 'Do While Loop' fails.<br>\nEdit: </p>\n\n<pre><code>Sub InfoExtractorTest()\n\n    Dim fso As Scripting.FileSystemObject\n    Dim ts As Scripting.TextStream\n    Dim textline As String\n    Dim CommaPosition As Integer\n\n    Set fso = New Scripting.FileSystemObject\n\n    Set ts = fso.OpenTextFile(Environ(\"Userprofile\") &amp; \"\\Desktop\\VBA Test\\GEFExtractor\\Example GEF's\\362B-S142.gef\")\n\n    Do While Not ts.AtEndOfStream\n\n      'Reads indiviual lines from file\n        Data = ts.ReadLine\n        If InStr(1, UCase(Data), \"#COLUMNINFO\") &gt; 0 Then\n\n        textline = ts.ReadLine\n        CommaPosition = InStr(textline, \",\")\n\n            Do Until CommaPosition = 0\n                ActiveCell.Value = Left(textline, CommaPosition - 1)\n                ActiveCell.Offset(0, 1).Select\n                textline = Right(textline, Len(textline) - CommaPosition)\n                CommaPosition = InStr(textline, \",\")\n            Loop\n\n            ActiveCell.Value = textline\n            ActiveCell.Offset(1, 0).End(xlToLeft).Select\n\n        End If\n    Loop\n\n    ts.Close\n    Set fso = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 4, "creation_date": 1510151367, "post_id": 47182266, "comment_id": 81313364, "body": "Did you forget a file wildcard? - <code>&quot;C:\\Users\\Brian.Scott\\Documents\\2017_INVENTORY\\TestInv\\*.XLS&zwnj;&#8203;*&quot;</code>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1510151433, "post_id": 47182266, "comment_id": 81313407, "body": "You will also need a backslash between the myPath and Filename."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1510151793, "post_id": 47182266, "comment_id": 81313643, "body": "Can you try <code>Dir(myPath, vbDirectory)</code> or <code>Dir()</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1510151822, "post_id": 47182266, "comment_id": 81313663, "body": "For the record, <code>Null</code> isn&#39;t <code>vbNullString</code> or <code>&quot;&quot;</code>. <code>Null</code> is a very special value that you&#39;re unlikely to ever need or even come across in VBA code written against the Excel object model."}, {"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510152094, "post_id": 47182266, "comment_id": 81313855, "body": "Brilliant! Fixed that problem. Here&#39;s my altered code:Sub GetSheets() myPath = &quot;C:\\Users\\Brian.Scott\\Documents\\2017_INVENTORY\\TestInv*.xls*&zwnj;&#8203;&quot; myFilename = Dir(myPath)    Do While myFilename &lt;&gt; &quot;&quot;   MsgBox (myPath &amp; &quot;\\&quot; &amp; myFilename)   Workbooks.Open Filename:=myPath &amp; &quot;\\&quot; &amp; myFilename, ReadOnly:=True      For Each Sheet In ActiveWorkbook.Sheets      Sheet.Copy After:=ThisWorkbook.Sheets(1)   Next Sheet      Workbooks(myFilename).Close      Filename = Dir()   Loop End Sub    However, I get a message that &quot;Method open failed"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1510152113, "post_id": 47182266, "comment_id": 81313868, "body": "Post an answer, don&#39;t answer in comments ;-)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1510152211, "post_id": 47182266, "comment_id": 81313940, "body": "@B_Scott - you do not need the second <code>*</code> in <code>*.xls*\u200c</code>. Just <code>*.xls</code> is enough."}, {"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 1, "creation_date": 1510152370, "post_id": 47182266, "comment_id": 81314043, "body": "The files are xlsx that was the reason for the second *"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510152375, "post_id": 47182266, "comment_id": 81314045, "body": "Also the <code>Workbooks.Open</code> method <i>returns an object reference to the workbook object</i> that was just opened - you should keep that reference in a <code>Workbook</code> variable, e.g. <code>Set wb = Workbooks.Open(...)</code>, and then you work against that <code>wb</code> variable instead of <code>ActiveWorkbook</code>. This means you can do <code>wb.Close</code> instead of fetching that object from the <code>Workbooks</code> collection every time... and here I am, answering in comments..."}, {"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510152484, "post_id": 47182266, "comment_id": 81314133, "body": "Sorry - new here - I&#39;m not seeing how to &quot;Post&quot; and answer"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510153102, "post_id": 47182266, "comment_id": 81314618, "body": "No problem, see below - and feel free to <a href=\"https://stackoverflow.com/help/someone-answers\">read this</a>. Cheers!"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510153553, "post_id": 47182831, "comment_id": 81314984, "body": "I may a few minor modifications (I think my explanation was wanting) and it works like a charm! I need to rename the tabs - I can use a specific cell for the name. Should I do that on the way in, or after I get them in the master sheet?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510153662, "post_id": 47182831, "comment_id": 81315085, "body": "You can do it any way you want to - just as long as you never end up with 2 sheets with the same name, everything should go well. I&#39;d try to do it in the loop body. I think <code>sh.Copy</code> will activate the created sheet, so you&#39;d go <code>ActiveSheet.Name = whateverYouMakeItBe</code>"}, {"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510154468, "post_id": 47182831, "comment_id": 81315742, "body": "For some reason I&#39;m not getting all the sheets in the directory - only 4 out 6"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510154492, "post_id": 47182831, "comment_id": 81315762, "body": "Check your filter, compare to the missing file names, adjust accordingly. If they look the same, watch for leading/trailing spaces."}, {"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510155739, "post_id": 47182831, "comment_id": 81316722, "body": "I set the filter to *.xls? which I assume will grab everything. The only difference in the names is a leading date. &quot;1-3-2017 Inventory&quot; is not getting used but &quot;1-9-2017 Inventory&quot; is being picked up"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510155790, "post_id": 47182831, "comment_id": 81316748, "body": "If you can, use a folder that only contains the files you need, and go with <code>*.*</code> for a filter =)"}, {"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510155929, "post_id": 47182831, "comment_id": 81316836, "body": "It appears to only load 4 sheets no matter how many are in the directory"}, {"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510156008, "post_id": 47182831, "comment_id": 81316904, "body": "I changed the filter - still only 4 files processed"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510156021, "post_id": 47182831, "comment_id": 81316912, "body": "Without a run-time error, that makes little sense. Are you silencing errors with <code>On Error Resume Next</code> by any chance?"}, {"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510156103, "post_id": 47182831, "comment_id": 81316979, "body": "No not silencing anything. It only does 4 no matter how many are in the directory"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510156144, "post_id": 47182831, "comment_id": 81317013, "body": "Make a new question, share your code <i>and</i> the expected filenames. Something isn&#39;t adding up."}, {"owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "edited": false, "score": 0, "creation_date": 1510156323, "post_id": 47182831, "comment_id": 81317139, "body": "Sorry - ignore my ineptitude! All is working great. Operator error! Thanks VERY much for all your help!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1510152992, "creation_date": 1510152992, "answer_id": 47182831, "question_id": 47182266, "link": "https://stackoverflow.com/questions/47182266/excel-dir-returns-unexpected-null/47182831#47182831", "title": "Excel Dir returns unexpected null", "body": "<p>Declare all your variables - specify <code>Option Explicit</code> at the top of every module, and then declare every single variable you use until the code compiles again. Not doing that is only asking for trouble; VBA will happily compile and run a typo, and debugging that isn't fun at all. Use Option Explicit. Always.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetSheets()\n    Const myPath As String = \"C:\\Users\\Brian.Scott\\Documents\\2017_INVENTORY\\\"\n    Const myFilter As String = \"TestInv*.xls?\"\n\n    Dim myFilename As String\n    myFilename = Dir(myPath &amp; myFilter)\n\n    Do While myFilename &lt;&gt; vbNullString\n        MsgBox myFilename\n        With Workbooks.Open(Filename:=myPath &amp; myFilename, ReadOnly:=True)\n            Dim sh As Worksheet\n            For Each sh In .Worksheets\n                sh.Copy After:=ThisWorkbook.Sheets(1)\n            Next\n            .Close\n        End With\n        Filename = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Notice that <code>With</code> block - it's holding a reference to the <code>Workbook</code> object that the <code>Workbooks.Open</code> function returns, so you can do <code>.Worksheets</code> and <code>.Close</code> against it, without needing to code against <code>ActiveWorkbook</code>, and without needing to re-fetch that exact same object reference from the <code>Workbooks</code> collection at every iteration.</p>\n\n<p>Your <code>myPath</code> contains a path, yes, but also wildcards, and I doubt this would work as expected:</p>\n\n<pre><code>Workbooks.Open \"C:\\Users\\Brian.Scott\\Documents\\2017_INVENTORY\\TestInv*.xls?\\TestInv42.xlsx\"\n</code></pre>\n\n<p>That's why I split the <code>myPath</code> string into a <em>path</em> and a <em>filter</em>: you supply the <em>filter</em> to the <code>Dir</code> function, and supply the <code>Workbooks.Open</code> function with the <em>path</em> with the file name that <code>Dir</code> returned.</p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1510153186, "last_edit_date": 1510153186, "creation_date": 1510153014, "answer_id": 47182837, "question_id": 47182266, "link": "https://stackoverflow.com/questions/47182266/excel-dir-returns-unexpected-null/47182837#47182837", "title": "Excel Dir returns unexpected null", "body": "<p>Sth like this should work</p>\n\n<pre><code>   Sub GetSheets()\n      myPath = \"C:\\Users\\Brian.Scott\\Documents\\2017_INVENTORY\\TestInv\\\"\n      Filename = Dir(myPath, vbNormal)\n      MsgBox (Filename)\n    Do While Filename &lt;&gt; \"\"\n      Workbooks.Open Filename:=myPath &amp; Filename, ReadOnly:=True\n      For Each Sheet In ActiveWorkbook.Sheets\n      Sheet.Copy After:=ThisWorkbook.Sheets(1)\n      Next Sheet\n      Workbooks(Filename).Close\n      Filename = Dir()\n    Loop\n  End Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8907350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5015e88abc8b86957eac5069f66b532?s=128&d=identicon&r=PG&f=1", "display_name": "B_Scott", "link": "https://stackoverflow.com/users/8907350/b-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 47182831, "answer_count": 2, "score": 2, "last_activity_date": 1510153186, "creation_date": 1510151293, "last_edit_date": 1510151331, "question_id": 47182266, "link": "https://stackoverflow.com/questions/47182266/excel-dir-returns-unexpected-null", "title": "Excel Dir returns unexpected null", "body": "<p>I'm trying to write what I thought would be a simple routine to take all the Excel sheets in a directory and copy them to tabs in a master sheet. Here's what I'm trying:</p>\n\n<pre><code>Sub GetSheets()\n      myPath = \"C:\\Users\\Brian.Scott\\Documents\\2017_INVENTORY\\TestInv\"\n      Filename = Dir(myPath)\n      MsgBox (Filename)\n    Do While Filename &lt;&gt; \"\"\n      Workbooks.Open Filename:=myPath &amp; Filename, ReadOnly:=True\n      For Each Sheet In ActiveWorkbook.Sheets\n      Sheet.Copy After:=ThisWorkbook.Sheets(1)\n      Next Sheet\n      Workbooks(Filename).Close\n      Filename = Dir()\n    Loop\n  End Sub\n</code></pre>\n\n<p>I put in the MsgBox when nothing was happening. It returns a null. myPath returns the correct name - which I copied and pasted from explorer to avoid spelling errors. I only have excel files in the directory, so I'm not error checking. This is a one-off need, but there are over 200 files in the directory, so I figured I could spend a little time on the code.\nAny ideas will be greatly appreciated as I'm pretty green with this.</p>\n"}, {"tags": ["vba", "ms-word", "caption"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1510152097, "post_id": 47182134, "comment_id": 81313857, "body": "We need to see more of your code and a clearer explanation of what you&#39;re doing. It&#39;s implied that your code is written and run from Excel (because &quot;cell B2&quot;) and operates on a Word document. How are you creating the <code>Selection</code> of where to insert your caption? The answer to your problem is likely along the lines of deleting the selection before or after you insert the caption."}, {"owner": {"reputation": 1104, "user_id": 4520420, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e92286a92381c034c5e84ee8f15933fe?s=128&d=identicon&r=PG&f=1", "display_name": "oli5679", "link": "https://stackoverflow.com/users/4520420/oli5679"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1510152890, "post_id": 47182134, "comment_id": 81314449, "body": "Thank you, I have tried to add more code and context to make my question clearer."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510158621, "post_id": 47182134, "comment_id": 81318805, "body": "One problem I see is that the Word &#39;InsertCaption&#39; method will automatically include &#39;Table nnn:&#39; as part of your caption. The other problem I see is that you are inserting &#39;Captions&#39;, but assigning them all to one location. Normally a caption is for a shape or object? Did you exclude the code to &#39;import&#39; your data from Excel?  If not, and all you want is something like a table of contents, then you need to change your approach."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 1, "last_activity_date": 1510254191, "creation_date": 1510254191, "answer_id": 47209646, "question_id": 47182134, "link": "https://stackoverflow.com/questions/47182134/vba-word-add-caption/47209646#47209646", "title": "VBA word add caption", "body": "<p>One of the built-in features of using the Caption style in MS Word is the automatic numbering it applies and dynamically adjust in your document. You are explicitly trying to manage the table numbering yourself - which is fine - but you'll then have to un-do some of Word's automatic helpful numbering in your code.</p>\n\n<p>Working from Excel, I've tested the code below to set up a test document with Captions and then a quick routine to remove the automatic part of the label. This example code works as a stand-alone test to illustrate how I worked it, leaving it to you to adapt to your own code.</p>\n\n<p>The initial <code>test</code> sub simply establishes the <code>Word.Application</code> and <code>Document</code> objects, then creates three tables with following paragraphs. Each of the tables has it's own caption (which shows the doubled up label, due to the automatic labeling from Word). The code throws up a <code>MsgBox</code> to pause so you can take a look at the document before it's modified.</p>\n\n<p><a href=\"https://i.stack.imgur.com/609lo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/609lo.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then the code goes back and searches the entire document for any <code>Caption</code> styles and examines the text within the style to find the double label. I made the assumption that a double label is present if there are two colons \":\" detected in the caption text. The first label (up to and past the first colon) is removed and the text replaced. With that, the resulting document looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ketGt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ketGt.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code:</p>\n\n\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim objWord As Object\n    Dim objDoc As Object\n    Set objWord = CreateObject(\"Word.Application\")\n    objWord.Visible = True\n    Set objDoc = objWord.documents.Add\n\n    Dim newTable As Object\n    Set newTable = objDoc.Tables.Add(Range:=objDoc.Range, NumRows:=3, NumColumns:=1)\n    newTable.Borders.Enable = True\n    newTable.Range.InsertCaption Label:=\"Table\", Title:=\": Table 1: summary xx\"\n    objDoc.Range.InsertParagraphAfter\n    objDoc.Range.InsertAfter \"Lorem ipsum\"\n\n    objDoc.Characters.Last.Select\n    objWord.Selection.Collapse\n    Set newTable = objDoc.Tables.Add(Range:=objWord.Selection.Range, NumRows:=3, NumColumns:=2)\n    newTable.Range.InsertCaption Label:=\"Table\", Title:=\": Table 2: summary yy\"\n    newTable.Borders.Enable = True\n    objDoc.Range.InsertParagraphAfter\n    objDoc.Range.InsertAfter \"Lorem ipsum\"\n\n    objDoc.Characters.Last.Select\n    objWord.Selection.Collapse\n    Set newTable = objDoc.Tables.Add(Range:=objWord.Selection.Range, NumRows:=3, NumColumns:=3)\n    newTable.Range.InsertCaption Label:=\"Table\", Title:=\": Table 3: summary zz\"\n    newTable.Borders.Enable = True\n    objDoc.Range.InsertParagraphAfter\n    objDoc.Range.InsertAfter \"Lorem ipsum\"\n\n    MsgBox \"document created. hit OK to continue\"\n\n    RemoveAutoCaptionLabel objWord\n    Debug.Print \"-----------------\"\nEnd Sub\n\nSub RemoveAutoCaptionLabel(ByRef objWord As Object)\n    objWord.Selection.HomeKey 6  'wdStory=6\n    With objWord.Selection.Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .Style = \"Caption\"\n        .Text = \"\"\n        .Forward = True\n        .Wrap = 1            'wdFindContinue=1\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        Do While .Execute()\n            RemoveDoubleLable objWord.Selection.Range\n            objWord.Selection.Collapse 0   'wdCollapseEnd=0\n        Loop\n    End With\nEnd Sub\n\nSub RemoveDoubleLable(ByRef capRange As Object)\n    Dim temp As String\n    Dim pos1 As Long\n    Dim pos2 As Long\n    temp = capRange.Text\n    pos1 = InStr(1, temp, \":\", vbTextCompare)\n    pos2 = InStr(pos1 + 1, temp, \":\", vbTextCompare)\n    If (pos1 &gt; 0) And (pos2 &gt; 0) Then\n        temp = Trim$(Right$(temp, Len(temp) - pos1 - 1))\n        capRange.Text = temp\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1104, "user_id": 4520420, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e92286a92381c034c5e84ee8f15933fe?s=128&d=identicon&r=PG&f=1", "display_name": "oli5679", "link": "https://stackoverflow.com/users/4520420/oli5679"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2814, "favorite_count": 0, "accepted_answer_id": 47209646, "answer_count": 1, "score": 1, "last_activity_date": 1510254191, "creation_date": 1510150865, "last_edit_date": 1510165373, "question_id": 47182134, "link": "https://stackoverflow.com/questions/47182134/vba-word-add-caption", "title": "VBA word add caption", "body": "<p>I am trying to add captions to a word document, using VBA. I am using the following code. The data starts off as tables in an Excel spreadsheet, with one per sheet. We are trying to generate a list of tables in the word document.</p>\n\n<p>The following code loads starts editing a word template:</p>\n\n<pre><code>Set objWord = CreateObject(\"Word.Application\")\nobjWord.Visible = True\nSet objDoc = objWord.Documents.Add(\"Template path\")\n\n' Moving to end of word document\nobjWord.Selection.EndKey END_OF_STORY, MOVE_SELECTION\n\n' Insert title\nobjWord.Selection.Font.Size = \"16\"\nobjWord.Selection.Font.Bold = True\nobjWord.Selection.TypeText (\"Document name\")\nobjWord.Selection.ParagraphFormat.SpaceAfter = 12\nobjWord.Selection.InsertParagraphAfter\n</code></pre>\n\n<p>The following code loops through the sheets in the worksheet and adds the tables and headers. </p>\n\n<pre><code>' Declaring variables\nDim Wbk As Workbook\nDim Ws As Worksheet\nDim END_OF_STORY As Integer: END_OF_STORY = 6\nDim MOVE_SELECTION As Integer: MOVE_SELECTION = 0\nDim LastRow As Integer\nDim LastColumn As Integer\nDim TableCount As Integer\nDim sectionTitle As String: sectionTitle = \" \"\n\n' Loading workbook\nSet Wbk = Workbooks.Open(inputFileName)\n\n' Moving to end of word document\nobjWord.Selection.EndKey END_OF_STORY, MOVE_SELECTION\n\n' Looping through all spreadsheets in workbook\nFor Each Ws In Wbk.Worksheets\n\n' Empty Clipboard\nApplication.CutCopyMode = False\n\n\nobjWord.Selection.insertcaption Label:=\"Table\", title:=\": \" &amp; Ws.Range(\"B2\").Text\n</code></pre>\n\n<p>In the cell B2, I have the following text: \"Table 1: Summary\". I am hoping for the word document to have a header which reflects this text. The problem is the table number is repeated twice, and I get output: \"Table 1: Table 1: Summary\". I tried the following alterations, both of which resulted in errors:</p>\n\n<pre><code>objWord.Selection.insertcaption Label:=\"\", title:=\"\" &amp; Ws.Range(\"B2\").Text\n\nobjWord.Selection.insertcaption Label:= Ws.Range(\"B2\").Text\n</code></pre>\n\n<p>What am I doing wrong, and more generally how does the insertcaption method work?</p>\n\n<p>I have tried reading this, but am confused by the syntax.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/selection-insertcaption-method-word\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/word-vba/articles/selection-insertcaption-method-word</a></p>\n"}, {"tags": ["excel", "internet-explorer", "vba"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "edited": false, "score": 0, "creation_date": 1510157568, "post_id": 47183925, "comment_id": 81318059, "body": "Daniel, I spoke to soon. It works when I go through the code step by step (using F8), but still does not work when I run it normally. Any thoughts?"}, {"owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "edited": false, "score": 1, "creation_date": 1510166353, "post_id": 47183925, "comment_id": 81323642, "body": "Daniel, I appreciate the help. It is definitely a timing thing."}], "tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": true, "score": 1, "last_activity_date": 1510166290, "last_edit_date": 1510166290, "creation_date": 1510155938, "answer_id": 47183925, "question_id": 47182132, "link": "https://stackoverflow.com/questions/47182132/navigating-through-websites/47183925#47183925", "title": "Navigating through websites", "body": "<h2>EDIT:</h2>\n\n<p>I think you are not giving enough time for ie to load... It is working for me.\nSo you can try this code that gives more time and try to load 3 times before aborting.</p>\n\n<pre><code>Option Explicit\nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n\nSub InternetPractice2()\n\n\n    Dim IE As InternetExplorer\n    Dim HTMLDoc As HTMLDocument\n    Dim logo As Object\n    Dim n As Long\n    Set IE = New InternetExplorer                'Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    With IE\n        .Silent = True\n        .Visible = True\n        .Navigate \"https://www.yahoo.com\"\n    End With\n\n    WaitIE IE, 5000\n\n    Set HTMLDoc = IE.Document\n    HTMLDoc.getElementById(\"uh-search-box\").Value = \"Earth\"\n    HTMLDoc.getElementById(\"uh-search-button\").Click\n\nload:\n    WaitIE IE, 10000\n    Set logo = HTMLDoc.getElementById(\"logo\")\n    If Not logo Is Nothing Then\n        logo.Click\n    ElseIf logo Is Nothing And n &lt; 4 Then\n        n = n + 1\n        GoTo load\n    End If\n    WaitIE IE, 5000\n\n    'Set ie to Nothing\n    IE.Quit\n    Set IE = Nothing\nEnd Sub\nSub WaitIE(IE As Object, Optional time As Long = 250)\n'Code from: https://stackoverflow.com/questions/33808000/run-time-error-91-object-variable-or-with-block-variable-not-set\nDim i As Long\nDo\n    Sleep time\n    Debug.Print CStr(i) &amp; vbTab &amp; \"Ready: \" &amp; CStr(IE.READYSTATE = 4) &amp; _\n                vbCrLf &amp; vbTab &amp; \"Busy: \" &amp; CStr(IE.Busy)\n    i = i + 1\nLoop Until IE.READYSTATE = 4 Or Not IE.Busy\nEnd Sub\n</code></pre>\n\n<h2>Original Answer</h2>\n\n<p>Try closing ie in the end of the code and add some delay, because if you step the code with F8, you will see that it works:</p>\n\n<pre><code>Sub InternetPractice2()\n\nDim ie As InternetExplorer\n\nSet ie = New InternetExplorer\n\nie.Visible = True\n\nie.navigate \"https://www.yahoo.com\"\n\nDo While ie.Busy = True Or ie.READYSTATE &lt;&gt; 4: DoEvents: Loop\n\nie.Document.getElementById(\"uh-search-box\").Value = \"Earth\"\nie.Document.getElementById(\"uh-search-button\").Click\n'Add delay After .Click\n\nDo While ie.Busy = True Or ie.READYSTATE &lt;&gt; 4: DoEvents: Loop\nApplication.wait Now+Timevalue(\"00:00:05\")\n\nie.Document.getElementById(\"logo\").Click\n'Set ie to Nothing\nSet ie = Nothing\nEnd Sub\n</code></pre>\n\n<p>Also close all iexplorer.exe on Windows Task Manager.</p>\n"}], "owner": {"reputation": 81, "user_id": 8907155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97066eee1516b5a283090d5a5d6d710a?s=128&d=identicon&r=PG&f=1", "display_name": "T Doe", "link": "https://stackoverflow.com/users/8907155/t-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1586, "favorite_count": 0, "accepted_answer_id": 47183925, "answer_count": 1, "score": 1, "last_activity_date": 1510166290, "creation_date": 1510150861, "last_edit_date": 1531164843, "question_id": 47182132, "link": "https://stackoverflow.com/questions/47182132/navigating-through-websites", "title": "Navigating through websites", "body": "<p>My code is able to interact with the first webpage it brings up, but then as soon as i navigate away from it, my code gives me a '424' object required error. Here is an example.</p>\n\n<p>EX: go to yahoo.com - search for 'Earth' - click on the Yahoo logo to return to the yahoo homepage</p>\n\n<pre><code>Sub InternetPractice()\n\nDim ie As InternetExplorer\n\nSet ie = New InternetExplorer\n\nie.Visible = True\n\nie.navigate \"https://www.yahoo.com\"\n\nDo While ie.Busy = True Or ie.readyState &lt;&gt; 4: DoEvents: Loop\n\nie.document.getElementById(\"uh-search-box\").Value = \"Earth\"\nie.document.getElementById(\"uh-search-button\").Click\n\n\nDo While ie.Busy = True Or ie.readyState &lt;&gt; 4: DoEvents: Loop\n\nie.document.getElementById(\"logo\").Click\n\nEnd Sub\n</code></pre>\n\n<p>Using VBA with the internet is new to me and any help is appreciated!</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "edited": false, "score": 0, "creation_date": 1510152171, "post_id": 47182437, "comment_id": 81313915, "body": "It&#39;s being used on a pivot table (not my design) but works either way :)"}, {"owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "edited": false, "score": 0, "creation_date": 1510152638, "post_id": 47182437, "comment_id": 81314246, "body": "Ah, it&#39;s now ignoring my {.PasteAndFormat (wdFormatPlainText)}"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "edited": false, "score": 0, "creation_date": 1510152787, "post_id": 47182437, "comment_id": 81314367, "body": "@CoffeeFuelsMeNow  I don&#39;t have access to your doc, so I can&#39;t debug what going on............sorry.............."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "edited": false, "score": 0, "creation_date": 1510152858, "post_id": 47182437, "comment_id": 81314416, "body": "@CoffeeFuelsMeNow You may need to <b>re-format after the paste</b>"}, {"owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "edited": false, "score": 0, "creation_date": 1510153050, "post_id": 47182437, "comment_id": 81314578, "body": "Ah, that explains it. Thank you. I am completely new to this."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1510151852, "creation_date": 1510151852, "answer_id": 47182437, "question_id": 47182107, "link": "https://stackoverflow.com/questions/47182107/only-copy-cells-with-data-from-excel-to-word/47182437#47182437", "title": "Only copy cells with data from Excel to Word", "body": "<p>This assumes that column <strong>B</strong> is <em>compact</em> (no holes in the data):</p>\n\n<pre><code>Sub CopyRangeToWord()\n    Dim objWord, N As Long\n    Dim objDoc\n    Set objWord = CreateObject(\"Word.Application\")\n    Set objDoc = objWord.documents.Add\n\n    N = Cells(Rows.Count, \"B\").End(xlUp).Row\n    Range(\"B5:B\" &amp; N).Copy\n\n\n    With objDoc.Paragraphs(objDoc.Paragraphs.Count).Range\n       'All formatting goes here\n       .PasteAndFormat (wdFormatPlainText)\n    End With\n    objWord.Visible = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 47182437, "answer_count": 1, "score": 2, "last_activity_date": 1510152927, "creation_date": 1510150801, "last_edit_date": 1510152927, "question_id": 47182107, "link": "https://stackoverflow.com/questions/47182107/only-copy-cells-with-data-from-excel-to-word", "title": "Only copy cells with data from Excel to Word", "body": "<p>I need some further help developing my code. I have the basics down now with some earlier help but I am not sure on this next part.</p>\n\n<p>The code I am designing will run in a spreadsheet whereby the amount of rows used in a sheet will vary depending on the amount of data being used. (Due to nature of business and Norwegian Laws, I can't go into more details.) </p>\n\n<p>I'd like to have a Range of <code>B5:B1000</code> as a standard range and only have cells containing data be auto filled into the template but I am unsure how to write said code. Could someone please advise how I am able to go about this?</p>\n\n<p>All questions related to this have been based on copying from one sheet to another. </p>\n\n<p>This is my code so far which I am using in excel:</p>\n\n<pre><code>Sub CopyRangeToWord()\nDim objWord\nDim objDoc\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc = objWord.Documents.Open(\"C:\\Users\\CoffeeFuelsMeNow\\Documents\\Custom Office Templates\\EVERYTHING IS AWESOME.dotx\")\n\nRange(\"B5:B92\").Copy\n\n\nWith objDoc.Paragraphs(objDoc.Paragraphs.Count).Range\n   'All formatting goes here\n   .PasteAndFormat (wdFormatPlainText)\nEnd With\nobjWord.Visible = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1510150781, "post_id": 47181818, "comment_id": 81312938, "body": "What is the problem with your code? What works? Where is the error?"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1510150979, "creation_date": 1510150979, "answer_id": 47182178, "question_id": 47181818, "link": "https://stackoverflow.com/questions/47181818/how-to-use-references-to-another-workbooks-when-using-vlookup/47182178#47182178", "title": "How to use references to another workbooks when using VLOOKUP", "body": "<p>The code in your post is a bit confusing, but see the code below for the concept as well as comments explaining.</p>\n\n<pre><code>Option Explicit\n\nSub VlookupExample()\n\n    Dim FileToOpen As Variant\n\n    'grabs workbook\n    FileToOpen = Application.GetOpenFilename(\"Microsoft Excel Files (*.xlsx), *.xlsx\", 1, \"Open today's GA ships\")\n    Workbooks.Open FileName:=FileToOpen\n\n    'FileToOpen now stores the workbook full path name\n    'strip out only workbook name\n    Dim FileName As String\n    FileName = Mid(FileToOpen, InStrRev(FileToOpen, \"\\\") + 1, 255)\n\n    'Now use in vlookup (same way you would if entered manually in cell.\n    Range(\"Y2\").Formula = \"=vlookup(X2,\" &amp; FileName &amp; \"!blog,2,False)\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7653920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13f192963632219e5d708bf6016b739?s=128&d=identicon&r=PG&f=1", "display_name": "jana", "link": "https://stackoverflow.com/users/7653920/jana"}, "edited": false, "score": 0, "creation_date": 1510152652, "post_id": 47182244, "comment_id": 81314257, "body": "@MercinSzaleniec thank you very much! works great. I just have one issue with it. in one vlookup it gives me values correctly, but the second one doesn&#39;t, it gives me #REF!. i have the same code, just instead of 2 i want value from 3rd column. Can you see where the problem could be?"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 13, "user_id": 7653920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13f192963632219e5d708bf6016b739?s=128&d=identicon&r=PG&f=1", "display_name": "jana", "link": "https://stackoverflow.com/users/7653920/jana"}, "edited": false, "score": 0, "creation_date": 1510153143, "post_id": 47182244, "comment_id": 81314641, "body": "what you can in in formula bar when clicking on the cell with #REF!?"}, {"owner": {"reputation": 13, "user_id": 7653920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13f192963632219e5d708bf6016b739?s=128&d=identicon&r=PG&f=1", "display_name": "jana", "link": "https://stackoverflow.com/users/7653920/jana"}, "edited": false, "score": 0, "creation_date": 1510154284, "post_id": 47182244, "comment_id": 81315604, "body": "it was exactly the same as the first one. here&#39;s the code i got:  ActiveSheet.Range(&quot;A1:BG&quot; &amp; LastRow2).AutoFilter Field:=25, Criteria1:=&quot;#N/A&quot;, Operator:=xlOr, Criteria2:=&quot;&quot;     On Error Resume Next     Range(&quot;Y2:Y&quot; &amp; LastRow2).SpecialCells(xlCellTypeVisible).Formula = &quot;=VLOOKUP(X2,&#39;[&quot; &amp; sht_ships.Parent.Name &amp; &quot;]&quot; &amp; sht_ships.Name &amp; &quot;&#39;!ships, 2,0)&quot;     Range(&quot;Z2:Z&quot; &amp; LastRow2).SpecialCells(xlCellTypeVisible).Formula = &quot;=VLOOKUP(X2,&#39;[&quot; &amp; sht_ships.Parent.Name &amp; &quot;]&quot; &amp; sht_ships.Name &amp; &quot;&#39;!ships, 3,0)&quot;     ActiveSheet.ShowAllData"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 13, "user_id": 7653920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13f192963632219e5d708bf6016b739?s=128&d=identicon&r=PG&f=1", "display_name": "jana", "link": "https://stackoverflow.com/users/7653920/jana"}, "edited": false, "score": 0, "creation_date": 1510155644, "post_id": 47182244, "comment_id": 81316651, "body": "I cannot decode script in comment. What you get in the cell after running the macro? BTW, are you sure that named range &quot;ships&quot; is at least three columns wide?"}, {"owner": {"reputation": 13, "user_id": 7653920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13f192963632219e5d708bf6016b739?s=128&d=identicon&r=PG&f=1", "display_name": "jana", "link": "https://stackoverflow.com/users/7653920/jana"}, "edited": false, "score": 0, "creation_date": 1510157249, "post_id": 47182244, "comment_id": 81317838, "body": "ah, you&#39;re right! i found out that i made one minor change in the file and it made that! thanks a lot for your help, it works perfectly! :)"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 0, "last_activity_date": 1510151201, "creation_date": 1510151201, "answer_id": 47182244, "question_id": 47181818, "link": "https://stackoverflow.com/questions/47181818/how-to-use-references-to-another-workbooks-when-using-vlookup/47182244#47182244", "title": "How to use references to another workbooks when using VLOOKUP", "body": "<p>you could build your formula in string variable:</p>\n\n<pre><code>sFormula = \"=VLOOKUP(X2,'[\" &amp; sht_blog.parent.name &amp;\"]\" &amp; sht_blog.name &amp;\"'!blog, 2,0)\"\n</code></pre>\n\n<p>and then simply: </p>\n\n<pre><code>Range(\"Y2\").Formula = sFormula\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7653920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13f192963632219e5d708bf6016b739?s=128&d=identicon&r=PG&f=1", "display_name": "jana", "link": "https://stackoverflow.com/users/7653920/jana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 47182244, "answer_count": 2, "score": 1, "last_activity_date": 1510151201, "creation_date": 1510150078, "question_id": 47181818, "link": "https://stackoverflow.com/questions/47181818/how-to-use-references-to-another-workbooks-when-using-vlookup", "title": "How to use references to another workbooks when using VLOOKUP", "body": "<p>I'd like to ask you for your help with my code. I am trying to get the value from another workbook and put it in the current workbook through VLOOKUP. I want to use the reference to a workbook and not the exact name because the name of the search workbook will change. Here's the code:</p>\n\n<pre><code>Sub Thu_submission_ships()\n    FileToOpen = Application.GetOpenFilename(\"Microsoft Excel Files (*.xlsx), *.xlsx\", 2, \"Open last week's EMEA GA Backlog YYYY-MM-DD submission\")\n    Workbooks.Open Filename:=FileToOpen\n\n    Set wb_blog = ActiveWorkbook\n    Set sht_blog = wb_blog.Sheets(\"Backlog\")\n\n    Columns(\"X:X\").NumberFormat = \"@\"\n    ActiveSheet.Range(\"X2:Z\" &amp; LastRow_blog).Name = \"blog\"\n    wb_blog.Save\n\n    FileToOpen = Application.GetOpenFilename(\"Microsoft Excel Files (*.xlsx), *.xlsx\", 1, \"Open today's GA ships\")\n    Workbooks.Open Filename:=FileToOpen\n\n    Sheets(\"Ships\").Select\n\n    LastRow2 = Cells(Rows.Count, 1).End(xlUp).Row\n\n    Columns(\"X:X\").Insert Shift:=xlToRight\n    Range(\"X2:X\" &amp; LastRow2).Formula = \"=F2&amp;L2\"\n    Range(\"X2:X\" &amp; LastRow2).Copy: Range(\"X2:X\" &amp; LastRow2).PasteSpecial xlPasteValues\n    Range(\"X2\").Select\n    Columns(\"X:X\").NumberFormat = \"@\"\n\n    Range(\"Y2:Y\" &amp; LastRow2).Formula = \"=VLOOKUP(X2, sht_blog!blog, 2, False)\"\n\nEnd Sub\n</code></pre>\n\n<p>Thank you very much for your help!</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1510161122, "post_id": 47181644, "comment_id": 81320506, "body": "It may be difficult to determine what is necessary for potential responders but try to leave out as much as you can when asking a question. For instance responders will not have an appropriate Excel workbook so you could try to set up the question without it. <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 62, "user_id": 8599937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42fcc5aeaa42de043320b7d61286824?s=128&d=identicon&r=PG&f=1", "display_name": "Samppa", "link": "https://stackoverflow.com/users/8599937/samppa"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1510245387, "post_id": 47181644, "comment_id": 81363047, "body": "Thanks for the feedback! As I&#39;m new to the site it takes some time to familiarize myself with the best practises. I&#39;ve seen just so many questions where people ask to see the whole code instead of part of it, so I thought this would be the best solution. The link you provided was also very helpful, thanks for that!"}], "answers": [{"comments": [{"owner": {"reputation": 62, "user_id": 8599937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42fcc5aeaa42de043320b7d61286824?s=128&d=identicon&r=PG&f=1", "display_name": "Samppa", "link": "https://stackoverflow.com/users/8599937/samppa"}, "edited": false, "score": 0, "creation_date": 1510245434, "post_id": 47186381, "comment_id": 81363073, "body": "Seems to work perfectly! Thank you very much for this!"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 3, "last_activity_date": 1510163217, "creation_date": 1510163217, "answer_id": 47186381, "question_id": 47181644, "link": "https://stackoverflow.com/questions/47181644/hide-screen-updating-when-sending-mail-with-outlook/47186381#47186381", "title": "Hide screen updating when sending mail with Outlook", "body": "<p>Appears <code>.GetInspector</code> has the same functionality of <code>.Display</code> except the \"display\".</p>\n\n<pre><code>Sub generateDefaultSignature_WithoutDisplay()\n\n    Dim OutApp As Object    ' If initiated outside of Outlook\n\n    Dim OutMail As Object\n\n    Dim strbody As String\n    Dim receiverName As String\n\n    receiverName = const_meFirstLast ' My name\n\n    strbody = \"&lt;BODY style=font-size:11pt;font-family:Calibri&gt;&lt;p&gt;Dear \" &amp; receiverName &amp; \",&lt;/p&gt;\" &amp; _\n        \"&lt;p&gt;Please find attached the weekly reports.&lt;/p&gt;\" &amp; _\n        \"&lt;p&gt;Kind regards,&lt;/p&gt;&lt;/BODY&gt;\"\n\n    Set OutApp = CreateObject(\"Outlook.Application\")    ' If initiated outside of Outlook\n    Set OutMail = OutApp.CreateItem(0)\n\n    With OutMail\n\n        .SendUsingAccount = OutApp.Session.Accounts.Item(1)\n\n        .To = const_emAddress ' My email address\n\n        .Subject = \"Weekly Reporting \u2013 \" &amp; UCase(\"w\") &amp; \"eek \" &amp; Format(Date, \"ww\") _\n          &amp; \" \" &amp; UCase(Left(Format(Date, \"mmmm\"), 1)) &amp; Right(Format(Date, \"mmmm\"), _\n          Len(Format(Date, \"mmmm\")) - 1) &amp; \" \" &amp; Year(Now)\n\n        ' Default Signature\n        '  Outlook 2013\n        '  There is a report that .GetInspector is insufficient\n        '   to generate the signature in Outlook 2016\n        .GetInspector ' rather than .Display\n\n        .HTMLBody = strbody &amp; .HTMLBody\n\n        .Send\n\n    End With\n\nExitRoutine:\n    Set OutApp = Nothing\n    Set OutMail = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 62, "user_id": 8599937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42fcc5aeaa42de043320b7d61286824?s=128&d=identicon&r=PG&f=1", "display_name": "Samppa", "link": "https://stackoverflow.com/users/8599937/samppa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2486, "favorite_count": 0, "accepted_answer_id": 47186381, "answer_count": 1, "score": 2, "last_activity_date": 1592896191, "creation_date": 1510149566, "last_edit_date": 1592896191, "question_id": 47181644, "link": "https://stackoverflow.com/questions/47181644/hide-screen-updating-when-sending-mail-with-outlook", "title": "Hide screen updating when sending mail with Outlook", "body": "<p>I have to send reports to over 400 email addresses (on column B). The filepaths for each report are on columns C, D and E.</p>\n\n<p>With this post: <a href=\"https://stackoverflow.com/questions/8994116/how-to-add-default-signature-in-outlook\">How to add default signature in Outlook</a> the signature is added when the <code>.display</code> method is used.</p>\n\n<p>The signature I want to show is for user number 1. I've selected the corresponding signature as a default signature for new messages. </p>\n\n<p>This signature contains a picture, but this doesn't seem to cause any problems.</p>\n\n<p>I wouldn't want the macro to show the mail every time it sends the mail, because I want to avoid the constant blinking on the screen. </p>\n\n<p>I tried to look for something like \"hide\" method from <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861252.aspx\" rel=\"nofollow noreferrer\">here</a> but didn't find anything useful (.<code>display</code> would run in the background, and it would stay hidden from the user). Other idea was to add <code>application.screenupdating = false</code> and correspondingly <code>true</code> in the end, but this didn't have any impact.</p>\n\n<p>How could I display the email in the background without showing it every time to the user?</p>\n\n<pre><code>Sub sendFiles_weeklyReports()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    Dim sh As Worksheet\n    Dim EmailCell As Range\n    Dim FileCell As Range\n    Dim rng As Range\n\n    Dim lastRow As Long\n    Dim timestampColumn As Long\n    Dim fileLogColumn As Long\n    Dim i As Long\n\n    Dim strbody As String\n    Dim receiverName As String\n    Dim myMessage As String\n    Dim reportNameRange As String\n\n    Dim answerConfirmation As Variant\n\nApplication.ScreenUpdating = False\n\n\n    Set sh = Sheets(\"Report sender\")\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.createitem(0)\n    lastRow = sh.Cells(Rows.Count, \"B\").End(xlUp).Row\n    i = 0\n    reportNameRange = \"C1:E1\"\n    timestampColumn = 17 'based on offset on EmailCell (column B)!\n    fileLogColumn = 18 'based on offset on EmailCell (column B)!\n\n    myMessage = \"Are you sure you want to send weekly reports?\" &amp; vbNewLine &amp; \"'\" &amp; _\n    sh.Range(\"C2\").Value &amp; \"', \" &amp; vbNewLine &amp; \"'\" &amp; sh.Range(\"D2\").Value &amp; \"' and \" &amp; vbNewLine &amp; _\n    \"'\" &amp; sh.Range(\"E2\").Value &amp; \"'?\"\n\n    answerConfirmation = MsgBox(myMessage, vbYesNo, \"Send emails\")\n\n\n    If answerConfirmation = vbYes Then\n        GoTo Start\n    End If\n    If answerConfirmation = vbNo Then\n        GoTo Quit\n    End If\n\nStart:\n    For Each EmailCell In sh.Range(\"B3:B\" &amp; lastRow)\n        EmailCell.Offset(0, fileLogColumn).ClearContents\n        EmailCell.Offset(0, timestampColumn).ClearContents\n\n        Set rng = sh.Cells(EmailCell.Row, 1).Range(reportNameRange)\n\n        If EmailCell.Value Like \"?*@?*.?*\" And Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n            With OutMail\n                For Each FileCell In rng\n                    If Trim(FileCell) &lt;&gt; \"\" Then\n                        If Dir(FileCell.Value) &lt;&gt; \"\" Then   'checks if there's a file path in the cell\n                            .Attachments.Add FileCell.Value\n                                EmailCell.Offset(0, fileLogColumn).Value = EmailCell.Offset(0, fileLogColumn).Value &amp; \", \" &amp; _\n                                Dir(FileCell.Value)\n                                i = i + 1\n                        End If\n                    End If\n                Next FileCell\n\n                receiverName = EmailCell.Offset(0, -1).Value\n                strbody = \"&lt;BODY style=font-size:11pt;font-family:Calibri&gt;&lt;p&gt;Dear \" &amp; receiverName &amp; \",&lt;/p&gt;\" &amp; _\n                \"&lt;p&gt;Please find attached the weekly reports.&lt;/p&gt;\" &amp; _\n                \"&lt;p&gt;Kind regards,&lt;/p&gt;&lt;/BODY&gt;\"\n\n                .SendUsingAccount = OutApp.Session.Accounts.Item(1)\n                .To = EmailCell.Value\n                .Subject = \"Weekly Reporting \u2013 \" &amp; UCase(\"w\") &amp; \"eek \" &amp; Format(Date, \"ww\") _\n                &amp; \" \" &amp; UCase(Left(Format(Date, \"mmmm\"), 1)) &amp; Right(Format(Date, \"mmmm\"), _\n                Len(Format(Date, \"mmmm\")) - 1) &amp; \" \" &amp; Year(Now)\n\n                .display\n                .HTMLBody = strbody &amp; .HTMLBody\n                .Send\n                EmailCell.Offset(0, timestampColumn).Value = Now\nSkipEmail:\n            End With\n\n            Set OutMail = Nothing\n        End If\n    Next EmailCell\n\n    Set OutApp = Nothing\n\nApplication.ScreenUpdating = True\n\n    Call MsgBox(\"Weekly reports have been sent.\", vbInformation, \"Emails sent\")\nQuit:\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1510152222, "post_id": 47181568, "comment_id": 81313949, "body": "It&#39;s impossible to tell why your workbook is so slow in opening without understanding more specifically what the code is doing and reviewing the code. Since the code is working, you can consider posting it on <a href=\"https://codereview.stackexchange.com/questions/tagged/vba+or+excel\">Code Review</a> for specific help"}, {"owner": {"reputation": 91, "user_id": 7889757, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d5713e71c44aba9ccf99f0599c542168?s=128&d=identicon&r=PG&f=1", "display_name": "accortdr", "link": "https://stackoverflow.com/users/7889757/accortdr"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1510152947, "post_id": 47181568, "comment_id": 81314504, "body": "I will take that into consideration, Thanks! I figured it would be sort of a general question which may be hard to see without posting the code, but I appreciate the feedback!"}], "owner": {"reputation": 91, "user_id": 7889757, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d5713e71c44aba9ccf99f0599c542168?s=128&d=identicon&r=PG&f=1", "display_name": "accortdr", "link": "https://stackoverflow.com/users/7889757/accortdr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510149397, "creation_date": 1510149397, "last_edit_date": 1531161705, "question_id": 47181568, "link": "https://stackoverflow.com/questions/47181568/macro-enabled-workbook-running-slow-crashing", "title": "Macro-Enabled workbook running slow/ Crashing", "body": "<p>I have been creating a tool in excel that is based around data entry by a user from a userform. This entire program and the transformations done through vba span approximately 950 lines of code. Addionally, I have several power queries built to generate live-updating stats as new data is entered. The file as a whole is 64,597 KB. Currently, when I open the file it takes a descent amount of time to open with some \"Excel not responding\" errors before resuming the opening process. I am nervous that once I roll out this program to the users that it may \"break.\" I am still fairly new to programming and don't have much formal training for best practices, so any tips for improving the speed/efficiency would be greatly appreciated! </p>\n"}, {"tags": ["vba", "excel", "loops", "for-loop"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1510149386, "post_id": 47181554, "comment_id": 81311926, "body": "What is error 1004? What have you tried?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510149480, "post_id": 47181554, "comment_id": 81311996, "body": "A <code>Range</code> needs more than just <code>&quot;A&quot;</code> - it needs something like <code>&quot;A1&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 8907153, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210867429909059/picture?type=large", "display_name": "Anna-Sofia Harju", "link": "https://stackoverflow.com/users/8907153/anna-sofia-harju"}, "edited": false, "score": 0, "creation_date": 1510150352, "post_id": 47181554, "comment_id": 81312626, "body": "thank you @ScottCraner for your answer! This works now!"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1510149490, "creation_date": 1510149490, "answer_id": 47181609, "question_id": 47181554, "link": "https://stackoverflow.com/questions/47181554/excel-vba-looping-rows-does-not-work-run-time-error-1004/47181609#47181609", "title": "Excel VBA Looping rows does not work, Run-time error &#39;1004&#39;", "body": "<p>Change the loop to this:</p>\n\n<pre><code>Dim myRow As Range\nFor Each myRow In rng.Rows\n    With Worksheets(\"sheet name\")\n\n        VARIABLE1 = .Range(\"A\" &amp; myRow.Row)\n        VARIABLE2 = .Range(\"K\" &amp; myRow.Row)\n        'etc\n    End With\nNext Row\n</code></pre>\n\n<p>Thus it would work, as far as you are referencing the Range correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1510149564, "creation_date": 1510149564, "answer_id": 47181643, "question_id": 47181554, "link": "https://stackoverflow.com/questions/47181554/excel-vba-looping-rows-does-not-work-run-time-error-1004/47181643#47181643", "title": "Excel VBA Looping rows does not work, Run-time error &#39;1004&#39;", "body": "<p>First do not use Row as a variable. Use something like <code>Rw</code>. </p>\n\n<p>Then change <code>.Range(\"A\")</code> to:</p>\n\n<pre><code> .Cells(Rw.Row,\"A\") \n</code></pre>\n\n<p>do that for all the ranges. The range must have a row attached. </p>\n\n<p>You could also do:</p>\n\n<pre><code> .Range(\"A\" &amp; Rw.Row) \n</code></pre>\n\n<p>So:</p>\n\n<pre><code>Dim Rw as Range\nDim rng As Range\nDim Final_risk_score\nSet rng = Worksheets(\"sheet name\").Range(\"A1:Z100\")\n\nFor Each Rw In rng.Rows\n    VARIABLE1 = Worksheets(\"sheet name\").Cells(Rw.Row,\"A\")\n    VARIABLE2 = Worksheets(\"sheet name\").Cells(Rw.Row,\"K\")\n    VARIABLE3 = Worksheets(\"sheet name\").Cells(Rw.Row,\"J\")\n    VARIABLE4 = Worksheets(\"sheet name\").Cells(Rw.Row,\"W\")\n    VARIABLE5 = Worksheets(\"sheet name\").Cells(Rw.Row,\"G\")\n    VARIABLE6 = Worksheets(\"sheet name\").Cells(Rw.Row,\"N\")\n    VARIABLE7 = Worksheets(\"sheet name\").Cells(Rw.Row,\"X\")\n    VARIABLE8 = Worksheets(\"sheet name\").Cells(Rw.Row,\"Y\")\n    VARIABLE9 = Worksheets(\"sheet2\").Range(\"N7\")\n\n    Final_risk_score= Score_calculations(VARIABLE1, VARIABLE2, VARIABLE3, VARIABLE4, VARIABLE5, VARIABLE6, VARIABLE7, VARIABLE8, VARIABLE9)\n    Worksheets(\"sheet name\").Cells(Rw.Row,\"Z\").Value = Final_risk_score\nNext Row\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8907153, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210867429909059/picture?type=large", "display_name": "Anna-Sofia Harju", "link": "https://stackoverflow.com/users/8907153/anna-sofia-harju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519503504, "creation_date": 1510149334, "last_edit_date": 1519503504, "question_id": 47181554, "link": "https://stackoverflow.com/questions/47181554/excel-vba-looping-rows-does-not-work-run-time-error-1004", "title": "Excel VBA Looping rows does not work, Run-time error &#39;1004&#39;", "body": "<p>I am trying to bcreate a loop that goes thru rows in a selected range in excel and output's a score to each row, but I get this error referring to the firt line in the for loop (setting VARIABLE1). If I replace the .Range(\"A\") with \"A2\" then I get an output but only for the first row naturally. How do I make it so that the code will loop each row?\nThe code:</p>\n\n<pre><code>Dim rng As Range\nDim Final_risk_score\nSet rng = Worksheets(\"sheet name\").Range(\"A1:Z100\")\n\nFor Each Row In rng.Rows\n    VARIABLE1 = Worksheets(\"sheet name\").Range(\"A\")\n    VARIABLE2 = Worksheets(\"sheet name\").Range(\"K\")\n    VARIABLE3 = Worksheets(\"sheet name\").Range(\"J\")\n    VARIABLE4 = Worksheets(\"sheet name\").Range(\"W\")\n    VARIABLE5 = Worksheets(\"sheet name\").Range(\"G\")\n    VARIABLE6 = Worksheets(\"sheet name\").Range(\"N\")\n    VARIABLE7 = Worksheets(\"sheet name\").Range(\"X\")\n    VARIABLE8 = Worksheets(\"sheet name\").Range(\"Y\")\n    VARIABLE9 = Worksheets(\"sheet2\").Range(\"N7\")\n\n    Final_score = Score_calculations(VARIABLE1, VARIABLE2, VARIABLE3, VARIABLE4, VARIABLE5, VARIABLE6, VARIABLE7, VARIABLE8, VARIABLE9)\n    Worksheets(\"sheet name\").Range(\"Z\").Value = Final_score\nNext Row\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1510149108, "post_id": 47181383, "comment_id": 81311728, "body": "What have you already tried and where did you run into a problem? Please keep in mind that SO is not a &quot;write all the code for me&quot; website."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1510149852, "post_id": 47181383, "comment_id": 81312257, "body": "You can use the <code>Worksheet_Change</code> event to fire some code when you update column A.  Use <code>Intersect</code> to check the required cell is being updated.  Check that the cell is either empty or one lower than the value you&#39;re entering when it&#39;s updated (so you&#39;re not duplicating phases).  Use something like <code>Target.Offset(,1) = Date</code> to enter todays date one cell to the right of the changed cell, use <code>Application.EnableEvents=False</code> to stop the code continually firing when it changes a cell value."}, {"owner": {"reputation": 1, "user_id": 8907001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63bfc27608ae6f012b2edb8571fdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/8907001/chris"}, "edited": false, "score": 0, "creation_date": 1510151531, "post_id": 47181383, "comment_id": 81313481, "body": "I wasn&#39;t looking for someone to write it. Just if it can be done, and the kind of formula or coding to use (i have only recently started take classes on VBA coding."}, {"owner": {"reputation": 1, "user_id": 8907001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63bfc27608ae6f012b2edb8571fdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/8907001/chris"}, "edited": false, "score": 0, "creation_date": 1510151581, "post_id": 47181383, "comment_id": 81313517, "body": "I am trying to use an if function with circular referencing, which works fine until the value in column A is changed.."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8907001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63bfc27608ae6f012b2edb8571fdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/8907001/chris"}, "edited": false, "score": 1, "creation_date": 1510151641, "post_id": 47181544, "comment_id": 81313565, "body": "Thank you for your help! I will try it now."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1510153942, "post_id": 47181544, "comment_id": 81315321, "body": "Please don&#39;t use that <code>.Select</code> madness. <code>objExcel.Cells(2, 2).Copy</code> achieves the exact same thing as the first two instructions. <code>objExcel.Range(&quot;B2&quot;).PasteSpecial -4163, -4142, False, False</code> achieves the exact same thing as the last two instructions. Using <code>.Select</code> and <code>.Activate</code>, and coding late-bound without IntelliSense against the <code>Selection</code> is one of the primary causes of bugs.. and SO questions."}, {"owner": {"reputation": 532, "user_id": 2683491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0692348d266f8d2e9f4af11a81e66917?s=128&d=identicon&r=PG&f=1", "display_name": "DrHouseofSQL", "link": "https://stackoverflow.com/users/2683491/drhouseofsql"}, "edited": false, "score": 0, "creation_date": 1510158697, "post_id": 47181544, "comment_id": 81318854, "body": "The gist of the answer lies in copying and pasting the value into the cell to be left with no formula. Doing that will achieve what the OP needs. Specifically how they do it programmatically will best be left up to them."}], "tags": [], "owner": {"reputation": 532, "user_id": 2683491, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0692348d266f8d2e9f4af11a81e66917?s=128&d=identicon&r=PG&f=1", "display_name": "DrHouseofSQL", "link": "https://stackoverflow.com/users/2683491/drhouseofsql"}, "is_accepted": false, "score": 0, "last_activity_date": 1510149314, "creation_date": 1510149314, "answer_id": 47181544, "question_id": 47181383, "link": "https://stackoverflow.com/questions/47181383/how-to-keep-data-constant-in-cells-when-reference-cell-is-changed/47181544#47181544", "title": "How to keep data constant in cells when reference cell is changed?", "body": "<p>After the date in column B is initially populated, copy and paste it back into the same cell using values only. This way it merely has the value with no formula. This is in VBScript but it gives you the idea.</p>\n\n<pre><code>' Select the applicable cell in B\n objExcel.Cells(2, 2).Select\n\n'Copy the data in column B\n objExcel.Selection.Copy\n\n'Put the cursor in column B   \n objExcel.Range(\"B2\").Select\n\n'Paste the value\n objExcel.Selection.PasteSpecial -4163, -4142, False, False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8907001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c63bfc27608ae6f012b2edb8571fdf8e?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/8907001/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1510149413, "creation_date": 1510148883, "last_edit_date": 1510149413, "question_id": 47181383, "link": "https://stackoverflow.com/questions/47181383/how-to-keep-data-constant-in-cells-when-reference-cell-is-changed", "title": "How to keep data constant in cells when reference cell is changed?", "body": "<p>I am working on a project with a number of different retail sites that range in completeness. </p>\n\n<p>In Column A, I want to record which phase of the project a site is on (ranging from 1-3).  In Columns B (phase 1), C (phase 2), and D (phase 3) I want the dates to appear when a change is made in column A.  </p>\n\n<p><strong>Now here is the part that I am stuck on:</strong><br>\nHow can i make it so that the date in column B does not change when I change column A from phase 1 to phase 2, and from phase 2 to phase 3.<br>\nFor example, Column A row 1 is marked as 1 and when this is done the date of 11/8/2017 appears in Column B.<br>\nWhich function or code can I use so that when I change column A to 2 (a week later), the date in column B remains the same and the date is recorded.  </p>\n\n<p>If anyone has any idea I would truly appreciate the support. </p>\n"}, {"tags": ["arrays", "vba", "csv", "export"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510148927, "post_id": 47181303, "comment_id": 81311596, "body": "If you are looking for speed, using Excel VBA is not your best option. Use VB.NET instead and write the CSV file directly, bypassing Excel altogether. Your slowest factor is Excel."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8907046, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155897389299680/picture?type=large", "display_name": "Pablo Mesples", "link": "https://stackoverflow.com/users/8907046/pablo-mesples"}, "edited": false, "score": 0, "creation_date": 1510152420, "post_id": 47181559, "comment_id": 81314084, "body": "Thank you @MarcinSzaleniec.  I have tried to use your subroutine, but i couldn&#39;t make it work as a part of my routine.  How do I transfer my arrays into the Integer and Strings you define?"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 11, "user_id": 8907046, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155897389299680/picture?type=large", "display_name": "Pablo Mesples", "link": "https://stackoverflow.com/users/8907046/pablo-mesples"}, "edited": false, "score": 0, "creation_date": 1510152814, "post_id": 47181559, "comment_id": 81314392, "body": "your arrays are ranges transferred to arrays, so use ranges directly. Like Range(&quot;F11:NTU616&quot;) instead of arrStock. But I am in concord with braX, you are unlikely to gain significant results in VBA. Nevertheless, your code may be optimalised."}, {"owner": {"reputation": 11, "user_id": 8907046, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155897389299680/picture?type=large", "display_name": "Pablo Mesples", "link": "https://stackoverflow.com/users/8907046/pablo-mesples"}, "edited": false, "score": 0, "creation_date": 1510158097, "post_id": 47181559, "comment_id": 81318439, "body": "Thank you again Marcin! have a nice day."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1510149348, "creation_date": 1510149348, "answer_id": 47181559, "question_id": 47181303, "link": "https://stackoverflow.com/questions/47181303/send-array-to-csv-file-simulation-too-slow/47181559#47181559", "title": "send array to csv file - simulation too slow", "body": "<p>You could probably get rid of selects and selections to speed up the macro, like:</p>\n\n<pre><code>32  Sheets(\"Export\").Select\n33  Range(\"F11:NTU616\").Select\n34  Selection.ClearContents\n</code></pre>\n\n<p>could be replaces by </p>\n\n<pre><code>32  Sheets(\"Export\").Range(\"F11:NTU616\").ClearContents\n</code></pre>\n\n<p>but you probably lost most of valuable seconds while saving file, as you already have noticed. Indeed, you could try export to file, see my subroutine:</p>\n\n<pre><code>Private Sub PrintToCSV(sFileName As String, rng As Range)\nDim TextFile As Integer\nDim FilePath As String\nDim FileContent As String\nDim cl As Range\n\nFilePath = ThisWorkbook.Path &amp; \"\\something something\\\" &amp; sFileName &amp; \".csv\"\n\nTextFile = FreeFile\n\nOpen FilePath For Output As TextFile\n\nFor Each cl In rng\n    Print #TextFile, cl.Value\nNext cl\n\nClose TextFile\nEnd Sub\n</code></pre>\n\n<p>But, generally speaking, VBA is scripting language, so it is slow. I am not sure if writing to file will be faster than saving as, but you may try. </p>\n"}], "owner": {"reputation": 11, "user_id": 8907046, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155897389299680/picture?type=large", "display_name": "Pablo Mesples", "link": "https://stackoverflow.com/users/8907046/pablo-mesples"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 525, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510256354, "creation_date": 1510148682, "last_edit_date": 1510256354, "question_id": 47181303, "link": "https://stackoverflow.com/questions/47181303/send-array-to-csv-file-simulation-too-slow", "title": "send array to csv file - simulation too slow", "body": "<p>I automated a montecarlo simulation for stock and option prices that runs 10 thousand paths for 606 trading days.  All and all it works fine, the problem is that is slow.  The slow part of the code is when it has to write an array of say 400 x 10000 to the spreadsheet, then export it into a new CSV file and save it. </p>\n\n<p>It does this for a 25 option portfolio (it takes 1 minute per option.)  So overall it takes 25 minutes, which is unacceptable.  How can I write directly to CSV the arrays of data that I am filling with the simulation?  I need to keep all stock prices, option prices and total portfolio value.   Below is the code that I have created for this.</p>\n\n<pre><code>    Sub Background_simulation()\n\n0   Application.ScreenUpdating = False\n1   Windows(\"Option Portfolio Simulation v7.xlsm\").Activate\n2   Sheets(\"Export\").Activate\n3   Dim Arr() As Variant\n4   ArrStock = Range(\"F11:NTU616\")\n6   ArrOption = Range(\"F621:NTU1226\")\n7   Sheets(\"Export\").Activate\n\n8   Dim DestinationStock As Range\n9   Set DestinationStock = Range(\"F11\")\n\n10  Dim DestinationOption As Range\n11  Set DestinationOption = Range(\"F621\")\n12  Dim RAND(1 To 606, 1 To 10000) As Variant\n13  Paths = Range(\"D6\").Value\n\n15  Dim Option_Paths(1 To 606, 1 To 10000) As Variant\n16  Dim St_Paths(1 To 606, 1 To 10000) As Variant\n17  Dim Options_Total(1 To 606, 1 To 10000) As Variant\n18  FromOption = Range(\"D7\").Value\n19  UpToOption = Range(\"D8\").Value\n20  Sheets(\"Portfolio\").Select\n21  Let MaxExpirationOfSet = Application.WorksheetFunction.Max(Range(\"BC2:BC26\").Value)\n22  Sheets(\"Export\").Select\n\n23  For a = 2 To 606\n24  For b = 1 To Paths\n25  Randomize\n26  RAND(a, b) = Application.WorksheetFunction.NormInv(RND(), 0, 1)\n27  Next\n28  Next\n\n31  For Option_Nr = FromOption To UpToOption\n32  Sheets(\"Export\").Select\n33  Range(\"F11:NTU616\").Select\n34  Selection.ClearContents\n35  Range(\"F621:NTU1226\").Select\n36  Selection.ClearContents\n38  Range(\"B1\").Select\n39  ActiveCell.FormulaR1C1 = Option_Nr\n42  Calls = Range(\"L3\").Value\n43  If Calls = 0 Then GoTo 2010\n44  St = Range(\"G2\").Value\n45  Rf = Range(\"G3\").Value\n46  Sigma = Range(\"G4\").Value\n47  dt = 1 / 250\n48  mrn = Rf - (1 / 2) * Sigma ^ 2\n49  X = Range(\"L5\").Value\n50  Expiration_Date = Range(\"D4\").Value\n\n120 For b = 1 To Paths\n130 RAND(1, b) = 1\n140 St_Paths(1, b) = St\n150 Option_Paths(1, b) = Application.WorksheetFunction.Max(St - X, 0) * Calls\n160 Options_Total(1, b) = Options_Total(1, b) + Option_Paths(1, b)\n170 Next\n\n190  For a = 2 To Expiration_Date\n200  For b = 1 To Paths\n600  St_Paths(a, b) = St_Paths(a - 1, b) * Exp(mrn * dt + Sigma * (dt) ^ (1 / 2) * RAND(a, b))\n700  Option_Paths(a, b) = Application.WorksheetFunction.Max(St_Paths(a, b) - X, 0) * Calls\n701  Options_Total(a, b) = Options_Total(a, b) + Option_Paths(a, b)\n703  Next\n704  Next\n\n705  For a = (Expiration_Date + 1) To MaxExpirationOfSet\n706  For b = 1 To Paths\n707  St_Paths(a, b) = St_Paths(a - 1, b)\n710  Option_Paths(a, b) = Option_Paths(a - 1, b)\n711  Options_Total(a, b) = Options_Total(a - 1, b)\n712  Next\n730  Next\n\n740 Sheets(\"Export\").Select\n750 Range(\"F11:NTU616\").Select\n760 Selection.ClearContents\n770 Range(\"F621:NTU1226\").Select\n780 Selection.ClearContents\n790 Range(\"A1\").Select\n\n800 DestinationStock.Resize(UBound(ArrStock, 1), UBound(ArrStock, 2)).Value = St_Paths\n810 DestinationOption.Resize(UBound(ArrOption, 1), UBound(ArrOption, 2)).Value = Option_Paths\n\n830 Sheets(\"Export\").Copy\n840 Range(\"F620\").Select\n845 ActiveWorkbook.BreakLink Name:= _\n        \"C:\\Users\\pmesples\\Desktop\\Options\\Option Portfolio Simulation v7.xlsm\", Type _\n        :=xlExcelLinks\n\n850 ChDir \"C:\\Users\\pmesples\\Desktop\\Options\"\n860 ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\pmesples\\Desktop\\Options\\\" &amp; Option_Nr &amp; \".csv\", _\n        FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n\n\n900  ActiveWindow.Close\n1000 Sheets(\"Export\").Select\n\n1001 Range(\"F\" &amp; 620 + MaxExpirationOfSet &amp; \":NTU\" &amp; 620 + MaxExpirationOfSet).Select\n1002 Selection.Copy\n1003 Sheets(\"Results\").Select\n1004 Cells(5, Option_Nr + 3).Select\n1005 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=True\n\n1006 Sheets(\"Export\").Select\n1010 Range(\"F11\").Select\n1020 Range(Selection, Selection.End(xlToRight)).Select\n1030 Range(Selection, Selection.End(xlDown)).Select\n1040 Selection.ClearContents\n1050 Selection.End(xlDown).Select\n1060 Range(\"F621\").Select\n1080 Range(Selection, Selection.End(xlDown)).Select\n1090 Range(Selection, Selection.End(xlToRight)).Select\n2000 Selection.ClearContents\n2005 Range(\"A1\").Select\n2010 Next\n\n2015 Range(\"B1\").Select\n2016 ActiveCell.FormulaR1C1 = 26\n2020 DestinationOption.Resize(UBound(ArrOption, 1), UBound(ArrOption, 2)).Value = Options_Total\n2030 Sheets(\"Export\").Copy\n2040 Range(\"F620\").Select\n2045 ActiveWorkbook.BreakLink Name:= _\n        \"C:\\Users\\pmesples\\Desktop\\Options\\Option Portfolio Simulation v7.xlsm\", Type _\n        :=xlExcelLinks\n\n2050 ChDir \"C:\\Users\\pmesples\\Desktop\\Options\"\n2060 ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\pmesples\\Desktop\\Options\\26.csv\", _\n        FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n\n\n2100  ActiveWindow.Close\n2110 Sheets(\"Export\").Select\n2215 Range(\"B1\").Select\n2120 ActiveCell.FormulaR1C1 = 1\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "cmd", "renaming"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510154799, "post_id": 47181250, "comment_id": 81316019, "body": "Looks like a third requirement at the end i.e. for an additional button. Your requirement B sounds like you might be trying to pick up a folder path and concatenate that with CMD before passing that to the shell command? Think you need a variable to hold the result of the inputbox (that gathers the folder picked by the user in your file looping in folder subroutine) which is accepted as an argument to your renaming procedure. Also, do you mean CMD when you specify Command in the shell script? If so, use a consistent name and make it specific and  a non ambiguous term e.g. commandText."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510157226, "post_id": 47181250, "comment_id": 81317821, "body": "Is the startRow a constant i.e. always the same? Would also need to see at least the signature of the sub that lists the files in a directory. An example of your column F text would help as would an image of some of your data. And the code for the sub which is called by the button push which allows the user to select a folder."}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510163717, "post_id": 47181250, "comment_id": 81322081, "body": "Thanks for the comments QHarr, I&#39;ve tried to update as much as I can."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510321888, "post_id": 47222138, "comment_id": 81398362, "body": "Thanks QHarr for the options, I&#39;ll look over more closely as would be good to understand it all.   I&#39;ve tried the above code with the batch file. macro one works, but macro 2 get&#39;s stuck defining:  Sub RenameFiles()      Dim fso As New FileSystemObject  You can access the update version here <a href=\"https://drive.google.com/file/d/144zqlxZKUI4Ze1luZl2aH7yhFUjmJpKM/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/144zqlxZKUI4Ze1luZl2aH7yhFUjmJpKM/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510321961, "post_id": 47222138, "comment_id": 81398406, "body": "Have you added the reference to the microsoft scripting runtime?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510322255, "post_id": 47222138, "comment_id": 81398632, "body": "I have also added some explanation in with the code. And see here for adding the runtime reference library <a href=\"https://stackoverflow.com/questions/3233203/how-do-i-use-filesystemobject-in-vba\" title=\"how do i use filesystemobject in vba\">stackoverflow.com/questions/3233203/&hellip;</a>"}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510331116, "post_id": 47222138, "comment_id": 81404508, "body": "Thanks - now get as far as here:  Set stream = fso.CreateTextFile(deskTopPath &amp; &quot;\\&quot; &amp; strFile, True) but throws an error. I replaced with  Set stream = fso.CreateTextFile(&quot;D:\\Users\\JAMOSULL\\Desktop&quot; &amp; &quot;\\&quot; &amp; strFile, True) and this worked - I&#39;m guessing it&#39;s a drive letter issue?  However, I then get an error here: Call Shell(testString, vbNormalFocus)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510331364, "post_id": 47222138, "comment_id": 81404657, "body": "Just change the following  deskTopPath = Environ$(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop&quot; to deskTopPath = &quot;D:\\Users\\JAMOSULL\\Desktop&quot; and revert the other line back to Set stream = fso.CreateTextFile(deskTopPath &amp; &quot;\\&quot; &amp; strFile, True)"}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510332832, "post_id": 47222138, "comment_id": 81405509, "body": "Is there a way to fix so that it will work on anyone&#39;s computer?   This is almost perfect now. I&#39;ve ran the batch file manually from the desktop and works great!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510332867, "post_id": 47222138, "comment_id": 81405534, "body": "That is what this line was doing deskTopPath = Environ$(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510332982, "post_id": 47222138, "comment_id": 81405595, "body": "if you press Ctrl + G to open the immediate window and enter  the following debug.print Environ$(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop&quot;     what do you get?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510386329, "post_id": 47222138, "comment_id": 81421540, "body": "I have also edited the answer to include a function that returns the desktop path. Let me know the result of the attempts with the comment above and/or the additional code. Code is written on assumption all machines will be using Windows. If there will be different operating systems or versions of Excel please add that requirement to the question e.g. this code must run on Excel 2013, 2016......."}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510681368, "post_id": 47222138, "comment_id": 81534644, "body": "I copied in the text for the Rename sub, but it still comes up with &#39;Path not found&#39; and references this line:   Set stream = fso.CreateTextFile(deskTopPath &amp; &quot;\\&quot; &amp; strFile, True) &#39;create the .bat file  I&#39;m on Windows 7 and running Office 2013  updated file here: <a href=\"https://drive.google.com/file/d/144zqlxZKUI4Ze1luZl2aH7yhFUjmJpKM/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/144zqlxZKUI4Ze1luZl2aH7yhFUjmJpKM/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510681706, "post_id": 47222138, "comment_id": 81534842, "body": "I will have a look tomorrow. What is the value of deskTopPath and strFile when the error occurs? If you open the locals window and step through the code with F8 it will show you the values as they are populated."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510741422, "post_id": 47222138, "comment_id": 81560138, "body": "Have you added in the function i put at the bottom of the answer GetDesktop?    If you add it to a code module and then Ctrl &amp; G to open the immediate window and type the following followed by Enter what do you get: debug.Print GetDesktop"}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510741971, "post_id": 47222138, "comment_id": 81560512, "body": "I&#39;ve updated so that the file is saved to the same directory as the files to be renamed are contained in, which solved the problem. Since the file is deleted anyway, I think this is fine."}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510742034, "post_id": 47222138, "comment_id": 81560550, "body": "I&#39;ve now updated the file with instructions/moved some of the columns around. Trying to fix the references - having trouble with counting the files in the folder and running all the renaming commands"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510742145, "post_id": 47222138, "comment_id": 81560623, "body": "Is that as per the file you uploaded?"}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510743155, "post_id": 47222138, "comment_id": 81561254, "body": "Re uploaded - it&#39;s only renaming 159 files - having trouble with this:             Dim lastRow As Long         lastRow = wsTab2.Cells(wsTab2.Rows.Count, &quot;I&quot;).End(xlUp).Row          Set strData = wsTab2.Range(&quot;K5:K&quot; &amp; lastRow) &#39;Only execute for as many new file names as present in Col I (in place of your until blank requirement)  I&#39;ve put &quot;I&quot; as the column where the new filenames are listed, and &quot;K&quot; as the column where the renaming commands are, but I&#39;m only getting 159 files renamed....  <a href=\"https://drive.google.com/file/d/1AkcE6PSfjWeYxkNxG5hMYvY563nJUh-i/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1AkcE6PSfjWeYxkNxG5hMYvY563nJUh-i/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510743573, "post_id": 47222138, "comment_id": 81561564, "body": "You should only rename for as many files as there old file names. In this case it would be column G.  Dim lastRow As Long lastRow = wsTab2.Cells(wsTab2.Rows.Count, &quot;G&quot;).End(xlUp).Row   And with this you should get 544 renames (as per upload)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510744018, "post_id": 47222138, "comment_id": 81561871, "body": "I have tested and it creates a batch file with the right number of entries if you set the LastRow using column G."}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510744648, "post_id": 47222138, "comment_id": 81562251, "body": "The command prompt was running in to some error. I&#39;ve I keep repeating the renaming function, it renames some more each time, after several clicks, it renamed all the files."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510744720, "post_id": 47222138, "comment_id": 81562295, "body": "You might need to increase the Wait time before killing the bat file. This line:  Application.Wait (Now + TimeValue(&quot;0:00:01&quot;))"}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510744798, "post_id": 47222138, "comment_id": 81562347, "body": "Version 4 - now working but on long list of files (maybe files with certain characters?) need to re run Rrenaming action <a href=\"https://drive.google.com/file/d/1SG1aNYVfx7xybSMgQ7RsiL7-Y7I62p1l/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1SG1aNYVfx7xybSMgQ7RsiL7-Y7I62p1l/&hellip;</a> OK I&#39;ll try altering timing"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510745802, "post_id": 47222138, "comment_id": 81562977, "body": "Give longer wait time."}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510747786, "post_id": 47222138, "comment_id": 81564243, "body": "Great working now! Can close off as answered - do I need to do this?  One minor thing - the clear contents line removing old filenames on &#39;Batch rename of Files&#39; tab is set to start at G5 but also clears G4, the heading. It&#39;s not an issue, but any idea what might cause this?  What do I need to do to close this off?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510748185, "post_id": 47222138, "comment_id": 81564509, "body": "You accept as answer to close by clicking next to the answer. A green tick then appears. This then awards points to me for having assisted. It is a way of encouraging answers and thanking people.  I think you must have something else going on because this line wsTab3.Range(&quot;G5:G&quot; &amp; lastRow).ClearContents only clear range from G5. You can test this by inserting the word STOP after the this line in the code and then executing ListFilesInDirectory and reviewing sheet Batch Rename of Files. Or insert a break point on this line: wsTab3.Range(&quot;G5&quot;).Activate and run the same procedure and review."}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510748916, "post_id": 47222138, "comment_id": 81565000, "body": "It&#39;s happening when the code hits     wsTab3.Range(&quot;G5&quot;).Activate"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510749054, "post_id": 47222138, "comment_id": 81565104, "body": "Did you insert the STOP line or the breakpoint and then inspect what had been cleared? It will not happen on wsTab3.Range(&quot;G5&quot;).Activate as this purely selects a cell and does nothing else with it."}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510751534, "post_id": 47222138, "comment_id": 81566897, "body": "I was using a breakpoint, it&#39;s happening just after i press F8 on the ClearContents line:    wsTab3.Range(&quot;G5:G&quot; &amp; lastRow).ClearContents &#39;Get rid of any existing file names      wsTab3.Range(&quot;G5&quot;).Activate"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510752102, "post_id": 47222138, "comment_id": 81567300, "body": "1) Put a break point on wsTab3.Range(&quot;G5:G&quot; &amp; lastRow).ClearContents so will stop before executing this and check that G4 is actually populated."}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510752339, "post_id": 47222138, "comment_id": 81567490, "body": "I added three break points on each line:     lastRow = wsTab3.Cells(wsTab3.Rows.Count, &quot;G&quot;).End(xlUp).Row      wsTab3.Range(&quot;G5:G&quot; &amp; lastRow).ClearContents &#39;Get rid of any existing file names      wsTab3.Range(&quot;G5&quot;).Activate  The cell is populated until after ClearContents is run/the activate line is highlighted yellow, then it&#39;s empty"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510752564, "post_id": 47222138, "comment_id": 81567653, "body": "No idea as i cannot duplicate. Maybe add another line after the .clearcontents line saying wsTab3.Range(&quot;G4&quot;) = &quot;Old Filenames&quot;"}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510757626, "post_id": 47222138, "comment_id": 81571446, "body": "OK, thanks - have added the extra code. Sometimes it didn&#39;t happen, sometimes it did, so not sure either.  Thanks for all your help!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510757812, "post_id": 47222138, "comment_id": 81571599, "body": "Not a problem. Maybe also think about things like some code that warns user before renaming, how many files will be renamed so the user can say yes or no?"}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510765470, "post_id": 47222138, "comment_id": 81577397, "body": "Yes - will be worthwhile, I&#39;ve put some text warning in the excel file but will try to build in more checks.   Next I want to enable the file to work even if people select a SharePoint folder, rather than one on their desktop. I&#39;ve tried selecting a mapped directory then listing files, but doesn&#39;t work as is. I&#39;ve found some answers and giving it a go myself atm. Should I create a fresh post/question to explore this if needed?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510766060, "post_id": 47222138, "comment_id": 81577748, "body": "Yes you should post a new question if it is a new programming problem though you can always link back to this question for info"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "edited": false, "score": 0, "creation_date": 1510766125, "post_id": 47222138, "comment_id": 81577795, "body": "Would be interesting to see what solutions you try"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1582706576, "last_edit_date": 1582706576, "creation_date": 1510314544, "answer_id": 47222138, "question_id": 47181250, "link": "https://stackoverflow.com/questions/47181250/running-list-of-cmd-lines-from-excel/47222138#47222138", "title": "Running List of CMD lines from Excel", "body": "<p>Caveats:</p>\n\n<p>1) I am not entirely clear on how you data etc is laid out so i am offering a way of achieving your goal that involves the elements i am clear on.</p>\n\n<p>2) To be honest, personally, i would do as much using arrays or a dictionary as possible rather than going backwards and forwards to worksheets.</p>\n\n<p>However...</p>\n\n<p>Following the outline of your requirements and a little <strong>rough and ready</strong>, we have:</p>\n\n<p>1) Using your macro <code>rename</code> (renamed as <code>ListFiles</code> and with a few minor tweaks) to write the chosen folder name out to <code>Range(\"A1\")</code> in <code>Worksheets(\"Batch Rename of Files\")</code> and the file names to Column C.</p>\n\n<p>2) Using a second macro <code>RenameFiles</code> to pick up the rename shell commands from Column F of <code>Worksheets(\"Batch Rename of Files\")</code>; write these out to a batch file on the desktop; add an additional first line command that sets the working directory to the chosen folder given in <code>Range(\"A1\")</code> (Requirement A). The shell command executes the .bat file, completes the renaming (Requirement B) and then there is a line to remove the .bat file.</p>\n\n<p>I am guessing this is a more efficient way of achieving your goal than looping the column F range executing a command one at a time.</p>\n\n<p>I have not sought to optimize code in any further ways (i have added a few existing typed functions.) There are a number of other improvements that could be made but this was intended to help you achieve your requirements.</p>\n\n<p>Let me know how it goes!</p>\n\n<p><strong>Tab1 layout (Sheet containing new file names)</strong>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/MePpf.png\" width=\"200\"></p>\n\n<p><strong>Batch Rename of Files layout (Sheet containing output of the first macro and the buttons )</strong>:</p>\n\n<p>Layout of Worksheet Batch Rename of File</p>\n\n<p><img src=\"https://i.stack.imgur.com/4Ddhw.png\" width=\"200\"></p>\n\n<p><strong>In a standard module called <code>ListFiles</code>:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub ListFilesInDirectory()\n\n    Dim xRow As Long\n    Dim xDirect$, xFname$, InitialFoldr$ 'type hints not really needed\n    Dim wb As Workbook\n    Dim wsTab2 As Worksheet\n\n    Set wb = ThisWorkbook\n    Set wsTab2 = wb.Worksheets(\"Batch Rename of Files\")\n\n    InitialFoldr$ = \"C:\\\"\n\n    Dim lastRow As Long\n    lastRow = wsTab2.Cells(wsTab2.Rows.Count, \"C\").End(xlUp).Row\n\n    wsTab2.Range(\"C4:C\" &amp; lastRow).ClearContents 'Get rid of any existing file names\n\n    wsTab2.Range(\"C4\").Activate\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n\n        .InitialFileName = Application.DefaultFilePath &amp; \"\\\"\n        .Title = \"Please select a folder to list Files from\"\n        .InitialFileName = InitialFoldr$\n        .Show\n\n        If .SelectedItems.Count &lt;&gt; 0 Then\n\n            xDirect$ = .SelectedItems(1) &amp; \"\\\"\n            xFname$ = Dir(xDirect$, 7)\n            wsTab2.Range(\"A1\") = xDirect$\n\n            Do While xFname$ &lt;&gt; vbNullString\n                ActiveCell.Offset(xRow) = xFname$\n                xRow = xRow + 1\n                xFname$ = Dir\n            Loop\n\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>In a standard module called <code>FileRenaming</code>:</strong></p>\n\n<pre><code>Option Explicit\n\nSub RenameFiles()\n\n    Dim fso As New FileSystemObject\n    Dim stream As TextStream\n    Dim strFile As String\n    Dim strPath As String\n    Dim strData As Range\n    Dim wb As Workbook\n    Dim wsTab2 As Worksheet\n    Dim currRow As Range\n\n    Set wb = ThisWorkbook\n    Set wsTab2 = wb.Worksheets(\"Batch Rename of Files\")\n\n    strPath = wsTab2.Range(\"A1\").Value2\n\n    If strPath = vbNullString Then\n\n        MsgBox \"Please ensure that Worksheet Batch Rename of Files has a directory path in cell A1\"\n\n    Else\n\n        If Right$(Trim$(strPath), 1) &lt;&gt; \"\\\" Then strPath = strPath &amp; \"\\\"\n\n        strFile = \"Rename.bat\"\n\n        Dim testString As String\n        Dim deskTopPath As String\n        deskTopPath = Environ$(\"USERPROFILE\") &amp; \"\\Desktop\" 'get desktop path as this is where .bat file will temporarily be saved\n\n        testString = fso.BuildPath(deskTopPath, strFile) 'Check if .bat already exists and delete\n\n        If Len(Dir(testString)) &lt;&gt; 0 Then \n            SetAttr testString, vbNormal\n            Kill testString\n        End If\n\n        Set stream = fso.CreateTextFile(deskTopPath &amp; \"\\\" &amp; strFile, True) 'create the .bat file\n\n        Dim lastRow As Long\n        lastRow = wsTab2.Cells(wsTab2.Rows.Count, \"C\").End(xlUp).Row\n\n        Set strData = wsTab2.Range(\"F4:F\" &amp; lastRow) 'Only execute for as many new file names as present in Col C (in place of your until blank requirement)\n\n        stream.Write \"CD /D \" &amp; strPath &amp; vbCrLf\n\n        For Each currRow In strData.Rows 'populate the .dat file\n            stream.Write currRow.Value &amp; vbCrLf\n        Next currRow\n\n        stream.Close\n\n        Call Shell(testString, vbNormalFocus)\n\n        Application.Wait (Now + TimeValue(\"0:00:01\"))  'As sometime re-naming doesn't seem to happen without a pause before removing .bat file\n\n        Kill testString\n\n        MsgBox (\"Renaming Complete\")\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Buttons code in Worksheet Batch Rename of Files</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    ListFilesInDirectory\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    RenameFiles\nEnd Sub\n</code></pre>\n\n<p><strong>Example .bat file contents</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/k0A6a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k0A6a.png\" alt=\"Example .bat file contents\"></a></p>\n\n<p><strong>VERSION 2</strong></p>\n\n<p>And here is a different version using a dictionary and passing parameters from one sub to another. This would therefore be a macro associated with only one button push operation i.e. there wouldn't be a second button. The single button would call <code>ListFiles</code> which in turn calls the second macro. May require you to go in to tools > references and add in Microsoft Scripting Runtime reference.</p>\n\n<p>Assumes you have a matching number of new file names in Col D of tab 1 as the number of files found in the folder (as per your script to obtain files in folder). I have removed the obsolete type references.Shout out to the RubberDuck VBA add-in crew for the add-in picking these up.</p>\n\n<p><strong>In one standard module:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub ListFiles()\n\n    Dim xDirect As String, xFname As String, InitialFoldr As String\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim dict As New Scripting.Dictionary\n    Dim counter As Long\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Tab1\") 'Worksheet where new file names are\n\n    counter = 4 'row where new file names start\n\n    InitialFoldr = \"C:\\\"\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n\n        .InitialFileName = Application.DefaultFilePath &amp; \"\\\"\n        .Title = \"Please select a folder to list Files from\"\n        .InitialFileName = InitialFoldr\n        .Show\n\n        If .SelectedItems.Count &lt;&gt; 0 Then\n\n            xDirect = .SelectedItems(1) &amp; \"\\\"\n            xFname = Dir(xDirect, 7)\n\n            Do While xFname &lt;&gt; vbNullString\n\n              If Not dict.Exists(xFname) Then\n                  dict.Add xFname, ws.Cells(counter, \"D\")  'Or which ever column holds new file names. This add to the dictionary the current name and new name\n                  counter = counter + 1\n                  xFname = Dir\n              End If\n            Loop\n\n        End If\n\n    End With\n\n    RenameFiles xDirect, dict 'pass directory path and dictionary to renaming sub\n\nEnd Sub\n</code></pre>\n\n<p><strong>In another standard module</strong>:</p>\n\n<pre><code>Public Sub RenameFiles(ByVal folderpath As String, ByRef dict As Dictionary)\n\n    Dim fso As New FileSystemObject\n    Dim stream As TextStream\n    Dim strFile As String\n    Dim testString As String\n    Dim deskTopPath As String\n\n    strFile = \"Rename.bat\"\n    deskTopPath = Environ$(\"USERPROFILE\") &amp; \"\\Desktop\"\n    testString = fso.BuildPath(deskTopPath, strFile)\n\n    'See if .dat file of same name already on desktop and delete (you could overwrite!)\n    If Len(Dir(testString)) &lt;&gt; 0 Then\n        SetAttr testString, vbNormal\n        Kill testString\n    End If\n\n    Set stream = fso.CreateTextFile(testString, True)\n\n    stream.Write \"CD /D \" &amp; folderpath &amp; vbCrLf\n\n    Dim key As Variant\n\n    For Each key In dict.Keys\n        stream.Write \"Rename \" &amp; folderpath &amp; key &amp; \" \" &amp; dict(key) &amp; vbCrLf 'write out the command instructions to the .dat file\n    Next key\n\n    stream.Close\n\n    Call Shell(testString, vbNormalFocus)\n\n    Application.Wait (Now + TimeValue(\"0:00:01\"))  'As sometime re-naming doesn't seem to happen without a pause before removing .bat file\n\n    Kill testString\n\n   ' MsgBox (\"Renaming Complete\")\n\nEnd Sub\n</code></pre>\n\n<p><strong>Scripting run time reference:</strong></p>\n\n<p>Adding runtime reference</p>\n\n<p><img src=\"https://i.stack.imgur.com/1J5GX.png\" width=\"300\"></p>\n\n<p>Additional method for finding the desktop path. Taken from <a href=\"https://excel.tips.net/T008233_Finding_the_Path_to_the_Desktop.html\" rel=\"nofollow noreferrer\">Allen Wyatt</a>:</p>\n\n<p>In a standard module add the following:</p>\n\n<pre><code>Public Function GetDesktop() As String\n    Dim oWSHShell As Object\n\n    Set oWSHShell = CreateObject(\"WScript.Shell\")\n    GetDesktop = oWSHShell.SpecialFolders(\"Desktop\")\n    Set oWSHShell = Nothing\nEnd Function\n</code></pre>\n\n<p>Then in the rest of the code replace any instances of <code>deskTopPath =.....</code> e.g.:</p>\n\n<pre><code>deskTopPath = Environ$(\"USERPROFILE\") &amp; \"\\Desktop\"\n</code></pre>\n\n<p>With</p>\n\n<pre><code>desktopPath = GetDesktop\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1958, "favorite_count": 1, "accepted_answer_id": 47222138, "answer_count": 1, "score": 1, "last_activity_date": 1582706576, "creation_date": 1510148474, "last_edit_date": 1510167709, "question_id": 47181250, "link": "https://stackoverflow.com/questions/47181250/running-list-of-cmd-lines-from-excel", "title": "Running List of CMD lines from Excel", "body": "<p>Can anyone help please with the following requirements? </p>\n\n<p><strong>Requirement A:</strong></p>\n\n<p>I'd like to create a loop to run a list of command strings in CMD as long as there's a non-zero value in column C. I think I need to define a variable i for my starting row as this will always be the same, and then run Shell(), pulling the command string from the corresponding cell in Row <code>i</code>, Column F. While <code>Cells(i, \"C\")</code> is not blank, keep going, increasing <code>i</code> by 1.</p>\n\n<p><strong>Requirement B:</strong></p>\n\n<p>I'd also like to link this macro to work in a directory deposited in a cell by an earlier macro that listed all the files in a selected directory. </p>\n\n<p>This is what I have, without any looping..</p>\n\n<pre><code>Sub Run_Renaming()\n\n    Dim CommandString As Long\n    Dim i As Integer\n    i = 5\n\n    'Other steps:\n        '1 - need to pick up variable (directory of files listed, taken from first macro\n        'when doing manually, I opened command, went to correct directory, then pasted\n        'the commands. I'm trying to handle pasting the commands. I'm not sure if I need\n        'something to open CMD from VBA, then run through the below loop, or add opening\n        'CMD and going to the directory in each iteration of the below loop...\n\n        '2 - Need to say - Loop below text if Worksheets(\"Batch Rename of Files\").Cells(i, \"C\").Value is no blank\n\n         CommandString = Worksheets(\"Batch Rename of Files\").Cells(i, \"F\").Value\n         Call Shell(\"cmd.exe /S /K\" &amp; CommandString, vbNormalFocus)\n\n    'Other steps:\n        '3 - need to increase i by 1\n\n        '4 - need to check if C column is blank or not\n\n        '5 - need to end of C column is blank\n\nEnd Sub\n</code></pre>\n\n<p><strong>Background:</strong></p>\n\n<p>I'm creating a file renaming tool for a friend. They can use excel, but no programming languages or command prompt. Because of this, I don't want to have any steps, like creating a batch file suggested <a href=\"https://stackoverflow.com/questions/38319056/how-do-i-run-a-set-of-terminal-commands-from-a-spreadsheet/38319809#38319809\">here</a>, that would complicate things for my friend. </p>\n\n<p>I've created an excel file with:</p>\n\n<p><code>Tab 1</code> - a template sheet to create a new file name list. Works by concatenating several cells, adding a filetype, and outputting to a range of cells. Tab two links to this range when creating the renaming command strings for CMD</p>\n\n<p><code>Tab 2</code> - </p>\n\n<p><code>Button 1</code> - <code>Sub rename()</code> below. VBA to list files in a selected directory in Column C</p>\n\n<p>Column F creates a command line that will rename File A as File B based on inputs to Tab 1 i.e. ren \"File 1\" \"A1_B1_C1.xlsx\"</p>\n\n<p><code>Button 2</code> - Refers to a renaming macro (requirement 1 and 2 above) that picks up the selected directory from Button 1 and runs through all the renaming command strings while in that directory</p>\n\n<pre><code>Sub rename()\n\n    Dim xRow As Long\n    Dim xDirect$, xFname$, InitialFoldr$\n\n    InitialFoldr$ = \"C:\\\"\n\n    Worksheets(\"Batch Rename of Files\").Activate\n    Worksheets(\"Batch Rename of Files\").Range(\"C4\").Activate\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n\n        .InitialFileName = Application.DefaultFilePath &amp; \"\\\"\n        .Title = \"Please select a folder to list Files from\"\n        .InitialFileName = InitialFoldr$\n        .Show\n\n        If .SelectedItems.Count &lt;&gt; 0 Then\n\n            xDirect$ = .SelectedItems(1) &amp; \"\\\"\n            xFname$ = Dir(xDirect$, 7)\n\n            Do While xFname$ &lt;&gt; \"\"\n                ActiveCell.Offset(xRow) = xFname$\n                xRow = xRow + 1\n                xFname$ = Dir\n            Loop\n\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "edited": false, "score": 0, "creation_date": 1510154622, "post_id": 47181313, "comment_id": 81315870, "body": "Thank you very much for the quick answer, Vitaya. I&#39;ll try to explain furhter."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "edited": false, "score": 0, "creation_date": 1510154702, "post_id": 47181313, "comment_id": 81315939, "body": "@Haellion - the locking and the unlocking part should be easily done once you know what to do."}, {"owner": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "edited": false, "score": 0, "creation_date": 1510155392, "post_id": 47181313, "comment_id": 81316497, "body": "There is a resource on Excel called &quot;Allow Users to Edit Ranges&quot; found on the &quot;Review&quot; tab under the &quot;Changes&quot; section (Excel 2016). It allows to protect the whole sheet but leaving a range for edition under the protection of a second password. This is my range (C19:G23 and C32:L70). I tried this code before but it doesn&#39;t work too. Also, I realized that I need to trigger it with a button to let the users to edit the rest of the range and not only the column C. Is there any way to do it with a public sub?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "edited": false, "score": 0, "creation_date": 1510155547, "post_id": 47181313, "comment_id": 81316586, "body": "@Haellion - simply record a macro while doing it."}, {"owner": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "edited": false, "score": 0, "creation_date": 1510156500, "post_id": 47181313, "comment_id": 81317251, "body": "Vityata, I tried that but then I&#39;ll have to recreate 1 macro for every line and make a button for every macro. It would be very cumbersome, not to mention that the users won&#39;t be able to use more than 1 line at the time. I need to be able to edit as many lines as I want within the range and then hit the button to action the macro because these lines will be added up and exported to another sheet creating another document based on the lack of &quot;Ok&quot; on column B."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "edited": false, "score": 0, "creation_date": 1510156938, "post_id": 47181313, "comment_id": 81317595, "body": "@Haellion - try to edit the recorded macro code so it works for every line."}, {"owner": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "edited": false, "score": 0, "creation_date": 1510157192, "post_id": 47181313, "comment_id": 81317789, "body": "I tried already. Apparently I&#39;m not capable of. Do you know how to change a range based on if a cell has a content or not?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "edited": false, "score": 0, "creation_date": 1510157272, "post_id": 47181313, "comment_id": 81317857, "body": "@Haellion - google <b>how to change a range based on if a cell has a content or not</b> and see the first 20 results."}, {"owner": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "edited": false, "score": 0, "creation_date": 1510158405, "post_id": 47181313, "comment_id": 81318666, "body": "I though it could work but the range set in the &quot;Allow Users to Edit Ranges&quot; cannot be changed the same way an ordinary range, Thanks."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1510148699, "creation_date": 1510148699, "answer_id": 47181313, "question_id": 47181166, "link": "https://stackoverflow.com/questions/47181166/protection-of-rows-within-an-edition-allowed-range-conditional-to-data-entry-in/47181313#47181313", "title": "Protection of rows within an edition allowed range conditional to data entry in a column", "body": "<p>I did not understand the protection part of your question, but the rest <em>(I need to create a VBA that verifies if data was input in any of the rows in column C within the range above, write the word \"Ok\" in column B of the rows where data was input)</em> should be done through this code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n    If Intersect(Target, Range(\"C1:C70\")) Is Nothing And _\n        Intersect(Target, Range(\"C19:G23\")) Is Nothing Then Exit Sub\n\n    Cells(Target.Row, 2) = \"OK\"\n\nEnd Sub\n</code></pre>\n\n<p>The trick is to exit the sub on 3 condtions:</p>\n\n<ul>\n<li>More than one cell</li>\n<li>Target outside C1:C70 </li>\n<li>Target outside C19:G23</li>\n</ul>\n\n<p>Then use the property <code>.Row</code> of <code>Target</code> in order to write the \"OK\" on column \"B\".</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "is_accepted": false, "score": 0, "last_activity_date": 1510168092, "creation_date": 1510168092, "answer_id": 47187736, "question_id": 47181166, "link": "https://stackoverflow.com/questions/47181166/protection-of-rows-within-an-edition-allowed-range-conditional-to-data-entry-in/47187736#47187736", "title": "Protection of rows within an edition allowed range conditional to data entry in a column", "body": "<p>I came up with this below sowing from a bunch a found and it worked perfectly. Thank you very much for the help!</p>\n\n<pre><code>Sub Test()\nActiveSheet.Unprotect Password:=\"Maze\"\nDim mainworkBook As Workbook\nSet mainworkBook = ActiveWorkbook\nApplication.ScreenUpdating = False\nDim lastRow As Long\nDim cell As Range\nlastRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nFor Each cell In Range(\"C32:C70\" &amp; lastRow)\nIf InStr(1, cell.Value, \"\") &lt;&gt; 0 Then\ncell.Offset(, -1).Value = \"Ok\"\nEnd If\nNext\nApplication.ScreenUpdating = True\nActiveSheet.Protect Password:=\"Maze\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8902666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62b8cdbf75ee54a379d6d726f24b11e9?s=128&d=identicon&r=PG&f=1", "display_name": "Haellion", "link": "https://stackoverflow.com/users/8902666/haellion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1510168092, "creation_date": 1510148241, "last_edit_date": 1510148322, "question_id": 47181166, "link": "https://stackoverflow.com/questions/47181166/protection-of-rows-within-an-edition-allowed-range-conditional-to-data-entry-in", "title": "Protection of rows within an edition allowed range conditional to data entry in a column", "body": "<p>Good afternoon,\nI have a worksheet protected with a password where users are allowed to edit only the range comprised by the cells <code>C19:G23</code> and <code>C32:L70</code>.\nI need to create a VBA that verifies if data was input in any of the rows in column C within the range above, write the word \"Ok\" in column B of the rows where data was input and protects these for further edition. In other words, I need to modify/overwrite the edition allowed range based on data input in column C.\nI tried several ways over 2 the last days, including the private sub below taken from another answer found here with several modifications, but none of them worked.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    Application.EnableEvents = False\n\n    Dim mypassword As String, StringToCheck As String\n\n    On Error GoTo Whoa\n\n    '~~&gt; Change the password here to protect/unprotect the sheet\n    mypassword = \"Maze\"\n\n    '~~&gt; Change it to the relevant string with which you want to compare\n    StringToCheck = \"Ok\"\n\n    If Not Intersect(Target, Range(\"C1:C70\")) Is Nothing Then\n        '~~&gt; Check for the cell value\n        If Target.Value = \u201cOk\u201d Then\n            '~~&gt; Un-Protect the sheet\n            ActiveSheet.Unprotect Squonk\n\n            '~~&gt; Lock the cell\n            Range(\"A1:AAA50000\").Locked = True\n\n            '~~&gt; Re-Protect the sheet\n            ActiveSheet.Protect Squonk\n        End If\n    End If\n\nLetsContinue:\n    Application.EnableEvents = True\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume LetsContinue\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1510148220, "post_id": 47181101, "comment_id": 81311095, "body": "Why are you using square brackets around your integer? <code>[1]</code> - try using just <code>1</code>"}, {"owner": {"reputation": 1, "user_id": 8906669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e57a116b2a485af1cd4d6f1afc3792?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8906669/tom"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510149463, "post_id": 47181101, "comment_id": 81311982, "body": "Hi, I got rid of them and it works now. Thank you very much!"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1510149554, "creation_date": 1510149554, "answer_id": 47181637, "question_id": 47181101, "link": "https://stackoverflow.com/questions/47181101/run-time-error-438-when-button-from-activex-controls-is-added/47181637#47181637", "title": "Run-time Error &#39;438&#39; when button from ActiveX Controls is added", "body": "<p>Integers do not require square braces around them. Instead of using <code>[1]</code> use just <code>1</code></p>\n"}], "owner": {"reputation": 1, "user_id": 8906669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e57a116b2a485af1cd4d6f1afc3792?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8906669/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510149554, "creation_date": 1510148038, "last_edit_date": 1510148122, "question_id": 47181101, "link": "https://stackoverflow.com/questions/47181101/run-time-error-438-when-button-from-activex-controls-is-added", "title": "Run-time Error &#39;438&#39; when button from ActiveX Controls is added", "body": "<p>I am new to VBA Excel. I am trying to copy certain information from email body (Outlook) into Excel. My code works fine when I run it from Visual Basic winfow under Excel. I want to lunch the code via button inserted from ActiveX controls. Unfortunately, when I hit the button, it reports </p>\n\n<blockquote>\n  <p>Run-time Error '438'</p>\n</blockquote>\n\n<p>at the line <code>sub1 = InStr([1], myitem.Subject, \"ARM_\")</code> Could anyone please help me to solve it? I tried to search for similar issues but I have not managed to find any that would be helpful. Thank you. Please find my code below. I am sorry for inapropriate formating.  </p>\n\n<pre><code>Sub out()\n\nDim myOlApp As Object\nDim mynamespace As Object\nDim myitem As Object\nDim myfolder As Object\nDim date1 As Date\nDim k As Integer\nDim i As Integer\nDim sub1 As Variant\nDim sub2 As Variant\nDim sub3 As Variant\nDim u As Integer\nDim x As String\n\n\n\nk = 1\n\n\n date1 = InputBox(\"zadej datum - dd/mm/yyyy\") 'vyskoci box pro zadani datumu\n\n Set myOlApp = CreateObject(\"Outlook.Application\") 'nastavi outlook pro editaci\n\n Set mynamespace = myOlApp.GetNamespace(\"mapi\") 'otevre adresar outlooku\n Set myfolder = myOlApp.ActiveExplorer.CurrentFolder 'pristup do adresare emailu (inbox)\n\n i = myfolder.items.Count ' pocet mailu v adresari - vsechny prichozi maily v outlooku\n\n For i = i - 40 To myfolder.items.Count ' tento cyklus projizdi poslednich 300 mailu ve schrance\n\n    Set myitem = myfolder.items(i) 'editace mailu ve schrance\n    sub1 = InStr([1], myitem.Subject, \"ARM_\") 'vyhleda vsechny maily(nazev), ktere zacinaji \"ARM_\"\n    sub2 = InStr([1], myitem.Body, \"Target release to customer:\") 'vyhleda text v tele emailu\n    sub3 = InStr([1], myitem.Body, \"Location\")\n\n    'MsgBox InStr([1], myitem.body, \"Locations:\")\n    'Cells(1, 3) = i\n     'Cells(2, 3) = myitem.Subject\n     'Cells(3, 3) = myitem.ReceivedTime\n     'Cells(4, 3) = sub2\n     'Cells(5, 3) = sub3\n\n\n   If myitem.ReceivedTime &gt; date1 And sub1 = 1 Then ' podminky museji byt splneny - datum,text v nazvu mailu,text v mailu\n\n      If sub2 &gt; 0 Then\n\n        k = k + 1\n        x = Mid(myitem.Body, sub2 + 27, sub3 - (sub2 + 27)) ' vyhleda ozadovany text\n        Cells(k, 1) = myitem.ReceivedTime ' cas doruceni mailu\n        Cells(k, 2) = myitem.Subject ' nazev mailu\n        'Cells(k, 3) = myitem.Body\n        Cells(k, 4) = x\n      End If\n    End If\n\n\n Next i\n  'msgtext = myitem.Body\n  'Cells(1, 1) = msgtext\n  'Cells(1, 2) = myitem.Subject\n  'Cells(1, 3) = myitem.ReceivedTime   \n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510148076, "post_id": 47180960, "comment_id": 81310998, "body": "Have you tried recording a macro when you do it manually?"}, {"owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510149743, "post_id": 47180960, "comment_id": 81312177, "body": "No i have no record a macro as the row numbers of the items associated with a quote can be anywhere in the list and the number of break quantities can vary with each item."}], "owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510147630, "creation_date": 1510147630, "question_id": 47180960, "link": "https://stackoverflow.com/questions/47180960/transforming-data-layout", "title": "Transforming Data Layout", "body": "<p>With reference the sample raw data below i have an export that lists for each item on a quote the various prices for each break quantity. Unfortunately the data is arranged in rows. What i would like to achieve is following the user specifying a particular quote number for the associated data to be copied to a new sheet and the layout transformed as per the two examples below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0Vg9v.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0Vg9v.jpg\" alt=\"Sample Raw Data\"></a></p>\n\n<p>If quote 1 is selected the data should be arranged with the various break quantities and prices vertically arranged with an empty row between items associated with quote 1. If the price break is null then it is excluded to avoid creating too many empty rows.</p>\n\n<p><a href=\"https://i.stack.imgur.com/73MmI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/73MmI.jpg\" alt=\"Quote 1\"></a></p>\n\n<p>By the same process if the user selected quote 2 then the data would be arranged as below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XaPhA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XaPhA.jpg\" alt=\"Quote 2\"></a></p>\n\n<p>I am happy to use vba to transform the data based on the user input for which quote they wish to view but i an unable to sort out the logic / process to use</p>\n"}, {"tags": ["vba", "colors", "ms-word"], "comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1510225577, "post_id": 47180943, "comment_id": 81348887, "body": "Sounds like you have a cool boss :-P  So... rather than search for all the possible colors can you search for shading that has  NOT no_color  (e.g. some color) and convert to highlight?"}, {"owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "reply_to_user": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1510313156, "post_id": 47180943, "comment_id": 81393000, "body": "I thought about it, but it is very slow too. Especially if there is no shading in doc. I have couple thousands large docs to review (every week) therefore I&#39;m looking for extremally fast solution."}], "answers": [{"tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 1, "last_activity_date": 1510483915, "last_edit_date": 1510483915, "creation_date": 1510409650, "answer_id": 47238831, "question_id": 47180943, "link": "https://stackoverflow.com/questions/47180943/how-to-find-shading-in-word-document-using-color-number-from-wordopenxml/47238831#47238831", "title": "How to find shading in Word document using color number from WordOpenXML", "body": "<p>I think this article explains what is going on: <a href=\"http://www.wordarticles.com/Articles/Colours/2007BuildSet.php\" rel=\"nofollow noreferrer\">http://www.wordarticles.com/Articles/Colours/2007BuildSet.php</a> </p>\n\n<p>In a nutshell you are dealing with Theme Colors and the reason they don't seem to convert from Hex to RGB is because they are modified by a 'lightness-darkness' accent. </p>\n\n<p>The article describes how the color system works - as far as I can tell, as you found out, the number you are looking for: -687800321 when written in HEX is: &amp;HD<strong>7</strong>00FFFF <em>(which is NOT RGB)</em>; instead this notation represents theme color \"number 7\" with lightness-darkness of FFFF.</p>\n\n<p>I think this essentially means you will need to create / find some sort of translation table to store in your conversion macro (or figure out what all the theme colors are and do something sneaky, see below).</p>\n\n<hr>\n\n<p>Gah, annoyingly, I have just realised it gets worse - read here:\n<a href=\"http://www.wordarticles.com/Articles/Colours/2007.php\" rel=\"nofollow noreferrer\">http://www.wordarticles.com/Articles/Colours/2007.php</a></p>\n\n<p>Anyway there is a solution based on the understanding that MS Word stores the RGB but insists on using the theme information to find the shading. So for a simple 2 word document you have:</p>\n\n<pre><code>&lt;w:r&gt;\n    &lt;w:rPr&gt;\n        &lt;w:shd w:val=\"clear\" w:color=\"auto\" w:fill=\"C0504D\" w:themeFill=\"accent2\"/&gt;\n    &lt;/w:rPr&gt;\n    &lt;w:t&gt;Red&lt;/w:t&gt;\n&lt;/w:r&gt;\n...\n&lt;w:r&gt;\n    &lt;w:rPr&gt;\n        &lt;w:shd w:val=\"clear\" w:color=\"auto\" w:fill=\"E5B8B7\" w:themeFill=\"accent2\" w:themeFillTint=\"66\"/&gt;\n    &lt;/w:rPr&gt;\n    &lt;w:t&gt;Red-Lighter&lt;/w:t&gt;\n&lt;/w:r&gt;\n</code></pre>\n\n<p>Both the fill values (C0504D) &amp; (E5B8B7) are RGB but you have to use the Theme information for find and replace which is annoying... So, for example, you have to use <code>w:themeFill=\"accent2\"</code> &amp; <code>w:themeFillTint=\"66\"</code>.</p>\n\n<p>And then you can use this function (see below) from the original article to convert accent<strong>2</strong> and tint<strong>66</strong> into the obscure number that are otherwise unable to determine.</p>\n\n<pre><code>' All Credit to Tony Jollans - http://www.wordarticles.com/Articles/Colours/2007.php\nFunction GetThemeColor(ThemeColorIndex As WdThemeColorIndex, TintAndShade As Double) As Long\n\n    Const HexadecimalPrefix As String = \"&amp;H\"\n    Const UseThemeColor     As String = \"D\"\n    Const UnusedZeroByte    As String = \"00\"\n    Const Unchanged         As String = \"FF\"\n\n    Dim ThemeColor          As String\n    Dim LightnessOrDarkness As String\n\n    ThemeColor = Hex$(ThemeColorIndex)\n\n    If TintAndShade &gt;= 0 Then\n        LightnessOrDarkness = Unchanged &amp; Right$(\"0\" &amp; Hex$((1 - TintAndShade) * &amp;HFF), 2)\n    Else\n        LightnessOrDarkness = Right$(\"0\" &amp; Hex$((1 + TintAndShade) * &amp;HFF), 2) &amp; Unchanged\n    End If\n\n    GetThemeColor = CLng(HexadecimalPrefix &amp; UseThemeColor &amp; ThemeColor &amp; UnusedZeroByte &amp; LightnessOrDarkness)\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "is_accepted": false, "score": 0, "last_activity_date": 1512993222, "creation_date": 1512993222, "answer_id": 47752387, "question_id": 47180943, "link": "https://stackoverflow.com/questions/47180943/how-to-find-shading-in-word-document-using-color-number-from-wordopenxml/47752387#47752387", "title": "How to find shading in Word document using color number from WordOpenXML", "body": "<p>After long investigation I've almost* find a solution. Here is my second topic in other forum.\n<a href=\"https://social.microsoft.com/Forums/pl-PL/2ea570b5-ce3a-4f37-a37c-9b2100941d39/how-to-find-shading-in-word-document-using-color-number-reciving-from-wordopenxml\" rel=\"nofollow noreferrer\">https://social.microsoft.com/Forums/pl-PL/2ea570b5-ce3a-4f37-a37c-9b2100941d39/how-to-find-shading-in-word-document-using-color-number-reciving-from-wordopenxml</a></p>\n\n<p>All magic is in bits :)</p>\n\n<pre><code>part 1  part 2       part 3        part 4            part 5\nfixed   w:themeFill  don't know    w:themeFillShade  w:themeFillTint\n1101    0111         00000000      11111111          11111111    \n</code></pre>\n\n<p>part 1.\nFixed for theme colors (negative number)</p>\n\n<p>part 2.\nw:themeFill is WdThemeColorIndex Enumeration (accent4 == 7 == 0111)</p>\n\n<p>part 3.\nStill looking what's this</p>\n\n<p>part 4.\nw:themeFillShade==11111111 (\"FF\") if ommited in xml </p>\n\n<p>part 5.\nw:themeFillTint==11111111 (\"FF\") if ommited in xml</p>\n\n<p>w:fill has no influence to color number if w:themeFill is used.</p>\n\n<hr>\n\n<p>*almost, because 9-16bits are still mystery.</p>\n"}], "owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512993222, "creation_date": 1510147574, "last_edit_date": 1510214478, "question_id": 47180943, "link": "https://stackoverflow.com/questions/47180943/how-to-find-shading-in-word-document-using-color-number-from-wordopenxml", "title": "How to find shading in Word document using color number from WordOpenXML", "body": "<p>I have to change every shading <code>BackgroundPatternColor</code> to <code>Highlight</code> (don't ask \"why?\", I have to)\nChanging character by character is very, very slow.\nFastest way is using <code>.Find</code> method.</p>\n\n<p>But in documents can be a lot of different shading colors (24-bit color).\nIn WordOpenXML is sth. like this:</p>\n\n<pre><code>  &lt;w:shd w:val=\"clear\" w:color=\"auto\" w:fill=\"8064A2\"&gt;\n</code></pre>\n\n<p>From this xml, I know that \"8064A2\" shading color was used in document - that \"8064A4\" number is hex RRGGBB mask , and its mean <code>RGB(128, 100, 162)</code> - hex \"80\" is 128 decimal etc.</p>\n\n<p>But... function <code>RGB(128, 100, 162)</code> return 10642560.\nThe shading I'm looking for return -687800321 </p>\n\n<pre><code>Debug.print Selection.Range.Shading.BackgroundPatternColor\n</code></pre>\n\n<p>Why? and how to receive -687800321 number from RGB (because <code>Selection.Find.Shading.BackgroundPatternColor = -687800321</code> works great)</p>\n"}, {"tags": ["vba", "class", "dictionary", "collections"], "answers": [{"tags": [], "owner": {"reputation": 159, "user_id": 8855875, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c08f95c3c642c1d29d0bef9809c66390?s=128&d=identicon&r=PG&f=1", "display_name": "JustinCoplin", "link": "https://stackoverflow.com/users/8855875/justincoplin"}, "is_accepted": true, "score": 0, "last_activity_date": 1510254853, "last_edit_date": 1510254853, "creation_date": 1510148799, "answer_id": 47181350, "question_id": 47180795, "link": "https://stackoverflow.com/questions/47180795/vba-collection-class-unwated-data-overwriting/47181350#47181350", "title": "VBA Collection Class: Unwated Data Overwriting", "body": "<p>I went ahead with the idea to pass along all the data to the add routine, and it seems to have solved the issue. I would still like to know why the method I was using did not work, though, so please feel free to comment or answer with regards to that. </p>\n\n<p>The solution was to change the cEdges.Add Sub to accept all the individual parameters that were once passed to the temporary edge variable:</p>\n\n<pre><code>Sub Add(ByVal iName As String, iNode1 As cCavity, iNode2 As cCavity, iValue As Integer)\n    Dim Edge As New cEdge\n    With Edge\n        .Name = iName\n        .SetNode iNode1, 0\n        .SetNode iNode2, 1\n        .Value = iValue\n    End With\n    pEdges.Add Edge.Name, Edge\nEnd Sub\n</code></pre>\n\n<p>This changes the populating loop to look like:</p>\n\n<pre><code>Sub CalculateEdges(cCavities() As cCavity, dEdges As cEdges)\n    Dim i As Integer\n\n    For i = 1 To UBound(cCavities)\n        Dim AdjSize As Integer\n        AdjSize = cCavities(i).AdjacencySize\n        If AdjSize &gt; MaxEdges Then MaxEdges = AdjSize\n        Dim j As Integer\n        For j = 1 To AdjSize\n            dEdges.Add cCavities(i).Name &amp; cCavities(i).Adjacency(j), cCavities(i), BackGround.NodeByName(cCavities, cCavities(i).Adjacency(j)), 0\n            dEdges.PrintNames\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This code, especially the .Add line, could be cleaned up. I will most likely do that, but this is fine for now. </p>\n\n<p><strong>EDIT:</strong> Upon further research and a bit more trial and error, I have discovered the reason for the data being overwritten. The <code>Set</code> keyword only creates a pointer to the original value, effectively making my above code have one object, the TempEdge variable, and a whole bunch of different heads that pointed to it. That is why when the Temp edge was edited, all the subsequent heads changes. </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10045352, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9aqOYm723I8/AAAAAAAAAAI/AAAAAAABSd4/Gjp9pES493I/photo.jpg?sz=128", "display_name": "Jon Cartee", "link": "https://stackoverflow.com/users/10045352/jon-cartee"}, "is_accepted": false, "score": 1, "last_activity_date": 1530944505, "creation_date": 1530944505, "answer_id": 51220519, "question_id": 47180795, "link": "https://stackoverflow.com/questions/47180795/vba-collection-class-unwated-data-overwriting/51220519#51220519", "title": "VBA Collection Class: Unwated Data Overwriting", "body": "<p>Moving the Set \"TempEdge = New cEdge\" into the loop will create a new instance and a new pointer location with every loop while maintaining your collections references to previous pointers.    </p>\n\n<pre><code>Sub CalculateEdges(cCavities() As cCavity, dEdges As cEdges)\nDim i As Integer\n\nFor i = 1 To UBound(cCavities)\n    Dim TempEdge As cEdge\n\n\n\n    Dim AdjSize As Integer\n    AdjSize = cCavities(i).AdjacencySize\n    If AdjSize&gt; MaxEdges Then MaxEdges = AdjSize\n    Dim j As Integer\n    For j = 1 To AdjSize\n        Set TempEdge = New cEdge\n        With TempEdge\n            'Edge Names are a combination of two node names\n            .Name = cCavities(i).Name &amp; cCavities(i).Adjacency(j)\n            'Sets the start node (Object) for the edge\n            .SetNode cCavities(i), 0\n            'Sets the end node (Object) for the edge\n            .SetNode BackGround.NodeByName(cCavities, cCavities(i).Adjacency(j)), 1\n            'Used later in program\n            .Value = 0\n        End With\n        dEdges.Add TempEdge\n        dEdges.PrintNames\n    Next j\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 159, "user_id": 8855875, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c08f95c3c642c1d29d0bef9809c66390?s=128&d=identicon&r=PG&f=1", "display_name": "JustinCoplin", "link": "https://stackoverflow.com/users/8855875/justincoplin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 47181350, "answer_count": 2, "score": 1, "last_activity_date": 1530944505, "creation_date": 1510147171, "question_id": 47180795, "link": "https://stackoverflow.com/questions/47180795/vba-collection-class-unwated-data-overwriting", "title": "VBA Collection Class: Unwated Data Overwriting", "body": "<p>I have a Collection Class (or rather a dictionary class, in this case) that is used to store a variable amount of edge objects. When I try to populate the Dictionary that holds all the information via loop, the data is continuously overwritten and I cannot seem to figure out why. The code for the class in question follows:</p>\n\n<pre><code>Option Explicit\n\nPrivate pEdges As New Scripting.Dictionary\n\nProperty Get Count() As Long\n    Count = pEdges.Count\nEnd Property\n\nProperty Get EdgeByName(ByVal iName As Variant) As cEdge\n    Set EdgeByName = pEdges(iName)\nEnd Property\n\n'Would it be better to pass all of the data to this add sub, and create \n'the class objects here, rather than creating a temporary class object and \n'just passing it along?\nSub Add(ByVal iEdge As cEdge)\n    Dim Edge As New cEdge\n    Set Edge = iEdge\n    pEdges.Add Edge.Name, Edge\nEnd Sub\n\nSub Remove(ByVal iName As Variant)\n    pEdges.Remove (iName)\nEnd Sub\n\nSub RemoveAll()\n    pEdges.RemoveAll\nEnd Sub\n\nSub PrintNames()\n    Dim Key As Variant\n    For Each Key In pEdges\n        Debug.Print Key &amp; \" - \" &amp; pEdges(Key).Name &amp; vbCrLf;\n    Next\n    Debug.Print vbdrlf;\nEnd Sub\n</code></pre>\n\n<p>Sub that generates the Edges object follows:</p>\n\n<pre><code>Sub CalculateEdges(cCavities() As cCavity, dEdges As cEdges)\n    Dim i As Integer\n\n    For i = 1 To UBound(cCavities)\n        Dim TempEdge As cEdge\n        Set TempEdge = New cEdge\n        Dim AdjSize As Integer\n        AdjSize = cCavities(i).AdjacencySize\n        If AdjSize&gt; MaxEdges Then MaxEdges = AdjSize\n        Dim j As Integer\n        For j = 1 To AdjSize\n            With TempEdge\n                'Edge Names are a combination of two node names\n                .Name = cCavities(i).Name &amp; cCavities(i).Adjacency(j)\n                'Sets the start node (Object) for the edge\n                .SetNode cCavities(i), 0\n                'Sets the end node (Object) for the edge\n                .SetNode BackGround.NodeByName(cCavities, cCavities(i).Adjacency(j)), 1\n                'Used later in program\n                .Value = 0\n            End With\n            dEdges.Add TempEdge\n            dEdges.PrintNames\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p>The output of the dEdges.PrintNames sub is what I have been using for debugging this (since the Watches window doesn't show the item data of a dictionary). \nAs the loops go on it prints the Key and the Name Value of the edge object that the key corresponds to. If working correctly, these two strings should be identical. As it is though, every time I add a new edge object to the dictionary, it overwrites the objects for all the previously entered keys. I have the suspicion that this is related to the fact that I create a TempEdge Variable to pass to the Collection Class, but I am not sure. </p>\n\n<p>Example of output:</p>\n\n<pre><code>C1C2 - C1C2\n\nC1C2 - C1C3\nC1C3 - C1C3\n\nC1C2 - C1C4\nC1C3 - C1C4\nC1C4 - C1C4\n\nETC\n</code></pre>\n\n<p>This is just one single data point being tested, but let me assure you that all the variables inside the cEdge object are overwritten, not just the name string. It is simply the easiest to check since it is just a string. </p>\n\n<p>As a side note, if there is a way to see the Object stored in the dictionary, similar to the \"Watches\" window, I would very much like to know how to do it. The entire reason I am even using the temp edge at this point is so I can keep track of what data is going into the dictionary at any given point in the loop.</p>\n\n<p>Second side note, If I can get this working I will most likely switch the cCavities array to a similar collection class. It is not currently one because I cant seem to get them working right.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510147052, "post_id": 47180709, "comment_id": 81310263, "body": "<code>Rows.Count</code> is not being fully qualified with a <code>Worksheet</code> and neither is <code>Columns.Count</code> or <code>Cells</code> references. You need to fully qualify your Ranges."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8890599"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510149982, "post_id": 47180709, "comment_id": 81312346, "body": "Thanks for your feedback! Could you help explain what you mean by qualify the ranges? I&#39;m new to the world of VBA. If I have a bit more context I think I could run with this."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8890599"}, "edited": false, "score": 0, "creation_date": 1510149821, "post_id": 47180926, "comment_id": 81312237, "body": "I&#39;ve adjusted the code with the recommendations you included above but the following line is resulting in an &#39;Application-defined or object-defined error:                                                                                                                             With x.Sheets(&quot;sheets&quot;)     .Range(StartCell, .Cells(FinalRow, FinalColumn)).Copy End With  With y.Sheets(&quot;sheets&quot;)     .Range(.Cells(1, 17), .Cells(FinalRow, FinalColumn)).Paste End With  End Sub"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1510150563, "last_edit_date": 1510150563, "creation_date": 1510147529, "answer_id": 47180926, "question_id": 47180709, "link": "https://stackoverflow.com/questions/47180709/copying-dynamic-range-into-a-different-workbook/47180926#47180926", "title": "Copying Dynamic Range into a Different Workbook", "body": "<p>You have to declare the worksheet, which is the \"parent\" of Cells as well. Like this:</p>\n\n<pre><code>With x.Sheets(\"Worksheet Name\")\n    .Range(StartCell, .Cells(finalrow, FinalColumn)).Copy\nEnd With\n\nWith y.Sheets(\"Worksheet Name\")\n    .Range(.Cells(1, 7)).PasteSpecial xlPasteAll\nEnd With\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8890599"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510150563, "creation_date": 1510146843, "last_edit_date": 1510147731, "question_id": 47180709, "link": "https://stackoverflow.com/questions/47180709/copying-dynamic-range-into-a-different-workbook", "title": "Copying Dynamic Range into a Different Workbook", "body": "<p>I'm currently trying to copy and paste a dynamic range from one workbook to another in order to refresh an existing dashboard. </p>\n\n<p>I've developed the code below, but continue to get error notifications on the italicized portion below:</p>\n\n<pre><code>Sub TransferData()\n\n    Dim x As Workbook\n    Dim y As Workbook\n\n    Set x = Workbooks.Open(\"C:\\file1.xlsx\")\n    Set y = Workbooks.Open(\"C:\\file2.xlsx\")\n    Set StartCell = Range(\"A1\")    \n\n    finalrow = x.Sheets(\"Worksheet Name\").Cells(Rows.Count, 2).End(xlUp).Row\n    'Counts\n    FinalColumn = x.Sheets(\"Worksheet Name\").Cells(1,\n    Columns.Count).End(xlToLeft).Column\n\n    *x.Sheets(\"Worksheet Name\").Range(StartCell, Cells(FinalRow,\n    FinalColumn)).Copy*\n    y.Sheets(\"Worksheet Name\").Range(Cells(1, 7), Cells(FinalRow,\n    FinalColumn)).Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1510147141, "post_id": 47180256, "comment_id": 81310331, "body": "Which line actually produces the error?"}, {"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1510147179, "post_id": 47180256, "comment_id": 81310355, "body": "If (c.Value = &quot;AFSB&quot; Or c.Value = &quot;TEIGIP4T&quot; Or c.Value = &quot;EPP&quot;) Then"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1510147228, "post_id": 47180256, "comment_id": 81310392, "body": "You&#39;ve probably got a cell that appears as <code>#######</code>? Try using: <code>If (c.Value2 = &quot;AFSB&quot; Or c.Value2 = &quot;TEIGIP4T&quot; Or c.Value2 = &quot;EPP&quot;) Then</code>"}, {"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1510147623, "post_id": 47180256, "comment_id": 81310690, "body": "You are absolutely right about the formatting issue where a few cells appear as #######.  Unfortunately, the correction you recommended still produces the Runtime error, but the code works when I manually override the formatting issue.  Is the easiest thing to insert code that would allow me to format the data as it is being copied over?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1510147853, "post_id": 47180256, "comment_id": 81310849, "body": "Are those cells formatted as Date? If so, the correction I suggested has never failed me before - are you sure you changed <b>all</b> the <code>Value</code> to <code>Value2</code>?"}, {"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1510149808, "post_id": 47180256, "comment_id": 81312229, "body": "I did but it looks like the issue was my not using CountLarge along with the formatting problems."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1510152759, "post_id": 47180256, "comment_id": 81314341, "body": "There&#39;s nothing in that code that should require <code>CountLarge</code> since you aren&#39;t counting all the cells on a sheet."}, {"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1510168369, "post_id": 47180256, "comment_id": 81324857, "body": "Good point, but for whatever reason it seems to be working now so I don&#39;t want to chance it."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "edited": false, "score": 0, "creation_date": 1510146293, "post_id": 47180345, "comment_id": 81309730, "body": "Gave that a shot, but still running into the overflow error.  Not sure what I am doing wrong here"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510146377, "post_id": 47180345, "comment_id": 81309779, "body": "What is the value of <code>x</code>? Basically, use Long always instead of Integer."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510146510, "post_id": 47180345, "comment_id": 81309866, "body": "@SJR Spot on! x is incrementing. I have edited my response."}, {"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "edited": false, "score": 0, "creation_date": 1510146660, "post_id": 47180345, "comment_id": 81309981, "body": "I&#39;ve declared both bottomL and x As Long, but still getting the same error"}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 1, "last_activity_date": 1510146473, "last_edit_date": 1510146473, "creation_date": 1510145800, "answer_id": 47180345, "question_id": 47180256, "link": "https://stackoverflow.com/questions/47180256/getting-runtime-error-6-overflow-error/47180345#47180345", "title": "Getting Runtime error &#39;6&#39;: Overflow error", "body": "<p>Variable \n<code>bottomL As Integer</code></p>\n\n<p>Will give overflow error the moment it exceeds 32,767 rows. Try declaring it as long</p>\n\n<p><code>bottomL As Long</code></p>\n\n<p>Edit: The rule applies to X as well as it is incrementing.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "edited": false, "score": 0, "creation_date": 1510148160, "post_id": 47180605, "comment_id": 81311061, "body": "I think we finally got, thanks for the refresh!  Was the issue that I wasn&#39;t using CountLarge and/or the Explicit declaration at start?  So frustrating it could come down to something that seemingly trivial"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "edited": false, "score": 0, "creation_date": 1510148312, "post_id": 47180605, "comment_id": 81311150, "body": "Because you were not using CountLarge you got a run time error. Explicit is not important here just best practise"}, {"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "edited": false, "score": 0, "creation_date": 1510148378, "post_id": 47180605, "comment_id": 81311202, "body": "Well thanks so much for the help, really appreciate it.  This is something I use daily so important to get it right.  Muchos gracias!"}, {"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "edited": false, "score": 0, "creation_date": 1510149290, "post_id": 47180605, "comment_id": 81311850, "body": "One more question, is it possible to augment your code slightly so it only copies values over as to preserve the source formatting in the destination tab?"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1510146565, "creation_date": 1510146565, "answer_id": 47180605, "question_id": 47180256, "link": "https://stackoverflow.com/questions/47180256/getting-runtime-error-6-overflow-error/47180605#47180605", "title": "Getting Runtime error &#39;6&#39;: Overflow error", "body": "<p>Try this </p>\n\n<pre><code>Option Explicit\n\nSub CopyRows()\n    Dim bottomL As Long\n    Dim x As Long\n        bottomL = Sheets(\"Pacer\").Range(\"L\" &amp; Rows.CountLarge).End(xlUp).Row: x = 1\n\n    Dim c As Range\n    For Each c In Sheets(\"Pacer\").Range(\"A1:L\" &amp; bottomL)\n        If (c.Value = \"AFSB\" Or c.Value = \"TEIGIP4T\" Or c.Value = \"EPP\") Then\n            Intersect(c.Parent.Columns(\"A:Q\"), c.EntireRow).Copy Worksheets(\"Portfolio\").Range(\"A\" &amp; x + 1)\n            x = x + 1\n        End If\n    Next c\n\nEnd Sub\n</code></pre>\n\n<p>Reason explained <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-countlarge-property-excel\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 47180605, "answer_count": 2, "score": 0, "last_activity_date": 1510146565, "creation_date": 1510145556, "last_edit_date": 1531161705, "question_id": 47180256, "link": "https://stackoverflow.com/questions/47180256/getting-runtime-error-6-overflow-error", "title": "Getting Runtime error &#39;6&#39;: Overflow error", "body": "<p>Code was working fine up until a couple of days ago but now getting the subject-line error.  Help?</p>\n\n<pre><code>Sub CopyRows()\n    Dim bottomL As Integer\n    Dim x As Integer\n        bottomL = Sheets(\"Pacer\").Range(\"L\" &amp; Rows.Count).End(xlUp).Row: x = 1\n\n    Dim c As Range\n    For Each c In Sheets(\"Pacer\").Range(\"A1:L\" &amp; bottomL)\n        If (c.Value = \"AFSB\" Or c.Value = \"TEIGIP4T\" Or c.Value = \"EPP\") Then\n            Intersect(c.Parent.Columns(\"A:Q\"), c.EntireRow).Copy Worksheets(\"Portfolio\").Range(\"A\" &amp; x + 1)\n            x = x + 1\n        End If\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13, "user_id": 8906768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82cf0025ef5b94d38fa0752ac15792b1?s=128&d=identicon&r=PG&f=1", "display_name": "Masterarbeit2", "link": "https://stackoverflow.com/users/8906768/masterarbeit2"}, "edited": false, "score": 0, "creation_date": 1510145983, "post_id": 47180186, "comment_id": 81309518, "body": "Now we found out that the problem was the cell format of the dates.But we still have the problem with the lookup values where no value is found. How is it possible to use iferror worksheetfunction?"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1510146040, "creation_date": 1510146040, "answer_id": 47180419, "question_id": 47180186, "link": "https://stackoverflow.com/questions/47180186/vba-excel-vlookup-search-value-is-string/47180419#47180419", "title": "Vba Excel Vlookup Search value is String", "body": "<p>Drop the <code>WorksheetFunction</code> as that always raises run-time errors (plenty about this online) while <code>Application</code> allows for an error to be tested.</p>\n\n<pre><code>Sub x()\n\nIf Cells(3, d) = Cells(c, 33) Then\n    VlookSrc = Cells(c, 48).Value &amp; \"/DIR/\" &amp; Cells(4, d).Value\n    Cells(c, d) = Application.IfError(Application.VLookup(VlookSrc, Range(Cells(5, 308), Cells(105673, 309)), 2, False), 0)\nElse\n    Cells(c, d) = 0\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1510146167, "creation_date": 1510146167, "answer_id": 47180461, "question_id": 47180186, "link": "https://stackoverflow.com/questions/47180186/vba-excel-vlookup-search-value-is-string/47180461#47180461", "title": "Vba Excel Vlookup Search value is String", "body": "<p>You can't use <code>IfError()</code> like that in <strong>VBA</strong>, instead:</p>\n\n<pre><code>Sub luxation()\n    Dim v\n    With Application.WorksheetFunction\n        v = 0\n        On Error Resume Next\n            Cells(c, d) = .VLookup(VlookSrc, Range(Cells(5, 308), Cells(105673, 309)), 2, False)\n        On Error GoTo 0\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8906768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82cf0025ef5b94d38fa0752ac15792b1?s=128&d=identicon&r=PG&f=1", "display_name": "Masterarbeit2", "link": "https://stackoverflow.com/users/8906768/masterarbeit2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 763, "favorite_count": 0, "accepted_answer_id": 47180461, "answer_count": 2, "score": 0, "last_activity_date": 1510146167, "creation_date": 1510145370, "last_edit_date": 1531164843, "question_id": 47180186, "link": "https://stackoverflow.com/questions/47180186/vba-excel-vlookup-search-value-is-string", "title": "Vba Excel Vlookup Search value is String", "body": "<p>The code below doesn't work </p>\n\n<blockquote>\n  <p>run time error 1004</p>\n</blockquote>\n\n<p><code>VlookSrc</code> (Dim As String in VBA) is the value we look for in <code>Range(\"KV5:KW105673\")</code>. It's a combination of different cells depending on c and d, and the string <code>/DIR/</code> in between.\nIn the local window it is possible to see that Excel recognizes the correct string.\nWe use the <code>IfError</code> Function because there won't always be value found.\nThe run error 1004 comes with the worksheetfunction.</p>\n\n<pre><code>    If Cells(3, d) = Cells(c, 33) Then\n        VlookSrc = Cells(c, 48).Value &amp; \"/DIR/\" &amp; Cells(4, d).Value\n       Cells(c, d) = Application.WorksheetFunction.IfError(Application.WorksheetFunction.VLookup(VlookSrc, Range(Cells(5, 308), Cells(105673, 309)), 2, False), 0)\n    Else\n        Cells(c, d) = 0\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1510145508, "post_id": 47180095, "comment_id": 81309244, "body": "Are you able to open the file manually without errors?"}, {"owner": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 1, "creation_date": 1510145591, "post_id": 47180095, "comment_id": 81309295, "body": "<a href=\"https://msdn.microsoft.com/en-gb/library/dk008ty4(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Dir</a> returns a <i>name</i>, not a <i>path</i>!"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1510145740, "post_id": 47180095, "comment_id": 81309384, "body": "@ShrivallabhaRedij yes."}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1510146008, "post_id": 47180095, "comment_id": 81309542, "body": "Why is current working directory such a hard concept?"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 3655, "user_id": 6634373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oLqp9.png?s=128&g=1", "display_name": "CommonSense", "link": "https://stackoverflow.com/users/6634373/commonsense"}, "edited": false, "score": 0, "creation_date": 1510146237, "post_id": 47180095, "comment_id": 81309689, "body": "@CommonSense Test the code. <code>Dir()</code> is bit misleading to me it seems. It is not faulty or incorrect code per se. I just tested code by running in different folders and it runs and picks workbook just fine. Maybe VBA  holds it in memory."}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1510146320, "post_id": 47180095, "comment_id": 81309744, "body": "its working at my end. I think its issue with the file extension. @RafaelOsipov can you pls check the extension of the file"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 2, "last_activity_date": 1510145954, "creation_date": 1510145954, "answer_id": 47180391, "question_id": 47180095, "link": "https://stackoverflow.com/questions/47180095/excel-vba-cant-find-a-xlsx-file-in-the-folder/47180391#47180391", "title": "Excel VBA Can&#39;t Find a xlsx File in The Folder", "body": "<p>Change this</p>\n\n<pre><code>Set UnionWB = Workbooks.Open(sWrkbkPath)\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>Set UnionWB = Workbooks.Open(Thisworkbook.Path &amp; \"\\\" &amp; sWrkbkPath)\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1989, "favorite_count": 0, "accepted_answer_id": 47180391, "answer_count": 1, "score": 0, "last_activity_date": 1510145954, "creation_date": 1510145092, "last_edit_date": 1510145879, "question_id": 47180095, "link": "https://stackoverflow.com/questions/47180095/excel-vba-cant-find-a-xlsx-file-in-the-folder", "title": "Excel VBA Can&#39;t Find a xlsx File in The Folder", "body": "<p>Hi I have a code and it pops up a massage box with </p>\n\n<blockquote>\n  <p>run time error 1004</p>\n</blockquote>\n\n<p>that it can't find the file that I want to open. How can I handle it? I got stuck in it already for hours and I can't find what was going wrong. I want to open an XLSX file that is saved in the same folder with the macro file and they are the only files in the folder, can someone help?</p>\n\n<pre><code>Private Sub cmdStartMonth_Click()\n'Optimize Macro Speed\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n'Analyze month by selecting\nDim myPath As String\nDim FileName As String\nDim UnionWB As Workbook\nDim MonthName As String\nMonthName = ListMonth.Value\nmyExtension = \"*.xlsx*\"\n\n    Dim sWrkbkPath As String\n    sWrkbkPath = Dir$(ThisWorkbook.Path &amp; \"\\*.xlsx\")\n\n    'Only expecting a single file so no need to loop.\n    If sWrkbkPath &lt;&gt; \"\" Then\n        Set UnionWB = Workbooks.Open(sWrkbkPath)\n    End If\n\nUnionWB.Worksheets(\"Union\").Range(\"A1:Y1\").AutoFilter\nWith UnionWB.Worksheets(\"Union\")\n        .Activate\n        .Range(\"L1:W1\").Find(MonthName, , xlValues, xlWhole).Activate\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>that is the problematic row in the code:</p>\n\n<pre><code>  Set UnionWB = Workbooks.Open(sWrkbkPath)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1510144605, "post_id": 47179803, "comment_id": 81308628, "body": "Do you have sheets named &quot;1&quot; and &quot;2&quot;? Do you have Ranges named &quot;DatatoCopy&quot; and &quot;Destination&quot; defined?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1510144750, "post_id": 47179803, "comment_id": 81308736, "body": "Did you make sure that there is an Excel file by the name <code>A.xlsm</code> and another by the name <code>B.xlsm</code> open? Did you make sure that <code>A.xlsm</code> has a sheet named <code>1</code> in it while the other Excel file has a sheet named <code>2</code> in it? Also, please make sure that there is a named range called <code>DataToCopy</code> in <code>A.xlsm</code> on sheet <code>1</code>. Ensure the same for the second named range <code>Destination</code> and also make sure that both ranges have the exact same size (rows and columns)."}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1510144868, "post_id": 47179803, "comment_id": 81308802, "body": "and also that both the sheets where the name ranges are , are active"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 1, "creation_date": 1510145303, "post_id": 47179803, "comment_id": 81309102, "body": "@ApurvPawar - it is neither possible nor necessary for both sheets to be active."}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510145350, "post_id": 47179803, "comment_id": 81309134, "body": "@SJR they are in two different workbooks, active in the sense selected"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 1, "creation_date": 1510145594, "post_id": 47179803, "comment_id": 81309297, "body": "@ApurvPawar - yes fair point about being active but still not necessary."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1510144739, "post_id": 47179846, "comment_id": 81308726, "body": "It&#39;s possible that the OP has sheets named &quot;1&quot; and &quot;2&quot;."}, {"owner": {"reputation": 1, "user_id": 8906665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a27c86a2bebcf8291171c34ecd27002?s=128&d=identicon&r=PG&f=1", "display_name": "user8906665", "link": "https://stackoverflow.com/users/8906665/user8906665"}, "edited": false, "score": 0, "creation_date": 1510145088, "post_id": 47179846, "comment_id": 81308949, "body": "Yes that&#39;s correct the sheets are named &quot;1&quot; and &quot;2&quot; so that is not the issue."}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 1, "creation_date": 1510145132, "post_id": 47179846, "comment_id": 81308989, "body": "just check all the things what Ralph has mentioned, Its working at my end."}], "tags": [], "owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1510144347, "creation_date": 1510144347, "answer_id": 47179846, "question_id": 47179803, "link": "https://stackoverflow.com/questions/47179803/application-defined-or-object-defined-error-when-copying-data-between-excel-work/47179846#47179846", "title": "Application-defined or object-defined error when copying data between excel workbooks", "body": "<p>Just remove the quotes \"\" for Sheets(\"1\") make it like Sheets(1)</p>\n"}], "owner": {"reputation": 1, "user_id": 8906665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a27c86a2bebcf8291171c34ecd27002?s=128&d=identicon&r=PG&f=1", "display_name": "user8906665", "link": "https://stackoverflow.com/users/8906665/user8906665"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510144480, "creation_date": 1510144174, "last_edit_date": 1510144480, "question_id": 47179803, "link": "https://stackoverflow.com/questions/47179803/application-defined-or-object-defined-error-when-copying-data-between-excel-work", "title": "Application-defined or object-defined error when copying data between excel workbooks", "body": "<p>I am trying to copy data between 2 Excel workbooks but I am getting the error:</p>\n\n<blockquote>\n  <p>Run-time error 1004</p>\n  \n  <p>Application-defined or object-defined error</p>\n</blockquote>\n\n<p>I don't understand why. Any help with this?</p>\n\n<hr>\n\n<pre><code>Sub CopyData()\n\nDim xWb As Workbook, xWs As Worksheet\n\nDim yWb As Workbook, yWs As Worksheet\n\nSet xWb = Workbooks(\"A.xlsm\")\n\nSet yWb = Workbooks(\"B.xlsm\")\n\nSet xWs = xWb.Sheets(\"1\")\n\nSet yWs = yWb.Sheets(\"2\")\n\nxWs.Range(\"DatatoCopy\").Value = yWs.Range(\"Destination\").Value\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1510148403, "post_id": 47179747, "comment_id": 81311217, "body": "The result you are getting is simple to explain. <code>F2</code> is not recognized as a column name and thus interpreted as a fix string. Hence, <code>F2</code> is shown in each row: <a href=\"http://sqlfiddle.com/#!6/60785/1/0\" rel=\"nofollow noreferrer\">sqlfiddle.com/#!6/60785/1/0</a> What you essentially want / need is a dynamic SQL statement and thus you have to dynamically create / build <code>strSQL</code> in your VBA. What you want cannot be achieved with a parameterized query."}, {"owner": {"reputation": 3, "user_id": 7703984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e965b893c19978e8c0d1f13a223c0fca?s=128&d=identicon&r=PG&f=1", "display_name": "19830409", "link": "https://stackoverflow.com/users/7703984/19830409"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1510269427, "post_id": 47179747, "comment_id": 81375983, "body": "Thanks! I&#39;ll try the method you suggested."}], "owner": {"reputation": 3, "user_id": 7703984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e965b893c19978e8c0d1f13a223c0fca?s=128&d=identicon&r=PG&f=1", "display_name": "19830409", "link": "https://stackoverflow.com/users/7703984/19830409"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 606, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510144016, "creation_date": 1510144016, "question_id": 47179747, "link": "https://stackoverflow.com/questions/47179747/can-i-use-parameterized-query-when-hdr-no", "title": "Can I use parameterized query when &quot;HDR=No&quot;?", "body": "<p>I'm trying to execute some SQL queries using VBA/ADODB on a Excel Sheet, and I want to put parameters into them.  </p>\n\n<ul>\n<li>I know how to put parameters when there are headers.</li>\n<li>I also know, when \"HDR=No\", column header names are automatically assigned (ex. \"F1\" for the 1st column).</li>\n</ul>\n\n<p>So, I tried to use this assigned name as a parameter value, but something strange happened.</p>\n\n<p>Here is my simplified code (data is on the sheet named \"data\"):</p>\n\n<pre><code>Dim objCn As New ADODB.Connection\nDim cmd As New ADODB.Command\nDim objRs As New ADODB.Recordset\nDim param As ADODB.Parameter\nDim strSQL As String\n\n\nWith objCn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .Properties(\"Extended Properties\") = \"Excel 12.0;HDR=No\"\n    .Open ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name\nEnd With\n\nstrSQL = \"\"\nstrSQL = strSQL &amp; \" SELECT F1, ? FROM [data$]\"\n\nSet cmd.ActiveConnection = objCn\n\nWith cmd\n    .CommandText = strSQL\n    .CommandType = adCmdText\n    .Prepared = True\nEnd With\n\nSet param = New ADODB.Parameter\n\nSet param = cmd.CreateParameter(\"param1\", adVarChar, adParamInput, 10)\ncmd.Parameters.Append param\ncmd.Parameters(\"param1\") = \"F2\"\n\nSet objRs = New ADODB.Recordset\nSet objRs = cmd.Execute\n\nWith ThisWorkbook.Worksheets(\"Sheet1\")\n    .Range(\"A2\").CopyFromRecordset objRs\nEnd With\n\nSet cmd = Nothing\nobjRs.Close: Set objRs = Nothing\nobjCn.Close: Set objCn = Nothing\n</code></pre>\n\n<p>And the result is like this (on \"Sheet1\"):</p>\n\n<pre><code>  |     A     |     B\n1 |           | \n2 | apple     | F2\n3 | banana    | F2\n4 | orange    | F2\n</code></pre>\n\n<p>I didn't get any errors, but as you can see, something happened with column 2 (\"F2\").</p>\n\n<p>So My Question is: Can't I execute parameterized queries using assigned header names?</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1510144239, "post_id": 47179602, "comment_id": 81308363, "body": "You aren&#39;t constructing the filename into your strPath from your recordset, so there is nothing going to import.  You also aren&#39;t declaring what your variables are."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1510144341, "post_id": 47179602, "comment_id": 81308437, "body": "What Minty said, plus <code>acImportDelimi</code> should not have that i at the end. Also, your code doesn&#39;t seem to be wrapped in a sub, and is missing <code>Option Explicit</code>, which you should be using"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1510148168, "post_id": 47179602, "comment_id": 81311068, "body": "What does your code do? Does it break? Where? What error message(s) do you get?"}], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1510155313, "creation_date": 1510155313, "answer_id": 47183725, "question_id": 47179602, "link": "https://stackoverflow.com/questions/47179602/importing-all-files-in-a-folder/47183725#47183725", "title": "Importing all files in a folder", "body": "<p>Loop through the \"FileNames\" recordset and import each file using the <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-transfertext-method-access\" rel=\"nofollow noreferrer\">TransferText</a> method. </p>\n\n<p>Change \"YourTableName\" to the name of the table the files should be imported.</p>\n\n<pre><code>Public Sub ImportFiles()\n    On Error GoTo ErrorTrap\n\n    Const strPath As String = \"C:\\Folder\\\"\n\n    Dim rs As DAO.Recordset\n    Set rs = CurrentDb().OpenRecordset(\"SELECT * FROM FileNames\", dbOpenSnapshot)\n    With rs\n        If .EOF Then GoTo Leave\n        .MoveLast\n        .MoveFirst\n    End With\n\n    Dim idx As Long\n    For idx = 1 To rs.RecordCount\n        DoCmd.TransferText TransferType:=acImportDelim, _\n                           TableName:=\"YourTableName\", _\n                           FileName:=strPath &amp; rs![FileName], _\n                           HasFieldNames:=True\n        rs.MoveNext\n    Next idx\n\nLeave:\n    On Error Resume Next\n        rs.Close\n    Set rs = Nothing\n    On Error GoTo 0\n    Exit Sub\n\nErrorTrap:\n    MsgBox Err.Description, vbCritical\n    Resume Leave\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1510155313, "creation_date": 1510143617, "question_id": 47179602, "link": "https://stackoverflow.com/questions/47179602/importing-all-files-in-a-folder", "title": "Importing all files in a folder", "body": "<p>I need to import over 100 CSV files in to a new access table</p>\n\n<p>I am struggling with the code to be honest any help is appreciated. This is what I have so far:</p>\n\n<pre><code>Option Compare Database\n\nDim sql\nDim rs\n\nConst strPath As String = \"C:\\Folder\\\" 'Directory Path\n\nsql = \"Select * from FileNames\"\n\nSet rs = CurrentDb.OpenRecordset(sql)\n\nrs.MoveFirst\n\nDo Until rs.EOF\n\n'docmd.TransferText rs(\"fileName\")\nDoCmd.TransferText acImportDelimi, , \"FileNames\", strPath, True\n\nrs.MoveNext\n\nLoop\n</code></pre>\n\n<p>I already have a table that has both the filepath and file name in. The format is as such:</p>\n\n<blockquote>\n  <p>C:\\Folder\\File17-08-01.csv</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1510142444, "post_id": 47179153, "comment_id": 81307194, "body": "Your sub has an argument <code>Wb</code> so you must call it from another procedure, e.g. <code>DoTrim(Wb1)</code> where wb1 is a workbook variable declared and assigned in the calling procedure."}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1510160914, "post_id": 47179559, "comment_id": 81320375, "body": "I&#39;d add that an alternative to <code>ThisWorkbook</code> could be <code>ActiveWorkbook</code> which would execute the code on the workbook that&#39;s selected (i.e. on top in the Excel Window) rather than the workbook containing the code."}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 1, "creation_date": 1510167027, "post_id": 47179559, "comment_id": 81324033, "body": "Instead of removing the variable, you could also make it optional and default it to <code>ThisWorkbook</code> or <code>ActiveWorkbook</code> so that you can still call it specifically if you want."}], "tags": [], "owner": {"reputation": 515, "user_id": 2949700, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6Yssn.png?s=128&g=1", "display_name": "Socii", "link": "https://stackoverflow.com/users/2949700/socii"}, "is_accepted": false, "score": 3, "last_activity_date": 1510157391, "last_edit_date": 1510157391, "creation_date": 1510143476, "answer_id": 47179559, "question_id": 47179153, "link": "https://stackoverflow.com/questions/47179153/how-do-i-execute-a-sub-that-doesnt-display-as-a-macro/47179559#47179559", "title": "How do I execute a sub that doesn&#39;t display as a macro?", "body": "<p>The subroutine is expecting a Workbook as a parameter <code>Sub DoTrim(Wb As Workbook)</code>, so you won't be able to run it from the macros window</p>\n\n<p>If the Excel Module is in the same Workbook you want to trim, then you can remove the parameter and use the <code>ThisWorkbook</code> object instead to loop through the Worksheets in the Workbook, as below:</p>\n\n<pre><code>Sub DoTrim()\n    Dim aCell As Range\n    Dim wsh As Worksheet\n\n    '~~&gt; If you are using it in an Add-In, it is advisable \n    '~~&gt; to keep the user posted :)\n    Application.StatusBar = \"Processing Worksheets... Please do not disturb...\"\n    DoEvents\n\n    Application.ScreenUpdating = False\n\n    For Each wsh In ThisWorkbook.Worksheets\n        With wsh\n            Application.StatusBar = \"Processing Worksheet \" &amp; _\n                                    .Name &amp; \". Please do not disturb...\"\n            DoEvents\n\n            For Each aCell In .UsedRange\n                If Not aCell.Value = \"\" And aCell.HasFormula = False Then\n                    With aCell\n                        .Value = Replace(.Value, Chr(160), \"\")\n                        .Value = Application.WorksheetFunction.Clean(.Value)\n                        .Value = Trim(.Value)\n                    End With\n                End If\n            Next aCell\n        End With\n    Next wsh\n\n    Application.ScreenUpdating = True\n    Application.StatusBar = \"Done\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8778257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa96bd5b9c51fd82f09c8e77070446cb?s=128&d=identicon&r=PG&f=1", "display_name": "ChasVA", "link": "https://stackoverflow.com/users/8778257/chasva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510157391, "creation_date": 1510142334, "last_edit_date": 1510143315, "question_id": 47179153, "link": "https://stackoverflow.com/questions/47179153/how-do-i-execute-a-sub-that-doesnt-display-as-a-macro", "title": "How do I execute a sub that doesn&#39;t display as a macro?", "body": "<p>I found an excellent piece of code on this site that I'd like to add to my workbook:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/21015840/trim-all-cells-within-a-workbookvba/21016303#21016303\">Trim all cells within a workbook(VBA)</a></p>\n\n<p>The code there is:</p>\n\n<pre><code>Sub DoTrim(Wb As Workbook)\n    Dim aCell As Range\n    Dim wsh As Worksheet\n\n    '~~&gt; If you are using it in an Add-In, it is advisable \n    '~~&gt; to keep the user posted :)\n    Application.StatusBar = \"Processing Worksheets... Please do not disturb...\"\n    DoEvents\n\n    Application.ScreenUpdating = False\n\n    For Each wsh In Wb.Worksheets\n        With wsh\n            Application.StatusBar = \"Processing Worksheet \" &amp; _\n                                    .Name &amp; \". Please do not disturb...\"\n            DoEvents\n\n            For Each aCell In .UsedRange\n                If Not aCell.Value = \"\" And aCell.HasFormula = False Then\n                    With aCell\n                        .Value = Replace(.Value, Chr(160), \"\")\n                        .Value = Application.WorksheetFunction.Clean(.Value)\n                        .Value = Trim(.Value)\n                    End With\n                End If\n            Next aCell\n        End With\n    Next wsh\n\n    Application.ScreenUpdating = True\n    Application.StatusBar = \"Done\"\nEnd Sub\n</code></pre>\n\n<p>I've tried copying and pasting this into an Excel module, but can't figure out how to execute it. I'm <em>really</em> new at all this, so I apologize in advance if this is a stupid question. I've searched on why the Sub won't show up as a macro, and the best possible answer I've found is that it is because it contains variables? </p>\n\n<p>I realize the original poster was trying to modify an Add-In; I'm just hoping there's a way to invoke this on a workbook.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "excel-formula", "runtime-error", "conditional-formatting", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510141467, "post_id": 47178545, "comment_id": 81306611, "body": "What version of Excel are you using? And how did you find that the error is due to the <code>=And</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8906269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a24f9e3f37fc0e673afac8ea919f04?s=128&d=identicon&r=PG&f=1", "display_name": "Eran Elad", "link": "https://stackoverflow.com/users/8906269/eran-elad"}, "edited": false, "score": 0, "creation_date": 1510150459, "post_id": 47180874, "comment_id": 81312696, "body": "Thanks. You answer gave me a clue to find the problem."}, {"owner": {"reputation": 11, "user_id": 8906269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a24f9e3f37fc0e673afac8ea919f04?s=128&d=identicon&r=PG&f=1", "display_name": "Eran Elad", "link": "https://stackoverflow.com/users/8906269/eran-elad"}, "edited": false, "score": 0, "creation_date": 1510150664, "post_id": 47180874, "comment_id": 81312853, "body": "In my Excel, the arguments in functions should be comma separated. In the other computers, it is semi-colon instead. for example, in my Excel I should write &quot;=AND(Arg1, Arg2)&quot;. In their Excel you should write: &quot;=AND (arg1;arg2)&quot;. I guess it&#39;s a locale issue. So, I want to add a comma or a semi-colon based on the locale. do you know how to ask this condition in the code?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1534188606, "post_id": 47180874, "comment_id": 90613059, "body": "In addition to @Rory &#39;s valid answer, my simple work around to return the <i>local CF formula</i> might be of some interest <a href=\"https://stackoverflow.com/questions/51751330/highlight-series-of-dates-that-met-conditions/51829017#51829017\">Highlight series of dates that met conditions</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1534230367, "post_id": 47180874, "comment_id": 90624599, "body": "@T.M. Isn&#39;t that exactly the same as my suggestion?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1534231713, "post_id": 47180874, "comment_id": 90625293, "body": "My apologies, of course you are right, apparently I missed to study the second line of your answer; nevertheless my example code could be helpful :-) @Rory"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1534232445, "post_id": 47180874, "comment_id": 90625673, "body": "@T.M. Totally agree! Just checking I hadn&#39;t missed something. :)"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 2, "last_activity_date": 1510147381, "creation_date": 1510147381, "answer_id": 47180874, "question_id": 47178545, "link": "https://stackoverflow.com/questions/47178545/excel-vba-conditional-formatting-correct-syntax-for-formula1-argument/47180874#47180874", "title": "Excel VBA conditional formatting - correct syntax for formula1 argument", "body": "<p>Unfortunately, the CF formula has to be coded exactly as it would be entered on the target machine, so is susceptible to language and regional issues between computers. What you can do is have the code enter the formula into a cell, then read back the <code>FormulaLocal</code> property of that cell, and use that in the CF settings.</p>\n"}], "owner": {"reputation": 11, "user_id": 8906269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a24f9e3f37fc0e673afac8ea919f04?s=128&d=identicon&r=PG&f=1", "display_name": "Eran Elad", "link": "https://stackoverflow.com/users/8906269/eran-elad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510155237, "creation_date": 1510140459, "last_edit_date": 1531161705, "question_id": 47178545, "link": "https://stackoverflow.com/questions/47178545/excel-vba-conditional-formatting-correct-syntax-for-formula1-argument", "title": "Excel VBA conditional formatting - correct syntax for formula1 argument", "body": "<p>There is a problem with conditional formatting via Excel VBA run on Excel 2016.\nI have the following simple code:</p>\n\n<pre><code>With targetSheet.Range(\"J:J\")\n        .FormatConditions.Delete\n        .FormatConditions.Add Type:=xlExpression, _\n            Formula1:=\"=AND(ISBLANK($J1), NOT(ISBLANK($A1)), ISBLANK($K1))\"\n        .FormatConditions(1).Interior.ColorIndex = 53\nEnd With\n</code></pre>\n\n<p>(<code>targetSheet</code> is defined elsewhere so no need to worry about it).</p>\n\n<p>This code works great on my computer. There is no run-time error and when I open the conditional formatting popup I see the correct formula as follow:</p>\n\n<pre><code>\"=AND(ISBLANK($J1), NOT(ISBLANK($A1)), ISBLANK($K1))\" \n</code></pre>\n\n<p>(including the quotation marks)</p>\n\n<p>When I send this Excel to other people in the office (All of us have Excel 2016), some of them receive the following error: </p>\n\n<blockquote>\n  <p>\"Run-time error '5': Invalid procedure call or argument.\"</p>\n</blockquote>\n\n<p>After debugging, I found that the Error is because of the <code>=AND</code> operator.</p>\n\n<p>If I remove the <code>=</code> (equal sign) it doesn't fail at run-time, but the conditional formatting functionality is wrong. When I open the conditional formatting popup, it shows:</p>\n\n<pre><code>=\"AND(ISBLANK($J1), NOT(ISBLANK($A1)), ISBLANK($K1))\"\n</code></pre>\n\n<p>What is the correct syntax for <code>Formula1:</code>?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1510140232, "post_id": 47178232, "comment_id": 81305758, "body": "How about <code>ThisWorkbook.Activate</code> at the end of the code?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1510142099, "post_id": 47178232, "comment_id": 81306986, "body": "Are you opening the other workbook with the macro? By default that one will become the <code>ActiveWorkbook</code>. Apart from that this is one of the many reasons to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid activation and selection in VBA</a>"}, {"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1510143617, "post_id": 47178232, "comment_id": 81307925, "body": "I didn&#39;t write the original macro but now have to fix it. Actually the macro opens up three different workbooks but seems to default to the one I don&#39;t want.  In Excel 2010, it opens the first workbook and that one becomes the active workbook which is what I want. I really don&#39;t understand how it could change between Excel 2010 and Excel 2017."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1510145215, "post_id": 47178232, "comment_id": 81309041, "body": "Capture the workbook in a variable (<code>Dim wb as Workbook : Set wb = Workbooks.Open(&quot;somepath\\somefile.xlsx&quot;)</code> and work against that object. Avoid working against <code>ActiveWorkbook</code> alltogether."}], "answers": [{"tags": [], "owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "is_accepted": false, "score": 0, "last_activity_date": 1510309070, "creation_date": 1510309070, "answer_id": 47220451, "question_id": 47178232, "link": "https://stackoverflow.com/questions/47178232/switching-between-workbooks-in-excel-vba/47220451#47220451", "title": "Switching between workbooks in Excel VBA", "body": "<p>I ended up fixing this issue but adding a new button and calling the macro from a button_click method. I have no idea why that worked and assigning the macro to the button didn't.</p>\n"}], "owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1003, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510309070, "creation_date": 1510139538, "last_edit_date": 1510150690, "question_id": 47178232, "link": "https://stackoverflow.com/questions/47178232/switching-between-workbooks-in-excel-vba", "title": "Switching between workbooks in Excel VBA", "body": "<p>For some reason Excel 2016 switches to a different workbook when I run a macro. There is no code that indicates this is happening.\nI've tried to switch the focus back using</p>\n\n<p>Appworkbook.Activate</p>\n\n<p>but it only works if I put a breakpoint there. I've tried sleep as well. It works fine on Excel 2010 and the macro does what it is supposed to do.</p>\n\n<p>Has anyone experienced similar?</p>\n\n<p>*****SOLUTION (Not ideal!)*****</p>\n\n<p>I ended up fixing this issue but adding a new button and calling the macro from a button_click method. I have no idea wy that worked and assigning the macro to the button didn't.</p>\n"}, {"tags": ["vba", "excel", "dynamic", "charts"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8614813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a38568893728d823cb9c76457d1bc31?s=128&d=identicon&r=PG&f=1", "display_name": "Braitaq", "link": "https://stackoverflow.com/users/8614813/braitaq"}, "edited": false, "score": 1, "creation_date": 1510142455, "post_id": 47178845, "comment_id": 81307204, "body": "Hi SJR, Thank you for the reply, the code works with your additions and thank you for explaining why exactly it failed."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1510141412, "creation_date": 1510141412, "answer_id": 47178845, "question_id": 47178193, "link": "https://stackoverflow.com/questions/47178193/vba-code-to-create-piechart-with-dymanic-datasource/47178845#47178845", "title": "VBA code to create Piechart with dymanic datasource", "body": "<p>Probably common mistake in that you are not fully qualifying all Range/Cells references with a sheet. When you add the chart sheet, Sheet1 is no longer active, and the code is then trying to access cells on a chart sheet which is never going to end happily. Note the dots in front of both Cells below.</p>\n\n<pre><code>Charts.Add\nActiveChart.ChartType = xlPie\nWith Sheets(\"Sheet1\")\n    ActiveChart.SetSourceData Source:=.Range(.Cells(2, x + 2), .Cells(1 + y, x + 2)), PlotBy:= _\nxlColumns\nEnd With\nActiveChart.Location Where:=xlLocationAsObject, Name:=\"Market Simulator\"\nActiveChart.HasTitle = False\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8614813, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a38568893728d823cb9c76457d1bc31?s=128&d=identicon&r=PG&f=1", "display_name": "Braitaq", "link": "https://stackoverflow.com/users/8614813/braitaq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1364, "favorite_count": 0, "accepted_answer_id": 47178845, "answer_count": 1, "score": 0, "last_activity_date": 1510141412, "creation_date": 1510139425, "question_id": 47178193, "link": "https://stackoverflow.com/questions/47178193/vba-code-to-create-piechart-with-dymanic-datasource", "title": "VBA code to create Piechart with dymanic datasource", "body": "<p>As a final step in a sub() in VBA i have tried to write a code to create a pie chart over the subs resulting data, however I'm having trouble defining the data-source as the column location of the data, and number of rows vary.\nHere is the current code.</p>\n\n<pre><code>'Create Pie chart\n\nCharts.Add\nActiveChart.ChartType = xlPie\nActiveChart.SetSourceData Source:=Sheets(\"Sheet1\").Range(Cells(2, X + 2), Cells(1 + Y, X + 2)), PlotBy:= _\nxlColumns\nActiveChart.Location Where:=xlLocationAsObject, Name:=\"Market Simulator\"\nActiveChart.HasTitle = False\n</code></pre>\n\n<p>X and Y is populated earlier in the code, X tells how many columns the chart source data have been shifted to the right, and Y tells how many rows long the datasource is (excluding header).</p>\n\n<p>When i try and run the sub I get an \"method cells of object _global failed\" Error, from searching online it seems this is triggered because the data source location isn't specific enough, but I'm not sure how it can be more specific as both sheet and cells are defined. I tried also adding workbook but it didn't help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1510139113, "post_id": 47177975, "comment_id": 81304982, "body": "By changing the button&#39;s picture perhaps?"}, {"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1510139560, "post_id": 47177975, "comment_id": 81305283, "body": "@KostasK. the pictures are coming from windows library <code>imagemso</code>. not sure how I can add my own pictures."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1510144449, "post_id": 47177975, "comment_id": 81308516, "body": "Yes you can. You have two options a) imageMso (built-in) or custom picture. Plenty of examples on the net but see this to get you started: <a href=\"https://www.rondebruin.nl/win/s2/win009.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s2/win009.htm</a>"}, {"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1510150492, "post_id": 47177975, "comment_id": 81312721, "body": "Can&#39;t get this working. Please see my edited post."}], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 0, "creation_date": 1510139572, "post_id": 47178067, "comment_id": 81305292, "body": "the icons are coming from windows library <code>imagemso</code>. not sure how I can add my own icons."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 0, "creation_date": 1510139662, "post_id": 47178067, "comment_id": 81305357, "body": "@peetman - google <b>how to add own icons in excel ribbon</b>. Or read this - <a href=\"https://www.rondebruin.nl/win/s2/win009.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s2/win009.htm</a>"}, {"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 0, "creation_date": 1510140492, "post_id": 47178067, "comment_id": 81305945, "body": "cheers, but the examples I find are using CustomUI Editor which I don&#39;t have due to company restrictions."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 0, "creation_date": 1510140577, "post_id": 47178067, "comment_id": 81306006, "body": "@peetman - the CustomUI Editor is a good tool indeed, but you can go around it - you only need a text editor like Notepad and knowledge what to write there."}, {"owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "edited": false, "score": 0, "creation_date": 1510150474, "post_id": 47178067, "comment_id": 81312710, "body": "I&#39;ve tried some code but it&#39;s not working. Please see my edited post."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1510139080, "creation_date": 1510139080, "answer_id": 47178067, "question_id": 47177975, "link": "https://stackoverflow.com/questions/47177975/add-notification-to-custom-ribbon-button-excel/47178067#47178067", "title": "Add notification to custom ribbon button excel", "body": "<p>The easiest way is simply to rebuild the ribbon every time you have a notification, by changing the icon correspondingly.</p>\n\n<p>A drawback will be that you will need quite a few icons, if you want to see the exact number of the notifications as well.</p>\n"}], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1510150454, "creation_date": 1510138843, "last_edit_date": 1531164843, "question_id": 47177975, "link": "https://stackoverflow.com/questions/47177975/add-notification-to-custom-ribbon-button-excel", "title": "Add notification to custom ribbon button excel", "body": "<p>I have developed a custom tab in Excel using XML. Is there a way to add notifications to the buttons?</p>\n\n<p><strong>Actual:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/1iafG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1iafG.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Request:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Y2oQI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y2oQI.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>Edit:</em></p>\n\n<p><strong>I've tried the following:</strong></p>\n\n<pre><code>    ribbonXml = ribbonXml + \"&lt;mso:button id=\"\"newProjectPN\"\" enabled=\"\"true\"\" label=\"\"Presentation Meeting (NOK)\"\" image=\"\"GetImage\"\" size=\"\"large\"\" onAction=\"\"newProjectPN\"\" visible=\"\"true\"\" /&gt;\"\n\n Public Sub GetImage(ByVal control As Office.IRibbonControl, ByRef image)\n     Set image = LoadPicture(\"C:\\Users\\peet\\Desktop\\teste.png\")\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1510138691, "post_id": 47177785, "comment_id": 81304695, "body": "@danieltakeshi - in this case, row 1 will be still deleted by <code>Columns(iCounter).Delete</code> ."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1510138806, "post_id": 47177785, "comment_id": 81304769, "body": "Yes, now I think I understood his question (still a little confused). Because i was reading the <a href=\"https://stackoverflow.com/questions/47162391/delete-blank-rows-from-column-b\">other question</a>, which i wondered he was trying to fix that code. But it is completely different."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1510139524, "post_id": 47177785, "comment_id": 81305255, "body": "Why not Application.CountA(Columns(iCounter).EntireColumn) = 1"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "edited": false, "score": 0, "creation_date": 1510139622, "post_id": 47177911, "comment_id": 81305326, "body": "@James - select the correct sheet and run it again."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1510138648, "creation_date": 1510138648, "answer_id": 47177911, "question_id": 47177785, "link": "https://stackoverflow.com/questions/47177785/delete-blank-columns-starting-at-row-2/47177911#47177911", "title": "Delete Blank Columns starting at Row 2", "body": "<p>You need to <code>Clear</code> and not to <code>Delete</code>, if you want to start from Row 2. \nThis is a way to go around it:</p>\n\n<pre><code>If Application.CountA(Columns(iCounter).EntireColumn) = 0 Then\n    Range(Cells(2, iCounter), Cells(2 ^ 16, iCounter)).Clear\nEnd If\n</code></pre>\n\n<p>It will clear the ranges from row 2 to row 65536. Probably it will work the way you want it.</p>\n"}, {"tags": [], "owner": {"reputation": 1040, "user_id": 558328, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/l9Uo9.jpg?s=128&g=1", "display_name": "real_yggdrasil", "link": "https://stackoverflow.com/users/558328/real-yggdrasil"}, "is_accepted": false, "score": 0, "last_activity_date": 1510138661, "creation_date": 1510138661, "answer_id": 47177915, "question_id": 47177785, "link": "https://stackoverflow.com/questions/47177785/delete-blank-columns-starting-at-row-2/47177915#47177915", "title": "Delete Blank Columns starting at Row 2", "body": "<p>The VBA below deletes a column in your sheet if it is empty:</p>\n\n<pre><code>Sub DeleteEmptyColumns()\n  'Updateby20140317\n  Dim rng As Range\n  Dim InputRng As Range\n  xTitleId = \"KutoolsforExcel\"\n  Set InputRng = Application.Selection\n  Set InputRng = Application.InputBox(\"Range :\", xTitleId, InputRng.Address, Type:=8)\n  Application.ScreenUpdating = False\n  For i = InputRng.Columns.Count To 1 Step -1\n      Set rng = InputRng.Cells(1, i).EntireColumn\n      If Application.WorksheetFunction.CountA(rng) = 0 Then\n        rng.Delete\n    End If\n  Next\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1510139745, "creation_date": 1510139745, "answer_id": 47178310, "question_id": 47177785, "link": "https://stackoverflow.com/questions/47177785/delete-blank-columns-starting-at-row-2/47178310#47178310", "title": "Delete Blank Columns starting at Row 2", "body": "<p>If I got you right you would like to see if the column starting with row 2 is empty and if yes, yoo would like to delete the column. If you have a header in every column your code only needs a small correction</p>\n\n<pre><code>Sub Delete_Cols()\n    Dim MyRange As Range\n    Dim iCounter As Long\n    Set MyRange = ActiveSheet.UsedRange\n    For iCounter = MyRange.Columns.Count To 1 Step -1\n        If Application.CountA(Columns(iCounter).EntireColumn) = 1 Then\n            Columns(iCounter).Delete\n        End If\n    Next iCounter\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 481, "user_id": 4678346, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6845c5e542113332da5214c2bd77b7df?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/4678346/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 47178310, "answer_count": 3, "score": 0, "last_activity_date": 1602437259, "creation_date": 1510138303, "last_edit_date": 1531164843, "question_id": 47177785, "link": "https://stackoverflow.com/questions/47177785/delete-blank-columns-starting-at-row-2", "title": "Delete Blank Columns starting at Row 2", "body": "<p>I am trying to delete blank columns in the worksheet from <strong>Row 2</strong> . If the whole column is blank i want to delete the column. </p>\n\n<p>The reason i am starting from row 2 is because i have headers in row 1. Subsequently these will also be deleted if that column is blank.  How do i start from row 2?</p>\n\n<pre><code>Sub Delete_Cols()\n Dim MyRange As Range\n    Dim iCounter As Long\n    Set MyRange = ActiveSheet.UsedRange\n    For iCounter = MyRange.Columns.Count To 1 Step -1\n       If Application.CountA(Columns(iCounter).EntireColumn) = 0 Then\n       Columns(iCounter).Delete\n       End If\n    Next iCounter\nEnd Sub\n</code></pre>\n\n<p>I need the macro to start checking for blank columns from row 2. </p>\n"}, {"tags": ["mysql", "excel", "vba", "ado"], "answers": [{"tags": [], "owner": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "is_accepted": false, "score": 0, "last_activity_date": 1510142095, "creation_date": 1510142095, "answer_id": 47179073, "question_id": 47177442, "link": "https://stackoverflow.com/questions/47177442/apply-sql-query-condition-to-multiple-columns-in-vba/47179073#47179073", "title": "Apply SQL query condition to multiple columns in VBA", "body": "<p>Do you mean something like this?</p>\n\n<pre><code>Public Sub test()\nDim sql_string As String\nDim sheet_name As String\n\n    sheet_name = \"Sheet5$\"\n\n    sql_string = \"Select \"\n    sql_string = sql_string &amp; GetField(sheet_name, \"num\") &amp; \",\"\n    sql_string = sql_string &amp; GetField(sheet_name, \"num1\") &amp; \",\"\n    sql_string = sql_string &amp; GetField(sheet_name, \"num2\") &amp; \",\"\n    sql_string = sql_string &amp; GetField(sheet_name, \"num3\")\n    sql_string = sql_string &amp; \" from [\" &amp; sheet_name &amp; \"]\"\n\n    Debug.Print sql_string\n\nEnd Sub\n\nPublic Function GetField(ByVal sheet_name As String, ByVal fieldName As String)\n\n    GetField = \"[\" &amp; sheet_name &amp; \"].[\" &amp; fieldName &amp; \"] * IIf(([\" &amp; sheet_name &amp; \"].[to] - [\" &amp; sheet_name &amp; \"].[frm]) &lt; 365, 0.4, IIf(([\" &amp; sheet_name &amp; \"].[to] - [\" &amp; sheet_name &amp; \"].[frm]) &gt; 365, 1, 0))\"\n\nEnd Function\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Select [Sheet5$].[num] * IIf(([Sheet5$].[to] - [Sheet5$].[frm]) &lt; 365, 0.4, IIf(([Sheet5$].[to] - [Sheet5$].[frm]) &gt; 365, 1, 0)),\n    [Sheet5$].[num1] * IIf(([Sheet5$].[to] - [Sheet5$].[frm]) &lt; 365, 0.4, IIf(([Sheet5$].[to] - [Sheet5$].[frm]) &gt; 365, 1, 0)),\n    [Sheet5$].[num2] * IIf(([Sheet5$].[to] - [Sheet5$].[frm]) &lt; 365, 0.4, IIf(([Sheet5$].[to] - [Sheet5$].[frm]) &gt; 365, 1, 0)),\n    [Sheet5$].[num3] * IIf(([Sheet5$].[to] - [Sheet5$].[frm]) &lt; 365, 0.4, IIf(([Sheet5$].[to] - [Sheet5$].[frm]) &gt; 365, 1, 0)) from [Sheet5$]\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 327, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510142095, "creation_date": 1510137433, "question_id": 47177442, "link": "https://stackoverflow.com/questions/47177442/apply-sql-query-condition-to-multiple-columns-in-vba", "title": "Apply SQL query condition to multiple columns in VBA", "body": "<p>Please find my below sample table,where i have applying if condition for multiplying Numerical data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/o1fhk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o1fhk.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Query Code</strong></p>\n\n<pre><code>sql_string = \"Select [Sheet5$].[num] * IIf(([Sheet5$].[to]-[Sheet5$].[frm])&lt;365, .4,\" &amp; _\n\"IIf(([Sheet5$].[to]-[Sheet5$].[frm])&gt;365, 1, 0)) from [Sheet5$]\"\n</code></pre>\n\n<p>Above code will help me out to apply the condition on one column <strong>i.e num</strong> only.But i want to apply it on multiple columns around 20-30 columns which is available in my actual data.it is possible to mention column names but it is  not possible to write the above <strong>if condition</strong> to each column. please guide me on the same.</p>\n"}, {"tags": ["excel", "vba", "collections", "runtime"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1510137237, "creation_date": 1510137237, "answer_id": 47177383, "question_id": 47177292, "link": "https://stackoverflow.com/questions/47177292/vba-collections-read-values-into-collection-from-static-range/47177383#47177383", "title": "VBA collections - Read values into collection from static range", "body": "<p>Voila:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    'Dim collLX0358  As New Collection - you are not using it, -&gt; you do not need it.\n    Dim ISINsLX0358 As Range\n\n    Dim isin        As Range\n    Dim coll        As New Collection\n    'Set collLX0358 = Nothing - WHY?\n\n    Set ISINsLX0358 = ThisWorkbook.Sheets(1).Range(\"B3:BK3\")\n\n    For Each isin In ISINsLX0358\n        If isin &lt;&gt; \"\" Then\n            coll.Add isin\n        End If\n    Next isin\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<ul>\n<li>Start using <code>Option Explicit</code></li>\n<li>What is the idea of <code>Set colLX0358 = Nothing</code>. As far as you are not using it, remove it from the code.</li>\n<li><code>Range</code> is an object in VBA and it should be used with the word <code>Set</code></li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 8708373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3f176c3ba5e87863a9e890da170ac18?s=128&d=identicon&r=PG&f=1", "display_name": "s00zie", "link": "https://stackoverflow.com/users/8708373/s00zie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1467, "favorite_count": 0, "accepted_answer_id": 47177383, "answer_count": 1, "score": 2, "last_activity_date": 1510137305, "creation_date": 1510137004, "last_edit_date": 1510137305, "question_id": 47177292, "link": "https://stackoverflow.com/questions/47177292/vba-collections-read-values-into-collection-from-static-range", "title": "VBA collections - Read values into collection from static range", "body": "<p>I'm trying to get a range of values into a new collection. Range is fixed, empty cells are supposed to be skipped, cells with content added to the collection. However, I get an error saying </p>\n\n<blockquote>\n  <p>\"Object variable or With block variable not set\" </p>\n</blockquote>\n\n<p>on the line </p>\n\n<pre><code>\"ISINsLX0358 = ThisWorkbook.Sheets(\"Splits_Vormonat\").Range(\"B3:BK3\")\"\n</code></pre>\n\n<p>Can somebody tell me why this is happening and help me improve my code?</p>\n\n<pre><code>Dim collLX0358 As New Collection\nDim ISINsLX0358 As Range\n\nSet collLX0358 = Nothing\n\nISINsLX0358 = ThisWorkbook.Sheets(\"Splits_Vormonat\").Range(\"B3:BK3\")\n\nFor Each isin In ISINsLX0358\n    If isin &lt;&gt; \"\" Then\n        coll.Add isin\n    End If\nNext isin\n</code></pre>\n"}, {"tags": ["excel", "vba", "sap"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 8868435, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9ed908192b768962a03c86298850c8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Sidvi", "link": "https://stackoverflow.com/users/8868435/sidvi"}, "edited": false, "score": 0, "creation_date": 1510144326, "post_id": 47179650, "comment_id": 81308428, "body": "I have rewritten it to look like your suggestion but my code still fail to insert the values into excel. ive put the rewritten code into the question."}, {"owner": {"reputation": 91, "user_id": 8868435, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9ed908192b768962a03c86298850c8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Sidvi", "link": "https://stackoverflow.com/users/8868435/sidvi"}, "edited": false, "score": 0, "creation_date": 1510145083, "post_id": 47179650, "comment_id": 81308945, "body": "Forgot to change a variable, it works fantastic! THANK YOU!"}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": true, "score": 4, "last_activity_date": 1510143734, "creation_date": 1510143734, "answer_id": 47179650, "question_id": 47177189, "link": "https://stackoverflow.com/questions/47177189/getting-specific-cell-data-from-sap-to-excel/47179650#47179650", "title": "Getting specific cell data from SAP to excel", "body": "<p>I solve such issues as follows.</p>\n\n<ol>\n<li><p>First, I record a help script. In doing so, the relevant columns of the grid are marked one after the other, and e.g. sorted in ascending order. After treating all interested columns in this way, you can discover all column names in the recorded script.</p></li>\n<li><p>The help script should look something like this:</p>\n\n<p><code>. . .\nsession.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").currentCellColumn = \"GLOBALTRANSFER_KONWA\"\nsession.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").selectColumn \"GLOBALTRANSFER_KONWA\"\nsession.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").pressToolbarButton \"&amp;SORT_ASC\"\n</code> </p></li>\n<li><p>In the correct script is then e.g. following:</p>\n\n<p><code>. . .\nsession.findById(\"wnd[0]\").maximize\nsession.findById(\"wnd[0]/tbar[0]/okcd\").text = \"/nymm_pricelist\"\nsession.findById(\"wnd[0]\").sendVKey 0\nsession.findById(\"wnd[0]/usr/ctxtS_MATNR-LOW\").text = Cells(currentline, 1).Value\nsession.findById(\"wnd[0]/usr/ctxtS_VKORG-LOW\").text = Cells(currentline, 4).Value\nsession.findById(\"wnd[0]/usr/ctxtS_VKORG-LOW\").setFocus\nsession.findById(\"wnd[0]/usr/ctxtS_VKORG-LOW\").caretPosition = 4\nsession.findById(\"wnd[0]\").sendVKey 8\nset myGrid = session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\")\n'myPar_1 = myGrid.getcellvalue (0 , \"X\")\n'myPar_2 = myGrid.getcellvalue (0 , \"Y\")\n'myPar_3 = myGrid.getcellvalue (0 , \"Z\")\n'myPar_4 = myGrid.getcellvalue (0 , \"U\")\n'myPar_5 = myGrid.getcellvalue (0 , \"V\")\nmyPar_6 = myGrid.getcellvalue (0 , \"GLOBALTRANSFER_KONWA\")\n</code></p></li>\n</ol>\n\n<p>For character strings X - V, valid column names are to be used.</p>\n\n<p>Regards,\nScriptMan</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12417488, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5wmpKaWvRaE/AAAAAAAAAAI/AAAAAAAAASo/VU3TjsV_5LM/photo.jpg?sz=128", "display_name": "Pedro Martinez", "link": "https://stackoverflow.com/users/12417488/pedro-martinez"}, "is_accepted": false, "score": 0, "last_activity_date": 1585242626, "last_edit_date": 1585242626, "creation_date": 1585242248, "answer_id": 60872438, "question_id": 47177189, "link": "https://stackoverflow.com/questions/47177189/getting-specific-cell-data-from-sap-to-excel/60872438#60872438", "title": "Getting specific cell data from SAP to excel", "body": "<p>Script man answer works great. For the beginners like me who didn't grasp it at first:</p>\n\n<p>You can create a variable that stores the text by specifying the text location in SAP. Example:</p>\n\n<pre><code>value = session.FindById(\"wnd[0]/usr/tblSAPL/ctxtAFVGD[4,0]\").Text\n</code></pre>\n\n<p>This saves SAP text to the value variable.</p>\n\n<p>In plain English: </p>\n\n<pre><code>value =  session.FindById(\"wnd[0]/usr/TableElement/CellElement[x,y]\").Text\n\n' where \n' value stores the text \n' x is column number\n' y is row number\n' TableElement and CellElement are found by recording\n' a SAP script and clicking around on the table to figure out\n' how the elements are named\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 8868435, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9ed908192b768962a03c86298850c8fa?s=128&d=identicon&r=PG&f=1", "display_name": "Sidvi", "link": "https://stackoverflow.com/users/8868435/sidvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10069, "favorite_count": 0, "accepted_answer_id": 47179650, "answer_count": 2, "score": 0, "last_activity_date": 1590419402, "creation_date": 1510136697, "last_edit_date": 1590419402, "question_id": 47177189, "link": "https://stackoverflow.com/questions/47177189/getting-specific-cell-data-from-sap-to-excel", "title": "Getting specific cell data from SAP to excel", "body": "<p>I am trying to get data from specific cells in a row in SAP, into an excel table using VBA. When I record a macro of me clicking the 5-6 items I need, it only gives me that I clicked one. Further more I cannot see any way to get the data from the cells, into SAP. The SAP code is here:</p>\n\n<pre><code>Dim W_Ret As Boolean\n\nW_Ret = Attach_Session\nIf Not W_Ret Then\n    Exit Sub\nEnd If\n\nstartrow = 10\n\nOn Error GoTo myerr\n\nobjSess.findById(\"wnd[0]\").maximize\nobjSess.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nymm_pricelist\"\nobjSess.findById(\"wnd[0]\").sendVKey 0\nobjSess.findById(\"wnd[0]/usr/ctxtS_MATNR-LOW\").Text = Cells(currentline, 1).Value\nobjSess.findById(\"wnd[0]/usr/ctxtS_VKORG-LOW\").Text = Cells(currentline, 4).Value\nobjSess.findById(\"wnd[0]/usr/ctxtS_VKORG-LOW\").SetFocus\nobjSess.findById(\"wnd[0]/usr/ctxtS_VKORG-LOW\").caretPosition = 4\nobjSess.findById(\"wnd[0]\").sendVKey 8\nSet myGrid = session.findById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\")\nCells(currentline, 5).Value = myGrid.GetCellValue(0, \"MAKTX\")\nCells(currentline, 6).Value = myGrid.GetCellValue(0, \"GLOBALSALES_KBETR\")\nCells(currentline, 7).Value = myGrid.GetCellValue(0, \"GLOBALSALES_KONWA\")\nCells(currentline, 8).Value = myGrid.GetCellValue(0, \"GLOBALTRANSFER_KBETR\")\nCells(currentline, 9).Value = myGrid.GetCellValue(0, \"GLOBALTRANSFER_KONWA\")\n\n\n' Setting the line status to completed\nCells(currentline, 2).Value = 1\nExit Sub\n\nmyerr:\n' Some error occured\n' Setting the line status to Failed\nCells(currentline, 2).Value = 2\n</code></pre>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["excel", "vba", "powerquery"], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 0, "last_activity_date": 1510148345, "last_edit_date": 1510148345, "creation_date": 1510139071, "answer_id": 47178062, "question_id": 47177169, "link": "https://stackoverflow.com/questions/47177169/excel-powerquery-get-data-from-model/47178062#47178062", "title": "Excel Powerquery - Get data from Model", "body": "<p>You may try something like this to set the connection...</p>\n\n<pre><code>Dim conn As WorkbookConnection\nDim cn As WorkbookConnection\n\nFor Each cn In ThisWorkbook.Connections\n    If cn.Name = \"ThisWorkbookDataModel\" Then\n        Set conn = cn\n        Exit For\n    End If\nNext cn\n</code></pre>\n\n<p>OR simply this..</p>\n\n<pre><code>Set Conn = ThisWorkbook.Connections(\"ThisWorkbookDataModel\")\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 568121, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1df057fea0293c9ba79b14739aac52e6?s=128&d=identicon&r=PG", "display_name": "Maurizio", "link": "https://stackoverflow.com/users/568121/maurizio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510148345, "creation_date": 1510136641, "question_id": 47177169, "link": "https://stackoverflow.com/questions/47177169/excel-powerquery-get-data-from-model", "title": "Excel Powerquery - Get data from Model", "body": "<p>Very simply...\n- I created a query using Excel PowerQuery and loading data ONLY as connection, not in a Sheet, and adding to Datamodel.</p>\n\n<p>I would like now via VBA to query the data, selecting a value in the model with a simple WHERE clause.</p>\n\n<p>I tried using <code>ActiveWorkbook.Connections</code> and so on, unsuccessfully (references to Activex Data Object is set). What should be the way? This is the code I am testing:</p>\n\n<pre><code>Public Sub SelectPQData()\nDim conn As Connection\nDim sheet As Excel.Worksheet\n\nOn Error GoTo MyFail\n\nSet conn = ActiveWorkbook.Connections.Item(1).ModelConnection\n</code></pre>\n\n<p>error is application or model defined...</p>\n\n<p>thanks</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1510148222, "creation_date": 1510148222, "answer_id": 47181160, "question_id": 47177006, "link": "https://stackoverflow.com/questions/47177006/changing-a-part-of-formula-from-relative-reference-to-absolute-reference/47181160#47181160", "title": "Changing a part of formula from relative reference to absolute reference", "body": "<p>As far as I can understand, your issue is to lock first argument of the MATCH function and simultaneously update it when filling down, am I right? If so, you could just fill down unlocked version of formula and then add dollar signs using Replace. See below:</p>\n\n<pre><code>Dim rng As Range\nDim cl As Range\n\nSet rng = \"define your range here\"\nFor Each cl In rng\n    cl.Formula = Replace(cl.Formula, \"MATCH(A\" &amp; cl.Row, \"MATCH($A$\" &amp; cl.Row)\nNext cl \n</code></pre>\n\n<p>Is this what you were looking for?</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8909964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df420517363b09ff99c2070fdcab962?s=128&d=identicon&r=PG", "display_name": "freeflyz", "link": "https://stackoverflow.com/users/8909964/freeflyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1510248563, "last_edit_date": 1510248563, "creation_date": 1510178811, "answer_id": 47190513, "question_id": 47177006, "link": "https://stackoverflow.com/questions/47177006/changing-a-part-of-formula-from-relative-reference-to-absolute-reference/47190513#47190513", "title": "Changing a part of formula from relative reference to absolute reference", "body": "<p>Try assigning cells in your formula to variables. When you bring the variables into formulas use the <a href=\"https://msdn.microsoft.com/en-us/library/bb213510(v=office.12).aspx\" rel=\"nofollow noreferrer\">.address</a> or <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-addresslocal-property-excel\" rel=\"nofollow noreferrer\">.addresslocal</a> properties to freeze or keep relative references.</p>\n\n<pre><code>Dim MyMatch as range\nSet MyMatch = range(\"a2\")\n\nrange(\"m2\").formula = \u201cINDEX(Sheet2!C:C,MATCH(\u201d &amp; MyMatch.Address &amp; \u201c,Sheet2!A:A,0))\u201d\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "is_accepted": false, "score": 0, "last_activity_date": 1511023766, "creation_date": 1511023766, "answer_id": 47368561, "question_id": 47177006, "link": "https://stackoverflow.com/questions/47177006/changing-a-part-of-formula-from-relative-reference-to-absolute-reference/47368561#47368561", "title": "Changing a part of formula from relative reference to absolute reference", "body": "<p>I would like to thank you both for your answer. \nBoth your methods worked, however due to large number of rows, the macro took a long time to run.\nIn the end, I shortened this and achieved my desired result with the following macro:</p>\n\n<pre><code>Range(\"A1\").Select\nActiveWindow.DisplayFormulas = True\nCells.Select\nSelection.Replace What:=\"Sheet1!B\", Replacement:=\"Sheet1!$B\", LookAt:=xlPart _\n    , SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nActiveWindow.DisplayFormulas = False\n</code></pre>\n\n<p>Nevertheless, thank you for your time.</p>\n"}], "owner": {"reputation": 601, "user_id": 7959614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f104f49cd87068e81f128afbda86a637?s=128&d=identicon&r=PG&f=1", "display_name": "HJA24", "link": "https://stackoverflow.com/users/7959614/hja24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 448, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1511023766, "creation_date": 1510136264, "last_edit_date": 1510144366, "question_id": 47177006, "link": "https://stackoverflow.com/questions/47177006/changing-a-part-of-formula-from-relative-reference-to-absolute-reference", "title": "Changing a part of formula from relative reference to absolute reference", "body": "<p>I am struggling with a cell reference problem. I have the following formula in cell B2:</p>\n\n<pre><code>=INDEX(Sheet2!C:C,MATCH(A2,Sheet2!A:A,0))\n</code></pre>\n\n<p>Next, I use the autofill-function to make sure that all the cells until the last row have this formula. In column C I have static / hard values which are \"leading\". I need to sort the values in column C on largest to smallest. If I do this, the formula move across the spreadsheet.\nFor example, the new formula in cell B2 is:</p>\n\n<p><code>=INDEX(Sheet2!C:C,MATCH(A210,Sheet2!A:A,0))</code></p>\n\n<p>So, ideally I want to make sure that <code>MATCH(A2)</code> is transformed into <code>MATCH($A$2)</code> and the formula in row 3 is:</p>\n\n<p><code>=INDEX(Sheet2!C:C,MATCH(A3,Sheet2!A:A,0))</code></p>\n\n<p>However, I use the following VBA-module to create the formula:</p>\n\n<pre><code>Range(\"B2\").Select\nWith Range(\"B2\")\n    .Formula = \"=INDEX(Sheet2!C:C,MATCH(A2,Sheet2!A:A,0))\"\n    .AutoFill Destination:=Range(\"B2:B\" &amp; LastRow)\nEnd With\n</code></pre>\n\n<p>This makes it impossible to use the locked <code>$A$2</code> from the start.</p>\n\n<p>I am aware of the following function: </p>\n\n<pre><code>Application.ConvertFormula(Formula:=oRange.Formula, fromreferencestyle:=Application.ReferenceStyle, toabsolute:=xlAbsolute)\n</code></pre>\n\n<p>However, I am struggling with how to insert this function into my macro. If I use the following macro: </p>\n\n<pre><code>Range(\"M2\").Select\nWith Range(\"M2\")\n    .Formula = \"=INDEX(Sheet2!C:C,MATCH(A2,Sheet2!A:A,0))\"\n    .AutoFill Destination:=Range(\"M2:M\" &amp; LastRow)\nEnd With                                                         \nRange(\"M2:M\" &amp; LastRow).Formula = Application.ConvertFormula(Formula:=\"=INDEX(Sheet2!C:C,MATCH(A2,Sheet2!A:A,0))\", fromreferencestyle:=Application.ReferenceStyle, toabsolute:=xlAbsolute)\n</code></pre>\n\n<p>I get in each row the following formula:</p>\n\n<pre><code> =INDEX(Sheet2!$C:$C,MATCH($A$2,Sheet2!$A:$A,0))\n</code></pre>\n\n<p>I appreciate the help!</p>\n"}, {"tags": ["vba", "excel", "loops", "merge"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6331891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb9ba134d03b28c278d2db8e07bd871?s=128&d=identicon&r=PG&f=1", "display_name": "BitteB", "link": "https://stackoverflow.com/users/6331891/bitteb"}, "edited": false, "score": 0, "creation_date": 1510140826, "post_id": 47178295, "comment_id": 81306167, "body": "Thank you so much. I almost managed to figure it out myself before I read your response, but your answer helped me solve the rest :D"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 35, "user_id": 6331891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb9ba134d03b28c278d2db8e07bd871?s=128&d=identicon&r=PG&f=1", "display_name": "BitteB", "link": "https://stackoverflow.com/users/6331891/bitteb"}, "edited": false, "score": 0, "creation_date": 1510147563, "post_id": 47178295, "comment_id": 81310643, "body": "Glad I could help."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 0, "last_activity_date": 1510139699, "creation_date": 1510139699, "answer_id": 47178295, "question_id": 47176817, "link": "https://stackoverflow.com/questions/47176817/copy-non-merged-cells-from-one-worksheet-to-merged-cells-in-another-using-a-loop/47178295#47178295", "title": "Copy non-merged cells from one worksheet to merged cells in another using a loop", "body": "<p>You could make use of the offset method to fill the value in the next column when you have a merged column. Something like:</p>\n\n<pre><code>Dim omk as Worksheet, ws As Worksheet\nDim a as Integer, b As Integer, i As Integer\nDim y As Integer, z As Integer, Coloffset As Integer\nDim x As Range, cell As Range\n\nSet omk = Sheets(\"Omkostningsmodel\")\nSet ws = ActiveSheet\n\nomk.Activate\n\na = 173\ni = 187\n\nFor Each cell In Range(\"C187\", \"C206\")\n    z = 3\n    b = 3\n    Coloffset = 0\n    For Each x In Range(Cells(i, z), Cells(i, 22))\n        If x.Column = 4 Or x.Column = 13 Or x.Column = 16 Then\n            Coloffset = Coloffset + 1\n        End If\n\n        x.Offset(0, Coloffset).Value = ws.Cells(a, b)\n\n        b = b + 1\n    Next x\n    a = a + 1\n    i = i + 1\nNext cell\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6331891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb9ba134d03b28c278d2db8e07bd871?s=128&d=identicon&r=PG&f=1", "display_name": "BitteB", "link": "https://stackoverflow.com/users/6331891/bitteb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 47178295, "answer_count": 1, "score": 0, "last_activity_date": 1510139699, "creation_date": 1510135776, "question_id": 47176817, "link": "https://stackoverflow.com/questions/47176817/copy-non-merged-cells-from-one-worksheet-to-merged-cells-in-another-using-a-loop", "title": "Copy non-merged cells from one worksheet to merged cells in another using a loop", "body": "<p>I have done a lot of both trying and failing and searching the internet for a solution, but I can't seem to figure out exactly how to solve my problem. Now I hope you guys can help me out.</p>\n\n<p>I am trying to copy a range of cells (non-merged) from one worksheet (ws) to another range which contains merged cells in another worksheet (omk). I have to do this for 20 ranges or so, so I am using a loop. The code I have written so far is pasted below:</p>\n\n<pre><code>Dim omk, ws As Worksheet\nDim a, b, i, y, z As Integer\nDim x As Range\n\nSet omk = Sheets(\"Omkostningsmodel\")\nSet ws = ActiveSheet\n\nomk.Activate\n\na = 173\ni = 187\nFor Each cell In Range(\"C187\", \"C206\")\n    z = 3\n    b = 3\n    For Each x In Range(Cells(i, z), Cells(i, 22))\n        x.Value = ws.Cells(a, b)\n        z = z + 1\n        b = b + 1\n        If z = 4 Or z = 13 Or z = 16 Then\n            z = z + 1\n        End If\n    Next x\n    a = a + 1\n    i = i + 1\nNext cell\n</code></pre>\n\n<p>My problem is that column c and d (3 and 4) is merged in the worksheet \"omk\", and therefore I have tried to make the second loop skip column d, while keeping column d in worksheet \"ws\" \"locked\" when this happens. However when I run the code, it seems like column d in worksheet \"ws\" isn't locked?</p>\n\n<p>I am not sure, I have been clear enough, so please let me know if you can't follow my problem. </p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 35, "user_id": 6706095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SW2LfTQdFe4/AAAAAAAAAAI/AAAAAAAABHU/TxBuVPLSe1k/photo.jpg?sz=128", "display_name": "jose m ruiz", "link": "https://stackoverflow.com/users/6706095/jose-m-ruiz"}, "edited": false, "score": 0, "creation_date": 1510135643, "post_id": 47176631, "comment_id": 81302591, "body": "Well, a silly workaround is to simply have my seat_list_data starting down from cell A2 instead of A1, so here I have my problem solved, but.. this is bugging me hard! I&#39;d like to understand why it can&#39;t find a value placed in the first row and if it&#39;s possible to sort it out with &quot;FIND&quot; for future uses."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1510136337, "creation_date": 1510136337, "answer_id": 47177039, "question_id": 47176631, "link": "https://stackoverflow.com/questions/47176631/use-find-range-to-get-first-row-in-a-column/47177039#47177039", "title": "Use find.range to get first row in a column", "body": "<p>\"What am I doing wrong here?\"\nYou are not using <code>Option Explicit</code>, thus the code quality is going low on a level that it does not compile:</p>\n\n<p><code>Dim rng, As Range</code> - that should be a compiling error, the comma is not needed</p>\n\n<p><code>With sht.rng</code> - compiling error</p>\n\n<p><code>Set where = .Find(what:=seat, LookIn:=xlValues)</code> - what is <code>where</code> - compiling error</p>\n\n<hr>\n\n<p>Advise - write <code>Option Explicit</code> on the top of your module, then Select \"Debug>Compile\" and see the errors you are getting. Try to work on them, until you are able to compile.</p>\n"}], "owner": {"reputation": 35, "user_id": 6706095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SW2LfTQdFe4/AAAAAAAAAAI/AAAAAAAABHU/TxBuVPLSe1k/photo.jpg?sz=128", "display_name": "jose m ruiz", "link": "https://stackoverflow.com/users/6706095/jose-m-ruiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1519503956, "creation_date": 1510135252, "last_edit_date": 1519503956, "question_id": 47176631, "link": "https://stackoverflow.com/questions/47176631/use-find-range-to-get-first-row-in-a-column", "title": "Use find.range to get first row in a column", "body": "<p>For simplicity let's say I have the following data:\n- Column A contains a list of seats available on a plane (seats that are not occupied)\n1A,1B,1C,1D,1E,1F,2A,2B,2C,etc</p>\n\n<p>When a seat available is allocated to a passenger, I would like to find that seat and delete it from the list.</p>\n\n<p>My code works for every seat that is <strong>not the first seat in column A</strong>, let's say a passenger wants seat 1A which is Cell(1,1) or Range(\"A1\") when I use find.range I get row 2, therefore it continues available for other passengers when in fact it shouldn't.</p>\n\n<p>What am I doing wrong here?</p>\n\n<pre><code>Private Sub RemoveFromListSeatAllocated(seat As String)\nDim sht As Worksheet\nDim rng, As Range\n\nSet sht = Sheets(\"This sheet\")\nSet rng = Range(\"A1:A192\")\n\n'FIND SEAT IN LIST OF SEATS AVAILABLE\nWith sht.rng\n  Set where = .Find(what:=seat, LookIn:=xlValues)\nEnd With\n\nSet rng = Range(\"A\" &amp; where.Row)\n\n'DELETE SEAT FOUND AND SHIFT UP \nsht.rng.Delete Shift:=xlUp\n\nEnd Sub\n</code></pre>\n\n\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1510135124, "post_id": 47176186, "comment_id": 81302218, "body": "Share the code of LoadAll function. How do you call 3rd party addin?"}, {"owner": {"reputation": 1, "user_id": 6658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e365dd82fd214fb51ca3545de97f57?s=128&d=identicon&r=PG&f=1", "display_name": "SRH1984", "link": "https://stackoverflow.com/users/6658259/srh1984"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1510135668, "post_id": 47176186, "comment_id": 81302606, "body": "I don&#39;t have access to the code of the loadall function. It is part of the UNIT4 Report Engine. All I can see is   Public Sub agrxlLoadAll()     agrxlImmediate &quot;LoadAll&quot; End Sub  To run this the user would enter the variables such as company code and then go to the UNIT4 Excelerator tab then Load &gt; All Sheets  I did consider a time delay on the macro, but while it runs relatively quickly on my sysetm using a test enviroment on a live system it could take considerably longer to run"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e365dd82fd214fb51ca3545de97f57?s=128&d=identicon&r=PG&f=1", "display_name": "SRH1984", "link": "https://stackoverflow.com/users/6658259/srh1984"}, "is_accepted": false, "score": 0, "last_activity_date": 1510223792, "creation_date": 1510223792, "answer_id": 47199624, "question_id": 47176186, "link": "https://stackoverflow.com/questions/47176186/a-macro-that-wont-run-until-another-3rd-party-process-has-completed/47199624#47199624", "title": "A macro that won&#39;t run until another 3rd party process has completed", "body": "<p>So, I think that I was approaching this in the wrong way.</p>\n\n<p>I've spent sometime learning about Excel addins (it isn't something I have any experience of), and I don't believe that my macro would ever work in the way I want it to.</p>\n\n<p>My limited understanding leads me to believe that the addin actually creates a new worksheet when the load all button is clicked, and this worksheet is populated with the data at the time it is created.</p>\n\n<p>Therefore, the macro won't detect any changes, as there have been no changes made to the worksheet.</p>\n"}], "owner": {"reputation": 1, "user_id": 6658259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64e365dd82fd214fb51ca3545de97f57?s=128&d=identicon&r=PG&f=1", "display_name": "SRH1984", "link": "https://stackoverflow.com/users/6658259/srh1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510223792, "creation_date": 1510133930, "last_edit_date": 1531161705, "question_id": 47176186, "link": "https://stackoverflow.com/questions/47176186/a-macro-that-wont-run-until-another-3rd-party-process-has-completed", "title": "A macro that won&#39;t run until another 3rd party process has completed", "body": "<p>I'm currently working on making some minor changes to a report.</p>\n\n<p>It is an Excel file that uses a 3rd party addin to connect to a database and pull back information.</p>\n\n<p>The part I have trouble in is that they would like the date and time that the report was run placed into the footer of the report.</p>\n\n<p>I have pulled the date from the database through to a cell on the report, and I can pull this into the footer, however, all of the solutions i have tried so far need the user to perform an action to run the macro, e.g. click on another cell, activate the worksheet etc.</p>\n\n<p>Is there a way I can set my macro to wait until another function/process has finished before it runs?</p>\n\n<p>e.g. The users opens the workbook, then clicks Load All Sheets, which triggers the LoadAll function which populates the sheets etc, ideally I would like to run my macro automatically once this has finished.</p>\n\n<p>Using call won't work, as if I make any changes to the 3rd party stuff those changes would need to be distributed to all users, and not every report needs the date in the footer </p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1510134632, "post_id": 47176162, "comment_id": 81301901, "body": "If it is controls box then you can set its <code>Input Range</code> property directly to <code>DropDownDates</code> and it will show the values. Is there any reason to do this programmatically?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1510137857, "post_id": 47176162, "comment_id": 81304133, "body": "I remember now why i was doing it programmatically. It was to ensure the combobox was populated with strings to avoid numbers or mm/dd/yyyy formatting appearing in the combobox. This ensured &quot;dd/mm/yyyy&quot; was always shown. The source range are dates before the function DateArrToStrArr() converts to string."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1510137888, "post_id": 47176162, "comment_id": 81304155, "body": "Are the dates in the Range <code>DropDownDates</code> fixed or calculated? If calculated, try forcing a recalc before using them."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510137974, "post_id": 47176162, "comment_id": 81304219, "body": "The range is dynamic. Would a recalc not happen with the workbook open?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1510139448, "creation_date": 1510139448, "answer_id": 47178204, "question_id": 47176162, "link": "https://stackoverflow.com/questions/47176162/vba-combobox-only-showing-one-item-after-workbook-open-event/47178204#47178204", "title": "VBA: ComboBox only showing one item after Workbook_Open event", "body": "<p>Thanks to @CLR for making me think about recalcs. I decided to hack my way around this with the following:</p>\n\n<p>I have added in <code>Worksheet(\"Benchmarking\")</code> a <strong><code>Worksheet_Activate</code></strong> event and removed the Workbook_Open code. This seems to do the trick</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n  ' ComboBox1.Clear\n   ComboBox1.List = DateArrToStrArr\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 975, "favorite_count": 0, "accepted_answer_id": 47178204, "answer_count": 1, "score": 2, "last_activity_date": 1510262219, "creation_date": 1510133873, "last_edit_date": 1510262219, "question_id": 47176162, "link": "https://stackoverflow.com/questions/47176162/vba-combobox-only-showing-one-item-after-workbook-open-event", "title": "VBA: ComboBox only showing one item after Workbook_Open event", "body": "<p>I am attempting to have a <strong><code>Workbook_Open</code></strong> event populate a controls ComboBox\nso that when the user goes to the <code>Worksheet(\"Benchmarking\")</code>, they have a pre-populated list to choose from that includes all the items in the array <code>datesArr</code>.</p>\n\n<p>The problem i am having is, upon opening the spreadsheet and navigating to the <code>Worksheet(\"Benchmarking\")</code>, i am only seeing one item in the drop down list:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3WFtK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3WFtK.png\" alt=\"Current situation with ComboBox1\"></a></p>\n\n<p>If i select that item then the list actually populates:</p>\n\n<p><a href=\"https://i.stack.imgur.com/K94QA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K94QA.png\" alt=\"Full list appearing when selecting initial single item\"></a></p>\n\n<p>Desired result: </p>\n\n<p>I want the full list to be available from the first time the user tries to make a selection not just after the <code>ComboBox1_Change</code> event is fired.</p>\n\n<p>Having reviewed numerous post e.g. <a href=\"https://stackoverflow.com/questions/30613031/sometimes-the-activex-combobox-only-shows-one-row-why?answertab=votes#tab-top\">Sometimes the ActiveX Combobox only shows one row, why?</a> , <a href=\"https://www.mrexcel.com/forum/excel-questions/148586-populating-combo-box-workbook-open.html\" rel=\"nofollow noreferrer\">Populating Combo Box on WorkBook Open</a> I have tried several different approaches including the following in the <code>Workbook_Open</code> event code:</p>\n\n<pre><code>.ListFillRange = \"DropDownDates\"  \n.List = DateArrToStrAr\n</code></pre>\n\n<p>I have also looped the array adding the items to ComboBox1. Each time i get the same 1 visible item in drop down result.</p>\n\n<p>Is someone able to tell me where i am going wrong please?</p>\n\n<p>My current code is</p>\n\n<p>1) <strong>ThisWorkbook</strong> </p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    With Worksheets(\"Benchmarking\").OLEObjects(\"ComboBox1\").Object\n        .Clear\n        .List = DateArrToStrArr '         \n    End With\n\nEnd Sub\n</code></pre>\n\n<p>2) <strong>Worksheet(\"Benchmarking\")</strong>:</p>\n\n<pre><code>Private Sub ComboBox1_Change() 'QH 2/11/17\n\n     Dim datesArr() As String\n     Dim ws As Worksheet\n\n     Set ws = ThisWorkbook.Worksheets(\"Lkup\")\n\n     datesArr = DateArrToStrArr 'function that reads a named range of dates and converts to string to avoid dd/mm becoming mm/dd\n\n     If ComboBox1.Value = vbNullString Then ComboBox1.Value = \"01/04/2016\"\n\n     ComboBox1.List = datesArr\n\n     '.....other code\n\nEnd Sub\n</code></pre>\n\n<p>Notes:</p>\n\n<p>The array <code>datesArr</code> is populated by the function <code>DateArrToStrArr()</code> which reads in a named range of dates <code>\"DropDownDates\"</code> (workbook scope) and converts them to a string array. This is then assigned to the ComboBox.</p>\n\n<p><code>DropDownDates</code> is a dynamic named range with formula <code>=OFFSET(Lkup!$F$16,,,Lkup!$M$12,)</code></p>\n\n<p>Set-up: Excel 2016 64 bit Windows.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 8854925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd814aa90330f508827afe1de6cc7f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Serversta", "link": "https://stackoverflow.com/users/8854925/serversta"}, "reply_to_user": {"reputation": 226, "user_id": 7528080, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/L2MWy.png?s=128&g=1", "display_name": "Emanuel Pirovano", "link": "https://stackoverflow.com/users/7528080/emanuel-pirovano"}, "edited": false, "score": 0, "creation_date": 1510133653, "post_id": 47175996, "comment_id": 81301218, "body": "I&#39;m not allowed to post a comment because I need 50 reputation. I said also that the workbook still not saved so maybe it&#39;s the problem. @EmanuelPirovano"}, {"owner": {"reputation": 285, "user_id": 8475183, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/9f2400e5151b9ac9f48ab67e5594ab09?s=128&d=identicon&r=PG&f=1", "display_name": "Raspi Surya", "link": "https://stackoverflow.com/users/8475183/raspi-surya"}, "edited": false, "score": 0, "creation_date": 1510135429, "post_id": 47175996, "comment_id": 81302435, "body": "I tried using application.quit. However, all the excel file opened are closed. I only want to close the specific excel file"}, {"owner": {"reputation": 83, "user_id": 8854925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd814aa90330f508827afe1de6cc7f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Serversta", "link": "https://stackoverflow.com/users/8854925/serversta"}, "edited": false, "score": 0, "creation_date": 1510138262, "post_id": 47175996, "comment_id": 81304397, "body": "Usually when i first open another workbook then i&#39;ll go ahead and name it.      <code>Set AnotherWorkbook = ActiveWorkbook</code>  then when i&#39;m done with it i just close it with <code>AnotherWorkbook.Close</code>"}], "tags": [], "owner": {"reputation": 83, "user_id": 8854925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd814aa90330f508827afe1de6cc7f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Serversta", "link": "https://stackoverflow.com/users/8854925/serversta"}, "is_accepted": false, "score": 1, "last_activity_date": 1510133390, "creation_date": 1510133390, "answer_id": 47175996, "question_id": 47175867, "link": "https://stackoverflow.com/questions/47175867/excel-freeze-after-close-workbook-in-macro/47175996#47175996", "title": "Excel freeze after close workbook in Macro", "body": "<p>Here's the answer for your question.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/3628252/closing-excel-application-using-vba\">Closing Excel Application using VBA</a></p>\n\n<p>Maybe the workbook still not saved that's why it freezes. Correct me if I'm wrong. Thanks.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3473379"}, "is_accepted": false, "score": 0, "last_activity_date": 1513251953, "creation_date": 1513251953, "answer_id": 47812596, "question_id": 47175867, "link": "https://stackoverflow.com/questions/47175867/excel-freeze-after-close-workbook-in-macro/47812596#47812596", "title": "Excel freeze after close workbook in Macro", "body": "<p>Take this example  : </p>\n\n<pre><code>Const xlAscending = 1\nConst xlYes = 1\nDim filePath\n    filePath = \"C:\\Users\\book1.xlsx\"\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = False\nobjExcel.DisplayAlerts = False\nDim objWorkbook\nSet objWorkbook = _ \n    objExcel.Workbooks.Open(filePath)\nSet objWorksheet = objWorkbook.Worksheets(1)\nSet objRange = objWorksheet.UsedRange\nSet objRange2 = objExcel.Range(\"A1\")\nobjRange.Sort objRange2, xlAscending, , , , , , xlYes\n'objExcel.Application.DefaultSaveFormat = xlWorkbookNormal'\nobjWorkbook.Save\nobjExcel.Application.Quit\nSet objExcel = Nothing\n</code></pre>\n\n<p>please conctrate on following : </p>\n\n<pre><code> objWorkbook.Save\n    objExcel.Application.Quit\n    Set objExcel = Nothing \n objExcel.Visible = False\nobjExcel.DisplayAlerts = False\n</code></pre>\n\n<p>Visible = false means that excel will not open </p>\n\n<p>DisplayAlerts = false allow you to ignore msgBox that pop up when you try to change excel . </p>\n\n<p>the first 2 commands are to close excel file.</p>\n\n<p>hope all clear , let me know if you have more questions</p>\n"}], "owner": {"reputation": 285, "user_id": 8475183, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/9f2400e5151b9ac9f48ab67e5594ab09?s=128&d=identicon&r=PG&f=1", "display_name": "Raspi Surya", "link": "https://stackoverflow.com/users/8475183/raspi-surya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513251953, "creation_date": 1510133080, "last_edit_date": 1510158816, "question_id": 47175867, "link": "https://stackoverflow.com/questions/47175867/excel-freeze-after-close-workbook-in-macro", "title": "Excel freeze after close workbook in Macro", "body": "<p>I am trying to close the workbooks after finish executing macro. \nSo i use this code</p>\n\n<pre><code> Workbooks(\"RPA 1.xlsm\").Close\n</code></pre>\n\n<p>However, after the RPA 1.xlsm closed, the other active workbook is freezed and can't be closed. It seems like something got stucked.</p>\n\n<p>Anyone know why?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1510134554, "post_id": 47175747, "comment_id": 81301848, "body": "why are we subtracting -4 here &quot;ws2.Range(&quot;H&quot; &amp; CR2).Value = ws2.Range(&quot;H&quot; &amp; CR2) - 4&quot;."}, {"owner": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "reply_to_user": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1510139627, "post_id": 47175747, "comment_id": 81305333, "body": "@ApurvPawar in this case the value we will be subtracting will always be 4 no matter what. But I am going to need it later on, so I&#39;m trying to get it done right now."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "edited": false, "score": 0, "creation_date": 1510139718, "post_id": 47176326, "comment_id": 81305396, "body": "Do I have to set the values for that range? I&#39;m using values that have already been placed inside the sheets I need."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "edited": false, "score": 0, "creation_date": 1510139845, "post_id": 47176326, "comment_id": 81305486, "body": "@Barbaaz - no, you do not have to. I have done it, in order to make sure that it works, because during the tests I have executed the code multiple times."}, {"owner": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "edited": false, "score": 0, "creation_date": 1510140037, "post_id": 47176326, "comment_id": 81305617, "body": "So I can use the variables I have in my code at the moment and use a loop like you did?"}, {"owner": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "edited": false, "score": 0, "creation_date": 1510140321, "post_id": 47176326, "comment_id": 81305814, "body": "for some reason I can&#39;t tag you. I&#39;m sorry to bother a little longer but I am quite new to VBA. I learned VB in High School but haven&#39;t used it in years, so I&#39;m a bit stranded. Should I ditch the &quot;If&quot; part of my code?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "edited": false, "score": 0, "creation_date": 1510140502, "post_id": 47176326, "comment_id": 81305951, "body": "@Barbaaz - to be honest, your code is a bit of a small mess. I do not understand the <code>-4</code> and <code>-1</code> parts, thus I cannot advise there. Concerning tagging, you cannot tag me under my answer, I get notification for every post."}, {"owner": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "edited": false, "score": 0, "creation_date": 1510140743, "post_id": 47176326, "comment_id": 81306122, "body": "Yeah. I figured it would be gory. I&#39;m going to try and explain what I need to do. I need to develop a &quot;small&quot; stock management software inside Excel. And since I need to use FIFO, I need to constantly jump from row to row until the values are 0. That&#39;s why you see the <code>-1</code>. As for the <code>-4</code>, that&#39;s the default value that will be subtracted from that range."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1510135304, "last_edit_date": 1510135304, "creation_date": 1510134337, "answer_id": 47176326, "question_id": 47175747, "link": "https://stackoverflow.com/questions/47175747/how-to-subtract-from-cells-making-their-value-0-and-moving-on-to-the-next-row/47176326#47176326", "title": "How to subtract from cells making their value 0 and moving on to the next row?", "body": "<p>Whenever you have a problem like this start from the smallest possible example and make it work. E.g., something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cV3ec.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cV3ec.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now the idea is to substract a value (let's say <code>320</code>) from the cell in <code>A1</code>, then the rest from the <code>B1</code> and etc. At the end you should have something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yWulK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yWulK.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now the funny part - work until you do not achieve picture 2 from picture 1. The simplest possible option is with using a variable for <code>substractValue</code> and decrease it with the value of the cell. Once the <code>substractValue</code> becomes 0 exit the for-loop:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SubstractMe()\n\n    Dim substractValue  As Double\n    Dim myCell          As Range\n\n    Range(\"A1\") = 100\n    Range(\"A2\") = 200\n    Range(\"A3\") = 300\n    Range(\"A4\") = 400\n\n    substractValue = 320\n\n    For Each myCell In Range(\"A1:A4\")\n        If myCell - substractValue &lt; 0 And substractValue &gt; 0 Then\n            substractValue = substractValue - myCell\n            myCell = 0\n        Else\n            myCell = myCell - substractValue\n            Exit For\n        End If\n    Next myCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510135304, "creation_date": 1510132732, "last_edit_date": 1510133660, "question_id": 47175747, "link": "https://stackoverflow.com/questions/47175747/how-to-subtract-from-cells-making-their-value-0-and-moving-on-to-the-next-row", "title": "How to subtract from cells making their value 0 and moving on to the next row?", "body": "<p>How can I subtract values from cells while not making them get negative values?</p>\n\n<p>For example.</p>\n\n<p>I have a cell with 100 in a row. \nAnd another with 200 in the next row.</p>\n\n<p>I use a CommandButton to subtract 105 from those rows. However, I want to use the FIFO (First In, First Out) principle and subtract from the cell with 100 first until it reaches 0 and only then, subtract from the one with 200.</p>\n\n<p>This is what I have so far.</p>\n\n<pre><code>Private Sub CommandButton1_Click() 'Guardar Carbona\u00e7\u00e3o\nDim LastRow As Long, CR As Long, ws As Worksheet, CR2 As Long, ws2 As Worksheet, ws3 As Worksheet\n\n    Set ws = Sheets(\"Carbona\u00e7\u00e3o\")\n    Set ws3 = Sheets(\"STOCK Sticks\")\n        LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n        CR = ws3.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        ws.Range(\"A\" &amp; LastRow).Value = Int((99999999 - 1 + 1) * Rnd + 8) 'ID Carbona\u00e7\u00e3o\n        ws.Range(\"B\" &amp; LastRow).Value = ComboBox1.Text 'Fabricante\n        ws.Range(\"C\" &amp; LastRow).Value = TextBox25.Text 'Lote Membranas\n        ws.Range(\"D\" &amp; LastRow).Value = Sheets(\"STOCK Sticks\").Range(\"A\" &amp; CR) 'ID Sticks\n        ws.Range(\"E\" &amp; LastRow).Value = TextBox2.Text 'N\u00ba Carbona\u00e7\u00e3o\n        ws.Range(\"F\" &amp; LastRow).Value = TextBox3.Text 'Densidade Total / Carbona\u00e7\u00e3o\n        ws.Range(\"G\" &amp; LastRow).Value = TextBox1.Text 'TETRA\n        ws.Range(\"H\" &amp; LastRow).Value = Format(Now(), \"dd/mm/yyyy hh:mm\") 'Data / Hora introdu\u00e7\u00e3o\n\n    Set ws2 = Sheets(\"STOCK Membranas\")\n        CR2 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 1\n            If ws2.Range(\"H\" &amp; CR2).Value = 0 Then\n                CR2 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n                ws2.Range(\"H\" &amp; CR2).Value = ws2.Range(\"H\" &amp; CR2) - 4\n            ElseIf ws2.Range(\"H\" &amp; CR2).Value &gt; 0 Then\n                   CR2 = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 1\n                   ws2.Range(\"H\" &amp; CR2).Value = ws2.Range(\"H\" &amp; CR2) - 4\n            End If\n\n\nComboBox1.Value = Null\nTextBox25.Value = Null\nTextBox1.Value = Null\nTextBox2.Value = Null\nTextBox3.Value = Null\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1510132752, "post_id": 47175720, "comment_id": 81300536, "body": "Where is the file on your computer? What is wrong with declaring the folderpath, should it be dynamic?"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1510132865, "post_id": 47175720, "comment_id": 81300613, "body": "I want it to be dynamic. and the folder names are not in english, I cant use in the code. @Luuklag"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1510135728, "post_id": 47175720, "comment_id": 81302649, "body": "@Luuklag did you understood what I mean afetr the edit?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1510136054, "post_id": 47175720, "comment_id": 81302879, "body": "Your code is saying the file name is <code>*.xlsx</code> and not a specific file name.  <code>myExtension</code> isn&#39;t declared and <code>ThisWorkbook.Path</code> won&#39;t have a file separator on the the end - it should be <code>ThisWorkbook.Path &amp; &quot;\\&quot; &amp; myExtension</code>.  You&#39;ll still need to sort out which file it&#39;s trying to open though - <code>*.xlsx</code> doesn&#39;t refer to a single file.  <code>MonthName</code> isn&#39;t used anywhere and <code>ScreenUpdating</code> &amp; <code>EnableEvents</code> isn&#39;t needed."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1510136408, "post_id": 47175720, "comment_id": 81303128, "body": "What do you mean by &quot;<i>without writing path</i>&quot;.  <code>ThisWorkbook.Path</code> is a pretty static path - it&#39;s wherever the workbook containing the code is saved, so the workbook you&#39;re trying to open must be in the same folder as the original file."}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1510138365, "post_id": 47175720, "comment_id": 81304459, "body": "@DarrenBartrup-Cook - yes that is excatly what i am trying to do, can you fix my code?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1510138699, "post_id": 47175720, "comment_id": 81304701, "body": "What exactly are you trying to do?  I&#39;ve pointed out what I can see is wrong with your code but I don&#39;t know what you&#39;re trying to do.  I don&#39;t know what &quot;<i>without writing path by using variables</i>&quot; means in this context.  Where does the month name come into it?  Is it a single file or all files you want opened (you&#39;re using <code>*</code> which I take to mean a number of files with some kind of wildcard name)."}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1510139078, "post_id": 47175720, "comment_id": 81304956, "body": "@DarrenBartrup-Cook i am trying to open one file that is xlsx type - to name it and to take data out of there. the file is in the same folder as the main file."}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1510139123, "post_id": 47175720, "comment_id": 81304989, "body": "@DarrenBartrup-Cook the file i am trying to open is the only xlsx file inside the folder."}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1510139313, "post_id": 47175720, "comment_id": 81305121, "body": "@DarrenBartrup-Cook the month is not relavant"}], "answers": [{"comments": [{"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1510141121, "post_id": 47178628, "comment_id": 81306385, "body": "the second sub is what I need, but somehow it says that it could not find the file with its right name and it is the only xlsx file in the folder"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1510141202, "post_id": 47178628, "comment_id": 81306444, "body": "&quot;sorry we couldn&#39;t find &quot;bla bla&quot;. is it possible it was removed, renamed or deleted?&quot;"}, {"owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 0, "creation_date": 1510143175, "post_id": 47178628, "comment_id": 81307622, "body": "these 2 files are the only one in the folder and still it shows me a massage box that it cant find the xlsx file in the folder."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "edited": false, "score": 1, "creation_date": 1510148650, "post_id": 47178628, "comment_id": 81311394, "body": "Sorry, that was my fault. For some reason it was working for me even though <code>Dir</code> only returns the workbook name and not the path as well.  When I tried it in a different folder I had the same error as you - I&#39;ve updated the code to include the path when opening the file."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1510148491, "last_edit_date": 1510148491, "creation_date": 1510140713, "answer_id": 47178628, "question_id": 47175720, "link": "https://stackoverflow.com/questions/47175720/excel-vba-open-xlsx-file-from-folder-without-writing-path/47178628#47178628", "title": "Excel VBA Open xlsx File From Folder Without writing Path", "body": "<p>Here's a couple of examples that may help.  </p>\n\n<p>The first will ask you to select the correct file and then open it:  </p>\n\n<pre><code>Public Sub Test()\n\n    Dim sWrkbkPath As String\n    Dim UnionWB As Workbook\n\n    sWrkbkPath = GetFile(ThisWorkbook.Path)\n    If sWrkbkPath &lt;&gt; \"\" Then\n        Set UnionWB = Workbooks.Open(sWrkbkPath)\n        MsgBox UnionWB.Name\n    End If\n\nEnd Sub\n\nFunction GetFile(Optional startFolder As Variant = -1) As Variant\n    Dim fle As FileDialog\n    Dim vItem As Variant\n    Set fle = Application.FileDialog(msoFileDialogFilePicker)\n    With fle\n        .Title = \"Select your Union Workbook\"\n        .AllowMultiSelect = False\n        .Filters.Add \"My Union Workbook\", \"*.xlsx\", 1\n        If startFolder = -1 Then\n            .InitialFileName = Application.DefaultFilePath\n        Else\n            If Right(startFolder, 1) &lt;&gt; \"\\\" Then\n                .InitialFileName = startFolder &amp; \"\\\"\n            Else\n                .InitialFileName = startFolder\n            End If\n        End If\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        vItem = .SelectedItems(1)\n    End With\nNextCode:\n    GetFile = vItem\n    Set fle = Nothing\nEnd Function\n</code></pre>\n\n<p>The second method assumes you only have a single xlsx file in the same folder as ThisWorkbook and opens the first file it finds:  </p>\n\n<pre><code>Public Sub OpenOnlyXLSXInFolder()\n    Dim sWrkbkPath As String\n    Dim UnionWB As Workbook\n    sWrkbkPath = Dir$(ThisWorkbook.Path &amp; \"\\*.xlsx\")\n\n    'Only expecting a single file so no need to loop.\n    If sWrkbkPath &lt;&gt; \"\" Then\n        Set UnionWB = Workbooks.Open(ThisWorkbook.Path &amp; \"\\\" &amp; sWrkbkPath)\n        MsgBox UnionWB.Name\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 7821579, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a953b9c8ac3a4f2afb4ab7ad9280fe81?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Osipov", "link": "https://stackoverflow.com/users/7821579/rafael-osipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2895, "favorite_count": 0, "accepted_answer_id": 47178628, "answer_count": 1, "score": 0, "last_activity_date": 1561821093, "creation_date": 1510132637, "last_edit_date": 1561821093, "question_id": 47175720, "link": "https://stackoverflow.com/questions/47175720/excel-vba-open-xlsx-file-from-folder-without-writing-path", "title": "Excel VBA Open xlsx File From Folder Without writing Path", "body": "<p>I want to open Excel xlsx file without writing path by using variables. I din't know why but it is not working. I have a folder with the main workbook and another one that I want to open that is xlsx. I want to name it UnionWB.</p>\n\n<pre><code>  Private Sub cmdStartMonth_Click()\n    'Optimize Macro Speed\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    'Analyze month by selecting\n    Dim myPath As String\n    Dim myFile As String\n    Dim UnionWB As Workbook\n    Dim MonthName As String\n    MonthName = ListMonth.Value\n    myExtension = \"*.xlsx*\"\n    Set UnionWB = Workbooks.Open(ThisWorkbook.Path &amp; myExtension)\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    End Sub\n</code></pre>\n\n<blockquote>\n  <p>Set UnionWB = Workbooks.Open(ThisWorkbook.Path &amp; myExtension)</p>\n</blockquote>\n"}, {"tags": ["xml", "vba", "excel", "xpath", "xml-namespaces"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1510156031, "post_id": 47175584, "comment_id": 81316920, "body": "what is <code>.Item(0).XML</code> supposed to be? Also userId is not a direct child of the documentElement. Try with <code>doc.SelectNodes(&quot;&#47;&#47;d:userId&quot;).xml</code> instead. Also: your namespaces need to be defined in the XML else you get a parseError. Example: <code>&lt;entry xmlns:m=&#39;http:&#47;&#47;tempuri.com&#39; xmlns:d=&#39;http:&#47;&#47;tempuri.com&#39;&gt;</code>"}, {"owner": {"reputation": 167, "user_id": 5047415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-KFCp1WY8eCE/AAAAAAAAAAI/AAAAAAAAACE/OYM4hRTuyJc/photo.jpg?sz=128", "display_name": "SanzioSan", "link": "https://stackoverflow.com/users/5047415/sanziosan"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1510157435, "post_id": 47175584, "comment_id": 81317979, "body": "I tried (&quot;//d:userId&quot;) with no luck, I do have these namespaces declared, I had sensitive data in that xml so i only copied a snippet from it"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1510157596, "post_id": 47175584, "comment_id": 81318076, "body": "You need to post some code, else all is mere guesswork."}, {"owner": {"reputation": 167, "user_id": 5047415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-KFCp1WY8eCE/AAAAAAAAAAI/AAAAAAAAACE/OYM4hRTuyJc/photo.jpg?sz=128", "display_name": "SanzioSan", "link": "https://stackoverflow.com/users/5047415/sanziosan"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1510167820, "post_id": 47175584, "comment_id": 81324551, "body": "I added the vba code"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1510221705, "post_id": 47175584, "comment_id": 81346250, "body": "What does <code>Debug.Print parentNode.nodeName</code> reveal? BTW: using <code>parentNode</code> as a variable name is really bad practice."}], "owner": {"reputation": 167, "user_id": 5047415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-KFCp1WY8eCE/AAAAAAAAAAI/AAAAAAAAACE/OYM4hRTuyJc/photo.jpg?sz=128", "display_name": "SanzioSan", "link": "https://stackoverflow.com/users/5047415/sanziosan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1572, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510162710, "creation_date": 1510132197, "last_edit_date": 1510162710, "question_id": 47175584, "link": "https://stackoverflow.com/questions/47175584/using-xpath-to-select-child-xml-nodes-in-vba", "title": "Using XPATH to select child xml nodes in VBA", "body": "<p>Im trying to build a validator withing my excel spread sheet.\nThe program grabs data from an odata service and parses the xml.</p>\n\n<p>My issue is <code>Debug.Print doc.SelectNodes(\"d:userId\").Item(0).XML</code> seems to return nothing.</p>\n\n<p>my xml looks like this:</p>\n\n<pre><code>&lt;entry&gt;\n&lt;content type=\"application/xml\"&gt;\n            &lt;m:properties&gt;\n                &lt;d:userId&gt;user.id&lt;/d:userId&gt;\n                &lt;d:lastName&gt;name&lt;/d:lastName&gt;\n                &lt;d:username&gt;user.name&lt;/d:username&gt;\n                &lt;d:custom01 m:null=\"true\"&gt;&lt;/d:custom01&gt;\n                &lt;d:division&gt;N/A&lt;/d:division&gt;\n                &lt;d:email&gt;user.name@email.com&lt;/d:email&gt;\n                &lt;d:department&gt;N/A&lt;/d:department&gt;\n                &lt;d:empId m:null=\"true\"&gt;user.id&lt;/d:empId&gt;\n                &lt;d:hireDate m:null=\"true\"&gt;&lt;/d:hireDate&gt;\n                &lt;d:jobCode m:null=\"true\"&gt;&lt;/d:jobCode&gt;\n                &lt;d:firstName&gt;user&lt;/d:firstName&gt;\n                &lt;d:mi m:null=\"true\"&gt;N/A&lt;/d:mi&gt;\n            &lt;/m:properties&gt;\n&lt;/content&gt;\n&lt;/entry&gt;\n</code></pre>\n\n<p>here is the VBA code:</p>\n\n<pre><code>Function getSimpleProperty(propertyName As String, parentNode As IXMLDOMNode) As String\n\n    Debug.Print parentNode.SelectSingleNode(\".//content\")\n    getSimpleProperty = parentNode.SelectSingleNode(\"/entry/content/m:properties/\" + propertyName)\n\nEnd Function\n</code></pre>\n\n<p>I recieve an error that says \"Reference to undeclared namespace prefix: 'd'\"\nIve seen other examples that use <code>XmlDocument</code> object however im stuck using <code>MSXML2.DOMDocument60</code></p>\n\n<p>The examples ive seen use a namespace manager but to create one i need to use a method from the <code>XmlDocument</code> that isnt available in the <code>MSXML2.DOMDocument60</code>.</p>\n\n<p><code>Dim nsmgr as XmlNamespaceManager = new XmlNamespaceManager(doc.NameTable) //doc.NameTable is used in XmlDocument but not DOMDocument60</code></p>\n\n<p>How can i create a namespacemanager with only the <code>MSXML2.DOMDocument60</code>\n object as my program is already heavily integrated with this and I dont want to have to rewrite the whole thing.</p>\n\n<p><em>Edit</em> </p>\n\n<p>So i made some progress. </p>\n\n<p>i added this before loading the xml:</p>\n\n<pre><code> xmlDoc.setProperty \"SelectionLanguage\", \"XPath\"\n    xmlDoc.setProperty \"SelectionNamespaces\", \"xmlns:d='http://schemas.microsoft.com/ado/2007/08/dataservices' xmlns:m='http://schemas.microsoft.com/ado/2007/08/dataservices/metadata'\"\n</code></pre>\n\n<p>This works for:</p>\n\n<p><code>Set findRecord = doc.SelectSingleNode(\"//d:userId[text()='\" + userId + \"']\").parentNode.parentNode.parentNode</code></p>\n\n<p>This doesnt work when i try </p>\n\n<pre><code>Debug.Print parentNode.SelectSingleNode(\"content/m:properties/\")\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1510134497, "post_id": 47175557, "comment_id": 81301818, "body": "This is what I have so far: SELECT * FROM Data WHERE F1 &lt;&gt; &#39;&#39; AND (FIELD6=&quot;Added&quot; OR &quot;REMOVED&quot;);"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1510135506, "post_id": 47175557, "comment_id": 81302505, "body": "Don&#39;t write code in comments, edit your question and add the code with proper formatting."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1510136534, "creation_date": 1510136534, "answer_id": 47177134, "question_id": 47175557, "link": "https://stackoverflow.com/questions/47175557/finding-a-records-twice-and-removing-from-a-database/47177134#47177134", "title": "Finding a records twice and removing from a database", "body": "<p>That could be:</p>\n\n<pre><code>Delete * From YourTable\nWhere Field6 = \"Added\" And AccountNummber In\n    (Select AccountNumber From YourTable As T\n    Where T.AccountNumber = YourTable.AccountNumber\n    And T.Field6 = \"Removed\")\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 47177134, "answer_count": 1, "score": -1, "last_activity_date": 1510136534, "creation_date": 1510132105, "question_id": 47175557, "link": "https://stackoverflow.com/questions/47175557/finding-a-records-twice-and-removing-from-a-database", "title": "Finding a records twice and removing from a database", "body": "<p>I need to search a database where Column A says if a record is Added, or removed.</p>\n\n<p>If the search finds and account number which shows a record showing Added, and another record with the same account number as Removed then it will delete the Added Record.</p>\n\n<p>How is this possible?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1510130081, "post_id": 47174867, "comment_id": 81298938, "body": "can you pls share what you have tried so far"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1510130346, "post_id": 47174867, "comment_id": 81299080, "body": "What is condition upon which you are deciding what rows should be removed?"}], "answers": [{"tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 0, "last_activity_date": 1510132098, "creation_date": 1510132098, "answer_id": 47175556, "question_id": 47174867, "link": "https://stackoverflow.com/questions/47174867/remove-rows-in-excel/47175556#47175556", "title": "Remove rows in excel", "body": "<p>Try this code </p>\n\n<pre><code>Sub Test()\n\n    Dim ws As Worksheet\n    For Each ws In ThisWorkbook.Worksheets\n        Dim i As Long\n        For i = 10 To 2 Step -1\n            Select Case ws.Cells(i, 1).Value\n            'add your ids for which you don't want to delete the rows\n            Case 1, 5\n                'do nothing\n            Case Else\n                ws.Cells(i, 1).EntireRow.Delete\n            End Select\n        Next i\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 0, "creation_date": 1510138382, "post_id": 47176236, "comment_id": 81304476, "body": "What do you mean? You mean the input box, that pops up at the beginning? You can enter multiple values. For example you want to keep following IDs: 13, 53, 23, then you should enter in input box such string: <code>13,53,23</code> - no spaces, only commas separating numbers :)"}, {"owner": {"reputation": 75, "user_id": 1297532, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c5bdbd07d9e6b1ad7d636e32dfe4da75?s=128&d=identicon&r=PG", "display_name": "user1297532", "link": "https://stackoverflow.com/users/1297532/user1297532"}, "edited": false, "score": 0, "creation_date": 1510138977, "post_id": 47176236, "comment_id": 81304880, "body": "Hi Michal. The only issue I have is that the input field cannot handle a long  input string. When i paste the values, it only seem to keep a third of the values. Is there some kind of restriction on like max 255 characters?"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 75, "user_id": 1297532, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c5bdbd07d9e6b1ad7d636e32dfe4da75?s=128&d=identicon&r=PG", "display_name": "user1297532", "link": "https://stackoverflow.com/users/1297532/user1297532"}, "edited": false, "score": 0, "creation_date": 1510139113, "post_id": 47176236, "comment_id": 81304981, "body": "What  do you enter in input box?"}, {"owner": {"reputation": 75, "user_id": 1297532, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c5bdbd07d9e6b1ad7d636e32dfe4da75?s=128&d=identicon&r=PG", "display_name": "user1297532", "link": "https://stackoverflow.com/users/1297532/user1297532"}, "edited": false, "score": 0, "creation_date": 1510139814, "post_id": 47176236, "comment_id": 81305458, "body": "it&#39;s a string of 400 numbers, all 5 digits long. Example: 10049,10048,10047,10046,10045,10044,10043,10042,10041. It stops after 255 characters so it has to do with the data set somehow i think."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 75, "user_id": 1297532, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c5bdbd07d9e6b1ad7d636e32dfe4da75?s=128&d=identicon&r=PG", "display_name": "user1297532", "link": "https://stackoverflow.com/users/1297532/user1297532"}, "edited": false, "score": 0, "creation_date": 1510158246, "post_id": 47176236, "comment_id": 81318538, "body": "Well, try doing it in steps. Read this for reference <a href=\"https://stackoverflow.com/questions/2969516/overcome-vba-inputbox-character-limit\" title=\"overcome vba inputbox character limit\">stackoverflow.com/questions/2969516/&hellip;</a>"}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1510134093, "creation_date": 1510134093, "answer_id": 47176236, "question_id": 47174867, "link": "https://stackoverflow.com/questions/47174867/remove-rows-in-excel/47176236#47176236", "title": "Remove rows in excel", "body": "<p>Try this code. At the start it will ask what IDs you want to keep in all worksheets. There you enter numbers separated by comma (<code>,</code>), no spaces or character other than comma and digits aren't allowed.</p>\n\n<pre><code>Sub DeleteArticles()\nDim i As Long\nDim strIDToKeep As String\nDim arrIDToKeep() As String\nDim ws As Worksheet\nDim lastRow As Long\nstrIDToKeep = InputBox(\"What IDs to keep?\")\narrIDToKeep = Split(strIDToKeep, \",\")\n\nFor Each ws In Worksheets\n    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n    For i = lastRow To 6 Step -1\n        'if ID isn't present in array of IDs to keep, then we delete entire row\n        If UBound(Filter(arrIDToKeep, ws.Cells(i, 1).Value)) = -1 Then\n            ws.Rows(i).EntireRow.Delete\n        End If\n    Next\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 1297532, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c5bdbd07d9e6b1ad7d636e32dfe4da75?s=128&d=identicon&r=PG", "display_name": "user1297532", "link": "https://stackoverflow.com/users/1297532/user1297532"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 47176236, "answer_count": 2, "score": 1, "last_activity_date": 1510134448, "creation_date": 1510129964, "last_edit_date": 1510134448, "question_id": 47174867, "link": "https://stackoverflow.com/questions/47174867/remove-rows-in-excel", "title": "Remove rows in excel", "body": "<p>Here is a tricky question. </p>\n\n<p>I have an Excel file containing roughly 4000 articles in each of the 10 sheets within the workbook. I would like to keep only about 400 articles and the remaining 3600 articles should be removed. </p>\n\n<p>All sheets within the workbook has the article ID in column A. </p>\n\n<p>All sheets has headers on row 1-5. </p>\n\n<p>The article ID can exist more than once in some of the sheets.</p>\n\n<p>I want to list the 400 article ID's in the Visual Basic Script itself so that i don't have to create a separate sheet or column that contains the information.</p>\n\n<p>Can someone please help me? I have tried so many scripts, but nothing seems to work...</p>\n\n<p>In the example below I want to keep Article ID's 5 and 1 (and of course the headers). The remaining 5 rows should be removed</p>\n\n<p><a href=\"https://i.stack.imgur.com/JISgv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JISgv.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Jp8uP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jp8uP.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is what i have tried:</p>\n\n<pre><code>Sub Delete()\nDim Firstrow As Long\nDim Lastrow As Long\nDim Lrow As Long\nDim CalcMode As Long\nDim ViewMode As Long\n\nWith Application\nCalcMode = .Calculation\n.Calculation = xlCalculationManual\n.ScreenUpdating = False\nEnd With\n\nWith ActiveSheet\n.Select\nViewMode = ActiveWindow.View\nActiveWindow.View = xlNormalView\n.DisplayPageBreaks = False\nFirstrow = 6\nLastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\nFor Lrow = Lastrow To Firstrow Step -1\n    With .Cells(Lrow, \"Y\")\n        If Not IsError(.Value) Then\n            If InStr(.Value, 1) = 0 Or InStr(.Value, 5) = 0 Then  .EntireRow.Delete\n        End If\n    End With\n Next Lrow\nEnd With\nEnd Sub\n</code></pre>\n\n<p>But, I get two issues:</p>\n\n<ol>\n<li><p>All rows are removed <strong>including</strong> the rows that I want to remove (1 and 5). </p></li>\n<li><p>It only works on the open sheet and not the whole workbook. </p></li>\n</ol>\n\n<p>Kind regards, </p>\n\n<p>Peter</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 3068, "user_id": 999017, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/05ae53ec79c0a066cf21cea1a8e2a8c8?s=128&d=identicon&r=PG", "display_name": "eithed", "link": "https://stackoverflow.com/users/999017/eithed"}, "edited": false, "score": 1, "creation_date": 1510130801, "post_id": 47174780, "comment_id": 81299333, "body": "Can you please say what you want to achieve? Keep the question straight to the point"}, {"owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "reply_to_user": {"reputation": 3068, "user_id": 999017, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/05ae53ec79c0a066cf21cea1a8e2a8c8?s=128&d=identicon&r=PG", "display_name": "eithed", "link": "https://stackoverflow.com/users/999017/eithed"}, "edited": false, "score": 0, "creation_date": 1510131510, "post_id": 47174780, "comment_id": 81299762, "body": "@eithed Sorry, that was the coffee"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "edited": false, "score": 0, "creation_date": 1510131485, "post_id": 47175220, "comment_id": 81299741, "body": "I&#39;ve just tried to use this code and Excel spent a bit too long thinking about it. Am I still using Sub CopyRangeToWord() or do I need a different one?"}, {"owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "edited": false, "score": 0, "creation_date": 1510132219, "post_id": 47175220, "comment_id": 81300173, "body": "Wait, nevermind. My word is playing up. This has helped"}], "tags": [], "owner": {"reputation": 26, "user_id": 8838336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7e2189b42be6b15ffeb0e0fffbff87c?s=128&d=identicon&r=PG&f=1", "display_name": "Mathias Schmid", "link": "https://stackoverflow.com/users/8838336/mathias-schmid"}, "is_accepted": true, "score": 1, "last_activity_date": 1510131146, "creation_date": 1510131146, "answer_id": 47175220, "question_id": 47174780, "link": "https://stackoverflow.com/questions/47174780/moving-excel-data-to-an-already-existing-word-document/47175220#47175220", "title": "Moving excel data to an already existing word document", "body": "<p>This works perfectly fine for me: It adds the rows to the document over and over again as a table if i execute the code</p>\n\n<pre><code>Dim objWord\nDim objDoc\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc =objWord.Documents.Open(\"C:\\Users\\schmidmath\\Documents\\test1.docx\")\n\nRange(\"A1:B10\").Copy\n\nWith objDoc.Paragraphs(objDoc.Paragraphs.Count).Range\n   'All formatting goes here\n   .Paste\n   .Font.Name = \"broadway\"\n   .Font.Color = wdColorBlue\n   .Font.Bold = True\n   .Font.Italic = True\n   .Font.Allcaps = True\n   .Font.Size = 20    \nEnd With\nobjWord.Visible = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "edited": false, "score": 0, "creation_date": 1510131937, "post_id": 47175287, "comment_id": 81300005, "body": "So it does work but it opens a new word document. I need it to open an already created word document. I appreciate your help."}], "tags": [], "owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1510131334, "creation_date": 1510131334, "answer_id": 47175287, "question_id": 47174780, "link": "https://stackoverflow.com/questions/47174780/moving-excel-data-to-an-already-existing-word-document/47175287#47175287", "title": "Moving excel data to an already existing word document", "body": "<p>Below modified code works at my end, test it and let me know if it suffice your requirement.</p>\n\n<pre><code>Sub CopyRangeToWord()\n Dim objWord\n Dim objDoc\n\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc = objWord.Documents.Add\nSet wordApp = GetObject(\"C:\\Users\\CoffeeFuelsMeNow\\Documents\\Ladedadeda\\Testplate.dotx\")\nSet obj\u00adDoc = objWord.Documents\n\nobjWord.Visible = True\nRange(\"A1:B10\").Copy\n With objDoc.Paragraphs(objDoc.Paragraphs.Count).Range\n       'All formatting goes here\n    .Paste\n    .Font.Name = \"broadway\"\n    .Font.Color = wdColorBlue\n    .Font.Bold = True\n    .Font.Italic = True\n    .Font.Allcaps = True\n    .Font.Size = 10\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8905164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d17c8869200121e82f231fa986dca6?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeFuelsMeNow", "link": "https://stackoverflow.com/users/8905164/coffeefuelsmenow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 47175220, "answer_count": 2, "score": 0, "last_activity_date": 1510165461, "creation_date": 1510129603, "last_edit_date": 1510165461, "question_id": 47174780, "link": "https://stackoverflow.com/questions/47174780/moving-excel-data-to-an-already-existing-word-document", "title": "Moving excel data to an already existing word document", "body": "<p>This is my third day of using VBA. I am currently working a 3 month contract for this company and have figured out how to automatically transfer data from excel to a new word document (a process they have wanted for years). I also found out how to open an existing word document from excel.</p>\n\n<p>The thing is, I haven't worked out how to transfer data from excel to an existing word document. </p>\n\n<p>Below is the code I am trying to write for the above reason. Can anyone point out where I'm going wrong? Any and all answers would be greatly appreciated :)</p>\n\n<pre><code>Sub CopyRangeToWord()\nDim objWord As Word.Application\nDim objDoc As Word.Document\nSet wordApp = GetObject(\"C:\\Users\\CoffeeFuelsMeNow\\Documents\\Ladedadeda\\Testplate.dotx\")\n\nSet objDoc = objWord.Documents\nobjWord.Visible = True\nRange(\"A1:B10\").Copy\n With objDoc.Paragraphs(objDoc.Paragraphs.Count).Range\n       'All formatting goes here\n    .Paste\n    .Font.Name = \"broadway\"\n    .Font.Color = wdColorBlue\n    .Font.Bold = True\n    .Font.Italic = True\n     .Font.Allcaps = True\n     .Font.Size = 20\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510140389, "post_id": 47174422, "comment_id": 81305865, "body": "Drop down list isn&#39;t generate by code! If operator select filter sign with mouse problem is not appear. Only if operator choose to display filter form by keyboard I have this behavior. I don&#39;t know how to add code :( in comment, sorry"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510140463, "post_id": 47174422, "comment_id": 81305927, "body": "The code for the shortcut alt + down arrow ?"}, {"owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510140948, "post_id": 47174422, "comment_id": 81306259, "body": "shortcut alt+down arrow is a Excel built in shortcut"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510141128, "post_id": 47174422, "comment_id": 81306394, "body": "The filter form is accessed by the shortcut, this  is revealing the dropdown and it is this you can&#39;t get rid of?"}, {"owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1510141908, "post_id": 47174422, "comment_id": 81306882, "body": "Exact! In first phase operator move focus to C1 cell (page field cell). Then he press &#39;alt+down&#39; arrow shortcut to reveal filter form. Make him selection and hit &#39;Enter&#39;. Macro resize a table to fit pivottable length and move focus to first cell in databody of table. Issue is that drop down remain displayed!"}], "owner": {"reputation": 26, "user_id": 8904880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be92fae219d0158a070f5acc0fb0220?s=128&d=identicon&r=PG&f=1", "display_name": "Cip", "link": "https://stackoverflow.com/users/8904880/cip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510140901, "creation_date": 1510128063, "last_edit_date": 1510140901, "question_id": 47174422, "link": "https://stackoverflow.com/questions/47174422/cancel-alt-down-arrow-remaining-effect-from-vba-code", "title": "Cancel alt + down arrow: remaining effect from VBA code", "body": "<p>I have a pivot table with page field. I wrote a few lines of code under the Pivot Table update event to do something.</p>\n\n<p>When the page field filter is used via the keyboard, the filter form is accessed with the shortcut alt + down arrow typed on a page field cell. </p>\n\n<p>Code works fine and at end moves focus to a specific cell.</p>\n\n<p>Problem is that <code>alt + down</code> arrow effect remains! The cell is shown with a drop down list displayed and the operator needs to hit the escape key to continue working. I try to avoid this by adding a sendkeys {esc} line after, but the  sendkeys numlock bug is more annoying than having to directly hit the escape key.</p>\n\n<p>My question is: </p>\n\n<p><strong>Is there another way to close, using vba code, the drop down list displayed in final cell?</strong></p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n\n       Sheet1.ListObjects(\"precomanda\").Resize Range(Sheet1.ListObjects(\"precomanda\").HeaderRowRange, _\n       Sheet1.ListObjects(\"precomanda\").HeaderRowRange.Offset(Sheet1.PivotTables(\"Istoric\").PivotFields(\"Produs\").DataRange.Count, 0))\n    Sheet1.Range(\"A5\").Activate\n    Application.SendKeys (\"{ESC}\")\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/jZ3I5.jpg\" alt=\"remanent effect of alt down arrow\"></p>\n"}, {"tags": ["vba", "excel", "jpeg"], "comments": [{"owner": {"reputation": 329, "user_id": 7690917, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/b9e7b42a2a7abd3dd2ea0f8896c56fd2?s=128&d=identicon&r=PG&f=1", "display_name": "bub", "link": "https://stackoverflow.com/users/7690917/bub"}, "edited": false, "score": 0, "creation_date": 1510127665, "post_id": 47174220, "comment_id": 81297691, "body": "You&#39;re not disabling screen updating. What do you mean by &quot;step through the code&quot;? Executing it with F5 or stepping in by F8?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1510128990, "post_id": 47174220, "comment_id": 81298428, "body": "See <a href=\"https://stackoverflow.com/questions/42091390/vba-range-to-jpg-picture/42092375#42092375\" title=\"vba range to jpg picture\">stackoverflow.com/questions/42091390/vba-range-to-jpg-pictur&zwnj;&#8203;e/&hellip;</a>: <code>chartobj.Activate</code> before <code>.Paste</code> and <code>.Export</code>."}, {"owner": {"reputation": 105, "user_id": 8904957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KpsEt.png?s=128&g=1", "display_name": "Keagan Allan", "link": "https://stackoverflow.com/users/8904957/keagan-allan"}, "edited": false, "score": 0, "creation_date": 1510130605, "post_id": 47174220, "comment_id": 81299211, "body": "By step through I mean using F8, if I press F5 the resultant JPGs are whitespace."}, {"owner": {"reputation": 105, "user_id": 8904957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KpsEt.png?s=128&g=1", "display_name": "Keagan Allan", "link": "https://stackoverflow.com/users/8904957/keagan-allan"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1510130640, "post_id": 47174220, "comment_id": 81299234, "body": "@AxelRichter thank you for that link I will have a look now"}], "answers": [{"comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1510798284, "post_id": 47175403, "comment_id": 81591959, "body": "FWIW, you&#39;ll probably get a nicer rendering of the text in a smaller image file if you use PNG instead of JPG."}, {"owner": {"reputation": 105, "user_id": 8904957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KpsEt.png?s=128&g=1", "display_name": "Keagan Allan", "link": "https://stackoverflow.com/users/8904957/keagan-allan"}, "reply_to_user": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1510816661, "post_id": 47175403, "comment_id": 81598086, "body": "Thank you @JonPeltier. I was thinking about trying different formats in the export. I need to determine the format the destination file can accept."}], "tags": [], "owner": {"reputation": 105, "user_id": 8904957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KpsEt.png?s=128&g=1", "display_name": "Keagan Allan", "link": "https://stackoverflow.com/users/8904957/keagan-allan"}, "is_accepted": true, "score": 0, "last_activity_date": 1510131665, "creation_date": 1510131665, "answer_id": 47175403, "question_id": 47174220, "link": "https://stackoverflow.com/questions/47174220/exporting-data-and-charts-from-excel-worksheets-to-jpg/47175403#47175403", "title": "Exporting data and charts from Excel Worksheets to JPG", "body": "<p>Using the recommendation from Axel Richter the code now runs.\nI added the <code>ChartObj.Activate</code> before the <code>.Paste</code> and <code>.Export</code></p>\n\n<p>Question has been answered.\nFull Code Below in case anyone needs it.</p>\n\n<pre><code>Sub ExportImage()\n\n'Place all worksheets in an array\n\nDim ShtNames() As String\nReDim ShtNames(1 To ActiveWorkbook.Sheets.Count)\nFor i = 1 To Sheets.Count\nShtNames(i) = Sheets(i).Name\nNext i\n\nDim sFilePath As String\nDim sView As String\n\nDim WS As Worksheet, PntRng As Range, OffSetRw As Integer, OffSetClmn As Integer\n\ni = 1\n\n'step through each worksheet to export to JPG\n\nDo Until i = Sheets.Count + 1\n    Sheets(Sheets(i).Name).Activate\n\n    Sheets(Sheets(i).Name).UsedRange.Select\n    ActiveSheet.PageSetup.PrintArea = Selection.Address\n\n'Credit to Winand and Ryan from this link https://stackoverflow.com/questions/16143877/using-vba-code-how-to-export-excel-worksheets-as-image-in-excel-2003/28541252\n\n'Captures current window view\n    sView = ActiveWindow.View\n\n'Sets the current view to normal so there are no \"Page X\" overlays on the image\n    ActiveWindow.View = xlNormalView\n\n'Temporarily disable screen updating\n    Application.ScreenUpdating = False\n\n    Set Sheet = ActiveSheet\n\n'Set the file path to export the image to the user's desktop\n'I have to give credit to Kyle for this solution, found it here:\n'http://stackoverflow.com/questions/17551238/vba-how-to-save-excel-workbook-to-desktop-regardless-of-user\n    sFilePath = \"C:\\temp\\Match\\JPG\\\" &amp; ActiveSheet.Name &amp; \".jpg\"\n    Dim ChartObj As ChartObject\n'Export print area as correctly scaled PNG image, courtasy of Winand\n    zoom_coef = 100 / Sheet.Parent.Windows(1).Zoom\n    Set area = Sheet.Range(Sheet.PageSetup.PrintArea)\n    area.CopyPicture xlPrinter\n    Set ChartObj = Sheet.ChartObjects.Add(0, 0, area.Width * zoom_coef, area.Height * zoom_coef)\n    ChartObj.Activate\n    ChartObj.Chart.Paste\n    ChartObj.Chart.Export sFilePath, \"jpg\"\n    ChartObj.Delete\n\n'Returns to the previous view\n    ActiveWindow.View = sView\n\n'Re-enables screen updating\n    Application.ScreenUpdating = True\n\ni = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 8904957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KpsEt.png?s=128&g=1", "display_name": "Keagan Allan", "link": "https://stackoverflow.com/users/8904957/keagan-allan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "accepted_answer_id": 47175403, "answer_count": 1, "score": 0, "last_activity_date": 1510131665, "creation_date": 1510127238, "last_edit_date": 1510131395, "question_id": 47174220, "link": "https://stackoverflow.com/questions/47174220/exporting-data-and-charts-from-excel-worksheets-to-jpg", "title": "Exporting data and charts from Excel Worksheets to JPG", "body": "<p>I am trying to automate the process of exporting a series of Excel Worksheets to JPEG. </p>\n\n<p>The Sheets in question are monitoring points for borehole logs, containing both information in cells as well as charts showing trends. The exported JPEGs will be used in reports.</p>\n\n<p>I have taken the code from here:\n<a href=\"https://stackoverflow.com/questions/16143877/using-vba-code-how-to-export-excel-worksheets-as-image-in-excel-2003/28541252\">Using VBA Code how to export excel worksheets as image in Excel 2003?</a></p>\n\n<p>Modified it slightly to meet my needs. The script captures the worksheets in an array, and steps through the array setting the print area dynamically to allow the original code to run as intended.</p>\n\n<pre><code>    Sub ExportImage()\n\n'Place all worksheets in an array\n\nDim ShtNames() As String\nReDim ShtNames(1 To ActiveWorkbook.Sheets.Count)\nFor i = 1 To Sheets.Count\nShtNames(i) = Sheets(i).Name\nNext i\n\nDim sFilePath As String\nDim sView As String\n\n\ni = 1\n\n'step through each worksheet to export to JPG\n\nDo Until i = Sheets.Count + 1\n    Sheets(Sheets(i).Name).Activate\n\n    Sheets(Sheets(i).Name).UsedRange.Select\n    ActiveSheet.PageSetup.PrintArea = Selection.Address\n\n'Credit to Winand and Ryan from this link https://stackoverflow.com/questions/16143877/using-vba-code-how-to-export-excel-worksheets-as-image-in-excel-2003/28541252\n\n'Captures current window view\n    sView = ActiveWindow.View\n\n'Sets the current view to normal so there are no \"Page X\" overlays on the image\n    ActiveWindow.View = xlNormalView\n\n'Temporarily disable screen updating\n    Application.ScreenUpdating = True\n\n    Set Sheet = ActiveSheet\n\n'Set the file path to export the image to the user's desktop\n'I have to give credit to Kyle for this solution, found it here:\n'http://stackoverflow.com/questions/17551238/vba-how-to-save-excel-workbook-to-desktop-regardless-of-user\n    sFilePath = \"C:\\temp\\Match\\JPG\\\" &amp; ActiveSheet.Name &amp; \".jpg\"\n\n'Export print area as correctly scaled PNG image, courtasy of Winand\n    zoom_coef = 100 / Sheet.Parent.Windows(1).Zoom\n    Set area = Sheet.Range(Sheet.PageSetup.PrintArea)\n    area.CopyPicture xlPrinter\n    Set chartobj = Sheet.ChartObjects.Add(0, 0, area.Width * zoom_coef, area.Height * zoom_coef)\n    chartobj.Chart.Paste\n    chartobj.Chart.Export sFilePath, \"jpg\"\n    chartobj.Delete\n\n'Returns to the previous view\n    ActiveWindow.View = sView\n\n'Re-enables screen updating\n    Application.ScreenUpdating = True\n\ni = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>When I step through the code it works as intended, however if I run the code from a button click or shortcut the resultant images are whitespace.</p>\n\n<p>I am using Excel 2016, on a Windows 7 machine.\nI thought perhaps the code runs \"too quickly\" for the capture of the JPEG and put in small \"Sleep\" points, but that did not work.</p>\n\n<p>Are there alternatives to this code that I may have missed?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "edited": false, "score": 0, "creation_date": 1510127436, "post_id": 47173960, "comment_id": 81297545, "body": "It is possible with formulas but - in my opinion - very complex and either with very long formulas or 2-3 helper columns. VBA on the other side will be easy and readable."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1510127564, "post_id": 47173960, "comment_id": 81297623, "body": "You can try to record macro by yourself and use Basic Filter: apply filter to both columns A and B, set first value from column E to filter in column A, same thing for columns F and B. If there is a record on your filtered table, this is the one you want to delete. Delete these cells, shifting other cells up. Then check the recorded macro and try to improve it. Come back in case you will need help."}, {"owner": {"reputation": 6244, "user_id": 833232, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/597891901827be52a8da06e355e13bc2?s=128&d=identicon&r=PG&f=1", "display_name": "Monah", "link": "https://stackoverflow.com/users/833232/monah"}, "edited": false, "score": 0, "creation_date": 1510131421, "post_id": 47173960, "comment_id": 81299693, "body": "you can use <code>vlookup</code> to mark which records to delete? I can provide you the method if this will solve your problem"}, {"owner": {"reputation": 35, "user_id": 1649928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2930150d216d5ae4acdc4ed2afb27d2?s=128&d=identicon&r=PG", "display_name": "MathNovice", "link": "https://stackoverflow.com/users/1649928/mathnovice"}, "edited": false, "score": 0, "creation_date": 1510133891, "post_id": 47173960, "comment_id": 81301378, "body": "I am trying to do it using <code>vlookup</code>. I will get back with whatever I achieve."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 1649928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2930150d216d5ae4acdc4ed2afb27d2?s=128&d=identicon&r=PG", "display_name": "MathNovice", "link": "https://stackoverflow.com/users/1649928/mathnovice"}, "edited": false, "score": 0, "creation_date": 1510133969, "post_id": 47175873, "comment_id": 81301436, "body": "The problem is, I do have repeated entries in both columns individually but no pair (row values together in columns A &amp; B as a pair) repeats through out the data. It is not about repetition in individual columns. Selected pairs are to be deleted, and the selection has to be made from columns E and F. I hope its clear. Thanks for the attempt though."}, {"owner": {"reputation": 83, "user_id": 8854925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd814aa90330f508827afe1de6cc7f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Serversta", "link": "https://stackoverflow.com/users/8854925/serversta"}, "reply_to_user": {"reputation": 35, "user_id": 1649928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2930150d216d5ae4acdc4ed2afb27d2?s=128&d=identicon&r=PG", "display_name": "MathNovice", "link": "https://stackoverflow.com/users/1649928/mathnovice"}, "edited": false, "score": 0, "creation_date": 1510134188, "post_id": 47175873, "comment_id": 81301578, "body": "I notice it just now that what I give you will not help on your case. Vlookup is that answer to your problem maybe but I&#39;m not so much familiar with it. Hope someone could help you. Have a good day!"}], "tags": [], "owner": {"reputation": 83, "user_id": 8854925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd814aa90330f508827afe1de6cc7f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Serversta", "link": "https://stackoverflow.com/users/8854925/serversta"}, "is_accepted": false, "score": 1, "last_activity_date": 1510133091, "creation_date": 1510133091, "answer_id": 47175873, "question_id": 47173960, "link": "https://stackoverflow.com/questions/47173960/delete-duplicate-pair-of-rows-in-excel-by-comparison/47175873#47175873", "title": "Delete duplicate pair of rows in excel by comparison", "body": "<p>Sorry for just giving out a link to help. I forgot that it can be change anytime in the future. So here's the full steps that you are going to make in order to solve your problem.</p>\n\n<p>Steps:<br>\n<a href=\"https://i.stack.imgur.com/ZmsDL.jpg\" rel=\"nofollow noreferrer\">Use Conditional Formatting</a> <br>\n<a href=\"https://i.stack.imgur.com/CPz4L.jpg\" rel=\"nofollow noreferrer\">Use Filter function</a><br>\n<a href=\"https://i.stack.imgur.com/Bn2Gs.jpg\" rel=\"nofollow noreferrer\">Use Filter Color</a><br>\n<a href=\"https://i.stack.imgur.com/AFSxn.jpg\" rel=\"nofollow noreferrer\">Now you're done.</a><br></p>\n\n<p>Sorry if I can't embed the picture here because my reputation is still low. But give me a chance to help just like this. I deleted my previous post by the way. Thanks.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 1649928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2930150d216d5ae4acdc4ed2afb27d2?s=128&d=identicon&r=PG", "display_name": "MathNovice", "link": "https://stackoverflow.com/users/1649928/mathnovice"}, "edited": false, "score": 0, "creation_date": 1510142441, "post_id": 47179137, "comment_id": 81307192, "body": "@Monah: Thanks for the idea. I am sure there are better solutions possible. Kindly please do share if you have any ideas."}], "tags": [], "owner": {"reputation": 35, "user_id": 1649928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2930150d216d5ae4acdc4ed2afb27d2?s=128&d=identicon&r=PG", "display_name": "MathNovice", "link": "https://stackoverflow.com/users/1649928/mathnovice"}, "is_accepted": true, "score": 1, "last_activity_date": 1510142277, "creation_date": 1510142277, "answer_id": 47179137, "question_id": 47173960, "link": "https://stackoverflow.com/questions/47173960/delete-duplicate-pair-of-rows-in-excel-by-comparison/47179137#47179137", "title": "Delete duplicate pair of rows in excel by comparison", "body": "<p>One possible solution:<br>\n<strong>(1)</strong>: Concatenate columns A and B using <code>A2&amp;\" \"&amp;B2</code> with result in <code>C2</code>.<br>\n<strong>(2)</strong>: Likewise concatenate columns E and F.<br>\n<strong>(3)</strong>: In column D Use the formula: <code>IF(ISNA(VLOOKUP(C2,$I$4:$I$5,1,0)),\"No\", \"Yes\")</code>. It will compare two columns and print \"Yes\" for any value that matches and \"No\" if it doesn't. The formula is taken from the page <a href=\"https://www.exceltrick.com/formulas_macros/vlookup-in-excel/#Vlookup-Multiple\" rel=\"nofollow noreferrer\">link</a>.<br>\n<strong>(4)</strong>: Sort data in column D.<br>\n<strong>(5)</strong>: Delete the rows with \"Yes\".<br>\n<strong>(6)</strong>: Separate columns A and B again.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5moWr.jpg\" rel=\"nofollow noreferrer\">After Steps 1 - 3 </a></p>\n"}], "owner": {"reputation": 35, "user_id": 1649928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2930150d216d5ae4acdc4ed2afb27d2?s=128&d=identicon&r=PG", "display_name": "MathNovice", "link": "https://stackoverflow.com/users/1649928/mathnovice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 47179137, "answer_count": 2, "score": 1, "last_activity_date": 1510142277, "creation_date": 1510126344, "last_edit_date": 1531161705, "question_id": 47173960, "link": "https://stackoverflow.com/questions/47173960/delete-duplicate-pair-of-rows-in-excel-by-comparison", "title": "Delete duplicate pair of rows in excel by comparison", "body": "<p>I have data arranged in two columns like columns A and B in the picture. I want to delete certain pairs (rows) from the data. The pairs to be deleted are given in columns E and F. </p>\n\n<p>I am looking for a formula (or group of formulae) that can take information from column E and F and delete the respective pair from column A and B and shift cells up. Actual data has 7000 rows and to be deleted rows are near 200. </p>\n\n<p>I tried Conditional Formatting or Advanced Filter (It gives only headers when  I select Unique Records Only) but nothing seems to work. </p>\n\n<p>I have no knowledge of VB. So formulae/commands would be preferred if possible, please. Many Thanks for the help.</p>\n\n<p>Before Removing Rows :</p>\n\n<p><img src=\"https://i.stack.imgur.com/dUeeZ.jpg\" alt=\"Before Removing Rows\"></p>\n\n<p>After Removing Rows : </p>\n\n<p><img src=\"https://i.stack.imgur.com/JkRvY.jpg\" alt=\"After Removing Rows\"></p>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "edited": false, "score": 0, "creation_date": 1510129458, "post_id": 47173959, "comment_id": 81298652, "body": "On what part of the code did you opened the <code>userform</code>?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "reply_to_user": {"reputation": 397, "user_id": 7950833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/407c76d0b44d62e6ff0159337f2ecac9?s=128&d=identicon&r=PG&f=1", "display_name": "kulapo", "link": "https://stackoverflow.com/users/7950833/kulapo"}, "edited": false, "score": 0, "creation_date": 1510130251, "post_id": 47173959, "comment_id": 81299024, "body": "It s on another module (in personal Macro), and is only a sub with  &quot;My_userform.Show&quot; inside"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1510132469, "post_id": 47173959, "comment_id": 81300337, "body": "You should never use Unload Me, you should use Me.hide <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">rubberduckvba.wordpress.com/2017/10/25/userform1-show</a>"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1510134933, "post_id": 47173959, "comment_id": 81302103, "body": "Using Me.hide instead doesn t solve the problem if I put it at the end (I still don t understand why), but it does work if I leave it at the beginning."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1510138808, "post_id": 47173959, "comment_id": 81304771, "body": "Me.hide works for me"}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1510138865, "creation_date": 1510138865, "answer_id": 47177980, "question_id": 47173959, "link": "https://stackoverflow.com/questions/47173959/where-to-place-the-unload-me-to-make-the-private-sub-work/47177980#47177980", "title": "Where to place the unload me to make the Private sub work", "body": "<p>The following code in a userform works</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton3_Click()\n    Private_Sub\n'    If MsgBox(\"Hide form?\", vbYesNo, \"Test\") Then\n        Hide\n'    End If\nEnd Sub\n\n\nPrivate Sub Private_Sub()\n    Workbooks.Open Filename:=\"...Filename...\"\nEnd Sub\n</code></pre>\n\n<p>In order to test it put the following code in a genral module</p>\n\n<pre><code>Option Explicit\n\nSub frmTest()\n\n    Dim frm As UserForm1\n\n    Set frm = New UserForm1\n    frm.Show\n    Unload frm\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510138865, "creation_date": 1510126341, "last_edit_date": 1531164843, "question_id": 47173959, "link": "https://stackoverflow.com/questions/47173959/where-to-place-the-unload-me-to-make-the-private-sub-work", "title": "Where to place the unload me to make the Private sub work", "body": "<p>I am using a userform and have issue with the \"unload me\"</p>\n\n<p>If I place the \"unload me\" before my private sub => the private sub doesn t start</p>\n\n<p>If I place it after, I cannot click in the cell of the new workbook (which is what I see first on my screen when the macro is done)</p>\n\n<p>Where should I put the unload me to make it work properly?</p>\n\n<p>Code below:</p>\n\n<pre><code>Private Sub CommandButton3_click()\n\n        Private_Sub\n\nUnload Me\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Private_Sub()\n\n    Workbooks.Open Filename:=\"U:\\mydocuments\\Workbook.xlsx\"\n\nEnd Sub\n</code></pre>\n\n<p>Please tell me if I don t make myself clear enough.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 3, "last_activity_date": 1510608556, "last_edit_date": 1510608556, "creation_date": 1510567136, "answer_id": 47261567, "question_id": 47173786, "link": "https://stackoverflow.com/questions/47173786/excel-browsing-a-folder-and-automating-data-entry-into-a-default-template/47261567#47261567", "title": "Excel Browsing a folder and Automating Data Entry into a default template", "body": "<p>This looks problematic</p>\n\n<pre><code>Filename = (\"Test_Data_ \") &amp; Range(\"O1\").Value &amp; \";\" &amp;     Range(\"O11\").Value\nActiveWorkbook.SaveAs Filename:=Filename, FileFormat:=xlOpenXMLWorkbook\n</code></pre>\n\n<p>you need to add </p>\n\n<pre><code>&amp; \".xlsx\"\n</code></pre>\n\n<p>to the end of the top line to correctly form the workbook filename.</p>\n"}, {"comments": [{"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1510730800, "post_id": 47288257, "comment_id": 81554003, "body": "Can you elaborate on that; Are you getting an error message of some sort? Is the code breaking on that line? Is the format doing nothing, or is it formatting in a way you don&#39;t like?"}, {"owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1510732241, "post_id": 47288257, "comment_id": 81554693, "body": "Run Time Error 1004. You cannot save this workbook as the same name as another open workbook or add-in. Choose a different name or close the other workbook or add-in before saving. But the field C11 is different in all my existent file since is a date value that differs in every file"}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1510756227, "post_id": 47288257, "comment_id": 81570325, "body": "The error code is telling you exactly what is wrong. There exists another file with the same name in that directory. So could this be that you are getting multiple files containing the same date? If so (and they have a time in them as well, you could use <code>Format(InstDate,&quot;YYYMMDDHHMMSS&quot;)</code>. If they don&#39;t have a time in them, you could append the current timestamp to the date like so <code>Format(InstDate,&quot;YYYMMDD&quot;) &amp; FORMAT(NOW,&quot;&quot;HHMMSS&quot;)</code>."}, {"owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "reply_to_user": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1510756305, "post_id": 47288257, "comment_id": 81570390, "body": "If you are certain that the date is different in every file, it may be that the date format isn&#39;t being passed correctly. Add a watch on the filename and step through the code to see what filename is being assigned to the file."}], "tags": [], "owner": {"reputation": 396, "user_id": 5386426, "user_type": "registered", "accept_rate": 36, "profile_image": "https://lh4.googleusercontent.com/-lFMZBhUDRSI/AAAAAAAAAAI/AAAAAAAAABY/kLVScF5RQUg/photo.jpg?sz=128", "display_name": "AranDG", "link": "https://stackoverflow.com/users/5386426/arandg"}, "is_accepted": false, "score": 1, "last_activity_date": 1510669849, "creation_date": 1510669849, "answer_id": 47288257, "question_id": 47173786, "link": "https://stackoverflow.com/questions/47173786/excel-browsing-a-folder-and-automating-data-entry-into-a-default-template/47288257#47288257", "title": "Excel Browsing a folder and Automating Data Entry into a default template", "body": "<p>As per the previous answer, you will need to give your file an extension. But also, you are referencing your Ranges O1 and O11 softly (meaning your not specifying a sheet). If these values need to come from the file you are opening, I would reference them explicitly with <code>wb.Worksheets(1).Range(\"O1\").Value</code>. By the looks of it, you are inadvertently getting these values from the target sheet (see cell O11 in screenshot 2 and your fourth file down in screenshot 1).</p>\n\n<p>I would also be very cautious about putting a raw date in a filename. You would be better with a datestamp: <code>Filename = \"Test_Data_ \" &amp; InstID &amp; \";\" &amp; Format(InstDate,\"YYYYMMDD\") &amp; \".xlsx\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1510799597, "post_id": 47314802, "comment_id": 81592300, "body": "Hey, thanks helping with the codes &amp; commenting to further help me understand better. I have implemented the code and let the macro run. It does produce, the file  with the required properties I needed, however, after the first file, the rest of the files remove all content in the template &amp; just copied the data.  It also produces, the file &quot;Test SaveData_Tester_12_30_1899&quot;, which have nothing in it. Just blank. Files are saved in the path retrieved from, instead of specified path"}, {"owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1510799698, "post_id": 47314802, "comment_id": 81592320, "body": "The link below will give a better understanding. Containing the amended code &amp; picture of the files produce as well as folder in which files produced are saved in.   <a href=\"https://www.dropbox.com/sh/69fvbgjknuol4td/AAAdARGKNGDc127Tbhz56bb5a?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/sh/69fvbgjknuol4td/AAAdARGKNGDc127Tbhz56bb5a?dl=&zwnj;&#8203;0</a>"}, {"owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "reply_to_user": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1510855264, "post_id": 47314802, "comment_id": 81624241, "body": "I see, did  you try to create a different folder for all your soure files?  The macro above will loop all the existing files on the specified folder. As you can see your source file is together with your template that runs your Macro. Meaning to say that it loops your template that runs the macro. Notice the end of the routine, it is emptying the used range of the template thus making an empty output file.  Try to make a directory like this, create a folder for your source files and another folder for your output files. Now you will have two different folders that the macro will target."}], "tags": [], "owner": {"reputation": 281, "user_id": 2857338, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6d5e21d7f25573f28a85b386a3befa29?s=128&d=identicon&r=PG&f=1", "display_name": "BLitE.exe", "link": "https://stackoverflow.com/users/2857338/blite-exe"}, "is_accepted": false, "score": 1, "last_activity_date": 1510770771, "creation_date": 1510770771, "answer_id": 47314802, "question_id": 47173786, "link": "https://stackoverflow.com/questions/47173786/excel-browsing-a-folder-and-automating-data-entry-into-a-default-template/47314802#47314802", "title": "Excel Browsing a folder and Automating Data Entry into a default template", "body": "<p>Hi Please correct me if I'm wrong. Okay here's the thing that I understand based on your explanation.</p>\n\n<p>First you have a Template (wbTemplate), and then a set of other workbooks that you need to open and pre-format it based on the template given then save it on your target path.</p>\n\n<p>You need to practice in setting all your objects dynamically. </p>\n\n<p>I put comments on every line so you may understand how this works.</p>\n\n<p>{ </p>\n\n<pre><code> Sub LoopAllExcelFilesInFolder()\n 'PURPOSE: To loop through all Excel files in a user specified folder and             perform a set task on them\n 'SOURCE: www.TheSpreadsheetGuru.com\n\n Dim wbTemplate As Workbook, wbSourceFile As Workbook\n Dim wsTemplate As Worksheet, wsSourceFile As Worksheet\n Dim SourceFileEndRow As Long, TemplateEndRow As Long\n Dim myPath As String, myFile As String 'This is where the Source File      located\n Dim myExtension As String\n Dim FldrPicker As FileDialog\n Dim InstID As String\n Dim InstDate As Date\n Dim InstBR As String\n Dim targetPath As String 'Set this to where you want to save all the output files\n\n Set wbTemplate = ThisWorkbook\n Set wsTemplate = ThisWorkbook.Sheets(1) ' Input the Index no. of your      Template, or much better to rename it based on the Name of the Template Tab\n targetPath = \"C:\\Users\\Enrerol\\Desktop\\Tester\\TargetPath\\\" 'Set where you want to save your Output File\n 'Optimize Macro Speed\n   Application.ScreenUpdating = False\n   Application.EnableEvents = False\n   Application.Calculation = xlCalculationManual\n\n 'Retrieve Target Folder Path From User\n   Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\n With FldrPicker\n   .Title = \"Select A Target Folder\"\n   .AllowMultiSelect = False\n     If .Show &lt;&gt; -1 Then GoTo NextCode\n     myPath = .SelectedItems(1) &amp; \"\\\"\n End With\n\n 'In Case of Cancel\n NextCode:\n   myPath = myPath\n   If myPath = \"\" Then GoTo ResetSettings\n\n     'Target File Extension (must include wildcard \"*\")\n   myExtension = \"*.xls*\"\n\n   'Target Path with Ending Extention\n   myFile = Dir(myPath &amp; myExtension)\n\n 'Loop through each Excel file in folder\n   Do While myFile &lt;&gt; \"\"\n 'Set variable equal to opened workbook\n   Set wbSourceFile = Workbooks.Open(Filename:=myPath &amp; myFile) ' Set our      SourceFile\n   Set wsSourceFile = wbSourceFile.Worksheets(1) 'Set the Worksheet that we      are copying\n 'Ensure Workbook has opened before moving on to next line of code\n   DoEvents\n\n 'Input Code Here\n\n   InstID = wsSourceFile.Range(\"O1\")\n   InstDate = wsSourceFile.Range(\"O11\")\n   InstBR = \"Base Reading\"\n SourceFileEndRow = wsSourceFile.Range(\"B\" &amp; Rows.Count).End(xlUp).Row '      This to  make sure that you have a dynamic range; it will get the last row used      of the Source File\n   wsSourceFile.Range(\"B15:E\" &amp; SourceFileEndRow).Copy      Destination:=wsTemplate.Range(\"M6\")\n TemplateEndRow = wsTemplate.Range(\"M\" &amp; Rows.Count).End(xlUp).Row 'We will      get the last used row of our Destination Column\n   wsTemplate.Range(\"E6:F\" &amp; TemplateEndRow) = InstID\n   wsTemplate.Range(\"K6:K\" &amp; TemplateEndRow) = InstDate\n   wsTemplate.Range(\"J6\") = InstBR\n\n Filename = (\"Test_Data_\") &amp; InstID &amp; \"_\" &amp; Format(InstDate, \"m_d_yyyy\") '      You need to change this, because there will be an error on your existing format.      Specially the instdate is Formated as \"dd/mm/yyyy\"\n Application.DisplayAlerts = False 'We will need to stop the prompting of      the excel application\n wbTemplate.SaveAs Filename:=targetPath &amp; Filename,      FileFormat:=xlOpenXMLWorkbook\n Application.DisplayAlerts = True 'Reset application Values\n 'Save and Close Workbook\n\n wbSourceFile.Close SaveChanges:=True\n wsTemplate.UsedRange.Delete\n 'Ensure Workbook has closed before moving on to next line of code\n   DoEvents\n\n 'Get next file name\n   myFile = Dir\n   Loop\n\n 'Message Box when tasks are completed\n   MsgBox \"Task Complete!\"\n\n ResetSettings:\n   'Reset Macro Optimization Settings\n Application.EnableEvents = True\n Application.Calculation = xlCalculationAutomatic\n Application.ScreenUpdating = True\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1511050577, "creation_date": 1510125711, "last_edit_date": 1511050577, "question_id": 47173786, "link": "https://stackoverflow.com/questions/47173786/excel-browsing-a-folder-and-automating-data-entry-into-a-default-template", "title": "Excel Browsing a folder and Automating Data Entry into a default template", "body": "<p>I been reading up codes available on the net from various sources and have debug with self-taught programming to make it work but I'm having difficulty proceeding on.</p>\n\n<p>As you can see, it comes from a source. Browsing a folder &amp; reading the files works fine with the code, I need to copy values from this folder &amp; paste it into the default template as assigned in the code &amp; save the file with with a default format and alongside values from a cell(O1) &amp; (O11) assign in the code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HUV2Y.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HUV2Y.jpg\" alt=\"Saved format of files\"></a></p>\n\n<p>As you can see, is not saved as xlsx and neither is it saving with the values from cell specified.</p>\n\n<p>Next, automating data entry to assigned field. Only first 3 files are able to copy exactly what I want. The rest inputs wrong data, as shown in the image below. Additionally, I also need to copy values from cell N15:O83 read from files in  folder, into template Column AA &amp; AB starting from row 6 respectively.</p>\n\n<p>Thanks in advance for any assistance provided.</p>\n\n<p><strong>Sample Source File</strong>\n<a href=\"https://i.stack.imgur.com/35RYI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/35RYI.jpg\" alt=\"Data To Extract\"></a>\n<strong>Correct Automation</strong>\n<a href=\"https://i.stack.imgur.com/sWyoO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sWyoO.jpg\" alt=\"Correct Automation\"></a>\n<strong>Wrong Automation</strong>\n<a href=\"https://i.stack.imgur.com/ymV2F.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ymV2F.jpg\" alt=\"Wrong Automation\"></a></p>\n\n<p><strong>Macro Code</strong></p>\n\n<pre><code>Sub LoopAllExcelFilesInFolder()\n'PURPOSE: To loop through all Excel files in a user specified folder and             perform a set task on them\n'SOURCE: www.TheSpreadsheetGuru.com\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\nDim InstID As String\nDim InstDate As Date\nDim InstBR As String\n\n\n\n\n'Optimize Macro Speed\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n  Application.Calculation = xlCalculationManual\n\n'Retrieve Target Folder Path From User\n  Set FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith FldrPicker\n  .Title = \"Select A Target Folder\"\n  .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n'In Case of Cancel\nNextCode:\n  myPath = myPath\n  If myPath = \"\" Then GoTo ResetSettings\n\n    'Target File Extension (must include wildcard \"*\")\n  myExtension = \"*.xls*\"\n\n  'Target Path with Ending Extention\n  myFile = Dir(myPath &amp; myExtension)\n\n'Loop through each Excel file in folder\n  Do While myFile &lt;&gt; \"\"\n'Set variable equal to opened workbook\n  Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n'Ensure Workbook has opened before moving on to next line of code\n  DoEvents\n\n'Input Code Here\n\n  InstID = Range(\"O1\")\n  InstDate = Range(\"O11\")\n  InstBR = \"Base Reading\"\n\n  wb.Worksheets(1).Range(\"B15:E83\").Copy\n  Workbooks.Add template:=\"C:\\Users\\PC1\\Desktop\\Daily data file\\Inc\\TestTemplate.xlsx\"\n  Sheets(ActiveSheet.Index + 1).Activate\n  If Err.Number &lt;&gt; 0 Then Sheets(1).Activate\n  Range(\"M6\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n    Range(\"E6:F76\") = InstID\n    Range(\"K6:K76\") = InstDate\n    Range(\"J6\") = InstBR\n\nChDir (\"C:\\Users\\PC\\Desktop\\Daily data file\\Inc\\INC22001 - Copy\\Test Save\") ' Directory you need to save the file as xlsm\nFilename = (\"Test_Data_ \") &amp; Range(\"O1\").Value &amp; \";\" &amp;     Range(\"O11\").Value\nActiveWorkbook.SaveAs Filename:=Filename, FileFormat:=xlOpenXMLWorkbook\n\n'Save and Close Workbook\n  wb.Close SaveChanges:=True\n\n'Ensure Workbook has closed before moving on to next line of code\n  DoEvents\n\n'Get next file name\n  myFile = Dir\n  Loop\n\n'Message Box when tasks are completed\n  MsgBox \"Task Complete!\"\n\nResetSettings:\n  'Reset Macro Optimization Settings\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510113882, "post_id": 47171162, "comment_id": 81292356, "body": "Copy, Paste Special Transpose?"}, {"owner": {"reputation": 187, "user_id": 4526433, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-w4Vacte3sUA/AAAAAAAAAAI/AAAAAAAAAko/vcaAhItjsNQ/photo.jpg?sz=128", "display_name": "Ben Logan", "link": "https://stackoverflow.com/users/4526433/ben-logan"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510114269, "post_id": 47171162, "comment_id": 81292466, "body": "Entirely automated..15-20 rosters every month, 1 week per sheet. Different staff levels per roster."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 4526433, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-w4Vacte3sUA/AAAAAAAAAAI/AAAAAAAAAko/vcaAhItjsNQ/photo.jpg?sz=128", "display_name": "Ben Logan", "link": "https://stackoverflow.com/users/4526433/ben-logan"}, "edited": false, "score": 0, "creation_date": 1510234203, "post_id": 47171615, "comment_id": 81354583, "body": "Sorry for the wonky description. That code works no problem at all, thanks!"}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 1, "last_activity_date": 1510117670, "last_edit_date": 1510117670, "creation_date": 1510115358, "answer_id": 47171615, "question_id": 47171162, "link": "https://stackoverflow.com/questions/47171162/copy-data-from-one-sheet-to-another-based-on-names-and-dates/47171615#47171615", "title": "Copy data from one sheet to another based on names and dates", "body": "<p>Something like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CopyTranspose(ByVal prgnSourceTopLeftCell As Excel.Range, ByVal prngDestinationTopLeftCell As Excel.Range)\n    Dim lastRow As Long\n    Dim lastCol As Long\n\n    With prgnSourceTopLeftCell.Worksheet\n        lastRow = .Cells(.Rows.Count, prgnSourceTopLeftCell.Column).End(xlUp).Row\n        lastCol = .Cells(prgnSourceTopLeftCell.Row, .Columns.Count).End(xlToLeft).Column\n        .Range(prgnSourceTopLeftCell, .Cells(lastRow, lastCol)).Copy\n    End With\n\n    prngDestinationTopLeftCell.PasteSpecial xlPasteAll, Transpose:=True\n\n    Application.CutCopyMode = False\nEnd Sub\n\nPublic Sub Demo()\n    CopyTranspose ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1), ThisWorkbook.Worksheets(\"Sheet2\").Cells(1, 1)\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong>: I see you did submit nice questions along with code in the past, so I guess it was just getting late :-)</p>\n"}], "owner": {"reputation": 187, "user_id": 4526433, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-w4Vacte3sUA/AAAAAAAAAAI/AAAAAAAAAko/vcaAhItjsNQ/photo.jpg?sz=128", "display_name": "Ben Logan", "link": "https://stackoverflow.com/users/4526433/ben-logan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1510128973, "accepted_answer_id": 47171615, "answer_count": 1, "score": -1, "last_activity_date": 1510117670, "creation_date": 1510112146, "last_edit_date": 1531161705, "question_id": 47171162, "link": "https://stackoverflow.com/questions/47171162/copy-data-from-one-sheet-to-another-based-on-names-and-dates", "closed_reason": "Needs more focus", "title": "Copy data from one sheet to another based on names and dates", "body": "<p>So I have two sheets. Both are rosters. One has dates across the top, names down the left. The other is the opposite. I need to copy the data from the latter to the former. I could hardcode the copy cell to cell, the problem is the amount of staff changes from roster to roster. What would be the best approach to complete this? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510112375, "post_id": 47171068, "comment_id": 81291956, "body": "I&#39;ve read your post twice, no idea what the question is. Can you <a href=\"https://stackoverflow.com/posts/47171068/edit\">edit</a> to carify?"}, {"owner": {"reputation": 39, "user_id": 8289821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5369baba8851cba235d5aefc82202d4?s=128&d=identicon&r=PG&f=1", "display_name": "suzie_q", "link": "https://stackoverflow.com/users/8289821/suzie-q"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510113214, "post_id": 47171068, "comment_id": 81292186, "body": "I&#39;ve edited it, please let me know if you need more clarification!"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8289821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5369baba8851cba235d5aefc82202d4?s=128&d=identicon&r=PG&f=1", "display_name": "suzie_q", "link": "https://stackoverflow.com/users/8289821/suzie-q"}, "edited": false, "score": 0, "creation_date": 1510119130, "post_id": 47171468, "comment_id": 81293847, "body": "This was super helpful and I figured out my issue soon after: sadly, I do have to keep the format of two text boxes (despite the heavy amount of human error possibility) but the work you suggested with filepath as a Name put me on the perfect path. Kudos &lt;3"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1510115677, "last_edit_date": 1510115677, "creation_date": 1510114390, "answer_id": 47171468, "question_id": 47171068, "link": "https://stackoverflow.com/questions/47171068/vba-excel-specify-path-to-import-text-file-via-text-box-on-userform/47171468#47171468", "title": "VBA Excel: Specify Path To Import Text File Via Text Box on Userform", "body": "<blockquote>\n  <p>but I have a userform that allows user input for 3 things: the path in which a text file is located, the name of the text file, and the location in which to import the data from the text file.</p>\n</blockquote>\n\n<p>I can't think of any good reason to separate the path and the file name, especially when doing so invites lots of opportunity for user error, which means you'll have to add a lot of error-handling logic to deal with fat-fingered or mistyped filenames, or paths, adding or ensuring the consistent use of a path separator at the end of the path (or not) for your subsequent concatenation, etc., etc.</p>\n\n<p>Something like this should set you on the right track. Use one of the <code>TextBox</code> events to invoke the <code>Application.FileDialog(msoFileDialogFilePicker)</code>, return the value (being the <em>full path</em>) to the selected item to the <code>TextBox</code>. </p>\n\n<pre><code>Private Sub TextBox1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n' this event fires when user clicks in the textbox\n' you may need to use other events also, but this is to illustrate\n' call the procedure that actually does the work:\nTextBox1.Value = getFileToOpen\nEnd Sub\nPrivate Function getFileToOpen()\n' this function opens the FileDialog and returns the name of the selected file\nDim fileName As String\nDim fdlg As FileDialog\nDim f As FileDialogFilter\nSet fdlg = Application.FileDialog(msoFileDialogFilePicker)\nfdlg.Filters.Clear\nSet f = fdlg.Filters.Add(\"Text Files\", \"*.txt\", 1)\nfdlg.FilterIndex = 1\nIf fdlg.Show Then\n    fileName = fdlg.SelectedItems(1)\nEnd If\ngetFileToOpen = fileName\n\nEnd Function\n</code></pre>\n\n<p>If you <em>absolutely</em> must maintain the two <code>TextBox</code> approach, then parse the resulting value from the <code>getFileToOpen</code> function and assign to the several text boxes as needed.</p>\n\n<p>Also, your <code>DestinationTextBox.Value</code> should be a <code>RefEdit</code> control, not a <code>TextBox</code>. The <code>RefEdit</code> control is specifically designed for allowing the user to select a range of cell(s).</p>\n\n<p>Assuming a 1004 error with your QueryTable, one likely culprit is that you've provided the <em>path</em> but not the <em>name</em> of the file. When you do this:</p>\n\n<pre><code>filePath = Dir(FileLocationTextBox.Value)\n</code></pre>\n\n<p><code>filePath</code> now represents <em>not</em> a <em>path</em>, but a file <code>Name</code>! So the identifier <code>filePath</code> is confusing, because that's not what it contains. </p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:=\"TEXT;\" &amp; _\n    filePath\n</code></pre>\n\n<p>And unless this file <em>name</em> exists in the active workbook's directory (unlikely, but possible) a 1004 error is the only possible result of this code, becuase the file you're referring to in the <code>filePath</code> variable doesn't exist in the active directory.  </p>\n\n<p>(technically this <em>could</em> resolve to a file in the working directory only, but odds are that no such filename exists</p>\n\n<p>Instead, building upon the solution I offered above (using <code>FileDialog</code> to ensure you have a valid filepath/filename to use, without relying on clumsy user input), do this:</p>\n\n<pre><code>Dim fullFileName as String\nfullFileName = TextFileNameTextBox.Value\n' Make sure there's a value here\nIf fullFileName = vbNullString Then Exit Sub\n' double-check that it's a valid path:\nIf Len(Dir(fullFileName)) = 0 Then Exit Sub\n\nWith ActiveSheet.QueryTables.Add(Connection:=\"TEXT;\" &amp; _\n    fullFileName &amp; , ...\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 8289821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5369baba8851cba235d5aefc82202d4?s=128&d=identicon&r=PG&f=1", "display_name": "suzie_q", "link": "https://stackoverflow.com/users/8289821/suzie-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1586, "favorite_count": 0, "accepted_answer_id": 47171468, "answer_count": 1, "score": 0, "last_activity_date": 1510115677, "creation_date": 1510111330, "last_edit_date": 1510113824, "question_id": 47171068, "link": "https://stackoverflow.com/questions/47171068/vba-excel-specify-path-to-import-text-file-via-text-box-on-userform", "title": "VBA Excel: Specify Path To Import Text File Via Text Box on Userform", "body": "<p>Okay I know this is a really stupid way to do this, but I have a userform that allows user input for 3 things: the path in which a text file is located, the name of the text file, and the location in which to import the data from the text file. What I want to do is to follow the path that the user inputs, get the text file via the name the user inputs, and place whatever the text file contains into the range that the user inputs.</p>\n\n<p>I know it can be easily be simplified using Application.GetOpenFilename, but you gotta do what you gotta do. What I need to do is to be able to specify the path, specify the text file, and the location in which to load all of the text from a text file into a range with comma delimiters. Currently the program either breaks on the line \".Refresh BackgroundQuery:=False\" or doesn't do anything at all, and I don't know how to move forward. My code is as follows- apologies for the messiness. Please let me know if you can help!</p>\n\n<pre><code>Private Sub OKButton_Click()\n\nDim filePath As String, destin As String, fileName As Variant\n\ndestin = DestinationTextBox.Value\nfileName = TextFileNameTextBox.Value\n\nfilePath = Dir(FileLocationTextBox.Value)\n\n'filePath = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\")\n'oh, if only\n\n    With ActiveSheet.QueryTables.Add(Connection:=\"TEXT;\" &amp; _\n    filePath, Destination:=Range(destin))\n        .Name = fileName &amp; \".txt\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierNone\n        .TextFileConsecutiveDelimiter = True\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileOtherDelimiter = \"\" &amp; Chr(10) &amp; \"\"\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, _\n           1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n           1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n           1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["shell", "ms-access", "vba", "psexec"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1510129126, "post_id": 47170914, "comment_id": 81298493, "body": "Your code doesn&#39;t compile. I guess you miss <code>Option Explicit</code> in your module since a variable like <code>svrUname</code> exists."}, {"owner": {"reputation": 11, "user_id": 7743038, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-RgnDj_iuPDs/AAAAAAAAAAI/AAAAAAAAFP8/KeEzYggv3sM/photo.jpg?sz=128", "display_name": "Pinky Pal-lingayan", "link": "https://stackoverflow.com/users/7743038/pinky-pal-lingayan"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1510131617, "post_id": 47170914, "comment_id": 81299831, "body": "I have it declared after the Options. My code have Option Compare Database and Option Explicit."}, {"owner": {"reputation": 11, "user_id": 7743038, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-RgnDj_iuPDs/AAAAAAAAAAI/AAAAAAAAFP8/KeEzYggv3sM/photo.jpg?sz=128", "display_name": "Pinky Pal-lingayan", "link": "https://stackoverflow.com/users/7743038/pinky-pal-lingayan"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1510131704, "post_id": 47170914, "comment_id": 81299885, "body": "Without using PSEXEC, &quot;WMIC logicaldisk get caption, size, freespace&quot;, it displays completely and acess can read the complete result."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1510134023, "post_id": 47170914, "comment_id": 81301471, "body": "Still, it cannot compile. And <code>sCmd</code> is declared twice."}, {"owner": {"reputation": 11, "user_id": 7743038, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-RgnDj_iuPDs/AAAAAAAAAAI/AAAAAAAAFP8/KeEzYggv3sM/photo.jpg?sz=128", "display_name": "Pinky Pal-lingayan", "link": "https://stackoverflow.com/users/7743038/pinky-pal-lingayan"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1510186483, "post_id": 47170914, "comment_id": 81333093, "body": "Same result. I deleted the duplicate declaration of sCmd. I updated the my post"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7743038, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-RgnDj_iuPDs/AAAAAAAAAAI/AAAAAAAAFP8/KeEzYggv3sM/photo.jpg?sz=128", "display_name": "Pinky Pal-lingayan", "link": "https://stackoverflow.com/users/7743038/pinky-pal-lingayan"}, "edited": false, "score": 0, "creation_date": 1510645578, "post_id": 47200040, "comment_id": 81510812, "body": "it&#39;s because the loop you set is For i=0 to 0 and svr(0, 0) = &quot;&quot;. You did not used the PSEXEC which is in svr(1, 0). The result you got was from the pc you&#39;re using, not from a remote pc.."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 11, "user_id": 7743038, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-RgnDj_iuPDs/AAAAAAAAAAI/AAAAAAAAFP8/KeEzYggv3sM/photo.jpg?sz=128", "display_name": "Pinky Pal-lingayan", "link": "https://stackoverflow.com/users/7743038/pinky-pal-lingayan"}, "edited": false, "score": 0, "creation_date": 1510676806, "post_id": 47200040, "comment_id": 81531859, "body": "Can&#39;t tell. I don&#39;t have PSEXEC on my Windows 10 machines."}, {"owner": {"reputation": 11, "user_id": 7743038, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-RgnDj_iuPDs/AAAAAAAAAAI/AAAAAAAAFP8/KeEzYggv3sM/photo.jpg?sz=128", "display_name": "Pinky Pal-lingayan", "link": "https://stackoverflow.com/users/7743038/pinky-pal-lingayan"}, "edited": false, "score": 0, "creation_date": 1510878395, "post_id": 47200040, "comment_id": 81635002, "body": "My question is about using PSEXEC within MS Access. And EXTRACTINFO sub function has nothing to do with the result of the msgbox displayed above"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 11, "user_id": 7743038, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-RgnDj_iuPDs/AAAAAAAAAAI/AAAAAAAAFP8/KeEzYggv3sM/photo.jpg?sz=128", "display_name": "Pinky Pal-lingayan", "link": "https://stackoverflow.com/users/7743038/pinky-pal-lingayan"}, "edited": false, "score": 0, "creation_date": 1510910308, "post_id": 47200040, "comment_id": 81645935, "body": "I don&#39;t think you can do that, as psexec opens a new process, so your output will be that of psexec, not that of WMIC. But you can run a command script and write the result to a file - see edited answer."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1510910476, "last_edit_date": 1510910476, "creation_date": 1510225019, "answer_id": 47200040, "question_id": 47170914, "link": "https://stackoverflow.com/questions/47170914/is-it-possible-to-successfully-get-results-when-running-psexec-in-ms-access-usin/47200040#47200040", "title": "Is it possible to successfully get results when running PsExec in MS Access using Shell.Exec()?", "body": "<p>If I run this code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub First()\n\n    Const svrUname = \"username\"\n    Const svrPass = \"password\"\n    Const ForReading = 1\n\n    Dim svr(2, 1) As String\n\n    svr(0, 0) = \"\"\n    svr(0, 1) = \"server name\"\n    svr(1, 0) = \"PSEXEC \\\\(IPADD) -u \" &amp; svrUname &amp; \" -p \" &amp; svrPass\n    svr(1, 1) = \"\"\n\n    Dim i As Integer\n    For i = 0 To 0\n        Call ShellRun(svr(i, 0) &amp; \"WMIC logicaldisk get size, caption, \" _\n        &amp; \"freespace\", svr(i, 1))\n    Next\n\nEnd Sub\n\nPublic Sub ShellRun(sCmd As String, svrName As String)\n\n    '  Run a shell command, returning the output as a string\n    Dim oShell As Object\n    Dim oExec As Object\n    Dim oOutput As Object\n    Dim a As String\n\n    ' Run command\n    Set oShell = CreateObject(\"Wscript.Shell\")\n    Set oExec = oShell.Exec(sCmd)\n    Set oOutput = oExec.StdOut\n\n    ' handle the results as they are written to and read from the StdOut object\n    Dim sInfo As String\n    Dim sLine As String\n\n    While Not oOutput.AtEndofStream\n        sLine = oOutput.Readline\n        'Call EXTRACTINFO(sLine, svrName)\n        a = a &amp; sLine\nSKIP:\n    Wend\n    MsgBox a\n    oExec.Terminate\n\nEnd Sub\n</code></pre>\n\n<p>it returns:</p>\n\n<p><a href=\"https://i.stack.imgur.com/v2npI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/v2npI.png\" alt=\"enter image description here\"></a></p>\n\n<p>So double-check your EXTRACTINFO function.</p>\n\n<p><strong>Command file:</strong></p>\n\n<pre><code>C:\\Folder\\PsExec \\\\server -u user -p password WMIC logicaldisk get size, caption, freespace &gt; C:\\SomeFolder\\DiskSize.txt\n</code></pre>\n\n<p>Then read this file.</p>\n"}], "owner": {"reputation": 11, "user_id": 7743038, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-RgnDj_iuPDs/AAAAAAAAAAI/AAAAAAAAFP8/KeEzYggv3sM/photo.jpg?sz=128", "display_name": "Pinky Pal-lingayan", "link": "https://stackoverflow.com/users/7743038/pinky-pal-lingayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594638798, "creation_date": 1510110235, "last_edit_date": 1594638798, "question_id": 47170914, "link": "https://stackoverflow.com/questions/47170914/is-it-possible-to-successfully-get-results-when-running-psexec-in-ms-access-usin", "title": "Is it possible to successfully get results when running PsExec in MS Access using Shell.Exec()?", "body": "<p>I'm trying to get the disk status of few servers using PSEXEC for the command in shell and append it to the table. But I only get the caption from the shell result. </p>\n\n<p>here is my code: </p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nConst svrUname = \"username\"\nConst svrPass = \"password\"\nConst ForReading = 1\n\nSub First()\n    Dim svr(2, 1) As String\n\n    svr(0, 0) = \"\"\n    svr(0, 1) = \"server name\"\n    svr(1, 0) = \"PSEXEC \\\\(IPADD) -u \" &amp; svrUname &amp; \" -p \" &amp; svrPass \" \n    svr(1, 1) = \"\"\n\n    Dim i As Integer\n    For i = 0 To 1\n        Call ShellRun(svr(i, 0) &amp; \"WMIC logicaldisk get size, caption, \" _ \n        &amp; \"freespace\", svr(i, 1))\n\n    Next\n\nEnd Sub\nPublic Sub ShellRun(sCmd As String, svrName As String)\n        '  Run a shell command, returning the output as a string\n        Dim oShell As Object\n        Dim oExec As Object\n        Dim oOutput As Object\n        Dim a As String\n\n        ' Run command\n        Set oShell = CreateObject(\"Wscript.Shell\")\n        Set oExec = oShell.Exec(sCmd)\n        Set oOutput = oExec.StdOut\n\n        ' handle the results as they are written to and read from the StdOut object\n        Dim sInfo As String\n        Dim sLine As String\n\n        While Not oOutput.AtEndofStream\n            sLine = oOutput.Readline\n        Call EXTRACTINFO(sLine, svrName) \n        a = a &amp; sLine\nSKIP:\n    Wend\n    MsgBox a\n    oExec.Terminate\n\nEnd Sub\n</code></pre>\n\n<p>and the result is only like this\u3000<a href=\"https://i.stack.imgur.com/3LCuG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3LCuG.png\" alt=\"and the result is only like this\"></a></p>\n\n<p>I was hoping to get these results when run from MS access\n<a href=\"https://i.stack.imgur.com/vayty.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vayty.png\" alt=\"enter image description here\"></a></p>\n\n<p>What seems to be the problem?</p>\n"}, {"tags": ["vba", "excel", "integer", "type-mismatch"], "comments": [{"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 0, "creation_date": 1510112057, "post_id": 47170684, "comment_id": 81291869, "body": "To clarify, you&#39;re trying to count the number of <i>unique values</i> within a range? Or count the number of cells which are a <i>specific</i> value?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8903734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf497d73528164e9475817cacb13a7c?s=128&d=identicon&r=PG&f=1", "display_name": "DP1242", "link": "https://stackoverflow.com/users/8903734/dp1242"}, "edited": false, "score": 0, "creation_date": 1510108971, "post_id": 47170711, "comment_id": 81291015, "body": "I understand that, however as it is within a sumproduct, it should work? See here: <a href=\"https://exceljet.net/formula/count-unique-values-in-a-range-with-countif\" rel=\"nofollow noreferrer\">exceljet.net/formula/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 8903734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf497d73528164e9475817cacb13a7c?s=128&d=identicon&r=PG&f=1", "display_name": "DP1242", "link": "https://stackoverflow.com/users/8903734/dp1242"}, "edited": false, "score": 0, "creation_date": 1510111788, "post_id": 47170711, "comment_id": 81291796, "body": "@DP1242 being nested in another function call doesn&#39;t change a function&#39;s arguments. The 2nd argument cannot be a range; whether it&#39;s nested in a SUMPRODUCT or a WHATHAVEYA is completely irrelevant."}, {"owner": {"reputation": 161, "user_id": 7783436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086ff93844797bf4e9b4f55f9d45636c?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/7783436/matt"}, "edited": false, "score": 0, "creation_date": 1510113259, "post_id": 47170711, "comment_id": 81292197, "body": "It appears that there is a significant difference between the <code>COUNTIF</code> formula and the <code>CountIf</code> method available on the <code>WorksheetFunction</code> object, leading to this limitation.  This has been answered, it looks like: <a href=\"https://stackoverflow.com/questions/1676068/count-unique-values-in-excel\" title=\"count unique values in excel\">stackoverflow.com/questions/1676068/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 8903734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf497d73528164e9475817cacb13a7c?s=128&d=identicon&r=PG&f=1", "display_name": "DP1242", "link": "https://stackoverflow.com/users/8903734/dp1242"}, "edited": false, "score": 0, "creation_date": 1510287368, "post_id": 47170711, "comment_id": 81380556, "body": "Thanks, I ended up using a UDF to get around this problem."}], "tags": [], "owner": {"reputation": 161, "user_id": 7783436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086ff93844797bf4e9b4f55f9d45636c?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/7783436/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1510108791, "creation_date": 1510108791, "answer_id": 47170711, "question_id": 47170684, "link": "https://stackoverflow.com/questions/47170684/declaring-integer-type-mismatch-error-when-using-sumproduct-with-countif/47170711#47170711", "title": "Declaring integer: Type Mismatch Error when using sumproduct with countif", "body": "<p><code>CountIf</code> does not take a range as its second parameter.  It should be a value like <code>32</code> or <code>\"Some text\"</code>.</p>\n\n<p>See: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-countif-method-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-countif-method-excel?f=255&amp;MSPPError=-2147217396</a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8903734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf497d73528164e9475817cacb13a7c?s=128&d=identicon&r=PG&f=1", "display_name": "DP1242", "link": "https://stackoverflow.com/users/8903734/dp1242"}, "edited": false, "score": 0, "creation_date": 1510109814, "post_id": 47170820, "comment_id": 81291246, "body": "If I input this formula within a worksheet cell directly however it will return the desired result...."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 3, "user_id": 8903734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf497d73528164e9475817cacb13a7c?s=128&d=identicon&r=PG&f=1", "display_name": "DP1242", "link": "https://stackoverflow.com/users/8903734/dp1242"}, "edited": false, "score": 2, "creation_date": 1510111690, "post_id": 47170820, "comment_id": 81291773, "body": "@DP1242 Excel can handle array calculations - VBA cannot."}, {"owner": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "reply_to_user": {"reputation": 3, "user_id": 8903734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf497d73528164e9475817cacb13a7c?s=128&d=identicon&r=PG&f=1", "display_name": "DP1242", "link": "https://stackoverflow.com/users/8903734/dp1242"}, "edited": false, "score": 0, "creation_date": 1510111831, "post_id": 47170820, "comment_id": 81291812, "body": "@DP1242 are you trying to count all cells in that range or only specific ones?"}], "tags": [], "owner": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "is_accepted": false, "score": 0, "last_activity_date": 1510109582, "creation_date": 1510109582, "answer_id": 47170820, "question_id": 47170684, "link": "https://stackoverflow.com/questions/47170684/declaring-integer-type-mismatch-error-when-using-sumproduct-with-countif/47170820#47170820", "title": "Declaring integer: Type Mismatch Error when using sumproduct with countif", "body": "<p>CountIf will count the number of cells that match your criteria. It does not change because you've placed it in SumProduct formula. </p>\n\n<p>If you are counting everything, try using Count instead of CountIf</p>\n"}], "owner": {"reputation": 3, "user_id": 8903734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bf497d73528164e9475817cacb13a7c?s=128&d=identicon&r=PG&f=1", "display_name": "DP1242", "link": "https://stackoverflow.com/users/8903734/dp1242"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "closed_date": 1510287374, "answer_count": 2, "score": 0, "last_activity_date": 1510110695, "creation_date": 1510108583, "last_edit_date": 1531164843, "question_id": 47170684, "link": "https://stackoverflow.com/questions/47170684/declaring-integer-type-mismatch-error-when-using-sumproduct-with-countif", "closed_reason": "Duplicate", "title": "Declaring integer: Type Mismatch Error when using sumproduct with countif", "body": "<p>Can anyone help me with the following:</p>\n\n<pre><code>Dim fundcount as integer\n\nFundCount = Application.WorksheetFunction.SumProduct(1 / Application.CountIf(Range(\"B12:B28\"), Range(\"B12:B28\")))\n</code></pre>\n\n<p>I am getting a type mismatch error on this script. </p>\n\n<p>The purpose of the script is to count a range of text results and return a unique value that can then be used in a loop later on in the code. </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1510107651, "post_id": 47170509, "comment_id": 81290655, "body": "<code>Range(&quot;A2:A &amp; LastRow).....</code> is missing the closing quotation mark. It should be <code>Range(&quot;A2:A&quot; &amp; LastRow)....</code>"}, {"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1510110135, "post_id": 47170509, "comment_id": 81291357, "body": "Perfect, Good spot, thanks for this"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "edited": false, "score": 0, "creation_date": 1510110188, "post_id": 47170599, "comment_id": 81291382, "body": "Thanks :) looking at the code too long I just didn&#39;t notice that"}], "tags": [], "owner": {"reputation": 161, "user_id": 7783436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/086ff93844797bf4e9b4f55f9d45636c?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/7783436/matt"}, "is_accepted": false, "score": 2, "last_activity_date": 1510108063, "creation_date": 1510108063, "answer_id": 47170599, "question_id": 47170509, "link": "https://stackoverflow.com/questions/47170509/can-you-please-identify-the-error-in-this-code/47170599#47170599", "title": "Can you please identify the error in this code", "body": "<p>You didn't close your string.  You want:</p>\n\n<pre><code>\"A2:A\" &amp; LastRow\n</code></pre>\n\n<p>Looks like this was answered in a comment.</p>\n"}], "owner": {"reputation": 37, "user_id": 8903653, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/b10a93fa65ee8c38e48e94dac56e76d4?s=128&d=identicon&r=PG&f=1", "display_name": "Damian M", "link": "https://stackoverflow.com/users/8903653/damian-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1510131206, "answer_count": 1, "score": 0, "last_activity_date": 1510108331, "creation_date": 1510107491, "last_edit_date": 1531164843, "question_id": 47170509, "link": "https://stackoverflow.com/questions/47170509/can-you-please-identify-the-error-in-this-code", "closed_reason": "Not suitable for this site", "title": "Can you please identify the error in this code", "body": "<p>I have a code that is giving me a compile error: </p>\n\n<blockquote>\n  <p>Expected: Expression and it specifically highlights the first IF of\n  the formula.</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre><code>Sub ProduceTheListOfRecourseAccounts()\n\n' Run formulas to populate the recourseable accounts on the Recourse Items Page\n\n    Sheets(\"Recourse Items\").Range(\"A2:A &amp; LastRow).FormulaArray = \"=IF(ISERROR(INDEX('Formula sheet'!$A:$F,SMALL(IF('Formula sheet'!E:E&gt;'WBC Recourse Summary'!$E$15,ROW('Formula sheet'!A:A)),ROW('Formula sheet'!1:1)),1)),\"\"\"\",INDEX('Formula sheet'!$A:$F,SMALL(IF('Formula sheet'!E:E&gt;'WBC Recourse Summary'!$E$15,ROW('Formula sheet'!A:A)),ROW('Formula sheet'!1:1)),1))\"\n\nEnd Sub\n</code></pre>\n\n<p>Please help me identify what I am doing wrong.  This is my first VBA array, all normal formulas are working well in VBA.</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["excel", "internet-explorer", "browser-automation", "vba"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510121004, "post_id": 47170276, "comment_id": 81294570, "body": "You don&#39;t have <code>Vehicle</code> declared in the shown routine - what is this variable?"}, {"owner": {"reputation": 1, "user_id": 8679478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xkc0hxIhl5I/AAAAAAAAAAI/AAAAAAAAAAA/cifIj_v0bnA/photo.jpg?sz=128", "display_name": "ERIK S", "link": "https://stackoverflow.com/users/8679478/erik-s"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510179545, "post_id": 47170276, "comment_id": 81330721, "body": "It was &lt;Dim Vehicle = object &gt;. Should I try as &lt;long&gt;?"}, {"owner": {"reputation": 1, "user_id": 8679478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xkc0hxIhl5I/AAAAAAAAAAI/AAAAAAAAAAA/cifIj_v0bnA/photo.jpg?sz=128", "display_name": "ERIK S", "link": "https://stackoverflow.com/users/8679478/erik-s"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510503275, "post_id": 47170276, "comment_id": 81452169, "body": "Ok, clearly I&#39;m not getting what I was looking for from this thread.  The above code works on some machines and not others.  How to a debug for that?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510505063, "post_id": 47170276, "comment_id": 81452783, "body": "Do you have references to <code>Microsoft HTML Library</code> as well as <code>InternetExplorer</code>"}, {"owner": {"reputation": 1, "user_id": 8679478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xkc0hxIhl5I/AAAAAAAAAAI/AAAAAAAAAAA/cifIj_v0bnA/photo.jpg?sz=128", "display_name": "ERIK S", "link": "https://stackoverflow.com/users/8679478/erik-s"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510601810, "post_id": 47170276, "comment_id": 81495257, "body": "I can see ref library files: VB -stdole2.TLB -mshtml.TLB on both machines, and they are both selected in VB &gt; Tools &gt; References &gt; available references."}], "owner": {"reputation": 1, "user_id": 8679478, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xkc0hxIhl5I/AAAAAAAAAAI/AAAAAAAAAAA/cifIj_v0bnA/photo.jpg?sz=128", "display_name": "ERIK S", "link": "https://stackoverflow.com/users/8679478/erik-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1510105747, "creation_date": 1510105747, "last_edit_date": 1531164843, "question_id": 47170276, "link": "https://stackoverflow.com/questions/47170276/ie-document-anything-throws-430-error", "title": "IE.document.*ANYTHING* throws 430 error", "body": "<p>I have this code running on one computer, but not another.  I hit an error whenever I try to call any of the following.    </p>\n\n<pre><code>\"InternetExplorer.document.getElementById(\"test\")\n\n\"HTMLDocument.getElementsByid(\"test\")\n\n\"HTMLDoc.all.quickSearchForm.Value = \"\n</code></pre>\n\n<p>I've tried all different methods of interacting with HTML elements in an excel macro, many work great on my home computer but not the production machine.  </p>\n\n<p>I've checked the following so far, </p>\n\n<p>Working Machine is: WIN10 PRO / OFFICE 2010 - logged in as admin\nNot working is: WIN7 ENT / OFFICE 2010 - logged as user?</p>\n\n<p>Both machines have reference libraries installed and active in VB\n-stdole2.TLB\n-mshtml.TLB</p>\n\n<p>Website:  <a href=\"https://sfbay.craigslist.org\" rel=\"nofollow noreferrer\">https://sfbay.craigslist.org</a> is set as trusted in IE both boxes.</p>\n\n<p>Here is my complete code working on one box and not the other.</p>\n\n<pre><code>    Sub TEST4()\n'\n' TEST3 Macro\n'\nDim IE As InternetExplorer\nDim myZip As Long\nDim siteZip As Object\nDim URL As String\nDim gender As Object\nDim btnGo As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nURL = \"https://sfbay.craigslist.org/\"\nIE.navigate (URL)\nDo\nDoEvents\nLoop Until IE.readyState = 4\nSet Vehicle = IE.document.getElementById(\"query\") 'this is where I hit error everytime\nVehicle.Value = \"Corvette\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "selenium-webdriver", "web-scraping"], "comments": [{"owner": {"reputation": 121, "user_id": 8828432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555c529a50eae483c69091a3ddd42508?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8828432/steven"}, "edited": false, "score": 0, "creation_date": 1510334669, "post_id": 47169839, "comment_id": 81406516, "body": "I ended up taking the easy way out. I located the link to the menu option I attempted to click and just went straight there using &quot;driver.get&quot;                                           Link: &lt;a href=&quot;/eligibility-benefits/aetna/search&quot;&gt;Eligibility and Benefits Inquiry&lt;/a&gt;"}], "owner": {"reputation": 121, "user_id": 8828432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/555c529a50eae483c69091a3ddd42508?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/8828432/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1510102461, "creation_date": 1510102461, "question_id": 47169839, "link": "https://stackoverflow.com/questions/47169839/elementnotvisbleerror-cannot-click-on-element", "title": "ElementNotVisbleError (Cannot Click on Element)", "body": "<p>Salutations,</p>\n\n<p>I'm writing code to scrape a website using Selenium and Excel VBA. The website in question has a menubar in which a menu option is visble to VBA only when hovered (class = \"hovered\" when the cursor is over the text, class = \"\" when the cursor is not over the text). Furthermore, while stepping into my code, I'm unable to click the link using Automation or Manually. </p>\n\n<p>Please see code below:   </p>\n\n<pre><code>WebsiteURL = \"https://navinet.navimedix.com/signed-out/session-expired?\nReturnUrl=/\"\ndriver.Get WebsiteURL\ndriver.Window.Maximize\ndriver.FindElementById(\"LoginPortletUsername\").SendKeys (UserName) 'Reads \nUsername\ndriver.FindElementById(\"LoginPortletPassword\").SendKeys (Password) 'Reads \npassword\ndriver.FindElementById(\"btnSignInSubmit\").Click\nApplication.Wait (Now + TimeValue(\"0:00:20\"))\ndriver.FindElementById(\"mh-workflows-my-health-plans-menu\").Click\ndriver.FindElementById(\"workflows-menu-plan-aetna\").Click\nApplication.Wait (Now + TimeValue(\"0:00:10\"))\ndriver.Window.Activate\ndriver.FindElementById(\"aetna-eligibility\").Click \n</code></pre>\n\n<p>The code works up until point, however the following options to access the menupath do not work.</p>\n\n<p>Option 1 (Move Cursor &amp; Click)</p>\n\n<pre><code>SetCursorPos 2221, 289\nCall SingleClick\n</code></pre>\n\n<p>With</p>\n\n<pre><code>Private Sub SingleClick()\nSetCursorPos 2286, 69 'x and y position for Health Edge search\nmouse_event MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0\nmouse_event MOUSEEVENTF_LEFTUP, 0, 0, 0, 0\nEnd Sub\n</code></pre>\n\n<p>And</p>\n\n<pre><code>Public Declare Function SetCursorPos Lib \"user32\" (ByVal x As Long, ByVal y As Long) As Long 'mouse position\nPublic Declare Sub mouse_event Lib \"user32\" (ByVal dwFlags As Long, ByVal dx As Long, ByVal dy As Long, ByVal cButtons As Long, ByVal dwExtraInfo As Long) 'user environment\nPublic Const MOUSEEVENTF_LEFTDOWN = &amp;H2\nPublic Const MOUSEEVENTF_LEFTUP = &amp;H4\nPublic Const MOUSEEVENTF_RIGHTDOWN As Long = &amp;H8\nPublic Const MOUSEEVENTF_RIGHTUP As Long = &amp;H10\n</code></pre>\n\n<p>Option 2 (Move Cursor &amp; Find New Class)</p>\n\n<pre><code>SetCursorPos 2221, 289\ndriver.FindElementByClass(\"hovered\").Click\n</code></pre>\n\n<p>Option 3 (Find Object Directly)</p>\n\n<pre><code>driver.FindElementByXPath(\"//*[@id='vertical-menu']/li[4]/ul/li/a\").Click\n</code></pre>\n\n<p>Option 4 (Use Move To Element Via Menu Path &amp; Click)</p>\n\n<pre><code>Set we = driver.FindElementByXPath(\"//*[@id='vertical-menu']/li[4]/ul/li/a\") \ndriver.Actions.MoveToElement(driver.FindElementById(\"aetna-eligibility\")).MoveToElement(we).Click.Perform\n</code></pre>\n\n<p>Any tips or alternatives would help greatly. This has been driving me crazy!</p>\n"}, {"tags": ["vba", "excel", "button"], "answers": [{"comments": [{"owner": {"reputation": 628, "user_id": 8867871, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/abe3d4d733f0ddba3d2aa35d681363d8?s=128&d=identicon&r=PG&f=1", "display_name": "delalma", "link": "https://stackoverflow.com/users/8867871/delalma"}, "edited": false, "score": 0, "creation_date": 1510367151, "post_id": 47206294, "comment_id": 81418023, "body": "Thank you for your answer. Sorry, I a, a beginner but when I create a button and link this macro, then I push the button but there is an error message from VBA."}], "tags": [], "owner": {"reputation": 1604, "user_id": 7902625, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IfPnf.jpg?s=128&g=1", "display_name": "Vasyl Lyashkevych", "link": "https://stackoverflow.com/users/7902625/vasyl-lyashkevych"}, "is_accepted": false, "score": 0, "last_activity_date": 1510243121, "creation_date": 1510243121, "answer_id": 47206294, "question_id": 47169829, "link": "https://stackoverflow.com/questions/47169829/how-to-change-color-and-text-inside-vba-button/47206294#47206294", "title": "How to change color and text inside VBA button?", "body": "<p>To change the color manually:</p>\n\n<blockquote>\n  <ol>\n  <li>Right-click the button and choose Format Shape</li>\n  <li>On the Fill tab of the resulting dialog, set your color</li>\n  </ol>\n</blockquote>\n\n<p>Assuming that you want an RGB color from the color picker, the code might something like:</p>\n\n<pre><code>Sub ChangeButtonColor()\n    With ActiveSheet.Shapes(\"Rectangle 1\").Fill\n        .ForeColor.RGB = RGB(228, 214, 186)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Also, you can find more information on the Internet, for example <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/80738-change-command-button-color-based-on-cell-value\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 628, "user_id": 8867871, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/abe3d4d733f0ddba3d2aa35d681363d8?s=128&d=identicon&r=PG&f=1", "display_name": "delalma", "link": "https://stackoverflow.com/users/8867871/delalma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6711, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1510243121, "creation_date": 1510102397, "last_edit_date": 1510106514, "question_id": 47169829, "link": "https://stackoverflow.com/questions/47169829/how-to-change-color-and-text-inside-vba-button", "title": "How to change color and text inside VBA button?", "body": "<p>I am trying to a button with VBA which change a color and all the writing inside whereby clicking on it.</p>\n\n<p>How can I write the command for that? Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1906, "user_id": 1760939, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1a953aa0b2eae7967861f194d4f78f8f?s=128&d=identicon&r=PG", "display_name": "Syakur Rahman", "link": "https://stackoverflow.com/users/1760939/syakur-rahman"}, "edited": false, "score": 0, "creation_date": 1510102814, "post_id": 47169795, "comment_id": 81289510, "body": "You should also mention which part is the original code and its main functionality, and which is your modification. It could ease on determining what the issue is."}, {"owner": {"reputation": 397, "user_id": 7787878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VkW4.jpg?s=128&g=1", "display_name": "E. Merckx", "link": "https://stackoverflow.com/users/7787878/e-merckx"}, "edited": false, "score": 2, "creation_date": 1510103643, "post_id": 47169795, "comment_id": 81289710, "body": "Do any cells in your range contain a name other than &quot;Aquino, Ervic&quot;? This will exit the loop any time a cell contains anything other than &quot;Aquino, Ervic&quot;."}, {"owner": {"reputation": 2500, "user_id": 1497597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e86c15a7b980952c674a567853249751?s=128&d=identicon&r=PG", "display_name": "D T", "link": "https://stackoverflow.com/users/1497597/d-t"}, "edited": false, "score": 0, "creation_date": 1510107881, "post_id": 47169795, "comment_id": 81290719, "body": "where is your data excel?"}, {"owner": {"reputation": 1, "user_id": 8903350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf4593c00026503d3bf9a8e21df55f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brian J.", "link": "https://stackoverflow.com/users/8903350/brian-j"}, "edited": false, "score": 0, "creation_date": 1510195000, "post_id": 47169795, "comment_id": 81335186, "body": "The else statement and message box were the only parts I added. everything else was the original macro. My goal is to look for a name and pull their transactions for the month and format them. My original code worked fine however if their was no name (no transactions) it would debug and still format. I want it to display a message box that there is no transactions and stop.Yes their are many names."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8903350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf4593c00026503d3bf9a8e21df55f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brian J.", "link": "https://stackoverflow.com/users/8903350/brian-j"}, "edited": false, "score": 0, "creation_date": 1510200757, "post_id": 47170127, "comment_id": 81336605, "body": "YowE3K I get a Run-time error 438 Object doesn&#39;t support this property or method."}, {"owner": {"reputation": 1, "user_id": 8903350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf4593c00026503d3bf9a8e21df55f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brian J.", "link": "https://stackoverflow.com/users/8903350/brian-j"}, "edited": false, "score": 0, "creation_date": 1510349702, "post_id": 47170127, "comment_id": 81413675, "body": "I typed in option explicit to see if all variables have been defined...it tells me variable not defined and it highlights this part  a ="}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 1, "user_id": 8903350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf4593c00026503d3bf9a8e21df55f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brian J.", "link": "https://stackoverflow.com/users/8903350/brian-j"}, "edited": false, "score": 0, "creation_date": 1510350180, "post_id": 47170127, "comment_id": 81413869, "body": "@BrianJ. Yes, you weren&#39;t declaring your variables in your posted code, so we couldn&#39;t tell whether you were letting them default to variants or whether they were Public variables declared outside that procedure.  If you haven&#39;t declared <code>a</code> anywhere and you want to use <code>Option Explicit</code> (which is always a good idea) then add a <code>Dim a As Long, i As Long</code> to the code.  But that doesn&#39;t explain an error 438."}, {"owner": {"reputation": 1, "user_id": 8903350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf4593c00026503d3bf9a8e21df55f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brian J.", "link": "https://stackoverflow.com/users/8903350/brian-j"}, "edited": false, "score": 0, "creation_date": 1510508963, "post_id": 47170127, "comment_id": 81454117, "body": "I ended up re-typing it with your suggestion and it works now. Probably had something that was copied on accident. Thank you very much. Works exactly the way I need it to!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1510104587, "creation_date": 1510104587, "answer_id": 47170127, "question_id": 47169795, "link": "https://stackoverflow.com/questions/47169795/if-else-vba-code-not-working/47170127#47170127", "title": "If Else VBA code not working", "body": "<p>Your current code is displaying your <code>\"No Activity This Month\"</code> message if <strong>any</strong> row does not contain <code>\"Aquino, Ervic\"</code> but you only want a message to be displayed if <strong>none</strong> of the rows contain that string.</p>\n\n<p>The easiest, and probably most efficient, way to do this is to perform the test first and then only process each row if an entry exists:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Application.ScreenUpdating = False\n\n    If Application.CountIf(Worksheets(\"Sheet1\").Columns(1), \"Aquino, Ervic\") = 0 Then\n        MsgBox \"No Activity This Month\"\n    Else\n        a = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n        For i = 2 To a\n            If Worksheets(\"Sheet1\").Cells(i, 1).Value = \"Aquino, Ervic\" Then\n                Worksheets(\"Sheet1\").Rows(i).Copy\n                '...\n                Cells.EntireColumn.AutoFit\n                Range(\"A2\").Select\n            End If\n        Next\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I would also strongly recommend reading through the question <a href=\"https://stackoverflow.com/q/10714251/6535336\">How to avoid using Select in Excel VBA</a>.  Those <code>Select</code> and <code>Activate</code> statements will cause you so many problems in the future that it is better to invest some time now in learning how to get rid of them.</p>\n"}], "owner": {"reputation": 1, "user_id": 8903350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf4593c00026503d3bf9a8e21df55f3?s=128&d=identicon&r=PG&f=1", "display_name": "Brian J.", "link": "https://stackoverflow.com/users/8903350/brian-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510109161, "creation_date": 1510102099, "last_edit_date": 1510109161, "question_id": 47169795, "link": "https://stackoverflow.com/questions/47169795/if-else-vba-code-not-working", "title": "If Else VBA code not working", "body": "<p>I am new to VBA and I usually google for pieces of code I need however this has proven to be difficult. I am trying to create a macro that searches for a specific name and copies and pastes all rows with that name in a separate sheet. This worked fine but I also want a message box to appear when the name is not there. I added some code and now it only shows the message box even if the name is actually there. Below is my code. Many thanks for any help or information.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Application.ScreenUpdating = False\n\n    a = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 2 To a\n\n        If Worksheets(\"Sheet1\").Cells(i, 1).Value = \"Aquino, Ervic\" Then\n\n            Worksheets(\"Sheet1\").Rows(i).Copy\n            Worksheets(\"Ervic Aquino\").Activate\n            b = Worksheets(\"Ervic Aquino\").Cells(Rows.Count, 1).End(xlUp).Row\n            Worksheets(\"Ervic Aquino\").Cells(b + 1, 1).Select\n            ActiveSheet.Paste\n            Worksheets(\"sheet1\").Activate\n\n            Application.CutCopyMode = False\n\n            Worksheets(\"Ervic Aquino\").Activate\n            Range(\"A1:K1\").Select\n            Range(Selection, Selection.End(xlDown)).Select\n            Application.CutCopyMode = False\n            Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n            Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n            With Selection.Borders(xlEdgeLeft)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            With Selection.Borders(xlEdgeTop)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            With Selection.Borders(xlEdgeBottom)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            With Selection.Borders(xlEdgeRight)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            With Selection.Borders(xlInsideVertical)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            With Selection.Borders(xlInsideHorizontal)\n                .LineStyle = xlContinuous\n                .ColorIndex = 0\n                .TintAndShade = 0\n                .Weight = xlThin\n            End With\n            Range(\"I2\").Select\n            Range(Selection, Selection.End(xlToRight)).Select\n            Range(Selection, Selection.End(xlDown)).Select\n            Selection.ClearContents\n            Range(\"H1\").Select\n            Selection.End(xlDown).Select\n            ActiveCell.Offset(1).Select\n            Selection.Font.Bold = True\n\n            Dim LR As Long\n            LR = Range(\"H\" &amp; Rows.Count).End(xlUp).Row\n            Range(\"H\" &amp; LR + 1).Formula = \"=SUM(H2:H\" &amp; LR &amp; \")\"\n\n            Cells.Select\n            Cells.EntireColumn.AutoFit\n            Range(\"A2\").Select\n\n            'If there is no activity do nothing\n        Else\n            MsgBox \"No Activity This Month\"\n\n            'End Loop\n            Exit For\n\n        End If\n\n    Next\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "edited": false, "score": 1, "creation_date": 1510101472, "post_id": 47169676, "comment_id": 81289190, "body": "just as a side note, VBA doesn&#39;t dim everything in that format. only <code>NumberMeals</code> is a <code>Decimal</code>, everything else is still <code>Variant</code>. To fix this you need to dim each individually, this can still be on the same line. <code>Dim Cost as Decimal, Number1 as Decimal, Number2 as Decimal.....</code>"}, {"owner": {"reputation": 11, "user_id": 8855593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a7df171c165fddf2b9040894639774?s=128&d=identicon&r=PG&f=1", "display_name": "0xfff1", "link": "https://stackoverflow.com/users/8855593/0xfff1"}, "reply_to_user": {"reputation": 145, "user_id": 6079835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/242191f996e245a22cef6553b047fc6f?s=128&d=identicon&r=PG&f=1", "display_name": "ballsy26", "link": "https://stackoverflow.com/users/6079835/ballsy26"}, "edited": false, "score": 0, "creation_date": 1510117979, "post_id": 47169676, "comment_id": 81293496, "body": "@ballsy26 Thanks for pointing that out."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8855593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a7df171c165fddf2b9040894639774?s=128&d=identicon&r=PG&f=1", "display_name": "0xfff1", "link": "https://stackoverflow.com/users/8855593/0xfff1"}, "is_accepted": false, "score": 1, "last_activity_date": 1511244156, "last_edit_date": 1511244156, "creation_date": 1510101533, "answer_id": 47169721, "question_id": 47169676, "link": "https://stackoverflow.com/questions/47169676/how-to-show-decimals-in-code/47169721#47169721", "title": "How to show decimal&#39;s in code", "body": "<p>Never mind found out how.</p>\n\n<p>Label5.Text = Format(Answer, \"C\")</p>\n"}], "owner": {"reputation": 11, "user_id": 8855593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a7df171c165fddf2b9040894639774?s=128&d=identicon&r=PG&f=1", "display_name": "0xfff1", "link": "https://stackoverflow.com/users/8855593/0xfff1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511244156, "creation_date": 1510101155, "question_id": 47169676, "link": "https://stackoverflow.com/questions/47169676/how-to-show-decimals-in-code", "title": "How to show decimal&#39;s in code", "body": "<pre><code>Dim Cost, Number1, Number2, Number3, Number4, Answer, Answer1, NumberMeals As Decimal\n    If rbSingle.Checked Then Number1 = 200.0 \n    If rbDouble.Checked Then Number2 = 210\n    If rbSuite.Checked Then Number3 = 220\n    If rbLuxary.Checked Then Number4 = 50\n    If CheckBox1.Checked Then NumberMeals = 10\n\n    Cost = Number1 + Number2 + Number3 + Number4 + NumberMeals\n    Answer = Cost * txtDays.Text\n\n    Label5.Text = Answer\n    Label5.Visible = True    \n</code></pre>\n\n<p>How do I make it show decimals in the label eg $200.00</p>\n"}, {"tags": ["excel", "filter", "pivot-table", "vba"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 1609391, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6362fd2deb1365e9b1ced58eb62a6341?s=128&d=identicon&r=PG", "display_name": "user1609391", "link": "https://stackoverflow.com/users/1609391/user1609391"}, "edited": false, "score": 0, "creation_date": 1510126147, "post_id": 47170919, "comment_id": 81296842, "body": "Thank you! It was the field name, I had a typo in it.   The tip on the macro recorder is very much appreciated, I didn&#39;t even think of that as a way to debug."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 0, "last_activity_date": 1510110279, "creation_date": 1510110279, "answer_id": 47170919, "question_id": 47169588, "link": "https://stackoverflow.com/questions/47169588/how-to-filter-column-labels-with-vba-in-an-excel-pivot-table/47170919#47170919", "title": "How To Filter Column Labels With VBA In An Excel Pivot Table", "body": "<p>There's nothing wrong with that syntax, near as I can tell. Are you sure you have the name right? Best way to check is to fire up the macro recorder, perform the action manually, and see what the resulting code looks like.</p>\n\n<p>Also note that you need to set .ManualUpdate = False when you are done, otherwise your PivotTable won't update when you are done. </p>\n"}], "owner": {"reputation": 379, "user_id": 1609391, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/6362fd2deb1365e9b1ced58eb62a6341?s=128&d=identicon&r=PG", "display_name": "user1609391", "link": "https://stackoverflow.com/users/1609391/user1609391"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4109, "favorite_count": 0, "accepted_answer_id": 47170919, "answer_count": 1, "score": 1, "last_activity_date": 1510110279, "creation_date": 1510100557, "last_edit_date": 1531164843, "question_id": 47169588, "link": "https://stackoverflow.com/questions/47169588/how-to-filter-column-labels-with-vba-in-an-excel-pivot-table", "title": "How To Filter Column Labels With VBA In An Excel Pivot Table", "body": "<p>In Excel I have been able to filter the row labels in a pivot table with this code:</p>\n\n<pre><code>Dim PT as PivotTable\nSet PT = ActiveSheet.PivotTables(\"Pivot1\")\nWith PT\n   .ManualUpdate=True\n   .ClearAllFiters\n   .PivotFields(\"App\").PivotFilters.Add Type:=xlCaptionDoesNotContain, Value1:=\"(Blank)\" \nEnd With\n</code></pre>\n\n<p>I need to do the same filter for the column labels where my field name is Type.<br>\nI tired this:</p>\n\n<pre><code>Dim PT as PivotTable\nSet PT = ActiveSheet.PivotTables(\"Pivot1\")\nWith PT\n   .ManualUpdate=True\n   .ClearAllFiters\n   .PivotFields(\"App\").PivotFilters.Add Type:=xlCaptionDoesNotContain, Value1:=\"(Blank)\" \n   .PivotFields(\"Type\").PivotFilters.Add Type:=xlCaptionDoesNotContain, Value1:=\"(Blank)\" \n\nEnd With\n</code></pre>\n\n<p>However I get an error, \"unable to get the PivotFields property of the PivotTable class\" when it hits the below line:</p>\n\n<pre><code>.PivotFields(\"Type\").PivotFilters.Add Type:=xlCaptionDoesNotContain, Value1:=\"(Blank)\" \n</code></pre>\n\n<p>What syntax do I use to filter the column label?</p>\n"}, {"tags": ["vba", "macos", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510100174, "post_id": 47169255, "comment_id": 81288870, "body": "I&#39;ll ask the dumb questions (that I would ask Windows users too) ... (a) Are you sure the bottom of your VBE window isn&#39;t below the bottom of the screen, i.e. is the VBE window maximised?  (b) Can you drag the bottom line (about the middle of your red rectangle) up to expose more area for the bit below that line? (Not sure whether that is even a Mac thing, or whether Macs do things differently than Windows, but may as well ask.)"}, {"owner": {"reputation": 433, "user_id": 6822649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/scash.png?s=128&g=1", "display_name": "maxischl", "link": "https://stackoverflow.com/users/6822649/maxischl"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510129538, "post_id": 47169255, "comment_id": 81298679, "body": ":D well, thanks for those dumb questions. Just to be sure I double checked, and... thats not it."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510164882, "post_id": 47169255, "comment_id": 81322797, "body": "Sometimes its the simple things that trip us up, so I figured it was worth asking. :D"}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 9401735, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8FL7zJZko4c/AAAAAAAAAAI/AAAAAAAAAAA/N0oaavJ96b0/photo.jpg?sz=128", "display_name": "Andy Anderson", "link": "https://stackoverflow.com/users/9401735/andy-anderson"}, "is_accepted": true, "score": 1, "last_activity_date": 1519392394, "creation_date": 1519392394, "answer_id": 48948924, "question_id": 47169255, "link": "https://stackoverflow.com/questions/47169255/vba-excel-office-2016-mac-tools-references-not-available/48948924#48948924", "title": "VBA excel Office 2016 Mac - Tools References not available", "body": "<p>It's in the tools menu - top of the monitor when you have the VB editor open.</p>\n"}], "owner": {"reputation": 433, "user_id": 6822649, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/scash.png?s=128&g=1", "display_name": "maxischl", "link": "https://stackoverflow.com/users/6822649/maxischl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2124, "favorite_count": 0, "accepted_answer_id": 48948924, "answer_count": 1, "score": 1, "last_activity_date": 1519392394, "creation_date": 1510098248, "question_id": 47169255, "link": "https://stackoverflow.com/questions/47169255/vba-excel-office-2016-mac-tools-references-not-available", "title": "VBA excel Office 2016 Mac - Tools References not available", "body": "<p>I cannot find the tools references button in my Exel VBA Editor (Office 2016 for Mac). It is supposed to be in the corner down left as marked below.\nAlso described <a href=\"https://stackoverflow.com/questions/42756114/office365-excel-access-to-the-tools-references-menu-for-regexp-library\">here</a>.</p>\n\n<p>I googled for almost two hours now. Any suggestions?</p>\n\n<p><strong>Note: It's different to Office for Windows!</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/hv2S5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hv2S5.png\" alt=\"Screenshot of VBA Editor Excel 2016\"></a></p>\n"}]