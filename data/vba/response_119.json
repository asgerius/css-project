[{"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1492646924, "last_edit_date": 1495541859, "creation_date": 1492646924, "answer_id": 43508075, "question_id": 43507532, "link": "https://stackoverflow.com/questions/43507532/select-column-once-it-is-added/43508075#43508075", "title": "select column once it is added", "body": "<p>Try it as,</p>\n\n<pre><code>With sht2\n    .Activate\n    .Range(myCol &amp; \"5\").Select\n    '... or,\n    .Cells(5, lastCol).Select\nEnd With\n</code></pre>\n\n<p>Note my use of a prefixing <code>.</code> with <code>.Cells(...)</code> and <code>.Range(...)</code>. When you are inside a With ... End With, the prefix period (e.g. .) passes the parent worksheet reference to the .Range or .Cells property.</p>\n\n<p>It would be worthwhile to read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/28700020#28700020\">How to avoid using Select in Excel VBA macros</a>.</p>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 43508075, "answer_count": 1, "score": 1, "last_activity_date": 1492650645, "creation_date": 1492643313, "last_edit_date": 1492650645, "question_id": 43507532, "link": "https://stackoverflow.com/questions/43507532/select-column-once-it-is-added", "title": "select column once it is added", "body": "<p>It adds a new column from a template of another page so formulas and formatting are copied in. It adds in 1 column before the last column. Last column is being used an an anchor. I would like it to select and goto the <code>myCol &amp; \"5\"</code> but i am unable to get it to work.</p>\n\n<pre><code>Function GetColumnLetter(colNum As Long) As String\n    Dim vArr\n    vArr = Split(Cells(1, colNum).Address(True, False), \"$\")\n    GetColumnLetter = vArr(0)\nEnd Function\n\nSub NewPlate_F() 'Insert Column Button\n    Application.ScreenUpdating = False\n\n    Dim sht8 As Worksheet\n    Set sht8 = ThisWorkbook.Worksheets(\"Add\")\n    Dim sht2 As Worksheet\n    Set sht2 = ThisWorkbook.Worksheets(\"Foundation Plates\")\n\n    Call Unprotect\n    sht2.Activate\n\n    Dim lastCol As Long\n    Dim myCol As String\n    Dim rng As Range\n    Dim cell As Range\n\n    With sht2\n        Set rng = Cells\n\n    lastCol = sht2.Cells(5, sht2.Columns.Count).End(xlToLeft).Column\n    myCol = GetColumnLetter(lastCol)\n\n    Set rng = sht2.Range(myCol &amp; \"5\")\n\n    'MsgBox rng.Address\n\n        With sht2\n        Columns(myCol).EntireColumn.Insert\n        Columns(myCol).ColumnWidth = 13\n            Application.Wait (Now + 0.000005)\n        sht8.Range(\"H7:H48\").Copy Range(myCol &amp; \"1\")\n        Range(myCol &amp; \"5\").Select\n        End With\n    End With\n\n\n    Call Format_Foundation\n    Call Unprotect\n\n    With sht2\n        Range(myCol &amp; \"5\").Select\n    End With\n    sht2.Activate\n\n    Set sht2 = Nothing\n    Set sht8 = Nothing\n    Application.CutCopyMode = False\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1492647566, "post_id": 43507219, "comment_id": 74070799, "body": "I think that the best way to speed up VBA is ... to not use VBA :] <a href=\"http://www.contextures.com/xlDataVal02.html\" rel=\"nofollow noreferrer\">contextures.com/xlDataVal02.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 975, "user_id": 890266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/iGHDm.gif?s=128&g=1", "display_name": "Bill Roberts", "link": "https://stackoverflow.com/users/890266/bill-roberts"}, "is_accepted": false, "score": -1, "last_activity_date": 1492643761, "last_edit_date": 1492643761, "creation_date": 1492643452, "answer_id": 43507554, "question_id": 43507219, "link": "https://stackoverflow.com/questions/43507219/loop-without-loop-vba/43507554#43507554", "title": "Loop without Loop VBA", "body": "<p>Welcome to VBA!</p>\n\n<p>Not so much an answer but this should speed up your VBA considerably.  This would go into the <strong>FIRST</strong> subroutine that calls any and all other VBA routines.  You wouldn't for example, place it into the <strong>FUNCTION</strong> you referenced.</p>\n\n<p>Add this to the top of your <strong>SUB</strong>:</p>\n\n<pre><code>Dim PrevCalc As XlCalculation\nWith Application\n    PrevCalc = .Calculation\n    .Calculation = xlCalculationManual\n    .Cursor = xlWait\n    .Calculate\n    .EnableEvents = False\n    .DisplayAlerts = False\n    '.ScreenUpdating = False ' Not really needed\nEnd With\n</code></pre>\n\n<p>then add this to the bottom:</p>\n\n<pre><code>With Application\n    .Cursor = xlDefault\n    .Calculate\n    .Calculation = PrevCalc\n    '.ScreenUpdating = True 'Not really needed\n    .DisplayAlerts = True\n    .EnableEvents = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7892451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00ee9ee847648be4d23a407468b6af92?s=128&d=identicon&r=PG&f=1", "display_name": "CherylM", "link": "https://stackoverflow.com/users/7892451/cherylm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1492643761, "creation_date": 1492641322, "last_edit_date": 1492643079, "question_id": 43507219, "link": "https://stackoverflow.com/questions/43507219/loop-without-loop-vba", "title": "Loop without Loop VBA", "body": "<p>I'm new to VBA. Below is code that applies a validation list to cells in column <code>C</code> depending on what option from another validation list was selected in column <code>B</code>. It's clunky and slow. I was hoping for some ideas on a different way to write it. Here's what I have:</p>\n\n<pre><code>For k = 36 To 88\n\n    If Range(\"B\" &amp; k) Is Nothing Then\n    Else\n        CarrierName = Range(\"B\" &amp; k)\n        Range(\"C\" &amp; k).Name = \"PlanName\"\n        xPlanDropDown = PlanDropDown(CarrierName, PlanName)\n    End If\n\n    Next k\n\nEnd Sub\n\nFunction PlanDropDown(CarrierName, PlanName)\n\n    Select Case CarrierName\n\n        Case \"Aetna EPO\"\n              Range(\"PlanName\").Validation _\n                .Modify xlValidateList, xlValidAlertStop, Formula1:=\"=Plans!A2:A101\"\n        Case \"Aetna HMO\"\n              Range(\"PlanName\").Validation _\n                .Modify xlValidateList, xlValidAlertStop, Formula1:=\"=Plans!B2:B101\"\n        Case \"Aetna PPO\"\n              Range(\"PlanName\").Validation _\n                .Modify xlValidateList, xlValidAlertStop, Formula1:=\"=Plans!C2:C101\"  ...\n</code></pre>\n\n<p>Thank you for any help you can provide! Cheryl</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1492640647, "post_id": 43506768, "comment_id": 74068806, "body": "I posted an answer thinking your <code>Resume</code> was a <code>Resume Next</code> and then realised it wasn&#39;t.  So I tried your code and, apart from the extraneous <code>:</code> in <code>Range(&quot;F2:&quot;)</code>, your code worked.  (I dislike the <b>way</b> it works, because <code>Select</code> statements should be avoided whenever possible, but that doesn&#39;t change the fact that it does actually work.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492641924, "post_id": 43506768, "comment_id": 74069226, "body": "Agreed @YowE3K - It could just as easily be <code>With Sheets(cell.Value)</code> instead of <code>Sheets(cell.Value).Select</code> and the <code>On Error GoTo CreateSheet</code> doesn&#39;t have to be repeated within the loop since it is not being reset to <code>On Error GoTo 0</code> anywhere."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492642698, "post_id": 43506911, "comment_id": 74069471, "body": "This is good for the source of the copy but the OP wants to dynamically &#39;<i>add a new worksheet if one named in column F doesn&#39;t exist</i>&#39;. I&#39;ve used the on error make new target worksheet with an With statement before but I don&#39;t see  how it would be handled here."}], "tags": [], "owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "is_accepted": false, "score": 1, "last_activity_date": 1492639753, "creation_date": 1492639753, "answer_id": 43506911, "question_id": 43506768, "link": "https://stackoverflow.com/questions/43506768/create-new-worksheets-based-on-values/43506911#43506911", "title": "Create new worksheets based on values", "body": "<p>It would help to define the source and destination worksheets. Here is something that I typically would do:</p>\n\n<pre><code>Dim source_worksheet As Worksheet\nDim target_worksheet As Worksheet\n\n    Set source_worksheet = ActiveWorkbook.Worksheets(\" whatever sheet column F is in ex: Sheet1\")\n\n    Set target_worksheet = ActiveWorkbook.Worksheets(\" whatever the new worksheet name is ex: Sheet5\")\n\n    source_worksheet.Copy After:=target_worksheet\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1492643025, "last_edit_date": 1495541862, "creation_date": 1492642484, "answer_id": 43507410, "question_id": 43506768, "link": "https://stackoverflow.com/questions/43506768/create-new-worksheets-based-on-values/43507410#43507410", "title": "Create new worksheets based on values", "body": "<p>In my comments I've stated that it would be easy to switch over to a <code>With ... End With</code> that defines the parent worksheet without <code>.Select</code> relying on the ActiveSheet property.</p>\n\n<pre><code>OPTION EXPLICIT\n\nSub RunMe()\n\n    dim cell as range\n    On Error GoTo CreateSheet\n\n    with worksheets(range(\"F2\").parent.name)    '&lt;~~ name this worksheet PROPERLY!!\n        For Each cell In .Range(.cells(2, \"F\"), .cells(.rows.count, \"F\").End(xlUp))\n            cell.EntireRow.Copy\n            with workSheets(cell.Value)\n                .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial\n            end with\n        Next cell\n    end with\n\n    Application.CutCopyMode = False\n    Exit Sub\n\nCreateSheet:\n    Worksheets.Add.Name = cell.Value\n    Resume\n\nEnd Sub\n</code></pre>\n\n<p>FWIW, this is my version of the 'add a new worksheet if the name doesn't exist' process - <a href=\"https://stackoverflow.com/questions/36671453/create-a-new-sheet-for-each-unique-agent-and-move-all-data-to-each-sheet/36672632#36672632\">Create a new sheet for each unique agent and move all data to each sheet</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 7795005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9679efc0b0a98e700cad958fd3a89d75?s=128&d=identicon&r=PG&f=1", "display_name": "DANNYJ1", "link": "https://stackoverflow.com/users/7795005/dannyj1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492643025, "creation_date": 1492639006, "question_id": 43506768, "link": "https://stackoverflow.com/questions/43506768/create-new-worksheets-based-on-values", "title": "Create new worksheets based on values", "body": "<p>I have been trying this for hours and am getting no where. I am using the code below to create new worksheets based on the value in column F. The code creates the worksheet but then copies and pastes the information into the original worksheet, not the new ones. the code is below.</p>\n\n<pre><code>Sub RunMe()\nFor Each cell In Range(Range(\"F2:\"), Range(\"F\" &amp; Rows.Count).End(xlUp))\n    cell.EntireRow.Copy\n    On Error GoTo CreateSheet\n    Sheets(cell.Value).Select\n    Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial\nNext cell\n\nApplication.CutCopyMode = False\nExit Sub\n\nCreateSheet:\nWorksheets.Add.Name = cell.Value\nResume\n\nEnd Sub\n</code></pre>\n\n<p>I borrowed it from hours of googling. It creates the sheets, but then they are blank.</p>\n\n<p>please help!</p>\n"}, {"tags": ["vba", "ms-access", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3925447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f736583332c234b0b0ac5a4bac49a71?s=128&d=identicon&r=PG&f=1", "display_name": "crimsonzero2", "link": "https://stackoverflow.com/users/3925447/crimsonzero2"}, "edited": false, "score": 0, "creation_date": 1492690507, "post_id": 43506274, "comment_id": 74091580, "body": "That&#39;s a bummer that I can&#39;t have it work and look the way the user want it to.  Thank you for the answer though."}], "tags": [], "owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "is_accepted": true, "score": 1, "last_activity_date": 1492636855, "creation_date": 1492636855, "answer_id": 43506274, "question_id": 43505509, "link": "https://stackoverflow.com/questions/43505509/microsoft-access-search-using-a-different-column/43506274#43506274", "title": "Microsoft Access Search Using A Different Column", "body": "<p>Simple answer: No. A combo box control will always search (autocomplete) the displayed value, which will be the first row source column with a non-zero width. The only way to achieve what you want would be to have two controls. You could have a combo box with Code as the first column followed by Name and Nickname, and then have a locked text box with <code>Control Source</code> set to <code>=myCombo.Column(1)</code></p>\n"}], "owner": {"reputation": 3, "user_id": 3925447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f736583332c234b0b0ac5a4bac49a71?s=128&d=identicon&r=PG&f=1", "display_name": "crimsonzero2", "link": "https://stackoverflow.com/users/3925447/crimsonzero2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 43506274, "answer_count": 1, "score": 0, "last_activity_date": 1492636855, "creation_date": 1492633841, "question_id": 43505509, "link": "https://stackoverflow.com/questions/43505509/microsoft-access-search-using-a-different-column", "title": "Microsoft Access Search Using A Different Column", "body": "<p>I have a ComboBox that has columns: Name, Nickname, and Code in it.  Currently, it is set up to search based on Name as the user types in the ComboBox when the user would prefer to type the Code instead.  Is there a way to set it up so the ComboBox displays like it is originally set up while allowing the user to search using the Code column?  I know that I can easily put the Code column in front of the Name column, but the user would like to keep the format the same.</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1492633672, "post_id": 43505382, "comment_id": 74065566, "body": "<a href=\"http://stackoverflow.com/a/1099570/3820271\">How to debug dynamic SQL in VBA</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492634762, "post_id": 43505382, "comment_id": 74066202, "body": "<a href=\"http://stackoverflow.com/a/43191528/1188513\">Avoid SQL Injection issues with parameterized queries</a>."}, {"owner": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1492635291, "post_id": 43505382, "comment_id": 74066476, "body": "what&#39;s the data type of the 6th variable?"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 2, "creation_date": 1492639604, "post_id": 43505382, "comment_id": 74068441, "body": "Try replacing this line <code>w = w &amp; &quot; week = &#39;&quot; &amp; Range(&quot;B5&quot;).Value &amp; &quot;&#39; &quot;</code>  with this <code>w = w &amp; &quot; week = &quot; &amp; Range(&quot;B5&quot;).Value &amp; &quot;&quot;</code>"}, {"owner": {"reputation": 17, "user_id": 4975326, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0da4616b88ae5b890b99dfeec40b9a10?s=128&d=identicon&r=PG&f=1", "display_name": "bermudamohawk", "link": "https://stackoverflow.com/users/4975326/bermudamohawk"}, "edited": false, "score": 0, "creation_date": 1492686882, "post_id": 43505382, "comment_id": 74088917, "body": "what&#39;s the data type of the 6th variable? - integer - no decimals. It;s a week number identifier"}, {"owner": {"reputation": 17, "user_id": 4975326, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0da4616b88ae5b890b99dfeec40b9a10?s=128&d=identicon&r=PG&f=1", "display_name": "bermudamohawk", "link": "https://stackoverflow.com/users/4975326/bermudamohawk"}, "edited": false, "score": 0, "creation_date": 1492690243, "post_id": 43505382, "comment_id": 74091407, "body": "Mark as answer doesn&#39;t seem to be available. EMM - that solved it, thank you. Just a closing single quote, looks like? - thanks again - BM"}], "owner": {"reputation": 17, "user_id": 4975326, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0da4616b88ae5b890b99dfeec40b9a10?s=128&d=identicon&r=PG&f=1", "display_name": "bermudamohawk", "link": "https://stackoverflow.com/users/4975326/bermudamohawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 541, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492675481, "creation_date": 1492633265, "last_edit_date": 1531164843, "question_id": 43505382, "link": "https://stackoverflow.com/questions/43505382/automation-error-80040e07-using-cn-executestrsql", "title": "automation error 80040e07 using cn.Execute(strSql)", "body": "<p>I have a macro that assembles an SQL query to send to Access.\nIt was working fine with 5 variables (excel values)</p>\n\n<p>When I add a sixth, the error in the title is generated.</p>\n\n<p>Screenshot attached on line in execution prior to error.\nMouse held over variable to show value.<a href=\"https://i.stack.imgur.com/33YU3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/33YU3.jpg\" alt=\"80040e07\"></a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub sum()\nDim cn As Object\nDim rs As Object\nDim strSql As String\nDim strConnection As String\nSet cn = CreateObject(\"ADODB.Connection\")\nstrConnection =Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\\\\Gr-001\\data\\GR-DEPTS\\999-SHRD\\data\\GRHours.accdb;\"\n'validation\nIf Range(\"B3\").Value &lt;&gt; \"\" And (Range(\"B4\").Value &lt;&gt; \"\" Or Range(\"C4\").Value &lt;&gt; \"\") Then\nMsgBox \"You cannot have both single date and date range entered at the same time.\", vbOKOnly + vbCritical, \"Error\"\nExit Sub\nEnd If\nDim w As String\n\n'beginning of SQL string\nstrSql = \"select sum(hours) from GRHours \"\n\nw = \"\"\n\n'check criteria for employee\nIf Range(\"B2\").Value &lt;&gt; \"\" Then w = w &amp; \" employee = '\" &amp; Range(\"B2\").Value &amp; \"' \"\n\n'check criteria for date (single)\nIf Range(\"B3\").Value &lt;&gt; \"\" Then\nIf w &lt;&gt; \"\" Then w = w &amp; \" AND \"\nw = w &amp; \" [date] = CDATE('\" &amp; Range(\"B3\").Value &amp; \"') \"\nEnd If\n\n'check criteria for date (beginning)\nIf Range(\"B4\").Value &lt;&gt; \"\" Then\nIf w &lt;&gt; \"\" Then w = w &amp; \" AND \"\nw = w &amp; \" [date] &gt;= CDATE('\" &amp; Range(\"B4\").Value &amp; \"') \"\nEnd If\n\n'check criteria for date (end)\nIf Range(\"C4\").Value &lt;&gt; \"\" Then\nIf w &lt;&gt; \"\" Then w = w &amp; \" AND \"\nw = w &amp; \" [date] &lt;= CDATE('\" &amp; Range(\"C4\").Value &amp; \"') \"\nEnd If\n\n'check criteria for job\nIf Range(\"B6\").Value &lt;&gt; \"\" Then\nIf w &lt;&gt; \"\" Then w = w &amp; \" AND \"\nw = w &amp; \" job = '\" &amp; Range(\"B6\").Value &amp; \"' \"\nEnd If\n\n'check criteria for task\nIf Range(\"B7\").Value &lt;&gt; \"\" Then\nIf w &lt;&gt; \"\" Then w = w &amp; \" AND \"\nw = w &amp; \" task = '\" &amp; Range(\"B7\").Value &amp; \"' \"\nEnd If\n\n'NEW INSERTION HERE - check criteria for week\nIf Range(\"B5\").Value &lt;&gt; \"\" Then\nIf w &lt;&gt; \"\" Then w = w &amp; \" AND \"\nw = w &amp; \" week = '\" &amp; Range(\"B5\").Value &amp; \"' \"\nEnd If\n'END NEW INSERTION\n\n\n'end of SQL string\nIf w &lt;&gt; \"\" Then strSql = strSql &amp; \" WHERE \" &amp; w\n\n'send string to access\ncn.Open strConnection\nSet rs = cn.Execute(strSql)\nActiveSheet.Range(\"B9\").CopyFromRecordset rs\n'End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1492633515, "post_id": 43505321, "comment_id": 74065476, "body": "Why work with <code>ActiveWorkbook</code> at all? Keep a reference to the <code>Workbook</code> objects you&#39;re working with, and use those."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492633538, "post_id": 43505321, "comment_id": 74065492, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492633516, "post_id": 43505406, "comment_id": 74065478, "body": "Note: this only works if the UserForm operates against <code>ThisWorkbook</code>. If it needs to operate against other workbook(s) being <i>active</i> at runtime (not enough detail in OP to say definitively), this may not work, for the same reason."}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492633639, "post_id": 43505406, "comment_id": 74065545, "body": "Thanks! Couldn&#39;t be much simpler!  To answer @DavidZemens, the workbook with the userform is entirely self contained, i.e. does not act on any other workbook."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "edited": false, "score": 0, "creation_date": 1492633833, "post_id": 43505406, "comment_id": 74065645, "body": "@MattD then that approach will work in <i>this</i> instance, but it will not work in more complicated scenarios you might encounter in the future :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "edited": false, "score": 2, "creation_date": 1492633908, "post_id": 43505406, "comment_id": 74065677, "body": "@MattD you shouldn&#39;t need to <code>Activate</code> it at all, you can simply refer to <code>ThisWorkbook.Worksheets...</code> instead of <code>ActiveWorkbook.Worksheets...</code> and that way it will work without needing to explicitly make any sheet active. There are other reasons why you may want to activate a sheet, from a UI or design perspective, but it&#39;s definitely not necessary to do so."}, {"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492634013, "post_id": 43505406, "comment_id": 74065756, "body": "@DavidZemens Thanks! I did a a find/replace ActiveWorkbook with ThisWorkbook in my module since it will work for this sheet. I&#39;ll have to do some studying about when it is best to use each."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1492634106, "post_id": 43505406, "comment_id": 74065813, "body": "It&#39;s never best to rely on <code>ActiveWorkbook</code>, <code>Select</code>, <code>Selection</code>, etc.. In some cases it&#39;s <i>easier</i>, but it&#39;s never <i>better</i>. <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Detailed explanation and how to avoid those things, here</a>."}], "tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": true, "score": 3, "last_activity_date": 1492633386, "creation_date": 1492633386, "answer_id": 43505406, "question_id": 43505321, "link": "https://stackoverflow.com/questions/43505321/excel-2013-vba-setting-activeworkbook-when-clicking-between-workbooks/43505406#43505406", "title": "Excel 2013 VBA: Setting activeworkbook when clicking between workbooks", "body": "<p>Instead of <code>activeworkbook</code> use <code>thisworkbook</code> which returns the workbook in which the code resides.</p>\n\n<p>To make it active <code>thisworkbook.activate</code> should work</p>\n"}], "owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 781, "favorite_count": 0, "accepted_answer_id": 43505406, "answer_count": 1, "score": 1, "last_activity_date": 1492633386, "creation_date": 1492633065, "question_id": 43505321, "link": "https://stackoverflow.com/questions/43505321/excel-2013-vba-setting-activeworkbook-when-clicking-between-workbooks", "title": "Excel 2013 VBA: Setting activeworkbook when clicking between workbooks", "body": "<p>I have a workbook with a userform that contains a listbox that is used to populate data on a sheet.</p>\n\n<p>If I have multiple workbooks open and I click from one workbook directly to the listbox on the userform in the other workbook, the ListBox_Change event fires before Activeworkbook changes to reflect the workbook that contains the userform.  So when the code reaches <code>Set EqDataSht = ActiveWorkbook.Worksheets(\"Equipment-Data\")</code> I get a subscript out of range error because the workbook I'm coming from doesn't contain a sheet named \"Equipment-Data\".</p>\n\n<p>What is the best way to set the ActiveWorkbook to the parent of the userform?  Thoughts I've had are setting a public variable <code>wb = ActiveWorkbook</code> on workbook_open or just trapping Err.Number=9 and telling the user to click on the sheet before clicking the userform.  I'm sure there is something simple I am completely overlooking (VBA amateur).</p>\n\n<p>Thoughts?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1492641588, "post_id": 43505041, "comment_id": 74069133, "body": "BTW, VB uses <code>#</code> for date and time literals: <code>If rng.Value &gt; #1:30# Then</code> or <code>If rng.Value2 &gt; 0.0625 Then</code>"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1492692382, "post_id": 43505041, "comment_id": 74093020, "body": "why do you not just do a sumif?"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492690161, "post_id": 43505303, "comment_id": 74091344, "body": "I think this could work, however I made the mistake in typing B3:B9, when it should be rows, B3:F3, B4:F4, ect.  I apologize for that."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492692660, "post_id": 43505303, "comment_id": 74093274, "body": "so I adjusted the code for a timevalue of 1 hour, since none of the days had a value above an hour and 30.  However, the output for each row was odd.  In the range of -0.01 to -0.001 for each row that had values over 60 minutes.  Any ideas?  For example, row 3 gave -0.0302546296296296"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492692741, "post_id": 43505303, "comment_id": 74093355, "body": "@sbagnato Did you change the TimeValue in both locations?  It&#39;s in the code twice."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492693165, "post_id": 43505303, "comment_id": 74093726, "body": "if I could facepalm on here, I would.  That line was slightly off my screen so I did not see it.  Now it works great.  If you want me to ask this in a new question, I can.  However, do you think there is anyway to get it to ignore the first instance of over 90 minutes, but then add subsequent instances?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492694365, "post_id": 43505303, "comment_id": 74094734, "body": "@sbagnato Updated code.  It will ignore the first instance over <code>dTime</code> (which is a variable I added so you only have to change the desired time in a single location) for each row."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492697106, "post_id": 43505303, "comment_id": 74096997, "body": "Awesome!  Thanks!"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1493132716, "post_id": 43505303, "comment_id": 74277773, "body": "Hey @tigeravatar how can I edit this code so that if the value is larger than a threshold, count it anyway?  For instance, if the analyst goes above 95 minutes on break, the first value is counted anyway.  I have not changed your code above much besides changing variable names."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1492694299, "last_edit_date": 1492694299, "creation_date": 1492632997, "answer_id": 43505303, "question_id": 43505041, "link": "https://stackoverflow.com/questions/43505041/excel-vba-if-value-exists-x-add-to-sum/43505303#43505303", "title": "Excel VBA - If value exists &gt; x, add to sum", "body": "<p>Hard to say if this is fully accurate without more information, but something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim aTimes As Variant\n    Dim dTime As Double\n    Dim aSumResults() As Double\n    Dim lResultIndex As Long\n    Dim i As Long, j As Long\n    Dim bFirst As Boolean\n\n    dTime = TimeValue(\"01:00:00\")\n    aTimes = ActiveSheet.Range(\"B3:F9\").Value 'Change to the full table range\n    ReDim aSumResults(1 To UBound(aTimes, 1) - LBound(aTimes, 1) + 1, 1 To 1)\n\n    For i = LBound(aTimes, 1) To UBound(aTimes, 1)\n        'Each i represents a row of the data\n        'Go through each column and collect the conditional sums\n        lResultIndex = lResultIndex + 1\n        bFirst = True   'Use bFirst to ignore first value greater than dTime\n        For j = LBound(aTimes, 2) To UBound(aTimes, 2)\n            If aTimes(i, j) &gt; dTime Then\n                If bFirst Then\n                    'This if the first value found for the row, ignore it\n                    bFirst = False\n                Else\n                    'Not the first value found, include in sum\n                    aSumResults(lResultIndex, 1) = aSumResults(lResultIndex, 1) + aTimes(i, j) - dTime\n                End If\n            End If\n        Next j\n    Next i\n\n    'Output the results\n    ActiveSheet.Range(\"G3\").Resize(UBound(aSumResults, 1)).Value = aSumResults\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492688980, "post_id": 43506000, "comment_id": 74090500, "body": "Yes, I apologize.  I meant row, but typed out a column.  So the first row would be B3:F3, the second C4:F4, and the final one B9:F9.  The sums of the values over 91 minutes would go in G3, G4....G9."}], "tags": [], "owner": {"reputation": 64, "user_id": 7112084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cb60c912881192d7b3ac827012a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam ", "link": "https://stackoverflow.com/users/7112084/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1492639922, "last_edit_date": 1492639922, "creation_date": 1492635743, "answer_id": 43506000, "question_id": 43505041, "link": "https://stackoverflow.com/questions/43505041/excel-vba-if-value-exists-x-add-to-sum/43506000#43506000", "title": "Excel VBA - If value exists &gt; x, add to sum", "body": "<p>You said you wanted the sum of the times in a row but then defined B3:B9, so I assumed you meant the sum of the times in a column.\nTry this:</p>\n\n<pre><code>Dim i As Integer\nDim num1 As Date\nFor i = 3 To 9\n    If Cells(i, 2).Value &gt; TimeValue(\"1:30:00\") Then\n        num1 = Cells(10, 2).Value + Cells(i, 2).Value - TimeValue(\"1:30:00\")\n        Cells(10, 2).Value = num1\n    End If\nNext i\n</code></pre>\n\n<p>I've defined where the sum is put as cell B10. You could make a similar loop for each column. I tried this out and it worked for me.</p>\n"}, {"comments": [{"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492689885, "post_id": 43506032, "comment_id": 74091131, "body": "Yes, that does work.  However, I need to do it in VBA.  As noted above, I had a typo, the times are in a row (B3:F3), not a column, my apologies."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1492635852, "creation_date": 1492635852, "answer_id": 43506032, "question_id": 43505041, "link": "https://stackoverflow.com/questions/43505041/excel-vba-if-value-exists-x-add-to-sum/43506032#43506032", "title": "Excel VBA - If value exists &gt; x, add to sum", "body": "<p>If you want to avoid VBA, this can actually be done by an Excel formula:</p>\n\n<pre><code>=SUMIF($B$3:$B$9,\"&gt;\"&amp;1.5/24)-COUNTIF($B$3:$B$9,\"&gt;\"&amp;1.5/24)*1.5/24\n</code></pre>\n\n<p>That sums up all values that exceed 90 minutes, and then subtracts off 90 minutes from the total for each value that has been counted.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HtoEZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HtoEZ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 2, "last_activity_date": 1492645843, "last_edit_date": 1492645843, "creation_date": 1492643347, "answer_id": 43507537, "question_id": 43505041, "link": "https://stackoverflow.com/questions/43505041/excel-vba-if-value-exists-x-add-to-sum/43507537#43507537", "title": "Excel VBA - If value exists &gt; x, add to sum", "body": "<p>I would recommend Excel Formula if that is an option, because of the restrictions of VBA solutions.</p>\n\n<pre><code>=SUMPRODUCT((B$3:B9-1/16)*(B$3:B9&gt;1/16))\n</code></pre>\n\n<p>or a bit shorter with array formula (enter with Ctrl + Shift + Enter) :</p>\n\n<pre><code>=SUMIF(B$3:B9-1/16,\"&gt;0\")\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "accepted_answer_id": 43505303, "answer_count": 4, "score": 0, "last_activity_date": 1492694299, "creation_date": 1492632035, "last_edit_date": 1492690535, "question_id": 43505041, "link": "https://stackoverflow.com/questions/43505041/excel-vba-if-value-exists-x-add-to-sum", "title": "Excel VBA - If value exists &gt; x, add to sum", "body": "<p>I have a table with time values.  If any value exists in a specified row that is greater than 90 minutes (1:30:00), I need to add the difference (i.e. how much greater it is) to a running total at the end of the row.  So, that box could be blank, could have just one cell's value, or could have multiple values added.  I already have the For loop to go through each cell in a row.  I need the part to sum the values.  And ideally, if there was a nested loop to do 6 separate sums for the 6 rows...</p>\n\n<pre><code>'Add break munutes\nfp.Activate\nDim rng As Range\nFor Each rng In Range(\"B3:F3\")\n    If rng.Value &gt; TimeValue(\"1:31:00\") Then\n\n    End If\nNext rng\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/VfSEL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VfSEL.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "formulas", "vba"], "comments": [{"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "edited": false, "score": 1, "creation_date": 1492631467, "post_id": 43504830, "comment_id": 74064286, "body": "why did you post this question here?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1492632009, "post_id": 43504830, "comment_id": 74064611, "body": "Record a macro of your search and find for one of the countries, and show us what you get."}, {"owner": {"reputation": 7517, "user_id": 3314095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nJlbV.png?s=128&g=1", "display_name": "XOR LX", "link": "https://stackoverflow.com/users/3314095/xor-lx"}, "edited": false, "score": 0, "creation_date": 1492633740, "post_id": 43504830, "comment_id": 74065597, "body": "<a href=\"https://excelxor.com/2014/09/30/list-of-unique-entries-from-column-of-space-separated-strings/\" rel=\"nofollow noreferrer\">excelxor.com/2014/09/30/&hellip;</a> Shouldn&#39;t be too difficult for you to make the small adjustments from space-separated to comma-separated, though give me a shout if you get stuck."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7891886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11241c8bf042bd61ce58217f398b6179?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/7891886/doug"}, "edited": false, "score": 0, "creation_date": 1492632408, "post_id": 43504990, "comment_id": 74064845, "body": "Thanks, msitt!  This gets me the counts. Still looking for a way to isolate a unique list of countries if I just have what is in column A."}, {"owner": {"reputation": 1221, "user_id": 2533734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066ad9fe2953f1bfded7cf950f8880ec?s=128&d=identicon&r=PG&f=1", "display_name": "msitt", "link": "https://stackoverflow.com/users/2533734/msitt"}, "reply_to_user": {"reputation": 21, "user_id": 7891886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11241c8bf042bd61ce58217f398b6179?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/7891886/doug"}, "edited": false, "score": 0, "creation_date": 1492633026, "post_id": 43504990, "comment_id": 74065201, "body": "You can use &quot;Text to Columns&quot; and &quot;Remove Duplicates&quot; in Excel to get the unique list of countries."}, {"owner": {"reputation": 21, "user_id": 7891886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11241c8bf042bd61ce58217f398b6179?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/7891886/doug"}, "edited": false, "score": 0, "creation_date": 1492633869, "post_id": 43504990, "comment_id": 74065660, "body": "Thanks again for your time and expertise. I have tried text to columns and remove duplicates but not coming up with a unique list of countries. Text to columns leaves leading spaces and remove duplicates recognizes as separate values."}, {"owner": {"reputation": 1221, "user_id": 2533734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066ad9fe2953f1bfded7cf950f8880ec?s=128&d=identicon&r=PG&f=1", "display_name": "msitt", "link": "https://stackoverflow.com/users/2533734/msitt"}, "reply_to_user": {"reputation": 21, "user_id": 7891886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11241c8bf042bd61ce58217f398b6179?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/7891886/doug"}, "edited": false, "score": 0, "creation_date": 1492633992, "post_id": 43504990, "comment_id": 74065737, "body": "You can use TRIM() to remove the extra spaces."}], "tags": [], "owner": {"reputation": 1221, "user_id": 2533734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/066ad9fe2953f1bfded7cf950f8880ec?s=128&d=identicon&r=PG&f=1", "display_name": "msitt", "link": "https://stackoverflow.com/users/2533734/msitt"}, "is_accepted": false, "score": 1, "last_activity_date": 1492631845, "creation_date": 1492631845, "answer_id": 43504990, "question_id": 43504830, "link": "https://stackoverflow.com/questions/43504830/list-of-comma-separated-values-in-excel-cells-to-unique-list-of-values-and-count/43504990#43504990", "title": "List of comma separated values in Excel cells to unique list of values and count", "body": "<p>Put the following formula into cell <code>D2</code>:</p>\n\n<pre><code>=COUNTIF(A:A,\"*\"&amp;C2&amp;\"*\")\n</code></pre>\n\n<p>This works by matching with wildcards. For example, the first search is on <code>*Bulgaria*</code>.</p>\n\n<p>Note that if you have cases where a country name is contained in another, then you will count that too. (Not an issue for the example you posted.)</p>\n"}], "owner": {"reputation": 21, "user_id": 7891886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11241c8bf042bd61ce58217f398b6179?s=128&d=identicon&r=PG&f=1", "display_name": "Doug", "link": "https://stackoverflow.com/users/7891886/doug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2852, "favorite_count": 0, "closed_date": 1601305099, "answer_count": 1, "score": 0, "last_activity_date": 1601047289, "creation_date": 1492631272, "last_edit_date": 1531161705, "question_id": 43504830, "link": "https://stackoverflow.com/questions/43504830/list-of-comma-separated-values-in-excel-cells-to-unique-list-of-values-and-count", "closed_reason": "Needs more focus", "title": "List of comma separated values in Excel cells to unique list of values and count", "body": "<p>I have a list of countries separated by commas down 1 column.  I need to create a unique/distinct list of the countries and a count of how many times they appear as outlined in the picture.  Currently doing this via manual efforts and looking for a much quicker way.  Open to VBA but prefer formulas if possible.  Thanks!</p>\n\n<p><a href=\"https://i.stack.imgur.com/HSv16.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HSv16.jpg\" alt=\"Example image\"></a></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492629934, "post_id": 43504274, "comment_id": 74063315, "body": "So when you click your button, it will create a new row in the table with all fields from the old record except for any fields that are set to &#39;Locked&#39;? How will you decide which &#39;Locked&#39; fields you really want someone to be able to edit? And how will you decide which users you want to allow?"}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492631340, "post_id": 43504274, "comment_id": 74064212, "body": "@WayneG.Dunn There is only one field that I want to not copy and have only certain users able to edit. I don&#39;t know yet the user list that will be allowed to edit. I only maintain the DB, the person who created it has left the company."}], "answers": [{"comments": [{"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1492631467, "post_id": 43504758, "comment_id": 74064287, "body": "I&#39;m not worried about the end users messing with anything in the backend. None of them even know there is one. The Access DB is just a frontend for the SQL DB. I&#39;m the only one who can directly access the SQL. I just need a way to restrict what users can edit one field."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1492631679, "post_id": 43504758, "comment_id": 74064418, "body": "Okay, what I suggest is one way and it is transparent to the users, they won&#39;t even know because they are not required to do a login. When frontend opens, code can check if already a record for them and then respond accordingly, maybe refusing them access until they &#39;contact administrator&#39; in case someone neglected to add new employee to the Users table."}, {"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1492631916, "post_id": 43504758, "comment_id": 74064558, "body": "So the <code>Environ(&quot;USERNAME&quot;)</code> captures the windows username of whoever opens the DB? If that&#39;s the case I might be able to just use a list of the users who do need the edit ability and just not allow anyone else."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1492632606, "post_id": 43504758, "comment_id": 74064959, "body": "It captures username of whoever is logged into that computer where the database is opened. I haven&#39;t tested situation where more than one user has logged onto the same computer and independently opens the database. Everybody in the office has their own computer."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1492633406, "post_id": 43504758, "comment_id": 74065400, "body": "Note that a simple batch file like this will spoof <code>Environ(&quot;USERNAME&quot;)</code> : <code>SET USERNAME=superuser &#47;&#47; start &quot;C:\\Program Files (x86)\\Microsoft Office\\Office14\\MSACCESS.EXE&quot; &quot;C:\\Users\\neo\\Documents\\Database1.accdb&quot;</code>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1492634167, "post_id": 43504758, "comment_id": 74065849, "body": "Yes, as they say &quot;locks are made to be picked&quot;. If someone really wants to do something bad enough they will find a way."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1492631020, "creation_date": 1492631020, "answer_id": 43504758, "question_id": 43504274, "link": "https://stackoverflow.com/questions/43504274/is-there-a-way-to-protect-a-field-so-that-only-certain-users-can-edit/43504758#43504758", "title": "Is there a way to protect a field so that only certain users can edit?", "body": "<p>What I do is have a table of users and their permissions level and Windows login username. I capture username with <code>Environ(\"USERNAME\")</code> and match with the users record and set up forms appropriately, usually just disable/hide particular buttons. </p>\n\n<p>But really have to do a lot more setup of the database to prevent users from accessing restricted data. Like hide navigation pane, disable ribbon, disable right click shortcut menu, disable function keys, maybe even publish as executable.</p>\n\n<p>But if they know where the backend is, what stops them from just opening it? Unless you go to something like SQLServer database, really nothing.</p>\n"}, {"comments": [{"owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "edited": false, "score": 0, "creation_date": 1492690712, "post_id": 43505158, "comment_id": 74091728, "body": "This did it! Thanks for the help!"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1492632450, "last_edit_date": 1495541392, "creation_date": 1492632450, "answer_id": 43505158, "question_id": 43504274, "link": "https://stackoverflow.com/questions/43504274/is-there-a-way-to-protect-a-field-so-that-only-certain-users-can-edit/43505158#43505158", "title": "Is there a way to protect a field so that only certain users can edit?", "body": "<p>I suggest a sub to lock / unlock the controls, like this:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub SetControlsLocked(ForceLocked As Boolean)\n\n    Dim bLocked As Boolean\n    Dim sUser As String\n\n    If ForceLocked Then\n        ' Always lock before copying\n        bLocked = True\n    Else\n        ' More secure method than Environ(\"USERNAME\")\n        sUser = CreateObject(\"WScript.Network\").UserName\n        ' Lock for everyone except some users\n        ' If the list is longer or changes regularly, lookup the Username in a table instead\n        bLocked = Not (sUser = \"jane\" Or sUser = \"bob\" Or sUser = \"mike\")\n    End If\n\n    ' do the locking\n    Me!Control1.Locked = bLocked\n    Me!Control2.Locked = bLocked\n\nEnd Sub\n</code></pre>\n\n<p>(refer to comments on <a href=\"https://stackoverflow.com/a/32565953/3820271\">https://stackoverflow.com/a/32565953/3820271</a> for \"more secure\" claim).</p>\n\n<p>and apply in your copy button routine...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdCopy_Click()\n\n    ' Lock before copying!\n    Call SetControlsLocked(True)\n\n    ' ... your existing copy routine\n\n    ' Unlock for special users\n    Call SetControlsLocked(False)\n\nEnd Sub\n</code></pre>\n\n<p>... and when opening the form:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Load()\n    ' Lock for non-special users\n    Call SetControlsLocked(False)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1648, "user_id": 2911241, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCs44.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2911241/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "accepted_answer_id": 43505158, "answer_count": 2, "score": 1, "last_activity_date": 1492632450, "creation_date": 1492629448, "question_id": 43504274, "link": "https://stackoverflow.com/questions/43504274/is-there-a-way-to-protect-a-field-so-that-only-certain-users-can-edit", "title": "Is there a way to protect a field so that only certain users can edit?", "body": "<p>I have an Access 2010 DB that I need to update a field in. Right now I have a button on one of my forms that will duplicate the selected row. I know that I can make a field not duplicate by setting the <code>Locked</code> property to <code>Yes</code> on that field.</p>\n\n<p>What I need to do is find a way to make a field not duplicate, but still be editable to certain people. I don't want to set the <code>Locked</code> property as that will lock it for everyone. </p>\n\n<p>I've no idea how to do this except to change the working of the <code>Duplicate record</code> button. Right now it simply makes a copy of the row that is selected and pastes it into the <code>New Record</code> row. This takes all fields that are not <code>Locked</code>. </p>\n\n<p>I read about possibly using a bunch of variables and setting them to the values of each of the fields, but this seems cumbersome since I have 160+ fields that I would have to setup. And then pasting them into the <code>New Record</code> row. I would prefer not to have to do this.</p>\n\n<p>I have used VBA just not with Access very much. A VBA solution is fine with me, I have not tried anything as I don't know where to even start.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492632316, "post_id": 43503984, "comment_id": 74064795, "body": "FWIW I&#39;m pretty sure this is a dupe... only I can&#39;t find it ATM."}], "answers": [{"tags": [], "owner": {"reputation": 243, "user_id": 6456800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7d9c1c5f3fb0426747663d2c944482?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6456800/unknown"}, "is_accepted": false, "score": -3, "last_activity_date": 1492630114, "creation_date": 1492630114, "answer_id": 43504494, "question_id": 43503984, "link": "https://stackoverflow.com/questions/43503984/cell-values-controlled-by-master-top-level-entry/43504494#43504494", "title": "Cell values controlled by master/top level entry", "body": "<pre><code>If [Process].Cells(1, 1).Value = \"No\" Then\n   [Process].Cells(2, 1).Value = \"No\"\n   End\n\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "edited": false, "score": 0, "creation_date": 1492691936, "post_id": 43504742, "comment_id": 74092647, "body": "I see how your code should work and it makes a lot more sense than the quick way I had attempted. However, nothing happens when I try to use your code. My table appears to be named correctly in both the table properties and in the VBA editor. I tried to replace the cell change with a msgbox to get a popup when it runs, but nothing happened so somehow I&#39;m not entering the loop."}, {"owner": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "edited": false, "score": 0, "creation_date": 1492717564, "post_id": 43504742, "comment_id": 74110151, "body": "Sorry, loop was the wrong word. I was just trying to test to see if the macro was even firing. I do have worksheet events active. And I have the above sub&#39;s on the worksheet page that the table is on, that&#39;s the correct place?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "edited": false, "score": 0, "creation_date": 1492717726, "post_id": 43504742, "comment_id": 74110236, "body": "The <code>Change</code> event will fire whenever anything <i>changes</i> on <i>that</i> worksheet, if worksheet/application events are enabled. Verify that you have the correct handler signature/name. At the top of the code pane, the left-hand dropdown should say &quot;Worksheet&quot;, and the right-hand dropdown should say &quot;Change&quot;. If that&#39;s not the case then you&#39;re not handling the <code>Change</code> event and nothing is calling your procedure."}, {"owner": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "edited": false, "score": 0, "creation_date": 1492718026, "post_id": 43504742, "comment_id": 74110382, "body": "I do in fact have both of those on Sheet7 where my table is.  perhaps a better question is, I have 7 of these sub tables. Is what we are attempting the best way to handle this &quot;master&quot; yes/no control that I want. Should I just be going about it differently than a VBA macro to do it?"}, {"owner": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "edited": false, "score": 0, "creation_date": 1492718302, "post_id": 43504742, "comment_id": 74110530, "body": "I added in a message box above and below the Application.enableevents lineand it will active when I change the value of any cell. It seems that the With table.range part is what isn&#39;t working."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "edited": false, "score": 0, "creation_date": 1492718559, "post_id": 43504742, "comment_id": 74110682, "body": "Your question was about one table on one specific worksheet. If you want to handle the case where anything changes on any sheet, handle <code>SheetChange</code> in the <code>ThisWorkbook</code> module; use the <code>Sh</code> parameter to determine which sheet was modified, and the <code>Target</code> parameter to determine which specific range/cell was modified. Learn to use the debugger: breakpoints (F9), step-through (F8), the immediate pane (Ctrl+G). Place a breakpoint on the <code>Set ProcessTable = Me.ListObjects(&quot;...&quot;)</code> instruction, hit F8 and then do <code>?ProcessTable Is Nothing</code> in the debug pane. Should say <code>False</code>. Fix accordingly."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1492631622, "last_edit_date": 1492631622, "creation_date": 1492630965, "answer_id": 43504742, "question_id": 43503984, "link": "https://stackoverflow.com/questions/43503984/cell-values-controlled-by-master-top-level-entry/43504742#43504742", "title": "Cell values controlled by master/top level entry", "body": "<p>The <code>Worksheet_Change</code> handler executes whenever any cell value changes on that worksheet.</p>\n\n<p><code>[Process]</code> being a bracketed expression, it gets evaluated at run-time by Excel, which has no choice to assume you're referring to the active sheet (the one handling <code>Worksheet_Change</code>), which means your <code>Process</code> table is on the very sheet being modified.</p>\n\n<p>Your handler is callling itself, <em>ad infinitum</em>, until the call stack violently explodes.</p>\n\n<p>Disable worksheet events before:</p>\n\n<pre><code>Application.EnableEvents = False\n</code></pre>\n\n<p>And restore them after:</p>\n\n<pre><code>Application.EnableEvents = True\n</code></pre>\n\n<p>That way any modifications you make to the worksheet while handling that \"hey I'm being modified\" event, won't fire up another \"hey I'm being modified\" event.</p>\n\n<hr>\n\n<p>I'd suggest you also replace the bracketed expression by actual object model calls, so as to get compile-time validation.</p>\n\n<pre><code>Public Property Get ProcessTable() As ListObject\n    Set ProcessTable = Me.ListObjects(\"Process\")\nEnd Property\n\nPrivate Sub Worksheet_Change(ByVal target As Range)\n\n    Application.EnableEvents = False\n    On Error GoTo CleanExit\n\n    Static table As ListObject\n    If table Is Nothing Then Set table = ProcessTable\n\n    With table.Range\n        If .Cells(1, 1).Value = \"No\" Then .Cells(2, 1).Value = \"No\"\n    End With\n\nCleanExit:    \n    Application.EnableEvents = True\n    Err.Clear\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 5547753, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/579de7b649442b2a4192bc8ba4a993be?s=128&d=identicon&r=PG&f=1", "display_name": "Ben A", "link": "https://stackoverflow.com/users/5547753/ben-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492631622, "creation_date": 1492628308, "question_id": 43503984, "link": "https://stackoverflow.com/questions/43503984/cell-values-controlled-by-master-top-level-entry", "title": "Cell values controlled by master/top level entry", "body": "<p>I'm building a user entry form in Excel (I know it isn't the ideal way, but it's the preferred program for all things here).</p>\n\n<p>I have a series of questions that the user needs to answer that are broken into sub sets. I would like to have a master question for each subset that will auto assign all the remaining items to \"no\". I have each subset of questions in its own table to simplify other tasks (the Table is named \"Process\") and the top left cell is the master yes/no entry cell. The worksheet macro I have crashes Excel right after it runs. Am I missing something?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\n    If [Process].Cells(1, 1).Value = \"No\" Then\n        [Process].Cells(2, 1).Value = \"No\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>I'm guessing that the test runs continuously for the test and that causes the crash. But I'm not sure how to best exit the sub.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "keyword", "reserved"], "comments": [{"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1492628629, "post_id": 43503980, "comment_id": 74062543, "body": "SpeedRestriction isn&#39;t a keyword. <a href=\"https://support.office.com/en-us/article/Access-2007-reserved-words-and-symbols-e33eb3a9-8baa-4335-9f57-da237c63eabe\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>  So are you sure you&#39;re connecting to an instance of the database which has data in speedRestriction?  or that the table exists and you&#39;re not getting an error?"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1492628880, "post_id": 43503980, "comment_id": 74062675, "body": "SpeedRestriction is not. But Restrict is. Can sql make that distinction? There are 950 records in the table. connection is fine. when I run the query in access it works. But in VBA I don&#39;t get records, neither do I get any errors. I tried running the same code with different table names in the query. It works perfectly fine."}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 1, "creation_date": 1492629114, "post_id": 43503980, "comment_id": 74062835, "body": "No it can&#39;t make that distinction.  the table name is SpeedRestriction.  So something else is going on.  used  debug.print or copy/paste to get the and pasted the sSQL and then tried to run it and it works?  making sure no spelling mistake/Typo on SpeedRestriction"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492629279, "post_id": 43503980, "comment_id": 74062928, "body": "Perhaps your table is actually named <code>SpeedRestrictions</code>? Or there&#39;s a typo somewhere? If you copy the query from the VBA code and paste it in Access, does it return rows? <b>Are you getting any error?</b>"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 1, "creation_date": 1492629321, "post_id": 43503980, "comment_id": 74062954, "body": "If there is any question about the table name, instead of opening using SQL (adCmdText), try opening the table by name (adCmdTable)."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492629610, "post_id": 43503980, "comment_id": 74063124, "body": "Have you used &#39;Option Explicit&#39; and compiled all your code? Do you have any error handling involved? Try what @Mat&#39;sMug suggested - it will help pinpoint the issue."}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492630010, "post_id": 43503980, "comment_id": 74063361, "body": "@Mat&#39;sMug, I tried that. Query works perfectly fine. It is &#39;SpeedRestriction&#39;. It is not &#39;SpeedRestrictions&#39;. Following is the result of debug sSql and BOF and EOF --- select * from SpeedRestriction True True"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492630160, "post_id": 43503980, "comment_id": 74063447, "body": "You <i>still</i> haven&#39;t answered the single fundamental question everybody involved has been asking you: are you getting any error? If so, <a href=\"https://stackoverflow.com/posts/43503980/edit\">edit</a> your post to include it. If you&#39;re not getting any errors, did you by any chance happen to remove an instruction saying <code>On Error Resume Next</code> in your code before posting it here?"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492630300, "post_id": 43503980, "comment_id": 74063524, "body": "Hi @Mat&#39;sMug, no I am not getting any errors. I am not doing any kind of error handling as of now"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492630349, "post_id": 43503980, "comment_id": 74063551, "body": "Have you tried @WayneG.Dunn&#39;s suggestion of opening the table as a table instead of doing <code>SELECT *</code>?"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492630556, "post_id": 43503980, "comment_id": 74063693, "body": "@WayneG.Dunn, as per your suggestions, I tried using following code to retrieve rows from SpeedRestriction table. rs.Open &quot;SpeedRestriction&quot;, conn, adOpenForwardOnly, adLockPessimistic, adCmdTable It does not give me any errors. recordcount property returns 0."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492631040, "post_id": 43503980, "comment_id": 74064038, "body": "The issue is not with the spelling of table name - you will get an error if table name does not exist (since you have no error trap). Try misspelling the name and see if you get the error. As for your recordcount, since you are opening &#39;adOpenForwardOnly&#39;, the recordcount will not work as you expect. To prove that point, change your statement to &#39;adOpenStatic&#39; instead of &#39;adOpenForwardOnly&#39;"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492631913, "post_id": 43503980, "comment_id": 74064556, "body": "@WayneG.Dunn, you are right. Table name is correct. if I misspell , I get error. Interestingly when I change to adOpenStatic then also recordcount returns zero.                                        &#39; rs.Open &quot;SpeedRestriction&quot;, conn, adOpenStatic, adLockOptimistic, adCmdTable                                                                                                Debug.Print rs.EOF Debug.Print rs.BOF Debug.Print   rs.RecordCount      &#39;                                                                                      returns True, True , 0"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492632521, "post_id": 43503980, "comment_id": 74064906, "body": "Since I do not see zero recordcount with your code, I&#39;m slightly puzzled.  For grins, please add a rs.MoveLast  rs.MoveFirst just before the Debug.Print rs.RecordCount."}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492632657, "post_id": 43503980, "comment_id": 74064989, "body": "@WayneG.Dunn, as per your suggestion I added rs.MoveLast just before the debug. It gives me Runtime error 3021-either BOF or EOF is true or the current record has been deleted."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492632848, "post_id": 43503980, "comment_id": 74065094, "body": "Then you have zero records returned! You could say &quot;if not rs.eof then rs.movelast rs.movefirst...&quot;"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492693091, "post_id": 43503980, "comment_id": 74093670, "body": "@WayneG.Dunn, it does not serve my purpose. There are 900+ records in that table. When I run this same code with other tables in the database it works fine. but only for this table, it does not fetch the records. nor does it give any errors/exception."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492694872, "post_id": 43503980, "comment_id": 74095144, "body": "If you ger &#39;rs.eof = true&#39; after the open, then it is returning zero rows. Is there anything &#39;not simple&#39; about the design of that table? Next I would create a new database, import only that table, open the table, view the records, compact/repair, then run your code against the new database. Or try using DAO to see if that works. There possibly is corruption."}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "edited": false, "score": 0, "creation_date": 1492695010, "post_id": 43503980, "comment_id": 74095254, "body": "Hi , I solved this problem. The mdb file was placed in a separate folder than the vba script (But it was valid path on the local laptop). I placed the .mdb file in the same folder as that of vba script and changed the path accordingly in the script. It ran perfectly fine .But I still fail to understand how other tables rows are fetched and only one table gives a problem. It does not make sense to me"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1492695168, "post_id": 43503980, "comment_id": 74095381, "body": "@WayneG.Dunn, Yes I tried witht DAO code today. It worked perfectly fine with the other tables but did not fetch records only from this particular table. I checked the schema for this table.it looks fine. Nothing peculiar.It is a table with 21 fields.Strange :)"}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "is_accepted": false, "score": 0, "last_activity_date": 1492696112, "creation_date": 1492696112, "answer_id": 43521434, "question_id": 43503980, "link": "https://stackoverflow.com/questions/43503980/sql-query-with-restricted-keyword-in-it-causing-query-to-not-work/43521434#43521434", "title": "SQL query with restricted keyword in it causing query to not work", "body": "<p>I solved this problem. The mdb file was placed in a separate folder than the vba script (But it was valid path on the local laptop). I placed the .mdb file in the same folder as that of vba script and changed the path accordingly in the script. It ran perfectly fine .But I still fail to understand how other tables rows are fetched and only one table gives a problem. It does not make sense to me</p>\n"}], "owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492696112, "creation_date": 1492628298, "last_edit_date": 1492630796, "question_id": 43503980, "link": "https://stackoverflow.com/questions/43503980/sql-query-with-restricted-keyword-in-it-causing-query-to-not-work", "title": "SQL query with restricted keyword in it causing query to not work", "body": "<p>I am trying to connect to mdb database through VBA. The code is perfectly fine. If I run the query on any other table , it works perfectly fine. But when I use the table name 'SpeedRestriction', then the query does not return any rows. I tried square brackets , but it does not work. I have only readonly access to the database so changing pre-existing table name is not possible. The code does not give any errors/exceptions.</p>\n\n<p>Is there any workaround? Following is the code.</p>\n\n<pre><code>sPath = &lt;Valid path&gt;\n\nSet conn = New ADODB.Connection\nstrConnection = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"Data Source=\" &amp; sPath\n\n\nconn.Open strConnection\n\nSet rs = New ADODB.Recordset\nrs.CursorLocation = adUseClient\n\nsSql = \"Select * from SpeedRestriction\"\n\nrs.Open sSql, conn, adOpenForwardOnly, adLockPessimistic, adCmdText\n\nDebug.Print rs.EOF\nDebug.Print rs.BOF\n\n'XL_Ws_SpeedData.Range(\"A1\").CopyFromRecordset rs\nThisWorkbook.Worksheets(\"Speed Data\").Range(\"A1\").CopyFromRecordset rs\n\nSet rs = Nothing\nconn.Close\nSet conn = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492659396, "post_id": 43503820, "comment_id": 74073771, "body": "How do you want the value in &quot;S1&quot; to be modified ? by code ? how ?"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492659628, "post_id": 43503820, "comment_id": 74073847, "body": "The value of S1 is just a formula. It is changed by slicer selection"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6014, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492640559, "creation_date": 1492627732, "last_edit_date": 1492640559, "question_id": 43503820, "link": "https://stackoverflow.com/questions/43503820/filtering-a-pivot-table-filter-based-on-dynamically-changing-cell-value", "title": "Filtering a pivot table filter based on dynamically changing cell value?", "body": "<p>I have a pivot table that I'd like to be filtered based on the value of a cell. This cell changes dynamically, so I need the pivot table to filter dynamically.</p>\n\n<p>My code so far is:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nIf Intersect(Target, Range(\"S1\")) Is Nothing Then Exit Sub\n\nDim pt As PivotTable\nDim Field As PivotField\nDim NewCat As String\n\nSet pt = Sheet1.PivotTables(\"PivotTable6\")\nSet Field = pt.PivotFields(\"Region Name\")\nNewCat = Sheet1.Range(\"S1\").Value\n\nWith pt\nField.ClearAllFilters\nField.CurrentPage = NewCat\npt.RefreshTable\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The problem with this code is that the pivot table does not filter automatically. </p>\n\n<p>For the pivot table to filter, I need to manually select cell S1. This is a problem because the cell value changes, so I would need to constantly be clicking this cell.</p>\n\n<p>How do I modify the code so that the value of cell S1 is automatically selected and does not require me to manually click the cell?</p>\n"}, {"tags": ["vba", "excel", "search", "wildcard"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1492627472, "post_id": 43503707, "comment_id": 74061876, "body": "When you pass <code>shLook.Cells(row,col).Value</code> to VBA it consider it a string.  Wildcards should be used within the script itself."}, {"owner": {"reputation": 1456, "user_id": 3596604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/47c77a08038828dd4c8f6908d70d31e7?s=128&d=identicon&r=PG&f=1", "display_name": "phil652", "link": "https://stackoverflow.com/users/3596604/phil652"}, "edited": false, "score": 0, "creation_date": 1492630536, "post_id": 43503707, "comment_id": 74063675, "body": "I&#39;m guessing this is in excel? Please add missing tags"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7891623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ee89570124b35df0bff360f018f939?s=128&d=identicon&r=PG&f=1", "display_name": "falconrae", "link": "https://stackoverflow.com/users/7891623/falconrae"}, "edited": false, "score": 0, "creation_date": 1492722906, "post_id": 43506475, "comment_id": 74112760, "body": "Wow, this is very helpful thank you!  How can I adapt the above code suggested by @YowE3K if the wildcard is in the middle of the search string eg. if I have a long list of Vehicle numbers, I would want the search String to be :  Vehicle_no_*_to_sell  as opposed to having to elaborate the search String for each Vehicle number :  Vehicle_no_1_to_sell Vehicle_no_2_to_sell Vehicle_no_3_to_sell etc"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 11, "user_id": 7891623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ee89570124b35df0bff360f018f939?s=128&d=identicon&r=PG&f=1", "display_name": "falconrae", "link": "https://stackoverflow.com/users/7891623/falconrae"}, "edited": false, "score": 0, "creation_date": 1492723381, "post_id": 43506475, "comment_id": 74112943, "body": "Are you really after the position where the match commences, or are you just trying to find whether the strings &quot;match&quot;?  <code>&quot;Vehicle_no_1_to_sell&quot; Like &quot;Vehicle_no_*_to_sell&quot;</code> should return <code>True</code>, so the first part of the code would work.  Finding the position would be more difficult."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1492637641, "creation_date": 1492637641, "answer_id": 43506475, "question_id": 43503707, "link": "https://stackoverflow.com/questions/43503707/searching-with-a-wildcard/43506475#43506475", "title": "Searching with a wildcard", "body": "<p>If you simply want to know whether the string exists, you could use:</p>\n\n<pre><code>Dim found As Boolean\nDim searchString As String\nsearchString = shLook.Cells(i, 1).Value\nIf Left(searchString, 1) &lt;&gt; \"?\" Then searchString = \"*\" &amp; searchString\nIf Right(searchString, 1) &lt;&gt; \"?\" Then searchString = searchString &amp; \"*\"\nfound = shSource.Cells(rowSt, 18).Value Like searchString\n</code></pre>\n\n<p>If you then want to know the position where the string starts, you will need to strip the wildcard characters out before doing the <code>Instr</code>:</p>\n\n<pre><code>If Found Then\n    LPosition = InStr(shSource.Cells(rowSt, 18), Replace(Replace(searchString, \"?\", \"\"), \"*\", \"\"))\nEnd If\n</code></pre>\n\n<p>Note:  You can't simply do the second part without having done the first part, because you would get a false match in the case of searching for \"?ABC\" within \"XYZABCIJK\".</p>\n"}], "owner": {"reputation": 11, "user_id": 7891623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ee89570124b35df0bff360f018f939?s=128&d=identicon&r=PG&f=1", "display_name": "falconrae", "link": "https://stackoverflow.com/users/7891623/falconrae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492637721, "creation_date": 1492627331, "last_edit_date": 1492637721, "question_id": 43503707, "link": "https://stackoverflow.com/questions/43503707/searching-with-a-wildcard", "title": "Searching with a wildcard", "body": "<p>In the following code, <code>shLook</code> is a sheet with a list of text items that I wish to search for strings in the sheet <code>shSource</code> by iterating through its rows denoted by <code>rowSt</code>.</p>\n\n<pre><code>LPosition = InStr(1, shSource.Cells(rowSt, 18), shLook.Cells(i, 1).Value)\n</code></pre>\n\n<p>This works well, however if any text in <code>shLook</code> contains a wildcard, it no longer is able to find corresponding string in <code>shSource</code>.</p>\n\n<p>Is there another method to implement this so that I can put wildcards in the list of text items?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492626987, "post_id": 43503522, "comment_id": 74061589, "body": "Helpful to indicate which line raises the error."}, {"owner": {"reputation": 290, "user_id": 6499835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/251e60b26ebf1f96ca23c5e2e476f0ac?s=128&d=identicon&r=PG", "display_name": "SgtStens", "link": "https://stackoverflow.com/users/6499835/sgtstens"}, "edited": false, "score": 1, "creation_date": 1492627202, "post_id": 43503522, "comment_id": 74061722, "body": "If there are other answers that indicate how to loop through each workbook in a directory, then all you have to do from there is nest another loop within that, to loop through all sheets in each workbook."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492627293, "post_id": 43503522, "comment_id": 74061767, "body": "Also, unless I&#39;m not understanding what you&#39;re trying to do, this looks mistaken: <code>.Cells(1).Value = ws.Range(&quot;D3&quot;).Value</code>. Though it won&#39;t cause an error, it is 99.9% likely to be equivalent to <code>ws.Cells(1).Value = ws.Range(&quot;D3&quot;).Value</code>, which is basically just overwriting a cell on the same sheet with the value from D3, etc."}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492627792, "post_id": 43503522, "comment_id": 74062064, "body": "I also thought it would be that simple, but the nesting just gives errors like &quot;loop without Do&quot; or The Application defined error I talked about earlier. This complier does not even highlight line that is causing the error."}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492627878, "post_id": 43503522, "comment_id": 74062113, "body": "And your right that line is wrong now that you mention. I&#39;m not sure what I was thinking there"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492627886, "post_id": 43503522, "comment_id": 74062123, "body": "It is that simple, and a &quot;loop without do&quot; error indicates that you have a <code>Loop</code> statement somewhere without a corresponding <code>Do While</code> statement :D"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492628063, "post_id": 43503522, "comment_id": 74062231, "body": "Also, check again on your compile errors, it should highlight something, like: <a href=\"http://imgur.com/VrBpryH\" rel=\"nofollow noreferrer\">imgur.com/VrBpryH</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492628266, "post_id": 43503522, "comment_id": 74062339, "body": "Probably means you&#39;re attempting to <i>open</i> a loop with the <code>Loop</code> statement. You open it with <code>Do</code> or <code>Do While</code> or <code>Do Until</code> and close it with <code>Loop</code> or <code>Loop While</code> or <code>Loop Until</code>, and to make it even more confusing you can do basically the same thing with a <code>While&#47;Wend</code> loop!"}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492628516, "post_id": 43503522, "comment_id": 74062487, "body": "I edited the code above, funny enough I am unable to reproduce my &quot;loop without do&quot;, but I this version does not copy any data all"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492628688, "post_id": 43503522, "comment_id": 74062577, "body": "You need to pay more attention to what you&#39;re doing... <code>rngDest</code> is defined as part of <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;)</code> Examine your variables, their parent/child objects. You&#39;re looping over every workbook in a directory, but for some reason at each iteration you are looping over only the worksheets in <code>ThisWorkbook</code>, see: <b><code>For Each ws In ThisWorkbook.Worksheets</code></b>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492628832, "post_id": 43503522, "comment_id": 74062651, "body": "Therefore, your <code>With RngDest</code> block is simply taking data from <code>ThisWorkbook.Worksheets(ws.Name)</code> because <code>ws</code> is defined as part of <code>ThisWorkbook</code> and dumping it into the <code>rngDest</code>. If there&#39;s no data in any of these sheets, then it will give the appearance that nothing is happening."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492628865, "post_id": 43503522, "comment_id": 74062667, "body": "Have a look here, since it seems most of these can be identified if you&#39;re using basic <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">debugging</a> technique."}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492628979, "post_id": 43503522, "comment_id": 74062737, "body": "Thank you I will look through it"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492629622, "post_id": 43504152, "comment_id": 74063132, "body": "So  I have stepped through the code like the guide you sent said, so I understand a little better what is going on. and like you said the code no goes through each ws and then attempts to place data where rng dest tells it to. I&#39;m receiving a new error though &quot;object does not support this property or method&quot; My debugger honestly doesn&#39;t give me a line, maybe there is a setting for the debugger, im missing. I will update the code to reflect."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492629853, "post_id": 43504152, "comment_id": 74063266, "body": "The debugger <i>always</i> highlights an offending line if you&#39;re getting that error. Step through code using F8 if in doubt, and take note of which is the last line you execute before the error occurs. It could be something as simple as a typo (i.e., <code>ThisWorkbook.Workshets</code> instead of <code>Worksheets</code>, etc. NB: If you&#39;ve edited the code you&#39;re using, please update the code in the question accordingly, otherwise it&#39;s difficult to follow along with what you&#39;re doing :)"}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492630119, "post_id": 43504152, "comment_id": 74063416, "body": "maybe I&#39;m not doing it right, but I just paste over the code from my original question every time I make changes should I post the edited code in a comment instead"}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492630263, "post_id": 43504152, "comment_id": 74063503, "body": "Oh also the offending line is &quot;For each ws in wkbkorigin&quot; if try to step into or step over that line I receive and error"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492630838, "post_id": 43504152, "comment_id": 74063887, "body": "Oh, sorry I did not see the updated code, but on second look yes you are doing it correctly. My mistake in the answer, it should be <code>For Each ws in wkbkorigin.Worksheets</code> :)"}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492631192, "post_id": 43504152, "comment_id": 74064136, "body": "No you were right, you had it listed in your original post I must have over looked it. I&#39;m getting no errors now, but also no results I will attempt to step through the code to figure out why"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492631559, "post_id": 43504152, "comment_id": 74064349, "body": "I added the <code>.Worksheets</code> after you mentioned the error to me, so it wasn&#39;t there originally."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492631656, "post_id": 43504152, "comment_id": 74064404, "body": "The problem is your <code>RngDest</code> is not being redefined appropriately or at the right time.  Instead of <code>RngDest.Cells(1).Value = ...</code> do <code>RngDest.Cells(1,1).Value = ...</code> and so on. Then I think it will work."}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492631726, "post_id": 43504152, "comment_id": 74064448, "body": "yeah I fixed that, but there are no results being copied to the other workbook even by stepping through the code I can it is looping through each worksheet."}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492631765, "post_id": 43504152, "comment_id": 74064466, "body": "oh ok I will try that. Thank you for all your assistance and the guide was really helpful"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492631770, "post_id": 43504152, "comment_id": 74064470, "body": "You may also need to move the <code>RngDest</code> reassignment above a few lines, you need to redefined that range for each worksheet but you&#39;re not redefining it until you close each workbook. So the values keep getting overwritten. See revision."}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492632184, "post_id": 43504152, "comment_id": 74064711, "body": "It works! thank you very much I just need to work on excluding some worksheets from being copied and I&#39;m in the money. I should be able to get that on my own. So how do I vote or close this question."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492632407, "post_id": 43504152, "comment_id": 74064844, "body": "At the top/left of my answer, I think you&#39;ll be able to mark it as accepted in this space: <a href=\"http://imgur.com/Mn4QC1M\" rel=\"nofollow noreferrer\">imgur.com/Mn4QC1M</a>"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1492631789, "last_edit_date": 1492631789, "creation_date": 1492628978, "answer_id": 43504152, "question_id": 43503522, "link": "https://stackoverflow.com/questions/43503522/looping-through-excel-worksheets-in-mulitple-workbooks-in-the-same-directory-wh/43504152#43504152", "title": "Looping through excel worksheets, in mulitple workbooks in the same directory while copying data into a new workbook", "body": "<p>The construct you need is:</p>\n\n<pre><code>Do While Fname &lt;&gt; \"\" And Fname &lt;&gt; ThisWorkbook.Name\n    Set wkbkorigin = Workbooks.Open(ThisWorkbook.Path &amp; \"/\" &amp; Fname)\n    For Each ws in wkbkorigin.Worksheets '### YOU NEED TO ITERATE OVER SHEETS IN THE WORKBOOK THAT YOU JUST OPENED ON THE PRECEDING LINE\n        With ws\n            ' Do something with the ws Worksheet, like take the values from D3 and E9 and put them in your RngDest range:\n             RngDest.Cells(1,1).Value = .Range(\"D3\").Value\n             RngDest.Cells(1,2).Value = .Range(\"E9\").Value\n        End With\n        Set RngDest = RngDest.Offset(1, 0) '## Offset this range for each sheet so that each sheet goes in a new row\n    Next\n    wkbkorigin.Close SaveChanges:=False   'close current file\n    Fname = Dir()     'get next file\nLoop\n</code></pre>\n\n<p>Also, and this is a tangent but I'll drop it here just to illustrate some possible point of confusion -- have a look at the several ways of iterating/looping in VBA:</p>\n\n<pre><code>Sub testing()\nDim i As Long\ni = 0\n\n'## do Loop can have a condition as part of the Loop\nDo\n    Call printVal(i)\nLoop While i &lt; 10\n\n'## Or as part of the Do\nDo While i &lt; 20\n    Call printVal(i)\nLoop\n\n'## You can use Do Until (or Do While) as above\nDo Until i &gt;= 30\n    Call printVal(i)\nLoop\n\n'## Likewise, Loop Until (or Loop While)\nDo\n    Call printVal(i)\nLoop Until i &gt;= 40\n\n'## You don't even need to include a CONDITION if you Exit Do from within the loop!\nDo\n    Call printVal(i)\n    If i &gt;= 50 Then Exit Do\nLoop\n\n'## Or you can use While/Wend\nWhile i &lt; 60\n    Call printVal(i)\nWend\n\n'## For/Next may also be appropriate:\nFor i = 60 To 70\n    Call printVal(i)\nNext\n\n\nEnd Sub\nSub printVal(ByRef i As Long)\n    i = i + 1\n    Debug.Print i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 43504152, "answer_count": 1, "score": 1, "last_activity_date": 1492631789, "creation_date": 1492626733, "last_edit_date": 1492629647, "question_id": 43503522, "link": "https://stackoverflow.com/questions/43503522/looping-through-excel-worksheets-in-mulitple-workbooks-in-the-same-directory-wh", "title": "Looping through excel worksheets, in mulitple workbooks in the same directory while copying data into a new workbook", "body": "<p>So I have been working for a couple hours on how to get this existing code to function the way I want it to. This code by itself would loop through workbooks in a directory and copy data from specific cells on the first sheet to a new workbook. I would like to have it do that, but also go through each worksheet in each workbook to get the required data. I would post all the versions of my data that I have tried but, I'm sure that will get me banned as well. So I will post my most recent:</p>\n\n<p>Sub GatherData()</p>\n\n<p>Dim wkbkorigin As Workbook\nDim originsheet As Worksheet\nDim destsheet As Worksheet\nDim ResultRow As Long\nDim Fname As String\nDim RngDest As Range\nDim ws As Worksheet</p>\n\n<pre><code>Set destsheet = ThisWorkbook.Worksheets(\"Sheet1\")\nSet RngDest = destsheet.Cells(Rows.Count, 1).End(xlUp) _\n                   .Offset(1, 0).EntireRow\nFname = Dir(ThisWorkbook.Path &amp; \"/*.xlsm\")\n\n'loop through each file in folder (excluding this one)\nDo While Fname &lt;&gt; \"\" And Fname &lt;&gt; ThisWorkbook.Name\n\n\n\n        Set wkbkorigin = Workbooks.Open(ThisWorkbook.Path &amp; \"/\" &amp; Fname)\n        'Set originsheet = wkbkorigin.Worksheets(\"1st\")\n        For Each ws In wkbkorigin\n        With ws\n            RngDest.Cells(1).Value = .Range(\"D3\").Value\n            RngDest.Cells(2).Value = .Range(\"E9\").Value\n            '.Cells(3).Value = originsheet.Range(\"D22\").Value\n            '.Cells(4).Value = originsheet.Range(\"E11\").Value\n            '.Cells(5).Value = originsheet.Range(\"F27\").Value\n        End With\n        Next\n        wkbkorigin.Close SaveChanges:=False   'close current file\n        Set RngDest = RngDest.Offset(1, 0)\n        Fname = Dir()     'get next file\nLoop\n</code></pre>\n\n<p>End Sub</p>\n\n<p>So This current version gives me the error \"Runtime Error 1004, Application defined or Object defined error. </p>\n\n<p>Previous versions of the code I have tried have done the following:\n-did not copy any data at all (using a \"For each ws\" statement)\n-Error \"Loop without Do\" (using a for statement with counter)\n-General compilations errors.</p>\n\n<p>I realize this question in part has been asked before, but I believe the question to be unique because, I have not seen a question that asks to loop each worksheet in  each workbook in a directory. I have done some research and all that seems to come up for me is looping worksheets in a single workbook. </p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Thank you </p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1492626758, "post_id": 43503219, "comment_id": 74061452, "body": "Are you sure that your range exactly matches the area you want to filter?"}, {"owner": {"reputation": 11, "user_id": 7881221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52457a62ab45e250a47ce47693efb69a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Smithey", "link": "https://stackoverflow.com/users/7881221/r-smithey"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1492628108, "post_id": 43503219, "comment_id": 74062259, "body": "I have date in range A6 to G6 and then the column &quot;K&quot; which should be the column the .Autofilter 11 refers to in the first with bloc and column  &quot;N&quot; for .AutoFilter 14."}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1492629197, "post_id": 43503219, "comment_id": 74062876, "body": "try only this line (sub or immediate window) and tell us what happens (and if auto filler is enabled in your sheet): <code>ActiveWorkbook.Sheets(&quot;Inquiries&quot;).Range(&quot;A6:K1200&quot;).AutoFil&zwnj;&#8203;ter</code>"}, {"owner": {"reputation": 11, "user_id": 7881221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52457a62ab45e250a47ce47693efb69a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Smithey", "link": "https://stackoverflow.com/users/7881221/r-smithey"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1492630596, "post_id": 43503219, "comment_id": 74063715, "body": "I have turned off auto filler in the options menu and removed all filters on all 3 sheets. I added in the above code right below Sub TransferTest1 (). The same Run Time Error popped up and then highlights the line of code you wrote above yellow as the error."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7881221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52457a62ab45e250a47ce47693efb69a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Smithey", "link": "https://stackoverflow.com/users/7881221/r-smithey"}, "edited": false, "score": 0, "creation_date": 1492628367, "post_id": 43503365, "comment_id": 74062403, "body": "Would this line of code go on the line above each .AutoFilter command? SO in this case, it would be in my macro 4 times?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1492626170, "creation_date": 1492626170, "answer_id": 43503365, "question_id": 43503219, "link": "https://stackoverflow.com/questions/43503219/run-time-error-1004-autofilter-method-of-range-class-failed/43503365#43503365", "title": "Run-Time error &#39;1004 - AutoFilter method of Range class failed", "body": "<p>Precede each call to <code>.AutoFilter</code> with,</p>\n\n<pre><code>if .parent.autofiltermode then .parent.autofiltermode = false\n</code></pre>\n\n<p>This will turn off any pre-existing .AutoFilters if they exist and do nothing if they do not exist.</p>\n"}], "owner": {"reputation": 11, "user_id": 7881221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52457a62ab45e250a47ce47693efb69a?s=128&d=identicon&r=PG&f=1", "display_name": "R.Smithey", "link": "https://stackoverflow.com/users/7881221/r-smithey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3075, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492626170, "creation_date": 1492625650, "last_edit_date": 1531164843, "question_id": 43503219, "link": "https://stackoverflow.com/questions/43503219/run-time-error-1004-autofilter-method-of-range-class-failed", "title": "Run-Time error &#39;1004 - AutoFilter method of Range class failed", "body": "<p>I am getting the above error when running the below code. I am very new to VBA and need some assistance in debugging. </p>\n\n<pre><code>Sub TransferTest1()\n\nDim INQUIRE As Worksheet\nDim QUOTE As Worksheet\nDim ORDER As Worksheet\nDim YString As String\nDim RecString As String\n\nSet INQUIRE = ActiveWorkbook.Sheets(\"Inquiries\")\nSet QUOTE = ActiveWorkbook.Sheets(\"Quotes\")\nSet ORDER = ActiveWorkbook.Sheets(\"Orders\")\n\nWith INQUIRE.Range(\"A6:K1200\")\n    .AutoFilter 11, \"Y\"\n    .Offset(1).Resize(, 7).Copy QUOTE.Range(\"A6\")  ' columns A:G\n    .AutoFilter\nEnd With\n\nWith QUOTE.Range(\"A6:N1200\")\n    .AutoFilter 14, \"Rec'vd\"\n    .Offset(1).Resize(, 7).Copy ORDER.Range(\"A6\") ' columns A:G\n    .Offset(1).Resize(, 2).Offset(11).Copy ORDER.Range(\"K6\")  ' columns L:M\n    .AutoFilter\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Thank you for the help in advance!</p>\n\n<p>R. Smithey</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1492624265, "post_id": 43502626, "comment_id": 74059950, "body": "Anyway, you have way to many <code>Select</code> and <code>ActiveSheet</code> in your code. If you tell us what you are trying to achieve, maybe we can offer a better solution"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1492625628, "post_id": 43503024, "comment_id": 74060780, "body": "I was thinking about .CurrentRegion but I decided that the OP most likely has data in A1 and A2 that would muck it up."}, {"owner": {"reputation": 183, "user_id": 7891362, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/406eb7612f7ab62216b7db4691b0f350?s=128&d=identicon&r=PG&f=1", "display_name": "GalacticPonderer", "link": "https://stackoverflow.com/users/7891362/galacticponderer"}, "edited": false, "score": 0, "creation_date": 1492668453, "post_id": 43503024, "comment_id": 74076741, "body": "tigeravatar, thank you. Jeeped was correct however, and I&#39;m am trying to parse information out of a CSV with irritating headers. You answer was really appreciated though!"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 2, "last_activity_date": 1492624947, "creation_date": 1492624947, "answer_id": 43503024, "question_id": 43502626, "link": "https://stackoverflow.com/questions/43502626/vba-range-1004-error/43503024#43503024", "title": "VBA Range 1004 error", "body": "<p>Give this version of your code a try:</p>\n\n<pre><code>Sub CSVParser()\n\n    Dim wb As Workbook\n    Dim wsCSV As Worksheet\n    Dim wsWork As Worksheet\n\n    Set wb = ActiveWorkbook\n    Set wsCSV = wb.Sheets(\"CSV Paste\")\n    Set wsWork = wb.Sheets(\"Working Sheet 1\")\n\n    wsCSV.Range(\"A3\").CurrentRegion.Copy wsWork.Cells(wsWork.Cells.Count, \"A\").End(xlUp).Offset(1)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 7891362, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/406eb7612f7ab62216b7db4691b0f350?s=128&d=identicon&r=PG&f=1", "display_name": "GalacticPonderer", "link": "https://stackoverflow.com/users/7891362/galacticponderer"}, "edited": false, "score": 0, "creation_date": 1492691128, "post_id": 43503051, "comment_id": 74092034, "body": "Perfect, thank you. This solved several problems I had that I didn&#39;t even realise I had :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1492625060, "creation_date": 1492625060, "answer_id": 43503051, "question_id": 43502626, "link": "https://stackoverflow.com/questions/43502626/vba-range-1004-error/43503051#43503051", "title": "VBA Range 1004 error", "body": "<p>I think this is what you are trying to achieve (without all the unnecessary <code>Select</code>):</p>\n\n<pre><code>Option Explicit\n\nSub CSVParser()\n\nDim i As Long\nDim x As Long\nDim LastRow As Long\nDim PasteRow As Long\n\nWith Sheets(\"CSV Paste\")\n    LastRow = .Range(\"A3\").End(xlDown).Row\n    For i = 3 To LastRow\n        PasteRow = Sheets(\"Working Sheet 1\").Cells(Sheets(\"Working Sheet 1\").Rows.Count, \"A\").End(xlUp).Row\n        .Range(.Range(\"A\" &amp; i), .Range(\"A\" &amp; i).End(xlToRight)).Copy Destination:=Sheets(\"Working Sheet 1\").Range(\"A\" &amp; PasteRow + 1)\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 183, "user_id": 7891362, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/406eb7612f7ab62216b7db4691b0f350?s=128&d=identicon&r=PG&f=1", "display_name": "GalacticPonderer", "link": "https://stackoverflow.com/users/7891362/galacticponderer"}, "edited": false, "score": 0, "creation_date": 1492668257, "post_id": 43503106, "comment_id": 74076648, "body": "Thank you very much, problem solved. I had read .Select was bad, but didn&#39;t know another solution. The pointer was very useful!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1492625250, "last_edit_date": 1495540932, "creation_date": 1492625250, "answer_id": 43503106, "question_id": 43502626, "link": "https://stackoverflow.com/questions/43502626/vba-range-1004-error/43503106#43503106", "title": "VBA Range 1004 error", "body": "<p>Using .Select and .Activate is not considered 'best practice'. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/28700020#28700020\">How to avoid using Select in Excel VBA macros</a>. Yes, using the code from the macro recorder is a good place to start but you have to get away from the practice at some point.</p>\n\n<p>Performing bulk operations is preferred to looping through an indeterminate number of rows or columns.</p>\n\n<pre><code>Option Explicit\n\nSub CSVParser()\n\n    Dim lastCol As Long\n\n    With Worksheets(\"CSV Paste\")\n        With .Range(.Cells(3, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp))\n            lastCol = .CurrentRegion.Columns.Count\n            With .Resize(.Rows.Count, lastCol)\n                .Copy Destination:=Sheets(\"Working Sheet 1\").Range(\"A1\")\n            End With\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 7891362, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/406eb7612f7ab62216b7db4691b0f350?s=128&d=identicon&r=PG&f=1", "display_name": "GalacticPonderer", "link": "https://stackoverflow.com/users/7891362/galacticponderer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 929, "favorite_count": 0, "accepted_answer_id": 43503051, "answer_count": 3, "score": 1, "last_activity_date": 1492625250, "creation_date": 1492623692, "last_edit_date": 1492624136, "question_id": 43502626, "link": "https://stackoverflow.com/questions/43502626/vba-range-1004-error", "title": "VBA Range 1004 error", "body": "<p>I am using the following code:</p>\n\n<pre><code>Sub CSVParser()\n\nDim i As Integer\nDim x As Integer\nDim values As Range\n\nSheets(\"CSV Paste\").Select    \nRange(\"A3\").Select\n\nFor i = 1 To Range(\"A3\", Range(\"A3\").End(xlDown)).Rows.Count        \n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n\n    Sheets(\"Working Sheet 1\").Select\n    Range(\"A1\").Select 'problem code\n\n    Do Until ActiveCell.Value = \"\"\n        If ActiveCell.Value = \"\" Then\n            Exit Do\n        Else\n            ActiveCell.Offset(1, 0).Select\n        End If\n    Loop\n\n    ActiveSheet.Paste\n    Sheets(\"CSV Paste\").Select                               \n    ActiveCell.Offset(1, 0).Select                \nNext\n\nEnd Sub\n</code></pre>\n\n<p>However, the line <code>Range(\"A1\").Select</code> just after <code>Sheets(\"Working Sheet 1\").Select</code> is kicking up a run-time error '1004'</p>\n\n<p>Does anyone know why? I have rearranged this in every way I can think of an have typed it out from scratch again.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1492622945, "post_id": 43502345, "comment_id": 74059127, "body": "Does this have to be VBA? It looks like this could be done with a formula"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1492633289, "post_id": 43502345, "comment_id": 74065343, "body": "Are there no middle names in sheet2?  Are the first and last names in sheet2 separated by a single space? Are the last/first names on sheet1 separated only by slash and not space(s)?"}, {"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1492715214, "post_id": 43502345, "comment_id": 74108882, "body": "@tigeravatar Yes, that is ture, however, initially, the information is split between sperate workbooks hence the variance in the names and the order they are being provided. A little down the road I intend to modify the script to extract and import data from those sheets."}, {"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1492715293, "post_id": 43502345, "comment_id": 74108927, "body": "@JohnMuggins Sheet2 does not have middle names and are separated by a single space. Sheet1 has a &quot;/&quot; and no spaces."}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1492781071, "post_id": 43505699, "comment_id": 74139667, "body": "I am struggling with getting this macro running. Initially I tried adapting it to     Sub CommandButton1_Click()    but it didnt like that. So i tried to attach it to a module and call the module through a click of a button. Nothing happened... and the same goes if I try and squeeze it into a worksheet change."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1493048121, "post_id": 43505699, "comment_id": 74234144, "body": "The important thing is the logic.  Do you see the logic with the &quot;Split&quot; function?  Sheet1 is initially split by the &quot;/&quot; forward slash character into a variable called   arraySheet1_a.  This gives you an array.  arraySheet1_a(0) = &quot;Miller&quot; and arraySheet1_a(1) = &quot;John Brent&quot;.  So now we split arraySheet1_a(1) into another array,   arraySheet1_b, where arraySheet1_b(0) = &quot;John&quot; and arraySheet1_b(1) = &quot;Brent&quot;.  So now you can search your other sheet for .find(what:=arraySheet1_b(0) &amp; &quot; &quot; &amp; arraySheet1_a(0)) ----- which equals &quot;John Miller&quot;.  Don&#39;t forget the space between the two names."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1492634590, "creation_date": 1492634590, "answer_id": 43505699, "question_id": 43502345, "link": "https://stackoverflow.com/questions/43502345/find-id-on-separate-sheet-using-part-of-data-in-a-cell/43505699#43505699", "title": "Find ID on separate sheet using part of data in a cell", "body": "<p>if your sheet 1 looks like this:</p>\n\n<pre><code>Miller/John Brent\nAcme/Joan Alice\nJones/Beatrice Sally\n</code></pre>\n\n<p>And your sheet 2 looks like this</p>\n\n<pre><code>ID 101  John Miller\nID 102  Joan Acme\nID 103  Beatrice Jones\n</code></pre>\n\n<p>Then the following code can help you learn the split function.  Once you learn how to get the first and last name from sheet 1 you will be able to search for it on sheet2 and get the corresponding ID number</p>\n\n<pre><code>Sub getID()\n\nDim ws1 As Worksheet, ws2 As Worksheet\nDim arraySheet2, arraySheet1_a, arraySheet1_b\n\nSet ws1 = Worksheets(\"Sheet1\")\nSet ws2 = Worksheets(\"Sheet2\")\n\nFor i = 1 To 3\n    arraySheet1_a = Split(ws1.Range(\"A\" &amp; i).Value, \"/\")\n    arraySheet1_b = Split(arraySheet1_a(1), \" \")\nDebug.Print arraySheet1_b(0) &amp; \" \" &amp; arraySheet1_a(0)\nNext i\n\nDebug.Print \"   \"\n\n\nFor i = 1 To 3\n    arraySheet2 = Split(ws2.Range(\"B\" &amp; i).Value, \" \")\nDebug.Print arraySheet2(0) &amp; \" \" &amp; arraySheet2(1)\nNext i\n\nSet ws1 = Nothing\nSet ws2 = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492634590, "creation_date": 1492622789, "last_edit_date": 1531161705, "question_id": 43502345, "link": "https://stackoverflow.com/questions/43502345/find-id-on-separate-sheet-using-part-of-data-in-a-cell", "title": "Find ID on separate sheet using part of data in a cell", "body": "<p>Sheet1</p>\n\n<pre><code>|Header1|Header3|\n|L/F M  |Blank  |\n|L/F M  |Blank  |\n|L/F M  |Blank  |\n|L/F M  |Blank  |\n|L/F M  |Blank  |\n|L/F M  |Blank  |\n</code></pre>\n\n<p>Sheet2</p>\n\n<pre><code>|Header1|Header2|\n|ID     |F L    |\n|ID     |F L    |\n|ID     |F L    |\n|ID     |F L    |\n|ID     |F L    |\n|ID     |F L    |\n\nF = First Name\nM = Middle Name\nL = Last Name\n</code></pre>\n\n<p>The objective is to run a script that will take either the first name or last name from sheet1 and compare with the coresponding names in sheet2. When a match is found, it will place the ID value in the blank cell next to it. </p>\n\n<pre><code>Option Explicit\n\nDim fName As Range\n\nSub Worksheet_SelectionChange(ByVal Target As Range)\n\n    With Worksheets(\"Sheet2\").Range(\"I:I\")\n         Set fName = .Find(what:=Left(Target, InStr(Target, \"/\")), LookAt:=xlPart)\n    End With\n\n    If Not Intersect(Target, Range(\"E:E\")) Is Nothing Then\n        Application.EnableEvents = False\n        With Intersect(Target, Range(\"E:E\"))\n            .Offset(, -7).Value = fName.Value\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I have been trying to adjust this code to no success.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "edited": false, "score": 0, "creation_date": 1492624120, "post_id": 43502689, "comment_id": 74059855, "body": "this is awesome! exactly what i was looking for. any reason why the column headers didn&#39;t make it to the new sheet?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "edited": false, "score": 1, "creation_date": 1492624227, "post_id": 43502689, "comment_id": 74059923, "body": "The column headers weren&#39;t identified to be a part of <code>rCopy</code>.  You&#39;d need to put a line before the loop adding the header row to <code>rCopy</code>"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1492623918, "creation_date": 1492623918, "answer_id": 43502689, "question_id": 43502293, "link": "https://stackoverflow.com/questions/43502293/how-to-export-identified-values-to-a-new-sheet/43502689#43502689", "title": "How to export identified values to a new sheet?", "body": "<p>Updated your code to show how to export the found rows to a new sheet:</p>\n\n<pre><code>Sub Export()\n\nDim lastRowcheck As Long, n1  As Long\nDim rCopy As Range\n\nWith Worksheets(\"Sheet1\")\n    lastRowcheck = Application.Max(.Range(\"B\" &amp; .Rows.Count).End(xlUp).Row, _\n                                   .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row)\n\n    For n1 = lastRowcheck To 1 Step -1\n        If Application.CountIfs(.Columns(\"B\"), .Cells(n1, \"B\").Value2, .Columns(\"C\"), .Cells(n1, \"C\").Value2) &gt; 1 Then\n           Debug.Print .Cells(n1, \"A\") &amp; \":\" &amp; .Cells(n1, \"B\") &amp; \":\" &amp; .Cells(n1, \"C\")\n           '''export to new sheet\n           If rCopy Is Nothing Then Set rCopy = .Rows(n1) Else Set rCopy = Union(rCopy, .Rows(n1))\n        End If\n    Next n1\nEnd With\n\n\nWith Sheets(\"Sheet2\")                            'For using a sheet that already exists\n'With Sheets.Add(After:=Sheets(Sheets.Count))    'For creating a brand new sheet to use\n    If Not rCopy Is Nothing Then rCopy.EntireRow.Copy _\n        Destination:=.Cells(.Rows.Count, \"A\").End(xlUp).Offset(1)\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 243, "user_id": 6456800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7d9c1c5f3fb0426747663d2c944482?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6456800/unknown"}, "is_accepted": false, "score": 1, "last_activity_date": 1492624647, "creation_date": 1492624647, "answer_id": 43502923, "question_id": 43502293, "link": "https://stackoverflow.com/questions/43502293/how-to-export-identified-values-to-a-new-sheet/43502923#43502923", "title": "How to export identified values to a new sheet?", "body": "<p>Why you are using loop in descending order</p>\n\n<pre><code>For n1 = lastRowcheck To 1 Step -1\n\nFor n1 = 1 To lastRowcheck\n</code></pre>\n\n<p>while you can use it if you need result in same order as per data.</p>\n\n<pre><code>Sub Export()\nDim lastRowcheck As Long, n1  As Long, i As Long\nDim ws As Worksheet\nSet ws = Sheets(\"NewSheet\") 'sheet name to export data\ni = 2 'add data from row 2 in new sheet\nWith Worksheets(\"Sheet1\")\nlastRowcheck = Application.Max(.Range(\"B\" &amp; .Rows.Count).End(xlUp).Row, _\n                               .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row)\nFor n1 = 1 To lastRowcheck\n    If Application.CountIfs(.Columns(\"B\"), .Cells(n1, \"B\").Value2, .Columns(\"C\"), .Cells(n1, \"C\").Value2) &gt; 1 Then\n       Debug.Print .Cells(n1, \"A\") &amp; \":\" &amp; .Cells(n1, \"B\") &amp; \":\" &amp; .Cells(n1, \"C\")\n       '''export to new sheet\n       ws.Cells(i, \"A\") = .Cells(n1, \"A\")\n       ws.Cells(i, \"B\") = .Cells(n1, \"B\")\n       ws.Cells(i, \"C\") = .Cells(n1, \"C\")\n       i = i + 1\n    End If\nNext n1\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 43502689, "answer_count": 2, "score": 1, "last_activity_date": 1492624647, "creation_date": 1492622633, "last_edit_date": 1495540018, "question_id": 43502293, "link": "https://stackoverflow.com/questions/43502293/how-to-export-identified-values-to-a-new-sheet", "title": "How to export identified values to a new sheet?", "body": "<p>This is a follow up to my previous question that can be found <a href=\"https://stackoverflow.com/questions/43500990/how-to-identify-rows-that-have-the-same-value-in-two-columns\">here</a></p>\n\n<p>Just for a quick recap, I have this table:</p>\n\n<pre><code>ID  Age Grade\n1   14  90\n2   15  78\n3   14  90\n4   16  86\n5   16  86\n6   15  89\n7   14  88\n</code></pre>\n\n<p>My desired output table in a new sheet is:</p>\n\n<pre><code>ID  Age Grade\n1   14  90\n3   14  90\n4   16  86\n5   16  86\n</code></pre>\n\n<p>I went through and picked out the rows that have repeating values in column B <strong><em>AND</em></strong> column C using this:</p>\n\n<pre><code>Sub Export()\n\nDim lastRowcheck As Long, n1  As Long\n\nWith Worksheets(\"Sheet1\")\n    lastRowcheck = Application.Max(.Range(\"B\" &amp; .Rows.Count).End(xlUp).Row, _\n                                   .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row)\n\n    For n1 = lastRowcheck To 1 Step -1\n        If Application.CountIfs(.Columns(\"B\"), .Cells(n1, \"B\").Value2, .Columns(\"C\"), .Cells(n1, \"C\").Value2) &gt; 1 Then\n           Debug.Print .Cells(n1, \"A\") &amp; \":\" &amp; .Cells(n1, \"B\") &amp; \":\" &amp; .Cells(n1, \"C\")\n           '''export to new sheet\n        End If\n    Next n1\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Now I just need to figure out how to export those rows into a new sheet and I have no idea where to start.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492624158, "post_id": 43501935, "comment_id": 74059878, "body": "re: &#39;<i>I have a column of telephone numbers</i>&#39; - Your image (recently added through an edit) shows 5 columns of telephone numbers."}, {"owner": {"reputation": 3, "user_id": 7891196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1326704384087873/picture?type=large", "display_name": "An Gr", "link": "https://stackoverflow.com/users/7891196/an-gr"}, "edited": false, "score": 0, "creation_date": 1492624341, "post_id": 43501935, "comment_id": 74059995, "body": "my Fault  can you help ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492624448, "post_id": 43501935, "comment_id": 74060053, "body": "Just as soon as I see the code that you tried yourself."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7891196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1326704384087873/picture?type=large", "display_name": "An Gr", "link": "https://stackoverflow.com/users/7891196/an-gr"}, "edited": false, "score": 0, "creation_date": 1492622042, "post_id": 43502034, "comment_id": 74058559, "body": "Im really new to this what is ( -- )?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 3, "user_id": 7891196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1326704384087873/picture?type=large", "display_name": "An Gr", "link": "https://stackoverflow.com/users/7891196/an-gr"}, "edited": false, "score": 0, "creation_date": 1492622157, "post_id": 43502034, "comment_id": 74058638, "body": "That is commonly known as a <a href=\"http://stackoverflow.com/questions/3286197/what-does-in-excel\">double unary</a>.  It can be read as &quot;minus negative&quot; if preferred.  Its purpose here is to convert strings into numbers (i.e. convert the string <code>&quot;2&quot;</code> into the number <code>2</code> in order to perform numerical comparisons)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3, "user_id": 7891196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1326704384087873/picture?type=large", "display_name": "An Gr", "link": "https://stackoverflow.com/users/7891196/an-gr"}, "edited": false, "score": 2, "creation_date": 1492622347, "post_id": 43502034, "comment_id": 74058773, "body": "@AnGr - Of course, googling <a href=\"https://www.google.ca/webhp?sourceid=chrome-instant&amp;rlz=1C1CHZL_enCA733CA733&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=what+is+--+in+excel\" rel=\"nofollow noreferrer\">what is -- in excel</a> could have told you that in less time than it took to type out your question let alone getting <a href=\"http://stackoverflow.com/users/2665425/tigeravatar\">tigeravatar</a> to answer."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 3, "last_activity_date": 1492621813, "creation_date": 1492621813, "answer_id": 43502034, "question_id": 43501935, "link": "https://stackoverflow.com/questions/43501935/adding-numbers-in-front-by-determining-first-number-excel/43502034#43502034", "title": "adding numbers in front by determining first number Excel", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>=--(IF(OR(--LEFT(A1,1)={3,5,7,9}),2,6)&amp;A1)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1492623924, "last_edit_date": 1492623924, "creation_date": 1492622219, "answer_id": 43502156, "question_id": 43501935, "link": "https://stackoverflow.com/questions/43501935/adding-numbers-in-front-by-determining-first-number-excel/43502156#43502156", "title": "adding numbers in front by determining first number Excel", "body": "<p>A Select Case statement makes an easy job of  multiple comparisons.</p>\n\n<pre><code>dim rw as long\nwith worksheets(\"sheet1\")\n    for rw = 2 to .cells(.rows.count, \"A\").end(xlup).row\n        select case int(left(.cells(rw, \"A\").value2, 1))\n            case 3, 5, 7, 9\n                .cells(rw, \"A\") = int(2 &amp; .cells(rw, \"A\").value2)\n            case else\n                .cells(rw, \"A\") = int(6 &amp; .cells(rw, \"A\").value2)\n        end select\n    next rw\n    .range(.cells(2, \"A\"), .cells(.rows.count, \"A\").end(xlup)).numberformat = \"0 000-0000\"\nend with\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7891196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1326704384087873/picture?type=large", "display_name": "An Gr", "link": "https://stackoverflow.com/users/7891196/an-gr"}, "edited": false, "score": 0, "creation_date": 1492623225, "post_id": 43502381, "comment_id": 74059250, "body": "I am using this with macro function"}, {"owner": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "reply_to_user": {"reputation": 3, "user_id": 7891196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1326704384087873/picture?type=large", "display_name": "An Gr", "link": "https://stackoverflow.com/users/7891196/an-gr"}, "edited": false, "score": 0, "creation_date": 1492623544, "post_id": 43502381, "comment_id": 74059470, "body": "I&#39;ve just submited another answer using VBA. Take a look!"}, {"owner": {"reputation": 3, "user_id": 7891196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1326704384087873/picture?type=large", "display_name": "An Gr", "link": "https://stackoverflow.com/users/7891196/an-gr"}, "edited": false, "score": 0, "creation_date": 1492624058, "post_id": 43502381, "comment_id": 74059806, "body": "can you take a look i added picture, its harder because its not a collum."}], "tags": [], "owner": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "is_accepted": true, "score": 0, "last_activity_date": 1492623475, "last_edit_date": 1492623475, "creation_date": 1492622863, "answer_id": 43502381, "question_id": 43501935, "link": "https://stackoverflow.com/questions/43501935/adding-numbers-in-front-by-determining-first-number-excel/43502381#43502381", "title": "adding numbers in front by determining first number Excel", "body": "<p>If you use a formula to recreate the list in a new column, use this:</p>\n\n<pre><code>=IF(OR(LEFT(A2)=\"3\",LEFT(A2)=\"5\",LEFT(A2)=\"7\",LEFT(A2)=\"9\"),2&amp;A2,6&amp;A2)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7891196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1326704384087873/picture?type=large", "display_name": "An Gr", "link": "https://stackoverflow.com/users/7891196/an-gr"}, "edited": false, "score": 0, "creation_date": 1492625206, "post_id": 43502503, "comment_id": 74060522, "body": "Can i adjust this Code with Pic I added ?"}], "tags": [], "owner": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "is_accepted": false, "score": 0, "last_activity_date": 1492623309, "creation_date": 1492623309, "answer_id": 43502503, "question_id": 43501935, "link": "https://stackoverflow.com/questions/43501935/adding-numbers-in-front-by-determining-first-number-excel/43502503#43502503", "title": "adding numbers in front by determining first number Excel", "body": "<p>If you want to do it via VBA, run the following sequence of code:</p>\n\n<pre><code>Sub AddNumber()\n\n    Dim i As Long, j As Long\n    Dim Strt As String\n        i = 2 'your first row index with data\n        j = 1 'the column index your list is located (e.g. column A)\n\n    Do While Cells(i, j) &lt;&gt; \"\"\n        Strt = Left(Cells(i, j), 1)\n        Select Case Strt\n        Case 3, 5, 7, 9\n            Cells(i, j) = 2 &amp; Cells(i, j)\n        Case Else\n            Cells(i, j) = 6 &amp; Cells(i, j)\n        End Select\n        i = i + 1\n        Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7891196, "user_type": "registered", "profile_image": "https://graph.facebook.com/1326704384087873/picture?type=large", "display_name": "An Gr", "link": "https://stackoverflow.com/users/7891196/an-gr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1492656897, "accepted_answer_id": 43502381, "answer_count": 4, "score": -2, "last_activity_date": 1492624252, "creation_date": 1492621507, "last_edit_date": 1492624252, "question_id": 43501935, "link": "https://stackoverflow.com/questions/43501935/adding-numbers-in-front-by-determining-first-number-excel", "closed_reason": "Needs more focus", "title": "adding numbers in front by determining first number Excel", "body": "<p>I want to add a new number in front of them, depending on the first number</p>\n\n<ul>\n<li>If first number is 3,5,7,9 then add in front 2</li>\n<li>Else add in front 6</li>\n</ul>\n\n<p>With Macro button\n<a href=\"https://i.stack.imgur.com/Hbod8.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 5, "creation_date": 1492621564, "post_id": 43501881, "comment_id": 74058261, "body": "The <code>InStr</code> method doesn&#39;t require the tilde <code>~</code>, so just remove that.  You only need the tilde if you&#39;re using the <code>Range.Find</code> method"}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 7237384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe7beeea585a2498de81036e5ec0934d?s=128&d=identicon&r=PG&f=1", "display_name": "aoswald", "link": "https://stackoverflow.com/users/7237384/aoswald"}, "is_accepted": false, "score": 1, "last_activity_date": 1492623228, "creation_date": 1492623228, "answer_id": 43502483, "question_id": 43501881, "link": "https://stackoverflow.com/questions/43501881/find-an-actual-in-excel-vba/43502483#43502483", "title": "Find an actual ? in excel vba", "body": "<p>I figured it out.  i added:</p>\n\n<pre><code>Dim SearchChar as String\nSearchChar = \"?\"\n</code></pre>\n\n<p>then replaced \"~?\" in the InStr line with SearchChar and it worked</p>\n"}], "owner": {"reputation": 75, "user_id": 7237384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fe7beeea585a2498de81036e5ec0934d?s=128&d=identicon&r=PG&f=1", "display_name": "aoswald", "link": "https://stackoverflow.com/users/7237384/aoswald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576918459, "creation_date": 1492621323, "last_edit_date": 1576918459, "question_id": 43501881, "link": "https://stackoverflow.com/questions/43501881/find-an-actual-in-excel-vba", "title": "Find an actual ? in excel vba", "body": "<p>I need to find an actual ? in a range of cells.  I am using this code:</p>\n\n<pre><code>    Dim rCell As Range\n    Dim rArea As Range\n\n' set range variable = Column in the active sheet.\n    Set rCell = Range(\"g1\")\n    Set rArea = Range(\"g2:g\" &amp; countusers)\n    For Each rCell In rArea\n    With rCell\n    Dim Qmark As Integer\n        If InStr(1, (rCell.Value), \"~?\") &gt; 0 Then\n       MsgBox \"Cell \" &amp; rCell.Address &amp; \"has a question mark in it\"\n        Qmark = Qmark + 1\n        End If\n</code></pre>\n\n<p>I put the ~ in front of the question mark but it's not working.\nthanks in advance</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492621499, "post_id": 43501750, "comment_id": 74058210, "body": "Change <code>originsheet.Range(&quot;D3&quot;).Value</code> to <code>ws.Range(&quot;D3&quot;).Value</code> and increment the destination (e.g. <code>.Cells(1).Value</code>)."}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492622093, "post_id": 43501750, "comment_id": 74058590, "body": "Jeeped, I guess Im missing something because it wont even compile now and  Can you direct to where this exact question is located at? So I don&#39;t waste anyone else time? Thank you"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492622394, "post_id": 43501750, "comment_id": 74058805, "body": "Click on the link provided in the top message."}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492622761, "post_id": 43501750, "comment_id": 74059026, "body": "I checked it out, mine compiles now but still only grabs data from the first worksheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492622917, "post_id": 43501750, "comment_id": 74059109, "body": "My crystal ball is in the shop and teleporting to where you are working is so expensive now-a-days. Why don&#39;t you edit your post (or better yet, ask a new question) with the updated code instead?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1492623069, "post_id": 43501750, "comment_id": 74059176, "body": "One point you seem to be missing is that the question of &#39;<i>how do I loop through each worksheet in a workbook</i>&#39; has been asked and answered literally hundreds of times. Do some research, write some code and if you run into problems, ask a new question with specific information and error codes. (see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>) Saying &#39;<i>it doesn&#39;t compile</i>&#39; or &#39;<i>it doesn&#39;t work</i>&#39; is a waste of everyone&#39;s time including your own."}, {"owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "edited": false, "score": 0, "creation_date": 1492623080, "post_id": 43501750, "comment_id": 74059181, "body": "Point taken Understood"}], "owner": {"reputation": 43, "user_id": 3776833, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1477177788/picture?type=large", "display_name": "Ashley", "link": "https://stackoverflow.com/users/3776833/ashley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "closed_date": 1492621690, "answer_count": 0, "score": 0, "last_activity_date": 1492620889, "creation_date": 1492620889, "question_id": 43501750, "link": "https://stackoverflow.com/questions/43501750/loop-through-excel-spreadsheets-in-different-workbooks", "closed_reason": "Duplicate", "title": "Loop through excel spreadsheets in different workbooks", "body": "<p>So one of you posted this code in a different question:\nDim wkbkorigin As Workbook\nDim originsheet As Worksheet\nDim destsheet As Worksheet\nDim ResultRow As Long\nDim Fname As String\nDim RngDest As Range\nDim ws As Worksheet</p>\n\n<pre><code>Set destsheet = ThisWorkbook.Worksheets(\"Sheet1\")\nSet RngDest = destsheet.Cells(Rows.Count, 1).End(xlUp) _\n                   .Offset(1, 0).EntireRow\nFname = Dir(ThisWorkbook.Path &amp; \"/*.xlsm\")\n\n'loop through each file in folder (excluding this one)\nDo While Fname &lt;&gt; \"\" And Fname &lt;&gt; ThisWorkbook.Name\n    Set wkbkorigin = Workbooks.Open(ThisWorkbook.Path &amp; \"/\" &amp; Fname)\n    Set originsheet = wkbkorigin.Worksheets(\"1st\")\n         For Each ws In ThisWorkbook.Worksheets\n        With RngDest\n\n            .Cells(1).Value = originsheet.Range(\"D3\").Value\n            .Cells(2).Value = originsheet.Range(\"E9\").Value\n            .Cells(3).Value = originsheet.Range(\"D22\").Value\n            '.Cells(4).Value = originsheet.Range(\"E11\").Value\n            '.Cells(5).Value = originsheet.Range(\"F27\").Value\n\n        End With\n        wkbkorigin.Close SaveChanges:=False   'close current file\n        Set RngDest = RngDest.Offset(1, 0)\n        Fname = Dir()     'get next file\nLoop\n</code></pre>\n\n<p>End Sub</p>\n\n<p>The problem is I can only get it look at the first sheet in every workbook and copy that data. I am trying to get it too look through every sheet in each workbook and copy data from the same cells. Is there anyway to do that. Thank you </p>\n"}, {"tags": ["vba", "visual-studio", "variables", "console", "storage"], "comments": [{"owner": {"reputation": 1415, "user_id": 3079834, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/l4Lgy.jpg?s=128&g=1", "display_name": "user3079834", "link": "https://stackoverflow.com/users/3079834/user3079834"}, "edited": false, "score": 0, "creation_date": 1492621056, "post_id": 43501621, "comment_id": 74057897, "body": "Have you tried anything yet? Or do you ask us to solve your coding tasks? Please provide some code."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7891035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4HTg.jpg?s=128&g=1", "display_name": "Kenneth", "link": "https://stackoverflow.com/users/7891035/kenneth"}, "edited": false, "score": 0, "creation_date": 1493183835, "post_id": 43501753, "comment_id": 74299751, "body": "I was able to complete the task."}, {"owner": {"reputation": 39, "user_id": 7891035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4HTg.jpg?s=128&g=1", "display_name": "Kenneth", "link": "https://stackoverflow.com/users/7891035/kenneth"}, "edited": false, "score": 1, "creation_date": 1493184432, "post_id": 43501753, "comment_id": 74300039, "body": "I created a registered accounts named &#39;admin&#39; (I was told I could do that) and gave the user the option to register their account. I was thinking of following a similar method to yours but the task was easier than I thought."}], "tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1492621608, "last_edit_date": 1492621608, "creation_date": 1492620907, "answer_id": 43501753, "question_id": 43501621, "link": "https://stackoverflow.com/questions/43501621/visual-basic-how-do-you-store-variables-after-closing-the-console/43501753#43501753", "title": "Visual Basic - How do you store variables after closing the console?", "body": "<p>I assume that \"coding task\" refers to some school related work, so you do not need to consider security questions.</p>\n\n<p>Just write the username ans passwort combination into a text file. Writing to and reading from a text file should be straight forward. A bit more sophisticated would be a database, sqlite is quite easy for this task.\nIf you get stuck at coding, just post your code here.</p>\n"}], "owner": {"reputation": 39, "user_id": 7891035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u4HTg.jpg?s=128&g=1", "display_name": "Kenneth", "link": "https://stackoverflow.com/users/7891035/kenneth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "accepted_answer_id": 43501753, "answer_count": 1, "score": 0, "last_activity_date": 1492621608, "creation_date": 1492620509, "question_id": 43501621, "link": "https://stackoverflow.com/questions/43501621/visual-basic-how-do-you-store-variables-after-closing-the-console", "title": "Visual Basic - How do you store variables after closing the console?", "body": "<p>I've been facing some problems in one of my coding tasks. The question asks me to \"store two usernames and passwords after closing the console. These accounts will represent two users that have already registered.\"</p>\n\n<p>I was told to create a simple registration system for a practice exam paper. I gave the user the option to register an account, however, (pre-made) registered accounts are not saved after console closure.</p>\n\n<p>Do anyone of you know how to store these variables? It would help me solve a few other problems regarding different tasks.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "date", "weekday"], "answers": [{"comments": [{"owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "edited": false, "score": 0, "creation_date": 1492621863, "post_id": 43501443, "comment_id": 74058451, "body": "If I run the linked answer for a Sunday, I get the Monday from 2 weeks prior.  Try <code>lastMonday(&quot;4&#47;16&#47;2017&quot;)</code> and you&#39;ll see what I mean."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 1, "last_activity_date": 1492623416, "last_edit_date": 1495541861, "creation_date": 1492619954, "answer_id": 43501443, "question_id": 43501280, "link": "https://stackoverflow.com/questions/43501280/get-dates-of-mon-fri-of-previous-week/43501443#43501443", "title": "Get dates of Mon-Fri of previous week", "body": "<h3>Updated</h3>\n\n<p>As the OP pointed out, the linked code doesn't work for this particular use case when the starting date is a Sunday.  Here's a fix:</p>\n\n<pre><code>Option Explicit   ' always always always use this\n\nPublic Function MondayLastWeek(pdat As Date) As Date\n    Dim weekday_increment As Long\n    weekday_increment = weekday(pdat, vbMonday) - 1\n    MondayLastWeek = DateAdd(\"ww\", IIf(weekday_increment = 6, 0, -1), pdat - weekday_increment)\n    ' IIf: if we're on Sunday, pdat-weekday_increment is already the date we want.\nEnd Function\n\nPublic Sub listPreviousWeekDays()\n    Dim monday As Date\n    monday = MondayLastWeek(Now)\n\n    Dim dayCtr As Long\n    For dayCtr = 0 To 4\n        Debug.Print monday + dayCtr\n    Next\nEnd Sub\n</code></pre>\n\n<h3>Original answer</h3>\n\n<p>This works for me:</p>\n\n<pre><code>Public Sub listPreviousWeekDays()\n\n    ' First, get last week's Monday just as in the linked question    \n    Dim LastMonday As Date\n    LastMonday = DateAdd(\"ww\", -1, Now - (Weekday(Now, vbMonday) - 1))\n\n    ' Then, loop over the rest of the week.\n    ' Monday + 0 days =&gt; Monday\n    ' Monday + 4 days =&gt; Friday\n    Dim dayCtr As Long\n    For dayCtr = 0 To 4\n        Debug.Print LastMonday + dayCtr\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>4/10/2017 12:38:17 PM \n4/11/2017 12:38:17 PM \n4/12/2017 12:38:17 PM \n4/13/2017 12:38:17 PM \n4/14/2017 12:38:17 PM \n</code></pre>\n\n<p>I think the issue is that the second parameter to <code>Weekday</code> doesn't specify which day you <em>want</em>.  Instead, it specifies which day of the week is <em>weekday number 1</em> (<a href=\"https://www.techonthenet.com/excel/formulas/weekday.php\" rel=\"nofollow noreferrer\">some documentation</a>).  Instead of messing with <code>Weekday</code>, just get the Monday using the <a href=\"https://stackoverflow.com/a/15116929/2877364\">linked answer</a>, then add days as necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 348, "user_id": 6268900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10204696681176720/picture?type=large", "display_name": "Praveen DA", "link": "https://stackoverflow.com/users/6268900/praveen-da"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1492620414, "post_id": 43501473, "comment_id": 74057451, "body": "Are you trying to get the output in Ascending order"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1492620502, "post_id": 43501473, "comment_id": 74057511, "body": "It appears that the OP&#39;s code, and your code, are returning Mon-Wed of last week, and Thu and Fri of <i>the week before that</i>.  I believe the OP is trying to get dates all in last week, not spread across two weeks."}, {"owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1492621559, "post_id": 43501473, "comment_id": 74058256, "body": "@cxw, that is correct.  I want to get the Mon-Fri dates from the previous week."}, {"owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "edited": false, "score": 0, "creation_date": 1492623120, "post_id": 43501473, "comment_id": 74059201, "body": "@PraveenRKaruppannan, this has the same problem as cxw&#39;s solution: if it is run on a Sunday, it gives the dates from 2 weeks ago instead of last week.  If you substitute <code>&quot;4&#47;16&#47;2017&quot;</code> for <code>Now</code> you can replicate this problem."}], "tags": [], "owner": {"reputation": 348, "user_id": 6268900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10204696681176720/picture?type=large", "display_name": "Praveen DA", "link": "https://stackoverflow.com/users/6268900/praveen-da"}, "is_accepted": false, "score": 1, "last_activity_date": 1492624747, "last_edit_date": 1492624747, "creation_date": 1492620044, "answer_id": 43501473, "question_id": 43501280, "link": "https://stackoverflow.com/questions/43501280/get-dates-of-mon-fri-of-previous-week/43501473#43501473", "title": "Get dates of Mon-Fri of previous week", "body": "<p>This should fix the issue.</p>\n\n<pre><code>Public Sub listPreviousWeekDays()\n\nDim dayCtr As Long\nFor dayCtr = 2 To 6\nDebug.Print DateAdd(\"ww\", -1, Now - (Weekday(Now, vbUseSystemDayOfWeek)) + dayCtr)\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "accepted_answer_id": 43501443, "answer_count": 2, "score": 1, "last_activity_date": 1492624747, "creation_date": 1492619361, "last_edit_date": 1495541379, "question_id": 43501280, "link": "https://stackoverflow.com/questions/43501280/get-dates-of-mon-fri-of-previous-week", "title": "Get dates of Mon-Fri of previous week", "body": "<p>I'm trying to implement <a href=\"https://stackoverflow.com/a/15116929/619177\">this SO answer</a> to get the dates for Monday-Friday of the previous week, testing with this:</p>\n\n<pre><code>Public Sub listPreviousWeekDays()\n\nDim dayCtr As Long\n\nFor dayCtr = 2 To 6\n    Debug.Print DateAdd(\"ww\", -1, Now - (Weekday(Now, dayCtr) - 1))\nNext\n\nEnd Sub\n</code></pre>\n\n<p>However, this gives:</p>\n\n<pre><code>4/10/2017 9:27:18 AM \n4/11/2017 9:27:18 AM \n4/12/2017 9:27:18 AM \n4/6/2017 9:27:18 AM \n4/7/2017 9:27:18 AM \n</code></pre>\n\n<p>My goal is for it to return:</p>\n\n<pre><code>4/10/2017 9:27:18 AM \n4/11/2017 9:27:18 AM \n4/12/2017 9:27:18 AM \n4/13/2017 9:27:18 AM \n4/14/2017 9:27:18 AM \n</code></pre>\n\n<p>EDIT: to avoid an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>, I'll explain what I'm trying to do: I want to run a macro that fills in a block of cells with the previous week's Mon-Fri dates.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 1, "creation_date": 1492622310, "post_id": 43501261, "comment_id": 74058748, "body": "I am guessing that there must be times when table <code>Submission_Key</code> doesn&#39;t exist, otherwise why would you have to keep adding the new field? What has changed? Are you running things in a different order?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7891005, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d4jY9gsDGL4/AAAAAAAAAAI/AAAAAAAAABI/wHo_0U5iAeQ/photo.jpg?sz=128", "display_name": "Mike Kushinsky", "link": "https://stackoverflow.com/users/7891005/mike-kushinsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1492721803, "creation_date": 1492721803, "answer_id": 43529766, "question_id": 43501261, "link": "https://stackoverflow.com/questions/43501261/error-3265-item-not-found-in-this-collection/43529766#43529766", "title": "Error 3265: Item not found in this collection&quot;", "body": "<p>Thanks Skippy. I'm actually thinking its a network issue. I ran the full program today and this module ran without errors. So when it can't \"find\" the table it's because of a network disruption. The can see the table in Access but the OLAP process cannot. This is one of those inaccurate errors that doesn't tell you the true cause.\nBe well!</p>\n"}], "owner": {"reputation": 1, "user_id": 7891005, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-d4jY9gsDGL4/AAAAAAAAAAI/AAAAAAAAABI/wHo_0U5iAeQ/photo.jpg?sz=128", "display_name": "Mike Kushinsky", "link": "https://stackoverflow.com/users/7891005/mike-kushinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594640078, "creation_date": 1492619305, "last_edit_date": 1594640078, "question_id": 43501261, "link": "https://stackoverflow.com/questions/43501261/error-3265-item-not-found-in-this-collection", "title": "Error 3265: Item not found in this collection&quot;", "body": "<blockquote>\n  <p>Error 3265: item not found in this collection</p>\n</blockquote>\n\n<p>It exists! I checked. This simple module has worked for two years. Now, suddenly it doesn't:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function AppendIndex()\n    Dim fld As DAO.Field\n    Set fld = DBEngine(0)(0).TableDefs(\"Submission_Key\").CreateField(\"Index\",dbLong)\n    fld.Attributes = dbAutoIncrField\n    DBEngine(0)(0).TableDefs(\"Submission_Key\").Fields.Append fld\n    Set fld = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "is_accepted": false, "score": 0, "last_activity_date": 1492627105, "creation_date": 1492627105, "answer_id": 43503639, "question_id": 43501221, "link": "https://stackoverflow.com/questions/43501221/select-combo-box-to-open-reports/43503639#43503639", "title": "Select Combo Box to Open Reports", "body": "<p>What are the values in your cmb_InventorySort combo box?   Better method than the case might be to use a lookup table to return the report name you want to open.</p>\n\n<p>i.e.\nReportList</p>\n\n<pre><code>ID  |  ReportName\nInv |  Inventory\nProvider ID | Inventory - Provider Number\n</code></pre>\n\n<p>Your combo box would use the above table as it's RowSource.</p>\n\n<p>Then after they've selected an item from the combobox (or after clicking a button) then you can lookup the report they've selected, and you won't need to hardcode the case statement.  i.e. you can change/add/remove report names from the table as you wish.</p>\n\n<pre><code>StrReport = dlookup(\"ReportName\",\"ReportList\", \"ID = '\" &amp; me!cmb_InventorySort &amp; \"'\"\n\ndocmd.openreport strReport, acViewPreview\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7871719, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/--yR4HF1JTzY/AAAAAAAAAAI/AAAAAAAAAzc/fAb4BjHh6vI/photo.jpg?sz=128", "display_name": "Amy C", "link": "https://stackoverflow.com/users/7871719/amy-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1492695519, "creation_date": 1492695519, "answer_id": 43521217, "question_id": 43501221, "link": "https://stackoverflow.com/questions/43501221/select-combo-box-to-open-reports/43521217#43521217", "title": "Select Combo Box to Open Reports", "body": "<p>Turns out the script was right.  I had to go back into the report and fix an error on the report layout.</p>\n"}], "owner": {"reputation": 1, "user_id": 7871719, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/--yR4HF1JTzY/AAAAAAAAAAI/AAAAAAAAAzc/fAb4BjHh6vI/photo.jpg?sz=128", "display_name": "Amy C", "link": "https://stackoverflow.com/users/7871719/amy-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594640091, "creation_date": 1492619191, "last_edit_date": 1594640091, "question_id": 43501221, "link": "https://stackoverflow.com/questions/43501221/select-combo-box-to-open-reports", "title": "Select Combo Box to Open Reports", "body": "<p>I can't get a select combo box to open reports upon the click of a button.  Here's what I have.  What do you suggest?  It's opening the report Inventory only when nothing is clicked but I can't get it to open the other reports.</p>\n\n<pre><code>Private Sub Run_Inventory_Report_Macro_Click()\nDim strSortBy As String\n\nstrSortBy = Nz(Me.cmb_InventorySort.Value, \"\")\n\nSelect Case strSortBy\nCase \"\"\n    DoCmd.OpenReport \"Inventory\", acViewPreview\nCase \"Provider ID\"\n    DoCmd.OpenReport \"Inventory-Provider Number\", acViewPreview\nCase \"Provider Last Name\"\n    DoCmd.OpenReport \"Inventory-Provider Last Name\", acViewPreview\nCase \"Inventory Type\"\n    DoCmd.OpenReport \"Inventory-Inventory Type\", acViewPreview\nCase \"Corporate Receipt Date\"\n    DoCmd.OpenReport \"Inventory-Corporate Receipt Date\", acViewPreview\nCase \"PODM Receipt Date\"\n    DoCmd.OpenReport \"Inventory-PODM Receipt Date\", acViewPreview\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vsto", "powerpoint"], "comments": [{"owner": {"reputation": 457, "user_id": 4515125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-rCNR0REYrms/AAAAAAAAAAI/AAAAAAAAABA/doHrukMdDwA/photo.jpg?sz=128", "display_name": "Christine Ross", "link": "https://stackoverflow.com/users/4515125/christine-ross"}, "edited": false, "score": 0, "creation_date": 1492623695, "post_id": 43501202, "comment_id": 74059565, "body": "I don&#39;t really understand your problem: The way to move or copy a shape from one slide to an other slide is to copy it, paste it and delete the old if wanted . What means you modify the content of the clipboard? When you want to be successful you have keep the clipboard as it is."}, {"owner": {"reputation": 28480, "user_id": 1137199, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/41GR5.png?s=128&g=1", "display_name": "dotNET", "link": "https://stackoverflow.com/users/1137199/dotnet"}, "reply_to_user": {"reputation": 457, "user_id": 4515125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-rCNR0REYrms/AAAAAAAAAAI/AAAAAAAAABA/doHrukMdDwA/photo.jpg?sz=128", "display_name": "Christine Ross", "link": "https://stackoverflow.com/users/4515125/christine-ross"}, "edited": false, "score": 0, "creation_date": 1492662544, "post_id": 43501202, "comment_id": 74074601, "body": "@ChristineRoss: See my edit."}, {"owner": {"reputation": 457, "user_id": 4515125, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh3.googleusercontent.com/-rCNR0REYrms/AAAAAAAAAAI/AAAAAAAAABA/doHrukMdDwA/photo.jpg?sz=128", "display_name": "Christine Ross", "link": "https://stackoverflow.com/users/4515125/christine-ross"}, "edited": false, "score": 0, "creation_date": 1492681911, "post_id": 43501202, "comment_id": 74085217, "body": "my answer remains copy and paste. You don&#39;t need your mysterious function getshape, because all kind of shape have a method for creation (shapes, charts,..). See <a href=\"https://msdn.microsoft.com/en-us/library/ff744177.aspx\" rel=\"nofollow noreferrer\">here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 28480, "user_id": 1137199, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/41GR5.png?s=128&g=1", "display_name": "dotNET", "link": "https://stackoverflow.com/users/1137199/dotnet"}, "edited": false, "score": 0, "creation_date": 1494043828, "post_id": 43813481, "comment_id": 74672216, "body": "Yep. This was my conclusion too."}], "tags": [], "owner": {"reputation": 3171, "user_id": 196852, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/33fdb4f51213d3eccb426cf4a4427d85?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/196852/chris"}, "is_accepted": true, "score": 0, "last_activity_date": 1494017058, "creation_date": 1494017058, "answer_id": 43813481, "question_id": 43501202, "link": "https://stackoverflow.com/questions/43501202/how-to-add-a-shape-object-to-shapes-collection/43813481#43813481", "title": "How to add a Shape object to Shapes collection", "body": "<p>Shape collections are read-only. That is because they contain only the shapes specific to a range. In Word, that range can be a paragraph, a section, a header, a group shape, the entire document, etc. In PowerPoint, I assume you can get a list of shapes from a slide, all slides, and maybe a group shape.</p>\n\n<p>You can't add directly to a shapes collection because you would have have to specify where that shape is supposed to go. The methods for doing that with new shapes already exists. Such a method does not exist for moving or copying shapes.</p>\n\n<p>It would be nice if there was a method to move a shape to a different location without using copy/paste, but someone at Microsoft must have decided that it wasn't worth doing.</p>\n"}], "owner": {"reputation": 28480, "user_id": 1137199, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/41GR5.png?s=128&g=1", "display_name": "dotNET", "link": "https://stackoverflow.com/users/1137199/dotnet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "accepted_answer_id": 43813481, "answer_count": 1, "score": 1, "last_activity_date": 1494017058, "creation_date": 1492619135, "last_edit_date": 1492662536, "question_id": 43501202, "link": "https://stackoverflow.com/questions/43501202/how-to-add-a-shape-object-to-shapes-collection", "title": "How to add a Shape object to Shapes collection", "body": "<p>This may seem trivial but I haven't been able to find a way. How do PowerPoint Object Model allow you to add a <code>Shape</code> object to a slide's <code>Shapes</code> collection? I can add new shapes using functions like <code>Shapes.AddSmartArt()</code>, <code>Shapes.AddPicture()</code> etc, but those will add <em>new</em> shapes. What if I have an existing Shape object's reference that I want to add to slide's shapes?</p>\n\n<p>One way of doing it is to call <code>Copy()</code> on the shape object and then call <code>Paste()</code> in the target slide, but I find it less than ideal since we'll modify the clipboard in the process (I know we can restore it after the operation, but then again this is lame).</p>\n\n<p>There are no <code>Add()</code>, <code>Append()</code> or <code>Insert()</code> functions in the <code>Shapes</code> collection as far as I have searched.</p>\n\n<h2>Edit</h2>\n\n<p>Perhaps I didn't make it clear enough. Let me try again. Say I have a Shape object in a variable like this (PowerPoint/VSTO/C#):</p>\n\n<pre><code>Shape s = GetShape(); //This function returns a Shape object\nMyPresentation.Slides[1].Shapes.???(s);\n</code></pre>\n\n<p>I need a suitable function in place of <code>???</code>; something like <code>Add</code>, <code>Insert</code>, <code>Append</code> etc, but nothing like this exists in the Object Model.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1492619272, "post_id": 43501141, "comment_id": 74056735, "body": "Do you mean &quot;characters&quot; rather than &quot;tabs&quot;?  I wouldn&#39;t generally use VBA for this - you can use built-in Excel functionality to do this perfectly well.  Formulae or filters will work."}, {"owner": {"reputation": 1, "user_id": 7890988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d00719d0b084eb5c1284df1fcda1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Adi ", "link": "https://stackoverflow.com/users/7890988/adi"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1492624259, "post_id": 43501141, "comment_id": 74059948, "body": "You&#39;re right, Characters! The problem with filtering is that I have thousands of rows so filtering is quite messy and that is why I want to eliminate all the cells with less than 5 characters."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7890988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d00719d0b084eb5c1284df1fcda1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Adi ", "link": "https://stackoverflow.com/users/7890988/adi"}, "edited": false, "score": 0, "creation_date": 1492624408, "post_id": 43501445, "comment_id": 74060036, "body": "Thank you! Just so I understand- How do you refer to a specific column in this code?"}, {"owner": {"reputation": 11, "user_id": 5322939, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/CCPh7.jpg?s=128&g=1", "display_name": "Rickey Alterman", "link": "https://stackoverflow.com/users/5322939/rickey-alterman"}, "reply_to_user": {"reputation": 1, "user_id": 7890988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d00719d0b084eb5c1284df1fcda1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Adi ", "link": "https://stackoverflow.com/users/7890988/adi"}, "edited": false, "score": 0, "creation_date": 1492699963, "post_id": 43501445, "comment_id": 74099393, "body": "If mid(Cells(i, &quot;PUT YOUR CELL COLUMN HERE&quot;).Value ,instr(Cells(i, &quot;PUT YOUR CELL COLUMN HERE&quot;).Value ,&quot;-&quot;),) &lt;=5  Then Range(Cells(i, &quot;PUT YOUR CELL COLUMN HERE&quot;), Cells(i, &quot;PUT YOUR CELL COLUMN HERE&quot;)).ClearContents"}], "tags": [], "owner": {"reputation": 11, "user_id": 5322939, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/CCPh7.jpg?s=128&g=1", "display_name": "Rickey Alterman", "link": "https://stackoverflow.com/users/5322939/rickey-alterman"}, "is_accepted": false, "score": 0, "last_activity_date": 1492620566, "last_edit_date": 1492620566, "creation_date": 1492619960, "answer_id": 43501445, "question_id": 43501141, "link": "https://stackoverflow.com/questions/43501141/clear-cell-content-based-on-number-of-tabs/43501445#43501445", "title": "Clear cell content based on number of tabs", "body": "<pre><code>Dim myLastRow As Long\n    Dim i As Long\n\n    Application.ScreenUpdating = False\n\n'   Find last row\n    myLastRow = Cells(Rows.Count, \"J\").End(xlUp).Row\n\n'   Loop through range\n    For i = 6 To myLastRow\n        If mid(Cells(i, \"J\").Value ,instr(Cells(i, \"J\").Value ,\"-\"),) &lt;=5  Then Range(Cells(i, \"O\"), Cells(i, \"Y\")).ClearContents\n    Next i\n\n    Application.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7890988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d00719d0b084eb5c1284df1fcda1d5?s=128&d=identicon&r=PG&f=1", "display_name": "Adi ", "link": "https://stackoverflow.com/users/7890988/adi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1591742890, "creation_date": 1492618921, "last_edit_date": 1591742890, "question_id": 43501141, "link": "https://stackoverflow.com/questions/43501141/clear-cell-content-based-on-number-of-tabs", "title": "Clear cell content based on number of tabs", "body": "<p>I would like to create a VBA code for deleting a cell content based on the number of tabs it contains. For example: in column K, delete cell content if it contains  5 tabs and below- 101-6 or 101- will be deleted but 101-61 won't be deleted.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1492621124, "post_id": 43501009, "comment_id": 74057949, "body": "Quick use of the macro recorder would tell you that <code>Range</code> needs to be in the form of column then row, e.g. <code>Range(&quot;A1&quot;)</code>. You could use <code>Cells</code> instead of <code>Range</code> and keep your existing formulation."}], "answers": [{"tags": [], "owner": {"reputation": 243, "user_id": 6456800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7d9c1c5f3fb0426747663d2c944482?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6456800/unknown"}, "is_accepted": false, "score": 0, "last_activity_date": 1492622615, "creation_date": 1492622615, "answer_id": 43502289, "question_id": 43501009, "link": "https://stackoverflow.com/questions/43501009/excel-vba-to-copy-existing-worksheet-based-on-horizontal-list/43502289#43502289", "title": "Excel vba to copy existing worksheet based on horizontal list", "body": "<p>For range need to define column then row. You can use cells instead of range.\n<code>ActiveSheet.Name = sh.Cells(6, j).Value</code></p>\n"}], "owner": {"reputation": 21, "user_id": 7640265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2eed84983ccb611bbee22659cd58fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Aston", "link": "https://stackoverflow.com/users/7640265/jim-aston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492622615, "creation_date": 1492618534, "question_id": 43501009, "link": "https://stackoverflow.com/questions/43501009/excel-vba-to-copy-existing-worksheet-based-on-horizontal-list", "title": "Excel vba to copy existing worksheet based on horizontal list", "body": "<p>First things first - I'm a complete vba novice, and the code I've put together was total trial and error.</p>\n\n<p>I'm trying to create a code which will allow me to create copies of an existing worksheet (entitled \"Template\") based upon a horizontal list of departmental names in Row 6 of the \"Statistics\" worksheet (starting in cell F6).  For any new departments needed to be included in the document, the user can simply add a new title into the next cell (G6, H6 etc), press the button to run the vba and a new worksheet will appear with the new title as the worksheet title.</p>\n\n<p>The reason I need it to do this is that I am using the INDIRECT function to calculate percentages based on departmental data, and I don't want to rely on whoever uses the workbook in the future knowing how to modify something in Excel (i.e. copying and pasting an existing worksheet, renaming it and then updating the list appropriately).</p>\n\n<p>The code I've put together is this:</p>\n\n<pre><code>Sub New_worksheet()\n\nDim j As Integer\nDim ws As Worksheet\nDim sh As Worksheet\nSet ws = Sheets(\"Template\")\nSet sh = Sheets(\"Statistics\")\nSet Rng = Cells(6, Columns.Count).End(xlToLeft)\n\nApplication.ScreenUpdating = 0\n\nFor j = 5 To Rng.Column\nSheets(\"Template\").Copy Before:=sh\nActiveSheet.Name = sh.Range(\"6\" &amp; j).Value\nNext j\n\nEnd Sub\n</code></pre>\n\n<p>But I get a problem with the <em>ActiveSheet.Name = sh.Range(\"6\" &amp; j).Value</em> part.  I think I've sorted out the problems in the rest of the code, but since it keeps having to debug, I'm not sure.</p>\n\n<p>Can anyone help, please?!!</p>\n"}, {"tags": ["excel", "vba", "parsing"], "comments": [{"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1492618782, "post_id": 43500990, "comment_id": 74056384, "body": "First you should sort the columns by age and then grade in ascending order  then you can check consecutive rows to see if they have same values, and then once you&#39;ve pruned the table you can resort by ID"}, {"owner": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1492618964, "post_id": 43500990, "comment_id": 74056513, "body": "the sheet i&#39;m working with is over 100,000 rows and not all grades are whole numbers, they go as far as 3 decimal places. it&#39;d be much easier to identify them through a script. @AhmedMasud"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1492619016, "post_id": 43500990, "comment_id": 74056542, "body": "Use <code>application.countifs</code> to identify multiples."}, {"owner": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "edited": false, "score": 0, "creation_date": 1492619216, "post_id": 43500990, "comment_id": 74056702, "body": "@Jeeped how would i go about using that?"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1492619224, "post_id": 43500990, "comment_id": 74056710, "body": "My suggestion is independent of the row-count and of the grades being in floating point format (you should be using numeric sorts)."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1492619307, "post_id": 43500990, "comment_id": 74056754, "body": "countifs will not be an easy nor an efficient solution"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1492619463, "post_id": 43500990, "comment_id": 74056847, "body": "@AhmedMasud - If efficiency is of prime concern then all processing should be performed within a 2-D variant memory array. My suggestion was tailored to the OP&#39;s expertise. Sometimes you need to learn to walk before running."}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "edited": false, "score": 0, "creation_date": 1492619712, "post_id": 43501266, "comment_id": 74057013, "body": "I got an &quot;Application defined or object defined error&quot; with the If statement. any ideas?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "edited": false, "score": 0, "creation_date": 1492619962, "post_id": 43501266, "comment_id": 74057174, "body": "My apologies; I had the wrong var name. Fixed above."}, {"owner": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "edited": false, "score": 0, "creation_date": 1492620575, "post_id": 43501266, "comment_id": 74057560, "body": "is this supposed to output to a new sheet as well or does it just identify the rows?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "edited": false, "score": 0, "creation_date": 1492620744, "post_id": 43501266, "comment_id": 74057680, "body": "It identifies (and writes to the VBE&#39;s Immediate window) the duplications in columns B &amp; C. I&#39;m not going to start making up imaginary destination worksheets and code all of that for you. That was not the question posed in this query. If that is what you are looking for, get started and post another question asking for assistance when you run into trouble."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1492619934, "last_edit_date": 1492619934, "creation_date": 1492619316, "answer_id": 43501266, "question_id": 43500990, "link": "https://stackoverflow.com/questions/43500990/how-to-identify-rows-that-have-the-same-value-in-two-columns/43501266#43501266", "title": "How to identify rows that have the same value in two columns?", "body": "<p>Use <code>application.countifs</code> to identify multiples.</p>\n\n<pre><code>Dim lastRowcheck As Long, n1  As Long\n\nWith Worksheets(\"grades\")\n    lastRowcheck = Application.Max(.Range(\"B\" &amp; .Rows.Count).End(xlUp).Row, _\n                                   .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row)\n\n    For n1 = lastRowcheck To 1 Step -1\n        If Application.CountIfs(.Columns(\"B\"), .Cells(n1, \"B\").Value2, .Columns(\"C\"), .Cells(n1, \"C\").Value2) &gt; 1 Then\n           '''export to new sheet\n           Debug.Print .Cells(n1, \"A\") &amp; \":\" &amp; .Cells(n1, \"B\") &amp; \":\" &amp; .Cells(n1, \"C\")\n        End If\n    Next n1\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 3821176, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b6e1f8eec7a60e6921d8fe18f69add6?s=128&d=identicon&r=PG&f=1", "display_name": "Abtra16", "link": "https://stackoverflow.com/users/3821176/abtra16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 43501266, "answer_count": 1, "score": 0, "last_activity_date": 1492619934, "creation_date": 1492618473, "question_id": 43500990, "link": "https://stackoverflow.com/questions/43500990/how-to-identify-rows-that-have-the-same-value-in-two-columns", "title": "How to identify rows that have the same value in two columns?", "body": "<p>I'm trying to identify an entire row if column B <strong><em>AND</em></strong> column C have repeating values with a VBA script. For example if I have a table that contains:</p>\n\n<pre><code>ID   Age   Grade\n1    14     90\n2    15     78\n3    14     90\n4    16     86\n5    16     86\n6    15     89\n7    14     88\n</code></pre>\n\n<p>After I run the script, I want a new sheet with the rows that have repeating values in column B <strong><em>AND</em></strong> column C. So the new sheet would look like:</p>\n\n<pre><code>ID   Age   Grade\n1    14     90\n3    14     90\n4    16     86\n5    16     86\n</code></pre>\n\n<p>This is what I have so far in terms of identifying the rows. I'm not that far along.</p>\n\n<pre><code>Sub ID()\nDim LastRowcheck As Long, n1 As Long\nDim LastRowcheck2 As Long, n2 As Long\n\nWith Worksheets(\"grades\")\n    LastRowcheck = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n    LastRowcheck = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row\n\n    For n1 = LastRowcheck To 1 Step -1\n        If .Cells(n1, 1).Value = Cells(n1 + 1, 1).Value And .Cells(n2, 1).Value = Cells(n2 + 1, 1).Value Then\n           '''export to new sheet\n        End If\n    Next n1\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "edited": false, "score": 0, "creation_date": 1492797296, "post_id": 43506908, "comment_id": 74150546, "body": "Dmitry, I guess I missed placing this in the original question. I have the user&#39;s email, and I want to find it in the address book. Then get information such as the phone # and office (updated the main post). Not sure if I can extract information besides the name for outlook.recipient."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "edited": false, "score": 0, "creation_date": 1492797625, "post_id": 43506908, "comment_id": 74150717, "body": "Of course you can - use Recipient.AddressEntry. From there you can use either AddressEntry.GetExchangeUser or AddressEntry.PropertyAccessor.GetProperty to read any MAPI property (use OutlookSpy to see what is available)."}, {"owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "edited": false, "score": 0, "creation_date": 1492798383, "post_id": 43506908, "comment_id": 74151100, "body": "Thanks. This is awesome. This should work for what I need. Will post the code once I am done with it."}, {"owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "edited": false, "score": 0, "creation_date": 1492922685, "post_id": 43506908, "comment_id": 74185272, "body": "Thanks again Dmitry. Posted a macro to do the search for the contact phone # as a separate answer as I could not place code in the comments."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1492639747, "creation_date": 1492639747, "answer_id": 43506908, "question_id": 43500724, "link": "https://stackoverflow.com/questions/43500724/outlook-address-book-search-no-looping/43506908#43506908", "title": "Outlook Address Book Search (No Looping?)", "body": "<p>Use <code>Namespace.CreateRecipient</code> / <code>Recipient.Resolve</code> to resolve the name (or address) in the address book. Even if you pass an SMTP address, it will be resolved to a GAL user (if there is a match).</p>\n"}, {"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1492923140, "post_id": 43549624, "comment_id": 74185342, "body": "There is absolutely no reason to create a dummy email. Use Namespace.CreateRecipient / Recipient.Resolve."}, {"owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1493044866, "post_id": 43549624, "comment_id": 74231660, "body": "Tried using Namespace.CreateRecipient but ran into an error and I had no time to entertain it. I needed a functional macro real quick. I have used resolving recipients before with emails, so that is why I went that route. When I have a chance, I will try it again with Namespace.CreateRecipient."}], "tags": [], "owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "is_accepted": false, "score": 1, "last_activity_date": 1492799161, "creation_date": 1492799161, "answer_id": 43549624, "question_id": 43500724, "link": "https://stackoverflow.com/questions/43500724/outlook-address-book-search-no-looping/43549624#43549624", "title": "Outlook Address Book Search (No Looping?)", "body": "<p>This is the solution that I am using to get the phone # of a contact using the email address from the global address book - using Dmitry Streblechenko approach.</p>\n\n<pre><code>Sub GetPhone(EmailAddress As String) 'Gets the phone # for contact\nDim OutApp As Outlook.Application\nDim OutMail As Object\nDim OutRecipients As Outlook.Recipient\nDim PhoNe As String\n\n\nOn Error Resume Next\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nSet OutRecipients = OutMail.Recipients.Add(EmailAddress)\nOutRecipients.Resolve\n\nPhoNe = OutRecipients.AddressEntry.GetExchangeUser.BusinessTelephoneNumber\nSet OutRecipients = Nothing\nSet OutMail = Nothing\nSet OutApp = Nothing\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 5636532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dc298e907c56095085915c55f6feafc?s=128&d=identicon&r=PG&f=1", "display_name": "M. Marzouk", "link": "https://stackoverflow.com/users/5636532/m-marzouk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2978, "favorite_count": 0, "accepted_answer_id": 43506908, "answer_count": 2, "score": 3, "last_activity_date": 1592870257, "creation_date": 1492617706, "last_edit_date": 1592870257, "question_id": 43500724, "link": "https://stackoverflow.com/questions/43500724/outlook-address-book-search-no-looping", "title": "Outlook Address Book Search (No Looping?)", "body": "<p>Is there anyway to search Outlook address box for a contact using their email address without any sort of For Loops? There are so many contacts in our Global Contact List and it takes forever to go through the list. Is there no search or find function that can be applied to the contact list.</p>\n\n<p><strong>I am looking to get information like the phone # and office for the user if they are found in the contact list.</strong></p>\n\n<p>All the solutions that I have found involve looping through the contact list.\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff869721.aspx\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/forum/showthread.php?t=76588</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff869721.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff869721.aspx</a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 6656249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1454e9581e40d22bdd5417d5a87d504e?s=128&d=identicon&r=PG&f=1", "display_name": "shoegazer100", "link": "https://stackoverflow.com/users/6656249/shoegazer100"}, "edited": false, "score": 0, "creation_date": 1492624065, "post_id": 43500630, "comment_id": 74059810, "body": "Still curious if anyone knows though why modifying the query and refreshing/requerying won&#39;t update the data in the subform."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6656249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1454e9581e40d22bdd5417d5a87d504e?s=128&d=identicon&r=PG&f=1", "display_name": "shoegazer100", "link": "https://stackoverflow.com/users/6656249/shoegazer100"}, "edited": false, "score": 0, "creation_date": 1492620446, "post_id": 43501499, "comment_id": 74057474, "body": "Thanks for the reply, but I&#39;m not just changing the sort order. The STAFF.FULLNAME &lt;&gt; &#39;JOHN DOE&#39; is what&#39;s being added to the query with the actual name being dependent on what the user has selected. There are specific names that need to be excluded from the query based on user input."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 13, "user_id": 6656249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1454e9581e40d22bdd5417d5a87d504e?s=128&d=identicon&r=PG&f=1", "display_name": "shoegazer100", "link": "https://stackoverflow.com/users/6656249/shoegazer100"}, "edited": false, "score": 0, "creation_date": 1492620841, "post_id": 43501499, "comment_id": 74057748, "body": "See revised answer."}, {"owner": {"reputation": 13, "user_id": 6656249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1454e9581e40d22bdd5417d5a87d504e?s=128&d=identicon&r=PG&f=1", "display_name": "shoegazer100", "link": "https://stackoverflow.com/users/6656249/shoegazer100"}, "edited": false, "score": 0, "creation_date": 1492623721, "post_id": 43501499, "comment_id": 74059582, "body": "Thanks for pointing me in right direction. Ultimately I used the filter property because I actually don&#39;t need any reordering: &#39;F.Filter = &quot;STAFF.FULLNAME &lt;&gt; &#39;JOHN DOE&#39;   F.FilterOn = True&#39;"}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 1, "last_activity_date": 1492620827, "last_edit_date": 1492620827, "creation_date": 1492620107, "answer_id": 43501499, "question_id": 43500630, "link": "https://stackoverflow.com/questions/43500630/form-not-refreshing-when-query-def-updated/43501499#43501499", "title": "Form not refreshing when query def updated", "body": "<p>Why modify query? Just to change the sort order? Build a form set for Datasheet view and apply sort criteria to the OrderBy property using DoCmd.SetOrderBy or </p>\n\n<pre><code>Me.OrderByOn = False    \nMe.OrderBy = \"your criteria\"\nMe.OrderByOn = True\n</code></pre>\n\n<p>And if you want to dynamically apply filter criteria, use code similar to the OrderBy.</p>\n"}], "owner": {"reputation": 13, "user_id": 6656249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1454e9581e40d22bdd5417d5a87d504e?s=128&d=identicon&r=PG&f=1", "display_name": "shoegazer100", "link": "https://stackoverflow.com/users/6656249/shoegazer100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "accepted_answer_id": 43501499, "answer_count": 1, "score": 0, "last_activity_date": 1492620827, "creation_date": 1492617394, "question_id": 43500630, "link": "https://stackoverflow.com/questions/43500630/form-not-refreshing-when-query-def-updated", "title": "Form not refreshing when query def updated", "body": "<p>I have a form that contains a subform which displays a datasheet view of a query. There is a button on the main form that when clicked will revise the query's SQL. When the button is clicked, the query is revised as expected, but the results do not update in the subform unless I close and reopen the main form.</p>\n\n<p>I've tried to requery the subform and the main form. I've tried to refresh the subform and the main form. I've tried various combinations of the two, but nothing will update the data shown in the subform except closing and reopening the main form.</p>\n\n<p>Any insights or suggestions? </p>\n\n<p>This is the code that I have in the main form, and it runs when a button is clicked.</p>\n\n<pre><code>    Dim f as Form\n    Set f = Me.frm_Subform.Form\n\n    ' Update the query def\n    Dim sSQL As String\n    Dim sqlArray As Variant\n    sSQL = CurrentDb.QueryDefs(\"myQuery\").SQL\n    sqlArray = Split(sSQL, \"ORDER BY\")\n    sSQL = Left(sqlArray(0), Len(sqlArray(0)) - 3)\n    sSQL = sSQL &amp; \" AND (STAFF.FULLNAME &lt;&gt; 'JOHN DOE') \"\n    sSQL = sSQL &amp; \"ORDER BY\" &amp; sqlArray(1)\n    CurrentDb.QueryDefs(\"myQuery\").SQL = sSQL\n\n    ' Refresh the subform\n    F.Requery\n    Me.Requery\n    F.Refresh\n    Me.Refresh\n    F.Repaint\n    Me.Repaint\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492617256, "post_id": 43500524, "comment_id": 74055319, "body": "Do you have a row that is <b>always</b> filled with a number to the extent of your data? Do you have one with text that is always filled to the extent of your data?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1492617991, "post_id": 43500524, "comment_id": 74055838, "body": "I&#39;m confused. Do you want to repair the mistake that your sub procedure makes every time you run it or do you want to fix the sub procedure so it doesn&#39;t make the  mistake? I would recommend the latter."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1492618080, "post_id": 43500524, "comment_id": 74055899, "body": "This often happens when erroneous formats or such are applied to entire columns or rows and while the extraneous rows <i>seem</i> blank, they actually have some style or format applied to them which considers them to be in the <code>UsedRange</code>. If your problem occurs because the code executes over and over again and when you hit this it calculates, review and refactor your code based on what I wrote above. Otherwise, simply delete the extra rows | columns and move on with life :)"}], "answers": [{"tags": [], "owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1492638350, "creation_date": 1492638350, "answer_id": 43506625, "question_id": 43500524, "link": "https://stackoverflow.com/questions/43500524/excel-vba-used-columns/43506625#43506625", "title": "Excel VBA Used Columns", "body": "<p>Can't you just delete the unused columns? If so what about this solution? </p>\n\n<pre><code>Sub DeleteUnusedColumns()\n\n        Dim colRange As Range\n        Dim c As Long\n\n    'Define the target range\n        Set colRange = ActiveSheet.UsedRange\n\n    'Iterate through the columns\n        For c = colRange.Columns.Count To 1 Step -1\n\n    'If the column is empty then you can delete it\n           If Application.CountA(Columns(c).EntireColumn) = 0 Then\n           Columns(c).Delete\n           End If\n\n    'Increment the counter down\n        Next c\n    End Sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 661, "user_id": 7247575, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8dbbe71a32fc7777d77fd555911bad3c?s=128&d=identicon&r=PG&f=1", "display_name": "Sylvi0202", "link": "https://stackoverflow.com/users/7247575/sylvi0202"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 591, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492638350, "creation_date": 1492617056, "last_edit_date": 1492617219, "question_id": 43500524, "link": "https://stackoverflow.com/questions/43500524/excel-vba-used-columns", "title": "Excel VBA Used Columns", "body": "<p>My Excel file is huge and I found out that the reason is in the unused columns. If I delete them the file has a normal size.\nThe unused columns are just blanks or at least appear to be blanks. However, something must be contained in them.\nHow can I find out what and how can I reset the UsedRange to the actual number of columns with content?</p>\n\n<p>I tried the following:</p>\n\n<pre><code> myLastCol = _\n   .Cells.Find(\"*\", after:=.Cells(1), _\n    LookIn:=xlFormulas, lookat:=xlWhole, _\n    searchdirection:=xlPrevious, _\n    searchorder:=xlByColumns).Column\n</code></pre>\n\n<p>And also</p>\n\n<pre><code>myLastCol=ActiveSheet.UsedRange.Columns.Count\n</code></pre>\n\n<p>Both would return the value <code>16383</code>. Any suggestions? How can this happen (I am sure it has something to do with the Macro I wrote)?</p>\n"}, {"tags": ["excel", "excel-formula", "user-defined-functions", "textjoin", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1492618293, "post_id": 43500680, "comment_id": 74056035, "body": "Sorry but I had to Mj&#246;lnir this one."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1492618352, "post_id": 43500680, "comment_id": 74056077, "body": "@Jeeped NP, could not find one that fit.  Yours is perfect."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492618760, "post_id": 43500680, "comment_id": 74056365, "body": "btw, I&#39;ve created a <a href=\"http://stackoverflow.com/questions/tagged/textjoin\">textjoin</a> tag recently that can be used to find Q&amp;A&#39;s on string concatenation. It  might even be due for an update to its info."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1492617555, "creation_date": 1492617555, "answer_id": 43500680, "question_id": 43500476, "link": "https://stackoverflow.com/questions/43500476/returning-column-names-if-there-is-match-in-the-row-looking-for-multiple-matche/43500680#43500680", "title": "Returning column names if there is match in the row, looking for multiple matches", "body": "<p>If you have a subscription to Office 365 Excel then you can use the following array formula:</p>\n\n<pre><code>=TEXTJOIN(\", \",TRUE,IF(($E$2:$H$6 = \"X\")*($D$2:$D$6=A2),$E$1:$H$1,\"\"))\n</code></pre>\n\n<p>Being an array formula it needs to be confirmed with Ctrl-Shift-Enter instead of Enter when exiting edit mode.  If done correctly then Excel will put <code>{}</code> around the formula.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8gTiU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8gTiU.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>If you do not have Office 365 then you can put this code in a module attached to the workbook and use the formula as described above:</p>\n\n<pre><code>Function TEXTJOIN(delim As String, skipblank As Boolean, arr)\n    Dim d As Long\n    Dim c As Long\n    Dim arr2()\n    Dim t As Long, y As Long\n    t = -1\n    y = -1\n    If TypeName(arr) = \"Range\" Then\n        arr2 = arr.Value\n    Else\n        arr2 = arr\n    End If\n    On Error Resume Next\n    t = UBound(arr2, 2)\n    y = UBound(arr2, 1)\n    On Error GoTo 0\n\n    If t &gt;= 0 And y &gt;= 0 Then\n        For c = LBound(arr2, 1) To UBound(arr2, 1)\n            For d = LBound(arr2, 1) To UBound(arr2, 2)\n                If arr2(c, d) &lt;&gt; \"\" Or Not skipblank Then\n                    TEXTJOIN = TEXTJOIN &amp; arr2(c, d) &amp; delim\n                End If\n            Next d\n        Next c\n    Else\n        For c = LBound(arr2) To UBound(arr2)\n            If arr2(c) &lt;&gt; \"\" Or Not skipblank Then\n                TEXTJOIN = TEXTJOIN &amp; arr2(c) &amp; delim\n            End If\n        Next c\n    End If\n    TEXTJOIN = Left(TEXTJOIN, Len(TEXTJOIN) - Len(delim))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 1668089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/026128d80fae4dcff69a9ce303f0dd5d?s=128&d=identicon&r=PG", "display_name": "Bijsterz", "link": "https://stackoverflow.com/users/1668089/bijsterz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "closed_date": 1492618248, "accepted_answer_id": 43500680, "answer_count": 1, "score": 0, "last_activity_date": 1492618554, "creation_date": 1492616920, "last_edit_date": 1531161705, "question_id": 43500476, "link": "https://stackoverflow.com/questions/43500476/returning-column-names-if-there-is-match-in-the-row-looking-for-multiple-matche", "closed_reason": "Duplicate", "title": "Returning column names if there is match in the row, looking for multiple matches", "body": "<p>I have one table with parts as following;</p>\n\n<pre><code>---------------\n| Part number |\n---------------\n| 123456      |\n| 16D345      |\n| 16E099      |\n| 490586      |\n| 970884      |\n---------------\n</code></pre>\n\n<p>And another one like so;</p>\n\n<pre><code>---------------------------------------------------\n| Part number | 940822 | 940922 | 170345 | 940222 |\n---------------------------------------------------\n| 123456      |    X   |        |    X   |    X   |\n| 16D345      |    X   |        |    X   |        |\n| 16E099      |        |    X   |        |    X   |\n| 490586      |    X   |        |    X   |    X   |\n| 970884      |        |        |    X   |        |\n---------------------------------------------------\n</code></pre>\n\n<p>The numbers in columns of the second table are 'units'.<br>\nI'm trying to figure out how to get all the unit numbers where a part has X. Basically I want to end up with the following;</p>\n\n<pre><code>----------------------------------------\n| Part number | Used in                |\n----------------------------------------\n| 123456      | 940822, 170345, 940222 |\n| 16D345      | 940822, 170345         |\n| 16E099      | 940922, 940222         |\n| 490586      | 940822, 170345, 940222 |\n| 970884      | 170345                 |\n----------------------------------------\n</code></pre>\n\n<p>Now I've just recently learned how to use INDEX and MATCH but haven't been able to get the result I want. I've tried using array formulas but I don't understand them yet.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1492618812, "post_id": 43500423, "comment_id": 74056401, "body": "are the records (column A) in sorted order?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1492621334, "post_id": 43500423, "comment_id": 74058105, "body": "Have you tried anything yourself? You&#39;re more likely to get help if you have."}, {"owner": {"reputation": 95, "user_id": 5095940, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/HvtK1.jpg?s=128&g=1", "display_name": "Billy Bragg in the UK", "link": "https://stackoverflow.com/users/5095940/billy-bragg-in-the-uk"}, "edited": false, "score": 0, "creation_date": 1492675743, "post_id": 43500423, "comment_id": 74081069, "body": "I did SJR from using lookups to VB but can&#39;t seem to get it to work. I should have posted my examples here."}], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1492637087, "last_edit_date": 1492637087, "creation_date": 1492634502, "answer_id": 43505676, "question_id": 43500423, "link": "https://stackoverflow.com/questions/43500423/group-on-excel-rows-to-a-single-cell-by-column-id/43505676#43505676", "title": "Group on excel rows to a single cell by column id", "body": "<p>These solutions use a working column named <em>Concatenated Results</em>.</p>\n\n<p>Assuming your data has a header <em>(adjust formulas as required)</em> and is located at <code>B6:C34</code> <em>(change as required)</em> as in fig below.</p>\n\n<p><strong>Data sorted by <code>ID</code></strong>: </p>\n\n<p><em>Concatenated Results:</em> Enter this formula in <code>D7</code>.</p>\n\n<pre><code>= CONCATENATE( C7, IF( EXACT( B7, B8 ), \",\" &amp; D8, \"\" ) )\n</code></pre>\n\n<p><em>ID.Unique:</em> Enter this <code>Array Formula</code> in <code>E7</code> (<em>FormulaArrays are entered pressing</em> <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>ENTER</kbd> <em>simultaneously, you shall see</em> <code>{</code> <em>and</em> <code>}</code> <em>around the formula if entered correctly</em>)</p>\n\n<pre><code>=IFERROR( INDEX( $B$7:$B$34,\nMATCH( 0, COUNTIF( $E6:$E$6, $B$7:$B$34 ), 0 ) * 1 ), \"\" )\n</code></pre>\n\n<p><em>Countries:</em> Enter this formula in <code>F7</code></p>\n\n<pre><code>=IFERROR(VLOOKUP(E7,$B$6:$J$34,3,0),\"\")\n</code></pre>\n\n<p>Copy range <code>D7:F7</code> till last row of data <em>(i.e. row 34)</em>.</p>\n\n<p><strong>Data not sorted</strong>: If the data is not sorted enter this formula for the <em>Concatenated Results</em> in <code>D7</code>. <em>All other formulas remain unchanged</em>.</p>\n\n<pre><code>=CONCATENATE( C7,\nIF( ISERROR( MATCH( B7, B8:B$35, 0 ) ), \"\",\n\",\" &amp; VLOOKUP( B7, B8:D$35, 3, 0 ) ) )\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LCkHG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LCkHG.png\" alt=\"enter image description here\"></a></p>\n\n<p>Suggest to read the following pages to gain a deeper understanding of the resources used:</p>\n\n<p><a href=\"https://support.office.com/en-us/article/Excel-functions-alphabetical-b3944572-255d-4efb-bb96-c6d90033e188\" rel=\"nofollow noreferrer\">Excel functions (alphabetical)</a>, <a href=\"https://support.office.com/en-us/article/Create-an-array-formula-E43E12E0-AFC6-4A12-BC7F-48361075954D\" rel=\"nofollow noreferrer\">Create an array formula</a>, <a href=\"https://support.office.com/en-us/article/Guidelines-and-examples-of-array-formulas-7D94A64E-3FF3-4686-9372-ECFD5CAA57C7\" rel=\"nofollow noreferrer\">Guidelines and examples of array formulas</a></p>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1506010524, "last_edit_date": 1506010524, "creation_date": 1492637858, "answer_id": 43506529, "question_id": 43500423, "link": "https://stackoverflow.com/questions/43500423/group-on-excel-rows-to-a-single-cell-by-column-id/43506529#43506529", "title": "Group on excel rows to a single cell by column id", "body": "<p>This is a VBA solution</p>\n\n<p>Assuming your data, excluding header, is located at <code>B7:C34</code> (change as required).</p>\n\n<p><em>ID.Unique:</em> Enter this Array Formula in E7 (<em>FormulaArrays are entered pressing</em> <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>ENTER</kbd> <em>simultaneously, you shall see</em> <code>{</code> <em>and</em> <code>}</code> <em>around the formula if entered correctly</em>)</p>\n\n<pre><code>=IFERROR( INDEX( $B$7:$B$34,\nMATCH( 0, COUNTIF( $E6:$E$6, $B$7:$B$34 ), 0 ) * 1 ), \"\" )\n</code></pre>\n\n<p><em>Countries:</em> Enter this <code>User Defined Function</code> <em>(UDF)</em> in F7</p>\n\n<pre><code>=Match_Concatenated(E7,$B$7:$C$34)\n</code></pre>\n\n<p>Copy this UDF code in a VBA Module</p>\n\n<pre><code>Option Explicit\n\nPublic Function Match_Concatenated(vValue As Variant, rTrg As Range) As String\nDim sOutput As String\nDim vTrg As Variant, vItm As Variant, lRow As Long\n    vTrg = rTrg.Value2\n    For lRow = 1 To UBound(vTrg)\n        vItm = WorksheetFunction.Index(vTrg, lRow, 0)\n        If vItm(1) = vValue Then sOutput = sOutput &amp; Chr(44) &amp; vItm(2)\n    Next\n    sOutput = Replace(sOutput, Chr(44), vbNullString, 1, 1)\n    Match_Concatenated = sOutput\nEnd Function\n</code></pre>\n\n<p>Suggest to read the following pages to gain a deeper understanding of the resources used:</p>\n\n<p><a href=\"https://support.office.com/en-us/article/Excel-functions-alphabetical-b3944572-255d-4efb-bb96-c6d90033e188\" rel=\"nofollow noreferrer\">Excel functions (alphabetical)</a>, </p>\n\n<p><a href=\"https://support.office.com/en-us/article/Create-an-array-formula-E43E12E0-AFC6-4A12-BC7F-48361075954D\" rel=\"nofollow noreferrer\">Create an array formula</a>, </p>\n\n<p><a href=\"https://support.office.com/en-us/article/Guidelines-and-examples-of-array-formulas-7D94A64E-3FF3-4686-9372-ECFD5CAA57C7\" rel=\"nofollow noreferrer\">Guidelines and examples of array formulas</a>,</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg278855(v=office.15).aspx\" rel=\"nofollow noreferrer\">Option Explicit Statement</a>,</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff193553(v=office.15).aspx\" rel=\"nofollow noreferrer\">Range.Value2 Property (Excel)</a>, <a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251601.aspx\" rel=\"nofollow noreferrer\">For...Next Statement</a>,</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow noreferrer\">WorksheetFunction Object (Excel)</a>, <a href=\"https://support.office.com/en-us/article/INDEX-function-a5dcf0dd-996d-40a4-a822-b56b061328bd\" rel=\"nofollow noreferrer\">INDEX function</a>,</p>\n\n<p><a href=\"https://msdn.microsoft.com/EN-US/library/office/gg251599.aspx\" rel=\"nofollow noreferrer\">If...Then...Else Statement</a>,  <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264409(v=office.15).aspx\" rel=\"nofollow noreferrer\">Replace Function</a></p>\n"}, {"tags": [], "owner": {"reputation": 1161, "user_id": 7848561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01f668ef5764c6c58a66b5e2b44cef88?s=128&d=identicon&r=PG&f=1", "display_name": "G.Arima", "link": "https://stackoverflow.com/users/7848561/g-arima"}, "is_accepted": false, "score": 0, "last_activity_date": 1492809218, "last_edit_date": 1492809218, "creation_date": 1492808732, "answer_id": 43552015, "question_id": 43500423, "link": "https://stackoverflow.com/questions/43500423/group-on-excel-rows-to-a-single-cell-by-column-id/43552015#43552015", "title": "Group on excel rows to a single cell by column id", "body": "<p>Try this out and let me know in case of any queries or if you require detailed explanation.</p>\n\n<p><strong>Step1:</strong> <code>Filter</code> the data by column A.<br>\n<strong>Step2:</strong> Make a new column C where use this formula <code>IF(A2=A1,CONCATENATE(B2,\",\",C1),B2)</code>  .<br>\n<strong>Step3:</strong> Make a new column D where use this formula <code>IF(A2=A3,\" \",\"REQUIRED_ANS\")</code> .<br>\n<strong>Step4:</strong> Filter on column D using <code>ALT</code> + <code>D</code> + <code>F</code> + <code>F</code> and you get you desired output.</p>\n\n<p><strong>My Output:</strong><br>\n<a href=\"https://i.stack.imgur.com/Lzbun.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lzbun.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 95, "user_id": 5095940, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/HvtK1.jpg?s=128&g=1", "display_name": "Billy Bragg in the UK", "link": "https://stackoverflow.com/users/5095940/billy-bragg-in-the-uk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 470, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1506010524, "creation_date": 1492616785, "last_edit_date": 1531161705, "question_id": 43500423, "link": "https://stackoverflow.com/questions/43500423/group-on-excel-rows-to-a-single-cell-by-column-id", "title": "Group on excel rows to a single cell by column id", "body": "<p>I have a question regarding excel.</p>\n\n<p>I have two columns, column A has a number and B has country codes. I'm looking for a way to automatically go through 100's thousands of rows to group them so they look like the following...</p>\n\n<p>Is this doable? I'm at a complete loss :(</p>\n\n<p>THE END RESULT</p>\n\n<pre><code>6512    AG,AI,AW,BB,BL,BM,\n6513    BQ,BS,BZ,CA,CR\n</code></pre>\n\n<p>STARTING POINT - column A &amp; B</p>\n\n<pre><code>6512    AG\n6512    AI\n6512    AW\n6512    BB\n6512    BL\n6512    BM\n6513    BQ\n6513    BS\n6513    BZ\n6513    CA\n6513    CR\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492615859, "post_id": 43499868, "comment_id": 74054314, "body": "Use <code>With ... End With</code> combined with <code>.CurrentRegion</code>, <code>.Resize</code> and <code>.End(xlDown)</code> to cycle through the grouped data, sorting each group as you progress through."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 3, "creation_date": 1492615968, "post_id": 43499868, "comment_id": 74054405, "body": "SO is not a code writing website. What have tried so far?"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1492615988, "creation_date": 1492615988, "answer_id": 43500150, "question_id": 43499868, "link": "https://stackoverflow.com/questions/43499868/excel-vba-if-value-in-rowx-value-in-row-x1-in-column-c-then-sort-values/43500150#43500150", "title": "Excel VBA: if value in row(x) = value in row (x+1) in column C then sort values in column H", "body": "<p>Go to the Developer tab and click \"Record Macro\". Give the macro any name (Excel's suggestion is fine).</p>\n\n<p>Perform the actions to sort the data, such as selct the data, swt the Sort settings etc.</p>\n\n<p>Click \"Stop recording\" in teh developer tab.</p>\n\n<p>Goto to VB and open the macro you just recorded. Use the code as a basis for your actual macro. You can record anything you want to know in additional recorded macros. The rest I leave to you. Come back when you have problems with your code.</p>\n"}], "owner": {"reputation": 1, "user_id": 7890376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc064d61ed4659f4ccd81980d527d17?s=128&d=identicon&r=PG&f=1", "display_name": "Otterring", "link": "https://stackoverflow.com/users/7890376/otterring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1492634601, "creation_date": 1492615246, "last_edit_date": 1492634601, "question_id": 43499868, "link": "https://stackoverflow.com/questions/43499868/excel-vba-if-value-in-rowx-value-in-row-x1-in-column-c-then-sort-values", "title": "Excel VBA: if value in row(x) = value in row (x+1) in column C then sort values in column H", "body": "<p>I'm very new to Excel VBA. </p>\n\n<p>Every month I import a spreadsheet of multiple customers' data that is already separated by customer in column C (account number).  Within each account number, I need to then sort the rows into alphanumeric order based on column E (service).  </p>\n\n<p>In other words, I need a macro that will sort the values in column E <strong>only if</strong> the values in column C are equal to each other.  </p>\n\n<p>Macro must also skip any irrelevant rows, some of which contain merged cells.</p>\n\n<p>FYI - the format of all the values = text, other than column I (charge amount).</p>\n\n<p>Any help greatly appreciated - apologies ahead of time if I haven't made my question clear enough!</p>\n\n<p>Below is a spreadsheet example:\n<img src=\"https://i.stack.imgur.com/P6U3f.png\" alt=\"sort service within each account number\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "edited": false, "score": 2, "creation_date": 1492615370, "post_id": 43499791, "comment_id": 74053967, "body": "This code has nothing to do with copy and paste. It assigns values."}, {"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "reply_to_user": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "edited": false, "score": 0, "creation_date": 1492615420, "post_id": 43499791, "comment_id": 74053995, "body": "Do you know then how to copy active column with merged cells and paste it in values?"}, {"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1492615977, "post_id": 43499791, "comment_id": 74054408, "body": "@pnuts Yes but I added a comment and seems nobody responded."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1492617305, "post_id": 43500329, "comment_id": 74055355, "body": "It copies the active column 4 times next to this one and deletes all merged cells. Do you know a way to copy the active column and paste in values even if it has merged cells?"}, {"owner": {"reputation": 64, "user_id": 7112084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cb60c912881192d7b3ac827012a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam ", "link": "https://stackoverflow.com/users/7112084/sam"}, "reply_to_user": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1492620972, "post_id": 43500329, "comment_id": 74057840, "body": "Could you try explaining that in a different way? The way this one is set up is it copies the active column (c) and pastes it to the column next to it (c + 1). In the example I used, I assumed that the active column had the cells in rows 4 and 5 merged, so I first merged the cells to the right of the active column before pasting them over. So whatever cells you have that are merged in your active column should first be merged in the column that you are going to paste in. You can use the merge function (in the example above, Range(Cells(x, c + 1), Cells(5, c + 1)).Merge) as many times as needed"}], "tags": [], "owner": {"reputation": 64, "user_id": 7112084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/013cb60c912881192d7b3ac827012a1a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam ", "link": "https://stackoverflow.com/users/7112084/sam"}, "is_accepted": true, "score": 2, "last_activity_date": 1492616525, "creation_date": 1492616525, "answer_id": 43500329, "question_id": 43499791, "link": "https://stackoverflow.com/questions/43499791/copy-and-paste-active-column-without-changing-cells-formats/43500329#43500329", "title": "Copy and paste active column without changing cells formats", "body": "<p>Try it this way:</p>\n\n<pre><code>Dim r As Long\nc = Selection.Column\n\nRange(Cells(4, c + 1), Cells(5, c + 1)).Merge\nColumns(c).EntireColumn.Copy\nColumns(c + 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>You may need to tweak some stuff, like merging certain cells, where you want the cell pasted in relation to the copied cell. Let me know how this works</p>\n"}], "owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 43500329, "answer_count": 1, "score": 1, "last_activity_date": 1576918380, "creation_date": 1492615077, "last_edit_date": 1576918380, "question_id": 43499791, "link": "https://stackoverflow.com/questions/43499791/copy-and-paste-active-column-without-changing-cells-formats", "title": "Copy and paste active column without changing cells formats", "body": "<p>This code helps me to copy and paste active column in values but the numbers are pasted with two decimals. I'm using this code because my sheet has merged cells inside and also some cells within the column have dates.</p>\n\n<pre><code>ActiveCell.Offset(0, 0).EntireColumn.Value = ActiveCell.EntireColumn.Value\n</code></pre>\n\n<p>I need to paste the column in values exactly in the format that the column has the format. Leave the numbers without the decimals.</p>\n\n<p>Note: If you do it manually by selecting the column and then selecting paste in values from  the Home bar, it pastes it exactly as it was with the formulas.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1492614922, "post_id": 43499720, "comment_id": 74053667, "body": "You beat me by 4 seconds. 8P"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1492614992, "post_id": 43499720, "comment_id": 74053712, "body": "@ScottCraner  It is a rare day when I answer a question faster than you :)"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1492614874, "creation_date": 1492614874, "answer_id": 43499720, "question_id": 43499569, "link": "https://stackoverflow.com/questions/43499569/simple-range-copy-issue/43499720#43499720", "title": "simple range copy issue", "body": "<p>You would need to qualify one or both of the uses of <code>Cells</code> so that VBA knows what sheet contains those cells:</p>\n\n<pre><code>Sheets(\"B\").Range(Sheets(\"B\").Cells(X, Y), Sheets(\"B\").Cells(X, Y+ 3)).Value = _\nSheets(\"A\").Range(Sheets(\"A\").Cells(1, Z), Sheets(\"A\").Cells(1, Z+ 3)).Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1492615154, "creation_date": 1492615154, "answer_id": 43499828, "question_id": 43499569, "link": "https://stackoverflow.com/questions/43499569/simple-range-copy-issue/43499828#43499828", "title": "simple range copy issue", "body": "<p>I would start from a known reference (like \"A1\") and use the <code>.Offset()</code> and <code>.Resize()</code> methods for \"selecting\" the values you want. This way you are guaranteed to get the same number of rows and columns.</p>\n\n<pre><code>Sheets(\"A\").Range(\"A1\").Offset(0,Z-1).Resize(1,3).Value = _ \n  Sheets(\"B\").Range(\"A1\").Offset(X-1,Y-1).Resize(1,3).Value\n</code></pre>\n\n<p>This works best in combination with <em>named ranges</em> in the worksheet</p>\n\n<pre><code>Sheets(\"A\").Range(\"TableA\").Offset(0,X-1).Resize(n,1).Value = _\n  Sheets(\"B\").Range(\"TableB\").Offset(0,Y-1).Resize(n,1).Value\n</code></pre>\n\n<p>for copying <code>n</code> rows from <code>TableB</code> column# <code>X</code> onto <code>TableA</code> column# <code>Y</code></p>\n"}], "owner": {"reputation": 91, "user_id": 5865063, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/29e6a11d3936b0932b6ea80dd157f633?s=128&d=identicon&r=PG&f=1", "display_name": "Dan S", "link": "https://stackoverflow.com/users/5865063/dan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1492616194, "accepted_answer_id": 43499720, "answer_count": 2, "score": 0, "last_activity_date": 1492615154, "creation_date": 1492614479, "question_id": 43499569, "link": "https://stackoverflow.com/questions/43499569/simple-range-copy-issue", "closed_reason": "Duplicate", "title": "simple range copy issue", "body": "<p>I know I'm being dense but I can't for the life of me find the right syntax for a simple (clipboard free) copy action:</p>\n\n<pre><code>Sheets(\"B\").Range(Cells(X, Y), Cells(X, Y+ 3)).value = _\nSheets(\"A\").Range(Cells(1, Z), Cells(1, Z+ 3)).value\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1492614545, "post_id": 43499447, "comment_id": 74053391, "body": "<code>Ctrl+Shift+a</code> does not work for me. Are you sure it works for you?"}, {"owner": {"reputation": 25, "user_id": 7890513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537d7fc3a0a4b8ebed03b0770aa54100?s=128&d=identicon&r=PG&f=1", "display_name": "scttsmn", "link": "https://stackoverflow.com/users/7890513/scttsmn"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1492614675, "post_id": 43499447, "comment_id": 74053486, "body": "I have not tried <code>Ctrl+Shift+a</code>.  I have only tried <code>Ctrl+a</code>, <code>Ctrl+Alt+a</code> and <code>Alt+a</code>."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1492614774, "post_id": 43499447, "comment_id": 74053555, "body": "What&#39;s point here assigning multiple shortcuts to the same macro?"}, {"owner": {"reputation": 25, "user_id": 7890513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537d7fc3a0a4b8ebed03b0770aa54100?s=128&d=identicon&r=PG&f=1", "display_name": "scttsmn", "link": "https://stackoverflow.com/users/7890513/scttsmn"}, "edited": false, "score": 1, "creation_date": 1492614913, "post_id": 43499447, "comment_id": 74053659, "body": "I only want <code>Alt+a</code>.  The others were just a test to see if other keystroke combinations were working."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7890513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537d7fc3a0a4b8ebed03b0770aa54100?s=128&d=identicon&r=PG&f=1", "display_name": "scttsmn", "link": "https://stackoverflow.com/users/7890513/scttsmn"}, "edited": false, "score": 1, "creation_date": 1492632208, "post_id": 43499867, "comment_id": 74064729, "body": "Tried this code as well, but with the same results - <code>%a</code> does not appear to be assigning the key stroke.  I tried your code for all 26 letters of the alphabet, and only the following letters worked: &quot;b&quot;, &quot;c&quot;, &quot;g&quot;, &quot;j&quot;, &quot;k&quot;, &quot;q&quot;, &quot;s&quot;, &quot;u&quot;, &quot;y&quot;, and &quot;z&quot;.  Some of the other key combinations appeared to behave as normal (such as <code>%h</code>, when pressed, would activate the &quot;Home&quot; tab in the ribbon).  Are there any other background processes in Excel that would override my macros and prevent me from being able to use the other 16 letters of the alphabet?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 25, "user_id": 7890513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537d7fc3a0a4b8ebed03b0770aa54100?s=128&d=identicon&r=PG&f=1", "display_name": "scttsmn", "link": "https://stackoverflow.com/users/7890513/scttsmn"}, "edited": false, "score": 1, "creation_date": 1492635988, "post_id": 43499867, "comment_id": 74066831, "body": "I found why I was able to do it - see the edit. And usually, many keys on the keyboard are used from Excel. If I have to use a shortcut, I use <code>Ctrl+e</code>, as far as it is somehow not taken. But you probably have a good reason to do use <code>Alt+a</code>, I suppose."}, {"owner": {"reputation": 25, "user_id": 7890513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537d7fc3a0a4b8ebed03b0770aa54100?s=128&d=identicon&r=PG&f=1", "display_name": "scttsmn", "link": "https://stackoverflow.com/users/7890513/scttsmn"}, "edited": false, "score": 1, "creation_date": 1492692203, "post_id": 43499867, "comment_id": 74092871, "body": "With this edit, the hotkey now works like a charm.  I should be able to make this work for my own purposes in the short term.  However, in the long term, do you foresee any solution that does not involve hiding the ribbon?  If at some point in the future, I wanted to share this macro, i would not want to have to require the user(s) to hide their ribbon."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 25, "user_id": 7890513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537d7fc3a0a4b8ebed03b0770aa54100?s=128&d=identicon&r=PG&f=1", "display_name": "scttsmn", "link": "https://stackoverflow.com/users/7890513/scttsmn"}, "edited": false, "score": 0, "creation_date": 1492695490, "post_id": 43499867, "comment_id": 74095657, "body": "Theoretically if there is a solution, not involving hiding the ribbon, it would be probably too difficult and would involive registry changes. That&#39;s too much of a price for a shortcut, I think."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1492635883, "last_edit_date": 1492635883, "creation_date": 1492615240, "answer_id": 43499867, "question_id": 43499447, "link": "https://stackoverflow.com/questions/43499447/application-onkey-error-with-a-keystroke/43499867#43499867", "title": "Application.OnKey error with &quot;%a&quot; keystroke", "body": "<p>This works for me:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Application.OnKey \"^a\", \"Macro1\"\n    Application.OnKey \"^%a\", \"Macro2\"\n    Application.OnKey \"%a\", \"Macro3\"\n\n    Application.ExecuteExcel4Macro \"SHOW.TOOLBAR(\"\"Ribbon\"\",false)\"\n\nEnd Sub\n\nPublic Sub Macro1()\n\n    Debug.Print \"Pryc\"\n\nEnd Sub\n\nPublic Sub Macro2()\n\n    Debug.Print \"Pryc2\"\n\nEnd Sub\n\nPublic Sub Macro3()\n\n    Debug.Print \"Pryc3\"\n\nEnd Sub\n\nPublic Sub UnTestMe() 'Run this to disable the shortcuts.\n\n    Application.OnKey \"^a\"\n    Application.OnKey \"^%a\"\n    Application.OnKey \"%a\"\n\n    Application.ExecuteExcel4Macro \"SHOW.TOOLBAR(\"\"Ribbon\"\",true)\"\n\nEnd Sub\n</code></pre>\n\n<p>Edit:\nTo make sure works, you should hide the ribbon. Otherwise, it finds something on the ribbon, which is with <code>A</code> and uses it as a screenshot. </p>\n\n<p>Try this to hide the ribbon:\n<code>Application.ExecuteExcel4Macro \"SHOW.TOOLBAR(\"\"Ribbon\"\",false)\"</code></p>\n\n<p>Try this to return it:\n<code>Application.ExecuteExcel4Macro \"SHOW.TOOLBAR(\"\"Ribbon\"\",true)\"</code></p>\n"}], "owner": {"reputation": 25, "user_id": 7890513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/537d7fc3a0a4b8ebed03b0770aa54100?s=128&d=identicon&r=PG&f=1", "display_name": "scttsmn", "link": "https://stackoverflow.com/users/7890513/scttsmn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 43499867, "answer_count": 1, "score": 2, "last_activity_date": 1492635883, "creation_date": 1492614134, "last_edit_date": 1531164843, "question_id": 43499447, "link": "https://stackoverflow.com/questions/43499447/application-onkey-error-with-a-keystroke", "title": "Application.OnKey error with &quot;%a&quot; keystroke", "body": "<p>I have the following code in the 'ThisWorkbook' object:</p>\n\n<pre><code>Sub Workbook_Open()\n    Application.OnKey \"^a\", \"SS_1\"\n    Application.OnKey \"^%a\", \"SS_1\"\n    Application.OnKey \"%a\", \"SS_1\"\nEnd Sub\n</code></pre>\n\n<p>In a seperate module, I have the following code:</p>\n\n<pre><code>Sub SS_1()\nMsgBox \"Hello\"\nEnd Sub\n</code></pre>\n\n<p>Both the <code>\"^a\"</code> and the <code>\"^%a\"</code> keystrokes execute the <code>SS_1</code> sub perfectly, and the MsgBox appears.</p>\n\n<p>However, the <code>\"%a\"</code> keystroke appears to do nothing, and no message box gets displayed.</p>\n\n<p>Are there any unique factors that I am unaware of that would cause this keystroke to operate differently than the other keystrokes?</p>\n\n<p>Thank you in advance for your help,</p>\n\n<p>Scott</p>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1492614222, "post_id": 43499400, "comment_id": 74053176, "body": "Using sql insert commands to populate excel sheets strikes me as a bad plan."}, {"owner": {"reputation": 1, "user_id": 4839761, "user_type": "registered", "profile_image": "https://graph.facebook.com/840823272631512/picture?type=large", "display_name": "Deniz Acaro\u011flu", "link": "https://stackoverflow.com/users/4839761/deniz-acaro%c4%9flu"}, "reply_to_user": {"reputation": 20094, "user_id": 1832636, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/03182c8b98caa6f9af95e4f4afd7c018?s=128&d=identicon&r=PG", "display_name": "Dan Bracuk", "link": "https://stackoverflow.com/users/1832636/dan-bracuk"}, "edited": false, "score": 0, "creation_date": 1492634344, "post_id": 43499400, "comment_id": 74065958, "body": "i got rusty in coding and i wanted to make some stock control system normally i am gonna make that on java after couple months :)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 4839761, "user_type": "registered", "profile_image": "https://graph.facebook.com/840823272631512/picture?type=large", "display_name": "Deniz Acaro\u011flu", "link": "https://stackoverflow.com/users/4839761/deniz-acaro%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1492635071, "post_id": 43499661, "comment_id": 74066375, "body": "There should likely be a space between <code>... columns(4))</code> and <code>VALUES (...</code>. I&#39;ve added one in above. Actually, I don&#39;t believe that <code>columns(1),columns(2),columns(3),columns(4)</code> requires wrapping brackets either but I&#39;m not 100% sure that they do any damage."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1492634954, "last_edit_date": 1492634954, "creation_date": 1492614747, "answer_id": 43499661, "question_id": 43499400, "link": "https://stackoverflow.com/questions/43499400/adodb-insert-into-another-sheet/43499661#43499661", "title": "ADODB Insert into another sheet", "body": "<p>I'm guessing that <em>Urun_barkodu, Urun_kodu, Urun_adi</em> and <em>Urun_kategori</em> are string vars. You need to concatenate them into the string.</p>\n\n<pre><code>add_data = \"INSERT INTO [\u00fcr\u00fcnler$] (columns(1),columns(2),columns(3),columns(4)) \"\nadd_data = add_data &amp; \"VALUES ('\" &amp; Urun_barkodu &amp; \"', '\" &amp; Urun_kodu&amp; \"', '\" &amp; Urun_adi &amp; \"', '\" &amp; Urun_kategori &amp; \"');\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4839761, "user_type": "registered", "profile_image": "https://graph.facebook.com/840823272631512/picture?type=large", "display_name": "Deniz Acaro\u011flu", "link": "https://stackoverflow.com/users/4839761/deniz-acaro%c4%9flu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 542, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492634954, "creation_date": 1492614029, "last_edit_date": 1492616898, "question_id": 43499400, "link": "https://stackoverflow.com/questions/43499400/adodb-insert-into-another-sheet", "title": "ADODB Insert into another sheet", "body": "<p>I am trying to create a record on another excel sheet with SQL insert command I am able to select with query but I don't know exactly how to insert a record my code is:</p>\n\n<pre><code>Function database_add(Urun_barkodu, Urun_kodu, Urun_adi, Urun_kategori) As String\n\n  Dim cn As Object, rs As Object, output As String, sql As String, Insert As String\n  Dim add_data As String\n  Dim rst As ADODB.Recordset\n  '---Connecting to the Data Source---\n  Set cn = CreateObject(\"ADODB.Connection\")\n  Set rst = New ADODB.Recordset\n  With cn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=\" &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Name &amp; \";\" &amp; _\n    \"Extended Properties=\"\"Excel 12.0 Xml;HDR=YES\"\";\"\n    .Open\n  End With\n  add_data = \"INSERT INTO [\u00fcr\u00fcnler$] (columns(1),columns(2),columns(3),columns(4))\"\n  add_data = add_data &amp; \"VALUES (Urun_barkodu, Urun_kodu, Urun_adi, Urun_kategori)\"\n  cn.Close\n  cn.Open\n  rst.Open add_data, cn, dOpenStatic, adLockReadOnly, adCmdText\n  '---Clean up---\n  rs.Close\n  cn.Close\n  Set cn = Nothing\n  Set rs = Nothing\nEnd Function\n</code></pre>\n\n<p>It gives me an error like:</p>\n\n<blockquote>\n  <p>syntax error in INSERT INTO STATEMENT</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492612938, "post_id": 43498918, "comment_id": 74052166, "body": "where are you trying to set a <code>Named Range</code> ? what line ? what variable you intended to use for the <code>Named Range</code> ?"}, {"owner": {"reputation": 13, "user_id": 7379665, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/6581fc888e4b46f81747126b3aa623cd?s=128&d=identicon&r=PG&f=1", "display_name": "bloodmilksky", "link": "https://stackoverflow.com/users/7379665/bloodmilksky"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492613282, "post_id": 43498918, "comment_id": 74052440, "body": "I believe it is                                                                  Application.ScreenUpdating = False data = Sheets(&quot;Report&quot;).Range(&quot;A2:E&quot; &amp; Report.Cells(Report.Rows.Count, &quot;A&quot;).End(xlUp).Row).Value2   Set dic = CreateObject(&quot;scripting.dictionary&quot;)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1492614068, "post_id": 43498918, "comment_id": 74053069, "body": "Which line specifically? You&#39;ve given <i>three</i> lines, but the error can only raise on one of them. I suspect it&#39;s the call to <code>Report.Rows</code>, unless <code>Report</code> object is globally-scoped and instantiated in another routine. See my answer below."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 2, "last_activity_date": 1506010578, "last_edit_date": 1506010578, "creation_date": 1492613827, "answer_id": 43499321, "question_id": 43498918, "link": "https://stackoverflow.com/questions/43498918/vba-macro-for-naming-ranges/43499321#43499321", "title": "VBA Macro For Naming Ranges", "body": "<p>In your code, you're referring to a non-instantiated variable <code>Report</code>. Since this variable hasn't been declared with a <code>Dim</code> statement, it will be treated as an empty variant, zero-length string, or 0-value numeric, or a <code>Nothing</code> object, depending on how/when you call upon it. </p>\n\n<p>And since you're doing <code>Report.__something__</code> the compiler assumes it's supposed to be an <code>Object</code> (since only <code>Object</code> type have properties/methods). Since it doesn't exist and/or hasn't been assigned, you're doing essentially: <code>Nothing.Cells...</code></p>\n\n<p>This will always raise a 424 because in order to invoke <em>any</em> <code>.__something__</code> call, you need to invoke it against a valid, existing <code>Object</code>.</p>\n\n<p>Change:</p>\n\n<pre><code>data = Sheets(\"Report\").Range(\"A2:E\" &amp; Report.Cells(Report.Rows.Count, \"A\").End(xlUp).Row).Value2\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>With Sheets(\"Report\")\n    data = .Range(\"A2:E\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).Value2\nEnd With\n</code></pre>\n\n<p>As always, using <code>Option Explicit</code> in each module will prevent you from executing/running code with undeclared variables. I would recommend adding that statement at the top of each code module, and then rectifying any compile errors (such as <code>Variable undefined</code>) which might arise.</p>\n\n<p>Also: See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">here</a> for more reliable ways of finding the \"last\" cell in a given range.</p>\n\n<p>And <a href=\"https://stackoverflow.com/questions/25094267/are-there-any-advantages-of-using-option-explicit-off-in-visual-basic-net\">here</a> is a VB.NET (similar conceptually) explanation of why you should be using <code>Option Explicit</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 7379665, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/6581fc888e4b46f81747126b3aa623cd?s=128&d=identicon&r=PG&f=1", "display_name": "bloodmilksky", "link": "https://stackoverflow.com/users/7379665/bloodmilksky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506010578, "creation_date": 1492612816, "last_edit_date": 1531164843, "question_id": 43498918, "link": "https://stackoverflow.com/questions/43498918/vba-macro-for-naming-ranges", "title": "VBA Macro For Naming Ranges", "body": "<p>I am trying to use the below to run through values in Column A on a Sheet Named \"Report\" and Create these ranges in a Sheet called \"Holidays_Requested\" but everytime I it pops up with </p>\n\n<blockquote>\n  <p>Object Required Runtime error 424. </p>\n</blockquote>\n\n<p>Can anyone help or know of an alternative way of creating named ranges using VBA. </p>\n\n<pre><code>Sub TransposeRange_new_code()\n    Dim OutRange As Range\n    Dim x As Long, y As Long\n    Dim sKey As String\n    Dim maxCount As Long\n    Dim data, dic, keys, items, dataout()\n\n\n    Application.ScreenUpdating = False\n    data = Sheets(\"Report\").Range(\"A2:E\" &amp; Report.Cells(Report.Rows.Count, \"A\").End(xlUp).Row).Value2\n\n\n    Set dic = CreateObject(\"scripting.dictionary\")\n    Set OutRange = Sheets(\"Holidays_Requested\").Range(\"B2\")\n\n\n    For x = 1 To UBound(data, 1)\n        If Trim$(data(x, 1)) &lt;&gt; \"_\" Then\n        sKey = Trim$(data(x, 1)) &amp; Chr(0) &amp; Trim$(data(x, 2))\n        If Not dic.exists(sKey) Then dic.Add sKey, CreateObject(\"Scripting.Dictionary\")\n        dic(sKey).Add x, Array(data(x, 4), data(x, 5))\n        If dic(sKey).Count &gt; maxCount Then maxCount = dic(sKey).Count\n        End If\n    Next\n\n\n    ReDim dataout(1 To maxCount + 1, 1 To dic.Count * 3)\n    keys = dic.keys\n    items = dic.items\n    For x = LBound(keys) To UBound(keys)\n        dataout(1, x * 3 + 1) = Split(keys(x), Chr(0))(0)\n        dataout(1, x * 3 + 2) = Split(keys(x), Chr(0))(1)\n        For y = 1 To items(x).Count\n            dataout(1 + y, x * 3 + 1) = items(x).items()(y - 1)(0)\n            dataout(1 + y, x * 3 + 2) = items(x).items()(y - 1)(1)\n        Next y\n    Next\n\n\n\n\n    OutRange.Resize(UBound(dataout, 1), UBound(dataout, 2)).Value2 = dataout\n\n\n    For x = 1 To UBound(keys)\n        OutRange.Offset(0, (x - 1) * 3).Resize(maxCount, 2).Name = \"\" &amp; validName(Split(keys(x - 1), Chr(0))(0))\n        With OutRange.Offset(0, (x - 1) * 3 + 1)\n            .Hyperlinks.Add anchor:=.Cells(1), Address:=\"mailto://\" &amp; .Value2, TextToDisplay:=.Value2\n        End With\n    Next\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "excel", "vba", "ribbon"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492612321, "post_id": 43498658, "comment_id": 74051667, "body": "Why are you escaping the forward slashes in the third format mask?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1492612513, "post_id": 43498658, "comment_id": 74051807, "body": "What happens if you add <code>index = -1</code> just before exiting dtFormat? (apologies for asking what appears to be a rudimentary question but it takes quite a bit of time to set up a &#39;test bench&#39; for a custom ribbon so testing is prohibitive)."}, {"owner": {"reputation": 891, "user_id": 2672634, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/03b9819527625d5198e71248e7590cbe?s=128&d=identicon&r=PG", "display_name": "Jason Samuels", "link": "https://stackoverflow.com/users/2672634/jason-samuels"}, "edited": false, "score": 0, "creation_date": 1492671738, "post_id": 43498658, "comment_id": 74078610, "body": "The escaping of forward slashes is how excel works when formatting a cell to dd/mmm/yyyy.  <code>index = -1</code> does nothing different."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1492696814, "post_id": 43498658, "comment_id": 74096757, "body": "Really?!? That isn&#39;t how my excel ever worked but good to know when attempting debug on someone else&#39;s system."}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 0, "creation_date": 1492759662, "post_id": 43498658, "comment_id": 74125086, "body": "That&#39;s how the dropdown works. Add a button to trigger the numberformat change instead, using the value in the dropdown."}], "owner": {"reputation": 891, "user_id": 2672634, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/03b9819527625d5198e71248e7590cbe?s=128&d=identicon&r=PG", "display_name": "Jason Samuels", "link": "https://stackoverflow.com/users/2672634/jason-samuels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 943, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1492634900, "creation_date": 1492612188, "last_edit_date": 1492634900, "question_id": 43498658, "link": "https://stackoverflow.com/questions/43498658/excel-ribbon-dropdown", "title": "Excel Ribbon Dropdown", "body": "<p>I have an Excel add-in that adds a tab to my ribbon with XML. </p>\n\n<p>The tab has a dropdown with three options. When I choose an option different to the current value, then the macro runs fine, but when I click on the dropdown and the value stays the same, the macro doesn't run. </p>\n\n<p>The macro updates the format of the selected cells. How can I run a macro when I click on the dropwdown, even if the value stays the same. Here is my xml and vb code:</p>\n\n<p>XML:</p>\n\n<pre><code>&lt;group id=\"pvt\" label=\"Formatting\"&gt;       \n  &lt;dropDown id=\"ddItem\" label=\"Date Format\" onAction=\"dtFormat\"&gt;\n  &lt;item id=\"Item1\" label=\"dd-mmm-yyyy\"/&gt;\n  &lt;item id=\"Item2\" label=\"dd-mmm-yy\"/&gt;\n  &lt;item id=\"Item3\" label=\"dd/mmm/yyyy\"/&gt;\n  &lt;/dropDown&gt;\n&lt;/group &gt;\n</code></pre>\n\n<p>VB.NET:</p>\n\n<pre><code>Public Sub dtFormat(control As IRibbonControl, ID As String, index As Integer)\n    If index = 0 Then\n        Selection.NumberFormat = \"dd-mmm-yyyy\"\n    ElseIf index = 1 Then\n        Selection.NumberFormat = \"dd-mmm-yy\"\n    ElseIf index = 2 Then\n        Selection.NumberFormat = \"dd\\/mmm\\/yyyy\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vba", "outlook", "vsto", "outlook-addin"], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 3609107, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100000140665524/picture?type=large", "display_name": "Laureant", "link": "https://stackoverflow.com/users/3609107/laureant"}, "edited": false, "score": 0, "creation_date": 1495446854, "post_id": 43504721, "comment_id": 75239003, "body": "Thank you for the reply! I like this coloring of the appointments in the Calendar view. Is there a way to color tasks in the Task List view? Or show the category color, without actually assigning categories? I want to visually distinguish between completed &amp; incomplete tasks, as well as tasks that are in progress"}, {"owner": {"reputation": 859, "user_id": 3609107, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100000140665524/picture?type=large", "display_name": "Laureant", "link": "https://stackoverflow.com/users/3609107/laureant"}, "edited": false, "score": 0, "creation_date": 1495452753, "post_id": 43504721, "comment_id": 75242757, "body": "Also, when I color an appointment item this way, and I open it in an inspector, I get the following message displayed on the top: &#39;No Categories (colored by old &quot;Personal&quot; label)&#39; or something similar. Any ways to get rid of that message? It looks like Outlook is not completely supporting this coloring anymore."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 859, "user_id": 3609107, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100000140665524/picture?type=large", "display_name": "Laureant", "link": "https://stackoverflow.com/users/3609107/laureant"}, "edited": false, "score": 0, "creation_date": 1495469310, "post_id": 43504721, "comment_id": 75254214, "body": "Yes, Outlook now uses categories instead of the color - when a category is created, it is associated with the color."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1492630884, "creation_date": 1492630884, "answer_id": 43504721, "question_id": 43498588, "link": "https://stackoverflow.com/questions/43498588/outlook-appointment-mouse-hover-screentip-customization-via-vsto-add-in/43504721#43504721", "title": "Outlook Appointment mouse hover screentip customization via VSTO add-in", "body": "<p>There is no way to customize the popup hint.</p>\n\n<p>To change the appointment color, you can set the named property with the DASL name <code>http://schemas.microsoft.com/mapi/id/{00062002-0000-0000-C000-000000000046}/82140003</code> (you can set it using <code>AppointmentItem.PropertyAccessor.SetProperty</code>). The valid values are </p>\n\n<pre><code>0x00000000 None\n0x00000001 Red\n0x00000002 Blue\n0x00000003 Green\n0x00000004 Grey\n0x00000005 Orange\n0x00000006 Cyan\n0x00000007 Olive\n0x00000008 Purple\n0x00000009 Teal\n0x0000000A Yellow\n</code></pre>\n"}], "owner": {"reputation": 859, "user_id": 3609107, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100000140665524/picture?type=large", "display_name": "Laureant", "link": "https://stackoverflow.com/users/3609107/laureant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 2, "accepted_answer_id": 43504721, "answer_count": 1, "score": 1, "last_activity_date": 1593042379, "creation_date": 1492612019, "last_edit_date": 1593042379, "question_id": 43498588, "link": "https://stackoverflow.com/questions/43498588/outlook-appointment-mouse-hover-screentip-customization-via-vsto-add-in", "title": "Outlook Appointment mouse hover screentip customization via VSTO add-in", "body": "<p>Whenever you're in a calendar in Outlook, and you hover your mouse over an appointment it shows a little screentip (like in the picture below)</p>\n\n<p>Is there a way to customize the look of this screentip? I would like to add a status field to it, which is linked to a custom UserProperty field so the user doesn't have to double-click the appointment and see it in an inspector.</p>\n\n<p><a href=\"https://i.stack.imgur.com/j48Mt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j48Mt.png\" alt=\"enter image description here\"></a></p>\n\n<p>Also: is there a way, to color or customize the actual appointment 'bars' in the calendar? I'm not talking about categories. I would like to mark them based on a custom UserProperty. Coloring, or adding a custom icon / flag?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1492611678, "post_id": 43498378, "comment_id": 74051085, "body": "<code>If Target.Count &gt;1 then Exit Sub</code>"}, {"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1492611857, "post_id": 43498378, "comment_id": 74051261, "body": "Thank you! Problem Solved!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1492612003, "post_id": 43498378, "comment_id": 74051380, "body": "Also, <code>Range(Target.Offset(, -1), Target.Offset(, -2)).ClearContents</code> can be <code>Target.Offset(, -2).Resize(1, 2).ClearContents</code>"}], "answers": [{"comments": [{"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1492613974, "post_id": 43498570, "comment_id": 74052983, "body": "Cleaned out the excess code, hopefully this asnwers a bit better what the change was."}], "tags": [], "owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "is_accepted": true, "score": 1, "last_activity_date": 1492613710, "last_edit_date": 1492613710, "creation_date": 1492611980, "answer_id": 43498570, "question_id": 43498378, "link": "https://stackoverflow.com/questions/43498378/selection-change-affecting-cells-outside-of-range/43498570#43498570", "title": "Selection Change affecting cells outside of range", "body": "<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Const Col As Long = 2\n\n    If Target.Count &gt; 1 Then\n    Exit Sub\n    End If\n</code></pre>\n\n<p>Added this to the top of the code, it will now exit the Sub if more than one cell is selected even if one of the selected cells are within the appropriate range.</p>\n"}, {"comments": [{"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1492613937, "post_id": 43499040, "comment_id": 74052959, "body": "I like how it assigns the appropriate value even if I select two cells in separate ranges. However, for some reason the cells are not clearing the contents properly when I tried using it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 1, "creation_date": 1492614007, "post_id": 43499040, "comment_id": 74053014, "body": "I thought about that; You may want to reverse the sequence with N7:N98 first and L7:L98 last. In other words, the cells are clearting but they are being filled in after they are cleared. You could also change the latter two conditions to ElseIf so only one would be processed instead of all three."}, {"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1492616056, "post_id": 43499040, "comment_id": 74054472, "body": "I tried swapping the order and it doesn&#39;t seem to work either. How would you implement an Else If?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1492616271, "post_id": 43499040, "comment_id": 74054623, "body": "See above. You really should have been able to research/figure out this on your own."}, {"owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "edited": false, "score": 0, "creation_date": 1492616658, "post_id": 43499040, "comment_id": 74054895, "body": "Fair enough, I shant bother you further. I did digure out why the cells were not clearing properly. As the code stands, it is deleting 2 cells to the right of the selection. The objective was to clear the other results. The last two &quot;ClearContents&quot; strings needed to be adjusted accordingly."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1492616244, "last_edit_date": 1492616244, "creation_date": 1492613108, "answer_id": 43499040, "question_id": 43498378, "link": "https://stackoverflow.com/questions/43498378/selection-change-affecting-cells-outside-of-range/43499040#43499040", "title": "Selection Change affecting cells outside of range", "body": "<p>After checking to see if the Selection intersects with the various ranges, only deal with the part of Target that intersects with the various ranges.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Const Col As Long = 2\n\n    If Not Intersect(Target, Range(\"L7:L98\")) Is Nothing Then\n        Application.EnableEvents = False\n        With Intersect(Target, Range(\"L7:L98\"))\n            .Value = \"T\"\n            .Offset(, 1).Resize(, Col).ClearContents\n        End With\n    End If\n    If Not Intersect(Target, Range(\"M7:M98\")) Is Nothing Then\n        Application.EnableEvents = False\n        With Intersect(Target, Range(\"M7:M98\"))\n            .Value = \"I\"\n            .Offset(, 1).Resize(, Col).ClearContents\n        End With\n    End If\n    If Not Intersect(Target, Range(\"N7:N98\")) Is Nothing Then\n        Application.EnableEvents = False\n        With Intersect(Target, Range(\"N7:N98\"))\n            .Value = \"D\"\n            .Offset(, 1).Resize(, Col).ClearContents\n        End With\n    End If\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Optional Alternative:</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Const Col As Long = 2\n\n    If Not Intersect(Target, Range(\"L7:L98\")) Is Nothing Then\n        Application.EnableEvents = False\n        With Intersect(Target, Range(\"L7:L98\"))\n            .Value = \"T\"\n            .Offset(, 1).Resize(, Col).ClearContents\n        End With\n    ElseIf Not Intersect(Target, Range(\"M7:M98\")) Is Nothing Then\n        Application.EnableEvents = False\n        With Intersect(Target, Range(\"M7:M98\"))\n            .Value = \"I\"\n            .Offset(, 1).Resize(, Col).ClearContents\n        End With\n    ElseIf Not Intersect(Target, Range(\"N7:N98\")) Is Nothing Then\n        Application.EnableEvents = False\n        With Intersect(Target, Range(\"N7:N98\"))\n            .Value = \"D\"\n            .Offset(, 1).Resize(, Col).ClearContents\n        End With\n    End If\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 174, "user_id": 7799504, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/79bee3a579490c7ad1d2b8c432b6dcc7?s=128&d=identicon&r=PG&f=1", "display_name": "Thelnternet", "link": "https://stackoverflow.com/users/7799504/thelnternet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 43498570, "answer_count": 2, "score": 1, "last_activity_date": 1492616244, "creation_date": 1492611511, "last_edit_date": 1531161705, "question_id": 43498378, "link": "https://stackoverflow.com/questions/43498378/selection-change-affecting-cells-outside-of-range", "title": "Selection Change affecting cells outside of range", "body": "<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Const Col As Long = 2\n\n    If Not Intersect(Target, Range(\"L7:L98\")) Is Nothing Then\n        Application.EnableEvents = False\n        Target.Value = \"T\"\n        Target.Offset(, 1).Resize(, Col).ClearContents\n        Application.EnableEvents = True\n    End If\n\n    If Not Intersect(Target, Range(\"M7:M98\")) Is Nothing Then\n        Application.EnableEvents = False\n        Target.Value = \"I\"\n        Target.Offset(, 1).ClearContents\n        Target.Offset(, -1).ClearContents\n        Application.EnableEvents = True\n    End If\n\n    If Not Intersect(Target, Range(\"N7:N98\")) Is Nothing Then\n        Application.EnableEvents = False\n        Target.Value = \"D\"\n        Range(Target.Offset(, -1), Target.Offset(, -2)).ClearContents\n        Application.EnableEvents = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This code is causing a slight problem for me. Any time I select an entire row within the ranges, every cell within the range gets changed to \"T\". Given the consistency of the code, if I delete the string with \"T\", then the entire row would be filled with \"I\"</p>\n\n<p>What can be adjusted to trigger <strong>only</strong> if cells within the range are selected?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1492612198, "creation_date": 1492612198, "answer_id": 43498663, "question_id": 43498271, "link": "https://stackoverflow.com/questions/43498271/excel-vba-copying-specific-worksheets-from-multiple-workbooks-in-different-loca/43498663#43498663", "title": "Excel VBA; copying specific worksheets from multiple workbooks in different locations", "body": "<p>From what I can see, you simply want to keep reopening the GetOpenFile dialog until the user cancels out (i.e. doesn't want to bring anymore files in).</p>\n\n<pre><code>Option Explicit\n\nSub AlphaTest()\n\n    Dim FName As Variant\n    'bunch of code here\n\n    FName = Application.GetOpenFilename(filefilter:=\"Excel Files (*.xl*), *.xl*\", _\n                                    MultiSelect:=True)\n    Do While FName &lt;&gt; \"False\"\n\n        If IsArray(FName) Then\n            'lots of code here\n        End If\n\n        FName = Application.GetOpenFilename(filefilter:=\"Excel Files (*.xl*), *.xl*\", _\n                                        MultiSelect:=True)\n    Loop\n\nExitTheSub:\n    'bunch of code here\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6527621, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-45oXprpKP-I/AAAAAAAAAAI/AAAAAAAAXnc/DXQYWHqwh1c/photo.jpg?sz=128", "display_name": "Shaw McAllan", "link": "https://stackoverflow.com/users/6527621/shaw-mcallan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492612198, "creation_date": 1492611245, "last_edit_date": 1492611591, "question_id": 43498271, "link": "https://stackoverflow.com/questions/43498271/excel-vba-copying-specific-worksheets-from-multiple-workbooks-in-different-loca", "title": "Excel VBA; copying specific worksheets from multiple workbooks in different locations", "body": "<p>I can copy a sheet named \"Alpha\" from 6 separate workbooks in the one directory, but I'm not sure how to get the code to loop around to pick up sheets in other files &amp; locations with slightly different names.</p>\n\n<p>I thought I could use :</p>\n\n<p>IF sheetname LIKE \"<em>Alpha</em>\" then\n sheetToCopy = make this the name of the sheet I want to copy\nEND IF</p>\n\n<p>It doesn't pass the name of the sheet onto the variable though.  I think it's because I'm already looping through an array, using file names &amp; numbers.</p>\n\n<p>The code below works perfectly for the 6 Alpha sheets, but it won't pick up \"Y Alpha\" or \"Alpha XZ\".</p>\n\n<p>Any help would be very much appreciated!</p>\n\n<p>I use the following code:</p>\n\n<pre><code>    Sub AlphaTest()\n    Dim MyPath As String\n    Dim SourceRcount As Long, FNum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n    Dim SaveDriveDir As String\n    Dim FName As Variant\n    Dim FirstCell As String\n    Dim sName As String\n\n\n    ' Set application properties.\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    SaveDriveDir = CurDir\n    ' Change this to the path\\folder location of the files.\n    ChDirNet \"Z:\\\"\n\n    FName = Application.GetOpenFilename(filefilter:=\"Excel Files (*.xl*), *.xl*\", _\n                                        MultiSelect:=True)\n    If IsArray(FName) Then\n\n        ' Add a new workbook with one sheet.\n        Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n        rnum = 1\n\n\n        ' Loop through all files in the myFiles array.\n        For FNum = LBound(FName) To UBound(FName)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(FName(FNum), ReadOnly:=True)\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n                On Error Resume Next\n\n            'If ActiveWorkbook.Worksheets.Name Like \"*Debtors*\" Then\n            '    sName = ActiveWorkbook.Worksheets.Name\n            'Else\n            '    sName = \"0\"\n            'End If\n\n                With mybook.Worksheets(\"Alpha\")\n                    FirstCell = \"A6\"\n                    Set sourceRange = .Range(FirstCell &amp; \":\" &amp; RDB_Last(3, .Cells))\n                    ' Test if the row of the last cell is equal to or greater than the row of the first cell.\n                    If RDB_Last(1, .Cells) &lt; .Range(FirstCell).Row Then\n                        Set sourceRange = Nothing\n                    End If\n                End With\n\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    ' If the source range uses all columns then\n                    ' skip this file.\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"There are not enough rows in the target worksheet.\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        ' Copy the file name in column A.\n                        With sourceRange\n                            BaseWks.Cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = FName(FNum)\n                        End With\n\n                        ' Set the destination range.\n                        Set destrange = BaseWks.Range(\"C\" &amp; rnum)\n\n                        ' Copy the values from the source range\n                        ' to the destination range.\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n                        rnum = rnum + SourceRcount + 1\n                    End If\n                End If\n                mybook.Close savechanges:=False\n            End If\n\n        Next FNum\n        BaseWks.Columns.AutoFit\n    End If\n\nExitTheSub:\n    ' Restore the application properties.\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n    ChDirNet SaveDriveDir\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "hp-uft"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1492612574, "post_id": 43498197, "comment_id": 74051857, "body": "I think you may want to read <a href=\"http://stackoverflow.com/documentation/vba/1179/procedure-calls/3818/this-is-confusing-why-not-just-always-use-parentheses#t=201704191432562970515\">this</a>. And then declare <code>url</code> as <code>ByVal url As String</code> so the function can only take a <code>String</code>. Right now we don&#39;t know for sure whether the <code>Navigate</code> call is failing because you&#39;re giving it something it can&#39;t handle - an explicit <code>String</code> parameter would make things less ambiguous. Seems UFT can&#39;t handle <code>CreateObject</code> calls?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1492612836, "post_id": 43498197, "comment_id": 74052088, "body": "I never used UFT, but by any programming standards you should be declaring your variables (and specify <code>Option Explicit</code> at the top of every module), and <code>app</code> is a dependency of that <code>openWindow</code> function, which is really just a procedure because it&#39;s not returning anything. So instead of creating your own dependencies you should inject it as an argument, and the automated test should be providing a fake/mock implementation of whatever interface your method needs to work with. <a href=\"https://rubberduckvba.wordpress.com/2017/03/17/go-ahead-mock-vba/\" rel=\"nofollow noreferrer\">This might interest you</a>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1492613201, "post_id": 43498197, "comment_id": 74052379, "body": "Also your function is recursive, and will invariably blow up the call stack given any invalid <code>url</code>, or if <i>anything</i> goes wrong."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1492688468, "post_id": 43498197, "comment_id": 74090093, "body": "UFT can handle <code>CreateObject</code> calls just fine, but it uses <code>vbscript</code> so you can&#39;t explicitly declare <code>url As String</code>.  I&#39;ve tried the code above in UFT and it works fine for me...?"}], "answers": [{"tags": [], "owner": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "is_accepted": true, "score": 0, "last_activity_date": 1493037713, "creation_date": 1493037713, "answer_id": 43588375, "question_id": 43498197, "link": "https://stackoverflow.com/questions/43498197/vba-code-not-working-in-uft/43588375#43588375", "title": "VBA code not working in UFT", "body": "<p>I found a workaround :</p>\n\n<pre><code>Function openWindow(urlToNavigate)\n    SystemUtil.Run \"iexplore.exe\",urlToNavigate\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 537, "user_id": 4730196, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0065a640f1aafb25f4cfafcf2c6c877f?s=128&d=identicon&r=PG&f=1", "display_name": "LostReality", "link": "https://stackoverflow.com/users/4730196/lostreality"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 43588375, "answer_count": 1, "score": 0, "last_activity_date": 1493037713, "creation_date": 1492611095, "last_edit_date": 1492612352, "question_id": 43498197, "link": "https://stackoverflow.com/questions/43498197/vba-code-not-working-in-uft", "title": "VBA code not working in UFT", "body": "<p>I really need your help for an issue I am stucked on since 3 hours...\nI have a VBA code that open IE and navigate to an URL.\nThe code seems to work when I test it within Microsoft Visual Basic :</p>\n\n<pre><code>Sub test()\n    On Error Resume Next\n        Set app = CreateObject(\"InternetExplorer.Application\")\n        MsgBox \"OpenWindow 1 : \" &amp; Err.Number\n        app.Visible = True\n        app.Navigate (\"salut.com\")\n        result = Err.Number\n        MsgBox \"OpenWindow 2 : \" &amp; Err.Number\n    On Error GoTo 0\n    If result &lt;&gt; 0 Then\n        Call test\n    End If\nEnd Sub\n</code></pre>\n\n<p>This code works properly in an Excel macro but whenever I execute the exact same code in UFT (Unified Functionnal Testing) it throws errors :</p>\n\n<ul>\n<li>error -2147467261 after the createObject (?)</li>\n<li>error 238 after the navigate (which I think is quite normal since\ncreateObject fails)</li>\n</ul>\n\n<p>The code is quite the same, I just pass the URL to navigate to to the function :</p>\n\n<pre><code>Function openWindow(url)\n    On error resume next\n        Set app = CreateObject(\"InternetExplorer.Application\")\n        app.Visible = true\n        app.Navigate(url)\n        result =  Err.number\n    On error goto 0\n    If result &lt;&gt; 0 Then\n        openWindow (url)\n    End If\nEnd Function\n</code></pre>\n\n<p>I really have no idea of what the issue is...</p>\n"}, {"tags": ["html", "ms-access", "vba"], "comments": [{"owner": {"reputation": 346, "user_id": 6524338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sje7.png?s=128&g=1", "display_name": "billyhoes", "link": "https://stackoverflow.com/users/6524338/billyhoes"}, "edited": false, "score": 1, "creation_date": 1492614284, "post_id": 43498065, "comment_id": 74053217, "body": "Are you perhaps missing a &quot;str_text &amp;&quot; in your str_text = &quot;&lt;img src=cid:&quot; &amp; Replace(mypicture2, &quot; &quot;, &quot;%20&quot;) &amp; &quot; height=240 width=180&gt;&quot; statement? (e.g.,  str_text = str_text &amp; &quot;&lt;img src=cid:&quot; &amp; Replace(mypicture2, &quot; &quot;, &quot;%20&quot;) &amp; &quot; height=240 width=180&gt;&quot;)"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 346, "user_id": 6524338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sje7.png?s=128&g=1", "display_name": "billyhoes", "link": "https://stackoverflow.com/users/6524338/billyhoes"}, "edited": false, "score": 0, "creation_date": 1492629980, "post_id": 43498065, "comment_id": 74063346, "body": "@billyhoes: Note that you can use <code>backticks</code> in comments too to make code readable. -- But yes, that would seem to be the problem, <code>str_text</code> is always overwritten from scratch. I suggest posting it as answer."}, {"owner": {"reputation": 1, "user_id": 7890208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154758096960892/picture?type=large", "display_name": "Paul", "link": "https://stackoverflow.com/users/7890208/paul"}, "edited": false, "score": 0, "creation_date": 1492815950, "post_id": 43498065, "comment_id": 74158741, "body": "Similar error in style, line should read; str_text = str_text &amp; &quot;&lt;p class=&#39;footer&#39;&gt;This is footer text size 8 Calibri&lt;/p&gt;&quot;  all working now! Thanks guys"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7890208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154758096960892/picture?type=large", "display_name": "Paul", "link": "https://stackoverflow.com/users/7890208/paul"}, "edited": false, "score": 0, "creation_date": 1492757063, "post_id": 43530094, "comment_id": 74123482, "body": "Thank you Billy, you are quite correct, a schoolboy error which I made worst by cut-and-pasting the line four more times.  Your line is totally correct and works as I expected, thank you."}, {"owner": {"reputation": 1, "user_id": 7890208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154758096960892/picture?type=large", "display_name": "Paul", "link": "https://stackoverflow.com/users/7890208/paul"}, "edited": false, "score": 0, "creation_date": 1492757131, "post_id": 43530094, "comment_id": 74123526, "body": "The style line  &quot;p.footer {margin: 1cm; font-size: 8px; font\u2014family: &#39;Calibri&#39;; } &quot; &amp; vbCrLf &amp; _  does not work as the email text remains Times 12 but the core question is resolved.  Brilliant."}, {"owner": {"reputation": 346, "user_id": 6524338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sje7.png?s=128&g=1", "display_name": "billyhoes", "link": "https://stackoverflow.com/users/6524338/billyhoes"}, "reply_to_user": {"reputation": 1, "user_id": 7890208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154758096960892/picture?type=large", "display_name": "Paul", "link": "https://stackoverflow.com/users/7890208/paul"}, "edited": false, "score": 0, "creation_date": 1492784477, "post_id": 43530094, "comment_id": 74142252, "body": "We&#39;ve all been there. Glad I could help.  :)"}], "tags": [], "owner": {"reputation": 346, "user_id": 6524338, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8sje7.png?s=128&g=1", "display_name": "billyhoes", "link": "https://stackoverflow.com/users/6524338/billyhoes"}, "is_accepted": false, "score": 0, "last_activity_date": 1492723118, "creation_date": 1492723118, "answer_id": 43530094, "question_id": 43498065, "link": "https://stackoverflow.com/questions/43498065/embedding-multiple-images-in-outlook-2010-via-access-2010-vba/43530094#43530094", "title": "Embedding Multiple Images In Outlook 2010 via Access 2010 VBA", "body": "<p>I believe you are missing <code>str_text &amp;</code> in your <code>str_text = \"&lt;img src=cid:\" &amp; Replace(mypicture2, \" \", \"%20\") &amp; \" height=240 width=180&gt;\"</code> statement.  You are overwriting the str_text variable every time you add the image code to it.</p>\n\n<p>Statements adding images should read like below:</p>\n\n<pre><code>str_text = str_text &amp; \"&lt;img src=cid:\" &amp; Replace(mypicture1, \" \", \"%20\") &amp; \" height=240 width=180&gt;\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7890208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154758096960892/picture?type=large", "display_name": "Paul", "link": "https://stackoverflow.com/users/7890208/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594640083, "creation_date": 1492610737, "last_edit_date": 1594640083, "question_id": 43498065, "link": "https://stackoverflow.com/questions/43498065/embedding-multiple-images-in-outlook-2010-via-access-2010-vba", "title": "Embedding Multiple Images In Outlook 2010 via Access 2010 VBA", "body": "<p>Code (and solution) to be in MS Access VBA.</p>\n\n<p>I want a header and footer logo and three images within the text of my email. (This is a simplistic get-it-working code. The final will be customized for each email)</p>\n\n<p>If I uncomment any of the five commented lines the relevant image is displayed and the REST of the text shows.</p>\n\n<p>i.e. I get only one image and whatever remaining text ~ I don't get five images interspersed with text. </p>\n\n<p>The style section does not seem to work either ~ the footer remains in Times New Roman size 12 :-(</p>\n\n<p>Here is what I have so far. Uncomment any of the lines to see the problem. Ideal is to uncomment them all and see 5 images at the receiving end of the email.</p>\n\n<p>NB the five images are on my laptop (c:\\images\\ various pictures ).  I do not want a solution to point to a server location for the images, I just want to embed and send a self-contained email.</p>\n\n<pre><code>Const MyPath = \"C:\\images\\\"\nConst MyPicture1 = \"Picture1.jpg\"\nConst mypicture2 = \"Picture2.jpg\"\nConst mypicture3 = \"Picture3.jpg\"\nConst mypicture4 = \"Picture4.jpg\"\nConst mypicture5 = \"Picture5.jpg\"\n\nDim str_head, str_style, str_body, str_body_end, str_text As String\n\nWith CreateObject(\"Outlook.Application\").CreateItem(0)\n    .Attachments.Add MyPath &amp; MyPicture1\n    .Attachments.Add MyPath &amp; mypicture2\n    .Attachments.Add MyPath &amp; mypicture3\n    .Attachments.Add MyPath &amp; mypicture4\n    .Attachments.Add MyPath &amp; mypicture5\n\n    str_head = \"&lt;html&gt; &lt;head&gt; &lt;meta http-equiv='Content-?jpe' content=' text/html; charset=iso-8859-1'&gt;\"\n\n    str_style = \"&lt;style type='text/CSS'&gt;\" &amp; vbCrLf &amp; _\n                \"&lt;!--\" &amp; vbCrLf &amp; _\n                \"body { background-color: palegreen; } \" &amp; vbCrLf &amp; _\n                \"h1 { margin: 1cm; font\u2014size:14px; font\u2014family: 'Times New Roman'; } \" &amp; vbCrLf &amp; _\n                \"p.footer {margin: 1cm; font-size: 8px; font\u2014family: 'Calibri'; } \" &amp; vbCrLf &amp; _\n                \"--&gt;\" &amp; vbCrLf &amp; _\n                \"&lt;/style&gt;\"\n\n    str_body = \"&lt;/head&gt; &lt;body&gt;\"\n\n    'str_text = \"&lt;img src=cid:\" &amp; Replace(MyPicture1, \" \", \"%20\") &amp; \" height=60 width=640&gt;\"    'Header logo\n\n    str_text = str_text &amp; \"&lt;h1&gt;This is header text size 14 Times New Roman&lt;/h1&gt;\"\n\n    str_text = str_text &amp; \"&lt;p&gt;This is body text size 12 Times New Roman&lt;/p&gt;\"\n\n    'str_text = \"&lt;img src=cid:\" &amp; Replace(mypicture2, \" \", \"%20\") &amp; \" height=240 width=180&gt;\"    'In text image\n\n    str_text = str_text &amp; \"&lt;p&gt;This is more body text size 12 Times New Roman&lt;/p&gt;\"\n\n    'str_text = \"&lt;img src=cid:\" &amp; Replace(mypicture3, \" \", \"%20\") &amp; \" height=240 width=180&gt;\"    'In text image\n\n    str_text = str_text &amp; \"&lt;p&gt;This is more body text size 12 Times New Roman&lt;/p&gt;\"\n\n    'str_text = \"&lt;img src=cid:\" &amp; Replace(mypicture4, \" \", \"%20\") &amp; \" height=240 width=180&gt;\"    'In text image\n\n    str_text = str_text &amp; \"&lt;p class 'footer'&gt;This is footer text size 8 Calibri&lt;/p&gt;\"\n\n    'str_text = \"&lt;img src=cid:\" &amp; Replace(mypicture5, \" \", \"%20\") &amp; \" height=60 width=640&gt;\"       'Footer logo\n\n    str_body_end = \"&lt;/body&gt; &lt;/html&gt;\"\n\n    .HTMLBody = str_head &amp; str_style &amp; str_body &amp; str_text &amp; str_body_end\n    .Display\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1492610969, "post_id": 43497986, "comment_id": 74050523, "body": "Can&#39;t reproduce that issue. If I use your sub in a fresh workbook with a protected sheet 1 and a protected workbook (protected with an empty password) your code works, and the event is executed. Are you sure that the event isn&#39;t executed? Test it by using a break point on <code>ActiveSheet.Unprotect</code> in the debugger."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1492611301, "post_id": 43497986, "comment_id": 74050800, "body": "If &#39;the worksheet is protected&#39; the user may not be allowed to <i>select</i> (aka <i>click</i>) on a cell. If they cannot click on a cell then they cannot double-click on a cell so no trigger is launched. Have you tried this will <code>Cancel = True</code> as the <b>first</b> line? This cancels any in-cell editing that may be attempted."}, {"owner": {"reputation": 315, "user_id": 5919453, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7d51217c2b23c42385baf7e50fc72950?s=128&d=identicon&r=PG&f=1", "display_name": "Steve G.", "link": "https://stackoverflow.com/users/5919453/steve-g"}, "edited": false, "score": 0, "creation_date": 1492624490, "post_id": 43497986, "comment_id": 74060076, "body": "I tried putting a breakpoint in and putting <code>Cancel = True</code> as the first line, but neither worked. I also have the cell (and all others like it) not marked as Locked or Hidden. When I click on Review-&gt;Protect Sheet, I can see I have &quot;Select unlocked cells&quot; checked. Indeed, I can click around and even edit the contents of the cells I&#39;m trying to double-click, just not run the event."}], "answers": [{"tags": [], "owner": {"reputation": 315, "user_id": 5919453, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7d51217c2b23c42385baf7e50fc72950?s=128&d=identicon&r=PG&f=1", "display_name": "Steve G.", "link": "https://stackoverflow.com/users/5919453/steve-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1493342467, "creation_date": 1493342467, "answer_id": 43670425, "question_id": 43497986, "link": "https://stackoverflow.com/questions/43497986/excel-vba-worksheet-double-click-event-wont-run-when-worksheet-is-protected/43670425#43670425", "title": "Excel VBA: Worksheet Double-click event won&#39;t run when worksheet is protected", "body": "<p>Aha! Stupid me. The reason it wasn't running is because the cell was getting its data from a predefined list. So whenever I clicked on the cell, it would automatically enter into \"list mode\" and so wouldn't run the doubleclick event. I never got the chance to double-click since one click was enough to activate the \"list mode\"!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13517135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e1e64118b70ae5f9695b97c55301b9?s=128&d=identicon&r=PG&f=1", "display_name": "pablorobe", "link": "https://stackoverflow.com/users/13517135/pablorobe"}, "is_accepted": false, "score": 0, "last_activity_date": 1589194757, "creation_date": 1589194757, "answer_id": 61728080, "question_id": 43497986, "link": "https://stackoverflow.com/questions/43497986/excel-vba-worksheet-double-click-event-wont-run-when-worksheet-is-protected/61728080#61728080", "title": "Excel VBA: Worksheet Double-click event won&#39;t run when worksheet is protected", "body": "<p>I have had the same problem and I needed to solve it without removing the list.</p>\n\n<p>I found the way to do that:</p>\n\n<p>When protecting the sheet, if you \"allow\" the last two options (Objects and Scenarios) the list won't open when clicking the list-cell with the sheet protection activated and, therefore, it will allow the DoubleClick Event to run.</p>\n\n<p>Of course, you can program it also in vba:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nIf Not Intersect(Target, ActiveSheet.Range(\"YOUR_RANGE_HERE\")) Is Nothing Then\n    ActiveSheet.Unprotect Password:=\"YOUR_PASSWORD_HERE\"\n\n    'YOUR_CODE_HERE\n\n    ActiveSheet.Protect UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False, _\n            AllowFormattingCells:=True, AllowFormattingColumns:=True, _\n            AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, Password:=\"YOUR_PASSWORD_HERE\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Please, note that in the protection statement I have included / allowed other options that you may want to exclude. Check what of these options you need (you can use the macro recorder in case you need it, but do not forget to click the objets and scenarios options).</p>\n"}], "owner": {"reputation": 315, "user_id": 5919453, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7d51217c2b23c42385baf7e50fc72950?s=128&d=identicon&r=PG&f=1", "display_name": "Steve G.", "link": "https://stackoverflow.com/users/5919453/steve-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1404, "favorite_count": 0, "accepted_answer_id": 43670425, "answer_count": 2, "score": 0, "last_activity_date": 1589194757, "creation_date": 1492610533, "last_edit_date": 1531161705, "question_id": 43497986, "link": "https://stackoverflow.com/questions/43497986/excel-vba-worksheet-double-click-event-wont-run-when-worksheet-is-protected", "title": "Excel VBA: Worksheet Double-click event won&#39;t run when worksheet is protected", "body": "<p>I'm having trouble with the running of a worksheet event (<code>BeforeDoubleClick</code>) while the worksheet is protected. (In fact, the whole workbook is protected.) The entire event won't run, so I can't run <code>ActiveSheet.Unprotect</code> as the first line in the worksheet, even before the event makes its changes. For completeness's sake, here's my code, though it doesn't even run, so it might not be a factor:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    ActiveSheet.Unprotect\n    Call ToggleReceiptSetting(Target, \"statements\")\n    ActiveSheet.Protect\n    Cancel = True\nEnd Sub\n</code></pre>\n\n<p>If I unprotect the worksheet manually, the event runs. Does anyone have a solution or a reason why Excel won't run this if the worksheet is protected? Is there a way to make it run without unprotecting the sheet before the event runs?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1492610437, "post_id": 43497880, "comment_id": 74050060, "body": "Try to declare the last 4 lines as <code>Range</code> somehow. If you paste the code, in the question, you would have more success. In general, take a look at the question here - <a href=\"http://stackoverflow.com/questions/19351832/copy-from-one-workbook-and-paste-into-another\" title=\"copy from one workbook and paste into another\">stackoverflow.com/questions/19351832/&hellip;</a>"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1494454611, "post_id": 43497880, "comment_id": 74841061, "body": "<a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">Why accept an answer?</a>. Accepting an answer helps other people with the same question."}], "answers": [{"tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": false, "score": 1, "last_activity_date": 1506018557, "last_edit_date": 1506018557, "creation_date": 1492611296, "answer_id": 43498284, "question_id": 43497880, "link": "https://stackoverflow.com/questions/43497880/i-am-trying-to-copy-all-the-information-off-of-two-different-worksheets-and-appl/43498284#43498284", "title": "I am trying to copy all the information off of two different worksheets and apply them to a master worksheet", "body": "<p>You cannot open worksheets. You open a workbook and it seems that these workbooks are in <code>ThisWorkbook</code>. You cannot define a worksheet to be a value (copied or paste). As you declare <code>x</code>, <code>y</code>, and <code>z</code> as <code>Worksheet</code> you need to go for defining ranges. However, as you just copy/paste them, there is no need for that declaration and you can directly do that. See below:</p>\n\n<pre><code>Sub BringDataToMasterSheet()\n\n    Dim WB As ThisWorkbook\n    Dim x As WorkSheet\n    Dim y As WorkSheet\n    Dim z As WorkSheet\n\n\n    '## Set worksheets first: (You don't open worksheets)\n    Set x = Worksheets(\"Delinquent Promises Detail\")\n    Set y = Worksheets(\"Delinquent Shipments Detail\")\n    Set z = Worksheets(\"Master\")\n\n\n    'Now, copy what you want:\n    x.Range(\"A2\").End(xlDown).Copy\n    z.Range(\"A2\").End(xlDown).Offset(1,0).PasteSpecial xlPasteAll\n\n    y.Range(\"A2\").End(xlDown).Copy\n    z.Range(\"A2\").End(xlDown).Offset(1,0).PasteSpecial xlPasteAll\n\nEnd Sub\n</code></pre>\n\n<p>Here are some lines that you may use here depedn on what exactly you mean by opening a worksheet or copying a range while setting them to something:</p>\n\n<p>This opens a workbook:</p>\n\n<p><code>Set myWB = Workbooks.Open(\"Path/to/the/file.xlsx\")</code></p>\n\n<p>This set a worksheet within that workbook:</p>\n\n<p><code>Set xyz = myWB.Worksheets(\"Sheet1\")</code></p>\n\n<p>This sets a range:</p>\n\n<pre><code>Dim myRange As Range\nSet myRange = xyz.Range(\"A2\")\n</code></pre>\n\n<p>This Copies that range and pastes it somewhere else in the same worksheet (except the borders of the original range):</p>\n\n<pre><code>myRange.Copy\nxyz.Range(\"H50\").PasteSpeciall xlPasteAllExceptBorders\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7786651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99109469b75a5b5f60d622f6c4182697?s=128&d=identicon&r=PG&f=1", "display_name": "zach123", "link": "https://stackoverflow.com/users/7786651/zach123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1506018557, "creation_date": 1492610251, "last_edit_date": 1531164843, "question_id": 43497880, "link": "https://stackoverflow.com/questions/43497880/i-am-trying-to-copy-all-the-information-off-of-two-different-worksheets-and-appl", "title": "I am trying to copy all the information off of two different worksheets and apply them to a master worksheet", "body": "<p>This is the code I am trying to use and it isn't quite working. I am not sure what I did wrong since I am still learning VBA. Can anyone help me to get this to work?</p>\n\n<pre><code>Sub BringDataToMasterSheet()\n\n    Dim WB As ThisWorkbook\n    Dim x As WorkSheet\n    Dim y As WorkSheet\n    Dim z As WorkSheet\n\n    '## Open Workbooks first:\n    Set x = Worksheet.Open(\"Delinquent Promises Detail\")\n    Set y = Worksheet.Open(\"Delinquent Shipments Detail\")\n    Set z = Worksheet.Open(\"Master\")\n\n\n\n    'Now, copy what you want from x:\n    x = Worksheet(\"Delinquent Promises Detail\").Range(\"A2\").lastrow.Copy\n    z = Worksheet(\"Master\").Range(\"A\").lastrow.PasteSpecial\n\n\n\n    y = Worksheet(\"Delinquent Shipments Detail\").Range(\"A2\").lastrow.Copy\n    z = Worksheet(\"Master\").Range(\"A\").lastrow.PasteSpecial\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492610140, "post_id": 43497800, "comment_id": 74049821, "body": "change to <code>Rows(&quot;5:&quot; &amp; k).Select</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7889813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a2e9312a06ea930c2a11cb56861e2ae?s=128&d=identicon&r=PG&f=1", "display_name": "Albatross 44", "link": "https://stackoverflow.com/users/7889813/albatross-44"}, "is_accepted": false, "score": 0, "last_activity_date": 1492610471, "creation_date": 1492610471, "answer_id": 43497968, "question_id": 43497800, "link": "https://stackoverflow.com/questions/43497800/excel-vba-rows-reference/43497968#43497968", "title": "Excel VBA (rows reference)", "body": "<p>The problem is that VBA can't recognise the k variable inside the \" \"</p>\n\n<p>Try something like:</p>\n\n<pre><code>Sub test()\nDim k As Long\nk = 9\nRows(\"5:\" &amp; k).Select\nEnd Sub\n</code></pre>\n\n<p>k is outside the \" \" so VBA recognises it as a variable and the &amp; tells VBA to concatenate the value of k onto what's inside the \" \" </p>\n"}], "owner": {"reputation": 11, "user_id": 7890192, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156003665107699/picture?type=large", "display_name": "Teng Xiang Rong", "link": "https://stackoverflow.com/users/7890192/teng-xiang-rong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 427, "favorite_count": 0, "closed_date": 1492611250, "answer_count": 1, "score": 1, "last_activity_date": 1492618459, "creation_date": 1492610055, "last_edit_date": 1531164843, "question_id": 43497800, "link": "https://stackoverflow.com/questions/43497800/excel-vba-rows-reference", "closed_reason": "Duplicate", "title": "Excel VBA (rows reference)", "body": "<p>Hi I am trying to refer to certain rows to do something in VBA.</p>\n\n<p>The code is something like below:</p>\n\n<pre><code>Sub test()\n\nDim k As Long\nk = 9\nRows(\"5:k\").Select\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to make my rows dynamic by changing the k value each time. however I am not sure why it cannot select the rows and the code don't work. Any ways to go around this issue? If I substitute k with 9 directly, the code works. But this does not happen.</p>\n\n<p>Am I supposed to select something like <code>rows(\"5:k(value)).select</code> ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1492610210, "post_id": 43497690, "comment_id": 74049876, "body": "Just had a poke around msdn, perhaps I could employ <code>Static</code> instead of global variables, altough I&#39;m not sure if that would help my <code>Workbook_BeforeSave</code> access them."}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1492612968, "post_id": 43497690, "comment_id": 74052196, "body": "in your procedure selectionchange you define Highrange, you use highrng and finally newhigh, to my understanding, you probably mean to use newhigh for all. highrange is not used, highrng is not initialised ...."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1492615730, "post_id": 43497690, "comment_id": 74054204, "body": "@h2so4 Sorry, fixed now, that was a legacy of the actual code"}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1492621459, "post_id": 43497690, "comment_id": 74058178, "body": "is declarations: part of your code ? if yes remove it"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1492680485, "post_id": 43497690, "comment_id": 74084217, "body": "@h2so4 Fixed (it wasn&#39;t actually in my real code). I&#39;ve also added the actual code to avoid similar issues. It should highlight the correct row of the first table on whichever sheet the code is placed. I&#39;ve also clarified how to raise the error message."}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 1, "creation_date": 1492682690, "post_id": 43497690, "comment_id": 74085826, "body": "define public oldT() in a new module, instead of in the sheet1"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1492685765, "post_id": 43497690, "comment_id": 74088082, "body": "@h2so4 I&#39;ll accept that as answer, maybe some additional explanation would be nice"}, {"owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "edited": false, "score": 0, "creation_date": 1492709753, "post_id": 43497690, "comment_id": 74105788, "body": "as the error message says, public arrays are not allowed in object module (in this case you try to define a public array within sheet1)"}], "answers": [{"tags": [], "owner": {"reputation": 1541, "user_id": 6769432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0ac4b9fd634e0ef51b2e35e2fbdc0c?s=128&d=identicon&r=PG&f=1", "display_name": "h2so4", "link": "https://stackoverflow.com/users/6769432/h2so4"}, "is_accepted": true, "score": 0, "last_activity_date": 1492709926, "creation_date": 1492709926, "answer_id": 43526323, "question_id": 43497690, "link": "https://stackoverflow.com/questions/43497690/access-worksheet-variables-from-workbook-events/43526323#43526323", "title": "Access worksheet variables from workbook events", "body": "<p>as mentioned in my comment, insert the instruction in a new module instead of sheet1</p>\n\n<pre><code>public oldT()\n</code></pre>\n\n<p>the error message mentions public arrays are not allowed in object module. I could not find more info on msdn. </p>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 43526323, "answer_count": 1, "score": 1, "last_activity_date": 1521285923, "creation_date": 1492609774, "last_edit_date": 1521285923, "question_id": 43497690, "link": "https://stackoverflow.com/questions/43497690/access-worksheet-variables-from-workbook-events", "title": "Access worksheet variables from workbook events", "body": "<p>I have a <code>Worksheet_SelectionChange</code> event which needs to know details about a range from <em>before</em> the change event ran. To do this, one part of the event logs the current state, another part looks at the logs from the previous time the event ran, and works with them. I'm saving the logs as global variables. My code steps look like this:</p>\n\n<pre><code>'Declarations:\nPrivate oldT() As Double\nPrivate oldHigh As Range\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n'''\n'1) Read range stored in oldHigh\n'''\nDim newHigh as Range\nDim newT() As Double\nSet newHigh= Target 'range we are currently working on\nReDim newT(1 To newHigh.Cells.Count, 1 To 3) '\n'''\n'2) Loop through each Cell in newHigh and pass 3 details to newT()\n'   This saves the current state\n'''\n'3) Make temporary change to newHigh\n'''\n'4) Loop through oldHigh, using the values saved in oldT() to reset it\n'''\nSet oldHigh = newHigh'log where you made the temporary changes\noldT = newT 'and what the cells were before the changes\nEnd Sub\n</code></pre>\n\n<p>I do not initialise the variables with a <code>Workbook_Open</code>, instead I have an error check in my selection change code (before step 1) in case <code>oldHigh</code> is empty.</p>\n\n<p>This is all fine, except that I now realise that if I save and exit, the last reset action does not take place. So I decided to carry out step <code>4)</code> in a <code>Workbook_BeforeSave</code> event, that way the workbook doesn't save the temporary change (making it permenant)\nThat code looks like this:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim i As Long\n    Dim subCell As Range\n    Dim oldHigh As Range: Set oldHigh = [a1]\n    For i = 1 To lastCol 'reset\n        Set subCell = oldHigh(1, i)\n        With subCell.Interior\n            .Color = oldT(i, 3)\n            .TintAndShade = oldT(i, 2)\n            .Pattern = oldT(i, 1)\n        End With\n    Next i\n    Set oldHigh = Nothing 'Required if user saves but does not exit,\n                          'This makes the workbook look as if it is freshly opened \n                          'Which is what my code is designed to handle\nEnd Sub\n</code></pre>\n\n<p>(As you can see, the data saved is fill info, I temporarily change the fill to highlight the selection, then change it back to how it was afterwards)</p>\n\n<h2>The problem</h2>\n\n<p>When I run that save event, the code can't access <code>oldT()</code> or <code>oldHigh</code>. I guessed this was because they are <code>Private</code> so I made them <code>Public</code>, but that gave the following error:\n<a href=\"https://i.stack.imgur.com/ndiLp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ndiLp.png\" alt=\"Error message\"></a></p>\n\n<p>How can I access these worsheet variables from the workbook event?</p>\n\n<h3>Actual Code:</h3>\n\n<p>To avoid confusion. Note <code>newHigh</code> is called <code>highRng</code> here</p>\n\n<pre><code>Private oldT() As Double\nPrivate oldHigh As Range\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nDim myTbl As ListObject\nDim oldHighTest As Boolean\nSet myTbl = Me.ListObjects(1)\nIf oldHigh Is Nothing Then\n    oldHighTest = True\nElse\n    oldHighTest = Intersect(oldHigh, Target) Is Nothing\nEnd If\nIf Not Intersect(Target, myTbl.Range) Is Nothing And oldHighTest Then ' highlight cells in table only when new row of table is selected\n    appMod False\n    On Error GoTo e\n    Dim tl As Range, highRng As Range, subCell As Range\n    Dim newT() As Double, lastCol As Long, i As Long\n    Set tl = myTbl.HeaderRowRange(1)\n    Set highRng = Me.Range(Cells(Target.Row, tl.Column), Cells(Target.Row, tl.Column + myTbl.ListColumns.Count - 1))\n    lastCol = highRng.Columns.Count\n    ReDim newT(1 To lastCol, 1 To 3) '\n    For i = 1 To lastCol 'save\n        Set subCell = highRng(1, i)\n        With subCell.Interior\n            newT(i, 1) = .Pattern\n            newT(i, 2) = .TintAndShade\n            newT(i, 3) = .Color\n        End With\n    Next i\n    With highRng.Interior 'highlight\n        .Pattern = xlSolid\n        .TintAndShade = 1\n        .Color = 4189681\n    End With\n    For i = 1 To lastCol 'reset last highlight using last save\n        Set subCell = oldHigh(1, i)\n        With subCell.Interior\n            .Color = oldT(i, 3)\n            .TintAndShade = oldT(i, 2)\n            .Pattern = oldT(i, 1)\n        End With\n    Next i\n\ne:  appMod True\n    Set oldHigh = highRng\n    oldT = newT\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Placed in <code>Sheet1</code> code, and highlights a row of table1 (or the 1st <code>ListObject</code> in the page, in case I change the table name)\n Where <code>appMod</code> calls</p>\n\n<pre><code>Public Sub appMod(t As Boolean)\nWith Application\n    .EnableEvents = t\n    .ScreenUpdating = t\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The problem arises when changing</p>\n\n<pre><code>Private oldT()\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Public oldT()\n</code></pre>\n\n<p>But no issues making <code>oldHigh</code> <code>Public</code> , only that it is still not picked up in the <code>ThisWorkbook</code> code (it is seen as blank when it isn't)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 1, "creation_date": 1492609577, "post_id": 43497492, "comment_id": 74049369, "body": "It&#39;ll be fine if the file is in use, though application.displayalerts would need to be disabled to avoid the read only dialogue."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492609961, "post_id": 43497492, "comment_id": 74049678, "body": "Thanks David!  The file should always exist, so the only issue would be me mistyping the date.  Instead of doing an &#39;Exit Sub&#39;, how can I get it to loop back to the inputbox?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492610293, "post_id": 43497492, "comment_id": 74049948, "body": "Use a <code>GoTo</code> statement or a <code>While</code> loop."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492611011, "post_id": 43497492, "comment_id": 74050562, "body": "@sbagnato see revision which should avoid the need for user input :D"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492611398, "post_id": 43497492, "comment_id": 74050870, "body": "David, no luck.  I get file does not exist.  Now, an actual filename is &quot;Agent Group Daily Summary 4.13.17&quot;.   However, with the holiday last week, there was no Friday.  So, I edited the code above so that vbFriday was vbThursday, but I still got a DNE error.  Ideas?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492611634, "post_id": 43497492, "comment_id": 74051044, "body": "oops, in all my fanciness, I forgot to add the <code>.xls</code> to the end of the filename, I&#39;ll revise!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492611681, "post_id": 43497492, "comment_id": 74051090, "body": "Revised, change to: <code>fullFileName = strFilePath &amp; LastFridayDate &amp; &quot;.xls&quot;</code> and I think that should work."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492611686, "post_id": 43497492, "comment_id": 74051096, "body": "@sbagnato &quot;with the holiday last week, there was no Friday&quot; - uh, what? Last Friday was <i>Good Friday</i>, which last I checked <i>was</i> a Friday. If your requirement is to get the <i>last Friday</i> like you stated, then last Friday was April 14, 2017. If your requirement is to get the <i>last workday in a week given a business calendar</i>, then you have misworded your question and we&#39;re (and you&#39;re) missing data. This answer gives you exactly what you asked for and you should accept it."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492611848, "post_id": 43497492, "comment_id": 74051253, "body": "Yeah, Matt, sorry but you know I did not mean there was not actually a Friday.  I meant there was no Friday file since no one worked Friday"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492689364, "post_id": 43497492, "comment_id": 74090775, "body": "David, looks like there still may be an issue.  As mentioned, there is no file for last Friday.  However, there is one for every day last week, as well as mon-wed this week.  However, when I run the code, it tells me no file for last Friday (which is good), and no file for Thursday.  Now, there is no file for today, because today has not ended, but why would it not grab last Thursday?  Point being, when I run it tomorrow (the day it&#39;s actually needed), if there was a Friday file, which normally there will be, it appears it will not find it..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492690615, "post_id": 43497492, "comment_id": 74091661, "body": "How do you <i>think</i> you asked this code to check for last Thursday&#39;s file? :)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492690863, "post_id": 43497492, "comment_id": 74091822, "body": "Hint: The <code>vbFriday</code> part of the <code>Weekday</code> function is not magically telling it to get friday&#39;s date. It&#39;s actually telling it that, for the sake of this function call, consider Friday to be the first day of the week. The <code>Weekday</code> function then returns an integer (the ordinal day of the week) which it subtracts from the <code>Date</code>.  What I would propose is, if the file is not found, you should modify code to have the user manually select the file. I&#39;ll revise that shortly."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492691219, "post_id": 43497492, "comment_id": 74092099, "body": "Hm, good point.  Well, I edited the LastFriday snippet into 5 different snippets.  Including extra code added in, here is the &quot;Thursday&quot; code:      ThursdayDate = Format(Date - (Weekday(Date, vbThursday) - 1), &quot;m.d.yy&quot;)     fullFileNameThursday = strFilePath &amp; ThursdayDate &amp; &quot;.xls&quot;     If Dir(fullFileNameThursday) = &quot;&quot; Then         MsgBox &quot;File for Thursday doesn&#39;t exist!&quot;         GoTo ExitThursday     End If     Set wbkThursday = Workbooks.Open(fullFileNameThursday, False, True)     Call BasicDailySummary     ...............     wbkThursday.Close SaveChanges:=False ExitThursday:"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492691346, "post_id": 43497492, "comment_id": 74092178, "body": "Please consider that it is nearly impossible to read multi-line code in comments here. You almost certainly do not want to be configuring a separate code for each day of the week, because how will the program know which day of the week it should be looking for."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492691379, "post_id": 43497492, "comment_id": 74092196, "body": "Also, have you debugged this expression <code>Format(Date - (Weekday(Date, vbThursday) - 1), &quot;m.d.yy&quot;) </code> because if you had, you would see that it is not doing what you think it&#39;s doing (it&#39;s actually returning <i>today&#39;s</i> date, which is why you&#39;re getting &quot;file not found&quot; message."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492691444, "post_id": 43497492, "comment_id": 74092248, "body": "FYI: to get thursday last, you&#39;d need to: <code>Format(Date - (Weekday(Date, vbFriday) ), &quot;m.d.yy&quot;) </code>, but don&#39;t. Use the revision above which allows the user to select the file from the folder. It&#39;s much cleaner."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1492693515, "post_id": 43497492, "comment_id": 74094046, "body": "David, I will test that code to see what it does.  My end goal is to open each of 5 days worth of files (last Friday, this Monday, ect., this Thursday), grab a few cells of data, and then close the files.  One larger section of code does make more sense than 5 smaller ones, one for each day, but I had not figured out how to do that part.  Once the entire script is done, the plan is to only run this Friday mornings; it is while testing that I am doing it on days such as today."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492693833, "post_id": 43497492, "comment_id": 74094304, "body": "If you get stuck, please ask a separate question. The scope of this question is already well beyond the original intent, which was &quot;how do I concatenate strings in VBA&quot;. It should be relatively easy to build a loop to create the 7 filenames (e.g., <code>&quot;4.14.17&quot;, &quot;4.15.17&quot;, ..., &quot;4.20.17&quot;</code> and then you can just use those in the macro."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1492691578, "last_edit_date": 1492691578, "creation_date": 1492609302, "answer_id": 43497492, "question_id": 43497439, "link": "https://stackoverflow.com/questions/43497439/excel-vba-append-xls-to-filename-to-open-file/43497492#43497492", "title": "Excel VBA - Append .xls to filename to open file", "body": "<p>This is basic string concatentation:</p>\n\n<pre><code>strFilePath &amp; strFileName &amp; \".xls\"\n</code></pre>\n\n<p>You should probably check to ensure the file exists, otherwise there will be an error:</p>\n\n<pre><code>Dim fullFileName As String\nstrFilePath &amp; strFileName &amp; \".xls\"\nIf Dir(fullFileName) = \"\" Then\n    MsgBox \"Invalid filename!\"\n    Exit Sub\nEnd If\nSet wbkOpen = Workbooks.Open(fullFileName, False, True)\n</code></pre>\n\n<p>Ideally, you can avoid user-input (which is prone to error) altogether:</p>\n\n<pre><code>Const strFilePath As String = \"D:\\Users\\stefan.bagnato\\Desktop\\Daily Performance Summary\\Agent Group Daily Summary \"\nDim wbkOpen As Workbook\nDim LastFridayDate As String\nDim fullFileName As String\nDim fdlg as FileDialog\nLastFridayDate = Format(Date - (Weekday(Date, vbFriday) - 1), \"m.d.yy\")\nfullFileName = strFilePath &amp; LastFridayDate &amp; \".xls\"\n\nIf Dir(fullFileName) = \"\" Then\n    If MsgBox(\"The file named \" &amp; fullFileName &amp; \" doesn't exist. Would you like to manually locate the file?\", vbYesNo) = vbNo Then\n        Exit Sub\n    Else\n        Set fdlg = Application.FileDialog(msoFileDialogOpen)\n        '## Opens the fileDialog in the normal folder where these files should exist\n        fdlg.InitialFileName = strFilePath\n        '## Display the fileDialog to the user\n        fdlg.Show\n        '## Validate the fileDialog hasn't been canceled\n        If fdlg.SelectedItems.Count &lt;&gt; 0 Then\n            '## Return the value of the item selected by the user\n            fullFileName = fdlg.SelectedItems(1)\n        Else:\n            MsgBox \"No file selected, exiting procedure...\"\n        End If\n    End If\nEnd If\nSet wbkOpen = Workbooks.Open(fullFileName, False, True)\n</code></pre>\n\n<p>Of course allowing the user to manually select the file may ultimately require additional validation and/or error-handling (i.e., what if they select the wrong file? How can the program know which <em>date</em> is the <em>correct</em> date [I'd wager that it <em>can't</em>, without doing an ugly brute force loop which still makes a lot of assumptions which might not always hold] What if they select a PDF or a PPT file instead of an XLS, etc. but those points are entirely out of scope for this question.)  </p>\n\n<p>If you have additional follow-ups, please follow proper site etiquette and ask a new question :)</p>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 43497492, "answer_count": 1, "score": 0, "last_activity_date": 1492691578, "creation_date": 1492609175, "question_id": 43497439, "link": "https://stackoverflow.com/questions/43497439/excel-vba-append-xls-to-filename-to-open-file", "title": "Excel VBA - Append .xls to filename to open file", "body": "<p>I have code to open a file with a variable date, as shown below.  This code will not work without entering m.d.y.xls into the input box.  I want to only have to enter m.d.y into the input box.  Please take a look and let me know what I am missing.  Thanks!</p>\n\n<pre><code>Dim wbkOpen As Workbook\nDim strFilePath As String\nDim strFileName As String\nstrFilePath = \"D:\\Users\\stefan.bagnato\\Desktop\\Daily Performance Summary\\Agent Group Daily Summary \"\nstrFileName = InputBox(\"Enter last Friday's date in the format M.D.Y\", \"Friday's Date\")\nSet wbkOpen = Workbooks.Open(strFilePath &amp; strFileName, False, True)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1492609468, "post_id": 43497048, "comment_id": 74049290, "body": "What good is a string var assigned to the worksheet&#39;s codename going to do? You cannot use the string like <code>strSheet1.Cells(1, 1)</code> or <code>Worksheets(strSheet1)</code> or really for anything else I can think of. You might be better to retrieve the ordinal index."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492610314, "post_id": 43497048, "comment_id": 74049965, "body": "<a href=\"http://stackoverflow.com/q/25203173/1188513\">stackoverflow.com/q/25203173/1188513</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7542269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac85356687ec7a43f8374041f24cca8?s=128&d=identicon&r=PG&f=1", "display_name": "Logic", "link": "https://stackoverflow.com/users/7542269/logic"}, "edited": false, "score": 0, "creation_date": 1492609520, "post_id": 43497098, "comment_id": 74049329, "body": "Is there a way to have it returned as a Worksheet that I can then use with commands like: ShtCodeName.UsedRange.Rows.Count"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5, "user_id": 7542269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac85356687ec7a43f8374041f24cca8?s=128&d=identicon&r=PG&f=1", "display_name": "Logic", "link": "https://stackoverflow.com/users/7542269/logic"}, "edited": false, "score": 0, "creation_date": 1492609888, "post_id": 43497098, "comment_id": 74049611, "body": "@Logic <code>CodeName</code> is just a <code>String</code>. <code>Worksheets(&quot;YourSheetName&quot;)</code> gets you the worksheet object you&#39;re after, so <code>Set sheet = Worksheets(&quot;YourSheetName&quot;)</code> and then you can do <code>sheet.UsedRange.Rows.Count</code>."}, {"owner": {"reputation": 5, "user_id": 7542269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac85356687ec7a43f8374041f24cca8?s=128&d=identicon&r=PG&f=1", "display_name": "Logic", "link": "https://stackoverflow.com/users/7542269/logic"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492610377, "post_id": 43497098, "comment_id": 74050013, "body": "@Mat&#39;sMug Thanks!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1492608314, "creation_date": 1492608314, "answer_id": 43497098, "question_id": 43497048, "link": "https://stackoverflow.com/questions/43497048/get-a-sheets-codename-using-the-sheets-name/43497098#43497098", "title": "Get a sheet&#39;s codename using the sheet&#39;s name", "body": "<p>Try something like below:</p>\n\n<pre><code>Dim ShtCodeName As String\n\nShtCodeName = Worksheets(\"YourSheetName\").CodeName\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7542269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ac85356687ec7a43f8374041f24cca8?s=128&d=identicon&r=PG&f=1", "display_name": "Logic", "link": "https://stackoverflow.com/users/7542269/logic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 43497098, "answer_count": 1, "score": 0, "last_activity_date": 1492608314, "creation_date": 1492608183, "question_id": 43497048, "link": "https://stackoverflow.com/questions/43497048/get-a-sheets-codename-using-the-sheets-name", "title": "Get a sheet&#39;s codename using the sheet&#39;s name", "body": "<p>I'm trying to write something where the user inputs the tab name of a worksheet in Excel and uses the tab name to get the sheet's codename before continuing through the code. </p>\n"}, {"tags": ["vba", "catia"], "comments": [{"owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "edited": false, "score": 0, "creation_date": 1492620210, "post_id": 43496564, "comment_id": 74057325, "body": "I really don&#39;t think you are suposed to have an Axis System inside a geometrical set. Also, what is the selected element you have in your selection?"}, {"owner": {"reputation": 307, "user_id": 2604880, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b482cd13e55dcff40efd112cb0d13774?s=128&d=identicon&r=PG", "display_name": "harishli2020", "link": "https://stackoverflow.com/users/2604880/harishli2020"}, "reply_to_user": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "edited": false, "score": 0, "creation_date": 1492694008, "post_id": 43496564, "comment_id": 74094447, "body": "Selected element is a Geometrical Set. I want to export all the required data to a text file. Geometric set(CSYS) contains all the data I want as shown in figure."}, {"owner": {"reputation": 307, "user_id": 2604880, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b482cd13e55dcff40efd112cb0d13774?s=128&d=identicon&r=PG", "display_name": "harishli2020", "link": "https://stackoverflow.com/users/2604880/harishli2020"}, "reply_to_user": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "edited": false, "score": 0, "creation_date": 1492694393, "post_id": 43496564, "comment_id": 74094754, "body": "My actual geometric set contains lines,  circles, arcs. I&#39;m able to import all except local axis system."}, {"owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "edited": false, "score": 0, "creation_date": 1493060442, "post_id": 43496564, "comment_id": 74241547, "body": "Check out the answer I posted, see if it helps you."}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 2604880, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b482cd13e55dcff40efd112cb0d13774?s=128&d=identicon&r=PG", "display_name": "harishli2020", "link": "https://stackoverflow.com/users/2604880/harishli2020"}, "edited": false, "score": 0, "creation_date": 1493101182, "post_id": 43521557, "comment_id": 74255373, "body": "Thank you AugustoQ. Now, I&#39;m able to export the axis system data using search and selection."}], "tags": [], "owner": {"reputation": 894, "user_id": 6591514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d491bd47cceefd875ac99174befa1720?s=128&d=identicon&r=PG&f=1", "display_name": "Quima", "link": "https://stackoverflow.com/users/6591514/quima"}, "is_accepted": true, "score": 2, "last_activity_date": 1522193704, "last_edit_date": 1522193704, "creation_date": 1492696434, "answer_id": 43521557, "question_id": 43496564, "link": "https://stackoverflow.com/questions/43496564/catia-v5-macro-to-access-axis-system-inside-a-geometric-set/43521557#43521557", "title": "Catia V5 macro to access axis-system inside a geometric set", "body": "<p>Axis Systems can't be found inside a Geometrical Set by looping through child items via the CATIA API.\nA <code>hybridBody</code> (Geometrical Set) only contains <code>HybridShapes</code>, <code>HybridBodies</code> and <code>Sketches</code>.</p>\n\n<p>You can see <code>Lines</code>, <code>Points</code>, and such other items because they are all <code>HybridShapes</code>.</p>\n\n<p>As far as I know, the only way of getting the Axis System object inside a Geometrical Set is through the <code>Selection.Search</code> method.</p>\n\n<p>Assuming you have the CSYS Geometrical Set in your selection, you can do the following:</p>\n\n<pre><code>Dim Selection as INFITF.Selection\nDim AxisSystem as INFITF.AxisSystem\n'Initialize Selection and other code here\nSelection.Search(\"'Part Design'.'Axis System';sel\")\nfor i = 1 to Selection.Count2\n    set AxisSystem = Selection.Item2(i).Value\n    '...\nNext\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 2604880, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b482cd13e55dcff40efd112cb0d13774?s=128&d=identicon&r=PG", "display_name": "harishli2020", "link": "https://stackoverflow.com/users/2604880/harishli2020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2562, "favorite_count": 0, "accepted_answer_id": 43521557, "answer_count": 1, "score": 2, "last_activity_date": 1544694435, "creation_date": 1492606972, "last_edit_date": 1544694435, "question_id": 43496564, "link": "https://stackoverflow.com/questions/43496564/catia-v5-macro-to-access-axis-system-inside-a-geometric-set", "title": "Catia V5 macro to access axis-system inside a geometric set", "body": "<p><a href=\"https://i.stack.imgur.com/SOtI4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SOtI4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Using a Catia V5 macro I want to save axis system and other geometric elements  inside a geometic set to a txt file. I'm able to access the geometric elements like points and lines but not the axis system(Shown in image) .</p>\n\n<pre><code>'Procedure to access the geometic elements inside a geometric set    \nDim prtDoc  As Part\nDim hbds As HybridBodies\nDim hbs As HybridShapes\nSet hbs = hbds.GetItem(objSel.Item2(1).Value.Name).HybridShapes\n</code></pre>\n\n<p>To access a geometric element and get its type</p>\n\n<pre><code>MsgBox TypeName(hbs.Item(i))\n</code></pre>\n\n<p>But how to access the axis system? </p>\n"}, {"tags": ["excel", "vba", "c#-4.0", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7889667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ab0ae5fea2cd4bdd261d5d673454bd?s=128&d=identicon&r=PG&f=1", "display_name": "Raj Bhalani", "link": "https://stackoverflow.com/users/7889667/raj-bhalani"}, "edited": false, "score": 0, "creation_date": 1492761070, "post_id": 43506773, "comment_id": 74125983, "body": "Thanks for suggestion. Updating pivot range for each worksheet works. Solution is good for now but not feasible as every time worksheet increases and i need to update pivot range of every worksheet every time i open file.  We can find feasible solution if we can find root cause of issue."}], "tags": [], "owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1492639044, "creation_date": 1492639044, "answer_id": 43506773, "question_id": 43496216, "link": "https://stackoverflow.com/questions/43496216/pivot-table-data-source-keeps-referring-to-previously-inserted-worksheets-pivot/43506773#43506773", "title": "Pivot table data source keeps referring to previously inserted worksheet&#39;s pivot table datasource", "body": "<p>Can you just update the pivot range that is being used in each of the workbooks? Something like this:</p>\n\n<pre><code>Private Sub UpdatePivotRange()\n\nDim sName\n\nlRow = Sheet1.Range(\"A2\").End(xlDown).Row\nLcol = Sheet1.Range(\"A2\").End(xlToRight).Column\n\n    sName = Sheet1.Name\n    pivRange = Sheet1.Name &amp; \"!R2C1:R\" &amp; lRow &amp; \"C\" &amp; Lcol\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7889667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ab0ae5fea2cd4bdd261d5d673454bd?s=128&d=identicon&r=PG&f=1", "display_name": "Raj Bhalani", "link": "https://stackoverflow.com/users/7889667/raj-bhalani"}, "is_accepted": false, "score": 0, "last_activity_date": 1492759857, "creation_date": 1492759857, "answer_id": 43536543, "question_id": 43496216, "link": "https://stackoverflow.com/questions/43496216/pivot-table-data-source-keeps-referring-to-previously-inserted-worksheets-pivot/43536543#43536543", "title": "Pivot table data source keeps referring to previously inserted worksheet&#39;s pivot table datasource", "body": "<p>Updating pivot range of each worksheet every time i open file as below code works:  </p>\n\n<pre><code>  Private Sub Workbook_Open()\n    'Set Variables Equal to Data Sheet and Pivot Sheet\n    Dim Data_sht As Worksheet\n    Dim Pivot_sht As Worksheet\n    Dim StartPoint As Range\n    Dim DataRange As Range\n    Dim PivotName As String\n    Dim NewRange As String\n    Dim WS_Count As Integer\n    Dim I As Integer\n    WS_Count = ActiveWorkbook.Worksheets.Count\n    ' Begin the loop.\n    For I = 1 To WS_Count\n    If ThisWorkbook.Worksheets(I).PivotTables.Count &lt;&gt; 0 Then\n    Set Data_sht = ThisWorkbook.Worksheets(I - 1)\n    Set Pivot_sht = ThisWorkbook.Worksheets(I)\n    PivotName = \"PivotTable\" + Replace(Pivot_sht.Name, \"-\", \"_\") + \"_ManagementARReport\"\n    Set StartPoint = Data_sht.Range(\"A1\")\n    Set DataRange = Data_sht.Range(StartPoint, StartPoint.SpecialCells(xlLastCell))\n    NewRange = Data_sht.Name &amp; \"!\" &amp; _\n    DataRange.Address(ReferenceStyle:=xlR1C1)\n    'Change Pivot Table Data Source Range Address\n    Pivot_sht.PivotTables(PivotName).ChangePivotCache _\n    ThisWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=NewRange)\n    'Ensure Pivot Table is Refreshed\n    Pivot_sht.PivotTables(PivotName).RefreshTable\n    End If\n    Next I\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7889667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05ab0ae5fea2cd4bdd261d5d673454bd?s=128&d=identicon&r=PG&f=1", "display_name": "Raj Bhalani", "link": "https://stackoverflow.com/users/7889667/raj-bhalani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 739, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1492936272, "creation_date": 1492606104, "last_edit_date": 1492936272, "question_id": 43496216, "link": "https://stackoverflow.com/questions/43496216/pivot-table-data-source-keeps-referring-to-previously-inserted-worksheets-pivot", "title": "Pivot table data source keeps referring to previously inserted worksheet&#39;s pivot table datasource", "body": "<p>I am generating two worksheets, one for data and one for pivot table named <strong>'worksheet1_data'</strong> and <strong>'worksheet1'</strong> respectively in same workbook using ep plus.\nIt seems good when I save for first time.\nAgain I process this excel file (.xlsx) and added two new worksheets <strong>'worksheet2_data'</strong> and <strong>'worksheet2'</strong> in it and generated new pivot table with datasource from <strong>'worksheet2_data'</strong>.\nWhen I open the file, pivot table in <strong>'worksheet1'</strong> and <strong>'worksheet2'</strong> both have datasource of <strong>'worksheet1_data'</strong>, \neven if I add more pivot tables, all have datasource of <strong>'worksheet1_data'</strong>.</p>\n\n<p>The code works fine while debugging but datasources change while opening excel sheet.\nCan any one suggest what could be the issue?</p>\n\n<p>Below is my code:</p>\n\n<pre><code>ExcelWorksheet worksheetManagementARReportData = package.Workbook.Worksheets.Add(EndDate.ToString(\"MM-dd-yyyy\") + \"_Data\");\nExcelWorksheet worksheetManagementARReport = package.Workbook.Worksheets.Add(EndDate.ToString(\"MM-dd-yyyy\"));\nvar dataRange_ManagementARReport = worksheetManagementARReportData.Cells[\"A1\"].LoadFromDataTable(dsGetManagementARReport.Tables[0], true);\nvar pivotTableManagementARReport = worksheetManagementARReport.PivotTables.Add(worksheetManagementARReport.Cells[\"A1\"], dataRange_ManagementARReport, \"PivotTable\" + EndDate.ToString(\"MM_dd_yyyy\") + \"_ManagementARReport\");\nTbl_AutomatedReport.PivotTable(rowfield, columnfield, pagefield, datafields, pivotTableManagementARReport);\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 1, "last_activity_date": 1492606296, "creation_date": 1492606296, "answer_id": 43496311, "question_id": 43496182, "link": "https://stackoverflow.com/questions/43496182/if-else-statement-where-the-condition-is-to-match-with-the-subtext-of-a-text/43496311#43496311", "title": "if else statement where the condition is to match with the subtext of a text", "body": "<p>In stead of <code>=</code> (equal) you can use <code>Like</code>:</p>\n\n<pre><code>If ActiveCell.Value Like \"Benchmark report \" &amp; \"*\"\n</code></pre>\n\n<p>Lookup <code>Like</code> in the help documentation for details.</p>\n"}, {"tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1492606335, "creation_date": 1492606335, "answer_id": 43496323, "question_id": 43496182, "link": "https://stackoverflow.com/questions/43496182/if-else-statement-where-the-condition-is-to-match-with-the-subtext-of-a-text/43496323#43496323", "title": "if else statement where the condition is to match with the subtext of a text", "body": "<p>Try this:</p>\n\n<pre><code>If InStr(ActiveCell.Value, \"Benchmark report\") &gt; 0 Then\n    'String found in cell value\nEnd IF\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1492606388, "creation_date": 1492606388, "answer_id": 43496343, "question_id": 43496182, "link": "https://stackoverflow.com/questions/43496182/if-else-statement-where-the-condition-is-to-match-with-the-subtext-of-a-text/43496343#43496343", "title": "if else statement where the condition is to match with the subtext of a text", "body": "<p>This is a good option to try in the immediate window:</p>\n\n<pre><code>?instr(1,\"John carter\",lcase(\"JOHN\"),vbTextCompare)&gt;0\n</code></pre>\n\n<p>Then replace the hardcoded values with <code>ActiveCell</code> or other ranges.</p>\n"}], "owner": {"reputation": 65, "user_id": 7888139, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F9Onh.jpg?s=128&g=1", "display_name": "prerna arora", "link": "https://stackoverflow.com/users/7888139/prerna-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 43496311, "answer_count": 3, "score": 0, "last_activity_date": 1492606388, "creation_date": 1492606018, "last_edit_date": 1492606241, "question_id": 43496182, "link": "https://stackoverflow.com/questions/43496182/if-else-statement-where-the-condition-is-to-match-with-the-subtext-of-a-text", "title": "if else statement where the condition is to match with the subtext of a text", "body": "<p>I want my condition to hold true if I find the string \"john\" in my cell .. and the cell value could be Mr John or John Carter. And both these scenarios should give a true value to my condition.</p>\n\n<p>I tried the below code. Didn't work:</p>\n\n<pre><code>If ActiveCell.Value = \"Benchmark report \" &amp; \"*\"\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "64-bit"], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "edited": false, "score": 0, "creation_date": 1492608999, "post_id": 43496229, "comment_id": 74048901, "body": "Good point, thank you, I&#39;ve updated my code now (but with no effect on that pop-up window)"}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1492606128, "creation_date": 1492606128, "answer_id": 43496229, "question_id": 43496084, "link": "https://stackoverflow.com/questions/43496084/sql-query-via-macro-vba-64-bit-ms-office-users-get-what-looks-like-credentia/43496229#43496229", "title": "SQL query via macro / VBA, 64-bit MS Office users get, what looks like credentials prompt window, but no such for 32-bit MS Office users", "body": "<p>As <code>Conn_str</code> is already a string, you don't need to quote it (actually: shouldn't quote it):</p>\n\n<pre><code>Connection:= Conn_str, ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "is_accepted": true, "score": 0, "last_activity_date": 1492709335, "creation_date": 1492709335, "answer_id": 43526153, "question_id": 43496084, "link": "https://stackoverflow.com/questions/43496084/sql-query-via-macro-vba-64-bit-ms-office-users-get-what-looks-like-credentia/43526153#43526153", "title": "SQL query via macro / VBA, 64-bit MS Office users get, what looks like credentials prompt window, but no such for 32-bit MS Office users", "body": "<p>OK, I think I found the cause of the problem. There was a mistake deeper in my code that I didn\u2019t mention. I'm going to post my findings here, hopefully it will help someone in the future.</p>\n\n<p>I store my Connection and SQL query info in a worksheet and to get these into a string I'm using a small function.</p>\n\n<pre><code>Function BuildStr(Rng As Range) As String\n    Dim Sub_Str As Range\n    For Each Sub_Str In Rng\n        BuildStr = BuildStr &amp; Sub_Str &amp; vbNewLine\n    Next Sub_Str\nEnd Function\n</code></pre>\n\n<p>The <code>&amp; vbNewLine</code> is there to ensure SELECT, FROM, WHERE, etc. statements in my SQL string start from new lines (otherwise no dice) and it also makes it easier to read the query when occasionally printed out. \nBut looks like it should not be used in the Connection string.</p>\n\n<p>So in short, the connection string should look like this:</p>\n\n<pre><code>OLEDB;DRIVER=SQL Server;SERVER=SVR_name;Database=DB_name;Trusted_Connection=Yes\n</code></pre>\n\n<p>And not like this:</p>\n\n<pre><code>OLEDB; &amp; VbNewLine &amp; DRIVER=SQL Server;  &amp; VbNewLine &amp; SERVER=SVR_name;  &amp; VbNewLine &amp; Database=DB_name;  &amp; VbNewLine &amp; Trusted_Connection=Yes\n</code></pre>\n\n<p>I am yet to understand why this isn't an issue on 32-bit Office, but most importantly I got rid of the annoying pop-up window (and learned something I didn't know).</p>\n\n<p>Thanks,\nJ.</p>\n"}], "owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 43526153, "answer_count": 2, "score": 0, "last_activity_date": 1492709335, "creation_date": 1492605716, "last_edit_date": 1531164843, "question_id": 43496084, "link": "https://stackoverflow.com/questions/43496084/sql-query-via-macro-vba-64-bit-ms-office-users-get-what-looks-like-credentia", "title": "SQL query via macro / VBA, 64-bit MS Office users get, what looks like credentials prompt window, but no such for 32-bit MS Office users", "body": "<p>I have a simple SQL query (below) that I run via a macro in Excel workbook. It works fine on MS Office 32-bit as well as 64-bit, however, for 64-bit Office users a pop-up window (below) appears in the middle (on the <code>.Refresh</code> line). It is enough to just press \"OK\" and the macro continues and fetches the data correctly, however, I would like to avoid this pop-up window if possible and/or understand why this is happening, please?</p>\n\n<p>Query:</p>\n\n<pre><code>Sub Run_Query( _\nByRef SQL_Data_rng As Range, _\nByRef Conn_str As String, _\nByRef SQL_str As String)\n\n    With ws1.QueryTables.Add( _\n    Connection:=\"\" &amp; Conn_str &amp; \"\", _\n    Destination:=SQL_Data_rng, _\n    Sql:=SQL_str)\n        .BackgroundQuery = False\n        .Refresh\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/4cYn3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4cYn3.png\" alt=\"Pop Up window\"></a></p>\n"}, {"tags": ["arrays", "vba"], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1492605504, "creation_date": 1492605504, "answer_id": 43496007, "question_id": 43495846, "link": "https://stackoverflow.com/questions/43495846/array-in-array-vba/43496007#43496007", "title": "Array in array vba", "body": "<p>Try a two dimensional array:</p>\n\n<pre><code>Dim parameters(10,10) As String\n\nparameters(1,1) = \"db1\"\nparameters(1,2) = \"server1\"\n...\nparameters(2,1) = \"db2\"\nparameters(2,2) = \"server2\"\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1492605558, "creation_date": 1492605558, "answer_id": 43496027, "question_id": 43495846, "link": "https://stackoverflow.com/questions/43495846/array-in-array-vba/43496027#43496027", "title": "Array in array vba", "body": "<p>You actually need a 2-D Array to populate your <code>servers</code>, try the code below:</p>\n\n<pre><code>Option Explicit\n\nSub x()\n\nDim servers(2, 3) As String\nDim parameters() As Variant\nDim i As Long, j As Long\n\nparameters = Array(\"db\", \"server\", \"user\", \"password\")\n\nFor i = 0 To 2\n    For j = LBound(parameters) To UBound(parameters)\n       servers(i, j) = parameters(j) &amp; i + 1\n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1492607942, "post_id": 43496064, "comment_id": 74048004, "body": "UDT&#39;s are so under-rated. This should be the accepted answer."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 4, "last_activity_date": 1492605656, "creation_date": 1492605656, "answer_id": 43496064, "question_id": 43495846, "link": "https://stackoverflow.com/questions/43495846/array-in-array-vba/43496064#43496064", "title": "Array in array vba", "body": "<p>It seems a user-defined type can help you:</p>\n\n<pre><code>Type tServerData\n    DBname As String\n    ServerID As String\n    UserName As String\n    Password As String\nEnd Type\n\nDim ServerData(0 To 2) As tServerData\n</code></pre>\n\n<p>Now you have an arrray for 3 servers, for example:</p>\n\n<pre><code>ServerData(0).DBname= \"db1\"\n</code></pre>\n\n<p>etc.</p>\n"}], "owner": {"reputation": 219, "user_id": 6791322, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/2RgQr.png?s=128&g=1", "display_name": "Alessandro95", "link": "https://stackoverflow.com/users/6791322/alessandro95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 43496027, "answer_count": 3, "score": 0, "last_activity_date": 1492605656, "creation_date": 1492605051, "question_id": 43495846, "link": "https://stackoverflow.com/questions/43495846/array-in-array-vba", "title": "Array in array vba", "body": "<p>i have to create an array in an array</p>\n\n<p>here my code: </p>\n\n<pre><code>Dim servers(2) As String\nDim parameters(3) As String\nDim i, j As Integer\n\nparameters(0) = \"db1\"\nparameters(1) = \"server1\"\nparameters(2) = \"user1\"\nparameters(3) = \"password1\"\n\nFor i = 0 To 2\n    For j = 0 To 3\n       servers(i) = parameters(j)\n    Next j\nNext i\n</code></pre>\n\n<p>I made a graphical example with the result and i really don't know how to do it:\n<a href=\"https://i.stack.imgur.com/1uSme.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/1uSme.png</a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7889480, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1474848722560046/picture?type=large", "display_name": "Lucas Senne", "link": "https://stackoverflow.com/users/7889480/lucas-senne"}, "edited": false, "score": 0, "creation_date": 1492698547, "post_id": 43495886, "comment_id": 74098186, "body": "I do have a doubt guys, I Edited my text asking for further questions, should I click on the edit button and put my question there or click on Answer your question button and type my question? I am a little confused about this"}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "reply_to_user": {"reputation": 19, "user_id": 7889480, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1474848722560046/picture?type=large", "display_name": "Lucas Senne", "link": "https://stackoverflow.com/users/7889480/lucas-senne"}, "edited": false, "score": 0, "creation_date": 1492698793, "post_id": 43495886, "comment_id": 74098420, "body": "If you have a follow up question, I would suggest a new question. At the end of your new question you can link to this one, and be clear about the new question and the (answered) old one."}], "tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1492605185, "creation_date": 1492605185, "answer_id": 43495886, "question_id": 43495737, "link": "https://stackoverflow.com/questions/43495737/predetermine-the-cells-with-the-data-to-send-emails/43495886#43495886", "title": "Predetermine the cells with the data to send emails", "body": "<p>Instead of</p>\n\n<pre><code>Set xRg = Application.InputBox(\"Please select the data range:\", \"Kutools for Excel\", xTxt, , , , , 8)\n</code></pre>\n\n<p>use the line</p>\n\n<pre><code>Set xRg = Range(\"A2:C6\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1492606106, "creation_date": 1492606106, "answer_id": 43496217, "question_id": 43495737, "link": "https://stackoverflow.com/questions/43495737/predetermine-the-cells-with-the-data-to-send-emails/43496217#43496217", "title": "Predetermine the cells with the data to send emails", "body": "<p>You can replace :</p>\n\n<pre><code>Dim xTxt As String\nOn Error Resume Next\nxTxt = ActiveWindow.RangeSelection.Address\nSet xRg = Application.InputBox(\"Please select the data range:\", \"Kutools for Excel\", xTxt, , , , , 8)\nIf xRg Is Nothing Then Exit Sub\nIf xRg.Columns.Count &lt;&gt; 3 Then\n    MsgBox \" Regional format error, please check\", , \"Kutools for Excel\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>by :</p>\n\n<pre><code>Set xRg = ActiveSheet.Range(\"A2:C6\")\n</code></pre>\n\n<p>I've included <code>On Error Resume Next</code> because if your code runs into an error, you'll not see it and hence cannot correct it to correct it!</p>\n"}], "owner": {"reputation": 19, "user_id": 7889480, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/1474848722560046/picture?type=large", "display_name": "Lucas Senne", "link": "https://stackoverflow.com/users/7889480/lucas-senne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 1, "accepted_answer_id": 43496217, "answer_count": 2, "score": 0, "last_activity_date": 1593413506, "creation_date": 1492604775, "last_edit_date": 1593413506, "question_id": 43495737, "link": "https://stackoverflow.com/questions/43495737/predetermine-the-cells-with-the-data-to-send-emails", "title": "Predetermine the cells with the data to send emails", "body": "<p>I found the code below. </p>\n\n<p>The code asks for the range with the data to be selected and sends the emails. I tried to predetermine these cells but I could not figure it out. </p>\n\n<p>Example</p>\n\n<p>This is my table, I do not want to select the cells every time I run the code, instead I would like the code take the data from cells A2:C6</p>\n\n<p><img src=\"https://i.stack.imgur.com/6qyD6.png\" alt=\"This is my table, I do not want to select the cells everytime I run the code, instead of that I would like to predetermine to always when I run the code the macro will take the data from cells A2:C6\"></p>\n\n<p>The code: </p>\n\n<pre><code>Sub SendEMail()\n'update by Extendoffice 20160506\nDim xEmail As String\nDim xSubj As String\nDim xMsg As String\nDim xURL As String\nDim i As Integer\nDim k As Double\nDim xCell As Range\nDim xRg As Range\nDim xTxt As String\nOn Error Resume Next\nxTxt = ActiveWindow.RangeSelection.Address\nSet xRg = Application.InputBox(\"Please select the data range:\", \"Kutools for Excel\", xTxt, , , , , 8)\nIf xRg Is Nothing Then Exit Sub\nIf xRg.Columns.Count &lt;&gt; 3 Then\n    MsgBox \" Regional format error, please check\", , \"Kutools for Excel\"\n    Exit Sub\nEnd If\nFor i = 1 To xRg.Rows.Count\n'       Get the email address\n    xEmail = xRg.Cells(i, 2)\n'       Message subject\n    xSubj = \"Your Registration Code\"\n'       Compose the message\n    xMsg = \"\"\n    xMsg = xMsg &amp; \"Dear \" &amp; xRg.Cells(i, 1) &amp; \",\" &amp; vbCrLf &amp; vbCrLf\n    xMsg = xMsg &amp; \" This is your Registration Code \"\n    xMsg = xMsg &amp; xRg.Cells(i, 3).Text &amp; \".\" &amp; vbCrLf &amp; vbCrLf\n    xMsg = xMsg &amp; \" please try it, and glad to get your feedback! \" &amp; vbCrLf\n    xMsg = xMsg &amp; \"Skyyang\"\n'       Replace spaces with %20 (hex)\n    xSubj = Application.WorksheetFunction.Substitute(xSubj, \" \", \"%20\")\n    xMsg = Application.WorksheetFunction.Substitute(xMsg, \" \", \"%20\")\n'       Replace carriage returns with %0D%0A (hex)\n    xMsg = Application.WorksheetFunction.Substitute(xMsg, vbCrLf, \"%0D%0A\")\n'       Create the URL\n    xURL = \"mailto:\" &amp; xEmail &amp; \"?subject=\" &amp; xSubj &amp; \"&amp;body=\" &amp; xMsg\n'       Execute the URL (start the email client)\n    ShellExecute 0&amp;, vbNullString, xURL, vbNullString, vbNullString, vbNormalFocus\n'       Wait two seconds before sending keystrokes\n    Application.Wait (Now + TimeValue(\"0:00:02\"))\n    Application.SendKeys \"%s\"\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "email", "lotus-notes"], "answers": [{"tags": [], "owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "is_accepted": true, "score": 0, "last_activity_date": 1492640813, "creation_date": 1492640813, "answer_id": 43507126, "question_id": 43495542, "link": "https://stackoverflow.com/questions/43495542/send-email-via-imb-notes-using-vba-sent-message-saves-in-drafts/43507126#43507126", "title": "Send Email Via IMB Notes using VBA - Sent message saves in drafts?", "body": "<p>The saved copy is still a draft because it hasn't been sent yet.  You need to save it after you send it.</p>\n\n<p>I.e., change this:</p>\n\n<pre><code>doc.Save True, False\nCall doc.PutInFolder(\"Delivery Tracker Email Notifications\")\n\nCall doc.Send(False)\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>Call doc.Send(False)\ndoc.Save True, False\nCall doc.PutInFolder(\"Delivery Tracker Email Notifications\")\n</code></pre>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 43507126, "answer_count": 1, "score": 0, "last_activity_date": 1492640813, "creation_date": 1492604302, "question_id": 43495542, "link": "https://stackoverflow.com/questions/43495542/send-email-via-imb-notes-using-vba-sent-message-saves-in-drafts", "title": "Send Email Via IMB Notes using VBA - Sent message saves in drafts?", "body": "<p>I am using the following code to send an email via IBM Notes using VBA.</p>\n\n<p>Code:</p>\n\n<pre><code>Sub SendEmail()\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\n\nApplication.CutCopyMode = False\n\n\n'Define Variables\nDim Ref As String\nDim TrueRef As String\n\nDim Attachment As String\nDim WB3 As Workbook\nDim WB4 As Workbook\nDim Rng As Range\nDim db As Object\nDim doc As Object\nDim body As Object\nDim header As Object\nDim stream As Object\nDim session As Object\nDim i As Long\nDim j As Long\nDim j2 As Long\nDim server, mailfile, user, usersig As String\nDim LastRow As Long, LastRow2 As Long, ws As Worksheet\nLastRow = Worksheets(1).Range(\"F\" &amp; Rows.Count).End(xlUp).Row  'Finds the last used row\n\n\n'Define Depot\nRef = Range(\"F\" &amp; (ActiveCell.Row)).Value\n\n    If Ref = \"WED\" Then\n    TrueRef = \"WED\"\n    Else\n    If Ref = \"WSM\" Then\n    TrueRef = \"WES\"\n    Else\n    If Ref = \"NAY\" Then\n    TrueRef = \"NAY\"\n    Else\n    If Ref = \"ENF\" Then\n    TrueRef = \"ENF\"\n    Else\n    If Ref = \"LUT\" Then\n    TrueRef = \"MAG\"\n    Else\n    If Ref = \"NFL\" Then\n    TrueRef = \"NOR\"\n    Else\n    If Ref = \"RUN\" Then\n    TrueRef = \"RUN\"\n    Else\n    If Ref = \"SOU\" Then\n    TrueRef = \"SOU\"\n    Else\n    If Ref = \"SOU\" Then\n    TrueRef = \"SOU\"\n    Else\n    If Ref = \"BRI\" Then\n    TrueRef = \"BRI\"\n    Else\n    If Ref = \"LIV\" Then\n    TrueRef = \"LIV\"\n    Else\n    If Ref = \"BEL\" Then\n    TrueRef = \"BEL\"\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n\n\n    If Ref &lt;&gt; \"\" Or TrueRef &lt;&gt; \"\" Then ' FailSafe\n\n\n\n'Start a session of Lotus Notes\nSet session = CreateObject(\"Notes.NotesSession\")\n'This line prompts for password of current ID noted in Notes.INI\nSet db = session.CurrentDatabase\nSet stream = session.CreateStream\n' Turn off auto conversion to rtf\nsession.ConvertMime = False\n\n\n\n'Email Code\n\n'Create email to be sent\n\nSet doc = db.CreateDocument\ndoc.Form = \"Memo\"\nSet body = doc.CreateMIMEEntity\nSet header = body.CreateHeader(\"Subject\")\nCall header.SetHeaderVal(\"Food Specials Delivery Tracker: The Status of Your Issue Has Changed (\" &amp; Range(\"N\" &amp; ActiveCell.Row).Value &amp; \")\")\n\n'Set From\nCall doc.ReplaceItemValue(\"Principal\", \"Food Specials &lt;mailto:Food.Specials@Lidl.co.uk&gt;\")\nCall doc.ReplaceItemValue(\"ReplyTo\", \"Food.Specials@Lidl.co.uk\")\nCall doc.ReplaceItemValue(\"DisplaySent\", \"Food.Specials@Lidl.co.uk\")\n\n\n\n'Set From\nCall doc.ReplaceItemValue(\"Principal\", \"Food Specials &lt;mailto:Food.Specials@Lidl.co.uk&gt;\")\nCall doc.ReplaceItemValue(\"ReplyTo\", \"Food.Specials@Lidl.co.uk\")\nCall doc.ReplaceItemValue(\"DisplaySent\", \"Food.Specials@Lidl.co.uk\")\n\n\n'To\nSet header = body.CreateHeader(\"To\")\nCall header.SetHeaderVal(\"supplychain-\" &amp; TrueRef &amp; \"@lidl.co.uk\")\n\n\n\n'Email Body\nCall stream.WriteText(\"&lt;HTML&gt;\")\nCall stream.WriteText(\"&lt;font size=\"\"3\"\" color=\"\"black\"\" face=\"\"Arial\"\"&gt;\")\nIf Hour(Now) &gt; 12 Then\nCall stream.WriteText(\"&lt;p&gt;Good afternoon,&lt;/p&gt;\")\nElse\nCall stream.WriteText(\"&lt;p&gt;Good morning,&lt;/p&gt;\")\nEnd If\nCall stream.WriteText(\"&lt;p&gt;Reference: \" &amp; Format(CDate(Range(\"A\" &amp; ActiveCell.Row).Value), \"DDMMYY\") &amp; \" - \" &amp; Range(\"C\" &amp; ActiveCell.Row).Value &amp; \" - \" &amp; Range(\"D\" &amp; ActiveCell.Row).Value &amp; \"&lt;/p&gt;\")\nIf ThisWorkbook.Sheets(1).Range(\"N\" &amp; ActiveCell.Row).Value = \"Issue Complete\" Then\nCall stream.WriteText(\"&lt;p&gt;Your recent issue has been marked as complete.&lt;/p&gt;\")\nElse\nCall stream.WriteText(\"&lt;p&gt;The status of your recent issue has changed.&lt;/p&gt;\")\nEnd If\n\n\n\n'Insert Range\nThisWorkbook.Sheets(1).Range(\"A\" &amp; ActiveCell.Row &amp; \":K\" &amp; ActiveCell.Row &amp; \", N\" &amp; ActiveCell.Row).SpecialCells(xlCellTypeVisible).Select\nSet Rng = Selection\nCall stream.WriteText(RangetoHTML(Rng))\nCells(1, 1).Select\n\nCall stream.WriteText(\"&lt;BR&gt;&lt;BR&gt;&lt;p&gt;&lt;a href=\"\"G:\\WH DISPO\\(3) PROMOTIONS\\(18) Food Specials Delivery Tracking\\Food Specials Delivery Tracker.xlsm\"\"&gt;Click here to view your issue on the Delivery Tracker now.&lt;/a&gt;&lt;/p&gt;&lt;/br&gt;\")\n\n'Signature\nCall stream.WriteText(\"&lt;BR&gt;&lt;p&gt;Kind regards / Mit freundlichen Gr&amp;#252;&amp;#223;en,&lt;/p&gt;&lt;/br&gt;\")\nCall stream.WriteText(\"&lt;p&gt;&lt;b&gt;Lidl UK Food Specials Team&lt;/b&gt;&lt;/p&gt;\")\n\nCall stream.WriteText(\"&lt;table border=\"\"0\"\"&gt;\")\nCall stream.WriteText(\"&lt;tr&gt;\")\nCall stream.WriteText(\"&lt;td&gt;&lt;img src=\"\"http://www.lidl.co.uk/statics/lidl-uk/ds_img/layout/top_logo2016.jpg\"\" alt=\"\"Mountain View\"\"&gt;&lt;/td&gt;\")\nCall stream.WriteText(\"&lt;td&gt;&lt;img src=\"\"http://www.lidl.co.uk/statics/lidl-uk/ds_img/assets_x_x/BOQLOP_NEW%281%29.jpg\"\" alt=\"\"Mountain View\"\"&gt;&lt;/td&gt;\")\nCall stream.WriteText(\"&lt;/tr&gt;\")\nCall stream.WriteText(\"&lt;/table&gt;\")\n\n\nCall stream.WriteText(\"&lt;/font&gt;\")\nCall stream.WriteText(\"&lt;/body&gt;\")\nCall stream.WriteText(\"&lt;/html&gt;\")\n\nCall body.SetContentFromText(stream, \"text/HTML;charset=UTF-8\", ENC_IDENTITY_7BIT)\n\ndoc.Save True, False\nCall doc.PutInFolder(\"Delivery Tracker Email Notifications\")\n\n\nCall doc.Send(False)\n\nsession.ConvertMime = True ' Restore conversion - very important\n\n\n'Clean Up the Object variables - Recover memory\n    Set db = Nothing\n    Set session = Nothing\n    Set stream = Nothing\n    Set doc = Nothing\n    Set body = Nothing\n    Set header = Nothing\n\n    'WB3.Close savechanges:=False\n\n    Application.CutCopyMode = False\n\n'Email Code\n\n\n\nElse ' Otherwise - FailSafe\n\n\n\n'Start a session of Lotus Notes\nSet session = CreateObject(\"Notes.NotesSession\")\n'This line prompts for password of current ID noted in Notes.INI\nSet db = session.CurrentDatabase\nSet stream = session.CreateStream\n' Turn off auto conversion to rtf\nsession.ConvertMime = False\n\n\n\n'Email Code\n\n'Create email to be sent\n\nSet doc = db.CreateDocument\ndoc.Form = \"Memo\"\nSet body = doc.CreateMIMEEntity\nSet header = body.CreateHeader(\"Subject\")\nCall header.SetHeaderVal(\"Food Specials Delivery Tracker: The Status of Your Issue Has Changed (\" &amp; Range(\"N\" &amp; ActiveCell.Row).Value &amp; \")\")\n\n'Set From\nCall doc.ReplaceItemValue(\"Principal\", \"Food Specials &lt;mailto:Food.Specials@Lidl.co.uk&gt;\")\nCall doc.ReplaceItemValue(\"ReplyTo\", \"Food.Specials@Lidl.co.uk\")\nCall doc.ReplaceItemValue(\"DisplaySent\", \"Food.Specials@Lidl.co.uk\")\n\n\n\n'Set From\nCall doc.ReplaceItemValue(\"Principal\", \"Food Specials &lt;mailto:Food.Specials@Lidl.co.uk&gt;\")\nCall doc.ReplaceItemValue(\"ReplyTo\", \"Food.Specials@Lidl.co.uk\")\nCall doc.ReplaceItemValue(\"DisplaySent\", \"Food.Specials@Lidl.co.uk\")\n\n\n'To\nSet header = body.CreateHeader(\"To\")\nCall header.SetHeaderVal(\"food.specials@lidl.co.uk\")\n\n\n\n'Email Body\nCall stream.WriteText(\"&lt;HTML&gt;\")\nCall stream.WriteText(\"&lt;font size=\"\"3\"\" color=\"\"black\"\" face=\"\"Arial\"\"&gt;\")\nIf Hour(Now) &gt; 12 Then\nCall stream.WriteText(\"&lt;p&gt;Good afternoon,&lt;/p&gt;\")\nElse\nCall stream.WriteText(\"&lt;p&gt;Good morning,&lt;/p&gt;\")\nEnd If\nCall stream.WriteText(\"&lt;p&gt;&lt;b&gt;Error: The below email was not delivered to the RDC.&lt;/b&gt;&lt;/p&gt;&lt;br&gt;\")\nCall stream.WriteText(\"&lt;p&gt;Reference: \" &amp; Format(CDate(Range(\"A\" &amp; ActiveCell.Row).Value), \"DDMMYY\") &amp; \" - \" &amp; Range(\"C\" &amp; ActiveCell.Row).Value &amp; \" - \" &amp; Range(\"D\" &amp; ActiveCell.Row).Value &amp; \"&lt;/p&gt;\")\nIf ThisWorkbook.Sheets(1).Range(\"N\" &amp; ActiveCell.Row).Value = \"Issue Complete\" Then\nCall stream.WriteText(\"&lt;p&gt;Your recent issue has been marked as complete.&lt;/p&gt;\")\nElse\nCall stream.WriteText(\"&lt;p&gt;The status of your recent issue has changed.&lt;/p&gt;\")\nEnd If\n\n\n\n'Insert Range\nThisWorkbook.Sheets(1).Range(\"A\" &amp; ActiveCell.Row &amp; \":K\" &amp; ActiveCell.Row &amp; \", N\" &amp; ActiveCell.Row).SpecialCells(xlCellTypeVisible).Select\nSet Rng = Selection\nCall stream.WriteText(RangetoHTML(Rng))\nCells(1, 1).Select\n\nCall stream.WriteText(\"&lt;BR&gt;&lt;BR&gt;&lt;p&gt;&lt;a href=\"\"G:\\WH DISPO\\(3) PROMOTIONS\\(18) Food Specials Delivery Tracking\\Food Specials Delivery Tracker.xlsm\"\"&gt;Click here to view your issue on the Delivery Tracker now.&lt;/a&gt;&lt;/p&gt;&lt;/br&gt;\")\n\n'Signature\nCall stream.WriteText(\"&lt;BR&gt;&lt;p&gt;Kind regards / Mit freundlichen Gr&amp;#252;&amp;#223;en,&lt;/p&gt;&lt;/br&gt;\")\nCall stream.WriteText(\"&lt;p&gt;&lt;b&gt;Lidl UK Food Specials Team&lt;/b&gt;&lt;/p&gt;\")\n\nCall stream.WriteText(\"&lt;table border=\"\"0\"\"&gt;\")\nCall stream.WriteText(\"&lt;tr&gt;\")\nCall stream.WriteText(\"&lt;td&gt;&lt;img src=\"\"http://www.lidl.co.uk/statics/lidl-uk/ds_img/layout/top_logo2016.jpg\"\" alt=\"\"Mountain View\"\"&gt;&lt;/td&gt;\")\nCall stream.WriteText(\"&lt;td&gt;&lt;img src=\"\"http://www.lidl.co.uk/statics/lidl-uk/ds_img/assets_x_x/BOQLOP_NEW%281%29.jpg\"\" alt=\"\"Mountain View\"\"&gt;&lt;/td&gt;\")\nCall stream.WriteText(\"&lt;/tr&gt;\")\nCall stream.WriteText(\"&lt;/table&gt;\")\n\n\nCall stream.WriteText(\"&lt;/font&gt;\")\nCall stream.WriteText(\"&lt;/body&gt;\")\nCall stream.WriteText(\"&lt;/html&gt;\")\n\nCall body.SetContentFromText(stream, \"text/HTML;charset=UTF-8\", ENC_IDENTITY_7BIT)\n\ndoc.Save True, False\nCall doc.PutInFolder(\"Delivery Tracker Email Notifications\")\n\n\nCall doc.Send(False)\n\nsession.ConvertMime = True ' Restore conversion - very important\n\n\n'Clean Up the Object variables - Recover memory\n    Set db = Nothing\n    Set session = Nothing\n    Set stream = Nothing\n    Set doc = Nothing\n    Set body = Nothing\n    Set header = Nothing\n\n    'WB3.Close savechanges:=False\n\n    Application.CutCopyMode = False\n\n'Email Code\n\n\n\n\n\nEnd If\n\n\n\n\n\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n\n<p>The codes working and the email is being sent. I am also choosing to save a copy of the sent email in a folder called Delivery Tracker Email Notifications.</p>\n\n<p>However, these emails also seem to be appearing in the drafts folder - Even though they have been sent.</p>\n\n<p>Please can someone explain/show me where i am going wrong here?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 1, "creation_date": 1492611023, "post_id": 43495326, "comment_id": 74050578, "body": "check your form open/load event. Besides, looping through employee table to find an employee is not the best practice. use sql, or dlookups"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "edited": false, "score": 0, "creation_date": 1492607468, "post_id": 43495869, "comment_id": 74047619, "body": "There was not change."}, {"owner": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "edited": false, "score": 0, "creation_date": 1492668801, "post_id": 43495869, "comment_id": 74076919, "body": "I redid the form. There is no difference."}, {"owner": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "edited": false, "score": 0, "creation_date": 1493726230, "post_id": 43495869, "comment_id": 74517448, "body": "The error has reoccurred. I have decompiled/compact and repaired twice this today."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "edited": false, "score": 0, "creation_date": 1493726838, "post_id": 43495869, "comment_id": 74517901, "body": "Create a plain new form and let your code open this. If it doesn&#39;t fail, the error is your other form; if it fails, the error is somewhere else."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1492605126, "creation_date": 1492605126, "answer_id": 43495869, "question_id": 43495326, "link": "https://stackoverflow.com/questions/43495326/struggling-to-solve-ms-access-openform-was-cancelled-error-2501/43495869#43495869", "title": "Struggling to solve MS Access OpenForm was cancelled - error 2501", "body": "<p>Your syntax is not correct. Try:</p>\n\n<pre><code>DoCmd.OpenForm \"Menu\", acNormal, , , , acWindowNormal \n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 5908472, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-onyPYCqh0SM/AAAAAAAAAAI/AAAAAAAAAEA/yIeATGP7sCQ/photo.jpg?sz=128", "display_name": "Marcus Mackaku", "link": "https://stackoverflow.com/users/5908472/marcus-mackaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 755, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492630260, "creation_date": 1492603727, "last_edit_date": 1492630260, "question_id": 43495326, "link": "https://stackoverflow.com/questions/43495326/struggling-to-solve-ms-access-openform-was-cancelled-error-2501", "title": "Struggling to solve MS Access OpenForm was cancelled - error 2501", "body": "<pre class=\"lang-vb prettyprint-override\"><code>'Check to see if the recordset actually contains rows\nIf Not (recordSet.EOF And recordSet.BOF) Then\n    recordSet.MoveFirst 'Unnecessary in this case, but still a good habit\n\n    'See if credentials match data\n    Do\n        If (recordSet!User_ID = PERSAL And recordSet!Password = Password) Then\n\n           'Open Menu form\n\n            DoCmd.OpenForm \"Menu\", acNormal, \"\", \"\", , acNormal\n\n            recordSet.Close 'Close the recordset\n            Set recordSet = Nothing 'Clean up\n\n            'Close Login form\n            DoCmd.Close acForm, \"Login\"\n\n            Exit Do\n        End If\n\n        recordSet.MoveNext\n\n        If (recordSet.EOF Or recordSet.BOF) Then\n            MsgBox \"Your credentials are incorrect or you are not registered.\"\n\n            Exit Do\n        End If\n    Loop\n\n    'Match the values entered for PERSAL nr. and password fields with a row in User table\n\nElse\n\n    MsgBox \"There are no records in the recordset.\"\n\n     recordSet.Close 'Close the recordset\n     Set recordSet = Nothing 'Clean up\n\nEnd If\n\nForm_Login.txtUser_ID.SetFocus\n</code></pre>\n\n<p>I have tried every solution I've found for the past 2 days but nothing has worked to solved my error 2501:</p>\n\n<p>I did:</p>\n\n<ul>\n<li>Decompiling</li>\n<li>Compact and repair</li>\n<li>Tackling the MSCOMCTL.OCX file</li>\n<li>Importing to a new access file</li>\n</ul>\n\n<p>I am spent. </p>\n\n<p>For the MSCOMCTL.OCX file I'm thinking to download a 2007 Office update SP 3. </p>\n\n<p>The exception/error appears on this line:</p>\n\n<pre><code>DoCmd.OpenForm \"Menu\", acNormal, \"\", \"\", , acNormal\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1492603371, "post_id": 43495066, "comment_id": 74044567, "body": "Use brackets! <code>5 + 3 * 2    =    5 + 6    =    11</code> and <code>(5 + 3) * 2     =    8 * 2    =    16</code> you should have had this at school math this is basic calculation (<a href=\"https://en.wikibooks.org/wiki/Arithmetic/Order_of_Operations\" rel=\"nofollow noreferrer\">Order of Operations</a>)."}, {"owner": {"reputation": 157, "user_id": 7495707, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5f55f2ae1b2d466f1b9ad3d211a074d6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Todor", "link": "https://stackoverflow.com/users/7495707/d-todor"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1492604115, "post_id": 43495066, "comment_id": 74045113, "body": "I did, but I added the brackets before the semicolon and it didn&#39;t work. Thank you either way, @Peh."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 7495707, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5f55f2ae1b2d466f1b9ad3d211a074d6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Todor", "link": "https://stackoverflow.com/users/7495707/d-todor"}, "edited": false, "score": 0, "creation_date": 1492604365, "post_id": 43495361, "comment_id": 74045290, "body": "Thank you. As I mentioned in my comment I tried to put the brackets before the semicolon and that didn&#39;t work."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 157, "user_id": 7495707, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5f55f2ae1b2d466f1b9ad3d211a074d6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Todor", "link": "https://stackoverflow.com/users/7495707/d-todor"}, "edited": false, "score": 0, "creation_date": 1492604421, "post_id": 43495361, "comment_id": 74045326, "body": "@D.Todor when you have too many <code>&quot;</code> and <code>(</code> use <code>Debug.Print</code> of the <code>Formula</code> string you are trying (I Do)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1492605460, "post_id": 43495361, "comment_id": 74046154, "body": "@ShaiRado any reason for that extra brackets? I remember a wise person who said something like &quot;an answer is perfect, if you cannot omit anything without changing the meaning&quot;. Therefore you can omit the extra brackets like sktneer did in his answer without changing the math!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1492605767, "last_edit_date": 1492605767, "creation_date": 1492603838, "answer_id": 43495361, "question_id": 43495066, "link": "https://stackoverflow.com/questions/43495066/vba-excel-evaluate-function-how-to-add-before-multipling/43495361#43495361", "title": "VBA Excel - Evaluate function - How to add before multipling", "body": "<p>As @Peh wrote in his comment, just add <code>()</code> for the add to work before the multiply:</p>\n\n<pre><code>Range(\"P2:P\" &amp; LR).Value = Evaluate(\"(I2:I\" &amp; LR &amp; \"+J2:J\" &amp; LR &amp; \")*O2:O\" &amp; LR)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1492604000, "creation_date": 1492604000, "answer_id": 43495428, "question_id": 43495066, "link": "https://stackoverflow.com/questions/43495066/vba-excel-evaluate-function-how-to-add-before-multipling/43495428#43495428", "title": "VBA Excel - Evaluate function - How to add before multipling", "body": "<p>Try it like this...</p>\n\n<pre><code>Range(\"P2:P\" &amp; LR) = Evaluate(\"(I2:I\" &amp; LR &amp; \"+J2:J\" &amp; LR &amp; \")*O2:O\" &amp; LR)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 396, "user_id": 7796810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f8b5deb296124be4aa1e86d92250d66?s=128&d=identicon&r=PG&f=1", "display_name": "Digvijay", "link": "https://stackoverflow.com/users/7796810/digvijay"}, "is_accepted": false, "score": 1, "last_activity_date": 1492604076, "creation_date": 1492604076, "answer_id": 43495464, "question_id": 43495066, "link": "https://stackoverflow.com/questions/43495066/vba-excel-evaluate-function-how-to-add-before-multipling/43495464#43495464", "title": "VBA Excel - Evaluate function - How to add before multipling", "body": "<pre><code>LR = Range(\"I\" &amp; Rows.Count).End(xlUp).Row\nRange(\"P2:P\" &amp; LR).formulaR1C1 = \"=(RC[-7]+RC[-6])*RC[-1]\"\n</code></pre>\n\n<p>This will do (I+J)*O</p>\n"}], "owner": {"reputation": 157, "user_id": 7495707, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5f55f2ae1b2d466f1b9ad3d211a074d6?s=128&d=identicon&r=PG&f=1", "display_name": "D. Todor", "link": "https://stackoverflow.com/users/7495707/d-todor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 43495361, "answer_count": 3, "score": 1, "last_activity_date": 1492605767, "creation_date": 1492602975, "question_id": 43495066, "link": "https://stackoverflow.com/questions/43495066/vba-excel-evaluate-function-how-to-add-before-multipling", "title": "VBA Excel - Evaluate function - How to add before multipling", "body": "<p>I have this piece of code right now:</p>\n\n<pre><code>    LR = Range(\"I\" &amp; Rows.Count).End(xlUp).Row\n    Range(\"P2:P\" &amp; LR) = Evaluate(\"I2:I\" &amp; LR &amp; \"*O2:O\" &amp; LR)\n</code></pre>\n\n<p>As you can see, this code is multipling each entry from the I column with the corresponding entry in the O column and putting that value into column P.</p>\n\n<p>Now I need to modify this code so it adds the respective values from colum I with the ones from column J and <strong>then</strong> multiplies that with the entry from column O. If I just write this</p>\n\n<pre><code>  Range(\"P2:P\" &amp; LR) = Evaluate(\"I2:I\" &amp; LR &amp; \"J2:J\" &amp; LR &amp; \"*O2:O\" &amp; LR)\n</code></pre>\n\n<p>it will obviously not work because it will mathematically multiply J with O before making a summ of I and J. How can I tell it to summ I and J together first?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "countif"], "comments": [{"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1492603315, "post_id": 43495032, "comment_id": 74044526, "body": "add the code you have tried with the question. Instead of explaining the formula, add the formula you used"}, {"owner": {"reputation": 1623, "user_id": 3080315, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dca9f77ce600fbae2b1cd16df56dba3e?s=128&d=identicon&r=PG&f=1", "display_name": "jz22", "link": "https://stackoverflow.com/users/3080315/jz22"}, "reply_to_user": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1492673214, "post_id": 43495032, "comment_id": 74079535, "body": "My attempt was so poor I thought it was better not to add it."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1492604141, "creation_date": 1492604141, "answer_id": 43495485, "question_id": 43495032, "link": "https://stackoverflow.com/questions/43495032/vba-macro-using-countif-with-three-columns/43495485#43495485", "title": "VBA macro using countif with three columns", "body": "<p>Since you have 3 conditions to your <code>Count</code> you need to use <code>CountIfs</code> function (and not <code>CountIf</code>).</p>\n\n<p>The code below will do the job for the 3 columns you've provided, and the example in your post:</p>\n\n<pre><code>Dim CountIfsRes As Long\n\nCountIfsRes = WorksheetFunction.CountIfs(Range(\"A:A\"), \"=long\", Range(\"B:B\"), \"=green\", Range(\"C:C\"), \"=10\")\n\nMsgBox CountIfsRes\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 7798223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56caec1d3c39ec58e886d25bb05d6235?s=128&d=identicon&r=PG&f=1", "display_name": "Joe W", "link": "https://stackoverflow.com/users/7798223/joe-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1492606326, "creation_date": 1492606326, "answer_id": 43496320, "question_id": 43495032, "link": "https://stackoverflow.com/questions/43495032/vba-macro-using-countif-with-three-columns/43496320#43496320", "title": "VBA macro using countif with three columns", "body": "<p>The answer above works if you want to know how many long green shirts there are. </p>\n\n<p>In the event you have multiple conditions you want to populate in a summary table you can adapt this formula to do so and insert the formula into a table.</p>\n\n<p><code>=COUNTIFS(A:A,\"long\",B:B,\"green\",C:C,\"10\")</code></p>\n"}], "owner": {"reputation": 1623, "user_id": 3080315, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dca9f77ce600fbae2b1cd16df56dba3e?s=128&d=identicon&r=PG&f=1", "display_name": "jz22", "link": "https://stackoverflow.com/users/3080315/jz22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1721, "favorite_count": 0, "accepted_answer_id": 43495485, "answer_count": 2, "score": 1, "last_activity_date": 1492606326, "creation_date": 1492602873, "last_edit_date": 1492603096, "question_id": 43495032, "link": "https://stackoverflow.com/questions/43495032/vba-macro-using-countif-with-three-columns", "title": "VBA macro using countif with three columns", "body": "<p>I have an Excel with three columns.</p>\n\n<pre><code>Column A:               Column B:    Column C:    \nshirts (long, short)    color        age\n</code></pre>\n\n<p>Now I need to find out how many long, green shirts there are with an age of 10. Of course I now how to filter it manually but I would like to do it automatically. Actually I have a much more complex Excel file with around 80k rows and I need to find out a couple more numbers. A solution for the above given example will do the job for me though. I will just adapt it to my actual file. I have found a few possible solutions but I think a simple countIf function will be the easiest or will it not be performant enough when it comes to over 80k rows? I also struggle to build a countIf function that uses two additional columns. I started to do it like this. Count the long shirts if the value of B is \"green\" and the value of column C is \"10\". Basically I would like to know if this is a proper solution and how the function could look like. </p>\n"}, {"tags": ["vba", "powerdesigner"], "comments": [{"owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "edited": false, "score": 0, "creation_date": 1492612739, "post_id": 43494682, "comment_id": 74051992, "body": "I don&#39;t know what it is you call &quot;overview&quot; in the context of PowerDesigner. Is it the symbols? If yes, how do you get the Table symbol to show the column description?"}, {"owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "edited": false, "score": 0, "creation_date": 1492612802, "post_id": 43494682, "comment_id": 74052055, "body": "If you save the model, and open it back, does it fix the mentioned table-overview? (in case this is a problem of cascading the Description update to all related places)"}, {"owner": {"reputation": 1, "user_id": 7889435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2aa5b8d835159380999510dc3c06794?s=128&d=identicon&r=PG&f=1", "display_name": "derzeit", "link": "https://stackoverflow.com/users/7889435/derzeit"}, "reply_to_user": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "edited": false, "score": 0, "creation_date": 1492681633, "post_id": 43494682, "comment_id": 74085019, "body": "Thanks for your comments. With &quot;overview&quot; I mean the window when you doubleclick a table. In this window there&#39;s a tab &quot;columns&quot;. Here you can see the names, datatypes... comments and description of the columns. And no, saving and reopening doesn&#39;t fix it..."}, {"owner": {"reputation": 3059, "user_id": 202367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca76b7b553fb6ccdf4982024c82200f3?s=128&d=identicon&r=PG", "display_name": "pascal", "link": "https://stackoverflow.com/users/202367/pascal"}, "edited": false, "score": 0, "creation_date": 1492702004, "post_id": 43494682, "comment_id": 74100947, "body": "I have no idea, it works for me... In the list of Columns, it is <code>Description Text</code>which is shown, not <code>Short Description</code>, correct? Can you add a snapshot of this Columns list to be sure... Also you could try using c.SetAttributeText instead of c.SetAttribute."}], "owner": {"reputation": 1, "user_id": 7889435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2aa5b8d835159380999510dc3c06794?s=128&d=identicon&r=PG&f=1", "display_name": "derzeit", "link": "https://stackoverflow.com/users/7889435/derzeit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 567, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492601922, "creation_date": 1492601922, "question_id": 43494682, "link": "https://stackoverflow.com/questions/43494682/changing-attributes-in-powerdesigner-via-vba-script", "title": "changing attributes in PowerDesigner via vba-script", "body": "<p>I have a data model in PowerDesigner. I wrote a vba-script that changes the description of a column to the value of the comment of the column. It does well. When I look at the column-properties I can see the new description. The problem is, that the new description does not appear in the table-overview. Only when I open the column-properties and close it with the ok-button, the new description appears in the table-overview. I have a lot of columns in my model, so... has it something to do with the object-hierarchy in PowerDesigner? My script:</p>\n\n<pre><code>option explicit\nDim kind, name, obj, c, a\nkind = InputBox(\"(T)able or (V)iew\")\nname = InputBox(\"Enter name\")\nIf kind = \"T\" Then\n  Set obj = ActiveModel.FindChildByName(name, cls_table)\nElseIf kind = \"V\" Then\n  Set obj = ActiveModel.FindChildByName(name, cls_view)\nEnd If\nFor each c in obj.columns\n  c.SetAttribute \"Description\", c.comment\nNext\n</code></pre>\n"}, {"tags": ["vba", "performance", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492601281, "post_id": 43494398, "comment_id": 74043129, "body": "add <code>Application.ScreenUpdating = False</code> in the begining of your code"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1492601290, "post_id": 43494398, "comment_id": 74043136, "body": "<a href=\"http://datapigtechnologies.com/blog/index.php/ten-things-you-can-do-to-speed-up-your-excel-vba-code/\" rel=\"nofollow noreferrer\">datapigtechnologies.com/blog/index.php/&hellip;</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492601356, "post_id": 43494398, "comment_id": 74043171, "body": "@ShaiRado but please don&#39;t forget to set it back to <code>Application.ScreenUpdating = True</code> before <code>End Sub</code>"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 3, "creation_date": 1492601583, "post_id": 43494398, "comment_id": 74043318, "body": "10,000 checkboxes add to the volume of your workbook making it slower just because of its size. Consider creating only a single checkbox and move it to the row you click on using the Worksheet_SelectionChange event."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1492602234, "post_id": 43494398, "comment_id": 74043776, "body": "Do it with one sheet and simply copy that column to the required sheet whenever you need it."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492603347, "post_id": 43494398, "comment_id": 74044550, "body": "I understand this issue and I find it unfortunate that excel does not provide some format to show a boolean cell in a checkbox-like format. I faced it, and had to beg users to get used to reading &quot;True / False&quot;... Placing a linked checkbox for each boolean cell is tedious and problematic, especially for large data. I didn&#39;t find a neat solution for this. Will happily grant a bounty for any eloquent solution (not one that adds hundreds of shapes, of course)."}, {"owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1492608057, "post_id": 43494398, "comment_id": 74048108, "body": "@Peh i did it, but unfortunately its not solution for my problem,"}, {"owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1492608062, "post_id": 43494398, "comment_id": 74048113, "body": "@JohnMuggins - each document has different numer of checkboxes."}, {"owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1492608069, "post_id": 43494398, "comment_id": 74048120, "body": "@Variatus - but u know i add checkbox for each row in specific range, your idea if i corretly understand it its i belive too hard for me to write ;)"}, {"owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492608099, "post_id": 43494398, "comment_id": 74048142, "body": "@A.S.H sad to hear it"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1492632457, "post_id": 43494398, "comment_id": 74064868, "body": "Can you use something other than a checkbox that the users can change with a simple click with onClick?  Like if Target = &quot;True&quot; then Target = &quot;False&quot; ELSE if Target = &quot;False&quot; then Target = &quot;True&quot;  Else if Target = &quot;&quot; then Target = &quot;False&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1492684428, "creation_date": 1492684428, "answer_id": 43517074, "question_id": 43494398, "link": "https://stackoverflow.com/questions/43494398/vba-excel-speed-up-macro-adding-checkboxes/43517074#43517074", "title": "VBA/Excel Speed up macro adding checkboxes", "body": "<p>Let's try this and see if it fits. Please paste the following code into a normal code module (by default 'Module1') of a blank workbook you create for this purpose. It is a module which doesn't exist in a new workbook. Don't use any of the existing.</p>\n\n<pre><code>Option Explicit\n\nEnum Nws                            ' Worksheet rows &amp; columns\n    ' 20 Apr 2017\n    NwsFirstDataRow = 2             ' adjust as required\n                                    ' Columns:\n    NwsMainData = 1                 ' (= A) Test for used range\n    NwsCheck = 7                    ' (= G) column for Check cell\nEnd Enum\n\nEnum Nck                            ' CheckBox\n    ' 20 Apr 2017\n    NckFalse\n    NckTrue\n    NckNotSet                       ' any value other than True or False\nEnd Enum\n\nSub SetCheckCell(Target As Range)\n    ' 20 Apr 2017\n\n    Dim TgtVal As Nck\n\n    With Target\n        If Len(.Value) Then\n            Select Case .Value\n                Case True\n                    TgtVal = NckFalse\n                Case False\n                    TgtVal = NckTrue\n                Case Else\n                    TgtVal = NckNotSet\n            End Select\n        Else\n            TgtVal = NckNotSet\n        End If\n\n        If TgtVal = NckNotSet Then\n            SetBorders Target\n            TgtVal = NckFalse\n        End If\n\n        .Value = CBool(Array(0, -1)(TgtVal))\n        With .Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = Array(xlThemeColorAccent6, xlThemeColorAccent3)(TgtVal)\n            .TintAndShade = 0.399945066682943\n            .PatternTintAndShade = 0\n        End With\n        .Offset(0, -1).Select\n    End With\nEnd Sub\n\nPrivate Sub SetBorders(Rng As Range)\n    ' 12 Apr 2017\n\n    Dim Brd As Long\n\n    For Brd = xlEdgeLeft To xlInsideHorizontal\n        SetBorder Rng, Brd\n    Next Brd\n    Rng.Borders(xlDiagonalDown).LineStyle = xlNone\n    Rng.Borders(xlDiagonalUp).LineStyle = xlNone\nEnd Sub\n\nPrivate Sub SetBorder(Rng As Range, _\n                      Brd As Long)\n    ' 12 Apr 2017\n\n    With Rng.Borders(Brd)\n        .LineStyle = xlContinuous\n        .ThemeColor = 1\n        .TintAndShade = -0.349986266670736\n        .Weight = xlMedium\n    End With\nEnd Sub\n</code></pre>\n\n<p>In column A, enter something - anything - in row 10 (or thereabouts). This is the last \"used\" row in your worksheet. </p>\n\n<p>Now paste the following code in the code sheet of the worksheet on which you created a last \"used\" row. It must be exactly that code sheet - no other. It is a sheet which already exists. You recognise it by the tab's name in the VBE's project explorer window.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    ' 20 Apr 2017\n\n    Dim Rng As Range                    ' used range (almost)\n    Dim Rl As Long                      ' last row\n\n    Application.EnableEvents = False\n    With Target.Worksheet\n        Rl = .Cells(.Rows.Count, NwsMainData).End(xlUp).Row\n        Set Rng = .Range(.Cells(NwsFirstDataRow, NwsCheck), .Cells(Rl, NwsCheck))\n        If Not Application.Intersect(Target, Rng) Is Nothing Then\n            SetCheckCell .Cells(Target.Row, NwsCheck)\n        End If\n    End With\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Now you are all set to test but understand the mechanics first. At the top of the first batch of code you have <code>Enum Nws</code> which specifies one row and two columns. The specified row is <code>NwsFirstDataRow</code> with an assigned value of 2. It means that row 1 is outside the scope of this code. The code will not run when you click in row 1 (presumably a caption row). You could set <code>NwsFirstDataRow</code> to a value of 3, thereby creating 2 header rows which the code won't touch.</p>\n\n<p>The two columns are <code>NwsMainData</code> and <code>NwsCheck</code>. <code>NwsMainData</code> is the column where the last row is measured. If you click below the last row the code will not run. You might find that column A doesn't suit your needs. You can set any other value, thereby specifying another column. The number you set is used for no other purpose but to find the last row. In your test, make sure the column actually has a used row.</p>\n\n<p><code>NwsCheck</code> is the column where you will have your \"check box\". You can specify any column. Try it out in a little while. The point is that the code will not run if you click any other column. Therefore, the code will run if you click in the <code>NwsCheck</code> column, at or below <code>NwsFirstDataRow</code> and at or above the last \"used\" row. Go ahead an click.</p>\n\n<p>Since the cell is empty it will be coloured as a checkbox and filled with the word \"False\". Click it again and it will change colour and value will be True. It continues to toggle. The cursor moves to the left to allow you to toggle.</p>\n\n<p>You could move the cursor right or up or down. You could change the colours to any colour Excel has on offer. You can change the frame from the one I have selected. You can change the words which are shown. In fact, there is very little you couldn't change - and it isn't difficult.</p>\n\n<p>The question is whether the idea can be adapted to do the job you want a check box to do.</p>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1492784809, "creation_date": 1492784809, "answer_id": 43545212, "question_id": 43494398, "link": "https://stackoverflow.com/questions/43494398/vba-excel-speed-up-macro-adding-checkboxes/43545212#43545212", "title": "VBA/Excel Speed up macro adding checkboxes", "body": "<p>Here is a variation of the above. Instead of writing TRUE or FALSE, it actually gives you a checkbox-character which is either checked or not. The code displays a message box informing you of the status, but the idea is to execute whatever code you want to run instead, based on whether the box is checked or not.</p>\n\n<p>To test this code, add this procedure to the normal code module. Some of the above code will be required for this solution. For the purpose of testing, just have the entire previous code installed. Then add this.</p>\n\n<pre><code>Function SetCheck(Cell As Range) As Boolean\n    ' 21 Apr 2017\n\n    Dim Fun As Integer\n    Dim Chars() As Variant\n    Dim Mark As Integer                     ' character current displayed\n\n    Chars = Array(168, 254)                 ' unchecked / checked box\n    With Cell\n        If Len(.Value) Then Mark = AscW(.Value)\n        Fun = IIf(Mark = Int(Chars(0)), 1, 0)\n        With .Font\n            .Name = \"Wingdings\"\n                .Size = 11\n        End With\n        .Value = ChrW(Chars(Fun))\n        .Offset(0, 1).Select\n    End With\n\n    SetCheck = CBool(Fun)\nEnd Function\n</code></pre>\n\n<p>Replace the existing event procedure with the one below. The difference is minute, but for quick testing, just replace all of it.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    ' 21 Apr 2017\n\n    Dim Rng As Range                    ' used range (almost)\n    Dim Rl As Long                      ' last row\n    Dim Chk As Boolean\n\n    Application.EnableEvents = False\n    With Target.Worksheet\n        Rl = .Cells(.Rows.Count, NwsMainData).End(xlUp).Row\n        Set Rng = .Range(.Cells(NwsFirstDataRow, NwsCheck), .Cells(Rl, NwsCheck))\n        If Not Application.Intersect(Target, Rng) Is Nothing Then\n'            SetCheckCell .Cells(Target.Row, NwsCheck)\n            Chk = SetCheck(Target.Cells(1))\n            MsgBox \"The checkbox is now \" &amp; IIf(Chk, \"\", \"un\") &amp; \"checked\"\n        End If\n    End With\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7866338, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a85723cb68d69d27391309aaf31731be?s=128&d=identicon&r=PG&f=1", "display_name": "Ttrx", "link": "https://stackoverflow.com/users/7866338/ttrx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 593, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492784809, "creation_date": 1492601125, "last_edit_date": 1492607508, "question_id": 43494398, "link": "https://stackoverflow.com/questions/43494398/vba-excel-speed-up-macro-adding-checkboxes", "title": "VBA/Excel Speed up macro adding checkboxes", "body": "<p>I need to add checkbox for each row in few documents and I have script for that which working, and that's ok but...\nIf I have 10k rows then this script it's very slowly. How I can speed up it?CODE:</p>\n\n<pre><code>Sub AddCheckBoxes()\n    Dim chk As CheckBox\n    Dim myRange As Range, cel As Range\n    Dim ws As Worksheet\n\n    Set ws = Sheets(\"\") 'adjust sheet to your need\n    Set myRange = ws.Range(\"A65:A75\") ' adjust range to your needs\n\n    For Each cel In myRange\n        Set chk = ws.CheckBoxes.Add(cel.Left, cel.Top, 30, 6) 'you can adjust left, top, height, width to your needs\n        With chk\n            .Caption = \"Valid\"\n            .LinkedCell = cel.Range(\"B65:B75\").Address\n        End With\n    Next \nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492600292, "post_id": 43493998, "comment_id": 74042388, "body": "The standard way to move a form/dialog around the screen is using the titlebar."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1492600305, "post_id": 43493998, "comment_id": 74042401, "body": "The code in the differently titled duplicate does exactly what you want."}], "owner": {"reputation": 73, "user_id": 3822565, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/13395e5f24c373d7b764de69053b3cf7?s=128&d=identicon&r=PG&f=1", "display_name": "user3822565", "link": "https://stackoverflow.com/users/3822565/user3822565"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "closed_date": 1492600287, "answer_count": 0, "score": 0, "last_activity_date": 1492600019, "creation_date": 1492600019, "question_id": 43493998, "link": "https://stackoverflow.com/questions/43493998/vba-how-move-a-user-form-without-titlebar-and-borders", "closed_reason": "Duplicate", "title": "VBA how move a user form without titlebar and borders", "body": "<p>I am using this code <a href=\"https://social.msdn.microsoft.com/Forums/vstudio/en-US/17452849-598c-410b-8675-b1e585d0e7e7/userform-without-titlebar-and-borders?forum=exceldev\" rel=\"nofollow noreferrer\">VBA Code</a> to UserForm without titlebar and borders.\nWorks perfectly ok but I would like to allow the user to  move around the displayed userform in the screen. Ad the moment I display the form on the bottom of the screen   </p>\n\n<pre><code>Private Sub UserForm_Initialize()     \n    Call RemoveTitleBar(Me)     \nEnd Sub\n</code></pre>\n\n<p>Code in Module:</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function FindWindow Lib \"User32\" _\nAlias \"FindWindowA\" ( _\nByVal lpClassName As String, _\nByVal lpWindowName As String) As Long\n\nPrivate Declare Function GetWindowLong Lib \"User32\" _\nAlias \"GetWindowLongA\" ( _\nByVal hwnd As Long, _\nByVal nIndex As Long) As Long\n\nPrivate Declare Function SetWindowLong Lib \"User32\" _\nAlias \"SetWindowLongA\" (ByVal hwnd As Long, _\nByVal nIndex As Long, _\nByVal dwNewLong As Long) As Long\n\nPrivate Declare Function DrawMenuBar Lib \"User32\" ( _\nByVal hwnd As Long) As Long\n\nSub RemoveTitleBar(frm As Object)\n    Dim lStyle          As Long\n    Dim hMenu           As Long\n    Dim mhWndForm       As Long\n\n    If Val(Application.Version) &lt; 9 Then\n        mhWndForm = FindWindow(\"ThunderXFrame\", frm.Caption) 'for Office 97 version\n    Else\n        mhWndForm = FindWindow(\"ThunderDFrame\", frm.Caption) 'for office 2000 or above\n    End If\n    lStyle = GetWindowLong(mhWndForm, -16)\n    lStyle = lStyle And Not &amp;HC00000\n    SetWindowLong mhWndForm, -16, lStyle\n    DrawMenuBar mhWndForm\nEnd Sub\n\nSub ShowForm()\n    UserForm.Show False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 5, "creation_date": 1492600055, "post_id": 43493869, "comment_id": 74042244, "body": "<code>to_do.Range(G4)</code> isn&#39;t a valid definition. It should be `to_do.Range(&quot;G4&quot;) and I would suggest that you use the Value property unless it is a formula you wish to assign, but your code assigns a Value (default)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1492600253, "post_id": 43493869, "comment_id": 74042360, "body": "<code>to_do.Range(&quot;G4&quot;).Formula = </code>, dont forget the double-quotes. You could spot it immediately if you had set <code>Option Explicit</code>..."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1492601210, "post_id": 43493869, "comment_id": 74043078, "body": "@Variatus I think you should add it as an answer"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492601359, "post_id": 43493869, "comment_id": 74043173, "body": "Thank you, @Shai Rado. A.S.H. didn&#39;t, either :-)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1492601449, "post_id": 43493869, "comment_id": 74043234, "body": "@Variatus LOL it&#39;s about who is first, it&#39;s about having an answer here when somone in the future searches for this topic and looking for an answer - he will se an answer here with <b>V</b> mark and some up-votes, then he&#39;ll know he got a reliable answer"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 3, "last_activity_date": 1492602142, "last_edit_date": 1492602142, "creation_date": 1492601896, "answer_id": 43494672, "question_id": 43493869, "link": "https://stackoverflow.com/questions/43493869/unknown-index-match-issue/43494672#43494672", "title": "Unknown index match issue", "body": "<p><code>to_do.Range(G4)</code> isn't a valid definition. It should be <code>to_do.Range(\"G4\")</code>. @A.S.H. pointed out correctly that your VBA would highlight the error first time you run the code if you'll use <code>Option Explicit</code> at the top of your code sheet.</p>\n\n<p>I suggest that you use the <code>Value</code> property to assign the value to, unless it is a <code>Formula</code> you wish to assign, but your code assigns a value because the <code>INDEX</code> function returns a range for which the <code>Value</code> property is the default. If you wanted the formula you would have to specify it. </p>\n"}, {"tags": [], "owner": {"reputation": 613, "user_id": 6227808, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/agzBm.jpg?s=128&g=1", "display_name": "Guilherme Felipe Reis", "link": "https://stackoverflow.com/users/6227808/guilherme-felipe-reis"}, "is_accepted": false, "score": 1, "last_activity_date": 1492602510, "creation_date": 1492602510, "answer_id": 43494903, "question_id": 43493869, "link": "https://stackoverflow.com/questions/43493869/unknown-index-match-issue/43494903#43494903", "title": "Unknown index match issue", "body": "<p>You quickly can solve your problem given the Worksheet names, so you don't need declare them in your code. \nYou're intending to print a formula in a cell, so you also can use the FormulaR1C1. \nMy solution for your problem is that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/k4YzX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k4YzX.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>wsTodo.Range(\"G4\").FormulaR1C1 = \"=INDEX('\" &amp; wsWorkingFile.Name &amp; \"'!C6,MATCH(R4C2,'\" &amp; wsWorkingFile.Name &amp; \"'!C2))\"\n</code></pre>\n\n<p>For the change the goes to VBAproject click in the worksheet and give it a name in the property (name).</p>\n\n<p><a href=\"https://i.stack.imgur.com/WDPYg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WDPYg.png\" alt=\"enter image description here\"></a></p>\n\n<p>What do you solved with this code:</p>\n\n<ul>\n<li>You don't need to worry about if the sheet changes names</li>\n<li>You can code quicker if you change the name of the plans</li>\n<li>You don't need to declare the sheet everytime</li>\n</ul>\n"}], "owner": {"reputation": 165, "user_id": 6585781, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-UCNEBiM5n4s/AAAAAAAAAAI/AAAAAAAAFTQ/vCKAzM-nnwY/photo.jpg?sz=128", "display_name": "Jake Walker", "link": "https://stackoverflow.com/users/6585781/jake-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 43494672, "answer_count": 2, "score": -1, "last_activity_date": 1492602510, "creation_date": 1492599690, "last_edit_date": 1492601534, "question_id": 43493869, "link": "https://stackoverflow.com/questions/43493869/unknown-index-match-issue", "title": "Unknown index match issue", "body": "<p>I get the error for the code below </p>\n\n<blockquote>\n  <p>Method 'Range' of object '_Worksheet' failed. </p>\n</blockquote>\n\n<p>Can anyone see what the issue is here?</p>\n\n<pre><code>Dim to_do As Worksheet, ordered As Worksheet\nSet to_do = Sheets(\"To do log\")\nSet ordered = Sheets(\"Working File\")\n\nto_do.Range(G4).Formula = _ \n   Application.WorksheetFunction.Index(ordered.Range(\"F:F\"), _\n   Application.Match(to_do.Range(\"B4\"), ordered.Range(\"B:B\"), 0))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "is_accepted": true, "score": 2, "last_activity_date": 1492599440, "creation_date": 1492599440, "answer_id": 43493777, "question_id": 43493643, "link": "https://stackoverflow.com/questions/43493643/replace-whole-cell-with-formula-if-it-contains-particular-string/43493777#43493777", "title": "Replace whole cell with formula if it contains particular string", "body": "<p>Use asterisk to mask other cell contents. So you have to search and replace the following line: <code>*searchText*</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/czZnM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/czZnM.png\" alt=\"enter image description here\"></a></p>\n\n<p>In VBA that would look like this:</p>\n\n<pre><code>Cells.Replace What:=\"*searchText*\", Replacement:=\"=1+1\"\n</code></pre>\n"}], "owner": {"reputation": 961, "user_id": 6931023, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7cc82083efe850c5de040e3beb53b74e?s=128&d=identicon&r=PG&f=1", "display_name": "gladiator", "link": "https://stackoverflow.com/users/6931023/gladiator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3847, "favorite_count": 0, "accepted_answer_id": 43493777, "answer_count": 1, "score": 0, "last_activity_date": 1492599440, "creation_date": 1492599147, "last_edit_date": 1531161705, "question_id": 43493643, "link": "https://stackoverflow.com/questions/43493643/replace-whole-cell-with-formula-if-it-contains-particular-string", "title": "Replace whole cell with formula if it contains particular string", "body": "<p>I want to Replace whole cell with  a formula  if it contains particular string (searchText) , but find and replace is not just replacing <strong>searchText</strong> with formula and not removing other contents of cell.</p>\n\n<p>Can anyone help.</p>\n"}, {"tags": ["excel", "sharepoint", "vbscript", "automation", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2107, "user_id": 65164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WSUpz.jpg?s=128&g=1", "display_name": "Mark Mascolino", "link": "https://stackoverflow.com/users/65164/mark-mascolino"}, "is_accepted": false, "score": 0, "last_activity_date": 1493298653, "creation_date": 1493298653, "answer_id": 43658882, "question_id": 43493087, "link": "https://stackoverflow.com/questions/43493087/is-it-possible-to-automate-sharepoint-usage-reports/43658882#43658882", "title": "Is it possible to automate Sharepoint usage reports?", "body": "<p>Yes.  For on premise SharePoint, the place in the API that you should be looking is the Microsoft.SharePoint.SPAuditQuery class.  This is where you can specify your criteria for what alerts you want and then use it to query the list of audit items to get all the data that you need.  Here is the SPAuditQuery class:\n<a href=\"https://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spauditquery.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spauditquery.aspx</a>\nand an overall look at the process:\n<a href=\"http://spuser.blogspot.com/2011/10/spaudit-how-to-read-from-audit-log.html\" rel=\"nofollow noreferrer\">http://spuser.blogspot.com/2011/10/spaudit-how-to-read-from-audit-log.html</a></p>\n"}], "owner": {"reputation": 3, "user_id": 7889086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86a8122521fd6a20bdb10d4a95362598?s=128&d=identicon&r=PG&f=1", "display_name": "Joy D&#39;souza", "link": "https://stackoverflow.com/users/7889086/joy-dsouza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 816, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494311426, "creation_date": 1492597757, "last_edit_date": 1531161705, "question_id": 43493087, "link": "https://stackoverflow.com/questions/43493087/is-it-possible-to-automate-sharepoint-usage-reports", "title": "Is it possible to automate Sharepoint usage reports?", "body": "<p>I need to generate reports of sites every week. These reports include page hits, views etc. Currently i need to go to site settings->Audit reports and then select the period and generate them and paste them in excel. Is there a way to automate this?</p>\n"}, {"tags": ["excel", "vba", "conditional-formatting"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1492597729, "post_id": 43492434, "comment_id": 74040558, "body": "Try recording a macro while setting conditional formatting using top border format. You will see, that <code>Excel</code> itself will using <code>.Borders(xlTop)</code> instead of <code>.Borders(xlEdgeTop)</code>. So probably <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837809.aspx\" rel=\"nofollow noreferrer\">Borders Object</a> for ranges differs from <code>Borders</code> collection from  <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196030.aspx\" rel=\"nofollow noreferrer\">FormatCondition.Borders</a> in this not documented way."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1492596751, "creation_date": 1492596751, "answer_id": 43492700, "question_id": 43492434, "link": "https://stackoverflow.com/questions/43492434/vba-apply-conditional-formatting-top-bottom-border-only/43492700#43492700", "title": "Vba apply conditional formatting top/bottom border only?", "body": "<p>This is what I use for border ranges:</p>\n\n<pre><code>Public Sub BorderMe(my_range)\n\n    Dim l_counter   As Long\n\n    For l_counter = 7 To 10 '7 to 10 are the magic numbers for xlEdgeLeft etc\n        With my_range.Borders(l_counter)\n            .LineStyle = xlContinuous\n            .Weight = xlMedium\n        End With\n    Next l_counter\n\nEnd Sub\n</code></pre>\n\n<p>You may edit the color, the weight, style and etc.\nThe magic ist that 7,8,9 and 10 are the numbers of Excel for <code>xlEdgeLeft</code>, <code>xlEdgeRight</code>, <code>xlEdgeTop</code> and <code>xlEdgeBottom</code>.</p>\n\n<p>Run it like this:<code>call borderme(selection)</code> in the immediate window, to see what is does.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7889216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b66882f109a98acba647887202004b3?s=128&d=identicon&r=PG&f=1", "display_name": "MaddyN", "link": "https://stackoverflow.com/users/7889216/maddyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1492598676, "creation_date": 1492598676, "answer_id": 43493456, "question_id": 43492434, "link": "https://stackoverflow.com/questions/43492434/vba-apply-conditional-formatting-top-bottom-border-only/43493456#43493456", "title": "Vba apply conditional formatting top/bottom border only?", "body": "<pre><code>   Rng.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=10\"\nRng.FormatConditions(Rng.FormatConditions.Count).SetFirstPriority\nWith Rng.FormatConditions(Rng.FormatConditions.Count).Borders(xlTop)\n    .LineStyle = xlContinuous\n    .TintAndShade = 0\n    .Weight = xlThin\n    .Color = vbRed\nEnd With\nWith Rng.FormatConditions(Rng.FormatConditions.Count).Borders(xlBottom)\n    .LineStyle = xlContinuous\n    .TintAndShade = 0\n    .Weight = xlThin\n    .Color = vbRed\nEnd With\n</code></pre>\n\n<p>Try this code dont forget to set rng Set Rng = Range(\"\")</p>\n"}, {"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1492599510, "creation_date": 1492599510, "answer_id": 43493798, "question_id": 43492434, "link": "https://stackoverflow.com/questions/43492434/vba-apply-conditional-formatting-top-bottom-border-only/43493798#43493798", "title": "Vba apply conditional formatting top/bottom border only?", "body": "<p>Try it like this...</p>\n\n<pre><code>Sub ResetConditions()\n    Dim ws As Worksheet\n    Dim Rng As Range\n    Dim n As Integer\n    Set ws = Sheets(1)\n    Set Rng = ws.Range(\"A9:P1048576\")\n\n    Rng.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=ROW(B9)=ROW(OFFSET($B$9,COUNTA($B:$B)-2,0))\"\n    n = Rng.FormatConditions.Count\n    Rng.FormatConditions(n).SetFirstPriority\n    With Rng.FormatConditions(n).Borders(xlTop)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n        .Color = vbRed\n    End With\n    With Rng.FormatConditions(n).Borders(xlBottom)\n        .LineStyle = xlContinuous\n        .Weight = xlThin\n        .Color = vbRed\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3612, "favorite_count": 0, "accepted_answer_id": 43493798, "answer_count": 3, "score": 0, "last_activity_date": 1492599510, "creation_date": 1492596076, "question_id": 43492434, "link": "https://stackoverflow.com/questions/43492434/vba-apply-conditional-formatting-top-bottom-border-only", "title": "Vba apply conditional formatting top/bottom border only?", "body": "<p>I am using the following vba code to apply conditional formatting.</p>\n\n<pre><code>Sub ResetConditions()\n    With Worksheets(1).Range(\"A9:P1048576\")\n        .FormatConditions.Add Type:=xlExpression, Formula1:= _\n          \"=ROW(B9)=ROW(OFFSET($B$9,COUNTA($B:$B)-2,0))\"\n        With .FormatConditions(.FormatConditions.Count)\n            .SetFirstPriority\n\n            With .Borders\n            .LineStyle = xlContinuous\n            .Weight = xlThin\n            .Color = vbRed\n            End With\n\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>The border is showing as this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NiPCq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NiPCq.png\" alt=\"enter image description here\"></a></p>\n\n<p>But i want it to look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/31Zgc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/31Zgc.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am trying to set only top/bottom borders like so:</p>\n\n<pre><code>Sub ResetConditions()\n        With Worksheets(1).Range(\"A9:P1048576\")\n            .FormatConditions.Add Type:=xlExpression, Formula1:= _\n              \"=ROW(B9)=ROW(OFFSET($B$9,COUNTA($B:$B)-2,0))\"\n            With .FormatConditions(.FormatConditions.Count)\n                .SetFirstPriority\n\n                With .Borders(xlEdgeTop)\n                .LineStyle = xlContinuous\n                .Weight = xlThin\n                .Color = vbRed\n                End With\n\n            End With\n        End With\n    End Sub\n</code></pre>\n\n<p>But i keep getting an error unable to set linestyle property of border class.</p>\n\n<p>Please can someone show me where i am going wrong?</p>\n"}, {"tags": ["vba", "excel", "variables", "variable-declaration"], "comments": [{"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 4, "creation_date": 1492596138, "post_id": 43492353, "comment_id": 74039490, "body": "If a variable isn&#39;t declared but is used then it is created late as a variant, if option explicit isn&#39;t present then it is accepted usage (not best practice though). It is likely that the old workbook did not have option explicit whereas the new one does."}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "reply_to_user": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1492596289, "post_id": 43492353, "comment_id": 74039580, "body": "@Zerk : YES . I totally fogot this detail. You&#39;re right ! I just checked thanks"}], "answers": [{"comments": [{"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1492596620, "post_id": 43492489, "comment_id": 74039811, "body": "Slow and clean solution IS the solution ... your answer is the wrong way around?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "edited": false, "score": 0, "creation_date": 1492596820, "post_id": 43492489, "comment_id": 74039982, "body": "Well, if you have 50.000 lines of code and a deadline in 30 minutes, you can risk it a bit. @whytheq"}, {"owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "edited": false, "score": 0, "creation_date": 1492597290, "post_id": 43492489, "comment_id": 74040283, "body": "Yeah it&#39;s simply way better to add it. It prevents spelling mistakes from being unseen also. I already set the <i>Require variable Declaration</i> option a while ago but this one wasn&#39;t done by me that&#39;s why."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1492597333, "post_id": 43492489, "comment_id": 74040314, "body": "Better to push the deadline back and get a correct result, rather than stick to the deadline and lose billions due to a misplaced decimal point."}, {"owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1492600548, "post_id": 43492489, "comment_id": 74042617, "body": "@DarrenBartrup-Cook not another xl related World economic meltdown .... Seb: BE CAREFUL!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1492607910, "last_edit_date": 1492607910, "creation_date": 1492596194, "answer_id": 43492489, "question_id": 43492353, "link": "https://stackoverflow.com/questions/43492353/hidden-variable-declaration-vba/43492489#43492489", "title": "Hidden variable declaration VBA", "body": "<p><strong>Worst case, quick and dirty scenario</strong> - remove <code>Option Explicit</code> from each module, class, workbook and worksheet. It makes sure, that all variables are declared. E.g., try running the following code:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n    k = 5\n    Debug.Print k\n\nEnd Sub\n</code></pre>\n\n<p>You cannot. Then add <code>dim k as long</code> after <code>Sub TestMe()</code>. Or remove the <code>Option Explicit</code>. Now you can run it.</p>\n\n<p><strong>Slow and clean solution:</strong> Check all variables, which are highlighted when you try to run the code and declare them. Your code would run faster.</p>\n"}], "owner": {"reputation": 476, "user_id": 7094856, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c545807801dd38b033d9d23fc9fc2922?s=128&d=identicon&r=PG&f=1", "display_name": "Seb", "link": "https://stackoverflow.com/users/7094856/seb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "accepted_answer_id": 43492489, "answer_count": 1, "score": 2, "last_activity_date": 1492607910, "creation_date": 1492595857, "question_id": 43492353, "link": "https://stackoverflow.com/questions/43492353/hidden-variable-declaration-vba", "title": "Hidden variable declaration VBA", "body": "<p><strong>Question :</strong> Is it possible that the declaration of some variables is \"hidden\" in VBA ?</p>\n\n<p><strong>Situation :</strong></p>\n\n<p>I have an Excel file with lots of modules but for some reasons whenever we open it this message shows up <a href=\"https://i.stack.imgur.com/kIqFG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kIqFG.png\" alt=\"\"></a> and I tried some \"solutions\" found on some forums with no success -> I decided to copy sheet by sheet and module by module the whole thing in a new \"clean\" excel file.</p>\n\n<p><strong>Issue :</strong> A code doesn't run saying that variable XXX is not declared (ok...makes sense), but I checked in the corrupted file and even though it is not declared anywhere neither (I checked with the Finder in the whole project) the code in question can run...Confusing !</p>\n\n<p>Any explanations for this ?</p>\n"}, {"tags": ["vba", "ms-word", "textbox", "userform", "multilinestring"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1492598236, "post_id": 43491976, "comment_id": 74040894, "body": "Your second attempt has the correct syntax which is why it doesn&#39;t produce an error, but the What-string isn&#39;t found because vbLf is a long, not a string, and though VBA probably manages to coerce the number into a string it isn&#39;t a number you are looking for. Off the top of my head I don&#39;t know which string the TextBox uses. It could be Chr(10) or Chr(11) or perhaps Chr(10) &amp; Chr(13) - or the other way around. You can enter this like <code>What:=Chr(11)</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1493133480, "post_id": 43491976, "comment_id": 74278386, "body": "@Variatus <code>vbLF</code> is undoubtedly a string. It&#39;s just not the correct string to use in this context, apparently :) (Try <code>?TypeName(vbLF)</code> in the Immediate window if you&#39;d like)"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1493164042, "post_id": 43491976, "comment_id": 74294474, "body": "Thank you @David Zemens. Looks can be deceiving, then :-)"}], "answers": [{"tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": true, "score": 1, "last_activity_date": 1493128550, "creation_date": 1493128550, "answer_id": 43612715, "question_id": 43491976, "link": "https://stackoverflow.com/questions/43491976/how-to-convert-a-multi-line-string-input-from-an-textbox-in-a-userform-to-a-si/43612715#43612715", "title": "How to convert a multi line string input from an textbox (in a userform) to a single line input string (vba word)", "body": "<p>In Word, you have to consider the carriage return as well. There are three ways doing it your way:</p>\n\n<pre><code>'Replace function\nTextBox1.Text = Replace(TextBox1.Text, vbCr + vbLf, \"\")\nTextBox1.Text = Replace(TextBox1.Text, Chr(10) + Chr(13), \"\")\nTextBox1.Text = Replace(TextBox1.Text, vbCrLf, \"\")\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6761170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ebb65ef564a46345b2ad33c9f2855dc?s=128&d=identicon&r=PG&f=1", "display_name": "Donfernando", "link": "https://stackoverflow.com/users/6761170/donfernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "accepted_answer_id": 43612715, "answer_count": 1, "score": 0, "last_activity_date": 1593764806, "creation_date": 1492594935, "last_edit_date": 1593764806, "question_id": 43491976, "link": "https://stackoverflow.com/questions/43491976/how-to-convert-a-multi-line-string-input-from-an-textbox-in-a-userform-to-a-si", "title": "How to convert a multi line string input from an textbox (in a userform) to a single line input string (vba word)", "body": "<p>I have created a user form on VBA (word) where the user inputs a body of multi line text into TextBox1. I wish to convert this into a single line string. I have tried the following:</p>\n\n<pre><code>'Replace method \nTextBox1.Text = TextBox1.Text.Replace what:=vbFl replacement:=\"\"\n</code></pre>\n\n<p>This results in 'invalid qualifier' with regards to the .Text</p>\n\n<pre><code>'Replace function\nTextBox1.Text = Replace(TextBox1.Text, vbLf, \"\")\n</code></pre>\n\n<p>This produces no error but doesn't carry out the required conversion. </p>\n"}, {"tags": ["vba", "excel", "date"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 1, "creation_date": 1492595707, "post_id": 43492149, "comment_id": 74039159, "body": "Thank you! I actually have tried with the code, and it wasnt working, and your reply just made me double checked my code, and found there was &quot;)&quot; missing!!  now its working fine!! :)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 0, "creation_date": 1492595853, "post_id": 43492149, "comment_id": 74039254, "body": "@rei123 you are welcome. Good to know it is fixed :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1492595352, "creation_date": 1492595352, "answer_id": 43492149, "question_id": 43491916, "link": "https://stackoverflow.com/questions/43491916/vba-month-function/43492149#43492149", "title": "VBA Month() function", "body": "<p>Looks ok, just try changing your formula into this:</p>\n\n<pre><code>.Range(\"B2\").Resize(Lastrow - 1).Formula = \"=MONTH(A2)&lt;&gt;MONTH(TODAY())\"\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 43492149, "answer_count": 1, "score": 1, "last_activity_date": 1492595352, "creation_date": 1492594780, "last_edit_date": 1495540474, "question_id": 43491916, "link": "https://stackoverflow.com/questions/43491916/vba-month-function", "title": "VBA Month() function", "body": "<p>first, apology for my english. Im working on something very similar to post <a href=\"https://stackoverflow.com/questions/25033022/macro-delete-rows-based-on-date\">Macro - delete rows based on date</a></p>\n\n<p>but my date data are in a reverse order, it sort from newest to oldest.</p>\n\n<p>The code provided by Dan Wagner didnt work out for me, as when I run the code it didnt do anything. </p>\n\n<p>I have got a code here that work fine if i manually set the month to be less than a value.  <code>.Range(\"B2\").Resize(Lastrow - 1).Formula = \"=AND(MONTH(A2)&lt;&gt;4)\"</code></p>\n\n<p>I want the code to delete rows if the month of the date in column A is not the current month. So i tried the code with <code>.Range(\"B2\").Resize(Lastrow - 1).Formula = \"=AND(MONTH(A2)&lt;&gt;Month(Date))\"</code> but it only deleted my headers.</p>\n\n<p>So i want to know if there is anything that can change the month(Date) function to number? or if there is any other best way of doing this?\nsee my full code below</p>\n\n<pre><code>Sub ProcessData2()\n    Dim rng As Range\n    Dim Lastrow As Long\n    Dim i As Long\n\n    With ActiveSheet\n\n        Lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        .Columns(2).Insert\n        .Range(\"B1\").Value = \"tmp\"\n        .Range(\"B2\").Resize(Lastrow - 1).Formula = \"=AND(MONTH(A2)&lt;&gt;Month(Date))\"\n        Set rng = .Range(\"A1\").Resize(Lastrow, 2)\n        rng.AutoFilter Field:=2, Criteria1:=\"=TRUE\"\n        On Error Resume Next\n        Set rng = .Range(\"B2\").Resize(Lastrow - 1).SpecialCells(xlCellTypeVisible)\n        On Error GoTo 0\n        If Not rng Is Nothing Then rng.EntireRow.Delete\n        .Columns(2).Delete\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1492592739, "post_id": 43491117, "comment_id": 74037035, "body": "How many cores does your machine have? VBA runs in a single threaded apartment."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492592855, "post_id": 43491117, "comment_id": 74037102, "body": "Is <code>CTO</code> an object?  If so, what type?  You are doing a <code>Set CTO = op.Range(&quot;J1&quot;)</code> as well as a <code>CTO = CP.Cells(C.Row, 1).Value</code> which seems .... strange."}, {"owner": {"reputation": 43, "user_id": 7888634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1045488de1ac37f7a83e7af434f11443?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Goh", "link": "https://stackoverflow.com/users/7888634/evan-goh"}, "edited": false, "score": 0, "creation_date": 1492592908, "post_id": 43491117, "comment_id": 74037136, "body": "CPU Spec: Intel Core i5-6300U @ 2.40 Ghz RAM 8GB"}, {"owner": {"reputation": 43, "user_id": 7888634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1045488de1ac37f7a83e7af434f11443?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Goh", "link": "https://stackoverflow.com/users/7888634/evan-goh"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492593111, "post_id": 43491117, "comment_id": 74037278, "body": "@YowE3K  I still relatively new to excel VBA but this coding seems to do what it is intended, feel free to re-code it if there is a much better way"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1492593145, "post_id": 43491117, "comment_id": 74037308, "body": "First thing I would try is to disable them all: EnableEvents=false: ScreenUpdating=false and especially Calculation=xlManual..."}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1492593192, "post_id": 43491117, "comment_id": 74037346, "body": "@YowE3K it&#39;s likely a variant otherwise it would error. My assumption on this is there&#39;s probably a huge amount of transactions going on, so many adjustments to cell values. Evan consider loading the data into an array and doing the edit operations there instead, then pasting the array back to the sheet."}, {"owner": {"reputation": 43, "user_id": 7888634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1045488de1ac37f7a83e7af434f11443?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Goh", "link": "https://stackoverflow.com/users/7888634/evan-goh"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1492594108, "post_id": 43491117, "comment_id": 74037976, "body": "@A.S.H Thanks for the tip, i put the Calculation=xlManual before the For Loop and Calculation=xlAutomatic just after now the code runs 100x faster Thanks everyone"}], "answers": [{"tags": [], "owner": {"reputation": 216, "user_id": 7034705, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U1yFv.jpg?s=128&g=1", "display_name": "ArindamD", "link": "https://stackoverflow.com/users/7034705/arindamd"}, "is_accepted": false, "score": 1, "last_activity_date": 1492595983, "last_edit_date": 1492595983, "creation_date": 1492595495, "answer_id": 43492205, "question_id": 43491117, "link": "https://stackoverflow.com/questions/43491117/excel-vba-for-loop-causes-100-cpu/43492205#43492205", "title": "Excel VBA for loop causes 100% CPU", "body": "<p>It seems you fell in a trap which has the following features:</p>\n\n<ol>\n<li>You are using a large excel file which is several MB in size</li>\n<li>The excel document is full of formula and data connection</li>\n<li>Additionally it might have pivot tables and charts</li>\n<li>Calculation option for Formula is Automatic</li>\n</ol>\n\n<p>Try this:\n1. Go to formula tab\n2. Click \"Calculation Option\"\n3. Select \"Manual\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/2i1re.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2i1re.jpg\" alt=\"Screenshot for your reference\"></a></p>\n\n<p>Now execute the macro you have created. It should be good to go. Once the macro is executed. You can change the calculation option.</p>\n\n<p>Note: You can control the calculation option problematically as well using below snippet:</p>\n\n<pre><code>    Dim CalcMode As Long\n    ' This will set the calculation mode to manual\n    With Application\n      CalcMode = .Calculation\n      .Calculation = xlCalculationManual\n      .ScreenUpdating = False\n      .EnableEvents = False\n    End With\n\n     &lt;&lt; Add your macro processing here &gt;&gt;\n\n    ' Again switch back to the original calculation option\n    With Application\n       .ScreenUpdating = True\n       .EnableEvents = True\n       .Calculation = CalcMode\nEnd With\n</code></pre>\n\n<p>Excel tries to calculate the values (based on formula) everytime any cell is changed. This is done for the entire document for every cell updated by your macro. So, for large excel document, it causes high CPU consumption.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 7798223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56caec1d3c39ec58e886d25bb05d6235?s=128&d=identicon&r=PG&f=1", "display_name": "Joe W", "link": "https://stackoverflow.com/users/7798223/joe-w"}, "is_accepted": true, "score": 2, "last_activity_date": 1492606653, "creation_date": 1492606653, "answer_id": 43496458, "question_id": 43491117, "link": "https://stackoverflow.com/questions/43491117/excel-vba-for-loop-causes-100-cpu/43496458#43496458", "title": "Excel VBA for loop causes 100% CPU", "body": "<p>To help your macro run smoother you can insert the below code before your main code (just below the sub) and right after your code (just before the end sub)\nThis will turn off screen updates, alerts, and set the calculation to manual so no formulas are updating until after the process has ran.</p>\n\n<pre><code>   'Please Before Main Code'\n   Application.ScreenUpdating = False\n   Application.DisplayAlerts = False\n   Application.Calculation = xlManual\n\n  'Insert main code here'\n\n  'Place After Main code'\n   Application.ScreenUpdating = True\n   Application.DisplayAlerts = True\n   Application.Calculation = xlAutomatic\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 7888634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1045488de1ac37f7a83e7af434f11443?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Goh", "link": "https://stackoverflow.com/users/7888634/evan-goh"}, "edited": false, "score": 0, "creation_date": 1492678829, "post_id": 43499614, "comment_id": 74083031, "body": "What does Resizee (n,1) do ?"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 43, "user_id": 7888634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1045488de1ac37f7a83e7af434f11443?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Goh", "link": "https://stackoverflow.com/users/7888634/evan-goh"}, "edited": false, "score": 1, "creation_date": 1492691088, "post_id": 43499614, "comment_id": 74092005, "body": "For example <code>Range(&quot;A1&quot;).Resize(10,3)</code> is equivalent to <code>Range(&quot;A1:C10&quot;)</code>. So it resizes the range of cells with a numeric values for the #rows and #columns. (<a href=\"https://msdn.microsoft.com/en-us/library/office/ff193274.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff193274.aspx</a>)"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 43, "user_id": 7888634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1045488de1ac37f7a83e7af434f11443?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Goh", "link": "https://stackoverflow.com/users/7888634/evan-goh"}, "edited": false, "score": 0, "creation_date": 1492691528, "post_id": 43499614, "comment_id": 74092301, "body": "@EvanGoh you see using <code>Cells()</code> refers to the entire worksheet, but with <code>Range(ref).Resize(nx,ny)</code> you get the table of values with <code>ref</code> as top left, and <code>(nx,ny)</code> as row and column count. If things move around in the worksheet it is a pain to retarget all the <code>Cells()</code>, but if you use named ranges (like <code>Range(&quot;data_table&quot;)</code>) you don&#39;t have to do anything."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 1, "last_activity_date": 1492614606, "creation_date": 1492614606, "answer_id": 43499614, "question_id": 43491117, "link": "https://stackoverflow.com/questions/43491117/excel-vba-for-loop-causes-100-cpu/43499614#43499614", "title": "Excel VBA for loop causes 100% CPU", "body": "<p>You are setting values of cells one at a time triggering a recalculation. The way to do this correctly is to read the columns into memory first, set the values and write the results <em>with one operation</em>. </p>\n\n<pre><code>Public Sub AnswerPost()\n\n    Dim r_status As Range, r_value As Range, r_calc As Range\n    Dim i As Long, n As Long\n    Dim op As Worksheet\n\n    Set op = Worksheets(\"ZVCTOSTATUS\")\n    ' Find the number of items on cell \"J2\" and below\n    n = Range(op.Range(\"J2\"), op.Range(\"J2\").End(xlDown)).Rows.Count\n    ' Set the n\u00d71 range of cells under \"J\", \"G\" and \"H\" columns\n    Set r_status = op.Range(\"J2\").Resize(n, 1)\n    Set r_value = op.Range(\"G2\").Resize(n, 1)\n    Set r_calc = op.Range(\"H2\").Resize(n, 1)\n\n    Dim x_status() As Variant, x_value() As Variant, x_calc() As Variant\n    ' Read cells from the worksheet into memory arrays\n    x_status = r_status.Value2\n    x_value = r_value.Value2\n    x_calc = r_status.Value2\n    ' Set values of x_calc based on x_status, row by row.\n    For i = 1 To n\n        Select Case x_status(i, 1)\n            Case \"FG BOOKED\", \"CLOSED\"\n                x_calc(i, 1) = 0#\n            Case \"NOT STARTED\", \"UNCONFIRMED\"\n                x_calc(i, 1) = x_value(i, 1)\n        End Select\n    Next i\n    ' Write the resulting array back into the worksheet\n    r_calc.Value2 = x_calc\nEnd Sub\n</code></pre>\n\n<p>Test case for above code</p>\n\n<p><a href=\"https://i.stack.imgur.com/C8XVm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C8XVm.png\" alt=\"screen\"></a></p>\n"}], "owner": {"reputation": 43, "user_id": 7888634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1045488de1ac37f7a83e7af434f11443?s=128&d=identicon&r=PG&f=1", "display_name": "Evan Goh", "link": "https://stackoverflow.com/users/7888634/evan-goh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2755, "favorite_count": 0, "accepted_answer_id": 43496458, "answer_count": 3, "score": 3, "last_activity_date": 1612343256, "creation_date": 1492592666, "last_edit_date": 1612343256, "question_id": 43491117, "link": "https://stackoverflow.com/questions/43491117/excel-vba-for-loop-causes-100-cpu", "title": "Excel VBA for loop causes 100% CPU", "body": "<pre><code>Application.ScreenUpdating = False\nDim r As Range\nDim a As Long\n\n\nSet op = Worksheets(&quot;ZVCTOSTATUS&quot;)\nSet CP = op.Columns(&quot;J&quot;)\nSet CTO = op.Range(&quot;J1&quot;)\nSet OD = op.Columns(&quot;G&quot;)\nSet ZV = op.Columns(&quot;H&quot;)\n\nop.Activate\nfa = op.Range(&quot;J&quot; &amp; Rows.Count).End(xlUp).Row\nSet r = op.Range(&quot;J2:J&quot; &amp; fa)\n\nFor Each C In r\n   CTO = CP.Cells(C.Row, 1).Value\n    If CTO = &quot;FG BOOKED&quot; Or CTO = &quot;CLOSED&quot; Then\n       ZV.Cells(C.Row, 1) = 0\n    ElseIf CTO = &quot;NOT STARTED&quot; Or CTO = &quot;UNCONFIRMED&quot; Then\n        ZV.Cells(C.Row, 1) = OD.Cells(C.Row, 1).Value\nEnd If\nNext C\n</code></pre>\n<p>I am using this code to go through my worksheet making a For loop to change value in Column H by referencing to Column J.</p>\n<p>When this code is used on a standalone worksheet, it seems to work perfectly. But once I port it over to a much bigger file which has data connection, and I run this macro only individually, it causes my CPU to run at 100% and takes up to 10 minutes.</p>\n<p>Does anyone know why this is happening?</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1492593926, "post_id": 43491084, "comment_id": 74037845, "body": "What exactly is the input? Will something like this work: <code>?Clng(Format(now+5, &quot;ww&quot;))</code> if you write it in the immediate window? It gives the week for the current day+5 days."}, {"owner": {"reputation": 968, "user_id": 134118, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7494efd9e38cf32e9b64d145ff8660bf?s=128&d=identicon&r=PG", "display_name": "warsong", "link": "https://stackoverflow.com/users/134118/warsong"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1492594635, "post_id": 43491084, "comment_id": 74038358, "body": "The input is the name of the day as a string (from a dropdown list, e.g. &quot;Monday&quot; ). Thanks I will try that right now. edit: not sure if that&#39;s what I&#39;m after actually. <code>d = CLng(Format(&quot;Monday&quot; + 5, &quot;ww&quot;))</code> gives a Type Mismatch error."}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 1, "last_activity_date": 1492595198, "creation_date": 1492595198, "answer_id": 43492091, "question_id": 43491084, "link": "https://stackoverflow.com/questions/43491084/excel-vba-is-there-a-way-to-get-the-date-in-the-current-week-given-only-the-d/43492091#43492091", "title": "Excel VBA - Is there a way to get the date in the current week, given only the day name?", "body": "<p>The main problem is turning your day name into a day number - so Tue or Tuesday returns day 1 (Monday being day 0).<br>\nOn first thought I'd use a <code>Select Case</code> statement in VBA, but there may be a better way.  </p>\n\n<p>The code below will calculate Mondays date (<code>dReturnDate</code>) and then add a number of days depending on what you ask for.  A nonsensical day name will return a <code>#Num</code> error.</p>\n\n<pre><code>Public Function DateFromDay(DayName As String) As Variant\n\n    Dim dReturnDate As Date\n    Dim lDayNumber As Long\n\n    dReturnDate = Date - Weekday(Date - 2)\n\n    Select Case DayName\n        Case \"Mon\", \"Monday\"\n            lDayNumber = 0\n        Case \"Tue\", \"Tuesday\"\n            lDayNumber = 1\n        Case \"Wed\", \"Wednesday\"\n            lDayNumber = 2\n        Case \"Thu\", \"Thursday\"\n            lDayNumber = 3\n        Case \"Fri\", \"Friday\"\n            lDayNumber = 4\n        Case \"Sat\", \"Saturday\"\n            lDayNumber = 5\n        Case \"Sun\", \"Sunday\"\n            lDayNumber = 6\n        Case Else\n            lDayNumber = -1\n    End Select\n\n    If lDayNumber &gt;= 0 Then\n        DateFromDay = dReturnDate + lDayNumber\n    Else\n        DateFromDay = CVErr(xlErrNum)\n    End If\n\nEnd Function  \n</code></pre>\n\n<p>On a worksheet:<br>\n<code>=DateFromDay(\"Tuesday\")</code> returns 18th April 2017<br>\n<code>=DateFromDay(\"Any Day\")</code> returns <code>#Num!</code></p>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 1, "last_activity_date": 1492598382, "creation_date": 1492598382, "answer_id": 43493362, "question_id": 43491084, "link": "https://stackoverflow.com/questions/43491084/excel-vba-is-there-a-way-to-get-the-date-in-the-current-week-given-only-the-d/43493362#43493362", "title": "Excel VBA - Is there a way to get the date in the current week, given only the day name?", "body": "<p>A lot depends on whether you want to use <code>vbUseSystemDayOfWeek</code> or if simply treating Monday as the 1st day is acceptable. You'd also need additional code if you wanted to accept, for example, \"Mon\" and \"Monday\" and if you wanted to protect the the lookup with <code>UCase</code>.</p>\n\n<p>In principle, though, the function could be as simple as:</p>\n\n<pre><code>Public Function DateFromDayName(dayName As String) As Date\n    Dim d As Long\n\n    d = WorksheetFunction.Match(dayName, _\n                                Array(\"Monday\", _\n                                      \"Tuesday\", _\n                                      \"Wednesday\", _\n                                      \"Thursday\", _\n                                      \"Friday\", _\n                                      \"Saturday\", _\n                                      \"Sunday\"), _\n                                0)\n\n    DateFromDayName = Now - Weekday(Now, vbMonday) + d\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 968, "user_id": 134118, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7494efd9e38cf32e9b64d145ff8660bf?s=128&d=identicon&r=PG", "display_name": "warsong", "link": "https://stackoverflow.com/users/134118/warsong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 0, "accepted_answer_id": 43492091, "answer_count": 2, "score": 0, "last_activity_date": 1492598382, "creation_date": 1492592550, "last_edit_date": 1531164843, "question_id": 43491084, "link": "https://stackoverflow.com/questions/43491084/excel-vba-is-there-a-way-to-get-the-date-in-the-current-week-given-only-the-d", "title": "Excel VBA - Is there a way to get the date in the current week, given only the day name?", "body": "<p>I need to work out a date within the current week (e.g. 2017/04/01) given only the day part of the date, is this possible with Excel VBA?\nI have looked at questions like this <a href=\"https://stackoverflow.com/questions/40408812/excel-vba-how-to-get-the-day-name-of-date\">excel vba - How to get the Day Name of Date?</a>\nbut they answer a different question. I've also looked at using constants like vbTuesday but they are't helping as I still need to work out how to connect the day name to the current week.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492592601, "post_id": 43491004, "comment_id": 74036936, "body": "@A.S.H - I agree."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1492593327, "last_edit_date": 1492593327, "creation_date": 1492592306, "answer_id": 43491004, "question_id": 43490707, "link": "https://stackoverflow.com/questions/43490707/vba-crashes-excel/43491004#43491004", "title": "VBA crashes Excel", "body": "<pre><code>Option Explicit\n\nSub ProcOne()\n\n    Dim OpColMain   As Long\n    Dim TextColMain As Long\n    Dim opColOne    As Long\n    Dim i           As Long\n\n    opColOne = 4\n\n    TextColMain = 1\n    OpColMain = 2\n\n    i = 1\n\n    Do Until i &gt;= 3\n        With ActiveSheet\n\n            If .Cells(i, OpColMain) = \"op1\" Then\n                .Cells(2, opColOne) = .Cells(2, opColOne) &amp; vbNewLine &amp; .Cells(i, TextColMain)\n            End If\n            i = i + 1\n\n        End With\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>You need <code>Option Explicit</code>, to make sure that you declare all variables correctly.\nYou need <code>With ActiveSheet</code>, because without it, you may be getting an error in Excel. Thus, you \ndeclare <code>.Cells</code> to the ActiveSheet and not just <code>Cells</code>. See the Microsoft info here: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194567.aspx\" rel=\"nofollow noreferrer\">Worksheet.Cells Property (Excel)</a>.</p>\n\n<p>Last but not least <code>i = i + 1</code> should be outside the loop, to make sure that we leave the endless loop. Or inside, depending on the code and the case. But in this case when we only have 3 lines - outside.</p>\n\n<p>Final edit - if you want to loop 3 times, use Do Until <code>i &gt;= 3</code>, otherwise you loop only twice.</p>\n"}], "owner": {"reputation": 48, "user_id": 6604621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/456b9ae536b1ed0ad46042911fc4c3f9?s=128&d=identicon&r=PG&f=1", "display_name": "Jay F", "link": "https://stackoverflow.com/users/6604621/jay-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 43491004, "answer_count": 1, "score": 2, "last_activity_date": 1492593327, "creation_date": 1492591463, "last_edit_date": 1492593269, "question_id": 43490707, "link": "https://stackoverflow.com/questions/43490707/vba-crashes-excel", "title": "VBA crashes Excel", "body": "<p>I'm using excel and VBA to append a cell using the contents of the below table. The data is being gathered from Table 1. It the code first checks what the option in column B(2) is <code>op1</code> it should then read the contents of column A(1) and append the cell D2 (Below <code>op1</code> in Table 2).</p>\n\n<p>This is then using a loop to go through all the values within Table 1 which then should continuously populate Table 2 until the set limit (3) is exceeded.</p>\n\n<p>Table 1:</p>\n\n<pre><code>A       B\n---    ---\ntext    op1\ntextt   op2\ntext    op1\n</code></pre>\n\n<p>Table 2:</p>\n\n<pre><code>D\n---\nop1\n*** The Cell I want to Append ***\n</code></pre>\n\n<p>The code I'm using is as follows.</p>\n\n<pre><code>Sub ProcOne()\n    OpColOne = 4\n\n    TextColMain = 1\n    OpColMain = 2\n\n    i = 1\n\n    Do Until i &gt; 3\n        If Cells(i, OpColMain) = \"op1\" Then\n            Cells(2, OpColOne) = Cells(2, OpColOne) &amp; vbNewLine &amp; Cells(i, TextColMain)\n            i = i + 1\n        End If\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2444, "user_id": 5733738, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/OQjxC.png?s=128&g=1", "display_name": "Harsha W", "link": "https://stackoverflow.com/users/5733738/harsha-w"}, "edited": false, "score": 0, "creation_date": 1492591189, "post_id": 43490572, "comment_id": 74035964, "body": "You have something here : <a href=\"http://stackoverflow.com/questions/29310458/how-to-copy-data-from-closed-workbookskeeping-them-closed-into-master-workbook\" title=\"how to copy data from closed workbookskeeping them closed into master workbook\">stackoverflow.com/questions/29310458/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1492602048, "post_id": 43494524, "comment_id": 74043650, "body": "This doesn&#39;t meet the question criteria: <i>without open that file</i>."}], "tags": [], "owner": {"reputation": 1, "user_id": 7889216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b66882f109a98acba647887202004b3?s=128&d=identicon&r=PG&f=1", "display_name": "MaddyN", "link": "https://stackoverflow.com/users/7889216/maddyn"}, "is_accepted": false, "score": -1, "last_activity_date": 1492601504, "creation_date": 1492601504, "answer_id": 43494524, "question_id": 43490572, "link": "https://stackoverflow.com/questions/43490572/vba-copy-data-from-other-workbook-without-open-that-workbook/43494524#43494524", "title": "VBA copy data from other workbook without open that workbook", "body": "<pre><code>Sub OpenCopyPaste()\nDim wb As Workbook\nDim Reportwb As Workbook\n' set report workbook to workbook object (works only is the file is already \n'open)\nSet Reportwb = ThisWorkbook\nApplication.ScreenUpdating = False\n' open the source workbook and select the source sheet\nSet wb = Workbooks.Open(Filename:=\"C:\\Users\\Adryan Permana\\Downloads\\Test\\part8.xlsx\")\n' copy the source range and paste in 1 line , paste at \"C3:E9\"\nwb.Sheets(\"Sheet1\").Range(\"C3:E9\").Copy\nReportwb.Sheets(\"Sheet1\").Range(\"C3:E9\").PasteSpecial xlPasteValues\nwb.Close False\nReportwb.Save\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Try This </p>\n"}], "owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7265, "favorite_count": 0, "closed_date": 1492602016, "answer_count": 1, "score": 0, "last_activity_date": 1492601504, "creation_date": 1492591081, "question_id": 43490572, "link": "https://stackoverflow.com/questions/43490572/vba-copy-data-from-other-workbook-without-open-that-workbook", "closed_reason": "Duplicate", "title": "VBA copy data from other workbook without open that workbook", "body": "<p>I have this VBA code:</p>\n\n<pre><code>Sub OpenCopyPaste()\n\nDim wb As Workbook\nDim Reportwb As Workbook\n\n' set report workbook to workbook object (works only is the file is already open)\nSet Reportwb = Workbooks(\"report.xlsx\")\n\n' open the source workbook and select the source sheet\nSet wb = Workbooks.Open(Filename:=\"C:\\Users\\Adryan Permana\\Downloads\\Test\\part8.xlsx\")\n\n' copy the source range and paste in 1 line , paste at \"C3:E9\"\nwb.Sheets(\"Sheet1\").Range(\"C3:E9\").Copy\nReportwb.Sheets(\"Sheet1\").Range(\"C3:E9\").PasteSpecial xlPasteValues\nReportwb.Save\n\nEnd Sub\n</code></pre>\n\n<p>I want to copy data from \"part8.xlsx\" without open that file. How can I do that? Many thanks for the help.</p>\n"}, {"tags": ["vba", "excel", "directory", "filenames"], "comments": [{"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 0, "creation_date": 1492591465, "post_id": 43490386, "comment_id": 74036138, "body": "It would help if you created a minimal, complete and verifiable example for your problem (see <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>)"}, {"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 0, "creation_date": 1492591629, "post_id": 43490386, "comment_id": 74036258, "body": "Also, have you tried anything yourself? (Hint: have a look at the help for the <code>Dir()</code> function)"}], "answers": [{"tags": [], "owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1492592313, "last_edit_date": 1492592313, "creation_date": 1492591757, "answer_id": 43490823, "question_id": 43490386, "link": "https://stackoverflow.com/questions/43490386/write-filename-to-cell-from-dir-in-vba/43490823#43490823", "title": "Write Filename to cell from DIR in VBA", "body": "<p>It looks as if the file name you want is stored in <strong>\"myFile\"</strong>.\nTo be sure please add a print to this line</p>\n\n<pre><code>myFile = Dir(myPath &amp; myExtension)\nDebug.Print myfile\n</code></pre>\n\n<p>and check if the output is actually the string you want.</p>\n\n<p>Try to change</p>\n\n<pre><code>Sheets(\"Faro Scan Data\").Select\nRange(\"E5\").Select\nPasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Sheets(\"Faro Scan Data\").Select\nRange(\"E5\").Value = myFile\nRange(\"E6\").Select\nPasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n</code></pre>\n\n<p>And I am not sure what this line should do:</p>\n\n<pre><code>myPath = myPath\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7885316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed149c1064869248a017943c94407cc?s=128&d=identicon&r=PG&f=1", "display_name": "dnaylor93", "link": "https://stackoverflow.com/users/7885316/dnaylor93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2166, "favorite_count": 1, "accepted_answer_id": 43490823, "answer_count": 1, "score": 1, "last_activity_date": 1492592313, "creation_date": 1492590516, "question_id": 43490386, "link": "https://stackoverflow.com/questions/43490386/write-filename-to-cell-from-dir-in-vba", "title": "Write Filename to cell from DIR in VBA", "body": "<p>I have the macro attached below that loops through files in a Dir and copies data into a master file (which the macro is run from). What I want to do is also write in the master file, the name of the file that the data has been copied from at the top of the column it is pasted into (Cell E5).</p>\n\n<p>Could you please advise... </p>\n\n<p>Sub Import_Data()</p>\n\n<pre><code>' PURPOSE: To loop through all Excel files in a user specified folder and perform a set task on them\n\nDim WB As Workbook\nDim wbThis As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\nSet wbThis = ActiveWorkbook\n\n' Optimize Macro Speed\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\n' Retrieve Target Folder Path From User\nMsgBox \"Please select Faro Scan Data Folder\"\n\nSet FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\nWith FldrPicker\n    .Title = \"Select A Target Folder\"\n    .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\n' In Case of Cancel\nNextCode:\nmyPath = myPath\nIf myPath = \"\" Then GoTo ResetSettings\n\n' Target File Extension (must include wildcard \"*\")\nmyExtension = \"*.xls\"\n\n' Target Path with Ending Extention\nmyFile = Dir(myPath &amp; myExtension)\n\n' Loop through each Excel file in folder\nDo While myFile &lt;&gt; \"\"\n\n    ' Set variable equal to opened workbook\n    Set WB = Workbooks.Open(Filename:=myPath &amp; myFile)\n\n    ' Ensure Workbook has opened before moving on to next line of code\n    DoEvents\n\n    ' Copy data from target workbook....\n    WB.Activate\n    Application.CutCopyMode = False\n    Range(\"D8:D377\").Copy\n    wbThis.Activate\n    Sheets(\"Faro Scan Data\").Select\n    Range(\"E5\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    Application.CutCopyMode = False\n\n    ' Insert column for next data set\n    Columns(\"E:E\").Select\n    Selection.Insert Shift:=xlToRight\n\n    ' Format column for new dataset\n    Columns(\"I:I\").Select\n    Selection.Copy\n    Columns(\"E:E\").Select\n    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = False\n\n    ' Close Workbook\n    WB.Close SaveChanges:=False\n\n    ' Ensure Workbook has closed before moving on to next line of code\n    DoEvents\n\n    ' Get next file name\n    myFile = Dir\nLoop\n\n' Message Box when tasks are completed\nMsgBox \"Task Complete!\"\n\n   ResetSettings:\n' Reset Macro Optimization Settings\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nMsgBox \"Remeber to enter column headings!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492591710, "post_id": 43490398, "comment_id": 74036311, "body": "FYI, in a previous discussion with @ShaiRado, we decided to &quot;in-the-general-case&quot; switch from the 2-phase activation to the single phase <code>Goto</code>. Well in fact, &quot;I&quot; decided for both of us :-P, hope you join ;)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492592421, "post_id": 43490398, "comment_id": 74036813, "body": "@A.S.H - I will try to remember.  (I so rarely answer questions that require a cell to actually be selected that I will probably forget before the next time it becomes useful.)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1492590553, "creation_date": 1492590553, "answer_id": 43490398, "question_id": 43490299, "link": "https://stackoverflow.com/questions/43490299/excel-vba-using-find-how-to-select-the-cell-where-the-item-is-found/43490398#43490398", "title": "Excel VBA: Using FIND: How to select the cell where the item is found?", "body": "<p>To select a cell, you can use the <code>Select</code> method.  So, if you have a <code>Range</code> object which has been set to the cell you want, you can apply the <code>Select</code> method to that object, i.e.</p>\n\n<pre><code>rng.Select\n</code></pre>\n\n<p>Incorporated into your existing code, it might look something like:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim rng As Range\n    Set rng = Cells.Find(What:=\"CCC\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n        xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n        , SearchFormat:=False)\n\n    If Not rng Is Nothing Then\n        MsgBox \"found\"\n        rng.Select\n    Else\n        MsgBox \"not found\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1492590702, "post_id": 43490429, "comment_id": 74035664, "body": "someone started switching to <code>Application.Goto rng</code> ;)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492590728, "post_id": 43490429, "comment_id": 74035678, "body": "The OP&#39;s code requires the worksheet to be active anyway, i.e. <code>Cells.Find</code>, <code>After:=ActiveCell</code>."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492590794, "post_id": 43490429, "comment_id": 74035717, "body": "@YowE3K yes, that makes your answer perfectly valid. No objection ;)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 3, "last_activity_date": 1492590629, "creation_date": 1492590629, "answer_id": 43490429, "question_id": 43490299, "link": "https://stackoverflow.com/questions/43490299/excel-vba-using-find-how-to-select-the-cell-where-the-item-is-found/43490429#43490429", "title": "Excel VBA: Using FIND: How to select the cell where the item is found?", "body": "<p>You can use <code>rng.Select</code> but it needs the worksheet to be active on top (or you habe to activate it first i.e. rng.Parent.Activate). Simplest is to use <code>Application.Goto rng</code></p>\n\n<pre><code>If Not rng Is Nothing Then\n    Application.Goto rng\n    MsgBox (\"found\")\nElse\n    MsgBox (\"Not found\")\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492590950, "post_id": 43490491, "comment_id": 74035811, "body": "You would need to select the result of the <code>Find</code> before it would become the <code>ActiveCell</code>."}, {"owner": {"reputation": 97, "user_id": 997817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10d6fb1a6977d821e91039d497d8e441?s=128&d=identicon&r=PG", "display_name": "Leon Lai", "link": "https://stackoverflow.com/users/997817/leon-lai"}, "edited": false, "score": 0, "creation_date": 1492591547, "post_id": 43490491, "comment_id": 74036200, "body": "Hi, Digvjay. Thanks for your reply. Unfortunately if I put .activate in line 3, there is a run time error: &quot;Object required&quot;. Regards, leon"}, {"owner": {"reputation": 396, "user_id": 7796810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f8b5deb296124be4aa1e86d92250d66?s=128&d=identicon&r=PG&f=1", "display_name": "Digvijay", "link": "https://stackoverflow.com/users/7796810/digvijay"}, "edited": false, "score": 0, "creation_date": 1492591882, "post_id": 43490491, "comment_id": 74036427, "body": "yes it was, now it will work fine. It selects the first cell which matches the criteria"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492592261, "post_id": 43490491, "comment_id": 74036676, "body": "You won&#39;t need the <code>activcecell.select</code> (which includes a typo) now that you have used <code>Activate</code> on the result of the Find.  And you will need to remove the test on whether the <code>Find</code> found anything or not as you have not stored the result into the <code>rng</code> variable.  And you will need to include some other error handling to cover the situation where the <code>Find</code> does not find anything."}, {"owner": {"reputation": 97, "user_id": 997817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10d6fb1a6977d821e91039d497d8e441?s=128&d=identicon&r=PG", "display_name": "Leon Lai", "link": "https://stackoverflow.com/users/997817/leon-lai"}, "edited": false, "score": 0, "creation_date": 1492592682, "post_id": 43490491, "comment_id": 74036992, "body": "Hi Digvijay. It works now! Thanks to you all, I&#39;ve found many different methods of doing the same thing! CLOSING!"}], "tags": [], "owner": {"reputation": 396, "user_id": 7796810, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9f8b5deb296124be4aa1e86d92250d66?s=128&d=identicon&r=PG&f=1", "display_name": "Digvijay", "link": "https://stackoverflow.com/users/7796810/digvijay"}, "is_accepted": true, "score": 2, "last_activity_date": 1492591803, "last_edit_date": 1492591803, "creation_date": 1492590816, "answer_id": 43490491, "question_id": 43490299, "link": "https://stackoverflow.com/questions/43490299/excel-vba-using-find-how-to-select-the-cell-where-the-item-is-found/43490491#43490491", "title": "Excel VBA: Using FIND: How to select the cell where the item is found?", "body": "<pre><code> Private Sub CommandButton1_Click()\nRange(\"A1\").select\nCells.Find(What:=\"CCC\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n        xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n        , SearchFormat:=False).activate\n\nactivcecell.select\nIf Not rng Is Nothing Then\n    MsgBox (\"found\")\nElse\n    MsgBox (\"not found\")\nEnd If\n\nEnd Sub       \n</code></pre>\n\n<p>Using activecell.select will select your first find cell.</p>\n"}], "owner": {"reputation": 97, "user_id": 997817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10d6fb1a6977d821e91039d497d8e441?s=128&d=identicon&r=PG", "display_name": "Leon Lai", "link": "https://stackoverflow.com/users/997817/leon-lai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4252, "favorite_count": 0, "accepted_answer_id": 43490491, "answer_count": 3, "score": 0, "last_activity_date": 1602199039, "creation_date": 1492590251, "last_edit_date": 1531164843, "question_id": 43490299, "link": "https://stackoverflow.com/questions/43490299/excel-vba-using-find-how-to-select-the-cell-where-the-item-is-found", "title": "Excel VBA: Using FIND: How to select the cell where the item is found?", "body": "<p>I am using Excel VBA to search for a string e.g. \"CCC\" in an Excel worksheet.\nI used the simple code shown.</p>\n\n<p>However, I want VBA to select the cell where the first occurrence of \"CCC\" is found. (Just like when you do a FIND manually).</p>\n\n<p>How can I modify my code to achieve this?`</p>\n\n<hr>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim rng As Range\nSet rng = Cells.Find(What:=\"CCC\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n        xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n        , SearchFormat:=False)\n\nIf Not rng Is Nothing Then\n    MsgBox (\"found\")\nElse\n    MsgBox (\"not found\")\nEnd If\n\nEnd Sub       \n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 54, "user_id": 4701713, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70bcd3530d34e217ae56cfc004b3d44e?s=128&d=identicon&r=PG&f=1", "display_name": "Al Amin", "link": "https://stackoverflow.com/users/4701713/al-amin"}, "edited": false, "score": 0, "creation_date": 1492661309, "post_id": 43497563, "comment_id": 74074280, "body": "Thank you Jbjstam"}], "tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": true, "score": 1, "last_activity_date": 1492609488, "creation_date": 1492609488, "answer_id": 43497563, "question_id": 43490204, "link": "https://stackoverflow.com/questions/43490204/ms-word-vba-include-text-file-line-into-an-array/43497563#43497563", "title": "Ms word VBA: include text file line into an array", "body": "<p>You can use a FileSystemObject to read line by line. Personally I'd use a Collection rather than an array so that I don't have to constantly use ReDim Preserve:</p>\n\n<pre><code>Sub S43490204()\n    Dim filePath As String\n    Dim fso\n    Dim oCollection As New Collection\n\n    filePath = \"lines.txt\"\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set txtStream = fso.OpenTextFile(filePath, 1, False) '1 = ForReading\n\n    On Error GoTo closeTarget\n\n    Do While Not txtStream.AtEndOfStream\n        oCollection.Add txtStream.ReadLine\n    Loop\n\ncloseTarget:\n    txtStream.Close\n\n    'I'm not sure why you'd want an array instead of a collection\n    Dim myArr() As String: myArr = GetStringArrayFromCollection(oCollection)\n\n    For i = LBound(myArr) To UBound(myArr)\n        Debug.Print \" - \" + myArr(i)\n    Next i\n\nEnd Sub\n\nFunction GetStringArrayFromCollection(oCollection As Collection) As String()\n    Dim arr() As String\n    Dim i As Integer\n\n    ReDim arr(0 To oCollection.Count - 1)\n\n    For i = 1 To oCollection.Count\n        arr(i - 1) = oCollection(i)\n    Next i\n\n    GetStringArrayFromCollection = arr\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 54, "user_id": 4701713, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/70bcd3530d34e217ae56cfc004b3d44e?s=128&d=identicon&r=PG&f=1", "display_name": "Al Amin", "link": "https://stackoverflow.com/users/4701713/al-amin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 43497563, "answer_count": 1, "score": 0, "last_activity_date": 1593764822, "creation_date": 1492589961, "last_edit_date": 1593764822, "question_id": 43490204, "link": "https://stackoverflow.com/questions/43490204/ms-word-vba-include-text-file-line-into-an-array", "title": "Ms word VBA: include text file line into an array", "body": "<p>Such I have a text file that contain the below lines:</p>\n\n<p>Line 1</p>\n\n<p>Line2 etc</p>\n\n<p>Line 3 etc</p>\n\n<p>Now, I want to read the text file and include the all of line into an array like this:</p>\n\n<p>LineList = Array(\"Line 1\", \"Line2 etc\", \"Line 3 etc\") </p>\n\n<p>How can I do this in ms word vba macro? </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1492587623, "post_id": 43489331, "comment_id": 74033740, "body": "Please rewrite your question, it&#39;s not written clearly."}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "reply_to_user": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1492587873, "post_id": 43489331, "comment_id": 74033908, "body": "i want to insert serial numbers in Column A if the cell value in column B is starting with out space. For more clarity please refer the image that i have attached. @ Josh Friedlander"}, {"owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1492588160, "post_id": 43489331, "comment_id": 74034075, "body": "Can&#39;t you sort your data alphabetically, and then add the numbers to those without spaces?"}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "reply_to_user": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1492588250, "post_id": 43489331, "comment_id": 74034120, "body": "Actually the above data are extracted from web and it is populated here.@JoshFriedlander"}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "reply_to_user": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "edited": false, "score": 0, "creation_date": 1492588300, "post_id": 43489331, "comment_id": 74034145, "body": "sorting doesn&#39;t play any role in this@JoshFriedlander"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "edited": false, "score": 0, "creation_date": 1492596741, "post_id": 43491900, "comment_id": 74039913, "body": "thanks It works as i expected, can we copy the data till before serial number and paste it in separate sheet.@Mrig"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "edited": false, "score": 0, "creation_date": 1492596815, "post_id": 43491900, "comment_id": 74039975, "body": "@DINESHKUMARPALANISAMY - Yeah it can be."}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "edited": false, "score": 0, "creation_date": 1492600409, "post_id": 43491900, "comment_id": 74042492, "body": "thanks for your effort. But i need to copy content till before serial no 2 and paste it in new sheet@Mrig"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "edited": false, "score": 0, "creation_date": 1492600894, "post_id": 43491900, "comment_id": 74042842, "body": "@DINESHKUMARPALANISAMY - Edited code will copy data from &#39;Cell B2&#39; to &#39;Cell D till last row&#39; from &#39;Sheet1&#39; and will paste to &#39;Cell B2&#39; in &#39;Sheet2&#39;."}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "edited": false, "score": 0, "creation_date": 1492601046, "post_id": 43491900, "comment_id": 74042947, "body": "i dont want to copy till last row, i wamt to copy till D12 for this example as A13 is &quot;2&quot;. (this may vary according to the data that i fetch)@Mrig"}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "reply_to_user": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "edited": false, "score": 0, "creation_date": 1492601188, "post_id": 43491900, "comment_id": 74043063, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/142073/discussion-between-dineshkumar-palanisamy-and-mrig\">continue this discussion in chat</a>."}, {"owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "edited": false, "score": 0, "creation_date": 1492667657, "post_id": 43491900, "comment_id": 74076351, "body": "It doesn&#39;t works. the data from whole Serial number 1 has to be copied and pasted, it is copying only serial number 1 alone"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "edited": false, "score": 0, "creation_date": 1492668423, "post_id": 43491900, "comment_id": 74076721, "body": "@DINESHKUMARPALANISAMY - <code>Set srcWS = ThisWorkbook.Sheets(&quot;Sheet1&quot;)</code> have you changed the sheet name here?"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "edited": false, "score": 0, "creation_date": 1492670147, "post_id": 43491900, "comment_id": 74077656, "body": "@DINESHKUMARPALANISAMY - Any success?"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 1, "last_activity_date": 1492666435, "last_edit_date": 1492666435, "creation_date": 1492594747, "answer_id": 43491900, "question_id": 43489331, "link": "https://stackoverflow.com/questions/43489331/copy-data-from-a-worksheet-till-a-condition/43491900#43491900", "title": "copy data from a worksheet till a condition", "body": "<p>Assuming your sheet is as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2RTiz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2RTiz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Enter the following formula in the <code>Cell A4</code></p>\n\n<pre><code>=IF(LEFT(B4,1)&lt;&gt;\" \",COUNTA($A$2:A3)+1-COUNTBLANK($A$2:A3),\"\")\n</code></pre>\n\n<p>Drag/Copy down formula as required.</p>\n\n<p>If you are looking for a VBA solution, following should work:</p>\n\n<pre><code>Sub Demo()\n    Dim ws As Worksheet\n    Dim lastRow As Long, index As Long, i As Long\n    Dim rng As Range\n\n    index = 1\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")   '----&gt;change the sheet name as required\n    lastRow = ws.Cells(Rows.count, \"B\").End(xlUp).Row\n    Set rng = ws.Range(\"B4:B\" &amp; lastRow)\n    For i = 4 To lastRow\n        If Left(ws.Cells(i, 2).Value, 1) &lt;&gt; \" \" Then\n            ws.Cells(i, 1).Value = index\n            index = index + 1\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>_______________________________________________________________________________</strong></p>\n\n<p><strong><em>EDIT 1</em></strong> : First copy data from <code>Sheet1</code> to <code>Sheet2</code> and then add serial numbers.</p>\n\n<pre><code>Sub Demo()\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim lastRow As Long, index As Long, i As Long\n    Dim rng As Range\n\n    index = 1\n    Set ws1 = ThisWorkbook.Sheets(\"Sheet1\")   '----&gt;change the sheet name as required\n    Set ws2 = ThisWorkbook.Sheets(\"Sheet2\")\n    lastRow = ws1.Cells(Rows.count, \"B\").End(xlUp).Row\n    ws1.Range(\"B2:D\" &amp; lastRow).Copy Destination:=ws2.Range(\"B2\")\n    Set rng = ws2.Range(\"B4:B\" &amp; lastRow)\n    For i = 4 To lastRow\n        If Left(ws2.Cells(i, 2).Value, 1) &lt;&gt; \" \" Then\n            ws2.Cells(i, 1).Value = index\n            index = index + 1\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p><strong>_______________________________________________________________________________</strong></p>\n\n<p><strong><em>EDIT 2</em></strong> :</p>\n\n<pre><code>Sub Demo()\n    Dim srcWS As Worksheet, destWS As Worksheet\n    Dim lastRow As Long, index As Long, i As Long\n    Dim copyRng As Range, rng1 As Range, rng2 As Range\n\n    index = 1\n    Set srcWS = ThisWorkbook.Sheets(\"Sheet1\")   '----&gt;change the sheet name as required\n    lastRow = srcWS.Cells(Rows.count, \"B\").End(xlUp).Row\n    Set rng1 = srcWS.Cells(4, 2)\n    For i = 4 To lastRow\n        If Left(srcWS.Cells(i, 2).Value, 1) &lt;&gt; \" \" Then\n            srcWS.Cells(i, 1).Value = index\n            index = index + 1\n            If i &lt;&gt; 4 Then\n                Set rng2 = srcWS.Cells(i - 1, 4)\n                Set destWS = Sheets.Add(After:=Sheets(Sheets.count))\n                srcWS.Range(rng1, rng2).Copy Destination:=destWS.Range(\"B4\")\n                Set rng1 = srcWS.Cells(i, 2)\n            End If\n        End If\n    Next i\n    Set rng2 = srcWS.Cells(lastRow, 4)\n\n    Set destWS = Sheets.Add(After:=Sheets(Sheets.count))\n    srcWS.Range(rng1, rng2).Copy Destination:=destWS.Range(\"B4\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 7411007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-hzWvqCSpVb0/AAAAAAAAAAI/AAAAAAAAARQ/5KNIxE2AA4s/photo.jpg?sz=128", "display_name": "DINESHKUMAR PALANISAMY", "link": "https://stackoverflow.com/users/7411007/dineshkumar-palanisamy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 43491900, "answer_count": 1, "score": 0, "last_activity_date": 1492666435, "creation_date": 1492587236, "question_id": 43489331, "link": "https://stackoverflow.com/questions/43489331/copy-data-from-a-worksheet-till-a-condition", "title": "copy data from a worksheet till a condition", "body": "<p>I have a worksheet which contains data in column B to column D. I want to copy the data from B4 to till the cell value which has space infront of it and paste it in a separate sheet and change the sheet as the value B4 and then it has to copy the next cell values untill the cell value with space infront and it continues till column B has empty cells.</p>\n\n<p>In addition to that i have to enter serial no in column A respect to the data without space inits intial stage. i have attached the input and expected output image for your reference.</p>\n\n<p>input:\n<a href=\"https://i.stack.imgur.com/Iv7HT.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Iv7HT.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>expected output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vun4U.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vun4U.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>please help on this issue.</p>\n"}, {"tags": ["vba", "excel", "worksheet-function"], "answers": [{"tags": [], "owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "is_accepted": false, "score": 3, "last_activity_date": 1492586957, "creation_date": 1492586957, "answer_id": 43489241, "question_id": 43489170, "link": "https://stackoverflow.com/questions/43489170/how-to-use-countif-function-having-the-criteria-as-a-part-of-string-literal/43489241#43489241", "title": "how to use countif function having the criteria as a part of string literal?", "body": "<p>You don't need VBA. You can use a wildcard with COUNTIF/COUNTIFS - make your criteria \"John*\" (so, <code>=COUNTIF(A1:A7, \"John*\")</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492587647, "post_id": 43489293, "comment_id": 74033759, "body": "<code>&quot;=&quot; &amp; &quot;John*&quot;</code>?  Really??  That wastes 5 keystrokes!  Whatever happened to just using <code>&quot;=John*&quot;</code>??!?!  (Just joking - there&#39;s a good reason to do what you did, or even better <code>&quot;=&quot; &amp; &quot;John&quot; &amp; &quot;*&quot;</code> - it makes it easier to replace the hard-coded <code>&quot;John&quot;</code> with a variable instead.)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492588326, "post_id": 43489293, "comment_id": 74034159, "body": "@YowE3K you are right, I was half-way in the answer, when I had to attend a work meeting (don&#39;t you just hate it when work interferes with your <b>SO</b>)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1492589142, "post_id": 43489293, "comment_id": 74034652, "body": "I can&#39;t really complain when I have a work meeting - I figure I need to give the company at least 30 minutes of my time each work day.  ;)"}, {"owner": {"reputation": 65, "user_id": 7888139, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F9Onh.jpg?s=128&g=1", "display_name": "prerna arora", "link": "https://stackoverflow.com/users/7888139/prerna-arora"}, "edited": false, "score": 0, "creation_date": 1492605214, "post_id": 43489293, "comment_id": 74045955, "body": "Also can you suggest if I want to do an IF condition where the condition is to again match with a particular subtext of a text then how can i do it . i was trying with this one  If ActiveCell.Value = &quot;Benchmark report &quot; &amp; &quot;*&quot;...doesnt seem to work"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 65, "user_id": 7888139, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F9Onh.jpg?s=128&g=1", "display_name": "prerna arora", "link": "https://stackoverflow.com/users/7888139/prerna-arora"}, "edited": false, "score": 0, "creation_date": 1492605261, "post_id": 43489293, "comment_id": 74045993, "body": "@prernaarora sound like a great new <b>SO</b> post"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1492588260, "last_edit_date": 1492588260, "creation_date": 1492587100, "answer_id": 43489293, "question_id": 43489170, "link": "https://stackoverflow.com/questions/43489170/how-to-use-countif-function-having-the-criteria-as-a-part-of-string-literal/43489293#43489293", "title": "how to use countif function having the criteria as a part of string literal?", "body": "<p>As @YowE3K commented, there is a reason why I use <code>\"=\" &amp; \"John*\")</code>. It's a preparation for using a variable in the future instead of the hard-coded \"John\".</p>\n\n<p>If you want to use a VBA solution , you can use:</p>\n\n<pre><code>Range(\"A199\").Value = WorksheetFunction.CountIf(Range(\"A1\", Range(\"A1\").End(xlDown)), \"=\" &amp; \"John*\")\n</code></pre>\n\n<p>Or, better yet:</p>\n\n<pre><code>Const NametoFind As String = \"John\"\n\nRange(\"A199\").Value = WorksheetFunction.CountIf(Range(\"A1\", Range(\"A1\").End(xlDown)), \"=\" &amp; NametoFind &amp; \"*\")\n</code></pre>\n\n<p><strong>Note</strong>: <code>Range(\"A1\", Range(\"A1\").End(xlDown))</code> will work for continous range only (not if you have blank cells in the middle of you range). </p>\n"}, {"tags": [], "owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1492587358, "creation_date": 1492587358, "answer_id": 43489370, "question_id": 43489170, "link": "https://stackoverflow.com/questions/43489170/how-to-use-countif-function-having-the-criteria-as-a-part-of-string-literal/43489370#43489370", "title": "how to use countif function having the criteria as a part of string literal?", "body": "<p>If you are allowed to use an extra column, make one right after you name column, using the following formula:</p>\n\n<pre><code>=ISNUMBER(SEARCH(\"JOHN\"; A1)\n</code></pre>\n\n<p>The above example should be in cell <code>B1</code>. Then you will get a <code>TRUE</code> if the cell in column A contains the name \"JOHN\", otherwise you will get a <code>FALSE</code>. Then you simply make a count:</p>\n\n<pre><code>=COUNTIF(B:B; TRUE)\n</code></pre>\n\n<p>It might be a slight disadvantage that you have to use an extra column. But on the plus-side, it is very understandable (both for yourself and others whom might read your code).</p>\n"}], "owner": {"reputation": 65, "user_id": 7888139, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F9Onh.jpg?s=128&g=1", "display_name": "prerna arora", "link": "https://stackoverflow.com/users/7888139/prerna-arora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "accepted_answer_id": 43489293, "answer_count": 3, "score": 2, "last_activity_date": 1492588260, "creation_date": 1492586716, "last_edit_date": 1492586940, "question_id": 43489170, "link": "https://stackoverflow.com/questions/43489170/how-to-use-countif-function-having-the-criteria-as-a-part-of-string-literal", "title": "how to use countif function having the criteria as a part of string literal?", "body": "<p>For example i want to count the number of \"johns\" appearing in the column A however column has both first name and last name and i want to count all the johns irrespective of their last name.</p>\n\n<p>I am using the below code however doesn't seem to work:</p>\n\n<pre><code>Range(\"A199\").Value = WorksheetFunction.CountIf(Range(\"A1\", Range(\"A1\").End(xlDown)), Cells.Find(What:=\"John \"))\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 3, "creation_date": 1492587775, "post_id": 43488952, "comment_id": 74033851, "body": "In your context (running the code from Access), the Application object represent Access itself, not Excel, so it has no ActiveWorkbook object.  try changing <code>Application.ActiveWorkbook</code> to <code>xl.ActiveWorkbook</code>."}, {"owner": {"reputation": 23, "user_id": 5897504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c069ba0a3707682f40a811ad40645d43?s=128&d=identicon&r=PG&f=1", "display_name": "nick1408", "link": "https://stackoverflow.com/users/5897504/nick1408"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1492642923, "post_id": 43488952, "comment_id": 74069544, "body": "Spot on Vincent.  Thanks mate."}], "owner": {"reputation": 23, "user_id": 5897504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c069ba0a3707682f40a811ad40645d43?s=128&d=identicon&r=PG&f=1", "display_name": "nick1408", "link": "https://stackoverflow.com/users/5897504/nick1408"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492586084, "creation_date": 1492586084, "last_edit_date": 1495535462, "question_id": 43488952, "link": "https://stackoverflow.com/questions/43488952/make-vba-run-from-ms-access", "title": "Make VBA run from MS Access", "body": "<p>I'm trying to use a macro from MS Access that @masoud wrote for me here - <a href=\"https://stackoverflow.com/questions/43433124/reopening-recently-closed-instances-of-excel/43434009?noredirect=1#comment73980918_43434009\">Reopening recently closed instances of Excel</a></p>\n\n<p>What do I need to do to have it run from MS Access?  Code has been converted to the following to suit me:</p>\n\n<pre><code>Public Sub CloseAllExcel(Close1 As Boolean)\nOn Error GoTo handler\n\nDim xl As Excel.Application\nDim wb As Excel.Workbook\n\nDim strPath As String\nstrPath = \"C:\\path.txt\"\n\n\nIf Close1 Then\n\nDim fso as Object\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nDim oFile as Object\nSet oFile = FSO.CreateTextFile(strPath)\n\n\n\nDo While xl Is Nothing\n  Set xl = GetObject(, \"Excel.Application\")\n  For Each wb In xl.Workbooks\n\n   oFile.WriteLine Application.ActiveWorkbook.FullName \n     wb.Save\n     wb.Close\n  Next\n   oFile.Close\n   Set fso = Nothing\n   Set oFile = Nothing\n  xl.Quit\n  Set xl = Nothing\nLoop\n\nExit Sub\n\nElse\nDim FileNum As Integer\nDim DataLine As String\n\nFileNum = FreeFile()\nOpen strPath For Input As #FileNum\n\n While Not EOF(FileNum)\n    Line Input #FileNum, DataLine \n    Workbooks.Open DataLine\n Wend\n Exit Sub\n End If\n\n handler:\n  If Err &lt;&gt; 429 Then 'ActiveX component can't create object\n  MsgBox Err.Description, vbInformation\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The issues I have is that oFile.WriteLine Application.ActiveWorkbook.FullName  is having a method or data member not found for the ActiveWorkbook.  I'm a bit of a novice with this but I would have thought the code was good enough as is to work straight from MS Access.  It works if run from Excel though.</p>\n\n<p>Thanks for the help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492585984, "post_id": 43488875, "comment_id": 74032684, "body": "your <code>Function get_dat(dates As String) As Date</code> reutrns a <code>Date</code> , not <code>Integer</code>, as <code>mm</code> is defined. If you want to get the result in mm, then you need your <code>Function</code> to be <code>Function get_dat(dates As String) As Integer</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492586477, "post_id": 43488875, "comment_id": 74033005, "body": "I suspect what you are trying to do is <code>mm = Month(CDate(Cells(3, 10)))</code> or perhaps (if <code>mm</code> was a string) <code>mm = Format(CDate(Cells(3, 10)),&quot;mm&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "edited": false, "score": 0, "creation_date": 1492589614, "post_id": 43489022, "comment_id": 74034943, "body": "Thanks I Have updated my The answer above in my question."}], "tags": [], "owner": {"reputation": 4350, "user_id": 4187933, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/cT6jj.png?s=128&g=1", "display_name": "lebelinoz", "link": "https://stackoverflow.com/users/4187933/lebelinoz"}, "is_accepted": true, "score": 2, "last_activity_date": 1492586277, "creation_date": 1492586277, "answer_id": 43489022, "question_id": 43488875, "link": "https://stackoverflow.com/questions/43488875/function-not-return-the-value-in-main-sub-macro/43489022#43489022", "title": "Function not return the Value in main sub Macro", "body": "<p>You seem to be missing a crucial line in <code>get_dat</code>.  The final line should be </p>\n\n<pre><code>get_dat = dates\n</code></pre>\n\n<p>As mentioned by @ShaiRado in the comments, the declared types don't quite match.  You might want to consider declaring <code>get_dat as Integer</code> instead of <code>as Date</code></p>\n"}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1345, "favorite_count": 0, "accepted_answer_id": 43489022, "answer_count": 1, "score": 0, "last_activity_date": 1492589548, "creation_date": 1492585868, "last_edit_date": 1531164843, "question_id": 43488875, "link": "https://stackoverflow.com/questions/43488875/function-not-return-the-value-in-main-sub-macro", "title": "Function not return the Value in main sub Macro", "body": "<p>Please Find my Below Macro code. I am trying to get return the value in <strong>mm</strong> by function <strong>get_dat</strong> but I am not getting the same. (Date is available in Cells(3, 10)). Please guide on the same. </p>\n\n<pre><code>Function get_dat(dates As String) As Date\n\ndates = Month(dates)\nIf Len(dates) &gt;= 1 Then\ndates = 0 &amp; dates\nElse: dates = dates\nEnd If\nEnd Function\n\nSub x()\nDim mm As Integer\nmm = get_dat(Cells(3, 10))\nEnd Sub\n</code></pre>\n\n<p>Correction Code:-</p>\n\n<pre><code>Function get_dat(dates As String) As String\n\ndates = Month(dates)\nIf Len(dates) &gt;= 1 Then\ndates = 0 &amp; dates\nElse: dates = dates\nEnd If\nget_dat = dates\nEnd Function\n\nSub x()\nDim mm As String\nmm = get_dat(Cells(3, 10))\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492585836, "post_id": 43488727, "comment_id": 74032574, "body": "Not sure I undestand, you want to copy &quot;C2:E2&quot;, than &quot;C3:E3&quot; one by one all the way to &quot;C9:E9&quot; ? why not copy &quot;C2:E9&quot; with one shot ?"}, {"owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "edited": false, "score": 0, "creation_date": 1492588205, "post_id": 43488727, "comment_id": 74034095, "body": "Check out similar question: <a href=\"http://stackoverflow.com/questions/10782189/excel-vba-loop-through-cells-and-copy-values-to-another-workbook\" title=\"excel vba loop through cells and copy values to another workbook\">stackoverflow.com/questions/10782189/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "edited": false, "score": 0, "creation_date": 1492587020, "post_id": 43489018, "comment_id": 74033340, "body": "Thanks. It work. How about if I want to select 2 certain range copy it and paste to other workbook in different columns.  For Example;  C2:E9 (copy) = C3 (Paste)  B12:F15(copy) =D10 (Paste)  B16:F17(copy)= D12(Paste)"}, {"owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "edited": false, "score": 0, "creation_date": 1492587823, "post_id": 43489018, "comment_id": 74033880, "body": "Great, It works. Thank you. I am still new with VBA.  How about if I want copy data from other workbook without open that workbook. I need to copy data from 20 workbooks. If I use this code, it will open 20 workbooks  and it consume a lot of time or maybe error in the application. Is there any way to copy data without open the workbooks?"}, {"owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "edited": false, "score": 0, "creation_date": 1492588465, "post_id": 43489018, "comment_id": 74034248, "body": "I tried to add PasteSpecial in your code but it doesn&#39;t work. How about if I want to use pastespecial?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "edited": false, "score": 0, "creation_date": 1492588579, "post_id": 43489018, "comment_id": 74034309, "body": "@AdryanPermana first I think I&#39;ve fully answered the question you raised in your post so you can mark this as &quot;ANSWER&quot; , cy clicking on the gray check-mark next to my answer (it will turn green), read here <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a> . After, add a new post, with your modified code and describe what you are trying to achieve, it will allow all users here to assist you."}, {"owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "edited": false, "score": 0, "creation_date": 1492588963, "post_id": 43489018, "comment_id": 74034526, "body": "Ok, sorry my mistake. I already mark it. Thank your for your help. I really appreciate it :)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "edited": false, "score": 0, "creation_date": 1492589044, "post_id": 43489018, "comment_id": 74034591, "body": "@AdryanPermana it&#39;s ok, no need to be sorry. When you post your new question, I&#39;ll try to help (before all other users)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1492586264, "creation_date": 1492586264, "answer_id": 43489018, "question_id": 43488727, "link": "https://stackoverflow.com/questions/43488727/vba-copy-selection-range-in-loop/43489018#43489018", "title": "VBA copy selection range in loop", "body": "<p>You can copy the entire range with <code>Range(\"C2:E9\").Copy</code>.</p>\n\n<p>Also, there is no need to use <code>Select</code>, <code>Activate</code> and <code>Selection</code>, it slows down the code run-time, just use fully qulifed <code>Wroksheets</code> and <code>Range</code> instead.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub OpenCopyPaste()\n\nDim wb As Workbook\nDim Reportwb As Workbook\n\n' set report workbook to workbook object (works only is the file is already open)\nSet Reportwb = Workbooks(\"report.xlsx\")\n\n' open the source workbook and select the source sheet\nSet wb = Workbooks.Open(Filename:=\"C:\\Users\\Adryan Permana\\Downloads\\Test\\part8.xlsx\")\n\n' copy the source range and paste in 1 line , paste at \"C3\"\nwb.Sheets(\"Sheet1\").Range(\"C2:E9\").Copy Destination:=Reportwb.Sheets(\"Sheet1\").Range(\"C3\")\n\nApplication.CutCopyMode = False\nReportwb.Save\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "edited": false, "score": 0, "creation_date": 1492586862, "post_id": 43489073, "comment_id": 74033242, "body": "Thanks. It worked prefectly. I am still new with VBA. I just realise we can do like that. How about if I want to select 2 certain range copy it and paste to other workbook in different columns.  For Example;  C2:E9 (copy) = C3 (Paste)  B12:F15(copy) =D10 (Paste)"}, {"owner": {"reputation": 51, "user_id": 5597829, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rG8FBfg88sw/AAAAAAAAAAI/AAAAAAAAAFQ/Q6qzY_bZ9q4/photo.jpg?sz=128", "display_name": "sda11", "link": "https://stackoverflow.com/users/5597829/sda11"}, "reply_to_user": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "edited": false, "score": 0, "creation_date": 1492591808, "post_id": 43489073, "comment_id": 74036372, "body": "if you think this is an answer mark this as answer. Kindly ask this question not in comment section. I will be glad to answer that. Thank you ;)"}], "tags": [], "owner": {"reputation": 51, "user_id": 5597829, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rG8FBfg88sw/AAAAAAAAAAI/AAAAAAAAAFQ/Q6qzY_bZ9q4/photo.jpg?sz=128", "display_name": "sda11", "link": "https://stackoverflow.com/users/5597829/sda11"}, "is_accepted": false, "score": 0, "last_activity_date": 1492591931, "last_edit_date": 1492591931, "creation_date": 1492586434, "answer_id": 43489073, "question_id": 43488727, "link": "https://stackoverflow.com/questions/43488727/vba-copy-selection-range-in-loop/43489073#43489073", "title": "VBA copy selection range in loop", "body": "<p>Instead use C2:E9</p>\n\n<pre><code>Sub OpenCopyPaste()\n' open the source workbook and select the source sheet\nWorkbooks.Open Filename:=\"C:\\Users\\Adryan Permana\\Downloads\\Test\\part8.xlsx\"\nSheets(\"Sheet1\").Select\n' copy the source range\n\n\nSheets(\"Sheet1\").Range(\"C2:E9\").Select\nSelection.Copy\n\n' select current workbook and paste the values starting at A1\nWindows(\"report.xlsx\").Activate\nSheets(\"Sheet1\").Select\nSheets(\"Sheet1\").Range(\"C3\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nActiveWorkbook.Save\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 4943777, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4358177ca259d3a9bb43d2c8b434cb4d?s=128&d=identicon&r=PG&f=1", "display_name": "Adryan Permana", "link": "https://stackoverflow.com/users/4943777/adryan-permana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 43489018, "answer_count": 2, "score": 1, "last_activity_date": 1492591931, "creation_date": 1492585461, "last_edit_date": 1492586410, "question_id": 43488727, "link": "https://stackoverflow.com/questions/43488727/vba-copy-selection-range-in-loop", "title": "VBA copy selection range in loop", "body": "<p>I want to ask about loop in VBA. I have this VBA code:</p>\n\n<pre><code>Sub OpenCopyPaste()\n\n' open the source workbook and select the source sheet\nWorkbooks.Open Filename:=\"C:\\Users\\Adryan Permana\\Downloads\\Test\\part8.xlsx\"\nSheets(\"Sheet1\").Select\n' copy the source range\nSheets(\"Sheet1\").Range(\"C2:E2,C3:E3,C4:E4,C5:E5,C6:E6,C7:E7,C8:E8,C9:E9\").Select\nSelection.Copy\n\n' select current workbook and paste the values starting at A1\nWindows(\"report.xlsx\").Activate\nSheets(\"Sheet1\").Select\nSheets(\"Sheet1\").Range(\"C3\").Select\nActiveSheet.Paste\nApplication.CutCopyMode = False\nActiveWorkbook.Save\n\nEnd Sub\n</code></pre>\n\n<p>I want to select all data in range \"C2:E2\" to \"C9:E9\" and paste it to other workbook. </p>\n\n<p>In my current code, I need to type one by one range from C2 - C9.\nI want to select data from C2-C9 in loop.</p>\n\n<p>Is there any way to do it in loop? </p>\n"}, {"tags": ["excel", "email", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 4, "creation_date": 1492583631, "post_id": 43487957, "comment_id": 74031192, "body": "Please tell us where your code does not work and how it fails."}, {"owner": {"reputation": 19, "user_id": 7881387, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210058765079962/picture?type=large", "display_name": "Mark Sy", "link": "https://stackoverflow.com/users/7881387/mark-sy"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1492645014, "post_id": 43487957, "comment_id": 74070188, "body": "@DavidG Hi David! Thank you for your reply. Got it working now as suggested by A.S.H."}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1492762095, "post_id": 43487957, "comment_id": 74126551, "body": "Title was not very explicit."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7881387, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210058765079962/picture?type=large", "display_name": "Mark Sy", "link": "https://stackoverflow.com/users/7881387/mark-sy"}, "edited": false, "score": 0, "creation_date": 1492644972, "post_id": 43488953, "comment_id": 74070175, "body": "Wow! It works! Thank you very much! Really appreciate the help!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 19, "user_id": 7881387, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210058765079962/picture?type=large", "display_name": "Mark Sy", "link": "https://stackoverflow.com/users/7881387/mark-sy"}, "edited": false, "score": 0, "creation_date": 1492645299, "post_id": 43488953, "comment_id": 74070245, "body": "@MarkSy you are welcome. Glad it helped. Please when an answer solves your problem think of &quot;accepting&quot; it by clicking the grey checkmark on the topleft of the answer, turning it into green :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1492589393, "last_edit_date": 1492589393, "creation_date": 1492586090, "answer_id": 43488953, "question_id": 43487957, "link": "https://stackoverflow.com/questions/43487957/find-email-that-meets-the-condition-inside-special-cells-with-formula/43488953#43488953", "title": "Find Email that meets the condition inside special cells with formula", "body": "<p>Just a guess, you say </p>\n\n<blockquote>\n  <p>each of these details have formulas embedded</p>\n</blockquote>\n\n<p>If the email addresses in row 18 have formulas, this line wont catch them:</p>\n\n<blockquote>\n  <p><code>For Each cell In Rows(18).Cells.SpecialCells(xlCellTypeConstants)</code></p>\n</blockquote>\n\n<p>Changing it to the following may solve the problem, and it is preferable in any case because you later check the string against the email pattern:</p>\n\n<pre><code>For Each cell In ActiveSheet.UsedRange.Rows(18).Cells\n</code></pre>\n\n<p>Better even, specify your sheet that has those data, i.e. if its name is \"myEmails\"; make it</p>\n\n<pre><code>For Each cell In Worksheets(\"myEmails\").UsedRange.Rows(18).Cells\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7881387, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210058765079962/picture?type=large", "display_name": "Mark Sy", "link": "https://stackoverflow.com/users/7881387/mark-sy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492762095, "creation_date": 1492583075, "last_edit_date": 1531164843, "question_id": 43487957, "link": "https://stackoverflow.com/questions/43487957/find-email-that-meets-the-condition-inside-special-cells-with-formula", "title": "Find Email that meets the condition inside special cells with formula", "body": "<p>I am working on a tracker that has a function of emailing people who didn't meet a criteria. I have NAMES reflected in Row 19 (<code>H19:AE19</code> to be specific; each cell column reflects 1 name); emails in Row 18 relative to the respective name; and conditions to be met in Row 20 (send email if blank; move to next if populated). </p>\n\n<p>Additional information: each of these details have formulas embedded. It changes whenever a certain drop down is changed.</p>\n\n<p>And so, the code is below and I can't seem to get it work:</p>\n\n<pre><code>Sub Test1()\nDim OutApp As Object\nDim OutMail As Object\nDim cell As Range\n\nApplication.ScreenUpdating = False\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nOn Error GoTo cleanup\n\n\nFor Each cell In Rows(18).Cells.SpecialCells(xlCellTypeConstants)\n    If cell.Value Like \"?*@ntrs.com\" And _\n    LCase(cell.Offset(2).Value) = \"\" Then\n        Set OutMail = OutApp.CreateItem(0)\n        On Error Resume Next\n        With OutMail\n            .To = cell.Value\n            .Subject = \"Reminder\"\n            .Body = \"Dear \" &amp; cell.Offset(1).Value _\n                  &amp; vbNewLine &amp; vbNewLine &amp; _\n                    \"Please contact us to discuss bringing \" &amp; _\n                    \"your account up to date\"\n            .Display\n            .Send\n        End With\n        On Error GoTo 0\n        Set OutMail = Nothing\n    End If\nNext cell\ncleanup:\nSet OutApp = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n\nThanks in advance!\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492586190, "post_id": 43488342, "comment_id": 74032803, "body": "@ShaiRado - LOL - but I&#39;m on <b>holidays</b> - I don&#39;t have as much spare time when I&#39;m on holidays!"}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "edited": false, "score": 0, "creation_date": 1596315196, "post_id": 43488342, "comment_id": 111774781, "body": "<code>Set VBComp = VBProj.VBComponents(Activesheet.CodeName)</code> works too."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 5, "last_activity_date": 1492584293, "creation_date": 1492584293, "answer_id": 43488342, "question_id": 43487928, "link": "https://stackoverflow.com/questions/43487928/vbcomponent-refer-to-sheet-by-tab-name/43488342#43488342", "title": "VBComponent refer to sheet by tab name", "body": "<p>You can use</p>\n\n<pre><code>Set VBComp = VBProj.VBComponents(Worksheets(\"SummaryTab\").CodeName)\n</code></pre>\n"}], "owner": {"reputation": 1096, "user_id": 5327707, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/f4db7ff546d2c0b1ce11937295d12451?s=128&d=identicon&r=PG&f=1", "display_name": "Ninja Dude", "link": "https://stackoverflow.com/users/5327707/ninja-dude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1544, "favorite_count": 0, "accepted_answer_id": 43488342, "answer_count": 1, "score": 3, "last_activity_date": 1492584293, "creation_date": 1492582986, "last_edit_date": 1531164843, "question_id": 43487928, "link": "https://stackoverflow.com/questions/43487928/vbcomponent-refer-to-sheet-by-tab-name", "title": "VBComponent refer to sheet by tab name", "body": "<pre><code>Set VBProj = ActiveWorkbook.VBProject\n        Set VBComp = VBProj.VBComponents(\"Sheet10\")\n</code></pre>\n\n<p>I have the code above. Currently Sheet10 is named as SummaryTab in the excel tab. I want to refer to the VBComponent using the name in the excel tab. Meaning that I want to use something like </p>\n\n<pre><code>Set VBComp = VBProj.VBComponents(\"SummaryTab\")\n</code></pre>\n\n<p>However, the above code is giving me errors. how can I fix this?</p>\n"}, {"tags": ["excel", "loops", "date", "vba"], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 239, "user_id": 7789119, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c4b7fad7b429a41386293c7f7bdc43d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Chia", "link": "https://stackoverflow.com/users/7789119/rachel-chia"}, "edited": false, "score": 0, "creation_date": 1492581207, "post_id": 43487308, "comment_id": 74029978, "body": "Now that we solved the endless loop problem, try some <code>Debug.Print endD</code>, check your variables in the debugger, etc. @RachelChia"}, {"owner": {"reputation": 239, "user_id": 7789119, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c4b7fad7b429a41386293c7f7bdc43d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Chia", "link": "https://stackoverflow.com/users/7789119/rachel-chia"}, "edited": false, "score": 0, "creation_date": 1492582853, "post_id": 43487308, "comment_id": 74030765, "body": "it&#39;s very weird cause it can work when end date is 31 Jul but not other dates"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 239, "user_id": 7789119, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c4b7fad7b429a41386293c7f7bdc43d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Chia", "link": "https://stackoverflow.com/users/7789119/rachel-chia"}, "edited": false, "score": 0, "creation_date": 1492583295, "post_id": 43487308, "comment_id": 74031015, "body": "@RachelChia probably the format of your dates is not compatible with what Excel expects. Again try to put <code>Debug.Print endD</code> before your loop and look what it displays in the <i>immediate window</i>."}, {"owner": {"reputation": 239, "user_id": 7789119, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c4b7fad7b429a41386293c7f7bdc43d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Chia", "link": "https://stackoverflow.com/users/7789119/rachel-chia"}, "edited": false, "score": 0, "creation_date": 1492587683, "post_id": 43487308, "comment_id": 74033790, "body": "i realise the end date must be a monday , an exact date for the loop to work"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1492580531, "creation_date": 1492580531, "answer_id": 43487308, "question_id": 43487214, "link": "https://stackoverflow.com/questions/43487214/looping-of-dates/43487308#43487308", "title": "Looping of dates", "body": "<blockquote>\n  <p><code>Do Until W = endD</code></p>\n</blockquote>\n\n<p>Ths could result in endless loop because your incremented value of the variable <code>W</code> may <em>\"jump\"</em> over the endD. Replace it by:</p>\n\n<pre><code>Do Until W &gt;= endD\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 239, "user_id": 7789119, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c4b7fad7b429a41386293c7f7bdc43d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Chia", "link": "https://stackoverflow.com/users/7789119/rachel-chia"}, "edited": false, "score": 0, "creation_date": 1493183969, "post_id": 43625452, "comment_id": 74299812, "body": "Nope this not what I want. i want it to loop every week from start date to end date and display the date and month"}], "tags": [], "owner": {"reputation": 177, "user_id": 7911617, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6392832e9b974ae44f7cf83d0ba23750?s=128&d=identicon&r=PG", "display_name": "Hank", "link": "https://stackoverflow.com/users/7911617/hank"}, "is_accepted": false, "score": 0, "last_activity_date": 1493184322, "last_edit_date": 1493184322, "creation_date": 1493183069, "answer_id": 43625452, "question_id": 43487214, "link": "https://stackoverflow.com/questions/43487214/looping-of-dates/43625452#43625452", "title": "Looping of dates", "body": "<pre><code>Sub test()\n\nDim FirstDate As Date\nDim LastDate As Date\nDim NextDate As Date\n\nFirstDate = Range(\"startdate\").Value\nLastDate = Range(\"enddate\").Value\n\nNextDate = FirstDate\nRange(\"tripdays\").Select\n\nDo Until NextDate &gt; LastDate\n\n    ActiveCell.Value = NextDate\n    ActiveCell.Offset(1, 0).Select\n    NextDate = NextDate + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>hows this?</p>\n"}], "owner": {"reputation": 239, "user_id": 7789119, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c4b7fad7b429a41386293c7f7bdc43d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rachel Chia", "link": "https://stackoverflow.com/users/7789119/rachel-chia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1493184322, "creation_date": 1492580162, "last_edit_date": 1531164843, "question_id": 43487214, "link": "https://stackoverflow.com/questions/43487214/looping-of-dates", "title": "Looping of dates", "body": "<p>I am trying to loop the dates by having a start date and end date so for example it starts on 3 Apr and ends on 31 Aug. After 3 Apr, it will add 7 days to the date till the end date and display the date and the month. I am trying to loop it but it loop endlessly and does not stop at all. The first two weeks works but starting the Do until loop, it does not work. Thanks in advance for your help </p>\n\n<pre><code>x = 5\nendD = Sheet1.Range(\"C20\").Value\nstartD = Sheet1.Range(\"C19\").Value\nmth = Month(startD)\nName = MonthName(mth, True)\nno = Day(startD)\nSheet1.Range(\"C2\").Value = no\nSheet1.Range(\"C1\").Value = Name\ndates = DateAdd(\"d\", 7, startD)\nName = MonthName(Month(dates), True)\nSheet1.Range(\"D2\").Value = Name\nSheet1.Range(\"D1\").Value = Day(dates)\nW = dates\nDo Until W = endD\nm = DateAdd(\"d\", 7, W)\nW = m\nno = 0\nName = \" \"\nno = Day(m)\nName = MonthName(Month(m), True)\nSheet1.Cells(1, x).Value = Name\nSheet1.Cells(2, x).Value = no\nx = x + 1\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel", "concatenation"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492580324, "post_id": 43487063, "comment_id": 74029576, "body": "Apart from the issue with the appending of strings (due to resetting <code>SDesc</code> every time through the <code>icol</code> loop), your code seems to be rewriting information on the <code>lastrow</code> row and/or <code>lastrow+1</code> row for each iteration of the <code>iRow</code> loop (because <code>lastrow</code> will be the same value each iteration).  It might be an idea to paste an image of your code into the question so that we can see what you are trying to achieve.  (Although that may not be an issue if there is other code, that updates column A, that hasn&#39;t been shown.)"}, {"owner": {"reputation": 61, "user_id": 6387534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d8851aafdfee3812dd303166d261b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Angel", "link": "https://stackoverflow.com/users/6387534/angel"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492580940, "post_id": 43487063, "comment_id": 74029849, "body": "Last row wont be the same for each iteration. This is part of a longer code where I have formulas in a table and then using that table to create journal entries. I realize I am resetting sDec everytime through the iCol but not sure how to fix that. I dont want it reset. I wan to add to it.  I can post the  entire code if that helps."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1492581208, "last_edit_date": 1492581208, "creation_date": 1492580893, "answer_id": 43487400, "question_id": 43487063, "link": "https://stackoverflow.com/questions/43487063/vba-loop-to-add-to-string-current-code-overwrites-instead-of-adding-to-cell/43487400#43487400", "title": "vba loop to add to string- Current code overwrites instead of adding to cell", "body": "<p>The issue with the string concatenation can be solved by not resetting the value of <code>SDesc2</code> every time through the <code>icol</code> loop, and then updating the cell only after the end of the loop:</p>\n\n<pre><code>Dim iRow As Integer, iCol As Integer\nDim sDesc as string, sDesc2 As String\nDim wsEntry As Worksheet\nDim wsUp As Worksheet\nSet wsEntry = Worksheets(\"Entries\")\nSet wsUp = Worksheets(\"Sheet1\")\nDim lastrow As Long\nDim sRange As Range\n\nFor iRow = 6 To 7\n    'Qualify \"Rows\"\n    lastrow = wsUp.Cells(wsUp.Rows.Count, \"A\").End(xlUp).Row\n    sDesc = wsEntry.Range(\"M\" &amp; iRow).Value\n\n    sDesc2 = \"\"\n    For iCol = 5 To 11\n        'Qualify \"Cells\" (I have assumed you were referring to wsEntry)\n        If wsEntry.Cells(iRow, iCol).Value &gt; 0 Then  ' Test numeric values, not strings\n            'Append comma only if something already present in the result\n            If sDesc2 &lt;&gt; \"\" Then\n                sDesc2 = sDesc2 &amp; \", \"\n            End If\n            sDesc2 = sDesc2 &amp; wsEntry.Cells(5, iCol).Value\n        End If\n    Next iCol\n\n    wsUp.Range(\"M\" &amp; lastrow + 1).Value = sDesc &amp; sDesc2\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6387534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d8851aafdfee3812dd303166d261b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Angel", "link": "https://stackoverflow.com/users/6387534/angel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3284, "favorite_count": 1, "accepted_answer_id": 43487400, "answer_count": 1, "score": 1, "last_activity_date": 1492581208, "creation_date": 1492579600, "last_edit_date": 1492579702, "question_id": 43487063, "link": "https://stackoverflow.com/questions/43487063/vba-loop-to-add-to-string-current-code-overwrites-instead-of-adding-to-cell", "title": "vba loop to add to string- Current code overwrites instead of adding to cell", "body": "<p>I am trying to add to cell however my code keeps overwriting itself.</p>\n\n<p><strong>Example</strong>:</p>\n\n<p>In a row if there is a value from columns 5 to 11, I want the heading appended to a specific cell (last cell in column M). </p>\n\n<p>If cells e2=Jan f2=Feb g2=Mar\nand e3=100 f3=40 g3=0</p>\n\n<p>I want to see in last row of M \"State - Jan, Feb\"</p>\n\n<p>Currently the codes is ending in \"State - Feb\" because it seems to overite \"Jan\" instead of adding to it. </p>\n\n<pre><code>Dim iRow As Integer, iCol As Integer\nDim sDesc as string, sDesc2 As String\nDim wsEntry As Worksheet\nDim wsUp As Worksheet\nSet wsEntry = Worksheets(\"Entries\")\nSet wsUp = Worksheets(\"Sheet1\")\nDim lastrow As Long\nDim sRange As Range\n\nFor iRow = 6 To 7\n    lastrow = wsUp.Cells(Rows.Count, \"A\").End(xlUp).Row\n    sDesc = wsEntry.Range(\"M\" &amp; iRow).Value\n    wsUp.Range(\"M\" &amp; lastrow + 1).Value = sDesc\n\n    For iCol = 5 To 11\n        If Cells(iRow, iCol) &gt; \"0\" Then\n            sEnt3 = wsEntry.Cells(5, iCol).Value\n            sDesc2 = sDesc &amp; sEnt3 &amp; \", \"\n            wsUp.Range(\"M\" &amp; lastrow).Value = sDesc2\n        End If\n    Next iCol\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"comments": [{"owner": {"reputation": 1428, "user_id": 2681855, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2837e0949b877e993bba550b5b95f498?s=128&d=identicon&r=PG&f=1", "display_name": "ManiMuthuPandi", "link": "https://stackoverflow.com/users/2681855/manimuthupandi"}, "edited": false, "score": 1, "creation_date": 1492582751, "post_id": 43487686, "comment_id": 74030701, "body": "Thanks a lot, Good explanation"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1492582060, "creation_date": 1492582060, "answer_id": 43487686, "question_id": 43487047, "link": "https://stackoverflow.com/questions/43487047/drop-down-values-missing-when-using-range-formula/43487686#43487686", "title": "Drop-down values missing when using Range formula", "body": "<p>Try</p>\n\n<pre><code>\"=PrjList!$A$2:$A$6\"\n</code></pre>\n\n<p>Without the <code>$</code>, the defined range address is \"relative\", so it will \"slide\" down with the cells of your range. i.e. the validation fr the second row will be <code>A3:A7</code> and so on.</p>\n\n<p>The <code>$</code> in the address instructs Excel to <em>fix</em> the validation range, because it is an <em>absolute</em> address.</p>\n"}], "owner": {"reputation": 1428, "user_id": 2681855, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/2837e0949b877e993bba550b5b95f498?s=128&d=identicon&r=PG&f=1", "display_name": "ManiMuthuPandi", "link": "https://stackoverflow.com/users/2681855/manimuthupandi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 43487686, "answer_count": 1, "score": 3, "last_activity_date": 1593678699, "creation_date": 1492579556, "last_edit_date": 1593678699, "question_id": 43487047, "link": "https://stackoverflow.com/questions/43487047/drop-down-values-missing-when-using-range-formula", "title": "Drop-down values missing when using Range formula", "body": "<p>I am having the below VBA function.  This is to create drop-down in the given cells</p>\n\n<pre><code>Public Sub CORE_SetValidation(ByRef Rng As Range, ByVal Value As String)\n    With Rng.Validation\n        Call .Delete\n        If Value &lt;&gt; \"\" Then\n            Call .Add(Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:=Value)\n            .ErrorMessage = \"Please select a value from drop-down list\"\n            .ErrorTitle = \"Value Error\"\n            .IgnoreBlank = True\n            .InCellDropdown = True\n            .InputMessage = \"\"\n            .InputTitle = \"\"\n            .ShowInput = True\n            .ShowError = True\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>When I pass the values to this by comma separated values, its working fine for all the entire columns</p>\n\n<pre><code>dictkeystring = \"1,2,3,4,5,6,7,8,9\"\nCORE_SetValidation(Sourcews.Columns(AllocationSheet_Prj_COLUMN).EntireColumn, dictkeystring)\n</code></pre>\n\n<p>But when I pass the values using Range formula, it doesn't work well.</p>\n\n<pre><code>dictkeystring = \"=PrjList!A2:A6\"\nCORE_SetValidation(Sourcews.Columns(AllocationSheet_Prj_COLUMN).EntireColumn, dictkeystring)\n</code></pre>\n\n<p>Problem is, For each cell I am missing one values; In first column missing one val, second cell missing 2 val, for third missing 3 values,... after some place I am missing all the values, empty drop-down I am getting</p>\n\n<p><a href=\"https://i.stack.imgur.com/QXqFL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QXqFL.png\" alt=\"enter image description here\"></a>\n<br />\nI am not sure why this error happen, Can I resolve this in Range formula</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1492748835, "post_id": 43486820, "comment_id": 74120082, "body": "Note: S3 cell will be change by Form Control or Active X Control, not manually."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1492590099, "post_id": 43486942, "comment_id": 74035250, "body": "Dear Shai,  Thank you for your advise. but the code does not work for me. After changing the S3 value, the S12 has not any change ..."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1492590167, "post_id": 43486942, "comment_id": 74035290, "body": "@Kasra where did you put the code ? what value did you enter in &quot;S3&quot; ?"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1492670281, "post_id": 43486942, "comment_id": 74077727, "body": "Hi, I putted the code under &quot;Microsoft Excel Object&quot; in &#187;AlphaPackage_2017&#171; ... What is surprising is that after changing S3 (S3 is Numeric type) then S12 has not been change. but when any Macro runs then S12 has been change!  what happen my friend?"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1492745726, "post_id": 43486942, "comment_id": 74119210, "body": "Hi my friend. thank you for your advise. I&#39;m Sorry, your code working but just if I change S3 value manually by keyboard! The code not works by form control or active X control. what is the solution?  Appreciate, Kasra"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1492579378, "last_edit_date": 1492579378, "creation_date": 1492579053, "answer_id": 43486942, "question_id": 43486820, "link": "https://stackoverflow.com/questions/43486820/set-value-of-a-cell-based-on-another-cells-value-in-vba-excel-2010/43486942#43486942", "title": "Set value of a cell based on another cell&#39;s value in VBA Excel 2010", "body": "<p>Add the code below in the <code>Worksheet_Change</code> event of \"AlphaPackage_2017\" sheet.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n' run the code below only if a value in cell \"S3\" is changed\nIf Not Intersect(Target, Range(\"S3\")) Is Nothing Then\n\n    Select Case Target.Value ' &lt;-- check the value of Range(\"S3\")\n        Case Is &gt; 6\n            Range(\"S12\").Value = 20\n        Case Else\n            Range(\"S12\").Value = 7\n    End Select\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Follow screen-shot below where to add this code (just in case you haven't used a <code>Worksheet</code> event before):</p>\n\n<p><a href=\"https://i.stack.imgur.com/HPukH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HPukH.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1492579255, "post_id": 43486950, "comment_id": 74029180, "body": "@ShaiRado although you typed much more lines. +1 for yours uses <code>Intersect</code> which is more accurate a solution :)"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1492745011, "post_id": 43486950, "comment_id": 74119033, "body": "@A.S.H Thank you for your advise, but after changing the S3 value by manually (with keyboard) , Excel is stopped and VB shows the second line:  If Target.Adress(0, 0) = &quot;S3&quot; Then  in yellow color. And also I want to use a form control or active X control for changing S3 value.  what is solution?  Appreciate, Kasra"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1492745396, "post_id": 43486950, "comment_id": 74119128, "body": "@Kasra I&#39;m so sorry, there was a typo in there (<code>Adress</code> should be <code>Address</code>). Seize the occasion and start using <code>Option Explicit</code>, the compiler will then spot for you such mistakes immediately :)"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1492749071, "post_id": 43486950, "comment_id": 74120140, "body": "@A.S.H Thank You My Friend ... OK, I want to use a Form Control or Active X control for changing S3 value. what is the solution with before conditions?   Appreciate, Kasra"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1492749581, "post_id": 43486950, "comment_id": 74120268, "body": "@Kasra that&#39;s a different and broad subject. I suggest you try setting the <code>Cell Link</code> property of the control and observe what happens. When facing a specific problem it should be worth a dedicated question :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1492745416, "last_edit_date": 1492745416, "creation_date": 1492579093, "answer_id": 43486950, "question_id": 43486820, "link": "https://stackoverflow.com/questions/43486820/set-value-of-a-cell-based-on-another-cells-value-in-vba-excel-2010/43486950#43486950", "title": "Set value of a cell based on another cell&#39;s value in VBA Excel 2010", "body": "<p>In the code module of the <code>AlphaPackage_2017</code> worksheet, write this routine:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address(0, 0) = \"S3\" Then\n        Me.Range(\"S12\").Value = IIf(Target.Value &gt; 6, 20, 7)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3617, "favorite_count": 0, "accepted_answer_id": 43486950, "answer_count": 2, "score": 1, "last_activity_date": 1492745416, "creation_date": 1492578330, "last_edit_date": 1531164843, "question_id": 43486820, "link": "https://stackoverflow.com/questions/43486820/set-value-of-a-cell-based-on-another-cells-value-in-vba-excel-2010", "title": "Set value of a cell based on another cell&#39;s value in VBA Excel 2010", "body": "<p>I want to set a value for a cell <code>[S12]</code> in a sheet called <strong>\"AlphaPackage_2017\"</strong> based on the other cell's value <code>[S3]</code> .</p>\n\n<p>checking should follow the  value in cell <code>[S3]</code> for any changing value and update immediately the value in cell <code>[S12]</code>.</p>\n\n<p>I wrote the below code:</p>\n\n<pre><code>Do\n    If S3.Value &gt; 6 Then\n        S12 = 20\n    Else\n        S12 = 7\n    End If\nLoop\n</code></pre>\n\n<p>the code does not work correctly, any advise is appreciated ...\nand also where the code should be write: in Module or in Page?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492578599, "post_id": 43486824, "comment_id": 74028911, "body": "Besides, the <code>SeriesCollection.XValues</code> is an array, could be made = <code>xdataRng.Value</code> but that would make it static. Your solution  makes it dynamically linked to the range (y)."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492578652, "post_id": 43486824, "comment_id": 74028933, "body": "@A.S.H I have been using too many Charts and Pivots MACROs lately ;)"}, {"owner": {"reputation": 53, "user_id": 7887525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a6acd95549dee190bde1d5cfdc5e938?s=128&d=identicon&r=PG&f=1", "display_name": "Eeshwar", "link": "https://stackoverflow.com/users/7887525/eeshwar"}, "edited": false, "score": 0, "creation_date": 1492593671, "post_id": 43486824, "comment_id": 74037673, "body": "Thanks Shai! That worked perfectly.  Separately, the <code>.Axes(xlCategory, xlPrimary).Character.Text</code> won&#39;t work, but <code>.Axes(xlCategory, xlPrimary).TextTitle.Text</code> will."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1492578348, "creation_date": 1492578348, "answer_id": 43486824, "question_id": 43486735, "link": "https://stackoverflow.com/questions/43486735/excel-vba-error-438-on-adding-values-to-series-in-chart-sheet-excel-2010/43486824#43486824", "title": "Excel-VBA: Error 438 on Adding Values to Series in Chart Sheet, Excel 2010", "body": "<p>Try the section of code below to replace yours:</p>\n\n<pre><code>With wb.Sheets(chartName)\n    Dim Ser As Series\n\n    Set Ser = .SeriesCollection.NewSeries\n    With Ser\n        .XValues = \"=\" &amp; xDataRng.Address(True, True, xlA1, xlExternal)\n        .Values = \"=\" &amp; yDataRng.Address(True, True, xlA1, xlExternal)\n    End With\n\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).Character.Text = xnameRng.Value\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).Character.Text = ynameRng.Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7887525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a6acd95549dee190bde1d5cfdc5e938?s=128&d=identicon&r=PG&f=1", "display_name": "Eeshwar", "link": "https://stackoverflow.com/users/7887525/eeshwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 43486824, "answer_count": 1, "score": 2, "last_activity_date": 1520354380, "creation_date": 1492577850, "last_edit_date": 1520354380, "question_id": 43486735, "link": "https://stackoverflow.com/questions/43486735/excel-vba-error-438-on-adding-values-to-series-in-chart-sheet-excel-2010", "title": "Excel-VBA: Error 438 on Adding Values to Series in Chart Sheet, Excel 2010", "body": "<p>I'm trying to put together some code that collects a set of data from a worksheet and then generates an XY Scatter plot. Whenever it reaches the line for inputting values into the series, it produces a \"Runtime Error 438: Object doesn't support this property or method.\"</p>\n\n<p><code>xDataRng.Address</code> has a value of <code>\"$C$8:$C$11\"</code></p>\n\n<p>I'm using Excel 2010 on Win 7.</p>\n\n<p>I've looked up every article and help thread I could find about this issue. Am I using <code>.SeriesCollection.XValues</code> incorrectly? How can I fix it?</p>\n\n<p>Thanks,</p>\n\n<p>Eeshwar</p>\n\n<pre><code>Sub createChart()\n\nSet wb = ThisWorkbook\nDim sheetName As Variant, chartName As Variant\n\nsheetName = ActiveSheet.Name\n\n'Find x-axis data\nDim xnameRng As Range, xdataRng As Range\nDim lastCol As Long, lastRow As Long\nDim i As Integer\n\nWith ActiveSheet\n    lastCol = .Cells(7, .Columns.Count).End(xlToLeft).Column\n    Set xnameRng = .Range(Cells(7, 2), Cells(7, lastCol)).Find(\"Horizontal Position (\", lookat:=xlPart)\n    lastRow = .Cells(.Rows.Count, xnameRng.Column).End(xlUp).Row\n    Set xdataRng = .Range(xnameRng.Offset(1, 0).Address, Cells(lastRow, xnameRng.Column))\nEnd With\n\n'Find y-axis data\nDim ynameRng As Range, ydataRng As Range\n\nWith ActiveSheet\n    Set ynameRng = .Range(.Cells(7, 2), .Cells(7, lastCol)).Find(\"Pressure (\", lookat:=xlPart)\n    Set ydataRng = .Range(ynameRng.Offset(1, 0).Address, .Cells(lastRow, ynameRng.Column))\nEnd With\n\n'Create chart\nWith wb.Sheets(\"Chart_Template\")\n    .Copy After:=Sheets(sheetName)\n\n    chartName = ActiveChart.Name\n\n    'Update chart details\n    With wb.Sheets(chartName)\n        .SeriesCollection.NewSeries\n        .SeriesCollection.XValues(1) = wb.Sheets(sheetName).Range(xdataRng.Address)  FAILS HERE\n        .SeriesCollection.Values(1) = wb.Sheets(sheetName).Range(ydataRng.Address)\n        .Axes(xlCategory, xlPrimary).HasTitle = True\n        .Axes(xlCategory, xlPrimary).Character.Text = xnameRng.Value\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).Character.Text = ynameRng.Value\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["loops", "ms-access", "vba", "do-while"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6901532, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/38285f61832fa43af61ae2c7e66c82ce?s=128&d=identicon&r=PG", "display_name": "Stavros_McGillicuddy", "link": "https://stackoverflow.com/users/6901532/stavros-mcgillicuddy"}, "edited": false, "score": 0, "creation_date": 1492610975, "post_id": 43487768, "comment_id": 74050530, "body": "Ah.. That&#39;s it. Thank you for your help"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1492582413, "creation_date": 1492582413, "answer_id": 43487768, "question_id": 43486302, "link": "https://stackoverflow.com/questions/43486302/vba-insert-two-list-box-values-into-a-table/43487768#43487768", "title": "VBA Insert two list box values into a table", "body": "<p>You need an inner loop as well:</p>\n\n<pre><code>Dim db As DAO.Database\nDim rs As DAO.Recordset\n\nSet db = CurrentDb()\nSet rs = db.OpenRecordset(\"tblFinal\")\n\nFor Each concept In ConceptList.ItemsSelected\n    For Each park In ParkList.ItemsSelected\n        rs.AddNew\n            rs!ConceptID = ConceptList.ItemData(concept)\n            rs!ParkID = ParkList.ItemData(park)\n        rs.Update\n    Next\nNext   \nrs.Close\n\nSet rs = Nothing\nSet db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6901532, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/38285f61832fa43af61ae2c7e66c82ce?s=128&d=identicon&r=PG", "display_name": "Stavros_McGillicuddy", "link": "https://stackoverflow.com/users/6901532/stavros-mcgillicuddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 43487768, "answer_count": 1, "score": 0, "last_activity_date": 1492582413, "creation_date": 1492575616, "last_edit_date": 1492582090, "question_id": 43486302, "link": "https://stackoverflow.com/questions/43486302/vba-insert-two-list-box-values-into-a-table", "title": "VBA Insert two list box values into a table", "body": "<p>I have two list boxes on my form.\nFor each item selected in ConceptList, I need to add all selected items in ParkList</p>\n\n<p>The attached Desired State image shows what I would expect when Two selections were made in the ConceptList and four in the ProspectList. The Current State shows the result of the code below</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZOWW1.png\" rel=\"nofollow noreferrer\">Current State Image</a>\n<a href=\"https://i.stack.imgur.com/qLfiR.png\" rel=\"nofollow noreferrer\">Desired State Image</a></p>\n\n<pre><code>  Dim db As Database\n   Dim rs As Recordset\n\n   Set db = CurrentDb()\n   Set rs = db.OpenRecordset(\"tblFinal\")\n   For Each itm In ConceptList.ItemsSelected\n        rs.AddNew\n        rs!ConceptID = ConceptList.ItemData(itm)\n        rs!ParkID = ParkList.ItemData(itm)\n        rs.Update\n  Next\n\n  rs.Close\n  Set rs = Nothing\n  Set db = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1492575868, "post_id": 43486143, "comment_id": 74027968, "body": "Do you ever have other sheets active? You use <code>With sht5</code>, but never &quot;anchor&quot; the ranges in that <code>With</code> statement. For instance, almost every use of <code>Cells()</code>, <code>Range()</code>, should have the <code>.</code> before it, so it makes positive that you&#39;re using the <code>Range()</code> and <code>Cells()</code> on <code>sht5</code>, otherwise it&#39;ll look to the active sheet for the range values."}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1492576824, "creation_date": 1492576824, "answer_id": 43486531, "question_id": 43486143, "link": "https://stackoverflow.com/questions/43486143/highlight-every-second-visible-row/43486531#43486531", "title": "highlight every second visible row", "body": "<p>After some difficulty I think I got it. You want to alternate the interior color of your <em>visible</em> rows but what you are actually doing is based on the <code>.row</code> property, which is independent on the visible/hidden rows. So your result is that even-numbered rows are colored with <code>RGB(228, 223, 235)</code> regardless of what rows are hidden.</p>\n\n<p>Without much involvement in the rest of your routine, these lines should be fixed: </p>\n\n<pre><code>&gt;     With WholeRng\n&gt;         For Each rng In WholeRng\n&gt;             If WorksheetFunction.Ceiling(rng.Row - 2, 1) Mod 2 = 0 Then\n&gt;                 rng.Interior.Color = RGB(228, 223, 235)\n&gt;             End If\n&gt;         Next\n&gt;     End With\n</code></pre>\n\n<p>As a simple fix, try changing the above lines into the following:</p>\n\n<pre><code>Dim b As Boolean\nFor Each rng In WholeRng.Rows\n    If Not rng.Hidden Then\n        If b Then rng.Interior.Color = RGB(228, 223, 235)\n        b = Not b\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1492579574, "creation_date": 1492579574, "answer_id": 43487056, "question_id": 43486143, "link": "https://stackoverflow.com/questions/43486143/highlight-every-second-visible-row/43487056#43487056", "title": "highlight every second visible row", "body": "<p>You can do this without code, Conditional Formatting will suffice</p>\n\n<ol>\n<li>Select rows 1 to 2 (start in A1 for the select)</li>\n<li>Add this conditional format test <code>=MOD(SUBTOTAL(103,A1:$A$1),2)=0</code></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/uPEGH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uPEGH.png\" alt=\"enter image description here\"></a></p>\n\n<ul>\n<li>The <code>SUBTOTAL</code> formula is using to count not blank entries, it ignores hidden cells.</li>\n<li>The <code>MOD</code> section highlights every second visible row.</li>\n</ul>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 43486531, "answer_count": 2, "score": 3, "last_activity_date": 1492579606, "creation_date": 1492574571, "last_edit_date": 1492579606, "question_id": 43486143, "link": "https://stackoverflow.com/questions/43486143/highlight-every-second-visible-row", "title": "highlight every second visible row", "body": "<p>I am trying to pinstripe every other visible row after i run a hide rows containing a total of 0. </p>\n\n<p>I have some code that does some striping but doesn't seem to be constantly every other visible row.</p>\n\n<p>Depending on the total qty the pin striping will be spot almost spot on and sometimes it will look like the attached picture.</p>\n\n<pre><code>Sub Format_635()\nApplication.ScreenUpdating = False\n\nDim sht5 As Worksheet\nSet sht5 = ThisWorkbook.Worksheets(\"635 BOM\")\n\nCall Unprotect\nsht5.Activate\n\nDim lastRow As Long, lastCol As Long\nDim rng As Range\nDim WholeRng As Range\n\nWith sht5\n    Set rng = Cells\n\n    'last row\n    lastRow = rng.Find(What:=\"*\", After:=rng.Cells(1), Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False).Row\n\n    'last column\n    lastCol = rng.Find(What:=\"*\", After:=rng.Cells(1), Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False).Column\n\n    Set WholeRng = Range(Cells(9, \"A\"), Cells(lastRow, lastCol))\n    WholeRng.Select\n\n    With WholeRng\n        With .Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = RGB(255, 255, 255)\n        .TintAndShade = 0\n        Range(Cells(9, \"A\"), Cells(lastRow, lastCol)).Borders(xlInsideHorizontal).LineStyle = xlContinuous\n        Range(Cells(9, \"A\"), Cells(lastRow, lastCol)).Borders(xlInsideVertical).LineStyle = xlContinuous\n        Range(Cells(9, \"A\"), Cells(lastRow, lastCol)).Borders(xlEdgeBottom).LineStyle = xlContinuous\n        Range(Cells(9, \"A\"), Cells(lastRow, lastCol)).Borders(xlEdgeRight).LineStyle = xlContinuous\n        End With\n    End With\n\n    With WholeRng\n    For Each rng In WholeRng\n    If WorksheetFunction.Ceiling(rng.Row - 2, 1) Mod 2 = 0 Then\n    rng.Interior.Color = RGB(228, 223, 235)\n    End If\n    Next\n    End With\nEnd With\n\nCall Protect\nsht5.Activate\nCall NoSelect\n\nSet rng = Nothing\nSet WholeRng = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xLzjD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xLzjD.png\" alt=\"Example\"></a></p>\n\n<blockquote>\n  <p>Thx </p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "search"], "comments": [{"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492568038, "post_id": 43485032, "comment_id": 74025857, "body": "The required parameter for MsgBox is a String, so you wouldn&#39;t want to use cVar(),  but cStr() or Format(). Is it possible that the Value is empty?"}, {"owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "reply_to_user": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492568409, "post_id": 43485032, "comment_id": 74025955, "body": "I added the following line (which is what my expected outcome should be) and the value returned correctly, so i guess the value shouldn&#39;t be empty?  <code>MsgBox ws.Range(&quot;B3&quot;).Value</code>"}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492570040, "post_id": 43485032, "comment_id": 74026356, "body": "Ok, it took me a while to notice...instead of (&quot;B&quot; + cRow), use (&quot;B&quot; &amp; cRow). Same in other places. &amp; is the string concatenation operator, not +."}, {"owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "reply_to_user": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492570598, "post_id": 43485032, "comment_id": 74026481, "body": "@RichHolton thanks alot! yeap, did it according to A.S.H&#39;s suggestion and it worked! :D"}, {"owner": {"reputation": 620, "user_id": 3119180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc7a56a59ab84634ee6cb37a7131ed2?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Holton", "link": "https://stackoverflow.com/users/3119180/rich-holton"}, "edited": false, "score": 0, "creation_date": 1492572954, "post_id": 43485032, "comment_id": 74027101, "body": "Glad A.S.H. was able to see it sooner than I did."}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1492568966, "last_edit_date": 1492568966, "creation_date": 1492568536, "answer_id": 43485217, "question_id": 43485032, "link": "https://stackoverflow.com/questions/43485032/excel-vba-type-mismatch-error-while-copying-value-from-cell-into-textbox/43485217#43485217", "title": "&lt;Excel-VBA&gt; &quot;Type mismatch&quot; error while copying value from cell into textbox", "body": "<blockquote>\n  <p><code>\"B\" + cRow</code></p>\n</blockquote>\n\n<p>This is not how you concatenate a number to a string in VBA. You should use:</p>\n\n<pre><code>\"B\" &amp; cRow\n'  ^^^\n</code></pre>\n\n<p>Ok the <code>+</code> operator works for concatenating strings, i.e. <code>\"a\" + \"b\"</code> but when trying it on a string and a number, it's a <em>type mismatch</em>. You could use <code>\"B\" + CStr(cRow)</code> but I advice you to drop completely the use of the <code>+</code> operator for string concatenation in VBA and stick to the <code>&amp;</code> operator for this matter.</p>\n"}], "owner": {"reputation": 43, "user_id": 1777263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577d933d71bffa51f80ddd394e4cd83b?s=128&d=identicon&r=PG", "display_name": "DG85", "link": "https://stackoverflow.com/users/1777263/dg85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 43485217, "answer_count": 1, "score": 2, "last_activity_date": 1492570902, "creation_date": 1492567271, "last_edit_date": 1492570902, "question_id": 43485032, "link": "https://stackoverflow.com/questions/43485032/excel-vba-type-mismatch-error-while-copying-value-from-cell-into-textbox", "title": "&lt;Excel-VBA&gt; &quot;Type mismatch&quot; error while copying value from cell into textbox", "body": "<p>I am currently doing up a simple Userform &lt;> Worksheet data editing interface, located in the same workbook. My userform buttons are on Sheet A and the Database (from which data will be pulled) is in another sheet. I am currently working on the search function (the entire block of code which is included below) and I am experiencing a \"type mismatch\" error at the following line:</p>\n\n<pre><code>MsgBox ws.Range(\"B\" + cRow).Value\n</code></pre>\n\n<p>I have tried using the CVar() and other alternatives but it does not resolve the problem.</p>\n\n<p>My intended workflow is that when a user types in a company name in the 'txtCompany' textbox and clicks the search button, it will search the database in the 'Company Name' (Column D) column for a similar name and return all other values in that row to my textboxes in the userform. </p>\n\n<p>Would kindly appreciate if anyone could enlighten me as to what is causing this problem. The entire code for the Sub is given below:</p>\n\n<pre><code>Private Sub btnSearch_Click()\n\nDim lRow As Long\nDim ws As Worksheet\nDim srcterm As String\nDim datevalue As String\nDim cCol, cRow As Integer\n\nSet ws = ThisWorkbook.Worksheets(\"Database\")\nlRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\nDim x As Control\nFor Each x In frmSearch.Controls\n    If TypeName(x) = \"TextBox\" Then\n    x.Value = \"\"\n    End If\nNext x\n\nsrcterm = txtCompany.Value\nMsgBox lRow\n\nFor Each cell In ws.Range(\"D3:D\" &amp; lRow)\n\n    If cell.Value Like srcterm Then\n\n        cRow = cell.Row\n        MsgBox cRow\n        MsgBox ws.Range(\"B\" + cRow).Value\n\n        With frmSearch\n            .txtDate.Value = ws.Range(\"B\" + cRow).Value\n            .txtCustomer.Value = ws.Cells(\"C\" + cRow).Value\n            .txtCompany.Value = ws.Cells(\"D\" + cRow).Value\n            .txtAddress.Value = ws.Cells(\"E\" + cRow).Value\n            .txtContact.Value = ws.Cells(\"F\" + cRow).Value\n            .txtEmail.Value = ws.Cells(\"G\" + cRow).Value\n            .txtStatus.Value = ws.Cells(\"H\" + cRow).Value\n        End With\n\n        datevalue = ws.Cells(\"A\" + cRow).Value\n    End If\n\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5645297, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f5bf1fc8b23f489e32a4d281db5dc088?s=128&d=identicon&r=PG&f=1", "display_name": "JordanCA57", "link": "https://stackoverflow.com/users/5645297/jordanca57"}, "edited": false, "score": 0, "creation_date": 1492577511, "post_id": 43486092, "comment_id": 74028498, "body": "Thanks so much for your help.  I just tried running this and I&#39;m getting a error in Sub Rectangles on the line Set SS = Cells(row, c)  c shows as empty.  I&#39;m not sure how to correct this."}, {"owner": {"reputation": 125, "user_id": 5645297, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f5bf1fc8b23f489e32a4d281db5dc088?s=128&d=identicon&r=PG&f=1", "display_name": "JordanCA57", "link": "https://stackoverflow.com/users/5645297/jordanca57"}, "edited": false, "score": 0, "creation_date": 1492577771, "post_id": 43486092, "comment_id": 74028609, "body": "As always, I posted my followup questions and then figured it out.  I changed &quot;col as Integer&quot; to &quot;c as Integer&quot; and it ran through with no errors.  The second column isn&#39;t placing them shapes in the right place.  Where is finds &quot;EE Only&quot;, but I&#39;ll spend some more time and try and figure it out.  Thanks again for your help."}, {"owner": {"reputation": 344, "user_id": 5803423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53283f0783229af1abc39741ab30b844?s=128&d=identicon&r=PG&f=1", "display_name": "protango", "link": "https://stackoverflow.com/users/5803423/protango"}, "reply_to_user": {"reputation": 125, "user_id": 5645297, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f5bf1fc8b23f489e32a4d281db5dc088?s=128&d=identicon&r=PG&f=1", "display_name": "JordanCA57", "link": "https://stackoverflow.com/users/5645297/jordanca57"}, "edited": false, "score": 0, "creation_date": 1492646476, "post_id": 43486092, "comment_id": 74070541, "body": "ahh yes my apologies I forgot to rename that variable, glad you figured it out!"}], "tags": [], "owner": {"reputation": 344, "user_id": 5803423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53283f0783229af1abc39741ab30b844?s=128&d=identicon&r=PG&f=1", "display_name": "protango", "link": "https://stackoverflow.com/users/5803423/protango"}, "is_accepted": true, "score": 1, "last_activity_date": 1492646648, "last_edit_date": 1492646648, "creation_date": 1492574267, "answer_id": 43486092, "question_id": 43484973, "link": "https://stackoverflow.com/questions/43484973/loop-through-a-row-until-blank/43486092#43486092", "title": "Loop through a row until blank", "body": "<p>I wasn't 100% sure about your requirements, but here's my best interpretation of it. Not I defined a new subroutine for the rectangles section, see comments for details</p>\n\n<pre><code>Sub AddShapes()\n    Const TextToFind As String = \"EE Only\"\n    Dim ws As Worksheet\n    Dim RowNum As Range\n\n    Set ws = ActiveSheet\n    Dim c As Integer\n    c = 2\n\n    Set RowNum = ws.Range(\"A:A\").Find(what:=TextToFind, lookat:=xlWhole)\n    Call Rectangles(RowNum.row, c, ws) ' call the rectangles function for our first instance\n\n    c = c+1 ' increment the column by one so we're not on the same column\n\n    Do While Not IsEmpty(Cells(3,c).Value) 'Loop through each column until the 3rd row is empty\n        Call Rectangles(3,c,ws) ' call our rectangles function on the 3rd row in the current column (c)\n        c=c+1 ' increment the column\n    Loop\n\nEnd Sub\n\nSub Rectangles(row As Integer, c As Integer, ws As Worksheet) ' we define a separate sub to draw the rectangles so that we can call it again and again\n    Dim SSLeft As Double\n    Dim SSTop As Double\n    Dim SS As Range\n    Set SS = Cells(row, c)\n    SSLeft = Cells(row, c).Left + (Cells(row, c).Width) / 4\n\n    'Add four rectangles\n    Dim y As Integer\n    For y = 0 To 3\n        SSTop = Cells(row + y, c).Top + ((Cells(row + y, c).Height) / 2) - 5\n        Call ActiveSheet.Shapes.AddShape(msoShapeRectangle, SSLeft, SSTop, 10, 10)\n    Next\n\n    'Format them\n\n    ws.DrawingObjects.Select\n    Selection.ShapeRange.Fill.Visible = msoFalse\n    With Selection.ShapeRange.Line\n        .Visible = msoTrue\n        .Weight = 1\n        .ForeColor.RGB = RGB(0, 0, 0)\n        .Transparency = 0\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5645297, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f5bf1fc8b23f489e32a4d281db5dc088?s=128&d=identicon&r=PG&f=1", "display_name": "JordanCA57", "link": "https://stackoverflow.com/users/5645297/jordanca57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 1, "accepted_answer_id": 43486092, "answer_count": 1, "score": 2, "last_activity_date": 1492646648, "creation_date": 1492566893, "last_edit_date": 1492571461, "question_id": 43484973, "link": "https://stackoverflow.com/questions/43484973/loop-through-a-row-until-blank", "title": "Loop through a row until blank", "body": "<p>I have the code below that does the following.</p>\n\n<p>It finds the text \u201cEE Only\u201d in column A and records the row number.</p>\n\n<p>It then adds four rectangles with the first one in the recorded row number and the other three in the three rows below.</p>\n\n<p>It then formats the rectangles with no fill and a black border.</p>\n\n<p>I have dim c as Integer and c = 2.  I then use that as the column.   So far everything is working as it should.  The problem I\u2019m having is that I need the column number to increase by one for every column after B that has something in row 3.  In other words; the first set of shapes will always be in column B.  After that if there is something in C3 then I need the column number to be increase by 1 and the shapes added to column C.  If something is in D3 increase c by 1 and add shapes to column D and so forth.  The first time row 3 is blank the loop would stop.</p>\n\n<p>I\u2019ve tried a couple of different things and I\u2019m at a completely loss.  The other issue I\u2019m having is, if I run the code with c = 2 the shapes are formatted properly.  If I then leave those shapes and manually change to c = 3 and run the code again, the new set of shapes have a blue fill.  Again, tried everything I could find and nothing works.</p>\n\n<pre><code>Sub AddShapes()\nConst TextToFind As String = \"EE Only\"\nDim ws As Worksheet\nDim RowNum As Range\n\nDim SSLeft As Double\nDim SSTop As Double\nDim SS As Range\nSet ws = ActiveSheet\nDim c As Integer\nc = 2\n\nSet RowNum = ws.Range(\"A:A\").Find(what:=TextToFind, lookat:=xlWhole)\nSet SS = Cells(RowNum.Row, c)\nSSLeft = Cells(RowNum.Row, c).Left + (Cells(RowNum.Row, c).Width) / 4\n\n'Add four rectangles\nDim y As Integer\nFor y = 0 To 3\n    SSTop = Cells(RowNum.Row + y, c).Top + ((Cells(RowNum.Row + y, c).Height) / 2) - 5\n    Call ActiveSheet.Shapes.AddShape(msoShapeRectangle, SSLeft, SSTop, 10, 10)\nNext\n\n'Format them\n\nws.DrawingObjects.Select\nSelection.ShapeRange.Fill.Visible = msoFalse\nWith Selection.ShapeRange.Line\n    .Visible = msoTrue\n    .Weight = 1\n    .ForeColor.RGB = RGB(0, 0, 0)\n    .Transparency = 0\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492568807, "post_id": 43484514, "comment_id": 74026069, "body": "How are those images embedded in your worksheet? As links to existing image files?"}, {"owner": {"reputation": 1, "user_id": 7819274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7ec2e31d1dd0b0ba306f139fd0d7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Txon", "link": "https://stackoverflow.com/users/7819274/txon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492664963, "post_id": 43484514, "comment_id": 74075368, "body": "Yes as hyperlinks to existing image files. Is there any other way without using hyperlinks? Please advice."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492683121, "post_id": 43484514, "comment_id": 74086162, "body": "How were those pictures inserted? manually or through VBA? Are these <i>shapes</i> with the fill area linked to an image? Is the file&#39;s name available somewhere in the cell, in the shape, etc? The more you provide information about <i>how</i> those pictures were inititally inserted, the more chance you have to find a solution."}, {"owner": {"reputation": 1, "user_id": 7819274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7ec2e31d1dd0b0ba306f139fd0d7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Txon", "link": "https://stackoverflow.com/users/7819274/txon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492735045, "post_id": 43484514, "comment_id": 74116549, "body": "Okay. Those images in the sheet are placed using image(activex control). And i want those images to appear in image box in the userform depends on the part no typed in textbox1."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492744957, "post_id": 43484514, "comment_id": 74119022, "body": "If the file names of the pics were not stored in the cells or somewhere, it&#39;s very difficult to retrieve them. And you need them because the image control does not support copy/paste."}, {"owner": {"reputation": 1, "user_id": 7819274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7ec2e31d1dd0b0ba306f139fd0d7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Txon", "link": "https://stackoverflow.com/users/7819274/txon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492755363, "post_id": 43484514, "comment_id": 74122463, "body": "These images are not copy and pasted. Its placed using activex image control from developer tab. We cannot retrieve the images to userform using the image names? If its difficult i can store hyperlinks to those image files in the cells replacing the images in database. But what are the changes i must do in my coding? Please advice."}, {"owner": {"reputation": 1, "user_id": 7819274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7ec2e31d1dd0b0ba306f139fd0d7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Txon", "link": "https://stackoverflow.com/users/7819274/txon"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492824359, "post_id": 43484514, "comment_id": 74160493, "body": "These images are not copy and pasted. Its placed using activex image control from developer tab. We cannot retrieve the images to userform using the image names? If its difficult i can store hyperlinks to those image files in the cells replacing the images in database. But what are the changes i must do in my coding? Please advice."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1492824729, "post_id": 43484514, "comment_id": 74160571, "body": "The easiest would be to store the file&#39;s names in the cell of column L itself, under the image. If you edit your question and say that, the problem wil be reduced to retrieving the right file name and dsplaying it in the image contol of the form. In that case I have an answer. But as I told you, retrieving the linked file&#39;s name from the shape itself is extremely difficult in Excel."}], "owner": {"reputation": 1, "user_id": 7819274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f7ec2e31d1dd0b0ba306f139fd0d7d9?s=128&d=identicon&r=PG&f=1", "display_name": "Txon", "link": "https://stackoverflow.com/users/7819274/txon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1530103503, "creation_date": 1492563479, "last_edit_date": 1530103503, "question_id": 43484514, "link": "https://stackoverflow.com/questions/43484514/how-to-change-the-display-pictures-in-userform-depend-on-textbox-1-value", "title": "How to change the display pictures in userform depend on textbox 1 value", "body": "<p>I have an Excel database of parts and I have created a userform where all the information about the parts will show up in the userform once I key in the part no in textbox1. \nBut now I'm stucked where I need the picture of the part to show up as well once I key in the part no in textbox1. </p>\n\n<p>Need some help.</p>\n\n<p>Please refer below for the picture of my datebase and userform and also my codes to pull up the information.</p>\n\n<p>Thanks.</p>\n\n<p>Database:\n<a href=\"https://i.stack.imgur.com/Aq86O.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Aq86O.jpg\" alt=\"database\"></a></p>\n\n<p>Userform:\n<a href=\"https://i.stack.imgur.com/kjrbf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kjrbf.jpg\" alt=\"userform\"></a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    ClearForm\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    Unload Me\nEnd Sub\n\nPrivate Sub TextBox1_Change()\n    GetData\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    TextBox1.SetFocus\nEnd Sub         \n\nSub GetData()\n    Dim id As Integer, i As Integer, j As Integer, flag As Boolean\n    If IsNumeric(UserForm1.TextBox1.Value) Then\n        flag = False\n        i = 0\n        id = UserForm1.TextBox1.Value\n\n        Do While Cells(i + 1, 1).Value &lt;&gt; \"\"\n            If Cells(i + 1, 1).Value = id Then\n                flag = True\n                For j = 2 To 10\n                    UserForm1.Controls(\"TextBox\" &amp; j).Value = Cells(i + 1, j).Value\n                Next j\n            End If\n            i = i + 1\n        Loop\n\n        If flag = False Then\n            For j = 2 To 10\n                UserForm1.Controls(\"TextBox\" &amp; j).Value = \"\"\n            Next j\n        End If\n    Else\n        ClearForm\n    End If\nEnd Sub\n\nSub ClearForm()\n    For j = 1 To 10\n        UserForm1.Controls(\"TextBox\" &amp; j).Value = \"\"\n    Next j\nEnd Sub   \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 1, "creation_date": 1492563668, "post_id": 43484473, "comment_id": 74024770, "body": "You need to be careful with declaration. It may overflow."}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "edited": false, "score": 1, "creation_date": 1492564169, "post_id": 43484473, "comment_id": 74024885, "body": "You have an exit condition based on the last cell of Column &quot;H&quot; - what&#39;s in Column H?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1492564419, "post_id": 43484473, "comment_id": 74024945, "body": "<i>&quot;time stamp in Column A and data in column B&quot;</i>... Please make your description match your code!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492571760, "post_id": 43484473, "comment_id": 74026783, "body": "Shouldn&#39;t <code>hr_counter_row = cell.Row + hr_counter</code> be <code>hr_counter_row = cell.Row + hr_counter - 2</code>?  For instance, (ignoring the frequency at which you really get data) if you have values at 10:00:00 in row 5, 10:30:00 in row 6, and 11:02:00 in row 7, then <code>cell.Row</code> will be 5. <code>hr_counter</code> will be 1 when you compare the value in row 5 to 11:00:00, it will be 2 when you compare the value in row 6 to 11:00:00, and it will be 3 when you compare the value in row 7 to 11:00:00 and exit the loop.  You would only want the average of rows 5 and 6, but will actually be averaging across rows 5 to 8."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492572059, "post_id": 43484473, "comment_id": 74026849, "body": "And definitely change the declarations of <code>hr_counter</code> and <code>hr_counter_row</code> to be <code>Long</code> instead of <code>Double</code> - there is no need to use floating-point values for something which is being used to refer to rows - Excel doesn&#39;t support fractional row numbers."}], "owner": {"reputation": 19, "user_id": 7886876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9784f870a64f397ac314468cc5a44a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Automan", "link": "https://stackoverflow.com/users/7886876/automan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1580130272, "creation_date": 1492563229, "last_edit_date": 1580130272, "question_id": 43484473, "link": "https://stackoverflow.com/questions/43484473/loop-counter-not-incrementing-for-large-number-of-loops", "title": "Loop counter not incrementing for large number of loops", "body": "<p>I have a data set with a time stamp in Column A and data in column B. There are four seconds to 30 minutes between data samples. I created VBA code to calculate the one hour average for each row. </p>\n\n<p>The data files can be 800,000 rows long. Everything runs smoothly until around 50,000 rows. After that the average starts to overshoot or undershoot by minutes. Sometimes it provides the average of 45 minutes, and others 1 hour and 20 minutes.</p>\n\n<pre><code>Sub One_hr_Avg()\n'\n' One_hr_Avg Macro\n' Determines the cel range of an hour from the starting cell and computes the average of the power across that range.\n'\n\n'\nApplication.Calculation = xlCalculationManual\n    'Set wks = ActiveWorkbook.Sheets(\"M_FPEB_Pwr_CV3_Plateau\")\n\n    'cell_rng: the user defined range of cells that the macro will search throughout for blanks.\n    'cell: the current working cell.\n    'cell_time: temp cell used to find the row of the cell ~1hr from the current cell.\n    Dim cell_rng As Range\n    Dim cell As Range\n    Dim cell_time As Range\n\n    'cell_start: the the starting time for the 1 hr avg.\n    'cell_end: the end time for the 1 hr avg.\n    Dim cell_start As Date\n    Dim cell_end As Date\n    Dim cell_start_temp As Date\n\n    Dim hr_counter As Double\n    Dim hr_counter_row As Double\n\n    Dim StartTime As Double\n    Dim MinutesElapsed As String\n\n    'Remember time when macro starts\n    StartTime = Timer\n\n    'Ask the user for the cell range.\n    Set cell_rng = Application.InputBox(\"Provide a range ($letter$number : $letter$number)\", \"Cell Range to Fill in Blanks\", Type:=8)\n    MsgBox \"The cells selected were \" &amp; cell_rng.Address\n\n    'Go through the cells and set equal to the value in the cell above if the current cell is blank.\n    For Each cell In cell_rng\n\n        'Get the time stamp of current cell and calculate the time 1hr ahead.\n        cell_start = CDate(Cells(cell.Row, \"B\").Value)\n\n        cell_start_temp = CDate(Cells(cell.Row, \"B\").Value)\n        cell_end = DateAdd(\"h\", 1, cell_start)\n        hr_counter = 1\n\n        Do While CDate(cell_start_temp) &lt; CDate(cell_end)\n\n            cell_start_temp = CDate(Cells(cell.Offset(hr_counter, 0).Row, \"B\").Value)\n            hr_counter = hr_counter + 1\n\n            If (hr_counter + cell.Row) &gt; Cells(Rows.Count, \"H\").End(xlUp).Row Then\n                Exit Do\n            End If\n\n        Loop\n\n        hr_counter_row = cell.Row + hr_counter\n\n        cell.Value = \"=Average(\" &amp; \"H\" &amp; cell.Row &amp; \":\" &amp; \"H\" &amp; hr_counter_row &amp; \")\"\n        cell.Offset(0, 1).Value = CDate(cell_start_temp)\n\n    Next cell\n\n    'Determine how many seconds code took to run\n    MinutesElapsed = Format((Timer - StartTime) / 86400, \"hh:mm:ss\")\n\n    'Notify user in seconds\n    MsgBox \"This code ran successfully in \" &amp; MinutesElapsed &amp; \" minutes\", vbInformation\n\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1492561923, "creation_date": 1492561923, "answer_id": 43484319, "question_id": 43483506, "link": "https://stackoverflow.com/questions/43483506/how-to-split-data-from-multiple-worksheets-based-on-column-into-multiple-workboo/43484319#43484319", "title": "How to split data from multiple worksheets based on column into multiple workbooks in Excel?", "body": "<p>I didn't like the idea of grouping your two functions, I prefer to first get teams using a dictionary then create a WB for each team and use Excel's filtering capabilities. Try it like this:</p>\n\n<pre><code>Sub SplitWB()\n    Application.EnableEvents = False: Application.ScreenUpdating = False: Application.DisplayAlerts = True\n    On Error GoTo Cleanup\n\n    Dim ws As Worksheet, wb As Workbook, team\n    For Each team In getTeams\n        Set wb = Workbooks.Add ' create a wb for each team with same # of sheets\n        Do Until wb.Worksheets.count &gt;= ThisWorkbook.Worksheets.count\n            wb.Worksheets.Add After:=wb.Sheets(wb.Sheets.count)\n        Loop\n\n        For Each ws In ThisWorkbook.Worksheets\n            With ws.UsedRange\n                .AutoFilter 1, team ' filter to copy only the team's rows\n                .Copy wb.Sheets(ws.Index).Range(\"A1\")\n                .AutoFilter\n            End With\n            wb.Sheets(ws.Index).name = ws.name &amp; \"_\" &amp; team\n        Next\n        wb.SaveAs ThisWorkbook.path &amp; \"\\\" &amp; team &amp; \".xlsx\"\n        wb.Close False\n    Next\n\nCleanup:\n    Application.EnableEvents = True: Application.ScreenUpdating = True: Application.DisplayAlerts = True\nEnd Sub\n\nFunction getTeams() ' gets the unique team names using a dictionary\n    Dim cel As Range, dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        For Each cel In .Range(\"A2:A\" &amp; .Cells(.Rows.count, \"A\").End(xlUp).row)\n            If Len(Trim(cel.Value2)) &gt; 0 Then dict(cel.Value2) = 0\n        Next\n    End With\n    getTeams = dict.Keys\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7729328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2814b3198eed09cc356942efb219bb83?s=128&d=identicon&r=PG&f=1", "display_name": "A Sun", "link": "https://stackoverflow.com/users/7729328/a-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1492561923, "creation_date": 1492556073, "last_edit_date": 1492557423, "question_id": 43483506, "link": "https://stackoverflow.com/questions/43483506/how-to-split-data-from-multiple-worksheets-based-on-column-into-multiple-workboo", "title": "How to split data from multiple worksheets based on column into multiple workbooks in Excel?", "body": "<p>A slight twist on 2 popular question asked in these forums...</p>\n\n<p>I am trying to split a Excel workbook into multiple workbooks based on different column value(lets call them saleTeam1, saleTeam2,saleTeam3).  </p>\n\n<p>However, the subject workbook has multiple worksheets, each reporting different metrics for the different sales teams: the only common denominator between the worksheets are the sales teams, indicated on the first columns of each worksheet.</p>\n\n<p>I use 2 VBA macros for different other tasks:</p>\n\n<p>1)parse target worksheet into multiple worksheets based on unique values in column A, and </p>\n\n<p>2)split a workbook and create new workbooks for each unique worksheet.</p>\n\n<p>Trying to integrate the 2 functions together but I feel it may be more worthwhile to build it from scratch.  However, I can't wrap my head around an efficient solution.</p>\n\n<pre><code>    Sub parse_data()\nDim lr As Long\nDim ws As Worksheet\nDim vcol, i As Integer\nDim icol As Long\nDim myarr As Variant\nDim title As String\nDim titlerow As Integer\n\n'set split target column\nvcol = 1\n\n' set split target sheet\nSet ws = Sheets(\"Sheet1\")\n\nlr = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row\ntitle = \"A1:M1\"\ntitlerow = ws.Range(title).Cells(1).Row\nicol = ws.Columns.Count\nws.Cells(1, icol) = \"Unique\"\nFor i = 2 To lr\nOn Error Resume Next\nIf ws.Cells(i, vcol) &lt;&gt; \"\" And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\nws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol)\nEnd If\nNext\nmyarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\nws.Columns(icol).Clear\nFor i = 2 To UBound(myarr)\nws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\nIf Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then\nSheets.Add(after:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\"\nElse\nSheets(myarr(i) &amp; \"\").Move after:=Worksheets(Worksheets.Count)\nEnd If\nws.Range(\"A\" &amp; titlerow &amp; \":A\" &amp; lr).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"A1\")\nSheets(myarr(i) &amp; \"\").Columns.AutoFit\nNext\nws.AutoFilterMode = False\nws.Activate\nEnd Sub\n\nSub SplitWB()\nDim xlApp As Object\nDim wbSource As Object\nDim wbNew As Object\nDim ws As Worksheet\nDim strFileName As String\n\n    ' change path and filename here\n    strFileName = \"C:\\Users\\username\\Documents\\split\\split.xlsx\"\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n\n    Set wbSource = xlApp.Workbooks.Open(strFileName)\n\n    For Each ws In wbSource.Worksheets\n         ws.Copy\n         Set wbNew = xlApp.ActiveWorkbook\n         wbNew.SaveAs wbSource.Path &amp; xlApp.PathSeparator &amp; ws.Name &amp; \".xlsx\"\n         wbNew.Close\n         Set wbNew = Nothing\n    Next ws\n\n    wbSource.Close SaveChanges:=False\n    Set wbSource = Nothing\n\n    xlApp.Quit\n    Set xlApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Bottom line: trying to make 1 workbook(with 5 worksheets with varying columns) with 6 teams data, into 6 workbooks(each with same 5 worksheets as original workbook) with each team's data separate</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1492552941, "post_id": 43482743, "comment_id": 74021836, "body": "I learn something new every day - I didn&#39;t even realise that you could use a <code>.Select False</code> in order to add an extra sheet to the currently selected sheet(s).  FWIW - the code works for me.  What are you entering in the InputBox, and what sheet names currently exist?"}, {"owner": {"reputation": 23, "user_id": 7886475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d27675084526efbf384c4bc1f58ab26e?s=128&d=identicon&r=PG&f=1", "display_name": "solologos", "link": "https://stackoverflow.com/users/7886475/solologos"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492553327, "post_id": 43482743, "comment_id": 74021966, "body": "I have 10 sheets, 6 in blue and 4 in green.  5 of the blue ones are named &quot;Blue1&quot;, &quot;Blue2&quot;, etc.  I entered &quot;blue&quot; in the InputBox.  For some reason, after I enter &quot;blue&quot;, the program just switches back to the VBA window."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1492553389, "post_id": 43482743, "comment_id": 74021994, "body": "Ahh - you would need to enter &quot;blue*&quot; for a <code>Like</code> to work.  If you want the users to be able to just enter &quot;blue&quot;, you should use <code>If Instr(LCase(ws.Name), LCase(cString)) &gt; 0 Then</code>."}, {"owner": {"reputation": 23, "user_id": 7886475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d27675084526efbf384c4bc1f58ab26e?s=128&d=identicon&r=PG&f=1", "display_name": "solologos", "link": "https://stackoverflow.com/users/7886475/solologos"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492553521, "post_id": 43482743, "comment_id": 74022043, "body": "Ha! It works! Thank you so much!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492553539, "post_id": 43482743, "comment_id": 74022051, "body": "See my edited comment."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1492553666, "creation_date": 1492553666, "answer_id": 43483088, "question_id": 43482743, "link": "https://stackoverflow.com/questions/43482743/select-excel-sheets-with-user-inputted-string/43483088#43483088", "title": "Select excel sheets with user inputted string", "body": "<p>If you have sheet names such as \"Blue1\", \"Blue2\", \"Blue3\", the current code will work if the user enters \"blue*\".</p>\n\n<p>If you want the user to just be able to enter \"blue\", then you should change your <code>If</code> statement to:</p>\n\n<pre><code>If Instr(LCase(ws.Name), LCase(cString)) &gt; 0 Then\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7886475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d27675084526efbf384c4bc1f58ab26e?s=128&d=identicon&r=PG&f=1", "display_name": "solologos", "link": "https://stackoverflow.com/users/7886475/solologos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 43483088, "answer_count": 1, "score": 2, "last_activity_date": 1492553819, "creation_date": 1492551974, "last_edit_date": 1531164843, "question_id": 43482743, "link": "https://stackoverflow.com/questions/43482743/select-excel-sheets-with-user-inputted-string", "title": "Select excel sheets with user inputted string", "body": "<p>I've been at this for a while and I don't understand why it's not working.  The code works in selecting sheets if I used a value like \"New\", but I can't get cString to work.</p>\n\n<pre><code>Sub SelectTabWithString()\n\n\n    Dim cString As String\n    Dim ws As Worksheet, flg As Boolean\n    cString = Application.InputBox(\"Enter Characters\")\n    For Each ws In Sheets\n        If LCase(ws.Name) Like cString Then\n            ws.Select Not flg\n            flg = True\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>I have 10 sheets, 6 in blue and 4 in green. 5 of the blue ones are named \"Blue1\", \"Blue2\", etc. I entered \"blue\" in the InputBox. For some reason, after I enter \"blue\", the program just switches back to the VBA window.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1492550788, "post_id": 43482401, "comment_id": 74020944, "body": "Ahh - I had been thinking the OP was trying to compare something with the values in the other cells, but this makes more sense."}, {"owner": {"reputation": 21, "user_id": 5125985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nldbz.jpg?s=128&g=1", "display_name": "Gunter", "link": "https://stackoverflow.com/users/5125985/gunter"}, "edited": false, "score": 0, "creation_date": 1493831162, "post_id": 43482401, "comment_id": 74573494, "body": "Thanks so much Scott. It achieved what i wanted."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 21, "user_id": 5125985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nldbz.jpg?s=128&g=1", "display_name": "Gunter", "link": "https://stackoverflow.com/users/5125985/gunter"}, "edited": false, "score": 0, "creation_date": 1493831246, "post_id": 43482401, "comment_id": 74573545, "body": "@Gunter please mark as correct by clicking on the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1492550453, "creation_date": 1492550453, "answer_id": 43482401, "question_id": 43482273, "link": "https://stackoverflow.com/questions/43482273/trying-to-pass-user-input-string-in-formular1c1-in-vba/43482401#43482401", "title": "Trying to pass user input string in formulaR1C1 in VBA", "body": "<p>use this formula:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=\"\"[\"\" &amp; \"\"\" &amp; field &amp; \"\"\" &amp; \"\"]=\"\" &amp; RC[-2] &amp; RC[-1]\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5125985, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nldbz.jpg?s=128&g=1", "display_name": "Gunter", "link": "https://stackoverflow.com/users/5125985/gunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492576905, "creation_date": 1492549915, "last_edit_date": 1492576905, "question_id": 43482273, "link": "https://stackoverflow.com/questions/43482273/trying-to-pass-user-input-string-in-formular1c1-in-vba", "title": "Trying to pass user input string in formulaR1C1 in VBA", "body": "<p>My code:</p>\n\n<pre><code>   Sub something()\n      field = InputBox(\"Please provide the field name\")\n      ActiveCell.FormulaR1C1 = \"=\"\"[\"\"\" &amp; Chr(34) &amp; field &amp; Chr(34) &amp; \"\"\"]=\"\"&amp;RC[-2]&amp;RC[-1]\"\n   End Sub\n</code></pre>\n\n<p>where:</p>\n\n<p><code>RC[-2]</code> is cell having value <code>Closed Fund</code></p>\n\n<p><code>RC[-1]</code> is cell having value  <code>or</code> </p>\n\n<p><code>field</code> is inputted as <code>Name</code></p>\n\n<p>What I got: </p>\n\n<blockquote>\n  <p>[\"Name\"]= Closed Fund or</p>\n</blockquote>\n\n<p>What I want:</p>\n\n<blockquote>\n  <p>[Name]= Closed Fund or</p>\n</blockquote>\n\n<p>So I tried tinkering my code as:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=\"\"[\"\"\" &amp; field &amp; \"\"\"]=\"\"&amp;RC[-2]&amp;RC[-1]\"\n</code></pre>\n\n<p>But I got </p>\n\n<blockquote>\n  <p>Run-time error '1004':\n  Application-defined or object-defined error`</p>\n</blockquote>\n\n<p>If the problem isn't clear yet, please comment below.</p>\n"}]