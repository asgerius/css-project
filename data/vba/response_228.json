[{"tags": ["excel", "vba", "graph"], "comments": [{"owner": {"reputation": 116, "user_id": 5470349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d15e5ee4eb6e9dad71f52f967b41f46?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/5470349/josh"}, "edited": false, "score": 0, "creation_date": 1558575615, "post_id": 56266389, "comment_id": 99149968, "body": "There are a number of methods available. You can use a counter, you can name them, you can delete them all and build them from scratch each time. If you post the code you have so far and some additional relevant information people will typically help you reach your solution."}], "answers": [{"tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1558583890, "creation_date": 1558583890, "answer_id": 56267894, "question_id": 56266389, "link": "https://stackoverflow.com/questions/56266389/counter-for-graphs-in-vba/56267894#56267894", "title": "Counter for graphs in VBA", "body": "<p>There are various ways you can accomplish this. The one I would suggest is to create a Graph and access it again and again to plot your data. You can use function like</p>\n\n<pre><code>Worksheets(\"SheetName\").ChartObjects(\"Chart Name\").Activate\n</code></pre>\n\n<p>Then you can use various other functions to change the source data of the activated chart multiple time in the loop.</p>\n\n<pre><code>ActiveChart.SetSourceData Source:=Range(\"Data Range\")\n</code></pre>\n\n<p>Here are links to the functions :  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.chartobjects\" rel=\"nofollow noreferrer\">ChartObjects</a></p>\n"}], "owner": {"reputation": 9, "user_id": 11542145, "user_type": "registered", "profile_image": "https://graph.facebook.com/2238755219507025/picture?type=large", "display_name": "Maria Vit&#243;ria Jaber", "link": "https://stackoverflow.com/users/11542145/maria-vit%c3%b3ria-jaber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1558593170, "creation_date": 1558569240, "last_edit_date": 1558593170, "question_id": 56266389, "link": "https://stackoverflow.com/questions/56266389/counter-for-graphs-in-vba", "title": "Counter for graphs in VBA", "body": "<p>Im working on a code in the userform in the vba. For this, i have to plot a graph multiple times with the data i aquired online. But the graph ploted many times should be the same. So how do i call the first graph to fill the next one that is in another subrotine? I should use a counter right? How do i reuse the graph in other subroutine?</p>\n"}, {"tags": ["arrays", "excel", "vba", "loops"], "comments": [{"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1558568864, "post_id": 56266293, "comment_id": 99148791, "body": "I assume you know how to set breakpoints when debugging in the Excel VBA editor, right? So, by stepping through your code, you should be able to see what&#39;s wrong,"}, {"owner": {"reputation": 9, "user_id": 11418202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e0ca46e037d93564d60a7c2e4901a4?s=128&d=identicon&r=PG&f=1", "display_name": "sTan_The_mAn", "link": "https://stackoverflow.com/users/11418202/stan-the-man"}, "reply_to_user": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1558569136, "post_id": 56266293, "comment_id": 99148839, "body": "@RobertBaron yes, everything works except specifying rows to write(last if statement). It writes them all when I would want to set parameters for which ones write."}, {"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1558569900, "post_id": 56266293, "comment_id": 99148993, "body": "If all rows are written, then test is always <code>False</code>, which means <code>FromArr(Dem2, 6) &lt;= 300</code> is always <code>True</code>. In the debugger, does <code>FromArr()</code> contain the conditions you want in column 6? That should be straightforward to see in the debugger."}, {"owner": {"reputation": 9, "user_id": 11418202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e0ca46e037d93564d60a7c2e4901a4?s=128&d=identicon&r=PG&f=1", "display_name": "sTan_The_mAn", "link": "https://stackoverflow.com/users/11418202/stan-the-man"}, "reply_to_user": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1558572890, "post_id": 56266293, "comment_id": 99149490, "body": "@RobertBaron yes, fromarr(i, 6) for one iteration = 312.26, while another iteration = 285. And no matter which way i flip the &gt;= it still writes them all, or none at all. Test value changes to true on pass through, and will not write when false. I&#39;m not sure I&#39;m using them correctly.--------apologies, it won&#39;t write if statement FromArr(dem2, 6) &gt;= then test = false"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1558589385, "post_id": 56266293, "comment_id": 99152410, "body": "Based on how you use boolean <i>test</i>, it should be <code>test = (FromArr(Dem2, 6) &gt;= -300) And (FromArr(Dem2, 6) &lt;= 300)</code>"}, {"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1558600645, "post_id": 56266293, "comment_id": 99157284, "body": "<code>FromArr()</code> is of type <code>Variant</code> which means it can contain any type. When comparing to <code>300</code>, make sure <code>FromArr(Dem2, 6)</code> contains a number type. The debugger tells you the underlying type of a <code>Variant</code>. If not of type number, there are VBA functions to convert to number."}, {"owner": {"reputation": 9, "user_id": 11418202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e0ca46e037d93564d60a7c2e4901a4?s=128&d=identicon&r=PG&f=1", "display_name": "sTan_The_mAn", "link": "https://stackoverflow.com/users/11418202/stan-the-man"}, "reply_to_user": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1558625907, "post_id": 56266293, "comment_id": 99171571, "body": "@RobertBaron <code>FromArr(Dem2, 6)</code> contains variant/double type."}, {"owner": {"reputation": 9, "user_id": 11418202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e0ca46e037d93564d60a7c2e4901a4?s=128&d=identicon&r=PG&f=1", "display_name": "sTan_The_mAn", "link": "https://stackoverflow.com/users/11418202/stan-the-man"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1558626044, "post_id": 56266293, "comment_id": 99171642, "body": "@PatricK I tried this, or at least as I understood it, to no avail. I used it multiple ways, changing stuff around, but was never able to get it to exclude any values from being written."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1558652187, "post_id": 56266293, "comment_id": 99181614, "body": "@sTan_The_mAn The boolean operation in my previous comment works if you are to omit values from <code>-300 &lt;= x &lt;= 300</code>. In your <i>working</i> code, get rid of <code>FromArr(i, 6) &gt;= 300 And FromArr(i, 6) &lt;= -300</code> (how can a number be greater then 300 and less than negative 300 at the same time?). You can get rid of those If blocks if you use code as per my previous comment."}, {"owner": {"reputation": 9, "user_id": 11418202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e0ca46e037d93564d60a7c2e4901a4?s=128&d=identicon&r=PG&f=1", "display_name": "sTan_The_mAn", "link": "https://stackoverflow.com/users/11418202/stan-the-man"}, "edited": false, "score": 0, "creation_date": 1558656310, "post_id": 56266293, "comment_id": 99182377, "body": "I&#39;m sorry, I don&#39;t understand. Do I declare <code>x As Double</code> then use it in place of <code>test</code>? How would this look? And in the process of testing this, I have discovered that it will not write more than 7 rows. I didn&#39;t have a lot more rows than that when testing and they were under 300 so I didn&#39;t pay it any mind. But when I added more, I found it was stopping without checking them all."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11418202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e0ca46e037d93564d60a7c2e4901a4?s=128&d=identicon&r=PG&f=1", "display_name": "sTan_The_mAn", "link": "https://stackoverflow.com/users/11418202/stan-the-man"}, "edited": false, "score": 0, "creation_date": 1558634366, "post_id": 56279917, "comment_id": 99175278, "body": "I had to change it to <code>Lbound(FromArr, 1) to UBound(FromArr, 2)</code> , but I got the jist of what you were trying to say. In addition I wasn&#39;t attaching my true/ false parameters correctly. Thank you sir."}], "tags": [], "owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "is_accepted": true, "score": 0, "last_activity_date": 1558630798, "creation_date": 1558630798, "answer_id": 56279917, "question_id": 56266293, "link": "https://stackoverflow.com/questions/56266293/how-can-i-apply-multiple-conditions-to-decide-what-values-are-written-from-an-ar/56279917#56279917", "title": "How can I apply multiple conditions to decide what values are written from an array to a target destination?", "body": "<p>This should work. You had a typo in the index to the <code>FromArr()</code>. I could not run it, so let me know if it does not work.</p>\n\n<pre><code>With wsTo\n    j = lastRow + 1\n    For i = LBound(FromArr, 1) To UBound(FromArr2, 1)\n\n        If FromArr(i, 6) &lt;= 300 Then test = False\n        If FromArr(1, 6) &gt; 300 Then test = True\n\n        If test = False Then\n            wsTo.Cells(j, 1) = FromArr(i, 0)\n            wsTo.Cells(j, 2) = FromArr(i, 1)\n            wsTo.Cells(j, 3) = FromArr(i, 2)\n            wsTo.Cells(j, 4) = FromArr(i, 3)\n            wsTo.Cells(j, 10) = FromArr(i, 4)\n            wsTo.Cells(j, 13) = FromArr(i, 5)\n            wsTo.Cells(j, 17) = FromArr(i, 6)\n            j = j + 1\n        End If\n    Next i\nEnd With                    \n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11418202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16e0ca46e037d93564d60a7c2e4901a4?s=128&d=identicon&r=PG&f=1", "display_name": "sTan_The_mAn", "link": "https://stackoverflow.com/users/11418202/stan-the-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 56279917, "answer_count": 1, "score": 0, "last_activity_date": 1558661847, "creation_date": 1558568296, "last_edit_date": 1558661847, "question_id": 56266293, "link": "https://stackoverflow.com/questions/56266293/how-can-i-apply-multiple-conditions-to-decide-what-values-are-written-from-an-ar", "title": "How can I apply multiple conditions to decide what values are written from an array to a target destination?", "body": "<p>In an effort to streamline my efforts for a data transfer macro, I have moved to arrays. I have limited experience with them, let alone vba. But I was able to build it, and have it write. The last hurdle I have is that I am unable to specify which values to write, as I only need them transferred if they are over or under a certain amount; i.e. array(dem2, 6) = >300 write, array(dem2, 6) = &lt;300 don't write.</p>\n\n<p>Long story short, I want to be able to write data for rows where that value is either >300 or &lt;-300.</p>\n\n<p>I spent several hours reading posts, trying various loops and conditions including do, do while, goto, elseif but none seem to work and cause errors to pop up. </p>\n\n<pre><code>Public wbFr As Workbook\nPublic wbTo As Workbook\nPublic wsFr As Worksheet\nPublic wsTo As Worksheet\nOption Explicit\nPublic Sub MoveToLogBookArray()\n'==================================\n' Macro to put data in array      '\n' Then write to separate workbook '\n'==================================\nDim FromArr() As Variant\nDim Dem1 As Long, Dem2 As Long  'Multi-dimensional\nDim lastRow As Long\nDim LR As Long\nDim i As Long\nDim j As Long\nDim test As Boolean\n'==================\n'Workbook with data\nSet wbFr = Workbooks(\"Book1useV2.xlsm\")\n'====================\n'Destination workbook\nSet wbTo = Workbooks(\"Book2V2.xlsm\")\n'============\n'Source sheet\nSet wsFr = wbFr.Worksheets(\"test\")\n'=================\n'Destination sheet\nSet wsTo = wbTo.Worksheets(\"Sheet7\")\n\nWith wsFr               'Attempt at setting bounds of array\nDem1 = Range(\"A2:A10\").Cells.Count - 1  '# of rows\nDem2 = Range(\"A2:A10\").Cells.Count - 3  '# of columns\n    ReDim FromArr(0 To Dem1, 0 To Dem2)\n        For Dem1 = LBound(FromArr, 1) To UBound(FromArr, 1)\n            For Dem2 = LBound(FromArr, 2) To UBound(FromArr, 2)\n                FromArr(Dem1, Dem2) = wsFr.Range(\"A2\").Offset(Dem1, Dem2)\n            Next Dem2\n        Next Dem1\n    End With\n    'Successfully builds array\n    '=========================\n    'Find last row of destination sheet to go to next empty row\nWith wsTo\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        lastRow = .Cells.Find(What:=\"*\", _\n                      After:=.Range(\"A1\"), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).row\n    Else\n        lastRow = 1\n    End If\nEnd With\n'================================================================\nWith wsTo\n    j = lastRow + 1\n      For i = LBound(FromArr) To UBound(FromArr)\n\n        test = True\n\n        If FromArr(Dem2, 6) &lt;= 300 Then test = False    'Inputting .value gives error\n            'do nothing                                 '\"Object required\"\n        If FromArr(Dem2, 6) &gt;= 300 Then test = True\n\n        If test = False Then\n            wsTo.Cells(j, 1) = FromArr(i, 0)\n            wsTo.Cells(j, 2) = FromArr(i, 1)\n            wsTo.Cells(j, 3) = FromArr(i, 2)\n            wsTo.Cells(j, 4) = FromArr(i, 3)\n            wsTo.Cells(j, 10) = FromArr(i, 4)\n            wsTo.Cells(j, 13) = FromArr(i, 5)\n            wsTo.Cells(j, 17) = FromArr(i, 6)\n            j = j + 1\n        End If              '=======================================================\n        Next i              'I'm unable to write only values over 300 or under -300]\nEnd With                    '=======================================================\n\nExit Sub\n\nEnd Sub\n\n</code></pre>\n\n<p>As mentioned above, I want to be able to specify rows of values input into an array in one workbook, then write them to a separate workbook based on conditions of column 6.</p>\n\n<pre><code>With wsTo   'set break here\n    j = lastRow + 1\n      For i = LBound(FromArr) To UBound(FromArr)\n        test = (FromArr(Dem2, 6) &lt;= -300) And (FromArr(Dem2, 6) &gt;= 300) '= True/False\n                                        'tried both false/true and commented out^^^^^                                \n                                        'and flipping &lt;, &gt;\n            If test = True Then\n                'do nothing\n            End If\n                    'When it writes, it writes all values or no values at all\n                    '````````````````````````````````````````````````````````\n            If test = False Then          'values for 4&amp;5 include decimals\n                wsTo.Cells(j, 1) = FromArr(i, 0)    'type= variant/double\n                wsTo.Cells(j, 2) = FromArr(i, 1)    'type= variant/string\n                wsTo.Cells(j, 3) = FromArr(i, 2)    'type= variant/string\n                wsTo.Cells(j, 4) = FromArr(i, 3)    'type= variant/string\n                wsTo.Cells(j, 10) = FromArr(i, 4)   'type= variant/double\n                wsTo.Cells(j, 13) = FromArr(i, 5)   'type= variant/double\n                wsTo.Cells(j, 17) = FromArr(i, 6)   'type= variant/double\n                j = j + 1    'On 4th iteration, value is 285 but is written anyway\n            End If\n                            '=======================================================\n        Next i              'I'm unable to write only values over 300 or under -300]\nEnd With                    '=======================================================\n\nExit Sub\n'Values in test Column\n'517.34\n'733.68\n'312.26\n'285.00 writes regardless\n'297.00 \"\"\n'312.00\n'333.00\n'250.00 \"\"\n'500.00\nEnd Sub\n</code></pre>\n\n<p>And here is my finished working project thanks to Robert and Patrick.</p>\n\n<pre><code>Public wbFr As Workbook\nPublic wbTo As Workbook\nPublic wsFr As Worksheet\nPublic wsTo As Worksheet\nOption Explicit\nPublic Sub MoveToLogBookArray()\n'==================================\n' Macro to put data in array      '\n' Then write to separate workbook '\n'==================================\nDim FromArr() As Variant\nDim lastRow As Long\nDim i As Long\nDim j As Long\nDim test As Boolean\n'==================\n'Workbook with data\nSet wbFr = Workbooks(\"Book1useV2.xlsm\")\n'====================\n'Destination workbook\nSet wbTo = Workbooks(\"Book2V2.xlsm\")\n'============\n'Source sheet\nSet wsFr = wbFr.Worksheets(\"test\")\n'=================\n'Destination sheet\nSet wsTo = wbTo.Worksheets(\"Sheet7\")\n'========================================================================\nWith wsFr               'Attempt at setting bounds of array\n    FromArr = Range(\"adjRange\")\nEnd With\n\nWith wsTo\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        lastRow = .Cells.Find(What:=\"*\", _\n                      After:=.Range(\"A1\"), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).row\n    Else\n        lastRow = 1\n    End If\nEnd With\n'===================================================================\n'Be sure to verify parameters\n'Check for errors\nOn Error GoTo ErrHandler\nWith wsTo\n    j = lastRow + 1\n      For i = LBound(FromArr) To UBound(FromArr)\n\n      test = False\n\n        If FromArr(i, 6) &gt;= 300 And FromArr(i, 6) &lt;= -300 Then test = False\n        If FromArr(i, 6) &lt; 299.99 And FromArr(i, 6) &gt; -299.99 Then test = True\n\n            If test = False Then\n                wsTo.Cells(j, 1) = FromArr(i, 1)\n                wsTo.Cells(j, 2) = FromArr(i, 2)\n                wsTo.Cells(j, 3) = FromArr(i, 3)\n                wsTo.Cells(j, 4) = FromArr(i, 4)\n                wsTo.Cells(j, 10) = FromArr(i, 5)\n                wsTo.Cells(j, 13) = FromArr(i, 6)\n                wsTo.Cells(j, 17) = FromArr(i, 7)\n                j = j + 1\n            End If\n        Next i\nEnd With\nOn Error GoTo 0\n'===================================================================\nExit Sub\nErrHandler:\n    MsgBox \"An error has occurred! Please check values are in correct column. \" &amp; Err.Description\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "module"], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11541888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aeb35e574e8955f63a22b3be32fd1?s=128&d=identicon&r=PG&f=1", "display_name": "mr.tdz", "link": "https://stackoverflow.com/users/11541888/mr-tdz"}, "edited": false, "score": 0, "creation_date": 1558623591, "post_id": 56265917, "comment_id": 99170370, "body": "I\u2019m not sure what you mean when you say the module is \u201claunching\u201d"}, {"owner": {"reputation": 1, "user_id": 11541888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aeb35e574e8955f63a22b3be32fd1?s=128&d=identicon&r=PG&f=1", "display_name": "mr.tdz", "link": "https://stackoverflow.com/users/11541888/mr-tdz"}, "edited": false, "score": 0, "creation_date": 1558623890, "post_id": 56265917, "comment_id": 99170504, "body": "Thanks for the response. For some reason, the modul still launches after the line:   <code>.Sheets(1).Range(&quot;A1&quot;).Resize(rngUsed.Rows.Count, _          rngUsed.Columns.Count).Value = rngUsed.Value`</code>  I can&#39;t tell if the Module is trying to run in the new wb, or if it&#39;s recalculating in the old wb. I&#39;m thinking the new, because it yields a &#39;Run-time error \\&#39;1004\\&#39;: Application-defined or object-defined error`, which would make sense if the module&#39;s arguments refer to a sheet back in the source workbook.    Interestingly, your code doesn&#39;t break the modules in the old wb like my code."}, {"owner": {"reputation": 1, "user_id": 11541888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aeb35e574e8955f63a22b3be32fd1?s=128&d=identicon&r=PG&f=1", "display_name": "mr.tdz", "link": "https://stackoverflow.com/users/11541888/mr-tdz"}, "edited": false, "score": 0, "creation_date": 1558623950, "post_id": 56265917, "comment_id": 99170533, "body": "By launching, I mean stepping into that line brings up the module window, and immediately steps into it. Then that module loops until the error 1004"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11541888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aeb35e574e8955f63a22b3be32fd1?s=128&d=identicon&r=PG&f=1", "display_name": "mr.tdz", "link": "https://stackoverflow.com/users/11541888/mr-tdz"}, "edited": false, "score": 0, "creation_date": 1558627514, "post_id": 56265917, "comment_id": 99172380, "body": "My code only copies values from one sheet to another - your function will never run in the new worksheet, so that shouldn&#39;t be a problem.  However it does seem like <i>something</i> is tripping it up.  Can you show an example of how it&#39;s called from the worksheet?"}, {"owner": {"reputation": 1, "user_id": 11541888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aeb35e574e8955f63a22b3be32fd1?s=128&d=identicon&r=PG&f=1", "display_name": "mr.tdz", "link": "https://stackoverflow.com/users/11541888/mr-tdz"}, "edited": false, "score": 0, "creation_date": 1558629071, "post_id": 56265917, "comment_id": 99173083, "body": "The <code>SaveAsCSV</code> sub is called from a button click in the <i>Instructions</i> Sheet. If I call it from the button instead of stepping through the function, the sub still breaks before saving the new wb &amp; after the values have been copied, but I get an Error 400 instead of an Error 1004.   The <code>MultipleLookupNoRept</code> Module runs in two columns on the ExportSheet."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 11541888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aeb35e574e8955f63a22b3be32fd1?s=128&d=identicon&r=PG&f=1", "display_name": "mr.tdz", "link": "https://stackoverflow.com/users/11541888/mr-tdz"}, "edited": false, "score": 0, "creation_date": 1558630931, "post_id": 56265917, "comment_id": 99173855, "body": "The problem is with <code>MultipleLookupNoRept</code> but I don&#39;t see any obvious issues in the code for that function, other than I&#39;m not sure what the purpose of the inner &quot;J&quot; loop is."}, {"owner": {"reputation": 1, "user_id": 11541888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aeb35e574e8955f63a22b3be32fd1?s=128&d=identicon&r=PG&f=1", "display_name": "mr.tdz", "link": "https://stackoverflow.com/users/11541888/mr-tdz"}, "edited": false, "score": 0, "creation_date": 1558651030, "post_id": 56265917, "comment_id": 99181374, "body": "Hmm. I think you&#39;re right, but it&#39;s odd that the module works on its own until the <code>SaveAsCSV</code> sub is called. The internal J loop just prevents duplicates. I&#39;m sure there&#39;s a more efficient way to write that part of the code."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1558565216, "creation_date": 1558565216, "answer_id": 56265917, "question_id": 56265822, "link": "https://stackoverflow.com/questions/56265822/vba-to-save-a-sheet-as-csv-breaks-existing-module/56265917#56265917", "title": "VBA to save a Sheet as CSV breaks existing module", "body": "<p>Try this (without the copy/paste):</p>\n\n<pre><code>Sub SaveAsCSV()\n\n    Dim csvFileName As String\n    Dim ThisWB As Workbook, csvWB As Workbook, rngUsed As Range\n\n    Set ThisWB = ActiveWorkbook\n\n    Set rngUsed = ThisWB.Sheets(\"SourceSheet\").UsedRange\n\n    csvFileName = ThisWB.Path &amp; \"\\\" &amp; _\n           ThisWB.Sheets(\"Instructions\").Range(\"E10\").Value &amp; \".csv\" 'no Set!\n\n    Application.DisplayAlerts = False\n\n    With Application.Workbooks.Add(1)\n        .Sheets(1).Range(\"A1\").Resize(rngUsed.Rows.Count, _\n                           rngUsed.Columns.Count).Value = rngUsed.Value\n\n        .SaveAs Filename:=csvFileName, FileFormat:=xlCSV, _\n                          CreateBackup:=False, Local:=True\n\n        .Close SaveChanges:=False\n    End With\n\n    Application.DisplayAlerts = True\n\n    MsgBox \"File has been Created and Saved\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11541888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a58aeb35e574e8955f63a22b3be32fd1?s=128&d=identicon&r=PG&f=1", "display_name": "mr.tdz", "link": "https://stackoverflow.com/users/11541888/mr-tdz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1558650635, "creation_date": 1558564318, "last_edit_date": 1558650635, "question_id": 56265822, "link": "https://stackoverflow.com/questions/56265822/vba-to-save-a-sheet-as-csv-breaks-existing-module", "title": "VBA to save a Sheet as CSV breaks existing module", "body": "<p>I am trying to build a VBA sub that will copy a sheet and save it as a CSV. I am using the tried and true method of:</p>\n\n<p>1) Copying the sheet</p>\n\n<p>2) Opening a new workbook</p>\n\n<p>3) Pasting the copied data into that new workbook</p>\n\n<p>4) Saving that workbook as a CSV</p>\n\n<p>The source sheet contains several formulas and a module in two cells, so I planned to use <code>.PasteSpecial xlPasteValues</code>. However, running the sub throws an Error 1004 and breaks the modules in the source sheet (they then display as #VALUE).</p>\n\n<p>I tried stepping through the sub, and the problem seems to be with <code>.PasteSpecial</code> method / something in the source sheet. When I get the <code>.PasteSpecial</code> step, the module contained in the source sheet launches, and then I'm stuck in a loop. </p>\n\n<p>As side a note, the <code>Set csvFileName</code> line refers to a cell that concatenates the filename value before the sub is run. I don't this is causing the problem because I removed it &amp; saw the same behavior.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub SaveAsCSV()\n\n    Dim csvFileName As String\n    Dim ThisWB As Workbook, csvWB As Workbook\n\n    Set ThisWB = ActiveWorkbook\n\n    ThisWB.Sheets(\"SourceSheet\").UsedRange.Copy\n\n    Set csvWB = Application.Workbooks.Add(1)\n\n    csvWB.Sheets(1).Range(\"A1\").PasteSpecial xlPasteValues\n\n    Set csvFileName = ThisWB.Path &amp; \"\\\" &amp; ThisWB.Sheets(\"Instructions\").Range(\"E10\").Value &amp; \".csv\"\n\n    Application.DisplayAlerts = False\n    csvWB.SaveAs FileName:=csvFileName, FileFormat:=xlCSV, CreateBackup:=False, Local:=True\n    csvWB.Close SaveChanges:=False\n    Application.DisplayAlerts = True\n\n    MsgBox \"File has been Created and Saved\"\n\nEnd Sub\n</code></pre>\n\n<p>A few more notes:</p>\n\n<ul>\n<li><p>The module works fine until I run the <code>SaveAsCSV</code> sub.</p></li>\n<li><p>The module is saved at the workbook level. It is basically an advanced vlookup w/ concatenation. Moving it within one of the sheets breaks it.</p></li>\n<li><p>The <code>SaveAsCSV</code> sub is also at the workbook level. Moving it to the \"Instructions\" sheet doesn't stop the behavior.</p></li>\n<li><p>Using Excel for Mac, Version 16.21.1</p></li>\n</ul>\n\n<p>Any help will be greatly appreciated!!</p>\n\n<p>Edit:5-23-19</p>\n\n<p>For reference, here is the module code:</p>\n\n<pre><code>Function MultipleLookupNoRept(Lookupvalue As String, LookupRange As Range, ColumnNumber As Integer)\n\nDim i As Long\nDim Result As String\n\nFor i = 1 To LookupRange.Columns(1).Cells.Count\n  If LookupRange.Cells(i, 1) = Lookupvalue Then\n    For J = 1 To i - 1\n    If LookupRange.Cells(J, 1) = Lookupvalue Then\n      If LookupRange.Cells(J, ColumnNumber) = LookupRange.Cells(i, ColumnNumber) Then\n        GoTo Skip\n      End If\n    End If\n    Next J\n    Result = Result &amp; \" \" &amp; LookupRange.Cells(i, ColumnNumber) &amp; \",\"\nSkip:\n  End If\nNext i\n\nMultipleLookupNoRept = Left(Result, Len(Result) - 1)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11486823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11232866ade13596ec7d38a933b228ae?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Held", "link": "https://stackoverflow.com/users/11486823/tony-held"}, "edited": false, "score": 0, "creation_date": 1558570774, "post_id": 56266092, "comment_id": 99149161, "body": "Thanks so much!  Exactly what I needed"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1558566605, "creation_date": 1558566605, "answer_id": 56266092, "question_id": 56265465, "link": "https://stackoverflow.com/questions/56265465/how-to-unlock-blank-cells-in-workbook-with-vba-on-open/56266092#56266092", "title": "How to unlock blank cells in workbook with VBA on open", "body": "<p>In this case the password for each sheet is <em>secret</em>:</p>\n\n<pre><code>Sub Tony()\n    Dim s As Worksheet\n\n    For Each s In Sheets\n        s.Unprotect (\"secret\")\n            s.Cells.Locked = False\n            On Error Resume Next\n                s.Cells.SpecialCells(xlCellTypeConstants).Locked = True\n                s.Cells.SpecialCells(xlCellTypeFormulas).Locked = True\n            On Error GoTo 0\n        s.Protect (\"secret\")\n    Next s\n\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE:</strong></p>\n\n<p>First make sure this does what you want.  Only then have your event macro call it.</p>\n"}], "owner": {"reputation": 17, "user_id": 11486823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11232866ade13596ec7d38a933b228ae?s=128&d=identicon&r=PG&f=1", "display_name": "Tony Held", "link": "https://stackoverflow.com/users/11486823/tony-held"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 56266092, "answer_count": 1, "score": 1, "last_activity_date": 1558566605, "creation_date": 1558561664, "last_edit_date": 1558562129, "question_id": 56265465, "link": "https://stackoverflow.com/questions/56265465/how-to-unlock-blank-cells-in-workbook-with-vba-on-open", "title": "How to unlock blank cells in workbook with VBA on open", "body": "<p>I have a workbook with multiple sheets that needs all non-blank cells to be locked and protected when opening the workbook.</p>\n\n<p>This will be an employee training record where multiple trainers will be evaluating new staff on skills.  I would like to prevent anyone from accidentally deleting training data.</p>\n\n<p>I found a code that will lock all cells, set all blank cells as unlocked, and protect the individual worksheet, but I'm having trouble applying this across my entire workbook.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Dim myCell As Range\n\n    Set myCell = Selection\n    Cells.Select\n    Selection.Locked = True\n    myCell.Select\n    Selection.SpecialCells(xlCellTypeBlanks).Select\n    Selection.Locked = False\n\n    ActiveSheet.Protect DrawingObjects:=True, _\n      Contents:=True, Scenarios:=True\n    myCell.Select\n\nEnd Sub\n</code></pre>\n\n<p>Ideally, I would also like to add password protection to prevent a new employee from unprotecting the workbook.  Is this possible within the same code?  Can split this to a new question also.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 0, "last_activity_date": 1558896566, "creation_date": 1558896566, "answer_id": 56316453, "question_id": 56265346, "link": "https://stackoverflow.com/questions/56265346/pivotfilters-add-no-longer-working-in-my-spreadsheet/56316453#56316453", "title": "PivotFilters.add no longer working in my spreadsheet", "body": "<p>I guess it's about date formatting. Please try to ensure, that the dates are formatted correctly, e. g. by this:</p>\n\n<pre><code>ptF1.PivotFilters.Add2 _\n    Type:=xlDateBetween, _\n    Value1:=CStr(CDate(StartDate)), Value2:=CStr(CDate(EndDate)), _\n    WholeDayFilter:=True\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11541791, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Hlh4DrVauF0/AAAAAAAAAAI/AAAAAAAACP4/Ba9DXwAG3J0/photo.jpg?sz=128", "display_name": "Jen Barker", "link": "https://stackoverflow.com/users/11541791/jen-barker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558896635, "creation_date": 1558561039, "last_edit_date": 1558896635, "question_id": 56265346, "link": "https://stackoverflow.com/questions/56265346/pivotfilters-add-no-longer-working-in-my-spreadsheet", "title": "PivotFilters.add no longer working in my spreadsheet", "body": "<p>This code has always worked in the past. Nothing has changed in the workbook and I have verified that all referenced data is formatted correctly.  Any idea what would have \"broken\" this?  It no longer applies the \"between\" filter to the dates in the pivot tables.</p>\n\n<p>Verified pivot tables work when manually altered.  Checked fields in data table to make sure nothing has changed and there is no corrupt data entered.</p>\n\n<pre><code>    StartDate = Sheet17.Range(\"D5\").Value\n    EndDate = Sheet17.Range(\"D6\").Value\n\n    Set pt = Sheet6.PivotTables(1)\n    Set ptF1 = pt.PivotFields(\"Est closing Date\")\n\n    ptF1.ClearAllFilters\n    ptF1.PivotFilters.Add _\n        Type:=xlDateBetween, Value1:=StartDate, Value2:=EndDate\n\n    Sheet17.Range(\"M10:Q999\").ClearContents\n    pt.TableRange1.Offset(4, 0).Copy\n    Sheet17.Cells(10, 13).PasteSpecial xlPasteValues\n\n    Set pt = Sheet6.PivotTables(2)\n    Set ptF1 = pt.PivotFields(\"Funds Date\")\n\n    ptF1.ClearAllFilters\n    ptF1.PivotFilters.Add _\n        Type:=xlDateBetween, Value1:=StartDate, Value2:=EndDate\n\n    Sheet17.Range(\"A10:E999\").ClearContents\n    'omit copying the top row of the PivotTable:\n    pt.TableRange2.Offset(4, 0).Copy\n    Sheet17.Cells(10, 1).PasteSpecial xlPasteValues\n\n    'Fill in dates\n    For ii = 11 To 100\n        If (Me.Cells(ii, 1) = \"\" And Me.Cells(ii, 2) &lt;&gt; \"\") Then\n            Me.Cells(ii, 1) = Me.Cells(ii - 1, 1)\n        End If\n    Next\n\n    'Fill in dates\n    For ii = 11 To 100\n        If (Me.Cells(ii, 8) = \"\" And Me.Cells(ii, 9) &lt;&gt; \"\") Then\n            Me.Cells(ii, 8) = Me.Cells(ii - 1, 8)\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 11499626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mek2k4Zsoec/AAAAAAAAAAI/AAAAAAAAABk/KjBXzDlzj8g/photo.jpg?sz=128", "display_name": "Jan Fusik", "link": "https://stackoverflow.com/users/11499626/jan-fusik"}, "edited": false, "score": 2, "creation_date": 1558618083, "post_id": 56276150, "comment_id": 99166983, "body": "oh! and BTW that last sorting which you added (and I left in my code) which sorts RGB (255, 255, 255) means it sorts cells with <b>White</b> color. However, the blank cells you want to get rid of would have <b>No Fill</b> color that means instead of <code>.Color = RGB(255, 255, 255)</code> you would likely want to use <code>.Color = xlNone</code>. Perhaps if you try this it could also pose a solution to your problem."}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 0, "creation_date": 1558632778, "post_id": 56276150, "comment_id": 99174655, "body": "Brilliant, thank you.  Works like a charm on the sample data, going to try to integrate it into my actual spreadsheet."}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 0, "creation_date": 1558638457, "post_id": 56276150, "comment_id": 99176982, "body": "One thing I changed- I swapped the second and third sorts, so it sorts by color, then by column C date, then by column B date.  That way, the green stuff is sorted by column C date, and that ordering is preserved when I sort by column B."}], "tags": [], "owner": {"reputation": 101, "user_id": 11499626, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mek2k4Zsoec/AAAAAAAAAAI/AAAAAAAAABk/KjBXzDlzj8g/photo.jpg?sz=128", "display_name": "Jan Fusik", "link": "https://stackoverflow.com/users/11499626/jan-fusik"}, "is_accepted": true, "score": 1, "last_activity_date": 1558617456, "last_edit_date": 1592644375, "creation_date": 1558617456, "answer_id": 56276150, "question_id": 56265261, "link": "https://stackoverflow.com/questions/56265261/why-do-blank-lines-appear-after-multi-level-sorting/56276150#56276150", "title": "Why do blank lines appear after multi-level sorting?", "body": "<p>I believe I might have an answers to your questions, atleast for the second one I am sure...</p>\n<h1><em>Why are the blank rows sitting there?</em></h1>\n<p>I can be only guessing since I do not have your source file to check for any irregularities nor your whole macro. If I had to guess, I would say it is either some function in your macro what is causing this or it might also be an issue of how you define sort ranges. You only specify columns and not actual starting cells and also no ending cells. The way I am used to sort data is to dynamically define the exact range.</p>\n<h1><em>How do I remove them or make them not appear at all?</em></h1>\n<p>Please try the code which I have adjusted based on your data and code you provided:</p>\n<pre><code>If Not Intersect(Target, Range(&quot;A:C&quot;)) Is Nothing Then\n    MsgBox (&quot;sorting&quot;)\n\nWith ActiveWorkbook.ActiveSheet\n    lastRow = .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Row '&lt;-- get last row of data in column &quot;A&quot;\n    .Sort.SortFields.Clear\n    \n    .Sort.SortFields.Add(Range(&quot;C1:C&quot; &amp; lastRow), _\n    xlSortOnCellColor, xlDescending, , xlSortNormal).SortOnValue.Color = RGB(146, 208, 80)\n    \n    .Sort.SortFields.Add Key:=.Range(&quot;B1:B&quot; &amp; lastRow), _\n                        SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n    \n    .Sort.SortFields.Add Key:=.Range(&quot;C1:C&quot; &amp; lastRow), _\n                        SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n                        \n    .Sort.SortFields.Add(Range(&quot;C1:C&quot; &amp; lastRow), _\n                        SortOn:=xlSortOnCellColor, Order:=xlDescending, DataOption:=xlSortNormal).SortOnValue.Color = RGB(255, 255, 255)\n                        \n    With .Sort\n        .SetRange Range(&quot;A1:C&quot; &amp; lastRow)\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd With\n\nEnd If\n</code></pre>\n<p>The main adjustment is declaration of lastRow which adjusts the bottom of the data range (in your situation it should not matter but you might sometimes encounter data where you want to sort until certain row and this will be very helpful. Also lastRow as defined here is very helpful for a whole lot of other macros and helps to set ranges dynamically).</p>\n<p>And I have also added the start the data as you can see in <code>Range(&quot;C1:C&quot; &amp; lastRow)</code></p>\n<p>I have tested this on a sample data you have provided and it worked as expected. I hope it will work for you exactly as you wanted to.</p>\n"}], "owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56276150, "answer_count": 1, "score": 0, "last_activity_date": 1558617456, "creation_date": 1558560578, "last_edit_date": 1558561463, "question_id": 56265261, "link": "https://stackoverflow.com/questions/56265261/why-do-blank-lines-appear-after-multi-level-sorting", "title": "Why do blank lines appear after multi-level sorting?", "body": "<p>I have a macro that sorts by color, then by date, then again by date.</p>\n\n<p>If I delete a date, instead of just re-sorting, it re sorts and then leaves blank rows where the row from which a date was deleted used to be.  I tried adding another sort layer where I sort by color RGB(0,0,0).</p>\n\n<ol>\n<li>Why are the blank rows sitting there?</li>\n<li>How do I remove them or make them not appear at all?</li>\n</ol>\n\n<pre><code>If Not Intersect(Target, Range(\"A:C\")) Is Nothing Then\n    MsgBox (\"sorting\")\n\n    ActiveSheet.Sort.SortFields.Clear\n    ActiveSheet.Sort.SortFields.Add(Range(\"C:C\"), _\n        xlSortOnCellColor, _\n        xlDescending, _\n        , _\n        xlSortNormal).SortOnValue.Color = RGB(146, 208, 80)\n\n    ActiveSheet.Sort.SortFields.Add2 Key:=Range(\"C:C\"), _\n        SortOn:=xlSortOnValues, _\n        Order:=xlDescending, _\n        DataOption:=xlSortNormal\n\n   ActiveSheet.Sort.SortFields.Add2 Key:=Range(\"B:B\"), _\n        SortOn:=xlSortOnValues, _\n        Order:=xlDescending, _\n        DataOption:=xlSortNormal\n\n   ActiveSheet.Sort.SortFields.Add2(Range(\"C:C\"), _\n        xlSortOnCellColor, _\n        xlDescending, _\n        , _\n        xlSortNormal).SortOnValue.Color = RGB(255, 255, 255)\n\n    With ActiveSheet.Sort\n        .SetRange Range(\"A:C\")\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\nEnd If\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/doULK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/doULK.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/45brJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/45brJ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1558565415, "post_id": 56265056, "comment_id": 99148127, "body": "&quot;This line does not seem to work&quot; - in what way does it not work?  Error message/nothing happens?"}, {"owner": {"reputation": 1, "user_id": 11199514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7145d656f3256d5d33085b86965d2230?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/11199514/paolo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558593286, "post_id": 56265056, "comment_id": 99153663, "body": "I am asked to debug it"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558593462, "post_id": 56265056, "comment_id": 99153732, "body": "Actually the question is what error do you get. If there is no error explain what your code does vs what you expect it to do. You need to be much more specific about <b>what exactly</b> is going wrong and ask a proper question to that. You might benefit from reading  <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> \u2022 We need precise questions to answer, questions like <i>&quot;How can I do X/Y?&quot;</i> are in most cases too broad to answer (see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>)."}, {"owner": {"reputation": 1, "user_id": 11199514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7145d656f3256d5d33085b86965d2230?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/11199514/paolo"}, "edited": false, "score": 0, "creation_date": 1558596730, "post_id": 56265056, "comment_id": 99155187, "body": "@PEH I have made some edits. It remains difficult as I do not get a specific error message."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558627700, "post_id": 56265056, "comment_id": 99172475, "body": "If <code>Three</code> is a date-type then you probably need <code>#</code> around the query value.   <a href=\"https://stackoverflow.com/questions/31502464/excel-adodb-query-dates\" title=\"excel adodb query dates\">stackoverflow.com/questions/31502464/excel-adodb-query-dates</a>"}], "owner": {"reputation": 1, "user_id": 11199514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7145d656f3256d5d33085b86965d2230?s=128&d=identicon&r=PG&f=1", "display_name": "Paolo", "link": "https://stackoverflow.com/users/11199514/paolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558597244, "creation_date": 1558559346, "last_edit_date": 1558597244, "question_id": 56265056, "link": "https://stackoverflow.com/questions/56265056/how-to-make-a-triple-cascading-combobox-in-vba", "title": "How to make a triple cascading combobox in VBA", "body": "<p>I am trying to create three cascading comboboxes (the third dependent from the second, the second from the first). I have found a way to create and populate the first two, but I am struggling with the third one. Note that I want to populate them starting from just three columns with headers One, Two, Three.</p>\n\n<p>I have used the method listed here <a href=\"https://www.encodedna.com/excel/how-to-create-cascading-combo-box-in-excel-using-vba.htm\" rel=\"nofollow noreferrer\">https://www.encodedna.com/excel/how-to-create-cascading-combo-box-in-excel-using-vba.htm</a> which worked fine for the first two. I have tried to write an additional Sub for the third combobox similar to the second but it did not work</p>\n\n<pre><code>Private Sub cmbDue_Change()\n    ' THE CHANGE EVENT OF THE SECOND COMBO TO POPULATE THE THIRD COMBO BOX.\n\n    If Trim(cmbDue.Text) &lt;&gt; \"\" Then\n\n        SetConn     ' SET THE CONNECTION TO THE DATABASE.\n\n        ' SQL QUERY TO FETCH VALUE IN THIRD COLUMN BASED ON THE SELECTED CATEGORY.\n        sQuery = \"SELECT Three FROM [First$] WHERE \" &amp; _\n            \"Two = '\" &amp; cmbDue.Text &amp; \"' \" &amp; _\n            \"ORDER BY Three\"\n\n        cmbTre.Clear          ' CLEAR THE THIRD COMBOBOX.\n\n\n        If rs.State = adStateOpen Then\n            rs.Close\n        End If\n\n        rs.CursorLocation = adUseClient\n\n        ' POPULATE CASCADING COMBO BOX WITH VALUES.\n        rs.Open sQuery, myConn, adOpenKeyset, adLockOptimistic\n        If rs.RecordCount &gt; 0 Then\n            Do While Not rs.EOF\n                cmbTre.AddItem rs.Fields(0).Value\n                rs.MoveNext\n            Loop\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>This line does not work:</p>\n\n<pre><code>    rs.Open sQuery, myConn, adOpenKeyset, adLockOptimistic\n</code></pre>\n\n<p>...while it worked fine in the first sub to populate the second combobox.\nI do not get a specific error message, I am just asked to debug.</p>\n\n<p>My understanding is that rs.open should open and ADODB recordset consisting of my original table containing the data, which was created with this sub</p>\n\n<pre><code>Option Explicit\n\nPublic myConn As New ADODB.Connection\nPublic rs As New ADODB.Recordset\nPublic sQuery As String\n\n' SET A CONNECTION.\nSub SetConn()\n    If myConn.State = adStateOpen Then\n        myConn.Close\n    End If\n\n    Dim sConnString As String\n    sConnString = \"Driver={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" &amp; _\n        \"DBQ=\" &amp; ActiveWorkbook.Path &amp; Application.PathSeparator &amp; ActiveWorkbook.Name\n\n    myConn.ConnectionString = sConnString\n    myConn.Open         ' OPEN THE CONNECTION.\nEnd Sub\n</code></pre>\n\n<p>\"sQuery\" should run the SQL query set in the previous sub, to be run on my table \"rs\"(the ADODB recordset), while \"myConn\" should simply connect to the recordset.</p>\n\n<p>But it does not work.</p>\n"}, {"tags": ["excel", "vba", "visio"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 1, "creation_date": 1558561282, "post_id": 56265048, "comment_id": 99147092, "body": "Can you paste the full code, please? Then I will post a full answer"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11541692, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D-TOuQy5E6M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf-L0Sx0cgB_wKvvsMv76iaDvlmCQ/mo/photo.jpg?sz=128", "display_name": "Suresh Rajan", "link": "https://stackoverflow.com/users/11541692/suresh-rajan"}, "edited": false, "score": 0, "creation_date": 1558702420, "post_id": 56265517, "comment_id": 99198570, "body": "Thank you. This worked. Appreciate your help and timely response"}], "tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": false, "score": 1, "last_activity_date": 1558562096, "creation_date": 1558562096, "answer_id": 56265517, "question_id": 56265048, "link": "https://stackoverflow.com/questions/56265048/copying-a-visio-page-and-pasting-it-in-excel-as-an-image/56265517#56265517", "title": "Copying a visio page and pasting it in excel as an image", "body": "<pre><code>'Assuming your page object is named vsoPage\n'This embeds the visio drawing\nvsoPage.CreateSelection(visSelTypeAll).Copy\nCIwb.Worksheets(\"Current FlowChart\").Paste\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11541692, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D-TOuQy5E6M/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf-L0Sx0cgB_wKvvsMv76iaDvlmCQ/mo/photo.jpg?sz=128", "display_name": "Suresh Rajan", "link": "https://stackoverflow.com/users/11541692/suresh-rajan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1558574489, "creation_date": 1558559310, "last_edit_date": 1558574489, "question_id": 56265048, "link": "https://stackoverflow.com/questions/56265048/copying-a-visio-page-and-pasting-it-in-excel-as-an-image", "title": "Copying a visio page and pasting it in excel as an image", "body": "<p>I'm trying to copy all shapes in a visio page and paste it in Excel as an image. The image should be a close replica of the visio drawing. Looking for Excel vba script to do this. I'm able to open visio, access shapes information etc, but stuck in copying and pasting all shapes to excel as a single image</p>\n\n<p>I tried the following: </p>\n\n<pre><code> For j = 1 To intShapeCount  'Get count of shapes on page\n        Set vsoConnectFrom = vsoShapes.Item(j)\n        vsoConnectFrom.Copy(visCopyPasteNoTranslate)\n        CIwb.Worksheets(\"Current FlowChart\").Paste\n  Next j\n</code></pre>\n\n<p>This code is pasting all shapes to a single spot and the shapes are not connected. Hence looking for code that would just copy all shapes and paste as image into excel</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1558559158, "post_id": 56264909, "comment_id": 99146346, "body": "Are you text boxes named &quot;TextBox1&quot; or &quot;TextBox 1&quot;, with a space?"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1558559359, "post_id": 56264909, "comment_id": 99146423, "body": "@BigBen &quot;TextBox 1&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1558559386, "post_id": 56264909, "comment_id": 99146436, "body": "Then you&#39;re missing a space in <code>Shapes(&quot;TextBox&quot;</code>"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558559533, "post_id": 56264909, "comment_id": 99146499, "body": "@MathieuGuindon still getting a runtime error even with the space added"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 1, "creation_date": 1558559594, "post_id": 56264909, "comment_id": 99146526, "body": "What is the error?"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1558559653, "post_id": 56264909, "comment_id": 99146554, "body": "@MathieuGuindon figured it out, i don&#39;t have a textbox named &quot;TextBox 110&quot;"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1558559672, "post_id": 56264909, "comment_id": 99146565, "body": "@AAA your solution works. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 3, "last_activity_date": 1561885477, "last_edit_date": 1561885477, "creation_date": 1558559550, "answer_id": 56265090, "question_id": 56264909, "link": "https://stackoverflow.com/questions/56264909/how-to-loop-multiple-textboxes-to-set-transparency/56265090#56265090", "title": "How to Loop Multiple TextBoxes to set Transparency", "body": "<pre><code>Sub set_Transparency()\nDim x As Integer\nFor x = 100 To 149\nWith Sheet5.Shapes(\"TextBox \" &amp; x)\n    With .TextFrame2.TextRange.Characters\n        With .Font.Fill\n          .ForeColor.RGB = RGB(255, 255, 255)\n          .Transparency = 0\n        End With\n    End With\nEnd With\n    Next x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56265090, "answer_count": 1, "score": 0, "last_activity_date": 1561885477, "creation_date": 1558558595, "question_id": 56264909, "link": "https://stackoverflow.com/questions/56264909/how-to-loop-multiple-textboxes-to-set-transparency", "title": "How to Loop Multiple TextBoxes to set Transparency", "body": "<p>I am trying to set transparency levels to 60% on multiple textboxes using VBA. I am using the following code to loop TextBox 100 - 149, when executing I encounter a runtime error <code>The item with the specified name was not found</code> How can I resolve? </p>\n\n<pre><code>Sub set_Transparency()\nDim x As Integer\nFor x = 100 To 149\nWith Sheet5.Shapes(\"TextBox\" &amp; x)\n    With .TextFrame2.TextRange.Characters\n        With .Font.Fill\n.ForeColor.RGB = RGB(255, 255, 255)\n.Transparency = 0\n    End With\n        End With\nEnd With\n    Next x\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 173, "user_id": 1719890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd25513c710f5a3d0d21b5dc195d6621?s=128&d=identicon&r=PG", "display_name": "Jitendra Singh", "link": "https://stackoverflow.com/users/1719890/jitendra-singh"}, "edited": false, "score": 0, "creation_date": 1558557922, "post_id": 56264284, "comment_id": 99145857, "body": "Is this webpage public? Care to share a link ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1558560529, "post_id": 56264284, "comment_id": 99146848, "body": "&quot;When I make changes to the table&quot; - where/how are you making these changes?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1558562595, "post_id": 56264284, "comment_id": 99147434, "body": "^^ As above. Also, share the full code please."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558563926, "post_id": 56264284, "comment_id": 99147792, "body": "I&#39;m guessing you&#39;re getting a cached version of the page, but you don&#39;t show us how you get the content.  Try adding some random querystring parameter on the end of the URL and see if that fixes it.   Something like <code>&quot;http:&#47;&#47;yourUrlHere.asp?x=&quot; &amp; Rnd() * 1000000</code>"}, {"owner": {"reputation": 37, "user_id": 6718386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1ebbf304f0e6c09deec3a496370bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Freddie Fred", "link": "https://stackoverflow.com/users/6718386/freddie-fred"}, "edited": false, "score": 0, "creation_date": 1558566511, "post_id": 56264284, "comment_id": 99148355, "body": "The page is not public. I think you are right about the cached.  I closed all of my browsers, tried again and it worked. How can I make sure the cache is empty when I run the code?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558579139, "post_id": 56264284, "comment_id": 99150561, "body": "See @TimWilliams comment. You can try to avoid being served cached page via amending url."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558627740, "post_id": 56264284, "comment_id": 99172491, "body": "If you show how you make the call to the page someone can help you make a change to that."}], "owner": {"reputation": 37, "user_id": 6718386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1ebbf304f0e6c09deec3a496370bf1?s=128&d=identicon&r=PG&f=1", "display_name": "Freddie Fred", "link": "https://stackoverflow.com/users/6718386/freddie-fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558562612, "creation_date": 1558555833, "last_edit_date": 1558562612, "question_id": 56264284, "link": "https://stackoverflow.com/questions/56264284/innertext-not-picking-up-changes-to-webpage", "title": "Innertext not picking up changes to webpage", "body": "<p>I am trying to pull data from a webpage created in ASP.NET maker.<br>\nThe page is basically a large table.</p>\n\n<p>When I make changes to the table, the changes appear on the page and in the html code.  The changes also appear when I export the webpage to an excel sheet.  However, the changes do not appear when I scrape the webpage with an inntertext method.  </p>\n\n<pre><code>Dim htmlTable As MSHTML.IHTMLElement\nDim htmltables As MSHTML.IHTMLElementCollection\nDim htmlRow As MSHTML.IHTMLElement\nDim htmlcell As MSHTML.IHTMLElement\nDim rowNum As Long, colNum As Integer\nDim x As Integer\nDim y As Integer\n\n\n\n\n    'Note: htmltable(s) is collection of elements not a single element.\n    Set htmltables = htmlPage.getElementsByTagName(\"table\")\n\n    For Each htmlTable In htmltables\n        'Debug.Print htmlTable.className\n\n        x = 1\n        For Each htmlRow In htmlTable.getElementsByTagName(\"tr\")\n            'Debug.Print vbTab &amp; htmlRow.innertext\n\n            y = 1\n            '//This prints out any level below the \"tr\" element\n            For Each htmlcell In htmlRow.Children\n                'Debug.Print vbTab &amp; htmlcell.innertext\n\n                Sheet3.Activate\n\n                Cells(x, y) = htmlcell.innertext\n\n            y = y + 1\n            Next htmlcell\n\n        x = x + 1\n        Next htmlRow\n\n    Next htmlTable\n</code></pre>\n\n<p>Has anyone every experienced something like this before?  I can't figure out what is going wrong.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1558555843, "post_id": 56264189, "comment_id": 99144916, "body": "The first two both add a <code>ChartObject</code> (which is basically just a container for an actual <code>Chart</code> object) to a sheet.  The last one creates a chart sheet (ie not a chart embedded on a worksheet)  Any of those approaches are fine - use whatever works for you."}, {"owner": {"reputation": 109, "user_id": 11437092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d743e94888e414deb880028153b72e1e?s=128&d=identicon&r=PG&f=1", "display_name": "wgmcgowan", "link": "https://stackoverflow.com/users/11437092/wgmcgowan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558634306, "post_id": 56264189, "comment_id": 99175252, "body": "@TimWilliams Thank you for your clarification! How does an embedded chart relate to these examples?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558643717, "post_id": 56264189, "comment_id": 99179094, "body": "The first two create embedded charts."}], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": true, "score": 2, "last_activity_date": 1558660877, "creation_date": 1558660877, "answer_id": 56284733, "question_id": 56264189, "link": "https://stackoverflow.com/questions/56264189/how-should-i-create-graphs-in-excel-using-vba/56284733#56284733", "title": "How should I create graphs in Excel using VBA?", "body": "<p>There are four syntaxes to add an embedded chart to a worksheet. I'll list them oldest first.</p>\n\n<p>The oldest way, adds a chart sheet, then places the chart sheet onto the worksheet. Don't use it, it's obsolete.</p>\n\n<pre><code>Charts.Add\nActiveChart.Location Where:=xlLocationAsObject, Name:=\"Sheet1\"\n</code></pre>\n\n<p>This way adds the ChartObject directly to the worksheet. A ChartObject is a special kind of shape that includes a chart. This adds a default chart (clustered column unless you've defined a different default), using the dimensions and positions in parentheses (which are required). It returns a ChartObject.</p>\n\n<pre><code>ActiveSheet.ChartObjects.Add(Left, Top, Width, Height)\n</code></pre>\n\n<p>Excel 2007 introduced this syntax, which includes the chart type (if omitted you get the default type) and position and size (if omitted the chart is the default size, 3 by 5 inches, in the center of the active window). It returns a Shape.</p>\n\n<pre><code>ActiveSheet.Shapes.AddChart(XlChartType, Left, Top, Width, Height)\n</code></pre>\n\n<p>Excel 2013 introduced another syntax, which also includes the chart style in addition to the other parameters, and which also returns a shape.</p>\n\n<pre><code>ActiveSheet.Shapes.AddChart2(Style, XlChartType, Left, Top, Width, Height)\n</code></pre>\n\n<p>I would like to use <code>AddChart2</code> all the time, but I still support users of Excel 2010, so I have to use <code>AddChart</code>. I have a routine that looks up the default style for a given chart type, so I can apply it in Excel 2013+ to mimic <code>AddChart2</code>. There is probably no reason to use <code>ChartObjects.Add</code> over <code>AddChart</code> or <code>AddChart2</code>; no need to rewrite code if it's working, but don't use it in new code.</p>\n\n<p>What you should do is declare a variable of type <code>Chart</code>, and set it as follows:</p>\n\n<pre><code>Dim cht As Chart\n\nSet cht = ActiveSheet.ChartObjects.Add(100, 100, 360, 216).Chart\n\nSet cht = ActiveSheet.Shapes.AddChart(xlXYScatterLines, 100, 100, 360, 216).Chart\n\nSet cht = ActiveSheet.Shapes.AddChart2(240, xlXYScatterLines, 100, 100, 360, 216).Chart\n</code></pre>\n\n<p>Now you can perform further operations on the chart assigned to <code>cht</code>.</p>\n"}], "owner": {"reputation": 109, "user_id": 11437092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d743e94888e414deb880028153b72e1e?s=128&d=identicon&r=PG&f=1", "display_name": "wgmcgowan", "link": "https://stackoverflow.com/users/11437092/wgmcgowan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 919, "favorite_count": 1, "accepted_answer_id": 56284733, "answer_count": 1, "score": 2, "last_activity_date": 1558660877, "creation_date": 1558555446, "question_id": 56264189, "link": "https://stackoverflow.com/questions/56264189/how-should-i-create-graphs-in-excel-using-vba", "title": "How should I create graphs in Excel using VBA?", "body": "<p>I am making a report on Excel that will create graphs for the user based on data entered into the spreadsheet. I am quite new to VBA and, whilst I think I'm getting the hang of some basic expressions and structures, I'm definitely having trouble getting my head around the options available for coding graphs.</p>\n\n<hr>\n\n<p>Basic Google searches produce lots of guides, the following being examples:</p>\n\n<p><a href=\"https://peltiertech.com/Excel/ChartsHowTo/QuickChartVBA.html\" rel=\"nofollow noreferrer\">https://peltiertech.com/Excel/ChartsHowTo/QuickChartVBA.html</a></p>\n\n<p><a href=\"https://www.thespreadsheetguru.com/blog/2015/3/1/the-vba-coding-guide-for-excel-charts-graph\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2015/3/1/the-vba-coding-guide-for-excel-charts-graph</a></p>\n\n<p>...and searches on Stack Overflow and looking through the Microsoft help pages provide a certain amount of insight. However, there seem to be several ways of making graphs using VBA, and I'm struggling to understand the nuances in different examples of code. </p>\n\n<hr>\n\n<p>For example, I'm hesitant about which variables I should use for the chart. What might be the consequences in using <code>Dim cht As Chart</code> as opposed to <code>As Shape</code> or <code>As ChartObject</code>? I imagine this might inform the expressions I'd consider using to create the actual graph - which, according to the examples, seem to include:</p>\n\n<pre><code>Set cht = ws.Shapes.AddChart2(201, xlColumnClustered)\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>ws.ChartObjects.Add(*Left, Top, Width, Height*)\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>Set chtSht = Charts.Add\n</code></pre>\n\n<p>...Each of which seem quite different and I ultimately don't understand what purposes the differences serve.</p>\n\n<p>I have a hunch it's mostly to do with whether the charts are embedded or not, though I'm not sure of the extent to which this would inform the code.</p>\n\n<p>So, for those who are more experienced than I am and can probably address these concerns more efficiently than I can digest Google search results: <strong>How should I go about creating graphs in Excel using VBA?</strong></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11541455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b0c15a89d9778c499fba6e30387237?s=128&d=identicon&r=PG&f=1", "display_name": "Tink", "link": "https://stackoverflow.com/users/11541455/tink"}, "edited": false, "score": 0, "creation_date": 1558616735, "post_id": 56264404, "comment_id": 99166193, "body": "That works perfectly on a blank sheet! Definitely a step in the right direction. My problem is when i paste into Sheet2 cell A15 is a merged cell (A15:A17) and 87 cells lower is another merged cell (A102:A104) etc..... For some reason it is pasting the A15 cell perfectly and it does not paste the remainder of the cells. If I change the offset to 86 or 90 it will paste as programmed but that is not the correct cell. Could it be because the merged cells throw off the offset count?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3, "user_id": 11541455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b0c15a89d9778c499fba6e30387237?s=128&d=identicon&r=PG&f=1", "display_name": "Tink", "link": "https://stackoverflow.com/users/11541455/tink"}, "edited": false, "score": 0, "creation_date": 1558616996, "post_id": 56264404, "comment_id": 99166329, "body": "Merged cells shouldn&#39;t throw off the count. You refer to a merged cell by its leftmost, uppermost cell, so <code>A102</code> would be the cell value to update. Step through the code with <code>F8</code>. What exactly happens for all the cells besides <code>A15</code>?"}, {"owner": {"reputation": 3, "user_id": 11541455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b0c15a89d9778c499fba6e30387237?s=128&d=identicon&r=PG&f=1", "display_name": "Tink", "link": "https://stackoverflow.com/users/11541455/tink"}, "edited": false, "score": 0, "creation_date": 1558617295, "post_id": 56264404, "comment_id": 99166483, "body": "Nothing, as far as i can tell. The step for the first iteration pastes in A15, then it runs through iterations but nothing happens on the sheet."}, {"owner": {"reputation": 3, "user_id": 11541455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b0c15a89d9778c499fba6e30387237?s=128&d=identicon&r=PG&f=1", "display_name": "Tink", "link": "https://stackoverflow.com/users/11541455/tink"}, "edited": false, "score": 0, "creation_date": 1558617380, "post_id": 56264404, "comment_id": 99166530, "body": "When i change my pasteSheet to a blank sheet it works exactly as intended, pasting in A15, A102, etc.... and the merged cells are top left A15, A102, etc..."}, {"owner": {"reputation": 3, "user_id": 11541455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b0c15a89d9778c499fba6e30387237?s=128&d=identicon&r=PG&f=1", "display_name": "Tink", "link": "https://stackoverflow.com/users/11541455/tink"}, "edited": false, "score": 0, "creation_date": 1558617531, "post_id": 56264404, "comment_id": 99166617, "body": "I understand what is happening. It is taking the merged cell as one cell. If i removed the merged cell at 102:104 it pastes the second iteration in 104. I believe it is taking A15:A17 as a single cell for the offset count - so while it is offsetting 87 it is starting at A17, not A15."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3, "user_id": 11541455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b0c15a89d9778c499fba6e30387237?s=128&d=identicon&r=PG&f=1", "display_name": "Tink", "link": "https://stackoverflow.com/users/11541455/tink"}, "edited": false, "score": 0, "creation_date": 1558617621, "post_id": 56264404, "comment_id": 99166672, "body": "Ahhh, you&#39;re right, interesting, learned something new. In that case you need to adjust the offset. Or you can use <code>.Cells(15 + i*87, 1).Value</code> instead of <code>Range(&quot;A15&quot;).Offset(i * 87).Value</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3, "user_id": 11541455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b0c15a89d9778c499fba6e30387237?s=128&d=identicon&r=PG&f=1", "display_name": "Tink", "link": "https://stackoverflow.com/users/11541455/tink"}, "edited": false, "score": 0, "creation_date": 1558617869, "post_id": 56264404, "comment_id": 99166841, "body": "Try the <code>.Cells(15 + i*87, 1).Value</code>. Might be easier than adjusting the Offset."}, {"owner": {"reputation": 3, "user_id": 11541455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b0c15a89d9778c499fba6e30387237?s=128&d=identicon&r=PG&f=1", "display_name": "Tink", "link": "https://stackoverflow.com/users/11541455/tink"}, "edited": false, "score": 0, "creation_date": 1558618009, "post_id": 56264404, "comment_id": 99166931, "body": "I did but since I do not have 15 reputation it is not publicly displayed. It says the answer was still recorded though. - check mark is green though. Thanks!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1558618018, "last_edit_date": 1558618018, "creation_date": 1558556363, "answer_id": 56264404, "question_id": 56264121, "link": "https://stackoverflow.com/questions/56264121/copy-column-and-paste-in-different-sheet-starting-at-row-15-then-every-87th-row/56264404#56264404", "title": "Copy Column and Paste in different sheet starting at row 15 then every 87th row after", "body": "<p>Untested, but something like this perhaps:</p>\n\n<pre><code>Dim copySheet As Worksheet\nDim pasteSheet As Worksheet\n\nSet copySheet = Worksheets(\"Sheet1\")\nSet pasteSheet = Worksheets(\"Sheet2\")\n\nDim i as Long\nFor i = 0 to 64\n    pasteSheet.Range(\"A15\").Offset(i * 87).Value = copySheet.Range(\"A6\").Offset(i).Value\nNext i\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>If you're dealing with merged cells in the <code>pasteSheet</code>, try</p>\n\n<pre><code>pasteSheet.Cells(15 + i*87, 1).Value = copySheet.Range(\"A6\").Offset(i).Value\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11541455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b0c15a89d9778c499fba6e30387237?s=128&d=identicon&r=PG&f=1", "display_name": "Tink", "link": "https://stackoverflow.com/users/11541455/tink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 1, "accepted_answer_id": 56264404, "answer_count": 1, "score": 0, "last_activity_date": 1558618018, "creation_date": 1558555155, "last_edit_date": 1558555240, "question_id": 56264121, "link": "https://stackoverflow.com/questions/56264121/copy-column-and-paste-in-different-sheet-starting-at-row-15-then-every-87th-row", "title": "Copy Column and Paste in different sheet starting at row 15 then every 87th row after", "body": "<p>I am trying to copy a column (Sheet 2, range(\"A6:A70\") and paste in Sheet 1. I want the value in Sheet 2 A6 to paste in Sheet 1 A15, then the value in Sheet 2 A7 to paste 87 rows below A 15, and so on pasting the whole column(Sheet 2, A6:A70) every 87th cell in sheet 1.  </p>\n\n<p>I have tried different .offset commands and </p>\n\n<pre><code>ActiveSheet.Cells(Rows.Count, \"B\").End(xlUp).Row + 1\n</code></pre>\n\n<p>but what i need the loop to do is </p>\n\n<p>start at A15 and paste first value</p>\n\n<p>then maybe:</p>\n\n<p>Read where last paste was, move 87 rows down, paste next value, etc... </p>\n\n<pre><code>Dim copySheet As Worksheet\nDim pasteSheet As Worksheet\nDim c As Range\n\nSet copySheet = Worksheets(\"Sheet1\")\nSet pasteSheet = Worksheets(\"Sheet2\")\n\ncopySheet.Range(\"A6:A70\").Copy\n\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(87, 0).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>actual results are nothing - i am unsure what code i should be using.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11551695, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kUv68DF9qFI/AAAAAAAAAAI/AAAAAAAAIMY/vssDtblSRlA/photo.jpg?sz=128", "display_name": "B.McInnis", "link": "https://stackoverflow.com/users/11551695/b-mcinnis"}, "is_accepted": false, "score": 0, "last_activity_date": 1564773976, "last_edit_date": 1564773976, "creation_date": 1559052541, "answer_id": 56344118, "question_id": 56264059, "link": "https://stackoverflow.com/questions/56264059/update-template-text-with-user-input/56344118#56344118", "title": "Update template text with user input", "body": "<p>Using my example, by saving \"#0#\" in your template in the \"to:\" section of the email, by clicking this template it will prompt you to change that entry with the \"Email Address\" question.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub CommandButton1_Click()\n\n    Call OpenTemplate\n\nEnd Sub\n\nSub OpenTemplate()\n\n    Dim OutMail As Outlook.MailItem\n    Set OutMail = Application.CreateItemFromTemplate(\"Template Location\")\n\n    On Error Resume Next\n    With OutMail\n        .To = Replace(.To, \"#0#\", InputBox(\"Email Address\"))\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = Replace(.Subject, \"#1#\", InputBox(\"Prompt 1\"))\n        .Body = Replace(.Body, \"#2#\", InputBox(\"Prompt 2\"))\n        .Body = Replace(.Body, \"#3#\", InputBox(\"Prompt 3\"))\n        .Body = Replace(.Body, \"#4#\", InputBox(\"Prompt 4\"))\n\n        .Display\n    End With\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11541433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1caeda3721e0d73c2e8bc40b7e0b4e2?s=128&d=identicon&r=PG&f=1", "display_name": "turnasquare1", "link": "https://stackoverflow.com/users/11541433/turnasquare1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1591879929, "creation_date": 1558554828, "last_edit_date": 1591879929, "question_id": 56264059, "link": "https://stackoverflow.com/questions/56264059/update-template-text-with-user-input", "title": "Update template text with user input", "body": "<p>I want my email template to prompt me for input, and replace specified fields with my input.</p>\n\n<p>For example my email will be like:</p>\n\n<blockquote>\n  <p>Hello [name] </p>\n</blockquote>\n\n<p>I want a box to pop up where I can enter the name and have it appear throughout the email, replacing [name].</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1558552968, "post_id": 56263594, "comment_id": 99143661, "body": "Why not just replace <code>Range(&quot;D1&quot;)</code> by the range that you actually want to sort?"}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1558553096, "post_id": 56263594, "comment_id": 99143722, "body": "@JohnColeman thanks for your reply; I don&#39;t know how to select that range, since it will change each time I add a row to the sheet; it&#39;s not a fixed range but a range that should grow and be limited by the situation in col K."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1558553236, "post_id": 56263594, "comment_id": 99143784, "body": "Determine the first cell in column <code>K</code> with data? <code>N = Range(&quot;K1&quot;).End(XlDown).Row() - 1</code> (or some variation of that) should work."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558553365, "post_id": 56263594, "comment_id": 99143844, "body": "Sort first on ColK then on ColD"}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558553916, "post_id": 56263594, "comment_id": 99144088, "body": "@TimWilliams won&#39;t this place the cells with blank col k at the bottom?"}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558554446, "post_id": 56263594, "comment_id": 99144313, "body": "@TimWilliams I think since I have colors in the sheet I can sort by color and date"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558554496, "post_id": 56263594, "comment_id": 99144335, "body": "OK well I guess I should have tried that first - I thought you could fix that with sort order...  Another possibility would be to put some other value in the blank cells."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558554883, "post_id": 56263594, "comment_id": 99144498, "body": "add an empty row where you want to stop. that&#39;s how you do it, then delete it back."}, {"owner": {"reputation": 2670, "user_id": 3826387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0bc3e39607231181fa257d9b280247a?s=128&d=identicon&r=PG&f=1", "display_name": "RobertBaron", "link": "https://stackoverflow.com/users/3826387/robertbaron"}, "edited": false, "score": 0, "creation_date": 1558562058, "post_id": 56263594, "comment_id": 99147287, "body": "Have you thought/looked at Excel dynamic named ranges? See <a href=\"https://www.excel-easy.com/examples/dynamic-named-range.html\" rel=\"nofollow noreferrer\">excel-easy.com/examples/dynamic-named-range.html</a>"}], "owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558552795, "creation_date": 1558552795, "question_id": 56263594, "link": "https://stackoverflow.com/questions/56263594/how-do-i-stop-a-sort-at-a-certain-point-in-the-column", "title": "How do I stop a sort at a certain point in the column?", "body": "<p>I have a spreadsheet that automatically sorts itself by the date in column D.</p>\n\n<pre><code>If Not Intersect(Target, Range(\"D:D\")) Is Nothing Then\n    MsgBox (\"sorting col D\")\n'    Application.EnableEvents = False\n\n    Range(\"D1\").Sort Key1:=Range(\"D2\"), _\n    Order1:=xlAscending, Header:=xlYes, _\n    OrderCustom:=1, MatchCase:=False, _\n    Orientation:=xlTopToBottom\n\n'    Application.EnableEvents = True\n\nEnd If\n</code></pre>\n\n<p>This code works fine.</p>\n\n<p>What I want to do is limit the sorting to the first N rows.  Unfortunately, N is not a fixed number.  Basically there will be information in column K for SOME of the rows (and all of the rows with column K will be at the bottom of the sheet).  So I only want the sort to be performed for the rows in which there is no data in column K.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3iKfI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3iKfI.png\" alt=\"img1\"></a></p>\n\n<p>So in this picture, supposing there are dates in column D for all the green rows too, if I added a new row with a date in column D, it would sort it BUT ONLY AMONG ROWS 2-10, leaving rows 11+ alone.  I do not want the green rows resorted by column D, as they are sorted by something else.  Sorry for the vague photo!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1558552853, "post_id": 56263588, "comment_id": 99143604, "body": "You already have <code>cell</code>. I&#39;m not sure why you need <code>TrackedCell</code>. But if you do, <code>Set TrackedCell = cell</code>."}, {"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 0, "creation_date": 1558553017, "post_id": 56263588, "comment_id": 99143685, "body": "Set TrackedCell = cell"}, {"owner": {"reputation": 15, "user_id": 10535212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a64a32effebd3e8de36f15385a5115?s=128&d=identicon&r=PG&f=1", "display_name": "R.Bourne", "link": "https://stackoverflow.com/users/10535212/r-bourne"}, "edited": false, "score": 0, "creation_date": 1558553335, "post_id": 56263588, "comment_id": 99143829, "body": "Thank you the error went away, but I made &#39;TrackedCell&#39; to act as the spot in the column I wanted filled in as &#39;cell&#39; was used to move down rows."}], "owner": {"reputation": 15, "user_id": 10535212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28a64a32effebd3e8de36f15385a5115?s=128&d=identicon&r=PG&f=1", "display_name": "R.Bourne", "link": "https://stackoverflow.com/users/10535212/r-bourne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558552766, "creation_date": 1558552766, "question_id": 56263588, "link": "https://stackoverflow.com/questions/56263588/having-trouble-keeping-track-of-a-cell-and-making-the-cells-range-equal-a-new-va", "title": "Having trouble keeping track of a cell and making the cells range equal a new variable", "body": "<p>I'm trying to choose a cell to keep track of while a loop moves down cell by cell checking for conditions. If the conditions are met I want the chosen cell to be filled in depending on the condition met. I keep getting run-time error '1004', \"Method 'Range' of object'_Global' failed\" on line<code>Set TrackedCell = Range(cell)</code>. How do you keep track or record a previous cell in a loop?</p>\n\n<pre><code>Sub AutoFill()\nDim rng As Range, cell As Range\n'Set rng = Application.InputBox(\"Select a range\", \"Get Range\", Type:=8)\nSet rng = Range(\"F36:F66\")\nFor Each cell In rng\n    If IsEmpty(cell) = True And IsEmpty(Range(\"B\" &amp; cell.Row)) = True Then\n        If IsEmpty(cell.Offset(-1, 0)) = True Then\n            Dim TrackedCell As Range\n            Set TrackedCell = Range(cell)\n            TrackedCell.Offset(0, 1).Select\n            cell.Offset(1, 0).Select\n            Do Until IsEmpty(cell) = True\n                If IsEmpty(TrackedCell) = False And InStr(1, celltxt, \"F\") Then\n                    TrackedCell.Value = \"F\"\n                ElseIf IsEmpty(TrackedCell) = False And InStr(1, celltxt, \"NE\") Then\n                    TrackedCell.Value = \"NE\"\n                ElseIf IsEmpty(TrackedCell) = False And InStr(1, celltxt, \"P\") Then\n                    TrackedCell.Value = \"P\"\n                End If\n            Loop\n            'Dim Subtest As Range\n        End If\n    End If\nNext cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "userform", "date-formatting"], "comments": [{"owner": {"reputation": 149, "user_id": 190704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5gObH.jpg?s=128&g=1", "display_name": "JoshF", "link": "https://stackoverflow.com/users/190704/joshf"}, "edited": false, "score": 0, "creation_date": 1558553661, "post_id": 56263541, "comment_id": 99143977, "body": "What type of controls are you using in the VBA Form?  What does the function Format return the date as?  String or Date Value?"}, {"owner": {"reputation": 149, "user_id": 190704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5gObH.jpg?s=128&g=1", "display_name": "JoshF", "link": "https://stackoverflow.com/users/190704/joshf"}, "edited": false, "score": 0, "creation_date": 1558554550, "post_id": 56263541, "comment_id": 99144360, "body": "I created a VBA form and added a Textbox control.  I then put a date in a cell and when the form loaded I used the same format function that you provided.  The correctly formatted date appeared in the Textbox control."}, {"owner": {"reputation": 19, "user_id": 7674503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb2f58071a3dcad52f4ec6d45904fcca?s=128&d=identicon&r=PG&f=1", "display_name": "Bert", "link": "https://stackoverflow.com/users/7674503/bert"}, "reply_to_user": {"reputation": 149, "user_id": 190704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5gObH.jpg?s=128&g=1", "display_name": "JoshF", "link": "https://stackoverflow.com/users/190704/joshf"}, "edited": false, "score": 0, "creation_date": 1558607906, "post_id": 56263541, "comment_id": 99161303, "body": "Function format returns string value. Thanks for helping. After 10:00 am (EDT) I will be working on this the rest of the day until it is working."}, {"owner": {"reputation": 19, "user_id": 7674503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb2f58071a3dcad52f4ec6d45904fcca?s=128&d=identicon&r=PG&f=1", "display_name": "Bert", "link": "https://stackoverflow.com/users/7674503/bert"}, "reply_to_user": {"reputation": 149, "user_id": 190704, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/5gObH.jpg?s=128&g=1", "display_name": "JoshF", "link": "https://stackoverflow.com/users/190704/joshf"}, "edited": false, "score": 0, "creation_date": 1558623631, "post_id": 56263541, "comment_id": 99170384, "body": "My email address is Bertb76@gmail.com. Could I send you the full code to see if you can help me identify why dates are not showing as dates but as strings? @JoshF"}], "owner": {"reputation": 19, "user_id": 7674503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb2f58071a3dcad52f4ec6d45904fcca?s=128&d=identicon&r=PG&f=1", "display_name": "Bert", "link": "https://stackoverflow.com/users/7674503/bert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558552671, "creation_date": 1558552598, "last_edit_date": 1558552671, "question_id": 56263541, "link": "https://stackoverflow.com/questions/56263541/how-to-convert-date-to-display-properly-in-user-form", "title": "How to convert date to display properly in user form?", "body": "<p>When entering the date in a new record, the \"Date Transferred\" field is formatted for mm/dd/yyyy. When the same date filed is displayed it is showing as a string, \"42353\", instead of \"12/15/2015\". </p>\n\n<p>Example of Current Code = </p>\n\n<pre><code>Private Sub Will18_Exit(ByVal Cancel As MSForms.ReturnBoolean)\n    If Will18 = vbEmptyString Then Exit Sub\n\n    If IsDate(Will18) Then\n        txtDateTxfr = Format(Will18, \"mm/dd/yyyy\")\n    Else\n        MsgBox \"Please enter a valid date mm/dd/yyyy\", vbCritical\n    End If\nEnd Sub\n</code></pre>\n\n<p>Would like dates in 3 fields to show as \"Date Received\", \"Date Removed\" and \"Date Transferred\" to show as \"mm/dd/yyyy\" not string value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1558552278, "post_id": 56263333, "comment_id": 99143327, "body": "Immediate thought... Looks like you will need to split your loops (currently nested) such that you can assess one column at a time, similar for <code>out1</code>.  Where do you get your <code>1004 error</code> in your code?"}, {"owner": {"reputation": 157, "user_id": 10836136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a7cb4b68bcc5afe10444ed2904dfc0?s=128&d=identicon&r=PG&f=1", "display_name": "Discover", "link": "https://stackoverflow.com/users/10836136/discover"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1558552896, "post_id": 56263333, "comment_id": 99143624, "body": "Not familiar with VBA so a working example would be great. The debug highlights the following line:     Set out1 = Range(&quot;G2&quot;, Range(&quot;K2&quot;).Offset(UBound(c1) * UBound(c2) * UBound(c3) * UBound(c4)))"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 10836136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a7cb4b68bcc5afe10444ed2904dfc0?s=128&d=identicon&r=PG&f=1", "display_name": "Discover", "link": "https://stackoverflow.com/users/10836136/discover"}, "edited": false, "score": 0, "creation_date": 1558556670, "post_id": 56264206, "comment_id": 99145315, "body": "Awesome! Works Beautifully!"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 157, "user_id": 10836136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a7cb4b68bcc5afe10444ed2904dfc0?s=128&d=identicon&r=PG&f=1", "display_name": "Discover", "link": "https://stackoverflow.com/users/10836136/discover"}, "edited": false, "score": 0, "creation_date": 1558619243, "post_id": 56264206, "comment_id": 99167719, "body": "@Discover Added functionality to code so that it can handle any number of results (including if the number of results exceeds the amount of rows on a single worksheet), and added comments to the code."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1558620225, "last_edit_date": 1558620225, "creation_date": 1558555508, "answer_id": 56264206, "question_id": 56263333, "link": "https://stackoverflow.com/questions/56263333/4-column-combinations-w-vba/56264206#56264206", "title": "4 Column Combinations W/ VBA", "body": "<p>This should work for you.  Please note that it will work for any number of columns, not just 4, and that it will also work if any of the columns don't have full population (though each column must have at least one populated cell).</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rDest As Range\n    Dim aHeaders() As Variant\n    Dim aTemp() As Variant\n    Dim aData() As Variant\n    Dim aResults() As Variant\n    Dim vTemp As Variant\n    Dim ixData As Long\n    Dim ixResult As Long\n    Dim ixRow As Long\n    Dim ixCol As Long\n    Dim lMaxRows As Long\n    Dim lResultsBlock As Long\n    Dim lOverflowResults As Long\n    Dim bPopulated As Boolean\n\n    'Adjust these as necessary\n    Set ws = ActiveWorkbook.Worksheets(1)   'The worksheet that contains the table of values\n    Set rDest = ws.Range(\"G2\")              'The worksheet and cell where results should be output to\n    lResultsBlock = 100000                  'The number of rows the results array can contain before having to output results and then continuing\n\n    'Get table of values that will be used to create combinations, assume table starts in A1 and has headers\n    With ws.Range(\"A1\").CurrentRegion\n        If .Rows.Count = 1 Then Exit Sub    'No data\n        If .Cells.Count = 2 Then\n            ReDim aHeaders(1 To 1, 1 To 1)\n            aHeaders(1, 1) = .Cells(1).Value\n            ReDim aData(1 To 1, 1 To 1)\n            aData(1, 1) = .Cells(2).Value\n        Else\n            aHeaders = .Resize(1).Value\n            aData = .Offset(1).Resize(.Rows.Count - 1).Value\n        End If\n        lMaxRows = UBound(aData, 1) ^ UBound(aData, 2)\n        ReDim aResults(1 To lResultsBlock, 1 To UBound(aData, 2))\n        lOverflowResults = 0\n    End With\n\n    'Clear previous results\n    ClearResults rDest\n\n    'Iterate over the table of values and create every possible combination\n    For ixRow = 1 To lMaxRows\n        'Prevent Excel from looking frozen, show a % percent complete\n        If (ixRow - 1) Mod 10000 = 0 Then\n            DoEvents\n            Application.StatusBar = \"Processing: \" &amp; Format(ixRow / lMaxRows, \"0.00%\") &amp; \" completed...\"\n        End If\n\n        'Check if this combination has any empty/blank values\n        bPopulated = True\n        ReDim aTemp(1 To UBound(aResults, 2))\n        For ixCol = 1 To UBound(aResults, 2)\n            ixData = Int(((ixRow - 1) Mod (UBound(aData, 1) ^ (UBound(aData, 2) - (ixCol - 1)))) / (UBound(aData, 1) ^ (UBound(aData, 2) - ixCol))) + 1\n            vTemp = aData(ixData, ixCol)\n            If Len(vTemp) &gt; 0 Then\n                aTemp(ixCol) = vTemp\n            Else\n                'Empty/blank found, skip this combination\n                bPopulated = False\n                Exit For\n            End If\n        Next ixCol\n\n        If bPopulated Then\n            'No empties/blanks found in this combination, add it to results\n            ixResult = ixResult + 1\n            For ixCol = 1 To UBound(aResults, 2)\n                aResults(ixResult, ixCol) = aTemp(ixCol)\n            Next ixCol\n            Erase aTemp\n\n            'Output results if the results array is full\n            If ixResult = UBound(aResults, 1) Then OutputResults ws, rDest, aResults, ixResult, lOverflowResults, aHeaders\n        End If\n    Next ixRow\n\n    'Output results if results array is at least partially populated\n    If ixResult &gt; 0 Then OutputResults ws, rDest, aResults, ixResult, lOverflowResults, aHeaders\n    Application.StatusBar = vbNullString\n\nEnd Sub\n\n'This will clear any previous results\nSub ClearResults(ByVal arg_rDest As Range)\n\n    Dim ws As Worksheet\n\n    arg_rDest.CurrentRegion.ClearContents\n    Application.DisplayAlerts = False\n    For Each ws In arg_rDest.Worksheet.Parent.Worksheets\n        If ws.Name Like \"Overflow Results (*)\" Then ws.Delete\n    Next ws\n    Application.DisplayAlerts = True\n\nEnd Sub\n\n'This will output the current results array to the appropriate destination, accounting for if a new sheet needs to be created and whether headers need to be provided\nSub OutputResults(ByRef arg_wsDest As Worksheet, _\n                  ByVal arg_rDest As Range, _\n                  ByRef arg_aResults As Variant, _\n                  ByRef arg_ixResult As Long, _\n                  ByRef arg_lOverflowResults As Long, _\n                  Optional ByVal arg_aHeaders As Variant)\n\n    Dim rDest As Range\n    Dim lHeaderRow As Long\n    Dim lRowCount As Long\n    Dim lColCount As Long\n\n    'Check if this is the first time results are being output\n    If arg_wsDest.Cells(arg_wsDest.Rows.Count, arg_rDest.Column).End(xlUp).Row &lt;= arg_rDest.Row Then\n        'This is the first time results are being output\n        arg_lOverflowResults = 0\n\n        'Check if headers need to be placed\n        If IsArray(arg_aHeaders) Then\n            If arg_rDest.Row = 1 Then lHeaderRow = 1 Else lHeaderRow = arg_rDest.Row - 1\n            With arg_wsDest.Cells(lHeaderRow, arg_rDest.Column).Resize(, UBound(arg_aHeaders, 2))\n                .Value = arg_aHeaders\n                .Font.Bold = True\n            End With\n            Set rDest = arg_wsDest.Cells(lHeaderRow + 1, arg_rDest.Column)\n        Else\n            Set rDest = arg_rDest\n        End If\n    End If\n\n    'These are used to create a new, empty results array after results are output\n    lRowCount = UBound(arg_aResults, 1)\n    lColCount = UBound(arg_aResults, 2)\n\n    'Check if there is room left in the current destination worksheet to contain all of the results\n    If arg_wsDest.Cells(arg_wsDest.Rows.Count, arg_rDest.Column).End(xlUp).Row + 1 + arg_ixResult &gt; arg_wsDest.Rows.Count Then\n        'Not enough room found, create a new sheet to continue outputting results on and apply headers if necessary\n        arg_lOverflowResults = arg_lOverflowResults + 1\n        Set arg_wsDest = arg_wsDest.Parent.Worksheets.Add(AFter:=arg_wsDest)\n        arg_wsDest.Name = \"Overflow Results (\" &amp; arg_lOverflowResults &amp; \")\"\n        If IsArray(arg_aHeaders) Then\n            With arg_wsDest.Cells(1, arg_rDest.Column).Resize(, UBound(arg_aHeaders, 2))\n                .Value = arg_aHeaders\n                .Font.Bold = True\n            End With\n            Set rDest = arg_wsDest.Cells(2, arg_rDest.Column)\n        Else\n            Set rDest = arg_wsDest.Cells(1, arg_rDest.Column)\n        End If\n    Else\n        'Enough room found, set destination for where results should begin\n        If rDest Is Nothing Then Set rDest = arg_wsDest.Cells(arg_wsDest.Rows.Count, arg_rDest.Column).End(xlUp).Offset(1)\n    End If\n\n    'Output results\n    rDest.Resize(arg_ixResult, UBound(arg_aResults, 2)).Value = arg_aResults\n\n    'Clear the existing results array and create a new, empty results array\n    Erase arg_aResults\n    ReDim arg_aResults(1 To lRowCount, 1 To lColCount)\n    arg_ixResult = 0\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 10836136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0a7cb4b68bcc5afe10444ed2904dfc0?s=128&d=identicon&r=PG&f=1", "display_name": "Discover", "link": "https://stackoverflow.com/users/10836136/discover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56264206, "answer_count": 1, "score": 0, "last_activity_date": 1558620225, "creation_date": 1558551628, "last_edit_date": 1558591553, "question_id": 56263333, "link": "https://stackoverflow.com/questions/56263333/4-column-combinations-w-vba", "title": "4 Column Combinations W/ VBA", "body": "<p>I have the following code:</p>\n\n<pre><code>  Sub combinations()\n\n  Range(\"G2:G\" &amp; Range(\"G2\").End(xlDown).Row).ClearContents\n  Range(\"H2:G\" &amp; Range(\"H2\").End(xlDown).Row).ClearContents\n  Range(\"I2:G\" &amp; Range(\"I2\").End(xlDown).Row).ClearContents\n  Range(\"J2:G\" &amp; Range(\"J2\").End(xlDown).Row).ClearContents\n\nDim c1() As Variant\nDim c2() As Variant\nDim c3() As Variant\nDim c4() As Variant\n\nDim out() As Variant\nDim j As Long, k As Long, l As Long, m As Long, n As Long\n\n\nDim col1 As Range\nDim col2 As Range\nDim col3 As Range\nDim col4 As Range\n\nDim out1 As Range\n\n\nSet col1 = Range(\"A2\", Range(\"A2\").End(xlDown))\nSet col2 = Range(\"B2\", Range(\"B2\").End(xlDown))\nSet col3 = Range(\"C2\", Range(\"C2\").End(xlDown))\nSet col4 = Range(\"D2\", Range(\"D2\").End(xlDown))\n\nc1 = col1\nc2 = col2\nc3 = col3\nc4 = col4\n\nSet out1 = Range(\"G2\", Range(\"K2\").Offset(UBound(c1) * UBound(c2) * UBound(c3) * UBound(c4)))\nout = out1\n\nj = 1\nk = 1\nl = 1\nm = 1\nn = 1\n\n\nDo While j &lt;= UBound(c1)\n    Do While k &lt;= UBound(c2)\n        Do While l &lt;= UBound(c3)\n            Do While m &lt;= UBound(c4)\n                out(n, 1) = c1(j, 1)\n                out(n, 2) = c2(k, 1)\n                out(n, 3) = c3(l, 1)\n                out(n, 4) = c4(m, 1)\n                n = n + 1\n                m = m + 1\n            Loop\n            m = 1\n            l = l + 1\n        Loop\n        l = 1\n        k = k + 1\n    Loop\n    k = 1\n    j = j + 1\nLoop\n\n\nout1.Value = out\nEnd Sub\n</code></pre>\n\n<p>It creates all possible combination for values you put in A:A through D:D.</p>\n\n<p>Example of a working table:</p>\n\n<pre><code>           Header1  Header2 Header3 Header4\n           A1       B1      C1      D1\n           A2       B2      C2      D2\n           A3       B3      C3      D3\n</code></pre>\n\n<p>The only time it does not work is when one of the columns only has 1 value.</p>\n\n<p>Example of a not working table:</p>\n\n<pre><code>           Header1  Header2 Header3 Header4\n           A1       B1      C1      D1\n                    B2      C2      D2\n                    B3      C3      D3\n</code></pre>\n\n<p>I get a </p>\n\n<blockquote>\n  <p>Run-time error '1004;</p>\n</blockquote>\n\n<p>Is there a way to fix this so that it would work for columns with 1 value as well?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1558554500, "last_edit_date": 1558554500, "creation_date": 1558554104, "answer_id": 56263875, "question_id": 56263326, "link": "https://stackoverflow.com/questions/56263326/using-text-boxes-as-a-criteria-for-list-boxes-in-access-2016/56263875#56263875", "title": "Using text boxes as a criteria for list boxes in Access 2016", "body": "<p>Simply concatenate the values which requires date conversion from string, Be sure to also <code>Requery</code> after assigining statement</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Dim whereClause As String\n\nwhereClause = \" WHERE [Date] BETWEEN CDate('\" &amp; Me.txtStart.Value &amp; \"')\" _\n                 &amp; \"             AND CDate('\" &amp; Me.txtEnd.Value &amp; \"')\"\n\nMe.lstDailytop.RowSource = \"SELECT StockCode, SumOfQTY, [Date] FROM qrytpdailystck \" &amp; whereClause\nMe.lstDailytop.Requery\n\nMe.lstMonthlytop.RowSource = \"SELECT StockCode, SumOfQTY, [Date] FROM qrytpmonthstck \" &amp; whereClause\nMe.lstMonthlytop.Requery\n\nMe.lstYearlytop.RowSource = \"SELECT StockCode, SumOfQTY, [Date] FROM qrytpyearstck \" &amp; whereClause\nMe.lstYearlytop.Requery\n</code></pre>\n\n<hr>\n\n<p>Alternatively, you can forgo the building of concatenated SQL string and use one query statement directly on form controls with absolute referencing. Using <code>NZ()</code> queries can accommodate if form date values are empty or not.</p>\n\n<p><strong>SQL</strong> <em>(save below statements as default assignments in each combobox's respective <code>RowSource</code> under Property Sheet, never to be changed)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT StockCode, SumOfQTY, [Date] \nFROM qrytpdailystck\nWHERE [Date] BETWEEN NZ(Forms!myFormName!txtStart, [Date])\n                 AND NZ(Forms!myFormName!txtEnd, [Date])\n\nSELECT StockCode, SumOfQTY, [Date] \nFROM qrytpmonthstck\nWHERE [Date] BETWEEN NZ(Forms!myFormName!txtStart, [Date])\n                 AND NZ(Forms!myFormName!txtEnd, [Date])\n\nSELECT StockCode, SumOfQTY, [Date] \nFROM qrytpyearstck\nWHERE [Date] BETWEEN NZ(Forms!myFormName!txtStart, [Date])\n                 AND NZ(Forms!myFormName!txtEnd, [Date])\n</code></pre>\n\n<p><strong>VBA</strong> <em>(run below on needed trigger event in macro or module)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>Me.lstDailytop.Requery    \nMe.lstMonthlytop.Requery    \nMe.lstYearlytop.Requery\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8921510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6761acc2fae0f23da7da64ba4cc7ca95?s=128&d=identicon&r=PG&f=1", "display_name": "Robit010", "link": "https://stackoverflow.com/users/8921510/robit010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 56263875, "answer_count": 1, "score": 0, "last_activity_date": 1558554500, "creation_date": 1558551562, "last_edit_date": 1558554452, "question_id": 56263326, "link": "https://stackoverflow.com/questions/56263326/using-text-boxes-as-a-criteria-for-list-boxes-in-access-2016", "title": "Using text boxes as a criteria for list boxes in Access 2016", "body": "<p>I have a form that has 3 list boxes that I am trying to query based off the range given from 2 entry/text boxes.  I'm not sure how to get the script to look at the text boxes.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.lstDailytop.RowSource = \" SELECT StockCode, SumOfQTY, Date from qrytpdailystck WHERE [Date] BETWEEN  Me.txtStart.Value And Me.txtEnd.Value\"\n\nMe.lstMonthlytop.RowSource = \" SELECT StockCode, SumOfQTY, Date from qrytpmonthstck WHERE [Date] BETWEEN Me.txtStart.Value AND Me.txtEnd.Value \"\n\nMe.lstYearlytop.RowSource = \" SELECT StockCode, SumOfQTY, Date from qrytpyearstck WHERE [Date] BETWEEN Me.txtStart.Value AND Me.txtEnd.Value \"\n</code></pre>\n\n<p>When I run this it ask for the value of <code>Me.txtStart.value</code> and <code>Me.txtEnd.value</code>. I'm assuming there is a way to let VBA know its referring to a object rather than a variable. I am unable to figure it out. Hoping someone knows what I'm doing wrong.</p>\n"}, {"tags": ["excel", "vba", "image"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 6552125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3fd6f09dae0d6962b18b43908ff2a256?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeB22", "link": "https://stackoverflow.com/users/6552125/georgeb22"}, "edited": false, "score": 0, "creation_date": 1558620463, "post_id": 56264239, "comment_id": 99168450, "body": "This worked like a charm! I changed a few references and added a few more lines so the images are centered, but this was exactly what I needed. Thank you!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1558555614, "creation_date": 1558555614, "answer_id": 56264239, "question_id": 56263067, "link": "https://stackoverflow.com/questions/56263067/moving-multiple-images-to-another-worksheet-using-vba-new-location/56264239#56264239", "title": "Moving multiple images to another worksheet using VBA - new location", "body": "<p>Here's a starting point:</p>\n\n<pre><code>Sub Tester()\n\n    Dim shtSource As Worksheet, shtDest As Worksheet\n    '....\n\n    Set shtSource = Worksheets(\"Eyelets\")\n    Set shtDest = Worksheets(\"Plots\")\n\n    '....\n\n    If CopyPicFromCell(shtSource.Range(\"A1\").Offset(i - 1, 2)) Then\n        'copied the picture, so paste to shtDest\n        shtDest.Paste\n        With shtDest.Shapes(shtDest.Shapes.Count)\n            .Top = shtDest.Range(\"A1\").Offset(0, 1).Top\n            .Left = shtDest.Range(\"A1\").Offset(0, 1).Left\n        End With\n    End If\n\n\nEnd Sub\n\n\n\n'see if there's a shape to be copied from a given cell\n'  return True if one was found\nFunction CopyPicFromCell(c As Range)\n    Const MARGIN As Long = 10 '&lt;&lt; how far the picture can be out of place\n    Dim shp As Shape\n    For Each shp In c.Parent.Shapes\n        'check the TopLeftCell and the shape's position\n        If shp.TopLeftCell.Address = c.Address Or _\n            (Abs(shp.Left - c.Left) &lt; MARGIN And Abs(shp.Top - c.Top) &lt; MARGIN) Then\n            shp.Copy\n            CopyPicFromCell = True\n            Exit For '&lt;&lt; done checking\n        End If\n    Next shp\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6552125, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3fd6f09dae0d6962b18b43908ff2a256?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeB22", "link": "https://stackoverflow.com/users/6552125/georgeb22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 56264239, "answer_count": 1, "score": 0, "last_activity_date": 1558555614, "creation_date": 1558550407, "question_id": 56263067, "link": "https://stackoverflow.com/questions/56263067/moving-multiple-images-to-another-worksheet-using-vba-new-location", "title": "Moving multiple images to another worksheet using VBA - new location", "body": "<p>I am creating a new sheet with the goal of reorganizing the information on another sheet. I have been able to move all other information to the other sheet in the format needed, but I can not move images/pictures of the parts.</p>\n\n<p>I have tried using the code shown below, but referencing the cell the images are in, but it does not copy. I did a little research and looked at if there was a simple way to move images just by copy-pasting cells through VBA and it does not seem to work. I also look at trying to rename all the shapes, but to no success. </p>\n\n<pre><code>'find the last row of values\nWorksheets(\"Eyelets\").Activate\n\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, \nSearchDirection:=xlPrevious).Row + 3\n\nWorksheets(\"Plot\").Activate\n\n'1st column of values\nFor i = 2 To LastRow Step 4\n\nCount = Count + 1\n\nx = i + Count\n\n'Store all variables in the row\nRDPNHold = Worksheets(\"Eyelets\").Range(\"A1\").Offset(i - 1, 0)\nFDPNHold = Worksheets(\"Eyelets\").Range(\"A1\").Offset(i - 1, 1)\nWRHold = Worksheets(\"Eyelets\").Range(\"A1\").Offset(i - 1, 4)\nMatHold = Worksheets(\"Eyelets\").Range(\"A1\").Offset(i - 1, 9)\nDiamHold = Worksheets(\"Eyelets\").Range(\"A1\").Offset(i - 1, 5).Value\n\n\n\n'Move All Part Numbers to next sheet.\nWorksheets(\"Plot\").Range(\"A1\").Offset(x - 2, 0) = RDPNText &amp; RDPNHold\nWorksheets(\"Plot\").Range(\"A1\").Offset(x - 1, 0) = FDPNText &amp; FDPNHold\nWorksheets(\"Plot\").Range(\"A1\").Offset(x, 0) = WRText &amp; WRHold\nWorksheets(\"Plot\").Range(\"A1\").Offset(x + 1, 0) = MatText &amp; MatHold &amp; DiamText &amp; DiamHold\n\n\n'Bold Specific parts of the cells\nWorksheets(\"Plot\").Range(\"A1\").Offset(x - 2, 0).Characters(Len(lngIDStart), 3).Font.Bold = True\nWorksheets(\"Plot\").Range(\"A1\").Offset(x - 1, 0).Characters(Len(lngIDStart), 3).Font.Bold = True\nWorksheets(\"Plot\").Range(\"A1\").Offset(x, 0).Characters(Len(lngIDStart), 3).Font.Bold = True\nWorksheets(\"Plot\").Range(\"A1\").Offset(x + 1, 0).Characters(Len(lngIDStart), 4).Font.Bold = True\nWorksheets(\"Plot\").Range(\"A1\").Offset(x + 1, 0).Characters(Len(lngIDStart) + 13, 5).Font.Bold = True\n\nNext i\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gE1Lr.png\" rel=\"nofollow noreferrer\">Information not formateed</a> This image shows how the information is already organized (I changed values due to work-related information)</p>\n\n<p><a href=\"https://i.stack.imgur.com/ukURh.png\" rel=\"nofollow noreferrer\">Formatted Information</a> This image shows how I am trying to format the information, and as shown the blank space for the images.</p>\n\n<p>Any ideas or suggestions are greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "paste"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1558550653, "post_id": 56262454, "comment_id": 99142636, "body": "Yes, it&#39;s definitely possible. Unless I&#39;m mistaken <code>ClearContents</code> is also clearing the <code>Application.CutCopyMode</code>. Clear the contents first, <i>then</i> copy the source, and then immediately paste it. As it stands it doesn&#39;t look like you&#39;re copying anything. What&#39;s being pasted?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558550812, "post_id": 56262454, "comment_id": 99142717, "body": "@MathieuGuindon Better worded then mine, I was going to say copy the range and paste before you clear the range. +1"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1558551023, "post_id": 56262454, "comment_id": 99142809, "body": "@GMalc if the range being cleared is supposed to be what&#39;s copied, then you&#39;re right it should be cleared last."}, {"owner": {"reputation": 123, "user_id": 11301508, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157606605643465/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/11301508/jens"}, "edited": false, "score": 0, "creation_date": 1558551426, "post_id": 56262454, "comment_id": 99142970, "body": "Hello! I&#39;m copying content from another program. The content is already in the clipboard when the macro is started."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558551558, "post_id": 56262454, "comment_id": 99143020, "body": "The <code>ClearContent</code> needs to run before data is in the clipboard then. Or can you paste to a new sheet?"}, {"owner": {"reputation": 123, "user_id": 11301508, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157606605643465/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/11301508/jens"}, "edited": false, "score": 0, "creation_date": 1558553133, "post_id": 56262454, "comment_id": 99143739, "body": "Don&#39;t know why but the clipboard isn&#39;t erased with the Sheets(&quot;searchresult&quot;).UsedRange.ClearContents line. The first example in my post do paste the stuff in the clipboard just fine."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558553547, "post_id": 56262454, "comment_id": 99143930, "body": "Not sure what the problem is then?"}, {"owner": {"reputation": 123, "user_id": 11301508, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157606605643465/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/11301508/jens"}, "edited": false, "score": 0, "creation_date": 1558553820, "post_id": 56262454, "comment_id": 99144037, "body": "The problem is that the screen flashes between the two sheets. Searchresult and Show. The second example in my post is what I want. I want to paste the content in the clipboard to the sheet &quot;Searchresult&quot; without having to select it first. I want the sheet &quot;Show&quot; to be visible all the time and the pasting to happen in the background! :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558553996, "post_id": 56262454, "comment_id": 99144121, "body": "I see that. What I&#39;m unclear about is what the problem is with the code you want, other than the missing ilne continuation. Getting any particular error? Tried pasing on A1? e.g. <code>Sheets(&quot;searchresult&quot;).Range(&quot;A1&quot;).PasteSpecial ...</code>"}, {"owner": {"reputation": 123, "user_id": 11301508, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157606605643465/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/11301508/jens"}, "edited": false, "score": 0, "creation_date": 1558554388, "post_id": 56262454, "comment_id": 99144275, "body": "Wow it worked! But had to use xlPasteAll from the comment from Peter T below! See the finished code below in the answer below!"}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1558551048, "creation_date": 1558551048, "answer_id": 56263208, "question_id": 56262454, "link": "https://stackoverflow.com/questions/56262454/possible-to-paste-content-into-a-sheet-thats-not-active/56263208#56263208", "title": "Possible to paste content into a sheet that&#39;s not active?", "body": "<p>It's very possible and even preferred to avoid using <code>Activate</code>. Look at <a href=\"https://riptutorial.com/excel-vba/example/9292/avoid-using-select-or-activate\" rel=\"nofollow noreferrer\">this webpage</a> for a brief discussion. But you still have to copy data to the clipboard in order to paste. So building on your example:</p>\n\n<pre><code>Option Explicit\n\nSub PasteContentExample()\n    Dim dataSource As Range\n    Set dataSource = ThisWorkbook.Sheets(\"searchresult\").UsedRange\n\n    Dim dataDestination As Range\n    Set dataDestination = ThisWorkbook.Sheets(\"anothersheet\").Range(\"A1\")\n    Set dataDestination = dataDestination.Resize(dataSource.Rows.Count, dataSource.Columns.Count)\n\n    dataSource.Copy\n    dataDestination.PasteSpecial xlPasteAll\n\n    '--- clear all data and formatting from the source area\n    dataSource.Clear\nEnd Sub\n</code></pre>\n\n<p>Notice this code doesn't clear the source contents until after it's been copied.</p>\n\n<p>Also notice it doesn't need <code>Select</code> or <code>Activate</code> :)</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 11301508, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157606605643465/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/11301508/jens"}, "is_accepted": false, "score": 1, "last_activity_date": 1558554583, "creation_date": 1558554583, "answer_id": 56263998, "question_id": 56262454, "link": "https://stackoverflow.com/questions/56262454/possible-to-paste-content-into-a-sheet-thats-not-active/56263998#56263998", "title": "Possible to paste content into a sheet that&#39;s not active?", "body": "<p>I finally got it to work! Thanks everyone! This is the code that did the trick:</p>\n\n<pre><code>sub pastecontent()\nSheets(\"privata\").UsedRange.ClearContents\nSheets(\"privata\").Range(\"A1\").PasteSpecial xlPasteAll\nend sub\n</code></pre>\n\n<p>So simple!\nThanks again! :)\n/Jens</p>\n"}], "owner": {"reputation": 123, "user_id": 11301508, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157606605643465/picture?type=large", "display_name": "Jens", "link": "https://stackoverflow.com/users/11301508/jens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558554583, "creation_date": 1558547704, "last_edit_date": 1558551630, "question_id": 56262454, "link": "https://stackoverflow.com/questions/56262454/possible-to-paste-content-into-a-sheet-thats-not-active", "title": "Possible to paste content into a sheet that&#39;s not active?", "body": "<p>I need to paste some data into a sheet in Excel that's not active. Is that possible? </p>\n\n<p>Every ten seconds content is copied from a different program (not excel) thanks to a script. I then need to paste the content into a background sheet in an excel workbook but I don't want the screen to flash every time, activating the background sheet where the data goes and then back to the main sheet.</p>\n\n<p>The content is already in the clipboard when the macro is started. </p>\n\n<p>This is the current code which works but make the screen flash.</p>\n\n<pre><code>Sub pastecontent()\nSheets(\"searchresult\").UsedRange.ClearContents\nSheets(\"searchresult\").select\nActiveSheet.PasteSpecial Format:=\"Unicode-text\", Link:=False, _\nDisplayAsIcon:=False, NoHTMLFormatting:=True\nSheets(\"Show\").Select\nEnd Sub\n</code></pre>\n\n<p>This is what I want</p>\n\n<pre><code>Sub pastecontent()\nSheets(\"searchresult\").UsedRange.ClearContents\nSheets(\"searchresult\").PasteSpecial Format:=\"Unicode-text\", Link:=False,   \nDisplayAsIcon:=False, NoHTMLFormatting:=True\nEnd Sub\n</code></pre>\n\n<p>Is it possible?\n/Jens</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1558547304, "post_id": 56262327, "comment_id": 99141167, "body": "Are you sure the Activesheet is the correct sheet?  Try replacing it with the actual sheet reference: <code>firstRow = WorkSheets(&quot;Sheet1&quot;).Evaluate(...</code> Changing <code>Sheet1</code> to the correct sheet name."}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1558547521, "post_id": 56262327, "comment_id": 99141263, "body": "@ScottCraner Hey Scott sorry that didn&#39;t change anything."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1558547709, "post_id": 56262327, "comment_id": 99141327, "body": "I assume you have a <code>On Error Resume Next</code> in your code.  That line errors for me."}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1558547810, "post_id": 56262327, "comment_id": 99141376, "body": "Ah yes I do have that..."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1558548165, "post_id": 56262327, "comment_id": 99141526, "body": "Based on the formula provided in your <code>Evaluate</code> method, it looks like you want the row number of the second row that has a populated cell in column K, is that correct?"}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1558548212, "post_id": 56262327, "comment_id": 99141547, "body": "@tigeravatar yes that is correct.  The error I get when I remove <code>On Error Resume Next</code> is <code>Object Required</code>"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1558548223, "creation_date": 1558548223, "answer_id": 56262572, "question_id": 56262327, "link": "https://stackoverflow.com/questions/56262327/how-to-set-a-variable-using-evaluate/56262572#56262572", "title": "How to set a variable using .Evaluate()", "body": "<p>First it is <code>ActiveSheet</code> and second you need to double the <code>\"</code></p>\n\n<pre><code>firstRow = Activesheet.Evaluate(\"SMALL(IF($K:$K&lt;&gt;\"\"\"\", ROW($K:$K) - ROW($K$1) + 1), 2)\")\n</code></pre>\n\n<p>Notes:</p>\n\n<ol>\n<li>The  <code>- ROW($K$1) + 1</code> is not needed with full column references.</li>\n<li>Do not use <code>On Error Resume Next</code> unless absolutely needed.  And then turn the error capture back on with <code>On Error Goto 0</code> as soon as possible to catch the errors so they can be dealt with.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1558549534, "post_id": 56262692, "comment_id": 99142146, "body": "This. <code>Evaluate</code> is VBA telling Excel &quot;you deal with it&quot; - and that&#39;s rarely a good idea in code. Use the object model whenever possible (it&#39;s likely ~99.99999% always possible)."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 2, "last_activity_date": 1558548740, "creation_date": 1558548740, "answer_id": 56262692, "question_id": 56262327, "link": "https://stackoverflow.com/questions/56262327/how-to-set-a-variable-using-evaluate/56262692#56262692", "title": "How to set a variable using .Evaluate()", "body": "<p>Generally speaking, using the Evaluate method with whole column references is quite taxing.  I know it's often tempting to use one-liners for code, but that usually just worsens performance.  To accomplish this same task, I recommend the Range.Find method instead, and it will be less prone to errors:</p>\n\n<pre><code>Sub RangeFindMethod()\n\n    Dim rFind As Range\n    Dim firstRow As Long\n\n    With ActiveSheet.Columns(\"K\")\n        Set rFind = .Find(\"*\", .Cells(.Cells.Count), xlValues, xlWhole, , xlNext)\n        If Not rFind Is Nothing Then\n            Set rFind = .FindNext(rFind)\n            firstRow = rFind.Row\n        Else\n            firstRow = 1\n        End If\n    End With\n\n    MsgBox firstRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 56262572, "answer_count": 2, "score": 0, "last_activity_date": 1558548740, "creation_date": 1558547179, "question_id": 56262327, "link": "https://stackoverflow.com/questions/56262327/how-to-set-a-variable-using-evaluate", "title": "How to set a variable using .Evaluate()", "body": "<p>I want to find the nth populated row in a column in excel and I have a formula that works when I just test it out in the actual spreadsheet.  But I'd like to set that value to a variable in a macro using <code>.Evaluate()</code>.</p>\n\n<p>After I say <code>Dim firstRow As Long</code>, <code>firstRow = 0</code></p>\n\n<p>After I say:</p>\n\n<p><code>firstRow = ActiveWorksheet.Evaluate(\"SMALL(IF($K:$K&lt;&gt;\"\", ROW($K:$K) - ROW($K$1) + 1), 2)\")</code></p>\n\n<p><code>firstRow</code> still set to 0.</p>\n\n<p>How do I get the variable to equal the value of the formula evaluation?</p>\n\n<p>I've tried adding <code>.Select</code> after the evaluate, I've tried changing firstRow to a <code>Variant</code> and those didn't work.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1558547704, "post_id": 56261954, "comment_id": 99141322, "body": "Find the &quot;^p and delete it.  Move left one character and insert a &quot;."}], "answers": [{"tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": false, "score": 0, "last_activity_date": 1558550120, "creation_date": 1558550120, "answer_id": 56263009, "question_id": 56261954, "link": "https://stackoverflow.com/questions/56261954/remove-paragraph-mark-from-last-line-in-a-bulleted-on-numbered-list-without-brea/56263009#56263009", "title": "Remove paragraph mark from last line in a bulleted on numbered list without breaking the last bullet/number", "body": "<p>If you remove the paragraph mark before the closing quotation marks the last paragraph of the list will inherit the formatting of the paragraph that follows it.</p>\n\n<p>If the list has been formatted using a numbered style you can apply that style to the paragraph containing the quotes before deleting the paragraph mark before it.</p>\n\n<p>If not it will be more difficult for you. You could try adding the quote marks to the last paragraph of the list then deleting the final paragraph, but that may not work if it is the final paragraph in the document.</p>\n"}, {"comments": [{"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1558935885, "post_id": 56277850, "comment_id": 99248908, "body": "I&#39;ve used the <code>Range</code> one, works very well. It&#39;s nice how you can get multiple approaches for one issue.   I&#39;ve adapted it to execute it for each occurrence of <code>&quot;^p&quot; &amp; ChrW(8220)</code>"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1558623032, "creation_date": 1558623032, "answer_id": 56277850, "question_id": 56261954, "link": "https://stackoverflow.com/questions/56261954/remove-paragraph-mark-from-last-line-in-a-bulleted-on-numbered-list-without-brea/56277850#56277850", "title": "Remove paragraph mark from last line in a bulleted on numbered list without breaking the last bullet/number", "body": "<p>There are various ways this could be done; it's mostly a matter of personal preference, which approach is used. Here are two. One uses a Wildcard Find with Replacement; the other manipulates the <code>Range</code> objects. The first probably executes faster (although that wouldn't be noticeable in this context) and leaves only one \"footprint\" in Word's Undo list.</p>\n\n<p>Note: I prefer working with a <code>Range</code> rather than <code>Selection</code>. The first option could be done with <code>Selection</code>; the second is better with a <code>Range</code>.</p>\n\n<ol>\n<li>Does a wildcard search on a paragraph mark plus the quote. Notice that each term is within parentheses: These make it possible to work with the term in the Replacement - the parentheses define <em>expressions</em>. </li>\n</ol>\n\n<p>This makes it possible to reverse the information as the Replacement: the quote comes before the paragraph mark - the paragraph mark remains intact (the bullets are not lost).</p>\n\n<pre><code>Sub TestFindParaAndQuote()\n    Dim rngFind As Word.Range\n\n    Set rngFind = ActiveDocument.content\n    rngFind.Find.ClearFormatting\n    With rngFind.Find\n        .Text = \"(^13)(\" &amp; ChrW(8220) &amp; \")\"\n        .Replacement.Text = \"\\2\\1\"\n        .Forward = True\n        .wrap = wdFindStop\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = True\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        .Execute Replace:=wdReplaceOne\n    End With\n\nEnd Sub\n</code></pre>\n\n<ol start=\"2\">\n<li>When a <code>Find.Execute</code> is successful, the <code>Range</code> (or <code>Selection</code>) moves to the found term. Here, if <code>bFound = True</code> then: 1) the quote is inserted before the <code>Range</code>; 2) the <code>Range</code> is collapsed to its end-point (after the original quote); 3) then extended backwards to include that quote; 4) and the entire <code>Range</code> deleted. (The following line, which is commented out, can be included if the paragraph following the original quote should also be deleted.)</li>\n</ol>\n\n<p>This example is useful for understanding how to work with <code>Find</code> when standard Find/Replace can't do the job for some reason.</p>\n\n<pre><code>Sub TestFindParaAndQuote()\n    Dim rngFind As Word.Range\n    Dim bFound As Boolean\n\n    Set rngFind = ActiveDocument.content\n    rngFind.Find.ClearFormatting\n    With rngFind.Find\n        .Text = \"^p\" &amp; ChrW(8220)\n        .Forward = True\n        .wrap = wdFindStop\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        bFound = .Execute\n        If bFound Then\n            rngFind.InsertBefore ChrW(8220)\n            rngFind.Collapse wdCollapseEnd\n            rngFind.MoveStart wdCharacter, -1\n            'rngFind.MoveEnd wdCharacter, 1 'use this, too, if the paragraph mark should be removed\n            'rngFind.Select                 'for testing purposes\n            rngFind.Delete\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 56277850, "answer_count": 2, "score": 2, "last_activity_date": 1558623032, "creation_date": 1558545449, "last_edit_date": 1558548597, "question_id": 56261954, "link": "https://stackoverflow.com/questions/56261954/remove-paragraph-mark-from-last-line-in-a-bulleted-on-numbered-list-without-brea", "title": "Remove paragraph mark from last line in a bulleted on numbered list without breaking the last bullet/number", "body": "<p>I have a numbered list in Word and, after each entry, there is a paragraph mark. In the end, after the paragraph mark, there's a quote mark <code>\u201d</code>. I want to remove the last paragraph mark from the numbered list, in order to put the quote mark next to the last line of the numbered list. However, using Find and Replace for <code>\"^p\" &amp; ChrW(8220)</code> removes the paragraph but also removes the numbering for the last entry. </p>\n\n<p>I have managed to do a workaround by selecting the quote mark, moving left one character and then deleting one character. However, it's inconsistent and I don't trust it to be reliable.</p>\n\n<pre><code>  Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = ChrW(8220)\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute\n    Selection.MoveLeft Unit:=wdCharacter, Count:=1\n    Selection.TypeBackspace\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ttYDP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ttYDP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there another way to to put the quotation next to the last entry without breaking the numbering?</p>\n"}, {"tags": ["excel", "vba", "find", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 8205652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0176cbc83d75820457addf210b5ebb60?s=128&d=identicon&r=PG&f=1", "display_name": "madmiddle", "link": "https://stackoverflow.com/users/8205652/madmiddle"}, "edited": false, "score": 0, "creation_date": 1558545025, "post_id": 56261531, "comment_id": 99140218, "body": "could you move the search to a function ?"}, {"owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "reply_to_user": {"reputation": 151, "user_id": 8205652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0176cbc83d75820457addf210b5ebb60?s=128&d=identicon&r=PG&f=1", "display_name": "madmiddle", "link": "https://stackoverflow.com/users/8205652/madmiddle"}, "edited": false, "score": 0, "creation_date": 1558545172, "post_id": 56261531, "comment_id": 99140279, "body": "You can move any piece of code to a function, it would just depend on how you want it to work with the parameters/arugments you provide it."}], "tags": [], "owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "is_accepted": false, "score": 0, "last_activity_date": 1558544820, "last_edit_date": 1558544820, "creation_date": 1558543431, "answer_id": 56261531, "question_id": 56261421, "link": "https://stackoverflow.com/questions/56261421/search-for-string-inside-another-workbook/56261531#56261531", "title": "Search for string inside another workbook", "body": "<p>Something like the below would be able to easily search for a specific string.</p>\n\n<pre><code>Dim wkb As Workbook\nDim wks As Worksheet\nSet wkb = Excel.Workbooks.Open(filename:=FolderPath, ReadOnly:=True)\nSet wks = wkb.Sheets(1)\n\nDim Raange As Range\nDIm MyValueIWantRange As Range\n\nSet Raange = wks.Range(\"b1:bz1000\")\n\nWith Raange\n    Set MyValueIWantRange = .Find(ValueYouWantToLookFor, , xlValues, xlWhole, xlByRows, , True)\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 8205652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0176cbc83d75820457addf210b5ebb60?s=128&d=identicon&r=PG&f=1", "display_name": "madmiddle", "link": "https://stackoverflow.com/users/8205652/madmiddle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558544820, "creation_date": 1558542930, "last_edit_date": 1558543147, "question_id": 56261421, "link": "https://stackoverflow.com/questions/56261421/search-for-string-inside-another-workbook", "title": "Search for string inside another workbook", "body": "<p>I'm trying to use a function to see, if data has been entered before.</p>\n\n<p>The log number is what i'm trying to find in the WB that is to be open. It is in the format of \"CQE0099340\". The workbook with this code has all these codes in column A. The WB I'm trying to read has them in column B: </p>\n\n<pre><code>Option Explicit\nPublic WS1 As Worksheet\n\nSub Import_Sheet()\n    Dim WB1 As Workbook\n    Dim WB2 As Workbook\n\n    'Dim WS1 As Worksheet\n    Dim WS2 As Worksheet\n    Dim WS3 As Worksheet\n\n    Dim fileDir, fileDest As String\n    Dim fso As Object\n    Dim objFiles As Object\n    Dim obj As Object\n    Dim lngFileCount As Long\n    Dim lRow1, lRow2 As Long\n    Dim newData, existData As Range\n\n    'Dim rngSheetDate As Range\n\n    'Application.ScreenUpdating = False\n    'Application.DisplayAlerts = False\n\n    'Set the worksheets that are going to be used.\n    Set WB1 = ThisWorkbook\n    Set WS1 = WB1.Sheets(\"Data\")\n    Set WS2 = WB1.Sheets(\"Info\")\n    WS1.Select\n\n    'Set the variables that are going to be used\n    If Right(WS2.Cells(2, 8).Value, 1) &lt;&gt; \"\\\" Then\n        WS2.Cells(2, 8).Value = WS2.Cells(2, 8).Value &amp; \"\\\"\n    End If\n    fileDir = WS2.Cells(2, 8).Value\n\n    'Set the archive folder to store the processed files\n    fileDest = fileDir &amp; \"Archive\\\"\n\n    If Dir(fileDest, vbDirectory) = \"\" Then\n        MkDir Path:=fileDest\n\n    End If\n\n    ' Fire up the file system code to be used for the searching of the files and moving/deleting later on in the code\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFiles = fso.GetFolder(fileDir).Files\n    'Set strFileBaseName = CreateObject(\"VBScript.RegExp\")\n\n    ' Make sure there is some files on the server to be processed\n    lngFileCount = objFiles.Count\n    If lngFileCount &gt; 0 Then\n\n        For Each obj In objFiles    'For every file that is on the server do the following code\n\n            On Error Resume Next\n\n            Set WB2 = Workbooks.Open(obj, False, True)  'Open the first file on the server and then set WS3 which is the first sheet (doesn't matter what it is called)\n            Set WS3 = WB2.Sheets(1)\n\n            WS3.Columns(\"A:AA\").Sort key1:=Range(\"B2\"), order1:=xlAscending, Header:=xlYes  'Sort the rows based on the data in column B\n\n            lRow1 = WS3.Cells(Rows.Count, \"B\").End(xlUp).Row\n            lRow2 = WS1.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n            Set newData = WS3.Range(\"B2\", \"B\" &amp; lRow1)\n\n            Set existData = WS1.Range(\"A2\", \"A\" &amp; lRow2)\n\n            Import_Data newData, existData\n\n            WB2.Close False\n\n            'fso.MoveFile Source:=obj.Path, Destination:=fileDest &amp; obj.Name\n\n        Next obj\n\n    Else\n\n        ' There was no files in the folder\n        MsgBox \"No files were found in folder:\" &amp; vbLf &amp; vbLf &amp; fileDir, vbOKOnly + vbInformation\n\n    End If\n\n    'Application.ScreenUpdating = True\n    'Application.DisplayAlerts = True\n\nEnd Sub\n\nSub Import_Data(chatRange, oldData)\n    'Dim newData As Range\n    Dim cell As Range\n\n    For Each cell In chatRange\n\n        If Not IsError(Application.Match(cell.Value, oldData, 0)) Then\n            '// Value found\n            MsgBox \"hello\"\n        End If\n\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1558543286, "post_id": 56261324, "comment_id": 99139460, "body": "<code>Dim</code> only makes that variable available to the module the variable is located in (assuming the variable is declared at the top of the code module).  So if your <code>PIXEL_DATA</code> is declared in <code>Module1</code> but you&#39;re trying to access it from, say, a userform, then you&#39;ll get that error.  If you want it to be truly global, change <code>Dim</code> to <code>Public</code>.  Generally speaking though, public variables are best avoided where possible, though there are circumstances where their use is warranted."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558549784, "post_id": 56261324, "comment_id": 99142260, "body": "<code>Dim</code> is always local. Avoid confusion, keep <code>Dim</code> for local variables, and use <code>Private</code> for module-level variables; use <code>Public</code> to declare globals... <i>if</i> you really need a global variable (most likely, you don&#39;t) - consider using parameters instead."}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1558543712, "last_edit_date": 1558543712, "creation_date": 1558543338, "answer_id": 56261511, "question_id": 56261324, "link": "https://stackoverflow.com/questions/56261324/vba-array-definition-does-not-work-for-global-definitions/56261511#56261511", "title": "VBA ARRAY definition does not work for global definitions", "body": "<p>You're missing the key component of <em>where</em> you're <code>Dim</code>ing <code>PIXEL_DATA()</code>. Here's an example:</p>\n\n<pre><code>Sub MainSub()\n\n   Dim PIXEL_DATA() As Variant\n   PIXEL_DATA = Array(1, 2, 3, 4, 5)\n   Call OtherSub\n\nEnd Sub\nSub OtherSub()\n\n    Dim Ptr As Long\n    Ptr = PIXEL_DATA(2)\n    Debug.Print Ptr\n\nEnd Sub\n</code></pre>\n\n<p>Running <code>MainSub()</code> will resulting in a compile error highlighting <code>OtherSub()</code> because <code>PIXEL_DATA()</code> is out of scope. But moving <code>PIXEL_DATA()</code> to the <strong>modular</strong> level compiles, runs and returns 3 to the immediate window as expected:</p>\n\n<pre><code>Dim PIXEL_DATA() As Variant\nSub MainSub()\n\n   PIXEL_DATA = Array(1, 2, 3, 4, 5)\n   Call OtherSub\n\nEnd Sub\nSub OtherSub()\n\n    Dim Ptr As Long\n    Ptr = PIXEL_DATA(2)\n    Debug.Print Ptr\n\nEnd Sub\n</code></pre>\n\n<p>If your <code>OtherSub()</code> is in an entire other module, then you'll need to declare is as <code>Public</code> like @tigeravatar mentioned above.</p>\n"}], "owner": {"reputation": 1, "user_id": 7451604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fa723311512e8f17ffc5bae6acf4673?s=128&d=identicon&r=PG&f=1", "display_name": "Lingo", "link": "https://stackoverflow.com/users/7451604/lingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558543712, "creation_date": 1558542585, "last_edit_date": 1558542931, "question_id": 56261324, "link": "https://stackoverflow.com/questions/56261324/vba-array-definition-does-not-work-for-global-definitions", "title": "VBA ARRAY definition does not work for global definitions", "body": "<p>I define PIXEL_DATA as a global with</p>\n\n<pre><code>Dim PIXEL_DATA() As Variant\n</code></pre>\n\n<p>I initialize it using the ARRAY function in a subroutine.  And while I am in that subroutine, PIXEL_DATA has the appropriate data in it.</p>\n\n<p>But when I try to access from another subroutine</p>\n\n<pre><code> Ptr = PIXEL_DATA(2)\n</code></pre>\n\n<p>I get \"PIXEL_DATA\" blued out and the error message \"Compiler Error: Not a Sub or Function not defined\".</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["sql", "excel", "vba", "csv", "ado"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1558542372, "post_id": 56260993, "comment_id": 99139057, "body": "There&#39;s not a lot of great options here. You can use (I believe) a schema.ini file to explain the schema of the csv so <code>jet</code> doesn&#39;t have to guess. I&#39;ve also read that you can monkey in registry to tell the driver to scan the entire file (instead of a sample) to determine data types by setting <code>HKey_Local_Machine\\Software\\Microsoft\\Jet\\4.0\\Engines\\Text\\M&zwnj;&#8203;axScanRows</code> to 0."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1558543629, "post_id": 56260993, "comment_id": 99139589, "body": "Also, and this is ridiculous, but if you are desperate.... I&#39;ve opened the file and injected fake data into the first 10 or so rows. That fake data contains formats that cause the engine to determine the correct data type. I then filter those records out in the <code>WHERE</code> clause. Again, it&#39;s ridiculous, but it will get you out of registry edits and schema.ini file writing and maintenance if you are needing to distribute the application."}, {"owner": {"reputation": 11, "user_id": 11540024, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mgkza27_EOw/AAAAAAAAAAI/AAAAAAAAABM/s9Q09s8DFC0/photo.jpg?sz=128", "display_name": "Austin G", "link": "https://stackoverflow.com/users/11540024/austin-g"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1558551471, "post_id": 56260993, "comment_id": 99142985, "body": "I just tried using a Schema.ini file and that works; thanks for the response.  Since the application will be distributed and there are multiple csv files in the source directory, I&#39;m thinking of having the VBA code write an ini file, run the query, and then delete the ini file."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1558555416, "post_id": 56260993, "comment_id": 99144740, "body": "I answered a similar question to this before. Maybe it will help. <a href=\"https://stackoverflow.com/a/54183499/4839827\">stackoverflow.com/a/54183499/4839827</a>"}], "owner": {"reputation": 11, "user_id": 11540024, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mgkza27_EOw/AAAAAAAAAAI/AAAAAAAAABM/s9Q09s8DFC0/photo.jpg?sz=128", "display_name": "Austin G", "link": "https://stackoverflow.com/users/11540024/austin-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 397, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1559123903, "creation_date": 1558541270, "last_edit_date": 1559123903, "question_id": 56260993, "link": "https://stackoverflow.com/questions/56260993/excel-vba-sql-query-of-csv-file-is-returning-integer-instead-of-double", "title": "Excel VBA: SQl query of csv file is returning integer instead of double", "body": "<p>In Excel, I have VBA code that uses ADO to create a query for a csv file.  The query returns some select fields into a Recordset, which I then extract the data I need for a report.  The field contains string and numerical values.</p>\n\n<p>The code works fine whenever the first numerical value in the field is a double, but if the value is an integer all numerical values are converted to integers, which doesn't give me the results I want.</p>\n\n<p>Here is how I set up the query and get the Recordset:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Function getRecordSet(ByVal fileSource As String, ByVal fileName As String) As ADODB.Recordset\n\n    Dim con As New ADODB.Connection\n    Dim cmd As New ADODB.command\n    Dim rs As ADODB.Recordset\n\n    'set up connection to file source\n    con.Provider = \"Microsoft.Jet.OLEDB.4.0\"\n    con.ConnectionString = _\n        \"Data Source=\" &amp; fileSource &amp; \";\" &amp; _\n        \"Extended Properties=\"\"text; HDR=Yes; FMT=Delimited; IMEX=1;\"\"\"\n    con.Open\n    con.CursorLocation = adUseClient\n    cmd.ActiveConnection = con\n\n    'set up and execute query\n    cmd.CommandText = _\n        \"SELECT [Total Test Timer], [Stage], [Corrected Blowby] \" &amp; _\n        \"FROM \" &amp; fileName &amp; \" \" &amp; _\n        \"WHERE [Stage] = 1\"\n    Set rs = cmd.Execute\n\n    'disconnect the record set from the file source\n    rs.ActiveConnection = Nothing\n\n    'clean up ADO objects\n    Set cmd = Nothing\n    If Not con Is Nothing Then\n        If con.State = adStateOpen Then con.Close\n        Set con = Nothing\n    End If\n\n    'return Recordset\n    Set getRecordSet = rs\n\nEnd Function\n</code></pre>\n\n<p>Here is a sample dataset where the code works as expected (The field where the error occurs is 'Corrected Blowby':</p>\n\n<pre><code>Total Test Timer,Stage,Corrected Blowby\n,,LPM\n,,SC1Mod4/ai25\n1.04167,1,21.85\n1.05,1,21.85\n1.05833,1,35.48\n1.06667,1,35.48\n1.075,1,35.48\n1.08333,1,35.48\n1.09167,1,35.48\n</code></pre>\n\n<p>And here is a sample dataset where all the numerical values are converted to integers:</p>\n\n<pre><code>Total Test Timer,Stage,Corrected Blowby\n,,LPM\n,,SC1Mod4/ai25\n1.025,1,0\n1.03333,1,0\n1.04167,1,0\n1.05,1,0\n1.05833,1,21.43\n1.06667,1,21.43\n1.075,1,21.43\n</code></pre>\n\n<p>I've tried casting the 'Corrected Blowby' field into a string and a double:</p>\n\n<pre><code>\"SELECT [Total Test Timer], [Stage], cStr([Corrected Blowby]) AS newField \" &amp; _\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>\"SELECT [Total Test Timer], [Stage], cDbl([Corrected Blowby]) AS newField \" &amp; _\n</code></pre>\n\n<p>but neither worked.  Does anyone have any advice on how to proceed?  Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558546345, "post_id": 56260958, "comment_id": 99140798, "body": "Please edit your code to add the debug.print outputs"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558546495, "post_id": 56260958, "comment_id": 99140851, "body": "You haven&#39;t closed either of the new files you created by saving <code>GlobalFile</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1558547896, "post_id": 56260958, "comment_id": 99141423, "body": "If a workbook with the same name as the one you&#39;re trying to open is already open, and you&#39;re trying to set a workbook.object to the return value of the <code>Open()</code> method, then the end result can be unpredictable."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6253248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSdPD.jpg?s=128&g=1", "display_name": "Fiordiligi", "link": "https://stackoverflow.com/users/6253248/fiordiligi"}, "edited": false, "score": 0, "creation_date": 1558549124, "post_id": 56262538, "comment_id": 99141960, "body": "Thx! For me it seems that if I would open a file onto a same named file already open, Excel would at least throw an error... I see NightMareFile as a brand new Reference to a freshly opened file. Excel indeed opens it, and says on the Excel window header: Ume.xlsx. And the name is Glo. I tis difficult for me to believe Excel lets me do something leading to this contradiction."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 33, "user_id": 6253248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSdPD.jpg?s=128&g=1", "display_name": "Fiordiligi", "link": "https://stackoverflow.com/users/6253248/fiordiligi"}, "edited": false, "score": 0, "creation_date": 1558549164, "post_id": 56262538, "comment_id": 99141981, "body": "I think it&#39;s possible a lot of people get caught out by this, and it&#39;s definitely something you&#39;d expect to raise an error or warning, rather than just return a &quot;random&quot; other workbook to your variable."}, {"owner": {"reputation": 33, "user_id": 6253248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSdPD.jpg?s=128&g=1", "display_name": "Fiordiligi", "link": "https://stackoverflow.com/users/6253248/fiordiligi"}, "edited": false, "score": 0, "creation_date": 1558552095, "post_id": 56262538, "comment_id": 99143237, "body": "Thank You Tim!  Closing GlobalFile after the last Save.As seems to solve the problem, or at least I am on track now to finish my project."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1558549057, "last_edit_date": 1558549057, "creation_date": 1558548060, "answer_id": 56262538, "question_id": 56260958, "link": "https://stackoverflow.com/questions/56260958/why-is-freshly-opened-workbook-name-different-from-workbook-title-in-excel-windo/56262538#56262538", "title": "Why is freshly opened Workbook.Name different from Workbook title in Excel window?", "body": "<p>If a workbook with the same name as the one you're trying to open is already open, and you're trying to assign a workbook object variable to the return value of the <code>Open()</code> method, then the end result can be unpredictable.</p>\n\n<p>For example - if I run this with both workbooks \"Glo\" and \"Ume\" already open:</p>\n\n<pre><code>Sub main_control_routine()\n\n    Dim wb As Workbook\n\n    Set wb = Workbooks.Open(\"Glo.xlsx\", False)\n    Debug.Print wb.Name\n\n    Set wb = Workbooks.Open(\"Ume.xlsx\", False)\n    Debug.Print wb.Name\n\n    Set wb = Workbooks.Open(\"Glo.xlsx\", False)\n    Debug.Print wb.Name\n\n    Set wb = Workbooks.Open(\"Ume.xlsx\", False)\n    Debug.Print wb.Name\n\nEnd Sub\n</code></pre>\n\n<p>...this is the output:</p>\n\n<pre><code>Ume.xlsx\nUme.xlsx\nUme.xlsx\nUme.xlsx\n</code></pre>\n\n<p>Not what you'd expect. </p>\n\n<p>In my testing it looks like instead of getting the intended workbook it returns a reference to the last-opened workbook.</p>\n\n<p>The fix would be to always check if the workbook is already open before using <code>Workbooks.Open()</code> to get a reference to it.</p>\n"}], "owner": {"reputation": 33, "user_id": 6253248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eSdPD.jpg?s=128&g=1", "display_name": "Fiordiligi", "link": "https://stackoverflow.com/users/6253248/fiordiligi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 1, "accepted_answer_id": 56262538, "answer_count": 1, "score": 2, "last_activity_date": 1558549057, "creation_date": 1558541124, "last_edit_date": 1558541967, "question_id": 56260958, "link": "https://stackoverflow.com/questions/56260958/why-is-freshly-opened-workbook-name-different-from-workbook-title-in-excel-windo", "title": "Why is freshly opened Workbook.Name different from Workbook title in Excel window?", "body": "<p>I have created a file and referenced it as <code>GlobalFile</code>.<br>\nThen I saved it as \"Glo\" and then as \"Ume\". Then I reopen the saved files to have two distinct workbooks open on two different names in two different Workbook objects: <code>GlobalFile</code> and <code>NightMareFile</code>.</p>\n\n<p>After opening, Excel windows has the correct headers as \"Glo.xls\" and \"Ume.xls\" respectively, but testing <code>NightMareFile.Name</code> results in \"Glo.xlsx\" !!!</p>\n\n<p>How is this possible at all?</p>\n\n<hr>\n\n<p>I'm on Win 10 64 bit, Excel 365 16 bit.</p>\n\n<p>Already tried:</p>\n\n<ul>\n<li>DoEvents before or after Open</li>\n<li>RefreshAll after open</li>\n<li>Excel restart brought no change.</li>\n</ul>\n\n<p>What makes me pull my hair: Changing the order of the two open blocks fixes the name conflict: if \"Ume\" is opened first it has the correct name, as does \"Glo\".</p>\n\n<p>Originally I had more named file versions saved and reopened, but only this one was always faulty, hence the new name: NightMareFile. No matter how I changed the order of files to open, this one always inherited the name of the file opened before him into another object variable.</p>\n\n<pre><code>Option Explicit\n\nSub main_control_routine()\n\n    Dim GlobalFile As Workbook\n    Dim NightMareFile As Workbook\n\n    Set GlobalFile = Workbooks.Add\n    Debug.Print \"GlobalFile.Name: \" &amp; GlobalFile.Name\n\n    Application.DisplayAlerts = False\n\n    GlobalFile.SaveAs Filename:=\"Glo\"\n    Debug.Print \"GLOBAL File ready!\"\n\n    'GlobalFile save as Ume\n    GlobalFile.SaveAs Filename:=\"Ume\"\n    Debug.Print \"GlobalFile.Name: As Ume \" &amp; GlobalFile.Name\n\n    Application.DisplayAlerts = True\n\n    'GLOBAL reopened to GlobalFile\n    Set GlobalFile = Workbooks.Open(\"Glo\", False)\n    Debug.Print \"GlobalFile.Name: \" &amp; GlobalFile.Name\n\n    'Ume reopened to NightMareFile\n    Set NightMareFile = Workbooks.Open(\"Ume\", False)\n    Debug.Print \"NightMareFile.Name: \" &amp; NightMareFile.Name\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1558541239, "post_id": 56260957, "comment_id": 99138440, "body": "<code>&quot;a&quot;</code> is not a valid range reference. How do you want to call this function, from the worksheet or within code?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1558542452, "post_id": 56260957, "comment_id": 99139103, "body": "Is &quot;a&quot; a named range?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1558544163, "post_id": 56260957, "comment_id": 99139870, "body": "If I understand what you&#39;re trying to do, I think you just need to change those statements to <code>a.ClearContents</code> and <code>a.Activate</code> to achieve what you want."}, {"owner": {"reputation": 5, "user_id": 11493149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s8wIU8JR8fw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyCKv2uVz1WMfLNMHc4-5zLoywYQ/mo/photo.jpg?sz=128", "display_name": "Noam Marciano", "link": "https://stackoverflow.com/users/11493149/noam-marciano"}, "edited": false, "score": 0, "creation_date": 1558546794, "post_id": 56260957, "comment_id": 99140959, "body": "a it&#39;s the variable within the function - the user&#39;s choose."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1558546851, "post_id": 56260957, "comment_id": 99140981, "body": "Your <code>Function</code> isn&#39;t returning anything and might as well be a <code>Sub</code> procedure. Are you trying to invoke it as a UDF, from a worksheet cell (e.g. <code>=cts(A1)</code>)? If so, you can&#39;t do that - a UDF takes inputs and computes a value that is returned to the cell that invokes it: it is not alowed to alter other cells or <code>Activate</code> anything. Lastly, <code>Range(&quot;a&quot;)</code> should simply be <code>a</code> - and <code>a</code> should be declared <code>ByVal a As Range</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 11493149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s8wIU8JR8fw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyCKv2uVz1WMfLNMHc4-5zLoywYQ/mo/photo.jpg?sz=128", "display_name": "Noam Marciano", "link": "https://stackoverflow.com/users/11493149/noam-marciano"}, "edited": false, "score": 0, "creation_date": 1558547911, "post_id": 56262348, "comment_id": 99141427, "body": "i declared &quot;a&quot; byval, and tried a.clearcontents and activate - it&#39;s still not working."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5, "user_id": 11493149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s8wIU8JR8fw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyCKv2uVz1WMfLNMHc4-5zLoywYQ/mo/photo.jpg?sz=128", "display_name": "Noam Marciano", "link": "https://stackoverflow.com/users/11493149/noam-marciano"}, "edited": false, "score": 0, "creation_date": 1558547931, "post_id": 56262348, "comment_id": 99141438, "body": "@NoamMarciano <code>As Range</code> is the important part. How are you invoking the function exactly?"}, {"owner": {"reputation": 5, "user_id": 11493149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s8wIU8JR8fw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyCKv2uVz1WMfLNMHc4-5zLoywYQ/mo/photo.jpg?sz=128", "display_name": "Noam Marciano", "link": "https://stackoverflow.com/users/11493149/noam-marciano"}, "edited": false, "score": 0, "creation_date": 1558548266, "post_id": 56262348, "comment_id": 99141570, "body": "not working mean that the message are show up, but the clear and activate hasn&#39;t.    Public Function cts(ByVal a As Range) As Range      If IsEmpty(a.Value) Then          MsgBox (&quot;ok&quot;)      ElseIf IsNumeric(a.Value) = False Then          MsgBox &quot;non-numeric entry&quot;          a.ClearContents          a.Activate"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1558547914, "last_edit_date": 1558547914, "creation_date": 1558547261, "answer_id": 56262348, "question_id": 56260957, "link": "https://stackoverflow.com/questions/56260957/how-to-clear-and-activate-cell-as-variables/56262348#56262348", "title": "how to clear and activate cell as variables?", "body": "<p>That <code>a</code> parameter is a <code>Range</code> object - it should be declared as such:</p>\n\n<pre><code>Public Function cts(ByVal a As Range) As Range\n</code></pre>\n\n<p><code>IsEmpty</code> returns a <code>Boolean</code>; comparing it to a Boolean literal is redundant:</p>\n\n<blockquote>\n<pre><code>If IsEmpty(a.Value) = True Then\n</code></pre>\n</blockquote>\n\n<p>Should be:</p>\n\n<pre><code>If IsEmpty(a.Value) Then\n</code></pre>\n\n<p>The expression <code>(\"Ok\")</code> is uselessly being evaluated as a <code>String</code> value (it's <em>already</em> a string literal). <a href=\"https://stackoverflow.com/a/56261848/1188513\">Don't use parentheses when you discard a function's return value</a>:</p>\n\n<pre><code>MsgBox \"Ok\"\n</code></pre>\n\n<p><code>a</code> being a <code>Range</code> object, this:</p>\n\n<blockquote>\n<pre><code>Range(\"a\").ClearContents\nRange(\"a\").Activate\n</code></pre>\n</blockquote>\n\n<p>Probably means to be this (<code>\"a\"</code> isn't a valid cell reference, so <code>Range(\"a\")</code> can't be evaluated):</p>\n\n<pre><code>a.ClearContents\na.Activate\n</code></pre>\n\n<p>By declaring <code>a As Range</code>, you get <em>IntelliSense</em> and Ctrl+Space autocompletion for its member calls; in your code it's an implicit <code>Variant</code>, so the member calls are all resolved at run-time (and <code>Option Explicit</code> can't save you from a typo).</p>\n\n<p>The function isn't returning anything, and it's not clear what <code>Range</code> you mean it to return (or why).</p>\n\n<p>If you wanted it to return <code>a</code>, you would do it like this:</p>\n\n<pre><code>Set cts = a\n</code></pre>\n\n<p>If the procedure doesn't need to return anything, then it should be a <code>Sub</code> procedure, not a <code>Function</code>.</p>\n\n<blockquote>\n<pre><code>ElseIf Int(a.Value) = False Then\n</code></pre>\n</blockquote>\n\n<p>That <code>Int</code> function call will fail with a <em>type mismatch</em> error if <code>a.Value</code> contains a <code>Variant/Error</code> value, because the conditional block hasn't first evaluated whether <code>IsError(a.Value)</code> is true; also <code>= False</code> is coercing the <code>Integer</code> into a <code>Boolean</code>, so the expression will wrongly evaluate to <code>False</code> when <code>a.Value</code> is <code>0</code> (because zero is <code>False</code>, and any non-zero value is <code>True</code>). The <code>Int</code> function takes <code>123.456</code> and outputs <code>123</code>, i.e. it returns the integer portion of the value it's given - <em>it does not evaluate whether the argument is an integer or not</em>.</p>\n\n<p>In order to evaluate whether the value is an integer value, you need to first make  sure you're looking at a numeric value:</p>\n\n<pre><code>If IsNumeric(a.Value) Then\n</code></pre>\n\n<p>Then compare <code>Int(a.Value)</code> with <code>a.Value</code> and see if they are the same:</p>\n\n<pre><code>    If Int(a.Value) = a.Value Then\n</code></pre>\n\n<p>Make sure you put the <code>ElseIf a.Value &gt; 5 Or a.Value &lt; 1 Then</code> check inside the <code>IsNumeric</code> case, otherwise that condition too will blow up given an error value, because <code>Variant/Error</code> can't be compared to anythign other than an <code>Error</code> value.</p>\n"}], "owner": {"reputation": 5, "user_id": 11493149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s8wIU8JR8fw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyCKv2uVz1WMfLNMHc4-5zLoywYQ/mo/photo.jpg?sz=128", "display_name": "Noam Marciano", "link": "https://stackoverflow.com/users/11493149/noam-marciano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558547914, "creation_date": 1558541123, "question_id": 56260957, "link": "https://stackoverflow.com/questions/56260957/how-to-clear-and-activate-cell-as-variables", "title": "how to clear and activate cell as variables?", "body": "<p>I tried to clear and to activate cell by function, but it doesn't works.</p>\n\n<pre><code> Function cts(a) As Range\n If IsEmpty(a.Value) = True Then\n     MsgBox (\"ok\")\n ElseIf IsNumeric(a.Value) = False Then\n     MsgBox \"non-numeric entry\"\n     Range(\"a\").ClearContents\n     Range(\"a\").Activate\n ElseIf Int(a.Value) = False Then\n     MsgBox \"integer required\"\n     Range(\"a\").ClearContents\n     Range(\"a\").Activate\n ElseIf a.Value &gt; 5 Or a.Value &lt; 1 Then\n     MsgBox \"valid values are between 1 and 5\"\n     Range(\"a\").ClearContents\n     Range(\"a\").Activate\n Else:\n     MsgBox \"ok\"\n End If\n\n End Function\n</code></pre>\n\n<p>the msg is shows up, but not the clear nor the activate.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 237, "user_id": 11510566, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-otB1u3k6NRM/AAAAAAAAAAI/AAAAAAAAAA4/c9kr55k_34w/photo.jpg?sz=128", "display_name": "Love Coding", "link": "https://stackoverflow.com/users/11510566/love-coding"}, "edited": false, "score": 1, "creation_date": 1558542323, "post_id": 56260885, "comment_id": 99139031, "body": "maybe you need to change the code for the LastRow to get the last row from Column K instead of Column A. &quot;LastRow = ws.Range(&quot;K&quot; &amp; Rows.Count).End(xlUp).Row&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1558550505, "creation_date": 1558550505, "answer_id": 56263085, "question_id": 56260885, "link": "https://stackoverflow.com/questions/56260885/find-the-total-of-the-same-column-from-multiple-sheets-and-express-totals-next-t/56263085#56263085", "title": "Find the total of the same column from multiple sheets and express totals next to sheet name on new sheet", "body": "<p>Declared and fully use <code>ws</code> and <code>LastRow</code> variables. Not using can cause code to pull values from another worksheet. Per comment from @LoveCoding, using a different column as the <code>LastRow</code> can overwrite a cell in <code>Col K</code>. You should have used the <code>LastRow</code> variable, in the Sum function. </p>\n\n<pre><code>Dim ws As Worksheet, LastRow As Long\n\nFor Each ws In ThisWorkbook.Worksheets\n    LastRow = ws.Range(\"K\" &amp; ws.Rows.Count).End(xlUp).Row\n\n    ws.Range(\"K\" &amp; LastRow + 1) = Application.WorksheetFunction.Sum(ws.Range(\"K2:K\" &amp; LastRow))\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11505276, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157091681577095/picture?type=large", "display_name": "Thom Beaumont", "link": "https://stackoverflow.com/users/11505276/thom-beaumont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558550505, "creation_date": 1558540887, "last_edit_date": 1558540994, "question_id": 56260885, "link": "https://stackoverflow.com/questions/56260885/find-the-total-of-the-same-column-from-multiple-sheets-and-express-totals-next-t", "title": "Find the total of the same column from multiple sheets and express totals next to sheet name on new sheet", "body": "<p>I'm looking to create a macro that will display the Sum from a set column of each of multiple sheets. I need the total of column \"K\" to be shown 1 row from the last entry of a variable number of entries. It is a requirment that this is in VBA as it needs to run with a number of other functions.</p>\n\n<p>I've tried the below code but it does not give the expected result and seems to be drawing data from other sheets.</p>\n\n<pre><code>Sub SumWorksheets()\n\n    Dim LastRow As Long\n    Dim ws As Worksheet\n\n    For Each ws In Worksheets\n\n        LastRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n        ws.Range(\"K\" &amp; LastRow + 1) = Application.WorksheetFunction.Sum(Range(\"K2:K\" &amp; ws.Rows.Count))\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I want the Total of all numbers in Column \"K\" to display 2 rows below the last number in Row \"K\"</p>\n"}, {"tags": ["excel", "vba", "google-apps-script"], "comments": [{"owner": {"reputation": 34507, "user_id": 7215091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/2pNI4.jpg?s=128&g=1", "display_name": "MetaMan", "link": "https://stackoverflow.com/users/7215091/metaman"}, "edited": false, "score": 0, "creation_date": 1558549072, "post_id": 56260668, "comment_id": 99141940, "body": "This question is too broad and so is probably on it&#39;s way to getting closed.  One of the chief reasons is that it requires us to provide an opinion.  My opinion is too get your company to pay for some training in Javascript and Google Apps Script.  Hire a consultant to help you in the short run and have one of your employees take the time to learn it for themselves so they can train everyone else (who wish) for the long term.   You will also become a great resource for people who will be asking the same questions in the future."}], "owner": {"reputation": 19, "user_id": 11540275, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DYRBgKpa3tk/AAAAAAAAAAI/AAAAAAAAAEY/8aUf0UjCaqY/photo.jpg?sz=128", "display_name": "Tom Erickson", "link": "https://stackoverflow.com/users/11540275/tom-erickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1558541085, "creation_date": 1558540126, "last_edit_date": 1558541085, "question_id": 56260668, "link": "https://stackoverflow.com/questions/56260668/potential-google-script-equivalents-to-specific-vba-functions-such-as-sendkeys", "title": "Potential Google Script equivalents to specific VBA functions such as SendKeys", "body": "<p>My workplace is changing from Office 365 to GSuite.</p>\n\n<p>How can I successfully move the macros created in VBA to Apps Script. </p>\n\n<p>Almost all of the macros involve the functions <code>Sendkeys</code> and <code>Appactivate</code>, which I can't seem to find any Apps Script equivalents for.</p>\n\n<p>There is also a large amount of IE automation used for these macros.</p>\n\n<p>Here are some examples of my code in VBA, I'm looking to remake in Apps Script.</p>\n\n<pre><code>Sub RetrieveCounts()\n    Dim strBaseURL As String 'This is where Internet Explorer will go when it is launched\n    Dim rngA As Range 'This will store the range\n    Dim IE As InternetExplorerMedium 'This will be what actually controls internet explorer when it is launched\n    Dim sht As String 'This will store the sheet that is open\n    Dim user As String 'This will store the username\n    Dim pass As String 'This will store the password\n    Dim failure As Boolean 'This asks whether or not the receiver failed as a true and false value\n    Dim serialNumber As String 'This stores the serial number\n    Dim choppedString As String 'This stores the whole string as it is being chopped up for the RA reasons\n    Dim colon As Long 'This finds the colons in the string\n    Dim comma As Integer 'This finds the commas in the string\n    Dim jobType As String 'This gets the job type\n    Dim returnReason As String 'This stores the return reason\n    Dim techLog As String 'This stores the tehcs login ID\n    Dim techName As String 'This stores the techs name\n    Dim userName As String 'This stores the users name\n    Dim userOrg As String\n\n    Set clip = New MSForms.DataObject\n    userOrg = Sheets(4).Range(\"B6\").Value\n\n    Set IE = New InternetExplorerMedium 'Open up Internet explorer\n\n    strBaseURL = \"http://mnet.dish.com/Reports_interactive/DNS_ON_HAND_QTY.asp\" 'Set's what IE will go to once it is launched\n    With IE 'If something does not have an object that it is being run on, run on IE\n    .Visible = True 'makes IE visible so that you can see what is going on, setting to false will cause the window to not show up and not run properly\n    .Navigate strBaseURL 'Go to the webpage defined earlier\n    Application.Wait Now + #12:00:02 AM#\n    Do Until .Busy = False: DoEvents: Loop 'Repeat this line until the page is %100 loaded\n\n    For Each ietag In .Document.forms(\"theForm\").ORG.getElementsbyTagName(\"Option\") 'Find the org number in the webpage\n        If Left(ietag.outertext, 3) = userOrg Then\n            choppedString = (InStr(ietag.outerhtml, \"=\") + 1)\n            choppedString = (Right(ietag.outerhtml, Len(ietag.outerhtml) - choppedString))\n            choppedString = Left(choppedString, 3)\n            .Document.forms(\"theForm\").ORG.Value = choppedString\n            Exit For\n        End If\n    Next ietag\n\n    '.Document.forms(\"theForm\").ORG.Value = \"228\"\n    .Document.getElementById(\"MainForm\").FirstChild.Click\n    Application.Wait Now + #12:00:02 AM#\n    Do Until .Busy = False: DoEvents: Loop 'Repeat this line until the page is %100 loaded\n    '.Document.getElementById(\"CopyBtn\").Click\n\n    clip.SetText IE.Document.getElementById(\"copyspan\").outerhtml\n    clip.PutInClipboard\n\n    Sheets(\"Counts\").Activate\n    Sheets(\"Counts\").Cells.Select\n    Selection.Delete\n\n    Sheets(\"Counts\").Paste Destination:=Worksheets(\"Counts\").Range(\"A1:A1\")\n\n    Sheets(\"UER\").Activate\n    Sheets(\"UER\").Range(\"A1\").Select\n\n    End With\n\n    IE.Quit\nquickStop:\nEnd Sub\n</code></pre>\n\n<pre><code>Sub Issue_SHS() 'Used to automatically issue the SHS Items\n    Dim partNumber As String\n    Dim vanNumber As String\n    Dim quantity As Integer\n    Dim workOrder As String\n    Dim cellValue As String\n    Dim serial As String\n    Dim openingParen As Integer\n    Dim closingParen As Integer\n    Dim startingCell As String\n    Dim startingRow As String\n    Dim rngG As Range\n'    On Error GoTo Errorcatch\n\n    If CapsLocks = True Then\n        MsgBox \"Gayle, turn off your Caps Lock...\"\n    Else\n    shsissue = 0 'Sets this to 0 in the case the you have to hit issue more than one time for whatever reason\n    'startingCell = \"G\" &amp; InputBox(\"Where would you like to start?\") &amp; \":G65536\" 'Gets where you would like to start the process\n    startingCell = IssueRange(True)\n    Set rngG = Worksheets(\"UER\").Range(startingCell) 'This get the range that the macro will run at\n    For Each cell In rngG 'Starts the loop\n        cellValue = cell 'Get the string inside of the cell\n        openingParen = InStr(cellValue, \"[\") 'Gets the opening square bracket\n        closingParen = InStr(cellValue, \"]\") 'Gets the closing square bracket\n        If openingParen &gt; 0 Then 'Makes sure that the first bracket returned something, otherwise it skips\n            If cell.Offset(0, -1).Value = \"Smart Home Services\" Then 'Makes sure that the item in question is an SHS item\n                If cell.EntireRow.Hidden = False Then 'Makes sure that the row is not hidden\n                    partNumber = Mid(cellValue, openingParen + 1, closingParen - openingParen - 1) 'Get the part number between the brackets\n                    vanNumber = cell.Offset(0, 11).Value 'Finds the van number\n                    quantity = cell.Offset(0, 2).Value 'Finds the quantity to issue\n                    workOrder = cell.Offset(0, 6).Value 'Finds the WO to issue the item to\n                    AppActivate (\"Oracle Applications - PERP\") 'Brings the Oracle page up\n                    SendKeys partNumber &amp; \"{TAB}\" &amp; vanNumber &amp; \"{TAB}\" &amp; \"{TAB}\" &amp; quantity &amp; \"{TAB}\" &amp; \"{TAB}\" &amp; \"I\" &amp; \"{TAB}\" &amp; workOrder, True 'Mimics the keystrokes to issue the item\n                    If Not cell.Offset(0, 1) = \"\" Then 'Checks if there is a serial number for the SHS Item\n                        serial = UCase(cell.Offset(0, 1).Value)\n                        SendKeys \"%r\" 'Opens the Serial Number Menu\n                        SendKeys serial &amp; \"{DOWN}\" 'Mimics the keystrokes for the serial number and hits the down arrow\n                        SendKeys \"{ENTER}\" 'Hits the enter key\n                    End If\n                    SendKeys \"{TAB}\" 'Sends the cursor to the next line\n                End If\n            End If\n        End If\n    Next cell\n    End If\n\nDone: 'This is used for debugging to find where an error occurs\n'Errorcatch:\n'    MsgBox Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "split"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 2, "creation_date": 1558539941, "post_id": 56260552, "comment_id": 99137720, "body": "<code>LBound(Array)</code> will return you the first index of the array and <code>UBound(Array)</code> the last index. Note that arrays built from Split start on index 0 so maybe you  should add 1 to the <code>Ubound</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1558540101, "post_id": 56260552, "comment_id": 99137802, "body": "I think you&#39;ll get a Type Mismatch error if you <code>Dim LineItems as String</code> and then try <code>LineItems = Split...</code>."}, {"owner": {"reputation": 128, "user_id": 3721622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3227ac807400fd29d72cd4c629564?s=128&d=identicon&r=PG&f=1", "display_name": "JoshGivens", "link": "https://stackoverflow.com/users/3721622/joshgivens"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558540394, "post_id": 56260552, "comment_id": 99137964, "body": "@Damian thanks, I&#39;ve been struggling with that for the past few hours.  Your solution works perfectly."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1558541036, "last_edit_date": 1558541036, "creation_date": 1558540456, "answer_id": 56260753, "question_id": 56260552, "link": "https://stackoverflow.com/questions/56260552/how-to-find-the-length-of-an-array-created-by-a-split-function/56260753#56260753", "title": "How to find the length of an array created by a split function", "body": "<p>However an array is created, the number of items in the array is:</p>\n\n<pre><code>UBound(arr) - LBound(arr) + 1\n</code></pre>\n\n<p>for example:</p>\n\n<pre><code>Sub qwerty()\n    arr = Split(\"abc,def,ghi\", \",\")\n    MsgBox UBound(arr) - LBound(arr) + 1\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE:</strong></p>\n\n<p>This is true even if you manually create an array like:</p>\n\n<pre><code>Dim poiuy( 13 to 27) As String\n</code></pre>\n"}], "owner": {"reputation": 128, "user_id": 3721622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6a3227ac807400fd29d72cd4c629564?s=128&d=identicon&r=PG&f=1", "display_name": "JoshGivens", "link": "https://stackoverflow.com/users/3721622/joshgivens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "closed_date": 1558540619, "accepted_answer_id": 56260753, "answer_count": 1, "score": 0, "last_activity_date": 1558541036, "creation_date": 1558539784, "last_edit_date": 1558539901, "question_id": 56260552, "link": "https://stackoverflow.com/questions/56260552/how-to-find-the-length-of-an-array-created-by-a-split-function", "closed_reason": "Duplicate", "title": "How to find the length of an array created by a split function", "body": "<p>I'm trying to read a csv file using an excel macro, the csv file doesn't have the same number of values on each row.  I'm trying to create a nested loop that goes through each value within each row one at a time to update a GUI.  </p>\n\n<p>I can open the csv and read in lines by hard coding which lines I want to read, but would like to be able to have the flexibility to utilize a large variety of user generated csv files.</p>\n\n<pre><code>Private Sub LoadSettings_btn_Click()\n    Dim strfilename As String\n    Dim fDialog As FileDialog, result As Integer\n    Set fDialog = Application.FileDialog(msoFileDialogFilePicker)\n    fDialog.AllowMultiSelect = False\n    fDialog.Title = \"Select a file\"\n    fDialog.InitialFileName = \"H:\\Personal\\SideProjects\"&lt;/code&gt;\n\n    If fDialog.Show = -1 Then\n        strfilename = fDialog.SelectedItems(1)\n    End If\n    Dim LineItems As String\n\n\n    Open strfilename For Input As #1\n    row_number = 0\n    Do Until EOF(1)\n        Line Input #1, LineFromFile\n        LineItems = Split(LineFromFile, \",\")\n        ActiveCell.Value = LineItems.Length()\n    Loop\n    Close #1\nEnd Sub\n</code></pre>\n\n<p>I expect to get the length of the array, in the case of my test file 1 for the first row, and 3 for the second row.  However I'm told I have an invalid qualifier.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 3, "creation_date": 1558539129, "post_id": 56260224, "comment_id": 99137276, "body": "All of your average ranges are missing a colon: <code>Application.WorksheetFunction.Average(Sheet1.Range(&quot;C&quot; &amp; lngCurrentRow &amp; &quot;:Q&quot; &amp; lngCurrentRow))</code>. Additionally, I&#39;d highly suggest putting <code>Option Explicit</code> at the top of your module, <code>Dim</code>ing your variables and using more easily understandable variable names :)"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1558539799, "post_id": 56260224, "comment_id": 99137629, "body": "...plus indent your code and remove all the empty lines"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1558539813, "post_id": 56260224, "comment_id": 99137641, "body": "Also recommended reading <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\">this</a> on how to avoid using Select"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1558539967, "post_id": 56260224, "comment_id": 99137735, "body": "I have edited your code to remove the empty lines, and also to indent your code. Notice how much more readable it is."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1558540295, "post_id": 56260224, "comment_id": 99137911, "body": "<code>lngCurrentRow And lngCurrentRow + 1</code> In VBA, <code>AND</code> when used like this (comparing two numeric values) will output a bitwise comparison.  So, for example, if <code>lngCurrentRow=5</code>, this formula will evaluate to <code>4</code>; probably not what you want."}, {"owner": {"reputation": 3, "user_id": 11540010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b134fccb6ac8dcfd6a8eaf286191e2aa?s=128&d=identicon&r=PG&f=1", "display_name": "NightSerpent", "link": "https://stackoverflow.com/users/11540010/nightserpent"}, "edited": false, "score": 0, "creation_date": 1558547626, "post_id": 56260224, "comment_id": 99141295, "body": "Thank you for the help everyone. My program works now!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11540010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b134fccb6ac8dcfd6a8eaf286191e2aa?s=128&d=identicon&r=PG&f=1", "display_name": "NightSerpent", "link": "https://stackoverflow.com/users/11540010/nightserpent"}, "edited": false, "score": 0, "creation_date": 1558543875, "post_id": 56260760, "comment_id": 99139730, "body": "Thank you so much for all the help. After hammering at it for a while I just hit a mental road block. This new code doesn&#39;t return any errors however when I make the average of the row associated with AB121 clearly greater then the average of the others it still deletes the rows associated with AB121 and AB122 keeping the row associated with AB123. Thoughts?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 3, "user_id": 11540010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b134fccb6ac8dcfd6a8eaf286191e2aa?s=128&d=identicon&r=PG&f=1", "display_name": "NightSerpent", "link": "https://stackoverflow.com/users/11540010/nightserpent"}, "edited": false, "score": 0, "creation_date": 1558544085, "post_id": 56260760, "comment_id": 99139828, "body": "@NightSerpent What is in columns D, F, J, L, etc.?"}, {"owner": {"reputation": 3, "user_id": 11540010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b134fccb6ac8dcfd6a8eaf286191e2aa?s=128&d=identicon&r=PG&f=1", "display_name": "NightSerpent", "link": "https://stackoverflow.com/users/11540010/nightserpent"}, "edited": false, "score": 0, "creation_date": 1558544390, "post_id": 56260760, "comment_id": 99139975, "body": "There are text in those columns. To be a bit more clear about the problem I am attempting to format a machine output file and these boxes specify the units of the number generated in the previous column. I attempted to delete this text and see if that fixed the issue, it did not."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 3, "user_id": 11540010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b134fccb6ac8dcfd6a8eaf286191e2aa?s=128&d=identicon&r=PG&f=1", "display_name": "NightSerpent", "link": "https://stackoverflow.com/users/11540010/nightserpent"}, "edited": false, "score": 0, "creation_date": 1558544633, "post_id": 56260760, "comment_id": 99140076, "body": "@NightSerpent Can you post a screenshot of some sample data? Testing on my end worked fine."}, {"owner": {"reputation": 3, "user_id": 11540010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b134fccb6ac8dcfd6a8eaf286191e2aa?s=128&d=identicon&r=PG&f=1", "display_name": "NightSerpent", "link": "https://stackoverflow.com/users/11540010/nightserpent"}, "edited": false, "score": 1, "creation_date": 1558547553, "post_id": 56260760, "comment_id": 99141275, "body": "dwirony - I am not sure what occurred. When I simplified my spreadsheet to show you, the program worked properly. I am going to have to keep playing to determine if there is any issue. Thank you for all the help."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1558540487, "creation_date": 1558540487, "answer_id": 56260760, "question_id": 56260224, "link": "https://stackoverflow.com/questions/56260224/vba-removing-a-row-through-lookup-and-average/56260760#56260760", "title": "VBA removing a row through lookup and average", "body": "<p>I took a shot at cleaning this up for you here - I deleted some unnecessary variables, removed <code>Select/ActiveColumn</code> and fixed some typos which you had (those were easily found by using <code>Option Explicit</code>):</p>\n\n<pre><code>Option Explicit\nSub FindAB12()\n\n    Dim lngLastRow As Long, lngCompareColumn As Long, lngCurrentRow As Long\n    Dim AB121 As Long, AB122 As Long, AB123 As Long\n\n    lngCompareColumn = 1 'Column A\n    lngLastRow = Cells(Rows.Count, lngCompareColumn).End(xlUp).Row\n\n    For lngCurrentRow = lngLastRow To 2 Step -1\n\n        If Cells(lngCurrentRow, lngCompareColumn).Value = \"AB12\" And _\n           Cells(lngCurrentRow + 1, lngCompareColumn).Value = \"AB12\" And _\n           Cells(lngCurrentRow + 2, lngCompareColumn).Value = \"AB12\" Then\n            AB121 = Application.WorksheetFunction.Average(Sheet1.Range(\"C\" &amp; lngCurrentRow &amp; \":Q\" &amp; lngCurrentRow))\n            AB122 = Application.WorksheetFunction.Average(Sheet1.Range(\"C\" &amp; lngCurrentRow + 1 &amp; \":Q\" &amp; lngCurrentRow + 1))\n            AB123 = Application.WorksheetFunction.Average(Sheet1.Range(\"C\" &amp; lngCurrentRow + 2 &amp; \":R\" &amp; lngCurrentRow + 2))\n\n            If AB121 &gt;= AB122 And AB121 &gt;= AB123 Then\n                Rows(lngCurrentRow + 2).Delete\n                Rows(lngCurrentRow + 1).Delete\n            ElseIf AB122 &gt;= AB123 And AB122 &gt;= AB121 Then\n                Rows(lngCurrentRow + 2).Delete\n                Rows(lngCurrentRow).Delete\n            ElseIf AB123 &gt;= AB122 And AB123 &gt;= AB121 Then\n                Rows(lngCurrentRow + 1).Delete\n                Rows(lngCurrentRow).Delete\n            End If\n\n        End If\n\n    Next lngCurrentRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11540010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b134fccb6ac8dcfd6a8eaf286191e2aa?s=128&d=identicon&r=PG&f=1", "display_name": "NightSerpent", "link": "https://stackoverflow.com/users/11540010/nightserpent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56260760, "answer_count": 1, "score": 0, "last_activity_date": 1558552327, "creation_date": 1558538684, "last_edit_date": 1558552327, "question_id": 56260224, "link": "https://stackoverflow.com/questions/56260224/vba-removing-a-row-through-lookup-and-average", "title": "VBA removing a row through lookup and average", "body": "<p>I have a table which changes daily. At times the text \"AB12\" is found in column A in multiples of three. When this happens I need VBA to recognize it has occurred, find the row it has occurred on and then average the values in columns C,E,G,I,K,M,O,and Q on that row. This average then needs to be compared to the average for the next row and the row after that deleting all but the row with the highest average. </p>\n\n<p>The code I have written thus far is found below. </p>\n\n<pre><code>Sub FindAB12()\n    Columns(\"A:Q\").Select\n    Set rngRange = Selection.CurrentRegion\n    lngNumRows = rngRange.Rows.Count\n    lngFirstRow = rngRange.Row\n    lngLastRow = lngFirstRow + lngNumRows - 1\n    lngCompareColumn = ActiveCell.Column\n    For lngCurrentRow = lngLastRow To lngFirstRow Step -1\n        If (Cells(lngCurrentRow, lngCompareColumn).Text = \"AB12\" And Cells(lngCurrentRow + 1, lngCompareColumn).Text = \"AB12\") Then _\n            AB121 = Application.WorksheetFunction.Average(Sheet1.Range(\"C\" &amp; lngCurrentRow &amp; \":Q\" &amp; lngCurrentRow))\n            AB122 = Application.WorksheetFunction.Average(Sheet1.Range(\"C\" &amp; (lngCurrentRow + 1) &amp; \":Q\" &amp; (lngCurrentRow + 1)))\n            AB123 = Application.WorksheetFunction.Average(Sheet1.Range(\"C\" &amp; (lngCurrentRow + 2) &amp; \":Q\" &amp; (lngCurrentRow + 2)))\n        Next lngCurrentRow\n\n        If AB1211 &gt; AB122 And AB1211 &gt; AB123 Then\n            Rows(lngCurrentRow + 1 And lngCurrentRow + 2).Delete\n        ElseIf AB122 &gt; AB123 And AB122 &gt; AB121 Then\n            Rows(lngCurrentRow And lngCurrentRow + 2).Delete\n        ElseIf AB123 &gt; AB122 And AB123 &gt; AB121 Then\n            Rows(lngCurrentRow And lngCurrentRow + 1).Delete\n        End If\n    End Sub\n\n</code></pre>\n\n<p>In a separate module I am having the sub called upon opening the tab. It would be expected that upon opening this tab only a single row called AB12 would exist in sequential rows (though another AB12 could exist in a later row). The code works up until I try to average (I have used the same code to successfully find and delete these duplicated rows when calculation was not needed). When it plays and hits the second average function I get the error <code>\"Run-time error '1004': Method 'Range' of object '_Worksheet' failed</code>. I am fairly new to VBA and after looking at a lot of code that others have created I have not been able to solve the problem. I hope someone out there can help. I have never used this forum before and am not sure how to best upload my current code, hope my problem and current code is clear.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "request"], "comments": [{"owner": {"reputation": 689, "user_id": 4731063, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RNPgT.png?s=128&g=1", "display_name": "Pants", "link": "https://stackoverflow.com/users/4731063/pants"}, "edited": false, "score": 0, "creation_date": 1558538587, "post_id": 56259818, "comment_id": 99136980, "body": "Can you post some of the code bits that you tried and didn&#39;t work?"}, {"owner": {"reputation": 1548, "user_id": 997341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0f8bade2ecc5240ed1779fa08dbb6a?s=128&d=identicon&r=PG", "display_name": "Michael Dougan", "link": "https://stackoverflow.com/users/997341/michael-dougan"}, "edited": false, "score": 0, "creation_date": 1558544641, "post_id": 56259818, "comment_id": 99140082, "body": "MS Access doesn&#39;t have a form of Ouverables that can account for holidays.  You could write a custom function that would calculate the number of days between two dates and then subtract the sum of all dates in the Holiday table BETWEEN the start and end dates.  Here is a link to someone who put a lot of thought into populating a Holiday table that might work for you:  <a href=\"https://access-programmers.co.uk/forums/showthread.php?t=174215&amp;highlight=Holiday\" rel=\"nofollow noreferrer\">access-programmers.co.uk/forums/&hellip;</a>"}], "owner": {"reputation": 3, "user_id": 11261659, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fy513M6ELZ4/AAAAAAAAAAI/AAAAAAAAACc/Iyqfu2wquuU/photo.jpg?sz=128", "display_name": "Mao Guenn", "link": "https://stackoverflow.com/users/11261659/mao-guenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "closed_date": 1558546439, "answer_count": 0, "score": 0, "last_activity_date": 1594778916, "creation_date": 1558537336, "last_edit_date": 1594778916, "question_id": 56259818, "link": "https://stackoverflow.com/questions/56259818/how-can-i-exclude-holidays-from-working-days-calculation-in-a-request-sql", "closed_reason": "Duplicate", "title": "How can I exclude holidays from working days calculation in a request (SQL)", "body": "<p>First of all I would like to precise that i'm a beginner/self learner and tried many codes before posting this, thank you for your consideration.</p>\n\n<p>I have a request in my MS Access that calculate working days between dates (SQL) using a function \"Ouvrables\" defined in VBA.</p>\n\n<p>I also have a table \"Holidays\" where there is a list of holidays/specific business days off.</p>\n\n<p>I would like to include this table in my SQL calculation, and exclude these holidays from the working days calculations on specific periods.</p>\n\n<p>Example : on may, there are 3 holidays , the 1st, the 8th, and the 30th (3 lines on holidays table)\nI would like to use my working days calculation in this case : 23 working days - 3 holidays = 20 working days</p>\n\n<p>Here is my request SQL code : </p>\n\n<pre><code>SELECT Z.Planning_Consultants.ID_Consultant, Sum(IIf([Activit\u00e9]=\"(2) Interstaff\",Ouvrables([maxBegin],[minEnd])*Planning_Consultants.Time_Allocated,0)) AS NonBillable, Sum(IIf([Activit\u00e9]=\"(1) Mission\",Ouvrables([maxBegin],[minEnd])*Planning_Consultants.Time_Allocated,0)) AS Billable, Sum(IIf([Activit\u00e9]=\"(3) Cong\u00e9s/Arr\u00eat\",Ouvrables([maxBegin],[minEnd])*Planning_Consultants.Time_Allocated,0)) AS Absent, Billable/(Billable+NonBillable-Absent) AS Urate, Consultants.Nom_de_famille\n\n\nFROM (SELECT Planning_Consultants.Time_Allocated, Planning_Consultants.Activit\u00e9, Planning_Consultants.Date_d\u00e9but, Planning_Consultants.Date_fin, Planning_Consultants.ID_Consultant, (IIf(Date_d\u00e9but&gt;[Saisir date d\u00e9but],Date_d\u00e9but,[Saisir date d\u00e9but])) AS maxBegin, (IIf(Date_fin&lt;[Saisir date fin],Date_fin,[Saisir date fin])) AS minEnd, DateDiff(\"d\",maxBegin,minEnd)+1 AS theDiff, Consultants.Nom_de_famille FROM Consultants RIGHT JOIN Planning_Consultants ON Consultants.[Cons_ID] = Planning_Consultants.[ID_Consultant] WHERE (((Planning_Consultants.Date_d\u00e9but)&lt;=[Saisir date fin]) AND ((Planning_Consultants.Date_fin)&gt;=[Saisir date d\u00e9but])))  AS Z INNER JOIN Consultants ON Z.ID_Consultant = Consultants.Cons_ID\n\nGROUP BY Z.Planning_Consultants.ID_Consultant, Consultants.Nom_de_famille;\n</code></pre>\n\n<p>Expected results : \nOn a full period : Non billable/Billable = 23 - 3 = 20 \nor \nFrom 01/05 to 10/05 Non billable = 8 - 2 , and From 11/05 to 31/05 Billable = 15 - 1</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1558536487, "post_id": 56259496, "comment_id": 99135624, "body": "Which line is the error?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1558536541, "post_id": 56259496, "comment_id": 99135655, "body": "Remove the brackets: <code>Withdrawal sSQLSting, Location</code> (FYI, this has come up many, many times before)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1558536788, "post_id": 56259496, "comment_id": 99135793, "body": "@Rory Thanks. Just found a dup for closure. I shouldn&#39;t have been so lazy."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558541401, "post_id": 56259496, "comment_id": 99138541, "body": "Your actual code was <code>Withdrawal (sSQLSting, Location)</code>, not <code>Withdrawal(sSQLSting, Location)</code>. That space is the VBE telling you &quot;this isn&#39;t an argument list, it&#39;s an expression I&#39;m going to try to evaluate and pass <code>ByVal</code> as the first argument to the <code>Withdrawal</code> procedure&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1558536672, "post_id": 56259530, "comment_id": 99135724, "body": "By remove parantheses I got another error <code>ByRef argument type mismatch</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1558536854, "post_id": 56259530, "comment_id": 99135842, "body": "Declare sSQLSting as string  It means your receiving sub wants two strings so check both arguments being passed are strings. And put Option Explicit at the top of your sub."}, {"owner": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1558537030, "post_id": 56259530, "comment_id": 99135965, "body": "Thanks you so much. I found it I forgot it"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "edited": false, "score": 0, "creation_date": 1558537073, "post_id": 56259530, "comment_id": 99135991, "body": "you are welcome. Sorry for closing the question abruptly on you. I should have done that immediately but wasn&#39;t really thinking."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1558536534, "creation_date": 1558536534, "answer_id": 56259530, "question_id": 56259496, "link": "https://stackoverflow.com/questions/56259496/calling-a-sub-in-vba-with-multiple-arguments/56259530#56259530", "title": "Calling A Sub in VBA with multiple arguments", "body": "<p>You should call without parentheses. Within parentheses is for function calls.</p>\n\n<pre><code>Withdrawal sSQLSting, Location \n</code></pre>\n\n<p>Please put <code>Option Explicit</code> at the top of your code and declare all your variables including with explicit type.</p>\n"}], "owner": {"reputation": 7, "user_id": 8426868, "user_type": "registered", "profile_image": "https://graph.facebook.com/562650554080681/picture?type=large", "display_name": "Kry Chulsa", "link": "https://stackoverflow.com/users/8426868/kry-chulsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1558536799, "accepted_answer_id": 56259530, "answer_count": 1, "score": 0, "last_activity_date": 1558536611, "creation_date": 1558536418, "question_id": 56259496, "link": "https://stackoverflow.com/questions/56259496/calling-a-sub-in-vba-with-multiple-arguments", "closed_reason": "Duplicate", "title": "Calling A Sub in VBA with multiple arguments", "body": "<p>I want to call sub with multiple argument but I got an error <b>Syntax error</b></p>\n\n<p>I tried it on Ms Excel 2013</p>\n\n<pre><code>Sub Withdrawal(Query As String, Savelocation As String)\n\n    'Query Data\n    Dim ReturnArray\n    Dim Conn As New ADODB.Connection\n    Dim mrs As New ADODB.Recordset\n    Dim DBPath As String, sconnect As String\n    DBPath = Application.ActiveWorkbook.Path + \"\\Data.xlsx\"\n    sconnect = \"Provider=MSDASQL.1;DSN=Excel Files;DBQ=\" &amp; DBPath &amp; \";HDR=Yes';\"\n    Conn.Open sconnect\n    mrs.Open Query, Conn\n    ThisWorkbook.Worksheets(Savelocation).Range(\"A3\").CopyFromRecordset mrs\n    mrs.Close\n    Conn.Close\nEnd Sub\n\nSub CashWithdrawal()\n    Dim CashWFYC As String\n    Dim Location As String\n    Location = \"CashWithdrawal\"\n    CashWFYC = \"SELECT TOP 10 * FROM [TT$]\"\n    sSQLSting = CashWFYC \n    Withdrawal(sSQLSting, Location)\nEnd Sub\n</code></pre>\n\n<p>I expect the output that got from that <code>sSQLSting</code> query should be save in <code>Location</code></p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1558536260, "post_id": 56259316, "comment_id": 99135500, "body": "You haven&#39;t <code>Set</code> <code>oFiles</code> variable. You have to set it to an object before you ask for the method. So this statement: <code>ReDim vaArray(1 To oFiles.Count)</code> wont work as <code>oFiles</code> is not a files object yet. Think of it this way: if you buy a universal remote and bring it home, you have to set it to your TV before you start using it for you TV"}, {"owner": {"reputation": 21, "user_id": 6888874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hS7ha.png?s=128&g=1", "display_name": "S. Worley", "link": "https://stackoverflow.com/users/6888874/s-worley"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1558536350, "post_id": 56259316, "comment_id": 99135542, "body": "@Zac I appreciate the advice but I did set oFiles, this is not the entire subroutine. I will update the code to reflect this."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1558536358, "creation_date": 1558536358, "answer_id": 56259475, "question_id": 56259316, "link": "https://stackoverflow.com/questions/56259316/looping-to-print-array-to-multiple-cells-range-of-object-global-failed-error/56259475#56259475", "title": "Looping to print array to multiple cells, &quot;range of object _Global failed&quot; error", "body": "<p>From the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/str-function\" rel=\"nofollow noreferrer\"><code>Str</code></a> documentation:</p>\n\n<blockquote>\n  <p>When numbers are converted to strings, a leading space is always reserved for the sign of number. If number is positive, the returned string contains a leading space and the plus sign is implied.</p>\n</blockquote>\n\n<p>If you <code>Debug.Print \"A\" + Str(i) + \":\" + \"E\" + Str(i)</code>, you'll see the leading space and how this is an invalid range reference: <code>A 1:E 1</code> instead of <code>A1:E1</code>.</p>\n\n<p>Use <code>&amp;</code> to concatenate, and avoid <code>Str</code> entirely.</p>\n\n<pre><code>\"A\" &amp; i &amp; \":E\" &amp; i\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6888874, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hS7ha.png?s=128&g=1", "display_name": "S. Worley", "link": "https://stackoverflow.com/users/6888874/s-worley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 56259475, "answer_count": 1, "score": 0, "last_activity_date": 1558536416, "creation_date": 1558535770, "last_edit_date": 1558536416, "question_id": 56259316, "link": "https://stackoverflow.com/questions/56259316/looping-to-print-array-to-multiple-cells-range-of-object-global-failed-error", "title": "Looping to print array to multiple cells, &quot;range of object _Global failed&quot; error", "body": "<p>I am reading the names of multiple files in a directory. Each file has a title with five dashes in it. I would like to print these names to a sheet with the titles already separated by the dashes and put into individual cells.</p>\n\n<p>For example, input:<br>\nmarie-loves-orange-tabby-cats-100<br>\nshelby-hates-white-winged-moths-200   </p>\n\n<p>Output (where lines represent cells):<br>\nMarie | loves | orange | tabby | cats | 100<br>\nshelby | hates | white | winged | moths | 200   </p>\n\n<p>I hadn't seen a graceful way to print single dimension arrays to cells (although my way isn't terribly graceful either), and the examples I could find did not cycle through changing values. I tried one with simply A:E as the range, but this printed the same file name down the entirety of the cells. To fix this, I made a string with variable values to serve as the range, so that it would only print in those cells and then move down the sheet. A1:E1, then A2:E2, ... so on. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim vaArray   As Variant\n    Dim i               As Integer\n    Dim oFile       As Object\n    Dim oFSO     As Object\n    Dim oFolder  As Object\n    Dim oFiles     As Object\n\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set oFolder = oFSO.GetFolder(sPath)\n    Set oFiles = oFolder.Files\n\n    If oFiles.Count = 0 Then\n        file_list = False\n        Exit Function\n    End If\n\n    ReDim vaArray(1 To oFiles.Count)\n    Dim afterSplit() As String\n    Dim rangeString As String\n    Worksheets(\"filenames\").Activate\n    i = 1\n    For Each oFile In oFiles\n        afterSplit = Split(oFile.Name, \"-\", 5)\n        rangeString = \"A\" + Str(i) + \":\" + \"E\" + Str(i)\n        Range(rangeString).Value = afterSplit\n        i = i + 1\n    Next\n</code></pre>\n\n<p>However, this throws a \"Message 'Range' of object '_Global' failed\" error without printing anything to the sheet. I appreciate any help with this. </p>\n\n<p>Edit: Larger code snipped added for clarity. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558535729, "post_id": 56259237, "comment_id": 99135158, "body": "Why would you need to create an array from the dictionary? <code>dict.Keys</code> will give you a 1d array with the keys stored and <code>dict.items</code> a 1d array with the items. So you can use that instead resizing an array over and over."}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "edited": false, "score": 0, "creation_date": 1558547760, "post_id": 56259237, "comment_id": 99141346, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21940111/updating-an-array-stored-in-a-vba-dictionary\">Updating an array stored in a VBA dictionary</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1558539091, "post_id": 56259443, "comment_id": 99137257, "body": "@Caerus have a look at my updated answer - you may find this more efficient over large datasets as it will create the entire array in one line instead of adding to the array each time"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1558539433, "last_edit_date": 1558539433, "creation_date": 1558536221, "answer_id": 56259443, "question_id": 56259237, "link": "https://stackoverflow.com/questions/56259237/vba-dictionaries/56259443#56259443", "title": "VBA Dictionaries", "body": "<p>Arrays stored as items in a dictionary don't like being directly written to. You need to write the dictionary item to a temporary array before setting the item back to the updated array.</p>\n\n<pre><code>Sub test()\n    Dim dict As New Scripting.Dictionary\n    Dim sht As Worksheet\n    Dim x As Long\n    Dim accountID As Variant, transaction As Variant\n    Dim arr As Variant\n\n    Set sht = Sheets(\"Sheet1\")\n\n    With sht\n        For x = 2 To 6\n            ReDim arr(0)\n            accountID = .Cells(x, 1).Value2\n            transaction = .Cells(x, 2).Value2\n            With dict\n                If Not .Exists(accountID) Then\n                    ReDim arr(0)\n                    arr(0) = transaction\n                    .Add Key:=accountID, Item:=arr\n                Else\n                    arr = .Item(accountID)\n                    ReDim Preserve arr(LBound(arr) To UBound(arr) + 1)\n                    arr(UBound(arr)) = transaction\n                    dict(accountID) = arr\n                End If\n            End With\n        Next x\n    End With\n\n\n    ' Read back dictionary and array\n    Dim k\n    Dim dictStr As String\n    dictStr = \"{\"\n    For Each k In dict.Keys\n        Debug.Print k, Join(dict(k), \", \")\n        dictStr = dictStr &amp; \"'\" &amp; k &amp; \"':[\" &amp; Join(dict(k), \",\") &amp; \"],\"\n    Next k\n    dictStr = Left(dictStr, Len(dictStr) - 1) &amp; \"}\"\n    MsgBox dictStr\n\nEnd Sub\n</code></pre>\n\n<p>This may be a more efficient way of achieving the same thing. This uses a couple of tricks using <code>Index</code> and <code>Filter</code> to Slice the arrays and filter a <code>2D</code> array</p>\n\n<pre><code>Sub test()\n    Dim arr As Variant, aKeys As Variant, aItems As Variant\n    Dim dict As New Scripting.Dictionary\n    Dim posArr As String\n    Dim i As Long, k As Long\n\n    With Sheets(\"Sheet1\")\n        arr = .Range(.Cells(2, 1), .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, 2))\n    End With\n\n    With Application\n        ' Separates the arr array into two 1D arrays\n        aKeys = .Transpose(.Index(arr, 0, 1))\n        aItems = .Transpose(.Index(arr, 0, 2))\n\n        ' Loops through aKeys array\n        For i = LBound(aKeys) To UBound(aKeys)\n            ' Reset the posArr string, this is used for indexing the arrays at the correct locations\n            posArr = vbNullString\n            ' Test if key already exists in dictionary. As we are getting all the possible values in one go we don't\n            ' need to worry about if it does exist. Testing here means we skip the second loop if not needed\n            If Not dict.Exists(aKeys(i)) Then\n                ' Loop through aKeys to find all the positions of the items we want in the array\n                For k = LBound(aKeys) To UBound(aKeys)\n                    ' If the key in position k is equal to the key in position i then add it to posArr string\n                    If aKeys(k) = aKeys(i) Then\n                        ' We will late split this into an array itself on the \",\" delimiter\n                        posArr = posArr &amp; k &amp; \",\"\n                    End If\n                Next k\n                ' Add our key and all our matching items to the dictionary\n                ' Here we split the posArr string on the \",\" delimiter and index the aItems array. This returns\n                ' All the values from aItems that have a matching position in the aKeys array.\n                ' For this to work it aKeys and aItems must have the exact same size (i.e. 1D and matching length)\n                dict.Add Key:=aKeys(i), Item:=.Index(aItems, Split(Left(posArr, Len(posArr) - 1), \",\"))\n            End If\n        Next i\n    End With\n\n\n    ' Read back the dictionary\n    ' Delete this and update with whatever you want to do with your data - This is currently just a check everything\n    ' has worked as expected\n    Dim dictKey\n    Dim dictStr As String\n    dictStr = \"{\"\n    For Each dictKey In dict.Keys\n        dictStr = dictStr &amp; vbNewLine &amp; vbTab &amp; \"'\" &amp; dictKey &amp; \"':[\" &amp; Join(dict(dictKey), \",\") &amp; \"],\"\n    Next dictKey\n    dictStr = Left(dictStr, Len(dictStr) - 1) &amp; vbNewLine &amp; \"}\"\n    MsgBox dictStr\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 614, "user_id": 3893580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bbf5b1f688a462c3a076210ea9efb3?s=128&d=identicon&r=PG&f=1", "display_name": "Caerus", "link": "https://stackoverflow.com/users/3893580/caerus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 56259443, "answer_count": 1, "score": 0, "last_activity_date": 1558539433, "creation_date": 1558535542, "question_id": 56259237, "link": "https://stackoverflow.com/questions/56259237/vba-dictionaries", "title": "VBA Dictionaries", "body": "<p>I'm trying to create a dictionary of key:value pairs in VBA. The keys will be account IDs and the values should be lists of integers. Given the following data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fnI0s.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fnI0s.png\" alt=\"enter image description here\"></a></p>\n\n<p>the dictionary should look like this: <code>{'123':[3,5],'456':[4,7],'789':[6]}</code></p>\n\n<p>The array used as a value in the key:value pair will be dynamic; we won't know in advance how large it will be. I'm much more familiar with how to do this in Python, but not VBA, which requires dynamic resizing of arrays. Here's my code so far:</p>\n\n<pre><code>Sub test()\n    Dim dict As New Scripting.Dictionary\n    Dim sht As Worksheet\n    Set sht = Sheets(\"Sheet1\")\n    Dim x As Integer\n    Dim accountID As Variant\n    Dim transaction As Variant\n\n    For x = 2 To 5\n        accountID = sht.Cells(x, 1).Value\n        transaction = sht.Cells(x, 2).Value\n        'Test whether the account exists in the dictionary\n        'If the account does not exist, add it along with its transaction value\n        If Not dict.Exists(accountID) Then\n            Dim arr() As Variant\n            arr(0) = transaction\n            dict.Add accountID, arr\n        'If the account exists, update its value array to include the transaction value\n        ElseIf dict.Exists(accountID) Then\n            arrLen = UBound(arr) - LBound(arr) + 1\n            ReDim Preserve arr(arrLen + 1)\n            dict(accountID)(arrLen + 1) = transaction\n        End If\n    Next x\nEnd Sub\n</code></pre>\n\n<p>It's bugging on the portion that modifies the array. How should this be changed? </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1558537294, "post_id": 56259137, "comment_id": 99136163, "body": "I suggest that first, you fill all values in column B, and later on you can drag down your formulas at C,D and E. Record a macro to see the code to drag down."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1558538085, "post_id": 56259137, "comment_id": 99136680, "body": "I could do that however the values of Column B are added 1-3 at a time while the formulas in C,D and E are needed right away when B is populated. @FoxfireAndBurnsAndBurns"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1558538722, "post_id": 56259137, "comment_id": 99137052, "body": "I see what you mean @FoxfireAndBurnsAndBurns but am not sure how to reference the range as new values are being added constantly."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1558539759, "post_id": 56259137, "comment_id": 99137611, "body": "How does your code transfer the value from the <code>ComboBox</code> into the next empty cell in <code>Col B</code>?"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1558540851, "post_id": 56259137, "comment_id": 99138215, "body": "@GMalc updated to show the correct code"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1558549867, "post_id": 56259137, "comment_id": 99142294, "body": "See my update, added borders"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1558549167, "post_id": 56261601, "comment_id": 99141983, "body": "Ok works perfectly thanks. How would I also add a border around that range? I recorded a macro but am not sure what to change the range too since it is dependent on how many values are added to the combobox"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1558618934, "post_id": 56261601, "comment_id": 99167504, "body": "I have added another textbox that I would like to translate to the cell 2 columns over from the value of combobox1. How wold I go about doing so?"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1558619383, "post_id": 56261601, "comment_id": 99167797, "body": "Also if the combobox/textbox is blank I would like the linked cell to remain the same."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1558626714, "post_id": 56261601, "comment_id": 99171966, "body": "@Tmacjoshua, It would be best if you ask that as another question."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1558984623, "post_id": 56261601, "comment_id": 99269649, "body": "could you take a look at this question please. <a href=\"https://stackoverflow.com/questions/56327603/userform-combobox-values-linked-cells-depend-on-all-combobox-values\" title=\"userform combobox values linked cells depend on all combobox values\">stackoverflow.com/questions/56327603/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 1, "last_activity_date": 1558549841, "last_edit_date": 1558549841, "creation_date": 1558543728, "answer_id": 56261601, "question_id": 56259137, "link": "https://stackoverflow.com/questions/56259137/finding-next-blank-row-then-adding-formula/56261601#56261601", "title": "finding next blank row then adding formula", "body": "<p>I added a line to your code, it should autofill each time you click the button.</p>\n\n<pre><code>Private sub CommandButton1_click()\n\nWith Worksheets(\"sheet\")\n    .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = ComboBox1.Value \n    .Cells(.Rows.Count, \"B\").End(xlUp).Offset(1, 0) = ComboBox2.Value\n    .Cells(Rows.Count, \"B\").End(xlUp).Offset(-1, 1).Resize(, 3).AutoFill .Cells(Rows.Count, \"B\").End(xlUp).Offset(-1, 1).Resize(, 3).Resize(2)\n\n    With .Cells(Rows.Count, \"B\").End(xlUp).Offset(-1, 1).Resize(, 3).Resize(2)\n        .Borders.LineStyle = xlContinuous\n    End With                   \n\nEnd With\nActiveWorkbook.RefreshAll\nUnload Me\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 56261601, "answer_count": 1, "score": 0, "last_activity_date": 1558549841, "creation_date": 1558535208, "last_edit_date": 1558548313, "question_id": 56259137, "link": "https://stackoverflow.com/questions/56259137/finding-next-blank-row-then-adding-formula", "title": "finding next blank row then adding formula", "body": "<p>I have a userform that will paste the combobox1 value to the next available row in column B. There are 3 columns to the right (C,D &amp; E) that have vlookup formulas that I would like to fill down as the combobox1 value is pasted to column B. </p>\n\n<p>This is the vlookup formula and B123 would be the combobox1 value for that specific row\n=IFERROR(VLOOKUP(B123,'Sheet1'!$A$3:$C$370,2,0),0)/1000000</p>\n\n<p>This is what I have tried so far</p>\n\n<pre><code>  Dim nextrow As Long \n  Dim nextrow1 As Long\n  Dim nextrow2 As Long\n  nextrow = Cells(Rows.Count, \"C\").End(xlUp).Row + 1\n        .Range(rows.count, nextrow - 1).FillDown\n  nextrow1 = Cells(Rows.Count, \"D\").End(xlUp).Row + 1\n        .Range(rows.count, nextrow - 1).FillDown\n  nextrow2 = Cells(Rows.Count, \"E\").End(xlUp).Row + 1\n        .Range(rows.count, nextrow - 1).FillDown\n  End Sub\n</code></pre>\n\n<p>This code will paste the combobox value into the next available row in column B</p>\n\n<pre><code>Private sub CommandButton1_click()\n\n    With Worksheets(\"sheet\")\n        .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0) = ComboBox1.Value \n        .Cells(.Rows.Count, \"B\").End(xlUp).Offset(1, 0) = ComboBox2.Value \n    End With\nActiveWorkbook.RefreshAll\nUnload Me\n</code></pre>\n"}, {"tags": ["excel", "vba", "theory"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1558535332, "post_id": 56259061, "comment_id": 99134915, "body": "Which line does throw the overload error?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1558535346, "post_id": 56259061, "comment_id": 99134924, "body": "Is always a good idea to avoid looping over the sheet itself, and way faster if you add that data in an array and loop over the array instead. The less you interact with the spreadsheet, the better."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558535361, "post_id": 56259061, "comment_id": 99134939, "body": "Could you explain what are you trying to achieve? Because it seems that you are looking for matches and then doing something else, which is fairly easy and fast to do with arrays and dictionaries. Thought I can&#39;t see anything wrong here, maybe some value is an error or something of the sort."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1558535629, "post_id": 56259061, "comment_id": 99135087, "body": "Actually I think any of your variables produces the overflow. See <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/overflow-error-6\" rel=\"nofollow noreferrer\">Overflow (Error 6)</a> \u2022 Also there are not declared variables in your code like <code>j</code>. Declare all of them properly. I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1558535801, "post_id": 56259061, "comment_id": 99135203, "body": "Also, check your Memory Usage in Task Manager - if this is excessive then A) use <code>Workbooks.Open location &amp; nextFile, ReadOnly:=True</code> to prevent Excel creating temporary files and B) Consider saving your workbook periodically to &quot;discard&quot; unsaved changes from memory"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1558535948, "post_id": 56259061, "comment_id": 99135295, "body": "Note that the description of Error 6 you included is for <b>Visual Basic</b> and not for <b>VBA</b> (see the link in my comment above which is the description for VBA). Also we cannot help without seeing your code (see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>) since the code is producing that error and needs to be fixed/changed."}, {"owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558536054, "post_id": 56259061, "comment_id": 99135373, "body": "@P\u1d07\u029c Even if I&#39;m specifically asking about the theory or definitions/limitations? This is something I&#39;m curious about and don&#39;t have the technical education nor can I find the answer elsewhere online."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558536147, "post_id": 56259061, "comment_id": 99135428, "body": "Again the description of the error that you posted is NOT for VBA. It is the wrong description. Therefore there is no theory about this in VBA. You are up the wrong tree. You have to search for the error in your code. Please show your code and tell in which line you get the error."}, {"owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1558536360, "post_id": 56259061, "comment_id": 99135552, "body": "Apologies, I missed what you meant."}, {"owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1558536394, "post_id": 56259061, "comment_id": 99135573, "body": "Also, there was no line that was highlighted. There was no option to debug. It just kicked out. That was it."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558536472, "post_id": 56259061, "comment_id": 99135612, "body": "@sethW Then go through the code step by step using F8. So you will see which line finally throws the error."}, {"owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558536497, "post_id": 56259061, "comment_id": 99135631, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193777/discussion-between-sethw-and-p\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1558547475, "post_id": 56259399, "comment_id": 99141239, "body": "So just for my own understanding, when rows of data are added to an array in the form of a range, it&#39;s automatically entered as a 2-dimensional array, dividing them by rows? And a variant array will be large enough to hold 50k rows of data with 17 columns each? Not doubting you, just had no idea."}, {"owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1558547834, "post_id": 56259399, "comment_id": 99141385, "body": "Also, the <code>newRow()</code> array was simply holding each new line from the opened file so that it could be compared with what had already been entered in the main file. 1. Read the next row into <code>newRow()</code> 2. Run through what has already been logged 3. Toss if already logged. 4. Add to main file if unique. And I&#39;m writing to the main file each time because there might ultimately be up to a few hundred thousand rows of data, and didn&#39;t want to run the chance of overflowing an array holding it all."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1558601422, "post_id": 56259399, "comment_id": 99157744, "body": "That&#39;s correct, allocating a range to a variant array will automatically be entered as a 2d array (starting at 1!). As far as I can tell, there is no reason why the array shouldn&#39;t be able to hold 50k/17, or hundreds of thousands. Though I&#39;ve never needed at such sizes, I&#39;ve just randomly populated a sheet up to 1kk, over the 17 columns and it loads in the array just fine. Loading and writing it back to a second sheet took in total approx 35 seconds, with only 5 seconds at 500k/17 for same process."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1558601426, "post_id": 56259399, "comment_id": 99157746, "body": "If your array gets to a crazy size and starts actiging weird, you might want to decide in your code to dump it in the spreadsheet at every 200k rows or so. i.e.: <code>If ubound(arrOutput) &gt; 200k then....</code>. Or do so for every workbook at least (collect rows to array), and not for every row to be written."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "edited": false, "score": 0, "creation_date": 1558604607, "post_id": 56259399, "comment_id": 99159511, "body": "I&#39;ve added further management to holding the values in an array, and writing back to the spreadsheet... As you can probably notice I&#39;ve kept the changes to your code to a minimum, so should be relatively easy to spot what has changed, and improve upon as you see fit."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 1, "last_activity_date": 1558604533, "last_edit_date": 1558604533, "creation_date": 1558536067, "answer_id": 56259399, "question_id": 56259061, "link": "https://stackoverflow.com/questions/56259061/how-do-i-figure-out-if-my-temporary-folder-is-overloading-apologies-on-the-len/56259399#56259399", "title": "How do I figure out if my temporary folder is overloading? (Apologies on the length)", "body": "<p>Not sure about the writing back to the sheet part (i would still allocate the values to an array and write it back all together, but that depends on what you have in the sheet already, plus whatever <code>newRow()</code> does), but can you give this a try and see if there is any improvement in speed?</p>\n\n<pre><code>Sub getCBU()\n\nDim rowCount As Long, newRow(1 To 17) As Variant, compareRow(1 To 17) As Variant, nextFile As String\nDim location As String, lastRow As Long, match As Boolean, startTime As Double, secondsElapsed As String\n\nDim arrData, arrOutput()\nDim arrTemp(): ReDim arrOutput(1 To 17, 1 To 1)\nDim R As Long, C As Long\n\nlocation = \"C:\\Users\\swallin\\Documents\\CBU History\\\"\nnextFile = Dir(location &amp; \"CBU*\")\nrowCount = 2\n\nstartTime = Timer\n\nDo While nextFile &lt;&gt; \"\"\n\n    Workbooks.Open (location &amp; nextFile)\n    lastRow = Workbooks(nextFile).Worksheets(1).Cells(Rows.Count, 1).End(xlUp).row\n    With Workbooks(nextFile).Worksheets(1)\n        arrData = .Range(.Cells(1, 1), .Cells(lastRow, 17))\n    End With\n\n    For s = 18 To lastRow\n\n        match = True\n\n        For X = 1 To 17\n            newRow(X) = arrData(s, X)\n        Next X\n\n        For y = 2 To rowCount\n\n            If Val(newRow(11)) = Val(arrData(y, 11)) Then\n\n                For j = 1 To 17\n                    compareRow(j) = arrData(y, j).Value\n                Next j\n\n                For v = 1 To 17\n                    If Val(compareRow(v)) &lt;&gt; Val(newRow(v)) Then\n                        match = False\n                        Exit For\n                    Else\n                        match = True\n                    End If\n                Next v\n\n                If match = True Then\n                    Exit For\n                End If\n\n            Else\n                match = False\n            End If\n\n        Next y\n\n        y = 2\n\n        If match = False Then\n            rowCount = rowCount + 1\n            ReDim Preserve arrTemp(1 To 17, 1 To rowCount)\n            For t = 1 To 17\n                arrTemp(t, rowCount) = newRow(t)\n            Next t\n        End If\n\n    Next s\n\n    s = 18\n\n    Workbooks(nextFile).Close\n\n    nextFile = Dir()\n\nLoop\n\n    'Transpose the array\n    ReDim arrOutput(1 To UBound(arrTemp, 2), 1 To UBound(arrTemp))\n    For C = LBound(arrTemp) To UBound(arrTemp)\n        For R = LBound(arrTemp, 2) To UBound(arrTemp, 2)\n            arrOutput(R, C) = arrTemp(C, R)\n        Next R\n    Next C\n\n    'Allocate back to the spreadsheet\n    With ThisWorkbook.Worksheets(1)\n        .Range(.Cells(2, 1), .Cells(UBound(arrOutput) + 1, 17)) = arrOutput\n    End With\n\n\nsecondsElapsed = Format((Timer - startTime) / 86400, \"hh:mm:ss\")\nThisWorkbook.Worksheets(2).Cells(1, 1) = secondsElapsed\n\nEnd Sub\n</code></pre>\n\n<p>PS: As others suggested, is a good idea to use <code>Option Explicit</code>, and eventually to step through to code and see if everything is working as intended.</p>\n\n<p>As for the Overflow issue...  stepping through code would/should resolve that as well eventually. See <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/overflow-error-6\" rel=\"nofollow noreferrer\">Overflow (Error 6)</a> for more info.</p>\n\n<p><strong>EDIT:</strong> I've added further management to holding the values in an array, and writing back to the spreadsheet.</p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1558538124, "creation_date": 1558538124, "answer_id": 56260057, "question_id": 56259061, "link": "https://stackoverflow.com/questions/56259061/how-do-i-figure-out-if-my-temporary-folder-is-overloading-apologies-on-the-len/56260057#56260057", "title": "How do I figure out if my temporary folder is overloading? (Apologies on the length)", "body": "<p>This opens a new instance for each file and closes it afterwards. Give it a try (I could not test it). This includes all the suggestions I made in the chat.</p>\n\n<pre><code>Option Explicit\n\nSub getCBU()\n    Dim location As String\n    location = \"C:\\Users\\swallin\\Documents\\CBU History\\\"\n\n    Dim nextFile As String\n    nextFile = Dir(location &amp; \"CBU*\")\n\n    Dim rowCount As Long\n    rowCount = 2\n\n    Dim startTime As Double\n    startTime = Timer\n\n\n    Dim newRow(1 To 17) As Variant, compareRow(1 To 17) As Variant\n    Dim lastRow As Long, match As Boolean\n\n    Dim s As Long, x As Long, y As Long, j As Long, v As Long, t As Long\n\n    Dim objExcel As Object, ActWb As Workbook\n\n\n    Do While nextFile &lt;&gt; \"\"\n        Set objExcel = CreateObject(\"Excel.Application\") 'new excel instance\n        Set ActWb = objExcel.Workbooks.Open(Filename:=location &amp; nextFile, ReadOnly:=True)\n\n        lastRow = ActWb.Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n\n        For s = 18 To lastRow\n            match = True\n\n            For x = 1 To 17\n                newRow(x) = ActWb.Worksheets(1).Cells(s, x)\n            Next x\n\n            For y = 2 To rowCount\n                If Val(newRow(11)) = Val(ThisWorkbook.Worksheets(1).Cells(y, 11)) Then\n                    For j = 1 To 17\n                        compareRow(j) = ThisWorkbook.Worksheets(1).Cells(y, j).Value\n                    Next j\n\n                    For v = 1 To 17\n                        If Val(compareRow(v)) &lt;&gt; Val(newRow(v)) Then\n                            match = False\n                            Exit For\n                        Else\n                            match = True\n                        End If\n                    Next v\n\n                    If match = True Then\n                        Exit For\n                    End If\n                Else\n                    match = False\n                End If\n            Next y\n\n            y = 2\n\n            If match = False Then\n                rowCount = rowCount + 1\n                For t = 1 To 17\n                    ThisWorkbook.Worksheets(1).Cells(rowCount, t) = newRow(t)\n                Next t\n            End If\n        Next s\n\n        s = 18\n\n        ActWb.Close SaveChanges:=False\n        objExcel.Quit 'close excel instance\n        Set objExcel = Nothing 'free variable\n\n        nextFile = Dir()\n    Loop\n\n    Dim secondsElapsed As String\n    secondsElapsed = Format$((Timer - startTime) / 86400, \"hh:mm:ss\")\n    ThisWorkbook.Worksheets(2).Cells(1, 1) = secondsElapsed\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1558542318, "last_edit_date": 1558542318, "creation_date": 1558540245, "answer_id": 56260696, "question_id": 56259061, "link": "https://stackoverflow.com/questions/56259061/how-do-i-figure-out-if-my-temporary-folder-is-overloading-apologies-on-the-len/56260696#56260696", "title": "How do I figure out if my temporary folder is overloading? (Apologies on the length)", "body": "<p>Here's a revamp of your code that should be quicker and more memory friendly. (updated to be able to handle any number of results).</p>\n\n<pre><code>Sub getCBU()\n\n    Dim wb As Workbook\n    Dim wsDest As Worksheet\n    Dim wsTime As Worksheet\n    Dim hUnqVals As Object\n    Dim hUnqRows As Object\n    Dim aHeaders() As Variant\n    Dim aCompare() As Variant\n    Dim aResults() As Variant\n    Dim aStartingData() As Variant\n    Dim sFolder As String\n    Dim sFile As String\n    Dim sDelim As String\n    Dim sTemp As String\n    Dim lMaxResults As Long\n    Dim lCompareStartRow As Long\n    Dim lValCompareCol As Long\n    Dim ixCompare As Long\n    Dim ixResult As Long\n    Dim ixCol As Long\n    Dim dTimer As Double\n\n    dTimer = Timer\n\n    Set wb = ThisWorkbook\n    Set wsDest = wb.Worksheets(1)\n    Set wsTime = wb.Worksheets(2)\n    Set hUnqRows = CreateObject(\"Scripting.Dictionary\")\n    Set hUnqVals = CreateObject(\"Scripting.Dictionary\")\n    sDelim = \"|\"\n    lMaxResults = 100000\n    lCompareStartRow = 18\n    lValCompareCol = 11\n\n    sFolder = Environ(\"UserProfile\") &amp; \"\\Documents\\CBU History\\\"    'Be sure to including ending \\\n    sFile = Dir(sFolder &amp; \"CBU*.xlsx\")\n\n    With wsDest.Range(\"A2:Q\" &amp; wsDest.Cells(wsDest.Rows.Count, lValCompareCol).End(xlUp).Row)\n        If .Row &gt; 1 Then\n            aHeaders = .Offset(-1).Resize(1).Value\n            aStartingData = .Value\n            ReDim aResults(1 To lMaxResults, 1 To .Columns.Count)\n            For ixResult = 1 To UBound(aStartingData, 1)\n                For ixCol = 1 To UBound(aStartingData, 2)\n                    sTemp = sTemp &amp; sDelim &amp; aStartingData(ixResult, ixCol)\n                Next ixCol\n                If Not hUnqRows.Exists(sTemp) Then hUnqRows.Add sTemp, sTemp\n                If Not hUnqVals.Exists(aStartingData(ixResult, lValCompareCol)) Then hUnqVals.Add aStartingData(ixResult, lValCompareCol), aStartingData(ixResult, lValCompareCol)\n                sTemp = vbNullString\n            Next ixResult\n            Erase aStartingData\n        Else\n            'No data to compare against, so no data can be added, exit macro\n            MsgBox \"No data found in [\" &amp; wsDest.Name &amp; \"]\" &amp; Chr(10) &amp; \"Exiting Macro.\", , \"Error\"\n            Exit Sub\n        End If\n    End With\n\n    With Application\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    ixResult = 0\n    Do While Len(sFile) &gt; 0\n        Application.StatusBar = \"Processing \" &amp; sFile &amp; \"...\"\n        With Workbooks.Open(sFolder &amp; sFile, , True).Worksheets(1)\n            With .Range(\"A\" &amp; lCompareStartRow &amp; \":Q\" &amp; .Cells(.Rows.Count, lValCompareCol).End(xlUp).Row)\n                If .Row &gt;= lCompareStartRow Then\n                    aCompare = .Value\n                    For ixCompare = 1 To UBound(aCompare, 1)\n                        If hUnqVals.Exists(aCompare(ixCompare, lValCompareCol)) Then\n                            For ixCol = 1 To UBound(aCompare, 2)\n                                sTemp = sTemp &amp; sDelim &amp; aCompare(ixCompare, ixCol)\n                            Next ixCol\n                            If Not hUnqRows.Exists(sTemp) Then\n                                hUnqRows.Add sTemp, sTemp\n                                ixResult = ixResult + 1\n                                For ixCol = 1 To UBound(aCompare, 2)\n                                    aResults(ixResult, ixCol) = aCompare(ixCompare, ixCol)\n                                Next ixCol\n                                If ixResult = lMaxResults Then OutputResults wsDest, aResults, ixResult, aHeaders\n                            End If\n                            sTemp = vbNullString\n                        End If\n                    Next ixCompare\n                    Erase aCompare\n                End If\n            End With\n            .Parent.Close False\n        End With\n        sFile = Dir()\n    Loop\n\n    Application.StatusBar = vbNullString\n    If ixResult &gt; 0 Then OutputResults wsDest, aResults, ixResult, aHeaders\n    wsTime.Range(\"A1\").Value = Format((Timer - dTimer) / 86400, \"hh:mm:ss\")\n\n    With Application\n        .Calculation = xlCalculationAutomatic\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n\nSub OutputResults(ByRef arg_ws As Worksheet, ByRef arg_aResults As Variant, ByRef arg_ixResult As Long, ByVal arg_aHeaders As Variant)\n\n    Static wsDest As Worksheet\n    Dim rDest As Range\n    Dim lMaxRows As Long\n    Dim lMaxCols As Long\n\n    If wsDest Is Nothing Then Set wsDest = arg_ws\n    lMaxRows = UBound(arg_aResults, 1)\n    lMaxCols = UBound(arg_aResults, 2)\n\n    Set rDest = wsDest.Range(\"A1\").Resize(, lMaxCols).EntireColumn.Find(\"*\", wsDest.Range(\"A1\"), xlValues, xlWhole, , xlPrevious)\n    If rDest Is Nothing Then Set rDest = wsDest.Range(\"A2\") Else Set rDest = wsDest.Cells(rDest.Row, \"A\")\n\n    If rDest.Row + 1 + arg_ixResult &gt; wsDest.Rows.Count Then\n        Set wsDest = wsDest.Parent.Worksheets.Add(After:=wsDest)\n        With wsDest.Range(\"A1\").Resize(, lMaxCols)\n            .Value = arg_aHeaders\n            .Font.Bold = True\n        End With\n        Set rDest = wsDest.Range(\"A2\")\n    End If\n\n    rDest.Resize(arg_ixResult, lMaxCols).Value = arg_aResults\n\n    Erase arg_aResults\n    ReDim arg_aResults(1 To lMaxRows, 1 To lMaxCols)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 7384402, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/697d533e7cd84e6a727bbc4135bbb444?s=128&d=identicon&r=PG&f=1", "display_name": "sethW", "link": "https://stackoverflow.com/users/7384402/sethw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1558604533, "creation_date": 1558534987, "last_edit_date": 1558537811, "question_id": 56259061, "link": "https://stackoverflow.com/questions/56259061/how-do-i-figure-out-if-my-temporary-folder-is-overloading-apologies-on-the-len", "title": "How do I figure out if my temporary folder is overloading? (Apologies on the length)", "body": "<p>I have a macro that threw the below error, and I have a theory why, but am having trouble finding any literature to back it up. Pages I found are typically people posting silly mistakes with incorrect variable types.</p>\n\n<p><a href=\"https://i.stack.imgur.com/do3Oq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/do3Oq.png\" alt=\"Run-time error &#39;6&#39; screenshot\"></a></p>\n\n<p>I don't think there's anything wrong with the code, I just think the nature of the task takes too long, therefore overloading the temp folder. Per <a href=\"https://www.techwalla.com/articles/how-to-fix-runtime-error-6-overflow\" rel=\"nofollow noreferrer\">TechWalla</a> (<i><b>emphasis</b></i> mine):</p>\n\n<blockquote>\n  <p>The Runtime Error 6 occurs in the Visual Basic program. It is an overflow issue that can occur when the Visual Basic program attempts to store <i><b>too much data in the temporary folders area</b></i>. Runtime files help Windows translate a program's language into Windows language so the program runs faster. You can get the Runtime Error 6 message for several reasons. One reason is that you are using a backslash instead of a forward slash in one of your calculations. Other reasons include <i><b>an overloaded temporary folder</b></i>, outdated software or a registry error.</p>\n</blockquote>\n\n<p>(<strong>Caveat:</strong> I haven't seen this explanation elsewhere and can't vouch for how reliable Techwalla is. I don't know if I'm not searching with the right keywords, but like I said, I haven't found much of anything other than code-specific forum posts.)</p>\n\n<p>Is there a way to determine if this is the case? I outline below why I think this is what's causing the error, which might help, but doesn't change the question. <strong>If this is the case, is there a way to find out? And if so, is there a way to prevent it?</strong></p>\n\n<p>(I'll be running it again tonight now that I've used a registry cleaner that found 1GB, though I don't know how much was from Excel. For reference, my C: drive has 180GB free...)</p>\n\n<p>EDIT: Removing code, because I'm asking not asking about that, but whether or not the temporary folder overloading could actually cause this.</p>\n\n<p>EDIT2: After being swayed by the people, I am re-adding the code. And I know, it's not efficient. Thank you for the suggestions though.</p>\n\n<p>EDIT3 (LAST ONE, I SWEAR): Though I realize the description above specifically mentions Visual Basic, which is not VBA, I'm keeping it in as I know Excel uses/creates temporary files, and has memory limits, which is ultimately what I'm curious about.</p>\n\n<pre><code>Sub getCBU()\n\nDim rowCount As Long, newRow(1 To 17) As Variant, compareRow(1 To 17) As Variant, nextFile As String, s As Long\nDim location As String, lastRow As Long, match As Boolean, startTime As Double, secondsElapsed As String\n\n\nlocation = \"C:\\Users\\swallin\\Documents\\CBU History\\\"\nnextFile = Dir(location &amp; \"CBU*\")\nrowCount = 2\n\nstartTime = Timer\n\nDo While nextFile &lt;&gt; \"\"\n\n    Workbooks.Open (location &amp; nextFile)\n    lastRow = Workbooks(nextFile).Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n\n    For s = 18 To lastRow\n\n        match = True\n\n        For x = 1 To 17\n            newRow(x) = Workbooks(nextFile).Worksheets(1).Cells(s, x)\n        Next x\n\n        For y = 2 To rowCount\n\n            If Val(newRow(11)) = Val(ThisWorkbook.Worksheets(1).Cells(y, 11)) Then\n\n                For j = 1 To 17\n                    compareRow(j) = ThisWorkbook.Worksheets(1).Cells(y, j).Value\n                Next j\n\n                For v = 1 To 17\n                    If Val(compareRow(v)) &lt;&gt; Val(newRow(v)) Then\n                        match = False\n                        Exit For\n                    Else\n                        match = True\n                    End If\n                Next v\n\n                If match = True Then\n                    Exit For\n                End If\n\n            Else\n                match = False\n            End If\n\n        Next y\n\n        y = 2\n\n        If match = False Then\n            rowCount = rowCount + 1\n            For t = 1 To 17\n                ThisWorkbook.Worksheets(1).Cells(rowCount, t) = newRow(t)\n            Next t\n        End If\n\n    Next s\n\n\n\n\n    s = 18\n\n    Workbooks(nextFile).Close\n\n    nextFile = Dir()\n\nLoop\n\nsecondsElapsed = Format((Timer - startTime) / 86400, \"hh:mm:ss\")\nThisWorkbook.Worksheets(2).Cells(1, 1) = secondsElapsed\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping", "getelementbyid", "getelementsbytagname"], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 1, "last_activity_date": 1558536799, "last_edit_date": 1558536799, "creation_date": 1558535517, "answer_id": 56259233, "question_id": 56258922, "link": "https://stackoverflow.com/questions/56258922/vba-innertext-using-getelements-cannot-locate-areas-in-html-code/56259233#56259233", "title": "VBA .innertext using getelements*, cannot locate areas in html code", "body": "<p>Here's the general logic of how to access the cells of an HTML table:</p>\n\n<pre><code>Sub test()\nDim sht As Worksheet\nDim doc As New HTMLDocument\nDim targetTable As HTMLTable\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\ndoc.body.innerHTML = sht.Range(\"M1\") 'I just stored the html code in cell M1 as a string for the sake of demonstration\n\nSet targetTable = doc.getElementsByClassName(\"table\")(0) 'Get the first element from a collection of elements whose class name is \"table\"\nDebug.Print targetTable.Rows(0).Cells(0).innerText 'Get the first row from the collection of rows that belong to the table and the first cell from the collection of cells that belong to this row.\nEnd Sub\n</code></pre>\n\n<p>The code above will print <code>Job #</code> in the immediate window. This is the inner text of the first cell of the first row (which is the header of the first column). You can get the rest of the values accordingly.</p>\n\n<p>Things to remember:</p>\n\n<ol>\n<li><code>doc.getElementsByClassName(\"table\")</code> is a collection of elements whose class name is \"table\"</li>\n<li>Same applies to <code>.getElementsByTagName</code> etc.</li>\n<li>The first item in the collection has an index of <code>0</code></li>\n<li>You can loop through all the elements in a collection using a <code>For-Each</code></li>\n<li>This <code>.getelementClassName</code> is wrong</li>\n<li>This <code>doc.getElementsByClassName(\"table\")(0).getElementsByTagName(\"td\")(0).innerText</code> is correct</li>\n<li>You can access an item in the collection either like that <code>doc.getElementsByClassName(\"Something\").Item(0)</code> or like that <code>doc.getElementsByClassName(\"Something\")(0)</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1558536334, "last_edit_date": 1558536334, "creation_date": 1558535648, "answer_id": 56259280, "question_id": 56258922, "link": "https://stackoverflow.com/questions/56258922/vba-innertext-using-getelements-cannot-locate-areas-in-html-code/56259280#56259280", "title": "VBA .innertext using getelements*, cannot locate areas in html code", "body": "<p><strong>The error:</strong></p>\n\n<p>The method is </p>\n\n<pre><code>getElementsByClassName \n</code></pre>\n\n<p>or</p>\n\n<pre><code>getElementsByTagName\n</code></pre>\n\n<p>These return collections which you then index into e.g.</p>\n\n<pre><code>ie.document.getElementsByClassName(\"className\")(0)  'first element\n</code></pre>\n\n<p>Making those changes should handle your initial error.</p>\n\n<hr>\n\n<p><strong>Targeting specific row and column:</strong></p>\n\n<p>You can use <code>nth-of-type</code> if automating with IE i.e. <code>tr:nth-of-type(rowNumberHere)</code> , <code>td:nth-of-type(columnNumberHere)</code>.</p>\n\n<p>I think you are after the second row first column so I would use css selectors</p>\n\n<pre><code>ie.document.querySelector(\".table tr:nth-of-type(2) td:nth-of-type(1)\").innerText\n</code></pre>\n\n<p>Modern browsers are optimized for css selectors so this should be an efficient method.</p>\n\n<hr>\n\n<p><strong>Entire table:</strong></p>\n\n<p>An easy way to copy an entire table is to use the clipboard</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim ie As New InternetExplorer, url As String, ws As Worksheet\n    Dim t As Date, clipboard As Object, hTable As Object\n    url = \"url\"\n    Const MAX_WAIT_SEC As Long = 10\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n\n    With ie\n        .Visible = True\n        .Navigate2 url\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n\n            t = Timer\n            Do\n                On Error Resume Next\n                Set hTable = .querySelector(\".table\")\n                On Error GoTo 0\n                If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n            Loop While hTable Is Nothing\n        End With\n\n        If hTable Is Nothing Then Exit Sub\n            clipboard.SetText hTable.outerHTML\n            clipboard.PutInClipboard\n            ws.Range(\"A1\").PasteSpecial\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Looping rows and columns of a table:</strong></p>\n\n<p>If you want to loop rows and columns of a table and write out, see <a href=\"https://stackoverflow.com/a/51428579/6241235\">here</a>.</p>\n"}], "owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 56259233, "answer_count": 2, "score": 1, "last_activity_date": 1558536799, "creation_date": 1558534545, "last_edit_date": 1558536072, "question_id": 56258922, "link": "https://stackoverflow.com/questions/56258922/vba-innertext-using-getelements-cannot-locate-areas-in-html-code", "title": "VBA .innertext using getelements*, cannot locate areas in html code", "body": "<p>I am trying to create a macro to get the innertext from an internal webpage. I am not sure on how to properly locate the where the text is and would appreciate some direction and possibly some explanation on the approach.</p>\n\n<p>I have tried numerous variations of using the getelementsby/tagname/classname to no avail. im not sure i understand the logic behind locating the areas after using the inspection function.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Var = ie.document.getelementClassName(\"sections\").getElementsByTagName(\"table\").Item(0).innerText\n\n'also tried\nVar = ie.document.getelementClassName(\"sections\").getElementsByTagName(\"table\").Item(1).getElementsByTagName(\"tr\").Item(2).getElementsByTagName(\"td\").Item(0).innerText\n\nVar = ie.document.getelementTagName(\"section\").getElementsByTagName(\"table\").Item(1).getElementsByTagName(\"tr\").Item(2).getElementsByTagName(\"td\").Item(0).innerText\n\n\nActiveCell.Offset(0, 1).Value = Var\n</code></pre>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;html class=\" js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface no-generatedcontent video audio localstorage sessionstorage webworkers no-applicationcache svg inlinesvg smil svgclippaths\" lang=\"\" style=\"\"&gt;&lt;!--&lt;![endif]--&gt;&lt;head&gt;\n    &lt;meta charset=\"utf-8\"&gt;\n    &lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\"&gt;\n    &lt;title&gt;NTC Tracking&lt;/title&gt;\n    &lt;meta name=\"description\" content=\"\"&gt;\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1\"&gt;\n    &lt;link rel=\"apple-touch-icon\" href=\"apple-touch-icon.png\"&gt;\n\n    &lt;link rel=\"stylesheet\" href=\"/Content/bootstrap.min.css\"&gt;\n    &lt;!--        &lt;link rel=\"stylesheet\" href=\"~/Content/bootstrap-theme.min.css\"&gt;--&gt;\n    &lt;!--For Plugins external css--&gt;\n    &lt;link rel=\"stylesheet\" href=\"/Content/plugins.css\"&gt;\n\n\n\n    &lt;!--Theme custom css --&gt;\n    &lt;link rel=\"stylesheet\" href=\"/Content/style.css\"&gt;\n\n    &lt;!--Theme Responsive css--&gt;\n    &lt;link rel=\"stylesheet\" href=\"/Content/responsive.css\"&gt;\n\n    &lt;script src=\"/Scripts/vendor/modernizr-2.8.3-respond-1.4.2.min.js\"&gt;&lt;/script&gt;\n\n\n&lt;/head&gt;\n&lt;body data-spy=\"scroll\" data-target=\"#main-navbar\"&gt;\n    &lt;!--[if lt IE 8]&gt;\n        &lt;p class=\"browserupgrade\"&gt;You are using an &lt;strong&gt;outdated&lt;/strong&gt; browser. Please &lt;a href=\"http://browsehappy.com/\"&gt;upgrade your browser&lt;/a&gt; to improve your experience.&lt;/p&gt;\n    &lt;![endif]--&gt;\n\n    &lt;div class=\"preloader\" style=\"display: none;\"&gt;&lt;div class=\"loaded\" style=\"display: none;\"&gt;&amp;nbsp;&lt;/div&gt;&lt;/div&gt;\n    &lt;div id=\"menubar\" class=\"main-menu\"&gt;\n        &lt;nav class=\"navbar-default navbar-fixed-top\" style=\"background-color:#ffc038; padding:20px;\"&gt;\n            &lt;div class=\"container\"&gt;\n                &lt;!-- Brand and toggle get grouped for better mobile display --&gt;\n                &lt;div class=\"navbar-header\"&gt;\n                    &lt;button type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#bs-example-navbar-collapse-1\" aria-expanded=\"false\"&gt;\n                        &lt;span class=\"sr-only\"&gt;Toggle navigation&lt;/span&gt;\n                        &lt;span class=\"icon-bar\"&gt;&lt;/span&gt;\n                        &lt;span class=\"icon-bar\"&gt;&lt;/span&gt;\n                        &lt;span class=\"icon-bar\"&gt;&lt;/span&gt;\n                    &lt;/button&gt;\n                    &lt;a class=\"\" href=\"http://10.102.18.162/\"&gt;&lt;img src=\"/images/msjlogo.png\" style=\"max-width:50%; margin-top:-20px;\"&gt;&lt;/a&gt;\n\n                &lt;/div&gt;\n\n                &lt;!-- Collect the nav links, forms, and other content for toggling --&gt;\n                &lt;div class=\"collapse navbar-collapse\" id=\"bs-example-navbar-collapse-1\"&gt;\n                    &lt;ul class=\"nav navbar-nav navbar-right\"&gt;\n                        &lt;li&gt;&lt;a href=\"#\"&gt;&lt;span style=\"font-weight:100; font-size:10px;\"&gt;Proxy Plus(5/22/2019 8:20:00 AM) | IQ(5/22/2019 8:31:00 AM) | Vendors(5/21/2019 2:24:00 PM) | USPS(5/22/2019 8:43:00 AM) | International(5/21/2019 2:24:00 PM)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;\n\n\n\n                    &lt;/ul&gt;\n                &lt;/div&gt;&lt;!-- /.navbar-collapse --&gt;\n                &lt;div&gt;\n                    &lt;a class=\"navbar-brand\" href=\"/\"&gt;&lt;h3&gt;NTC Tracking&lt;/h3&gt;&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;div style=\"clear:both; margin-bottom:20px;\"&gt;&lt;/div&gt;\n                &lt;div&gt;\n\n            &lt;/div&gt;\n            &lt;/div&gt;&lt;!-- /.container-fluid --&gt;\n        &lt;/nav&gt;\n    &lt;/div&gt;\n    &lt;!--Home page style--&gt;\n    &lt;header id=\"home\" class=\"sections\"&gt;\n\n    &lt;/header&gt;\n\n    &lt;!-- Sections --&gt;\n\n\n\n\n&lt;header id=\"home\"&gt;\n    &lt;div class=\"container\"&gt;\n        &lt;h2 align=\"center\"&gt;Search Job&lt;/h2&gt;\n        &lt;div class=\"col-md-6 col-md-offset-3 col-sm-6 col-xs-12\"&gt;\n            &lt;p align=\"center\"&gt;Description of this view, testing space and top bar at the same time&lt;/p&gt;\n            &lt;p align=\"center\"&gt;There are some hiding fields due to the web space, if you want to see them click on export&lt;/p&gt;\n            &lt;p align=\"center\"&gt;Description of this view, testing space and top bar at the same time&lt;/p&gt;\n            &lt;p align=\"center\"&gt;Description of this view, testing space and top bar at the same time&lt;/p&gt;\n        &lt;/div&gt;\n\n    &lt;/div&gt;\n    &lt;br&gt;\n&lt;/header&gt;\n&lt;section class=\"sections\"&gt;\n    &lt;div class=\"portfolio\"&gt;\n        &lt;div align=\"center\" class=\"portfolio-item\"&gt;\n            &lt;h5 align=\"center\"&gt;Job Number &lt;/h5&gt;&lt;input id=\"PPNumber\" name=\"PPNumber\" type=\"text\" value=\"P23315\"&gt;&lt;br&gt;\n            &lt;a onclick=\"submitdata();\" href=\"#\" class=\"btn btn-primary\"&gt;Search &lt;/a&gt;\n            &lt;br&gt;&lt;br&gt;\n\n                &lt;div&gt;\n\n                    &lt;p&gt;&lt;/p&gt;\n                &lt;/div&gt;\n                &lt;div style=\"float:left\"&gt;&lt;h3 align=\"left\"&gt;JOB&lt;/h3&gt;&lt;/div&gt;\n                &lt;table class=\"table\" style=\"font-size:11px;\"&gt;\n                    &lt;tbody&gt;&lt;tr&gt;\n                        &lt;th&gt;\n                            Job #\n                        &lt;/th&gt;\n                        &lt;th width=\"20%\"&gt;\n                            Job Name\n                        &lt;/th&gt;\n                        &lt;th&gt;\n                            MeetingDate\n                        &lt;/th&gt;\n                        &lt;th&gt;\n                            DropDate\n                        &lt;/th&gt;\n                        &lt;th&gt;\n                            NTCMailDate\n                        &lt;/th&gt;\n                        &lt;th&gt;\n                            LI#\n                        &lt;/th&gt;\n                        &lt;th&gt;\n                            Total Pieces\n                        &lt;/th&gt;\n                        &lt;th width=\"5%\"&gt;\n                            Day 40 On\n                        &lt;/th&gt;\n                        &lt;th width=\"5%\"&gt;\n                            Logistics Processed\n                        &lt;/th&gt;\n                        &lt;th width=\"5%\"&gt;\n                            IQ Status\n                        &lt;/th&gt;\n                        &lt;th&gt;\n                            MustMail Comments\n                        &lt;/th&gt;\n                        &lt;th&gt;\n                            Total Batch Completed\n                        &lt;/th&gt;\n                        &lt;th&gt;\n                            Actual Status\n                        &lt;/th&gt;\n                        &lt;th&gt;\n                            Options\n                        &lt;/th&gt;\n\n                    &lt;/tr&gt;\n                        &lt;tr&gt;\n                            &lt;td&gt;\n&lt;a href=\"/Report/Batchdetail/P23315-010\" target=\"_blank\"&gt;P23315-010&lt;/a&gt;                            &lt;/td&gt;\n                            &lt;td width=\"20%\"&gt;\n                                ATLANTICA YIELD PLC      &lt;----****I NEED THIS****               \n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                6/20/2019\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                5/13/2019\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                5/13/2019\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                LI-8154090\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                2200\n                            &lt;/td&gt;\n                            &lt;td width=\"5%\"&gt;\n                                5/11/2019\n                            &lt;/td&gt;\n                            &lt;td width=\"5%\"&gt;\n                                4386\n                            &lt;/td&gt;\n                            &lt;td width=\"5%\"&gt;\n                                Mailed\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                MUST MAIL 5/14\n                            &lt;/td&gt;\n                            &lt;td&gt;\n                                11 out of 11\n                            &lt;/td&gt;\n                                &lt;td&gt;\n                                    Foreign Client\n                                &lt;/td&gt;\n                                                                                &lt;td&gt;\n                                                &lt;a class=\"btn btn-default\" href=\"/Report/Reopenjob?jobnumber=P23315&amp;amp;jobref=P23315-010\"&gt;Reopen Job&lt;/a&gt;\n                                            &lt;/td&gt;\n                        &lt;/tr&gt;\n                &lt;/tbody&gt;&lt;/table&gt;\n                &lt;br&gt;\n                 &lt;br&gt;\n         &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/section&gt;\n&lt;script&gt;\n\nfunction submitdata(){\n\n\n    var valtext = $(\"#PPNumber\").val();//you can do also by  getelementbyid\n    window.location.href = '/Report/Search/' + valtext;\n\n}\nfunction ShowMessage() {\n    var result = prompt(\"Please insert a comment if required.\", \"\");\n    if (result == null) {\n        return false; //break out of the function early\n    }\n    document.getElementById('comments').value = result;\n    return true;\n}\n\n&lt;/script&gt;\n\n\n\n\n\n\n    &lt;div class=\"scroll-top\"&gt;\n\n        &lt;div class=\"scrollup\"&gt;\n            &lt;i class=\"fa fa-angle-double-up\"&gt;&lt;/i&gt;\n        &lt;/div&gt;\n\n    &lt;/div&gt;\n\n    &lt;!--Footer--&gt;\n    &lt;footer id=\"footer\" class=\"footer\"&gt;\n        &lt;div class=\"container\"&gt;\n\n            &lt;div class=\"row\"&gt;\n\n\n                &lt;div class=\"socio-copyright\"&gt;\n\n                    &lt;div class=\"social\"&gt;\n\n                    &lt;/div&gt;\n\n                    &lt;p&gt;Made by Broadridge 2017. All rights reserved.&lt;/p&gt;\n                &lt;/div&gt;\n\n            &lt;/div&gt;\n        &lt;/div&gt;\n\n    &lt;/footer&gt;\n    &lt;script src=\"/Scripts/vendor/bootstrap.min.js\"&gt;&lt;/script&gt;\n\n    &lt;script src=\"/Scripts/vendor/jquery-1.11.2.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"/Scripts/plugins.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"/Scripts/main.js\"&gt;&lt;/script&gt;\n\n\n\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>error 438</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 11539914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7862a1ca017b41e659f3af3f388dd8ab?s=128&d=identicon&r=PG&f=1", "display_name": "koch", "link": "https://stackoverflow.com/users/11539914/koch"}, "edited": false, "score": 0, "creation_date": 1558534814, "post_id": 56258880, "comment_id": 99134570, "body": "It returns Application-defined or object-defined error when I use both"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 167, "user_id": 11539914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7862a1ca017b41e659f3af3f388dd8ab?s=128&d=identicon&r=PG&f=1", "display_name": "koch", "link": "https://stackoverflow.com/users/11539914/koch"}, "edited": false, "score": 0, "creation_date": 1558534981, "post_id": 56258880, "comment_id": 99134690, "body": "@koch You should only use one of them. Try <code>ThisWorkbook.Worksheets(&quot;Schools&quot;)</code> then. Is the worksheet <code>Schools</code> in the same workbook as the code?"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1558534464, "last_edit_date": 1558534464, "creation_date": 1558534424, "answer_id": 56258880, "question_id": 56258846, "link": "https://stackoverflow.com/questions/56258846/how-to-store-the-value-of-a-cell-in-a-string/56258880#56258880", "title": "How to store the value of a cell in a string", "body": "<p>Note that there are 2 different naming systems:</p>\n\n<ol>\n<li><p>The VBA code name of a worksheet (which can be changed in the Project Explorer in VBE)</p>\n\n<pre><code>Num = Schools.Cells(136,7).Value\n</code></pre></li>\n<li><p>The tab name of the worksheet (which can be changed by any user)</p>\n\n<pre><code>Num = Worksheets(\"Schools\").Cells(136,7).Value\n</code></pre></li>\n</ol>\n\n<p>Note that <code>Schools</code> and <code>Worksheets(\"Schools\")</code> can be 2 completely different worksheets. These 2 naming systems are completely independend.</p>\n"}], "owner": {"reputation": 167, "user_id": 11539914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7862a1ca017b41e659f3af3f388dd8ab?s=128&d=identicon&r=PG&f=1", "display_name": "koch", "link": "https://stackoverflow.com/users/11539914/koch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1558534654, "accepted_answer_id": 56258880, "answer_count": 1, "score": 1, "last_activity_date": 1558534464, "creation_date": 1558534312, "last_edit_date": 1558534337, "question_id": 56258846, "link": "https://stackoverflow.com/questions/56258846/how-to-store-the-value-of-a-cell-in-a-string", "closed_reason": "Duplicate", "title": "How to store the value of a cell in a string", "body": "<p>I want to store the value of cell [136,7] in sheet Schools in a string</p>\n\n<pre><code>Dim Num As String\n\nNum = Schools.Cells(136,7).Value\n</code></pre>\n\n<p>This code won't run. I am suspecting the error occurs because I cannot refer to my sheet directly use its name. But I do not know how to remedy this.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "textbox"], "comments": [{"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1558559038, "post_id": 56258790, "comment_id": 99146303, "body": "Textbox controls don&#39;t support SQL, nor can  they have sql as their data source. So, you have to use code + a record set, or use dlookup()."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11539844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d583a82a4592f6a7d88da146f37548d?s=128&d=identicon&r=PG&f=1", "display_name": "Paulie", "link": "https://stackoverflow.com/users/11539844/paulie"}, "edited": false, "score": 0, "creation_date": 1558605372, "post_id": 56259017, "comment_id": 99159952, "body": "Thanks very much for this, I have used the code as specified but it&#39;s now returning the actual field value into the controlsource field in the properties window. This again is resulting in the #Name? error. I am assuming I can&#39;t just fill the textbox control on the fly with the value directly?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 1, "user_id": 11539844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d583a82a4592f6a7d88da146f37548d?s=128&d=identicon&r=PG&f=1", "display_name": "Paulie", "link": "https://stackoverflow.com/users/11539844/paulie"}, "edited": false, "score": 0, "creation_date": 1558614216, "post_id": 56259017, "comment_id": 99164695, "body": "Right, it returned the value, not the expression. See edited answer, please."}, {"owner": {"reputation": 1, "user_id": 11539844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d583a82a4592f6a7d88da146f37548d?s=128&d=identicon&r=PG&f=1", "display_name": "Paulie", "link": "https://stackoverflow.com/users/11539844/paulie"}, "edited": false, "score": 1, "creation_date": 1558697076, "post_id": 56259017, "comment_id": 99195639, "body": "Thanks guys. I got it working although it still needed a bit of tweaking but you certainly pointed me in the right direction. The final code was like this:      .ControlSource = &quot;=DLookup(&quot;&quot;[Customer_ID]&quot;&quot;,&quot;&quot;qrySelectCustData&quot;&quot;, &quot;&quot;[CustomerName] =  &#39;&quot; &amp; cVal &amp; &quot;&#39;&quot;&quot;)&quot;"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1558697537, "last_edit_date": 1558697537, "creation_date": 1558534849, "answer_id": 56259017, "question_id": 56258790, "link": "https://stackoverflow.com/questions/56258790/trying-to-populate-a-textbox-with-the-result-from-sql-vba-and-getting-name-erro/56259017#56259017", "title": "Trying to populate a textbox with the result from sql/vba and getting #Name error", "body": "<p>You can't use SQL directly this way. Use <em>DLookup</em>:</p>\n\n<pre><code>.ControlSource = \"=DLookup(\"\"[Customer_ID]\"\",\"\"[qrySelectCustData]\"\",\"\"[CustomerName]='\" &amp; [cVal] &amp; \"'\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11539844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d583a82a4592f6a7d88da146f37548d?s=128&d=identicon&r=PG&f=1", "display_name": "Paulie", "link": "https://stackoverflow.com/users/11539844/paulie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558697537, "creation_date": 1558534127, "last_edit_date": 1558534187, "question_id": 56258790, "link": "https://stackoverflow.com/questions/56258790/trying-to-populate-a-textbox-with-the-result-from-sql-vba-and-getting-name-erro", "title": "Trying to populate a textbox with the result from sql/vba and getting #Name error", "body": "<p>I am trying to populate a textbox on an Access form with a value from a query where the selection criteria is another variable.\nThe code is generating the sql, which I then put into the rowsource of the textbox object but I just get a #Name in the textbox. \nThe generated sql is working if I put it into the query builder and run it. </p>\n\n<pre><code>With Me.txtSupplier_ID\n        .SetFocus\n        .ControlSource = \"(SELECT [Customer_ID] FROM [qrySelectCustData] WHERE [CustomerName] ='\" &amp; cVal &amp; \"')\"\n        .Requery\n\nEnd With\n</code></pre>\n\n<p>The generated sql is working if I put it into the query builder and run it. </p>\n\n<pre><code>With Me.txtSupplier_ID\n        .SetFocus\n        .ControlSource = \"(SELECT [Customer_ID] FROM [qrySelectCustData] WHERE [CustomerName] ='\" &amp; cVal &amp; \"')\"\n        .Requery\n\nEnd With\n</code></pre>\n\n<p>The textbox should be populated with the customer id related to the customer name. The name is coming through fine and the controlsource is populated fine but still getting the #Name? error instead.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 0, "creation_date": 1558546663, "post_id": 56258704, "comment_id": 99140916, "body": "Can you provide more specific details about which aspects of the Outlook Object Model you are having difficulty with? StackOverflow isn&#39;t a code writing service, but if you rephrase your question and show the code or research you&#39;ve done so far you will have a better chance of getting a response."}, {"owner": {"reputation": 13, "user_id": 11539744, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oGXHSYlbnTc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reIFP3sqDz191XtcO6_zL7Y-Ao5bQ/mo/photo.jpg?sz=128", "display_name": "L&#225;szl&#243; Luk&#225;cs", "link": "https://stackoverflow.com/users/11539744/l%c3%a1szl%c3%b3-luk%c3%a1cs"}, "reply_to_user": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "edited": false, "score": 0, "creation_date": 1558552947, "post_id": 56258704, "comment_id": 99143648, "body": "Thanks for the advice! I rephrased my question."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1558567592, "creation_date": 1558567592, "answer_id": 56266223, "question_id": 56258704, "link": "https://stackoverflow.com/questions/56258704/how-to-search-shared-mailbox-based-on-excel-cell-values/56266223#56266223", "title": "How to search shared mailbox based on Excel cell values?", "body": "<p>Never loop through all items in a folder, always use <code>Items.Find/FindNext</code> or <code>Items.Restrict</code>. In your case, the query would be </p>\n\n<pre><code>@SQL=\"http://schemas.microsoft.com/mapi/proptag/0x1000001F\" LIKE '%Some value%' \n</code></pre>\n\n<p>The DASL name above corresponds to the <code>PR_BODY_W</code> MAPI property (you cannot use <code>Body</code> OOM name in a query).</p>\n\n<p>If you want matches on multiple values, your need to create an appropriate query using \"OR\" and/or \"AND\" operators. </p>\n"}], "owner": {"reputation": 13, "user_id": 11539744, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-oGXHSYlbnTc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reIFP3sqDz191XtcO6_zL7Y-Ao5bQ/mo/photo.jpg?sz=128", "display_name": "L&#225;szl&#243; Luk&#225;cs", "link": "https://stackoverflow.com/users/11539744/l%c3%a1szl%c3%b3-luk%c3%a1cs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1608316658, "creation_date": 1558533846, "last_edit_date": 1608316658, "question_id": 56258704, "link": "https://stackoverflow.com/questions/56258704/how-to-search-shared-mailbox-based-on-excel-cell-values", "title": "How to search shared mailbox based on Excel cell values?", "body": "<p>I want to search Outlook shared mailboxes based on the cell value in range A:A then write a &quot;Y&quot; or &quot;N&quot; to B:B depending on whether it finds something.<br />\nI would like to search in body and subject as well.</p>\n<p>For example: In cell A1 there is a number 1111123 to search in shared mailboxes.<br />\nIf a match is found write a &quot;Y&quot; to cell B1, if not, write a &quot;N&quot;.<br />\nThen go to cell A2, A3, A4, etc. till the last cell in range A:A and write the results to B2, B3, B4, etc.</p>\n<p>This code searches Outlook for the value in the active cell and writes a &quot;Y&quot; or a &quot;N&quot; to range B1.</p>\n<ol>\n<li>I want the macro not only to find the value of the active cell, but the value of the whole column A. cell by cell.</li>\n<li>This is slow. It takes around 3-5 min to find the cell value.</li>\n</ol>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n    \nPublic Sub Search_Outlook_Emails()\n    \n    Dim outApp As Outlook.Application\n    Dim outNs As Outlook.Namespace\n    Dim outStartFolder As Outlook.MAPIFolder\n    Dim foundEmail As Outlook.MailItem\n        \n    Set outApp = New Outlook.Application\n    Set outNs = outApp.GetNamespace(&quot;MAPI&quot;)     \n    \n    Set outStartFolder = outNs.GetDefaultFolder(Outlook.olFolderInbox).Parent    \n      \n    'Set outStartFolder = outNs.PickFolder\n    \n    If Not outStartFolder Is Nothing Then\n            \n        Set foundEmail = Find_Email_In_Folder(outStartFolder, ActiveCell.Value)\n            \n        If Not foundEmail Is Nothing Then\n            Range(&quot;B1&quot;).Select\n            ActiveCell.FormulaR1C1 = &quot;Y&quot;    \n        End If\n                \n    Else\n            \n        Range(&quot;B1&quot;).Select\n        ActiveCell.FormulaR1C1 = &quot;N&quot;\n                \n    End If\n    \nEnd Sub\n    \n    \nPrivate Function Find_Email_In_Folder(outFolder As Outlook.MAPIFolder, findText As String) As Outlook.MailItem\n        \n    Dim outItem As Object\n    Dim outMail As Outlook.MailItem\n    Dim outSubFolder As Outlook.MAPIFolder\n    Dim i As Long\n        \n    Debug.Print outFolder.FolderPath\n        \n    Set Find_Email_In_Folder = Nothing\n        \n    'Search emails in this folder\n        \n    i = 1\n    While i &lt;= outFolder.Items.Count And Find_Email_In_Folder Is Nothing\n        \n        Set outItem = outFolder.Items(i)\n                    \n        If outItem.Class = Outlook.OlObjectClass.olMail Then\n                \n            'Does the findText occur in this email's body text?\n                           \n            Set outMail = outItem\n            If InStr(1, outMail.Body, findText, vbTextCompare) &gt; 0 Then Set Find_Email_In_Folder = outMail\n                \n        End If\n            \n        i = i + 1\n            \n    Wend\n        \n    DoEvents\n        \n    'If not found, search emails in subfolders\n        \n    i = 1\n    While i &lt;= outFolder.Folders.Count And Find_Email_In_Folder Is Nothing\n        \n        Set outSubFolder = outFolder.Folders(i)\n            \n        'Only check mail item folders\n            \n        If outSubFolder.DefaultItemType = Outlook.olMailItem Then Set Find_Email_In_Folder = Find_Email_In_Folder(outSubFolder, findText)\n        \n        i = i + 1\n            \n    Wend\n        \nEnd Function\n</code></pre>\n"}, {"tags": ["python", "excel", "vba"], "comments": [{"owner": {"reputation": 1375, "user_id": 6695569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34de466149e34dff31dac5f9ad16af8d?s=128&d=identicon&r=PG", "display_name": "Stephane L", "link": "https://stackoverflow.com/users/6695569/stephane-l"}, "edited": false, "score": 1, "creation_date": 1558536132, "post_id": 56258452, "comment_id": 99135417, "body": "You should give some of your code to have precise answers."}], "answers": [{"comments": [{"owner": {"reputation": 2821, "user_id": 5662006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2eb237f223f66056b9ea829b44b4cf40?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Farr", "link": "https://stackoverflow.com/users/5662006/chris-farr"}, "edited": false, "score": 0, "creation_date": 1558533474, "post_id": 56258469, "comment_id": 99133698, "body": "For this to work you also need to make sure that your python interpreter has been added to your PATH variable."}], "tags": [], "owner": {"reputation": 900, "user_id": 7041244, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AnlBx.jpg?s=128&g=1", "display_name": "Divyanshu Srivastava", "link": "https://stackoverflow.com/users/7041244/divyanshu-srivastava"}, "is_accepted": true, "score": 0, "last_activity_date": 1558533168, "creation_date": 1558533168, "answer_id": 56258469, "question_id": 56258452, "link": "https://stackoverflow.com/questions/56258452/why-is-my-python-script-not-running-from-command-line/56258469#56258469", "title": "Why is my python script not running from command line?", "body": "<p>To run the script</p>\n\n<pre><code>python C:\\users\\RGilsburg\\Desktop\\a\\untitled1.py\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 11466531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda96154af5cdb7de46bb9829296a15d?s=128&d=identicon&r=PG&f=1", "display_name": "Ray234", "link": "https://stackoverflow.com/users/11466531/ray234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 56258469, "answer_count": 1, "score": 0, "last_activity_date": 1558539430, "creation_date": 1558533094, "last_edit_date": 1558539430, "question_id": 56258452, "link": "https://stackoverflow.com/questions/56258452/why-is-my-python-script-not-running-from-command-line", "title": "Why is my python script not running from command line?", "body": "<p>I am trying to run a simple python script from my command line. It works fine when I run the python script on its own but when I call it from the command line nothing happens. I don't even get an error. Python is added to my path. This is what I'm doing.</p>\n\n<pre><code>cmd C:\\users\\RGilsburg\\Desktop\\a\\untitled1.py\n</code></pre>\n\n<p>The command prompt just proceeds to print the Microsoft Version and copyright details.</p>\n\n<p>Anyone know what is causing this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1558533052, "post_id": 56258346, "comment_id": 99133393, "body": "What have you tried so far? If you need a hint: use <code>Find</code> to find your expected value, then set your range and assign it to an array"}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1558534726, "last_edit_date": 1558534726, "creation_date": 1558534397, "answer_id": 56258872, "question_id": 56258346, "link": "https://stackoverflow.com/questions/56258346/excel-vba-find-cell-and-add-to-dynamic-array/56258872#56258872", "title": "Excel VBA - Find cell and add to dynamic array", "body": "<p>Something like this should work for you.  It's a relatively simple task, most of the code here is just error checking.</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rFindText As Range\n    Dim rFindBlank As Range\n    Dim rData As Range\n    Dim aData() As Variant\n    Dim sSearchCol As String\n    Dim sFind As String\n    Dim vData As Variant\n\n    'Adjust these variables to suit your needs\n    Set ws = ActiveWorkbook.ActiveSheet\n    sSearchCol = \"C\"\n    sFind = \"Find4\"\n\n    'Find the text you're looking for\n    Set rFindText = ws.Columns(sSearchCol).Find(sFind, ws.Cells(ws.Rows.Count, sSearchCol), xlValues, xlWhole, , xlNext)\n    If rFindText Is Nothing Then\n        'Text not actually found, error out\n        MsgBox \"No cell found to have [\" &amp; sFind &amp; \"]\", , \"Error\"\n        Exit Sub\n    ElseIf rFindText.Row = 1 Then\n        'Text found, but it's in row 1 so it can't have any data above it, error out\n        MsgBox \"[\" &amp; sFind &amp; \"] found but there is no data for it.\", , \"Error\"\n        Exit Sub\n    End If\n\n    'Text found and it's not in row 1, now find the first blank cell above the found text\n    Set rFindBlank = ws.Range(sSearchCol &amp; 1, rFindText).Find(vbNullString, rFindText, xlValues, xlWhole, , xlPrevious)\n    If rFindBlank Is Nothing Then\n        'No blank row found above it, assume the data starts at row 1 and set your data range\n        Set rData = ws.Range(sSearchCol &amp; 1, rFindText.Offset(-1))\n    ElseIf rFindBlank.Row + 1 = rFindText.Row Then\n        'Blank cell found, but it's immediately above the found text, so there's no data; error out\n        MsgBox \"[\" &amp; sFind &amp; \"] found but there is no data for it.\", , \"Error\"\n        Exit Sub\n    Else\n        'Blank cell found and it's not immediately above the found text, set your data range\n        Set rData = ws.Range(rFindBlank.Offset(1), rFindText.Offset(-1))\n    End If\n\n    'To avoid an error populating the array, check if the data range is only a single cell\n    If rData.Cells.Count = 1 Then\n        'Data is a single cell, need to redim and then populate array\n        ReDim aData(1 To 1, 1 To 1)\n        aData(1, 1) = rData.Value\n    Else\n        'Data is more than one cell, can populate array directly\n        aData = rData.Value\n    End If\n\n    'Array now populated with the desired data, do something with it here\n    For Each vData In aData\n        MsgBox vData\n    Next vData\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 56258872, "answer_count": 1, "score": 0, "last_activity_date": 1558534726, "creation_date": 1558532787, "question_id": 56258346, "link": "https://stackoverflow.com/questions/56258346/excel-vba-find-cell-and-add-to-dynamic-array", "title": "Excel VBA - Find cell and add to dynamic array", "body": "<p>I have column C with the following structure:</p>\n\n<pre><code>[blank cell]\nitem1.1\nitem1.2\nitem1.3\nFind1\n[blank cell]\nitem2.1\nitem2.2\nFind2\n[blank cell]\nitem3.1\nitem3.2\nitem3.3\nFind3\n[blank cell]\nand so on...\n</code></pre>\n\n<p>I am looking for a macro that finds let's say <code>\"Find2\"</code> and then adds all items above <code>\"Find2\"</code> (until the first blank cell is reached) to a dynamic VBA array. In this example, the array will have <code>item2.1</code> and <code>item2.2</code>. Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba", "charts", "tooltip", "gantt-chart"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1558534091, "post_id": 56258164, "comment_id": 99134127, "body": "Hmmm. Not sure if this is possible. If you protect using <code>DrawingObjects = False</code>, the user will be able to activate the chart, but also edit and delete it..."}], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 1075025, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82e99bd3acad18b88bbe2e5e66c108e2?s=128&d=identicon&r=PG", "display_name": "Muk Bo", "link": "https://stackoverflow.com/users/1075025/muk-bo"}, "edited": false, "score": 0, "creation_date": 1558619862, "post_id": 56259144, "comment_id": 99168061, "body": "Thank you very much for the prompt reply... I will disable editing/protect the chart on click and reactivate or un-protect it on mouse move. Let us see if this fixes it. Will keep posting updates here..."}], "tags": [], "owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "is_accepted": false, "score": 0, "last_activity_date": 1558536534, "last_edit_date": 1558536534, "creation_date": 1558535223, "answer_id": 56259144, "question_id": 56258164, "link": "https://stackoverflow.com/questions/56258164/how-do-i-display-tool-tip-on-an-excel-column-chart-contained-in-a-sheet-that-is/56259144#56259144", "title": "How do I display Tool-tip on an excel column chart contained in a sheet that is protected(UserInterfaceOnly)?", "body": "<p>I think that it is possible (using Excel 365 and I think 2007 and newer):</p>\n\n<p>1) Unlock Your worksheet.</p>\n\n<p>2) Right click on Your chart and choose \"Assign macro...\" then assign the macro that is displaying tooltip for this chart.</p>\n\n<p>3) Lock Your worksheet with disabling objects edition.</p>\n\n<p>When You click on Your chart the assigned macro will fire (and display tooltip).\nIt is not possible to right click or edit the chart and You are able to display tooltip.</p>\n\n<p>There are also events that can fire appropraite macro, e. g. to unprotect worksheet (on activate) and protect on deactivate. You can also catch when user tries to edit chart by using event on click and disabling it:\n<a href=\"https://docs.microsoft.com/en-us/office/vba/excel/concepts/events-worksheetfunctions-shapes/chart-object-events\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/excel/concepts/events-worksheetfunctions-shapes/chart-object-events</a></p>\n"}], "owner": {"reputation": 424, "user_id": 1075025, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/82e99bd3acad18b88bbe2e5e66c108e2?s=128&d=identicon&r=PG", "display_name": "Muk Bo", "link": "https://stackoverflow.com/users/1075025/muk-bo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558536534, "creation_date": 1558532152, "question_id": 56258164, "link": "https://stackoverflow.com/questions/56258164/how-do-i-display-tool-tip-on-an-excel-column-chart-contained-in-a-sheet-that-is", "title": "How do I display Tool-tip on an excel column chart contained in a sheet that is protected(UserInterfaceOnly)?", "body": "<p>I have a stacked column chart with many series and with legend etc. I am having to display a tooltip when the mouse hovers over the series and the good thing is I achieved that using code from <a href=\"https://www.clearlyandsimply.com/clearly_and_simply/2016/08/customizable-tooltips-on-excel-charts.html\" rel=\"nofollow noreferrer\">Here</a>.\nOnly problem is I want the user not to delete the chart or move it. So I protect the sheet with</p>\n\n<p><code>ActiveWorkbook.Worksheets(\"Sheet1\").Protect Password:=\"Password\", UserInterfaceOnly:=True</code></p>\n\n<p>Now since I have protected it the macro can make the chart active and still work with it but user cannot activate it. My tooltip program works only if user can activate the chart.\nHere is a snap(Dummy)</p>\n\n<p><a href=\"https://i.stack.imgur.com/zo0ds.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zo0ds.png\" alt=\"Tooltip shows on one of the series in Picture\"></a></p>\n\n<p>How do I keep the protection of the sheet as well as allow user to activate chart which displays the tooltip?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1558532478, "post_id": 56257975, "comment_id": 99133022, "body": "You are not very clear in your request... whole worksheet? whole workbook? Either way, I would get all data into an array for each worksheet, get the row numbers to be deleted, then delete them (looping directly over your data can be slow to extremely slow depending how much data you have)."}], "answers": [{"comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1558532757, "post_id": 56258239, "comment_id": 99133193, "body": "Is great, unless you have lots and lots of data... this will be proportionally slower."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1558532900, "post_id": 56258239, "comment_id": 99133288, "body": "I added a second answer."}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1558532414, "creation_date": 1558532414, "answer_id": 56258239, "question_id": 56257975, "link": "https://stackoverflow.com/questions/56257975/how-to-delete-rows-that-contains-value-invoiced-in-whole-worksheet/56258239#56258239", "title": "How to delete rows that contains value &quot;Invoiced&quot; in whole worksheet", "body": "<p>Loop through every cell within every row within <code>activesheet.usedrange</code>:</p>\n\n<pre><code>Private Sub BoomShakalaka_Click()\n    For r = ActiveSheet.UsedRange.Rows.Count To 1 Step -1\n        For Each c In ActiveSheet.UsedRange.Rows(r).Cells\n            If c.Value = \"Invoiced\" Then\n                c.EntireRow.Delete\n                Exit For\n            End If\n        Next c\n    Next r\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11539528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OHhCXkSYBIc/AAAAAAAAAAI/AAAAAAAAABE/sdiMZPMyUfc/photo.jpg?sz=128", "display_name": "Mxurr", "link": "https://stackoverflow.com/users/11539528/mxurr"}, "edited": false, "score": 0, "creation_date": 1558533793, "post_id": 56258375, "comment_id": 99133922, "body": "Thank you Greg, it is working great for me. I have one more question. Can i just add &quot;or&quot; if i would like to add another value like for example &quot;Delivered&quot;?"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 11, "user_id": 11539528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OHhCXkSYBIc/AAAAAAAAAAI/AAAAAAAAABE/sdiMZPMyUfc/photo.jpg?sz=128", "display_name": "Mxurr", "link": "https://stackoverflow.com/users/11539528/mxurr"}, "edited": false, "score": 0, "creation_date": 1558533984, "post_id": 56258375, "comment_id": 99134058, "body": "@Mxurr if is working great for you, probably you don&#39;t have lots of data... because using find is about as slow as using for each cell in my experience at least. Anyways, kudos to Greg for coming up with 2 solutions really fast."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1558535740, "post_id": 56258375, "comment_id": 99135166, "body": "No &quot;or&quot; won&#39;t work. IF you have just one more word, just copy and paste the code into a new sub with the word changed. If you have maybe more words, then I would suggest you put a string parameter into the sub definition, so you can call the same sub with different words."}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1558532880, "creation_date": 1558532880, "answer_id": 56258375, "question_id": 56257975, "link": "https://stackoverflow.com/questions/56257975/how-to-delete-rows-that-contains-value-invoiced-in-whole-worksheet/56258375#56258375", "title": "How to delete rows that contains value &quot;Invoiced&quot; in whole worksheet", "body": "<p>Alternatively, you could do it by using find. This will be faster than my other answer if there is a lot of data:</p>\n\n<pre><code>sub BoomShakalaka_Click()\n    screenupdating = false\n    On Error GoTo exitSub\n\n    ActiveSheet.UsedRange.SpecialCells(xlLastCell).select\n\n    do while true\n        Cells.Find(What:=\"Invoiced\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n        xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False _\n        , SearchFormat:=False).Activate\n        Selection.EntireRow.Delete\n\n    Loop\n\nexitSub:\n    screenupdating = True\n    Exit Sub\nend sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 1, "creation_date": 1558534048, "post_id": 56258614, "comment_id": 99134095, "body": "What if the value <code>Invoiced</code> is in multiple columns of the same row? Seems like you need to exit the inner loop?"}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 1, "last_activity_date": 1558534213, "last_edit_date": 1558534213, "creation_date": 1558533537, "answer_id": 56258614, "question_id": 56257975, "link": "https://stackoverflow.com/questions/56257975/how-to-delete-rows-that-contains-value-invoiced-in-whole-worksheet/56258614#56258614", "title": "How to delete rows that contains value &quot;Invoiced&quot; in whole worksheet", "body": "<p>I want to add here my idea of using arrays instead, so you only access the worksheet when you read the data, and then when you delete the rows.</p>\n\n<pre><code>Option Explicit\n\nSub deleteInvoiced()\n\nWith Application\n    .ScreenUpdating = False\n    .DisplayAlerts = False\nEnd With\n\nDim wb As Workbook: Set wb = ActiveWorkbook         'or ThisWorkbook, or the name of the workbook where data is\nDim ws As Worksheet\nDim R As Long, C As Long, X As Long\nDim lRow As Long, lCol As Long\n\nDim arrData\n\n    For Each ws In wb.Worksheets\n        lRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).row                     'Get the last row in the current sheet\n        lCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column           'Get the last column in the current sheet\n\n        arrData = ws.Range(ws.Cells(1, 1), ws.Cells(lRow, lCol))\n\n        For R = UBound(arrData) To LBound(arrData) Step -1\n            For C = UBound(arrData, 2) To LBound(arrData, 2) Step -1\n                If arrData(R, C) = \"Invoiced\" Or arrData(R, C) = \"Delivered\" Then\n                    'Now delete the rows\n                    ws.Cells(R, C).EntireRow.Delete\n                    Exit For 'Exit here in case multiple \"Invoice\" or \"Delivered\" in the same row (WHY?!!). Thanks @Brian.\n                End If\n            Next C\n        Next R\n    Next ws\n\nWith Application\n    .ScreenUpdating = True\n    .DisplayAlerts = True\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>PS: There is no error handling, but i leave that to you.</p>\n"}, {"tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1558542168, "last_edit_date": 1558542168, "creation_date": 1558541734, "answer_id": 56261114, "question_id": 56257975, "link": "https://stackoverflow.com/questions/56257975/how-to-delete-rows-that-contains-value-invoiced-in-whole-worksheet/56261114#56261114", "title": "How to delete rows that contains value &quot;Invoiced&quot; in whole worksheet", "body": "<p>Here's another interesting way. It assumes your data starts in cell <code>A1</code> and is contiguous. </p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestDeleteInvoiced()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim arr As Variant\n    Dim arr1() As Variant\n    Dim row As Long\n    Dim col As Long\n    Dim i As Long\n\n    Set wb = ActiveWorkbook\n    i = 1\n    ReDim arr1(1 To 14)\n\n    For Each ws In wb.Worksheets\n        arr = ws.Range(\"A1\").CurrentRegion\n\n        For row = UBound(arr, 1) To LBound(arr, 1) Step -1\n            For col = UBound(arr, 2) To LBound(arr, 2) Step -1\n                If arr(row, col) = \"Invoiced\" Then\n                    arr1(i) = row &amp; \":\" &amp; row\n                    i = i + 1\n                        'This If statement ensures that the Join function is less than 255 characters.\n                        If i = 15 Then\n                            ws.Range(Join(arr1, \", \")).EntireRow.Delete\n                            ReDim arr1(1 To 14)\n                            i = 1\n                        End If\n                    Exit For\n                End If\n            Next col\n        Next row\n\n        ReDim Preserve arr1(1 To i - 1)\n        ws.Range(Join(arr1, \", \")).EntireRow.Delete\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>Note: Deleting a range of non-contiguous rows cannot exceed a 255 character parameter. <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/25944-delete-multiple-rows-non-contiguous\" rel=\"nofollow noreferrer\">Link</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11539528, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OHhCXkSYBIc/AAAAAAAAAAI/AAAAAAAAABE/sdiMZPMyUfc/photo.jpg?sz=128", "display_name": "Mxurr", "link": "https://stackoverflow.com/users/11539528/mxurr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1558542168, "creation_date": 1558531614, "last_edit_date": 1558532072, "question_id": 56257975, "link": "https://stackoverflow.com/questions/56257975/how-to-delete-rows-that-contains-value-invoiced-in-whole-worksheet", "title": "How to delete rows that contains value &quot;Invoiced&quot; in whole worksheet", "body": "<p>I have a lot of Excels from different modules with different column layouts (purchase orders, Sales orders, Production orders, etc.).</p>\n\n<p>I want to delete every row that contains value \"Invoiced\".</p>\n\n<p>I was able to create simple code where only one column (\"J\") is checked, but I need whole worksheet to be checked.</p>\n\n<pre><code>Private Sub BoomShakalaka_Click()\n\n    Application.ScreenUpdating = False\n    ow = Cells(Rows.Count, \"J\").End(xlUp).Row\n    For r = ow To 1 Step -1\n        If Cells(r, \"J\") = \"Invoiced\" Then Rows(r).Delete\n\n    Next\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I expect that after I run this function, it will check the whole workbook and delete every row which contains the value \"Invoiced\".</p>\n"}, {"tags": ["vba", "datetime", "ms-access", "parsing"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7810207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26d53e7dce3668d36c8e62206e9ce62f?s=128&d=identicon&r=PG&f=1", "display_name": "Swellionite", "link": "https://stackoverflow.com/users/7810207/swellionite"}, "edited": false, "score": 0, "creation_date": 1558535242, "post_id": 56258980, "comment_id": 99134851, "body": "Thank you. I&#39;m sure I&#39;ll be able to get by with this."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1558534708, "creation_date": 1558534708, "answer_id": 56258980, "question_id": 56257924, "link": "https://stackoverflow.com/questions/56257924/how-to-extract-only-specific-date-times-in-the-following-format-time-am-pm-es/56258980#56258980", "title": "How to extract only specific date/times in the following format: (time am/pm (EST) date) in vba access", "body": "<p>You can use an expression like this:</p>\n\n<pre><code>TextDate = \"12:13 a.m. (EST) July 30\"\nTrueDate = CDate(Split(TextDate, \")\")(1)) + CDate(Replace(Split(TextDate, \"(\")(0), \".\", \"\"))\n</code></pre>\n\n<p>That doesn't, however, take the <em>timezone</em> into account - that would be a task of its own. And it has no idea of the year, thus the current year is returned.</p>\n"}], "owner": {"reputation": 11, "user_id": 7810207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26d53e7dce3668d36c8e62206e9ce62f?s=128&d=identicon&r=PG&f=1", "display_name": "Swellionite", "link": "https://stackoverflow.com/users/7810207/swellionite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56258980, "answer_count": 1, "score": 0, "last_activity_date": 1594778928, "creation_date": 1558531443, "last_edit_date": 1594778928, "question_id": 56257924, "link": "https://stackoverflow.com/questions/56257924/how-to-extract-only-specific-date-times-in-the-following-format-time-am-pm-es", "title": "How to extract only specific date/times in the following format: (time am/pm (EST) date) in vba access", "body": "<p>I've been tasked with going through a database that dedicates a column to a description of the event that has occurred in the business and splitting the description into multiple separate columns. The individuals who enter these messages are giving a basic description of the event and the time and date at which it had occurred. Eventually these vba commands will be translated to SQL equivalents so the programmers can implement this into the system, but for now I'm working in vba (which I just started learning yesterday) so that I can run queries to see if the code I'm writing actually works.</p>\n\n<p>Anyway, the problem that I'm having is the formal of the date and time. One of the entries is:</p>\n\n<p>12:13 a.m. (EST) July 30</p>\n\n<p>another example is:</p>\n\n<p>01:49 (GMT) Feb. 13</p>\n\n<p>As you can see, they are using abbreviations for only some of the months, and are reporting the time in different time-zones, which makes this even more complex.</p>\n\n<p>Some entries don't have a leading 0 for the time.</p>\n\n<p>I was wondering if you had any ideas on where to start. Initially I thought about looking for the (EST) or (GMT) parts of the string and then taking a chunk out from either sides of it, but I'm not quite sure that would work seeing as some months are abbreviated and some times dont have leading zeroes.</p>\n\n<p>Also, I should say that these times are within the long message string itself. There is no standard on where these times are placed within the string.</p>\n\n<p>Any help would be fantastic - really If you could just point me in the right direction, or even tell me that this isn't worth it that would be a big help.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "merge"], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1558531739, "last_edit_date": 1558531739, "creation_date": 1558531576, "answer_id": 56257961, "question_id": 56257475, "link": "https://stackoverflow.com/questions/56257475/in-excel-how-can-i-use-vba-to-dynamically-merge-cells-with-same-value/56257961#56257961", "title": "In Excel, how can I use VBA to dynamically merge cells with same value?", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastColumn As Long, StartPoint As Long, EndPoint As Long, i As Long, y As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'Find the last column of row 1\n         LastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        'Set StartPoint\n        StartPoint = 1\n\n        'Loop row 1\n        For i = 1 To LastColumn\n\n            If i = StartPoint Then\n\n                For y = i + 1 To LastColumn\n\n                    If .Cells(1, i).Value &lt;&gt; .Cells(1, y).Value Then\n\n                        EndPoint = y - 1\n                        Exit For\n\n                    End If\n\n                Next y\n\n                Application.DisplayAlerts = False\n\n                    With .Range(.Cells(1, StartPoint), Cells(1, EndPoint))\n                        .Merge\n                        .HorizontalAlignment = xlCenter\n                        .VerticalAlignment = xlCenter\n                    End With\n\n                Application.DisplayAlerts = True\n\n                StartPoint = y\n                EndPoint = 0\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1558532026, "creation_date": 1558532026, "answer_id": 56258118, "question_id": 56257475, "link": "https://stackoverflow.com/questions/56257475/in-excel-how-can-i-use-vba-to-dynamically-merge-cells-with-same-value/56258118#56258118", "title": "In Excel, how can I use VBA to dynamically merge cells with same value?", "body": "<p>This is the one I use.</p>\n\n<pre><code>Sub MergeSame()\n    Dim rng As Range\n    Dim First As Range\n    Dim Last As Range\n\n    Set rng = Selection\n\n    If rng.Rows.Count &gt; 1 Then Exit Sub\n\n    For i = 1 To rng.Columns.Count + 1\n        If rng.Cells(1, i).Value &lt;&gt; PreviousValue Then\n            If Not (First Is Nothing) Then\n                Set Last = rng.Cells(1, i - 1)\n                Range(First, Last).Merge\n            End If\n            Set First = rng.Cells(1, i)\n            PreviousValue = rng.Cells(1, i).Value\n        Else\n            rng.Cells(1, i).Clear\n        End If\n\n        rng.Cells(1, i).HorizontalAlignment = xlCenter\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 11539473, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o9ycK1DDzDs/AAAAAAAAAAI/AAAAAAAAwIE/bwFTGJUrecE/photo.jpg?sz=128", "display_name": "Kaue ", "link": "https://stackoverflow.com/users/11539473/kaue"}, "is_accepted": false, "score": 0, "last_activity_date": 1558611455, "creation_date": 1558611455, "answer_id": 56274373, "question_id": 56257475, "link": "https://stackoverflow.com/questions/56257475/in-excel-how-can-i-use-vba-to-dynamically-merge-cells-with-same-value/56274373#56274373", "title": "In Excel, how can I use VBA to dynamically merge cells with same value?", "body": "<p>Thank you both!</p>\n\n<p>You helped me in creating my own solution. </p>\n\n<p>It's made of A LOT (350+ lines) of ifs and elses... :P</p>\n\n<p>But it works!</p>\n"}], "owner": {"reputation": 39, "user_id": 11539473, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o9ycK1DDzDs/AAAAAAAAAAI/AAAAAAAAwIE/bwFTGJUrecE/photo.jpg?sz=128", "display_name": "Kaue ", "link": "https://stackoverflow.com/users/11539473/kaue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1558611455, "creation_date": 1558530223, "last_edit_date": 1558531725, "question_id": 56257475, "link": "https://stackoverflow.com/questions/56257475/in-excel-how-can-i-use-vba-to-dynamically-merge-cells-with-same-value", "title": "In Excel, how can I use VBA to dynamically merge cells with same value?", "body": "<p>I am creating an excel for project management and on the Gantt part, it would be good to have both days and weeknum as information. </p>\n\n<p><a href=\"https://i.stack.imgur.com/mST7K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mST7K.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see on the picture, the scroll bar on top makes the table change, so the merge would also have to change as the numbers move around.</p>\n\n<p>I have not tried much, because I just can't possibly think of a way of doing this automatically. I want the cells to merge and unmerge because the results will change. </p>\n\n<p>This is what I expect to happen:</p>\n\n<p><a href=\"https://i.stack.imgur.com/f2iZl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f2iZl.png\" alt=\"enter image description here\"></a></p>\n\n<p>If needed, I can show how the scroll works to make it visually easier to understand. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1558529292, "creation_date": 1558529292, "answer_id": 56257182, "question_id": 56257105, "link": "https://stackoverflow.com/questions/56257105/need-a-vba-to-count-the-number-of-entries-in-each-sheet-and-list-it-in-separate/56257182#56257182", "title": "Need a VBA to count the number of entries in each sheet and list it in separate sheet", "body": "<p>The COUNTA function counts all entries in a range. A range can be a column. So</p>\n\n<pre><code>   =CountA(A:A)  returns the number of entries in column A\n</code></pre>\n\n<p>You can add the sheet name to refer to a range in a different sheet</p>\n\n<pre><code>  =CountA(sheet2!A:A)  counts all the entries in column A in sheet2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 11539406, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4_mh-PLY7tQ/AAAAAAAAAAI/AAAAAAAACho/tIz50IZ5sTY/photo.jpg?sz=128", "display_name": "Atul", "link": "https://stackoverflow.com/users/11539406/atul"}, "edited": false, "score": 0, "creation_date": 1558590941, "post_id": 56257518, "comment_id": 99152875, "body": "Works like a charm. Thank  you so much. :)"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1558530363, "creation_date": 1558530363, "answer_id": 56257518, "question_id": 56257105, "link": "https://stackoverflow.com/questions/56257105/need-a-vba-to-count-the-number-of-entries-in-each-sheet-and-list-it-in-separate/56257518#56257518", "title": "Need a VBA to count the number of entries in each sheet and list it in separate sheet", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet, LastRowWS As Long, LastRowRS As Long\n\n    'Loop all worksheets\n    For Each ws In ThisWorkbook.Worksheets\n        'Do not count if sheet name is Results. This sheets has the counts\n        With ws\n            If .Name &lt;&gt; \"Results\" Then\n                'Find last row of worksheet ws column A\n                LastRowWS = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n                With ThisWorkbook.Worksheets(\"Results\")\n                    'Find last row of worksheet Results column A\n                    LastRowRS = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n                    'Add the results\n                    .Range(\"A\" &amp; LastRowRS + 1).Value = ws.Name\n                    .Range(\"B\" &amp; LastRowRS + 1).Value = LastRowWS\n                End With\n\n            End If\n\n        End With\n\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong></p>\n\n<p>Column A of each sheet does not have headers.</p>\n\n<p><strong>Sheets Column A</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Ubjuc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ubjuc.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Results:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ZU2WQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZU2WQ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 5, "user_id": 11539406, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4_mh-PLY7tQ/AAAAAAAAAAI/AAAAAAAACho/tIz50IZ5sTY/photo.jpg?sz=128", "display_name": "Atul", "link": "https://stackoverflow.com/users/11539406/atul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 56257518, "answer_count": 2, "score": -2, "last_activity_date": 1558530363, "creation_date": 1558529014, "last_edit_date": 1558529544, "question_id": 56257105, "link": "https://stackoverflow.com/questions/56257105/need-a-vba-to-count-the-number-of-entries-in-each-sheet-and-list-it-in-separate", "title": "Need a VBA to count the number of entries in each sheet and list it in separate sheet", "body": "<p>I have a workbook with multiple sheets. I want to count the number of entries  from column A from each sheet and list them in a final sheet. For example,</p>\n\n<p>Sheet 1 has 30 entries\nSheet 2 has 40 entries\nSheet 3 for listing the number of entries</p>\n\n<p>I am looking for an output in A1 and B1 as:</p>\n\n<p>Sheet 1 30\nSheet 2 40</p>\n\n<p>One of the major challenges is that the number of sheets are not defined. Few of the times it may also reach to 4 to 5 sheets. Can we build a user defined number of sheets to be considered and then run the count command?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1558532264, "post_id": 56256844, "comment_id": 99132872, "body": "Use dictionaries and arrays. It will take seconds to do the job.<a href=\"https://stackoverflow.com/questions/56246138/how-do-i-speed-up-a-double-for-loop-with-if-in-the-inner-loop-in-vba/56246302#56246302\">Here</a> a question similar to yours."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11534881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf517ede75f9a47bc34790e20aa8ae0?s=128&d=identicon&r=PG&f=1", "display_name": "benwalden", "link": "https://stackoverflow.com/users/11534881/benwalden"}, "edited": false, "score": 0, "creation_date": 1558533572, "post_id": 56258366, "comment_id": 99133775, "body": "There are no gaps in key cells...  Column A is the same on both sheets.  Data in &quot;PR Data Windchill&quot; starts on row 2, but data on &quot;PR Data&quot; starts on row 7."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "reply_to_user": {"reputation": 15, "user_id": 11534881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf517ede75f9a47bc34790e20aa8ae0?s=128&d=identicon&r=PG&f=1", "display_name": "benwalden", "link": "https://stackoverflow.com/users/11534881/benwalden"}, "edited": false, "score": 0, "creation_date": 1558534030, "post_id": 56258366, "comment_id": 99134086, "body": "Just needed to change the second &#39;rc&#39; initialisation as above. As Damien correctly called out, Dictionaries are much faster when doing things like this."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558535043, "post_id": 56258366, "comment_id": 99134729, "body": "Dictionaries along with arrays, you are still working on the sheet. Working the sheet taxes the execution time, if you get everything into arrays the execution will be even faster."}, {"owner": {"reputation": 15, "user_id": 11534881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf517ede75f9a47bc34790e20aa8ae0?s=128&d=identicon&r=PG&f=1", "display_name": "benwalden", "link": "https://stackoverflow.com/users/11534881/benwalden"}, "edited": false, "score": 0, "creation_date": 1558536199, "post_id": 56258366, "comment_id": 99135460, "body": "So, my original code only looked at empty cells (Case Is = &quot;&quot;), but I now want to make it work on (Case Is = &quot;Open&quot;, &quot;Under Review&quot;, &quot;Accepted&quot;).  Do I change the Do Until ... = &quot;&quot; to my other cases?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1558603990, "post_id": 56258366, "comment_id": 99159174, "body": "The part to change is <code>Slave.Cells(rc, 7).Text = &quot;&quot;</code>.  So you would have  <code>If Slave.Cells(rc, 7).Text = &quot;&quot; or Slave.Cells(rc, 7).Text = &quot;Open&quot; or ... Then</code>.  There are a few ways to do this but this is the simplest"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": true, "score": 0, "last_activity_date": 1558533984, "last_edit_date": 1558533984, "creation_date": 1558532849, "answer_id": 56258366, "question_id": 56256844, "link": "https://stackoverflow.com/questions/56256844/cell-update-using-app-match-faster-than-app-vlookup/56258366#56258366", "title": "Cell Update using App.Match - Faster than App.VLookup?", "body": "<p>Assuming there are no gaps in Column A on either sheet and the first row of data is Row 1...</p>\n\n<pre><code>Function Update()\n\nDim Master As Worksheet\nDim Slave As Worksheet\n\nSet Master = ThisWorkbook.Worksheets(\"PR Data Windchill\")\nSet Slave = ThisWorkbook.Worksheets(\"PR Data\")\n\nDim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nDim rc As Long\nrc = 1\nDo Until Master.Cells(rc, 1) = \"\"\n    If Not dict.Exists(Master.Cells(rc, 1).Value) Then dict.Add Master.Cells(rc, 1).Value, Master.Cells(rc, 7).Value\n    rc = rc + 1\nLoop\n\nrc = 7 'changed from 1\nDo Until Slave.Cells(rc, 1) = \"\"\n    If Slave.Cells(rc, 7).Text = \"\" Then\n        If dict.Exists(Slave.Cells(rc, 1).Value) Then Slave.Cells(rc, 7) = dict(Slave.Cells(rc, 1).Value)\n    End If\n    rc = rc + 1\nLoop\n\nMsgBox (\"Status Update Complete\")\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11534881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf517ede75f9a47bc34790e20aa8ae0?s=128&d=identicon&r=PG&f=1", "display_name": "benwalden", "link": "https://stackoverflow.com/users/11534881/benwalden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 56258366, "answer_count": 1, "score": 1, "last_activity_date": 1558533984, "creation_date": 1558528161, "question_id": 56256844, "link": "https://stackoverflow.com/questions/56256844/cell-update-using-app-match-faster-than-app-vlookup", "title": "Cell Update using App.Match - Faster than App.VLookup?", "body": "<p>I'm trying to search for a key value of \"PR Data\" looking in \"PR Data Windchill\".  Once found, I'd like to copy the 6th cell to the right of found in \"PR Data Windchill\" and paste back to the original key in the 6th cell to the right in \"PR Data\".</p>\n\n<p>I've tried using Application.VLookup and, although it worked, it was slow.  I'm working with data ranges that are 50,000-100,000 items long.</p>\n\n<pre><code>Function Update()\n\nDim Master As Worksheet\nDim Slave As Worksheet\nDim lrS As Long\nDim i As Long, m, SLookup As Range\n\nSet Master = ThisWorkbook.Worksheets(\"PR Data Windchill\")\nSet Slave = ThisWorkbook.Worksheets(\"PR Data\")\n\nSet SLookup = ThisWorkbook.Worksheets(\"PR Data Windchill\").Columns(1)\n\nlrS = Slave.Cells(Slave.Rows.Count, \"A\").End(xlUp).Row\n\nWith Slave\n    For i = 7 To lrS\n        Select Case .Range(\"G\" &amp; i)\n        Case Is = \"\" '\"Open\", \"Under Review\", \"Accepted\"\n        m = Application.Match(.Rows(i).Cells(1).Value, SLookup, 0)\n        .Rows(i).Cells(1).Offset(0, 6).Copy Slave.Rows(i).Cells(1).Offset(0, 6)\n        End Select\n    Next i\nEnd With\n\nApplication.CutCopyMode = False\n\nMsgBox (\"Status Update Complete\")\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10687939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eddaa5ad89e2579670826d06e0f872b8?s=128&d=identicon&r=PG&f=1", "display_name": "lfdk", "link": "https://stackoverflow.com/users/10687939/lfdk"}, "edited": false, "score": 0, "creation_date": 1558592256, "post_id": 56262413, "comment_id": 99153303, "body": "But if I comment out the select case and the variables to it. the code runs fine with the Item variable. When I recieve an email I get an sms that tels me that &quot;you got new mail send/recieve time&quot; so I added the select case so that I can see who it is from."}, {"owner": {"reputation": 13, "user_id": 10687939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eddaa5ad89e2579670826d06e0f872b8?s=128&d=identicon&r=PG&f=1", "display_name": "lfdk", "link": "https://stackoverflow.com/users/10687939/lfdk"}, "edited": false, "score": 0, "creation_date": 1558609634, "post_id": 56262413, "comment_id": 99162272, "body": "The Item variable is declared  in the  &quot;Sub inboxItems_ItemAdd(ByVal Item As Object)&quot;"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 13, "user_id": 10687939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eddaa5ad89e2579670826d06e0f872b8?s=128&d=identicon&r=PG&f=1", "display_name": "lfdk", "link": "https://stackoverflow.com/users/10687939/lfdk"}, "edited": false, "score": 0, "creation_date": 1558667497, "post_id": 56262413, "comment_id": 99184116, "body": "Thanks for the updated code. Now it&#39;s clear that you are deleting the email that&#39;s passed as the Item parameter in the ItemAdd event, and you&#39;re not setting the OldMessage variable to anything at all. ActiveInspector is of no use - it&#39;s only for open items. The email that&#39;s being added to that folder is not opened."}, {"owner": {"reputation": 13, "user_id": 10687939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eddaa5ad89e2579670826d06e0f872b8?s=128&d=identicon&r=PG&f=1", "display_name": "lfdk", "link": "https://stackoverflow.com/users/10687939/lfdk"}, "edited": false, "score": 0, "creation_date": 1558697108, "post_id": 56262413, "comment_id": 99195655, "body": "Sorry my mistake. I accidently removed the line of code that causes the problem. Underneath &quot;Dim OldMessage As Outlook.MailItem&quot; there shouldt have been &quot;Set OldMessage = Application.ActiveInspector.CurrentItem&quot;. What do you mean that I&#39;m deleting the mail that is passed as the Item. I only delete the Item if it contains &quot;SMS status&quot; in the subject line. But how do I get the Item.  I have tryed to make a &quot;Dim olType As Outlook.MailItem&quot; and &quot;Set olType = Item.ActiveInspector.CurrentItem&quot; insted og the OldMessage. Then I get this error 438 - Object doesn&#39;t support this proberty or method."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 13, "user_id": 10687939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eddaa5ad89e2579670826d06e0f872b8?s=128&d=identicon&r=PG&f=1", "display_name": "lfdk", "link": "https://stackoverflow.com/users/10687939/lfdk"}, "edited": false, "score": 0, "creation_date": 1558720374, "post_id": 56262413, "comment_id": 99207166, "body": "You already have access to the Item object - you are even reading its properties. If you want to cast that to a MailItem variable, just add &quot;Set OldMessage = Item&quot;. Again, you CANNOT USE ActiveInspector - the item is NOT open in its own Inspector window."}, {"owner": {"reputation": 13, "user_id": 10687939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eddaa5ad89e2579670826d06e0f872b8?s=128&d=identicon&r=PG&f=1", "display_name": "lfdk", "link": "https://stackoverflow.com/users/10687939/lfdk"}, "edited": false, "score": 0, "creation_date": 1559025894, "post_id": 56262413, "comment_id": 99278582, "body": "Eric Legault Thanks for your help and time. It works now."}, {"owner": {"reputation": 13, "user_id": 10687939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eddaa5ad89e2579670826d06e0f872b8?s=128&d=identicon&r=PG&f=1", "display_name": "lfdk", "link": "https://stackoverflow.com/users/10687939/lfdk"}, "edited": false, "score": 0, "creation_date": 1559026478, "post_id": 56262413, "comment_id": 99278817, "body": "Hi again Eric. What if I want to check mails not only in the inbox but also in sub folders."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 13, "user_id": 10687939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eddaa5ad89e2579670826d06e0f872b8?s=128&d=identicon&r=PG&f=1", "display_name": "lfdk", "link": "https://stackoverflow.com/users/10687939/lfdk"}, "edited": false, "score": 0, "creation_date": 1559052886, "post_id": 56262413, "comment_id": 99293376, "body": "Create another event handler for the Items.ItemAdd event for that folder&#39;s Items collection"}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": true, "score": 0, "last_activity_date": 1558547518, "creation_date": 1558547518, "answer_id": 56262413, "question_id": 56256764, "link": "https://stackoverflow.com/questions/56256764/how-to-reference-item-that-triggers-itemadd/56262413#56262413", "title": "How to reference item that triggers ItemAdd?", "body": "<p>If there is no open item window of any kind, ActiveInspector will be Nothing.  Also, based on your supplied code sample, the Item variable is not declared or set anywhere, so you'll likely also get an error on this line: </p>\n\n<pre><code>If TypeName(Item) = \"MailItem\" Then\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10687939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eddaa5ad89e2579670826d06e0f872b8?s=128&d=identicon&r=PG&f=1", "display_name": "lfdk", "link": "https://stackoverflow.com/users/10687939/lfdk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 56262413, "answer_count": 1, "score": 1, "last_activity_date": 1605524147, "creation_date": 1558527883, "last_edit_date": 1605524147, "question_id": 56256764, "link": "https://stackoverflow.com/questions/56256764/how-to-reference-item-that-triggers-itemadd", "title": "How to reference item that triggers ItemAdd?", "body": "<p>I'm trying to send a message to my phone when I receive mail at work.</p>\n<p>The macro should send mail to an sms service that converts the mail to an sms and sends it to my phone. The message will contain the mail sender address and the send and receive times.</p>\n<p>I have put together two macros I found by searching the internet.</p>\n<p>The first code is on this link <a href=\"https://www.tachytelic.net/2017/10/how-to-run-a-vba-macro-when-new-mail-is-received-in-outlook/\" rel=\"nofollow noreferrer\" title=\"how-to-run-a-vba-macro-when-new-mail-is-received-in-outlook\">tachytelic.net</a></p>\n<p>The second I found here\n<a href=\"https://stackoverflow.com/questions/40367448/how-to-get-the-sender-of-an-outlook-message\" title=\"how-to-get-the-sender-of-an-outlook-message\">stackoverflow.com</a></p>\n<p>Here is the part of the code that fails.</p>\n<pre><code>'variable for select case\nDim EmailFrom As String\nDim OldMessage As Outlook.MailItem\n\nSet OldMessage = Application.ActiveInspector.CurrentItem\n\n'Puts sender mail address in variable both ordinary mail and Exchange emails.\nSelect Case OldMessage.SenderEmailType\n    Case &quot;EX&quot;\n       EmailFrom = OldMessage.Sender.GetExchangeUser.PrimarySmtpAddress\n    Case Else\n       EmailFrom = OldMessage.SenderEmailAddress\nEnd Select\n\n'Sends E-mail to sms service.\nIf TypeName(Item) = &quot;MailItem&quot; Then\n    With olEmail\n        .BodyFormat = olFormatPlain\n        .To = &quot;some@mail.com&quot;\n        .Subject = &quot;You got a new E-mail!&quot;\n        .Body = EmailFrom &amp; vbCrLf &amp; &quot;Sendt: &quot; &amp; Item.SentOn &amp; vbCrLf &amp; &quot;Modtaget: &quot; &amp; Item.ReceivedTime\n        .Send\n    End With\nEnd If\n</code></pre>\n<p>I get</p>\n<blockquote>\n<p>runtime error 91 - Object variable or With block variable not set.</p>\n</blockquote>\n<p>I tried to use the F8 key but that isn't possible, I don't know why.</p>\n<p>Then I took the original code and pasted it in a module. Then I can use the F8 key to go through the code.</p>\n<p>The error comes when I reach this line.</p>\n<pre><code>Set OldMessage = Application.ActiveInspector.CurrentItem\n</code></pre>\n<p>Here is the whole code</p>\n<pre><code>Option Explicit\nPrivate WithEvents inboxItems As Outlook.Items\nSub Application_Startup()\n  Dim outlookApp As Outlook.Application\n  Dim objectNS As Outlook.NameSpace\n  \n  Set outlookApp = Outlook.Application\n  Set objectNS = outlookApp.GetNamespace(&quot;MAPI&quot;)\n  Set inboxItems = objectNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nSub inboxItems_ItemAdd(ByVal Item As Object)\n\nOn Error GoTo ErrorHandler\n\n'variable for if statments\nDim olApp As Outlook.Application\nDim olEmail As Outlook.MailItem\n\nSet olApp = New Outlook.Application\nSet olEmail = olApp.CreateItem(olMailItem)\n\n'variable for select case\nDim EmailFrom As String\nDim OldMessage As Outlook.MailItem\n\n'Deletes sms status mails I recieve when I mail to sms service\nIf InStr(Item.Subject, &quot;SMS status&quot;) &gt; 0 Then\n    Item.UnRead = False\n    Item.Save\n    Item.Delete\n    End\nEnd If\n\n'Puts sender mail address in variable both ordinary mail and Exchange emails.\nSelect Case OldMessage.SenderEmailType\n    Case &quot;EX&quot;\n       EmailFrom = OldMessage.Sender.GetExchangeUser.PrimarySmtpAddress\n    Case Else\n       EmailFrom = OldMessage.SenderEmailAddress\nEnd Select\n\n'Sends E-mail to sms service.\nIf TypeName(Item) = &quot;MailItem&quot; Then\n    With olEmail\n        .BodyFormat = olFormatPlain\n        .To = &quot;some@mail.com&quot;\n        .Subject = &quot;You got a new E-mail!&quot;\n        .Body = EmailFrom &amp; vbCrLf &amp; &quot;Sendt: &quot; &amp; Item.SentOn &amp; vbCrLf &amp; &quot;Modtaget: &quot; &amp; Item.ReceivedTime\n        .Send\n    End With\nEnd If\n\nExitNewItem:\n    Exit Sub\nErrorHandler:\n    MsgBox Err.Number &amp; &quot; - &quot; &amp; Err.Description\n    Resume ExitNewItem\nEnd Sub \n\n</code></pre>\n<p>Then it is easier to get an overview.</p>\n<p>How do I get the ActiveInspector to se the recieved mail and save it in the OldMessage?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1558526739, "post_id": 56256087, "comment_id": 99129461, "body": "Could you please provide a picture or the expected result?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11539009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb67b54ab7b6bcd5f854fb891a57ebd?s=128&d=identicon&r=PG&f=1", "display_name": "Conor", "link": "https://stackoverflow.com/users/11539009/conor"}, "edited": false, "score": 0, "creation_date": 1558534201, "post_id": 56256396, "comment_id": 99134207, "body": "Thank you for your reply, that ScreenUpdating tip is really beneficial."}], "tags": [], "owner": {"reputation": 83, "user_id": 11464820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a90397304663e503b1f646d4ecffc7?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Carlson", "link": "https://stackoverflow.com/users/11464820/steven-carlson"}, "is_accepted": false, "score": 0, "last_activity_date": 1558526799, "last_edit_date": 1558526799, "creation_date": 1558526619, "answer_id": 56256396, "question_id": 56256087, "link": "https://stackoverflow.com/questions/56256087/copy-the-last-5-cells-in-a-column-until-last-row/56256396#56256396", "title": "Copy the last 5 cells in a column until last row", "body": "<p>it is inefficient to use .Select, here's a great resource: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>To eliminate the screen flashes, put this at the beginning of your code. Remember to turn it back to true at the end. </p>\n\n<pre><code>Application.ScreenUpdating = False\n</code></pre>\n\n<p>You want to use a loop, where the variable i becomes the row number you will reference like so:</p>\n\n<pre><code> Range(\"A\" &amp; i).Value... \n</code></pre>\n\n<p>There are many ways to loop, here is one example:</p>\n\n<pre><code>For i = 1 to 300\n    //All your code here\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": true, "score": 0, "last_activity_date": 1558527918, "creation_date": 1558527918, "answer_id": 56256773, "question_id": 56256087, "link": "https://stackoverflow.com/questions/56256087/copy-the-last-5-cells-in-a-column-until-last-row/56256773#56256773", "title": "Copy the last 5 cells in a column until last row", "body": "<p>If you only want the values (not formulae or formatting) then you can simply use Value=Value...</p>\n\n<pre><code>Dim i As Long, sWs As Excel.Worksheet, tWs As Excel.Worksheet\nSet sWs = ThisWorkbook.Worksheets(\"Late list Sorting\")\nSet tWs = ThisWorkbook.Worksheets(\"Late list\")\nFor i = 2 To 300\n    tWs.Range(tWs.Cells(i + 2, 4), tWs.Cells(i + 2, 8)).Value = sWs.Range(sWs.Cells(i, 1).End(xlToRight), sWs.Cells(i, 1).End(xlToRight).Offset(0, -5)).Value\nNext\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11539009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb67b54ab7b6bcd5f854fb891a57ebd?s=128&d=identicon&r=PG&f=1", "display_name": "Conor", "link": "https://stackoverflow.com/users/11539009/conor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56256773, "answer_count": 2, "score": 0, "last_activity_date": 1558527918, "creation_date": 1558525374, "question_id": 56256087, "link": "https://stackoverflow.com/questions/56256087/copy-the-last-5-cells-in-a-column-until-last-row", "title": "Copy the last 5 cells in a column until last row", "body": "<p>I have a text based system with people's names, and I need to copy and paste the first 4 cells (not a problem) and the last 5 cells to a different worksheet for analysis.</p>\n\n<p>The problem arises with the transfer from the text based system the data is presented in, to the spreadsheet when it comes to people with spaces in their surname (ie, Da Silva).  I use text to columns, which will give me a variant number columns, depending on the number of spaces in the name which is an issue.</p>\n\n<p>I already have a crude solution, but the time it takes and the jumping about between screens while the macro is running looks very unprofessional.  I don't get much spare time at work, and I don't have the tools to test this properly at home.</p>\n\n<p>Can anyone help me get this to loop until the last empty cell, and basically neaten it up a little?</p>\n\n<p>The code, which repeats 300 times, is as following:</p>\n\n<pre><code>Sheets(\"Late list Sorting\").Select\nRange(\"A2\").End(xlToRight).Select\nRange(ActiveCell.Offset(0, 0), ActiveCell.Offset(0, -5)).Select\nSelection.Copy\nSheets(\"Late list\").Select\nRange(\"D4\").Select\nActiveSheet.Paste\n\n(...Repeat until...)\n\nRange(\"A300\").End(xlToRight).Select\nRange(ActiveCell.Offset(0, 0), ActiveCell.Offset(0, -5)).Select\nSelection.Copy\nSheets(\"Late list\").Select\nRange(\"D302\").Select\nActiveSheet.Paste\nSheets(\"Late list Sorting\").Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558525837, "post_id": 56256009, "comment_id": 99128948, "body": "Note: Don&#39;t use <code>.Activate</code> and <code>ActiveSheet</code>. Instead use <code>With Worksheets(&quot;HRA&quot;)</code> and start use <code>.Cells</code> without <code>ActiveSheet</code>. You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 1, "user_id": 11539072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a90084656902c0bf9a51864a2b32984?s=128&d=identicon&r=PG&f=1", "display_name": "Uthara", "link": "https://stackoverflow.com/users/11539072/uthara"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558535097, "post_id": 56256009, "comment_id": 99134762, "body": "Will that in mind. Thanks for the article"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11539072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a90084656902c0bf9a51864a2b32984?s=128&d=identicon&r=PG&f=1", "display_name": "Uthara", "link": "https://stackoverflow.com/users/11539072/uthara"}, "edited": false, "score": 0, "creation_date": 1558535041, "post_id": 56257305, "comment_id": 99134727, "body": "I have tried this. But the same issue. Excel is going to &#39;not responding&#39; mode. The volume of data is huge."}], "tags": [], "owner": {"reputation": 1, "user_id": 11539540, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/59cfa7f3f86b8910b27c31faf3b67789?s=128&d=identicon&r=PG", "display_name": "user11539540", "link": "https://stackoverflow.com/users/11539540/user11539540"}, "is_accepted": false, "score": 0, "last_activity_date": 1558529667, "creation_date": 1558529667, "answer_id": 56257305, "question_id": 56256009, "link": "https://stackoverflow.com/questions/56256009/how-to-do-vlookup-to-a-dynamic-table-and-autofill-without-using-loop/56257305#56257305", "title": "how to do vlookup to a dynamic table and autofill without using loop", "body": "<p>For all intents and purposes, VLOOKUP simply looks up a value in one column and returns the value in another column for that row.</p>\n\n<pre><code>Option Explicit\n\nSub HRG2HRa()\n\n    Dim i As Long, j As Long, m As Variant\n    Dim hrgA As Variant, hrgK As Variant, hrgBA As Variant\n    Dim hraA As Variant, hra2C As Variant\n\n    With Worksheets(\"HRG\")\n\n        i = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        hrgA = .Range(.Cells(2, \"A\"), .Cells(i, \"A\")).Value2\n        hrgK = .Range(.Cells(2, \"K\"), .Cells(i, \"K\")).Value2\n        hrgBA = .Range(.Cells(2, \"BA\"), .Cells(i, \"BA\")).Value2\n\n    End With\n\n    With Worksheets(\"HRA\")\n\n        i = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        j = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n        hraA = .Range(.Cells(2, \"A\"), .Cells(i, \"A\")).Value2\n        ReDim hra2C(LBound(hraA, 1) To UBound(hraA, 1), 1 To 2)\n\n        For i = LBound(hraA, 1) To UBound(hraA, 1)\n\n            m = Application.Match(hraA(i, 1), hrgA, 0)\n\n            If Not IsError(m) Then\n\n                hra2C(i, 1) = hrgK(m, 1)\n                hra2C(i, 2) = hrgBA(m, 1)\n\n            End If\n\n        Next i\n\n        .Cells(2, j + 1).Resize(UBound(hra2C, 1), UBound(hra2C, 2)) = hra2C\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11539072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a90084656902c0bf9a51864a2b32984?s=128&d=identicon&r=PG&f=1", "display_name": "Uthara", "link": "https://stackoverflow.com/users/11539072/uthara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558529667, "creation_date": 1558525098, "last_edit_date": 1558525489, "question_id": 56256009, "link": "https://stackoverflow.com/questions/56256009/how-to-do-vlookup-to-a-dynamic-table-and-autofill-without-using-loop", "title": "how to do vlookup to a dynamic table and autofill without using loop", "body": "<p>I have 2 tables in different worksheets and i have to do vlookup to get the data from both these dynamic tables. I have done this using a for loop but sue to large data, excel is crashing. Is there any other way to do this?</p>\n\n<p>The columns in the lookup array will be constant. But the rows will keep on changing. </p>\n\n<pre><code>Sheets(\"HRG\").Activate\n\nlastrow = ActiveSheet.UsedRange.Row + ActiveSheet.UsedRange.Rows.Count - 1\nlastcolumn = ActiveSheet.UsedRange.Column + \nActiveSheet.UsedRange.Columns.Count - 1\nSet VLRange = ActiveSheet.Range(Cells(2, 1), Cells(lastrow, lastcolumn))\n\nSheets(\"HRA\").Activate\n\nWith ActiveSheet\n    lastrowHRA = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n\nFor i = 2 To lastrowHRA\n    ActiveSheet.Cells(i, lastColHRA + 1) = Application.VLookup(ActiveSheet.Cells(i, 1), VLRange, 11, False)\n    ActiveSheet.Cells(i, lastColHRA + 2) = Application.VLookup(ActiveSheet.Cells(i, 1), VLRange, 53, False)\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10088615, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nNQJ4epO5VY/AAAAAAAAAAI/AAAAAAAAABs/Om2HeikBI8w/photo.jpg?sz=128", "display_name": "Tardisgx", "link": "https://stackoverflow.com/users/10088615/tardisgx"}, "is_accepted": false, "score": 0, "last_activity_date": 1558526213, "creation_date": 1558526213, "answer_id": 56256287, "question_id": 56255836, "link": "https://stackoverflow.com/questions/56255836/how-to-apply-formula-to-every-cell-in-range-and-print-result-for-each-cell-in-ce/56256287#56256287", "title": "How to Apply Formula to every cell in range and print result for each cell in cell zz new line", "body": "<p><a href=\"https://www.reddit.com/r/excel/comments/brndla/how_to_apply_formula_to_every_cell_in_range_and/\" rel=\"nofollow noreferrer\">https://www.reddit.com/r/excel/comments/brndla/how_to_apply_formula_to_every_cell_in_range_and/</a></p>\n\n<p>Solution Occurred here</p>\n\n<pre><code>    Sub BuildList()\n    Dim c As Range\n    Dim rngInput As Range\n    Dim rngOutput As Range\n    Dim i As Long\n\n    'Ask our user for stuff\n    Set rngInput = Application.InputBox(\"What cells do you want to read?\", \"Input\", , , , , , 8)\n    Set rngOutput = Application.InputBox(\"Where do you want output to go?\", \"Output\", , , , , , 8)\n\n    Application.ScreenUpdating = False\n\n    'Write the answers\n    For Each c In rngInput.Cells\n        rngOutput.Cells(1).Offset(i).Value = ShowFormula(c)\n        i = i + 1\n    Next c\n    Application.ScreenUpdating = True\nEnd Sub\n\n    Function ShowFormula(rng As Range)\n        If rng.HasArray = True Then\n            ShowFormula = \"{\" &amp; rng.Formula &amp; \"}\"\n        Else\n            ShowFormula = \"Sheets(\"\"\" &amp; ActiveSheet.Name &amp; \"\"\"). Range(\"\"\" &amp; rng.Address &amp; \"\"\")\" &amp; \".FormulaR1C1 = \" &amp; \"\"\"\" &amp; rng.FormulaR1C1 &amp; \"\"\"\"\n        End If\n    End Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10088615, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nNQJ4epO5VY/AAAAAAAAAAI/AAAAAAAAABs/Om2HeikBI8w/photo.jpg?sz=128", "display_name": "Tardisgx", "link": "https://stackoverflow.com/users/10088615/tardisgx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558526213, "creation_date": 1558524524, "last_edit_date": 1558524579, "question_id": 56255836, "link": "https://stackoverflow.com/questions/56255836/how-to-apply-formula-to-every-cell-in-range-and-print-result-for-each-cell-in-ce", "title": "How to Apply Formula to every cell in range and print result for each cell in cell zz new line", "body": "<p>My goal is to be able to \"translate\" for lack of a better term; each cell in a sheet range into VBA.</p>\n\n<p>This means I can instantly take an existing workbook and produce VBA to recreate it.</p>\n\n<p>So I put this UDF together. It shows a cell as it would appear in VBA. R1C1 format</p>\n\n<pre><code>Function showformula(rng As Range)\n    If rng.HasArray = True Then\n        showformula = \"{\" &amp; rng.Formula &amp; \"}\"\n    Else\n        showformula = \"Sheets(\"\"\" &amp; ActiveSheet.Name &amp; \"\"\"). Range(\"\"\" &amp; rng.Address &amp; \"\"\")\" &amp; \".FormulaR1C1 = \" &amp; \"\"\"\" &amp; rng.FormulaR1C1 &amp; \"\"\"\"\n    End If\nEnd Function\n</code></pre>\n\n<p>So 1)show a user select box for specifying a range. Then Click Proceed and 2) the above UDF reads for every cell in the specified range and 3) prints each cell's result on a new line in cell ZZ.</p>\n\n<p>1 is easy enough to googlefu</p>\n\n<p>but 2) &amp; 3) I do not know how I would write it</p>\n"}, {"tags": ["vba", "ms-word", "word-table"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 1, "last_activity_date": 1558526591, "creation_date": 1558526591, "answer_id": 56256386, "question_id": 56255536, "link": "https://stackoverflow.com/questions/56255536/combine-or-merge-word-table-with-condition/56256386#56256386", "title": "Combine or merge word table with condition", "body": "<p>Provided the first table's row count &lt;> 12:</p>\n\n<pre><code>Sub MergeTables()\nDim TblSrc As Table, TblTgt As Table, Rng As Range\nFor Each TblSrc In ActiveDocument.Tables\n    With TblSrc\n      If .Rows.Count = 12 Then\n        .Rows(1).Delete\n        Set Rng = TblTgt.Range\n        Rng.Collapse wdCollapseEnd\n        Rng.FormattedText = .Range.FormattedText\n        .Delete\n      Else\n        Set TblTgt = TblSrc\n      End If\n    End With\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11426405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481b8b845c3c390db81fac5429d7dde5?s=128&d=identicon&r=PG&f=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/11426405/sanjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 56256386, "answer_count": 1, "score": 1, "last_activity_date": 1558619578, "creation_date": 1558523541, "last_edit_date": 1558619578, "question_id": 56255536, "link": "https://stackoverflow.com/questions/56255536/combine-or-merge-word-table-with-condition", "title": "Combine or merge word table with condition", "body": "<p>The word document containing multiple tables. If any table having rows equal to value x (eg. 12) then delete first row and cut that table and paste it below the last row of previous table (means join the selected table with previous table at the end). The below code delete the first row but pasting the same table above the selected table. I have used copy in below code instead of cut.</p>\n\n<pre><code>Private Sub MergeTables()\nDim tbl As Table, r As Row\nDim i As Integer\n\nWith ActiveDocument\nFor Each tbl In ActiveDocument.Tables\n    If tbl.Rows.Count = 12 Then\n    With tbl\n    .Rows(1).Delete\n    tbl.Range.Copy 'Need to paste below last row of previous table\n\n    'tbl.Range.GoTo What:=wdGoToTable, Which:=wdGoToPrevious 'Pasting above the same table\n    tbl.Range.PasteAndFormat wdFormatOriginalFormatting\n    End With\n    End If\n\nNext tbl\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba", "dao", "ms-access-2016"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1558523412, "post_id": 56255344, "comment_id": 99127650, "body": "Not an answer to your question, hence just a comment but that is not how to concatenate your SQL strings in VBA. <code>sqlTxtSelect</code> looks okay, but the other two are resulting in <code>False</code>."}, {"owner": {"reputation": 355, "user_id": 5346843, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8b14e611cc6e48b110b7becdcb0b25b6?s=128&d=identicon&r=PG&f=1", "display_name": "PetGriffin", "link": "https://stackoverflow.com/users/5346843/petgriffin"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1558524659, "post_id": 56255344, "comment_id": 99128338, "body": "Thx CLR.  I have corrected that but still get the same issue"}], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 5346843, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8b14e611cc6e48b110b7becdcb0b25b6?s=128&d=identicon&r=PG&f=1", "display_name": "PetGriffin", "link": "https://stackoverflow.com/users/5346843/petgriffin"}, "is_accepted": true, "score": 0, "last_activity_date": 1558524831, "creation_date": 1558524831, "answer_id": 56255934, "question_id": 56255344, "link": "https://stackoverflow.com/questions/56255344/error-424-object-required-after-null-sql-query/56255934#56255934", "title": "Error 424 object required after NULL SQL query", "body": "<p>The problem lies with the statement</p>\n\n<pre><code>DoCmd.RunSQL (sqlTxtInsert)\n</code></pre>\n\n<p>If I change this to </p>\n\n<pre><code>db.Execute (sqlTxtInsert)\n</code></pre>\n\n<p>then everything is fine.  Should have scrolled to the end of the answer at the original link ....</p>\n"}], "owner": {"reputation": 355, "user_id": 5346843, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8b14e611cc6e48b110b7becdcb0b25b6?s=128&d=identicon&r=PG&f=1", "display_name": "PetGriffin", "link": "https://stackoverflow.com/users/5346843/petgriffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 56255934, "answer_count": 1, "score": 0, "last_activity_date": 1558535835, "creation_date": 1558522894, "last_edit_date": 1558535835, "question_id": 56255344, "link": "https://stackoverflow.com/questions/56255344/error-424-object-required-after-null-sql-query", "title": "Error 424 object required after NULL SQL query", "body": "<p>I am running some EXCEL VBA code to update the contents of an ACCESS database table along the lines suggested here:\n<a href=\"https://stackoverflow.com/questions/6913258/if-rowcount-0-sql-syntax-error-in-access\">IF @@Rowcount = 0 -- SQL Syntax Error in Access</a>\n. When I execute the SELECT query, EXCEL VBA gives this error message:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Run-time error 424: Object required\n</code></pre>\n\n<p>I extracted the SQL string from the VBA Watch window and ran it as a Query in ACCESS. The first time I did this, there were no records becasue the table was empty, so I ran the INSERT query in ACCESS and then tried running the VBA code but got the same error message.</p>\n\n<p>The code is here:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public db As DAO.Database\n\n' Open database\n\nPublic Sub OpenMdtDatabase()\n    Set db = DBEngine(0).OpenDatabase(\"SL_MDT_data_v1.accdb\")\nEnd Sub\n\n' Update DB table\n\nSub UpdateDb()\n\n' Initialise\n\nDim rs As DAO.Recordset\nSet xlSht = Sheets(\"plot_data\")\n\n' Open database\n\nCall OpenMdtDatabase\n\n' Get the data to store\n\nsname = xlSht.Cells(6, \"R\").Value\nxfill = xlSht.Cells(6, \"S\").Value\nxedge = xlSht.Cells(6, \"T\").Value\nxstyl = xlSht.Cells(6, \"U\").Value\nxsize = xlSht.Cells(6, \"V\").Value\n\n' SQL stuff\n\nsqlTxtSelect = \"SELECT SeriesName FROM SeriesProperties WHERE SeriesName ='\" &amp; sname &amp; \"';\"\n\nsqlTxtUpdate = \"UPDATE SeriesProperties \" &amp; _\nsqlTxtUpdate = \"SET SeriesFill = \" &amp; xfill &amp; \", \" &amp; _\nsqlTxtUpdate = \"SeriesEdge = \" &amp; xedge &amp; \", \" &amp; _\nsqlTxtUpdate = \"SeriesStyle = \" &amp; xstyl &amp; \", \" &amp; _\nsqlTxtUpdate = \"SeriesSize = \" &amp; xsize &amp; \" \" &amp; _\nsqlTxtUpdate = \"WHERE SeriesName = '\" &amp; sname &amp; \"';\"\n\nsqlTxtInsert = \"INSERT INTO SeriesProperties('\" &amp; sname &amp; \"') \" &amp; _\nsqlTxtInsert = \"VALUES(\" &amp; xfill &amp; \", \" &amp; xedge &amp; \", \" &amp; xstyl &amp; \", \" &amp; xsize &amp; \");\"\n\nSet rs = db.OpenRecordset(sqlTxtSelect)\n\nIf rs.RecordCount = 0 Then\n    DoCmd.RunSQL (sqlTxtInsert)\nElse\n    DoCmd.RunSQL (sqlTxtUpdate)\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I am guessing that there is something wrong with the SQL SELECT string.  I tried setting this directly using</p>\n\n<pre><code>SELECT SeriesName FROM SeriesProperties WHERE SeriesName ='14/10-2:F2F_SLMC'\n</code></pre>\n\n<p>but still get the same error message.  I have also tried removing the colon ...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 83, "user_id": 11464820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a90397304663e503b1f646d4ecffc7?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Carlson", "link": "https://stackoverflow.com/users/11464820/steven-carlson"}, "edited": false, "score": 0, "creation_date": 1558525537, "post_id": 56255299, "comment_id": 99128807, "body": "@Rawrplus is correct, how about filling in a nearby column with &quot;Completed&quot; and have the form loop to find where the user left off on open?"}, {"owner": {"reputation": 830, "user_id": 5700274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/296611a36356cc767257abb5d4a5f58d?s=128&d=identicon&r=PG&f=1", "display_name": "LetsSeo", "link": "https://stackoverflow.com/users/5700274/letsseo"}, "reply_to_user": {"reputation": 83, "user_id": 11464820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a90397304663e503b1f646d4ecffc7?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Carlson", "link": "https://stackoverflow.com/users/11464820/steven-carlson"}, "edited": false, "score": 0, "creation_date": 1558527811, "post_id": 56255299, "comment_id": 99129977, "body": "@StevenCarlson, current code does it, the problem is if users exit from user form using X button, userform will be promt again for the next row."}], "answers": [{"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 1, "last_activity_date": 1558524973, "creation_date": 1558524973, "answer_id": 56255972, "question_id": 56255299, "link": "https://stackoverflow.com/questions/56255299/how-to-exit-from-the-loop-when-user-clicks-x-button-on-userform/56255972#56255972", "title": "How to exit from the loop when user clicks X button on userform?", "body": "<p>Sadly I don't think this is possible, given <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> doesn't support multi-threading.</p>\n\n<p>If you really insist on asking the user whether to pause, it would be better to simply ask an <code>If</code> conditional during the run-time.</p>\n\n<p>eg.</p>\n\n<pre><code>For i = 1 to myRange.Cells.Count\n\n ' your code here...\n\n If i = myRange.Cells.Count / 2 Then\n    If MsgBox(\"Continue to the for loop?\", vbYesNo) = vbNo Then\n       UnLoad MyForm\n       Exit For\n    End If\n End If\n\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": false, "score": 1, "last_activity_date": 1558525935, "creation_date": 1558525935, "answer_id": 56256212, "question_id": 56255299, "link": "https://stackoverflow.com/questions/56255299/how-to-exit-from-the-loop-when-user-clicks-x-button-on-userform/56256212#56256212", "title": "How to exit from the loop when user clicks X button on userform?", "body": "<p>You need to add DoEvents which will check for a user interaction.  However, simply closing the form will not stop the code from running so you will need to add another controller.</p>\n\n<p>For example</p>\n\n<pre><code>Option Explicit\nPrivate stopCode As Boolean\nPrivate Sub UserForm_Click()\n    Dim i As Long\n    stopCode = False\n    For i = 1 To 1000000\n        Debug.Print i\n        DoEvents\n        If stopCode = True Then Exit For\n    Next\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If MsgBox(\"Do you want to stop\", vbQuestion + vbYesNo) &lt;&gt; vbYes Then Cancel = True\n    stopCode = True\nEnd Sub\n</code></pre>\n\n<p>When the user closes the form they will be asked if they want to stop the code.  If they say yes it closes the form but the <strong>stopCode</strong> 'controller' also makes sure the running code is stopped.</p>\n"}], "owner": {"reputation": 830, "user_id": 5700274, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/296611a36356cc767257abb5d4a5f58d?s=128&d=identicon&r=PG&f=1", "display_name": "LetsSeo", "link": "https://stackoverflow.com/users/5700274/letsseo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558525935, "creation_date": 1558522700, "last_edit_date": 1558523726, "question_id": 56255299, "link": "https://stackoverflow.com/questions/56255299/how-to-exit-from-the-loop-when-user-clicks-x-button-on-userform", "title": "How to exit from the loop when user clicks X button on userform?", "body": "<p>I have vba code below to edit every row one by one on userform interface:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim MyRange As Range\n    Dim cell As Range\n\n    Set MyRange = Range(\"A2\", Range(\"A2\").End(xlDown))\n\n    For Each cell In MyRange            \n        cell.Select\n\n        'Build form            \n        MyForm.Title.Caption = cell.Offset(0, 2)\n\n        If cell.Offset(0, 2) = 1 Then\n            MyForm.Checked.Value = True\n        Else\n            MyForm.Checked.Value = False\n        End If\n\n        'Show form\n        MyForm.Show  \n    Next cell\nEnd Sub\n</code></pre>\n\n<p>I have thousand of rows and I need to give user a some break!</p>\n\n<p>I want this process to pause if user clicks X button, but I couldn't find a way to exit from the loop.</p>\n\n<p>My userform code is like below:</p>\n\n<pre><code>Private Sub Checked_Click()\n    If MyForm.Checked.Value = True Then\n        ActiveCell.Offset(0, 1).Value = 1\n    Else\n        ActiveCell.Offset(0, 1).Value = \"\"\n    End If \nEnd Sub\n\n\nPrivate Sub DoneButton_Click()\n    ActiveCell.Offset(0, 2).Value = 1\n    Unload MyForm \nEnd Sub\n\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = vbFormControlMenu Then\n       MsgBox \"paused\"\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>What I'm trying to accomplish?</strong></p>\n\n<p>I need to stop for each loop at first block of code when users click X button to close the userform. But I don't know how to listen if <code>UserForm_QueryClose</code> called to exit loop from first block of code.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1558525270, "post_id": 56255218, "comment_id": 99128673, "body": "Assuming this is because the Word Application instance has been closed by the user (or maybe another part of the program) what about creating your own instance of <code>Word.Application</code>, and opening the document via that instance. That way, you could hold onto it until you know that everything is finished. Otherwise, I don&#39;t think you have any sort of guarantee of the Application instance&#39;s availability."}, {"owner": {"reputation": 36, "user_id": 9385713, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Adrian Slater", "link": "https://stackoverflow.com/users/9385713/adrian-slater"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1558527250, "post_id": 56255218, "comment_id": 99129702, "body": "I am running it myself, not touching the keyboard while it is running,  So no, the application is not being closed by the user.  The program that calls this routine does creates its own instance of word already.  There is nothing in the code to close the instance of word until the end of the program."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1558545549, "post_id": 56255218, "comment_id": 99140452, "body": "So what does this -- <i>the error is because word no longer exists</i> -- mean? Also, can you read properties on <code>oWdocMove</code>?"}, {"owner": {"reputation": 36, "user_id": 9385713, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Adrian Slater", "link": "https://stackoverflow.com/users/9385713/adrian-slater"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1558627052, "post_id": 56255218, "comment_id": 99172139, "body": "The word application has quit (crashed?) in the middle of the process.  It quits without any error message or interruption to code.  Once the word application has quit, the access code can no longer manipulate any of the word objects in that application.  When the word application quits any open word objects are closed as they only exist in the word application.  At this point I cannot get any properties for the document oWdocMove since it is no longer available to the program.  The program &quot;notices&quot; that word has quit when it tries to do something with a word object and cannot."}], "owner": {"reputation": 36, "user_id": 9385713, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Adrian Slater", "link": "https://stackoverflow.com/users/9385713/adrian-slater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594778947, "creation_date": 1558522451, "last_edit_date": 1594778947, "question_id": 56255218, "link": "https://stackoverflow.com/questions/56255218/my-access-vba-is-giving-an-automation-error-2147023170-800706be-when-automa", "title": "My Access Vba is giving an automation error &#39;-2147023170 (800706be)&#39; when automating word", "body": "<p>I am using a database to extract data that I need to present.  Because I need to present the data in both landscape and portrait an access report will not do the trick.  I am therefore using Access vba to put the data into a word template.  However when I run the code over the full data I keep encountering an automation error.  The word application ceases to exist.</p>\n\n<p>I have queried and I don't think I have any of the common code errors associated with this problem, so no unreferenced word objects etc.  I have also replaced all references to word constants like wdcell with their integer values.  I have run through the code in debug, and when I run through in debug, the code never fails.  I have put in some pauses (a function that waits a specific time and performs DoEvents) to see if that helps</p>\n\n<pre><code>Function MoveMergePaste(wdInputName As String, oWord As Word.Application, oWdocMerged As Word.Document) As Long\nDim oWdocMove As Word.Document\nDim oWdocMoveMerged As Word.Document\nDim rst As Recordset\nDim strSQL As String\n\nOn Error GoTo ERR_MoveMergePaste\n\nPause 1\nstrSQL = \"SELECT T.* FROM tblMovementTemp AS T INNER JOIN tblMovementHeader AS H \"\nstrSQL = strSQL &amp; \"ON T.FundId = H.FundId ORDER BY tblPosition\"\nSet rst = CurrentDb.OpenRecordset(strSQL)\n\nPause 0.5\nSet oWdocMove = oWord.Documents.Open(wdInputName)\nPause 0.5\noWdocMove.Bookmarks(\"PremiumDataStart\").Select\n\nrst.MoveFirst\noWord.Selection.TypeText rst!tblElement\noWord.Selection.MoveRight Unit:=12 '(wdcell)\noWord.Selection.TypeText rst!TotalUnits\nrst.MoveNext\nWhile Not rst.EOF\n    oWord.Selection.MoveRight Unit:=12 '(wdcell)\n    oWord.Selection.TypeText rst!tblElement\n    oWord.Selection.MoveRight Unit:=12 '(wdcell)\n    oWord.Selection.TypeText rst!TotalUnits\n    rst.MoveNext\nWend\n\n'Start mail merge Claims\n'------------------------------------------------\nWith oWdocMove.MailMerge\n    .MainDocumentType = 0 'wdFormLetters\n    .OpenDataSource _\n    Name:=CurrentProject.FullName, _\n    AddToRecentFiles:=False, _\n    LinkToSource:=True, _\n    Connection:=\"QUERY mailmerge\", _\n    SQLStatement:=\"SELECT * FROM [tblMovementHeader] \"\n    .Destination = 0 'wdSendToNewDocument\n    .Execute Pause:=False\nEnd With\n\n'Copy movement data into merged document\n'------------------------------------------------\nSet oWdocMoveMerged = oWord.ActiveDocument\noWdocMoveMerged.Select\noWord.Selection.WholeStory\noWord.Selection.Copy\noWdocMerged.Select\noWord.Selection.EndKey Unit:=6 '(wdstory)\noWord.Selection.PasteAndFormat (wdFormatOriginalFormatting)\n\nMoveMergePaste = 0\n\nEXIT_MoveMergePaste:\n    On Error Resume Next\n    'Close files\n    '------------------------------------------------\n    oWdocMove.Close SaveChanges:=False\n    oWdocMoveMerged.Close SaveChanges:=False\n\n    'Release objects\n    '------------------------------------------------\n    Set oWdocMove = Nothing\n    Set oWdocMoveMerged = Nothing\n    Set rst = Nothing\n    Exit Function\n\nERR_MoveMergePaste:\n    MoveMergePaste = Err.Number\n    MsgBox Err.Description\n    Resume EXIT_MoveMergePaste\n\nEnd Function\n</code></pre>\n\n<p>I pass a string which is for the path of a word template, a word application object, and an existing open word document.  the routine builds a record set of data, opens the word template, finds a bookmark in the template and then writes data from the recordset to the template.  Once it has done this it performs a mail merge on the template and copies the data from the newly created merged document into the open document.  It returns 0 if successful.  It closes the template and merged document and releases the objects.</p>\n\n<p>Mostly it works, but far too often to make it usable I get the automation error. '-2147023170 (800706be)'. The error usually occurs because the word has ceased to exist.  If I break the code the line of code that returns the error is </p>\n\n<p>oWdocMove.Bookmarks(\"PremiumDataStart\").Select</p>\n\n<p>But the line is OK, the error is because word no longer exists.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558524947, "post_id": 56255139, "comment_id": 99128481, "body": "What is your question and what is your issue? You didn&#39;t ask a question yet. Also you should tell where exactly you got stuck or errors. \u2022 You might benefit from reading  <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Also your code cannot work because there is an <code>End If</code> missing right before <code>Next</code>."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1558531603, "post_id": 56255139, "comment_id": 99132408, "body": "I don&#39;t understand what you are asking. Does column A have a list of worksheet names in it? Also, are you using a dictionary object? I don&#39;t see it dimensioned anywhere. If so, how are you allocating it?"}, {"owner": {"reputation": 1, "user_id": 11538884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20141cdb26f8ead746e332b7880b938?s=128&d=identicon&r=PG&f=1", "display_name": "Seanie", "link": "https://stackoverflow.com/users/11538884/seanie"}, "edited": false, "score": 0, "creation_date": 1558533006, "post_id": 56255139, "comment_id": 99133357, "body": "The Macro reads in files from a file directory in a separate column and adjacent to each of these, I want to input these into named tabs(column A). So I want a Macro to fail when trying to import a file in column B if there are duplicate named tabs in Column A."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558530169, "post_id": 56256995, "comment_id": 99131384, "body": "If you want to test for <code>Sheets</code> then <code>Dim ws As Object</code>. If you want to test for <code>Worksheets</code> then <code>Set ws = ThisWorkbook.Worksheets(s)</code> and name function <code>WorksheetExists</code>. \u2022 Why? Because <code>Sheets</code> contains also <code>Charts</code> and not only <code>Worksheets</code>."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1558530229, "last_edit_date": 1558530229, "creation_date": 1558528675, "answer_id": 56256995, "question_id": 56255139, "link": "https://stackoverflow.com/questions/56255139/checking-existing-sheet-names-in-list/56256995#56256995", "title": "Checking Existing Sheet names in list", "body": "<pre><code> Public Function SheetExists(s as string) As Boolean\n     'Returns true if s is the name of a sheet in the current workbook\n     On Error Goto NOPE\n     Dim ws As Worksheet\n     Set ws = ThisWorkbook.Sheets(s)\n     SheetExists = True\n     Exit function\n\n NOPE:\n     SheetExists = False\n End function\n</code></pre>\n\n<p>Once you have this function, you can enter <code>=SheetExists(A1)</code> in cell B1 and it will show true or false. Then drag down the rest of b adjacent to your tab names</p>\n"}], "owner": {"reputation": 1, "user_id": 11538884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e20141cdb26f8ead746e332b7880b938?s=128&d=identicon&r=PG&f=1", "display_name": "Seanie", "link": "https://stackoverflow.com/users/11538884/seanie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1607161213, "creation_date": 1558522186, "last_edit_date": 1607161213, "question_id": 56255139, "link": "https://stackoverflow.com/questions/56255139/checking-existing-sheet-names-in-list", "title": "Checking Existing Sheet names in list", "body": "<p>I want to check whether an existing tab or worksheet is in a list of tab names, say in Column A. Column A is found in a tab called Import RPT.</p>\n<p>If the name exists I want the code to end and create a MsgBox saying that a spreadsheet already exists in row i of column A, if not continue.</p>\n<p>I've combined pieces from Stack Overflow:</p>\n<pre><code>Dim sht As Worksheet, r As Range\n\nWith Sheets(&quot;Import RPT&quot;)\n    For Each sht In Worksheets\n        Set r = sht.Cells.Range(&quot;C2:C&quot; &amp; Count)\n        If Application.WorksheetFunction.CountIf(Range(&quot;rngSheetInclusions&quot;), sht.Name) &gt; 0 Then\n            strResult = strResult &amp; &quot;Duplicate Name: &quot; &amp; r &amp; vbNewLine &amp; &quot;Rows: &quot; &amp; _\n            Left(dict.Item(r), Len(dict.Item(r)) - 1) &amp; vbNewLine &amp; vbNewLine\n            MsgBox strResul\n\n    Next\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1558522324, "post_id": 56255046, "comment_id": 99127114, "body": "hi. whats the value of RC[-8] ?"}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1558522567, "post_id": 56255046, "comment_id": 99127241, "body": "the function will check the existence of a file with the same value as column B and return either &#39;ok&#39; or &#39;missing&#39; in column J. RC[-8] is getting it to look 8 cells to the right"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1558523288, "post_id": 56255046, "comment_id": 99127591, "body": "do u have the FileExists4 function in a module ?"}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1558527312, "post_id": 56255046, "comment_id": 99129730, "body": "no, but it isn&#39;t in a module in the working code"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 1, "creation_date": 1558534937, "post_id": 56255046, "comment_id": 99134663, "body": "i think that FileExist4 must be in a module to be available to excel"}, {"owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "reply_to_user": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1558536716, "post_id": 56255046, "comment_id": 99135745, "body": "Thanks, that has fixed it"}, {"owner": {"reputation": 620, "user_id": 10291096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/907c58bf476bf3db80e304093fbc1cfd?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Curado", "link": "https://stackoverflow.com/users/10291096/luis-curado"}, "edited": false, "score": 0, "creation_date": 1558538229, "post_id": 56255046, "comment_id": 99136767, "body": "nice. dont forguet to mark que answer has good. thanks"}], "owner": {"reputation": 63, "user_id": 6320231, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f13345bbd5d806bce9a4abcf9b7ddfff?s=128&d=identicon&r=PG&f=1", "display_name": "James Hurst", "link": "https://stackoverflow.com/users/6320231/james-hurst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558529919, "creation_date": 1558521908, "last_edit_date": 1558529919, "question_id": 56255046, "link": "https://stackoverflow.com/questions/56255046/vba-userform-to-check-file-exists-in-selected-folder", "title": "VBA userform to check file exists in selected folder", "body": "<p>We copy PDF's from a master folder into a designated project folder, I have created user form which allows the user to check the existence of the PDF file based on the value in row 'B'</p>\n\n<p>I have successfully created a script which will allow me to check the existence of the PDF in the master folder, but this is by providing the folder location in the code. The second folder I need to check will change depending on the location of the project hence why I have the user form to select the folder location</p>\n\n<pre><code>Private Sub slctfldrcmd_Click()\n    Dim fldr As FileDialog\n    Dim sItem As String\n\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        '.InitialFileName = Application.GetSaveAsFilename()\n\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n\n        sItem = .SelectedItems(1)\n    End With\n\nNextCode:\n    GetFolder = sItem\n    choosefldrtb.Value = sItem\n\n    Set fldr = Nothing\nEnd Sub\n\n\nPrivate Sub runcmd_Click()\n    'ActiveSheet.Columns(\"H:K\").ClearContents\n\n    Dim ws As Worksheet\n    Dim R As Range\n\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = True\n    End With\n\n    For Each R In Range(\"G2:G\" &amp; Cells(Rows.Count, \"G\").End(xlUp).Row)\n        If R &lt;&gt; vbNullString Then ActiveSheet.Hyperlinks.Delete       \n    Next R\n\n    For Each R In Range(\"G2:G\" &amp; Cells(Rows.Count, \"G\").End(xlUp).Row)\n        If R &lt;&gt; vbNullString Then Columns(\"J\").ClearContents     \n    Next R\n\n    For Each ws In ThisWorkbook.Worksheets\n        Dim c As Range\n\n        For Each c In Range(\"B2:B\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\n            If c &lt;&gt; vbNullString Then\n                c.Offset(0, 8).Value = \"=IF(FileExists4(RC[-8]), \"\"ok\"\", \"\"missing\"\")\"\n            End If\n        Next c\n    Next ws\n\n    'Call Draw_Clean \n    'Call Hyperlinks2\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = CalcMode\n    End With\n\n    'MsgBox \"PDF's Checked\"          \n    MsgBox \"Drawings in \" &amp; choosefldrtb.Value &amp; \"  Checked\"        \nEnd Sub\n\n\nFunction FileExists4(sFile As String)     \n    sPath = FldrChkuserform.choosefldrtb.Value &amp; \"\\\" &amp; sFile &amp; \".PDF\"\n    FileExists4 = Dir(sPath) &lt;&gt; \"\"\nEnd Function\n</code></pre>\n\n<p>At the moment everything is working apart from the return value in column 'J' which should state \"ok\" or \"missing\" All that happens is \"#NAME?\" I think it has something to do with the value in the text box not transferring through to the 'FileExists4' function?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11538660, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pY7_XRj7iBk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcevFsJ57zOC2ndrp6cYPXyXSZ1nA/mo/photo.jpg?sz=128", "display_name": "DFSK", "link": "https://stackoverflow.com/users/11538660/dfsk"}, "edited": false, "score": 0, "creation_date": 1558525896, "post_id": 56255089, "comment_id": 99128976, "body": "Hi Mohit, Thanks a lot for correcting such a dumb mistake from my side =) For the second part I want to select only one item from the filtered list, not the whole range. Basically, Imagine you are making a Football team, you click on goalkeepers (workbook A) and worbook B will open and give you a list of available GK. From there you have to select one, and that selection should be pasted and showed in Workbook A."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 3, "user_id": 11538660, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pY7_XRj7iBk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcevFsJ57zOC2ndrp6cYPXyXSZ1nA/mo/photo.jpg?sz=128", "display_name": "DFSK", "link": "https://stackoverflow.com/users/11538660/dfsk"}, "edited": false, "score": 0, "creation_date": 1558533877, "post_id": 56255089, "comment_id": 99133983, "body": "Sure... I have added a link in the answer for you to follow. Please mark the answer as accepted. :)"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1558533827, "last_edit_date": 1558533827, "creation_date": 1558522006, "answer_id": 56255089, "question_id": 56254668, "link": "https://stackoverflow.com/questions/56254668/how-to-use-autofilter-from-one-workbook-to-another/56255089#56255089", "title": "How to use autofilter from one workbook to another?", "body": "<p>As I can see you are using the wrong format of Autofilter. Try this line after amending as per your need. Autofilter takes in Criteria1 not Criteria.</p>\n\n<pre><code>ActiveWorkbook.ActiveSheet.Range(\"A9\").AutoFilter Field:=1, Criteria1:=input_db\n</code></pre>\n\n<p>Also you can find more about Autofilter here: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.autofilter\" rel=\"nofollow noreferrer\">Link</a></p>\n\n<p>Let us know if it still doesn't work.</p>\n\n<p>Edit 2 : </p>\n\n<p>You will have to open a input box and select the cell. You can follow the <a href=\"https://stackoverflow.com/questions/22812235/using-vba-to-prompt-user-to-select-cells-possibly-on-different-sheet\">This Link</a> for that. </p>\n"}], "owner": {"reputation": 3, "user_id": 11538660, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pY7_XRj7iBk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcevFsJ57zOC2ndrp6cYPXyXSZ1nA/mo/photo.jpg?sz=128", "display_name": "DFSK", "link": "https://stackoverflow.com/users/11538660/dfsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56255089, "answer_count": 1, "score": 0, "last_activity_date": 1558533827, "creation_date": 1558520647, "question_id": 56254668, "link": "https://stackoverflow.com/questions/56254668/how-to-use-autofilter-from-one-workbook-to-another", "title": "How to use autofilter from one workbook to another?", "body": "<p>I am trying to get a database from Workbook B to autofilter using some input from Workbook A. I am building the macro in Workbook A. </p>\n\n<p>I have the following:\nWorkbook A - Document were you start working\nWorrkbook B - Database, the final objective of this code is to import some info from Workbook B to Workbook A</p>\n\n<p>I need the following:</p>\n\n<ul>\n<li>By double clicking in a column from workbook A, workbook B should open (done)</li>\n<li>The clicked value from workbook A will be saved as a variable, lets call it input_db (done)</li>\n<li>Workbook B will autofilter based on input_db (not done, help required here!)</li>\n<li>The required data is selected from workbook B and imported to workbook A, preferably with a double click as well (not done yet, but if you have any suggestion for this, Ill be gratefull ;))</li>\n</ul>\n\n<p>The process should be repeated several times in a row.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\nDim input_row, input_column As Integer\nDim input_db As String\nDim wbB, wbA As Workbooks\n\nIf Not (Application.Intersect(ActiveCell, [Links]) Is Nothing) Then 'Links is the name of the range where I need the code to be active\nIf ActiveCell.Value &lt;&gt; \"\" Then\n\ninput_row = ActiveCell.row\ninput_column = ActiveCell.Column\ninput_db = ActiveCell.Value\n\nSet database = Workbooks.Open(\"Workbook B location\")\n\n\nActiveWorkbook.ActiveSheet.Range(\"A9\").AutoFilter Field:=1, Criteria:=input_db ' This bit doesnt work as expected\n\n\nEnd If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1558520106, "creation_date": 1558520106, "answer_id": 56254490, "question_id": 56254388, "link": "https://stackoverflow.com/questions/56254388/how-to-fix-run-time-error-1004-cause-by-target-formula-function/56254490#56254490", "title": "How to fix &quot;Run-time error &#39;1004&#39;&quot; cause by Target.Formula function", "body": "<p>In VBA code, you must use commas to separate arguments in functions, even if your local delimiter is semi-colons.</p>\n\n<p>I.e. change the line</p>\n\n<pre><code>Target.Formula = \"=VLOOKUP($I$2;'Raw Data'!$A$1:$AH$5000;4;FALSE)\"\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Target.Formula = \"=VLOOKUP($I$2,'Raw Data'!$A$1:$AH$5000,4,FALSE)\"\n</code></pre>\n\n<p>and see if that works</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5, "user_id": 11538652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366f5126237e2e163d1400acfe118cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver495", "link": "https://stackoverflow.com/users/11538652/oliver495"}, "edited": false, "score": 0, "creation_date": 1558524353, "post_id": 56254611, "comment_id": 99128193, "body": "@Oliver495 If this answered your question please upvote/mark it as solved: <a href=\"https://meta.stackexchange.com/a/5235\">Accepting Answers: How does it work?</a>"}, {"owner": {"reputation": 5, "user_id": 11538652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366f5126237e2e163d1400acfe118cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver495", "link": "https://stackoverflow.com/users/11538652/oliver495"}, "edited": false, "score": 0, "creation_date": 1558528437, "post_id": 56254611, "comment_id": 99130311, "body": "Works so far but I need to add another row that checks if there is a value in column I. Cause if there is no value in column I the code creates an error. Can you help with this one?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 5, "user_id": 11538652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366f5126237e2e163d1400acfe118cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver495", "link": "https://stackoverflow.com/users/11538652/oliver495"}, "edited": false, "score": 0, "creation_date": 1558529223, "post_id": 56254611, "comment_id": 99130768, "body": "You can use <code>Me.Cells(iCell.Row, &quot;I&quot;).Value</code> to access the value in the same row in column I. Use that to buid your check <code>If iCell.Value = vbNullString And Me.Cells(iCell.Row, &quot;I&quot;).Value &lt;&gt; vbNullString Then</code>. Also note that I added <code>Application.EnableEvents = False</code> incuding error handling which is necessary to avoid that writing to the cell triggers another change event (I forgot that)."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1558529401, "last_edit_date": 1558529401, "creation_date": 1558520457, "answer_id": 56254611, "question_id": 56254388, "link": "https://stackoverflow.com/questions/56254388/how-to-fix-run-time-error-1004-cause-by-target-formula-function/56254611#56254611", "title": "How to fix &quot;Run-time error &#39;1004&#39;&quot; cause by Target.Formula function", "body": "<h3>The main issue</h3>\n\n<p>You need to switch the <code>;</code> to <code>,</code> because the <code>.Formula</code> needs to be the original english version of the formula which uses <code>,</code>.</p>\n\n<h3>Your code will fail if <code>Target</code> is a range of multiple cells</h3>\n\n<p>Note that your code will fail if you eg. copy paste a range (not a single cell).</p>\n\n<p>Change it to the following:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Me.Range(\"A2\")) Is Nothing Then Exit Sub\n\n    Application.EnableEvents = False\n    On Error Goto ENABLE_EVENTS\n\n    If Me.Range(\"A2\").Value = vbNullString Then\n        Me.Range(\"A2\").Formula = \"=VLOOKUP($I$2,'Raw Data'!$A$1:$AH$5000,4,FALSE)\"\n    End If\n\nENABLE_EVENTS:\n    Application.EnableEvents = True\n    If Err.Number &lt;&gt; 0 Then Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you need to do it for multiple cells in column A it would look like this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim AffectedRange As Range\n    Set AffectedRange = Intersect(Target, Me.Range(\"A2:A\" &amp; Me.Rows.Count))\n\n    Application.EnableEvents = False\n    On Error Goto ENABLE_EVENTS\n\n    If Not AffectedRange Is Nothing Then\n        Dim iCell As Range\n        For Each iCell In AffectedRange.Cells\n            If iCell.Value = vbNullString Then\n                iCell.Formula = \"=VLOOKUP($I\" &amp; iCell.Row &amp; \",'Raw Data'!$A$1:$AH$5000,4,FALSE)\"\n            End If\n        Next iCell\n    End If\n\nENABLE_EVENTS:\n    Application.EnableEvents = True\n    If Err.Number &lt;&gt; 0 Then Err.Raise Err.Number, Err.Source, Err.Description, Err.HelpFile, Err.HelpContext\nEnd Sub\n</code></pre>\n\n<p>Note that you probably mean to use </p>\n\n<pre><code>\"=VLOOKUP($I\" &amp; iCell.Row &amp; \", 'Raw Data'!$A$1:$AH$5000,4,FALSE)\"\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>\"=VLOOKUP($I$2, 'Raw Data'!$A$1:$AH$5000,4,FALSE)\"\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11538652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366f5126237e2e163d1400acfe118cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver495", "link": "https://stackoverflow.com/users/11538652/oliver495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 56254611, "answer_count": 2, "score": 0, "last_activity_date": 1558529401, "creation_date": 1558519774, "last_edit_date": 1558527205, "question_id": 56254388, "link": "https://stackoverflow.com/questions/56254388/how-to-fix-run-time-error-1004-cause-by-target-formula-function", "title": "How to fix &quot;Run-time error &#39;1004&#39;&quot; cause by Target.Formula function", "body": "<p>I have a file where I want to check if cell \"$A$2\" is empty and if that's true I want to add the formula <code>(=VLOOKUP($I$2;'Raw Data'!$A$1:$AH$5000;4;FALSE)</code> in this cell. Went I run the code below it generates a </p>\n\n<blockquote>\n  <p>Run-tim error '1004' (Application-defined or object defined error).</p>\n</blockquote>\n\n<p>I already played with the target formula and if I take simple formulas like <code>=B1+B2</code> it works and I don^t get an error message. So it seems to be something about the Vlookup formula that causes the error.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If (Target.Cells.Address = \"$A$2\" And Target = vbNullString) Then\n        Target.Formula = \"=VLOOKUP($I$2;'Raw Data'!$A$1:$AH$5000;4;FALSE)\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>I expect the cell <code>\"$A$2\"</code> to show the result of the formula <code>=VLOOKUP($I$2;'Raw Data'!$A$1:$AH$5000;4;FALSE)</code> unless the cell is overwritten manually.</p>\n\n<p>Thanks for your help @P\u1d07\u029c @eirikduade @Gareth!</p>\n\n<p>Now I am trying to do the same for all cells in Column A where there is a value in column I of the same row and I struggle with the .Range function. Could you please give me any suggestions how to fix the following code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim lastRowF As Integer\n    lastRowF = Sheet3.Cells(Sheet3.Rows.Count, \"I\").End(xlUp).Row\n    For j = 1 To lastRowF\n        If Intersect(Target, Me.Range(Cells(j, 2))) Is Nothing Then Exit Sub\n        If Me.Range(.Cells(j, 2)) = vbNullString Then\n            Me.Range(.Cells(j, 2)).Formula = \"=VLOOKUP(\"\"\" &amp; cells.(y, 1) &amp; \"\"\",'Raw Data'!$A$1:$AH$5000,4,FALSE)\"\n            Exit For\n        End If\n    Next j\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1558517291, "post_id": 56253514, "comment_id": 99124310, "body": "Can you please include what you have tried and what didn&#39;t work as expected? Also, you have both tagged VBA and Excel-Formula. Which one are you working on? Clicking a button implies you looking into VBA instead of formulas."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1558517334, "post_id": 56253514, "comment_id": 99124334, "body": "Copy all data from sheet1 to sheet3 into sheet4 and use AutoFilter in sheet4. \u2022 Please note that because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1558518376, "post_id": 56253514, "comment_id": 99124931, "body": "please see <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is \u201cCan someone help me?\u201d not an actual question?</a> and <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">I downvoted because no attempt was made</a>. Also check out the <a href=\"https://stackoverflow.com/tour\">tour</a>, and more good information at <a href=\"https://stackoverflow.com/help/on-topic\">&quot;help center&quot;.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 1, "creation_date": 1558519611, "post_id": 56253937, "comment_id": 99125600, "body": "Simple and doing what requested... and surely works for few rows fine. But if you have thousands of rows, this is doomed to get slower the bigger the data is. Ideally you should only access the sheets twice with VBA, read/write and use arrays to process everything in the background (at lighting speeds)."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1558519887, "post_id": 56253937, "comment_id": 99125748, "body": "@DarXyde each answer should provide a way to go where you want. NOT the way especially when the OP ask for a code without providing any effort. if you need speed you should consider dictionary as the best solution."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1558518358, "creation_date": 1558518358, "answer_id": 56253937, "question_id": 56253514, "link": "https://stackoverflow.com/questions/56253514/i-have-a-multiple-sheets-in-an-excel-workbook-i-need-to-scan-all-these-sheets-a/56253937#56253937", "title": "I have a multiple sheets in an excel workbook. I need to scan all these sheets at the click of a button and pick specific values from the sheets", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim ws As Worksheet\n    Dim LastrowWS As Long, LastrowS4 As Long, i As Long\n\n    For Each ws In ThisWorkbook.Worksheets\n\n        If ws.name &lt;&gt; \"Sheet4\" Then\n\n            With ws\n\n                LastrowWS = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n                For i = 2 To LastrowWS\n\n                    If .Range(\"C\" &amp; i).Value = \"No\" Then\n\n                        .Range(\"A\" &amp; i &amp; \":C\" &amp; i).Copy\n\n                        With ThisWorkbook.Worksheets(\"Sheet4\")\n\n                            LastrowS4 = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n                            .Range(\"A\" &amp; LastrowS4 + 1).PasteSpecial xlPasteValues\n\n                        End With\n\n                    End If\n\n                Next i\n\n            End With\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 1, "last_activity_date": 1558519508, "creation_date": 1558519508, "answer_id": 56254307, "question_id": 56253514, "link": "https://stackoverflow.com/questions/56253514/i-have-a-multiple-sheets-in-an-excel-workbook-i-need-to-scan-all-these-sheets-a/56254307#56254307", "title": "I have a multiple sheets in an excel workbook. I need to scan all these sheets at the click of a button and pick specific values from the sheets", "body": "<p>This is far from a perfect solution, and it still needs some error handling to meet daily issues... however it should give you a good starting point on how to manipulate your data, and do so without reading back and forth from the spreadsheet multiple times (though for a couple of rows it doesn't matter, for few thounds it does).</p>\n\n<pre><code>Option Explicit\n\nSub getNonPermanents()\n\nDim wb As Workbook: Set wb = ActiveWorkbook         'or ThisWorkbook, or the name of the workbook where data is\nDim ws As Worksheet\nDim R As Long, C As Long, X As Long\nDim lRow As Long\n\nDim arrData\nDim arrNonPerm() As String: ReDim arrNonPerm(1 To 3, 1 To 1)\n\n    For Each ws In wb.Worksheets()\n        If ws.Name = \"Sheet1\" Or ws.Name = \"Sheet2\" Or ws.Name = \"Sheet3\" Then  'Or could just be ws.Name &lt;&gt; \"Sheet 4\", and/or other more elegant ways to deal with this\n            lRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).row                     'Get the last row in the current sheet\n\n            arrData = ws.Range(ws.Cells(2, 1), ws.Cells(lRow, 3))               'Allocate all data to an array\n\n            For R = LBound(arrData) To UBound(arrData)                          'Loop through the data, and if any are \"No\"....\n                If arrData(R, 3) = \"No\" Then\n                    X = X + 1\n                    ReDim Preserve arrNonPerm(1 To 3, 1 To X)                   'Increase the array as needed\n                    For C = LBound(arrData, 2) To UBound(arrData, 2)\n                        arrNonPerm(C, X) = arrData(R, C)                        'Allocate to the non perm array\n                    Next C\n                End If\n            Next R\n        End If\n    Next ws\n\n    Erase arrData\n    ReDim arrData(LBound(arrNonPerm, 2) To UBound(arrNonPerm, 2), LBound(arrNonPerm) To UBound(arrNonPerm))\n\n    For R = LBound(arrNonPerm, 2) To UBound(arrNonPerm, 2)                      'Reallocate the data to an array to be ready to put it back in the sheet\n        For C = LBound(arrNonPerm) To UBound(arrNonPerm)\n            arrData(C, R) = arrNonPerm(R, C)\n        Next C\n    Next R\n\n    With wb.Worksheets(\"Sheet4\")\n        lRow = .Cells(.Rows.Count, 1).End(xlUp).row\n        .Range(.Cells(lRow + 1, 1), .Cells(lRow + UBound(arrData), 3)) = arrData    'Add the data at the end of existing data (i.e. headers the very least).\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9397822, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Hellboy", "link": "https://stackoverflow.com/users/9397822/hellboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1558519508, "creation_date": 1558517143, "last_edit_date": 1558517210, "question_id": 56253514, "link": "https://stackoverflow.com/questions/56253514/i-have-a-multiple-sheets-in-an-excel-workbook-i-need-to-scan-all-these-sheets-a", "title": "I have a multiple sheets in an excel workbook. I need to scan all these sheets at the click of a button and pick specific values from the sheets", "body": "<p>I have the following tables in separate sheets (but same workbook): </p>\n\n<p>Sheet 1<br>\n<a href=\"https://i.stack.imgur.com/rwcYM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rwcYM.png\" alt=\"Sample sheet 1\"></a></p>\n\n<p>Sheet 2<br>\n<a href=\"https://i.stack.imgur.com/HBstA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HBstA.png\" alt=\"Sample sheet 2\"></a></p>\n\n<p>Sheet 3<br>\n<a href=\"https://i.stack.imgur.com/WQl3F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WQl3F.png\" alt=\"Sample sheet 3\"></a></p>\n\n<p>In Sheet 4, I need to click the button. This button will scan sheet 1, 2 and 3 and provide a list of items that are have the value of Permanent column as \"No\". It has to be one single list in Sheet 4. </p>\n\n<p>Expected Sheet 4:<br>\n<a href=\"https://i.stack.imgur.com/H7Ex9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H7Ex9.png\" alt=\"List in Sheet 4\"></a></p>\n\n<p>I am not sure where to start.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11538371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JsFVXl7vrG4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwiaKOOnCii6r_nalrfywP9u6cIg/mo/photo.jpg?sz=128", "display_name": "Oliver East", "link": "https://stackoverflow.com/users/11538371/oliver-east"}, "edited": false, "score": 0, "creation_date": 1558549573, "post_id": 56253865, "comment_id": 99142166, "body": "Sorry but that doesn&#39;t help I have list of 40+ sheets in the dropdown box and I need to paste to 1 of those sheets depending on which sheet is showing in the dropdown + plus list length changes as more sheets are added"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 1, "user_id": 11538371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JsFVXl7vrG4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwiaKOOnCii6r_nalrfywP9u6cIg/mo/photo.jpg?sz=128", "display_name": "Oliver East", "link": "https://stackoverflow.com/users/11538371/oliver-east"}, "edited": false, "score": 0, "creation_date": 1558566111, "post_id": 56253865, "comment_id": 99148284, "body": "I understood that you want to paste data in Cell A1, but you want to pick the tab name from A1. I have amended the answer accordingly. Try now."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1558566059, "last_edit_date": 1558566059, "creation_date": 1558518180, "answer_id": 56253865, "question_id": 56253381, "link": "https://stackoverflow.com/questions/56253381/i-want-to-copy-a-range-of-cells-and-paste-them-to-another-sheet-dependent-on-a-d/56253865#56253865", "title": "I want to copy a range of cells and paste them to another sheet dependent on a drop down selection and activated using a button", "body": "<p>you need to change the sheet name in your worksheet function.</p>\n\n<p>This might work.</p>\n\n<pre><code>Sub Button2_Click()\n\n'Copying the Data\nWorksheets(\"Sheet1\").Range(\"a2:x2\").Copy\n\n'Pasting the data\n' What we were missing was to pass the name of the tab dynamically. Now this code will pick up the name that appears in the Cell A1.\n\nActiveSheet.Paste Destination:=Worksheets(Worksheets(\"Sheet1\").Range(\"A1\").value).Range(\"A1\")\n\nEnd Sub\n</code></pre>\n\n<p>Also in the paste range you only need to put the first cell range to paste values. </p>\n\n<p>To paste the Transposed Values check the function <strong>PasteSpecial</strong> with Transpose property set to True.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11538371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JsFVXl7vrG4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwiaKOOnCii6r_nalrfywP9u6cIg/mo/photo.jpg?sz=128", "display_name": "Oliver East", "link": "https://stackoverflow.com/users/11538371/oliver-east"}, "is_accepted": false, "score": 0, "last_activity_date": 1558549797, "creation_date": 1558549797, "answer_id": 56262934, "question_id": 56253381, "link": "https://stackoverflow.com/questions/56253381/i-want-to-copy-a-range-of-cells-and-paste-them-to-another-sheet-dependent-on-a-d/56262934#56262934", "title": "I want to copy a range of cells and paste them to another sheet dependent on a drop down selection and activated using a button", "body": "<p>Here is some more code I have tried for the issue but still does not seem to work.</p>\n\n<p>Sub ExportButton1()\n'\n' ExportButton1 Macro\n' Exports Data to staff sheet from drop down box\n'\n' Keyboard Shortcut: Ctrl+e\n'\n    ActiveWorkbook.Save\nEnd Sub\nPrivate Sub CommandButton1_Click(ByVal Target As Range)\n  Application.ScreenUpdating = False\n  Dim copySheet As Worksheet\n  Dim pasteSheet As Worksheet</p>\n\n<p>Set copySheet = Worksheets(\"Data\")\n  'On Error Resume Next\n    'If Not (Application.Intersect(Range(\"H2\"), Target) Is Nothing) Then _</p>\n\n<p>Set pasteSheet = Worksheets(ActiveSheet.Range(\"H2\"))</p>\n\n<p>copySheet.Range(\"G5:AA5\").Copy\n  pasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n  Application.CutCopyMode = False\n  Application.ScreenUpdating = True\nEnd Sub</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11538371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JsFVXl7vrG4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwiaKOOnCii6r_nalrfywP9u6cIg/mo/photo.jpg?sz=128", "display_name": "Oliver East", "link": "https://stackoverflow.com/users/11538371/oliver-east"}, "edited": false, "score": 0, "creation_date": 1558600609, "post_id": 56271206, "comment_id": 99157259, "body": "Thank you for your help much appreciated"}], "tags": [], "owner": {"reputation": 1, "user_id": 11538371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JsFVXl7vrG4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwiaKOOnCii6r_nalrfywP9u6cIg/mo/photo.jpg?sz=128", "display_name": "Oliver East", "link": "https://stackoverflow.com/users/11538371/oliver-east"}, "is_accepted": false, "score": 0, "last_activity_date": 1558600584, "creation_date": 1558600584, "answer_id": 56271206, "question_id": 56253381, "link": "https://stackoverflow.com/questions/56253381/i-want-to-copy-a-range-of-cells-and-paste-them-to-another-sheet-dependent-on-a-d/56271206#56271206", "title": "I want to copy a range of cells and paste them to another sheet dependent on a drop down selection and activated using a button", "body": "<p>'I have found another way around the problem to copy paste cells to certain sheet then on 'staff sheet a formula in a table to tests column A value on data sheet for name and only 'transpose those rows</p>\n\n<pre><code>Sub Macro1()\nRange(\"A2:J2\").Select\nSelection.Copy\nSheets(\"Sheet3\").Select\nRange(\"A60000\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSheets(\"Sheet1\").Select\n</code></pre>\n\n<p>End Sub</p>\n\n<p>'Formula on staff sheet is -=IF(Sheet3!A:A=\"Column1\",Sheet3!$B:$B,\"\")</p>\n"}], "owner": {"reputation": 1, "user_id": 11538371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JsFVXl7vrG4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfwiaKOOnCii6r_nalrfywP9u6cIg/mo/photo.jpg?sz=128", "display_name": "Oliver East", "link": "https://stackoverflow.com/users/11538371/oliver-east"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1558600584, "creation_date": 1558516782, "last_edit_date": 1558516814, "question_id": 56253381, "link": "https://stackoverflow.com/questions/56253381/i-want-to-copy-a-range-of-cells-and-paste-them-to-another-sheet-dependent-on-a-d", "title": "I want to copy a range of cells and paste them to another sheet dependent on a drop down selection and activated using a button", "body": "<p>I have an Export to sheet button but I can't get it working correctly.\nI selects the correct cells to copy but can't then transpose them on to selected sheet that appears in the drop down box in cell A1, I then also need it to paste on the next available row in that specific sheet. The problem is that I can't just list the sheets in VBA as the list in the drop down box changes. I have tried several ways to with no success. If someone could help it would be great</p>\n\n<pre><code>Sub Button2_Click()\n\n    Worksheets(\"Sheet1\").Range(\"a2:x2\").Copy\n    ActiveSheet.Paste Destination:=Worksheets(\"Sheet1!A1\").Range(\"a:x\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "match", "vlookup"], "comments": [{"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 1, "creation_date": 1558516526, "post_id": 56253239, "comment_id": 99123848, "body": "I did not understand very well what you mean. You may be interested in VLOOKUP() and HLOOKUP() functions."}, {"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558516810, "post_id": 56253239, "comment_id": 99124002, "body": "Vlookup returns always the same value"}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558516993, "post_id": 56253239, "comment_id": 99124120, "body": "Read the help for vlookup() carefully. The data must be sorted, or the third parameter must be set accordingly. The column with the keys should not have duplicate values. Otherwise, the result is not what you want. Noo algorithm can decide which value you want, if you have two values associated with the same key (A -&gt; Row1, A -&gt; Row2). How can the algorithm decide how to choose between Row1 and Row2?"}, {"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558517307, "post_id": 56253239, "comment_id": 99124323, "body": "The point is that I have duplicates in the second table, and they are meant to be there for specific reasons. I need to match entries from table 1 to entries in table 2. In other words I need to link the entries in table 1 to all entries in table 2 without repeating them. I have theorized it given the above code, I am aware there might be other more elegant ways but this is the max I can do. I am planning to do it by shifting the range of the Vlookup by one unit downward every time it finds something so that matches do not repeat."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 1, "creation_date": 1558517611, "post_id": 56253239, "comment_id": 99124477, "body": "Then maybe you should use c1=h1, d1=i1, c2=h2, d2=i2... and so on... You just duplicate the data with the most basic formula."}, {"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558517796, "post_id": 56253239, "comment_id": 99124602, "body": "I can&#39;t see how it can be automatized to thousands of entries though"}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 1, "creation_date": 1558518165, "post_id": 56253239, "comment_id": 99124814, "body": "Your specification is very weak. Example: why did you added 2 lines with &quot;D&quot; in column C? Even crazier: 2 lines with &quot;i&quot;, one has Row10, the other is blank... You need to be able to describe in words all rules and all exceptions, and then the algorithm will be easier to find."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1558518687, "post_id": 56253239, "comment_id": 99125082, "body": "Sorry, but your question is unclear. In your image there are 2 tables: would left table be your input and right table your expected output? Because right table looks like you filtered and/or hided those rows where field &quot;Result&quot; is blank in left table"}, {"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "reply_to_user": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558519166, "post_id": 56253239, "comment_id": 99125340, "body": "Yes, the input are values in the left table. Maybe you can help me in clarify. So what I need to do is to find whether the entries in the left table are in the right table. In case they are in the right table, I would need to get the value from the adjacent cell. @virolino This is an example of a list I can have. If Item A is in the right table I need to get the value that is linked to item A in the right table. If I have two item A in the left table I need to find the first value of item A and the second item of Item A. Hope this helps"}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558519424, "post_id": 56253239, "comment_id": 99125490, "body": "You can try the following: for each line in the C:D range you parse the entire H:I range, until you find a match. If you find a match, you do what you need to do. If you do not find a match, you will probably do nothing. You need 2 nested &quot;for&quot; loops, of course."}, {"owner": {"reputation": 1780, "user_id": 10988580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9885afb3fe782ac4c8e89a3b5904b8f6?s=128&d=identicon&r=PG&f=1", "display_name": "virolino", "link": "https://stackoverflow.com/users/10988580/virolino"}, "edited": false, "score": 0, "creation_date": 1558519603, "post_id": 56253239, "comment_id": 99125594, "body": "Another option would be to calculate some helper columns, simply joining the values. Then hopefully you will have unique values and you can use VLOOKUP() with the calculated values. E.g.: E1=C1&amp;D1, J1=H1&amp;I1, E2=C2&amp;D2, J2=H2&amp;I2, ..."}, {"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "edited": false, "score": 0, "creation_date": 1558522260, "post_id": 56253239, "comment_id": 99127077, "body": "Loops must be very limited as my database have many entries (approx 7000) and their running time would be immense and worthless."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "edited": false, "score": 0, "creation_date": 1558540938, "post_id": 56255108, "comment_id": 99138269, "body": "I have updated the code but it still does not work as it supposed to. Please take a look."}, {"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "edited": false, "score": 0, "creation_date": 1558542406, "post_id": 56255108, "comment_id": 99139075, "body": "The code needs to verify if the entries in left table are in right table. The code now verifies them but whereas the first set of  entries are verified without repetition of the return values when the code encounters following entries it just verify the first one and skip to retry the following entries"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "edited": false, "score": 0, "creation_date": 1558601563, "post_id": 56255108, "comment_id": 99157843, "body": "@Alessio_110 What do you mean with <i>when the code encounters following entries it just verify the first one and skip</i>??"}, {"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "edited": false, "score": 0, "creation_date": 1559050327, "post_id": 56255108, "comment_id": 99291840, "body": "I was looking for a macro that could would behave as vlookup without repeating the same value over and over"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1558522084, "creation_date": 1558522084, "answer_id": 56255108, "question_id": 56253239, "link": "https://stackoverflow.com/questions/56253239/vlookup-without-repetition-using-vba-on-excel/56255108#56255108", "title": "Vlookup without repetition using vba on excel", "body": "<p>Well, Let's see if this helps you out and probably you can adapt it to your needs.</p>\n\n<p>I replied your data like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SzdCX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SzdCX.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The macro will create a list in columns H:I like the right table of your image. The macro will always delete any previous result. My macro works on <em>standard</em> ranges, is not designed to work on tables (ListObjects in VBA), but you can easily adapt it to your needs.</p>\n\n<pre><code>Sub CREATE_LIST()\nApplication.ScreenUpdating = False\nDim LastRow As Long\nDim MyRange As Range\nDim rng As Range\nDim i As Long\n\n\n'we clear previous list\nColumns(\"H:I\").Delete\n\n'we add data\nRange(\"H1\").Value = \"Target\"\nRange(\"I1\").Value = \"Return\"\n\nLastRow = Range(\"C\" &amp; Rows.Count).End(xlUp).Row 'Last row of column C, where data is.\n\nSet MyRange = Range(\"D2:D\" &amp; LastRow).SpecialCells(xlCellTypeConstants, 23) 'we select only NON BLANK cells\n\ni = 2 'initial row\n\nFor Each rng In MyRange\n    Range(\"H\" &amp; i).Value = rng.Offset(0, -1).Value 'value of adjacent cell (Column C)\n    Range(\"I\" &amp; i).Value = rng.Value 'value of cell in column D\n    i = i + 1\nNext rng\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>After executing code I get:\n<a href=\"https://i.stack.imgur.com/M25PK.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M25PK.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And trying different data works too:\n<a href=\"https://i.stack.imgur.com/FyJ9Z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FyJ9Z.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Hope you can adapt this to your needs.</p>\n"}, {"comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559050768, "post_id": 56343422, "comment_id": 99292119, "body": "Your original question and this has absolutey nothing in common, LoL. In your first question you ignored blank values, and now you just are kind of moving values one or 2 rows higher. Why now B appears in the results with 56 when 56 is related to C? Why D dissapears when it has a 99?. Totally different question. Anyways, if you found a solution for your problem, that&#39;s all that matters, so good job."}, {"owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1559051866, "post_id": 56343422, "comment_id": 99292776, "body": "I am sorry for that. I did not know how to put it into words I suppose. I just wanted to find a macro that would vlookup values without returning the same value over and over"}], "tags": [], "owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "is_accepted": false, "score": 0, "last_activity_date": 1559050267, "creation_date": 1559050267, "answer_id": 56343422, "question_id": 56253239, "link": "https://stackoverflow.com/questions/56253239/vlookup-without-repetition-using-vba-on-excel/56343422#56343422", "title": "Vlookup without repetition using vba on excel", "body": "<p>Apologies for the unclear explanation of the problem. I have provided here below a solution I have sorted out. I was looking for a code that could execute vlookup without returning the same values. Below is the solution. I am aware that the code might not be the cleanest and most elegant one but it is effective and run fast enough for large data sample. </p>\n\n<pre><code>Sub Matching()\n\n    Dim Search_Array As Variant\n    Dim Target_MatchValue As Variant\n    Dim Target_Range As Range\n    Dim arr As Variant\n    Dim counter As Integer\n    Dim n As Integer\n\n    'data must be ordered in order to apply the non-repetitive condition\n    Search_Array = Sheet1.Range(\"A2\", Sheet1.Range(\"A1\").End(xlDown)) 'use this array to loop through the value to search for\n\n\n    n = 0\n    Sheet1.Activate\n    With ActiveSheet\n        For counter = LBound(Search_Array) To UBound(Search_Array)\n\n            Target_MatchValue = 0\n            Target_MatchValue = Application.Match(Search_Array(counter, 1), .Range(Cells(2 + n, 4), Cells(1000, 4)), 0) 'This code will return the value used for the shifting range\n            Set Target_Range = .Range(Cells(2 + n, 4), Cells(1000, 5))  'this is supposed to work as a shifting range allowing to match entries without making repetitions. I used the MATCH function in order to set the start of the range. i.e. if there is a match in the target table the range will shift from the location of the match downwards. If the match is at on the same level then it does not shift the range in order to match the same-level entry afterwards it is supposed to shift by one unit in order to prevent repetitions.\n            'target_range.select Activate this code in order to see the macro in action\n            arr = Application.VLookup(Search_Array(counter, 1), Target_Range, 2, False) 'store the vlookup value in an array in order to increase the efficiency the code and to speed up the whole proces\n\n                If IsError(arr) Then\n                    .Cells(2 + n, 2).value = \"\" 'if the macro does not find anything, no value will be recorded anywhere\n\n                    Else\n                    .Cells(1 + n + Target_MatchValue, 2).value = Search_Array(counter, 2)  'Return the value of the search_array in this cell so to match column A values with column D values if they are found\n\n                End If\n\n                If IsError(arr) Then\n                        n = n\n                    ElseIf Target_MatchValue = 0 Then 'if the macro does not find anything, the shifting range does not shift so that subsequent values can be searched in the same range without missing precious matches\n                        n = n + 1\n\n                    ElseIf Target_MatchValue &gt; 0 Then 'if there is a matching value between Column A and Column B, the shifting range shifts by the n + the distance between the the current vlookupvalue and the found value. Note that Data must be stored in a filtered order otherwise vlookup will not work correctly\n                        n = n + Target_MatchValue\n\n                End If\n        Next counter\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>By exchanging ideas with some friends, I was told to think about a potential helper column that would be used to store incremental numbers. This helper column would store incremental numbers that would help to meet the non-repetition condition. Please see the below example.</p>\n\n<p><a href=\"https://i.stack.imgur.com/QfxjL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QfxjL.png\" alt=\"enter image description here\"></a></p>\n\n<p>The idea here is that if a value is found in column E, I store n being equal to the value found in the helper column. Then the code needs to verify if the future values' n are bigger than previous n. If this condition is met, then the one-repetition condition is fulfilled. n changes value to the next bigger value. \nFor example, if I find L in the right table, I report 96 as value and store N being equal to 11. When I search for the next value of L, the new n must be bigger than the current n otherwise I will not store the new found value. The value 77 found has indeed a bigger n than the previous value as 12 is bigger than 11. I hope this helps.</p>\n"}], "owner": {"reputation": 33, "user_id": 11272763, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209531433178154/picture?type=large", "display_name": "Alessio_110", "link": "https://stackoverflow.com/users/11272763/alessio-110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559050267, "creation_date": 1558516327, "last_edit_date": 1558552964, "question_id": 56253239, "link": "https://stackoverflow.com/questions/56253239/vlookup-without-repetition-using-vba-on-excel", "title": "Vlookup without repetition using vba on excel", "body": "<p>I am trying to put in place a macro that allows me to match identical entry from one table to another. The tricky part is that if a match is found, it cannot be repeated. The way I theorized it is kind of elementary, however it is the only way I can think of it given my still limited knowledge in VBA.</p>\n\n<p><strong>The structure</strong></p>\n\n<ol>\n<li>Both tables need to be first filtered in order to allow the non-repetition condition.</li>\n<li>Store the searching values as arrays in order to speed up the process of the macro</li>\n<li>Match the entries to search with the ones from the targeted table in order to find matches. This is done with the in-application function MATCH. The MATCH function returns the cell where the match is situated, this is useful as it constantly shift the range in order to not repeate the same value all the time.</li>\n<li>After calculating the shifting range, I use a VLookup function in order to return the second entry.</li>\n</ol>\n\n<p>Unfortunately, the macro is incomplete. I cannot find a way to constantly shift the range without compromising the mechanism. The problem resides in the shifting range that is not created correctly to shift after each match.</p>\n\n<p><strong>Desired result</strong></p>\n\n<p>In the below image the desired result would be to check if all items in the left table are in the right table. Take item A, I need to find two item As. I have in the right column a first item A with value 17 and a second item A with value 81. If I do not find any value I have nothing, as it is the case of Ds and E. If instead I have less entries in the left table (as it is for the case of entry L) then I need to return all values of Entry L: 96; 77; 40.</p>\n\n<p><a href=\"https://i.stack.imgur.com/68tVL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/68tVL.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>    Sub Matching11()\nThisWorkbook.Activate\n\nWorksheets.add\n\nWorksheets(\"Test4\").Range(\"A1:T110\").copy Destination:=ActiveSheet.Range(\"A1\")\n\nWith ActiveSheet\n\n    Dim Search_Array As Variant\n    Search_Array = Range(\"C2\", Range(\"C1\").End(xlDown)) 'use this array to loop through the value to search for\n\n\n    Dim Target_MatchValue As Integer\n    Dim Target_Range As Range\n    Dim arr As Variant\n    Dim counter As Integer\n    Dim n As Integer\n\n\n\n    counter = 0\n    n = 0\n    Target_MatchValue = 0\n\n    For counter = LBound(Search_Array) To UBound(Search_Array)\n        Target_MatchValue = 0\n\n        Target_MatchValue = Application.Match(Search_Array(counter, 1), .Range(\"H2:H200\"), 0) - 1 'change C column with the range where you will have the tyres you need search for\n        Set Target_Range = .Range(.Cells(2 + n, 8), .Cells(1000, 9))  'this is supposed to work as a shifting range allowing to match entries without making repetitions. I used the MATCH function in order to set the start of the range. i.e. if there is a match in the target table the range will shift from the location of the match downwards. If the match is at on the same level then it does not shift the range in order to match the same-level entry afterwards it is supposed to shift by one unit in order to prevent repetitions.\n        'If arr = Application.VLookup(Search_Array(counter, 1), Target_Range, 2, False) Is Nothing Then GoTo NextCounter    'I used Vlookup in order to return the value set in the second column of the targetted table. As alternative, I think I could just use offset since I previously used MQTCH\n\n\n        arr = Application.VLookup(Search_Array(counter, 1), Target_Range, 2, False)\n        If IsError(arr) Then\n            GoTo NextCounter\n            Else\n            .Range(Cells(1 + counter, 6), Cells(1 + counter, 6)).value = arr 'Return the value of the array in this cell\n        End If\n        Target_Range.Select\n\n        If Target_MatchValue = 0 Then\n\n            n = n + 1\n\n            ElseIf Target_MatchValue &gt; 0 Then\n            n = n + Target_MatchValue\n        End If\n        .Range(Cells(1 + counter, 5), Cells(1 + counter, 5)).value = Search_Array(counter, 1) 'Return the value of the array in this cell\n    Next counter\n\nNextCounter:\nNext counter\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558516445, "post_id": 56253170, "comment_id": 99123800, "body": "<i>&quot;its not working&quot;</i> is no useful error description. Instead describe what happens or which errors you get."}, {"owner": {"reputation": 497, "user_id": 3308819, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/0527715a3eb8e5c6eba060a63c372fcb?s=128&d=identicon&r=PG&f=1", "display_name": "Prush", "link": "https://stackoverflow.com/users/3308819/prush"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558516747, "post_id": 56253170, "comment_id": 99123970, "body": "Thanks Peh, its again ask to enter password"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1558516671, "creation_date": 1558516671, "answer_id": 56253341, "question_id": 56253170, "link": "https://stackoverflow.com/questions/56253170/unprotect-workbook-while-opening-with-password/56253341#56253341", "title": "Unprotect workbook while opening with password", "body": "<p>If you have a look into the documentation of the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.open\" rel=\"nofollow noreferrer\">Workbooks.Open method</a> you will see that it has a <code>Password</code> parameter.</p>\n\n<pre><code>Option Explicit\n\nSub demo()\n    Dim PathFile As String\n    PathFile = \"c:\\login\\FloorLoginData.xlsx\"\n\n    Dim wb As Workbook\n    Set wb = Workbooks.Open(FileName:=PathFile, Password:=\"password\")\nEnd Sub\n</code></pre>\n\n<p><em>Note: Don't use</em> <code>Variant</code> <em>if you can use</em> <code>String</code><em>.</em> <code>Variant</code> <em>is the worst choice as variable type, always use something else if you can.</em></p>\n"}], "owner": {"reputation": 497, "user_id": 3308819, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/0527715a3eb8e5c6eba060a63c372fcb?s=128&d=identicon&r=PG&f=1", "display_name": "Prush", "link": "https://stackoverflow.com/users/3308819/prush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 56253341, "answer_count": 1, "score": 0, "last_activity_date": 1558516671, "creation_date": 1558516119, "last_edit_date": 1558516385, "question_id": 56253170, "link": "https://stackoverflow.com/questions/56253170/unprotect-workbook-while-opening-with-password", "title": "Unprotect workbook while opening with password", "body": "<p>I am trying to open protected workbook which is encrypt with password and password is \"password\".</p>\n\n<p>I write below code but its not working.</p>\n\n<p>please help on this.</p>\n\n<pre><code>Sub demo()\nDim path_file As Variant\npath_file = \"c:\\login\\FloorLoginData.xlsx\"\nWorkbooks.Open(path_file).Unprotect Password:=\"password\"\nend sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "edited": false, "score": 0, "creation_date": 1558676670, "post_id": 56252732, "comment_id": 99185892, "body": "The result is still 0"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "reply_to_user": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "edited": false, "score": 1, "creation_date": 1558686141, "post_id": 56252732, "comment_id": 99189786, "body": "How have you declared v_date?  If it is a variant then this might not work.  If it is a date then change the code as edited above."}, {"owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "edited": false, "score": 0, "creation_date": 1558688599, "post_id": 56252732, "comment_id": 99191117, "body": "Yes, it is declared as date, and with your updated answer it works. Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": true, "score": 1, "last_activity_date": 1558686221, "last_edit_date": 1558686221, "creation_date": 1558514649, "answer_id": 56252732, "question_id": 56252571, "link": "https://stackoverflow.com/questions/56252571/worksheetfunction-sumifs-based-on-range-that-has-date-and-time/56252732#56252732", "title": "WorksheetFunction.SumIfs based on Range that has date and time", "body": "<p>Assuming v_date is a date only it will default to midnight.  Therefore you need to filter by <code>&gt;=v_date</code> (midnight) and <code>&lt;v_date+1</code> (midnight next day)</p>\n\n<pre><code>result = WorksheetFunction.SumIfs(Range(\"C3:C100\"), _\nRange(\"A3:A100\"), \"&gt;=\" &amp; CDbl(v_date), _\nRange(\"A3:A100\"), \"&lt;\" &amp; CDbl(v_date + 1))\n</code></pre>\n"}], "owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 56252732, "answer_count": 1, "score": 0, "last_activity_date": 1558688631, "creation_date": 1558514121, "last_edit_date": 1558688631, "question_id": 56252571, "link": "https://stackoverflow.com/questions/56252571/worksheetfunction-sumifs-based-on-range-that-has-date-and-time", "title": "WorksheetFunction.SumIfs based on Range that has date and time", "body": "<p>I'm trying to create a SumIfs that sums all the values in a range based on a date like this</p>\n\n<pre><code>Dim v_date as Date\nv_date = Date\nresult = WorksheetFunction.SumIfs(Range(\"C3:C100\"),Range(\"A3:A100\"),v_date)\n</code></pre>\n\n<p>The problem is that Range(\"A3:A100\") has date and time in it but i want to filter only by date.\nI tried adding a wildcard like <code>v_date &amp; \"*\"</code> but it didn't work. The result is always 0.</p>\n"}, {"tags": ["vba", "ms-access", "dll", "callback"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1558512279, "post_id": 56251960, "comment_id": 99121532, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Your question is very generic, it&#39;s very likely you have an incompatibility somewhere, for example by calling the callback function the wrong way."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2112247"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1558517234, "post_id": 56251960, "comment_id": 99124273, "body": "Ok Erik... I have added all the code I use... thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2112247"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1558706629, "post_id": 56251960, "comment_id": 99200950, "body": "As I said in UPDATE 1 the problem exists only when the callback is called from within thread function. If it is called from within message function everything is ok"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1558718620, "post_id": 56251960, "comment_id": 99206478, "body": "Certainly a possibility. My C is rusty but I believe you can&#39;t just call a 32-bit function pointer from a 64-bit application."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2112247"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1558941709, "post_id": 56251960, "comment_id": 99251024, "body": "My wrong... sorry... I checked the dll and is 32-bit. My MS Access 2010 is also 32-bit... so this is not the problem (even if Windows 7 is 64bit). For this reason I deleted the comment."}], "owner": {"user_type": "does_not_exist", "display_name": "user2112247"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594778964, "creation_date": 1558511977, "last_edit_date": 1594778964, "question_id": 56251960, "link": "https://stackoverflow.com/questions/56251960/ms-access-crashes-out-when-its-callback-function-called-from-a-dlls-thread-func", "title": "Ms Access crashes out when its callback function called from a dll&#39;s thread function", "body": "<p>I have made a dll with C for use in an Ms Access vba project. The dll makes use of a vba callback function. According to MS documentation the vba callback function has to be in a module and not in a form's code. Inside the callback function I set a form's filter property. But because of this the Access crashes when the execution it arrives there!!! Why? Other references to form's components have no problem (for example when I set the value of the form's textbox)\nThanks</p>\n\n<p>The C dll code compiled with VS 2017:</p>\n\n<pre><code>#include &lt;windows.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;tchar.h&gt;\n\ntypedef void(__stdcall * CallbackFunction)();\n\nDWORD __stdcall ThreadFunc(CallbackFunction Callback) {\n\nCallback();\nreturn 0;\n}\n\n\n__declspec(dllexport) void __stdcall message(CallbackFunction Callback) {\n    // Array to store thread handles\n    HANDLE Array_Of_Thread_Handles[1];\n    Array_Of_Thread_Handles[0] = CreateThread(NULL, 0, ThreadFunc, Callback, 0, NULL);\n}\n</code></pre>\n\n<p>And here is the code that call the dll function \"message\" from within vba</p>\n\n<pre><code>Private Sub Form_Load()\n    Call message(AddressOf Callback)\nEnd Sub\n</code></pre>\n\n<p>The vba Declaration of dll</p>\n\n<pre><code>Public Declare Sub message Lib \"MonitoringDirectoryDLL.dll\" Alias \"_message@4\" (ByVal Callback As Long)\n</code></pre>\n\n<p>The vba callback subroutine (resides on a Module according to MS documentation)</p>\n\n<pre><code>Public Sub Callback()\n    On Error Resume Next\n    Forms(\"MyForm\").txtTest=\"test\" 'this line executed well and the string \"test\" appears ok in the form.\n    Forms(\"MyForm\").Filter=\"\" 'in this line Access crashes out\n    Forms(\"MyForm\").FilterOn=True\nEnd Sub\n</code></pre>\n\n<p>UPDATE 1</p>\n\n<p>I found that the problem exists only when the vba Callback Sub is called from the Thread function (ThreadFunc). If it is called from within dll \"message\" function form's filter is set ok (!!!) </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1558515296, "post_id": 56251907, "comment_id": 99123118, "body": "So... what have you tried and doesn&#39;t work?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1558518455, "post_id": 56251907, "comment_id": 99124972, "body": "Can you share the code that you have written and didn&#39;t work ?"}, {"owner": {"reputation": 1, "user_id": 11537924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cb43d9ae73539423e116a62c23afab9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike_gr", "link": "https://stackoverflow.com/users/11537924/mike-gr"}, "edited": false, "score": 0, "creation_date": 1558610110, "post_id": 56251907, "comment_id": 99162545, "body": "Ok, I managed to fix it myself based on the code above. The reason the saveas.-part didn&#39;t work was simply because some of the values used for the naming procedure contained illegal characters.  One question though. How do I change this part to also copy and paste the format: Workbooks(mainWB).Sheets(mainSht).Rows(r).Copy and         ActiveSheet.Paste"}], "owner": {"reputation": 1, "user_id": 11537924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cb43d9ae73539423e116a62c23afab9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike_gr", "link": "https://stackoverflow.com/users/11537924/mike-gr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558536754, "creation_date": 1558511758, "last_edit_date": 1558536754, "question_id": 56251907, "link": "https://stackoverflow.com/questions/56251907/vba-for-copying-selected-data-to-new-workbooks", "title": "VBA for copying selected data to new workbooks", "body": "<p>I have a list in Excel from which I need to filter and copy selected data from a workbook to a bunch of new (not yet existing) workbooks. Here's what needs to be done:</p>\n\n<p>In the main file there's a  table consisting of columns A-Z. In column A there are 250 unique different values which are used for sorting the data. The list needs to be looped through and filtered by each value in column A. With every filtering action all rows sharing the same values should be copied (along with column headers) and pasted in a new workbook. The new workbook needs to be created and named using the value in column A.</p>\n\n<p>I'm a newbie when it comes to VBA and any help would be greatly appreciated. </p>\n\n<p>Edit: Here's some code I found on a different forum (credit to WarPigl3t over at mrexcel.com) that I've trying to use. It seems to do all I need (and also some extra stuff with timestamp that's not really needed). However the .SaveAs part of the macro fails for some reason.</p>\n\n<pre><code>Sub CopySelectedData()\nnameColumn = \"A\"\nheaderRow = 1\nfirstRow = 2\n\nmainWB = getWorkbookName(ThisWorkbook.Name)\nmainSht = ActiveSheet.Name\nlastRow = Workbooks(mainWB).Sheets(mainSht).Range(\"A\"  &amp; Rows.Count).End(xlUp).Row\nfilePath = getFilePath(ActiveWorkbook)\ntimeStamp = getTimeStamp()\nCall createNewDirectory(filePath, timeStamp)\narrayOfNames = createArrayOfNames(mainWB, mainSht, firstRow, lastRow, nameColumn)\nCall createNewWorkbook(mainWB, mainSht, nameColumn, headerRow, firstRow, lastRow, filePath, timeStamp, arrayOfNames)\nEnd Sub\n\nFunction getWorkbookName(WB_Name)\nmySplit = Split(WB_Name, \".\")\ngetWorkbookName = mySplit(0)\nEnd Function\n\nFunction getFilePath(WB) As String\ngetFilePath = WB.Path\nEnd Function\n\nFunction getTimeStamp()\nmyNow = Now\nmyNow = Replace(myNow, \"/\", \"-\")\nmyNow = Replace(myNow, \":\", \"`\")\ngetTimeStamp = myNow\nEnd Function\n\nSub createNewDirectory(filePath, folderName)\nMkDir (filePath &amp; \"/\" &amp; folderName)\nEnd Sub\n\nFunction createArrayOfNames(mainWB, mainSht, firstRow, lastRow, nameColumn)\na = 0\nDim myArrayOfNames() As String\nReDim Preserve myArrayOfNames(a)\nr = firstRow\nDo Until r &gt; lastRow\n    myValue = Workbooks(mainWB).Sheets(mainSht).Range(nameColumn &amp; r).Value\n    addNewElementToArrayOfNames = True\n    For Each element In myArrayOfNames()\n        If element = myValue Then\n            addNewElementToArrayOfNames = False\n        End If\n    Next element\n    If addNewElementToArrayOfNames = True Then\n        ReDim Preserve myArrayOfNames(a)\n        myArrayOfNames(a) = myValue\n        a = a + 1\n    End If\n    r = r + 1\nLoop\ncreateArrayOfNames = myArrayOfNames()\nEnd Function\n\nSub createNewWorkbook(mainWB, mainSht, nameColumn, headerRow, firstRow, lastRow, filePath, timeStamp, arrayOfNames)\nFor Each element In arrayOfNames\n    Set newWB = Workbooks.Add\n    With newWB\n        .SaveAs Filename:=filePath &amp; \"\\\" &amp; timeStamp &amp; \"\\\" &amp; element &amp; \".xls\"\n        newWB_Name = getWorkbookName(newWB.Name)\n        Call createMonthlyData(newWB_Name, mainWB, mainSht, nameColumn, headerRow, firstRow, lastRow, element)\n        newWB.Save\n        newWB.Close\n    End With\nNext element\nEnd Sub\n\nSub createMonthlyData(newWB_Name, mainWB, mainSht, nameColumn, headerRow, firstRow, lastRow, arrayName)\nWorkbooks(mainWB).Sheets(mainSht).Rows(headerRow).Copy\nActiveSheet.Paste Destination:=Workbooks(newWB_Name).Sheets(\"Blad1\").Rows(headerRow)\nnextRow = firstRow\nr = firstRow\nDo Until r &gt; lastRow\n    nameValue = Workbooks(mainWB).Sheets(mainSht).Range(nameColumn &amp; r).Value\n    If nameValue = arrayName Then\n        Workbooks(mainWB).Sheets(mainSht).Rows(r).Copy\n        ActiveSheet.Paste Destination:=Workbooks(newWB_Name).Sheets(\"Blad1\").Rows(nextRow)\n        nextRow = nextRow + 1\n    End If\n    r = r + 1\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558511845, "post_id": 56251802, "comment_id": 99121290, "body": "What is the issue? If you do that with strings the result woud obviosly be <code>#VALUE!</code>. What would you expect how Excel would handle your strings?"}, {"owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1558512057, "post_id": 56251802, "comment_id": 99121402, "body": "@P\u1d07\u029c I want Excel to skip those columns so that the original string remains unaffected."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1558512965, "last_edit_date": 1558512965, "creation_date": 1558512390, "answer_id": 56252071, "question_id": 56251802, "link": "https://stackoverflow.com/questions/56251802/subtract-rows-from-one-another-but-skip-strings/56252071#56252071", "title": "Subtract rows from one another, but skip strings", "body": "<p>Then test with <code>=IFERROR</code> if the result of your subtraction returns <code>#VALUE!</code> and in that case return the original value:</p>\n\n<pre><code>.Evaluate(\"=IFERROR(A2:G2-A10:G10,A2:G2)\")\n</code></pre>\n\n<p>This returns the value from A2:G2 if the subtraction errors.</p>\n\n<p>Alternatively you can also check for numbers:</p>\n\n<pre><code>.Evaluate(\"=IF(ISNUMBER(A2:G2),A2:G2-A10:G10,A2:G2)\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1558514318, "creation_date": 1558514318, "answer_id": 56252643, "question_id": 56251802, "link": "https://stackoverflow.com/questions/56251802/subtract-rows-from-one-another-but-skip-strings/56252643#56252643", "title": "Subtract rows from one another, but skip strings", "body": "<p>You can also use code like below:</p>\n\n<pre><code>With ActiveWorkbook.Sheets(1).Range(\"A20:G20\")\n    .Formula = \"=IFERROR(A2-A10,\"\"\"\")\"\n    .Value = .Value\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 545, "user_id": 11356960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47cda0d343183c7e4d9d5961845654b0?s=128&d=identicon&r=PG&f=1", "display_name": "NoNameNo123", "link": "https://stackoverflow.com/users/11356960/nonameno123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 56252071, "answer_count": 2, "score": 0, "last_activity_date": 1558514318, "creation_date": 1558511353, "last_edit_date": 1558512011, "question_id": 56251802, "link": "https://stackoverflow.com/questions/56251802/subtract-rows-from-one-another-but-skip-strings", "title": "Subtract rows from one another, but skip strings", "body": "<p>I know I can subtract entire rows with the following line: </p>\n\n<pre><code>ActiveWorkbook.Sheets(1).Range(\"A20:G20\") = ActiveWorkbook.Sheets(1).Evaluate(\"A2:G2-A10:G10\")\n</code></pre>\n\n<p>However, I have strings in a few columns. I tried hiding those columns, but this doesn't make Excel skip them. In theory I could delete them and re-insert them afterwards, but if possible I'd like to avoid a solution with so many steps in between. </p>\n\n<p>I'm working with two workbooks and about 2500 rows and 20 columns. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1558513430, "post_id": 56251690, "comment_id": 99122053, "body": "I&#39;m confused!  You say you want the code to run when the workbook opens but your code refers to worksheet events."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "is_accepted": true, "score": 1, "last_activity_date": 1558513856, "creation_date": 1558513856, "answer_id": 56252500, "question_id": 56251690, "link": "https://stackoverflow.com/questions/56251690/how-do-i-enable-this-macro-to-run-everytime-i-open-or-edit-anything-on-my-excel/56252500#56252500", "title": "How do i enable this macro to run everytime i open or edit anything on my excel?", "body": "<p><strong>Worksheet_Activate()</strong> and <strong>Worksheet_Change</strong> do not run when you open the workbook.  They run when the sheet is activated or changed.</p>\n\n<p>You need <strong>Private Sub Workbook_Open()</strong> which is in the <strong>ThisWorkbook</strong> class.</p>\n\n<p>To run your macro when your workbook opens you would add the call to your Sub in there</p>\n\n<pre><code>Private Sub Workbook_Open()\n    AutoFitAll\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10748500, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--fNB_Y7SD4A/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gazDMTFpDY8Ymn40iLRddX-QLmyw/mo/photo.jpg?sz=128", "display_name": "user10748500", "link": "https://stackoverflow.com/users/10748500/user10748500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 56252500, "answer_count": 1, "score": 0, "last_activity_date": 1558513856, "creation_date": 1558510949, "last_edit_date": 1558511951, "question_id": 56251690, "link": "https://stackoverflow.com/questions/56251690/how-do-i-enable-this-macro-to-run-everytime-i-open-or-edit-anything-on-my-excel", "title": "How do i enable this macro to run everytime i open or edit anything on my excel?", "body": "<p>Sorry, I'm new to excel-vba and need some guidance. I want to run auto-adjust the height of merged cells upon opening my excel file.</p>\n\n<p>I found the code to auto-adjust the merged cell height, which I've tried and it works. I also found the code that supposes to enable macros to run everytime when the Excel file is opened. However, I have trouble integrating both. </p>\n\n<p>Code to auto-adjust height of cell</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AutoFitAll()\n    Call AutoFitMergedCells(Range(\"I13:L13\"))\nEnd Sub\n\n\nPublic Sub AutoFitMergedCells(oRange As Range)\n  Dim tHeight As Integer\n  Dim iPtr As Integer\n  Dim oldWidth As Single\n  Dim oldZZWidth As Single\n  Dim newWidth As Single\n  Dim newHeight As Single\n  With Sheets(\"Acceptance\")\n    oldWidth = 0\n    For iPtr = 1 To oRange.Columns.Count\n      oldWidth = oldWidth + .Cells(1, oRange.Column + iPtr - 1).ColumnWidth\n    Next iPtr\n    oldWidth = .Cells(1, oRange.Column).ColumnWidth + .Cells(1, oRange.Column + 1).ColumnWidth\n    oRange.MergeCells = False\n    newWidth = Len(.Cells(oRange.Row, oRange.Column).Value)\n    oldZZWidth = .Range(\"ZZ1\").ColumnWidth\n    .Range(\"ZZ1\") = Left(.Cells(oRange.Row, oRange.Column).Value, newWidth)\n    .Range(\"ZZ1\").WrapText = True\n    .Columns(\"ZZ\").ColumnWidth = oldWidth\n    .Rows(\"1\").EntireRow.AutoFit\n    newHeight = .Rows(\"1\").RowHeight / oRange.Rows.Count\n    .Rows(CStr(oRange.Row) &amp; \":\" &amp; CStr(oRange.Row + oRange.Rows.Count - 1)).RowHeight = newHeight\n    oRange.MergeCells = True\n    oRange.WrapText = True\n    .Range(\"ZZ1\").ClearContents\n    .Range(\"ZZ1\").ColumnWidth = oldZZWidth\n  End With\nEnd Sub\n</code></pre>\n\n<p>Code that enable the macro to run upon opening excel  </p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    'your code here\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    'your code here\nEnd Sub\n</code></pre>\n\n<p>So what I'm hoping to achieve is that when I open the excel file, the merged cells that has excessive content that is unable to be shown within the default height of the cells would automatically be adjusted so all the contents can be seen.</p>\n"}, {"tags": ["excel", "vba", "flat-file"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1558510299, "post_id": 56251398, "comment_id": 99120454, "body": "Can you post some example code?"}, {"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1558511511, "post_id": 56251398, "comment_id": 99121118, "body": "I don&#39;t think having to use 32 bits for backwards compatibility is likely to be the issue, but if it is then you should look into <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/directives\" rel=\"nofollow noreferrer\">preprocessor directives</a>."}], "owner": {"reputation": 1, "user_id": 11537826, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kGnnuEV_GH0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf50lzOC2R0WadaM_rS4d9VdrBG9Q/mo/photo.jpg?sz=128", "display_name": "qrious1", "link": "https://stackoverflow.com/users/11537826/qrious1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558602897, "creation_date": 1558509844, "last_edit_date": 1558602897, "question_id": 56251398, "link": "https://stackoverflow.com/questions/56251398/copying-to-flatfile-using-vba-in-excel", "title": "copying to flatfile using vba in excel", "body": "<p>I am trying to copy some 2000 rows of data from one Excel file to an Excel-based flatfile. Memory maxes out if I try to copy the whole set at one go, so I tried to copy/paste one row at a time. It takes a considerable amount of time now.\nAny workarounds?</p>\n\n<p>I am using Excel 2016 &amp; 32-bit system. I can't move this to 64-bit, since the other users may not have access to 64-bit system.</p>\n\n<p>here's the code used</p>\n\n<pre><code>        'run loop from first row to last filled row, check if flag is yes, then copy entire row\n        For RowCount = 1 To RowMax\n        Indicator = ThisWorkbook.Sheets(\"Product Summary View\").Cells(RowCount, 10).Value\n\n            If Indicator = \"Yes\" Then\n\n                ThisWorkbook.Sheets(\"Product Summary View\").Cells(RowCount, 10).EntireRow.Copy\n                DestWB.Sheets(\"Sheet1\").Cells(RowCountP, 1).PasteSpecial Paste:=xlPasteValues\n                RowCountP = RowCountP + 1\n\n            ElseIf Indicator = \"SupplyRisk Indicator\" Then\n\n                ThisWorkbook.Sheets(\"Product Summary View\").Cells(RowCount, 10).EntireRow.Copy\n                DestWB.Sheets(\"Sheet1\").Cells(RowCountP, 1).PasteSpecial Paste:=xlPasteValues\n                RowCountP = RowCountP + 1\n\n            End If\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1558623289, "post_id": 56251384, "comment_id": 99170183, "body": "On Stack Overflow, all information relevant to a problem needs to be <i>in the question</i> - links to outside sources should not be necessary. This is a Q&amp;A site and its content should be helpful to others, not just the original person with the problem. It&#39;s not possible to understand this problem understanding how the document is built - we need to be able to reproduce it. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> entirely within the question that contains just the information necessary to reproduce the issue, along with an exact description of how the code currently works and what the expected/desired result is."}], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1558568339, "post_id": 56266230, "comment_id": 99148711, "body": "Actually, after clicking a submit button at the end of the document all the hidden text is deleted. I chose to hide it only during editing in order to make it reversible. I didn&#39;t understand what you said about not being in range."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1558568934, "post_id": 56266230, "comment_id": 99148812, "body": "Your &#39;Selection.Range&#39; references do not insert content <i>into</i> a bookmark; at best they&#39;ll insert it after or in place of whatever is selected. If what is selected is a bookmark, the content will be inserted <i>after</i> it."}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1558569698, "post_id": 56266230, "comment_id": 99148948, "body": "The &#39;selection.range&#39; was put only to give the button two states. By clicking the button it gets selected and replaced with the other button from autotext. The bookmark that I want to be switched from hidden status is placed after the selection. For testing purposes I left only <code>Expand1</code> Macrobutton with one line of VBA: <code>Bookmarks(&quot;CollapseMentiuniReclamant&quot;).Range.Font.Hidden = False</code> and it&#39;s still not showing."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1558570084, "post_id": 56266230, "comment_id": 99149029, "body": "In your document, press F5 (Goto) and choose the CollapseMentiuniReclamant bookmark. What gets selected?"}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1558570241, "post_id": 56266230, "comment_id": 99149067, "body": "The hidden text gets selected. In my case, it&#39;s only a word &quot;list&quot; that&#39;s positioned after all visible text."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1558572715, "post_id": 56266230, "comment_id": 99149464, "body": "The code &#39;Bookmarks(&quot;CollapseMentiuniReclamant&quot;).Range.Font.Hidden = False&#39; and your Expand1 macro both work for me - including when the latter is triggered by a MACROBUTTON field. Check your field coding."}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1558591652, "post_id": 56266230, "comment_id": 99153117, "body": "The button works because I&#39;ve added a MsgBox and the message pops out. I&#39;ll try today on a different computer. Thank you!"}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "edited": false, "score": 0, "creation_date": 1559335864, "post_id": 56266230, "comment_id": 99401562, "body": "the code worked after I&#39;ve added <code>ActiveDocument.</code> before  <code>&#39;Bookmarks(&quot;CollapseMentiuniReclamant&quot;).Range.Font.Hidden = False&#39;</code>. I can&#39;t seem to find a cause for this, because my code didn&#39;t trigger another document, all the computing was done using a single document."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1558567639, "creation_date": 1558567639, "answer_id": 56266230, "question_id": 56251384, "link": "https://stackoverflow.com/questions/56251384/vba-code-for-unhiding-a-bookmarked-text-is-not-working/56266230#56266230", "title": "VBA code for unhiding a bookmarked text is not working", "body": "<p>It's not showing up because what you're trying to hide/unhide isn't inside the bookmarked range. In any event, you should be inserting/deleting the content, not simply toggling it's hidden property. Making something hidden is no guarantee it won't be seen or printed (even if not seen), as those settings depend on how the end user has Word configured.</p>\n"}], "owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1558570138, "creation_date": 1558509795, "last_edit_date": 1558570138, "question_id": 56251384, "link": "https://stackoverflow.com/questions/56251384/vba-code-for-unhiding-a-bookmarked-text-is-not-working", "title": "VBA code for unhiding a bookmarked text is not working", "body": "<p>I've created an ActiveX dropdown list and each option is linked to a bookmark for the text. Under the ActiveX controls there are the bookmarks (<code>R1</code> and<code>R2</code>), hidden.</p>\n\n<p>When I hit the <code>btnselect</code> button, all the other bookmarks, except the selected one, get deleted and the selected one becomes visible.\nIn the bookmark <code>R2</code> </p>\n\n<p>I have a <code>MacroButton</code> for showing/hiding another text (<code>CollapseMentiuniReclamant</code>). When clicking the button it runs either <code>Expand1</code> sub or <code>Collapse1</code> sub, but the bookmark <code>CollapseMentiuniReclamant</code> doesn't show up. </p>\n\n<p>I've simplified the document and codes as much as possible. Link to the document - <a href=\"https://wetransfer.com/downloads/1caea3c5d3b05e226e8b8f6a29760ad220190522071742/15db59\" rel=\"nofollow noreferrer\">https://wetransfer.com/downloads/1caea3c5d3b05e226e8b8f6a29760ad220190522071742/15db59</a>.</p>\n\n<p>The vba code is:</p>\n\n<pre><code>Private Sub btnselect_Click()\nIf ComboBox1.Value = \"1\" Then\nBookmarks(\"R1\").Range.Font.Hidden = False\nBookmarks(\"R2\").Range.Font.Hidden = False\nBookmarks(\"R2\").Range.Delete\nEnd If\nIf ComboBox1.Value = \"2\" Then\nBookmarks(\"R1\").Range.Font.Hidden = False\nBookmarks(\"R1\").Range.Delete\nBookmarks(\"R2\").Range.Font.Hidden = False\nBookmarks(\"CollapseMentiuniReclamant\").Range.Font.Hidden = True\nEnd If\nEnd Sub\nSub Expand1()\nActiveDocument.AttachedTemplate.BuildingBlockEntries(\"Collapse1\").Insert _\nWhere:=Selection.Range\nBookmarks(\"CollapseMentiuniReclamant\").Range.Font.Hidden = False\nEnd Sub\nSub Collapse1()\nActiveDocument.AttachedTemplate.BuildingBlockEntries(\"Expand1\").Insert _\nWhere:=Selection.Range\nBookmarks(\"CollapseMentiuniReclamant\").Range.Font.Hidden = True\nEnd Sub\n</code></pre>\n\n<p>Update: I've simplified the last part of code and the problem still persists:</p>\n\n<pre><code>Sub Expand1()\nBookmarks(\"CollapseMentiuniReclamant\").Range.Font.Hidden = False\nEnd Sub\n</code></pre>\n\n<p>I've even removed the button entirely and ran the macro from View Macros Tab and it's not working.\nWhy doesn't <code>CollapseMentiuniReclamant</code> show up?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558510055, "post_id": 56251328, "comment_id": 99120296, "body": "I guess you are taking <code>D3:D2000</code> because your data won&#39;t exceed that but you want to stop on the last row with data which could be <code>D958</code>. Is that it?"}, {"owner": {"reputation": 23, "user_id": 9396005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba7b7960d8896f4cde7519c3484f783?s=128&d=identicon&r=PG&f=1", "display_name": "thomasuponor", "link": "https://stackoverflow.com/users/9396005/thomasuponor"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558510186, "post_id": 56251328, "comment_id": 99120384, "body": "The list of addresses is from C3:C2000: NORDVEJ 3 SLAGELSE DENMARK, NORDG&#197;RDE 1A SVINNINGE DENMARK, DRAGSTRUPVEJ 42;DRAGSTRUP CEMENTST&#216;BERI APS ERSLEV  DENMARK, NORDG&#197;RDE 1A SVINNINGE DENMARK,  So I just want to copy street name + street number to the next cells D2:D2000"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558510233, "post_id": 56251328, "comment_id": 99120418, "body": "Then where do your numbers end?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1558510299, "post_id": 56251328, "comment_id": 99120455, "body": "You are gonna need to split your adresses and use most likely regex to handle this."}, {"owner": {"reputation": 23, "user_id": 9396005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba7b7960d8896f4cde7519c3484f783?s=128&d=identicon&r=PG&f=1", "display_name": "thomasuponor", "link": "https://stackoverflow.com/users/9396005/thomasuponor"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558510460, "post_id": 56251328, "comment_id": 99120538, "body": "I have one address in each cell going from C2:C2000. So number ends in every cell"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1558543715, "post_id": 56251328, "comment_id": 99139638, "body": "You show <code>NORDG&#197;RDE 1A SVINNINGE DENMARK</code> as one of your addresses. Do you really want to split this after the <code>1</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1558512572, "creation_date": 1558512572, "answer_id": 56252122, "question_id": 56251328, "link": "https://stackoverflow.com/questions/56251328/looping-with-condition-do-until-numbers-end/56252122#56252122", "title": "Looping with condition. Do until numbers end", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub CopyYes()\n\n    Dim arr As Variant, strSplit As Variant\n    Dim i As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        arr = .Range(\"C3:C2000\")\n\n        For i = LBound(arr) To UBound(arr)\n\n            strSplit = Split(arr(i, 1), \" \")\n\n            .Range(\"E\" &amp; i + 2).Value = strSplit(0)\n\n            .Range(\"F\" &amp; i + 2).Value = strSplit(1)\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Results:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/PpmEb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PpmEb.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1558512963, "last_edit_date": 1558512963, "creation_date": 1558512620, "answer_id": 56252135, "question_id": 56251328, "link": "https://stackoverflow.com/questions/56251328/looping-with-condition-do-until-numbers-end/56252135#56252135", "title": "Looping with condition. Do until numbers end", "body": "<p>Here is a function that will perform your 'cut' on a string. It's not pretty and it could no doubt be better written with a simple reg-ex command but..</p>\n\n<pre><code>Function untilnumeric(txt As String) As String\n    Dim i As Long\n    Dim started As Boolean\n    For i = 1 To Len(txt)\n        If Asc(Mid(txt, i, 1)) &gt; 47 And Asc(Mid(txt, i, 1)) &lt; 58 Then\n            started = True\n        Else\n            If started = True And Asc(Mid(txt, i, 1)) = 32 Then\n                untilnumeric = Left(txt, i - 1)\n                Exit For\n            End If\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>You could use it like this to perform it on column C - copying the result to D:</p>\n\n<pre><code>Range(\"D3:D2000\").Value = Range(\"C3:C2000\").Value\nFor Each c In Range(\"D3:D2000\").Cells\n    c.Value = untilnumeric(c.Value)\nNext\n</code></pre>\n\n<p>Note: Amended slightly to pick up any letters within the number part. eg.100A</p>\n"}], "owner": {"reputation": 23, "user_id": 9396005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cba7b7960d8896f4cde7519c3484f783?s=128&d=identicon&r=PG&f=1", "display_name": "thomasuponor", "link": "https://stackoverflow.com/users/9396005/thomasuponor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 56252122, "answer_count": 2, "score": 0, "last_activity_date": 1558512963, "creation_date": 1558509617, "last_edit_date": 1558509835, "question_id": 56251328, "link": "https://stackoverflow.com/questions/56251328/looping-with-condition-do-until-numbers-end", "title": "Looping with condition. Do until numbers end", "body": "<p>I have a cell with a full address. I want to copy street name and street number to the next cell. E.g \"STRANDVEJEN 100 MIDDELFART DENMARK\"</p>\n\n<p>In this example I want \"STRANDVEJEN 100\" to be copied.</p>\n\n<p>Currently everything is being copied to the next cell.\nBut I need advice how to continue</p>\n\n<pre><code>Sub move()\n    Range(\"C3:C2000\").Copy Range(\"D3:D2000\")\n    Do until......\nEnd Sub\n</code></pre>\n\n<p>I need help with the do until part.</p>\n"}, {"tags": ["excel", "vba", "loops", "ms-word", "paragraph"], "answers": [{"comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 31, "user_id": 11426405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481b8b845c3c390db81fac5429d7dde5?s=128&d=identicon&r=PG&f=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/11426405/sanjay"}, "edited": false, "score": 0, "creation_date": 1558859205, "post_id": 56266345, "comment_id": 99233429, "body": "You would probably find it far easier if you simply bookmarked all the ranges in your source document. Then you&#39;d only need two columns - one for the source bookmark and another for the destination bookmark."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 31, "user_id": 11426405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481b8b845c3c390db81fac5429d7dde5?s=128&d=identicon&r=PG&f=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/11426405/sanjay"}, "edited": false, "score": 0, "creation_date": 1558864254, "post_id": 56266345, "comment_id": 99234420, "body": "So how do you know what words will be in the source document?"}, {"owner": {"reputation": 31, "user_id": 11426405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481b8b845c3c390db81fac5429d7dde5?s=128&d=identicon&r=PG&f=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/11426405/sanjay"}, "edited": false, "score": 0, "creation_date": 1558934349, "post_id": 56266345, "comment_id": 99248480, "body": "Images of excel sheet, source and destination document output of my and macropod added."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 31, "user_id": 11426405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481b8b845c3c390db81fac5429d7dde5?s=128&d=identicon&r=PG&f=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/11426405/sanjay"}, "edited": false, "score": 0, "creation_date": 1558947025, "post_id": 56266345, "comment_id": 99253250, "body": "The problem is that your end text is inside the table. Put whatever you need to define the end of the range outside the table. Otherwise, you&#39;re effectively telling Word to not include the end of the last cell or the end of the table - which is impossible for it to do if you want the last cell copied."}, {"owner": {"reputation": 31, "user_id": 11426405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481b8b845c3c390db81fac5429d7dde5?s=128&d=identicon&r=PG&f=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/11426405/sanjay"}, "edited": false, "score": 0, "creation_date": 1558948201, "post_id": 56266345, "comment_id": 99253909, "body": "Dear Sir, I have added &quot;end&quot; word after table for your code and working but source formatting getting change (if it contain table within two text). However, in my code copy paste only last row entry in each loop but maintaining formatting as well as able to include last table cell. Sir, thank you very much for healthy discussion and your valuable time and effort."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 31, "user_id": 11426405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481b8b845c3c390db81fac5429d7dde5?s=128&d=identicon&r=PG&f=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/11426405/sanjay"}, "edited": false, "score": 0, "creation_date": 1558999173, "post_id": 56266345, "comment_id": 99273059, "body": "The change will be due to the inconsistent use of Styles in your documents. I&#39;ve updated the answer to suggest a copy/paste approach that should work around that issue."}, {"owner": {"reputation": 31, "user_id": 11426405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481b8b845c3c390db81fac5429d7dde5?s=128&d=identicon&r=PG&f=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/11426405/sanjay"}, "edited": false, "score": 0, "creation_date": 1559013450, "post_id": 56266345, "comment_id": 99275361, "body": "Dear Sir, working perfectly without any format change. Thank you very much for your time, healthy discussion and effort."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 2, "last_activity_date": 1558999082, "last_edit_date": 1558999082, "creation_date": 1558568763, "answer_id": 56266345, "question_id": 56251088, "link": "https://stackoverflow.com/questions/56251088/loop-copy-paragraph-based-on-excel-list-from-one-document-to-another-using-book/56266345#56266345", "title": "Loop: Copy paragraph based on excel list from one document to another using bookmark", "body": "<p>Your description is unclear. Perhaps:</p>\n\n<pre><code>Sub CopyPasteParagraphs()\nDim wdApp As New Word.Application\nDim DocSrc As Word.Document, DocTgt As Word.Document, wdRng As Word.Range\nDim WS As Worksheet, r As Long\nSet WS = Sheets(\"List1\")\nWith wdApp\n  .Visible = True\n  Set DocSrc = .Documents.Open(ActiveWorkbook.Path &amp; \"\\Source Document.doc\") 'SourceDocument\n  Set DocTgt = Documents.Open(ActiveDocument.Path &amp; \"\\Destination Document.doc\")\n  With DocSrc\n    For r = 1 To WS.UsedRange.SpecialCells(xlCellTypeLastCell).Row\n    With .Range\n      With .Find\n        .Text = WS.Range(\"A\" &amp; r) &amp; \"*\" &amp; WS.Range(\"B\" &amp; r)\n        .MatchWildcards = True\n        .Execute\n      End With\n      If .Find.Found = True Then Set wdRng = .Duplicate\n        With DocTgt\n          If .Bookmarks.Exists(\"Text\" &amp; r) Then\n            .Bookmarks(\"Text\" &amp; r).Range.FormattedText = wdRng.FormattedText\n          End If\n        End If\n      End If\n    End With\n    .Close False\n  End With\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Instead of:</p>\n\n<pre><code>      If .Bookmarks.Exists(\"Text\" &amp; r) Then\n        .Bookmarks(\"Text\" &amp; r).Range.FormattedText = wdRng.FormattedText\n      End If\n</code></pre>\n\n<p>you might use:</p>\n\n<pre><code>      If .Bookmarks.Exists(\"Text\" &amp; r) Then\n        wdRng.Copy\n        .Bookmarks(\"Text\" &amp; r).Range.PasteAndFormat wdFormatOriginalFormatting\n      End If\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11426405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/481b8b845c3c390db81fac5429d7dde5?s=128&d=identicon&r=PG&f=1", "display_name": "sanjay", "link": "https://stackoverflow.com/users/11426405/sanjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 56266345, "answer_count": 1, "score": 0, "last_activity_date": 1558999082, "creation_date": 1558508702, "last_edit_date": 1558934229, "question_id": 56251088, "link": "https://stackoverflow.com/questions/56251088/loop-copy-paragraph-based-on-excel-list-from-one-document-to-another-using-book", "title": "Loop: Copy paragraph based on excel list from one document to another using bookmark", "body": "<p>Please refer below screenshot for more details.</p>\n\n<p>Excel Sheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/KR957.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KR957.jpg\" alt=\"Excel sheet\"></a></p>\n\n<p>Source Document</p>\n\n<p><a href=\"https://i.stack.imgur.com/N3i66.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N3i66.jpg\" alt=\"Source Document\"></a></p>\n\n<p>Below my code output in Destination Document\n<a href=\"https://i.stack.imgur.com/kF9cw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kF9cw.jpg\" alt=\"Below my code output in Destination Document\"></a></p>\n\n<p>Macropod output in Destination Document</p>\n\n<p><a href=\"https://i.stack.imgur.com/9MUuz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9MUuz.jpg\" alt=\"Macropod output in Destination Document\"></a></p>\n\n<p>The excel file Sheets(\"List1\"), containing two columns with text/string.\nColumn A having starting word of paragraph or table and Column B having ending word of paragraph or table. </p>\n\n<p>Based on column A and B text, the macro find the starting and ending word in source document.\nIf found then, copy all text or table including starting and ending word from source document with formatting and past it at bookmarks (Text1, Text2 and so on) in destination document with source formatting.</p>\n\n<p>The paragraph I am trying to copy contains text and tables (either in between two text or at end) </p>\n\n<p>How to loop column A and B text/string with loop of bookmark. </p>\n\n<p>Below macro what I have try is find text based on column A and B in source document, copy with formatting and paste it at bookmark in destination document.</p>\n\n<p>But it selecting range (text or table) of last entry in each loop. \nI have try to edit below code but not succeeded. I do not have good knowledge of coding. </p>\n\n<p>Kindly look wonderful answer received from Macropod and my comments. </p>\n\n<pre><code>Sub CopyPasteParagraphsNew()\nDim wdApp As New Word.Application\nDim DocSrc As Word.Document, DocTgt As Word.Document, wdRng As Word.Range\nDim WS As Worksheet, r As Long\nDim i As Long\nDim j As Long\n\nDim M As Long\nDim N As Long\n\n\nSet WS = Sheets(\"List1\")\n  Set MsWord = CreateObject(\"Word.Application\")\n  On Error Resume Next\nSet wrdApp = GetObject(, \"Word.Application\")\nOn Error GoTo 0\nIf wrdApp Is Nothing Then\nSet wrdApp = CreateObject(\"Word.Application\")\nbWeStartedWord = True\nEnd If\n\nWith DocSrc\n\nWith MsWord\n.Visible = True\n.Documents.Open (ActiveWorkbook.Path &amp; \"\\Source Document.doc\")\n.Activate\n\nMsWord.Selection.HomeKey Unit:=wdStory\nWith MsWord.Selection.Find\n\nM = Cells(Rows.Count, \"A\").End(xlUp).Row 'selecting last string of column A and pasting at each bookmark\nFor i = 1 To M\n.ClearFormatting\n.Wrap = wdFindStop\n.MatchCase = True\n.Text = Cells(i, \"A\").Value\n.Execute\nMsWord.Selection.Collapse\n\nNext i\n\nN = Cells(Rows.Count, \"B\").End(xlUp).Row 'selecting last string of column B and pasting at each bookmark\nFor j = 1 To N\nlngStart = MsWord.Selection.End\n.Text = Cells(j, \"B\").Value\n.Execute\n\nNext j\nlngEnd = MsWord.Selection.End\nMsWord.ActiveDocument.Range(lngStart, lngEnd).Copy\n\nSet DocTgt = Documents.Open(ActiveWorkbook.Path &amp; \"\\Destination Document.doc\")\nWith DocTgt\n For t = 1 To DocTgt.Bookmarks.Count\nIf DocTgt.Bookmarks.Exists(\"Text\" &amp; t) Then\n\nMsWord.Selection.GoTo What:=wdGoToBookmark, Name:=(\"Text\" &amp; t)\nMsWord.Selection.PasteAndFormat wdFormatOriginalFormatting\n\nEnd If\nNext\nEnd With\nEnd With\nEnd With\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558506460, "post_id": 56250322, "comment_id": 99118519, "body": "Isn&#39;t it complaining about <code>Me.ListBox2.Value</code>? Take a look at <a href=\"https://stackoverflow.com/a/21056444/7404943\">this answer</a> about clearing listbox (selection or whole list)"}, {"owner": {"reputation": 13, "user_id": 11537440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a139edad81d408de10e6619f90f4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Nosferato4", "link": "https://stackoverflow.com/users/11537440/nosferato4"}, "reply_to_user": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558516746, "post_id": 56250322, "comment_id": 99123969, "body": "Hi, thank you for the comment Barbsan, however I am still confused.  Excel highlights this here: Private Sub ListBox1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)  ^Which means this is the 1 with the problem. But I can&#39;t figure out what the problem is because this was how the tutorial did it and they are right.  Why do you suggest clearing listbox? Sorry. Pretty new to VBA here."}, {"owner": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558517101, "post_id": 56250322, "comment_id": 99124179, "body": "I don&#39;t suggest, I see that you have comment <code>&#39;clear listbox1</code> followed by <code>Me.ListBox2.Value</code> which I expect to cause the error. Excel sometimes struggles to show the exact line that causes the error. I&#39;ve just chosen random moment from your link <a href=\"https://youtu.be/dWTEUWqlQAc?t=533\" rel=\"nofollow noreferrer\">youtu.be/dWTEUWqlQAc?t=533</a> and there&#39;s <code>Me.ListBox2.Clear</code> instead of this line"}, {"owner": {"reputation": 13, "user_id": 11537440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a139edad81d408de10e6619f90f4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Nosferato4", "link": "https://stackoverflow.com/users/11537440/nosferato4"}, "reply_to_user": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558518438, "post_id": 56250322, "comment_id": 99124962, "body": "Hi, I Changed this      &#39;clear listbox1      Me.ListBox2.Value  to  &gt; Me.listbox1.MultiSelect = fmMultiSelectSingle Me.listbox1.Value = &quot;&quot;  &gt; Me.listbox1.MultiSelect = fmMultiSelectMulti   But I don&#39;t think it is working."}, {"owner": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558518603, "post_id": 56250322, "comment_id": 99125043, "body": "Did you read my last comment? In your video there&#39;s a <code>Me.ListBox2.Clear</code> on that line"}, {"owner": {"reputation": 13, "user_id": 11537440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a139edad81d408de10e6619f90f4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Nosferato4", "link": "https://stackoverflow.com/users/11537440/nosferato4"}, "reply_to_user": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558659804, "post_id": 56250322, "comment_id": 99182941, "body": "Hi, yes I understand that. But what I don&#39;t understand is why this is a problem and I do not know what to do..."}, {"owner": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558679920, "post_id": 56250322, "comment_id": 99187046, "body": "So you want to get explanation why <code>Me.ListBox2.Value</code> causes that error? About &quot;what to do&quot; I&#39;d recommend to follow your tutorial and use <code>Me.ListBox2.Clear</code>"}, {"owner": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558680423, "post_id": 56250322, "comment_id": 99187232, "body": "Do you declare <code>lastrow</code> anywhere? Like <code>Dim lastrow As Integer</code> or something similar?"}, {"owner": {"reputation": 13, "user_id": 11537440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a139edad81d408de10e6619f90f4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Nosferato4", "link": "https://stackoverflow.com/users/11537440/nosferato4"}, "reply_to_user": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558684362, "post_id": 56250322, "comment_id": 99188923, "body": "Hi Barbsan,  Thank you for your reply. Nothing works for me at the moment. I am still receiving an error message even though I changed i to Me.ListBox2.Clear  With regards to your comment about lastrow, i have this code in Listbox1 mouse up and Listbox2 click:  <code>lastrow = ThisWorkbook.Worksheets(&quot;List of Emails&quot;).Cells(Rows.Count, 1).End(xlUp).Row</code>"}, {"owner": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558684943, "post_id": 56250322, "comment_id": 99189188, "body": "Could you comment all lines but this with <code>lastrow</code> (or create some new sub and copy that line) and check whether it fails or not?"}, {"owner": {"reputation": 13, "user_id": 11537440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a139edad81d408de10e6619f90f4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Nosferato4", "link": "https://stackoverflow.com/users/11537440/nosferato4"}, "reply_to_user": {"reputation": 3238, "user_id": 7404943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/364eff21ecce181be48b17e7208397e2?s=128&d=identicon&r=PG&f=1", "display_name": "barbsan", "link": "https://stackoverflow.com/users/7404943/barbsan"}, "edited": false, "score": 0, "creation_date": 1558685985, "post_id": 56250322, "comment_id": 99189713, "body": "Hi, I commented all lines with &#39;lastrow except for the 1 you mentioned, but nothing seems to be working.  Not sure how to proceed with the other method.  Do you mind if I send my excel softcopy file to you?  Thanks!"}], "owner": {"reputation": 13, "user_id": 11537440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a139edad81d408de10e6619f90f4f7?s=128&d=identicon&r=PG&f=1", "display_name": "Nosferato4", "link": "https://stackoverflow.com/users/11537440/nosferato4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558505325, "creation_date": 1558505325, "question_id": 56250322, "link": "https://stackoverflow.com/questions/56250322/excel-vba-listbox-multiselect-to-fill-other-listbox-vba-code-with-multi-page-g", "title": "Excel VBA Listbox MultiSelect To Fill Other ListBox - VBA code with multi page gives error", "body": "<p>I am creating a Excel VBA Listbox MultiSelect To Fill Other ListBox using the video tutorial here:</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=dWTEUWqlQAc\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=dWTEUWqlQAc</a></p>\n\n<p>Basically, what this means is, \"Excel, if I select these items from ListBox 1 which obtains a range of values from Excel Column C, return me a list of values from Excel Column A on the same row\"</p>\n\n<p>However, I keep getting an error message \"Compile error Invalid Use of Property\"</p>\n\n<p>This highlights this code here:</p>\n\n<pre><code>Private Sub ListBox1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n</code></pre>\n\n<p>I am not sure what I am doing wrong. Is it because I am using Multi-page or something with this code?</p>\n\n<p>I have tried re-watching that damned tutorial but nothing seems to be working.</p>\n\n<pre><code>Private Sub ListBox1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\n\n'find lastrow\n\nlastrow = ThisWorkbook.Worksheets(\"List of Emails\").Cells(Rows.Count, 1).End(xlUp).Row\n\n\n'clear listbox1\nMe.ListBox2.Value\n\n'not just one value, but whichever were selected\nFor SelItm = LBound(Me.ListBox1.Email) To UBound(Me.ListBox1.Email)\n    If Me.ListBox1.Selected(SelItm) = True Then\n       'It is selected\n\n        curVal = Me.ListBox1.List(SelItm, 0)\n\n        For X = 2 To lastrow\n            If emails.Cells(X, \"c\") = curVal Then\n                'found a match; populate listbox2\n                Me.ListBox2.AddItem ThisWorkbook.Worksheets(\"List of Emails\").Cells(X, \"a\")\n            End If\n        Next X\n\n\n    End If\n\n\nNext SelItm\n\n\nEnd Sub\n</code></pre>\n\n<p>I cannot get rid of the error message no matter how hard I try. Like wtf is \"Compile error Invalid Use of Property\" ? I did exactly as the Youtube guide did.</p>\n\n<p>Appreciate if anyone can offer any kind assistance. Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1558507833, "post_id": 56250321, "comment_id": 99119153, "body": "Why can&#39;t you solve this issue? Where exactly did you get stuck? What was your attempt? What is your question? You didn&#39;t ask one yet. \u2022 Because this is no free coding service you must include the code you have tried and explain where you got stuck or errors. \u2022 Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to improve your question."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1558511435, "post_id": 56250321, "comment_id": 99121072, "body": "You have <code>vba</code> as a tag.. thus I assume you want some code to help.. Please provide what you have already so we can help you where you are getting stuck..."}, {"owner": {"reputation": 85, "user_id": 11535108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc12b8d595913e487cde6b6dcae178f?s=128&d=identicon&r=PG&f=1", "display_name": "D3merzel", "link": "https://stackoverflow.com/users/11535108/d3merzel"}, "edited": false, "score": 0, "creation_date": 1558544410, "post_id": 56250321, "comment_id": 99139985, "body": "Hello! Sorry, but I&#39;m really knew to programming and VBA which is why I&#39;m asking this question without giving some code. I&#39;m trying to teach myself VBA and Excel."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 11535108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc12b8d595913e487cde6b6dcae178f?s=128&d=identicon&r=PG&f=1", "display_name": "D3merzel", "link": "https://stackoverflow.com/users/11535108/d3merzel"}, "edited": false, "score": 0, "creation_date": 1558545325, "post_id": 56251827, "comment_id": 99140361, "body": "I tried it but it doesn&#39;t work for me. It doesn&#39;t show me any errors. Nothing happens."}, {"owner": {"reputation": 85, "user_id": 11535108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc12b8d595913e487cde6b6dcae178f?s=128&d=identicon&r=PG&f=1", "display_name": "D3merzel", "link": "https://stackoverflow.com/users/11535108/d3merzel"}, "edited": false, "score": 0, "creation_date": 1558586731, "post_id": 56251827, "comment_id": 99151829, "body": "Hello. What do you mean with debugging? He doesn&#39;t show me any errors. There is no debugging pop up. Nothing happens."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 85, "user_id": 11535108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc12b8d595913e487cde6b6dcae178f?s=128&d=identicon&r=PG&f=1", "display_name": "D3merzel", "link": "https://stackoverflow.com/users/11535108/d3merzel"}, "edited": false, "score": 0, "creation_date": 1558590872, "post_id": 56251827, "comment_id": 99152856, "body": "insert a break point in the first line and go through code using F8 to find what is going wrong using immediate and watches windows."}, {"owner": {"reputation": 85, "user_id": 11535108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc12b8d595913e487cde6b6dcae178f?s=128&d=identicon&r=PG&f=1", "display_name": "D3merzel", "link": "https://stackoverflow.com/users/11535108/d3merzel"}, "edited": false, "score": 0, "creation_date": 1558631149, "post_id": 56251827, "comment_id": 99173948, "body": "Okay, I will try it out. Thank you."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1558511445, "creation_date": 1558511445, "answer_id": 56251827, "question_id": 56250321, "link": "https://stackoverflow.com/questions/56250321/searching-for-a-value-string-and-aditional-endings-in-another-worksheet/56251827#56251827", "title": "Searching for a value/string and aditional endings in another worksheet", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nSub CopyYes()\n\n    Dim i As Long, LastRow1 As Long, LastRow3 As Long\n    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet\n    Dim rngToSearch As Range, rngFound As Range\n\n    With ThisWorkbook\n        Set ws1 = .Worksheets(\"Sheet1\")\n        Set ws2 = .Worksheets(\"Sheet2\")\n        Set ws3 = .Worksheets(\"Sheet3\")\n    End With\n\n    Set rngToSearch = ws2.Range(\"B1:E3\")\n\n    With ws1\n\n        LastRow1 = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        For i = 1 To LastRow1\n\n            Set rngFound = rngToSearch.Find(.Range(\"A\" &amp; i).Value &amp; \"*\", LookIn:=xlValues)\n\n            If Not rngFound Is Nothing Then\n\n                LastRow3 = ws3.Cells(ws3.Rows.Count, \"A\").End(xlUp).Row\n\n                If LastRow3 = 1 And ws3.Range(\"A1\").Value = \"\" Then\n                    LastRow3 = 1\n                Else\n                    LastRow3 = LastRow3 + 1\n                End If\n\n                ws2.Range(\"B\" &amp; rngFound.Row &amp; \":E\" &amp; rngFound.Row).Copy\n                ws3.Range(\"A\" &amp; LastRow3).PasteSpecial Paste:=xlPasteValues\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 11535108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc12b8d595913e487cde6b6dcae178f?s=128&d=identicon&r=PG&f=1", "display_name": "D3merzel", "link": "https://stackoverflow.com/users/11535108/d3merzel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1558511445, "creation_date": 1558505324, "last_edit_date": 1558506164, "question_id": 56250321, "link": "https://stackoverflow.com/questions/56250321/searching-for-a-value-string-and-aditional-endings-in-another-worksheet", "title": "Searching for a value/string and aditional endings in another worksheet", "body": "<p>I want to use each value/string in a certain column (A1, A2, A3...) in worksheet 1 to search a certain range in worksheet 2 for that value/string alone and (!) with additional endings.</p>\n\n<p>Example: Use in worksheet 1 A1 = K-1234 and search in a defined range in worksheet 2 for the string K-1234 and combinations of K-1234 with /x, /y, /z. Whenever you find such a combination copy the whole row from worksheet 2 into a new worksheet 3.</p>\n\n<p><strong>Using column A in worksheet 1:</strong></p>\n\n<pre><code>worksheet 1    \n\nA\n\nA1    = K-1234\nA2    = Y-1234\nA3    = RP-78\n\u2026\nA1000 = Z/34-1\n</code></pre>\n\n<p><strong>Searching in worksheet 2 in the range B1:E3 for A1, A1/x, A1/y and A1/z:</strong></p>\n\n<pre><code>worksheet 2\n\nA     B      C     D     E\n\nGHJ   A1/x   456   G5G   F1-1\nFF-   A1     23-A  TTR   BV1\n8/a   A1/z   bnR   34-1  bn/1\n</code></pre>\n\n<p><strong>That's how worksheet 3 should look like after using A1 from worksheet 1 to search in worksheet 2:</strong></p>\n\n<pre><code>worksheet 3\n\nA     B     C      D      E \n\nFF-   A1    23-A   TTR   BV1\nGHJ   A1/x  456    G5G    F1-1\n8/a   A1/z  bnR    34-1   bn/1\n</code></pre>\n\n<p><strong>or with A1 written out:</strong></p>\n\n<pre><code>worksheet 3\n\nA     B          C      D      E \n\nFF-   K-1234     23-A   TTR   BV1\nGHJ   K-1234/x   456    G5G    F1-1\n8/a   K-1234/z   bnR    34-1   bn/1\n</code></pre>\n\n<p>(A1/y doesn't exist)</p>\n\n<p>Continue with A2, A2/x, A2/y and A2/z and so on till the end of the column (for example A1000).</p>\n\n<p>Hope I could explain the problem sufficiently. I would be very thankful for any suggestion.</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11537378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KhrlAZSDjIM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceOu_croND7Xr0GbH38d1venBqWg/mo/photo.jpg?sz=128", "display_name": "Oki Toma", "link": "https://stackoverflow.com/users/11537378/oki-toma"}, "edited": false, "score": 0, "creation_date": 1558505200, "post_id": 56250109, "comment_id": 99117999, "body": "Thank you for quick help. I used the below query and its returning. &quot;vbSunday&quot; was not working in the ACCESS Query creater so used number values."}, {"owner": {"reputation": 537, "user_id": 8631622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8c3c8025900b42d95e64cd0d1518ee?s=128&d=identicon&r=PG&f=1", "display_name": "Pie", "link": "https://stackoverflow.com/users/8631622/pie"}, "edited": false, "score": 0, "creation_date": 1558509111, "post_id": 56250109, "comment_id": 99119742, "body": "Can you help me with this question? I tried everything I knew but could not solve. <a href=\"https://stackoverflow.com/q/56207459/8631622\">stackoverflow.com/q/56207459/8631622</a> @Caius Jard"}], "tags": [], "owner": {"reputation": 46070, "user_id": 1410664, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/vGygm.gif?s=128&g=1", "display_name": "Caius Jard", "link": "https://stackoverflow.com/users/1410664/caius-jard"}, "is_accepted": false, "score": 1, "last_activity_date": 1558520526, "last_edit_date": 1558520526, "creation_date": 1558504212, "answer_id": 56250109, "question_id": 56250042, "link": "https://stackoverflow.com/questions/56250042/how-to-select-all-records-where-the-event-date-is-weekend-and-export-to-another/56250109#56250109", "title": "How to SELECT all records where the event date is weekend and export to another table", "body": "<p>Apparently access has a weekday() function:</p>\n\n<p><a href=\"https://support.office.com/en-gb/article/weekday-function-05d360d7-2c3f-4691-9448-c96ea0351940\" rel=\"nofollow noreferrer\">https://support.office.com/en-gb/article/weekday-function-05d360d7-2c3f-4691-9448-c96ea0351940</a></p>\n\n<p>I recommend you use the parameter that fixes the start of the week to avoid regional variations affecting your query</p>\n\n<pre><code>WHERE weekday(datefield, 1) IN (1,7)\n</code></pre>\n\n<p>Your weekday query would be similar; use NOT IN, combined with a test that your time field is &lt;= '05:00' OR >= '22:00', assuming time is a string. It'll need a leading zero to work out correctly. Remember to use brackets when using OR.</p>\n\n<pre><code>WHERE ... NOT IN (1,7) ANd (timefield &lt;= '05:00' OR timefield &gt;= '22:00')\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 11537378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KhrlAZSDjIM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceOu_croND7Xr0GbH38d1venBqWg/mo/photo.jpg?sz=128", "display_name": "Oki Toma", "link": "https://stackoverflow.com/users/11537378/oki-toma"}, "edited": false, "score": 0, "creation_date": 1558600448, "post_id": 56252191, "comment_id": 99157152, "body": "Thank you.. I have used this and looks working correctly for me .....WHERE ((([03_WorkFile].\u5e74\u6708\u65e5) Not In ([00_Holiday].[Date-Holiday])) AND (([03_WorkFile].\u6642\u9593)&gt;#12/30/1899 22:0:0# Or ([03_WorkFile].\u6642\u9593)&lt;#12/30/1899 5:0:0#) AND ((Weekday([\u5e74\u6708\u65e5],1)) Not In (1,7)))"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 15, "user_id": 11537378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KhrlAZSDjIM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceOu_croND7Xr0GbH38d1venBqWg/mo/photo.jpg?sz=128", "display_name": "Oki Toma", "link": "https://stackoverflow.com/users/11537378/oki-toma"}, "edited": false, "score": 0, "creation_date": 1558601229, "post_id": 56252191, "comment_id": 99157648, "body": "Yes, a little more verbose, but will return the same result."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1558512874, "creation_date": 1558512874, "answer_id": 56252191, "question_id": 56250042, "link": "https://stackoverflow.com/questions/56250042/how-to-select-all-records-where-the-event-date-is-weekend-and-export-to-another/56252191#56252191", "title": "How to SELECT all records where the event date is weekend and export to another table", "body": "<p>The first you can get by filtering on the weekday where you set the second argument to <em>2</em> for <em>vbMonday</em>:</p>\n\n<pre><code>Select * From YourTable\nWhere Weekday([DATE_Field], 2) &gt; 5\n</code></pre>\n\n<p>For the second task, use an expanded criteria:</p>\n\n<pre><code>Select * From YourTable\nWhere \n    Weekday([DATE_Field], 2) &lt;= 5\n    And\n    [TIME_Field] Not Between #05:00:00# And #22:00:00#\n</code></pre>\n\n<p>Date/time values in Access are wrapped in octothorpes (#).</p>\n"}], "owner": {"reputation": 15, "user_id": 11537378, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KhrlAZSDjIM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rceOu_croND7Xr0GbH38d1venBqWg/mo/photo.jpg?sz=128", "display_name": "Oki Toma", "link": "https://stackoverflow.com/users/11537378/oki-toma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558520526, "creation_date": 1558503881, "last_edit_date": 1558506336, "question_id": 56250042, "link": "https://stackoverflow.com/questions/56250042/how-to-select-all-records-where-the-event-date-is-weekend-and-export-to-another", "title": "How to SELECT all records where the event date is weekend and export to another table", "body": "<p>I am new to MS Access VBA.. I have imported the log file to the table and would like to extract to another table.\n1) all logs/records where DATE_Field = Weekend.\n2) all logs/records where DATE_Field is weekday AND Time_Field between 22:00 and 05:00</p>\n\n<p>I tried Query and tried to convert the date field using \"datename\" but error says there is no valid function with that name</p>\n\n<p>DoW: datename([LogFile].Date)</p>\n\n<p>I would like to extract all logs which are\n1) all logs/records where DATE_Field = Weekend.\n2) all logs/records where DATE_Field is weekday AND Time_Field between 22:00 and 05:00</p>\n"}, {"tags": ["vba", "uipath"], "answers": [{"tags": [], "owner": {"reputation": 475, "user_id": 3247151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bb251a387bb385ae94603fad858b006?s=128&d=identicon&r=PG&f=1", "display_name": "Mads T", "link": "https://stackoverflow.com/users/3247151/mads-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1558520213, "creation_date": 1558520213, "answer_id": 56254533, "question_id": 56249538, "link": "https://stackoverflow.com/questions/56249538/how-to-prevent-uipath-from-getting-stuck-in-call-macro-stage/56254533#56254533", "title": "How to prevent UiPath from getting stuck in Call Macro Stage?", "body": "<p>You can wrap your call macro in a parallel where you in a second branch have a delay and a Throw Exception. The delay should be your desired timeout value, i.e. 15 minutes.</p>\n\n<p>You also need to have a local variable of type boolean as input to the <a href=\"https://docs.microsoft.com/en-us/dotnet/api/system.activities.statements.parallel.completioncondition?view=netframework-4.8\" rel=\"nofollow noreferrer\">condition property</a> in the parallel. When/if the macro call returns you set this boolean to True which in turn cancels the delay branch. </p>\n\n<p>This way, if the exception is thrown the parallel is exited and the workflow continues. Based on your desired behavior you may want to wrap the parallel in a try-catch.</p>\n"}, {"comments": [{"owner": {"reputation": 309, "user_id": 9286924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2L7p4.jpg?s=128&g=1", "display_name": "anandhu", "link": "https://stackoverflow.com/users/9286924/anandhu"}, "edited": false, "score": 0, "creation_date": 1558604334, "post_id": 56255025, "comment_id": 99159369, "body": "I tried the above code with a simple macro function which displays a message box. The message box is  popping up only when the timeout exception is thrown."}, {"owner": {"reputation": 309, "user_id": 9286924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2L7p4.jpg?s=128&g=1", "display_name": "anandhu", "link": "https://stackoverflow.com/users/9286924/anandhu"}, "edited": false, "score": 0, "creation_date": 1558604518, "post_id": 56255025, "comment_id": 99159465, "body": "Will prarallel really work in this case? I feel it wont  because, when the macro is in execution, bot is executing the &#39;Execute Macro&#39; activity. Only when the macro is finished it will come out of it.  So will it be able to switch to the other branch of parallel (while its executing the &#39;Execute Macro&#39; stage)?"}, {"owner": {"reputation": 756, "user_id": 11135214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4FimU.png?s=128&g=1", "display_name": "Konstantinos Palaiodimos", "link": "https://stackoverflow.com/users/11135214/konstantinos-palaiodimos"}, "reply_to_user": {"reputation": 309, "user_id": 9286924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2L7p4.jpg?s=128&g=1", "display_name": "anandhu", "link": "https://stackoverflow.com/users/9286924/anandhu"}, "edited": false, "score": 0, "creation_date": 1558613100, "post_id": 56255025, "comment_id": 99164108, "body": "Yes it will work, the thing that needs to be added is to change the value of the  Boolean variable (excecutionMacroComplete)  to True if macro was successful. I have tried by placing the macro to wait for 2 minutes and the maxWaitTime variable to 1 minute. Keep in mind that if you wrap up the Parallel Action in Try-Catch block then whatever you set in Catch section will be displayed as exception if you do not use Try and Catch then Throw message will be displayed."}, {"owner": {"reputation": 756, "user_id": 11135214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4FimU.png?s=128&g=1", "display_name": "Konstantinos Palaiodimos", "link": "https://stackoverflow.com/users/11135214/konstantinos-palaiodimos"}, "reply_to_user": {"reputation": 309, "user_id": 9286924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2L7p4.jpg?s=128&g=1", "display_name": "anandhu", "link": "https://stackoverflow.com/users/9286924/anandhu"}, "edited": false, "score": 0, "creation_date": 1558614003, "post_id": 56255025, "comment_id": 99164562, "body": "@automaticSoldier please check updated answer and comment above."}], "tags": [], "owner": {"reputation": 756, "user_id": 11135214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4FimU.png?s=128&g=1", "display_name": "Konstantinos Palaiodimos", "link": "https://stackoverflow.com/users/11135214/konstantinos-palaiodimos"}, "is_accepted": false, "score": 2, "last_activity_date": 1558613889, "last_edit_date": 1558613889, "creation_date": 1558521840, "answer_id": 56255025, "question_id": 56249538, "link": "https://stackoverflow.com/questions/56249538/how-to-prevent-uipath-from-getting-stuck-in-call-macro-stage/56255025#56255025", "title": "How to prevent UiPath from getting stuck in Call Macro Stage?", "body": "<p>There is a way to do this, let me try to present it to you:</p>\n\n<p>You will need 3 variables for your solution as per below:</p>\n\n<ol>\n<li>One to store your wait time until exception will be thrown type of <strong>TimeSpan</strong></li>\n<li>One to declare your start time of your current execution type of <strong>DateTime</strong> </li>\n<li>One to inform if the default wait time of execution was exceeded or not type of <strong>Boolean</strong>  </li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/MOBFk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MOBFk.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then you need to use <strong>Parallel activity</strong> where on your <strong>Excel Application Scope</strong> and <strong>Execute Macro</strong> will run together with a <strong>While loop</strong> that will constantly compare starting time and your set waiting time. If it will exceed the default time value set, an exception will be thrown. Check the solution example below: </p>\n\n<p><a href=\"https://i.stack.imgur.com/hFlDu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hFlDu.png\" alt=\"enter image description here\"></a></p>\n\n<p>In this case because we surround <strong>Parallel</strong> Action in <strong>Try-Catch</strong> block, you need to specify the exception expression in <strong>Catches</strong> section, since <strong>Throw</strong> will be overwritten by <strong>Catches</strong> as per below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oPH7u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oPH7u.png\" alt=\"enter image description here\"></a></p>\n\n<p>The second option is to do it without <strong>Try-Catch</strong> then the <strong>Throw</strong> exception will be displayed, check solution below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/GC9sE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GC9sE.png\" alt=\"enter image description here\"></a></p>\n\n<p>Also you need to modify the <strong>Throw</strong> action by setting the exception message accordingly as per image below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/avudr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/avudr.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this will be helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2845140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DB0jk.jpg?s=128&g=1", "display_name": "Markus12", "link": "https://stackoverflow.com/users/2845140/markus12"}, "is_accepted": false, "score": 0, "last_activity_date": 1612776629, "creation_date": 1612776629, "answer_id": 66098961, "question_id": 56249538, "link": "https://stackoverflow.com/questions/56249538/how-to-prevent-uipath-from-getting-stuck-in-call-macro-stage/66098961#66098961", "title": "How to prevent UiPath from getting stuck in Call Macro Stage?", "body": "<p>Answer by @Konstantinos Palaiodimos is in the right direction but the branch 2 is having loop which would continuously execute until maxWaitTime and eventually would throw exception. So to ensure the control goes back to Branch 1(Excel scope) after timeout checking in Branch 2(Do while Loop) a delay need to be added to the Branch 2.\nIf there is a delay in branch 2 the control will go back to Branch 1 during that delay to check if macro execution is completed or not , if macro is not completed then again control comes back to branch 2 and the cycle continues until maxWaitTime or till the macro execution completes</p>\n"}], "owner": {"reputation": 309, "user_id": 9286924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2L7p4.jpg?s=128&g=1", "display_name": "anandhu", "link": "https://stackoverflow.com/users/9286924/anandhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1425, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1612776629, "creation_date": 1558500814, "question_id": 56249538, "link": "https://stackoverflow.com/questions/56249538/how-to-prevent-uipath-from-getting-stuck-in-call-macro-stage", "title": "How to prevent UiPath from getting stuck in Call Macro Stage?", "body": "<p>I am calling a macro using call macro in UiPath Workflow. The concern is some time one of the excels that the macro handles will freeze forever, Causing the macro execution to hang and the process will get stuck  in Call macro forever.</p>\n\n<p>Is there some way I can modify the UiPath workflow so that, if the Call macro activity is not completed within 15 minutes, the bot throws an exception?</p>\n"}, {"tags": ["html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 490, "user_id": 5377275, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z_DcwcHvDos/AAAAAAAAAAI/AAAAAAAAAEQ/B7U68v6GxR8/photo.jpg?sz=128", "display_name": "Trevor Keller", "link": "https://stackoverflow.com/users/5377275/trevor-keller"}, "edited": false, "score": 0, "creation_date": 1558500480, "post_id": 56249457, "comment_id": 99116544, "body": "Please post a <a href=\"http://www.sscce.org/\" rel=\"nofollow noreferrer\">Short, Self Contained, Correct (Compilable), Example</a>."}, {"owner": {"reputation": 490, "user_id": 5377275, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z_DcwcHvDos/AAAAAAAAAAI/AAAAAAAAAEQ/B7U68v6GxR8/photo.jpg?sz=128", "display_name": "Trevor Keller", "link": "https://stackoverflow.com/users/5377275/trevor-keller"}, "edited": false, "score": 0, "creation_date": 1558501160, "post_id": 56249457, "comment_id": 99116675, "body": "Possibly <a href=\"https://stackoverflow.com/questions/51661787/application-screenupdating-false-not-working-switching-between-excel-sheets-or\">related</a>?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1558514427, "post_id": 56249457, "comment_id": 99122606, "body": "What does <i>cannot get it done</i> mean? Is it looping pages but not extracting info? Failing to loop pages?"}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558519845, "post_id": 56249457, "comment_id": 99125726, "body": "Unable to turn the pages, Failing to loop pages"}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558520431, "post_id": 56249457, "comment_id": 99126039, "body": "I need you to go you are on page 1 Up to 26"}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558540011, "post_id": 56249457, "comment_id": 99137758, "body": "The last code is Internet Explorer correct changes the pages but not the copies in the sheet that I need. How can I complement your code with mine? in this new code does not indicate that descrague the data to the sheet 1"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558539715, "post_id": 56254599, "comment_id": 99137589, "body": "Add you sheet into the code and write the values to that sheet. My preference is the top version and you just change sheet1 to your sheet."}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558540238, "post_id": 56254599, "comment_id": 99137881, "body": "that&#39;s the detail I&#39;m new to vba and I do not know at what moment of the code devo add the sheet, please explain if it is in your possibilities distinguished sir."}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558540327, "post_id": 56254599, "comment_id": 99137927, "body": "in his new code was left mine and I do not know how I can complement it. all the variables are different from my code"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558541347, "post_id": 56254599, "comment_id": 99138511, "body": "my code writes to sheet 1 as does yours. What is the problem?"}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558542128, "post_id": 56254599, "comment_id": 99138932, "body": "do not keep the data in the sheet, use the last code you wrote and only do the loop between the pages but do not throw any data in the sheet"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558542281, "post_id": 56254599, "comment_id": 99139007, "body": "yes because I expect you to be able to do that part. My code at the bottom was to help you loop all pages."}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558542328, "post_id": 56254599, "comment_id": 99139033, "body": "I copied his code in a new module but he does not save the data"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558542682, "post_id": 56254599, "comment_id": 99139193, "body": "Try the top version and install jsonconverter.bas"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558543462, "post_id": 56254599, "comment_id": 99139531, "body": "you can download workbook and run: <a href=\"https://tmpfiles.org/download/19133/Book1.xlsb\" rel=\"nofollow noreferrer\">tmpfiles.org/download/19133/Book1.xlsb</a>"}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558543575, "post_id": 56254599, "comment_id": 99139569, "body": "I do not know how to complement the codes, this is a personal project, I really need help, I know that this is a website for developers and that I am a nobato but it is very important for me to complete this code"}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558546252, "post_id": 56254599, "comment_id": 99140748, "body": "you are a genius, bless you and yours, let me tell you that I am your admirer from now on and that I will do everything in my power to learn from you all"}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558546475, "post_id": 56254599, "comment_id": 99140839, "body": "The first code works perfectly although the second one shows error. I am eternally grateful to you, your help to the pending and without asking for anything in return I really appreciate you I am happy"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558546576, "post_id": 56254599, "comment_id": 99140883, "body": "The second one is fine but you need to add a reference to Microsoft Internet Explorerand add in the extra code to write out the tables. Everything you need is in the answers. The top answer does everything for you. The bottom answer requires you to do a little work using the link I include."}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558546869, "post_id": 56254599, "comment_id": 99140994, "body": "I hope that the future readers will realize the genius that you are, I have seen your answers in many questions and all very well asked, finally since you tell me how to learn part of what you already know, some advice"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558546906, "post_id": 56254599, "comment_id": 99141010, "body": "what would you like to know?"}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558547029, "post_id": 56254599, "comment_id": 99141049, "body": "where he got so much knowledge, some guide that I can recommend"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558547119, "post_id": 56254599, "comment_id": 99141085, "body": "<a href=\"https://www.youtube.com/user/WiseOwlTutorials/search?query=web-scraping\" rel=\"nofollow noreferrer\">youtube.com/user/WiseOwlTutorials/search?query=web-scraping</a>   and <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors</a>  and  <a href=\"https://flukeout.github.io/\" rel=\"nofollow noreferrer\">flukeout.github.io</a>  and <a href=\"https://stackoverflow.com/search?q=vba+and+web-scraping\">stackoverflow.com/search?q=vba+and+web-scraping</a>"}, {"owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "edited": false, "score": 0, "creation_date": 1558642427, "post_id": 56254599, "comment_id": 99178565, "body": "Sorry for my ignorance but I do not know how to manage the url from which the data is extracted to this URL &quot; <a href=\"http://mlb.mlb.com/pubajax/wf/flow/stats.splayer?season=2018&amp;sort_order=%27desc%27&amp;sort_column=\" rel=\"nofollow noreferrer\">mlb.mlb.com/pubajax/wf/flow/&hellip;</a> % 27avg% 27 &amp; stat_type = hitting &amp; page_type = SortablePlayer &amp; game_type =% 27R% 27 &amp; player_pool = ALL &amp; season_type = ANY &amp; sport_code =% 27mlb% 27 &amp; results &quot;"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1558544462, "last_edit_date": 1558544462, "creation_date": 1558520436, "answer_id": 56254599, "question_id": 56249457, "link": "https://stackoverflow.com/questions/56249457/scraping-web-with-url-in-milliseconds-unix/56254599#56254599", "title": "Scraping web with url in milliseconds Unix", "body": "<h2>XMLHTTP:</h2>\n\n<p>The page does ajax calls to get json which it uses to update the content for each page. It does this using query string parameters, one of which is the records per page (default 50). You can view this activity in the browser network tab via dev tools <kbd>F12</kbd></p>\n\n<p><a href=\"https://i.stack.imgur.com/5T0sX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5T0sX.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can avoid using a browser and issue xmlhttp requests to the same endpoint, altering the query string parameters to get all the results. It seems, in my testing, you cannot request all the results in one go. Instead, I issue a request for 1000 results, then check if there are any additional results to obtain and issue further requests, in batches of 1000, to get them.</p>\n\n<p>I am using <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">jsonconverter.bas</a> to parse the json. I extract the info from the json and load into an array, <code>results</code>, so I can write all results out to the sheet in one go - much more efficient this way as reduces i/o with sheet.</p>\n\n<p>After copying the code from the link above into a module called jsonConverter, you need to go  'VBE > Tools > References > Add a reference to Microsoft Scripting Runtime</p>\n\n<hr>\n\n<p><strong>TODO:</strong></p>\n\n<ol>\n<li>Add error handling for failed request</li>\n</ol>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>Option Explicit  \nPublic Sub GetResults()\n    'VBE &gt; Tools &gt; References &gt; Microsoft Scripting Runtime\n    Dim ws As Worksheet, results(), i As Long, totalResults As Long\n    Dim headers(), columnCount As Long, pageNumber As Long\n    Dim numberOfPages As Long, resultsPerPage As Long, json As Object\n\n    resultsPerPage = 1000\n    pageNumber = 1\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n\n        .Open \"GET\", \"http://mlb.mlb.com/pubajax/wf/flow/stats.splayer?season=2018&amp;sort_order=%27desc%27&amp;sort_column=%27avg%27&amp;stat_type=hitting&amp;page_type=SortablePlayer&amp;game_type=%27R%27&amp;player_pool=ALL&amp;season_type=ANY&amp;sport_code=%27mlb%27&amp;results=\" &amp; resultsPerPage &amp; \"&amp;recSP=\" &amp; pageNumber &amp; \"&amp;recPP=\" &amp; resultsPerPage, False\n        .send\n\n        Set json = JsonConverter.ParseJson(.responseText)\n        totalResults = json(\"stats_sortable_player\")(\"queryResults\")(\"totalSize\")\n        headers = json(\"stats_sortable_player\")(\"queryResults\")(\"row\").item(1).keys\n        numberOfPages = json(\"stats_sortable_player\")(\"queryResults\")(\"totalP\")\n        columnCount = UBound(headers) + 1\n\n        ReDim results(1 To totalResults, 1 To columnCount)\n        Dim r As Long, c As Long, dict As Object, key As Variant\n\n        For pageNumber = 1 To numberOfPages\n            If pageNumber &gt; 1 Then\n                .Open \"GET\", \"http://mlb.mlb.com/pubajax/wf/flow/stats.splayer?season=2018&amp;sort_order=%27desc%27&amp;sort_column=%27avg%27&amp;stat_type=hitting&amp;page_type=SortablePlayer&amp;game_type=%27R%27&amp;player_pool=ALL&amp;season_type=ANY&amp;sport_code=%27mlb%27&amp;results=\" &amp; resultsPerPage &amp; \"&amp;recSP=\" &amp; pageNumber &amp; \"&amp;recPP=\" &amp; resultsPerPage, False\n                .send\n                Set json = JsonConverter.ParseJson(.responseText)\n            End If\n\n            For Each dict In json(\"stats_sortable_player\")(\"queryResults\")(\"row\")\n                r = r + 1: c = 1\n                For Each key In dict.keys\n                    results(r, c) = dict(key)\n                    c = c + 1\n                Next\n            Next\n        Next\n    End With\n    With ws\n        .Cells(1, 1).Resize(1, columnCount) = headers\n        .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Sample of output ( appreciate can't really read as is - but idea of layout):</strong> </p>\n\n<p><img src=\"https://i.stack.imgur.com/jiDTP.png\" height=\"150\"></p>\n\n<p>image link: <a href=\"https://i.stack.imgur.com/jiDTP.png\" rel=\"nofollow noreferrer\">https://i.stack.imgur.com/jiDTP.png</a></p>\n\n<hr>\n\n<h2>Internet Explorer:</h2>\n\n<p>If you want to use slower browser solution you can concatenate the page number into the url and loop to cover all pages. The number of pages can be extracted from the pagination on page 1.</p>\n\n<p>You can see how to write the tables out below each other by looking at this <a href=\"https://stackoverflow.com/a/53135557/6241235\">answer</a>. Change the lines with <code>GetLastRow(ws, 1) + 2</code> to <code>GetLastRow(ws, 1) + 1</code></p>\n\n<pre><code>Option Explicit\n'VBE &gt; Tools &gt; References: Microsoft Internet Controls\n\n    Public Sub GetData()\n        Dim ie As New InternetExplorer, numberOfPages As Long\n        Dim url As String, i As Long\n        Const PLAYERS_PER_PAGE = 50\n        url = \"http://mlb.mlb.com/stats/sortable.jsp#elem=%5Bobject+Object%5D&amp;tab_level=child&amp;click_text=Sortable+Player+hitting&amp;game_type='R'&amp;season=2018&amp;season_type=ANY&amp;league_code='MLB'&amp;sectionType=sp&amp;statType=hitting&amp;page=1&amp;playerType=ALL&amp;ts=\"\n\n        With ie\n            .Visible = True\n            .Navigate2 url\n            While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n            With .document\n\n                numberOfPages = CLng(.querySelector(\".paginationWidget-last\").innerText)\n\n                'do something  with page 1\n                If numberOfPages &gt; 1 Then\n\n                    For i = 2 To numberOfPages\n                        ie.Navigate2 Replace$(url, \"page=1\", \"page=\" &amp; CStr(i))\n                        While ie.Busy Or ie.readyState &lt; 4: DoEvents: Wend\n\n                        'do something with other pages\n                    Next\n                    Stop 'delete me later\n                End If  \n            End With  \n            .Quit\n        End With\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "is_accepted": false, "score": 0, "last_activity_date": 1558641118, "last_edit_date": 1558641118, "creation_date": 1558623708, "answer_id": 56278093, "question_id": 56249457, "link": "https://stackoverflow.com/questions/56249457/scraping-web-with-url-in-milliseconds-unix/56278093#56278093", "title": "Scraping web with url in milliseconds Unix", "body": "<p>I have managed to complement his second code with mine, although I have not been very professional, I am interested in how to achieve combertir the url of \"<a href=\"http://mlb.mlb.com/stats/sortable.jsp#elem=%5Bobject+Object%5D&amp;tab_level=child&amp;click_text=Sortable+Player+hitting&amp;game_type=&#39;R&#39;&amp;season=2018&amp;season_type=ANY&amp;league_code=&#39;MLB&#39;&amp;sectionType=sp&amp;statType=hitting&amp;page=1&amp;playerType=ALL&amp;ts\" rel=\"nofollow noreferrer\">official page</a>\" to this \"<a href=\"http://mlb.mlb.com/pubajax/wf/flow/stats.splayer?season=2018&amp;sort_order=%27desc%27&amp;sort_column=%27avg%27&amp;stat_type=hitting&amp;page_type=SortablePlayer&amp;game_type=%27R%27&amp;player_pool=ALL&amp;season_type=ANY&amp;sport_code=%27mlb%27&amp;results\" rel=\"nofollow noreferrer\">official page for jsone</a>\"</p>\n\n<pre><code> Option Explicit\n   'VBE &gt; Tools &gt; References: Microsoft Internet Controls\n\nPublic Sub GetData()\n\nDim ele As Object\nDim y As Integer\nDim EstaPagina As Byte\nEstaPagina = 1\n'we will output data to excel, starting on row 1\ny = 1\nDim ie As New InternetExplorer, numberOfPages As Long\nDim url As String, i As Long\nConst PLAYERS_PER_PAGE = 50\nurl = \"http://mlb.mlb.com/stats/sortable.jsp#elem=%5Bobject+Object%5D&amp;tab_level=child&amp;click_text=Sortable+Player+pitching&amp;game_type='R'&amp;season=2018&amp;season_type=ANY&amp;league_code='MLB'&amp;sectionType=sp&amp;statType=pitching&amp;page=1&amp;playerType=ALL&amp;ts=\"\n\n        With ie\n            .Visible = True\n            .Navigate2 url\n            While .Busy Or .readyState &lt; 4: DoEvents: Wend\n            With .document\n                numberOfPages = CLng(.querySelector(\".paginationWidget-last\").innerText)\n\n                'do something  with page 1\n                If numberOfPages &gt; 1 Then\n\n                    For i = 1 To numberOfPages\n                        ie.Navigate2 Replace$(url, \"page=1\", \"page=\" &amp; CStr(i))\n\n                        For Each ele In ie.document.getElementById(\"datagrid\").getElementsByTagName(\"tr\")\n        'show the text content of 'tr' element being looked at\n        'Debug.Print ele.textContent\n\n        'each 'tr' (table row) element contains 4 children ('td') elements\n        'put text of 1st 'td' in col A\n        Sheets(\"Sheet1\").Range(\"A\" &amp; y).value = ele.Children(1).textContent\n        'put text of 2nd 'td' in col B\n        Sheets(\"Sheet1\").Range(\"B\" &amp; y).value = ele.Children(2).textContent\n        'put text of 3rd 'td' in col C\n        Sheets(\"Sheet1\").Range(\"C\" &amp; y).value = ele.Children(3).textContent\n        'put text of 4th 'td' in col D\n        Sheets(\"Sheet1\").Range(\"D\" &amp; y).value = ele.Children(4).textContent\n        'put text of 4th 'td' in col f\n        Sheets(\"Sheet1\").Range(\"E\" &amp; y).value = ele.Children(5).textContent\n        'increment row counter by 1\n        y = y + 1\n        Next\n        While ie.Busy Or ie.readyState &lt; 4: DoEvents: Wend\n  ' do something with other pages\n                    Next\n   ' Stop 'delete me later\n                End If\n            End With\n            .Quit\n        End With\n        On Error Resume Next\n        Range(\"A1\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.RemoveDuplicates Columns:=Array(1, 2, 3, 4), _\n    header:=xlNo\n\nOn Error Resume Next\nApplication.ScreenUpdating = True\n\nMsgBox \"Volcado terminado\", vbInformation\nRange(\"A1\").Select\n\n    'save the Excel workbook\n    ActiveWorkbook.Save\n\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9773751, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156397783898762/picture?type=large", "display_name": "Yunior Cruz", "link": "https://stackoverflow.com/users/9773751/yunior-cruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 2, "accepted_answer_id": 56254599, "answer_count": 2, "score": -2, "last_activity_date": 1558641118, "creation_date": 1558500183, "last_edit_date": 1558521367, "question_id": 56249457, "link": "https://stackoverflow.com/questions/56249457/scraping-web-with-url-in-milliseconds-unix", "title": "Scraping web with url in milliseconds Unix", "body": "<p>The web in which I browse has several pages. I want to click on those elements or play with urls and thus be able to copy the data. The initial URL ends at = 1 &amp; playerType = ALL &amp; ts = 1558502019375, in my code there is a loop that is supposed to go page after page to get the data but I can not get it done.</p>\n\n<pre><code>Sub UPDATE_DATA_MLB()\nApplication.ScreenUpdating = False\n\n'dimension (set aside memory for) our variables\nDim objIE As InternetExplorer\nDim ele As Object\nDim y As Integer\nDim EstaPagina As Byte\nDim EstaURL As String\n\n\n'P\u00e1gina inicial\n\nEstaPagina = 1\n'we will output data to excel, starting on row 1\ny = 1\n\nEstaURL = \"http://mlb.mlb.com/stats/sortable.jsp#elem=%5Bobject+Object%5D&amp;tab_level=child&amp;click_text=Sortable+Player+hitting&amp;game_type='R'&amp;season=2018&amp;season_type=ANY&amp;league_code='MLB'&amp;sectionType=sp&amp;statType=hitting&amp;page=1&amp;playerType=ALL&amp;ts=1558502019375\" '&amp;ts=1526432697176\"\n\n'start a new browser instance\nSet objIE = New InternetExplorer\n'make browser visible\nobjIE.Visible = False\n\nDo Until EstaPagina = 255\n  'navigate to page with needed data\n  objIE.navigate EstaURL &amp; EstaPagina\n  'wait for page to load\n  Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n  'If UCase(Left(EstaURL, 211) &amp; \"1\") = UCase(Left(objIE.LocationURL, (211 + Len(EstaPagina)))) And y &gt; 1 Then Exit Do\n\n  'look at all the 'tr' elements in the 'table' with id 'myTable',\n  'and evaluate each, one at a time, using 'ele' variable\n  For Each ele In objIE.document.getElementById(\"datagrid\").getElementsByTagName(\"tr\")\n      'show the text content of 'tr' element being looked at\n      'Debug.Print ele.textContent\n\n      'each 'tr' (table row) element contains 4 children ('td') elements\n      'put text of 1st 'td' in col A\n      Sheets(\"Sheet1\").Range(\"A\" &amp; y).Value = ele.Children(0).textContent\n      'put text of 2nd 'td' in col B\n      Sheets(\"Sheet1\").Range(\"B\" &amp; y).Value = ele.Children(1).textContent\n      'put text of 3rd 'td' in col C\n      Sheets(\"Sheet1\").Range(\"C\" &amp; y).Value = ele.Children(2).textContent\n      'put text of 4th 'td' in col D\n      Sheets(\"Sheet1\").Range(\"D\" &amp; y).Value = ele.Children(5).textContent\n      'put text of 4th 'td' in col f\n      Sheets(\"Sheet1\").Range(\"E\" &amp; y).Value = ele.Children(22).textContent\n      'increment row counter by 1\n      y = y + 1\n  Next\nEstaPagina = EstaPagina + 1\nLoop\nlobjIE.Quit\nSet objIE = Nothing\nSet ele = Nothing\n\nRange(\"A1\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5), _\n  Header:=xlNo\n\n\nApplication.ScreenUpdating = True\n\nMsgBox \"Volcado terminado\", vbInformation\nRange(\"A1\").Select\n\n  'save the Excel workbook\n  ActiveWorkbook.Save\nEnd Sub ```\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 1, "creation_date": 1558504152, "post_id": 56249275, "comment_id": 99117623, "body": "Please post your actual code instead of screenshots of it. Is there a specific reason why this needs to be done via VBA? It seems to me that it can be easily done with the data validation tool in excel. Unless I&#39;m missing something."}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1558505390, "post_id": 56249275, "comment_id": 99118069, "body": "Posted actual code. I want the validation to be dynamic. There are two columns, lets say one is User Name and the other one is Time. At present there are 4 entries in user name and time each. If a new entry is made now, I want the validation on time column to be active for the new entry. If it can be achieved through excel itself then please guide me on that"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1558516415, "post_id": 56249275, "comment_id": 99123775, "body": "Does it absolutely have to be dynamic? It seems to me that if you just apply a data validation rule to the whole column, you would be covered. No?"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "reply_to_user": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1558520433, "post_id": 56249275, "comment_id": 99126041, "body": "Yeah. I can apply validation to the whole column"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1558521979, "post_id": 56249275, "comment_id": 99126923, "body": "Again, maybe I&#39;m missing something, but I think you could just select the column you want, go to <code>Data&gt;Data Validation</code> on excel&#39;s ribbon and just add a data validation rule for the whole column by specifying the <code>Allow</code> as <code>Whole Number</code>, the <code>Minimum</code> as <code>1</code> and the <code>Maximum</code> as <code>160</code>? You can also customize the <code>Error Alert</code> message to fit your needs."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558499951, "post_id": 56249333, "comment_id": 99116430, "body": "How do i create a range name. I want it to be dynamic i.e. I want it to take the range from row 2 to last row. Please bear with me, I&#39;m new to VBA"}, {"owner": {"reputation": 74, "user_id": 11087287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9d7d71a27d5ddb1f1ca086295e83ff?s=128&d=identicon&r=PG&f=1", "display_name": "jonrizz", "link": "https://stackoverflow.com/users/11087287/jonrizz"}, "reply_to_user": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558500088, "post_id": 56249333, "comment_id": 99116453, "body": "yes it will be dynamic, as you may notice on the code, we are only checking the column. if you want you can specify the column number. you may use this instead If Target.Column = 1 Then, meaning its checking on column A"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558500153, "post_id": 56249333, "comment_id": 99116471, "body": "I&#39;m unable to run this code. I am not getting an option to run this sub. I&#39;m being shown all other subs except this one"}, {"owner": {"reputation": 74, "user_id": 11087287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9d7d71a27d5ddb1f1ca086295e83ff?s=128&d=identicon&r=PG&f=1", "display_name": "jonrizz", "link": "https://stackoverflow.com/users/11087287/jonrizz"}, "reply_to_user": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558500237, "post_id": 56249333, "comment_id": 99116490, "body": "is your excel macro enabled?, did you add the code under workbook?"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558500342, "post_id": 56249333, "comment_id": 99116514, "body": "Yes. I have created 4 subs all of which I&#39;m able to execute. But not this one. I have got 4 sheets on my workbook with time column present in the &quot;input&quot; sheet"}, {"owner": {"reputation": 74, "user_id": 11087287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9d7d71a27d5ddb1f1ca086295e83ff?s=128&d=identicon&r=PG&f=1", "display_name": "jonrizz", "link": "https://stackoverflow.com/users/11087287/jonrizz"}, "reply_to_user": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558500537, "post_id": 56249333, "comment_id": 99116557, "body": "see the sample image i have attached above"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558500728, "post_id": 56249333, "comment_id": 99116600, "body": "I too have attached two images to my original question. Please see them and tell what is wrong"}, {"owner": {"reputation": 537, "user_id": 8631622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8c3c8025900b42d95e64cd0d1518ee?s=128&d=identicon&r=PG&f=1", "display_name": "Pie", "link": "https://stackoverflow.com/users/8631622/pie"}, "edited": false, "score": 0, "creation_date": 1558509196, "post_id": 56249333, "comment_id": 99119781, "body": "Can you help me with this question? I tried everything I knew but could not solve. <a href=\"https://stackoverflow.com/q/56207459/8631622\">stackoverflow.com/q/56207459/8631622</a> @jonrizz"}, {"owner": {"reputation": 74, "user_id": 11087287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9d7d71a27d5ddb1f1ca086295e83ff?s=128&d=identicon&r=PG&f=1", "display_name": "jonrizz", "link": "https://stackoverflow.com/users/11087287/jonrizz"}, "reply_to_user": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558564449, "post_id": 56249333, "comment_id": 99147911, "body": "@RithwikSarma, did try your code and its look working fine with me? is there any error you encountered?"}], "tags": [], "owner": {"reputation": 74, "user_id": 11087287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9d7d71a27d5ddb1f1ca086295e83ff?s=128&d=identicon&r=PG&f=1", "display_name": "jonrizz", "link": "https://stackoverflow.com/users/11087287/jonrizz"}, "is_accepted": false, "score": 0, "last_activity_date": 1558505163, "last_edit_date": 1558505163, "creation_date": 1558499418, "answer_id": 56249333, "question_id": 56249275, "link": "https://stackoverflow.com/questions/56249275/data-validation-to-a-dynamic-range/56249333#56249333", "title": "Data validation to a dynamic range", "body": "<p>first you can create a range name for column you want your \"time\" and you can use the sample codes below.</p>\n\n<pre><code>    Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    If Target.Column = Range(\"time\").Column Then\n\n      If Not (IsNumeric(Target.Value)) Then\n\n        MsgBox \"only numbers allowed\"\n\n        Target.Value = \"\"\n\n        Target.Select\n\n      End If\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Em058.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Em058.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558520750, "post_id": 56252509, "comment_id": 99126224, "body": "What do I need to change if I need to prevent decimal numbers as well. Only integers less than 160 are allowed"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558586086, "post_id": 56252509, "comment_id": 99151706, "body": "Not working. Even integers less than 160 are getting cleared"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558608815, "post_id": 56252509, "comment_id": 99161836, "body": "No, I have copy pasted the same code. On entering values such as 123, 110,25 etc, the entry is being cleared"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "edited": false, "score": 0, "creation_date": 1558609818, "post_id": 56252509, "comment_id": 99162383, "body": "debug the code and tell me at which point the code clear your cell. At <code>If Not IsNumeric</code> or <code>ElseIf Target.Offset</code>"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 0, "last_activity_date": 1558523900, "last_edit_date": 1558523900, "creation_date": 1558513882, "answer_id": 56252509, "question_id": 56249275, "link": "https://stackoverflow.com/questions/56249275/data-validation-to-a-dynamic-range/56252509#56252509", "title": "Data validation to a dynamic range", "body": "<p>You could try:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    '1. Check if the column that affected is B (change to the column you want)\n    '2. Check if changed field is one (used to avoid errors if user change more than one cells at the same time)\n    If Not Intersect(Target, Columns(\"B:B\")) Is Nothing And Target.Count = 1 Then\n        'Check if target is numeric\n        If Not IsNumeric(Target.Value) Then\n            Call Clear(Target)\n        End If\n        'Check if target.offset(1,0) is numeric\n        If Not IsNumeric(Target.Offset(1, 0).Value) Then\n            Call Clear(Target.Offset(1, 0))\n        End If\n    End If\n\nEnd Sub\n\nSub Clear(ByVal rng As Range)\n\n    'Disable events in order to prevent code to re trigger when clear cell\n    Application.EnableEvents = False\n    rng.Value = \"\"\n    'Enable events\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDITED VERSION:</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    '1. Check if the column that affected is B (change to the column you want)\n    '2. Check if changed field is one (used to avoid errors if user change more than one cells at the same time)\n    If Not Intersect(Target, Columns(\"B:B\")) Is Nothing And Target.Count = 1 Then\n        'Check if target is numeric\n        If Not IsNumeric(Target.Value) Then\n            Call Clear(Target)\n        ElseIf Target.Value &gt; 160 Or (Target.Value = Int(Target.Value) = False) Then\n             Call Clear(Target)\n        End If\n        'Check if target.offset(1,0) is numeric\n        If Not IsNumeric(Target.Offset(1, 0).Value) Then\n            Call Clear(Target.Offset(1, 0))\n        ElseIf Target.Offset(1, 0).Value &gt; 160 Or (Target.Offset(1, 0).Value = Int(Target.Offset(1, 0).Value) = False) Then\n            Call Clear(Target)\n        End If\n    End If\n\nEnd Sub\n\nSub Clear(ByVal rng As Range)\n\n    'Disable events in order to prevent code to re trigger when clear cell\n    Application.EnableEvents = False\n    rng.Value = \"\"\n    'Enable events\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 56252509, "answer_count": 2, "score": 0, "last_activity_date": 1558523900, "creation_date": 1558498962, "last_edit_date": 1558505207, "question_id": 56249275, "link": "https://stackoverflow.com/questions/56249275/data-validation-to-a-dynamic-range", "title": "Data validation to a dynamic range", "body": "<p>I have a column named \"time\" in my excel sheet. I want to write a code such that whenever user performs an entry in time column, if it is a whole number, it should accept, but if it is not a pop up should appear saying \"only numbers allowed\". Also, the validation should be dynamic i.e. should automatically validate next row if users enters a new entry</p>\n\n<p><a href=\"https://i.stack.imgur.com/I8p3g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I8p3g.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/pj9Tn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pj9Tn.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\nIf Target.Column = Range(\"Meeting Time\").Column Then\n\n    If Not (IsNumeric(Target.Value)) Then\n\n        MsgBox \"only numbers allowed\"\n\n        Target.Value = \"\"\n\n        Target.Select\n    End If\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "dimensions", "static-initialization"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558500200, "post_id": 56249183, "comment_id": 99116480, "body": "All executable statements in VBA must be within a procedure scope (<code>Sub</code>, <code>Function</code>, <code>Property [Get|Let|Set]</code>). <code>Dim</code> isn&#39;t an executable statement, it&#39;s legal at module-level, only in the module&#39;s <code>(declarations)</code> section (at the top). You need to put the <code>Pixels = Array(1, 2, 3)</code> assignment in a procedure in the same module as the declaration (could be another module if it was <code>Public Pixels(1 To 3) As Integer</code>)."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1558505256, "post_id": 56249183, "comment_id": 99118020, "body": "Do <code>Dim Pixels() As Variant</code> or <code>Dim Pixels As Variant</code> instead of <code>Dim Pixels(1 To 3) As Integer</code> to make possible the result of <code>Array()</code> function be assigned to the variable."}], "answers": [{"comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1558500356, "post_id": 56249238, "comment_id": 99116517, "body": "Have you tested the second part (or option) that you&#39;ve posted?"}], "tags": [], "owner": {"reputation": 74, "user_id": 11087287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9d7d71a27d5ddb1f1ca086295e83ff?s=128&d=identicon&r=PG&f=1", "display_name": "jonrizz", "link": "https://stackoverflow.com/users/11087287/jonrizz"}, "is_accepted": false, "score": 0, "last_activity_date": 1558564283, "last_edit_date": 1558564283, "creation_date": 1558498626, "answer_id": 56249238, "question_id": 56249183, "link": "https://stackoverflow.com/questions/56249183/vba-error-how-do-i-define-and-initialize-an-array-in-vba/56249238#56249238", "title": "VBA Error: How do I define and initialize an Array in VBA", "body": "<p>You may try this sample below.</p>\n\n<pre><code>Dim Pixcels(2) As Integer\n\nPixcels(0) = 1\n\nPixcels(1) = 2\n\nPixcels(2) = 3\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 537, "user_id": 8631622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8c3c8025900b42d95e64cd0d1518ee?s=128&d=identicon&r=PG&f=1", "display_name": "Pie", "link": "https://stackoverflow.com/users/8631622/pie"}, "edited": false, "score": 0, "creation_date": 1558509229, "post_id": 56249943, "comment_id": 99119796, "body": "Can you help me with this question? I tried everything I knew but could not solve. <a href=\"https://stackoverflow.com/q/56207459/8631622\">stackoverflow.com/q/56207459/8631622</a> @Skin"}], "tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": false, "score": 2, "last_activity_date": 1558503355, "creation_date": 1558503355, "answer_id": 56249943, "question_id": 56249183, "link": "https://stackoverflow.com/questions/56249183/vba-error-how-do-i-define-and-initialize-an-array-in-vba/56249943#56249943", "title": "VBA Error: How do I define and initialize an Array in VBA", "body": "<p>Some example methods here ...</p>\n\n<pre><code>Public Sub DefineArray()\n    Dim i As Long\n\n    ' ---------------------------------------------------------------\n    ' Using the Array function\n    ' ---------------------------------------------------------------\n    Dim arrTest1 As Variant\n\n    arrTest1 = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10)\n\n    For i = 0 To UBound(arrTest1)\n        Debug.Print arrTest1(i)\n    Next\n\n    ' ---------------------------------------------------------------\n    ' ReDim Preserve\n    ' ---------------------------------------------------------------\n    Dim arrTest2() As String\n\n    For i = 0 To 10\n        ReDim Preserve arrTest2(i)\n        arrTest2(i) = i\n    Next\n\n    For i = 0 To UBound(arrTest2)\n        Debug.Print arrTest2(i)\n    Next\n\n    ' ---------------------------------------------------------------\n    ' Fixed at declaration\n    ' ---------------------------------------------------------------\n    Dim arrTest3(10) As String\n\n    For i = 0 To UBound(arrTest3)\n        arrTest3(i) = i\n    Next\n\n    For i = 0 To UBound(arrTest3)\n        Debug.Print arrTest3(i)\n    Next\n\n    ' ---------------------------------------------------------------\n    ' Using a function that returns an array, e.g. Split\n    ' ---------------------------------------------------------------\n    Dim strTest As String, arrTest4 As Variant\n\n    strTest = \"This is a test\"\n    arrTest4 = Split(strTest, \" \")\n\n    For i = 0 To UBound(arrTest4)\n        Debug.Print arrTest4(i)\n    Next\n\n    ' ---------------------------------------------------------------\n    ' From a range\n    ' ---------------------------------------------------------------\n    Dim arrTest5 As Variant, lngRow As Long, lngCol As Long\n\n    arrTest5 = Sheet1.Range(\"A1:K10\").Value\n\n    For lngRow = LBound(arrTest5, 1) To UBound(arrTest5, 1)\n        For lngCol = LBound(arrTest5, 2) To UBound(arrTest5, 2)\n            Debug.Print arrTest5(lngRow, lngCol)\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>Hopefully that gives you a good cross section and as per the comment, make sure it's contained within a function or procedure (sub).  See my example.</p>\n"}], "owner": {"reputation": 1, "user_id": 7451604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fa723311512e8f17ffc5bae6acf4673?s=128&d=identicon&r=PG&f=1", "display_name": "Lingo", "link": "https://stackoverflow.com/users/7451604/lingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558564283, "creation_date": 1558498170, "question_id": 56249183, "link": "https://stackoverflow.com/questions/56249183/vba-error-how-do-i-define-and-initialize-an-array-in-vba", "title": "VBA Error: How do I define and initialize an Array in VBA", "body": "<p>I copied this code from Microsoft, but it does not work.</p>\n\n<p><code>Dim Pixels(1 To 3) As Integer\nPixels = Array(1, 2, 3)</code></p>\n\n<p>When I excute it, I get an error on the '1' in the Array Statement\nsaying \"Invalid outside procedure\".</p>\n\n<p>I am running the code from an initialization module and would like a quick way to initizlize \"Pixels\" and was hoping I could use \"Array\".</p>\n\n<p>Thanks for your help.\nMac</p>\n"}, {"tags": ["vba", "visual-studio"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558495148, "post_id": 56248706, "comment_id": 99115581, "body": "thanks for the input! ill try working with this"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558495682, "post_id": 56248706, "comment_id": 99115673, "body": "Comment if you face any error in this."}, {"owner": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558496469, "post_id": 56248706, "comment_id": 99115841, "body": "It is looping through each file now but it is not updating the excel sheet with the new values from each file. any recommendation? I suspect its because of my shotty attempt to assign a cell range for each value"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558497598, "post_id": 56248706, "comment_id": 99116011, "body": "Yes you will have to loop the values that your pasting. So in short you have to declare an integer i and in the same loop assign it a value 1 if you want to paste values in your excel from 1st row and change your code as &quot;Range(&quot;A:&quot; &amp; i).value&quot; . Also don&#39;t forget to add 1 to the value of i before &quot;Next&quot; so that in next iteration code will paste values in next row of excel."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558497847, "post_id": 56248706, "comment_id": 99116049, "body": "I have amended the code. Hope it will solve your issue."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 537, "user_id": 8631622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8c3c8025900b42d95e64cd0d1518ee?s=128&d=identicon&r=PG&f=1", "display_name": "Pie", "link": "https://stackoverflow.com/users/8631622/pie"}, "edited": false, "score": 0, "creation_date": 1558513864, "post_id": 56248706, "comment_id": 99122291, "body": "@Pie - I have edited your question and added the line that works for me. Check it!"}, {"owner": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558676594, "post_id": 56248706, "comment_id": 99185871, "body": "i added your bit of code but i keep getting an error ( method &#39;Range&#39; of &#39;object _Global&#39; failed i then tried getting rid of the colon and added A2 instead as this is where i want the values to start it will run the code Range(&quot;A2&quot; &amp; i).value but it places the obtained values in cell A21 it does reiterate the code but it doesn&#39;t select the next file so basically it is running the macro over the same file instead of going to the next file and calculating those values. I edit my question to reflect my updated code"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558678224, "post_id": 56248706, "comment_id": 99186385, "body": "Hi Change it to Range(&quot;A&quot; &amp; i +1).value .. That will do the job. It will start with cell A2. @user11536789"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558678431, "post_id": 56248706, "comment_id": 99186458, "body": "@user11536789 ... You will have to change all the fields. I have amended the answer to reflect this.  Also you are not opening each file in the loop, you have only opened one file in the beginning of your code."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558678938, "post_id": 56248706, "comment_id": 99186659, "body": "At the moment your code is opening one file and applying loop over the same variables because you are not opening any file in the loop."}, {"owner": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558681377, "post_id": 56248706, "comment_id": 99187597, "body": "awesome, the range issue is fixed so it does add the new values to A2 and beyond, i moved the  MyFile = Dir(MyFolder &amp; &quot;\\&quot; fls.Name, vbReadOnly) into the loop sequence but i get an error ( compile error, Expected: list separator or )"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1558686003, "post_id": 56248706, "comment_id": 99189724, "body": "My Mistake, I forgot to add another &amp; in the line it should be  &quot;MyFile = Dir(MyFolder &amp; &quot;\\&quot; &amp; fls.Name, vbReadOnly)&quot;                 ........ Also in your code change the Close Textfile to Close MyFile"}, {"owner": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "edited": false, "score": 0, "creation_date": 1559103165, "post_id": 56248706, "comment_id": 99310462, "body": "adding,  Text = &quot;&quot; after close but before next solved the issue for me, thanks for your help it was much appreciated"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 1, "last_activity_date": 1558678813, "last_edit_date": 1558678813, "creation_date": 1558493900, "answer_id": 56248706, "question_id": 56248598, "link": "https://stackoverflow.com/questions/56248598/how-to-run-a-macro-through-a-folder-containing-hundreds-of-txt-files/56248706#56248706", "title": "how to run a macro through a folder containing hundreds of .txt files", "body": "<p>You can loop through all the files of the folder by using the below code. Amend it according to your need.</p>\n\n<pre><code>'First you will need to declare an object\n\nDim objFSO As Object\nDim objFolder As Object\n\n'then set this object to the address you received in first part of your code \n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.getFolder(MyFolder) \n\n'Now create a new object for files in that folder and apply the for loop as below\n\nDim fls As Object\nDim i As Integer\ni = 1\nFor Each fls In objFolder.Files\n\n'----- Your Code to perform on Each file\nRange(\"A\" &amp; i+1).value ' Change all accordingly\n\ni = i + 1\nNext\n</code></pre>\n\n<p>This should do the Job!</p>\n\n<p>Edit ----------- You will have to change all the fields </p>\n\n<pre><code>Range(\"A\" &amp; i + 1).Value = Mid(Text, starttime + 7, 16)\nRange(\"B\" &amp; i + 1).Value = Mid(Text, endtime + 5, 16)\nRange(\"C\" &amp; i + 1).Value = Mid(Text, so + 4, 8)\nRange(\"E\" &amp; i + 1).Value = Mid(Text, engineer + 10, 4)\nRange(\"F\" &amp; i + 1).Value = Mid(Text, account + 9, 6)\nRange(\"G\" &amp; i + 1).Value = Mid(Text, incident + 8, 4)\nRange(\"H\" &amp; i + 1).Value = Mid(Text, machine + 9, 4)\nRange(\"I\" &amp; i + 1).Value = Mid(Text, down + 6, 9)\n</code></pre>\n\n<p>Edit for file opening:</p>\n\n<p>You will have to open each file in the loop:</p>\n\n<pre><code> MyFile = Dir(MyFolder &amp; \"\\\" fls.Name, vbReadOnly)\n</code></pre>\n\n<p>After that extract the text the way you are doing. But this have to be done in the Loop. So that the process is repeated for every file.</p>\n"}], "owner": {"reputation": 25, "user_id": 11536789, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RHQyHwxC33I/AAAAAAAAAAI/AAAAAAAAAAQ/SBxlcCWuN9k/photo.jpg?sz=128", "display_name": "user11536789", "link": "https://stackoverflow.com/users/11536789/user11536789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "closed_date": 1558512292, "accepted_answer_id": 56248706, "answer_count": 1, "score": 1, "last_activity_date": 1558685190, "creation_date": 1558493000, "last_edit_date": 1558685190, "question_id": 56248598, "link": "https://stackoverflow.com/questions/56248598/how-to-run-a-macro-through-a-folder-containing-hundreds-of-txt-files", "closed_reason": "Duplicate", "title": "how to run a macro through a folder containing hundreds of .txt files", "body": "<p>I have a folder with hundreds of .txt files that I need to parse some lines from. These lines then need to be pasted to an excel sheet continuing down in order. This is my first attempt at vba but I managed to pull the text I want from one file and paste it into the excel sheet but I am stuck at being able to continuously run the macro through the entire folder and continuously add the parsed text lines to the excel sheet. Sorry if this is rough but it is my first attempt at macro writing </p>\n\n<p>I tried using Application.FileDialog(msoFileDialogFolderPicker) to call the folder that has all my .txt files in. I then opened the files i wanted with </p>\n\n<pre><code>MyFile = Dir(MyFolder &amp; \"\\\", vbReadOnly)\n</code></pre>\n\n<p>then tried a Do Loop to run the macro through each file but it didn't return any value despite completing the macro it just replaced the previously obtained results.</p>\n\n<p>Here is the basic portion of my code </p>\n\n<pre><code>Sub read()\n</code></pre>\n\n<p>'PURPOSE: Send All Data From Text File To A String Variable</p>\n\n<pre><code>Dim TextFile As Integer\nDim FilePath As String\nDim FileContent As String\n\n\nDim MyFolder As String, MyFile As String\n\n'Opens a file dialog box for user to select a folder\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n   .AllowMultiSelect = False\n   .Show\n   MyFolder = .SelectedItems(1)\n   Err.Clear\nEnd With\n</code></pre>\n\n<p>'File Path of Text File\nMyFile = Dir(MyFolder &amp; \"\\\", vbReadOnly)</p>\n\n<p>'Determine the next file number available for use by the FileOpen function\n     TextFile = FreeFile</p>\n\n<p>'Open the text file\n    Open MyFile For Input As #1</p>\n\n<p>'Store file content inside a variable</p>\n\n<pre><code>Do Until EOF(1)\n    Line Input #1, textline\n    Text = Text &amp; textline\nLoop\n\nClose #1\n</code></pre>\n\n<p>Dim objFSO As Object\n    Dim objFolder As Object</p>\n\n<pre><code>Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFolder = objFSO.getFolder(MyFolder)\n\nDim fls As Object\nDim i As Integer\ni = 1\n\nFor Each fls In objFolder.Files\n</code></pre>\n\n<p>'find required data from txt file</p>\n\n<pre><code>starttime = InStr(Text, \"+start=\")\nendtime = InStr(Text, \"+end=\")\nso = InStr(Text, \"+so=\")\nengineer = InStr(Text, \"+engineer=\")\naccount = InStr(Text, \"+account=\")\nincident = InStr(Text, \"+number=\")\nmachine = InStr(Text, \"+machine=\")\ndown = InStr(Text, \"+down=\")\nnextrow = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n</code></pre>\n\n<p>'label headers for txt data</p>\n\n<pre><code>Range(\"A1\").Value = \"       start time   \"\nRange(\"B1\").Value = \"       end time   \"\nRange(\"C1\").Value = \"   SO   \"\nRange(\"D1\").Value = \"       Total Time    \"\nRange(\"E1\").Value = \"   Engineer       \"\nRange(\"F1\").Value = \"   Account\"\nRange(\"G1\").Value = \"   Incident\"\nRange(\"H1\").Value = \"   Machine\"\nRange(\"I1\").Value = \"   down\"\n</code></pre>\n\n<p>'paste obtained txt data into excel cells</p>\n\n<pre><code>Range(\"A2\" &amp; i).Value = Mid(Text, starttime + 7, 16)\nRange(\"B2\").Value = Mid(Text, endtime + 5, 16)\nRange(\"C2\").Value = Mid(Text, so + 4, 8)\nRange(\"E2\").Value = Mid(Text, engineer + 10, 4)\nRange(\"F2\").Value = Mid(Text, account + 9, 6)\nRange(\"G2\").Value = Mid(Text, incident + 8, 4)\nRange(\"H2\").Value = Mid(Text, machine + 9, 4)\nRange(\"I2\").Value = Mid(Text, down + 6, 9)\n</code></pre>\n\n<p>'Report Out macro finished\n    MsgBox \"      Finished        \"</p>\n\n<pre><code>'Close Text File\n     Close TextFile\n\ni = i + 1\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This gives me the results I want but I have to go through each individual file which is time consuming. I would rather have it loop though the entire folder pulling the information from each file and adding the pulled text to the excel sheet continuing down each row any help would be greatly appreciated</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1558491713, "post_id": 56248452, "comment_id": 99115006, "body": "Do you have a reference set to the Microsoft Word Object Library under <i>Tools</i> &gt; <i>References</i>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1558492718, "post_id": 56248452, "comment_id": 99115170, "body": "<code>wdExportFormatPDF</code> is defined in the Word type library - you need to use the underlying value of that named constant, or reference the library and use early binding / declare <code>wordApp As Word.Application</code>, <code>wordDoc As Word.Document</code>, and <code>Set wordApp = New Word.Application</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11536850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397b9b93a1f1cece0ad9ab69484de427?s=128&d=identicon&r=PG&f=1", "display_name": "Michael T", "link": "https://stackoverflow.com/users/11536850/michael-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1558499452, "creation_date": 1558499452, "answer_id": 56249345, "question_id": 56248452, "link": "https://stackoverflow.com/questions/56248452/type-5-errors-when-using-exportasfixedformat/56249345#56249345", "title": "Type 5 errors when using ExportAsFixedFormat", "body": "<blockquote>\n  <p>Do you have a reference set to the Microsoft Word Object Library under Tools > \n  References? \u2013 BigBen 1 hour ago</p>\n</blockquote>\n\n<p>THANKS BEN! I searched the list twice and thought that the office 16.0 reference was the correct one - it's a big list, and only after your comment went back again and found \"word\" was there the whole time :)</p>\n"}, {"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1558500517, "creation_date": 1558500517, "answer_id": 56249501, "question_id": 56248452, "link": "https://stackoverflow.com/questions/56248452/type-5-errors-when-using-exportasfixedformat/56249501#56249501", "title": "Type 5 errors when using ExportAsFixedFormat", "body": "<p>if  reference to Word was there the whole time, Error 5 will also be raised  if <code>CustomDocumentProperties</code> \"PO_Item\" is not added. I reproduced error 5 on that line. </p>\n\n<p>Make it </p>\n\n<pre><code>wordDoc.CustomDocumentProperties.Add _\n    Name:=\"PO_Item\", LinkToContent:=False, Value:=newName, _\n    Type:=msoPropertyTypeString\n</code></pre>\n\n<p>Also keep in a line</p>\n\n<pre><code>wordDoc.ExportAsFixedFormat outputfilename:=filePath &amp; newName &amp; \".pdf\", exportformat:=wdExportFormatPDF\n</code></pre>\n\n<p>and it is tested and working. </p>\n"}], "owner": {"reputation": 1, "user_id": 11536850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397b9b93a1f1cece0ad9ab69484de427?s=128&d=identicon&r=PG&f=1", "display_name": "Michael T", "link": "https://stackoverflow.com/users/11536850/michael-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558500517, "creation_date": 1558491375, "question_id": 56248452, "link": "https://stackoverflow.com/questions/56248452/type-5-errors-when-using-exportasfixedformat", "title": "Type 5 errors when using ExportAsFixedFormat", "body": "<p>It seems to work for everyone else, but my exportasfixedformat always calls up a type 5 error.</p>\n\n<p>I've tried: similar code to others, checking everything has been dimmed, using _, and more but I just can't get my head around it.</p>\n\n<pre><code>Dim wordApp As Object\nDim wordDoc As Object\nDim newName As String\nDim FilE As String\nDim filePath As String\n\nPublic Sub MainCode()\nfilePath = \"X:\\Invoices\\10.4.1 RFPOs\\\"\nFilE = \"X:\\Invoices\\10.4.1 RFPOs\\Supporting Evidence Template v1.docx\"\nSet wordApp = CreateObject(\"word.application\")\nwordApp.Visible = True\nSet wordDoc = wordApp.documents.Open(FilE)\nnewName = \"THIS SMELLS\"\nwordDoc.CustomDocumentProperties(\"PO_Item\").Value = newName\nwordDoc.Fields.Update\nwordDoc.ExportAsFixedFormat outputfilename:=filePath &amp; newName &amp; \".pdf\", \nexportformat:=wdExportFormatPDF\nwordDoc.Close\nwordApp.Quit\nSet wordDoc = Nothing\nSet wordApp = Nothing\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Run-time error '5':\nInvalid procedure or argument.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1558487253, "post_id": 56247839, "comment_id": 99114310, "body": "What is <code>Range.Text:=Contents</code>? <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.bookmarks.add\" rel=\"nofollow noreferrer\"><code>Bookmarks.Add</code></a> has a <code>Range</code> parameter."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1558487307, "post_id": 56247839, "comment_id": 99114318, "body": "There is more information in the error message than what you&#39;ve provided. Please <a href=\"https://stackoverflow.com/posts/56247839/edit\">edit</a> your post to include the complete, full, exact error message and indicate the line on which it is occurring."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11536601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qryWGVsbkrA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rflP6u7OlONWM9Ud3LtP2C3f0uigQ/mo/photo.jpg?sz=128", "display_name": "Robert", "link": "https://stackoverflow.com/users/11536601/robert"}, "edited": false, "score": 0, "creation_date": 1558690040, "post_id": 56248569, "comment_id": 99191911, "body": "Thanks so much taking the time to answer my question so thoroughly. Both your explanation and the revised code was helpful."}], "tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": false, "score": 0, "last_activity_date": 1558492588, "creation_date": 1558492588, "answer_id": 56248569, "question_id": 56247839, "link": "https://stackoverflow.com/questions/56247839/i-cannot-insert-text-directly-into-bookmark-via-vba/56248569#56248569", "title": "I cannot insert text directly into bookmark via VBA", "body": "<p>You cannot add a bookmark to text that doesn't exist already in a document. In other words, you have to first select the text you want to enclose within a bookmark. If the text doesn't exist, then you must insert the text and then you can select it and finally insert the necessary bookmark to surround it.</p>\n\n<p>If you had opened the VBE, Visual Basic Editor, and looked at your code you would see the statement <code>Add Range.Text:=Contents</code> in red and it was causing the syntax error because there are no such properties in the Bookmarks.Add method.</p>\n\n<p>Even with the Bookmarks.Add method corrected your code would still fail because the string variable BMName is never given a value and the BookMark name cannot be blank.</p>\n\n<p>Below is revise code of your routine that you should study:</p>\n\n<pre><code>Sub AddBookMarkRevised()\n\nDim BMName As String\nDim Contents As String\nDim rng As Range\n\nBMName = \"BM1\"\nContents = \"Testing\"\n\nSet rng = Selection.Range\nrng.Text = Contents\n\nWith ActiveDocument.Bookmarks\n .Add BMName, rng\n .DefaultSorting = wdSortByName\n .ShowHidden = False\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11536601, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qryWGVsbkrA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rflP6u7OlONWM9Ud3LtP2C3f0uigQ/mo/photo.jpg?sz=128", "display_name": "Robert", "link": "https://stackoverflow.com/users/11536601/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1558620240, "creation_date": 1558484820, "last_edit_date": 1558620240, "question_id": 56247839, "link": "https://stackoverflow.com/questions/56247839/i-cannot-insert-text-directly-into-bookmark-via-vba", "title": "I cannot insert text directly into bookmark via VBA", "body": "<p>'Trying to insert text directly into a bookmark via VBA</p>\n\n<p>'tried lots of things, but nothing worked. </p>\n\n<p>'Can someone point out where I am getting this wrong?</p>\n\n<pre><code>Sub AddBookMark()\n\nDim BMName As String\nDim Contents As String\n\nsText = \"BM1\"\nContents = \"Testing\"\n\nWith ActiveDocument.Bookmarks\n .Add Range.Text:=Contents\n .Add Name:=BMName\n .DefaultSorting = wdSortByName\n .ShowHidden = False\nEnd With\nEnd Sub\n</code></pre>\n\n<p>'Compile error: syntax error</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1558481775, "post_id": 56247512, "comment_id": 99113404, "body": "It is unclear what you want the function to return...........the <b>name of the previous worksheet</b> or or the <b>value of the cells</b> in the previous worksheet or <b>what</b>  ??"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1558482263, "post_id": 56247512, "comment_id": 99113486, "body": "<code>#NAME</code> indicates the UDF <code>PrevSheet</code> is not found, from current workbook or any addins. Your UDF should return Range. If macro was enabled then this UDF function should show and not give you <i>#NAME</i> error."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1558482935, "post_id": 56247512, "comment_id": 99113610, "body": "Your issues may be related to how you have defined your Named Ranges.  Please update your Q with full details of your Names"}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 8631622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8c3c8025900b42d95e64cd0d1518ee?s=128&d=identicon&r=PG&f=1", "display_name": "Pie", "link": "https://stackoverflow.com/users/8631622/pie"}, "edited": false, "score": 0, "creation_date": 1558510626, "post_id": 56247629, "comment_id": 99120619, "body": "Can you help me with this question? I tried everything I knew but could not solve. stackoverflow.com/q/56207459/8631622 @Gary&#39;s Student"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1558482527, "creation_date": 1558482527, "answer_id": 56247629, "question_id": 56247512, "link": "https://stackoverflow.com/questions/56247512/macro-added-prevsheet-function-returns-name-error/56247629#56247629", "title": "Macro added PrevSheet function returns #NAME error", "body": "<p>Your code appears to work <strong>if it is placed in a Standard Module</strong>:</p>\n\n<pre><code>Public Function PrevSheet(RCell As Range) As Variant\n    Dim xIndex As Long\n    Application.Volatile\n\n    xIndex = RCell.Worksheet.Index\n    MsgBox xIndex\n    If xIndex &gt; 1 Then\n        PrevSheet = Worksheets(xIndex - 1).Range(RCell.Address)\n    End If\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2OdHh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2OdHh.png\" alt=\"enter image description here\"></a></p>\n\n<p>For example, in the worksheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/znVfy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/znVfy.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have assigned cell <strong>A7</strong> the Name <em>junk</em> and the 666 is the value in the previous sheet's cell <strong>A7</strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 11505290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7g3nP-io7U0/AAAAAAAAAAI/AAAAAAAAAC4/PR3aoE_fz_c/photo.jpg?sz=128", "display_name": "Flamingo", "link": "https://stackoverflow.com/users/11505290/flamingo"}, "edited": false, "score": 0, "creation_date": 1558532872, "post_id": 56247788, "comment_id": 99133267, "body": "Ive amended the code and respecified the ranges as you suggested, and it still doesn&#39;t work? Let me show you  &lt;br/&gt; !<a href=\"https://imgur.com/1nEN0YJ\" rel=\"nofollow noreferrer\">the name manager</a>  &lt;br/&gt;  it doesnt show me the names on the dropdown  &lt;br/&gt;  !<a href=\"https://imgur.com/gsWtPPs\" rel=\"nofollow noreferrer\">it doesnt show me the names on the dropdown bar</a>.  &lt;br/&gt;  sheet 1. the range bar doesnt display the named range when selected  &lt;br/&gt;  !<a href=\"https://imgur.com/9aHULD8\" rel=\"nofollow noreferrer\">sheet1</a>.  &lt;br/&gt;  !sheet 2. the prevsheet function doesnt work either way  <a href=\"https://imgur.com/bDJtbKQ\" rel=\"nofollow noreferrer\">sheet2</a>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 31, "user_id": 11505290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7g3nP-io7U0/AAAAAAAAAAI/AAAAAAAAAC4/PR3aoE_fz_c/photo.jpg?sz=128", "display_name": "Flamingo", "link": "https://stackoverflow.com/users/11505290/flamingo"}, "edited": false, "score": 0, "creation_date": 1558559103, "post_id": 56247788, "comment_id": 99146323, "body": "@Flamingo for some reason that style of Name doesn&#39;t show in the dropdown.  To fix the <code>#Name?</code> issue, change the name of your Module to something other than <code>PrevSheet</code>  (making it the same as the UDF has created a conflict)"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1558485144, "last_edit_date": 1558485144, "creation_date": 1558484170, "answer_id": 56247788, "question_id": 56247512, "link": "https://stackoverflow.com/questions/56247512/macro-added-prevsheet-function-returns-name-error/56247788#56247788", "title": "Macro added PrevSheet function returns #NAME error", "body": "<p>This will work, if you define your Named Ranges correctly.  There are several ways this can be done, but here's one that is IMO simplest.</p>\n\n<p>Since you say <em>...use it with named single cell ranges which are consistent across the workbook.</em> you can create a single Named Range, Workbook scope, that will refer to  a cell (or cells) on the sheet which references the name.</p>\n\n<p>Lets say you want to refer to cell <code>A1</code>.  In Name Manager, create a Name, lets say <code>YourNamedRange</code> workbook scope, Reference <code>=!$A$1</code>  (Note the <code>!</code> without a sheet reference).</p>\n\n<p>When you add a formula to a sheet (eg <code>=YourNamedRange</code>) it will refer to cell <code>A1</code> <em>on the sheet containing the formula</em>.</p>\n\n<p>Applying it to your UDF, just use <code>=PrevSheet(YourNamedRange)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/zXqfd.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zXqfd.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Your UDF works (mostly) as is, but will fail if a different Workbook is active.  To fix that, use</p>\n\n<pre><code>Function PrevSheet(RCell As Range)\n    Dim xIndex As Long\n    Application.Volatile\n    xIndex = RCell.Worksheet.Index\n    If xIndex &gt; 1 Then\n        With RCell.Worksheet.Parent 'The workbook containing RCell\n            PrevSheet = .Worksheets(xIndex - 1).Range(RCell.Address)\n        End With\n    End If\nEnd Function\n</code></pre>\n\n<p>There is also a <code>Worksheet</code>Property called <code>Previous</code> that does much the same thing, so you can refactor as</p>\n\n<pre><code>Function PrevSheet(RCell As Range) As Variant\n    Application.Volatile\n    PrevSheet = RCell.Worksheet.Previous.Range(RCell.Address).Value\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11505290, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7g3nP-io7U0/AAAAAAAAAAI/AAAAAAAAAC4/PR3aoE_fz_c/photo.jpg?sz=128", "display_name": "Flamingo", "link": "https://stackoverflow.com/users/11505290/flamingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1558534971, "creation_date": 1558481388, "last_edit_date": 1558534971, "question_id": 56247512, "link": "https://stackoverflow.com/questions/56247512/macro-added-prevsheet-function-returns-name-error", "title": "Macro added PrevSheet function returns #NAME error", "body": "<p>I added a simple Previous Sheet macro to file and it worked normally, until it started to return #NAME error, and i can't figure out why.</p>\n\n<p>I meant to use it with named single cell ranges which are consistent across the workbook, I'd used it successfully before naming the ranges and didn't think it would have any impact on the fuction. After naming the ranges though it no longer works, not even for regular non named ranges. </p>\n\n<p>I have tested this by creating a new workbook, filling some sheets and trying it out, and it still returns a <code>#NAME</code> error. When i evaluate the function, the error appears at the very first step: recognizing the function. However, when i type into the formula bar, the programs offers me the formula normally. </p>\n\n<p>I have also tried referring to the named cells by its cell, and even adding the worksheet name before the cell (eg \"<code>prevsheet(previoussheetname!a1)</code>, or <code>prevsheet(thissheetname!a1)</code>). I have even, in a last ditch effort, tried adding double quotes before the cell name. </p>\n\n<p>For full disclosure, i have also another macro subroutine that uses references to previous and next sheets, but as it wouldnt recognize the function itself (which should have been an early sign), it makes use of relative referencing  (ie <code>activesheet(index - 1</code>, <code>activesheet(index + 1)</code>). At the time i didn't think it would mess up the function, but as i grow ever more desperate and confused, maybe thats a possibility.</p>\n\n<p>the <code>PrevSheet()</code> code i was using:</p>\n\n<pre><code>Function PrevSheet(RCell As Range)\n\n    Dim xIndex As Long\n\n    Application.Volatile\n\n    xIndex = RCell.Worksheet.Index\n\n    If xIndex &gt; 1 Then _\n        PrevSheet = Worksheets(xIndex - 1).Range(RCell.Address)\n\nEnd Function\n</code></pre>\n\n<p>And as it is now, as suggested by Chris Neilsen</p>\n\n<p>Function PrevSheet(RCell As Range) As Variant</p>\n\n<pre><code>Application.Volatile\n\nPrevSheet = RCell.Worksheet.Previous.Range(RCell.Address).Value\n</code></pre>\n\n<p>End Function</p>\n\n<p>As suggested by Chris Neilsen i have edited the named ranges to look like this:</p>\n\n<p><code>!(nothing)$column$row</code> with its scope set to <code>Workbook</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/pi3fk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pi3fk.png\" alt=\"name manager\"></a></p>\n\n<p>The named range is not available at the range browser. \n<a href=\"https://i.stack.imgur.com/QC5Sc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QC5Sc.png\" alt=\"range browser\"></a></p>\n\n<p>Only cell B1 is named. It is called \"name\"\n<a href=\"https://i.stack.imgur.com/kGgtF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kGgtF.png\" alt=\"sheet1\"></a></p>\n\n<p>PrevSheet() does not work with either range. \n<a href=\"https://i.stack.imgur.com/Ccwwd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ccwwd.png\" alt=\"sheet2\"></a></p>\n\n<p>Macros are enabled</p>\n\n<p><a href=\"https://i.stack.imgur.com/xSNkV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xSNkV.png\" alt=\"macros are enabled\"></a></p>\n\n<p>Anyone with a better understanding of vba, macros and excel can tell me why this is happening and how do i fix it so it returns the value of the specified cell in the first sheet to the left of sheet the function is typed in? (ie, in sheet4, <code>=prevsheet(A1)</code> will return the value of cell A1 in sheet3)</p>\n\n<p>I hope my question is clearer now!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1558477476, "post_id": 56247016, "comment_id": 99112529, "body": "I don&#39;t see how this is deleting anything. You are adding a row below your last blank row. This row will be blank by default"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1558477498, "post_id": 56247016, "comment_id": 99112532, "body": "If you insert a row anywhere by just doing <code>right click &gt; insert</code> you will find a blank row or column (depending on the insert)"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1558483467, "post_id": 56247016, "comment_id": 99113696, "body": "Try copying the row above rather than inserting and the clear the cells that don\u2019t contain formulas."}], "answers": [{"tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": false, "score": 1, "last_activity_date": 1558484407, "creation_date": 1558484407, "answer_id": 56247810, "question_id": 56247016, "link": "https://stackoverflow.com/questions/56247016/i-have-a-vb-code-to-add-a-row-in-excel-but-it-keeps-deleting-the-formulas-in-al/56247810#56247810", "title": "I have a VB code to add a row in excel, but it keeps deleting the formulas in all columns", "body": "<p>Try something like this ...</p>\n\n<pre><code>Sub AddRow()\n    Dim lngLastRow As Long, rngActiveCell As Range\n\n    ' Rename \"Sheet1\" to the name of your worksheet.\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        lngLastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        ' Get the active cell, we'll make sure we reselect it after the copy operation completes.\n        Set rngActiveCell = ActiveCell\n\n        ' Turn screen updating off.\n        Application.ScreenUpdating = False\n\n        ' Copy and paste the last row to the row below.\n        .Rows(lngLastRow).Copy\n        .Rows(lngLastRow + 1).PasteSpecial\n\n        ' Select the previously active cell.\n        rngActiveCell.Select\n\n        On Error Resume Next\n\n        ' Clear the cells that do not contain formulas.\n        .Rows(lngLastRow + 1).SpecialCells(xlCellTypeConstants).ClearContents\n\n        On Error GoTo 0\n\n        ' Do some clean up work.\n        Application.CutCopyMode = False\n        Application.ScreenUpdating = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>There are few other things that may need to be thrown in but go with that as a start.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nRmgv.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nRmgv.gif\" alt=\"enter image description here\"></a></p>\n\n<p>I hope it helps.</p>\n"}], "owner": {"reputation": 1, "user_id": 11535987, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-l6Ji7JpNoSY/AAAAAAAAAAI/AAAAAAAAAvA/wLyR_N4a6sQ/photo.jpg?sz=128", "display_name": "Ray", "link": "https://stackoverflow.com/users/11535987/ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558489025, "creation_date": 1558477153, "last_edit_date": 1558489025, "question_id": 56247016, "link": "https://stackoverflow.com/questions/56247016/i-have-a-vb-code-to-add-a-row-in-excel-but-it-keeps-deleting-the-formulas-in-al", "title": "I have a VB code to add a row in excel, but it keeps deleting the formulas in all columns", "body": "<p>I have some VBA code in excel to add a row when I click a button. The problem is that the formulas are deleted in the rows when I click the \"Add Row\" button. </p>\n\n<p>The code is this:</p>\n\n<pre><code>Sub AddRow()\n    Range(\"A\" &amp; Rows.Count).End(xlUp).Select\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.EntireRow.Insert\nEnd Sub\n</code></pre>\n\n<p>I cannot think of a way to get around this problem. I'm by no means fluent in coding at all. I obtained the code from a youtube video that looked like it would help me with adding rows.</p>\n\n<p>An example of the formulas that I have entered in is:</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"Cuvette Packaging\",$C$105:$C$419)),$B$105:$B$1276,\"\")\n</code></pre>\n\n<p>I just can't seem to find out how to get around the code to not delete what I have in all of my columns.</p>\n"}, {"tags": ["vba", "multiple-columns", "shuffle"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558472776, "post_id": 56246342, "comment_id": 99111160, "body": "Have you tried storing the random numbers into dictionaries and check them while randomize runs? So if you get a number wich index (row) is the same, try another one."}, {"owner": {"reputation": 3, "user_id": 3375228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6b37634a10ebb3cb18820ef84817a11?s=128&d=identicon&r=PG&f=1", "display_name": "user3375228", "link": "https://stackoverflow.com/users/3375228/user3375228"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558474313, "post_id": 56246342, "comment_id": 99111719, "body": "as you can see from my code that I am not an excel guru, this being said I hadn&#39;t heard about dictionaries before but I just googled it and it may work, just have to figure out the verbiage."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558474381, "post_id": 56246342, "comment_id": 99111745, "body": "look up for &quot;vba for smarties dictionaries&quot; I learned there how to use them"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1558498591, "post_id": 56246342, "comment_id": 99116175, "body": "Are the values in the initial array column UNIQUE?  Is one goal to have all COMBIINATIONS and PERMUTATIONS of these numbers, or just have 4 values?  Shuffle the first column, then for each row shuffle the first column into a work area and strike out the value that was in the first column, taking the first  3 remaining values."}, {"owner": {"reputation": 3, "user_id": 3375228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6b37634a10ebb3cb18820ef84817a11?s=128&d=identicon&r=PG&f=1", "display_name": "user3375228", "link": "https://stackoverflow.com/users/3375228/user3375228"}, "edited": false, "score": 0, "creation_date": 1558526148, "post_id": 56246342, "comment_id": 99129124, "body": "Yes the values in the initial array column are Unique. No I don&#39;t want all permutations, I&#39;m trying to get unique values in each row that is created by shuffling the original array into the following columns"}], "owner": {"reputation": 3, "user_id": 3375228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6b37634a10ebb3cb18820ef84817a11?s=128&d=identicon&r=PG&f=1", "display_name": "user3375228", "link": "https://stackoverflow.com/users/3375228/user3375228"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558473110, "creation_date": 1558472629, "last_edit_date": 1558473110, "question_id": 56246342, "link": "https://stackoverflow.com/questions/56246342/shuffle-an-existing-column-multiple-times-with-no-repeats-on-any-row", "title": "Shuffle an existing column multiple times with no repeats on any row", "body": "<p>I am using VBA</p>\n\n<p>I have a column of integers in an array</p>\n\n<p>I run the array thru a randomizer module and copy that to a second column</p>\n\n<p>I run the array thru a randomizer module and copy that to a third column</p>\n\n<p>I run the array thru a randomizer module and copy that to a fourth column</p>\n\n<p>The issue I can't seem to over come is duplicates on the same row</p>\n\n<p>IE:</p>\n\n<pre><code>    2   13   27   14\n    27  27   13   5\n    14  5    2    13\n    13  2    14   27\n    5   14   5    2\n</code></pre>\n\n<p>*columns are much longer</p>\n\n<p>I have searched the web but everyone is focused on creating random numbers without duplicate. I have found shuffling but once again it seems to be one dimensional.</p>\n\n<pre><code>'// get a random number from 1 to the last row of column 25\nFor N1 = 1 To LastRow\nAgain:\n    Randomize Timer\n    RNum = Int(Rnd * (LastRow - 1 + 1) + 1)\n\n\n'// this is where the values in \"NArray\" get shuffled around\n    Temp = NArray(N1)\n    NArray(N1) = NArray(RNum)\n    NArray(RNum) = Temp\n\n    ws5.Cells(N1, Lp) = NArray(N1)\n\n'// this looks for duplicate numbers in the row\n    Select Case Lp\n        Case 26:    a = ws5.Cells(N1, Lp).Value + 0\n                b = ws5.Cells(N1, Lp - 1).Value + 0\n                If a = b Then\n                    GoTo Again\n                End If\n        Case 27:    a = ws5.Cells(N1, Lp).Value + 0\n                b = ws5.Cells(N1, Lp - 2).Value + 0\n                c = ws5.Cells(N1, Lp - 1).Value + 0\n                If a = b Then\n                    GoTo Again\n                ElseIf a = c Then\n                    GoTo Again\n                End If\n</code></pre>\n\n<p>...<br>\n    '// the shuffled array is inserted into the cells of column 26\n    For N1 = 1 To LastRow\n        ws5.Cells(N1, Lp) = NArray(N1)\n    Next N1\n    Next Lp</p>\n\n<p>no errors with the exception that when comparing cell values in the row going from column to column it misses duplicate values such as row 2 column 3 may contain \"14\" and row 2 column 4 contains \"14\" it doesn't loop back and get another value for column 4</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1558473125, "post_id": 56246305, "comment_id": 99111298, "body": "To be honest, you&#39;re probably better off asking optimization questions on <a href=\"https://codereview.stackexchange.com/\">Code Review</a>, if the code already works."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558473409, "post_id": 56246305, "comment_id": 99111410, "body": "Loop through all the cells with a dictionary, if the item exists, add the values, if it doesn&#39;t add the item and it&#39;s value. When it&#39;s done just paste the keys and items from the dictionary. That should take barely 5 seconds"}, {"owner": {"reputation": 19, "user_id": 7769721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-duHthQmNFjg/AAAAAAAAAAI/AAAAAAAAEs8/XM0-oiOal3Q/photo.jpg?sz=128", "display_name": "Thomas Koipuram", "link": "https://stackoverflow.com/users/7769721/thomas-koipuram"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1558473502, "post_id": 56246305, "comment_id": 99111438, "body": "@BigBen Thanks for the tip, I was unaware of the same. Will a moderator move it or do I need to create a duplicate question there?"}, {"owner": {"reputation": 19, "user_id": 7769721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-duHthQmNFjg/AAAAAAAAAAI/AAAAAAAAEs8/XM0-oiOal3Q/photo.jpg?sz=128", "display_name": "Thomas Koipuram", "link": "https://stackoverflow.com/users/7769721/thomas-koipuram"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1558473962, "post_id": 56246305, "comment_id": 99111597, "body": "Thanks @Damian. Let me do some research on Dictionary... Never used it. Appreciate if someone can help with the implementation."}, {"owner": {"reputation": 656, "user_id": 2103337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0SDOA.jpg?s=128&g=1", "display_name": "supajason", "link": "https://stackoverflow.com/users/2103337/supajason"}, "edited": false, "score": 0, "creation_date": 1558474311, "post_id": 56246305, "comment_id": 99111718, "body": "Also turn screenupdating off"}, {"owner": {"reputation": 19, "user_id": 7769721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-duHthQmNFjg/AAAAAAAAAAI/AAAAAAAAEs8/XM0-oiOal3Q/photo.jpg?sz=128", "display_name": "Thomas Koipuram", "link": "https://stackoverflow.com/users/7769721/thomas-koipuram"}, "reply_to_user": {"reputation": 656, "user_id": 2103337, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0SDOA.jpg?s=128&g=1", "display_name": "supajason", "link": "https://stackoverflow.com/users/2103337/supajason"}, "edited": false, "score": 0, "creation_date": 1558474517, "post_id": 56246305, "comment_id": 99111788, "body": "@supajason Yes, missed to mention... its already off. Thanks for the tip though."}, {"owner": {"reputation": 2306, "user_id": 1843468, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c459886648fd2e153a518352292ab509?s=128&d=identicon&r=PG", "display_name": "LWChris", "link": "https://stackoverflow.com/users/1843468/lwchris"}, "edited": false, "score": 0, "creation_date": 1558474888, "post_id": 56246305, "comment_id": 99111922, "body": "Unless it&#39;s required to be coded, I&#39;d like to mention that &quot;Aggregate one column based on another&quot; is exactly what the built in PivotTables are there for."}, {"owner": {"reputation": 19, "user_id": 7769721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-duHthQmNFjg/AAAAAAAAAAI/AAAAAAAAEs8/XM0-oiOal3Q/photo.jpg?sz=128", "display_name": "Thomas Koipuram", "link": "https://stackoverflow.com/users/7769721/thomas-koipuram"}, "reply_to_user": {"reputation": 2306, "user_id": 1843468, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c459886648fd2e153a518352292ab509?s=128&d=identicon&r=PG", "display_name": "LWChris", "link": "https://stackoverflow.com/users/1843468/lwchris"}, "edited": false, "score": 0, "creation_date": 1558475868, "post_id": 56246305, "comment_id": 99112179, "body": "@LWChris Totally Agree. However, as I mentioned, this is just a small part of an &quot;automation app&quot; in Excel. So it needs to be in the code."}, {"owner": {"reputation": 2306, "user_id": 1843468, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c459886648fd2e153a518352292ab509?s=128&d=identicon&r=PG", "display_name": "LWChris", "link": "https://stackoverflow.com/users/1843468/lwchris"}, "edited": false, "score": 0, "creation_date": 1558552249, "post_id": 56246305, "comment_id": 99143313, "body": "@ThomasKoipuram Yes. Maybe other users who are stopping by while trying to reinvent the wheel just to see aggregated data will find this useful. :)"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7769721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-duHthQmNFjg/AAAAAAAAAAI/AAAAAAAAEs8/XM0-oiOal3Q/photo.jpg?sz=128", "display_name": "Thomas Koipuram", "link": "https://stackoverflow.com/users/7769721/thomas-koipuram"}, "edited": false, "score": 0, "creation_date": 1558475942, "post_id": 56246682, "comment_id": 99112194, "body": "Thanks so much for the code and explanation. It helped a lot!"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1558474578, "creation_date": 1558474578, "answer_id": 56246682, "question_id": 56246305, "link": "https://stackoverflow.com/questions/56246305/need-help-to-optimize-the-excel-vba-code-that-aggregates-duplicates/56246682#56246682", "title": "Need help to optimize the Excel VBA code that aggregates duplicates", "body": "<p>Here you go:</p>\n\n<pre><code>Option Explicit\nSub Consolidate()\n\n    Dim arrData As Variant\n    Dim i As Long\n    Dim Sales As New Scripting.Dictionary 'You will need the library Microsoft Scripting Runtime\n\n    Application.ScreenUpdating = False 'speed up the code since excel won't show you what is happening\n\n    'First of all, working on arrays always speeds up a lot the code because you are working on memory\n    'instead of working with the sheets\n    With ThisWorkbook.Sheets(\"YourSheet\") 'change this\n        i = .Cells(.Rows.Count, 1).End(xlUp).Row 'last row on column A\n        arrData = .Range(\"A2\", .Cells(i, 2)).Value 'here im assuming your row 1 has headers and we are storing the data into an array\n    End With\n\n    'Then we create a dictionary with the data\n    For i = 1 To UBound(arrData) 'from row 2 to the last on Q1 (the highest)\n        If Not Sales.Exists(arrData(i, 1)) Then\n            Sales.Add arrData(i, 1), arrData(i, 2) 'We add the worker(Key) with his sales(Item)\n        Else\n            Sales(arrData(i, 1)) = Sales(arrData(i, 1)) + arrData(i, 2) 'if the worker already exists, sum his sales\n        End If\n    Next i\n\n    'Now you have all the workers just once\n    'If you want to delete column A and B and just leave the consolidate data:\n    With ThisWorkbook.Sheets(\"YourSheet\") 'change this\n        i = .Cells(.Rows.Count, 1).End(xlUp).Row 'last row on column A\n        .Range(\"A2:B\" &amp; i).ClearContents\n        .Cells(2, 1).Resize(Sales.Count) = Application.Transpose(Sales.Keys) 'workers\n        .Cells(2, 2).Resize(Sales.Count) = Application.Transpose(Sales.Items) 'Their sales\n    End With\n\n    Application.ScreenUpdating = True 'return excel to normal\n\nEnd Sub\n</code></pre>\n\n<p>To learn everything about dictionaries (and more) check <a href=\"http://www.snb-vba.eu/VBA_Dictionary_en.html\" rel=\"nofollow noreferrer\">this</a></p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 7769721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-duHthQmNFjg/AAAAAAAAAAI/AAAAAAAAEs8/XM0-oiOal3Q/photo.jpg?sz=128", "display_name": "Thomas Koipuram", "link": "https://stackoverflow.com/users/7769721/thomas-koipuram"}, "edited": false, "score": 0, "creation_date": 1558478002, "post_id": 56246954, "comment_id": 99112656, "body": "This looks good (and compact)! I already implemented Damian&#39;s solution and it brought down my running time from 45 sec to 4 seconds. So, I am currently sticking with that. But this is a good learning. Thanks!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1558495108, "post_id": 56246954, "comment_id": 99115573, "body": "Using <code>SumProduct</code> on whole columns is a bad idea. <a href=\"https://fastexcel.wordpress.com/2015/12/12/excel-full-column-references-and-used-range-good-idea-or-bad-idea/\" rel=\"nofollow noreferrer\">See Here</a> (from the conclusion: <i>Formulas other than array formulas and SUMPRODUCT handle whole column references efficiently.</i> ) Use the much simpler <code>=SUMIFS(B:B,A:A,C2)</code> instead"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1558534430, "post_id": 56246954, "comment_id": 99134347, "body": "@chrisneilsen  I agree and I updated the Answer.........................Thank you!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1558534366, "last_edit_date": 1558534366, "creation_date": 1558476728, "answer_id": 56246954, "question_id": 56246305, "link": "https://stackoverflow.com/questions/56246305/need-help-to-optimize-the-excel-vba-code-that-aggregates-duplicates/56246954#56246954", "title": "Need help to optimize the Excel VBA code that aggregates duplicates", "body": "<p>With data in cols <strong>A</strong> and <strong>B</strong> like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cjl8X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cjl8X.png\" alt=\"enter image description here\"></a></p>\n\n<p>Running this short macro:</p>\n\n<pre><code>Sub KopyII()\n    Dim cell As Range, N As Long\n\n    Columns(\"A:A\").Copy Range(\"C1\")\n    ActiveSheet.Range(\"C:C\").RemoveDuplicates Columns:=1, Header:=xlNo\n    N = Cells(Rows.Count, \"C\").End(xlUp).Row\n\n    Range(\"B1\").Copy Range(\"D1\")\n\n    Range(\"D2:D\" &amp; N).Formula = \"=SUMPRODUCT(--(A:A= C2),(B:B))\"\nEnd Sub\n</code></pre>\n\n<p>will produce this in cols <strong>C</strong> and <strong>D</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/0BYKU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0BYKU.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>NOTE:</strong></p>\n\n<p>This relies on Excel's builtin RemoveDuplicates feature.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>As chris neilsen points out, this function should be a bit quicker to evaluate:</p>\n\n<pre><code>Sub KopyIII()\n    Dim cell As Range, N As Long, A As Range, C As Range\n    Set A = Range(\"A:A\")\n    Set C = Range(\"C:C\")\n\n    A.Copy C\n    C.RemoveDuplicates Columns:=1, Header:=xlNo\n    N = Cells(Rows.Count, \"C\").End(xlUp).Row\n\n    Range(\"B1\").Copy Range(\"D1\")  ' the header\n\n    Range(\"D2:D\" &amp; N).Formula = \"=SUMIFS(B:B,A:A,C2)\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7769721, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-duHthQmNFjg/AAAAAAAAAAI/AAAAAAAAEs8/XM0-oiOal3Q/photo.jpg?sz=128", "display_name": "Thomas Koipuram", "link": "https://stackoverflow.com/users/7769721/thomas-koipuram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56246682, "answer_count": 2, "score": 0, "last_activity_date": 1558534366, "creation_date": 1558472449, "question_id": 56246305, "link": "https://stackoverflow.com/questions/56246305/need-help-to-optimize-the-excel-vba-code-that-aggregates-duplicates", "title": "Need help to optimize the Excel VBA code that aggregates duplicates", "body": "<p>Below is my source table</p>\n\n<pre><code>    Name              Sales\n---------------------------------\n    Thomas             100\n    Jay                200\n    Thomas             100\n    Mathew              50\n</code></pre>\n\n<p>Output I need is as below</p>\n\n<pre><code>    Name              Sales\n---------------------------------\n    Thomas             200\n    Jay                200\n    Mathew              50\n</code></pre>\n\n<p>Basically, I have 2 columns that can have duplicates and I need to aggregate the second column based on first column.</p>\n\n<p>Current code I have is as below. Its working perfectly fine. It takes around 45 seconds to run for 4500 records. I was wondering if there is a more efficient way to do this... as it seems to be a trivial requirement.</p>\n\n<pre><code>'Combine duplicate rows and sum values\n\nDim Rng As Range\nDim LngRow As Long, i As Long\n\nLngLastRow = lRow 'The last row is calculated somewhere above...\n\n'Initializing the first row\ni = 1\n\n'Looping until blank cell is encountered in first column\nWhile Not Cells(i, 1).Value = \"\"\n\n    'Initializing range object\n    Set Rng = Cells(i, 1)\n\n    'Looping from last row to specified first row\n    For LngRow = LngLastRow To (i + 1) Step -1\n\n        'Checking whether value in the cell is equal to specified cell\n        If Cells(LngRow, 1).Value = Rng.Value Then\n            Rng.Offset(0, 1).Value = Rng.Offset(0, 1).Value + Cells(LngRow, 2).Value\n            Rows(LngRow).Delete\n        End If\n\n    Next LngRow\n\n    i = i + 1\n\nWend\n</code></pre>\n\n<p>Note that this is part of a larger excel app and hence I definitely need the solution to be in Excel VBA.</p>\n"}, {"tags": ["regex", "vba", "google-sheets", "array-formulas", "google-sheets-formula"], "comments": [{"owner": {"reputation": 31, "user_id": 8358849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783c974493b95f5dbf3fd50a6827d66f?s=128&d=identicon&r=PG&f=1", "display_name": "NKI", "link": "https://stackoverflow.com/users/8358849/nki"}, "reply_to_user": {"reputation": 68102, "user_id": 5632629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pfxka.jpg?s=128&g=1", "display_name": "player0", "link": "https://stackoverflow.com/users/5632629/player0"}, "edited": false, "score": 0, "creation_date": 1558472182, "post_id": 56246187, "comment_id": 99110915, "body": "<a href=\"https://docs.google.com/spreadsheets/d/1B7_1JDaoeSd9hbS_eizNOK00qoui1KnkG7tBZbbpYo4/edit?usp=sharing\" rel=\"nofollow noreferrer\">docs.google.com/spreadsheets/d/&hellip;</a>"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1558472226, "post_id": 56246187, "comment_id": 99110932, "body": "The <code>.Pattern = &quot;&#47;^(\\d{3})(\\d{3})(\\d{4})$&#47;&quot;</code> won&#39;t work in Excel VBA because the regex delimiters (together with anchors) will prevent strings from matching."}, {"owner": {"reputation": 31, "user_id": 8358849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783c974493b95f5dbf3fd50a6827d66f?s=128&d=identicon&r=PG&f=1", "display_name": "NKI", "link": "https://stackoverflow.com/users/8358849/nki"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1558472591, "post_id": 56246187, "comment_id": 99111075, "body": "@WiktorStribi\u017cew you are correct. It&#39;s actually .Pattern = &quot;[0-9,\\-]{12}&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8358849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783c974493b95f5dbf3fd50a6827d66f?s=128&d=identicon&r=PG&f=1", "display_name": "NKI", "link": "https://stackoverflow.com/users/8358849/nki"}, "edited": false, "score": 2, "creation_date": 1558473211, "post_id": 56246426, "comment_id": 99111336, "body": "Wow. That was fast. I have been at this all day. Thank you very much. I am extremely grateful"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1558473319, "post_id": 56246426, "comment_id": 99111374, "body": "Feel like I commented a similar answer not too long ago. Love seeing how Sheets can do regex formulaically, much better than Excel."}, {"owner": {"reputation": 68102, "user_id": 5632629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pfxka.jpg?s=128&g=1", "display_name": "player0", "link": "https://stackoverflow.com/users/5632629/player0"}, "reply_to_user": {"reputation": 31, "user_id": 8358849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783c974493b95f5dbf3fd50a6827d66f?s=128&d=identicon&r=PG&f=1", "display_name": "NKI", "link": "https://stackoverflow.com/users/8358849/nki"}, "edited": false, "score": 0, "creation_date": 1558473443, "post_id": 56246426, "comment_id": 99111419, "body": "@NKI I added ArrayFormula variation"}, {"owner": {"reputation": 31, "user_id": 8358849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783c974493b95f5dbf3fd50a6827d66f?s=128&d=identicon&r=PG&f=1", "display_name": "NKI", "link": "https://stackoverflow.com/users/8358849/nki"}, "edited": false, "score": 0, "creation_date": 1558474591, "post_id": 56246426, "comment_id": 99111815, "body": "@player0 I just noticed that if the numbers are not exactly in this (123) 456-7890, it returns an empty cell. An example is cell D3 on the link. Is there anyway to also catch 123) 456-7860?"}, {"owner": {"reputation": 68102, "user_id": 5632629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pfxka.jpg?s=128&g=1", "display_name": "player0", "link": "https://stackoverflow.com/users/5632629/player0"}, "edited": false, "score": 1, "creation_date": 1558474975, "post_id": 56246426, "comment_id": 99111950, "body": "sure: <code>=ARRAYFORMULA(IFERROR(REGEXREPLACE(REGEXEXTRACT(SPLIT(A2:A, CHAR(10)),   &quot;(.*)\\(.T&quot;),&quot;\\(|\\)|\\s|\\-&quot;, &quot;&quot;)))</code>"}, {"owner": {"reputation": 31, "user_id": 8358849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783c974493b95f5dbf3fd50a6827d66f?s=128&d=identicon&r=PG&f=1", "display_name": "NKI", "link": "https://stackoverflow.com/users/8358849/nki"}, "edited": false, "score": 0, "creation_date": 1558475948, "post_id": 56246426, "comment_id": 99112195, "body": "@player0 Thanks for update. One last thing. If the cell only contains (123) 456-7890 and nothing else. It returns an empty cell."}, {"owner": {"reputation": 31, "user_id": 8358849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783c974493b95f5dbf3fd50a6827d66f?s=128&d=identicon&r=PG&f=1", "display_name": "NKI", "link": "https://stackoverflow.com/users/8358849/nki"}, "edited": false, "score": 0, "creation_date": 1558476131, "post_id": 56246426, "comment_id": 99112226, "body": "@player0 Also, can you explain briefing what is going in the formula? I want to understand how it works."}, {"owner": {"reputation": 68102, "user_id": 5632629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pfxka.jpg?s=128&g=1", "display_name": "player0", "link": "https://stackoverflow.com/users/5632629/player0"}, "edited": false, "score": 1, "creation_date": 1558478257, "post_id": 56246426, "comment_id": 99112704, "body": "I made better one: <code>=ARRAYFORMULA(IFERROR(REGEXEXTRACT(TO_TEXT(SPLIT(  REGEXREPLACE(A2:A, &quot;\\(|\\)|\\-| &quot;, &quot;&quot;), CHAR(10))), &quot;\\d+&quot;)))</code>"}, {"owner": {"reputation": 68102, "user_id": 5632629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pfxka.jpg?s=128&g=1", "display_name": "player0", "link": "https://stackoverflow.com/users/5632629/player0"}, "edited": false, "score": 0, "creation_date": 1558478525, "post_id": 56246426, "comment_id": 99112758, "body": "and it means: delete <code>(</code>,  <code>)</code>,  <code>-</code>, <code>-empty space-</code> from A2:A then split by char(10) eg every new line, then regexextract the number from each string and omit all errors with iferror"}, {"owner": {"reputation": 68102, "user_id": 5632629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pfxka.jpg?s=128&g=1", "display_name": "player0", "link": "https://stackoverflow.com/users/5632629/player0"}, "reply_to_user": {"reputation": 537, "user_id": 8631622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8c3c8025900b42d95e64cd0d1518ee?s=128&d=identicon&r=PG&f=1", "display_name": "Pie", "link": "https://stackoverflow.com/users/8631622/pie"}, "edited": false, "score": 0, "creation_date": 1558511796, "post_id": 56246426, "comment_id": 99121267, "body": "@Pie I wish I could, but don&#39;t have the knowledge to solve it. sry"}], "tags": [], "owner": {"reputation": 68102, "user_id": 5632629, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Pfxka.jpg?s=128&g=1", "display_name": "player0", "link": "https://stackoverflow.com/users/5632629/player0"}, "is_accepted": true, "score": 3, "last_activity_date": 1558478205, "last_edit_date": 1558478205, "creation_date": 1558473096, "answer_id": 56246426, "question_id": 56246187, "link": "https://stackoverflow.com/questions/56246187/how-to-extract-phone-number-and-split-to-column-in-google-sheet/56246426#56246426", "title": "How to extract phone number and split to column in Google sheet?", "body": "<pre><code>=ARRAYFORMULA(IFERROR(REGEXEXTRACT(TO_TEXT(SPLIT(\n REGEXREPLACE(A2:A, \"\\(|\\)|\\-| \", \"\"), CHAR(10))), \"\\d+\")))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/WGxae.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WGxae.png\" alt=\"\"></a></p>\n\n<hr>\n\n<p>or:</p>\n\n<pre><code>=ARRAYFORMULA(REGEXREPLACE(REGEXEXTRACT(SPLIT(A2, CHAR(10)), \n \"\\((.*)\\(.T\"),\"\\)|\\s|\\-\", \"\"))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pNEpU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pNEpU.png\" alt=\"0\"></a></p>\n\n<p>true array formula would be:</p>\n\n<pre><code>=ARRAYFORMULA(IFERROR(REGEXREPLACE(REGEXEXTRACT(SPLIT(A2:A, CHAR(10)), \n \"\\((.*)\\(.T\"),\"\\)|\\s|\\-\", \"\")))\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8358849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/783c974493b95f5dbf3fd50a6827d66f?s=128&d=identicon&r=PG&f=1", "display_name": "NKI", "link": "https://stackoverflow.com/users/8358849/nki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 56246426, "answer_count": 1, "score": 2, "last_activity_date": 1558478205, "creation_date": 1558471863, "last_edit_date": 1558473535, "question_id": 56246187, "link": "https://stackoverflow.com/questions/56246187/how-to-extract-phone-number-and-split-to-column-in-google-sheet", "title": "How to extract phone number and split to column in Google sheet?", "body": "<p>I am trying to extract phone numbers in this format (123) 456-7890 and put each number in a separate column with format 1234567890 with no space, dash or parenthesis. </p>\n\n<p>I am able to achieve this in Excel using VBA code below from another StackOverflow question, but not able to get it working on Google sheet</p>\n\n<pre><code>\nSub ewqre()\n    Dim str As String, n As Long, rw As Long\n    Dim rgx As Object, cmat As Object, ws As Worksheet\n\n    Set rgx = CreateObject(\"VBScript.RegExp\")\n    Set ws = Worksheets(\"Sheet4\")\n\n    With rgx\n        .Global = True\n        .MultiLine = True\n        'phone number pattern is: ###-###-####\n        .Pattern = \"/^(\\d{3})(\\d{3})(\\d{4})$/\"\n        For rw = 2 To ws.Cells(Rows.Count, \"A\").End(xlUp).Row\n            str = ws.Cells(rw, \"A\").Value2\n            If .Test(str) Then\n                Set cmat = .Execute(str)\n                'populate the worksheet with the matches\n                For n = 0 To cmat.Count - 1\n                    ws.Cells(rw, Columns.Count).End(xlToLeft).Offset(0, 1) = cmat.Item(n)\n                Next n\n            End If\n        Next rw\n    End With\n\n    Set rgx = Nothing: Set ws = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 2, "creation_date": 1558483098, "post_id": 56246158, "comment_id": 99113643, "body": "Just an advise, instead of redact a screen clip, replace with some generic text and paste here (or share from cloud storage) so people can test with it (just 1 example is enough). Don&#39;t expect people to type those XML! Also why is it Click event of ComboBox?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 2, "creation_date": 1558485550, "post_id": 56246158, "comment_id": 99114025, "body": "If you wanted to output specific values from the FlexStatement then you would need to select the values you want by calling <code>selectSingleNode</code> or <code>selectNodes</code> on <code>singleNode</code> and then outputting those values to a range on the worksheet. Also, <code>Set XDoc = CreateObject(&quot;MSXML2.DOMDocument&quot;)</code> should be <code>Set XDoc = CreateObject(&quot;MSXML2.DOMDocument.6.0&quot;)</code> to ensure you are using the most up to date version"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1558544748, "post_id": 56246158, "comment_id": 99140113, "body": "a) Even if your set SingleNode <code>Not Is Nothing</code> (i.e. a <code>FlexStatement</code> node exists), it&#39;s necessary to describe which subnode informations you want to write to sheet showing us a minimal structure or XPath and some example contents. - Maybe you would like to study how to <a href=\"https://stackoverflow.com/questions/51887820/obtain-attribute-names-from-xml-using-vba/51919182#51919182\">display XML structures including attributes</a> first.  b) It&#39;s easy to get the combobox value via its zero-based <code>.ListIndex</code> property and to integrate it into your <b>XPath</b> via the <code>&amp;</code> operator to connect string parts."}], "answers": [{"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1558560761, "creation_date": 1558560761, "answer_id": 56265298, "question_id": 56246158, "link": "https://stackoverflow.com/questions/56246158/how-to-use-combobox-to-extract-information-form-xml-file/56265298#56265298", "title": "How to use ComboBox to extract information form XML file?", "body": "<p>Consider several adjustments:</p>\n\n<ol>\n<li><p>Use the <em>AfterUpdate</em> trigger event of combobox.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub ComboBox1_AfterUpdate()\n    ...\nEnd Sub\n</code></pre></li>\n<li><p>Simply concatenate the combobox value <code>Me.ComboBox1</code> to XPath expression.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>XDoc.SelectSingleNode(\"/FlexQueryResponse/FlexStatements/FlexStatement[@accountId='\" &amp; Me.ComboBox1 &amp; \"']\")\n</code></pre></li>\n<li><p>Select the needed attribute value or loop through multiple by node for extraction to sheet.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub ComboBox1_AfterUpdate()\n    ' Load the XML document\n    Dim XDoc As Object, root As Object, singleNode As Object\n    Dim i As Integer\n\n    Set XDoc = CreateObject(\"MSXML2.DOMDocument\")\n\n    XDoc.async = False: XDoc.validateOnParse = False\n    XDoc.Load (\"C:\\Users\\isabelle\\Google Drive\\IB API Integration\\Flexqueries\\FlexDay.xml\")\n\n    ' OUTPUT ONE ATTRIBUTE OF NODE\n    Set singleNode = XDoc.SelectSingleNode(\"/FlexQueryResponse/FlexStatements/FlexStatement[@accountId='\" &amp; Me.ComboBox1 &amp; \"']\")\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\") =  singleNode.Attributes.getNamedItem(\"accountId\").Text\n\n    ' OUTPUT ALL ATTRIBUTES OF NODE\n    For i = 0 To singleNode.Attributes.Length - 1\n         ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A\" &amp; i + 1) = singleNode.Attributes(i).Name\n         ThisWorkbook.Worksheets(\"Sheet1\").Range(\"B\" &amp; i + 1) = singleNode.Attributes(i).Text\n    Next i\n\n    Set XDoc = Nothing\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/01xmK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/01xmK.png\" alt=\"Excel Output\"></a></p></li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 11535945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/981528cf3b259b4697a1a7252026b27b?s=128&d=identicon&r=PG&f=1", "display_name": "IsabelleBoruet", "link": "https://stackoverflow.com/users/11535945/isabelleboruet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 56265298, "answer_count": 1, "score": 1, "last_activity_date": 1558560761, "creation_date": 1558471744, "last_edit_date": 1558558458, "question_id": 56246158, "link": "https://stackoverflow.com/questions/56246158/how-to-use-combobox-to-extract-information-form-xml-file", "title": "How to use ComboBox to extract information form XML file?", "body": "<p>I have a XML file that contain a lot of information. \nSo, I would like to create a macro in VBA Excel that allow me to filter the information based on the <em>accountID</em> (available form an Userform - ComboBox) </p>\n\n<p>It's the first time I work with XML and userform.</p>\n\n<p>I've tried to adjust multiple code that I found on the net, but i understand better this one so I would like to continue with something similar (if possible): </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub ComboBox1_Click()\n    Dim wks As Worksheet\n    Set wks = Sheet2\n\n    ' Load the XML document\n    Dim XDoc As Object, root As Object\n    Set XDoc = CreateObject(\"MSXML2.DOMDocument\")\n    XDoc.async = False: XDoc.validateOnParse = False\n    XDoc.Load (\"C:\\Users\\isabelle\\Google Drive\\IB API Integration\\Flexqueries\\FlexDay.xml\") \n\n    Dim singleNode As Object\n    Set singleNode = XDoc.SelectSingleNode(\"//FlexQueryResponse/FlexStatements/FlexStatement[@accountId='U2396623']\")\n\nEnd Sub\n</code></pre>\n\n<p>The accountId 'U2396623' is only an example. This will correspond to the entry in the combobox.</p>\n\n<p>My two problems are : </p>\n\n<ol>\n<li><p>First, I don't know how to link the entry in the combobox to the code (based on the accountID) </p></li>\n<li><p>Second, code above does not work. I think the path (<code>XDoc.SelectSingleNode</code>) is not the right one... So, I tied several combination and it never worked. Or maybe it's the output that does not work correctly (The output should be in the <em>Sheet2</em> )</p></li>\n</ol>\n\n<p>My XML file looks like it : </p>\n\n<pre><code>&lt;FlexQueryResponse queryName=\"Sample_1\" type=\"AF\"&gt;\n   &lt;FlexStatements count=\"10\"&gt;\n      &lt;FlexStatement accountId=\"\" fromDate=\"2019-04-22\" toDate=\"2019-05-21\" period=\"Last30CalendarDays\" whenGenerated=\"2019-05-22;13:49:30\"&gt;\n         &lt;AccountInformation accountId=\"\" acctAlias=\"\" currency=\"CAD\" accountType=\"Advisor Client\" dateOpened=\"2018-02-08\" dateFunded=\"2018-03-01\" dateClosed=\"\" street=\"\" street2=\"\" city=\"\" state=\"\" country=\"\" postalCode=\"\" primaryEmail=\"\" /&gt;\n         &lt;ChangeInNAV accountId=\"\" acctAlias=\"\" startingValue=\"\" endingValue=\"\" realized=\"0\" changeInUnrealized=\"0\" depositsWithdrawals=\"0\" twr=\"\" mtm=\"\" dividends=\"\" changeInDividendAccruals=\"\" interest=\"\" changeInInterestAccruals=\"\" advisorFees=\"\" clientFees=\"0\" otherFees=\"0\" /&gt;\n         &lt;CashReport&gt;\n            &lt;CashReportCurrency accountId=\"\" acctAlias=\"\" clientFees=\"0\" commissions=\"\" deposits=\"0\" withdrawals=\"0\" accountTransfers=\"0\" dividends=\"\" advisorFees=\"\" otherFees=\"0\" currency=\"BASE_SUMMARY\" startingCash=\"\" endingCash=\"\" endingSettledCash=\"\" /&gt;\n            /&amp;gt;\n         &lt;/CashReport&gt;\n         &lt;OpenPositions&gt;\n            &lt;OpenPosition accountId=\"\" acctAlias=\"\" symbol=\"\" position=\"\" costBasisPrice=\"\" strike=\"\" expiry=\"\" putCall=\"\" positionValue=\"\" percentOfNAV=\"\" fifoPnlUnrealized=\"\" currency=\"CAD\" fxRateToBase=\"1\" assetCategory=\"STK\" description=\"BOMBARDIER INC PFD SER 2\" securityID=\"CA0977515075\" cusip=\"\" isin=\"CA0977515075\" /&gt;\n         &lt;/OpenPositions&gt;\n         &lt;FxPositions&gt;\n            &lt;FxPosition accountId=\"\" fxCurrency=\"CAD\" quantity=\"\" costPrice=\"\" unrealizedPL=\"0\" /&gt;\n         &lt;/FxPositions&gt;\n         &lt;OptionEAE&gt;\n            &lt;OptionEAE accountId=\"\" acctAlias=\"\" currency=\"USD\" assetCategory=\"\" symbol=\"\" description=\"\" securityID=\"\" cusip=\"\" isin=\"\" listingExchange=\"\" underlyingConid=\"\" underlyingSymbol=\"FCAU\" underlyingSecurityID=\"NL0010877643\" underlyingListingExchange=\"NYSE\" issuer=\"\" strike=\"16\" expiry=\"2019-05-03\" putCall=\"C\" date=\"2019-04-22\" transactionType=\"Assignment\" quantity=\"2\" tradePrice=\"0.0000\" markPrice=\"0.3500\" realizedPnl=\"0.00\" /&gt;\n         &lt;/OptionEAE&gt;\n         &lt;PendingExcercises /&gt;\n         &lt;ClientFees /&gt;\n         &lt;OpenDividendAccruals&gt;\n            &lt;OpenDividendAccrual accountId=\"\" acctAlias=\"\" currency=\"\" assetCategory=\"\" symbol=\"\" description=\"\" securityID=\"\" cusip=\"\" isin=\"\" exDate=\"2019-05-03\" payDate=\"2019-06-24\" quantity=\"400\" grossRate=\"0.23\" grossAmount=\"92\" netAmount=\"92\" /&gt;\n         &lt;/OpenDividendAccruals&gt;\n      &lt;/FlexStatement&gt;\n   &lt;/FlexStatements&gt;\n&lt;/FlexQueryResponse&gt;\n</code></pre>\n\n<p>If you have any question don't hesitate ! </p>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["vba", "performance"], "comments": [{"owner": {"reputation": 7749, "user_id": 4046632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e6a87a176719c607a2a73ce6728d88?s=128&d=identicon&r=PG&f=1", "display_name": "buran", "link": "https://stackoverflow.com/users/4046632/buran"}, "edited": false, "score": 2, "creation_date": 1558472047, "post_id": 56246138, "comment_id": 99110858, "body": "simple VLOOKUP formula will do here"}, {"owner": {"reputation": 3, "user_id": 11035217, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5eRghNnmKzo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMRNEuLDtOB79vl7GcLNzj3b8tQ7g/mo/photo.jpg?sz=128", "display_name": "Davide Tarsitano", "link": "https://stackoverflow.com/users/11035217/davide-tarsitano"}, "reply_to_user": {"reputation": 7749, "user_id": 4046632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e6a87a176719c607a2a73ce6728d88?s=128&d=identicon&r=PG&f=1", "display_name": "buran", "link": "https://stackoverflow.com/users/4046632/buran"}, "edited": false, "score": 0, "creation_date": 1558472264, "post_id": 56246138, "comment_id": 99110946, "body": "Do you mean in the vba code? I need to do this in VBA. I cannot use a normal formula in the cell in this case"}, {"owner": {"reputation": 7749, "user_id": 4046632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e6a87a176719c607a2a73ce6728d88?s=128&d=identicon&r=PG&f=1", "display_name": "buran", "link": "https://stackoverflow.com/users/4046632/buran"}, "edited": false, "score": 0, "creation_date": 1558472374, "post_id": 56246138, "comment_id": 99110995, "body": "yes, you can do this also in VBA - put VLOOKUP formula in the respective cell. Don&#39;t forget to turn off auto calculations before populating and enable at the end. Same for screen updating"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1558472334, "creation_date": 1558472334, "answer_id": 56246280, "question_id": 56246138, "link": "https://stackoverflow.com/questions/56246138/how-do-i-speed-up-a-double-for-loop-with-if-in-the-inner-loop-in-vba/56246280#56246280", "title": "How do I speed up a double for loop with if in the inner loop in vba?", "body": "<p>Use Variant arrays</p>\n\n<pre><code>Sheets(\"Q1\").Visible = True\n\nWith Worksheets(\"Complete Car\")\n    Dim vlue() As Variant\n    vlue = .Range(.Cells(4, 2), .Cells(3000, 2))\n\n    Dim out() As Variant\n    ReDim out(1 To UBound(vlue, 1), 1 To 1)\nEnd With\n\nWith Worksheets(\"Q1\")\n    Dim lkup() As Variant\n    lkup = .Range(.Cells(2, 21), .Cells(1500, 30))\nEnd With\n\nDim i As Long\nFor i = LBound(vlue, 1) To UBound(vlue, 1)\n    Dim j As Long\n    For j = LBound(lkup, 1) To UBound(lkup, 1)\n        If vlue(i, 1) = lkup(j, 1) Then\n            out(i, 1) = lkup(j, 10)\n            Exit For\n        End If\n    Next j\nNext i\n\nWorksheets(\"Complete Car\").Cells(4, 32).Resize(UBound(out, 1), UBound(out, 2)).Value = out\n\nSheets(\"Q1\").Visible = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 1, "last_activity_date": 1558472413, "creation_date": 1558472413, "answer_id": 56246302, "question_id": 56246138, "link": "https://stackoverflow.com/questions/56246138/how-do-i-speed-up-a-double-for-loop-with-if-in-the-inner-loop-in-vba/56246302#56246302", "title": "How do I speed up a double for loop with if in the inner loop in vba?", "body": "<p>Even though this is a question for code review, here is an answer using dictionaries and arrays:</p>\n\n<pre><code>Option Explicit\nSub PopulateData()\n\n    Dim arrCompleteCar As Variant, arrQ1 As Variant\n    Dim i As Integer, j As Integer\n    Dim Matches As New Scripting.Dictionary 'You will need the library Microsoft Scripting Runtime\n\n    Application.ScreenUpdating = False 'speed up the code since excel won't show you what is happening\n\n    'First of all, working on arrays always speeds up a lot the code because you are working on memory\n    'instead of working with the sheets\n    With ThisWorkbook\n        arrCompleteCar = .Sheets(\"Complete_Car\").UsedRange.Value 'this will throw your entire sheet into one 2D array\n        arrQ1 = .Sheets(\"Q1\").UsedRange.Value\n    End With\n\n    'Then we create a dictionary with the data on worksheet Q1\n    For i = 2 To UBound(arrQ1) 'from row 2 to the last on Q1 (the highest)\n        If arrQ1(i, 21) = vbNullString Then Exit For 'this is to avoid looping through blank cells\n        If Not Matches.Exists(arrQ1(i, 21)) Then 'this is to avoid duplicates\n            Matches.Add arrQ1(i, 21), arrQ1(i, 30) 'we add the matching value with the one to replace\n        End If\n    Next i\n\n    arrQ1 = Nothing 'empty the Q1 array since it's useless now\n\n    'Now we loop the Complete Car worksheet\n    For i = 4 To UBound(arrCompleteCar)\n        'in case we find a match, we replace the column 32 with the column 30 from Q1\n        If Matches.Exists(arrCompleteCar(i, 2)) Then arrCompleteCar(i, 32) = Matches(arrCompleteCar(i, 2))\n    Next i\n\n    ThisWorkbook.Sheets(\"Complete_Car\").UsedRange.Value = arrCompleteCar 'we paste the array back to the sheet\n\n    arrCompleteCar = Nothing\n    Matches.RemoveAll\n\n    Application.ScreenUpdating = True 'return excel to normal\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7749, "user_id": 4046632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e6a87a176719c607a2a73ce6728d88?s=128&d=identicon&r=PG&f=1", "display_name": "buran", "link": "https://stackoverflow.com/users/4046632/buran"}, "is_accepted": false, "score": 0, "last_activity_date": 1558473793, "creation_date": 1558473793, "answer_id": 56246540, "question_id": 56246138, "link": "https://stackoverflow.com/questions/56246138/how-do-i-speed-up-a-double-for-loop-with-if-in-the-inner-loop-in-vba/56246540#56246540", "title": "How do I speed up a double for loop with if in the inner loop in vba?", "body": "<pre><code>Sub PopulateData()\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n    End With\n\n    Worksheets(\"Complete Car\").Range(\"AF4:AF3000\").FormulaR1C1 = \"=VLOOKUP('Complete Car'!RC2,Q1!R2C21:R1500C30,10,FALSE)\"\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n    End With\n\n    ' Convert formulas to values\n    With Worksheets(\"Complete Car\").Range(\"AF4:AF3000\")\n        .Value = .Value\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11035217, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5eRghNnmKzo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMRNEuLDtOB79vl7GcLNzj3b8tQ7g/mo/photo.jpg?sz=128", "display_name": "Davide Tarsitano", "link": "https://stackoverflow.com/users/11035217/davide-tarsitano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1558473793, "creation_date": 1558471682, "last_edit_date": 1558471719, "question_id": 56246138, "link": "https://stackoverflow.com/questions/56246138/how-do-i-speed-up-a-double-for-loop-with-if-in-the-inner-loop-in-vba", "title": "How do I speed up a double for loop with if in the inner loop in vba?", "body": "<p>I've written this code to search a match in a column of sheet \"q1\" with the elements of another column in sheet \"Complete Car\". Since I have 3000 rows to check in Complete Car and 1500 in q1 (inner loop), is there any suggestion on how to write this more efficiently? </p>\n\n<p>Code is below:</p>\n\n<pre><code>Sub PopulateData()\n\n Sheets(\"Q1\").Visible = True\n\n  Dim i As Integer\n  Dim j As Integer\n\n  For i = 4 To 3000\n\n        For j = 2 To 1500\n\n\n        If Worksheets(\"Complete Car\").Cells(i, 2) = Worksheets(\"Q1\").Cells(j, 21) Then\n\n           Worksheets(\"Complete Car\").Cells(i, 32) = Worksheets(\"Q1\").Cells(j, 30)\n\n           End If\n\n        Next j\n\n  Next i\n\n\n  Sheets(\"Q1\").Visible = False\n</code></pre>\n"}, {"tags": ["excel", "vba", "errorbar", "pivot-chart"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1558470502, "post_id": 56245636, "comment_id": 99110250, "body": "Well, there are many ways to put in error bars... some chart styles have them by default, in other cases you can add error bars via VBA.  We would need more info about <i>how</i> you generate to aid in finding an <b>objective</b> solution to your issue, rather than the current question which may have a multitude of answers."}, {"owner": {"reputation": 13, "user_id": 11505595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157716833894131/picture?type=large", "display_name": "Vincent-Daniel Girard", "link": "https://stackoverflow.com/users/11505595/vincent-daniel-girard"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1558529241, "post_id": 56245636, "comment_id": 99130781, "body": "Perfect, I&#39;ll edit my question to put a concise example"}], "owner": {"reputation": 13, "user_id": 11505595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157716833894131/picture?type=large", "display_name": "Vincent-Daniel Girard", "link": "https://stackoverflow.com/users/11505595/vincent-daniel-girard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1558531033, "creation_date": 1558469121, "last_edit_date": 1558531033, "question_id": 56245636, "link": "https://stackoverflow.com/questions/56245636/is-there-a-way-to-automatically-or-programmatically-insert-dynamic-errorbars-in", "title": "Is there a way to automatically or programmatically insert dynamic errorbars in a pivot-chart in Excel?", "body": "<p>I have a <strong>pivot-chart</strong> that uses averages to plot each of my grouped points. I'd like to add errorbars, but Excel doesn't seem to support <strong>automatic errorbar generation</strong> (or does it?). </p>\n\n<p>Should I just generate a standard graph / pivot-chart all in VBA to include this capability? I'd be losing most of the nice slicer features (if the standard chart is the solution) and it makes me sad...</p>\n\n<p>EDIT: Let's look at an example!</p>\n\n<p>Here is a picture of a pivot-chart I made using data from a table in another sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dqLGR.png\" rel=\"nofollow noreferrer\">Example</a></p>\n\n<p><strong>I'd like to add errorbars that are automatically calculated form the standard deviation of the mean.</strong> But since a new mean is calculted each time I filter my pivot for a specific combination of filtered fields, then I can't just add errorbars manually each time I change the filtering of my data! </p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1558469542, "post_id": 56245385, "comment_id": 99109856, "body": "Can you show the behavior by adding an image using \u201cScreen to Gif\u201d? Would help."}, {"owner": {"reputation": 9, "user_id": 11504773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22783af83260867abcfb7b8f82cfc85f?s=128&d=identicon&r=PG&f=1", "display_name": "Veri", "link": "https://stackoverflow.com/users/11504773/veri"}, "reply_to_user": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1558473275, "post_id": 56245385, "comment_id": 99111358, "body": "@Skin I added a GIF for clarification. Thank you for the tip!"}, {"owner": {"reputation": 1, "user_id": 13110056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5d676b025082de806b312a49beda800?s=128&d=identicon&r=PG&f=1", "display_name": "Pietruch", "link": "https://stackoverflow.com/users/13110056/pietruch"}, "edited": false, "score": 0, "creation_date": 1584972385, "post_id": 56245385, "comment_id": 107600509, "body": "I use the same code and it worked for me perfectly until some update of Office 365... :( It still works fine on Excel 2010 when I checked it on other computer. That update also broke &#39;search as you type&#39; functionality in my ComboBox."}], "owner": {"reputation": 9, "user_id": 11504773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22783af83260867abcfb7b8f82cfc85f?s=128&d=identicon&r=PG&f=1", "display_name": "Veri", "link": "https://stackoverflow.com/users/11504773/veri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1584972385, "creation_date": 1558467816, "last_edit_date": 1558473215, "question_id": 56245385, "link": "https://stackoverflow.com/questions/56245385/userform-combobox-with-searchable-list-to-not-select-first-item-with-keydown", "title": "UserForm ComboBox with searchable list to not select first item with keyDown", "body": "<p><strong>Background</strong></p>\n\n<p>I have a UserForm with a ComboBox (<code>ComboBox1</code>) that includes a searchable list (thanks to the code). However, when I use the down button, it just selects the first item and gets rid of the rest of the list that was there first (like as if basically puts the first item as the searched name).</p>\n\n<p>I have found a very similar question on stack overflow but the solution did not fully work for me.</p>\n\n<p>Here is the link: <a href=\"https://stackoverflow.com/questions/26931436/how-use-the-combobox-keydown-event-without-selecting-the-listed-item\">How use the combobox keydown event without selecting the listed item</a></p>\n\n<p>The code that I have for my UserForm is below:</p>\n\n<pre><code>Dim a()\n\nPrivate Sub CommandButton2_Click()\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n  a = [Liste].Value\n  Me.ComboBox1.List = a\nEnd Sub\nPrivate Sub ComboBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\nDim Abort As Boolean\n    Select Case KeyCode\n        Case 38  'Up\n            If ComboBox1.ListIndex &lt;= 0 Then KeyCode = 0 'ignore \"Up\" press if already on the first selection, or if not on a selection\n            Abort = True\n            If Not KeyCode = 0 Then ' If on a selection past the first entry\n                KeyCode = 0\n            'Manually choose next entry, cancel key press\n                ComboBox1.ListIndex = ComboBox.ListIndex - 1\n            End If\n            Me.ComboBox1.DropDown\n        Case 40 'Down\n            If ComboBox1.ListIndex = ComboBox1.ListCount - 1 Then KeyCode = 0\n        ' This method was from the discussion I linked, prevents \"falling off the bottom of the list\"\n            Abort = True\n            If Not KeyCode = 0 Then ' If on a selection before the last entry\n                KeyCode = 0\n            'Manually choose next entry, cancel key press\n                ComboBox1.ListIndex = ComboBox1.ListIndex + 1\n            End If\n            Me.ComboBox1.DropDown\n    End Select\n    Abort = False\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\nIf Abort Then Exit Sub ' Stop Event code if flag set\n    Abort = True\n    ' sets the flag until finished with commands to prevent changes made by code triggering the event multiple times\nSet d1 = CreateObject(\"Scripting.Dictionary\")\n    tmp = UCase(Me.ComboBox1) &amp; \"*\"\n    For Each c In a\n        If UCase(c) Like tmp Then d1(c) = \"\"\n    Next c\n    Me.ComboBox1.List = d1.keys\n    Me.ComboBox1.DropDown\nAbort = False\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n  ActiveCell = Me.ComboBox1\n  Unload Me\nEnd Sub\n\nPrivate Sub cmdClose_Click()\n  Unload Me\nEnd Sub\n</code></pre>\n\n<p>The particular section that is apparently trying to stop the comboBox from selecting the first item is this:</p>\n\n<pre><code>Private Sub ComboBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\nDim Abort As Boolean\n    Select Case KeyCode\n        Case 38  'Up\n            If ComboBox1.ListIndex &lt;= 0 Then KeyCode = 0 'ignore \"Up\" press if already on the first selection, or if not on a selection\n            Abort = True\n            If Not KeyCode = 0 Then ' If on a selection past the first entry\n                KeyCode = 0\n            'Manually choose next entry, cancel key press\n                ComboBox1.ListIndex = ComboBox.ListIndex - 1\n            End If\n            Me.ComboBox1.DropDown\n        Case 40 'Down\n            If ComboBox1.ListIndex = ComboBox1.ListCount - 1 Then KeyCode = 0\n        ' This method was from the discussion I linked, prevents \"falling off the bottom of the list\"\n            Abort = True\n            If Not KeyCode = 0 Then ' If on a selection before the last entry\n                KeyCode = 0\n            'Manually choose next entry, cancel key press\n                ComboBox1.ListIndex = ComboBox1.ListIndex + 1\n            End If\n            Me.ComboBox1.DropDown\n    End Select\n    Abort = False\nEnd Sub\n</code></pre>\n\n<p>However, when I enter something (Let's say I enter \"App\" to find \"Applesauce\" and the dropdown list shows both \"Apple\" and \"Applesauce\") and click the down button, it just goes to the first item and does not move anymore. The list does not disappear but it just gets stuck on the first item.</p>\n\n<p><em>Does anyone have any idea what I need to change in my code to make it work? (Or any other ideas on how to make it work in general)?</em></p>\n\n<p>GIF for clarification:\n<a href=\"https://i.stack.imgur.com/9X0Hr.gif\" rel=\"nofollow noreferrer\">KeyDown not moving beyong first item</a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1558468860, "post_id": 56245501, "comment_id": 99109578, "body": "The formula produced is <code>=SUM(L:L3)</code> also getting a <code>type mismatch</code> error when it loops to next row. Error on line 7 of your code."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1558468980, "post_id": 56245501, "comment_id": 99109631, "body": "Try adding j = 1 before the loop. I assumed you had blank lines above your data as in your screencap"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": true, "score": 1, "last_activity_date": 1558468405, "creation_date": 1558468405, "answer_id": 56245501, "question_id": 56245359, "link": "https://stackoverflow.com/questions/56245359/dynamic-first-and-last-row-of-a-range/56245501#56245501", "title": "Dynamic first and last row of a range", "body": "<p>You can loop through the column like this:</p>\n\n<pre><code>For i = 2 To mySheet.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n    If Range(\"B\" &amp; i).Value &lt;&gt; vbNullString Then\n        If Range(\"B\" &amp; i - 1).Value = vbNullString Then\n            j = i\n        End If\n    Else\n        If Range(\"B\" &amp; i - 1).Value &lt;&gt; vbNullString And Range(\"B\" &amp; i - 1).Formula &lt;&gt; \"=SUM(B\" &amp; j &amp; \":B\" &amp; i - 2 &amp; \")\" Then\n            Range(\"B\" &amp; i).Formula = \"=SUM(B\" &amp; j &amp; \":B\" &amp; i - 1 &amp; \")\"\n        End If\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1558469368, "creation_date": 1558469368, "answer_id": 56245689, "question_id": 56245359, "link": "https://stackoverflow.com/questions/56245359/dynamic-first-and-last-row-of-a-range/56245689#56245689", "title": "Dynamic first and last row of a range", "body": "<p>This uses Match to skip chunks and as such the number or loops are less</p>\n\n<pre><code>With ActiveSheet\n    Dim b As Long\n    b = 2\n\n    Do Until b = .Rows.Count\n\n        Dim x As Variant\n        x = .Evaluate(\"Match(True, Index(\" &amp; .Range(.Cells(b, \"l\"), .Cells(.Rows.Count, \"l\")).Address &amp; \" &lt;&gt; \"\"\"\",),0)\")\n        If Not IsError(x) Then\n            b = b + x - 1\n        Else\n            Exit Sub\n        End If\n\n        x = .Evaluate(\"Match(True, Index(\" &amp; .Range(.Cells(b, \"l\"), .Cells(.Rows.Count, \"l\")).Address &amp; \" = \"\"\"\",),0)\")\n        Dim i As Long\n        i = b + x - 1\n\n        .Cells(i, \"l\").Formula = \"=sum(L\" &amp; b &amp; \":L\" &amp; i - 1 &amp; \")\"\n\n        b = i + 2\n     Loop\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 56245501, "answer_count": 2, "score": 0, "last_activity_date": 1558493835, "creation_date": 1558467685, "last_edit_date": 1558493835, "question_id": 56245359, "link": "https://stackoverflow.com/questions/56245359/dynamic-first-and-last-row-of-a-range", "title": "Dynamic first and last row of a range", "body": "<p>I am surprised there's no answer for this. I have read <a href=\"https://stackoverflow.com/questions/43376174/setting-dynamic-ranges-in-vba\">Setting Dynamic Ranges in VBA</a> and <a href=\"https://stackoverflow.com/questions/39412060/selecting-dynamic-range?rq=1\">Selecting Dynamic Range</a> and <a href=\"https://stackoverflow.com/questions/10753925/autofill-dynamic-range-last-row-and-last-column\">Autofill Dynamic Range Last Row and Last Column</a> and <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/e626eba2-8019-48e9-9827-3d98a3ad64f9/excel-vba-select-range-dynamically?forum=exceldev\" rel=\"nofollow noreferrer\">MSDN</a></p>\n\n<p>I have multiple, distinct ranges on a sheet with varying sizes. I am trying to subtotal <code>column L</code>. I can do it using a hardcoded sum (via <code>subtotal</code> variable) but I want to insert a formula into the cell instead. This requires knowing the starting and end rows for each range. My code almost works. It fails when the range only consists of one row. Even so, I feel there's gotta be a smarter way to do this.</p>\n\n<p>How does one determine the start and end row of a range on a sheet filled with multiple ranges?</p>\n\n<pre><code>For i = 2 To j\n\n    If .Cells(i + 1, \"L\") = \"\" And .Cells(i + 2, \"L\") = \"\" Then\n        b = .Cells(i - 1, \"J\").End(xlUp).Row\n    End If\n\n    subtotal = subtotal + .Cells(i, \"L\").Value2\n    If .Cells(i, 1) = \"\" And .Cells(i - 1, \"B\") &lt;&gt; \"\" Then\n        If .Cells(i - 1, \"K\") = 0 Then\n            .Cells(i, \"K\").Value2 = \"Check Payment\"\n            'Set sumRng = .Range(.Cells(b, \"L\"), .Cells(i - 1, \"L\"))\n            .Cells(i, \"L\").Formula = \"=sum(L\" &amp; b &amp; \":L\" &amp; i - 1 &amp; \")\"\n            .Cells(i - 1, \"L\").Borders(xlEdgeBottom).LineStyle = xlContinuous\n            total = total + subtotal\n            subtotal = 0\n        ElseIf .Cells(i - 1, \"K\") = \"Checking\" Then\n            .Cells(i, \"K\").Value2 = \"EFT Payment\"\n            'Set sumRng = .Range(.Cells(b, \"L\"), .Cells(i - 1, \"L\"))\n            .Cells(i, \"L\").Formula = \"=sum(L\" &amp; b &amp; \":L\" &amp; i - 1 &amp; \")\"\n            .Cells(i - 1, \"L\").Borders(xlEdgeBottom).LineStyle = xlContinuous\n            total = total + subtotal\n            subtotal = 0\n        End If\n    End If\nNext\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/OjX3t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OjX3t.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access", "ms-access-forms"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "edited": false, "score": 0, "creation_date": 1558621691, "post_id": 56249517, "comment_id": 99169209, "body": "so intsead of Me, could I use something like Form!FormName!txtUserName.value ?  Do you understand what I mean?"}, {"owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "reply_to_user": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "edited": false, "score": 0, "creation_date": 1558670950, "post_id": 56249517, "comment_id": 99184646, "body": "Yes you can do that. Its <code>Forms!FormName!txtUserName.Value</code>"}], "tags": [], "owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "is_accepted": false, "score": 0, "last_activity_date": 1558500632, "creation_date": 1558500632, "answer_id": 56249517, "question_id": 56245326, "link": "https://stackoverflow.com/questions/56245326/custom-audit-trail-in-access-to-capture-login-details/56249517#56249517", "title": "Custom Audit Trail in Access to capture login details", "body": "<p>If you want to use the userName the user enters in your login form, just replace the <code>Environ(\"username\")</code> with the value of the textbox from your login form. Lets say the textbox in your login form is called <code>txtUserName</code> then just replace your code with this:</p>\n\n<pre><code>= &amp; cDQ &amp; Me!txtUserName.Value &amp; cDQ &amp; \", \"\n</code></pre>\n\n<p>The <code>Me!</code> refers to your form where your code gets executed (your login form).</p>\n"}], "owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594778977, "creation_date": 1558467517, "last_edit_date": 1594778977, "question_id": 56245326, "link": "https://stackoverflow.com/questions/56245326/custom-audit-trail-in-access-to-capture-login-details", "title": "Custom Audit Trail in Access to capture login details", "body": "<p>I have a login screen that I built in Access, I need the UserName (which is a column in table \"Employee\"), to be stored in \"Audit\" Table which I have built to store changes that take place in the DB. </p>\n\n<p>When I login from the custom login screen it should have the username captured in (tempvars maybe) and it should remain available till the user closes the program, i.e. during the session (logged in as lets say \"user_x\") and I also want this UserName to be captured in Audit table. </p>\n\n<p>I got a code from the internet to capture the changes that take place in the DB but it uses the Access login utility. I want to change it to capture login details from my custom login table once a user logs in.</p>\n\n<pre><code>Const cDQ As String = \"\"\"\"\nSub AuditTrail(frm As Form, recordid As Control)\n  'Track changes to data.\n  'recordid identifies the pk field's corresponding\n  'control in frm, in order to id record.\n  Dim ctl As Control\n  Dim varBefore As Variant\n  Dim varAfter As Variant\n  Dim strControlName As String\n  Dim strSQL As String\n  On Error GoTo ErrHandler\n  'Get changed values.\n  For Each ctl In frm.Controls\n    With ctl\n    'Avoid labels and other controls with Value property.\n    If .ControlType = acTextBox Then\n      If .Value  .OldValue Then\n        varBefore = .OldValue\n        varAfter = .Value\n        strControlName = .Name\n        'Build INSERT INTO statement.\n        strSQL = \"INSERT INTO \" _\n           &amp; \"Audit (EditDate, User, RecordID, SourceTable, \" _\n           &amp; \" SourceField, BeforeValue, AfterValue) \" _\n           &amp; \"VALUES (Now(),\" _\n           &amp; cDQ &amp; Environ(\"username\") &amp; cDQ &amp; \", \" _\n           &amp; cDQ &amp; recordid.Value &amp; cDQ &amp; \", \" _\n           &amp; cDQ &amp; frm.RecordSource &amp; cDQ &amp; \", \" _\n           &amp; cDQ &amp; .Name &amp; cDQ &amp; \", \" _\n           &amp; cDQ &amp; varBefore &amp; cDQ &amp; \", \" _\n           &amp; cDQ &amp; varAfter &amp; cDQ &amp; \")\"\n        'View evaluated statement in Immediate window.\n        Debug.Print strSQL\n        DoCmd.SetWarnings False\n        DoCmd.RunSQL strSQL\n        DoCmd.SetWarnings True\n      End If\n    End If\n    End With\n  Next\n  Set ctl = Nothing\n  Exit Sub\n\nErrHandler:\n  MsgBox Err.Description &amp; vbNewLine _\n   &amp; Err.Number, vbOKOnly, \"Error\"\nEnd Sub\n</code></pre>\n\n<p>Username to be captured in Audit Table once a user logs in using the login screen.</p>\n\n<p>What should I use in place of </p>\n\n<pre><code>&amp; cDQ &amp; Environ(\"username\") &amp; cDQ &amp; \", \" _\n</code></pre>\n\n<p>to capture my userName coming from a successful login action from the custom Login Screen that I built.</p>\n"}, {"tags": ["excel", "vba", "macos"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 11554202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0765c64543d5efae5fb5132eb96364f?s=128&d=identicon&r=PG&f=1", "display_name": "iincitr", "link": "https://stackoverflow.com/users/11554202/iincitr"}, "is_accepted": false, "score": 0, "last_activity_date": 1586680508, "creation_date": 1586680508, "answer_id": 61168780, "question_id": 56245200, "link": "https://stackoverflow.com/questions/56245200/why-are-the-printpreview-and-printout-preview-true-methods-sending-directly-to/61168780#61168780", "title": "Why are the PrintPreview and PrintOut Preview:=True methods sending directly to the printer instead of previewing?", "body": "<p>Do not use </p>\n\n<p>ActiveSheet.PrintOut PrintToFile:=True<br>\n ' This is for the current printers command files </p>\n\n<p>the only solution is </p>\n\n<p>ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF</p>\n"}], "owner": {"reputation": 21, "user_id": 2457257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8f114d6a8d8246f662961ef17d31a804?s=128&d=identicon&r=PG", "display_name": "Jeff H.", "link": "https://stackoverflow.com/users/2457257/jeff-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586680508, "creation_date": 1558466876, "last_edit_date": 1566045196, "question_id": 56245200, "link": "https://stackoverflow.com/questions/56245200/why-are-the-printpreview-and-printout-preview-true-methods-sending-directly-to", "title": "Why are the PrintPreview and PrintOut Preview:=True methods sending directly to the printer instead of previewing?", "body": "<p>I'm cobbling together a macro to deal with an enormous amount of paperwork. It's designed (and copied and pasted from online examples) to essentially enable a mail merge entirely within excel, using one sheet as the form letter and another as the database. </p>\n\n<p>I've tried a few different variations on object.PrintOut Preview:=True, object.PrintPreview, etc. and I can't get a print preview window. It sends right to the printer.  Similarly, I can't get the PrintToFile parameter to do anything either.  The preview range is set to TRUE in the worksheet, and I've even tried explicitly setting it to True in the code, with no change.</p>\n\n<pre><code>  If Range(\"Preview\") Then\n    'Neither of these options appear to work in Excel for Mac. It sends directly to the printer.\n    'ActiveSheet.Printout Preview:=True\n    ActiveWorkbook.PrintPreview\n  Else\n    If Range(\"PrintPDF\") Then\n      'This also doesn't appear to work in Excel for Mac. Also sends directly to the printer.\n       ActiveSheet.PrintOut PrintToFile:=True\n    Else\n      ActiveSheet.PrintOut\n    End If\n  End If\n</code></pre>\n\n<p>I expect to be able to get a print preview message, and when using the PrintToFile parameter, I expect to get a dialog box asking for a file name, per the documentation.</p>\n"}, {"tags": ["vba", "ms-access", "dao", "recordset"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558470862, "post_id": 56245885, "comment_id": 99110383, "body": "At every iteration, you&#39;re invoking <code>.MoveFirst</code> unconditionally, then <code>.MoveNext</code> only when <code>Field01a.Value &lt;&gt; Field01a.Value</code> ...a condition that can only ever be <code>False</code> - therefore, the loop is infinitely processing the first record (side note, <code>Else:</code> should be <code>Else</code> with the rest of the block properly indented). Also you begin reading the recordset before you know whether it contains any records. The problem can&#39;t possibly be with <code>Do While Not</code> vs <code>Do Until</code>, which are exactly equivalent - only, <code>Do Until</code> avoids the negative phrasing and should thus be preferred."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1558471024, "post_id": 56245885, "comment_id": 99110455, "body": "There shouldn&#39;t be any condition attached to <code>.MoveNext</code>. Whatever happens in the loop body, you want that to be <i>for every record</i>, and you want to be on the next record when you hit that <code>Loop</code> keyword and jump back up to re-evaluate whether you have any more records to process."}], "tags": [], "owner": {"reputation": 7, "user_id": 10787816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869fa56e27a418bdfd9e265fa4885adc?s=128&d=identicon&r=PG&f=1", "display_name": "CircularReference", "link": "https://stackoverflow.com/users/10787816/circularreference"}, "is_accepted": false, "score": 0, "last_activity_date": 1558470395, "creation_date": 1558470395, "answer_id": 56245885, "question_id": 56245110, "link": "https://stackoverflow.com/questions/56245110/dao-recordset-unable-to-movenext-in-table-object/56245885#56245885", "title": "DAO.Recordset, unable to MoveNext in table object", "body": "<p>I have some unusual security restrictions at my job, which I'm blaming on this not working.  But I looked at some Access Programming boards, and found this post [<a href=\"https://access-programmers.co.uk/forums/showthread.php?t=171138]\" rel=\"nofollow noreferrer\">https://access-programmers.co.uk/forums/showthread.php?t=171138]</a> which let me know I can make a loop using either \"Do While\" or \"Do Until\".  When I tried switching the loop style to \"Do Until\" it worked fine.</p>\n\n<p>Do Until ExDif.EOF</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 10787816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869fa56e27a418bdfd9e265fa4885adc?s=128&d=identicon&r=PG&f=1", "display_name": "CircularReference", "link": "https://stackoverflow.com/users/10787816/circularreference"}, "edited": false, "score": 0, "creation_date": 1558474115, "post_id": 56246229, "comment_id": 99111660, "body": "Thanks @Mathieu, this cleared up some other issues I was having"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1558472042, "creation_date": 1558472042, "answer_id": 56246229, "question_id": 56245110, "link": "https://stackoverflow.com/questions/56245110/dao-recordset-unable-to-movenext-in-table-object/56246229#56246229", "title": "DAO.Recordset, unable to MoveNext in table object", "body": "<p>Several problems.</p>\n\n<blockquote>\n<pre><code>Set ExDif = Tang.OpenRecordset(\"Staging_LOG_ExportDifferences\")\nSet Field01a = ExDif.Fields(\"a_Client Name\")\nSet Field01b = ExDif.Fields(\"b_Client Name\")\nSet ID = ExDif.Fields(\"ID\")\n</code></pre>\n</blockquote>\n\n<p>This code starts reading the recordset before it's known that there are records. If the recordset is empty (i.e. recordset is both <code>BOF</code> and <code>EOF</code>), these subsequent assignments will fail with an error. These assignments should be inside the record-reader loop.</p>\n\n<blockquote>\n<pre><code>ExDif.MoveFirst\n</code></pre>\n</blockquote>\n\n<p>You're <em>already</em> on the first record; moving the cursor back to the first record unconditionally, at each iteration, is why your loop is stuck on the first record. Remove this line.</p>\n\n<blockquote>\n<pre><code>If Field01a.Value &lt;&gt; Field01a.Value Then\n</code></pre>\n</blockquote>\n\n<p>This expression will always evaluate to <code>False</code>, it's a heuristically constant expression, likely a typo. Was it meant to compare <code>Field01a</code> with <code>Field01b</code>?</p>\n\n<blockquote>\n<pre><code>Else: MsgBox \"Client Name matches\"\n\n'Move to next record (row) in table\nExDif.MoveNext\n\n'End the Else - If\nEnd If\n</code></pre>\n</blockquote>\n\n<p>This indentation is very misleading and very, very error-prone. Consider:</p>\n\n<pre><code>Else\n    MsgBox \"Client Name matches\"\n    ExDif.MoveNext\nEnd If\n</code></pre>\n\n<p>Now, <code>.MoveNext</code> being conditional (somewhat - see previous point about the condition expression), is a problem: <strong>no matter what happens in the loop body</strong>, you want to be on the next record when you're done. So <code>.MoveNext</code> should never be conditional.</p>\n\n<hr>\n\n<p>This should fix it:</p>\n\n<pre><code>Set exportDiffs = Tang.OpenRecordset(\"Staging_LOG_ExportDifferences\")\nDo Until exportDiffs.EOF\n\n    Dim clientNameA As String\n    clientNameA = exportDiffs.Fields(\"a_Client Name\").Value\n\n    Dim clientNameB As String\n    clientNameB = exportDiffs.Fields(\"b_Client Name\").Value\n\n    If clientNameA &lt;&gt; clientNameB Then\n        'client name mismatch\n        GoTo Skip\n    End If\n\n    Dim id As Long\n    id = exportDiffs.Fields(\"ID\").Value\n\n    ' do stuff...\n\nSkip:\n    exportDiffs.MoveNext\nLoop\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 10787816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869fa56e27a418bdfd9e265fa4885adc?s=128&d=identicon&r=PG&f=1", "display_name": "CircularReference", "link": "https://stackoverflow.com/users/10787816/circularreference"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 56246229, "answer_count": 2, "score": 0, "last_activity_date": 1560927899, "creation_date": 1558466444, "last_edit_date": 1560927899, "question_id": 56245110, "link": "https://stackoverflow.com/questions/56245110/dao-recordset-unable-to-movenext-in-table-object", "title": "DAO.Recordset, unable to MoveNext in table object", "body": "<p>Goal:  I am writing a loop to go through a table, row by row, evaluate if fields match eachother, then move to the next record (row) and re-evaluate.  I eventually want to build a ever-growing string out of it, but for now I cannot get the Code to go to the next loop.  The value(s) show that the code only evaluates the first record, and repeats itself.</p>\n\n<p>I've tried moving the line 'ExDif.MoveNext' into/out of the loop, before/after the End If, no change.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nSub Export_Library_Compare_Process()\n\n'Identify the variables\nDim Tang As DAO.Database\nDim ExDif As DAO.Recordset\nDim Field01a As DAO.Field\nDim Field01b As DAO.Field\nDim ID As DAO.Field\n\n'Set the database and recordsets to database and tables\nSet Tang = CurrentDb\nSet ExDif = Tang.OpenRecordset(\"Staging_LOG_ExportDifferences\")\nSet Field01a = ExDif.Fields(\"a_Client Name\")\nSet Field01b = ExDif.Fields(\"b_Client Name\")\nSet ID = ExDif.Fields(\"ID\")\n\n'Start a series to look to see what matches\nDo While Not ExDif.EOF\n\n    'Move to first row in table\n    ExDif.MoveFirst\n\n    'Field 01 - Client Name\n    If Field01a.Value &lt;&gt; Field01a.Value Then\n        MsgBox \"Client Name does not match\"\n    Else: MsgBox \"Client Name matches\"\n\n    'Move to next record (row) in table\n    ExDif.MoveNext\n\n    'End the Else - If\n    End If\n\n'End Loop\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 990, "user_id": 10664048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392477f06aa24cefe7af4362e43ea49e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike_H", "link": "https://stackoverflow.com/users/10664048/mike-h"}, "edited": false, "score": 0, "creation_date": 1558469233, "post_id": 56244833, "comment_id": 99109742, "body": "Which code have you tried so far? You must show some work or pre-work of your own. The community isn&#39;t providing plain solutions to people just needing some final code. That would be an issue to hire someone. But add your work and everything is fine."}, {"owner": {"reputation": 21, "user_id": 11529581, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-opZEjPZd-ys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rerA30GVcDHVzHk9dhX0gMKTYbV4w/mo/photo.jpg?sz=128", "display_name": "Xsdi", "link": "https://stackoverflow.com/users/11529581/xsdi"}, "reply_to_user": {"reputation": 990, "user_id": 10664048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/392477f06aa24cefe7af4362e43ea49e?s=128&d=identicon&r=PG&f=1", "display_name": "Mike_H", "link": "https://stackoverflow.com/users/10664048/mike-h"}, "edited": false, "score": 0, "creation_date": 1558473014, "post_id": 56244833, "comment_id": 99111247, "body": "I was constantly trying to learn the keywords and other terms. Just learnt MID Function and I was able to at least start with it. I was looking for some clues to the problem as I did not know where and how to start. Just gone through so many forums and I was able to atleast add some code of mine."}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1558480354, "post_id": 56244833, "comment_id": 99113116, "body": "Consider using RegEx to find and extract your keywords - I&#39;ve shown an example of how to do it here <a href=\"https://stackoverflow.com/questions/56229757/reading-a-text-file-in-vba-and-modifying-a-certain-cell-depending-on-the-user-in/56230103#56230103\" title=\"reading a text file in vba and modifying a certain cell depending on the user in\">stackoverflow.com/questions/56229757/&hellip;</a> You should have no problems finding more tutorials and examples.  Let us know if you are still stuck after you try this approach."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11529581, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-opZEjPZd-ys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rerA30GVcDHVzHk9dhX0gMKTYbV4w/mo/photo.jpg?sz=128", "display_name": "Xsdi", "link": "https://stackoverflow.com/users/11529581/xsdi"}, "edited": false, "score": 0, "creation_date": 1558520753, "post_id": 56248515, "comment_id": 99126225, "body": "Extraordinary ."}, {"owner": {"reputation": 21, "user_id": 11529581, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-opZEjPZd-ys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rerA30GVcDHVzHk9dhX0gMKTYbV4w/mo/photo.jpg?sz=128", "display_name": "Xsdi", "link": "https://stackoverflow.com/users/11529581/xsdi"}, "edited": false, "score": 0, "creation_date": 1558530905, "post_id": 56248515, "comment_id": 99131880, "body": "extra ordinary... i am able to learn new functions...I have a small doubt.. what if the the char aftr T= is a combination of alpbabet and numbers like this &quot;AT T= 0.13D1&quot;. . ..Could yu pl throw some light on"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 21, "user_id": 11529581, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-opZEjPZd-ys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rerA30GVcDHVzHk9dhX0gMKTYbV4w/mo/photo.jpg?sz=128", "display_name": "Xsdi", "link": "https://stackoverflow.com/users/11529581/xsdi"}, "edited": false, "score": 0, "creation_date": 1558553837, "post_id": 56248515, "comment_id": 99144048, "body": "If extracted data might be Strings (or floating point numbers) then remove type casting to Long.  Answer edited"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1558638648, "last_edit_date": 1558638648, "creation_date": 1558492061, "answer_id": 56248515, "question_id": 56244833, "link": "https://stackoverflow.com/questions/56244833/extracting-specific-words-from-textpad-and-writing-it-in-microsoft-excel/56248515#56248515", "title": "Extracting specific words from Textpad and writing it in Microsoft Excel", "body": "<p>Here's your code refactored to add the required loop, and deal with a number of other issues.</p>\n\n<pre><code>Sub Extract()\n    Dim myFile As Variant ' Handle Cancel\n    Dim text As String\n    Dim textline As String\n    Dim idx As Long     ' separate position from data\n    Dim DisplayName As String\n    Dim DisplayFound As Boolean 'flag for if rw should be incremented\n    Dim TimeName As String\n    Dim TimeFound As Boolean\n    Dim FNum As Integer ' FreeFile returns an Integer\n    Dim rw As Long      'counter for output row\n    Dim ws As Worksheet ' best to avoid Active objects\n\n    On Error GoTo EH ' ensure file is closed\n\n    ' speed thing up a bit\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n    DisplayName = \"DISPLAY ID\"\n    TimeName = \"AT T=\"\n\n    rw = 1 ' start output at row 1\n    myFile = Application.GetOpenFilename()\n    If myFile = False Then GoTo CleanUp ' handle cancel\n    Set ws = ActiveSheet ' or whatever sheet you need\n\n    FNum = FreeFile\n    Open myFile For Input As #FNum\n    With ws\n        Do Until EOF(FNum)\n            Line Input #FNum, textline\n\n            DisplayFound = False\n            TimeFound = False\n            idx = InStr(textline, DisplayName)\n            If idx Then ' DisplayName was found\n                text = Trim(Mid$(textline, idx + Len(DisplayName)))\n                idx = InStr(text, \" \")\n                If idx Then  'allow for possibility  value is at end of string\n                    text = Trim(Left$(text, idx - 1))\n                End If\n                .Cells(rw, 1).Value = text\n                DisplayFound = True\n            End If\n            idx = InStr(textline, TimeName)\n            If idx Then ' TimeName was found\n                text = Trim(Mid$(textline, idx + Len(TimeName)))\n                idx = InStr(text, \" \")\n                If idx Then  'allow for possibility  value is at end of string\n                    text = Trim(Left$(text, idx - 1))\n                End If\n                .Cells(rw, 2).Value = text\n                TimeFound = True\n            End If\n            If DisplayFound Or TimeFound Then\n                rw = rw + 1  'increment output row\n            End If\n        Loop\n    End With\nCleanUp:\n    On Error Resume Next\n    Close #FNum\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\nExit Sub\nEH:\n    'Add Error Handling here\n\n    'Then clean up\n    Resume CleanUp\nEnd Sub\n</code></pre>\n\n<p>Note that writing directly to the sheet like this one cell at a time may be too slow, especially if you are processing many files, or the files are large.  If it is too slow for your needs, consider transitioning to a Variant Array approach (many examples of that here on SO)</p>\n"}], "owner": {"reputation": 21, "user_id": 11529581, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-opZEjPZd-ys/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rerA30GVcDHVzHk9dhX0gMKTYbV4w/mo/photo.jpg?sz=128", "display_name": "Xsdi", "link": "https://stackoverflow.com/users/11529581/xsdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561865336, "creation_date": 1558465189, "last_edit_date": 1561865336, "question_id": 56244833, "link": "https://stackoverflow.com/questions/56244833/extracting-specific-words-from-textpad-and-writing-it-in-microsoft-excel", "title": "Extracting specific words from Textpad and writing it in Microsoft Excel", "body": "<p>I want to extract numbers after specific words from TextPad to Excel columns.</p>\n\n<p>Example TextPad file.</p>\n\n<pre><code>INFO CRITERIA is MATCHED. DISPLAY ID 123456 AND AT T=369   \nMAY BE MATCHING OR MAY NOT BE\nINFO CRITERIA is MATCHED. DISPLAY ID 12345678 AND AT T=3698  \nSEVERAL PACKAGES TO BE FOLLOWED\nWAIT UNTIL THE PROCESS FINISHES\nINFO CRITERIA is MATCHED. DISPLAY ID 123 AND AT T=32\nREGARDING THE TIMINGS..\n</code></pre>\n\n<p>I want to extract the DISPLAY ID and the time (T=) to different columns in Excel.</p>\n\n<p>Below is the code I tried.</p>\n\n<p>How to use an array and for loop? How to read the remaining lines? If we use Mid function and the number of characters after \"T=\" varies in each line, it will be difficult to get the numbers correct.</p>\n\n<pre><code>Sub Extract()\nDim myFile As String, _\n    text As String, _\n    textline As String, _\n    DISPLAY As Integer, _\n    TIME As Integer\n\n    myFile = Application.GetOpenFilename()\n    Open myFile For Input As #1\n    Do Until EOF(1)\n        Line Input #1, textline\n        text = text &amp; textline\n    Loop\n    DISPLAY = InStr(text, \"DISPLAY ID\")\n    TIME = InStr(text, \"AT T=\")\n    Range(\"A1\").Value = Mid(text, DISPLAY + 10, 8)\n    Range(\"B1\").Value = Mid(text, TIME + 5, 6)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "visio"], "answers": [{"tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": true, "score": 1, "last_activity_date": 1558473122, "creation_date": 1558473122, "answer_id": 56246430, "question_id": 56244775, "link": "https://stackoverflow.com/questions/56244775/how-to-find-all-shapes-in-a-visio-drawing-and-add-each-shape-to-an-array/56246430#56246430", "title": "How to find all shapes in a Visio drawing and add each shape to an array?", "body": "<p>Understanding your desired business logic is the first step. Your steps 1 &amp; 2 can be a single step. </p>\n\n<p>Understanding your solution space is about understanding the range of tools a programming language gives you. In this case it is about how to efficiently loop (e.g. <code>For Each</code>) and information containers (e.g. <code>Collection</code>).</p>\n\n<p>Here is some example code:</p>\n\n<pre><code>Option Explicit ' Always use this at the top of a module. Always.\n\nFunction ExampleFindShapes(chosenPage as Page) as Collection\nDim foundShapes as New Collection ' Note the new part, this initialised the Collection\nDim shapeLoopIterator as Shape\nDim arrayLoopIterator as Long\nDim validShapes as Variant\n\n    validShapes = Array(\"Bob\", \"Harry\", \"George\")\n    For each shapeLoopIterator in chosenPage.Shapes ' One way to loop through an object collection\n        For arrayLoopIterator = LBound(validShapes) to UBound(validShapes) ' One way to loop through an array\n            If shapeLoopIterator.Name = validShapes(arrayLoopIterator) Then\n                foundShapes.Add shapeLoopIterator ' store the found shape as a reference to the shape\n                'Could put something in here to break out of the loop\n            End If\n        Next arrayLoopIterator\n    Next shapeLoopIterator\n    ExampleFindShapes = foundShapes\nEnd Function\n</code></pre>\n\n<p>Coding from memory as I don't have Visio installed on this machine, so <code>Page</code> might be something else.</p>\n\n<p>I have stored a reference to the shape instead of just the name, because the collection of found shapes will be easier to use in your parts 3 &amp; 4, instead of you having to find and reference the shapes again.</p>\n\n<p>The answer gets a little more complicated if you are working with grouped shapes. I suggest a new question referencing this one if this is the case as the answer will involve recursion and passing the collection down the line which a little more complex.</p>\n"}], "owner": {"reputation": 23, "user_id": 11535476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/081a3c2bb78448c1b13899bf4a3585b2?s=128&d=identicon&r=PG&f=1", "display_name": "Tasha713B", "link": "https://stackoverflow.com/users/11535476/tasha713b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 0, "accepted_answer_id": 56246430, "answer_count": 1, "score": 1, "last_activity_date": 1558551128, "creation_date": 1558464949, "last_edit_date": 1558551128, "question_id": 56244775, "link": "https://stackoverflow.com/questions/56244775/how-to-find-all-shapes-in-a-visio-drawing-and-add-each-shape-to-an-array", "title": "How to find all shapes in a Visio drawing and add each shape to an array?", "body": "<p>I am new to VBA and this is my first assignment, involving a pre-existing Visio drawing.</p>\n\n<p>The Visio drawing consists of several shapes and I ultimately want a way to detect which shapes are cables (two \"connector\" shapes that are attached by a dynamic connector) using vba code. To do this, \n1) I want to start by storing all the shape names in an array. \n2) Then, I want to cross-check that array with know names of connector shapes and create a new array of just those connector shapes. \n3) Next, I would check what each connector shape is connected to and that would allow me to determine what type of cable it is (I have this part of the code complete). \n4) Finally, I would assign the cable's # to one of the connector shapes (I think I have working code for this too). </p>\n\n<p>I am trying to figure out how to implement Steps 1 and 2 with my existing code.</p>\n\n<p>Currently I am only able to detect connected shapes when one of those shapes is selected:</p>\n\n<pre><code>Public Sub ConnectedShapes()\n' Get the shapes that are at the other end of\n' incoming connections to a selected shape\n    Dim vsoShape As Visio.Shape\n    Dim allShapes As Visio.Shapes\n    Dim lngShapeIDs() As Long\n    Dim intCount As Integer\n\n    If ActiveWindow.Selection.Count = 0 Then\n        MsgBox (\"Please select a shape that has connections.\")\n        Exit Sub\n    Else\n        Set vsoShape = ActiveWindow.Selection(1)\n    End If\n\n    Set allShapes = ActiveDocument.Pages.Item(1).Shapes\n    lngShapeIDs = vsoShape.ConnectedShapes(visConnectedShapesAllNodes, \"\")\n\n    Debug.Print \"   Shape selected:     \";\n    Debug.Print vsoShape\n\n    Debug.Print \"   Shape(s) connected: \";\n    For intCount = 0 To UBound(lngShapeIDs)\n        connectedItem = allShapes.ItemFromID(lngShapeIDs(intCount)).Name\n        Debug.Print connectedItem\n        If InStr(1, vsoShape, \"USB A - top\") = 1 Then\n            If InStr(1, connectedItem, \"USB A Female\") = 1 Then\n                '    write cable's number\n            ElseIf InStr(1, connectedItem, \"USB Mini B\") = 1 Then\n                '    write cable's number\n            ElseIf InStr(1, connectedItem, \"USB Micro B\") = 1 Then\n                '    write cable's number\n            ElseIf InStr(1, connectedItem, \"USB C Male\") = 1 Then\n                '    write cable's number\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Is there a built-in function for Visio vba that would help me implement steps 1 &amp; 2? What's the easiest way to find all the shapes in the document and store them in an array?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11535607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47813bc433a7c0139d939020a7c354a8?s=128&d=identicon&r=PG&f=1", "display_name": "A_D312281", "link": "https://stackoverflow.com/users/11535607/a-d312281"}, "edited": false, "score": 0, "creation_date": 1558468520, "post_id": 56245028, "comment_id": 99109450, "body": "Hi, thanks for responding so quickly! Unfortunately Private Functions are totally alien to me &amp; I&#39;m not too sure how to implement the above. I&#39;ve tried simply removing my &#39;Set wbBook2&#39; line &amp; adding your above solution however this gives a Compile Error. In addition, I assume the invocation line would take the place of the first &#39;Set&#39; only and this would be the only change? Or am I entirely off-track? Thanks"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 1, "user_id": 11535607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47813bc433a7c0139d939020a7c354a8?s=128&d=identicon&r=PG&f=1", "display_name": "A_D312281", "link": "https://stackoverflow.com/users/11535607/a-d312281"}, "edited": false, "score": 0, "creation_date": 1558475002, "post_id": 56245028, "comment_id": 99111961, "body": "<i>[1/2]</i> You can ignore <code>Private</code> that is just scope declaration and completely irrelevant to your solution. Functions work similarly as procedures (<code>Sub</code>) only difference being, they return a value - in our case either a <code>Workbook</code> object or <code>Nothing</code>. Copy paste entire function in to the same module (presumably Sheet code) as the rest of your code"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 1, "user_id": 11535607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47813bc433a7c0139d939020a7c354a8?s=128&d=identicon&r=PG&f=1", "display_name": "A_D312281", "link": "https://stackoverflow.com/users/11535607/a-d312281"}, "edited": false, "score": 0, "creation_date": 1558475114, "post_id": 56245028, "comment_id": 99111994, "body": "<i>[2/2]</i> Make sure you have your <code>wbBook1</code> and <code>wsSheet1</code> correctly declared and initalized (like in your example code). Once you do, you create a variable eg. <code>wbBook2</code> and use the function which will return the object according to the name from <code>Range(&quot;O35&quot;)</code> - in other words, the last line of my answer. Now the <code>Workbook</code> <i>(if it exists)</i> will be stored inside <code>wbBook2</code> variable"}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 0, "last_activity_date": 1558466018, "creation_date": 1558466018, "answer_id": 56245028, "question_id": 56244672, "link": "https://stackoverflow.com/questions/56244672/how-to-define-a-cell-value-as-a-worksheet/56245028#56245028", "title": "How to define a cell value as a worksheet", "body": "<p>It's safer to loop through Workbooks and look for a match</p>\n\n<pre><code>Private Function set_wb(ByVal toName As String) As Workbook\n\n    ' Function set_wb(&lt;String&gt;), returns Workbook Object on match.\n    ' - if no match found, return Nothing\n    ' - invokation example: Set wb1 = set_wb(\"Book1\")\n\n    Dim wb As Workbook\n    For each wb in Application.Workbooks\n       If wb.Name = toName Then\n           Set set_wb = wb ' wb found\n           Exit Function\n       End If\n    Next wb\n\n    Set set_wb = Nothing ' wb not found\nEnd Function\n</code></pre>\n\n<p>And would be invoked in your case the following way:</p>\n\n<pre><code>Set wbBook2 = set_wb(wsSheet1_1.Range(\"O35\")) \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11535607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47813bc433a7c0139d939020a7c354a8?s=128&d=identicon&r=PG&f=1", "display_name": "A_D312281", "link": "https://stackoverflow.com/users/11535607/a-d312281"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558466018, "creation_date": 1558464512, "question_id": 56244672, "link": "https://stackoverflow.com/questions/56244672/how-to-define-a-cell-value-as-a-worksheet", "title": "How to define a cell value as a worksheet", "body": "<p>I'm currently using a fixed file name in my code however I'd like to replace this fixed name with the value of a particular cell</p>\n\n<p>I've looked extensively across threads to no luck - I'm quite new to coding so I've found similar issues but nothing I'm able to apply to my coding or adapt for exactly my needs</p>\n\n<p>I've tried using </p>\n\n<pre><code>Set wbBook2 = Workbooks(wsSheet1_1.Range(\"O35\").Value) \n</code></pre>\n\n<p>and a few other similar steps but to no avail</p>\n\n<pre><code>Dim wbBook1 As Workbook\nDim wsSheet1_1 As Worksheet\nDim wsSheet1_2 As Worksheet\n\nDim wbBook2 As Workbook\nDim wsSheet2_1 As Worksheet\n\nSet wbBook1 = Workbooks(\"Main File.xlsm\")\nSet wsSheet1_1 = wbBook1.Worksheets(\"Example1\")\nSet wsSheet1_2 = wbBook1.Worksheets(\"Example2\")\n\nSet wbBook2 = Workbooks(\"Look Up File.xlsm\")\nSet wsSheet2_1 = wbBook2.Worksheets(\"Example3\")\n</code></pre>\n\n<p>The above allows me to use 'wbBook2.Activate' to switch to the workbook where the data is located &amp; take the necessary actions however I'd like to be able to change from using \"Look Up File.xlsm\" to cell O35 on wsSheet1_1.</p>\n\n<p>Currently I'm just ensuring my look-up file has the same name as is noted in the code but this would obviously lead to failure if this is accidentally re-named or a user titled this LookUp File (omitting the space) for example.</p>\n\n<p>Note that 'wbBook2' will already be open when this code is used &amp; the file name can change. The user separately defines the full file path &amp; name (including .xlsm) which is then opened in a separate macro that needs to remain separate</p>\n"}]