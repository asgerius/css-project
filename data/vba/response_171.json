[{"tags": ["vba", "image", "powerpoint"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1524101181, "post_id": 49910671, "comment_id": 86838527, "body": "Show the code you tried. Check <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1524344330, "post_id": 49910671, "comment_id": 86936811, "body": "It&#39;s hard to tell what you&#39;re doing here from just your description. It&#39;s always best to show us the code you&#39;re having trouble with.  But if you&#39;re using the Slide.Export method, look at the help entry for it. By specifying height and width, you can have it export images at up to around 3000 pixels in PPT 2010 and before, and at much higher resolutions in PPT 2013 (updated) and 2016"}, {"owner": {"reputation": 1, "user_id": 9504165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "SeoHyun", "link": "https://stackoverflow.com/users/9504165/seohyun"}, "edited": false, "score": 0, "creation_date": 1524573599, "post_id": 49910671, "comment_id": 87019881, "body": "Oh, my mistake. I&#39;ll add it."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1524580206, "post_id": 49910671, "comment_id": 87024803, "body": "Exporting Shapes doesn&#39;t work predictably. Try setting a temporary presentation&#39;s slide size to the same proportions as the image, insert the image onto the slide then use .Slide.Export (with height and width parameters) to export the image."}], "owner": {"reputation": 1, "user_id": 9504165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "SeoHyun", "link": "https://stackoverflow.com/users/9504165/seohyun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1524574235, "creation_date": 1524095793, "last_edit_date": 1524574235, "question_id": 49910671, "link": "https://stackoverflow.com/questions/49910671/vba-save-export-extremely-huge-images", "title": "VBA Save/Export extremely huge images", "body": "<p>I'm making a comic saving program with Powerpoint VBA.</p>\n\n<p>I already made image downloader from internet site, and it was successful.</p>\n\n<p>The problem was the image's size.</p>\n\n<p>The size of image was too huge, so it wasn't able to save images with <code>.Export</code> property.</p>\n\n<p>Is there any way to save extremely huge images without Resolution loss?</p>\n\n<p>+if it is not able to save big images, please tell me merge multiple images without Resolution loss in VBA instead.</p>\n\n<ul>\n<li>Code</li>\n</ul>\n\n<p>`</p>\n\n<pre><code>Public Sub downWebtoonS(ID As Long, S As Long, F As Long)\nOn Error Resume Next\nDim i As Long, ldBar As Double\nldBar = ActivePresentation.Slides(mainS).Shapes(\"loadA\").Left\nFor i = S To F\nCall downWebtoon(ID, i, S, F, i)\n\nCall ActivePresentation.Slides(TmpS).Shapes(\"res\").Export(\"C:\\temp\\PPT\\Webtoon\\img\" &amp; i &amp; \".png\", ppShapeFormatPNG) 'It is the problem\n\nActivePresentation.Slides(TmpS).Shapes(\"res\").Copy\nActivePresentation.Slides(TmpS).Shapes(\"res\").Delete\nActivePresentation.Slides(mainS).Shapes(\"loadA\").Width = (ActivePresentation.SlideMaster.Width - (ldBar * 2)) / (F - S + 1) * (i - S + 1)\nActivePresentation.Slides(mainS).Shapes(\"nowStatA\").TextFrame.TextRange.Text = (i - S + 1) &amp; \" / \" &amp; (F - S + 1) &amp; \" (\" &amp; Int(100 / (F - S + 1) * (i - S + 1)) &amp; \"%)\"\nNext i\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 0\nwsh.Run \"cmd /k title PPT &amp; color 1F &amp; echo. Wait a minute... &amp; del C:\\temp\\PPT\\Webtoon\\tmp.png &amp; exit\", vbHide, waitOnReturn\nEnd Sub\n\n\nPublic Sub downWebtoon(ID As Long, viewNo As Long, S As Long, F As Long, t As Long)\nOn Error Resume Next\nDim n As Long, i As Long, URL As String, shpTop As Double, ldBar As Double\nldBar = ActivePresentation.Slides(mainS).Shapes(\"load\").Left\nDim shp As Shape\nshpTop = 0\nn = getImgNo(ID, viewNo)\nFor i = 0 To n - 1\nDoEvents\nWith ActivePresentation.Slides(TmpS).Shapes.AddShape(msoShapeRectangle, 0, 0, 0, 0)\n    .Name = \"shp\" &amp; i\n    .Line.Visible = False\n    .Top = shpTop\nEnd With\nSet shp = ActivePresentation.Slides(TmpS).Shapes(\"shp\" &amp; i)\nURL = getURL(ID, viewNo, i)\nshpTop = shpTop + downImg(shp, URL)\nIf i &gt; 0 Then\nActivePresentation.Slides(TmpS).Shapes.Range(Array(\"shp\" &amp; i, \"frm\" &amp; i - 1)).Group.Name = \"frm\" &amp; i\nElse\nActivePresentation.Slides(TmpS).Shapes(\"shp0\").Name = \"frm0\"\nEnd If\nActivePresentation.Slides(mainS).Shapes(\"load\").Width = (ActivePresentation.SlideMaster.Width - (ldBar * 2)) / n * (i + 1)\nActivePresentation.Slides(mainS).Shapes(\"nowStat\").TextFrame.TextRange.Text = i + 1 &amp; \"Cut / \" &amp; n &amp; \"Cut\" &amp; \" (\" &amp; Int((i + 1) / n * 100) &amp; \"%)\"\nActivePresentation.Slides(mainS).Shapes(\"loadA\").Width = (ActivePresentation.SlideMaster.Width - (ldBar * 2)) / (F - S + 1) * ((t - S) + ((i + 1) / (n)))\nActivePresentation.Slides(mainS).Shapes(\"nowStatA\").TextFrame.TextRange.Text = (t - S + 1) &amp; \" / \" &amp; (F - S + 1) &amp; \" (\" &amp; Int(100 / (F - S + 1) * ((t - S) + ((i + 1) / (n)))) &amp; \"%)\"\nDoEvents\nNext i\nActivePresentation.Slides(TmpS).Shapes(\"frm\" &amp; n - 1).Name = \"res\"\nEnd Sub\n\n\n\nPublic Function downImg(shp As Shape, link As String)\nCall DownloadFile(link, \"C:\\temp\\PPT\\Webtoon\\tmp.png\")\nshp.Fill.UserPicture \"C:\\temp\\PPT\\Webtoon\\tmp.png\"\nshp.Width = WidthImage\nshp.height = LoadPicture(\"C:\\temp\\PPT\\Webtoon\\tmp.png\").height * (WidthImage / LoadPicture(\"C:\\temp\\PPT\\Webtoon\\tmp.png\").Width)\ndownImg = shp.height\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010", "circular-reference"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1524096471, "post_id": 49910408, "comment_id": 86837358, "body": "If you&#39;re using an event handler to respond to changes then do you even need the monthly/annual formulas?  When the user changes a monthly or annual amount you could directly update the other cell on that row."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524096750, "post_id": 49910408, "comment_id": 86837427, "body": "Instead of <code>And .Formula Is Nothing Then</code> use  <code>And Len(.Formula) = 0 Then</code>.   &quot;Formula&quot; is just an empty string when a cell has no fomula."}, {"owner": {"reputation": 25, "user_id": 3973012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90856ed580fd07799b2f707a2a7ecde1?s=128&d=identicon&r=PG&f=1", "display_name": "LordBalogh", "link": "https://stackoverflow.com/users/3973012/lordbalogh"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524159188, "post_id": 49910408, "comment_id": 86869913, "body": "FYI: I want to use formulas in the worksheet to allow the user to see what calculations the worksheet is performing, if they would like to. I know the worksheet is flawless but I must allow for others to verify it for themselves."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1524159442, "last_edit_date": 1524159442, "creation_date": 1524158866, "answer_id": 49926893, "question_id": 49910408, "link": "https://stackoverflow.com/questions/49910408/re-instate-formulas-when-deleted/49926893#49926893", "title": "Re-instate formulas when deleted", "body": "<p>A better approach (since you're already using an event handler to respond to changes) might be to skip the formulas entirely, and instead when the user changes a monthly or annual amount directly just update the other cell on that row.</p>\n\n<p>Alternatively if you want to continue with your current approach:</p>\n\n<p>Instead of </p>\n\n<pre><code> ... And .Formula Is Nothing Then \n</code></pre>\n\n<p>use </p>\n\n<pre><code> ... And Len(.Formula) = 0 Then \n</code></pre>\n\n<p>\"Formula\" just returns an empty string when a cell has no formula.</p>\n"}], "owner": {"reputation": 25, "user_id": 3973012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90856ed580fd07799b2f707a2a7ecde1?s=128&d=identicon&r=PG&f=1", "display_name": "LordBalogh", "link": "https://stackoverflow.com/users/3973012/lordbalogh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 49926893, "answer_count": 1, "score": 1, "last_activity_date": 1524159442, "creation_date": 1524093601, "last_edit_date": 1524159385, "question_id": 49910408, "link": "https://stackoverflow.com/questions/49910408/re-instate-formulas-when-deleted", "title": "Re-instate formulas when deleted", "body": "<h1>Context</h1>\n\n<p>I am trying to make a hassle-free multifamily rental analysis worksheet. The end user doesn't know anything about excel. The datapoints of one section are <em>unit types</em>, <em>number of units per type</em>, <em>monthly rent per unit</em>, and <em>annual rent per unit</em>. I would like the user to be able to enter the <em>monthly rent</em> and have the <em>annual rent</em> calculated or vise versa (assuming, in both cases, they've also entered the <em>number of units</em> per type). The formulas in question are more simple than you could have imagined:</p>\n\n<p><em>Monthly rent</em> = <em>Annual Rent</em> / <em>12</em> / <em>Number of units</em></p>\n\n<p><em>Annual rent</em> = <em>Monthly rent</em> * <em>Number of Units</em> * <em>12</em></p>\n\n<p>I've enabled iterative calculation to allow me to keep a formula in each rent column, because they rely on each other for their calculation (<strong>dependent formulas</strong>). This works great but only for the first entry. If the user entered <em>monthly rent</em> data but would now like to instead enter <em>annual data</em>, the formula for the monthly calculation is gone. <strong>However,</strong> I was able to resolve this with some crafty code in <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> that I pasted below. This works perfectly. Whenever one is changed, the formula is inserted for the other, overwriting the user input--<em>unless</em>... one of the formulas was deleted instead of just changed.</p>\n\n<h1>The Problem</h1>\n\n<p>I cannot find any information on how to insert a formula when a user deletes it. For example: Let's say the user had previously entered information for <em>monthly rent</em> and the worksheet automatically calculated annual rent. Now, when the user goes back to delete <em>monthly rent</em>, the monthly rent cell isn't reset, it's empty. The formula is no longer there and when they edit annual rent, the VBA doesn't reinstate the monthly rent formula.</p>\n\n<p>I don't know:</p>\n\n<ul>\n<li><p>why the commented out ElseIf block doesn't work</p></li>\n<li><p>why sometimes deleting information entered into one of the dependent cells clears the other one and sometimes it doesn't</p></li>\n<li><p>why deleting the formula out of one and editing the other one doesn't reinstate the formula that was deleted. E.g. deleting monthly rent and then editing annual rent doesn't recreate the monthly rent formula</p></li>\n</ul>\n\n<p>The ideal behavior, when the user deletes one of the dependent formulas, would be to have the cells return to their starting position with both circular formulas in place. It seems simply re-entering the formula when it is deleted should do the trick but surprisingly, I can't find any help on how to do that.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'Macro replaces formulas in circular reference cells\n'This is to allow users to enter a piece of data in one\n'column and have the other column automatically calculate,\n'even if they had already entered data into the cell that\n'calculates.\n'\n'FOR EXAMPLE: users can enter the monthly rent to have the\n'annual rent calculate OR they can enter the annual rent to\n'have the monthly rent calculate (assuming they have also\n'provided number of units in the No. of Units column). This\n'macro overwrites the cell contents of the unused column, allowing\n'users to enter a monthly rent figure and see what the annual rent\n'is but then to specify the annual rent and have the monthly rent\n'column overwrite their previously entered figure\n\nDim AnnualRent, MonthlyRent As Range\nDim cll As Variant\n\n'Dynamically set the ranges of interest, to allow users to\n'add rows willy-nilly\nSet AnnualRent = Range(\"R2:R\" &amp; Range(\"Total_Ann_Rent\").Row - 1)\nSet MonthlyRent = Range(\"P2:P\" &amp; Range(\"Total_Ann_Rent\").Row - 1)\n\n'It is necessary to disable event listening to prevent an infinite loop\nApplication.EnableEvents = False\n\n'Handle subsequent changes to the ranges set above, specifically,\n'to rebuild the circularity\nFor Each cll In Target.Cells\n    With cll\n        'Make a persistent formula for MonthlyRent\n        If Not Intersect(cll, MonthlyRent) Is Nothing _\n            And .Offset(0, 2).FormulaR1C1 &lt;&gt; \"=RC[-2]*12*RC[-11]\" Then\n\n            .Offset(0, 2).FormulaR1C1 = \"=RC[-2]*12*RC[-11]\"\n\n'       'Reinstate the MonthlyRent when it's deleted\n'        ElseIf Not Intersect(cll, MonthlyRent) Is Nothing _\n'            And .Formula Is Nothing Then\n'\n'            .FormulaR1C1 = \"=IFERROR(RC[2]/12/RC[-9],0)\"\n\n\n        'Make a persistent formula for Annual Rent\n        ElseIf Not Intersect(cll, AnnualRent) Is Nothing _\n            And .Offset(0, -2).FormulaR1C1 &lt;&gt; \"=IFERROR(RC[2]/12/RC[-9],0)\" Then\n\n            .Offset(0, -2).FormulaR1C1 = \"=IFERROR(RC[2]/12/RC[-9],0)\"\n\n'        'Reinstate Annual Rent formula when it's deleted\n'        ElseIf Not Intersect(cll, AnnualRent) Is Nothing _\n'            And .formula Is Nothing Then\n'\n'            .Formula R1C1 = \"=RC[-2]*12*RC[-11]\"\n\n        End If\n    End With\nNext cll\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1524101486, "post_id": 49910356, "comment_id": 86838602, "body": "you will need to iterate over each cell in turn and figure out if it is locked, and if it isn&#39;t paste the corresponding cell"}, {"owner": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1524102474, "post_id": 49910356, "comment_id": 86838823, "body": "I thought that may be the case. Any ideas how that might look in VBA language incorporating what I have so far?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1524112712, "post_id": 49910356, "comment_id": 86841255, "body": "Try some of the similar questions in the side panel or from a search engine."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "edited": false, "score": 0, "creation_date": 1524173365, "post_id": 49914675, "comment_id": 86876988, "body": "this is well efficient. This will negate the need for me to lock the cells to begin with and prevent iterating twice as you point out. thanks."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1524121267, "creation_date": 1524121267, "answer_id": 49914675, "question_id": 49910356, "link": "https://stackoverflow.com/questions/49910356/vba-to-paste-into-a-range-with-locked-cells-but-skip-locked-cells/49914675#49914675", "title": "VBA to Paste into a range with locked cells, but skip locked cells", "body": "<p>you're unnecessarily iterating twice: just copy values in not yellowed cells</p>\n\n<pre><code>Option Explicit\n\nSub lockcellsbycolor()\n    Dim colorIndex As Integer\n    colorIndex = 6\n    Dim xRg As Range\n\n    Application.ScreenUpdating = False\n    ActiveSheet.Unprotect\n\n    For Each xRg In Sheets(\"Sheet1\").Range(\"A1:D40\").Cells\n        Dim color As Long\n        color = xRg.Interior.colorIndex\n        If color &lt;&gt; colorIndex Then xRg.Value = Sheets(\"Sheet2\").Range(xRg.Address).Value\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9593756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565f089ffb202150accd41d196cbdc9d?s=128&d=identicon&r=PG&f=1", "display_name": "shano", "link": "https://stackoverflow.com/users/9593756/shano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 760, "favorite_count": 1, "accepted_answer_id": 49914675, "answer_count": 1, "score": 0, "last_activity_date": 1524121267, "creation_date": 1524093180, "last_edit_date": 1524099847, "question_id": 49910356, "link": "https://stackoverflow.com/questions/49910356/vba-to-paste-into-a-range-with-locked-cells-but-skip-locked-cells", "title": "VBA to Paste into a range with locked cells, but skip locked cells", "body": "<p>I have a VBA script that searches a range in \"Sheet1\" for cells with yellow colour (6) and locks those cells. These cells are intentionally protected so that they are not able to be changed. My script then copies a range in \"Sheet2\" and pastes it into \"Sheet1\" however I get the error message to say that the cells are protected. What I need is for the script to skip the cells that are locked in \"Sheet1\" but pastes to all other cells in that range that are unlocked. I want the integrity of the locked cells to remain the same. this is what I have so far:</p>\n\n<pre><code>Sub lockcellsbycolor()\n\n    Dim colorIndex As Integer\n    colorIndex = 6\n    Dim xRg As Range\n    Application.ScreenUpdating = False\n    ActiveSheet.Unprotect\n\n    For Each xRg In ActiveSheet.Range(\"A1:D40\").Cells\n        Dim color As Long\n        color = xRg.Interior.colorIndex\n        If (color = colorIndex) Then\n            xRg.Locked = True\n        Else\n            xRg.Locked = False\n        End If\n    Next xRg\n    Application.ScreenUpdating = True\n    ActiveSheet.Unprotect\n    MsgBox \"All specified colour cells have been locked!\"\n    ActiveSheet.Protect\n\n'grab data from sheet 2 and paste into \"Sheet1\"\n    Sheets(\"Sheet2\").Select\n    Range(\"A1:D40\").Select\n    Selection.Copy\n    Sheets(\"Sheet1\").Select\n    Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n'I need this paste to ignore locked cells - meaning any cell that's locked is not pasted over the top of but rather skipped. (See picture for an example of the desired outcome)\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pqBAE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pqBAE.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["xml", "vba", "excel", "export"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524089069, "post_id": 49909499, "comment_id": 86835321, "body": "What line gives the error?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9666649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d82281a42d5d7c64ae85ab1d4199a0?s=128&d=identicon&r=PG&f=1", "display_name": "samj", "link": "https://stackoverflow.com/users/9666649/samj"}, "edited": false, "score": 0, "creation_date": 1524149793, "post_id": 49909774, "comment_id": 86864193, "body": "Thanks so much! That fixed it! The debugger was pointing to the first &quot;doc.get ElementsbyTagName&quot; line, so I assumed it was having trouble reading the XML template for the tags. Should&#39;ve known it was something simpler!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1524089562, "creation_date": 1524089562, "answer_id": 49909774, "question_id": 49909499, "link": "https://stackoverflow.com/questions/49909499/excel-to-xml-export-via-vba/49909774#49909774", "title": "Excel to XML export via VBA", "body": "<pre><code>doc.validateOnParse = False\n</code></pre>\n\n<p>is hiding the parse error:</p>\n\n<blockquote>\n  <p>End tag 'mods' does not match the start tag 'physicalDescription'.</p>\n</blockquote>\n\n<p>You haven't closed the tag <code>&lt;physicalDescription&gt;</code> in your XML template</p>\n"}], "owner": {"reputation": 1, "user_id": 9666649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65d82281a42d5d7c64ae85ab1d4199a0?s=128&d=identicon&r=PG&f=1", "display_name": "samj", "link": "https://stackoverflow.com/users/9666649/samj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524089562, "creation_date": 1524088000, "question_id": 49909499, "link": "https://stackoverflow.com/questions/49909499/excel-to-xml-export-via-vba", "title": "Excel to XML export via VBA", "body": "<p>I have been using the template in the answer to <a href=\"https://stackoverflow.com/questions/27098966/convert-rows-of-spreadsheet-to-separate-xml-files\">this question</a> in order to export data from an Excel spreadsheet into separate XML files for each row. I've modified the template in that post to match the output I need, yet when I run the macro I get a \"Runtime Error 91: Object Variable or With block variable not set.\" Here is the VBA Macro I'm currently using: </p>\n\n<pre><code>Sub xmlconverter1()\n\nsTemplateXML = \"&lt;?xml version='1.0'?&gt;\" + vbNewLine + _\n\"&lt;mods xmlns='http://www.loc.gov/mods/v3' xmlns:mods='http://www.loc.gov/mods/v3' xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xlink='http://www.w3.org/1999/xlink'&gt;\" + vbNewLine + _\n    \"   &lt;titleInfo&gt;\" + vbNewLine + _\n    \"       &lt;title&gt;&lt;/title&gt;\" + vbNewLine + _\n    \"   &lt;/titleInfo&gt;\" + vbNewLine + _\n    \"   &lt;typeOfResource&gt;\" + vbNewLine + _\n    \"   &lt;/typeOfResource&gt;\" + vbNewLine + _\n    \"   &lt;name type='personal'&gt;\" + vbNewLine + _\n    \"       &lt;namePart&gt;&lt;/namePart&gt;\" + vbNewLine + _\n    \"   &lt;/name&gt;\" + vbNewLine + _\n    \"   &lt;abstract&gt;\" + vbNewLine + _\n    \"   &lt;/abstract&gt;\" + vbNewLine + _\n    \"   &lt;identifier&gt;\" + vbNewLine + _\n    \"   &lt;/identifier&gt;\" + vbNewLine + _\n    \"   &lt;originInfo&gt;\" + vbNewLine + _\n    \"       &lt;dateIssued&gt;&lt;/dateIssued&gt;\" + vbNewLine + _\n    \"   &lt;/originInfo&gt;\" + vbNewLine + _\n    \"   &lt;physicalDescription&gt;\" + vbNewLine + _\n    \"       &lt;form&gt;&lt;/form&gt;\" + vbNewLine + _\n    \"       &lt;extent&gt;&lt;/extent&gt;\" + vbNewLine + _\n    \"   &lt;subject&gt;\" + vbNewLine + _\n    \"       &lt;geographic&gt;&lt;/geographic&gt;\" + vbNewLine + _\n    \"   &lt;/subject&gt;\" + vbNewLine + _\n    \"&lt;/mods&gt;\" + vbNewLine\n\n\n Set doc = CreateObject(\"MSXML2.DOMDocument\")\n doc.async = False\n doc.validateOnParse = False\n doc.resolveExternals = False\n\n With ActiveWorkbook.Worksheets(1)\n lLastRow = .UsedRange.Rows.Count\n\nFor lRow = 2 To lLastRow\n sTitle = .Cells(lRow, 2).Value\n sType = .Cells(lRow, 11).Value\n sCreator = .Cells(lRow, 3).Value\n sDescription = .Cells(lRow, 6).Value\n sIdentifier = .Cells(lRow, 1).Value\n sDate = Format(.Cells(lRow, 9).Value, \"YYYY-MM-DD\")\n sForm = .Cells(lRow, 12).Value\n sExtent = .Cells(lRow, 22).Value\n sCoverage = .Cells(lRow, 7).Value\n doc.LoadXML sTemplateXML\n doc.getElementsByTagName(\"title\")(0).appendChild doc.createTextNode(sTitle)\n doc.getElementsByTagName(\"typeOfResource\")(0).appendChild doc.createTextNode(sType)\n doc.getElementsByTagName(\"name\")(0).appendChild doc.createTextNode(sCreator)\n doc.getElementsByTagName(\"abstract\")(0).appendChild doc.createTextNode(sDescription)\n doc.getElementsByTagName(\"identifier\")(0).appendChild doc.createTextNode(sIdentifier)\n doc.getElementsByTagName(\"dateIssued\")(0).appendChild doc.createTextNode(sDate)\n doc.getElementsByTagName(\"form\")(0).appendChild doc.createTextNode(sForm)\n doc.getElementsByTagName(\"extent\")(0).appendChild doc.createTextNode(sExtent)\n doc.getElementsByTagName(\"geographic\")(0).appendChild doc.createTextNode(sCoverage)\n doc.Save sIdentifier\n\nNext\n\n End With\n\nEnd Sub\n</code></pre>\n\n<p>What can I change that will get rid of this error and still give me the output in the format I need? </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1524088314, "post_id": 49909496, "comment_id": 86835052, "body": "Your desired outcome is the normal, expected behavior for a UDF in a workbook. It sounds like there is something else going on -- perhaps there is some other macro code tied to an event handler like Close, BeforeClose, Open, etc., that is altering the state of the workbook either when you close it, or when you first open it, but as your question is currently asked, there is not enough information to answer with much certainty."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1524088594, "post_id": 49909496, "comment_id": 86835148, "body": "For instance, if Row 1 is deleted <i>after</i> the function has been evaluated initially, the function will returns a #Value error since the range parameter no longer exists. If you examine the function, it might look like: <code>=IsRowVisible(#REF!)</code> ."}, {"owner": {"reputation": 103, "user_id": 6814082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e445e9ca7659177ba78f2e0521784aca?s=128&d=identicon&r=PG&f=1", "display_name": "JFrizz", "link": "https://stackoverflow.com/users/6814082/jfrizz"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1524089016, "post_id": 49909496, "comment_id": 86835300, "body": "The range being referred to exists and is not hidden.  For instance, in cell AL39 I have =IsRowVisible(A39).  In cell A39, I have someone&#39;s name.  When I click on cell AL39 and click the formula bar, and then hit return, the value in cell AL39 changes from #VALUE! to 1. That&#39;s the desired result.  It just needs to happen automatically without me having to signal it to calculate.  Imagine having this formula in 100 places.  Also calculations are set to Automatic."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1524089363, "post_id": 49909496, "comment_id": 86835411, "body": "show ALL of your code. otherwise, impossible to answer."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 6814082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e445e9ca7659177ba78f2e0521784aca?s=128&d=identicon&r=PG&f=1", "display_name": "JFrizz", "link": "https://stackoverflow.com/users/6814082/jfrizz"}, "edited": false, "score": 0, "creation_date": 1524089430, "post_id": 49909559, "comment_id": 86835433, "body": "I think this may have worked!!!! I will test this and mark as answered asap.  But for now, I have to run out of the office.  THanks!"}, {"owner": {"reputation": 103, "user_id": 6814082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e445e9ca7659177ba78f2e0521784aca?s=128&d=identicon&r=PG&f=1", "display_name": "JFrizz", "link": "https://stackoverflow.com/users/6814082/jfrizz"}, "edited": false, "score": 1, "creation_date": 1524147647, "post_id": 49909559, "comment_id": 86862622, "body": "That does, in fact, appear to be the trick.  Thank you again."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 103, "user_id": 6814082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e445e9ca7659177ba78f2e0521784aca?s=128&d=identicon&r=PG&f=1", "display_name": "JFrizz", "link": "https://stackoverflow.com/users/6814082/jfrizz"}, "edited": false, "score": 0, "creation_date": 1524147691, "post_id": 49909559, "comment_id": 86862657, "body": "@JFrizz  Glad to help!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1524088667, "last_edit_date": 1524088667, "creation_date": 1524088294, "answer_id": 49909559, "question_id": 49909496, "link": "https://stackoverflow.com/questions/49909496/how-can-i-make-a-vba-function-work-upon-opening-the-workbook/49909559#49909559", "title": "How can I make a VBA function work upon opening the workbook", "body": "<p>Does this improve things?:</p>\n\n<pre><code>Function IsRowVisible(MyRange As Range) As Integer\n    Application.Volatile\n    If (MyRange.EntireRow.Hidden = False) Then\n        IsRowVisible = 1\n    Else\n        IsRowVisible = 0\n    End If\n\nEnd Function\n</code></pre>\n\n<p>This is probably a volatility issue.  Your function may only be re-calculating when the <strong>value</strong> in <strong>A1</strong> changes.</p>\n\n<p>You may need to combine your function with a <code>SUBTOTAL()</code> function because <code>SUBTOTAL()</code> does recalculate when rows are hidden/unhidden.</p>\n"}], "owner": {"reputation": 103, "user_id": 6814082, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e445e9ca7659177ba78f2e0521784aca?s=128&d=identicon&r=PG&f=1", "display_name": "JFrizz", "link": "https://stackoverflow.com/users/6814082/jfrizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 49909559, "answer_count": 1, "score": 0, "last_activity_date": 1524088667, "creation_date": 1524087971, "question_id": 49909496, "link": "https://stackoverflow.com/questions/49909496/how-can-i-make-a-vba-function-work-upon-opening-the-workbook", "title": "How can I make a VBA function work upon opening the workbook", "body": "<p>I created a function in vba to determine if a row is visible.  The function returns 1 if visible and 0 if not visible.  The function looks like this:</p>\n\n<pre><code>Function IsRowVisible(MyRange As Range) As Integer\n\n    If (MyRange.EntireRow.Hidden = False) Then\n        IsRowVisible = 1\n    Else\n        IsRowVisible = 0\n    End If\n\nEnd Function\n</code></pre>\n\n<p>I then have a column in my workbook where I refer to this function in a formula such as:\n=IsRowVisible(A1)</p>\n\n<p>The formula returns #VALUE! until I run a macro that runs some other code or until I click the formula and hit Enter.  Then it works fine.  </p>\n\n<p>I would like it to work like a normal function in Excel where a value is returned when you open the workbook.  Where am I going wrong?  </p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["excel", "vba", "odbc"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524095223, "post_id": 49909415, "comment_id": 86837079, "body": "If you disable the error handler, what&#39;s the text of the error?"}, {"owner": {"reputation": 11, "user_id": 6762995, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207816101457371/picture?type=large", "display_name": "Bruno Repetto", "link": "https://stackoverflow.com/users/6762995/bruno-repetto"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524147789, "post_id": 49909415, "comment_id": 86862739, "body": "That is the weird thing. It exits the function right after it goes over the .CommanText instruction without producing an error. Execution does not stop, but since the query really didn&#39;t produce data, the code fails elsewhere. Only with the debugger was I able to pinpoint the root cause of the problem to that very instruction. I am using Excel 2007."}, {"owner": {"reputation": 11, "user_id": 6762995, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207816101457371/picture?type=large", "display_name": "Bruno Repetto", "link": "https://stackoverflow.com/users/6762995/bruno-repetto"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524150113, "post_id": 49909415, "comment_id": 86864448, "body": "Clarifying my above comment: The function is still exited after .CommandText after disabling the error when the Var variable is 33582 characters in length."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524151700, "post_id": 49909415, "comment_id": 86865550, "body": "I see other references online to a ~32k character limit, but no references to a work-around.  Can you split your query into multiple pieces and append each set of results?  Without seeing your SQL it&#39;s difficult to make suggestions."}, {"owner": {"reputation": 11, "user_id": 6762995, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207816101457371/picture?type=large", "display_name": "Bruno Repetto", "link": "https://stackoverflow.com/users/6762995/bruno-repetto"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524156957, "post_id": 49909415, "comment_id": 86868724, "body": "It is confirmed.  .CommandText does not take strings larger than 32767.  I rewrote the query using aliasing to save space on its size and got it to run a few more iterations until it grew to a size exceeding 32767.  Then it failed again."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524157086, "post_id": 49909415, "comment_id": 86868793, "body": "Are you running a large <code>where blah in(...)</code>-type query ?"}, {"owner": {"reputation": 11, "user_id": 6762995, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207816101457371/picture?type=large", "display_name": "Bruno Repetto", "link": "https://stackoverflow.com/users/6762995/bruno-repetto"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524163308, "post_id": 49909415, "comment_id": 86872072, "body": "Yes.  The where parts are what makes the query so large."}], "owner": {"reputation": 11, "user_id": 6762995, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207816101457371/picture?type=large", "display_name": "Bruno Repetto", "link": "https://stackoverflow.com/users/6762995/bruno-repetto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 581, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524087499, "creation_date": 1524087499, "question_id": 49909415, "link": "https://stackoverflow.com/questions/49909415/commandtext-in-an-odbc-query-excel-vba", "title": ".CommandText in an ODBC query (EXCEL VBA)", "body": "<p>I have successfully used this function to access a database for a couple of years now. The Var string always contains a valid SQL that is dynamically built depending on the data of the day.</p>\n\n<pre><code>Function Get_Query_Results(Rng As Range, Location As String, var As String, UID As String, PWD As String) As Long\n    Rng.Select\n    On Error GoTo TroubleWithDatabase\n    With ActiveSheet.ListObjects.Add(SourceType:=0, Source:=\"ODBC;DSN=XDR223;UID=\" &amp; UID &amp; \";PWD=\" &amp; PWD &amp; \";\", Destination:=Rng).QueryTable\n        .CommandText = var\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .Refresh BackgroundQuery:=False\n    End With\n    Get_Query_Results = LastInCol(Columns(Location)) - 1\n    Exit Function\nTroubleWithDatabase:\n    Get_Query_Results = 0\nEnd Function\n</code></pre>\n\n<p>The LastInCol function sets the value of the function to the number of records retrieved. If there's an error, the value of the function is set to 0.</p>\n\n<p>Today I traced a problem with the line</p>\n\n<pre><code>    .CommandText = var\n</code></pre>\n\n<p>When it attempts to execute that line, an error is trapped and then jumps to TroubleWithDatabase and exits.</p>\n\n<p>As I've said, this has never failed me until today. Today, var exceeded 32767 characters in length. It is 33582 characters in length. I suspecting that .CommandText can't take more than 32767 characters, which I find strange. Can anybody confirm?</p>\n\n<p>Better yet, can anybody see any errors at all with the function?</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1524086447, "post_id": 49909120, "comment_id": 86834260, "body": "How many sheets are in workbook?"}, {"owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1524086529, "post_id": 49909120, "comment_id": 86834294, "body": "just one sheet."}], "answers": [{"comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "edited": false, "score": 1, "creation_date": 1524087145, "post_id": 49909267, "comment_id": 86834578, "body": "@Kelley replace your sheet name with 1 - Example <code>ActiveWorkbook.Worksheets(&quot;owssvr (1)&quot;)</code> with <code>ActiveWorkbook.Worksheets(1)</code>"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1524091547, "last_edit_date": 1524091547, "creation_date": 1524086795, "answer_id": 49909267, "question_id": 49909120, "link": "https://stackoverflow.com/questions/49909120/how-to-make-recorded-macro-work-on-any-sheet/49909267#49909267", "title": "How to make recorded macro work on any sheet?", "body": "<p><em>Reference your worksheet name by Index Number</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    ActiveWorkbook.Worksheets(1)\nEnd Sub\n</code></pre>\n\n<p><em><a href=\"https://msdn.microsoft.com/en-us/library/office/aa221564(v=office.11).aspx\" rel=\"nofollow noreferrer\">Referring to Sheets by Index Number [Excel 2003 VBA Language Reference]</a></em></p>\n\n<blockquote>\n  <p><em><sub>An index number is a sequential number assigned to a sheet, based on the position of its sheet tab (counting from the left) among sheets of the same type. The following procedure uses the Worksheets property to activate worksheet one in the active workbook.</sub></em></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1524087811, "creation_date": 1524087811, "answer_id": 49909465, "question_id": 49909120, "link": "https://stackoverflow.com/questions/49909120/how-to-make-recorded-macro-work-on-any-sheet/49909465#49909465", "title": "How to make recorded macro work on any sheet?", "body": "<p>There <strong>two</strong> things at issue here:</p>\n\n<ol>\n<li>the worksheet name</li>\n<li>the Table name</li>\n</ol>\n\n<p>Lets assume that the name of the table is the same on all sheets on which the macro is to be used.  First Activate the worksheet and then run:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\nDim ws As Worksheet\nSet ws = ActiveSheet\n    ws.ListObjects(\"Table_owssvr__2\").Sort. _\n    SortFields.Clear\nws.ListObjects(\"Table_owssvr__2\").Sort. _\n    SortFields.Add Key:=Range(\"Table_owssvr__2[Number]\"), SortOn:=xlSortOnValues _\n    , Order:=xlAscending, DataOption:=xlSortNormal\nws.ListObjects(\"Table_owssvr__2\").Sort. _\n    SortFields.Add Key:=Range(\"Table_owssvr__2[ID]\"), SortOn:= _\n    xlSortOnValues, Order:=xlAscending, DataOption:=xlSortTextAsNumbers\nws.ListObjects(\"Table_owssvr__2\").Sort. _\n    SortFields.Add Key:=Range(\"Table_owssvr__2[Date]\"), SortOn:= _\n    xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nWith ws.ListObjects(\"Table_owssvr__2\"). _\n    Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1524087840, "creation_date": 1524087840, "answer_id": 49909474, "question_id": 49909120, "link": "https://stackoverflow.com/questions/49909120/how-to-make-recorded-macro-work-on-any-sheet/49909474#49909474", "title": "How to make recorded macro work on any sheet?", "body": "<p>This should work on any sheet which has only a single listobject which contains the required column names:</p>\n\n<pre><code>Sub Tester()\n    Dim tName As String\n\n    With ActiveSheet.ListObjects(1).Sort\n\n        tName = .Parent.Name 'list name\n\n        .SortFields.Clear\n        .SortFields.Add Key:=Range(tName &amp; \"[Number]\"), SortOn:=xlSortOnValues, _\n            Order:=xlAscending, DataOption:=xlSortNormal\n        .SortFields.Add Key:=Range(tName &amp; \"[ID]\"), SortOn:=xlSortOnValues, _\n            Order:=xlAscending, DataOption:=xlSortTextAsNumbers\n        .SortFields.Add Key:=Range(tName &amp; \"[Date]\"), SortOn:=xlSortOnValues, _\n            Order:=xlDescending, DataOption:=xlSortNormal\n\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9593773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cf38ba76acf49f646ad5f524a85ecde?s=128&d=identicon&r=PG&f=1", "display_name": "Kelley", "link": "https://stackoverflow.com/users/9593773/kelley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 49909474, "answer_count": 3, "score": 2, "last_activity_date": 1524091547, "creation_date": 1524086117, "last_edit_date": 1524086595, "question_id": 49909120, "link": "https://stackoverflow.com/questions/49909120/how-to-make-recorded-macro-work-on-any-sheet", "title": "How to make recorded macro work on any sheet?", "body": "<p>I recorded a macro to sort my excel sheet by Number (which is column A), then ID (which is column D), then the newest-oldest Date (which is column M)</p>\n\n<p>I want to be able to copy this macro onto any sheet (which would have all the same columns), but it tells me \"subscript out of range\" because there are different names.</p>\n\n<p>Here is the macro. The sheet name is \"owssvr (1)\", but I'd like it to be able to be for any sheet that has the same columns and such:</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"owssvr (1)\").ListObjects(\"Table_owssvr__2\").Sort. _\n    SortFields.Clear\nActiveWorkbook.Worksheets(\"owssvr (1)\").ListObjects(\"Table_owssvr__2\").Sort. _\n    SortFields.Add Key:=Range(\"Table_owssvr__2[Number]\"), SortOn:=xlSortOnValues _\n    , Order:=xlAscending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"owssvr (1)\").ListObjects(\"Table_owssvr__2\").Sort. _\n    SortFields.Add Key:=Range(\"Table_owssvr__2[ID]\"), SortOn:= _\n    xlSortOnValues, Order:=xlAscending, DataOption:=xlSortTextAsNumbers\nActiveWorkbook.Worksheets(\"owssvr (1)\").ListObjects(\"Table_owssvr__2\").Sort. _\n    SortFields.Add Key:=Range(\"Table_owssvr__2[Date]\"), SortOn:= _\n    xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"owssvr (1)\").ListObjects(\"Table_owssvr__2\"). _\n    Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n</code></pre>\n\n<p>I was thinking of using something w/ a With</p>\n"}, {"tags": ["vba", "catia"], "answers": [{"tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1524165375, "creation_date": 1524165375, "answer_id": 49928622, "question_id": 49908827, "link": "https://stackoverflow.com/questions/49908827/catia-vba-replace-command-schreplace/49928622#49928622", "title": "Catia VBA (replace-command schreplace)", "body": "<p>The Replace command is not supported in the automation interface (VBA).</p>\n\n<p>Since you are in charge of the assembly, it is possible to work around this using some tricks. </p>\n\n<p>One way is to add an isolated (datum) axis system to your part, then use the formula editor (creating a formula) to set it equal to your contextual one. </p>\n\n<p>In your part do <em>ALL</em> your construction from this datum axis system. Don't use the copy-pasted one for any purpose except as input to the formula.   </p>\n\n<p>Now if you want to use a different axis, copy-paste-with-link the new one into your part, and then change the formula to refer to the new copy. The downstream geometry will then update. This is all doable in VBA. </p>\n\n<p><a href=\"https://i.stack.imgur.com/uZCa6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uZCa6.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9090169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fae794de9ef65214c93b79f6dcc835?s=128&d=identicon&r=PG&f=1", "display_name": "AVIS", "link": "https://stackoverflow.com/users/9090169/avis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524165375, "creation_date": 1524084726, "question_id": 49908827, "link": "https://stackoverflow.com/questions/49908827/catia-vba-replace-command-schreplace", "title": "Catia VBA (replace-command schreplace)", "body": "<p>I'm trying to develop an assembly which uses contextual link... But stuck up at a point where I need to replace a existing axis system with new axis system. I came across a command from object browser - schreplace... Can someone assist me over this or advice me on the same</p>\n\n<p>The options  comes when part is active inside an assembly after which right click an axis system and select replace in order to replace it with another axis system</p>\n"}, {"tags": ["vba", "templates", "connection", "sage-erp"], "answers": [{"tags": [], "owner": {"reputation": 553, "user_id": 886432, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/3d6cea6632e81e287c5e16fd4cda1a01?s=128&d=identicon&r=PG", "display_name": "FunkMonkey33", "link": "https://stackoverflow.com/users/886432/funkmonkey33"}, "is_accepted": false, "score": 0, "last_activity_date": 1524813733, "creation_date": 1524813733, "answer_id": 50057351, "question_id": 49908697, "link": "https://stackoverflow.com/questions/49908697/connection-template-resetting-connections-and-looping-thru/50057351#50057351", "title": "Connection template, resetting connections and looping thru", "body": "<p>You can programmatically set the connection string.</p>\n\n<p>There is a MAS 90 / MAS 200 ODBC driver called SOTAMAS90.  On MAS installations in the last 5 years, there is both a 32 and a 64 bit driver.  </p>\n\n<p>In VBA, if I remember correctly, you would do something like this.  (This assumes you already have fetched the Investor object you need, and it has properties called username and password):</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Dim conn as new ADODB.Connection()\r\n\r\n' Set properties of connection string manually\r\nconn.ConnectionString = \"DRIVER = SOTAMAS90; UID=\" &amp; myInvestor.username &amp; \"; PWD=\" &amp; myInvestor.password &amp; \"; Company=ABC\"\r\n\r\nconn.Open()</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Another approach is to use a single ODBC connection within Access, to set up a linked ODBC table, using Access' Get External Data feature.  Then you can treat it like any other Access table, and just query it directly.  The problem with this approach is that Access will keep prompting you for credentials, both when you first open the table, and then if you are inactive for a while.  I'm told you can save the UID and password in the SOTAMAS90 ODBC connection, but I've never done it.  </p>\n\n<p>Hope that helps.</p>\n\n<p>Aaron</p>\n"}], "owner": {"reputation": 1, "user_id": 9253595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/522f16a562227734393d1d06d44c4618?s=128&d=identicon&r=PG&f=1", "display_name": "Tonya Ballard", "link": "https://stackoverflow.com/users/9253595/tonya-ballard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524813733, "creation_date": 1524084119, "last_edit_date": 1524245067, "question_id": 49908697, "link": "https://stackoverflow.com/questions/49908697/connection-template-resetting-connections-and-looping-thru", "title": "Connection template, resetting connections and looping thru", "body": "<p><strong>Back Story</strong>\nI am working with SAGE Mas 200 software, trying to link to it through Access.  This software houses date for 300 investors for my company.  With EACH investor I have a different investor ID that goes along with my UID and Password upon logging in, therefore EVERY connection string is different.  </p>\n\n<p>After many hours of trial and error, I have been successful in connecting via Access to only find out that I can only have one active connection string per database.  Since I have 300 investors that I need to pull data from, there is the problem...and I can't figure it out.</p>\n\n<p>I am a newby with VBA so my knowledge is extremely limited.  I have read about linking to a 'template' file with the connection strings, but not sure how to format the template file.  Can someone show me an example?  Also, how would I get it to loop thru each query stored in the database and then pull the appropriate connection string?  </p>\n\n<p><strong>Examples</strong>\nHere is an example of my connection string where 'AAL' is the investor code: </p>\n\n<pre><code>ODBC;DSN=SOTAMAS90;UID=tbard|AAL;PWD=password;Directory=\\\\mas-200\\MAS90;Prefix=\\\\mas-200\\MAS90\\SY\\, \\\\mas-200\\MAS90\\==\\;ViewDLL=\\\\mas-200\\MAS90\\HOME;SERVER=NotTheServer\n</code></pre>\n\n<p>The query name for this would be MAS_AAL.  </p>\n\n<p>Another investor: SMP, the query name MAS_SMP.  Etc, etc, etc...</p>\n\n<p>Can someone be my light at the end of the tunnel and help me out so I don't have to manually run 300 queries.  I'm dying over here!!  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1524084696, "post_id": 49908686, "comment_id": 86833559, "body": "I can&#39;t get that output.  I get the correct output.  The issue must be with the data some how."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524085442, "post_id": 49908686, "comment_id": 86833891, "body": "Works fine for me too (on Win7)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1524085860, "post_id": 49908686, "comment_id": 86834030, "body": "Works ok on Win7 (Old Price as currency with 2 decimal places, Discount as Percentage with 0 decimal places)"}, {"owner": {"reputation": 103, "user_id": 4256814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x90Zq.png?s=128&g=1", "display_name": "LiceRewis", "link": "https://stackoverflow.com/users/4256814/licerewis"}, "edited": false, "score": 1, "creation_date": 1524092231, "post_id": 49908686, "comment_id": 86836278, "body": "I can&#39;t get that either - have you tried starting with a blank workbook and just running this example only?"}], "owner": {"reputation": 1, "user_id": 4556394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/834d180148e1242ee912aded64c8d999?s=128&d=identicon&r=PG&f=1", "display_name": "alevanpa1", "link": "https://stackoverflow.com/users/4556394/alevanpa1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524084416, "creation_date": 1524084077, "last_edit_date": 1524084416, "question_id": 49908686, "link": "https://stackoverflow.com/questions/49908686/excel-vba-currency-erronous-display", "title": "Excel VBA Currency Erronous Display", "body": "<p>I'm using a MAC, version: 10.11.16 \"el Capitan\"</p>\n\n<p>I hope this all makes sense.</p>\n\n<p>I'm learning VBA, using a book named \"Learn VBA Fast, Vol 1, Excel Function Design Course\"</p>\n\n<p>The message boxes in the code display the correct values, but the value is the \nspreadsheet cell is absurd (See Below)</p>\n\n<p>Why is this happening?</p>\n\n<p>I've set up the spreadsheet as follows:</p>\n\n<p>Old Price as currency</p>\n\n<p>New Price as currency</p>\n\n<p>Discount as percentage</p>\n\n<p>I've also tried the discount cells </p>\n\n<ul>\n<li><p>as custom:  <code>0.00</code></p></li>\n<li><p>as number: <code>-1234.00</code> (2 decimal places)</p></li>\n<li><p>as currency:  <code>-$1234.00</code> (2 decimal places)</p></li>\n</ul>\n\n<p>The result is always the same values--no matter what configuration I set the discount cell to be.</p>\n\n<p>The spreadsheet is setup like this</p>\n\n<pre><code>old Price  |            New Price        |       Discount\n----------------------------------------------------------\n\n$12.50     |     $18,483,160,287,229.10   |     10%\n\n----------------------------------------------------------\n\n$13.25     |      $18,483,160,287,229.10   |     10%\n\n----------------------------------------------------------\n</code></pre>\n\n<p>The function calls, in the \"New Price\" cells is as follows:</p>\n\n<p><code>=NewPrice(E43,G43)</code> and <code>=NewPrice(E44,G43)</code></p>\n\n<p>The function code follows:</p>\n\n<pre><code>Option Explicit\n\nFunction NewPrice(OldPrice As Currency, Discount As Currency) As Currency\n\n        Discount = OldPrice * Discount\n\n        NewPrice = OldPrice - Discount\n\n        MsgBox \"Old price = \" &amp; OldPrice &amp; vbCrLf &amp; _\n \"Discount = \" &amp; Discount &amp; vbCrLf &amp; \"New price = \" &amp; NewPrice     \n\nEnd Function\n</code></pre>\n\n<p>Question:  Why is the display value so crazy wrong?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9665971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd193075bd088d341654667ca2bc4c08?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy L", "link": "https://stackoverflow.com/users/9665971/jeremy-l"}, "edited": false, "score": 0, "creation_date": 1524148312, "post_id": 49910018, "comment_id": 86863143, "body": "When I use this structure I get and Error &#39;1004&#39;, Method&#39;Range&#39; of object &#39;_Worksheet&#39; failed"}, {"owner": {"reputation": 11, "user_id": 9665971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd193075bd088d341654667ca2bc4c08?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy L", "link": "https://stackoverflow.com/users/9665971/jeremy-l"}, "edited": false, "score": 0, "creation_date": 1524148334, "post_id": 49910018, "comment_id": 86863153, "body": "Private Sub commandbutton1_click() Dim n As Integer     n = Application.WorksheetFunction.CountIf(Range(&quot;tbl_client1[vis&zwnj;&#8203;ible]&quot;), &quot;1&quot;)     If (n) = 1 Then     Sheets(&quot;clientlist&quot;).CommandButton2.Visible = True     Else     Sheets(&quot;clientlist&quot;).CommandButton2.Visible = False     End If End Sub"}, {"owner": {"reputation": 11, "user_id": 9665971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd193075bd088d341654667ca2bc4c08?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy L", "link": "https://stackoverflow.com/users/9665971/jeremy-l"}, "edited": false, "score": 0, "creation_date": 1524148571, "post_id": 49910018, "comment_id": 86863313, "body": "Never mind I didn&#39;t have the spelling correct for my table.  It should have been &quot;tbl_clients1&quot;.  Thanks for your help"}], "tags": [], "owner": {"reputation": 1079, "user_id": 6827197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/445d726384a840c085144bdced116a32?s=128&d=identicon&r=PG&f=1", "display_name": "a-burge", "link": "https://stackoverflow.com/users/6827197/a-burge"}, "is_accepted": false, "score": 1, "last_activity_date": 1524090941, "creation_date": 1524090941, "answer_id": 49910018, "question_id": 49908622, "link": "https://stackoverflow.com/questions/49908622/countif-function-in-vba-that-refers-to-a-table-column-by-name/49910018#49910018", "title": "Countif function in VBA that refers to a table column by name?", "body": "<p>Use <code>Range(\"TBL_Client1[your-column-name]\")</code></p>\n\n<p>That should do the trick.</p>\n"}], "owner": {"reputation": 11, "user_id": 9665971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd193075bd088d341654667ca2bc4c08?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy L", "link": "https://stackoverflow.com/users/9665971/jeremy-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524126097, "creation_date": 1524083784, "last_edit_date": 1524126097, "question_id": 49908622, "link": "https://stackoverflow.com/questions/49908622/countif-function-in-vba-that-refers-to-a-table-column-by-name", "title": "Countif function in VBA that refers to a table column by name?", "body": "<p>I'm having as issue trying to refer to a table column name in a countif statement.  I have a table <code>TBL_Client1</code> with multiple column names.  I have three slicers that can be selected to narrow down my table to 1 row.  I'm using the first column <code>Visible</code> in the table to identify when the table has been selected down to one row. I'm Currently using this code on a button to trigger another button visibility.  It works but the table I have is dynamic and could use more and more rows.  How can I refer to the table column name instead of <code>a1:a1500</code></p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim n As Integer\nn = Application.WorksheetFunction.CountIf(Range(\"a1:a1500\"), \"1\")\nIf (n) = 1 Then\nSheets(\"clientlist\").CommandButton2.Visible = True\nElse\nSheets(\"clientlist\").CommandButton2.Visible = False\nEnd If\n</code></pre>\n\n<p>I'm using this to make a button visible <code>CommandButton2</code>.  <code>CommandButton2</code> once visible executes a copy function that once again, I cant figure out how to reference a table column by name instead of referring to a row number.  The following is my next macro:</p>\n\n<pre><code>Sub update()\nA = Worksheets(\"clientlist\").Cells(Rows.Count, 4).End(xlUp).Row\nFor i = 5 To A\nIf Worksheets(\"clientlist\").Cells(i, 1).Value = \"1\" Then\n    Worksheets(\"clientlist\").Cells(i, 2).Copy\n    b = Worksheets(\"contactlog\").Cells(Rows.Count, 2).End(xlUp).Row\n    Worksheets(\"clientlist\").Paste \nDestination:=Worksheets(\"contactlog\").Cells(b + 1, 2)\n    Worksheets(\"clientlist\").Cells(i, 3).Copy\n    Worksheets(\"contactlog\").Cells(b + 1, 3).PasteSpecial \nPaste:=xlPasteValues\n    Application.CutCopyMode = False\n    Worksheets(\"clientlist\").Cells(10, 11).Copy\n    Worksheets(\"contactlog\").Cells(b + 1, 4).PasteSpecial \nPaste:=xlPasteValues\n    Application.CutCopyMode = False\n    Worksheets(\"clientlist\").Cells(i, 11).Copy\n    Worksheets(\"clientlist\").Paste \nDestination:=Worksheets(\"contactlog\").Cells(b + 1, 7)\n    Worksheets(\"clientlist\").Cells(i, 12).Copy\n    Worksheets(\"clientlist\").Paste \nDestination:=Worksheets(\"contactlog\").Cells(b + 1, 6)\n    Worksheets(\"clientlist\").Cells(i, 13).Copy\n    Worksheets(\"clientlist\").Paste \nDestination:=Worksheets(\"contactlog\").Cells(b + 1, 5)\n    Worksheets(\"clientlist\").Cells(3, 11).Copy\n    Worksheets(\"clientlist\").Paste \nDestination:=Worksheets(\"contactlog\").Cells(b + 1, 8)\n    c = Worksheets(\"deals\").Cells(Rows.Count, 2).End(xlUp).Row\n    Worksheets(\"clientlist\").Cells(10, 11).Copy\n    Worksheets(\"deals\").Cells(c + 1, 3).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>Finally, I'm using 2 buttons and visibility only because I cant figure out how to get a Macro to run continuously.  I've been searching through the web (especially StackOverflow) for about 2 weeks now and I'm getting close, but just not quite as Dynamic as I feel it could be.  Ultimately I would like the visibility of the button to be triggered anytime something is selected on a slicer.  I already tried the change and update but since the actual information on the table itself is not changing the code I've tried hasn't worked.  And I would like to copy/countif/paste referring to table column names instead of row numbers and column numbers.\nThanks for reading!  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 9068633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oBvBUitVZjE/AAAAAAAAAAI/AAAAAAAADxk/kjjgfYLy2y8/photo.jpg?sz=128", "display_name": "Tomasz Kozuch", "link": "https://stackoverflow.com/users/9068633/tomasz-kozuch"}, "edited": false, "score": 0, "creation_date": 1524084184, "post_id": 49908546, "comment_id": 86833321, "body": "Great! I didn&#39;t think of that. I dropped the formatting <code>Rng.Offset(0, xOffsetColumn).NumberFormat = &quot;MMMM&quot;</code> and viola :D"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 29, "user_id": 9068633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oBvBUitVZjE/AAAAAAAAAAI/AAAAAAAADxk/kjjgfYLy2y8/photo.jpg?sz=128", "display_name": "Tomasz Kozuch", "link": "https://stackoverflow.com/users/9068633/tomasz-kozuch"}, "edited": false, "score": 0, "creation_date": 1524112165, "post_id": 49908546, "comment_id": 86841106, "body": "@TomaszKozuch  Good Job!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1524083493, "creation_date": 1524083493, "answer_id": 49908546, "question_id": 49908493, "link": "https://stackoverflow.com/questions/49908493/output-date-month-in-uppercase/49908546#49908546", "title": "Output date month in uppercase", "body": "<p>You need to first make a string and the <code>Ucase()</code> it.</p>\n\n<p>Consider:</p>\n\n<pre><code>Sub dural()\n    Dim d As Date\n    d = Now\n    MsgBox UCase(Format(d, \"MMM\"))\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11857487, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1IBTCQrjxis/AAAAAAAAAAI/AAAAAAAAALI/xyAA95JrLCg/photo.jpg?sz=128", "display_name": "Josias Maestre", "link": "https://stackoverflow.com/users/11857487/josias-maestre"}, "is_accepted": false, "score": 0, "last_activity_date": 1564488521, "creation_date": 1564488521, "answer_id": 57271312, "question_id": 49908493, "link": "https://stackoverflow.com/questions/49908493/output-date-month-in-uppercase/57271312#57271312", "title": "Output date month in uppercase", "body": "<pre><code>Sub Which_Month()\nDim A As String\n\n    A = UCase(Format(Date, \"mmmm\"))\n    Debug.Print A\n    Msgbox A\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9068633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oBvBUitVZjE/AAAAAAAAAAI/AAAAAAAADxk/kjjgfYLy2y8/photo.jpg?sz=128", "display_name": "Tomasz Kozuch", "link": "https://stackoverflow.com/users/9068633/tomasz-kozuch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "accepted_answer_id": 49908546, "answer_count": 2, "score": 1, "last_activity_date": 1564488521, "creation_date": 1524083203, "last_edit_date": 1524084113, "question_id": 49908493, "link": "https://stackoverflow.com/questions/49908493/output-date-month-in-uppercase", "title": "Output date month in uppercase", "body": "<p>So i have <code>Rng.Offset(0, xOffsetColumn).Value = UCase(Date)</code> followed by <code>Rng.Offset(0, xOffsetColumn).NumberFormat = \"MMMM\"</code> which outputs the current date and formats it to the current month name but Ucase() doesn't capitalize the name, is it because <code>Date</code> is not a string? or because of the formatting <code>.NumberFormat</code> afterwords?</p>\n\n<p>Here is part the code:</p>\n\n<pre><code>If Not rngColJ Is Nothing Then\n    For Each Rng In rngColJ\n        If Not VBA.IsEmpty(Rng.Value) Then\n            Rng.Offset(0, xOffsetColumn).Value = UCase(Format(d, \"MMMM\"))\n        Else\n            Rng.Offset(0, xOffsetColumn).ClearContents\n        End If\n    Next\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1524082344, "post_id": 49908249, "comment_id": 86832395, "body": "You say it errors. What is the error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1524082446, "post_id": 49908249, "comment_id": 86832451, "body": "&quot;Run time error 1004: Application-defined or object-defined error&quot;"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1524082743, "post_id": 49908249, "comment_id": 86832606, "body": "Ugly. Are you certain that you have the pivot table name correct (perhaps there is a space hanging out at the end of the name that isn&#39;t visible)? Is this pivot table located in the same worksheet that this <code>Worksheet_Activate()</code> event is located? Does it work if you remove the first refresh statement?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1524082746, "post_id": 49908249, "comment_id": 86832610, "body": "Works for me. Are you sure you spelled your sheet name and pivot tables right?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1524082817, "post_id": 49908249, "comment_id": 86832639, "body": "@JNevill I think he must have a misspelling - I believe even if this sub is located in another sheet&#39;s module, it will still run fine, no?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1524083007, "post_id": 49908249, "comment_id": 86832727, "body": "@dwirony I agree. I think a misspelling is the only thing that is going to cause this error. I was thinking, if it&#39;s the same worksheet, then the pivottable object doesn&#39;t need to be qualified by the <code>Worksheets()</code> object potentially eliminating another change to typo."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "edited": false, "score": 0, "creation_date": 1524083115, "post_id": 49908249, "comment_id": 86832783, "body": "It&#39;s very odd, I&#39;ve renamed the table and checked for typos several times.  Can&#39;t for the life of me figure this out.  The first PivotTables works and the code is in the correct sheet"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1524085873, "post_id": 49908249, "comment_id": 86834036, "body": "@oryan5000 when you get the error, click debug and hover your arrow over each name (worksheets and pivot tables) and see which one says 1004"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "edited": false, "score": 0, "creation_date": 1524153915, "post_id": 49908249, "comment_id": 86866949, "body": "I figured it out.  Excel didn&#39;t like the second PivotTable because their was a blank row ahead of the column headers"}], "owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524082463, "creation_date": 1524082234, "last_edit_date": 1524082463, "question_id": 49908249, "link": "https://stackoverflow.com/questions/49908249/vba-refreshing-pivot-tables-as-sheet-opens", "title": "VBA: Refreshing Pivot Tables as Sheet Opens", "body": "<p>I have two Pivot Tables on a sheet that I'd like to have automatically refreshed when the sheet is selected.  The Pivot Tables have been named \"Order Detail-No Common Names\" and \"Master Table\".  The code for the first table works but errors on the second table.  \"Run time error 1004: Application-defined or object-defined error\".  Does anyone have any idea as to why this may be?</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\nWorksheets(\"TRANSLATION-Eligible Product\").PivotTables(\"Order Detail-No \nCommon Names\").PivotCache.Refresh\n\nWorksheets(\"TRANSLATION-Eligible Product\").PivotTables(\"Master \nTable\").PivotCache.Refresh\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "vba", "python-3.x", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1524082751, "post_id": 49908098, "comment_id": 86832611, "body": "<code>Workbooks.Open(urlToYourWorkbookHere)</code>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524085189, "post_id": 49908098, "comment_id": 86833790, "body": "You can COM connect to Excel object library (like VBA does) using Python&#39;s <code>win32com</code> module if using Python on PC machine. To piggyback @TimWilliams comment: <code>import win32com; excel = win32com.client.Dispatch(&quot;Excel.Application&quot;); doc = excel.Workbooks.Open( urlToYourWorkbookHere)</code>"}, {"owner": {"reputation": 65, "user_id": 4293751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff00f9dde03a705aa9aa778170cb8a78?s=128&d=identicon&r=PG&f=1", "display_name": "SBF12345", "link": "https://stackoverflow.com/users/4293751/sbf12345"}, "edited": false, "score": 0, "creation_date": 1524087466, "post_id": 49908098, "comment_id": 86834704, "body": "what is the best library to get for this task?...i&#39;ve downloaded two versions of the pywin32 package and loaded them...both are returning an error:    import win32api, sys, os ModuleNotFoundError: No module named &#39;win32api&#39;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524091567, "post_id": 49908098, "comment_id": 86836108, "body": "What OS are you using?"}, {"owner": {"reputation": 65, "user_id": 4293751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff00f9dde03a705aa9aa778170cb8a78?s=128&d=identicon&r=PG&f=1", "display_name": "SBF12345", "link": "https://stackoverflow.com/users/4293751/sbf12345"}, "edited": false, "score": 0, "creation_date": 1524100024, "post_id": 49908098, "comment_id": 86838219, "body": "I am operating windows 7"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524112764, "post_id": 49908098, "comment_id": 86841275, "body": "Do you have Excel installed?  If Yes, 32-bit or 64-bit?"}, {"owner": {"reputation": 65, "user_id": 4293751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff00f9dde03a705aa9aa778170cb8a78?s=128&d=identicon&r=PG&f=1", "display_name": "SBF12345", "link": "https://stackoverflow.com/users/4293751/sbf12345"}, "edited": false, "score": 0, "creation_date": 1524159930, "post_id": 49908098, "comment_id": 86870322, "body": "it is Excel 2003 so it is 32 bit."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524176687, "post_id": 49908098, "comment_id": 86878084, "body": "<a href=\"https://stackoverflow.com/questions/21343774/importerror-no-module-named-win32api\" title=\"importerror no module named win32api\">stackoverflow.com/questions/21343774/&hellip;</a>"}], "owner": {"reputation": 65, "user_id": 4293751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff00f9dde03a705aa9aa778170cb8a78?s=128&d=identicon&r=PG&f=1", "display_name": "SBF12345", "link": "https://stackoverflow.com/users/4293751/sbf12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524081862, "creation_date": 1524081648, "last_edit_date": 1524081862, "question_id": 49908098, "link": "https://stackoverflow.com/questions/49908098/extracting-an-excel-file-from-html-in-python", "title": "extracting an excel file from html in python", "body": "<p>I would like to open and copy an excel file (.xls) from a website in python.</p>\n\n<p>I have the following code below:</p>\n\n<pre><code>import requests \n\npage = requests.get(\"https://fred.stlouisfed.org/series/IC4WSA\")\n\nfrom bs4 import BeautifulSoup\n\nsoup = BeautifulSoup(page.content, 'html.parser')\n\nfor link in soup.find_all('a'):\nprint(link.get('href'))\n</code></pre>\n\n<p>I have located string characters representing the href link to the excel file in the print line.</p>\n\n<p>I would like to be able to open the excel workbook associated with the href and transfer the contents of the excel workbook to another excel workbook.  If possible I might also like to run a VBA macro to affect the updated excel workbook.</p>\n\n<p>My question: how do I select and open the excel file using python and once open tranfer the data to another workbook or run a vba subroutine to create a final product?  Overall I am trying to build a simple and effective scraper of excel files with python.  If there are other structures or logical approaches I am interested to hear of those too.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "edited": false, "score": 1, "creation_date": 1524081384, "post_id": 49907940, "comment_id": 86831900, "body": "Your code doesn&#39;t look wrong, is the workbook opened in the same application ? is it correctly created with the input name ? Or is it a sheet ? Moreover, in your code, you&#39;re setting up a <code>wb</code> so use it in the <code>with</code> statement imo."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1524081891, "post_id": 49907940, "comment_id": 86832147, "body": "If you are attempting to create a new workbook and assign a specific name to it, then use <code>Workbooks.Add</code> to create it and then <code>Save</code> it with the specified name."}, {"owner": {"reputation": 1, "user_id": 9666278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Riley Sittler", "link": "https://stackoverflow.com/users/9666278/riley-sittler"}, "reply_to_user": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "edited": false, "score": 0, "creation_date": 1524084461, "post_id": 49907940, "comment_id": 86833461, "body": "Hi @JeanRostan, it looks fine to me as well. Even when I save the temporary file and give it a proper name in excel format I run into the same issue. I receive a run-time error &#39;9&#39; subscript out of range and line containing      &quot;set wb = Workbooks(x)&quot;  flags yellow"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9666278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Riley Sittler", "link": "https://stackoverflow.com/users/9666278/riley-sittler"}, "edited": false, "score": 0, "creation_date": 1524084345, "post_id": 49908341, "comment_id": 86833407, "body": "Hi Gary, unfortunately this is not the issue. The temporary workbook has already been opened at this point. What I would like to do is have a separate sheet already open in which executes the macro. I use the name of the tmp file and in my input box in order for my code to sort and tally certain items with in it. Similar to that of having input the code straight into the temporary sheet. It seems trivial but I run dozens of these reports a day and this would save a lot of time."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1, "user_id": 9666278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Riley Sittler", "link": "https://stackoverflow.com/users/9666278/riley-sittler"}, "edited": false, "score": 0, "creation_date": 1524085132, "post_id": 49908341, "comment_id": 86833759, "body": "Is my <b>EDIT#1</b> of any value??"}, {"owner": {"reputation": 1, "user_id": 9666278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Riley Sittler", "link": "https://stackoverflow.com/users/9666278/riley-sittler"}, "edited": false, "score": 0, "creation_date": 1524086501, "post_id": 49908341, "comment_id": 86834286, "body": "Yes somewhat! So it is now working for files saved as excel files. However it is not working for the temporary excel files. This isn&#39;t a huge issue - if you&#39;re curious the files are defaulted to save as &quot;text (tab delimited)&quot; files. I assume this is the issue as the extension is what was throwing me off for the files saved as excel files. Is there an extension that I could use which would allow me to access the text files?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1, "user_id": 9666278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Riley Sittler", "link": "https://stackoverflow.com/users/9666278/riley-sittler"}, "edited": false, "score": 0, "creation_date": 1524087006, "post_id": 49908341, "comment_id": 86834516, "body": "@RileySittler  See my <b>EDIT#2</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1524086966, "last_edit_date": 1524086966, "creation_date": 1524082622, "answer_id": 49908341, "question_id": 49907940, "link": "https://stackoverflow.com/questions/49907940/assigning-variable-workbook-name-with-inputbox-vba/49908341#49908341", "title": "Assigning variable workbook name with Inputbox VBA", "body": "<p>If you are attempting to create a new temporary workbook and assign a filename to it then try:</p>\n\n<pre><code>Sub MyMacro()\n\n    Dim X As String\n    X = InputBox(\"Set work book name\")\n    Workbooks.Add\n\n    ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\garys\\Desktop\\\" &amp; X &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n\n    With ActiveWorkbook\n        'code is entered here'\n    End With\nEnd Sub\n</code></pre>\n\n<p><em>(Of course, you would use your own folder-name and your file-type)</em></p>\n\n<p><strong>EDIT#1:</strong>\nspecifically in your code, try replacing:</p>\n\n<pre><code>With Workbooks(x)\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>With Workbooks(x &amp; \".xlsx\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>With Workbooks(x &amp; \".xlsm\")\n</code></pre>\n\n<p><strong>EDIT#2:</strong></p>\n\n<p>If you are save as text, then try:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\garys\\Desktop\\\" &amp; x &amp; \".txt\", FileFormat:=xlText, CreateBackup:=False\n</code></pre>\n\n<p>and refer like:</p>\n\n<pre><code>With Workbooks(x &amp; \".txt\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9666278, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Riley Sittler", "link": "https://stackoverflow.com/users/9666278/riley-sittler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1407, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524086966, "creation_date": 1524081120, "question_id": 49907940, "link": "https://stackoverflow.com/questions/49907940/assigning-variable-workbook-name-with-inputbox-vba", "title": "Assigning variable workbook name with Inputbox VBA", "body": "<p>I am looking to assign an input box string to a workbook name in order to manipulate data from one sheet to the next. For example, when I generate a report it is assigned a temporary file name \"tmp1\" \"tmp2\" etc. I would like to use another excel sheet as a program which will run a macro in order to sort, copy, etc. the newly generated file, with only having to enter the name of the temporary file \"tmp1\" etc.</p>\n\n<p>I am able to run the macro that I need and am familiar with the 'With' statements that will allow me to do so. my issue is when I run the following code:</p>\n\n<pre><code>Sub MyMacro()\nDim wb As Workbook\nDim X As String\nX = InputBox(\"Set work book name\")\nSet wb = Workbooks(X)\n\nWith Workbooks(x)\n.'code is entered here'\nEnd with\nEnd sub\n</code></pre>\n\n<p>I run into an object error. It seems I am incorrectly referencing the new file. Any help would be appreciated</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1524082587, "creation_date": 1524082587, "answer_id": 49908332, "question_id": 49907915, "link": "https://stackoverflow.com/questions/49907915/adding-paragraphs-after-inlineshapes/49908332#49908332", "title": "Adding paragraphs after InlineShapes", "body": "<p>No need to use <code>Select</code>- an <code>InlineShape</code> has a <code>Range</code> property, so something like this:</p>\n\n<pre><code>Dim ilsRange as Word.Range\n\nSet ilsRange = IShape.Range\nilsRange.InsertAfter vbCr\n</code></pre>\n\n<p>Or you can make it shorter, as long as you don't need to do anything else with the Range:</p>\n\n<pre><code>IShape.Range.InsertAfter vbCr\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7463112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff2a3b4f8ba1e376a524ae4e41300d71?s=128&d=identicon&r=PG&f=1", "display_name": "R. Ben", "link": "https://stackoverflow.com/users/7463112/r-ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 49908332, "answer_count": 1, "score": 0, "last_activity_date": 1593731231, "creation_date": 1524080983, "last_edit_date": 1593731231, "question_id": 49907915, "link": "https://stackoverflow.com/questions/49907915/adding-paragraphs-after-inlineshapes", "title": "Adding paragraphs after InlineShapes", "body": "<p>Alright, this may be an easy question but I can't get the answer. I have a couple of pictures, I believe Word considers them 'InlineShapes', there are no paragraphs to separate them; I need to add a paragraph between the InlineShapes so when I go and do 'Convert Text to Table' I can use the Paragraphs as separations.</p>\n\n<p>Here is part of the Code\nSub Resize()</p>\n\n<pre><code>'Resize barcodes to fit in labels\nApplication.ScreenUpdating = False\nDim Shap As Shape\nDim IShape As InlineShape\nDim countshapes As Long\nDim countinlineshapes As Long\n\n'Change Images into InlineShapes\nDo\n    countshapes = ActiveDocument.Shapes.Count\n    For Each Shap In ActiveDocument.Shapes\n        Shap.ConvertToInlineShape\n    Next Shap\n\nLoop Until countshapes = 0\n\n'Resizes the pictures(now InlineShapes) and add paragraphs\nFor Each IShape In ActiveDocument.InlineShapes\n    With IShape\n        .Width = InchesToPoints(2)\n        .Height = InchesToPoints(1.2)\n        .Select\n    End With\n    'Here is where I thought the Paragraph would be added\n    Selection.Paragraphs.Add\nNext IShape\n\n'Change Page Orientation\nActiveDocument.PageSetup.Orientation = wdOrientLandscape\n\n'Create Table\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 1, "creation_date": 1524080692, "post_id": 49907764, "comment_id": 86831501, "body": "Why do you want or need to be able to change at both places? Isn&#39;t it better to just change at one of the places and use a simple formula to keep the sheets connected?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524080879, "post_id": 49907764, "comment_id": 86831606, "body": "Think it&#39;s a case of extending the code example you posted, probably better to use the Workbook SheetChange event which will save you having a different bit of code for each sheet."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1524081060, "post_id": 49907764, "comment_id": 86831715, "body": "If you manage to get what you want, won&#39;t that create an endless loop? You update &quot;sheet1&quot;, the summary is automatically updated because of this, when the summary is updated the code notices it and updates &quot;sheet1&quot; again that again updates summary and so on."}, {"owner": {"reputation": 13, "user_id": 9666047, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i-Py8dCVD24/AAAAAAAAAAI/AAAAAAAAAMQ/dGShc1USJ4g/photo.jpg?sz=128", "display_name": "csaunders", "link": "https://stackoverflow.com/users/9666047/csaunders"}, "edited": false, "score": 0, "creation_date": 1524081333, "post_id": 49907764, "comment_id": 86831873, "body": "Fully agree that data entry in one place is the best design practice...however in this case I&#39;m trying something different."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 1, "creation_date": 1524081339, "post_id": 49907764, "comment_id": 86831875, "body": "You can turn off update events during a macro run though <code>Application.EnableEvents = False</code>"}, {"owner": {"reputation": 13, "user_id": 9666047, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i-Py8dCVD24/AAAAAAAAAAI/AAAAAAAAAMQ/dGShc1USJ4g/photo.jpg?sz=128", "display_name": "csaunders", "link": "https://stackoverflow.com/users/9666047/csaunders"}, "edited": false, "score": 0, "creation_date": 1524081488, "post_id": 49907764, "comment_id": 86831950, "body": "Also, the endless loop doesn&#39;t occur because it only does one update from the active worksheet...I think due to the Me.Range and  .EnableEvents False/True."}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1524081514, "post_id": 49907764, "comment_id": 86831963, "body": "One thing to keep in mind, when a macro has updated something on a sheet you can&#39;t undo. So any changes you do can&#39;t be undone."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9666047, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i-Py8dCVD24/AAAAAAAAAAI/AAAAAAAAAMQ/dGShc1USJ4g/photo.jpg?sz=128", "display_name": "csaunders", "link": "https://stackoverflow.com/users/9666047/csaunders"}, "edited": false, "score": 0, "creation_date": 1524087646, "post_id": 49907998, "comment_id": 86834780, "body": "Bang on! That&#39;s the exact behavior I was looking for. Great point to use the ThisWorkbook section too. Thanks so much for your advice!!"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1524081857, "last_edit_date": 1524081857, "creation_date": 1524081341, "answer_id": 49907998, "question_id": 49907764, "link": "https://stackoverflow.com/questions/49907764/sync-multipe-worksheets/49907998#49907998", "title": "Sync Multipe Worksheets", "body": "<p>Something like this is what you're looking for.  Make sure to place the code in the <code>ThisWorkbook</code> code module.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    Dim wsSummary As Worksheet\n    Dim rSummaryTable As Range\n    Dim rChanged As Range\n    Dim ChangedCell As Range\n    Dim wsTest As Worksheet\n\n    Set wsSummary = ThisWorkbook.Sheets(\"Sheet1\")   'Set to actual name of your Summary Sheet\n    Set rSummaryTable = wsSummary.Range(\"A:C\")      'Set to the actual columns you want to monitor in the Summary sheet\n\n    Application.EnableEvents = False\n\n    If Sh.Name = wsSummary.Name Then\n        Set rChanged = Intersect(rSummaryTable, Target)\n        If Not rChanged Is Nothing Then\n            For Each ChangedCell In rChanged.Cells\n                On Error Resume Next\n                Set wsTest = ThisWorkbook.Sheets(ChangedCell.Row + 1)\n                On Error GoTo 0\n                If wsTest Is Nothing Then Set wsTest = ThisWorkbook.Sheets.Add(After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n                wsTest.Cells(1, ChangedCell.Column).Value = ChangedCell.Value\n                wsSummary.Activate\n            Next ChangedCell\n        End If\n    Else\n        Set rChanged = Intersect(Sh.Range(rSummaryTable.Cells(1).Address).Resize(, rSummaryTable.Columns.Count), Target)\n        If Not rChanged Is Nothing Then\n            For Each ChangedCell In rChanged.Cells\n                rSummaryTable.Cells(Sh.Index - 1, ChangedCell.Column - rSummaryTable.Column + 1).Value = ChangedCell.Value\n            Next ChangedCell\n        End If\n    End If\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9666047, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i-Py8dCVD24/AAAAAAAAAAI/AAAAAAAAAMQ/dGShc1USJ4g/photo.jpg?sz=128", "display_name": "csaunders", "link": "https://stackoverflow.com/users/9666047/csaunders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "accepted_answer_id": 49907998, "answer_count": 1, "score": 1, "last_activity_date": 1524082093, "creation_date": 1524080383, "last_edit_date": 1524082093, "question_id": 49907764, "link": "https://stackoverflow.com/questions/49907764/sync-multipe-worksheets", "title": "Sync Multipe Worksheets", "body": "<p>I'm trying to get Excel VBA to do \"two-way\" updating of linked data between Worksheets. Sheet1 is a summary table and Sheet2,3,4... are more detailed data. The challenge is that data entry can occur two locations...in the Summary Sheet1, or in one of the connected Worksheets.</p>\n\n<p>As an analogy this could be like having an Annual Budget summary worksheet with supporting worksheets for each month's expenditures. However, data can be entered in either location. </p>\n\n<p>In a nutshell, if you are in Sheet1 and change the data, it will update Sheet2,Sheet3, Sheet4, etc. and if you are in Sheet2,Sheet3, Sheet4 and change the data, it will update summary table in Sheet1.</p>\n\n<p>I found a similar working solution that keeps a single cell A1 updated between Sheet1 and Sheet2:</p>\n\n<h2>Sheet1</h2>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Intersect(Target, Me.Range(\"A1\")) Is Nothing Then Exit Sub\nApplication.EnableEvents = False\nSheets(\"Sheet2\").Range(\"A1\").Value = Target.Value\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<h2>Sheet2</h2>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Intersect(Target, Me.Range(\"A1\")) Is Nothing Then Exit Sub\nApplication.EnableEvents = False\nSheets(\"Sheet1\").Range(\"A1\").Value = Target.Value\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>However, what I'm really after is a bigger version of this to have a \"summary table\" of rows of data in Sheet1 update/sync with multiple other worksheets. Each worksheet corresponds to a single row in the Sheet1 table. </p>\n\n<p>Here's a simplified example of what the worksheets contain.</p>\n\n<h2>Sheet1 \"Summary Table\"</h2>\n\n<pre><code>A1:C1 'Row 1 data in Summary Table {1,2,3}\nA2:C2 'Row 2 data in Summary Table {4,5,6}\nAi:Ci 'Row i data in Summary Table (7,8,9}\n</code></pre>\n\n<h2>Sheet2</h2>\n\n<pre><code>A1:C1 'Data Corresponding to Summary Table Row 1 {1,2,3}\n</code></pre>\n\n<h2>Sheet3</h2>\n\n<pre><code>A1:C1 'Data Corresponding to Summary Table Row 2 {4,5,6}\n</code></pre>\n\n<h2>Sheet4</h2>\n\n<pre><code>A1:C1 'Data Corresponding to Summary Table Row 3 {7,8,9}\n</code></pre>\n\n<p>Any advice on this problem would be much appreciated!\nThanks!</p>\n\n<p><a href=\"https://i.stack.imgur.com/qDScF.jpg\" rel=\"nofollow noreferrer\">Sheet1</a>\n<a href=\"https://i.stack.imgur.com/gszny.jpg\" rel=\"nofollow noreferrer\">Sheet2</a>\n<a href=\"https://i.stack.imgur.com/ll3DN.jpg\" rel=\"nofollow noreferrer\">Sheet3</a>\n<a href=\"https://i.stack.imgur.com/bWQPQ.jpg\" rel=\"nofollow noreferrer\">Sheet4</a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9666038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2852cdf15f263e12ba5cf17a06a5449f?s=128&d=identicon&r=PG&f=1", "display_name": "MKnudsen", "link": "https://stackoverflow.com/users/9666038/mknudsen"}, "edited": false, "score": 0, "creation_date": 1524130022, "post_id": 49912037, "comment_id": 86850152, "body": "Thanks, I&#39;ll go with your array code. Speedy solution"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1524108860, "last_edit_date": 1524108860, "creation_date": 1524106884, "answer_id": 49912037, "question_id": 49907745, "link": "https://stackoverflow.com/questions/49907745/excel-2016-vba-add-cell-in-front-of-transposed-data/49912037#49912037", "title": "Excel 2016 VBA - Add cell in front of transposed data", "body": "<p>If I understand correctly, you want a duplicate of column J to the left of the transposed row</p>\n\n<p>If so (and for 300,000 rows) I'd suggest using an array to transpose and copy all data:</p>\n\n<pre><code>Rows: 302,407; Time: 6.320 sec\n</code></pre>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub TransposeRows1()     'Fast (array)\n\n    Const SR = 2    'Start row\n\n    Dim ws As Worksheet, lr As Long, arr As Variant, r1 As Long, r2 As Long, tr As Long\n\n    Set ws = ActiveSheet\n\n    lr = ws.Cells(ws.Rows.Count, \"D\").End(xlUp).Row\n\n    arr = ws.Range(ws.Cells(SR, \"A\"), ws.Cells(lr, \"R\")).Formula    'Copy Range to Array\n\n    tr = 1\n    For r1 = 1 To lr Step 7\n        If r1 &lt; lr - 7 Then\n            arr(tr, 10) = arr(r1, 1) 'Col J (If empty replace arr(r1, 1) with vbNullString\n            arr(tr, 11) = arr(r1, 1) 'Col K\n            For r2 = 0 To 6\n                arr(tr, 12 + r2) = arr(r1 + r2, 4)  'Col M to R\n            Next r2\n            tr = tr + 1     'Next transposed row\n        End If\n    Next r1\n    ws.Range(ws.Cells(SR, \"A\"), ws.Cells(lr, \"R\")).Formula = arr    'Paste Array to Range\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Result</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xk2aX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xk2aX.png\" alt=\"Result\"></a></p>\n\n<hr>\n\n<p>.</p>\n\n<p>To fix your code:</p>\n\n<p><strong>V1</strong> - Copy / Paste column J at the end, or simply insert an empty column  before J</p>\n\n<pre><code>Rows: 302,407; Time: 43.516 sec\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub TransposeRows2()     'copy/paste J col at the end\n Dim ws As Worksheet, lr As Long, c As Long, t As Long\n\n Set ws = ActiveSheet\n lr = ws.Cells(ws.Rows.Count, \"D\").End(xlUp).Row\n c = 2\n t = 2\n Application.ScreenUpdating = False\n While c &lt;= lr\n  ws.Range(\"A\" &amp; c).Copy ws.Range(\"J\" &amp; t)\n  ws.Range(\"K\" &amp; t).Resize(, 7) = WorksheetFunction.Transpose(ws.Range(\"D\" &amp; c).Resize(7))\n  c = c + 7\n  t = t + 1\n Wend\n With ws.UsedRange\n    .Columns(\"J\").Copy\n    .Columns(\"K\").Insert Shift:=xlToRight\n    Application.CutCopyMode = False\n End With\n Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>V2</strong> - Insert J cells while iterating</p>\n\n<pre><code>Rows: 302,407; Time: 42.883 sec\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub TransposeRows3()     'insert J cell while looping\n Dim ws As Worksheet, lr As Long, c As Long, t As Long\n\n Set ws = ActiveSheet\n lr = ws.Cells(ws.Rows.Count, \"D\").End(xlUp).Row\n c = 2\n t = 2\n Application.ScreenUpdating = False\n While c &lt;= lr\n  ws.Range(\"A\" &amp; c).Copy ws.Range(\"J\" &amp; t &amp; \":K\" &amp; t)\n  ws.Range(\"L\" &amp; t).Resize(, 7) = WorksheetFunction.Transpose(ws.Range(\"D\" &amp; c).Resize(7))\n  c = c + 7\n  t = t + 1\n Wend\n Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9666038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2852cdf15f263e12ba5cf17a06a5449f?s=128&d=identicon&r=PG&f=1", "display_name": "MKnudsen", "link": "https://stackoverflow.com/users/9666038/mknudsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 49912037, "answer_count": 1, "score": 0, "last_activity_date": 1524108860, "creation_date": 1524080267, "last_edit_date": 1531164843, "question_id": 49907745, "link": "https://stackoverflow.com/questions/49907745/excel-2016-vba-add-cell-in-front-of-transposed-data", "title": "Excel 2016 VBA - Add cell in front of transposed data", "body": "<p>I have reused the code from <a href=\"https://stackoverflow.com/questions/37545372/excel-vba-code-to-transpose-data-from-rows-to-columns\">here</a> and added some code</p>\n\n<pre><code>Sub TransposeRows2()\nDim i&amp;, z&amp;, x&amp;\ni = Cells(Rows.Count, \"D\").End(xlUp).Row\nz = 1: x = 1\nWhile z &lt;= i\n    ' Added code\n    Range(\"A\" &amp; z).Select\n    Selection.Copy\n    Range(\"J\" &amp; x).Select\n    ActiveSheet.Paste\n    ' Added code end\n    Range(\"K\" &amp; x).Resize(, 7) = _\n        WorksheetFunction.Transpose(Range(\"D\" &amp; z).Resize(7))\n    z = z + 7: x = x + 1\nWend\nEnd Sub\n</code></pre>\n\n<p>To each transposed row I want to add a cell to the left. But doing this with the below code slows down the action (there is more than 300.000 rows). </p>\n\n<pre><code>Range(\"A\" &amp; z).Select\n    Selection.Copy\n    Range(\"J\" &amp; x).Select\n    ActiveSheet.Paste\n</code></pre>\n\n<p>Is there another way to add a cell to the left of each transposed row?</p>\n\n<p><strong>Original data</strong></p>\n\n<pre><code>Jumphost    Application License Key xxx-xxx\nJumphost    Application License Type    Std.\nJumphost    Application Product ID  xxx-xxx\nJumphost    Application Display Name    Juniper Networks  Inc.\nJumphost    Application Installation Date   20-10-2014\nJumphost    Application Publisher   Juniper Networks, Inc.\nJumphost    Application Version 2.1.1.1\n</code></pre>\n\n<p><strong>Transposed data</strong></p>\n\n<pre><code>Jumphost    xxx-xxx Std.    xxx-xxx Juniper Networks  Inc.  20-10-2014  Juniper Networks, Inc.  2.1.1.1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524079144, "post_id": 49907213, "comment_id": 86830683, "body": "<code>If Not Inputs Is Nothing Then</code> - Find() returns <code>Nothing</code> if there&#39;s no match found."}, {"owner": {"reputation": 3, "user_id": 9430289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12143e41d1f950c3a17095b908077f8a?s=128&d=identicon&r=PG&f=1", "display_name": "AGB04", "link": "https://stackoverflow.com/users/9430289/agb04"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524085043, "post_id": 49907213, "comment_id": 86833722, "body": "@TimWilliams Thank you.  I was using IsEmpty instead of Is Nothing and it wasn&#39;t reading the same way.  Code works great now.  If you put that in an answer, I will gladly check it as answered!"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1524085641, "creation_date": 1524085641, "answer_id": 49909026, "question_id": 49907213, "link": "https://stackoverflow.com/questions/49907213/table-information-transferred-between-multiple-sheets-vba/49909026#49909026", "title": "Table information transferred between multiple sheets VBA", "body": "<p>Use:</p>\n\n<pre><code>If Not Inputs Is Nothing Then \n</code></pre>\n\n<p>in place of</p>\n\n<pre><code>If Not IsEmpty(Inputs) Then\n</code></pre>\n\n<p><code>Find()</code> returns <code>Nothing</code> if there's no match found. </p>\n"}], "owner": {"reputation": 3, "user_id": 9430289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12143e41d1f950c3a17095b908077f8a?s=128&d=identicon&r=PG&f=1", "display_name": "AGB04", "link": "https://stackoverflow.com/users/9430289/agb04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 49909026, "answer_count": 1, "score": -1, "last_activity_date": 1524085641, "creation_date": 1524078198, "question_id": 49907213, "link": "https://stackoverflow.com/questions/49907213/table-information-transferred-between-multiple-sheets-vba", "title": "Table information transferred between multiple sheets VBA", "body": "<p>I have one table on sheet1[bss] and data feeds into a table that is split between two sheets [actv &amp; actv2].  I have a Range.Find function that based on bss.Range(F).Value and searches a range in actv and inputs the data in the respective row.  However, if the data is in actv2, I'm having issues on getting the code to search actv, if it's not found, go to actv2 and repeat the search.  I've tried multiple different ways and none seem to work when bss.Range(F) is in actv2.  I've done a single GoTo tag for when IsEmpty(Inputs) as well as Not IsEmpty, I've done double tags to send the loop there when if statements are true, This one is just embedded if statements:</p>\n\n<pre><code>Sub Roll_7300()\n\nDim oldactv As Worksheet\nDim oldactv2 As Worksheet\nDim actv As Worksheet\nDim actv2 As Worksheet\nDim bss As Worksheet\nDim BasisSST As Range ' Might not be used\nDim Inputs As Range\nDim Inputs2 As Range ' Sets the row for find in Activities\nDim EndRangeRE As Range\nDim EndRangeRE2 As Range ' Finds \"10 Other Costs\" in the input template\nDim EndRangeNRE As Range ' Finds \"Recurring Costs\" in the input template\nDim rngall As Range ' full used range in input template\nDim StartRangeNRE As Range\nDim StartRangeNRE2 As Range\nDim StartRangeRE As Range ' Finds \"Recurring Costs\" in the input template\nDim looprng As Range ' Range for the loop\nDim myRng As Range ' Range used in loop\nDim borderrng As Range ' Range for bordering\nDim BOE As Range ' Full used range in Basis of Estimate\nDim myRange As Range ' Range used in loop2\nDim BRow As Range ' Basis Row used in loop\nDim ARow As Range ' Activity Row used in loop\nDim newrow As Range\nDim newrow2 As Range\nDim FY16 As Variant\nDim FY17 As Variant\nDim FY18 As Variant\nDim FY19 As Variant\nDim FY20 As Variant\nDim FY21 As Variant\nDim FY22 As Variant\nDim FY23 As Variant\nDim FY24 As Variant\nDim actrng As Range\nDim Engineering As Range\nDim NRC As String\nDim Hyphen As Integer\nDim NREBasis As String\nDim looprng2 As Range\nDim rngall2 As Range\n\nSet oldactv = ActiveWorkbook.Sheets(\"7300 Part 1 Form\")\nSet oldactv2 = ActiveWorkbook.Sheets(\"7300 Part 2 Form\")\noldactv.UsedRange.Copy\nSheets.Add(After:=Sheets(\"7300 Part 2 Form\")).Activate\nActiveSheet.Name = \"7300 Part 1 Updated \" &amp; Format(Date, \"mm.dd.yy\")\nSet actv = ActiveWorkbook.Sheets(\"7300 Part 1 Updated \" &amp; Format(Date, \"mm.dd.yy\"))\nactv.Paste\noldactv2.UsedRange.Copy\nSheets.Add(After:=Sheets(\"7300 Part 1 Updated \" &amp; Format(Date, \"mm.dd.yy\"))).Activate\nActiveSheet.Name = \"7300 Part 2 Updated \" &amp; Format(Date, \"mm.dd.yy\")\nSet actv2 = ActiveWorkbook.Sheets(\"7300 Part 2 Updated \" &amp; Format(Date, \"mm.dd.yy\"))\nactv2.Paste\n\n\nSet bss = ActiveWorkbook.Sheets(\"{Activity} Basis of Estimate\")\n\nactv.Activate\nSet rngall = actv.UsedRange\nSet EndRangeRE = rngall.Find(What:=\"10. Other Cost\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\nSet EndRangeNRE = rngall.Find(What:=\"Recurring Costs\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\nSet StartRangeNRE = rngall.Find(What:=\"Non-Recurring Costs\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\nSet StartRangeRE = rngall.Find(What:=\"Recurring Costs\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\nSet looprng = actv.Range(StartRangeNRE, EndRangeRE)\nSet borderrng = actv.Range(looprng, looprng.Offset(0, 3))\nlooprng.UnMerge\nactv2.Activate\nSet rngall2 = actv2.UsedRange\nSet EndRangeRE2 = rngall2.Find(What:=\"TOTAL (Recurring and Non Recurring):  \", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\nSet StartRangeNRE2 = rngall2.Find(What:=\"Non-Recurring Costs\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\nSet looprng2 = actv2.Range(StartRangeNRE2, EndRangeRE2)\nlooprng2.UnMerge\n\nSet BOE = bss.UsedRange.Offset(4, 2)\n\nbss.Activate\nDo\nFor Each BRow In BOE.Rows\n    Set Engineering = bss.Range(\"D\" &amp; BRow.Row)\n    Set BasisSST = bss.Range(\"F\" &amp; BRow.Row)\n    Set FY16 = bss.Range(\"AD\" &amp; BRow.Row)\n    Set FY17 = bss.Range(\"AE\" &amp; BRow.Row)\n    Set FY18 = bss.Range(\"AF\" &amp; BRow.Row)\n    Set FY19 = bss.Range(\"AG\" &amp; BRow.Row)\n    Set FY20 = bss.Range(\"AH\" &amp; BRow.Row)\n    Set FY21 = bss.Range(\"AI\" &amp; BRow.Row)\n    Set FY22 = bss.Range(\"AJ\" &amp; BRow.Row)\n    Set FY23 = bss.Range(\"AK\" &amp; BRow.Row)\n    Set FY24 = bss.Range(\"AL\" &amp; BRow.Row)\n actv.Activate\n Set Inputs = looprng.Find(What:=\"BasisSST\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\n actv2.Activate\n Set Inputs2 = looprng2.Find(What:=\"BasisSST\", LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\n If Not IsEmpty(Inputs) Then\n    If Engineering = \"NRE\" Then\n        bss.Activate\n          NRC = BasisSST\n          Hyphen = InStr(NRC, \"-\")\n          NREBasis = Mid(NRC, Hyphen + 1)\n        actv.Activate\n          Set Inputs = looprng.Find(What:=NREBasis, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\n          Set newrow = Inputs.EntireRow\n            newrow.Cells(10).Value = FY16 + newrow.Cells(10)\n            newrow.Cells(11).Value = FY17 + newrow.Cells(11)\n            newrow.Cells(12).Value = FY18 + newrow.Cells(12)\n            newrow.Cells(13).Value = FY19 + newrow.Cells(13)\n            newrow.Cells(14).Value = FY20 + newrow.Cells(14)\n            newrow.Cells(15).Value = FY21 + newrow.Cells(15)\n            newrow.Cells(16).Value = FY22 + newrow.Cells(16)\n            newrow.Cells(17).Value = FY23 + newrow.Cells(17)\n            newrow.Cells(18).Value = FY24 + newrow.Cells(18)\n    Else\n        actv.Activate\n          Set Inputs = looprng.Find(What:=BasisSST, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\n            If BasisSST = \"1.1 Equipment\" Then\n              Set newrow = Inputs.Offset(1, 0).EntireRow\n                  newrow.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromRightOrBelow\n                  newrow.Offset(-1, 0).Cells(1).Value = BasisSST\n                  newrow.Offset(-1, 0).Cells(10).Value = FY16\n                  newrow.Offset(-1, 0).Cells(11).Value = FY17\n                  newrow.Offset(-1, 0).Cells(12).Value = FY18\n                  newrow.Offset(-1, 0).Cells(13).Value = FY19\n                  newrow.Offset(-1, 0).Cells(14).Value = FY20\n                  newrow.Offset(-1, 0).Cells(15).Value = FY21\n                  newrow.Offset(-1, 0).Cells(16).Value = FY22\n                  newrow.Offset(-1, 0).Cells(17).Value = FY23\n                  newrow.Offset(-1, 0).Cells(18).Value = FY24\n            Else\n              Set newrow = Inputs.EntireRow\n                newrow.Cells(10).Value = FY16 + newrow.Cells(10)\n                newrow.Cells(11).Value = FY17 + newrow.Cells(11)\n                newrow.Cells(12).Value = FY18 + newrow.Cells(12)\n                newrow.Cells(13).Value = FY19 + newrow.Cells(13)\n                newrow.Cells(14).Value = FY20 + newrow.Cells(14)\n                newrow.Cells(15).Value = FY21 + newrow.Cells(15)\n                newrow.Cells(16).Value = FY22 + newrow.Cells(16)\n                newrow.Cells(17).Value = FY23 + newrow.Cells(17)\n                newrow.Cells(18).Value = FY24 + newrow.Cells(18)\n            End If\n    End If\n  ElseIf Not IsEmpty(Inputs2) Then\n    actv2.Activate\n      Set Inputs = looprng2.Find(What:=BasisSST, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=True)\n      Set newrow2 = Inputs.EntireRow\n         newrow2.Cells(7).Value = FY16 + newrow2.Cells(7)\n         newrow2.Cells(8).Value = FY17 + newrow2.Cells(8)\n         newrow2.Cells(9).Value = FY18 + newrow2.Cells(9)\n         newrow2.Cells(10).Value = FY19 + newrow2.Cells(10)\n         newrow2.Cells(11).Value = FY20 + newrow2.Cells(11)\n         newrow2.Cells(12).Value = FY21 + newrow2.Cells(12)\n         newrow2.Cells(13).Value = FY22 + newrow2.Cells(13)\n         newrow2.Cells(14).Value = FY23 + newrow2.Cells(14)\n         newrow2.Cells(15).Value = FY24 + newrow2.Cells(15)\n  End If\nNext BRow\nLoop Until IsEmpty(BasisSST)\n\nEnd Sub\n</code></pre>\n\n<p>Any help you can provide would be greatly appreciated.  I've thought about doing a Select Case but haven't tried that yet.  Thanks all!</p>\n"}, {"tags": ["vba", "date", "syntax", "formatting", "conditional"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1524078916, "post_id": 49907210, "comment_id": 86830556, "body": "Change Formula1:=&quot;=$A$2&quot;, Formula2:=&quot;=$B$2&quot;, to Formula1:=&quot;=$A2&quot;, Formula2:=&quot;=$B2&quot;, so that the rows are relative.  Can&#39;t you just use numrows to get a range to select?  Range(&quot;F2:AC&quot; &amp; numrows).select, then apply your conditions to the the entire range."}, {"owner": {"reputation": 69, "user_id": 7681900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f262d5942a0cded58e75c4f9309afa63?s=128&d=identicon&r=PG&f=1", "display_name": "Scott H", "link": "https://stackoverflow.com/users/7681900/scott-h"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1524147127, "post_id": 49907210, "comment_id": 86862220, "body": "I wound up doing this.  the &quot;$&quot; changes weren&#39;t working consistently but that was tied to data format issues I think.  Oh.. and something else had it only selecting some cells.  Not all of them."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524147701, "post_id": 49923348, "comment_id": 86862663, "body": "Get rid of  Range(&quot;F2&quot;).Select it serves no purpose here and be aware you are implicitly referencing the activesheet. You might want to explicitly reference the sheet by its name."}], "tags": [], "owner": {"reputation": 69, "user_id": 7681900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f262d5942a0cded58e75c4f9309afa63?s=128&d=identicon&r=PG&f=1", "display_name": "Scott H", "link": "https://stackoverflow.com/users/7681900/scott-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1524147623, "last_edit_date": 1524147623, "creation_date": 1524147315, "answer_id": 49923348, "question_id": 49907210, "link": "https://stackoverflow.com/questions/49907210/vba-syntax-to-reference-cell-on-same-row-inside-conditional-format/49923348#49923348", "title": "VBA syntax to reference cell on same row inside conditional format", "body": "<p>this worked perfectly.</p>\n\n<pre><code>Sub Conditions2()\n\n    Dim numrows As Long\n\n    Range(\"F2\").Select\n\n    numrows = Range(\"F2\", Range(\"F2\").End(xlDown)).Rows.Count\n\n    With Range(\"F2\", Range(\"F2\").End(xlToRight)).Resize(numrows)\n        With .FormatConditions.Add(Type:=xlCellValue, Operator:=xlBetween, Formula1:=\"=$A2\", Formula2:=\"=$B2\")\n            .SetFirstPriority\n            With .Font\n                .Color = -16383844\n                .TintAndShade = 0\n            End With\n            With .Interior\n                .PatternColorIndex = xlAutomatic\n                .Color = 13551615\n                .TintAndShade = 0\n            End With\n            .StopIfTrue = False\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7681900, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f262d5942a0cded58e75c4f9309afa63?s=128&d=identicon&r=PG&f=1", "display_name": "Scott H", "link": "https://stackoverflow.com/users/7681900/scott-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524147623, "creation_date": 1524078177, "question_id": 49907210, "link": "https://stackoverflow.com/questions/49907210/vba-syntax-to-reference-cell-on-same-row-inside-conditional-format", "title": "VBA syntax to reference cell on same row inside conditional format", "body": "<p>I'm trying to create a VBA Macro to automate part of a large process.  I can do it manually but it isn't practical as there are 27K rows.</p>\n\n<p>I have a range of dates in columns F through AC.  I'm trying to use conditional formatting to color the ones that fall between the dates in columns A and B on the same row.  IE:  Row 2 (1 is headers) A2 and B2 are dates that span one year.  F2:AC2 are filled with dates that may or may not fall in that range.  Turn the ones that do red (pink red text or what ever).  Continue for the next 27K rows.</p>\n\n<p>What I have is working on a 57 item sample Except that it only references the original hard coded selections from the macro recording.  I'm struggling with the syntax to make it dynamic.</p>\n\n<pre><code>[code]Sub Conditions()\n</code></pre>\n\n<p>'\n    ' Conditional format\n'</p>\n\n<pre><code>    Dim x As Integer\n    Application.ScreenUpdating = False\n    NumRows = Range(\"F2\", Range(\"F2\").End(xlDown)).Rows.Count\n\n    'Range(\"F2\").Select\n    'Range((\"F2\"), Selection.End(xlToRight)).Select\n\n\n    Range(\"F2\").Select\n    Range((\"F2\"), Selection.End(xlToRight)).Select \n\nFor x = 1 To NumRows\n        Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlBetween, _\n        Formula1:=\"=$A$2\", Formula2:=\"=$B$2\"\n        'Formula1:=\"=ActiveCell.Offset(0,-5)\", Formula2:=\"=ActiveCell.Offset(0,-4)\" '&lt;---- offset from active cell\n\n    Selection.FormatConditions    (Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Font\n        .Color = -16383844\n        .TintAndShade = 0\n    End With\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 13551615\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n\n        ActiveCell.Offset(1, 0).Select\n        Range(ActiveCell, ActiveCell.End(xlToRight)).Select\n    Next\n    Application.ScreenUpdating = True\nEnd Sub [code]\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1524081948, "post_id": 49907155, "comment_id": 86832181, "body": "You may need to completely change the way you create your chart, as you can&#39;t programatically switch x and y values (I don&#39;t <i>think</i>). Basically you&#39;re trying to switch your Y and X values, right?"}, {"owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1524137900, "post_id": 49907155, "comment_id": 86855712, "body": "Not really switch but instead treat the data differently. It want to treat data that is in words, as numbers.  It still places it on the correct axis, but rather than showing in months (Jan. Feb. Mar.) it shows it as number where (Jan.=1 Feb.=2 Mar.=3 etc.)"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524077982, "creation_date": 1524077982, "last_edit_date": 1531164843, "question_id": 49907155, "link": "https://stackoverflow.com/questions/49907155/converting-numerical-bar-column-graph-axis-to-text-axis-vba", "title": "Converting numerical bar (column) graph axis to Text Axis VBA", "body": "<p>Hi so I wrote this today to create a bar graph based on some data in my sheet but it is treating my column of months as numbers (instead labeling the x axis with 1-12). Is there a way to manipulate it to take the column as text and therefore make the axis \"January, February, Etc.\" </p>\n\n<p>This could also apply to names of binned data I suppose.</p>\n\n<pre><code>'Create Range for Y\n   Dim rng1Y As Range, rng2Y As Range\n   Dim Y_Range As Range\n\nWith ThisWorkbook.Sheets(\"Graphs\")\nSet rng1Y = .Cells(1, A + 7)\n\n' Prevents Crashing if no data is in column\n    If Cells(1, A + 7) = \"\" Then\n\n    Else\n\n    Set rng2Y = .Cells(1, A + 7).End(xlDown)\n\n    Set Y_Range = .Range(rng1Y.Address &amp; \":\" &amp; rng2Y.Address)\n    Y_Range.Select\n\n    End If\n\n\n'Adds a second Series if needed\nIf Cells(2, A + 8) = \"\" Then\n\nElse\n\n 'Create Range for X\n    Dim rng1X As Range, rng2X As Range\n    Dim X_Range As Range\n\nWith ThisWorkbook.Sheets(\"Graphs\")\nSet rng1X = .Cells(1, A + 8)\n\n'prevents crashing if no data is in column\nIf Cells(2, A + 8) = \"\" Then\n\nElse\n\nSet rng2X = .Cells(1, A + 8).End(xlDown)\n\nSet X_Range = .Range(rng1X.Address &amp; \":\" &amp; rng2X.Address)\nX_Range.Select\n\nEnd If\n\n\n ' Creates full range for Bar graph\nSet Total_Range = .Range(Y_Range.Address &amp; \":\" &amp; X_Range.Address)\n\nTotal_Range.Select\n\nEnd With\n'-------------------------------------------------------------------------\n\n'Build chart\n\nDim Sh As Worksheet\nDim chrt As Chart\n\nSet chrt = Nothing\nSet Sh = ActiveWorkbook.Worksheets(\"Graphs\")\nSet chrt = Sh.Shapes.AddChart.Chart\nWith chrt\n\n\n    'Titles\n    .HasTitle = True\n    .ChartTitle.Characters.Text = Cells(i + 12, 2).Value\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Title Here X\"\n    .Axes(xlValue, xlPrimary).HasTitle = True\n    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Title here Y\"\n    .Axes(xlCategory).HasMajorGridlines = True\n    .HasLegend = True\n\n    End With\nEnd If\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1524077739, "post_id": 49907026, "comment_id": 86829975, "body": "Step through it with <code>F8</code>, after the first iteration what happens? Also, remove the <code>On Error Resume Next</code> and let us know if any errors are thrown.  Alternatively, do a <code>For i = 1 to 14 &#47;&#47; [your code] &#47;&#47; next i</code> instead of a <code>While</code> loop."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524077831, "post_id": 49907026, "comment_id": 86830017, "body": "What is <code>OutMail</code> ?  Once it&#39;s sent the first time, you can&#39;t send it again.  You&#39;ll need to create a new mail item for each iteration through the loop.  Also this type of loop is exactly what a <code>For...Next</code> loop is intended for: using <code>Do While...Loop</code> is a bit confusing."}, {"owner": {"reputation": 49, "user_id": 8644263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd3da17d34cc08f95c2b8afe2008eff3?s=128&d=identicon&r=PG&f=1", "display_name": "Schott.Ben", "link": "https://stackoverflow.com/users/8644263/schott-ben"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524078516, "post_id": 49907026, "comment_id": 86830340, "body": "@TimWilliams Outmail is &quot;Set OutMail = OutApp.CreateItem(0)&quot;"}, {"owner": {"reputation": 49, "user_id": 8644263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd3da17d34cc08f95c2b8afe2008eff3?s=128&d=identicon&r=PG&f=1", "display_name": "Schott.Ben", "link": "https://stackoverflow.com/users/8644263/schott-ben"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1524078839, "post_id": 49907026, "comment_id": 86830506, "body": "@BruceWayne When I ran the program without the On Error Resume I got Run Time Error -2147221238 The Item has been moved or deleted"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1524081239, "post_id": 49907379, "comment_id": 86831820, "body": "Tangential question - I personally prefer the <code>For x = y to z</code> loop over a <code>Do while ...</code> loop. I notice you switched the <code>while</code> loop out for a <code>for</code> loop -- is that personal preference as well, or are there performance or some other differences too?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1524082481, "post_id": 49907379, "comment_id": 86832472, "body": "Hi @BruceWayne - I noticed your comment after I&#39;d posted mine on the same topic.  I guess it&#39;s just convention to use a <code>For...Next</code> when the number of iterations is pre-determined as in this case.  <code>Do While...Loop</code> is better suited when the number of iterations is determined only as the loop iterates."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1524078804, "creation_date": 1524078804, "answer_id": 49907379, "question_id": 49907026, "link": "https://stackoverflow.com/questions/49907026/vba-excel-sending-more-than-one-email/49907379#49907379", "title": "VBA Excel Sending More than one Email", "body": "<pre><code>Dim i As Long\n\nFor i = 1 To 14\n    With OutApp.CreateItem(0)\n        .to = SupervisorAddress(i)\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"QTF Expired\"\n        .Body = Body(i)\n        'You can add a file like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send   'or use .Display\n    End With\nNext\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 8644263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cd3da17d34cc08f95c2b8afe2008eff3?s=128&d=identicon&r=PG&f=1", "display_name": "Schott.Ben", "link": "https://stackoverflow.com/users/8644263/schott-ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 49907379, "answer_count": 1, "score": 0, "last_activity_date": 1524078804, "creation_date": 1524077564, "question_id": 49907026, "link": "https://stackoverflow.com/questions/49907026/vba-excel-sending-more-than-one-email", "title": "VBA Excel Sending More than one Email", "body": "<p>I am attempting to write a program that sends different managers emails regaurding their information. For some rease the program will send only one email out and say it is completed with no errors. How do I make it send all 14 emails. Right now the emails are all pointed at my direct email address. Please Help!</p>\n\n<pre><code>Dim i As Integer\ni = 1\n\nDo While i &lt;&gt; 14\nOn Error Resume Next\nWith OutMail\n    .to = SupervisorAddress(i)\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"QTF Expired\"\n    .Body = Body(i)\n    'You can add a file like this\n    '.Attachments.Add (\"C:\\test.txt\")\n    .Send   'or use .Display\nEnd With\nOn Error GoTo 0\ni = i + 1\nLoop\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 0, "creation_date": 1524076763, "post_id": 49906665, "comment_id": 86829443, "body": "Can you try using <code>oPivot.PivotCache.Refresh</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "reply_to_user": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 0, "creation_date": 1524082364, "post_id": 49906665, "comment_id": 86832414, "body": "That does not work unfortunately"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "edited": false, "score": 0, "creation_date": 1524080889, "post_id": 49906848, "comment_id": 86831613, "body": "The line &quot;Next pivot_table&quot; highlights and states the error message (Invalid Next control Variable reference&quot;.  Any ideas?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1524082080, "post_id": 49906848, "comment_id": 86832253, "body": "Change that to <code>Next oPivot</code>"}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 0, "creation_date": 1524085420, "post_id": 49906848, "comment_id": 86833883, "body": "Updated, forgot to change the last variable name"}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": true, "score": 0, "last_activity_date": 1524085401, "last_edit_date": 1524085401, "creation_date": 1524076947, "answer_id": 49906848, "question_id": 49906665, "link": "https://stackoverflow.com/questions/49906665/refreshing-two-pivot-tables-on-a-sheet-whenever-the-sheet-is-selected/49906848#49906848", "title": "Refreshing Two Pivot Tables on a Sheet whenever the sheet is selected", "body": "<p>This method works:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\nDim oPivot As PivotTable\nDim xlsheet As Worksheet\n\nSet xlsheet = ActiveSheet\n\nFor Each oPivot In xlsheet.PivotTables\n    oPivot.PivotCache.Refresh\nNext oPivot \n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 49906848, "answer_count": 1, "score": 0, "last_activity_date": 1524085401, "creation_date": 1524076198, "question_id": 49906665, "link": "https://stackoverflow.com/questions/49906665/refreshing-two-pivot-tables-on-a-sheet-whenever-the-sheet-is-selected", "title": "Refreshing Two Pivot Tables on a Sheet whenever the sheet is selected", "body": "<p>I have two PivotTables on a sheet that I would like to have refreshed automatically whenever the sheet is open.  I've put that macro this macro within that sheet.  However, I am getting an error on this line \"oPivot.RefreshTable\"</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\nDim oSheet As Worksheet\nDim oPivot As PivotTable\n\nSet oSheet = ActiveSheet\n\nFor Each oPivot In oSheet.PivotTables\n    oPivot.RefreshTable\nNext oPivot\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1524119547, "post_id": 49905952, "comment_id": 86843792, "body": "Have you seen the <code>Report_NoData()</code> event of the report if it&#39;s of any use? You can print text on the report or even change the recordset if that&#39;s the case."}], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1524135958, "post_id": 49906627, "comment_id": 86854360, "body": "I have already incorporated a solution like that. When there is no record, the sub report will generate a line indicating &quot;No Records Found&quot;, which ultimately shows the subreport. But I am thinking for another possibility to show the subreport even without any records in it."}, {"owner": {"reputation": 241, "user_id": 7297332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VB8cW.jpg?s=128&g=1", "display_name": "jshort", "link": "https://stackoverflow.com/users/7297332/jshort"}, "reply_to_user": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "edited": false, "score": 0, "creation_date": 1524151847, "post_id": 49906627, "comment_id": 86865666, "body": "You could have the subreport based on a results table. If there are no records found in your query you could put a &quot;No result&quot; entry in the table."}], "tags": [], "owner": {"reputation": 241, "user_id": 7297332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VB8cW.jpg?s=128&g=1", "display_name": "jshort", "link": "https://stackoverflow.com/users/7297332/jshort"}, "is_accepted": true, "score": 0, "last_activity_date": 1524076054, "creation_date": 1524076054, "answer_id": 49906627, "question_id": 49905952, "link": "https://stackoverflow.com/questions/49905952/return-a-string-when-no-record-found-in-select-query/49906627#49906627", "title": "Return a string when no record found in SELECT query", "body": "<p>Instead of trying to make the query give a result for no records you could have some VBA test for results:</p>\n\n<pre><code>Set myRecordset = db.OpenRecordset(mySQLquery)\n\n If myRecordset.RecordCount = 0 Then\n     MsgBox \"No records for this selection\"\nEnd If\n</code></pre>\n\n<p>Without knowing the particulars of your database it may also be possible to have a summary query that counts the number of records for each instance, then make another query based on that query with a SWITCH to give a text output:</p>\n\n<pre><code>Switch(numRecords=0,\"To Be Improved\",numRecords&gt;0,\"We good\") AS To_Be_Improved\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 3323922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d8bc71a162eb74603e49f3f626132cfb?s=128&d=identicon&r=PG&f=1", "display_name": "user3323922", "link": "https://stackoverflow.com/users/3323922/user3323922"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 49906627, "answer_count": 1, "score": 1, "last_activity_date": 1524076054, "creation_date": 1524073564, "question_id": 49905952, "link": "https://stackoverflow.com/questions/49905952/return-a-string-when-no-record-found-in-select-query", "title": "Return a string when no record found in SELECT query", "body": "<p>I have a select query in Access VBA. This query is a record source for a report. This report is a Sub Report of a Sub Report. I need the query to produce a string when there is no record exist for any particular search. Therefore, this subreport could be shown in the main report</p>\n\n<p>Query Name: Qry_To_Be_Imoroved. </p>\n\n<pre><code>SELECT To_Be_Improved.To_Be_Improved, To_Be_Improved.Record_ID, To_Be_Improved.ID\nFROM To_Be_Improved\nWHERE (((To_Be_Improved.Record_ID)=[Reports]![Incident_Report_Updated]![Record_ID]));\n</code></pre>\n\n<p>How can I amend this to add a string to \"To_Be_Improved\" column when there is no record for a query. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1524074858, "post_id": 49905794, "comment_id": 86828389, "body": "Perhaps :Rng.Offset(0, xOffsetColumn).Value = &quot;WEEK &quot; &amp;  Application.WorksheetFunction.WeekNum(Now)"}, {"owner": {"reputation": 29, "user_id": 9068633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oBvBUitVZjE/AAAAAAAAAAI/AAAAAAAADxk/kjjgfYLy2y8/photo.jpg?sz=128", "display_name": "Tomasz Kozuch", "link": "https://stackoverflow.com/users/9068633/tomasz-kozuch"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1524076775, "post_id": 49905794, "comment_id": 86829454, "body": "Yup that works, but <code>Application.WorksheetFunction.WeekNum(Now)</code> returns &quot;16&quot; which is the current week number of the year. Any idea how to get the week number of the current month??"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1524076857, "post_id": 49905794, "comment_id": 86829506, "body": "It depends on how you define the first week of the month."}, {"owner": {"reputation": 29, "user_id": 9068633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oBvBUitVZjE/AAAAAAAAAAI/AAAAAAAADxk/kjjgfYLy2y8/photo.jpg?sz=128", "display_name": "Tomasz Kozuch", "link": "https://stackoverflow.com/users/9068633/tomasz-kozuch"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1524076918, "post_id": 49905794, "comment_id": 86829539, "body": "Starting with the first monday of the month."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1524076975, "post_id": 49905794, "comment_id": 86829578, "body": "So you want <b>Monday</b> to be the first day of the week?"}, {"owner": {"reputation": 29, "user_id": 9068633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oBvBUitVZjE/AAAAAAAAAAI/AAAAAAAADxk/kjjgfYLy2y8/photo.jpg?sz=128", "display_name": "Tomasz Kozuch", "link": "https://stackoverflow.com/users/9068633/tomasz-kozuch"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1524078020, "post_id": 49905794, "comment_id": 86830117, "body": "Yes, this makes this week the 3rd week of the month. If you look at May, May 7th would be the first week of that month starting with Monday."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1524078461, "post_id": 49905794, "comment_id": 86830311, "body": "Please see barry&#39;s answer here:  <a href=\"https://stackoverflow.com/questions/20620712/excel-formula-to-get-week-number-in-month-having-monday\" title=\"excel formula to get week number in month having monday\">stackoverflow.com/questions/20620712/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 9068633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oBvBUitVZjE/AAAAAAAAAAI/AAAAAAAADxk/kjjgfYLy2y8/photo.jpg?sz=128", "display_name": "Tomasz Kozuch", "link": "https://stackoverflow.com/users/9068633/tomasz-kozuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1524079408, "creation_date": 1524079408, "answer_id": 49907535, "question_id": 49905794, "link": "https://stackoverflow.com/questions/49905794/text-followed-by-week-number-of-the-month/49907535#49907535", "title": "Text followed by Week number of the month", "body": "<p>Changed <code>Application.WorksheetFunction.WeekNum(Now)</code> for <code>Int((6 + Day(Date + 1 - Weekday(Date - 1))) / 7)</code> to correctly output current week number of the month starting with <strong>Monday</strong>.</p>\n"}], "owner": {"reputation": 29, "user_id": 9068633, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-oBvBUitVZjE/AAAAAAAAAAI/AAAAAAAADxk/kjjgfYLy2y8/photo.jpg?sz=128", "display_name": "Tomasz Kozuch", "link": "https://stackoverflow.com/users/9068633/tomasz-kozuch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1524079408, "creation_date": 1524072944, "last_edit_date": 1524079089, "question_id": 49905794, "link": "https://stackoverflow.com/questions/49905794/text-followed-by-week-number-of-the-month", "title": "Text followed by Week number of the month", "body": "<p>I can't seem to crack how to get static text \"WEEK\" followed by the current week number of the month (as of 4/18/18 that is 3). This is for Range <code>rngColK</code>. Which property will show the week number of the month? <code>Application.WorksheetFunction.WeekNum(Now)</code> doesn't seem to do that and I don't know if it's allowed to be added after static text \"WEEK\". </p>\n\n<p>For Range <code>rngColJ</code>,this one is kind of off the main topic, I'm getting the right output I just need it all uppercase, and using two sections \";>\" in <code>Rng.Offset(0, xOffsetColumn).NumberFormat = \"MMMM;&gt;\"</code> doesn't do that. Is the syntax incorrect?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'Fill in Date.\nDim rngColG As Range\nDim rngColJ As Range\nDim rngColK As Range\nDim Rng As Range\nDim xOffsetColumn As Integer\nSet rngColG = Intersect(Application.ActiveSheet.Range(\"A:A\"), Target)\nxOffsetColumn = 6\n\nApplication.EnableEvents = False\nIf Not rngColG Is Nothing Then\n    For Each Rng In rngColG\n        If Not VBA.IsEmpty(Rng.Value) Then\n            Rng.Offset(0, xOffsetColumn).Value = Date - Weekday(Date, 3)\n            Rng.Offset(0, xOffsetColumn).NumberFormat = \"mmmm d, yyyy\"\n        Else\n            Rng.Offset(0, xOffsetColumn).ClearContents\n        End If\n    Next\nEnd If\n\nSet rngColJ = Intersect(Application.ActiveSheet.Range(\"A:A\"), Target)\nxOffsetColumn = 9\n\nIf Not rngColJ Is Nothing Then\n    For Each Rng In rngColJ\n        If Not VBA.IsEmpty(Rng.Value) Then\n            Rng.Offset(0, xOffsetColumn).Value = Now\n            Rng.Offset(0, xOffsetColumn).NumberFormat = \"MMMM;&gt;\"\n        Else\n            Rng.Offset(0, xOffsetColumn).ClearContents\n        End If\n    Next\nEnd If\n\nSet rngColK = Intersect(Application.ActiveSheet.Range(\"A:A\"), Target)\nxOffsetColumn = 10\n\nIf Not rngColK Is Nothing Then\n    For Each Rng In rngColK\n        If Not VBA.IsEmpty(Rng.Value) Then\n            Rng.Offset(0, xOffsetColumn).Value = \"WEEK\" &amp;\" \"&amp; Int((6 + \n            Day(Date + 1 - Weekday(Date - 1))) / 7)\n        Else\n            Rng.Offset(0, xOffsetColumn).ClearContents\n        End If\n\n    Next\nEnd If\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ado"], "comments": [{"owner": {"reputation": 241, "user_id": 7297332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VB8cW.jpg?s=128&g=1", "display_name": "jshort", "link": "https://stackoverflow.com/users/7297332/jshort"}, "edited": false, "score": 0, "creation_date": 1524075053, "post_id": 49905342, "comment_id": 86828492, "body": "Does it have to be ADO? I&#39;ve found DAO recordsets to be better for making updates in iteration."}, {"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "reply_to_user": {"reputation": 241, "user_id": 7297332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VB8cW.jpg?s=128&g=1", "display_name": "jshort", "link": "https://stackoverflow.com/users/7297332/jshort"}, "edited": false, "score": 0, "creation_date": 1524077247, "post_id": 49905342, "comment_id": 86829725, "body": "I&#39;m all ears... I don&#39;t know how to use DAO, only ADO. Will it require a lot of changes to the code and how would I reference a record +/- the current record?  Thanks"}, {"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "reply_to_user": {"reputation": 241, "user_id": 7297332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VB8cW.jpg?s=128&g=1", "display_name": "jshort", "link": "https://stackoverflow.com/users/7297332/jshort"}, "edited": false, "score": 0, "creation_date": 1524080140, "post_id": 49905342, "comment_id": 86831236, "body": "Since I only need three arrays and only for a few records, I decided to save data as I process through the records in arrays and then set the fields in the current record based on the values in the arrays.  I am still interested in DAO and doing this, so if someone has a good pointer to a webpage with examples, I&#39;d appreciate it."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "edited": false, "score": 0, "creation_date": 1524149391, "post_id": 49907752, "comment_id": 86863899, "body": "Thanks, @jshort.  This is what I needed."}], "tags": [], "owner": {"reputation": 241, "user_id": 7297332, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/VB8cW.jpg?s=128&g=1", "display_name": "jshort", "link": "https://stackoverflow.com/users/7297332/jshort"}, "is_accepted": true, "score": 0, "last_activity_date": 1524080303, "creation_date": 1524080303, "answer_id": 49907752, "question_id": 49905342, "link": "https://stackoverflow.com/questions/49905342/2010-access-vba-moving-to-different-records-in-ado/49907752#49907752", "title": "2010 Access vba moving to different records in ADO", "body": "<p>With a DAO object reference you can iterate through your records and update them.</p>\n\n<pre><code>Dim db As Database, myRecordset As Recordset\nSet db = CurrentDb()\n\nsqlString = \"SELECT myfield FROM myTable\"\n\nSet myRecordset = db.OpenRecordset(sqlString, dbOpenDynaset, dbSeeChanges)\n\nmyRecordset.MoveFirst\n\nDo While myRecordset.EOF = False\n    myRecordset.Edit\n    myRecordset.Fields(\"myfield \").Value = newValue\n    myRecordset.Update\n    myRecordset.MoveNext\nLoop\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 49907752, "answer_count": 1, "score": 0, "last_activity_date": 1594650737, "creation_date": 1524071294, "last_edit_date": 1594650737, "question_id": 49905342, "link": "https://stackoverflow.com/questions/49905342/2010-access-vba-moving-to-different-records-in-ado", "title": "2010 Access vba moving to different records in ADO", "body": "<p>I have a need to update a record either (n) records before or after the current record using ADO.</p>\n\n<p>I have the code to open, read through all the selected records and close.</p>\n\n<p>What I'm wondering is if there's a way to change the current record pointer.  For example, I'd like to do something like this:</p>\n\n<pre><code>i=1\nDo until rs.EOF\n  If i &gt; 5 then\n    Field2=rs!Field1\n    rs!CurrentRecordPointer = i-3\n    'update Field2 in this record\n    rs!CurrentRecordPointer = i+3\n  End If\n  i = i + 1\n  rs.MoveNext\nLoop\n</code></pre>\n\n<p>Is this possible, or will I need to use an array?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1524070744, "post_id": 49905132, "comment_id": 86826183, "body": "Should be <code>Data!</code> - not the extra quote."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524071505, "post_id": 49905132, "comment_id": 86826603, "body": "@SJR If the worksheet name has a single space character following the word <i>Data</i>, then the single quote is needed."}, {"owner": {"reputation": 25, "user_id": 6626840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d4e79f9297d760921c0c8615dc89260?s=128&d=identicon&r=PG&f=1", "display_name": "sys73r", "link": "https://stackoverflow.com/users/6626840/sys73r"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1524072578, "post_id": 49905132, "comment_id": 86827190, "body": "@SJR: awesome! not sure how it got there! thank you!"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1524087681, "post_id": 49905132, "comment_id": 86834794, "body": "Where is <code>Lr</code> defined?"}], "owner": {"reputation": 25, "user_id": 6626840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d4e79f9297d760921c0c8615dc89260?s=128&d=identicon&r=PG&f=1", "display_name": "sys73r", "link": "https://stackoverflow.com/users/6626840/sys73r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524070621, "creation_date": 1524070583, "last_edit_date": 1531164843, "question_id": 49905132, "link": "https://stackoverflow.com/questions/49905132/adding-custom-formula-to-range-cell", "title": "Adding custom formula to Range() cell", "body": "<pre><code>    Sub test()\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False 'keeping the screen clean\n\n    Sheets(\"Data\").Select\n\n\n\n'Here is where the error is triggered.\n    With ThisWorkbook.Worksheets(\"TestSheet\")\n        '.Range(\"A2:A\" &amp; Lr).Formula = \"=CusVlookup(Z2,Data'!A:B,2)\" &lt;- this doesnt work either\n        .Range(\"A2:A\" &amp; Lr) = \"=CusVlookup(Z2,Data'!A:B,2)\"\n    End With\n\n    End Sub\n\n\nFunction CusVlookup(lookupval, LookupRange As Range, indexcol As Long)\n    Dim x As Range\n    Dim Result As String\n    Result = \"\"\n    For Each x In LookupRange\n        If x = lookupval Then\n            Result = Result &amp; \",\" &amp; x.Offset(0, indexcol - 1)\n        End If\n    Next x\n    CusVlookup = Result\nEnd Function\n</code></pre>\n\n<p>I've tried using the regular Vlookup and works just fine but if I try to use this custom function it triggers the error. By the way I need to get the multiple matches \"vlookups\" into one cell separated by comma.(I added the goal just in case you know a better/faster way to do the same.)</p>\n\n<p>whats wrong with the code?</p>\n\n<blockquote>\n  <p>Error 1004 - Application-defined or object-defined error</p>\n</blockquote>\n"}, {"tags": ["vba", "drop-down-menu", "web", "non-ascii-characters"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524072232, "post_id": 49905088, "comment_id": 86826995, "body": "Is this an internal URL?"}, {"owner": {"reputation": 11, "user_id": 9665543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215720779788777/picture?type=large", "display_name": "Lucie Bednarova Duesterhoeft", "link": "https://stackoverflow.com/users/9665543/lucie-bednarova-duesterhoeft"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524073073, "post_id": 49905088, "comment_id": 86827448, "body": "no but you need login which I coded and it works"}], "owner": {"reputation": 11, "user_id": 9665543, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215720779788777/picture?type=large", "display_name": "Lucie Bednarova Duesterhoeft", "link": "https://stackoverflow.com/users/9665543/lucie-bednarova-duesterhoeft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1524071147, "creation_date": 1524070428, "last_edit_date": 1524071147, "question_id": 49905088, "link": "https://stackoverflow.com/questions/49905088/website-to-select-from-drop-down-list-with-mixed-english-and-arabic-characters", "title": "Website to select from drop down list with mixed English and Arabic characters", "body": "<p>I have a list on website that has on each line a mixed English and Arabic. I tried</p>\n\n<pre><code>ieApp.Document.forms(0).all(\"ctl00$ContentPlaceHolder1$ddlManufacturer\").Value = \"Chevrolet ~ \u0634\u064a\u0641\u0631\u0648\u0644\u064a\u0647\"\n</code></pre>\n\n<p>I also tried to put the expression into Excel cell and reference it in the code:</p>\n\n<pre><code>ieApp.Document.forms(0).all(\"ctl00$ContentPlaceHolder1$ddlManufacturer\").Value = Range(\"a7\")\n</code></pre>\n\n<p>Neither solution works. Here is the code for the list:</p>\n\n<pre><code>&lt;select name=\"ctl00$ContentPlaceHolder1$ddlManufacturer\" id=\"ddlManufacturer\" style=\"width:270px;\"&gt;\n        &lt;option value=\"\"&gt;---Select Manufacturer---&lt;/option&gt;\n        &lt;option value=\"1\"&gt;Acura ~ \u0627\u0643\u064a\u0648\u0631\u0627&lt;/option&gt;\n        &lt;option value=\"2\"&gt;Aston Martin ~ \u0627\u0633\u062a\u0648\u0646 \u0645\u0627\u0631\u062a\u0646&lt;/option&gt;\n        &lt;option value=\"3\"&gt;Audi ~ \u0627\u0648\u062f\u064a&lt;/option&gt;\n        &lt;option value=\"4\"&gt;BAIC ~ \u0628\u0627\u064a\u0643&lt;/option&gt;\n        &lt;option value=\"5\"&gt;BAW ~ \u0628\u064a \u0627\u064a\u0647 \u062f\u0628\u0644\u064a\u0648&lt;/option&gt;\n        &lt;option value=\"6\"&gt;Bentley ~ \u0628\u0646\u062a\u0644\u064a &lt;/option&gt;\n        &lt;option value=\"7\"&gt;BMW ~ \u0628\u064a \u0627\u0645 \u062f\u0628\u0644\u064a\u0648&lt;/option&gt;\n        &lt;option value=\"8\"&gt;Brilliance ~ \u0628\u0631\u064a\u0644\u064a\u0627\u0646\u0633&lt;/option&gt;\n        &lt;option value=\"9\"&gt;BYD ~ \u0628\u064a \u0648\u0627\u064a \u062f\u064a&lt;/option&gt;\n        &lt;option value=\"10\"&gt;Cadillac ~ \u0643\u0627\u062f\u064a\u0644\u0627\u0643&lt;/option&gt;\n        &lt;option value=\"11\"&gt;Changan ~ \u062a\u0634\u0627\u0646\u062c\u0627\u0646&lt;/option&gt;\n        &lt;option value=\"12\"&gt;Chery ~ \u062a\u0634\u064a\u0631\u064a&lt;/option&gt;\n        &lt;option value=\"13\"&gt;Chevrolet ~ \u0634\u064a\u0641\u0631\u0648\u0644\u064a\u0647&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>I have other list on that website that have only English and have no problem selecting them. I do not want to use .selectedindex=13 since the list can change over time. Any suggestions?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8190948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5625b6b926b96d6e08e0e5a5c97d37bf?s=128&d=identicon&r=PG&f=1", "display_name": "MB9", "link": "https://stackoverflow.com/users/8190948/mb9"}, "edited": false, "score": 0, "creation_date": 1524075016, "post_id": 49906117, "comment_id": 86828473, "body": "Thank you Gustav, What I mean by field is: Right now in Excel the users select a cell and then press the button and the previously selected cell populates with the macro that is driven by the button. I am looking to have this same functionality in Access in a front end form view that populates the database."}, {"owner": {"reputation": 45, "user_id": 8190948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5625b6b926b96d6e08e0e5a5c97d37bf?s=128&d=identicon&r=PG&f=1", "display_name": "MB9", "link": "https://stackoverflow.com/users/8190948/mb9"}, "edited": false, "score": 0, "creation_date": 1524089397, "post_id": 49906117, "comment_id": 86835422, "body": "Thank you again for the help Gustav, unfortunately Access does not like the {Me!ActiveField.Value = Format(Now, &quot;dd/mm/yyyy hh:nn&quot;)}. There must be something with the syntax as it returns this after formatting the property {m&quot;e!A&quot;c&quot;tiveFiel&quot;d&quot;.Value = For&quot;m&quot;at(&quot;n\\ow&quot;, dd/mm/yyyy hh:nn)&quot;}"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 45, "user_id": 8190948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5625b6b926b96d6e08e0e5a5c97d37bf?s=128&d=identicon&r=PG&f=1", "display_name": "MB9", "link": "https://stackoverflow.com/users/8190948/mb9"}, "edited": false, "score": 1, "creation_date": 1524127058, "post_id": 49906117, "comment_id": 86848240, "body": "The Format property should only hold the format itself: dd/mm/yyyy hh:nn"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 45, "user_id": 8190948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5625b6b926b96d6e08e0e5a5c97d37bf?s=128&d=identicon&r=PG&f=1", "display_name": "MB9", "link": "https://stackoverflow.com/users/8190948/mb9"}, "edited": false, "score": 0, "creation_date": 1525896667, "post_id": 49906117, "comment_id": 87540674, "body": "No problem. Have a nice evening!"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1524083355, "last_edit_date": 1524083355, "creation_date": 1524074200, "answer_id": 49906117, "question_id": 49905019, "link": "https://stackoverflow.com/questions/49905019/importing-into-access-for-static-date-time-input/49906117#49906117", "title": "Importing into Access for Static Date/Time Input", "body": "<p>Not quite sure what you mean by \"field\" ...</p>\n\n<p>However, if a textbox named ActiveField, do this:</p>\n\n<pre><code>Me!ActiveField.Value = Format(Now, \"dd/mm/yyyy hh:nn\")\n</code></pre>\n\n<p>or simply:</p>\n\n<pre><code>Me!ActiveField.Value = Now\n</code></pre>\n\n<p>and apply your format to the Format property of the textbox.</p>\n\n<p>The textbox can be bound to a field of the table/query, the form is bound to.</p>\n"}], "owner": {"reputation": 45, "user_id": 8190948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5625b6b926b96d6e08e0e5a5c97d37bf?s=128&d=identicon&r=PG&f=1", "display_name": "MB9", "link": "https://stackoverflow.com/users/8190948/mb9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 49906117, "answer_count": 1, "score": 0, "last_activity_date": 1524083355, "creation_date": 1524070169, "last_edit_date": 1531164843, "question_id": 49905019, "link": "https://stackoverflow.com/questions/49905019/importing-into-access-for-static-date-time-input", "title": "Importing into Access for Static Date/Time Input", "body": "<p>Trying to convert this simple Excel Macro:</p>\n\n<pre><code>Private Sub Command74_Click()\nOn Error Resume Next\nActiveField = Format(Date, \"dd/mm/yyyy\") &amp; \"  \" &amp; Format(Time, \"hh:mm\")\nEnd Sub\n</code></pre>\n\n<p>into Access to use via a button to input Static Date AND Time into a field. Currently this is ran by a button in the Excel file, just wanting to use this in Access as well is this even possible?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1524069581, "post_id": 49904716, "comment_id": 86825542, "body": "Please edit your question to include an &quot;MCVE&quot; Example.  (See: &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;).  As it stands your code won&#39;t even compile and it&#39;s not clear what you&#39;re trying to do.  Sample data and some background would also be helpful. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> as well as <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1524069794, "post_id": 49904716, "comment_id": 86825656, "body": "What on earth are <code>set DurtyRows as</code> and <code>Deleteelete</code>? Hardly surprising your code doesn&#39;t work."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1524070706, "post_id": 49904716, "comment_id": 86826163, "body": "Also, it&#39;s <code>Shift:=xlUp</code> (it&#39;s lowercase &quot;L&quot;) not <code>...x1up</code>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1524074974, "post_id": 49904716, "comment_id": 86828449, "body": "This thread may help you on your journey, it shows how to delete the filtered rows <a href=\"https://stackoverflow.com/questions/49774855/delete-visible-rows-after-filter-applied/49775737#49775737\" title=\"delete visible rows after filter applied\">stackoverflow.com/questions/49774855/&hellip;</a>"}, {"owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "edited": false, "score": 0, "creation_date": 1524131470, "post_id": 49904716, "comment_id": 86851358, "body": "Hi there. sorry for my dirty code that i posted yesterday.  it was the end of the day with some Vision disorders.  here is the code without delleting autofilter result ( a blank cells ).  it works and maybe it could help some one.   for the deleting of the result im working on it"}, {"owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "edited": false, "score": 0, "creation_date": 1524131620, "post_id": 49904716, "comment_id": 86851480, "body": "Sub AdataPreparation()    Dim WorkSh As Worksheet, FilterRow As Variant, DurtyRows as range     Set WorkSh = Sheets(&quot;feuil2&quot;)    WorkSh.Activate    FilterRow = Rows(&quot;1:1&quot;).Find(What:=&quot;ID&quot;, LookAt:=xlWhole).Column    WorkSh.UsedRange.AutoFilter Field:=FilterRow, Criteria1:=&quot;=&quot;     End Sub"}, {"owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1524148358, "post_id": 49904716, "comment_id": 86863173, "body": "@Davesexcel: thank you for sharing the link. it is thanks to that that I found the solution"}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "is_accepted": true, "score": 0, "last_activity_date": 1524149388, "creation_date": 1524149388, "answer_id": 49924041, "question_id": 49904716, "link": "https://stackoverflow.com/questions/49904716/delete-autofilter-field-resullt-using-the-header-name/49924041#49924041", "title": "delete Autofilter Field resullt using the header Name", "body": "<p>I tried to always use an autofilter to find the empty cells before removing them but I'm stuck with it . instead  i used SpecialCells function Since i want to delete the Empty cells. So it Works but if I want to delete other celles dipending other special criteria than blank or somting that is not specified in SpecialCells Methode , i will have a problem but So far here is a solution. i Hope that will help some one. Here is a code. If you have a solution using Autofilter please share. Thanks </p>\n\n<pre><code>Sub data()\n\n Dim Wrksh As Worksheet, DurtyRows As Range, LstRw As Long\n\n\nSet WorkSh = Sheets(\"feuil2\")\n\n    With WorkSh\n    LstRw = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Set DurtyRows = .Range(\"A1:A\" &amp; LstRw).SpecialCells(xlCellTypeBlanks)\n    DurtyRows.EntireRow.Delete\n    .AutoFilterMode = False\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 49924041, "answer_count": 1, "score": -6, "last_activity_date": 1524149388, "creation_date": 1524069029, "last_edit_date": 1524143736, "question_id": 49904716, "link": "https://stackoverflow.com/questions/49904716/delete-autofilter-field-resullt-using-the-header-name", "title": "delete Autofilter Field resullt using the header Name", "body": "<p>I used the  Autofilter function but using field with the header name \"ID\" instead the number of column. for this part it's ok. Then I tried to delete the autofilter result but I'm Stuck. I saw that there is several questions about this  problematic but there is no a solution. however i tried this code but it doesn't work.  </p>\n\n<p>I will use this macro for several data. the purpose is to clean all data where there is blank. thank you for any help in advance </p>\n\n<p>here is my code : </p>\n\n<pre><code>Sub AdataPreparation()\nDim WorkBk As Workbook, WorkSh As Worksheet, FilterRow As Variant, DurtyRows as range \n\nSet WorkSh = Sheets(\"feuil2\")\nWorkSh.Activate\nFilterRow = Rows(\"1:1\").Find(What:=\"ID\", LookAt:=xlWhole).Column\nset DurtyRows as WorkSh.UsedRange.AutoFilter Field:=FilterRow, Criteria1:=\"=\" \nDurtyRows.Delete Shift :=xlUp\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524071482, "post_id": 49904524, "comment_id": 86826589, "body": "I guess I do. When I click the button, the code looks at one workbook to get information and then opens another workbook to insert the information in the next empty row."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524154561, "post_id": 49904524, "comment_id": 86867364, "body": "You need to add workbook references in the same way as sheet references. Please accept the/an answer if it&#39;s answered your question."}, {"owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524233308, "post_id": 49904524, "comment_id": 86903233, "body": "Referencing the workbook didn&#39;t work. The only thing that worked was adding the worksheet reference along with every cell reference. I&#39;m sure there is something simple I&#39;m missing, but the above changes you recommended did not allow the code to run."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524235252, "post_id": 49904524, "comment_id": 86904552, "body": "We&#39;ve both answered the question you asked. The workbook issue is a separate question and you haven&#39;t provided enough information for that to be answered. The point of With is that you don&#39;t need to specify the sheet each time."}, {"owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524235677, "post_id": 49904524, "comment_id": 86904835, "body": "I understand the point of with but that didn&#39;t work. When I added it with the way you instructed, I got an error saying the object was required. I didn&#39;t think I had an issue with workbook references and didn&#39;t receive and error in that regard. I was simply answering your question regarding it. It&#39;s my understanding that I accept answers that work, is that not correct?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524235980, "post_id": 49904524, "comment_id": 86905027, "body": "Yes, I&#39;m not asking you to accept an answer which didn&#39;t work, and I&#39;m not that fussed anyway, but your question was &quot;Is there a way to only reference the sheet once so the code looks for all information on the worksheet I need information from?&quot; and as I say we have both answered that. Perhaps you need to ask another question."}, {"owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524236834, "post_id": 49904524, "comment_id": 86905566, "body": "So are you saying I should accept this answer because it should have answered the question we thought I was asking? Or just answers should be accepted because you attempted? It doesn&#39;t matter if the answer is corrected the issue? Not trying to be obtuse. I&#39;ll go back and read the policies concerning this. I certainly want to give credit where it is do."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524237014, "post_id": 49904524, "comment_id": 86905684, "body": "Looking at your profile, you appear to have a problem acknowledging the help you receive in general."}, {"owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524237402, "post_id": 49904524, "comment_id": 86905928, "body": "Yes, I have apparently misunderstood the conditions I am supposed to accept answers. I am looking some clarification on how to correct this."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524237670, "post_id": 49904524, "comment_id": 86906071, "body": "This is my final word. The main thing is that you get the answers you need and that those helping have their contributions acknowledged (at least an expression of gratitude, although the system is points-based). If you are not getting the answers you need, perhaps revisit how you couch your questions. If you are and have just not understood how the system works that is easily fixed."}, {"owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524238028, "post_id": 49904524, "comment_id": 86906292, "body": "In reading some of the questions about accepting the answer, it appears that answers that correct the problem should be accepted. Neither did which is why they are not accepted. I don&#39;t think I failed to ask the correct question. Workbook referencing was never a problem and even when I added that, the error remained. As you see, I am new to this site and my upvotes do not show up since my reputation is so low. I upvoted your answer and appreciate your help, but it did not correct the issue I was having."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524238192, "post_id": 49904524, "comment_id": 86906387, "body": "Final final word! You haven&#39;t upvoted either answer, perhaps you have not got to grips with the system. Try reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> if you haven&#39;t already. I suggest you then ask a new question rather than prolong this one."}, {"owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524238638, "post_id": 49904524, "comment_id": 86906652, "body": "I did upvote your answer. When I upvote, I get a note saying that the upvote is recorded but because my reputation is not 15, it doesn&#39;t change the public score. Idk if you can see my upvote otherwise. This initial issue has been corrected but not by using the methods you recommended. There is no need to ask another question. Thanks again."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1524068411, "creation_date": 1524068411, "answer_id": 49904524, "question_id": 49904464, "link": "https://stackoverflow.com/questions/49904464/understanding-sheet-cell-referencing-in-vba-excel/49904524#49904524", "title": "Understanding sheet/cell referencing in VBA excel", "body": "<p>You can use a With statement - note the dots in front of the ranges. However, your first code should work I'd have thought - do you have more than one workbook in operation?</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    AgentName = .Range(\"C2\")\n    County = .Range(\"d1\")\n    Idate = Format(.Range(\"e1\"), \"yyyymmdd\")\n    LogNum = Format(.Range(\"f1\"), \"000\")\n    IncidentReport = County &amp; Idate &amp; LogNum\nend with\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "edited": false, "score": 0, "creation_date": 1524072554, "post_id": 49904530, "comment_id": 86827175, "body": "When I tried that, and use &quot;.Range(&quot;C2&quot;), I get an error saying an object is required. I tried referencing the workbook with ThisWorkbook too. If I remove the &#39;.&#39; then the code works, but references sheet2 and not sheet1."}], "tags": [], "owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "is_accepted": false, "score": 0, "last_activity_date": 1524068425, "creation_date": 1524068425, "answer_id": 49904530, "question_id": 49904464, "link": "https://stackoverflow.com/questions/49904464/understanding-sheet-cell-referencing-in-vba-excel/49904530#49904530", "title": "Understanding sheet/cell referencing in VBA excel", "body": "<p>Yes, use <code>with</code> block:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    AgentName = .Range(\"C2\")\n    'Set IncidentReport = Range(\"d1:f1\")\n    County = .Range(\"d1\")\n    Idate = Format(.Range(\"e1\"), \"yyyymmdd\")\n    LogNum = Format(.Range(\"f1\"), \"000\")\n    IncidentReport = County &amp; Idate &amp; LogNum\nEnd With\n</code></pre>\n\n<p>Within the <code>with</code> block, you can reference your object using <code>.</code> so <code>object.a</code> becomes <code>.</code></p>\n"}], "owner": {"reputation": 123, "user_id": 9592178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c0a9ace1c848ba18a7989d3b9ccad0?s=128&d=identicon&r=PG&f=1", "display_name": "MsAgentM", "link": "https://stackoverflow.com/users/9592178/msagentm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524068425, "creation_date": 1524068186, "last_edit_date": 1531164843, "question_id": 49904464, "link": "https://stackoverflow.com/questions/49904464/understanding-sheet-cell-referencing-in-vba-excel", "title": "Understanding sheet/cell referencing in VBA excel", "body": "<p>So I moved a macro button with some pretty extensive coding so users won't accidently click it. Basically, the macro sends information on sheet one to a summary workbook. I thought that I could just move the button since the first part of the code that looks for the variables needed selects the worksheet I actually want to get information from. However the macro still looks at the activeworksheet to get the variables. I can fix this by simply putting the worksheet reference along with the range reference to get the necessary information, but I didn't think I needed to do that. Is there a way to only reference the sheet once so the code looks for all information on the worksheet I need information from?</p>\n\n<p>first code--gets information from whatever worksheet it's attached to, in this case sheet2:</p>\n\n<pre><code> Worksheets(\"Sheet1\").Select\n    AgentName = Range(\"C2\")\n    'Set IncidentReport = Range(\"d1:f1\")\n    County = Range(\"d1\")\n    Idate = Format(Range(\"e1\"), \"yyyymmdd\")\n    LogNum = Format(Range(\"f1\"), \"000\")\n    IncidentReport = County &amp; Idate &amp; LogNum\n</code></pre>\n\n<p>This code pulls the information from the correct sheet, but I have a lot of variables I'm looking to get and surely there is a better way:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Select\n    AgentName = Worksheets(\"Sheet1\").Range(\"C2\")\n    'Set IncidentReport = Range(\"d1:f1\")\n    County = Worksheets(\"Sheet1\").Range(\"d1\")\n    Idate = Format(Worksheets(\"Sheet1\").Range(\"e1\"), \"yyyymmdd\")\n    LogNum = Format(Worksheets(\"Sheet1\").Range(\"f1\"), \"000\")\n    IncidentReport = County &amp; Idate &amp; LogNum\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1524067996, "post_id": 49904284, "comment_id": 86824580, "body": "You won&#39;t be able to use an autonumber field for that.  You&#39;ll have to run a query to count the entries or use DCOUNT when a new record is added."}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1524125316, "post_id": 49905590, "comment_id": 86847258, "body": "You can automatically assign the IDs using data macros. However, you can&#39;t use a <code>DMax</code> in there."}], "tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 0, "last_activity_date": 1524073085, "last_edit_date": 1524073085, "creation_date": 1524072208, "answer_id": 49905590, "question_id": 49904284, "link": "https://stackoverflow.com/questions/49904284/how-to-set-multiple-starting-points-for-autonumber-field-in-an-access-table/49905590#49905590", "title": "How to set multiple Starting points for autoNumber field in an access table", "body": "<p>You can't use autonumber. You have to manually assign the ID.</p>\n\n<p>To get the next ID per group:</p>\n\n<pre><code>NextIDForGroup = Nz(DMax(\"IDFieldName\",\"TableName\",\"IDFieldName &gt;= \" &amp; [StartingPointForGroup] &amp; \" AND IDFieldName &lt; \" &amp; [StartingPointForGroup]+[IntervalBetweenGroups]),[StartingPointForGroup] - 1) + 1\n</code></pre>\n\n<p>If you are assured that each group ahs at least one exiting record it can ve simplified to:</p>\n\n<pre><code>NextIDForGroup = DMax(\"IDFieldName\",\"TableName\",\"IDFieldName &gt;= \" &amp; [StartingPointForGroup] &amp; \" AND IDFieldName &lt; \" &amp; [StartingPointForGroup]+[IntervalBetweenGroups]) + 1\n</code></pre>\n\n<p>I assume you will pick your starting IDs properly so there is no chance for overlap.</p>\n"}], "owner": {"reputation": 1, "user_id": 9535993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b5ad48d9547924b02567848422a68de?s=128&d=identicon&r=PG&f=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/9535993/santosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524073085, "creation_date": 1524067569, "last_edit_date": 1524069947, "question_id": 49904284, "link": "https://stackoverflow.com/questions/49904284/how-to-set-multiple-starting-points-for-autonumber-field-in-an-access-table", "title": "How to set multiple Starting points for autoNumber field in an access table", "body": "<p>I'm working on a MS access based tasks list where all teams have been assigned with a series to use as unique ID. ie, team A will number their tasks from 100 to 199, then team B will use series 200 to 299 ad so on. whenever they perform a task they will use a macro to get next available number in their respective series.</p>\n\n<p>Now I have created the table but unable to find a way to return the next incremental number from each teams series. Is there any way to get this done? I want to achieve this in a single table.</p>\n\n<p>I'm using Access 2016 and VBA.</p>\n"}, {"tags": ["vba", "web-scraping"], "comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1524069522, "post_id": 49904218, "comment_id": 86825510, "body": "What happens when you try <code>HTMLDoc.querySelector(&quot;input[type=&#39;submit&#39;]&quot;).Click</code> instead of <code>form.submit</code>?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1524070226, "post_id": 49904218, "comment_id": 86825895, "body": "Please share more information about the &quot;number of things&quot; you have read and tried.  This is a pretty basic web scraping task and there are dozens of examples, I&#39;m not sure what&#39;s not working for you.  (See &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;)"}, {"owner": {"reputation": 1, "user_id": 9665396, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M7BuTlpPlM4/AAAAAAAAAAI/AAAAAAAABcY/DOh31bet4Uo/photo.jpg?sz=128", "display_name": "Remy", "link": "https://stackoverflow.com/users/9665396/remy"}, "edited": false, "score": 0, "creation_date": 1524127326, "post_id": 49904218, "comment_id": 86848390, "body": "It works perfectly, thank so much my friend. Sorry for the inconvenience but I&#39;m a newbie."}], "owner": {"reputation": 1, "user_id": 9665396, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M7BuTlpPlM4/AAAAAAAAAAI/AAAAAAAABcY/DOh31bet4Uo/photo.jpg?sz=128", "display_name": "Remy", "link": "https://stackoverflow.com/users/9665396/remy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524070164, "creation_date": 1524067399, "last_edit_date": 1524070164, "question_id": 49904218, "link": "https://stackoverflow.com/questions/49904218/login-into-a-website", "title": "Login into a Website", "body": "<p>I have read a number of posts related to this topic, tried a number of different methods and still can't get it to work.</p>\n\n<p>The macro is working for the user name and password but login not working..</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim MyBrowser As InternetExplorer\n\nSub RepsolLogin()\nDim MyHTML_Element As IHTMLElement\nDim MyURL As String\nDim form As HTMLFormElement\nMyURL = \"https://login.repsol.com/es/Landing/AuthnPage?returnUrl=https://www.repsol.com/es_es/\"\nSet MyBrowser = New InternetExplorer\nMyBrowser.Silent = True\nMyBrowser.navigate MyURL\nMyBrowser.Visible = True\nDo\n    DoEvents\nLoop Until MyBrowser.ReadyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = MyBrowser.document\n\nDo While HTMLDoc.getElementById(\"gigya-login-form\") Is Nothing\n    DoEvents\nLoop\n\nSet form = HTMLDoc.getElementById(\"gigya-login-form\")\n\nform.all.UserName.Value = \"xxx@xxx.com\" 'Enter your email id here\nform.all.Password.Value = \"password\" 'Enter your password here\n\n\nform.submit\nEnd Sub\n</code></pre>\n\n<p>Can anyone have a look an tell me how I must have the macro?</p>\n"}, {"tags": ["regex", "vba", "replace", "find"], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "edited": false, "score": 1, "creation_date": 1524067316, "post_id": 49904152, "comment_id": 86824139, "body": "I believe the find and replace wildcards operate the same as with using the <code>Like</code> operator in VBA. For anything complex VBA is your best bet."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1524067318, "last_edit_date": 1524067318, "creation_date": 1524067172, "answer_id": 49904152, "question_id": 49903848, "link": "https://stackoverflow.com/questions/49903848/using-regex-expressions-within-vbas-find-and-replace-tool/49904152#49904152", "title": "Using regex expressions within VBA&#39;s Find and Replace tool", "body": "<p>Is there a way to use regex expressions within the VBA editor's find and replace tool? </p>\n\n<ul>\n<li>Nope. </li>\n</ul>\n\n<p><strong>But</strong>, if you want to replace something per <code>Sub</code>, you can loop all Subs, check for <code>Private</code> and add something like this:</p>\n\n<pre><code>For Each objComp In objPro.VBComponents\n    If objComp.Type = 1 Then\n        strText = objComp.CodeModule.Lines(1, UP_TO_LINE)\n\n        If InStr(1, strText, PRIVATE_MODULE) = 0 Then\n            objComp.CodeModule.InsertLines 2, PRIVATE_MODULE\n        End If\n\n    End If\nNext objComp\n</code></pre>\n\n<p>The whole code is from this answer - <a href=\"https://stackoverflow.com/a/41612479/5448626\">https://stackoverflow.com/a/41612479/5448626</a></p>\n\n<hr>\n\n<p>Playing with the VBEditor &amp; VBA is quite interesting:</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s9/win002.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s9/win002.htm</a></p>\n"}], "owner": {"reputation": 161, "user_id": 9341705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69a187b6fc1d11a97ef1087bdea68d91?s=128&d=identicon&r=PG&f=1", "display_name": "ericauv", "link": "https://stackoverflow.com/users/9341705/ericauv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 49904152, "answer_count": 1, "score": 1, "last_activity_date": 1524067318, "creation_date": 1524066192, "last_edit_date": 1524066996, "question_id": 49903848, "link": "https://stackoverflow.com/questions/49903848/using-regex-expressions-within-vbas-find-and-replace-tool", "title": "Using regex expressions within VBA&#39;s Find and Replace tool", "body": "<p>Is there a way to use regex expressions within the VBA editor's find and replace tool? </p>\n\n<p><img src=\"https://i.stack.imgur.com/FHWUl.jpg\" alt=\"Screenshot of Find and Replace Tool\"></p>\n\n<p>for example:\nI've turned pattern matching on but my regex expressions do not seem to work at all.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1524067021, "post_id": 49903793, "comment_id": 86823980, "body": "This looks like something a PowerPivot would be useful for, not VBA."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7853435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JJ9TB.jpg?s=128&g=1", "display_name": "Chemdawg", "link": "https://stackoverflow.com/users/7853435/chemdawg"}, "edited": false, "score": 0, "creation_date": 1524148247, "post_id": 49907191, "comment_id": 86863095, "body": "thanks but now I get a subscript out of range error on the upperbound."}, {"owner": {"reputation": 1, "user_id": 9587797, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ccacAgAQDXY/AAAAAAAAAAI/AAAAAAAAlqs/roNmX_XQnoI/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/9587797/sean"}, "reply_to_user": {"reputation": 57, "user_id": 7853435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JJ9TB.jpg?s=128&g=1", "display_name": "Chemdawg", "link": "https://stackoverflow.com/users/7853435/chemdawg"}, "edited": false, "score": 0, "creation_date": 1524204968, "post_id": 49907191, "comment_id": 86885779, "body": "Make sure your the sheets(&quot;sheetname&quot;) line matches up with sheet name in your workbook."}], "tags": [], "owner": {"reputation": 1, "user_id": 9587797, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ccacAgAQDXY/AAAAAAAAAAI/AAAAAAAAlqs/roNmX_XQnoI/photo.jpg?sz=128", "display_name": "Sean", "link": "https://stackoverflow.com/users/9587797/sean"}, "is_accepted": false, "score": 0, "last_activity_date": 1524078087, "creation_date": 1524078087, "answer_id": 49907191, "question_id": 49903793, "link": "https://stackoverflow.com/questions/49903793/return-multiple-rows-of-data-in-vba/49907191#49907191", "title": "Return multiple rows of data in vba", "body": "<p>If I am understanding you are trying to get all the \"Package values\" based on \"Part\" and \"Parameter\".  I would run a while loop with a for loop inside that iterates at a match and stores in an array that gets bigger using reDim Preserve.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1mpJy.png\" rel=\"nofollow noreferrer\">example input with output pasted onto G column</a></p>\n\n<pre><code>Sub example()\n\nDim rower, destination, packageCount As Integer\nDim Package() As Variant\nDim part As String\n\ndestination = 4586\npart = \"06509269AA\"\nrower = 0\npackageCount = 0\n\nSheets(\"Sheet1\").Activate\nRange(\"B3\").Activate\n\nDo While ActiveCell.Offset(rower) &lt;&gt; \"\"\n    If ActiveCell.Offset(rower) = destination And ActiveCell.Offset(rower, 1) = part Then\n        packageCount = packageCount + 1\n        ReDim Preserve Package(packageCount + 1)\n        Package(packageCount) = ActiveCell.Offset(rower, 2)\n    End If\n    rower = rower + 1\nLoop\n\nRange(\"g2\").Activate\n\nFor i = 0 To UBound(Package)\n    ActiveCell.Offset(i) = Package(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7853435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JJ9TB.jpg?s=128&g=1", "display_name": "Chemdawg", "link": "https://stackoverflow.com/users/7853435/chemdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 699, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524078087, "creation_date": 1524065999, "last_edit_date": 1531164843, "question_id": 49903793, "link": "https://stackoverflow.com/questions/49903793/return-multiple-rows-of-data-in-vba", "title": "Return multiple rows of data in vba", "body": "<p>I have a row such as the following:</p>\n\n<pre><code>Destination: Part:\n04586        06509269AA\n</code></pre>\n\n<p>I want to look up this data in another sheet that has multiple rows of the same data with extra information</p>\n\n<pre><code>Destination: Part:       Package:\n04586        06509269AA  656665\n04586        06509269AA  213226\n</code></pre>\n\n<p>and return the full data to a new sheet.</p>\n\n<p>I tried doing an index, match, using a key for the data set but it crashes excel due to how much rows of data I actually pull in my query, and also I would need to find a way to increment rows in the new sheet for how many rows of data there actually is.</p>\n\n<p>Any ideas of what I can try in VBA to create this report? </p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 1, "creation_date": 1524065986, "post_id": 49903669, "comment_id": 86823278, "body": "To help pinpoint an answer please state what line the error highlights."}, {"owner": {"reputation": 3, "user_id": 8258218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dmlvG.jpg?s=128&g=1", "display_name": "Kaneki Byte", "link": "https://stackoverflow.com/users/8258218/kaneki-byte"}, "reply_to_user": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1524066687, "post_id": 49903669, "comment_id": 86823750, "body": "Hi Zerk,   I&#39;ve just checked and the debugger is returning the error on the below  <code>code</code>         With Worksheets(&quot;Home&quot;)             .Hyperlinks.Add Anchor:=.Range(&quot;H&quot; &amp; row_ptr), _              Address:=&quot;&quot;, _             SubAddress:=AddStr, _             TextToDisplay:=Workbooks(ActiveWorkbook.Name).Worksheets(&quot;Au&zwnj;&#8203;dit_InFlight&quot;).Range&zwnj;&#8203;(&quot;D&quot; &amp; i).Value         End With <code>code</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524066729, "post_id": 49903669, "comment_id": 86823779, "body": "We can&#39;t see line numbers.... Have you tried commenting out sections line by line to determine?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1524067398, "post_id": 49903669, "comment_id": 86824197, "body": "Have you checked the values of each of the variables involved at this point? I cannot produce this error as is though clearly I don&#39;t have your dataset."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524072079, "post_id": 49903669, "comment_id": 86826912, "body": "This wont help to resolve your query but might help to improve your code: you don&#39;t have to <code>.Activate</code> the sheets when you have already created an object that points to the sheet. Also, as you&#39;ve already created the object.. why not use that? i.e. your line: <b><code>With Worksheets(&quot;Home&quot;)</code></b> should be replaced by: <b><code>With InputWorksheet</code></b> because you already have the sheet object pointing to that sheet. If you want to learn more about this, search for topics like: <b>qualifying worksheets vba</b> and <b>late worksheet binding vba</b>"}, {"owner": {"reputation": 3, "user_id": 8258218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dmlvG.jpg?s=128&g=1", "display_name": "Kaneki Byte", "link": "https://stackoverflow.com/users/8258218/kaneki-byte"}, "edited": false, "score": 0, "creation_date": 1524084549, "post_id": 49903669, "comment_id": 86833488, "body": "Thanks Zac really appreciated I&#39;ll try tweaking the code. I think with this it&#39;s an issue with repotion with the same code without resorting variables possibly"}, {"owner": {"reputation": 3, "user_id": 8258218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dmlvG.jpg?s=128&g=1", "display_name": "Kaneki Byte", "link": "https://stackoverflow.com/users/8258218/kaneki-byte"}, "edited": false, "score": 0, "creation_date": 1524127357, "post_id": 49903669, "comment_id": 86848413, "body": "Hi Zac,  I took a look and removed the Hyperlink section of the code and it showed that additional lines were being added which were blank due to the    &lt;&gt; &quot;Closed&quot;  Then so I&#39;ve removed this and set a static value and resolved the problem."}], "owner": {"reputation": 3, "user_id": 8258218, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dmlvG.jpg?s=128&g=1", "display_name": "Kaneki Byte", "link": "https://stackoverflow.com/users/8258218/kaneki-byte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524069707, "creation_date": 1524065592, "last_edit_date": 1524069707, "question_id": 49903669, "link": "https://stackoverflow.com/questions/49903669/run-time-error-5-invalid-procedure-call-or-argument", "title": "Run-time error 5 : Invalid procedure call or argument", "body": "<p>I've got the below code and it works completely fine for rows 1 - 46 on it's own populating one table. As soon as I replicate this with a second table to populate it throws Error1. </p>\n\n<p>I've taken out everything below \"' Second Table Entry \" and works fine ... put back in and same error. On the \"Home\" sheet it actually populates the tables information but still throws the error which is stopping further vba from executing. </p>\n\n<p>Any ideas? I've been all over google, stackoverflow, superuser and Microsoft MSDN and can't figure out where in the second bit of code is causing it to error. </p>\n\n<p>EDIT: I've checked the debugger and it's highlighting the below code in the second table inserts </p>\n\n<pre><code>With Worksheets(\"Home\")\n    .Hyperlinks.Add Anchor:=.Range(\"H\" &amp; row_ptr), _\n    Address:=\"\", _\n    SubAddress:=AddStr, _\n    TextToDisplay:=Workbooks(ActiveWorkbook.Name).Worksheets(\"Audit_InFlight\").Range(\"D\" &amp; i).Value\nEnd With\n</code></pre>\n\n<p>Any help is greatly appreciated.</p>\n\n<p>Error1</p>\n\n<blockquote>\n  <p>Run-time error '5': Invalid procedure call or argument</p>\n</blockquote>\n\n<pre><code>Private Sub Workbook_Open()\nDim row_ptr As Long\nDim i As Long  \nDim i2 As Long\nDim rownbrMA_Inflight As Long   \nDim rownbrAudit As Long\nDim CurrentWorkbook As Workbook \nDim InputWorksheet As Worksheet \nDim DataSourceWorksheet As Worksheet\nDim AuditDataSourceWorksheet As Worksheet\n\nSet CurrentWorkbook = Workbooks(ActiveWorkbook.Name)\nSet InputWorksheet = CurrentWorkbook.Sheets(\"Home\")   \nSet DataSourceWorksheet = CurrentWorkbook.Sheets(\"MA_Inflight\") \nSet AuditDataSourceWorksheet = CurrentWorkbook.Sheets(\"Audit_InFlight\")\n\nInputWorksheet.Range(\"A30:M176\").Clear  \nInputWorksheet.Range(\"A30:M176\").ClearFormats   \nInputWorksheet.Range(\"A30:M176\").Interior.Color = RGB(255, 255, 255)\nrownbrMA_Inflight = DataSourceWorksheet.Range(\"C\" &amp; Rows.Count).End(xlUp).Row   \nrow_ptr = 31  \nFor i = 8 To rownbrMA_Inflight \n\nIf DataSourceWorksheet.Range(\"C\" &amp; i).Value = \"Open\" Then \nInputWorksheet.Rows(row_ptr).Insert Shift:=xlDown 'CopyOrigin:=xlFormatFromLeftOrAbove   \nInputWorksheet.Range(\"A\" &amp; row_ptr).Value = DataSourceWorksheet.Range(\"E\" &amp; i).Value  \nInputWorksheet.Range(\"B\" &amp; row_ptr).Value = DataSourceWorksheet.Range(\"F\" &amp; i).Value  \nAddStr = \"MA_Inflight!\" &amp; \"$F$\" &amp; CStr(i)  \nActiveWorkbook.Activate \nWorksheets(\"Home\").Activate  \nWith Worksheets(\"Home\")   \n.Hyperlinks.Add Anchor:=.Range(\"B\" &amp; row_ptr), _\n Address:=\"\", _\nSubAddress:=AddStr, _\nTextToDisplay:=Workbooks(ActiveWorkbook.Name).Worksheets(\"MA_Inflight\").Range(\"F\" &amp; i).Value  \nEnd With  \nInputWorksheet.Range(\"C\" &amp; row_ptr).Value = DataSourceWorksheet.Range(\"I\" &amp; i).Value   \nInputWorksheet.Range(\"D\" &amp; row_ptr).Value = DataSourceWorksheet.Range(\"J\" &amp; i).Value \nInputWorksheet.Range(\"E\" &amp; row_ptr).Value = DataSourceWorksheet.Range(\"L\" &amp; i).Value \nrow_ptr = row_ptr + 1   \nEnd If  \nNext i  \n'============================================================\n' Second Table Entry \n'============================================================\nrownbrAudit = DataSourceWorksheet.Range(\"C\" &amp; Rows.Count).End(xlUp).Row  \nrow_ptr = Empty  \nrow_ptr = 31\nFor i = 8 To rownbrAudit \n\nIf AuditDataSourceWorksheet.Range(\"B\" &amp; i).Value &lt;&gt; \"Closed\" Then  \nInputWorksheet.Rows(row_ptr).Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove  \nInputWorksheet.Range(\"G\" &amp; row_ptr).Value = AuditDataSourceWorksheet.Range(\"B\" &amp; i).Value \nInputWorksheet.Range(\"H\" &amp; row_ptr).Value = AuditDataSourceWorksheet.Range(\"D\" &amp; i).Value \n'New code ---------------------------  \nAddStr = \"Audit_InFlight!\" &amp; \"$D$\" &amp; CStr(i)\nActiveWorkbook.Activate   \nWorksheets(\"Home\").Activate   \nWith Worksheets(\"Home\")  \n.Hyperlinks.Add Anchor:=.Range(\"H\" &amp; row_ptr), _\n Address:=\"\", _\nSubAddress:=AddStr, _\nTextToDisplay:=Workbooks(ActiveWorkbook.Name).Worksheets(\"Audit_InFlight\").Range(\"D\" &amp; i).Value \nEnd With   \n'-----------------------------------\nInputWorksheet.Range(\"I\" &amp; row_ptr).Value = AuditDataSourceWorksheet.Range(\"G\" &amp; i).Value \nInputWorksheet.Range(\"J\" &amp; row_ptr).Value = AuditDataSourceWorksheet.Range(\"H\" &amp; i).Value \nInputWorksheet.Range(\"K\" &amp; row_ptr).Value = AuditDataSourceWorksheet.Range(\"I\" &amp; i).Value \nInputWorksheet.Range(\"L\" &amp; row_ptr).Value = AuditDataSourceWorksheet.Range(\"J\" &amp; i).Value\nInputWorksheet.Range(\"M\" &amp; row_ptr).Value = AuditDataSourceWorksheet.Range(\"K\" &amp; i).Value\nrow_ptr = row_ptr + 1  \nEnd If\nNext i\n\n'RemoveBlankCells\n'PURPOSE: Deletes single cells that are blank located inside a designated range\nDim rng As Range\n'Store blank cells inside a variable\nSet rng = InputWorksheet.Range(\"A30:E50\").SpecialCells(xlCellTypeBlanks)\n'Delete blank cells and shift upward\n  rng.Rows.Delete Shift:=xlShiftUp\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9665198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d022382c54e8b232ae10770d193a6a2?s=128&d=identicon&r=PG&f=1", "display_name": "Antip", "link": "https://stackoverflow.com/users/9665198/antip"}, "edited": false, "score": 0, "creation_date": 1524067890, "post_id": 49903754, "comment_id": 86824514, "body": "The files are getting closed but since in my each files there are 1152 cells. A dialog box &quot;There is a large amount of information in Clipboard. Click &quot;Yes&quot; for Copying ....etc etc&quot; is appearing each time the file is getting closed after reading. How to solve this? Thanks!"}], "tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": false, "score": 0, "last_activity_date": 1524065857, "creation_date": 1524065857, "answer_id": 49903754, "question_id": 49903634, "link": "https://stackoverflow.com/questions/49903634/unable-to-close-files-which-are-read-using-vba-after-the-operation/49903754#49903754", "title": "Unable to Close files which are read using VBA after the operation", "body": "<p>Creating a workbook variable and using this would be a clean way to do it. The aspects within this sub of activating workbooks and interacting with sheets that aren't fully referenced is a concern and you could improve it further by properly referencing these.\nAlso be careful with <code>application.screenupdating=false</code> if you disable it within a sub make sure that every exit point will restore it.</p>\n\n<pre><code>Sub LoopThroughDirectory()\n\nApplication.ScreenUpdating = False\n\nDim MyFile As String, wbData As Workbook\nDim erow\n\nMyFile = Dir(\"C:\\Desktop\\Actual Files\\\")\n\nDo While Len(MyFile) &gt; 0\n\nIf MyFile = \"zmaster.xlsm\" Then\n    Application.ScreenUpdating = True\n    Exit Sub\nEnd If\n\nSet wbData = Workbooks.Open(MyFile)\n\nRange(\"A2:O97\").Copy\n\nWindows(\"zmaster.xlsm\").Activate\n\nerow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\nActiveSheet.Paste Destination:=Worksheets(\"Sheet1\").Range(Cells(erow, 1), Cells(erow, 15))\n\nwbData.Close False\n\nMyFile = Dir\n\nLoop\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9665198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d022382c54e8b232ae10770d193a6a2?s=128&d=identicon&r=PG&f=1", "display_name": "Antip", "link": "https://stackoverflow.com/users/9665198/antip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524066544, "creation_date": 1524065477, "last_edit_date": 1524066544, "question_id": 49903634, "link": "https://stackoverflow.com/questions/49903634/unable-to-close-files-which-are-read-using-vba-after-the-operation", "title": "Unable to Close files which are read using VBA after the operation", "body": "<p>Objective: To copy data from all the excel files kept in the folder to the master excel files. The data is being copied correctly. However, I am unable to close all the files which are read by the program. Have tried all these options: <code>ActiveWorkbook.Close</code>, <code>Workbooks(MyFile).Close SaveChanges:=False</code>, <code>Workbooks(MyFile).Close SaveChanges:=False</code>, but none is working.</p>\n\n<p>How to solve the issue?</p>\n\n<p><strong>VBA Code:</strong></p>\n\n<pre><code>Sub LoopThroughDirectory()\n\n    Dim MyFile As String\n    Dim erow\n\n    MyFile = Dir(\"C:\\Desktop\\Actual Files\\\")\n\n    Do While Len(MyFile) &gt; 0 \n        If MyFile = \"zmaster.xlsm\" Then\n            Exit Sub\n        End If \n        Workbooks.Open (MyFile)   \n        Range(\"A2:O97\").Copy   \n        Windows(\"zmaster.xlsm\").Activate   \n        erow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n        ActiveSheet.Paste Destination:=Worksheets(\"Sheet1\").Range(Cells(erow, 1), Cells(erow, 15))  \n        Application.ScreenUpdating = False\n        MyFile = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1524095860, "post_id": 49903311, "comment_id": 86837203, "body": "That said, a mailmerge could be used, with only the record corresponding to the selected row being merged. Quite simple once the set-up is done and minimal VBA code is needed."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7359278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab896635967aad4ebf7670ad0402e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Rui", "link": "https://stackoverflow.com/users/7359278/rui"}, "edited": false, "score": 0, "creation_date": 1524213907, "post_id": 49904015, "comment_id": 86890711, "body": "Thanks @Cindy, I have used content controls option and things went pretty straight"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1524770127, "last_edit_date": 1524770127, "creation_date": 1524066716, "answer_id": 49904015, "question_id": 49903311, "link": "https://stackoverflow.com/questions/49903311/exporting-data-from-excel-to-word-data-targets-placeholders/49904015#49904015", "title": "Exporting data from Excel to Word: data targets/placeholders", "body": "<p>Word has multiple possibilities for the developer to write data that will be displayed in the document. Which to use depends on the individual requirement of the developer.</p>\n\n<ol>\n<li>Traditionally, <strong>bookmarks</strong> are most often used. A <code>Bookmark</code> object provides a <code>Range</code> property so that the inserted content can be formatted or otherwise manipulated. A bookmark can be <em>referenced</em> elsewhere in the document as a cross-reference or to repeat the information more than one time.</li>\n</ol>\n\n<p>VBA code to write to a bookmark</p>\n\n<pre><code> ActiveDocument.Bookmarks(\"BookmarkName\").Range.Text = \"Data as string\"\n</code></pre>\n\n<p>Writing to a bookmark with content deletes the bookmark. If the bookmark should be retained</p>\n\n<pre><code>Dim sBookmarkName as String\nDim rngBookmark as Word.Range\nDim doc as Word.Document\nDim bkm as Word.Bookmark\nsBookmarkName = \"BookmarkName\"\nSet doc = ActiveDocument\nIf doc.Bookmarks.Exists(sBookmarkName) Then\n  Set bkm = doc.Bookmarks(sBookmarkName)\n  Set rng = bkm.Range\n  rng.Text = \"Data as string\"\n  doc.Bookmarks.Add(sBookmarkName, rngBookmark)\nEnd If\n</code></pre>\n\n<ol start=\"2\">\n<li>Text content can be written to <code>Document.Variable</code> or <code>CustomDocumentProperty</code> objects and the content reflected on the document surface by use of <code>DocVariable</code> or <code>DocProperty</code> fields. This has the advantage of the content travelling with the document, whether the user edits what's displayed on the surface, or not. Formatting the content is problematic.</li>\n</ol>\n\n<p>To write to document Variables and custom document properties:</p>\n\n<pre><code>ActiveDocument.Variables(\"VariableName\") = \"Data as string\"\n'See the language reference for more about values for Type\nActiveDocument.CustomDocumentProperties.Add Name:=\"PropertyName\", _\n                                            LinkToContent:=False,  _\n                                            Type:=msoPropertyTypeString, _\n                                            Value:=\"Data as string\"\n</code></pre>\n\n<ol start=\"3\">\n<li>Starting in Word 2007, <strong>content controls</strong> are recommended by Microsoft as data placeholders. Programmatically addressing them is similar to working with bookmarks. Main differences:\n\n<ul>\n<li>the title or tag of a content control can be used more than once in the document</li>\n<li>writing to a content control need not (but can) remove the content control (writing to a bookmark removes the bookmark, but it can be recreated if it's needed for referencing or writing data at a future time)</li>\n<li>a content control can be linked to a Custom XML Part in the document</li>\n<li>data written to content controls can be more easily extracted from the <em>closed</em> Word document, via the Office Open XML file format. (Even more easily if the content control is linked to a Custom XML Part)</li>\n<li>Corollary: it's also possible to write data directly to a Custom XML Part that's linked to content controls in a document. This is especially interesting if the data should be written to a <em>closed</em> file.</li>\n</ul></li>\n</ol>\n\n<p>Since content controls can have the same title or tag, the object model returns an array for these properties. Word also assigns each content control a unique ID (GUID) - if the GUID is known, the content control can be addressed directly.</p>\n\n<pre><code>Dim doc as Word.Document\nDim sCC_ID as String\nDim sCC_Title as String\nDim sCC_Tag as String\n\nSet doc = ActiveDocument\n'ID value is passed as a string\ndoc.ContentControls(\"1691881769\").Range.Text = \"Data as String\"\n\n'Get the first content control with the given title\nsCC_Title = \"Content Control Title\"\ndoc.ContentControls.SelectContentControlByTitle(sCC_Title).Item(1).Range.Text = \"Data as String\"\n\n'Loop all content controls having the same tag\nDim aCC as Word.ContentControls\nDim cc as Word.ContentControl\n\nsCC_Tag = \"Content Control Tag\"\nSet aCC = doc.SelectContentControlsByTag(\"Content Control Tag\")\nFor Each cc In aCC\n    cc.Range.Text = \"Data as string\"\nNext\n</code></pre>\n\n<ol start=\"4\">\n<li>It's possible to write data to <strong>merge fields</strong>, although this NOT how merge fields are meant to be used. This approach is most often used when the idea is that a user can set up a document \"easily\". Writing the code to target the merge fields is more complex than for the other types of placeholders.</li>\n</ol>\n\n<p>The following snippet demonstrates how to loop all fields in document not linked to a mail merge data source, search for the merge field and replace it with data</p>\n\n<pre><code>Dim fld As Word.Field\nDim fldRange As Word.Range\nDim sFldCode As String, sDataField As String, sDataContent\n\nsDataField = \"MergefieldName\"\nsDataContent = \"Data as string\"\nFor Each fld In ActiveDocument.Fields\n    sFldCode = fld.code\n    Select Case InStr(sFldCode, sDataField)\n        Case Is &gt; 0\n          Set fldRange = fld.result\n          fld.Delete\n          fldRange = sDataContent\n    End Select\nNext\n</code></pre>\n\n<ol start=\"5\">\n<li><strong>Find/Replace</strong> is also an option. Usually, some kind of special character delimits the start and end of the \"placeholder\". The code searches these characters, reads the placeholder and inserts data at the \"found\" position.</li>\n</ol>\n\n<p>Simple search code:</p>\n\n<pre><code>Dim wdDoc As Word.Document\nDim sPlaceholder as String, sData as String\n\nsData = \"Data as string\"\nsPlaceholder = \"DataFieldName\"\nSet wdDoc = ActiveDocument\n\nWith wdDoc.content.Find\n    .ClearFormatting\n    .Text = \"&lt;&lt;\" &amp; sPlaceholder &amp; \"&gt;&gt;\"\n    With .Replacement\n        .ClearFormatting\n        .Text = sData\n    End With\n    .Execute Replace:=wdReplaceAll\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7359278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab896635967aad4ebf7670ad0402e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Rui", "link": "https://stackoverflow.com/users/7359278/rui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 933, "favorite_count": 0, "accepted_answer_id": 49904015, "answer_count": 1, "score": 0, "last_activity_date": 1524770127, "creation_date": 1524064445, "last_edit_date": 1524766515, "question_id": 49903311, "link": "https://stackoverflow.com/questions/49903311/exporting-data-from-excel-to-word-data-targets-placeholders", "title": "Exporting data from Excel to Word: data targets/placeholders", "body": "<p>In Excel I have a userform that has a ListBox being populated from an Excel table using RowSource=myTable. </p>\n\n<p>Now I want to select one line, press a button, and export every column from the selected row to different places on a Word document, which is a template with pre-formated text. Column1 should go to place1, column2 to place2, whatever I want... </p>\n\n<p>What data targets/placeholders are available in Word for inserting data?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1524063928, "post_id": 49902969, "comment_id": 86821744, "body": "I can only suggest to bring your data to standart view, which is table."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1524066684, "creation_date": 1524066684, "answer_id": 49904008, "question_id": 49902969, "link": "https://stackoverflow.com/questions/49902969/autofilter-for-4-criterias-in-a-single-column-using-excel-vba/49904008#49904008", "title": "Autofilter for 4 criterias in a single column using excel vba", "body": "<p>It is easier to re-distribute your data, but to use AutoFIlter you can reduce <strong>4</strong> criteria to <strong>1</strong> criteria by applying a \"helper\" column.</p>\n\n<p>The helper column will contain the formula:</p>\n\n<pre><code>=IF(OR(ISNUMBER(FIND(\"Number\",A2)),ISNUMBER(FIND(\"Name\",A2)),ISNUMBER(FIND(\"Street\",A2)),ISNUMBER(FIND(\"Address\",A2))),\"Display\",\"Hide\")\n</code></pre>\n\n<p>We can then filter on the \"helper\".  Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UQ30S.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UQ30S.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code:</p>\n\n<pre><code>Sub User()\n    Dim N As Long, r1 As Range, r2 As Range\n    Dim s As String\n\n    N = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Range(\"B1\").Value = \"helper\"\n    Set r1 = Range(\"B2:B\" &amp; N)\n    s = \"=IF(OR(ISNUMBER(FIND(\"\"Number\"\",A2)),ISNUMBER(FIND(\"\"Name\"\",A2)),ISNUMBER(FIND(\"\"Street\"\",A2)),ISNUMBER(FIND(\"\"Address\"\",A2))),\"\"Display\"\",\"\"Hide\"\")\"\n    r1.Formula = s\n\n    With Range(\"A:B\")\n        .AutoFilter\n        .AutoFilter Field:=2, Criteria1:=\"Display\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>and after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/c05F5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c05F5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1524081414, "creation_date": 1524081414, "answer_id": 49908023, "question_id": 49902969, "link": "https://stackoverflow.com/questions/49902969/autofilter-for-4-criterias-in-a-single-column-using-excel-vba/49908023#49908023", "title": "Autofilter for 4 criterias in a single column using excel vba", "body": "<p>AutoFilter is limited to 2 criteria with wildcards (* or ?)</p>\n\n<p>The 2 versions below will allow you to specify as many wildcards as you need</p>\n\n<hr>\n\n<p>.</p>\n\n<p><strong>Version 1</strong> - Loops through each wildcard applying the AutoFliter and combining the visible ranges</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub FilterRows3WildAF()      '(Optional ByVal showAll As Boolean = False)\n\n    Const FILTER_COL = \"A\"\n    Const WILDCARDS = \"Name Street Address Number\"  'cell starts with these 4 words\n\n    Dim ws As Worksheet, wild As Variant, lr As Long, toShow As Range, itm As Variant\n\n    Set ws = ActiveSheet\n    wild = Split(WILDCARDS) 'will search for cells starting with: Name*, then Street*, etc\n    Application.ScreenUpdating = False\n    ws.Rows.Hidden = False\n\n    With ws.Range(ws.Cells(1), ws.Cells(ws.Rows.Count, FILTER_COL).End(xlUp))\n        lr = .Rows.Count\n        Set toShow = .Cells(lr + 1, FILTER_COL)\n        For Each itm In wild\n            .AutoFilter Field:=1, Criteria1:=itm &amp; \"*\", Operator:=xlFilterValues\n            If .SpecialCells(xlCellTypeVisible).Cells.CountLarge &gt; 1 Then\n                Set toShow = Union(toShow, .Offset(1).SpecialCells(xlCellTypeVisible))\n            End If\n        Next\n        .AutoFilter\n        .Rows.Hidden = True\n        toShow.EntireRow.Hidden = False\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>.</p>\n\n<p><strong>Version 2</strong> - Loops through each cell, checking with InStr() if the wildcard exists</p>\n\n<hr>\n\n<pre><code>Public Sub FilterRows3WildInstr()   '(Optional ByVal showAll As Boolean = False)\n\n    Const FILTER_COL = \"A\"\n    Const WILDCARDS = \"Name Street Address Number\"  'cell starts with these 4 words\n\n    Dim ws As Worksheet, wild As Variant, lr As Long, arr As Variant\n    Dim toHide As Range, r As Long, itm As Variant, found As Boolean\n\n    Set ws = ActiveSheet\n    wild = Split(WILDCARDS) 'will search for cells starting with: Name*, then Street*, etc\n    ws.Rows.Hidden = False\n\n    With ws.Range(ws.Cells(1), ws.Cells(ws.Rows.Count, FILTER_COL).End(xlUp))\n        lr = .Rows.Count\n        arr = .Value2\n        Set toHide = .Cells(lr + 1, FILTER_COL)\n        For r = 1 To UBound(arr)\n            For Each itm In wild\n                found = InStr(1, arr(r, 1), itm) &gt; 0\n                If found Then Exit For\n            Next\n            If Not found Then Set toHide = Union(toHide, .Cells(r, FILTER_COL))\n        Next\n        toHide.EntireRow.Hidden = True: .Rows(lr + 1).Hidden = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9665007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a766f6ee2f47a4cd1eefd6891fb18575?s=128&d=identicon&r=PG&f=1", "display_name": "User1995", "link": "https://stackoverflow.com/users/9665007/user1995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 1, "accepted_answer_id": 49904008, "answer_count": 2, "score": -2, "last_activity_date": 1524081414, "creation_date": 1524063409, "last_edit_date": 1524065269, "question_id": 49902969, "link": "https://stackoverflow.com/questions/49902969/autofilter-for-4-criterias-in-a-single-column-using-excel-vba", "title": "Autofilter for 4 criterias in a single column using excel vba", "body": "<p><a href=\"https://i.stack.imgur.com/UUgsy.png\" rel=\"nofollow noreferrer\">i need this kind of filtered data in excel</a>I need to filter 4 Criteria in one column. Used autofilter but it didn't work.it work's only for 2 Criteria.\n<a href=\"https://i.stack.imgur.com/JplzP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JplzP.png\" alt=\"The code that I have used and didn&#39;t worked\"></a></p>\n\n<p>Please give a solution for this issue.</p>\n\n<p>P.S: I am a beginner in Excel Vba.</p>\n"}, {"tags": ["excel", "sap-gui", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9664666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b1476d9bd09bf207b9bcc95e70b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jefran", "link": "https://stackoverflow.com/users/9664666/jefran"}, "edited": false, "score": 0, "creation_date": 1524162473, "post_id": 49914281, "comment_id": 86871642, "body": "Thank you for your response, but I still get the same result.  Strictly all the commands were not recorded directly by the recorder, as that doesn&#39;t record the vital saving to the external application, rather I took the published code for copying the header text and substituted the recorded code for displaying the item text for that which showed the header text, assuming, or hoping that the next line would copy the new source text in the same way as it had the header text."}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 11, "user_id": 9664666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b1476d9bd09bf207b9bcc95e70b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jefran", "link": "https://stackoverflow.com/users/9664666/jefran"}, "edited": false, "score": 0, "creation_date": 1524165434, "post_id": 49914281, "comment_id": 86873240, "body": "Can you publish a screen shot please?"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 11, "user_id": 9664666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b1476d9bd09bf207b9bcc95e70b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jefran", "link": "https://stackoverflow.com/users/9664666/jefran"}, "edited": false, "score": 0, "creation_date": 1524210578, "post_id": 49914281, "comment_id": 86888751, "body": "But you could also record a script that writes a new text in the container. The recording will then be stopped and you will not save the new text of course. In the script itself you have the command what you could use then."}, {"owner": {"reputation": 11, "user_id": 9664666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b1476d9bd09bf207b9bcc95e70b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jefran", "link": "https://stackoverflow.com/users/9664666/jefran"}, "edited": false, "score": 0, "creation_date": 1524303705, "post_id": 49914281, "comment_id": 86925218, "body": "That is a  great idea - thank you!  I&#39;ll give it a go and report back."}, {"owner": {"reputation": 11, "user_id": 9664666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b1476d9bd09bf207b9bcc95e70b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jefran", "link": "https://stackoverflow.com/users/9664666/jefran"}, "edited": false, "score": 0, "creation_date": 1524665967, "post_id": 49914281, "comment_id": 87065308, "body": "I have a script which puts text into the relevant place, but how do I show it?  It is too big to be a comment."}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 11, "user_id": 9664666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b1476d9bd09bf207b9bcc95e70b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jefran", "link": "https://stackoverflow.com/users/9664666/jefran"}, "edited": false, "score": 0, "creation_date": 1524679921, "post_id": 49914281, "comment_id": 87073714, "body": "I did not ask a question here. But I would imagine that you can edit the question or you can give yourself an answer with the recorded script."}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": false, "score": 0, "last_activity_date": 1524119875, "creation_date": 1524119875, "answer_id": 49914281, "question_id": 49902654, "link": "https://stackoverflow.com/questions/49902654/sap-sales-order-text-extraction-to-excel/49914281#49914281", "title": "SAP Sales Order Text Extraction to Excel", "body": "<p>Unfortunately, I do not have access to transaction VA03. But if all commands were actually recorded by the script recorder, then I can imagine that the data is not ready when they are queried. And so perhaps a little break might be the solution.</p>\n\n<p>for example:</p>\n\n<pre><code>...\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\09/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[0]/shell\").doubleClickItem \"Z102\", \"Column1\"\nwaitTill = Now() + TimeValue(\"00:00:01\")\nWhile Now() &lt; waitTill\n  DoEvents\nWend\n\nCells(1, 1) = session.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\09/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[0]/shell\").Text\n...\n</code></pre>\n\n<p>Regards,\nScriptMan</p>\n"}], "owner": {"reputation": 11, "user_id": 9664666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b1476d9bd09bf207b9bcc95e70b2a6?s=128&d=identicon&r=PG&f=1", "display_name": "Jefran", "link": "https://stackoverflow.com/users/9664666/jefran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524119875, "creation_date": 1524062554, "last_edit_date": 1531164843, "question_id": 49902654, "link": "https://stackoverflow.com/questions/49902654/sap-sales-order-text-extraction-to-excel", "title": "SAP Sales Order Text Extraction to Excel", "body": "<p>For years I worked with an ERP system that I could reach every corner of and get data out of very easily, but we have now moved to a global SAP system and with a much lower level of access things are not as easy.\nI have a specific requirement to extract the data from some of the sales order item text fields; because these are encrypted and because I am limited to SQVI, this can't be done directly.\nI tried recording a script to extract the data using transaction VA03 and found as everyone else has that the vital parts of saving as a local file aren't recorded.  I found a very useful post in the SAP archived discussions, <a href=\"https://archive.sap.com/discussions/thread/3240622\" rel=\"nofollow noreferrer\">https://archive.sap.com/discussions/thread/3240622</a> in which this very problem was addressed, and managed to get header text saved into Excel by making some trivial changes to suit our configuration.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Macro1()\r\n'\r\n' Macro1 Macro\r\n'\r\n\r\n\r\nIf Not IsObject(sap) Then\r\n\r\n   Set SapGuiAuto = GetObject(\"SAPGUI\")\r\n\r\n   Set sap = SapGuiAuto.GetScriptingEngine\r\n\r\nEnd If\r\n\r\nIf Not IsObject(Connection) Then\r\n\r\n   Set Connection = sap.Children(0)\r\n\r\nEnd If\r\n\r\nIf Not IsObject(session) Then\r\n\r\n   Set session = Connection.Children(0)\r\n\r\nEnd If\r\n\r\nIf IsObject(WScript) Then\r\n\r\n   WScript.ConnectObject session, \"on\"\r\n\r\n   WScript.ConnectObject sap, \"on\"\r\n\r\nEnd If\r\n\r\nsession.findById(\"wnd[0]\").resizeWorkingPane 167, 31, False\r\n\r\nsession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nva03\"\r\n\r\nsession.findById(\"wnd[0]\").sendVKey 0\r\n\r\nsession.findById(\"wnd[0]/usr/ctxtVBAK-VBELN\").Text = \"nnnnnn\"\r\n\r\nsession.findById(\"wnd[0]\").sendVKey 0\r\nsession.findById(\"wnd[0]/usr/subSUBSCREEN_HEADER:SAPMV45A:4021/btnBT_HEAD\").press\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\09\").Select\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\09/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[0]/shell\").selectItem \"Z005\", \"Column1\"\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\09/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[0]/shell\").ensureVisibleHorizontalItem \"Z005\", \"Column1\"\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\09/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[0]/shell\").doubleClickItem \"Z005\", \"Column1\"\r\n\r\nCells(1, 1) = session.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\08/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[1]/shell\").Text\r\n\r\nsession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>This works, (the order number has been suppressed as nnnnnn in the highly unlikely event that someone might recognise it) and I was able to get data from other fields by adding lines, but when I try to do the same kind of thing for item text with the variation below</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>ub Macro1()\r\n'\r\n' Macro1 Macro\r\n'\r\n\r\n\r\nIf Not IsObject(sap) Then\r\n\r\n   Set SapGuiAuto = GetObject(\"SAPGUI\")\r\n\r\n   Set sap = SapGuiAuto.GetScriptingEngine\r\n\r\nEnd If\r\n\r\nIf Not IsObject(Connection) Then\r\n\r\n   Set Connection = sap.Children(0)\r\n\r\nEnd If\r\n\r\nIf Not IsObject(session) Then\r\n\r\n   Set session = Connection.Children(0)\r\n\r\nEnd If\r\n\r\nIf IsObject(WScript) Then\r\n\r\n   WScript.ConnectObject session, \"on\"\r\n\r\n   WScript.ConnectObject sap, \"on\"\r\n\r\nEnd If\r\n\r\nsession.findById(\"wnd[0]\").resizeWorkingPane 167, 31, False\r\n\r\nsession.findById(\"wnd[0]/tbar[0]/okcd\").Text = \"/nva03\"\r\n\r\nsession.findById(\"wnd[0]\").sendVKey 0\r\n\r\nsession.findById(\"wnd[0]/usr/ctxtVBAK-VBELN\").Text = \"nnnnnn\"\r\nsession.findById(\"wnd[0]\").sendVKey 0\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/subSUBSCREEN_BUTTONS:SAPMV45A:4050/btnBT_POPO\").press\r\nsession.findById(\"wnd[1]/usr/txtRV45A-POSNR\").Text = \"351\"\r\nsession.findById(\"wnd[1]/usr/txtRV45A-POSNR\").caretPosition = 3\r\nsession.findById(\"wnd[1]\").sendVKey 0\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_OVERVIEW/tabpT\\01/ssubSUBSCREEN_BODY:SAPMV45A:4400/subSUBSCREEN_TC:SAPMV45A:4900/subSUBSCREEN_BUTTONS:SAPMV45A:4050/btnBT_PKON\").press\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\09\").Select\r\n' Texts is 9th tab - this leaves cursor on first text line, next line moves to Customer tags, but doesn't show content, which only shows on doubleClickItem \"Z102\" line\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\09/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[0]/shell\").selectItem \"Z102\", \"Column1\"\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\09/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[0]/shell\").ensureVisibleHorizontalItem \"Z102\", \"Column1\"\r\nsession.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_ITEM/tabpT\\09/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[0]/shell\").doubleClickItem \"Z102\", \"Column1\"\r\n\r\nCells(1, 1) = session.findById(\"wnd[0]/usr/tabsTAXI_TABSTRIP_HEAD/tabpT\\09/ssubSUBSCREEN_BODY:SAPMV45A:4152/subSUBSCREEN_TEXT:SAPLV70T:2100/cntlSPLITTER_CONTAINER/shellcont/shellcont/shell/shellcont[0]/shell\").Text\r\n\r\n\r\nsession.findById(\"wnd[0]/tbar[0]/btn[3]\").press\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>This brings up the the required fields on the SAP screen but then throws up an error, \"Run-time error '619' The control could not be found be id.\"</p>\n\n<p>I clearly don't understand all that is going on - can someone help me, please?</p>\n\n<p>Andrew</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1524541100, "post_id": 49902559, "comment_id": 87002450, "body": "Where&#39;s your form and code to select the Part numbers and Workcenter? Your tables are fine. You just need the combo boxes to hide the key ID fields, display the text, and then append the data using the combo box values in field 1."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1525117444, "post_id": 49902559, "comment_id": 87231637, "body": "Have you defined relational integrity in your Access database? You can find this in the Relationships button, usually under the Database Tools menu. If you see the relationships you desire for the three tables above, your work is done. The database will automatically enforce relational integrity for you. You won&#39;t need the <code>Workcenters</code> and <code>PM_Parts</code> tables in the query, if all you are trying to do is ensure the foreign keys exist."}], "owner": {"reputation": 45, "user_id": 6409941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a502a9e2300c2bf8493687e022c807b0?s=128&d=identicon&r=PG&f=1", "display_name": "jhalf2008", "link": "https://stackoverflow.com/users/6409941/jhalf2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524541173, "creation_date": 1524062335, "last_edit_date": 1524541173, "question_id": 49902559, "link": "https://stackoverflow.com/questions/49902559/query-is-not-updateable-join-key-is-not-in-recordset", "title": "Query is Not Updateable - Join Key is Not in Recordset", "body": "<p>I am unable to add new records to this query. It is set up such that table \"SOL_Routing\" is a many to many, meaning only the combination of fields [PartID], [WC_ID], and [Operation] can uniquely identify a record because all 3 of these fields need to allow duplicate values. The same combination of these 3 fields should not exist twice.\n<a href=\"https://i.stack.imgur.com/576OX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/576OX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Example of query data set:</p>\n\n<pre><code>Part_No    Operation    Workcenter\nX          1            WC1\nX          2            WC1\nX          3            WC2\nY          1            WC1\nY          2            WC4\nY          3            WC7\n</code></pre>\n\n<p>How can I change the keys or arrange my data differently to allow me to add new records to this query? I do not want to loose referential integrity by changing the Recordset type to \"Inconsistent Updates\". The whole purpose of the query is to add the new record to SOL_Routings by being able to enter \"[Workcenter]\" and \"[Part_No]\" names through the joined ID.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 3, "creation_date": 1524061668, "post_id": 49902215, "comment_id": 86819988, "body": "Its a property let so expects to be assigned a value: <code>foo.ParseSegment = something</code> where <code>something</code> is set to <code>value</code> within the routine."}], "answers": [{"comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1524062964, "post_id": 49902282, "comment_id": 86820997, "body": "Oops, sorry, got my <code>Let</code> and <code>Get</code> mixed up, ... fixed now."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1524063198, "post_id": 49902282, "comment_id": 86821166, "body": "Perfect it works great now! Appreciate the hasty response :)"}], "tags": [], "owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "is_accepted": true, "score": 2, "last_activity_date": 1524063009, "last_edit_date": 1524063009, "creation_date": 1524061561, "answer_id": 49902282, "question_id": 49902215, "link": "https://stackoverflow.com/questions/49902215/invalid-use-of-property/49902282#49902282", "title": "Invalid use of Property", "body": "<p>It's a property, not a method(Sub).  You are trying to call it like a method.  Property assignments must be assigned to.</p>\n\n<pre><code>foo.ParseSegment = \"\"\n</code></pre>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 49902282, "answer_count": 1, "score": -1, "last_activity_date": 1524063009, "creation_date": 1524061371, "last_edit_date": 1531164843, "question_id": 49902215, "link": "https://stackoverflow.com/questions/49902215/invalid-use-of-property", "title": "Invalid use of Property", "body": "<p><strong>TESTING MODULE</strong></p>\n\n<pre><code>Private Sub fooTest()\n\n   Dim foo As cSegment\n   Set foo = New cSegment\n\n   foo.ParseSegment\n\n   Debug.Print foo.Segment\n\nEnd Sub\n</code></pre>\n\n<p><strong>CLASS</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate pElements As Collection\nPrivate pSegmentData As String\n\nPublic Property Let ParseSegment(value As String)\n   pSegmentData = value\n   ParseElements pSegmentData\nEnd Property\n</code></pre>\n\n<p>I keep getting an error on <code>foo.ParseSegment</code> saying \"Invalid Use of property\"</p>\n\n<p>I'm not sure whats wrong here, as to my understanding my <code>Let</code> property is setup correctly. Does anyone know why I might be getting this error message?</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1524065059, "post_id": 49902194, "comment_id": 86822618, "body": "I believe you&#39;ll find the answer to converting text to numbers in this Stack Overflow discussion: <a href=\"https://stackoverflow.com/questions/36771458/vba-convert-text-to-number\" title=\"vba convert text to number\">stackoverflow.com/questions/36771458/vba-convert-text-to-num&zwnj;&#8203;ber</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 9664804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18755364273b98f62a0cf4fc202a3dab?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/9664804/drac"}, "is_accepted": true, "score": 0, "last_activity_date": 1524125581, "creation_date": 1524125581, "answer_id": 49915977, "question_id": 49902194, "link": "https://stackoverflow.com/questions/49902194/while-exporting-table-in-access-to-sheet-in-excel-i-need-to-set-date-and-number/49915977#49915977", "title": "While exporting table in access to sheet in excel, I need to set Date and Number value in Excel row", "body": "<p>Thank you Cindy for helping me out and finding the answer. The code in the link you provided didnt work for me straight away but after playing around with it a bit i came up with the following</p>\n\n<p><code>wks.range(\"Z2:Z\" &amp; rs.RecordCount + 1).NumberFormat = \"0\"\n wks.range(\"Z2:Z\" &amp; rs.RecordCount + 1).Value = wks.range(\"Z2:Z\" &amp; rs.RecordCount + 1).Value</code></p>\n\n<p>This finally solved my problem. Thank you so much for the help !</p>\n"}], "owner": {"reputation": 27, "user_id": 9664804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18755364273b98f62a0cf4fc202a3dab?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/9664804/drac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 49915977, "answer_count": 1, "score": 0, "last_activity_date": 1524125581, "creation_date": 1524061330, "last_edit_date": 1524069978, "question_id": 49902194, "link": "https://stackoverflow.com/questions/49902194/while-exporting-table-in-access-to-sheet-in-excel-i-need-to-set-date-and-number", "title": "While exporting table in access to sheet in excel, I need to set Date and Number value in Excel row", "body": "<p>I have written a small code to export a query from Access to a sheet in Excel.</p>\n\n<p>In the Excel sheet i have one problem; there is one row (underneath a header) that need to be converted into a  </p>\n\n<ul>\n<li>number value</li>\n</ul>\n\n<p>Basically my VBA code should do what i now have to do by hand.</p>\n\n<ul>\n<li>Number value: Select the cells containing the numbers.\nPress  (popup) and select \"convert to number\"</li>\n</ul>\n\n<p>I already have this</p>\n\n<pre><code>wks.range(\"Z2:Z\" &amp; rs.RecordCount + 1).numberformat = \"General\"\n</code></pre>\n\n<p>but it doesn't work</p>\n\n<p>For reference below is my full code</p>\n\n<pre><code>SUB UnknownProcName\n\n  Dim appXL As Object\n  Dim wb As Object\n  Dim wks As Object\n  Dim xlf As String\n  Dim rs As DAO.Recordset\n\n  'Full path to Excel file'\n\n\n  Set rs = CurrentDb.OpenRecordset(\"openPOLIST\")\n  Set wks = wb.Sheets(\"INP.OpenPOlist\")\n\n  wks.range(\"A1\").select\n  For Each fld In rs.Fields\n      appXL.ActiveCell = fld.Name\n      appXL.ActiveCell.Offset(0, 1).select\n  Next\n  wks.range(\"A2\").CopyFromRecordset rs\n  wks.range(\"A1\" &amp; rs.RecordCount + 1).Columns.AutoFit\n\n  wks.range(\"Z2:Z\" &amp; rs.RecordCount + 1).numberformat = \"General\"\n\n  rs.Close\n  wb.Save\n  wb.Close\n  appXL.Quit\n  Set wb = Nothing\n  Set rs = Nothing\n\n  DoCmd.SetWarnings True\n  MsgBox (\"Well... it does give a warning...\")\nEnd Sub\n</code></pre>\n\n<p>After i run the export the number it looks like this After export and has indeed the text value:</p>\n\n<p><a href=\"https://i.stack.imgur.com/H5FZZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/H5FZZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I press this button and choose convert to number it has the desired value</p>\n\n<p><a href=\"https://i.stack.imgur.com/rlYYv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rlYYv.png\" alt=\"enter image description here\"></a></p>\n\n<p>and looks like this after manual change</p>\n\n<p><a href=\"https://i.stack.imgur.com/Gtk7J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gtk7J.png\" alt=\"https://i.stack.imgur.com/Gtk7J.png\"></a></p>\n"}, {"tags": ["c++", "excel", "vba", "debugging"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524061985, "post_id": 49902164, "comment_id": 86820220, "body": "Does it work if you add an actual reference to the DLL (via tools/references) in the VBE?"}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524063419, "post_id": 49902164, "comment_id": 86821357, "body": "Seems to be the same issue when adding a reference via tools/references"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524063674, "post_id": 49902164, "comment_id": 86821555, "body": "I&#39;m not familiar with C++, but is there a COM registration for the library? The entry point would have a specific GUID that you should be able to find in the registry under <code>HKCR&#47;CLSID&#47;{GUID}</code> - that key would have an <code>InprocServer32</code> subkey, with a <code>CodeBase</code> path pointing to the DLL location - is it there and pointing to the build path?"}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524064197, "post_id": 49902164, "comment_id": 86821951, "body": "It is indeed an ATL COM project; I&#39;m still a bit overwhelmed by COM registration - it cannot be registered on a machine level due to lack of admin rights (and indeed none of the GUIDs are under HKCR/CLSID). Could there be anything similar in terms of user-level registration in any other registry tree?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524064542, "post_id": 49902164, "comment_id": 86822212, "body": "I&#39;m not 100% sure, but with my own side project (a COM add-in for the VBE, written in C#), I have to run VS as administrator in order to get a build to correctly register. If you leave the VBE opened with an early-bound reference to the DLL, can you still successfully build the DLL? If so, you&#39;re somehow not loading the DLL from the build location - VS shouldn&#39;t be able to overwrite the DLL while it&#39;s in use."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524065359, "post_id": 49902164, "comment_id": 86822863, "body": "hmm, odd indeed - I&#39;m stumped at this point... good luck!"}, {"owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524065945, "post_id": 49902164, "comment_id": 86823252, "body": "Ah, my mistake (deleted the previous comment). Built the DLL without changing code, so VS didn&#39;t try to recreate it in the first place. In short - rebuilding the DLL while its referenced in VBA does indeed not work as it is in use"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1524070252, "post_id": 49902164, "comment_id": 86825910, "body": "FYI it&#39;s possible to register a COM DLL without admin right. Either write yourself the keys in <code>HKCU</code> instead of <code>HKCR</code> or override the registry root with <code>RegOverridePredefKey</code> before the registration."}], "answers": [{"tags": [], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "is_accepted": false, "score": 1, "last_activity_date": 1524481281, "creation_date": 1524481281, "answer_id": 49979503, "question_id": 49902164, "link": "https://stackoverflow.com/questions/49902164/debugging-a-c-dll-loaded-into-excel-via-loadlibrary/49979503#49979503", "title": "Debugging a C++ DLL loaded into Excel via LoadLibrary()", "body": "<p>You might try to add a __debugbreak directive. If the dll is build in debug, it should open the Windows Just in Time debugger.</p>\n\n<pre><code>__declspec(dllexport) int __stdcall Test()\n{\n  __debugbreak(); \n  return 123;\n}\n</code></pre>\n\n<p>see <a href=\"https://msdn.microsoft.com/en-us//library/f408b4et.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us//library/f408b4et.aspx</a></p>\n"}], "owner": {"reputation": 3613, "user_id": 3437979, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/6b05c587e3faf4af86bcff4ac556086b?s=128&d=identicon&r=PG&f=1", "display_name": "Bogey", "link": "https://stackoverflow.com/users/3437979/bogey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1524481281, "creation_date": 1524061259, "question_id": 49902164, "link": "https://stackoverflow.com/questions/49902164/debugging-a-c-dll-loaded-into-excel-via-loadlibrary", "title": "Debugging a C++ DLL loaded into Excel via LoadLibrary()", "body": "<p>I'm writing a C++-based DLL which exports a few functions, let's say in a simple case</p>\n\n<pre><code>__declspec(dllexport) int __stdcall Test()\n{\n  return 123;\n}\n</code></pre>\n\n<p>Then, I load this DLL into a running Excel process via VBA, and invoke its Test function:</p>\n\n<pre><code>Private Declare PtrSafe Function LoadLibrary Lib \"kernel32\" Alias \"LoadLibraryA\" (ByVal lpLibFileName As String) As LongPtr\nPrivate Declare Function Test Lib \"MyLibrary.dll\" () As Long\n\nSub executeTest()\n  LoadLibrary \"Path\\To\\MyLibrary.dll\"\n  Dim result As Long: result = Test()\nEnd Sub\n</code></pre>\n\n<p>This works fine. But I don't seem to be able to Debug the C++ part of it.</p>\n\n<p>I've tried firing up Excel, and before executing any code (i.e. befoer the DLL is loaded into Excel), attaching Visual Studio to the running Excel process.\nWhen I set a breakpoint, it's \"white\" - aka \"This breakpoint will not currently be hit. No symbols have been loaded for this document\". Makes sense as my DLL hasn't been laoded into Excel yet.</p>\n\n<p>Then, I execute the VBA code, which will load up the DLL and invoke the Test function. But the debugger's status doesn't change, the breakpoint remains in this state; at no point does it seem to realize the library has been loaded / is able to debug it.</p>\n\n<p>Am I doing anything wrong there? Is there a way to debug calls to my DLL in this scenario?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "range", "spreadsheet"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9664830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac3a405c23bc0e8e6ed82d61613dd0a5?s=128&d=identicon&r=PG&f=1", "display_name": "MDC1992", "link": "https://stackoverflow.com/users/9664830/mdc1992"}, "edited": false, "score": 0, "creation_date": 1524061894, "post_id": 49902299, "comment_id": 86820152, "body": "Tried, but it is still not moving the data over??"}], "tags": [], "owner": {"reputation": 373, "user_id": 5214530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ilIQx.png?s=128&g=1", "display_name": "user5214530", "link": "https://stackoverflow.com/users/5214530/user5214530"}, "is_accepted": false, "score": 0, "last_activity_date": 1524061614, "creation_date": 1524061614, "answer_id": 49902299, "question_id": 49902094, "link": "https://stackoverflow.com/questions/49902094/creating-a-new-sheet-copying-data-and-naming-the-sheet/49902299#49902299", "title": "Creating a new sheet, copying data and naming the sheet", "body": "<p>you can try next code:</p>\n\n<pre><code>Sub CreateNewSheet()\nsheet_name_to_create = Sheet1.Range(\"F5\").Value\nSheet1.Range(\"C4:G17\").Copy \n\nFor rep = 1 To (Worksheets.Count)\nIf LCase(Sheets(rep).Name) = LCase(sheet_name_to_create) Then\nMsgBox \"Already Exists!\"\nExit Sub\nEnd If\nNext\nSheets.Add After:=Sheets(Sheets.Count)\nSheets(ActiveSheet.Name).Name = sheet_name_to_create\nSheets(sheet_name_to_create).Range(\"C4:G17\").PasteSpecial xlPasteValues\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9664830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac3a405c23bc0e8e6ed82d61613dd0a5?s=128&d=identicon&r=PG&f=1", "display_name": "MDC1992", "link": "https://stackoverflow.com/users/9664830/mdc1992"}, "edited": false, "score": 0, "creation_date": 1524066800, "post_id": 49903120, "comment_id": 86823827, "body": "BOOOOOOMMM! THHANK YOU!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": true, "score": 0, "last_activity_date": 1524063878, "creation_date": 1524063878, "answer_id": 49903120, "question_id": 49902094, "link": "https://stackoverflow.com/questions/49902094/creating-a-new-sheet-copying-data-and-naming-the-sheet/49903120#49903120", "title": "Creating a new sheet, copying data and naming the sheet", "body": "<p>Try this:</p>\n\n<pre><code>Sub copy_newsheet()\n\nDim pname\nDim ws As Worksheet\n\npname = ActiveSheet.Range(\"F5\").Value\n\nFor Each ws In ActiveWorkbook.Sheets\n\nIf ws.Name = pname Then\nMsgBox \"Already Exists\"\nExit Sub\nEnd If\n\nNext ws\n\nActiveSheet.Range(\"C4:G17\").Copy\nSheets.Add After:=ActiveSheet\nActiveSheet.Range(\"C4:G17\").PasteSpecial Paste:=xlPasteValues\nActiveSheet.Range(\"C4:G17\").PasteSpecial Paste:=xlPasteFormats\nActiveSheet.Name = pname\n\nEnd Sub  \n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9664830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac3a405c23bc0e8e6ed82d61613dd0a5?s=128&d=identicon&r=PG&f=1", "display_name": "MDC1992", "link": "https://stackoverflow.com/users/9664830/mdc1992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 49903120, "answer_count": 2, "score": 0, "last_activity_date": 1524069760, "creation_date": 1524061071, "last_edit_date": 1524069760, "question_id": 49902094, "link": "https://stackoverflow.com/questions/49902094/creating-a-new-sheet-copying-data-and-naming-the-sheet", "title": "Creating a new sheet, copying data and naming the sheet", "body": "<p>I need help!</p>\n\n<p>I am looking to create a button that will create a new worksheet, copying the data that has been inputted and naming the sheet the value which is entered in F5.</p>\n\n<p>I have this so far:</p>\n\n<pre><code>Sub CreateNewSheet()\nsheet_name_to_create = Sheet1.Range(\"F5\").Value\n\nFor rep = 1 To (Worksheets.Count)\nIf LCase(Sheets(rep).Name) = LCase(sheet_name_to_create) Then\nMsgBox \"Already Exists!\"\nExit Sub\nEnd If\nNext\nSheets.Add After:=Sheets(Sheets.Count)\nSheets(ActiveSheet.Name).Name = sheet_name_to_create\n\nEnd Sub\n</code></pre>\n\n<p>This is creating the new sheet for me, naming it the value which is in F5.\nBut I need to copy the range C4:G17</p>\n\n<p>Can someone help me please?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1524060691, "post_id": 49901794, "comment_id": 86819218, "body": "I don&#39;t understand how that can be happening - if the filter doesn&#39;t exist, running that code should be giving you a <code>Run-time error &#39;1004&#39;</code>. Can you show us more of your code? Something&#39;s missing here-"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524061147, "post_id": 49901794, "comment_id": 86819548, "body": "Does it default to the first pivotitem?"}, {"owner": {"reputation": 3, "user_id": 9500092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "d williams", "link": "https://stackoverflow.com/users/9500092/d-williams"}, "edited": false, "score": 0, "creation_date": 1524061348, "post_id": 49901794, "comment_id": 86819712, "body": "dwirony: Edited with more of the code. QHarr: No it overwrites whatever is in the current Pivot Item. So I added the clearfilter but it will still overwrite the last thing vba filtered to."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1524062097, "post_id": 49901794, "comment_id": 86820303, "body": "@dwirony <code>On Error Resume Next</code> is what was missing ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524062143, "post_id": 49901794, "comment_id": 86820342, "body": "FWIW the inner <code>With</code> block seems redundant."}], "owner": {"reputation": 3, "user_id": 9500092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "d williams", "link": "https://stackoverflow.com/users/9500092/d-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 320, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524061284, "creation_date": 1524060222, "last_edit_date": 1524061284, "question_id": 49901794, "link": "https://stackoverflow.com/questions/49901794/vba-pivotfields-currentpage-overwriting-value", "title": "VBA pivotfields.Currentpage overwriting value", "body": "<p>I have a set list of products A through D that can appear in a table. When pivoted out I use VBA to set the filter and copy the data into a different table. The issue I run into is if the product value isn't in the given set of data it overwrites whatever is currently in the filter. </p>\n\n<p>Pivot Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iOCn6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iOCn6.png\" alt=\"img1\"></a></p>\n\n<p>Pivot After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IV9dK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IV9dK.png\" alt=\"img2\"></a></p>\n\n<p>Ex. Client 1 only has products A, B, D. VBA will go through and try to filter C but since C is not in the filter, C will overwrite B. So when you look at the filter it will have A, C, D. </p>\n\n<p>Below is the basic code used. I've tried using error handling with Resume Next and GoTo with neither working. Any ideas?</p>\n\n<pre><code> With pvt\n    On Error Resume Next\n    .pivotFields(\"Product\").ClearAllFilters\n    .pivotFields(\"Product\").CurrentPage = \"C\"\n    If Err.Number = 0 Then\n        With pvt\n            'Code'\n        End With\n    End If\n  End With\n</code></pre>\n"}, {"tags": ["vba", "excel", "winapi", "hook"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 2, "creation_date": 1524060462, "post_id": 49901675, "comment_id": 86819059, "body": "Probably related to the message processing of Excel. Excel is the wrong place to be writing such code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524060934, "post_id": 49901675, "comment_id": 86819388, "body": "Looks like an X-Y problem. What do you need a mouse hook for?"}, {"owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "edited": false, "score": 0, "creation_date": 1524127951, "post_id": 49901675, "comment_id": 86848771, "body": "David: so I can&#39;t make hook to any process? Mathieu: I just want to undestand it better."}], "owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1524059964, "creation_date": 1524059964, "last_edit_date": 1531164843, "question_id": 49901675, "link": "https://stackoverflow.com/questions/49901675/why-windows-mouse-hook-in-excel-vba-slows-down-excel-if-there-isnt-userform", "title": "Why Windows mouse hook in Excel-VBA slows down Excel if there isn&#39;t userform?", "body": "<p>I'm setting simple mouse hook like that:  </p>\n\n<pre><code>Private Declare PtrSafe Function UnhookWindowsHookEx Lib \"user32\" (ByVal hHook As LongPtr) As LongPtr\nPrivate Declare PtrSafe Function SetWindowsHookEx Lib \"user32\" Alias \"SetWindowsHookExA\" (ByVal idHook As LongPtr, ByVal lpFn As LongPtr, ByVal hmod As LongPtr, ByVal dwThreadId As LongPtr) As LongPtr\nPrivate Declare PtrSafe Function CallNextHookEx Lib \"user32\" (ByVal hHook As LongPtr, ByVal nCode As LongPtr, ByVal wParam As LongPtr, lParam As Any) As LongPtr\nPrivate Declare PtrSafe Function GetCurrentThreadId Lib \"kernel32\" () As LongPtr\n\nPrivate HookHandle As LongPtr\n\nPrivate Const WH_MOUSE = 7\n\nPublic Sub RemoveHook()\n    On Error Resume Next\n    UnhookWindowsHookEx HookHandle\nEnd Sub\n\nPublic Sub SetHook()\n    HookHandle = SetWindowsHookEx(WH_MOUSE, AddressOf NewProc, 0, GetCurrentThreadId)\nEnd Sub\n\nPublic Function NewProc(ByVal lngCode As LongPtr, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As LongPtr\n    NewProc = CallNextHookEx(HookHandle, lngCode, wParam, lParam)\n    Exit Function\nEnd Function\n</code></pre>\n\n<p>and Excel slows down so much, that I can barely kill it.\nBut when I do that in userform:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    SetHook\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\n    RemoveHook\nEnd Sub\n</code></pre>\n\n<p>It works normal. My question is WHY?</p>\n"}, {"tags": ["sql", "sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 23458, "user_id": 4137916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bab91fda70af7e9beb8934d323540e8?s=128&d=identicon&r=PG", "display_name": "Jeroen Mostert", "link": "https://stackoverflow.com/users/4137916/jeroen-mostert"}, "edited": false, "score": 1, "creation_date": 1524059881, "post_id": 49901464, "comment_id": 86818615, "body": "I don&#39;t know enough about Access, but the answer to your last question is yes: SQL Server is an, ahem, proper database system, and those all support concurrent modifications and querying. SQL Server will do so by taking appropriate locks, so there can still be a need to schedule downtime if tables are in continuous use and you need to change the table structure, but barring hardware failure or a severe bug, the database will never corrupt. It&#39;s one of the big selling points of &quot;professional&quot; databases."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 8804702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95a5c1f7503586538c5932b597fa39a4?s=128&d=identicon&r=PG&f=1", "display_name": "Ramya", "link": "https://stackoverflow.com/users/8804702/ramya"}, "is_accepted": false, "score": 0, "last_activity_date": 1524061852, "creation_date": 1524061852, "answer_id": 49902379, "question_id": 49901464, "link": "https://stackoverflow.com/questions/49901464/can-i-add-tables-or-fields-to-access-back-end-file-while-others-are-using-the-fr/49902379#49902379", "title": "Can I add tables or fields to access back end file while others are using the front end?", "body": "<p>We can do but it is not recommended.IF there are any dependencies on the table that script/procedures would be failing.</p>\n\n<p>Create procedure using dynamic SQL and call this procedure in front-end code based on the requirement</p>\n\n<pre><code>Create procedure Name2\nAS\nBEGIN\nDECLARE @sql nvarchar(max)\nSET @SQL ='ALTER Table Temp\n   ADD  Name INT '\n\nEXEC(@SQL)\n\nEND\n\nEXEC Name2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "is_accepted": false, "score": 0, "last_activity_date": 1524129359, "creation_date": 1524129359, "answer_id": 49917215, "question_id": 49901464, "link": "https://stackoverflow.com/questions/49901464/can-i-add-tables-or-fields-to-access-back-end-file-while-others-are-using-the-fr/49917215#49917215", "title": "Can I add tables or fields to access back end file while others are using the front end?", "body": "<p>I agree with the other answers given - you can add new tables or new data to the sql backend of an access frontend that is in use.  Adding new fields to active tables would be the most risky. All of these actions should be absolutely fine, but there is always the possibility of dependencies or some other circumstance that causes a corruption.  So the best answer is, you need to assess your particular situation.  Is the access system critical to your 10 users?  So if your work on the backend does cause a corruption, will they be ok without for a short time while you restore it from backup?  If you have to restore to a backup, can they easily recreate the work that they have lost? If yes to both of those, you can do the work while they are using it, but if not then you need to do it when the front end isn't in use.  Secondly, before you do any work on the backend always remember to check that the most recent backup is a) actually recent and b) does restore as expected.  </p>\n"}, {"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1524881157, "creation_date": 1524881157, "answer_id": 50072171, "question_id": 49901464, "link": "https://stackoverflow.com/questions/49901464/can-i-add-tables-or-fields-to-access-back-end-file-while-others-are-using-the-fr/50072171#50072171", "title": "Can I add tables or fields to access back end file while others are using the front end?", "body": "<p>You can quite well do this with SQL server. If you add new columns, then again now problem. Note that the FE will not see new tables or new columns until you re-link the front end. In effect it quite safe to do this. </p>\n"}], "owner": {"reputation": 21, "user_id": 9351922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce10ba619d444e9e41ba9fea831f2db?s=128&d=identicon&r=PG&f=1", "display_name": "Wotterbed", "link": "https://stackoverflow.com/users/9351922/wotterbed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1524881157, "creation_date": 1524059394, "last_edit_date": 1524854504, "question_id": 49901464, "link": "https://stackoverflow.com/questions/49901464/can-i-add-tables-or-fields-to-access-back-end-file-while-others-are-using-the-fr", "title": "Can I add tables or fields to access back end file while others are using the front end?", "body": "<p>A similar question was asked previously but does not answer my question. I have a split database with back end and front end in Access. I have 10 users. I wish to append data to existing tables or add new fields while users are using the front end. I see in a previous thread that it is not recommended to edit a live back end. </p>\n\n<p>Is there a way with VBA and SQL to add fields or append data to the back end through the front end without the risk of corrupting the database? </p>\n\n<p>Also if I moved the back end to SQL Server, would I be able to add data or edit data in the back end while the front end is in use? </p>\n"}, {"tags": ["vba", "while-loop"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "edited": false, "score": 0, "creation_date": 1524059374, "post_id": 49901368, "comment_id": 86818224, "body": "Try replacing all ifs except the first one by ElseIf and replacing IsEmpty(ActiveCell) by sht2.Cells(nr, &quot;AO&quot;).Value = &quot;&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524059679, "post_id": 49901368, "comment_id": 86818459, "body": "Paste your whole procedure <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">here</a>, click the &quot;Indent!&quot; button - what&#39;s wrong with it will jump right at you."}, {"owner": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "edited": false, "score": 0, "creation_date": 1524059792, "post_id": 49901368, "comment_id": 86818540, "body": "Ahhhhhh that was it!!! I forgot the &quot;ElseIf&quot; and just made it say &quot;If&quot; !"}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1524059678, "post_id": 49901477, "comment_id": 86818458, "body": "Wouldn&#39;t he need <code>ElseIf</code>s instead?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1524059709, "post_id": 49901477, "comment_id": 86818477, "body": "@dwirony arguably should be a <code>Select...Case</code> block ;-)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524059721, "post_id": 49901477, "comment_id": 86818489, "body": "@MathieuGuindon Yes or that!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1524059759, "post_id": 49901477, "comment_id": 86818521, "body": "@MathieuGuindon That was what I was typing up"}, {"owner": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "edited": false, "score": 0, "creation_date": 1524059887, "post_id": 49901477, "comment_id": 86818620, "body": "Yes.. the &quot;ElseIf&quot; got me.. I had used &quot;If&quot; multiple times!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 3, "last_activity_date": 1524060041, "last_edit_date": 1524060041, "creation_date": 1524059435, "answer_id": 49901477, "question_id": 49901368, "link": "https://stackoverflow.com/questions/49901368/loop-without-do-error-cant-find-solution/49901477#49901477", "title": "Loop Without Do Error - Can&#39;t Find Solution", "body": "<p>You need 2 more End Ifs</p>\n\n<pre><code>Option Explicit\n\nSub LateralSizeID()\n\n    Dim wb As Workbook\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim nr As Long\n\n    Set wb = ThisWorkbook\n    Set sht1 = wb.Sheets(\"From AGO\")\n    Set sht2 = wb.Sheets(\"To MapCall\")\n\n    nr = 2\n\n    Range(\"AO2\").Select\n\n    Do Until IsEmpty(ActiveCell)\n\n        If sht2.Cells(nr, \"AO\").Value = \"6\" Then\n            sht2.Cells(nr, \"AO\").Value = \"2\"\n\n            If sht2.Cells(nr, \"AO\").Value = \"4\" Then\n\n                sht2.Cells(nr, \"AO\").Value = \"1\"\n\n                If sht2.Cells(nr, \"AO\").Value = \"8\" Then\n                    sht2.Cells(nr, \"AO\").Value = \"3\"\n\n                Else\n                   sht2.Cells(nr, \"AO\").Value = \"2\"\n\n                End If\n\n                nr = nr + 1\n\n                ActiveCell.Offset(1, 0).Select\n            End If\n        End If\n\n    Loop\n\n    MainSizeID\n\nEnd Sub\n</code></pre>\n\n<p>I think the whole thing could become:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub LateralSizeID()\n\n    Dim wb As Workbook\n    Dim sht1 As Worksheet\n    Dim sht2 As Worksheet\n    Dim nr As Long, rng As Range\n\n    Set wb = ThisWorkbook\n    Set sht1 = wb.Sheets(\"From AGO\")\n    Set sht2 = wb.Sheets(\"To MapCall\")\n\n    With sht2                                    'change as required\n        For Each rng In .Range(.Range(\"AO2\"), .Range(\"AO2\").End(xlDown))\n            Select Case rng.Value\n            Case 4\n                rng = 1\n            Case 8\n                rng = 3\n            Case Else\n                rng = 2\n            End Select\n        Next rng\n\n        MainSizeID\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8726203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9b4c57199fbe70fb04cc65c978590df?s=128&d=identicon&r=PG&f=1", "display_name": "Rmoore", "link": "https://stackoverflow.com/users/8726203/rmoore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524060149, "creation_date": 1524059132, "question_id": 49901368, "link": "https://stackoverflow.com/questions/49901368/loop-without-do-error-cant-find-solution", "title": "Loop Without Do Error - Can&#39;t Find Solution", "body": "<p>I am trying to loop through cells and replace certain numbers with a coded domain number (ie - 6 should be coded as a 2, etc). I have used this exact same method in numerous other places throughout this VBA and it seems to work just fine. This portion is giving the error of \"Loop Without Do\" even though there is an \"End If\" statement. I've searched through other questions and answers and can't seem to pinpoint my mistake. Any help would be greatly appreciated!</p>\n\n<pre><code>Sub LateralSizeID()\n\n'Column AO\n\nDim wb As Workbook\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim nr As Long\n\nSet wb = ThisWorkbook\nSet sht1 = wb.Sheets(\"From AGO\")\nSet sht2 = wb.Sheets(\"To MapCall\")\n\nnr = 2\n\nRange(\"AO2\").Select\n\nDo Until IsEmpty(ActiveCell)\n\n  If sht2.Cells(nr, \"AO\").Value = \"6\" Then\n        sht2.Cells(nr, \"AO\").Value = \"2\"\n\n  If sht2.Cells(nr, \"AO\").Value = \"4\" Then\n        sht2.Cells(nr, \"AO\").Value = \"1\"\n\n  If sht2.Cells(nr, \"AO\").Value = \"8\" Then\n        sht2.Cells(nr, \"AO\").Value = \"3\"\n\n  Else: sht2.Cells(nr, \"AO\").Value = \"2\"\n\n  End If\n\n  nr = nr + 1\n\nActiveCell.Offset(1, 0).Select\n\nLoop\n\nMainSizeID\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "reporting-services", "sql-server-2008-r2", "reportbuilder3.0"], "comments": [{"owner": {"reputation": 5417, "user_id": 2033717, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4S3Ha.jpg?s=128&g=1", "display_name": "StevenWhite", "link": "https://stackoverflow.com/users/2033717/stevenwhite"}, "edited": false, "score": 0, "creation_date": 1524082803, "post_id": 49901185, "comment_id": 86832633, "body": "You are supplying the parameter name in the expression so why are you trying to return it?"}, {"owner": {"reputation": 2419, "user_id": 150684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64578a71b5e38c7541134e3fdd145137?s=128&d=identicon&r=PG", "display_name": "thomas", "link": "https://stackoverflow.com/users/150684/thomas"}, "edited": false, "score": 0, "creation_date": 1524084195, "post_id": 49901185, "comment_id": 86833326, "body": "It seems you are trying to do something dynamic with parameters where you don\u2019t know their names ahead of time? Can you expand upon that use case more?"}, {"owner": {"reputation": 534, "user_id": 4407044, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08a3fcf868bcd8a4a9cd5925525156bb?s=128&d=identicon&r=PG&f=1", "display_name": "DarthVoid", "link": "https://stackoverflow.com/users/4407044/darthvoid"}, "reply_to_user": {"reputation": 2419, "user_id": 150684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64578a71b5e38c7541134e3fdd145137?s=128&d=identicon&r=PG", "display_name": "thomas", "link": "https://stackoverflow.com/users/150684/thomas"}, "edited": false, "score": 0, "creation_date": 1524138184, "post_id": 49901185, "comment_id": 86855900, "body": "@thomas yep, pretty much. Given any report, I need to be able to get the names of all UI parms. I&#39;ll also need to be able to associate the names of the parms with the values that the user selected when they hit &quot;View Report&quot;."}, {"owner": {"reputation": 2419, "user_id": 150684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64578a71b5e38c7541134e3fdd145137?s=128&d=identicon&r=PG", "display_name": "thomas", "link": "https://stackoverflow.com/users/150684/thomas"}, "edited": false, "score": 0, "creation_date": 1524138854, "post_id": 49901185, "comment_id": 86856387, "body": "I would imagine you will have to do this in Custom Code within the report. Are you looking to do this in some other language or location? Seems like if you have access to all the reports to add Custom Code then you already know the answer to which parameters exist."}, {"owner": {"reputation": 534, "user_id": 4407044, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08a3fcf868bcd8a4a9cd5925525156bb?s=128&d=identicon&r=PG&f=1", "display_name": "DarthVoid", "link": "https://stackoverflow.com/users/4407044/darthvoid"}, "edited": false, "score": 0, "creation_date": 1524141800, "post_id": 49901185, "comment_id": 86858340, "body": "I do have access to all the reports and yes I can add custom code, but I don&#39;t have the time to write out very specific code for each report. I need something generic that captures the parm names in any report."}, {"owner": {"reputation": 534, "user_id": 4407044, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08a3fcf868bcd8a4a9cd5925525156bb?s=128&d=identicon&r=PG&f=1", "display_name": "DarthVoid", "link": "https://stackoverflow.com/users/4407044/darthvoid"}, "edited": false, "score": 0, "creation_date": 1524141842, "post_id": 49901185, "comment_id": 86858370, "body": "Let&#39;s start there - how would I write custom code to get the list of parm names?"}, {"owner": {"reputation": 2419, "user_id": 150684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/64578a71b5e38c7541134e3fdd145137?s=128&d=identicon&r=PG", "display_name": "thomas", "link": "https://stackoverflow.com/users/150684/thomas"}, "edited": false, "score": 0, "creation_date": 1524263034, "post_id": 49901185, "comment_id": 86917590, "body": "I see you posted another question on the same topic. I think that other question may answer this one as well."}], "owner": {"reputation": 534, "user_id": 4407044, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/08a3fcf868bcd8a4a9cd5925525156bb?s=128&d=identicon&r=PG&f=1", "display_name": "DarthVoid", "link": "https://stackoverflow.com/users/4407044/darthvoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524065384, "creation_date": 1524058592, "last_edit_date": 1524065384, "question_id": 49901185, "link": "https://stackoverflow.com/questions/49901185/report-builder-3-0-how-to-get-the-name-not-the-label-of-a-parameter", "title": "Report Builder 3.0 - How to get the name (not the label) of a parameter", "body": "<p>I know that I can get the value (<code>Parameters!parm.Value -&gt; 1</code>) and the label (<code>Parameters!parm.Label -&gt; \"ParmLabel\"</code>), but how do I get the name of the parameter (<code>??? -&gt; \"parm\"</code>)?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1524058255, "post_id": 49900631, "comment_id": 86817455, "body": "How does the code know what month?  Is it always last month?  So if you pressed the button today, it would use March dates?"}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1524058873, "post_id": 49900631, "comment_id": 86817896, "body": "It would always be pressed on the last day of the month. So I would have pressed it on the 30th of march since that&#39;s the last work day of march. Also, I forgot to mention earlier that in the main page which contains the actual buttons, cell A1 is just =TODAY(). When you press a button to archive the daily report then the new sheet that is created is just named after A1."}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1524064471, "post_id": 49901433, "comment_id": 86822154, "body": "This doesn&#39;t seem to be working but I&#39;m wondering if the reason it&#39;s not is that there is a header row?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1524064895, "post_id": 49901433, "comment_id": 86822485, "body": "@Jb83 it worked when I tested it.  Header row shouldn&#39;t make a difference.  Is your column A populated?"}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1524066267, "post_id": 49901433, "comment_id": 86823478, "body": "Ah, I figured out the issue. It is working but the first row is formatted as HH:MM because except for the blanks it contains times. But I am sure I can use a format function in the code to format DayIndex as short date or something."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1524066471, "post_id": 49901433, "comment_id": 86823606, "body": "@Jb83 I have updated the code to include a line to set the cell format to display a date properly."}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1524072449, "post_id": 49901433, "comment_id": 86827107, "body": "Works perfectly! Thank you for all your help!"}, {"owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "edited": false, "score": 0, "creation_date": 1524245978, "post_id": 49901433, "comment_id": 86910649, "body": "Quick follow up if anyone is still out there. I&#39;ve had to add 3 additional sheets before my first one to house some data from some sql pulls but I don&#39;t want to include them on my summary sheet that this creates. How would I skip the first however many sheets?"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1524066449, "last_edit_date": 1524066449, "creation_date": 1524059325, "answer_id": 49901433, "question_id": 49900631, "link": "https://stackoverflow.com/questions/49900631/need-to-fill-blanks-in-one-column-with-ascending-dates-of-the-month/49901433#49901433", "title": "Need to fill blanks in one column with ascending dates of the month", "body": "<p>Based on comment:</p>\n\n<blockquote>\n  <p>It would always be pressed on the last day of the month. So I would\n  have pressed it on the 30th of march since that's the last work day of\n  march.</p>\n</blockquote>\n\n<p>You just need to add a variable keeping track of the day, and then use that variable inside the <code>If cnt = 10 Then</code> block.</p>\n\n<p>Add this variable:</p>\n\n<pre><code>Dim DayIndex as Date:   DayIndex = CDate(Evaluate(\"DATE(YEAR(TODAY()),MONTH(TODAY()),1)\"))\n</code></pre>\n\n<p>And then:</p>\n\n<pre><code>  If cnt = 10 Then\n    Rows(rw).Insert Shift:=xlDown\n    Cells(rw, \"A\").Value = DayIndex\n    Cells(rw, \"A\").NumberFormat = \"d/m/yyyy\"\n    DayIndex = DayIndex + 1\n    cnt = 1\n    lr = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n  Else\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 9607977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0690dd5b0f7ef8e1c18e1759273c602?s=128&d=identicon&r=PG&f=1", "display_name": "Jb83", "link": "https://stackoverflow.com/users/9607977/jb83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 49901433, "answer_count": 1, "score": 0, "last_activity_date": 1524066449, "creation_date": 1524057111, "last_edit_date": 1524058219, "question_id": 49900631, "link": "https://stackoverflow.com/questions/49900631/need-to-fill-blanks-in-one-column-with-ascending-dates-of-the-month", "title": "Need to fill blanks in one column with ascending dates of the month", "body": "<p>I have a workbook that creates daily reports in separate worksheets and at the end of the month I click a button that creates a monthly summary sheet from all of the individual daily sheets. The code that creates the monthly summary sheet has some lines that insert a blank row every 10 rows because the next day's data starts every 10 rows. </p>\n\n<p>What I'm trying to do now is find the code that will insert the date into column A of the newly created blank rows. So column A in the first newly created blank line would contain 1/1/2018,The 2nd newly created blank row would have 1/2/2018 and so on. </p>\n\n<p>Here is my current code, please let me know if you have any ideas for what to add to it to insert the dates in the newly created blank row. Another possible solution that I don't know how to implement would be copying the title of each worksheet to every 10th row since every worksheet is simply titled the date.</p>\n\n<pre><code>Sub endofmonth()\n  'This sub should be run at the end of the month and will generate a monthly     summary sheet\n  Dim wrk As Workbook\n  Dim sht As Worksheet\n  Dim trg As Worksheet\n  Dim rng As Range\n  Dim colCount As Integer\n  Set wrk = ActiveWorkbook\n  For Each sht In wrk.Worksheets\n    If sht.Name = \"Month End\" Then\n      MsgBox \"There is a worksheet called as 'Month End'.\" &amp; vbCrLf &amp; _\n             \"Please remove or rename this worksheet since 'Month End' would be\" &amp; _\n             \"the name of the result worksheet of this process.\", vbOKOnly + vbExclamation, \"Error\"\n      Exit Sub\n    End If\n  Next sht\n  Application.ScreenUpdating = False\n  Set trg = wrk.Worksheets.Add(After:=wrk.Worksheets(wrk.Worksheets.Count))\n  trg.Name = \"Month End\"\n  Set sht = wrk.Worksheets(1)\n  colCount = sht.Cells(1, 255).End(xlToLeft).Column\n  With trg.Cells(1, 1).Resize(1, colCount)\n    .Value = sht.Cells(1, 1).Resize(1, colCount).Value\n    .Font.Bold = True\n  End With\n  For Each sht In wrk.Worksheets\n    If sht.Index = wrk.Worksheets.Count Then\n      Exit For\n    End If\n    Set rng = sht.Range(sht.Cells(2, 1), sht.Cells(65536, 1).End(xlUp).Resize(, colCount))\n    trg.Cells(65536, 1).End(xlUp).Offset(1).Resize(rng.Rows.Count, rng.Columns.Count).Value = rng.Value\n  Next sht\n  trg.Columns.AutoFit\n  'This part of the code formats the Monthly Summary sheet correctly\n  With ThisWorkbook.Sheets(\"Month End\")\n    .Columns(1).Resize(.Rows.Count - 1, 1).Offset(1, 0).NumberFormat = \"HH:MM AM/PM\"\n    .Columns(4).Resize(.Rows.Count - 1, 1).Offset(1, 0).NumberFormat = \"00\"\n    .Columns(10).Resize(.Rows.Count - 1, 1).Offset(1, 0).NumberFormat = \"00.00\"\n    .Columns(17).Resize(.Rows.Count - 1, 1).Offset(1, 0).NumberFormat = \"0.00%\"\n    .Columns(18).Resize(.Rows.Count - 1, 1).Offset(1, 0).NumberFormat = \"0.00%\"\n    .Columns(19).Resize(.Rows.Count - 1, 1).Offset(1, 0).NumberFormat = \"0.00%\"\n    'This part of the code inserts a break at the end of every day on the monthly  summary sheet\n    Dim rw As Long\n    Dim lr As Long\n    Dim cnt As Long\n    lr = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    rw = 2\n    cnt = 1\n    Do\n      If cnt = 10 Then\n        Rows(rw).Insert Shift:=xlDown\n        cnt = 1\n        lr = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n      Else\n        cnt = cnt + 1\n      End If\n      rw = rw + 1\n    Loop While rw &lt;&gt; lr\n\n  End With\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated! </p>\n"}, {"tags": ["excel", "loops", "insert", "row", "vba"], "answers": [{"comments": [{"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "edited": false, "score": 1, "creation_date": 1524118387, "post_id": 49900929, "comment_id": 86843227, "body": "Thank you! This works perfectly. I would really love to understand exactly how your code works. Would you care to give a short explanation? :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "edited": false, "score": 0, "creation_date": 1524120451, "post_id": 49900929, "comment_id": 86844294, "body": "Sure. It uses a count variable rather than a range so that we can step backwards, starting at C3276 and ending at C8. <code>rng(r)</code> is just the rth cell in <code>rng</code> - e.g. when r=1 then rng(1) is C8. That said, using the Find method would be more efficient than looping through every cell."}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "edited": false, "score": 0, "creation_date": 1524123437, "post_id": 49900929, "comment_id": 86846138, "body": "I figured that was the logic being applied - but better safe than sorry ;) Efficiency is not required in this particular case, as it was just a one time use. Thanks again for your help."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 5, "last_activity_date": 1524057916, "creation_date": 1524057916, "answer_id": 49900929, "question_id": 49900630, "link": "https://stackoverflow.com/questions/49900630/excel-vba-loop-through-column-and-insert-rows-based-on-cell-value/49900929#49900929", "title": "Excel VBA loop through column and insert rows based on cell value", "body": "<p>Two problems I think. 1) You should loop backwards as otherwise you will skip rows as you are adding more rows, and 2) in your loop you should have referred to <code>cell</code> rather than the ActiveCell which is never set.</p>\n\n<pre><code>Sub Create_new_rows()\n\nDim rng As Range, r As Long\n\nSet rng = Range(\"C8:C3276\")\n\nFor r = rng.Count To 1 Step -1\n    If rng(r).Value = \"Total\" Then\n        rng(r + 1).EntireRow.Insert\n    End If\nNext r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4264, "favorite_count": 0, "accepted_answer_id": 49900929, "answer_count": 1, "score": 0, "last_activity_date": 1524057916, "creation_date": 1524057098, "last_edit_date": 1531161705, "question_id": 49900630, "link": "https://stackoverflow.com/questions/49900630/excel-vba-loop-through-column-and-insert-rows-based-on-cell-value", "title": "Excel VBA loop through column and insert rows based on cell value", "body": "<p><strong>Hello!</strong></p>\n\n<p>I am trying to build a code that loops through each cell in range C8:C3276 and inserts a new row below if the cell value is \"Total\".</p>\n\n<p>Here is the code i have so far:</p>\n\n<pre><code>Sub Create_new_rows()\n\nDim rng As Range\nDim cell As Range\nSet rng = Range(\"C8:C3276\")\n\nFor Each cell In rng\n\nIf ActiveCell.Value = \"Total\" Then\nActiveCell.Offset(1, 0).Activate\nActiveCell.EntireRow.Insert\nEnd If\n\nNext cell\n\nEnd Sub\n</code></pre>\n\n<p>Nothing happens when i execute the code. I assume the code is built incorrectly as the macro runs (i get no error message), but without doing anything.</p>\n\n<p>Any help is greatly appreciated! :)</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1524057379, "post_id": 49900390, "comment_id": 86816807, "body": "If you look at the color-coding on this code, the <code>End Sub</code> is in red text. So is the <code>End With</code>. Red text is strings or numbers. Since I&#39;m not sure what the formula should look like once it&#39;s in the conditional formatting, I&#39;m not sure where there is a missing/extra <code>&quot;</code>; but you should definitely take a closer look at that string...."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1524058941, "post_id": 49900729, "comment_id": 86817942, "body": "I have just updated my post, to explain more briefly what I intend to do. :)"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1524062146, "post_id": 49900729, "comment_id": 86820349, "body": "Thanks, with this function the code is executed. <b>1.</b> However, the formatting condition is in all cells the same one. They are all reffering to cell C9. How can I make this flexible? <b>2.</b> Even though, the conditional formatting forumla is inserted the interior and font color didn&#39;t change.  Do you know what&#39;s going on here? :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1524124262, "post_id": 49900729, "comment_id": 86846655, "body": "@HPM This should work as expected. Make sure you delete all old conditions that might already exists for this range, before applying a new condition!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1524059334, "last_edit_date": 1524059334, "creation_date": 1524057382, "answer_id": 49900729, "question_id": 49900390, "link": "https://stackoverflow.com/questions/49900390/excel-vba-conditional-formatting-and-function/49900729#49900729", "title": "Excel VBA Conditional Formatting AND-Function", "body": "<p>You need to concatenate the strings and values correctly.</p>\n\n<p>Example:</p>\n\n<pre><code>MyVariable = \"ccc\"\nresult = \"aaa\" &amp; \"bbb\" &amp; MyVariable &amp; \"AnotherString\"\n'result is \"aaabbbcccAnotherString\"\n</code></pre>\n\n<p>I'm not sure what you tried but probably you meant something like</p>\n\n<pre><code>Formula1:=\"=AND($C9&lt;&gt;\"\"\"\";\" &amp; Range(\"$C9\").Value &lt;= Tabelle4.Range(\"B2\").Value &amp; \")\")\n</code></pre>\n\n<p>Or more likely something like</p>\n\n<pre><code>Formula1:=\"=AND($C9&lt;&gt;\"\"\"\";$C9&lt;=Tabelle4!B2)\")\n</code></pre>\n\n<p>Update:</p>\n\n<pre><code>Formula1:=\"=AND($C9&lt;&gt;\"\"\"\";$C9&lt;=\" &amp; Tabelle4.Range(\"B2\").Value &amp; \")\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1524062882, "post_id": 49900787, "comment_id": 86820927, "body": "Thanks for your support as well :) Your function seems to be the same as the one from PEH and with this function the code is executed. 1. However as stated above, the formatting condition is in all cells the same one. They are all reffering to cell C9. How can I make this flexible? 2. Even though, the conditional formatting forumla is inserted the interior and font color didn&#39;t change. Do you know what&#39;s going on here? :)"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 1, "creation_date": 1524064586, "post_id": 49900787, "comment_id": 86822240, "body": "The formula is locked to Column C, but (if the top cell is Row 9) the row should change as the code moves down.  I <i>do</i> notice you don&#39;t have a line in your shown code to delete existing Conditional Formatting - have you had a look at the Conditional Formatting that has been placed in from &quot;Home&quot; &gt; &quot;Conditional Formatting&quot; to makes sure there is not other formatting overrriding the new stuff?"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 1, "last_activity_date": 1524057555, "creation_date": 1524057555, "answer_id": 49900787, "question_id": 49900390, "link": "https://stackoverflow.com/questions/49900390/excel-vba-conditional-formatting-and-function/49900787#49900787", "title": "Excel VBA Conditional Formatting AND-Function", "body": "<p>First, check the colours on your formatting to see what's a string and what's not - you have a mysterious extra <code>\"</code> in the middle of your formula, which will prevent the code from compiling in the first place.  You have also tried to put VBA code (<code>Tabelle4.Range(\"B2\").Value</code>) into an Excel formula, which won't work.</p>\n\n<p>If you want to fix the value of <code>Tabelle4.Range(\"B2\").Value</code> when the macro is run, you can change</p>\n\n<pre><code>Formula1:=\"=AND($C9&lt;&gt;\"\"\"\";\"$C9.Value &lt;= Tabelle4.Range(\"\"B2\"\").Value)\")\n</code></pre>\n\n<p>to  </p>\n\n<pre><code>Formula1:=\"=AND($C9&lt;&gt;\"\"\"\";$C9&lt;=\" &amp; Tabelle4.Range(\"B2\").Value &amp; \")\")\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 49900787, "answer_count": 2, "score": 0, "last_activity_date": 1524059334, "creation_date": 1524056384, "last_edit_date": 1524058862, "question_id": 49900390, "link": "https://stackoverflow.com/questions/49900390/excel-vba-conditional-formatting-and-function", "title": "Excel VBA Conditional Formatting AND-Function", "body": "<p><strong>UPDATE:</strong></p>\n\n<p>I try to use conditional formatting for the following case: </p>\n\n<p>If a cell in column C (starting with C9) <code>Tabelle3.Range(Tabelle3.Cells(9, 3), Tabelle3.Cells(lastcell, 3))</code></p>\n\n<ol>\n<li>is not empty <code>Cell &lt;&gt;\"\"</code>\nAND</li>\n<li>fullfills a criteria which is stated in Tabelle4 Cell B2 <code>Tabelle4.Range(\"B2\")</code></li>\n</ol>\n\n<p>its <code>Interior.Color</code> should be changed to <code>Cellclr</code> and its <code>Font.Color</code> to <code>Fontclr</code></p>\n\n<p><strong>Start Old Post:</strong>\nI looked through various posts about conditional formatting but I couldn't find any, that is preciously solving my problem. </p>\n\n<p>I want to apply conditional formatting to a Excel workbook which will be constantly extanded. Therefore, I wrote the following code: </p>\n\n<pre><code>Sub ConForm()\n\nDim lastcell As Long\nDim Cellclr As Long\nDim Fontclr As Long\n\nlastcell = Tabelle3.Range(\"A1048576\").End(xlUp).Row\nCellclr = RGB(232, 245, 246)\nFontclr = RGB(26, 155, 167)\n\nSet C = Tabelle3.Range(Tabelle3.Cells(9, 3), Tabelle3.Cells(lastcell, 3))\n\n    With C.FormatConditions.Add( _\n            Type:=xlExpression, _\n            Formula1:=\"=AND($C9&lt;&gt;\"\"\"\";\"$C9.Value &lt;= Tabelle4.Range(\"\"B2\"\").Value)\")\n        .Interior.Color = Cellclr\n        .Font.Color = Fontclr\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>If I just use the following range and formula:</p>\n\n<pre><code>Range(\"C9\")\nFormula1:=\"=C9&lt;&gt;\"\"\"\"\") \n</code></pre>\n\n<p>the code works out for Cell C9. However, as already mentioned, it should be this Formula </p>\n\n<pre><code>=AND($C9&lt;&gt;\"\"\"\";\"$C9.Value &lt;= Tabelle4.Range(\"\"B2\"\").Value\n</code></pre>\n\n<p>be applied for the range</p>\n\n<pre><code>Tabelle3.Range(Tabelle3.Cells(9, 3), Tabelle3.Cells(lastcell, 3))\n</code></pre>\n\n<p>Does someone know where I made a mistake/mistakes and how to solve this issue? </p>\n"}, {"tags": ["vba", "excel", "error-handling"], "comments": [{"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 1, "creation_date": 1524056385, "post_id": 49900353, "comment_id": 86816136, "body": "You didn&#39;t declare <code>i</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524060511, "post_id": 49900353, "comment_id": 86819093, "body": "Always. Use. <code>Option Explicit</code>. This is why. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> would also tell you that unqualified <code>Range</code> calls are implicitly referencing whatever the <code>ActiveSheet</code> is, which is frail/bug-prone. Avoid <code>Worksheet.Select</code> and work with an actual explicit <code>Worksheet</code> reference instead - see the 2nd snippet in QHarr&#39;s answer."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8622820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fnhvrm3YmDM/AAAAAAAAAAI/AAAAAAAABjM/9rZo0bsMSqs/photo.jpg?sz=128", "display_name": "Manish Shiwlani", "link": "https://stackoverflow.com/users/8622820/manish-shiwlani"}, "edited": false, "score": 0, "creation_date": 1524056925, "post_id": 49900384, "comment_id": 86816491, "body": "Your code works but it copies all the values. I just need text values to be transferred not numbers. Do you know anyway I can change that?"}, {"owner": {"reputation": 11, "user_id": 8622820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fnhvrm3YmDM/AAAAAAAAAAI/AAAAAAAABjM/9rZo0bsMSqs/photo.jpg?sz=128", "display_name": "Manish Shiwlani", "link": "https://stackoverflow.com/users/8622820/manish-shiwlani"}, "edited": false, "score": 0, "creation_date": 1524057278, "post_id": 49900384, "comment_id": 86816735, "body": "This is giving a different error message on the line &quot;If Not IsNumeric(.Range(&quot;H&quot; &amp; i)) Then&quot; The error message is &quot;Application-defined or object-defined error&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 8622820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fnhvrm3YmDM/AAAAAAAAAAI/AAAAAAAABjM/9rZo0bsMSqs/photo.jpg?sz=128", "display_name": "Manish Shiwlani", "link": "https://stackoverflow.com/users/8622820/manish-shiwlani"}, "edited": false, "score": 0, "creation_date": 1524057500, "post_id": 49900384, "comment_id": 86816890, "body": "on which line is the error? If the first time worked so should the second , I think, as I have only changed the test."}, {"owner": {"reputation": 11, "user_id": 8622820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fnhvrm3YmDM/AAAAAAAAAAI/AAAAAAAABjM/9rZo0bsMSqs/photo.jpg?sz=128", "display_name": "Manish Shiwlani", "link": "https://stackoverflow.com/users/8622820/manish-shiwlani"}, "edited": false, "score": 0, "creation_date": 1524057674, "post_id": 49900384, "comment_id": 86817031, "body": "If Not IsNumeric(.Range(&quot;H&quot; &amp; currentRow)) Then"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 8622820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fnhvrm3YmDM/AAAAAAAAAAI/AAAAAAAABjM/9rZo0bsMSqs/photo.jpg?sz=128", "display_name": "Manish Shiwlani", "link": "https://stackoverflow.com/users/8622820/manish-shiwlani"}, "edited": false, "score": 0, "creation_date": 1524057965, "post_id": 49900384, "comment_id": 86817249, "body": "That doesn&#39;t seem possible as currentRow starts at 17 so is greater than 0 and H17:H1000 exists as a valid range. And IsNumeric is a standard test. What is your Excel subscription and version and OS?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 11, "user_id": 8622820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fnhvrm3YmDM/AAAAAAAAAAI/AAAAAAAABjM/9rZo0bsMSqs/photo.jpg?sz=128", "display_name": "Manish Shiwlani", "link": "https://stackoverflow.com/users/8622820/manish-shiwlani"}, "edited": false, "score": 1, "creation_date": 1524059905, "post_id": 49900384, "comment_id": 86818637, "body": "@ManishShiwlani Did you copy the whole code, or just that one section - you&#39;ll get that error if you still have <code>Dim row as Long</code> instead of <code>Dim currentRow as Long</code>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1524059946, "post_id": 49900384, "comment_id": 86818673, "body": "@QHarr One way that line <i>could</i> error is if <code>ThisWorkbook.Sheets(&quot;102Tk&quot;)</code> was a Chartsheet instead of a Worksheet - but that would be <code>Run-time error &#39;438&#39;: Object doesn&#39;t support this proerty or method</code> instead"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1524060736, "post_id": 49900384, "comment_id": 86819243, "body": "@Chronocidal yes. and this is why you should retrieve worksheets through the <code>Worksheets</code> collection. And if the sheet exists at compile-time, then you should be using its <code>CodeName</code> instead - there&#39;s already a project-scope <code>Worksheet</code> object variable for every worksheet that exists at compile-time, right there waiting to be used. No need to dereference these sheets every time."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1524060855, "last_edit_date": 1524060855, "creation_date": 1524056357, "answer_id": 49900384, "question_id": 49900353, "link": "https://stackoverflow.com/questions/49900353/i-am-getting-this-error-message-run-time-error-1004-method-range-of-object/49900384#49900384", "title": "I am getting this error message. Run Time error &#39;1004&#39; Method &#39;Range&#39; of object&#39;_Global&#39; Failed", "body": "<p>Should i be row?</p>\n\n<pre><code>Option Explicit\nSub n()\n\n    Sheets(\"102Tk\").Select \n    Dim row As Long\n\n    For row = 17 To 1000\n        ' Check if \"save\" appears in the value anywhere.\n        If Not IsNumeric(Range(\"H\" &amp; row)) Then\n            ' Copy the value and then blank the source.\n            Range(\"E\" &amp; row).Value = Range(\"H\" &amp; row).Value\n            Range(\"H\" &amp; row).Value = \"\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Which avoiding using row as a variable name and a few other tidies could be:</p>\n\n<pre><code>Option Explicit\nPublic Sub SetValues()\n    Dim currentRow As Long\n    With ThisWorkbook.Worksheets(\"102Tk\")  'taking note of the comments and using worksheet collection to avoid Chart sheets\n        For currentRow = 17 To 1000\n            ' Check if \"save\" appears in the value anywhere.\n            If Not IsNumeric(.Range(\"H\" &amp; currentRow)) Then\n                ' Copy the value and then blank the source.\n                .Range(\"E\" &amp; currentRow) = .Range(\"H\" &amp; currentRow)\n                .Range(\"H\" &amp; currentRow) = vbNullString\n            End If\n        Next currentRow\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8622820, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fnhvrm3YmDM/AAAAAAAAAAI/AAAAAAAABjM/9rZo0bsMSqs/photo.jpg?sz=128", "display_name": "Manish Shiwlani", "link": "https://stackoverflow.com/users/8622820/manish-shiwlani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 49900384, "answer_count": 1, "score": -1, "last_activity_date": 1524060855, "creation_date": 1524056238, "last_edit_date": 1524057049, "question_id": 49900353, "link": "https://stackoverflow.com/questions/49900353/i-am-getting-this-error-message-run-time-error-1004-method-range-of-object", "title": "I am getting this error message. Run Time error &#39;1004&#39; Method &#39;Range&#39; of object&#39;_Global&#39; Failed", "body": "<p>I am trying to copy text values only from column H and move them to E. I want to automate it so that everytime a text value comes to H from sheet1, it directly goes to E instead of H. Leaving H empty in that cell.    </p>\n\n<pre><code>    Sheets(\"102Tk\").Select\n    Dim row As Long\n    For row = 17 To 1000\n        ' Check if \"textvalue\" appears in the value anywhere.\n        If WorksheetFunction.IsText(Range(\"H\" &amp; i)) Then\n            ' Copy the value and then blank the source.\n            Range(\"E\" &amp; i).value = Range(\"H\" &amp; i).value\n            Range(\"H\" &amp; i).value = \"\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1524056299, "post_id": 49900247, "comment_id": 86816069, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4933487/using-sql-server-specific-code-in-access-linked-to-sql-server-database\">Using SQL Server specific code in Access linked to SQL Server database</a>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1524057035, "post_id": 49900247, "comment_id": 86816561, "body": "Is the SQL-Server tag needed?"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1524057198, "creation_date": 1524057198, "answer_id": 49900663, "question_id": 49900247, "link": "https://stackoverflow.com/questions/49900247/trying-to-run-a-sql-update-query-in-ms-access-using-vba-not-sure-if-aliases-are/49900663#49900663", "title": "Trying to run a SQL update query in MS Access using VBA, not sure if aliases are allowed", "body": "<p>In Access your SQL syntax is wrong (and you've missed the opening <code>\"</code> before <code>UPDATE</code>.  </p>\n\n<p>You've written your query as:  </p>\n\n<pre><code>  UPDATE t1 \n  SET [problemID] = t2.[problemID]\n  FROM dbo.table1 t1 JOIN dbo.table2 t2\n      ON t1.[problemDescription] = t2.[problemDescription]  \n</code></pre>\n\n<p>Access syntax is:  </p>\n\n<pre><code>  UPDATE Table1 T1 INNER JOIN Table2 T2 ON T1.ProblemDescription = T2.ProblemDescription\n  SET    T1.ProblemID = T2.ProblemID\n</code></pre>\n\n<p>Having said that, if you're using a pass-through query you have to use the syntax of the database being used (SQL-Server in this case I guess).</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1524057282, "creation_date": 1524057282, "answer_id": 49900688, "question_id": 49900247, "link": "https://stackoverflow.com/questions/49900247/trying-to-run-a-sql-update-query-in-ms-access-using-vba-not-sure-if-aliases-are/49900688#49900688", "title": "Trying to run a SQL update query in MS Access using VBA, not sure if aliases are allowed", "body": "<p>No. Field and table names must be fixed.</p>\n\n<p>You need, in VBA, the (re)build the <code>sqlstring</code> replacing the placeholders with the actual and literal field names.</p>\n\n<p>Then run the SQL.</p>\n"}], "owner": {"reputation": 1, "user_id": 9660986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d99ab89146b7c6880373891c280957f?s=128&d=identicon&r=PG&f=1", "display_name": "Deshaun Smantty", "link": "https://stackoverflow.com/users/9660986/deshaun-smantty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524057282, "creation_date": 1524055958, "last_edit_date": 1524057148, "question_id": 49900247, "link": "https://stackoverflow.com/questions/49900247/trying-to-run-a-sql-update-query-in-ms-access-using-vba-not-sure-if-aliases-are", "title": "Trying to run a SQL update query in MS Access using VBA, not sure if aliases are allowed", "body": "<p>I need help with this query I am trying to write with in VBA in MS Access:</p>\n\n<pre><code>  Dim sqlstring as String\n  UPDATE t1 \" _\n  &amp; \" SET [problemID] = t2.[problemID] \" _\n  &amp; \" FROM dbo.table1 t1 \" _\n     &amp; \" JOIN dbo.table2 t2 \" _\n        &amp; \" ON t1.[problemDescription] = t2.[problemDescription]\n  DoCmd.RunSQL (sqlstring)\n</code></pre>\n\n<p>What I would like to happen is, when this runs, table1 will fill the values in its column, <code>problemID</code>, with the number associated with the values in its column <code>problemDescription</code> that match the values in the column <code>problemDescription</code> in <code>table2</code>. table2 has a <code>problemID</code> column as well and this column has values in it that I need passed to table1, if all that makes sense.</p>\n\n<p>Whenever it runs, I get a syntax error saying there is a missing operator in the expression</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1524054686, "post_id": 49899645, "comment_id": 86814949, "body": "Look into <a href=\"http://www.contextures.com/xlFunctions05.html\" rel=\"nofollow noreferrer\"><code>INDIRECT</code></a>"}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "edited": false, "score": 0, "creation_date": 1524054872, "post_id": 49899645, "comment_id": 86815086, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/4471884/how-to-turn-a-string-formula-into-a-real-formula\">How to turn a string formula into a &quot;real&quot; formula</a>"}], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 8993352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8yKIc.jpg?s=128&g=1", "display_name": "Matthias Neubert", "link": "https://stackoverflow.com/users/8993352/matthias-neubert"}, "reply_to_user": {"reputation": 11, "user_id": 9462705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c718c73340ad1f4b44b3efd8657d296?s=128&d=identicon&r=PG&f=1", "display_name": "Heinrich", "link": "https://stackoverflow.com/users/9462705/heinrich"}, "edited": false, "score": 0, "creation_date": 1524056666, "post_id": 49899954, "comment_id": 86816313, "body": "@Heinrich Remember to use INDIRECT in your own language your excel &quot;speaks&quot; I have edited my answer and added a link with an excel translator"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 11, "user_id": 9462705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c718c73340ad1f4b44b3efd8657d296?s=128&d=identicon&r=PG&f=1", "display_name": "Heinrich", "link": "https://stackoverflow.com/users/9462705/heinrich"}, "edited": false, "score": 1, "creation_date": 1524057742, "post_id": 49899954, "comment_id": 86817083, "body": "@Heinrich To use <code>INDIRECT</code> to reference another workbook, that workbook must be Open, or you will get a <code>#REF!</code> error"}, {"owner": {"reputation": 11, "user_id": 9462705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c718c73340ad1f4b44b3efd8657d296?s=128&d=identicon&r=PG&f=1", "display_name": "Heinrich", "link": "https://stackoverflow.com/users/9462705/heinrich"}, "edited": false, "score": 0, "creation_date": 1524058243, "post_id": 49899954, "comment_id": 86817446, "body": "I used Indirect in my language. Even when the other workbook is open, it still does not work. They main reason for using this, was not needing to open the other workbook. So VBA code will be the better way."}], "tags": [], "owner": {"reputation": 287, "user_id": 8993352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8yKIc.jpg?s=128&g=1", "display_name": "Matthias Neubert", "link": "https://stackoverflow.com/users/8993352/matthias-neubert"}, "is_accepted": false, "score": 0, "last_activity_date": 1524056956, "last_edit_date": 1524056956, "creation_date": 1524055155, "answer_id": 49899954, "question_id": 49899645, "link": "https://stackoverflow.com/questions/49899645/create-dynamic-filepath-and-access-value/49899954#49899954", "title": "create dynamic filepath and access value", "body": "<p>You can use </p>\n\n<pre><code>=INDIRECT(\"folderpath\\[\" &amp; A1 &amp; \".xlsm]Checklist!$CE$29\")\n</code></pre>\n\n<p>This works if your excel \"speaks\" is in english. If you have another language you have to translate it. you can find some examples <a href=\"https://se.excel-translator.de/indirekt/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/1Z9rp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1Z9rp.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 9462705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c718c73340ad1f4b44b3efd8657d296?s=128&d=identicon&r=PG&f=1", "display_name": "Heinrich", "link": "https://stackoverflow.com/users/9462705/heinrich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524056956, "creation_date": 1524054252, "last_edit_date": 1531161705, "question_id": 49899645, "link": "https://stackoverflow.com/questions/49899645/create-dynamic-filepath-and-access-value", "title": "create dynamic filepath and access value", "body": "<p>I want to copy the value of one Cell from another workbook.\nThe file path of the other workbook is generated by a value of the first workbook. </p>\n\n<pre><code>='folderpath\\[11111.xlsm]Checklist'!$CE$29\n</code></pre>\n\n<p>11111 should be a dynamic generated value and exists for example in Cell A1.</p>\n\n<p>If I change the value 11111 to 22222, the formula should adapt to access the value of the Cell in the worksheet \"22222.xlsm\" </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1524054177, "post_id": 49899394, "comment_id": 86814575, "body": "Why VBA? Use a Formula in AN that if any False in that row, then 1, else nothing. And then color the row using Conditional Formating"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524054246, "post_id": 49899394, "comment_id": 86814625, "body": "Also, in your question you say <i>...from M to AL...</i> and your code says <code>&quot;W:AL&quot;</code>. Which one is the right one?"}, {"owner": {"reputation": 103, "user_id": 9478211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543a998c8a35f0583d07d91bf31069e5?s=128&d=identicon&r=PG&f=1", "display_name": "EnnaSmile", "link": "https://stackoverflow.com/users/9478211/ennasmile"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524054521, "post_id": 49899394, "comment_id": 86814812, "body": "@FoxfireAndBurnsAndBurns M to AL is correct, my mistake.. How do I write the formula for that?"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 9478211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543a998c8a35f0583d07d91bf31069e5?s=128&d=identicon&r=PG&f=1", "display_name": "EnnaSmile", "link": "https://stackoverflow.com/users/9478211/ennasmile"}, "edited": false, "score": 0, "creation_date": 1524135318, "post_id": 49901565, "comment_id": 86853865, "body": "Thank you for your answer and help, but for some reason this worked only partly for me. I figured out a solution using VBA."}, {"owner": {"reputation": 103, "user_id": 9478211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543a998c8a35f0583d07d91bf31069e5?s=128&d=identicon&r=PG&f=1", "display_name": "EnnaSmile", "link": "https://stackoverflow.com/users/9478211/ennasmile"}, "edited": false, "score": 0, "creation_date": 1524136492, "post_id": 49901565, "comment_id": 86854748, "body": "I don&#39;t know the reason, that&#39;s why I said &quot;for some reason&quot;. I would gladly let you know what it was if I knew."}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 1, "last_activity_date": 1524078543, "last_edit_date": 1524078543, "creation_date": 1524059698, "answer_id": 49901565, "question_id": 49899394, "link": "https://stackoverflow.com/questions/49899394/how-to-put-values-in-last-row-if-the-value-in-certain-range-is-certain-word-usin/49901565#49901565", "title": "How to put values in last row if the value in certain range is certain word using VBA?", "body": "<p>My example is with less data, Just adapt the formulas to your needs.\nAlso, please note my Excel is in Spanish, but I'll translate formulas.</p>\n\n<p>For this answer, we will use <a href=\"https://support.office.com/en-us/article/guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7\" rel=\"nofollow noreferrer\">Array Formulas</a>.</p>\n\n<p>My data is just <code>A1:C17</code>. Some cells contain a number and others contain a False value (False in spanish is False, check image):</p>\n\n<p><a href=\"https://i.stack.imgur.com/7QAti.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7QAti.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Ok, first step would be in column AN to use an Array Formula to show a 1 value if any cell in the row is False, and nothing if not. In my case, I put that formula in column D. I used <code>=IF(A1:C1=FALSE;1;\"\")</code>. Drag it down.</p>\n\n<p><strong>VERY IMPORTANT</strong>: When you type this formula, do not press enter. You have to press <kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>ENTER</kbd>, to make it an array formula. If you don't do it like this, it will fail. After applying formula, I get this results in column D:</p>\n\n<p><a href=\"https://i.stack.imgur.com/334xP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/334xP.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Note that only rows with a False value raise a 1 in Column D. Rest of cells are blank.</p>\n\n<p>Second step, the conditional formatting. Just create a rule that says that if D cell = 1 then background color is red. Remember to create the rule with relative references (blocking just the column, not the row) to make it work. My formula in the rule is <code>=IF($D1=1;TRUE;FALSE)</code> and the rule is like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TSf4G.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TSf4G.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And final result is like this. As you can see, it colors all the row if value in cell D is 1. If not, it does nothing:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Qr0xw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qr0xw.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this helps. Adapt it to your needs.</p>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 9478211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543a998c8a35f0583d07d91bf31069e5?s=128&d=identicon&r=PG&f=1", "display_name": "EnnaSmile", "link": "https://stackoverflow.com/users/9478211/ennasmile"}, "is_accepted": false, "score": 0, "last_activity_date": 1524136629, "creation_date": 1524136629, "answer_id": 49919748, "question_id": 49899394, "link": "https://stackoverflow.com/questions/49899394/how-to-put-values-in-last-row-if-the-value-in-certain-range-is-certain-word-usin/49919748#49919748", "title": "How to put values in last row if the value in certain range is certain word using VBA?", "body": "<p>This is the solution that worked for me so I hope it'll be helpful to someone else.</p>\n\n<pre><code>Set r = Sheet7.Range(\"M:AL\")\nFor i = 5 To RowCount\nWith r.Cells(i)\nIf .Value = \"False\" Then\n    .EntireRow.Interior.Color = 15773610\nEnd If\nEnd With\nNext i\nFor i = 5 To RowCount\nIf Sheet7.Cells(i, \"AL\").Interior.Color = 15773610 Then\n    Cells(i, \"AN\").Value = 1\nEnd If\nNext I\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 9478211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543a998c8a35f0583d07d91bf31069e5?s=128&d=identicon&r=PG&f=1", "display_name": "EnnaSmile", "link": "https://stackoverflow.com/users/9478211/ennasmile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524136629, "creation_date": 1524053433, "question_id": 49899394, "link": "https://stackoverflow.com/questions/49899394/how-to-put-values-in-last-row-if-the-value-in-certain-range-is-certain-word-usin", "title": "How to put values in last row if the value in certain range is certain word using VBA?", "body": "<p>So, I have a range of cells, from M to AL and they display values \"True\" or \"False\" for certain data. I need a code that goes trough that range row by row and when finds a value \"False\" puts value 1 in AN column and colors that row. This is my code so far:</p>\n\n<pre><code>Set r = Sheet7.Range(\"W:AL\")\nFor i = 5 To RowCount\nWith r.Cells(i)\nIf .Value = \"False\" Then\n    .EntireRow.Interior.Color = 15773610\n    Cells(i, \"AN\").Value = 1\nEnd If\nEnd With\nNext i\n</code></pre>\n\n<p>But it doesn't work. I'm probably missing something but I can't figure out what it is. Any help would be highly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "edited": false, "score": 0, "creation_date": 1524053802, "post_id": 49899450, "comment_id": 86814362, "body": "cellSource is not empty. It has value at all time."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "edited": false, "score": 0, "creation_date": 1524053955, "post_id": 49899450, "comment_id": 86814446, "body": "@aaroki - what is the value?"}, {"owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "edited": false, "score": 0, "creation_date": 1524054239, "post_id": 49899450, "comment_id": 86814621, "body": "cellSource value is = a,b,c,d. Comma separated values"}, {"owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "edited": false, "score": 0, "creation_date": 1524054504, "post_id": 49899450, "comment_id": 86814803, "body": "but if i give range like Formula1:=&quot;=$AD$2:$AD$7&quot; then its not corrupting. But its populating the dropdown with all comma separated values only. its not splitting"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "edited": false, "score": 0, "creation_date": 1524054981, "post_id": 49899450, "comment_id": 86815154, "body": "@aaroki - try to put them in inverted commas - <code>&quot;a,b,c,d&quot;</code> or to play a bit. Some ideas here - <a href=\"https://stackoverflow.com/questions/47032944/getting-dynamic-dropdown-list-in-vba-validation\" title=\"getting dynamic dropdown list in vba validation\">stackoverflow.com/questions/47032944/&hellip;</a>"}, {"owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "edited": false, "score": 0, "creation_date": 1524056430, "post_id": 49899450, "comment_id": 86816166, "body": "The values will be dynamic. not a static. it can be any range."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1524053618, "creation_date": 1524053618, "answer_id": 49899450, "question_id": 49899290, "link": "https://stackoverflow.com/questions/49899290/excel-is-corrupting-when-populating-dropdown-using-vba/49899450#49899450", "title": "Excel is corrupting when populating dropdown using VBA", "body": "<p>Most probably the <code>cellSource</code> is empty and thus it gives error at <code>Formula1</code>, which is trying to get its value. </p>\n\n<p>Write in your code after the <code>Sub AddListValidation</code>  this line:</p>\n\n<pre><code>If Len(cellSource) Then Exit Sub\n</code></pre>\n\n<p>Thus, it will exit, if the <code>cellSource</code> is empty and will avoid the error.</p>\n"}], "owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1580892552, "creation_date": 1524053045, "last_edit_date": 1524053989, "question_id": 49899290, "link": "https://stackoverflow.com/questions/49899290/excel-is-corrupting-when-populating-dropdown-using-vba", "title": "Excel is corrupting when populating dropdown using VBA", "body": "<pre><code>Private Sub Workbook_Open()\n Dim ws As Worksheet\n Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n Dim LastRow As Long \n LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n Dim iRow As Long\n For iRow = 2 To LastRow\n    AddListValidation ws.Cells(iRow, \"C\"), ws.Cells(iRow, \"B\")\n Next iRow\nEnd Sub\n\n\nSub AddListValidation(cellSource As Range, cellTarget As Range)\n cellTarget.Value = \"Select your values here\"\n With cellTarget.Validation\n    .Delete\n    .Add Type:=xlValidateList, Formula1:=cellSource.Value\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"\"\n    .ShowInput = True\n    .ShowError = True\n End With\nEnd Sub\n</code></pre>\n\n<p>First time the dropdown is getting populated. When I do some changes on the sheet and when i reopen the sheet again, its saying that its corrupted and am not getting the dropdown as well. </p>\n\n<p>can anyone help me pls?</p>\n\n<p>The Formula which I used is correct or not?</p>\n\n<pre><code>.Add Type:=xlValidateList, Formula1:=cellSource.Value\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524053694, "post_id": 49899221, "comment_id": 86814293, "body": "First of all, delete <code>On error resume next</code>. That hides errors, even if the code keeps running, but with errors, that&#39;s the first step"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1524053823, "post_id": 49899221, "comment_id": 86814374, "body": "Second, check <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/data-types/data-type-summary\" rel=\"nofollow noreferrer\">DATa TYPES</a>. You are using <code>Variant</code> types when not needed. Choosing the right type of data helps avoiding errors and also optimizes resources of your PC"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524053963, "post_id": 49899221, "comment_id": 86814453, "body": "Also, move your <code>Next i</code> outside your IF sentence. Put it right after your <code>End if</code>. And also, you should check <a href=\"http://access-excel.tips/excel-vba-indentation-auto-indent/\" rel=\"nofollow noreferrer\">INDENTATION</a> when typing code"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1524059598, "post_id": 49899221, "comment_id": 86818395, "body": "@Mitch did you get to test any of the solution provided below ? any feedback ?"}], "answers": [{"tags": [], "owner": {"reputation": 177, "user_id": 3166968, "user_type": "registered", "profile_image": "https://graph.facebook.com/1528145703/picture?type=large", "display_name": "Landy", "link": "https://stackoverflow.com/users/3166968/landy"}, "is_accepted": false, "score": 1, "last_activity_date": 1524053974, "creation_date": 1524053974, "answer_id": 49899571, "question_id": 49899221, "link": "https://stackoverflow.com/questions/49899221/if-statement-within-a-loop/49899571#49899571", "title": "IF statement within a loop", "body": "<p>The problem is the if statement is spanning outside the loop. You should just exit the loop with the if statment and keep it contained inside the for</p>\n\n<pre><code>    For I = 1 to 10\n    on error resume next\n    set found=workbooks(\"b\").worksheets(i).range(\"a:b\").match(val)\n    found= found.address\n    if isEmpty(found) then\n    //do something\n    else \n    exit for\n    end if\n\n    next i\n\n\n\nend sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1524056516, "last_edit_date": 1524056516, "creation_date": 1524056191, "answer_id": 49900330, "question_id": 49899221, "link": "https://stackoverflow.com/questions/49899221/if-statement-within-a-loop/49900330#49900330", "title": "IF statement within a loop", "body": "<p>Your code should have \"screamed\" a few times:</p>\n\n<ul>\n<li><code>dim val as variant</code> ? maybe as <code>Variant</code>.</li>\n<li>You should (or trying) to use <code>match</code>, your syntax is closer to <code>Find</code>. Using <code>Find</code> should also include a scenario <code>Find</code> didn't find the result. In any way, you need to <code>Set</code> the <code>Find</code> function result to a <code>Range</code> object.</li>\n<li>Your closing <code>Next I</code> should be after the <code>End If</code>, not in the middle.</li>\n<li>Using <code>on error resume next</code> doesn't make your error go away, you are just \"closing your eyes\" hoping it will go away.</li>\n<li>More notes in my code's comments below.</li>\n</ul>\n\n<p><strong><em>Modified Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub autocheck()\n\nDim found As Range\nDim foundAdress As String\nDim i As Long\nDim val As Variant\n\nSet val = Workbooks(\"A\").Worksheets(\"primary\").Range(\"a1\").Value\n\nFor i = 1 To 10\n\n    Set found = Workbooks(\"b\").Worksheets(i).Range(\"A:B\").Find(what:=val)\n\n    If Not found Is Nothing Then ' Find was successfull\n        foundAdress = found.Address\n        Exit For\n    Else ' Find failed\n        ' in your code do nothing, continue looping\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9664105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ef48531b46f9ff503b308fbedf6cd5d?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch ", "link": "https://stackoverflow.com/users/9664105/mitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524057303, "creation_date": 1524052845, "last_edit_date": 1524057303, "question_id": 49899221, "link": "https://stackoverflow.com/questions/49899221/if-statement-within-a-loop", "title": "IF statement within a loop", "body": "<p>I need help figuring out what I am doing wrong. Keep in my mind im an amateur.</p>\n\n<p>I have two Workbooks, Workbook A and Workbook B. In workbook A I have a value in cell a1 and workbook B i have lets say 10 sheets with values in column A and B. </p>\n\n<p>I would like to match value from a1 in workbook A by looping through all sheets in workbook B, and then returning the address if where it found it. I then write an if statement if the value is found to stop the loop because I will later have it search another cell, though I got stuck so I haven't written that line of code yet. </p>\n\n<p>Here is the code and Ill note where im stuck.</p>\n\n<pre><code>sub autocheck()\n\ndim found as varient\ndim I as integer\ndim val as varient\nset val=workbooks(\"A\").worksheets(\"primary\").range(\"a1\").value\n\nFor I = 1 to 10\non error resume next\nset found=workbooks(\"b\").worksheets(i).range(\"a:b\").match(val)\nfound= found.address\nif isempty(found) then\n\nnext i\n\nelse \nexit for\nend if \n\nend sub\n</code></pre>\n\n<p>Here I get an error saying can not have next with out for. </p>\n\n<p>Any idea how I get around these? I apologize for the formatting.</p>\n\n<p>Thank you all! </p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 3, "creation_date": 1524052267, "post_id": 49898916, "comment_id": 86813423, "body": "When deleting rows, start at the bottom and work your way up : <code>For x = lastrow To 1 Step -1</code>"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1524052295, "post_id": 49898916, "comment_id": 86813442, "body": "Would it speed up the code?"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1524052318, "post_id": 49898916, "comment_id": 86813465, "body": "@Rhyfelwr It would definetely delete all rows correctly at least."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1524052329, "post_id": 49898916, "comment_id": 86813472, "body": "That&#39;s a start!"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524052902, "post_id": 49898916, "comment_id": 86813836, "body": "<i>...the loop works but it frequently crashes excel and times out...</i> IF it crashes, try using <code>DoEvents</code> after deleting. Type it right after your IF and test it. Also, disabling calculations with <code>Application.Calculation = xlCalculationManual</code> will help"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1524053629, "post_id": 49898916, "comment_id": 86814253, "body": "Does your table have headers?"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1524053723, "post_id": 49898916, "comment_id": 86814314, "body": "No headers it is just a raw logging file with an event with a corresponding date in each row"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1524062666, "post_id": 49898916, "comment_id": 86820764, "body": "This answer is a lot faster: <a href=\"https://stackoverflow.com/a/30959316\">Excel VBA Performance - 1 million rows - Delete rows containing a value, in less than 1 min</a>"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1524063510, "post_id": 49898916, "comment_id": 86821434, "body": "Wow that is actually very interesting. I guess this is the limitation of VBA when users have to use workarounds like that."}], "answers": [{"comments": [{"owner": {"reputation": 10897, "user_id": 736172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/25b2d80f32ba198cf07c5ab0e0af469d?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/736172/ahmad"}, "edited": false, "score": 0, "creation_date": 1524052522, "post_id": 49899072, "comment_id": 86813589, "body": "upvoted for looping the rows backwards, thus avoiding deleting rows that should not be deleted"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1524052553, "post_id": 49899072, "comment_id": 86813605, "body": "Parent object of <code>Cells</code> is not specified, as well as for <code>Rows</code>. <code>Application.ScreenUpdating = False&#47;True</code> applies better for this procedure than <code>Application.Calculation</code>, unless OP has tons of formulas in worksheet."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1524052634, "post_id": 49899072, "comment_id": 86813662, "body": "Hmm I&#39;m sorry but this one is even slower than my original code, although it does work!"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1524052683, "post_id": 49899072, "comment_id": 86813694, "body": "But you file stays editable while macro&#39;s running... Right?"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 2, "creation_date": 1524052695, "post_id": 49899072, "comment_id": 86813698, "body": "@Rhyfelwr because it evokes <code>Format(Now()),&quot;SomeFormat&quot;)</code> for each cell it checks."}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "edited": false, "score": 0, "creation_date": 1524052776, "post_id": 49899072, "comment_id": 86813756, "body": "Right! Keeping <code>Auditdate</code> variable it&#39;s better... I didn&#39;t test the script... (edited already)..."}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 1, "last_activity_date": 1524052899, "last_edit_date": 1524052899, "creation_date": 1524052394, "answer_id": 49899072, "question_id": 49898916, "link": "https://stackoverflow.com/questions/49898916/deleting-all-rows-containing-a-specific-value-most-efficient-method/49899072#49899072", "title": "Deleting all rows containing a specific value (most efficient method?)", "body": "<p>I would do the following:</p>\n\n<pre><code>Sub PSAudit()\n    Dim psm As Worksheet\n    Set psm = ThisWorkbook.Sheets(\"PS_MAIN\")\n    Dim LastRow As Long\n    Dim Auditdate As String\n    Auditdate = Format(Now() - 1, \"yyyy-mm-dd\")\n    Application.Calculation = xlCalculationManual\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For x = LastRow To 1 Step -1\n        If psm.Cells(x, 1).Value &lt;&gt; Auditdate Then\n            psm.Cells(x, 1).EntireRow.Delete\n        End If\n        DoEvents\n    Next x\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Explanation:\nFirst, when you use a <code>for next</code>to delete rows (or columns) start from the bottom.\nSecond, if you place a <code>DoEvents</code>on the procedure, your file doesn't crash.\nAnd third, using complete cells addresses gives you liberty to work on your file (even on other sheets) or even on another workbooks while your script is running.</p>\n"}, {"comments": [{"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1524054795, "post_id": 49899168, "comment_id": 86815031, "body": "Well this one seems the fastest and the most stable so I&#39;ll use your solution, it still takes a good 7-8 minutes to run the loop through the file but I guess I&#39;ll have to live with it haha. Thanks for the help!"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1524058170, "post_id": 49899168, "comment_id": 86817391, "body": "Out of interest.. is your source table sorted in any particular order?"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1524058471, "post_id": 49899168, "comment_id": 86817607, "body": "It is sorted by date ascending by default"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 1, "creation_date": 1524060125, "post_id": 49899168, "comment_id": 86818800, "body": "If you&#39;re talking about column A, then you could speed things up <b>a lot</b> by finding the top and bottom of the block to delete and delete that entire block as one command."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1524053105, "last_edit_date": 1524053105, "creation_date": 1524052695, "answer_id": 49899168, "question_id": 49898916, "link": "https://stackoverflow.com/questions/49898916/deleting-all-rows-containing-a-specific-value-most-efficient-method/49899168#49899168", "title": "Deleting all rows containing a specific value (most efficient method?)", "body": "<p>You need to start at the bottom as once a row is deleted, your index is out by one row. You also should really qualify the sheet for your <code>LastRow</code> query. Nor sure why you declare <code>rng</code> as you don't use it. Lastly, I'd turn off calculation if the workbook contains any formulae.</p>\n\n<pre><code>Sub PSAudit()\n\n    Dim Auditdate As String\n    Dim psm As Worksheet\n\n    Set psm = Sheets(\"PS_MAIN\")\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Auditdate = Format(Date - 1, \"yyyy-mm-dd\")\n\n    lastrow = psm.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n      For x = lastrow To 1 Step -1\n          With psm.Range(\"A\" &amp; x)\n              If .Value &lt;&gt; Auditdate Then .EntireRow.Delete\n          End With\n      Next x\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 323, "user_id": 9034269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a314b3c9b9b7d834f280ecbc043847e?s=128&d=identicon&r=PG&f=1", "display_name": "ingwarus", "link": "https://stackoverflow.com/users/9034269/ingwarus"}, "is_accepted": false, "score": -2, "last_activity_date": 1524053217, "creation_date": 1524053217, "answer_id": 49899327, "question_id": 49898916, "link": "https://stackoverflow.com/questions/49898916/deleting-all-rows-containing-a-specific-value-most-efficient-method/49899327#49899327", "title": "Deleting all rows containing a specific value (most efficient method?)", "body": "<p>Deleting row by row will be painfully slow, so you should sort by date and delete all rows at once. It's the fastest way.</p>\n"}, {"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1524054319, "post_id": 49899544, "comment_id": 86814680, "body": "Probably because I declared <code>auditDate</code> as a <code>Date</code> and you&#39;re using it (elsewhere) as a string. Frankly, you could skip using <code>auditDate</code> in the <code>.Find()</code> and substitute with <code>What:=date-1</code> and it <i>should</i> work depending on how your dates are formatted (are they actual Excel Date formats or are they just text) - that will determine what you need to search for. Also, you can <code>Dim auditDate as String</code> and set it to whatever you need, <i>and</i> <code>Dim searchDate as Date</code> to use in the <code>.Find()</code> method if you want and if that makes things work better"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1524054504, "post_id": 49899544, "comment_id": 86814802, "body": "Hmmm I&#39;ve been trying to specify too exact values to look for (date of the day before yesterday and today&#39;s date) as strings to put them after the what:= query but sadly it still doesn&#39;t work. Even though according to the debug.print the declared dates to look for are correct."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1524055274, "post_id": 49899544, "comment_id": 86815345, "body": "Sadly, I&#39;m not sure that a formula result can be used in the <code>.Find()</code> function, so this probably won&#39;t work. However, I&#39;ll leave it here as an example of using <code>.Find()</code> instead of looping."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1524056151, "last_edit_date": 1524056151, "creation_date": 1524053911, "answer_id": 49899544, "question_id": 49898916, "link": "https://stackoverflow.com/questions/49898916/deleting-all-rows-containing-a-specific-value-most-efficient-method/49899544#49899544", "title": "Deleting all rows containing a specific value (most efficient method?)", "body": "<p>Using <code>.Find()</code> is always significantly faster than looping through all rows (for all but trivial numbers of rows).</p>\n\n<p>This is untested but should get you started. You'll probably have to tweak the <code>What:=\"\"</code> parameter a bit and play around with that. It's much easier when you're searching for something specific than searching for what's <em>not</em> that specific thing. I'd suggest refining your search using the dialog box to determine exactly what you need to put in the <code>What:=\"\"</code> parameter.</p>\n\n<p>Remember that <code>.Find()</code> will use all search settings that are defined in the UI dialog box <em>unless</em> you specify them in your code, <em>and</em> changing them in code will change what you see in the dialog box, too.</p>\n\n<pre><code>Private Sub PSAudit()\n\n  On Error GoTo cleanExit\n  Dim auditDate As Date\n  auditDate = Date\n\n  Dim previousCalculation As Long\n  previousCalculation = Application.Calculation\n  Application.ScreenUpdating = False\n  Application.Calculation = xlCalculationManual\n\n  Dim psm As Worksheet\n  Set psm = ActiveWorkbook.Worksheets(\"PS_MAIN\")\n  Dim searchRange As Range\n  Set searchRange = psm.Columns(\"A\")\n\n  Dim oldDates As Range\n  Set oldDates = psm.Columns.Find(What:=\"&lt; auditDate\", LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns)\n\n  If not oldDates is Nothing then\n    Dim deleteRow As Range\n    For Each deleteRow In oldDates\n      deleteRow.EntireRow.Delete\n    Next\n End If\n\ncleanExit:\n  Application.ScreenUpdating = True\n  Application.Calculation = previousCalculation\n\nEnd Sub\n</code></pre>\n\n<p>Turning off <code>.ScreenUpdating</code> and <code>.Calculation</code>, as mentioned by others, will improve processing times somewhat, but <code>.Find()</code> will be the big hitter.</p>\n"}, {"tags": [], "owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "is_accepted": false, "score": 1, "last_activity_date": 1524079029, "last_edit_date": 1524079029, "creation_date": 1524056987, "answer_id": 49900586, "question_id": 49898916, "link": "https://stackoverflow.com/questions/49898916/deleting-all-rows-containing-a-specific-value-most-efficient-method/49900586#49900586", "title": "Deleting all rows containing a specific value (most efficient method?)", "body": "<p>Expanding @ingwarus answer, it is faster to delete all rows at once, given their address.</p>\n\n<pre><code>Sub PSAudit()\n    Dim Auditdate As String\n    Dim rng As Range\n    Dim psm As Worksheet\n    Dim vArr(), i As Long\n    Dim auStart As Long, auEnd As Long\n\n    DisFun False\n\n    Set psm = ThisWorkbook.Worksheets(\"PS_MAIN\")\n    Auditdate = Format(Date - 1, \"yyyy-mm-dd\")\n    Set rng = psm.Range(\"A1:D\" &amp; Range(\"A\" &amp; psm.Rows.Count).End(xlUp).Row)\n    'Set rng = psm.Range(\"A1\").CurrentRegion\n    rng.Sort rng.Cells(1, 1), xlAscending, , , , , , xlNo\n    vArr = Application.Transpose(rng.Columns(\"A\").Value)\n    For i = LBound(vArr) To UBound(vArr)\n        If vArr(i) = Auditdate Then auStart = i: Exit For\n    Next i\n    For i = UBound(vArr) To LBound(vArr) Step -1\n        If vArr(i) = Auditdate Then auEnd = i: Exit For\n    Next i\n    Select Case True\n        'Auditdate is at start\n        Case auStart = 1\n            psm.Range(auEnd + 1 &amp; \":\" &amp; UBound(vArr)).EntireRow.Delete\n        'Auditdate is at the end\n        Case auEnd = UBound(vArr)\n            psm.Range(\"1:\" &amp; auStart - 1).EntireRow.Delete\n        'Auditdate in between\n        Case Else\n            psm.Range(\"1:\" &amp; auStart - 1 &amp; \",\" &amp; auEnd + 1 &amp; \":\" &amp; UBound(vArr)).EntireRow.Delete\n    End Select\n\n    DisFun True\n\nEnd Sub\n</code></pre>\n\n<p>Firstly of all, we need to define the range and sort it.<br>\nSecondly, we need to find first and last occurence of <strong>AuditDate</strong>.<br>\nDepending on <strong>auStart</strong> and <strong>auEnd</strong> values, we can narrow down certain situations and delete rows accordingly.<br>\nI've used help sub one can find useful in later projects:</p>\n\n<pre><code>Private Sub DisFun(ByVal Status As Boolean)\n    With Application\n        .ScreenUpdating = Status\n        .EnableEvents = Status\n        .DisplayStatusBar = Status\n        .Calculation = IIf(Status, -4105, -4135)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 49899168, "answer_count": 5, "score": 0, "last_activity_date": 1524079029, "creation_date": 1524051957, "question_id": 49898916, "link": "https://stackoverflow.com/questions/49898916/deleting-all-rows-containing-a-specific-value-most-efficient-method", "title": "Deleting all rows containing a specific value (most efficient method?)", "body": "<p>Hi there I am trying to write a macro that processes a huge file (talking 30-35k rows). I have a loop that goes through all the cells in column <code>A</code> and deletes all rows where the date in column <code>A</code> doesn't equal yesterday's date. (sounds convoluted I know). Is there any more efficient way of doing this? I mean the loop works but it frequently crashes excel and times out etc. </p>\n\n<pre><code>Sub PSAudit()\nDim Auditdate As String\nDim rng As Range\nDim psm as worksheet\n\nSet psm = Sheets(\"PS_MAIN\")\nApplication.ScreenUpdating = False\n\n        Auditdate = Format(Date - 1, \"yyyy-mm-dd\")\n\n    lastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    For x = 1 To lastrow\n\n        If psm.Range(\"A\" &amp; x).Value &lt;&gt; Auditdate Then psm.Range(\"A\" &amp; x).EntireRow.Delete\n\n    Next x\n\n\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "edited": false, "score": 0, "creation_date": 1528759680, "post_id": 49898094, "comment_id": 88620417, "body": "At the risk of sounding like I&#39;m telling people how to vote, (which I&#39;m not, just curious why they&#39;re voting the way they are): While I prefer my answer, feel it&#39;s more complete and neater, I don&#39;t understand what about this answer is &quot;not helpful&quot;... It looks right (and based on the currently selected answer would definitely work)... so..."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "edited": false, "score": 0, "creation_date": 1528870796, "post_id": 49898094, "comment_id": 88664735, "body": "@IsaacReefman: Originally, Raul didn&#39;t tell that the field name included spaces, thus bracketing was not needed. Then he did, and posted a clumsy string concatenating, thus I modified my answer to include the bracketing in the usual way. Still, a comment to my answer could have done it, and - you are right - I see no reason for the shy and anonymous downvotes. But that&#39;s life."}, {"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "edited": false, "score": 0, "creation_date": 1529044142, "post_id": 49898094, "comment_id": 88742022, "body": "Another mystery: He selected my answer (that had the brackets in from the beginning, and would have returned the same result as yours, just structured it differently) and that was it for ages. And then he changed his mind and switched to his... I genuinely wonder why the sudden change."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": -2, "last_activity_date": 1524659534, "last_edit_date": 1524659534, "creation_date": 1524049373, "answer_id": 49898094, "question_id": 49897861, "link": "https://stackoverflow.com/questions/49897861/ms-access-filter-by-combobox-selection-based-on-column-names/49898094#49898094", "title": "MS Access Filter by ComboBox selection based on Column names", "body": "<p>Try with:</p>\n\n<pre><code>filterString = \"[\" &amp; selectedfield  &amp; \"] BETWEEN #\" &amp; Format(startDate, \"MM-DD-YYYY\") &amp; \"# And #\" &amp; Format(endDate, \"MM-DD-YYYY\") &amp; \"#\"\n</code></pre>\n\n<p>This will output for a field name of \"My Field\":</p>\n\n<pre><code>[My Field] BETWEEN #04-25-2018# And #04-25-2018#\n</code></pre>\n\n<p>Your expanded expression will return:</p>\n\n<pre><code>[My Field] BETWEEN #04-25-2018# And #04-25-2018#\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1524658678, "post_id": 49900273, "comment_id": 87060116, "body": "This is just a more convoluted way to create a string identical to my answer."}, {"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "edited": false, "score": 0, "creation_date": 1528759436, "post_id": 49900273, "comment_id": 88620373, "body": "Why all the extra concatenation? And why are you starting the string off with an empty string, followed by another string? Seems like an awful lot of double handling..."}], "tags": [], "owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "is_accepted": true, "score": 0, "last_activity_date": 1524056030, "creation_date": 1524056030, "answer_id": 49900273, "question_id": 49897861, "link": "https://stackoverflow.com/questions/49897861/ms-access-filter-by-combobox-selection-based-on-column-names/49900273#49900273", "title": "MS Access Filter by ComboBox selection based on Column names", "body": "<p>This works:</p>\n\n<p><code>filterString = \"\" &amp; \"[\" &amp; selectedField &amp; \"]\" &amp; \" BETWEEN #\" &amp; Format(startDate, \"MM-DD-YYYY\") &amp; \"# And #\" &amp; Format(endDate, \"MM-DD-YYYY\") &amp; \"#\"</code></p>\n"}, {"tags": [], "owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "is_accepted": false, "score": 1, "last_activity_date": 1528766024, "last_edit_date": 1528766024, "creation_date": 1524101028, "answer_id": 49911283, "question_id": 49897861, "link": "https://stackoverflow.com/questions/49897861/ms-access-filter-by-combobox-selection-based-on-column-names/49911283#49911283", "title": "MS Access Filter by ComboBox selection based on Column names", "body": "<p>It looks like you haven't defined <code>\"selectedfield\"</code> - you should define it as a <code>string</code>, and then set it to <code>\"[\" &amp; CboxSelectField.Value &amp; \"]\"</code> to make it work the way you're trying to at the moment.</p>\n\n<p>So your coding would look like this:</p>\n\n<pre><code>Private Sub Command88_Click()\nDim startDate As String, endDate As String\nDim selectedfield As String, filterString As String\n\nstartDate = txtStartDate\nendDate = txtEndDate\nselectedfield = \"[\" &amp; CboxSelectField.Value &amp; \"]\"\n\nfilterString = selectedfield &amp; \" BETWEEN #\" &amp; _\nFormat(startDate, \"MM-DD-YYYY\") &amp; \"# And #\" &amp; _\nFormat(endDate, \"MM-DD-YYYY\") &amp; \"#\"\n\nMe.Filter = filterString\nMe.FilterOn = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 49900273, "answer_count": 3, "score": 0, "last_activity_date": 1528766024, "creation_date": 1524048647, "last_edit_date": 1524070037, "question_id": 49897861, "link": "https://stackoverflow.com/questions/49897861/ms-access-filter-by-combobox-selection-based-on-column-names", "title": "MS Access Filter by ComboBox selection based on Column names", "body": "<p>I am a bit stuck here. i have got the following code:</p>\n\n<pre><code>` Private Sub Command88_Click()\nDim filterString As String\nDim startDate As String\nDim endDate As String\n\nstartDate = txtStartDate\nendDate = txtEndDate\nselectedfield = CboxSelectField.Value\n\nfilterString = \"[HW End of Support] BETWEEN #\" &amp; Format(startDate, \"MM-DD-YYYY\") &amp; \"# And #\" &amp; Format(endDate, \"MM-DD-YYYY\") &amp; \"#\"\n\nMe.Filter = filterString\nMe.FilterOn = True\n\nEnd Sub`\n</code></pre>\n\n<p>the filter runs fine as long as the value of the column to filter on by remains hard coded i.e <code>[HW End of Support]</code> but i have a combobox called <code>CboxSelectField</code> that has 4 different column names and what i need is to filter data based on the column that has been selected from the combo box?\nif i replace the <code>[HW End of Support]</code> with the <code>selectedField</code> variable that contains the value of the selection of the combobox then the code breaks and it does not filter.</p>\n\n<p>help please!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1524048288, "post_id": 49897640, "comment_id": 86810691, "body": "First thing you need to do is be aware of <a href=\"https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/ksh7h19t(v=vs.90)\" rel=\"nofollow noreferrer\"><b>reserved words</b></a>.  Don&#39;t use words like <code>module</code> and <code>value</code> as the name of a variable.  Don&#39;t you think <code>Dim module as module</code> could be a little confusing?  Secondly, it&#39;s very unclear what you&#39;re trying to do here.  I&#39;d suggest you put <code>Option Explicit</code> at the top of [every] module [forever] so help with name conflicts, and then you&#39;ll need to share more background and examples of what you&#39;re trying to accomplish."}, {"owner": {"reputation": 41, "user_id": 8047680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d207c8f7f0f6582b15d62d93b47d6726?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Fityka", "link": "https://stackoverflow.com/users/8047680/artur-fityka"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1524049401, "post_id": 49897640, "comment_id": 86811461, "body": "@ashleedawg I&#39;ve changed <code>module</code> to <code>model</code>, <code>value</code> is not reserved word, but I&#39;ve changed it to <code>cash</code>. I want to get error when I try to set <code>m_cash As Currency</code> via <code>testString as String</code>."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1524050710, "post_id": 49897640, "comment_id": 86812342, "body": "You could check the type and raise your own <code>Sub test(x As Variant)  If TypeName(x) &lt;&gt; &quot;Long&quot; Or TypeName(x) &lt;&gt; &quot;Integer&quot; Then     Err.Raise 9999, , &quot;Incorrect&quot; End If  End Sub</code>"}, {"owner": {"reputation": 41, "user_id": 8047680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d207c8f7f0f6582b15d62d93b47d6726?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Fityka", "link": "https://stackoverflow.com/users/8047680/artur-fityka"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1524052955, "post_id": 49897640, "comment_id": 86813866, "body": "@Nathan_Sav if I do <code>Property Let(ByVal newCash As Variant)</code> then I have to do <code>Property Get Value() As Variant</code> also. I do not want to return from getter <code>As Variant</code>."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1524062633, "post_id": 49897640, "comment_id": 86820738, "body": "You can return it as a conversion, the variable added will be correct, so your get doesn&#39;t need to change"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1524062840, "post_id": 49897640, "comment_id": 86820894, "body": "VBA will always try to force a data type to &quot;fit&quot;, if it possibly can - it&#39;s not C#, more like JavaScript in this respect (I&#39;m assuming you come from another programming language since you expect stronger data typing). If Nathan&#39;s suggestion is not helpful, then you need to build type-checking into the code that sends data to your class/properties. Possibly a function that checks data types.  Or force a conversion (<code>val = CCur(testString)</code>) - which would trigger an error if the conversion is not possible - before sending <code>val</code> to <code>modelObj.Cash</code>."}], "owner": {"reputation": 41, "user_id": 8047680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d207c8f7f0f6582b15d62d93b47d6726?s=128&d=identicon&r=PG&f=1", "display_name": "Artur Fityka", "link": "https://stackoverflow.com/users/8047680/artur-fityka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524049624, "creation_date": 1524048010, "last_edit_date": 1524049624, "question_id": 49897640, "link": "https://stackoverflow.com/questions/49897640/how-to-prevent-automatic-conversion-when-passing-argument-to-property", "title": "How to prevent automatic conversion when passing argument to property?", "body": "<p>Why it does not fail when I try to pass string (<code>testString = \"10\"</code>) argument to property which takes currency parameter (<code>ByVal newCash as Currency</code>)? I do not want this automatic conversion. How to prevent it? How to disable it?</p>\n\n<p><code>Model</code> class module</p>\n\n<pre><code>Option Explicit\n\nPrivate m_cash As Currency\n\nPublic Property Let Cash(ByVal newCash As Currency)\n    m_cash = newCash\nEnd Property\n</code></pre>\n\n<p><code>Test</code> class module</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n    Dim modelObj as Model\n    Dim testString as String\n\n    Set modelObj = New Model\n    testString = \"10\"\n\n    modelObj.Cash = testString\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "find"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1524047701, "post_id": 49897401, "comment_id": 86810257, "body": "Most probably <code>strng</code> is no variable set?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1524048115, "post_id": 49897401, "comment_id": 86810558, "body": "You&#39;re not getting 2 errors at once, so which error is this section of code giving you now, and where?"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 2, "creation_date": 1524048925, "post_id": 49897401, "comment_id": 86811105, "body": "You should post your full code here."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1524050269, "last_edit_date": 1524050269, "creation_date": 1524048948, "answer_id": 49897956, "question_id": 49897401, "link": "https://stackoverflow.com/questions/49897401/variable-not-set-and-error-91-using-in-vba/49897956#49897956", "title": "Variable not set and error 91 using in VBA", "body": "<p>If <code>rngvar1</code> is <code>Nothing</code>, then you cannot use <code>.Find</code> for it. Thus, make a check whether it is \"Not Nothing\", before assigning:</p>\n\n<pre><code>Dim rngvar1 As Range\nSet rngvar1 = ActiveWorksheet.Range(\"K\" + CStr(strng.Row) + \":K\" + CStr(endrng.Row))\nIf Not rngvar1 Is Nothing Then\n    Set rngvar1 = rngvar1.Find(what:=maxDate, LookIn:=xlValues)\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1524049913, "creation_date": 1524049913, "answer_id": 49898252, "question_id": 49897401, "link": "https://stackoverflow.com/questions/49897401/variable-not-set-and-error-91-using-in-vba/49898252#49898252", "title": "Variable not set and error 91 using in VBA", "body": "<p>A couple of things in your code:</p>\n\n<ol>\n<li>Have Error handling scenario if <code>Find</code> failed to fetch <code>maxdate</code>.</li>\n<li>You are searching for a <code>Date</code>, try using <code>LookIn:=xlFormulas</code>.</li>\n</ol>\n\n<p>The rest of my comments in the code below:</p>\n\n<pre><code>Dim Sht As Worksheet\nDim rngvar1 As Range\n\nSet Sht = ActiveSheet ' &lt;-- rather not use ActiveSheet, better use Worksheets(\"YourSheetName\")\n\nWith Sht\n    Set rngvar1 = .Range(.Cells(strng.Row, \"K\"), .Cells(endrng.Row, \"K\")).Find(what:=maxdate, LookIn:=xlFormulas)\n\n    If Not rngvar1 Is Nothing Then ' If Find was successfull\n        ' put the rest of your code here\n\n    Else ' Find failed &gt;&gt; raise an error message\n        MsgBox \"Error finding \" &amp; maxdate, vbCritical\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 9653820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3fbbb2f098360405f3b546032a81517?s=128&d=identicon&r=PG", "display_name": "Romita Thakur", "link": "https://stackoverflow.com/users/9653820/romita-thakur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 49898252, "answer_count": 2, "score": 0, "last_activity_date": 1524050269, "creation_date": 1524047321, "last_edit_date": 1524048062, "question_id": 49897401, "link": "https://stackoverflow.com/questions/49897401/variable-not-set-and-error-91-using-in-vba", "title": "Variable not set and error 91 using in VBA", "body": "<p>Hi I am facing an issue with VBA for <code>variable not set</code>.</p>\n\n<pre><code>Dim rngvar1 As Range\nSet rngvar1 = ActiveWorksheet.Range(\"K\" + CStr(strng.Row) + \":K\" + _\n    CStr(endrng.Row)).Find(what:=maxdate, LookIn:=xlValues)\n</code></pre>\n\n<p>I am getting valuea in <code>strng.Row</code>, <code>endrng.Row</code> and in <code>maxdate</code> also but getting '<code>nothing</code>' in <code>rngvar1</code>.</p>\n\n<p>Also getting <code>-4163</code> in <code>LookIn:=xlValues</code>.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007", "ms-access-2016"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1524048946, "post_id": 49897380, "comment_id": 86811118, "body": "See also <a href=\"http://allenbrowne.com/AppFindAsUType.html\" rel=\"nofollow noreferrer\">allenbrowne.com/AppFindAsUType.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1524049109, "creation_date": 1524049109, "answer_id": 49898017, "question_id": 49897380, "link": "https://stackoverflow.com/questions/49897380/access-vba-search-while-you-type-in-textbox-from-listbox/49898017#49898017", "title": "Access VBA :Search while you type in Textbox from Listbox", "body": "<p>If you have Listbox with a rowsource like:</p>\n\n<pre><code>    SELECT CustomerID, CompanyName, Phone, Fax FROM Customers ORDER BY CustomerID\n</code></pre>\n\n<p>then use code-behind similar to:</p>\n\n<pre><code>'Search string for the list box.\nPrivate strLstSearch As String\n\n' Listing A\nPrivate Sub SetTyped()\n  'Display current typed or selected value.\n  Me!txtSearch.Value = strLstSearch\nEnd Sub\n\n' Listing B\nPrivate Sub lstPhone_KeyPress(KeyAscii As Integer)\n  'Select item in list box\n  Dim lst As ListBox\n  Dim rst As ADODB.Recordset\n  Dim lngKeyLen As Long\n  Dim booReset As Boolean\n  Set lst = Me.ActiveControl\n  'Determine keyboard input\n  'and respond accordingly.\n  Select Case KeyAscii\n    Case vbKeyBack\n      'Cancel last key press.\n      lngKeyLen = Len(strLstSearch)\n      If lngKeyLen &gt; 0 Then\n        strLstSearch = Left(strLstSearch, lngKeyLen - 1)\n        If lngKeyLen = 1 Then\n          'Search string is empty. Reset listbox.\n          booReset = True\n        End If\n      End If\n    Case vbKeyEscape\n      'Reset search string and listbox.\n      strLstSearch = vbNullString\n      booReset = True\n    Case vbKeyReturn, vbKeyTab\n    'Keeps Tab and Enter from being trapped.\n    Case Else\n      'Set search string value\n      strLstSearch = strLstSearch &amp; Chr(KeyAscii)\n      'Inhibit normal stepping in listbox.\n      KeyAscii = 0\n  End Select\n  lngKeyLen = Len(strLstSearch)\n  If booReset = True Then\n    'Reset listbox.\n    lst.Value = lst.ItemData(Abs(lst.ColumnHeads))\n  ElseIf lngKeyLen &gt; 0 Then\n    'Search listbox using the rowsource.\n    Set rst = New ADODB.Recordset\n    rst.Open lst.RowSource, CurrentProject.Connection, _\n      adOpenStatic, adLockPessimistic\n    With rst\n      If .RecordCount &gt; 0 Then\n        .Find \"CustomerID Like '\" &amp; strLstSearch _\n         &amp; \"*'\"\n        If .EOF Then\n          'Skip key entry and notify user.\n          strLstSearch = Left(strLstSearch, lngKeyLen - 1)\n          DoCmd.Beep\n        Else\n          'Set listbox to located match.\n          lst.Value = .Fields(lst.BoundColumn - 1).Value\n        End If\n      End If\n      .Close\n    End With\n  End If\n  'Display current value.\n  Call SetTyped\n  Set rst = Nothing\n  Set lst = Nothing\n\nExitHere:\n  Set rst = Nothing\n  Set lst = Nothing\n  Exit Sub\n\nErrHandler:\n  MsgBox Err.Number &amp; \" \" &amp; Err.Description\n  GoTo ExitHere\n\nEnd Sub\n\n' Listing C\nPrivate Sub lstPhone_Click()\n  'Select item clicked on.\n  strLstSearch = Me.ActiveControl.Value\n  Call SetTyped\nEnd Sub\n\n' Listing D\nPrivate Sub lstPhone_GotFocus()\n  'Reset search string.\n  strLstSearch = vbNullString\n  Call SetTyped\nEnd Sub\n\n' Listing E\nPrivate Sub lstPhone_LostFocus()\n  'Reset search string.\n  strLstSearch = vbNullString\n  Call SetTyped\nEnd Sub\n</code></pre>\n\n<p>If you\u2019re using DAO, make the following changes to the code: </p>\n\n<ol>\n<li>List item</li>\n<li><p>Add the following declaration and definition statements:</p>\n\n<p>Dim dbs As DAO.Database</p>\n\n<p>Dim rst As DAO.Recordset</p>\n\n<p>Set dbs = CurrentDB</p></li>\n<li><p>Delete the ADODB Recordset declaration and definition statements.</p></li>\n<li><p>Replace the rst.Open statement with the following statement:</p>\n\n<p>Set rst = dbs.OpenRecordset(lst.RowSource)</p></li>\n<li><p>Replace the Find method with FindFirst.</p></li>\n<li>Replace the .EOF property with .NoMatch.</li>\n</ol>\n"}], "owner": {"reputation": 25, "user_id": 9527824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f2c20e326538f36652dac82f192086c?s=128&d=identicon&r=PG&f=1", "display_name": "user9527824", "link": "https://stackoverflow.com/users/9527824/user9527824"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2448, "favorite_count": 0, "closed_date": 1524068255, "answer_count": 1, "score": 0, "last_activity_date": 1524049109, "creation_date": 1524047253, "question_id": 49897380, "link": "https://stackoverflow.com/questions/49897380/access-vba-search-while-you-type-in-textbox-from-listbox", "closed_reason": "Duplicate", "title": "Access VBA :Search while you type in Textbox from Listbox", "body": "<p>I have text box and i want to search from a listbox whihc is populated from a table. I want the list box to find the item whihc the user is typing in the text box. This is the code i have written. The Text Box name = textSearch and listbox name = lstAvailable. Can anyone help me ?</p>\n\n<pre><code>  Dim lngBoxLength As Long\n  Dim intRow As Integer\n  Dim strTextBox As String\n  strTextBox = textSearch.Text\n  lngBoxLength = Len(textSearch.Text)\n\n  For intRow = 0 To lstAvailable.ListCount - 1\n  If Left(lstAvailable.Column(1, intRow), lngBoxLength) = strTextBox Then\n  lstAvailable.Selected(intRow) = True\n  Exit For\n  Next intRow\n  end if \n  end sub\n</code></pre>\n"}, {"tags": ["javascript", "html", "vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524049965, "post_id": 49897167, "comment_id": 86811817, "body": "Is this an internal URL? Or can you share?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1524103273, "post_id": 49897167, "comment_id": 86838997, "body": "Try firing the onSelect event, or try setting the Option&#39;s value directly. E.g. campaignType.FireEvent &quot;MYEVENTNAMEHERE&quot;"}, {"owner": {"reputation": 31, "user_id": 1458402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/292f3180c0bc6e7aaa99ceee4e50a496?s=128&d=identicon&r=PG", "display_name": "Sourav Das", "link": "https://stackoverflow.com/users/1458402/sourav-das"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524482871, "post_id": 49897167, "comment_id": 86975884, "body": "@QHarr - Yes this is an internal url."}, {"owner": {"reputation": 31, "user_id": 1458402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/292f3180c0bc6e7aaa99ceee4e50a496?s=128&d=identicon&r=PG", "display_name": "Sourav Das", "link": "https://stackoverflow.com/users/1458402/sourav-das"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1524482988, "post_id": 49897167, "comment_id": 86975969, "body": "@RyanWildry - What would be the event to be triggered here?"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1524487994, "post_id": 49897167, "comment_id": 86979278, "body": "Could be onSelect, or onChange. What happens when you just set the value of the element?\\"}, {"owner": {"reputation": 31, "user_id": 1458402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/292f3180c0bc6e7aaa99ceee4e50a496?s=128&d=identicon&r=PG", "display_name": "Sourav Das", "link": "https://stackoverflow.com/users/1458402/sourav-das"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1524572740, "post_id": 49897167, "comment_id": 87019277, "body": "@RyanWildry - The code is not even setting the value of the element. I don&#39;t know why."}, {"owner": {"reputation": 31, "user_id": 1458402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/292f3180c0bc6e7aaa99ceee4e50a496?s=128&d=identicon&r=PG", "display_name": "Sourav Das", "link": "https://stackoverflow.com/users/1458402/sourav-das"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1527152607, "post_id": 49897167, "comment_id": 88022505, "body": "@RyanWildry - Any help on why the value is not set would be highly appreciated."}], "owner": {"reputation": 31, "user_id": 1458402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/292f3180c0bc6e7aaa99ceee4e50a496?s=128&d=identicon&r=PG", "display_name": "Sourav Das", "link": "https://stackoverflow.com/users/1458402/sourav-das"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524103205, "creation_date": 1524046701, "last_edit_date": 1531164843, "question_id": 49897167, "link": "https://stackoverflow.com/questions/49897167/how-to-select-an-option-from-a-javascript-enabled-dropdown-box-on-ie-using-vba", "title": "How to Select an Option from a Javascript enabled dropdown box on IE using VBA", "body": "<p>Using VBA, I need to select an option out of 6 from a drop down box which is connected to a Javascript which changes the form below based on options selected.</p>\n\n<p>Here is the html codeo on the page:</p>\n\n<pre><code>&lt;script type=\"text/javascript\"&gt;\n    P.when('A','keyword-layout-model').register('keyword-layout-model-instance', \n    function(A, KeywordTargetingModel){\n        var model = new KeywordTargetingModel();\n        model.updateFromAdType('AAP_CPM');\n\n    A.on(\"a:dropdown:selected:lineItem.type\", function (data) {\n        model.updateFromAdType(data.value);\n    });\n\n    return model;\n})\n&lt;/script&gt;\n\n&lt;script type=\"text/javascript\"&gt;\n    // Create an instance of the ad-type-model. If this is moved, then the documentation\n    // in AdTypeModel.js in the D16GRodeoBackbone package needs to be updated.\n    P.when('ad-type-model').register('ad-type-model-instance', function(AdTypeModel){\n        return new AdTypeModel({adType: 'AAP_CPM'}, {adTypeDropdownId: 'lineItem.type'});\n    });\n&lt;/script&gt;\n\n&lt;span id=\"lineItem.type_d16g-validation\" class=\"d16g-validation d16g-component d16g-dropdown\" for=\"lineItem.type\"&gt;{\"required\":false}&lt;/span&gt;\n&lt;span class=\"a-dropdown-container\"&gt;&lt;select name=\"lineItem.type\" autocomplete=\"off\" id=\"lineItem.type\" tabIndex=\"-1\" class=\"a-native-dropdown\"&gt; \n&lt;option class=\"a-prompt\" value=\"\"&gt;Standard display&lt;/option&gt;\n&lt;option value=\"AAP_MOBILE_APP\"&gt;AAP - Mobile app&lt;/option&gt;\n&lt;option value=\"AMAN_APP\"&gt;AMAN - Mobile app&lt;/option&gt;\n&lt;option value=\"AAP_MOBILE_WEB\"&gt;AAP mobile display&lt;/option&gt;\n&lt;option value=\"CLASS_I_MOBILE_APP\"&gt;Class I - Mobile app&lt;/option&gt;\n&lt;option value=\"CLASS_I_MOBILE_WEB\"&gt;Class I - Mobile web&lt;/option&gt;&lt;option value=\"CLASS_I_WEB\"&gt;Class I display&lt;/option&gt;\n&lt;option value=\"AAP_CPM\" selected&gt;Standard display&lt;/option&gt;\n&lt;option value=\"AAP_VIDEO_CPM\"&gt;Video&lt;/option&gt;\n&lt;/select&gt;\n\n&lt;span tabIndex=\"-1\" id=\"lineItem.type_controller\" data-a-class=\"a-width-extra-large d16g-dropdownController\" class=\"a-button a-button-dropdown a-width-extra-large d16g-dropdownController\"&gt;&lt;span class=\"a-button-inner\"&gt;&lt;span class=\"a-button-text a-declarative\" data-action=\"a-dropdown-button\" role=\"button\" tabIndex=\"0\" aria-hidden=\"true\"&gt;&lt;span class=\"a-dropdown-prompt\"&gt;Standard display&lt;/span&gt;&lt;/span&gt;&lt;i class=\"a-icon a-icon-dropdown\"&gt;&lt;/i&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&amp;nbsp;\n\n&lt;div id=\"lineItem.type_error\" class=\"a-box a-alert-inline a-alert-inline-error d16g-hidden d16g-errorMessage\" aria-live=\"assertive\" role=\"alert\"&gt;&lt;div class=\"a-box-inner a-alert-container\"&gt;&lt;i class=\"a-icon a-icon-alert\"&gt;&lt;/i&gt;&lt;div class=\"a-alert-content\"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div id=\"lineItem.type_serverError\" class=\"a-box a-alert-inline a-alert-inline-error d16g-hidden d16g-serverErrorMessage\" aria-live=\"assertive\" role=\"alert\"&gt;&lt;div class=\"a-box-inner a-alert-container\"&gt;&lt;i class=\"a-icon a-icon-alert\"&gt;&lt;/i&gt;&lt;div class=\"a-alert-content\"&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n\n&lt;script type=\"text/javascript\"&gt;\n            P.when('D16G', 'jquery-1.9.0', 'A').register('refresh-form-ad-type', function(D16G, $, A) {\n                var options = {\n    saveButtonId                : \"bookAsLineItem\",\n    classIForecastOverride      : true,\n    canBookClassISov            : true,\n    retailMerchandising         : false,\n    budgetEntryRequired         : true,\n    hideDSMLineEntry            : false,\n    campaignType                : \"BILLABLE\",\n    canBypassKsoForecast        : false,\n    enableKsoOptimization       : false,\n    enableKsoBuyingStrategy     : false,\n    hasPermissionForViewability : false,\n    internalEntity              : true,\n    internalUser                : true\n};\n\n                A.on(\"a:dropdown:selected:lineItem.type\", function (data) {\n                    D16G.Util.setAdType(data.value, options);\n                });\n\n                // trigger the initial event at page load\n                var id = '#' + D16G.Util.escapeId(\"lineItem.type\");\n                A.trigger(\"a:dropdown:selected:lineItem.type\", {value : $(id).val() });\n\n                // Return a function that can be used to trigger a refresh of the page's fields\n                return function(){\n                    A.trigger(\"a:dropdown:selected:lineItem.type\", {value : $(id).val() })\n                };\n            });\n        &lt;/script&gt;             \n&lt;/div&gt;\n</code></pre>\n\n<p>\n</p>\n\n<p>I have tried using the following VBA code but of no help. Neither the option is getting selected nor the form below is changing. I think there is a javascript which gets triggered but I am unable to figure out how.</p>\n\n<pre><code>Set campaignType = IE.document.getElementById(\"lineItem.type\")\n\nFor i = 0 To campaignType.Options.Length\n  If campaignType.Options(i).Text = \"Class I display\" Then\n      campaignType.selectedIndex = i\n       Exit For\n   End If\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1524047029, "post_id": 49897164, "comment_id": 86809787, "body": "You want to apply conditional formatting to &quot;half&quot; of the string?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1524047191, "post_id": 49897164, "comment_id": 86809902, "body": "Partial format of concatenated cells is not supported: See <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_other-mso_archive/partial-format-contents-in-a-concatendated-cell/e5009136-dd7f-4899-97e6-7e6e3500ae51\" rel=\"nofollow noreferrer\">partial format contents in a concatendated cell</a>"}, {"owner": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "edited": false, "score": 0, "creation_date": 1524047335, "post_id": 49897164, "comment_id": 86810002, "body": "I have conditional formatting for values in Total Value and Delta rows. I want to concatenate values from those two rows while preserving formatting from each of them. From my understanding this can&#39;t be done with conditional formatting, so I want to convert from it to the static formatting for each &quot;half&quot; of the string. This is why I&#39;m using trying to colour each character. It works if the source formatting is static and not conditional."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1524047337, "post_id": 49897164, "comment_id": 86810004, "body": "How have you made the picture in the question? With Paint? Or is it a screenshot from Excel?"}, {"owner": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "edited": false, "score": 0, "creation_date": 1524047450, "post_id": 49897164, "comment_id": 86810095, "body": "Screenshot from Excel. It is a desired result that was achieved by manually colouring parts of text and giving them appropriate fonts (Wingdings for arrow)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1524047452, "post_id": 49897164, "comment_id": 86810096, "body": "Easiest way would be just to use 2 consecutive cells E.g. A1 for total value and B1 for delta. Borderline around both cells, and it looks like the same. This saves you much time and I see no disadvantages."}, {"owner": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1524047610, "post_id": 49897164, "comment_id": 86810200, "body": "@P\u1d07\u029c I was thinking about that solution but the length of strings will vary day-to-day and there are more than 10 columns for which I&#39;ll be applying solutions. That will require quite a lot of manual adjusting daily which I&#39;d rather avoid. :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1524047821, "post_id": 49897164, "comment_id": 86810348, "body": "@Seidhe just format A to the right and B to the left. That way it looks almost the same. As you can read in my link above partial format of concatenated cells is not supported in Excel. You might have a look here <a href=\"https://stackoverflow.com/questions/49895205/bold-text-in-a-concatenate-formula/49895502#49895502\" title=\"bold text in a concatenate formula\">stackoverflow.com/questions/49895205/&hellip;</a> which is a similar question."}, {"owner": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1524048348, "post_id": 49897164, "comment_id": 86810732, "body": "@P\u1d07\u029c thanks for the help. Unfortunately, I can&#39;t use your solution (neither the one with two cells close to each other nor the one you linked). I will probably try with copying and pasting my source range to Word and then pasting it back to Excel as this way you can preserve formatting without having rules  and then I&#39;ll use my part of macro (as it works with normal - not conditional formatting)."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "is_accepted": false, "score": 0, "last_activity_date": 1524059652, "creation_date": 1524059652, "answer_id": 49901550, "question_id": 49897164, "link": "https://stackoverflow.com/questions/49897164/concatenating-text-and-preserving-conditional-formatting-as-static/49901550#49901550", "title": "Concatenating text and preserving conditional formatting as static", "body": "<p>I have partly achieved what I wanted by copying my source range with all the conditional formatting to Word and pasting it back to Excel to another range. This way the formatting was preserved but there were no rules for conditional formatting and all the font parameters were readable by my macro. Only problem is when using non-standard colours as they are different in Excel and Word (for example red turns to pink)</p>\n\n<pre><code>Sub Merge_Cells()\nDim i As Integer\nDim rngFrom1 As Range\nDim rngFrom2 As Range\nDim rngTo As Range\nDim lenFrom1 As Integer\nDim lenFrom2 As Integer\nDim objWord As Object\nDim objDoc As Object\nDim rngcopy As Range\nDim ws As Worksheet\n\nSet ws = Sheets(\"test\")\nws.Visible = True\nws.Activate    \nSet rngcopy = Range(\"C51\", \"C53\")\nrngcopy.Select\n' Copy Excel Selection\nSelection.Copy\n\n' Create new Word Application\nSet objWord = CreateObject(\"Word.Application\")\nobjWord.Visible = False\n\n' Create new Word Document\nSet objDoc = objWord.Documents.Add(Template:=\"Normal\", NewTemplate:=False, DocumentType:=0)\n\n' Paste Excel range into Word document\nobjWord.Selection.PasteExcelTable False, False, True\n\n' Copy text from cells\nIf objDoc.Tables.Count &gt;= 1 Then\n    objDoc.Tables(1).Select\n    objWord.Selection.Copy\nEnd If\n\n' Close Microsoft Word and not save changes\nobjWord.Quit False\nSet objWord = Nothing\n'Paste it back to Excel\nws.Range(\"C58\").Activate\nws.Paste\n\n'Old code\nSet rngFrom1 = Cells(59, 3) 'first row\nSet rngFrom2 = Cells(60, 3) 'second row\nSet rngTo = Cells(64, 3)\nlenFrom1 = Len(rngFrom1)\nlenFrom2 = Len(rngFrom2)\nrngTo.Value = rngFrom1.Text &amp; \" \" &amp; rngFrom2.Text 'concatenating text\n\nFor i = 1 To lenFrom1\n    With rngTo.Characters(i, 1).Font\n      .Name = rngFrom1.DisplayFormat.Characters(i, 1).Font.FontStyle\n      .Bold = rngFrom1.DisplayFormat.Characters(i, 1).Font.Bold\n      .Size = rngFrom1.DisplayFormat.Characters(i, 1).Font.Size\n      .ColorIndex = rngFrom1.DisplayFormat.Characters(i, 1).Font.ColorIndex\n    End With\nNext i\n\nFor i = 1 To lenFrom2\n    'start from character that is after space\n    With rngTo.Characters(lenFrom1 + 1 + i, 1).Font \n      .Name = rngFrom2.DisplayFormat.Characters(i, 1).Font.Name\n      .Bold = rngFrom2.DisplayFormat.Characters(i, 1).Font.Bold\n      .Size = rngFrom2.DisplayFormat.Characters(i, 1).Font.Size\n      .ColorIndex = rngFrom2.DisplayFormat.Characters(i, 1).Font.ColorIndex\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 8794503, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5c638e40ed4b08bbc3af55032e6a4910?s=128&d=identicon&r=PG&f=1", "display_name": "Seidhe", "link": "https://stackoverflow.com/users/8794503/seidhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 684, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524059652, "creation_date": 1524046697, "last_edit_date": 1524046810, "question_id": 49897164, "link": "https://stackoverflow.com/questions/49897164/concatenating-text-and-preserving-conditional-formatting-as-static", "title": "Concatenating text and preserving conditional formatting as static", "body": "<p>I have a table with two rows that have conditional formating in them (rules like if lower than then colour text). I need to concatenate those two rows and preserve formatting from each row separately. Due to this I can't just concatenate values and paste formats as it will apply conditional formatting to the whole text and not just the parts of it. </p>\n\n<p>I have searched for solution and found that you can convert conditional formatting to static formatting by using Range.DisplayFormat property. In my code I am basically going by each character \nand copying DisplayFormat from source cell (with conditional formatting) and using the same font, size, bold and color on characters in my target range.</p>\n\n<p>The result should look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ou2qZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ou2qZ.png\" alt=\"desired result\"></a></p>\n\n<p>Unfortunately, I am getting just a concatenated string without formatting. Do you know a better way to achieve what I need? Or could you help me with fixing the existing code.</p>\n\n<pre><code>Sub Merge_Cells()\nDim i As Integer\nDim rngFrom1 As Range\nDim rngFrom2 As Range\nDim rngTo As Range\nDim lenFrom1 As Integer\nDim lenFrom2 As Integer\n\n  Set rngFrom1 = Cells(59, 1) 'first row\n  Set rngFrom2 = Cells(60, 1) 'second row\n  Set rngTo = Cells(64, 1)\n  lenFrom1 = Len(rngFrom1)\n  lenFrom2 = Len(rngFrom2)\n\n  rngTo.Value = rngFrom1.Text &amp; \" \" &amp; rngFrom2.Text 'concatenating text\n\n  For i = 1 To lenFrom1\n    With rngTo.Characters(i, 1).Font\n      .Name = rngFrom1.DisplayFormat.Characters(i, 1).Font.FontStyle\n      .Bold = rngFrom1.DisplayFormat.Characters(i, 1).Font.Bold\n      .Size = rngFrom1.DisplayFormat.Characters(i, 1).Font.Size\n      .ColorIndex = rngFrom1.DisplayFormat.Characters(i, 1).Font.ColorIndex\n    End With\n  Next i\n\n  For i = 1 To lenFrom2\n    'start from character that is after space\n    With rngTo.Characters(lenFrom1 + 1 + i, 1).Font \n      .Name = rngFrom2.DisplayFormat.Characters(i, 1).Font.Name\n      .Bold = rngFrom2.DisplayFormat.Characters(i, 1).Font.Bold\n      .Size = rngFrom2.DisplayFormat.Characters(i, 1).Font.Size\n      .ColorIndex = rngFrom2.DisplayFormat.Characters(i, 1).Font.ColorIndex\n    End With\n  Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 330, "user_id": 8835677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Y4mX.jpg?s=128&g=1", "display_name": "Night Programmer", "link": "https://stackoverflow.com/users/8835677/night-programmer"}, "edited": false, "score": 0, "creation_date": 1524046961, "post_id": 49897026, "comment_id": 86809746, "body": "you can directly copy paste then drag down or up for sequence ."}, {"owner": {"reputation": 3, "user_id": 9283113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef71f70d65feaafdfc88d488de5e11d?s=128&d=identicon&r=PG&f=1", "display_name": "shweta agnihotri", "link": "https://stackoverflow.com/users/9283113/shweta-agnihotri"}, "reply_to_user": {"reputation": 330, "user_id": 8835677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Y4mX.jpg?s=128&g=1", "display_name": "Night Programmer", "link": "https://stackoverflow.com/users/8835677/night-programmer"}, "edited": false, "score": 0, "creation_date": 1524642426, "post_id": 49897026, "comment_id": 87049585, "body": "I could but its bug slide and its weekly activity"}, {"owner": {"reputation": 330, "user_id": 8835677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Y4mX.jpg?s=128&g=1", "display_name": "Night Programmer", "link": "https://stackoverflow.com/users/8835677/night-programmer"}, "edited": false, "score": 0, "creation_date": 1524648531, "post_id": 49897026, "comment_id": 87053332, "body": "not getting you"}, {"owner": {"reputation": 3, "user_id": 9283113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef71f70d65feaafdfc88d488de5e11d?s=128&d=identicon&r=PG&f=1", "display_name": "shweta agnihotri", "link": "https://stackoverflow.com/users/9283113/shweta-agnihotri"}, "reply_to_user": {"reputation": 330, "user_id": 8835677, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Y4mX.jpg?s=128&g=1", "display_name": "Night Programmer", "link": "https://stackoverflow.com/users/8835677/night-programmer"}, "edited": false, "score": 0, "creation_date": 1524736106, "post_id": 49897026, "comment_id": 87095696, "body": "I mean, I have 3 ppt like this with 30-35 slide in each and this is weekly activity.  To drag and down every week I thought to write code for it. As I wanted to paste PPT2 at the end of my main (PPT1)"}], "owner": {"reputation": 3, "user_id": 9283113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ef71f70d65feaafdfc88d488de5e11d?s=128&d=identicon&r=PG&f=1", "display_name": "shweta agnihotri", "link": "https://stackoverflow.com/users/9283113/shweta-agnihotri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524046280, "creation_date": 1524046280, "question_id": 49897026, "link": "https://stackoverflow.com/questions/49897026/vba-code-for-copy-from-one-powerpoint-to-paste-in-another-powerpoint", "title": "vba code for copy from one powerpoint to paste in another powerpoint", "body": "<p>I have PPT1 where I need to copy from PPT2 which has 4 slide which will go to always in end in PPT1.</p>\n\n<p>Could anyone help me to write code in PPT as I have not idea to give range in PPts.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "edited": false, "score": 0, "creation_date": 1524046960, "post_id": 49897025, "comment_id": 86809744, "body": "I fixed that error now. But the problem is first time its working as expected. but when I close and open the workbook,its repairing the sheet and its not populating the data. I have cross verfied that is happening because of this set of code."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1524048601, "post_id": 49897025, "comment_id": 86810897, "body": "You should provide an <code>Operator</code>, too. And <code>Formula1</code> should look like <code>&quot;=$A$2:$A$5&quot;</code>. Note the <code>=</code> sign."}, {"owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1524052042, "post_id": 49897025, "comment_id": 86813272, "body": "im doing loop till the lastrow. Also at very first time, the dropdown is coming with values. but second time if i open the same excel, its corrupted."}, {"owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1524052299, "post_id": 49897025, "comment_id": 86813446, "body": "I tried with ur formula. Its not splitting the comma separated value. its taking all the values with (,) into the dropdown"}, {"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1524052449, "post_id": 49897025, "comment_id": 86813550, "body": "You should submit a new Question for your new question."}, {"owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "edited": false, "score": 0, "creation_date": 1524052843, "post_id": 49897025, "comment_id": 86813792, "body": "ok let me do it"}], "owner": {"reputation": 149, "user_id": 4022263, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/58ffcf8ae0255bfc0afe0dd96107d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "aaroki", "link": "https://stackoverflow.com/users/4022263/aaroki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524050504, "creation_date": 1524046276, "last_edit_date": 1531164843, "question_id": 49897025, "link": "https://stackoverflow.com/questions/49897025/throwing-exception-when-creating-dropdown-validation-in-vba", "title": "Throwing exception when creating dropdown validation in vba", "body": "<pre><code>Sub Example(x As Range, y As Range)\n\n  With y.Validation\n      .Delete\n      .Add Type:=xlValidateList, Formula1:=x.Value\n      .IgnoreBlank = True\n      .InCellDropdown = True\n      .InputTitle = \"\"\n      .ErrorTitle = \"\"\n      .InputMessage = \"\"\n      .ErrorMessage = \"\"\n      .ShowInput = True\n      .ShowError = True\n  End With\nEnd Sub\n</code></pre>\n\n<p>This is the function i am using for creating dropdown list from comma separted cell. But its throwing exception in the line of<br>\n  .Add Type:=xlValidateList, Formula1:=x.Value </p>\n\n<p>The Error is : </p>\n\n<blockquote>\n  <p>1004- Application-defined error </p>\n</blockquote>\n\n<p>Here is the code for looping:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n  Range(\"D2\").Select\n\n  Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"FacT&amp;C\")\n\n  Dim LastRow As Long 'always use long instead of integer\n  LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n  Dim iRow As Long\n   For iRow = 2 To LastRow\n     Example ws.Cells(iRow, \"AD\"), ws.Cells(iRow, \"R\")\n   Next iRow\nEnd Sub\n</code></pre>\n\n<p>Pls help me out</p>\n"}, {"tags": ["arrays", "excel", "for-loop", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "edited": false, "score": 0, "creation_date": 1524047612, "post_id": 49896985, "comment_id": 86810203, "body": "I have already tried all of these. The Item is getting matched for first element of array.It runs for the first matched i value of first item only. After that, although i gets incremented, The Cells values are not checked. LastRow is correct.On Error resume next is not present anywhere in the rest of the code(not mentioned above)."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "edited": false, "score": 1, "creation_date": 1524047779, "post_id": 49896985, "comment_id": 86810322, "body": "@Saboohi - I really do not wish to write it (because it is a bad practice), but write <code>wsb.Activate</code> before the <code>If Cells(i, 2).Value = Item Then</code> and it would probably work."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "edited": false, "score": 0, "creation_date": 1524048178, "post_id": 49896985, "comment_id": 86810603, "body": "@Saboohi - are you sure? However, what happens when you start going line by line with F8?"}, {"owner": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "edited": false, "score": 0, "creation_date": 1524048701, "post_id": 49896985, "comment_id": 86810965, "body": "It runs for the first matched i value of both the items in array and displays output but still doesn&#39;t show for all matched i values."}, {"owner": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "edited": false, "score": 0, "creation_date": 1524049060, "post_id": 49896985, "comment_id": 86811212, "body": "If I also add wsb.Activate before Next i, then it runs for all matched(i) values of first item but doesn&#39;t run for second item of array."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "edited": false, "score": 0, "creation_date": 1524049154, "post_id": 49896985, "comment_id": 86811280, "body": "@Saboohi - I guess that you are not interested in debugging with F8. Still, write <code>Set wsc = Workbooks(M).Sheets(Item)</code> after <code>For Each Item In Arr</code>, restart your PC and give it a try again."}, {"owner": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "edited": false, "score": 0, "creation_date": 1524049631, "post_id": 49896985, "comment_id": 86811602, "body": "I have been debugging since beginning.The code is working after adding wsb.Activate before Next i. Seems like while debugging, my pointer was at &quot;Next Item&quot; and that&#39;s why it was not showing for another item of array. Thanks for all your help."}, {"owner": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "edited": false, "score": 0, "creation_date": 1524049697, "post_id": 49896985, "comment_id": 86811639, "body": "ABove you mentioned that it&#39;s a bad practise. Can you please explain how?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "edited": false, "score": 1, "creation_date": 1524050355, "post_id": 49896985, "comment_id": 86812092, "body": "@Saboohi - see this for the bad practise - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba/35864330#35864330\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1524046175, "creation_date": 1524046175, "answer_id": 49896985, "question_id": 49896854, "link": "https://stackoverflow.com/questions/49896854/the-below-code-is-not-running-for-all-matching-cases-of-i-but-only-for-the-ver/49896985#49896985", "title": "The below code is not running for all matching cases of &quot;i&quot; but only for the very first matched Item", "body": "<p>Declare your variables like this:</p>\n\n<pre><code>Dim ws As Worksheet, wsa As worksheet, wsb as Worksheet\nDim wsc as Worksheet, wso As Worksheet\nDim index1b as Long, LastRow as Long, MOLastRow as Long, wsoLastRow As Long\n</code></pre>\n\n<p>Then start debugging with pressing <kbd>F8</kbd>. It goes line by line and you may see where is the problem in the nested loop. It can be in one of these 3:</p>\n\n<ul>\n<li><p>you need to write Trim(Cells(i, 2)) in the If Cells(i, 2).Value = Item Then condition;</p></li>\n<li><p>you are not calculating <code>LastRow</code> correctly;</p></li>\n<li><p>you have <code>On Error Resume Next</code> somewhere in your code and you are entering an error w/o noticing;</p></li>\n</ul>\n"}], "owner": {"reputation": 35, "user_id": 8841568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35fe7c8c26a39f6a67389731e2b02d30?s=128&d=identicon&r=PG&f=1", "display_name": "HobbyCoder", "link": "https://stackoverflow.com/users/8841568/hobbycoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524046175, "creation_date": 1524045830, "last_edit_date": 1531164843, "question_id": 49896854, "link": "https://stackoverflow.com/questions/49896854/the-below-code-is-not-running-for-all-matching-cases-of-i-but-only-for-the-ver", "title": "The below code is not running for all matching cases of &quot;i&quot; but only for the very first matched Item", "body": "<p>In worksheet wsb,I am trying to copy column B and Column having ParName in header and pasting it to columns B &amp; H respectively of worksheet wso. The problem is It's running only for first Item and also for the first matched value of i for that item and not for all the matched item-i values.</p>\n\n<pre><code>Dim ws, wsa, wsb, wsc, wso As Worksheet\nDim index1b, LastRow, MOLastRow, wsoLastRow As Long\nDim ColLtr1b As Variant\nDim MoNameArr\n\nSet wsb = Workbooks(Y).Sheets(\"REF\")\nwsb.Activate\nLastRow = GetLastRow(wsb, 2)\nArr = Array(\"Abc\", \"Def\")\nSet wso = Workbooks(W).Sheets(\"Output\")\n\nFor Each Item In Arr\n\n    For i = 2 To LastRow\n\n        If Cells(i, 2).Value = Item Then\n\n            wsb.Activate\n            ParName = wsb.Cells(i, 3).Value\n            Set wsc = Workbooks(M).Sheets(Item)\n            wsc.Activate\n            index1b = Application.Match(ParName, wsc.Rows(1), 0)\n\n            If Not IsError(index1b) Then\n\n                ColLtr1b = Replace(wsc.Cells(1, index1b).Address(True, False), \"$1\", \"\")\n                MOLastRow = wsc.Cells(Rows.Count, 2).End(xlUp).Row\n                Range(\"B2:B\" &amp; GetLastRow(wsc, 2)).Copy\n\n                wso.Activate\n                wsoLastRow = GetLastRow(wso, 2)\n                Range(\"B\" &amp; wsoLastRow + 1).Select\n                ActiveSheet.Paste\n\n                wsc.Activate\n                Range(ColLtr1b &amp; \"2:\" &amp; ColLtr1b &amp; GetLastRow(wsc, 2)).Copy\n\n                wso.Activate\n                Range(\"H\" &amp; wsoLastRow + 1).Select\n                ActiveSheet.Paste\n\n            End If\n\n        End If\n\n    Next i\n\nNext Item\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524047067, "post_id": 49896829, "comment_id": 86809820, "body": "So the columns to delete are not part of the table? The table simply lists the columns to delete?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1524047691, "post_id": 49896829, "comment_id": 86810249, "body": "Is the first column always in the same place, but the last column can change?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1524048548, "post_id": 49896829, "comment_id": 86810851, "body": "Do the column names repeat?  You&#39;re using <code>FindNext</code> which indicates that each column heading could appear multiple times and you want to remove them all?"}, {"owner": {"reputation": 45, "user_id": 9089755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e76d80f84b129684d162a81a3d1e007?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/9089755/marc"}, "edited": false, "score": 0, "creation_date": 1524081977, "post_id": 49896829, "comment_id": 86832194, "body": "Hi guys, thank you for all the responses. The columns to delete are in a second table and the first column will always be in the same place but the last column can change. The data I use only contains unique headings, there are no duplicate headings. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9089755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e76d80f84b129684d162a81a3d1e007?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/9089755/marc"}, "edited": false, "score": 0, "creation_date": 1524082063, "post_id": 49897794, "comment_id": 86832243, "body": "Hi, thanks for the above. I would work on a small list of headings but unfortunately my table contains approx 120 columns of which two thirds are not required. Will definitely look to use that though. Thanks again."}, {"owner": {"reputation": 651, "user_id": 9650803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SmX47.png?s=128&g=1", "display_name": "PoorlyWrittenCode", "link": "https://stackoverflow.com/users/9650803/poorlywrittencode"}, "reply_to_user": {"reputation": 45, "user_id": 9089755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e76d80f84b129684d162a81a3d1e007?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/9089755/marc"}, "edited": false, "score": 0, "creation_date": 1524088404, "post_id": 49897794, "comment_id": 86835084, "body": "Ah, missed the part about the ListObject. Can&#39;t say I&#39;ve used those. But a quick search shows you could just convert that to an array.  <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/6/20/&hellip;</a>  under Reading Table Data Into An Array Variable  So maybe something like: <code>headingsToDelete = Application.Transpose(ActiveSheet.ListObjects(&quot;Delete&quot;).List&zwnj;&#8203;Columns(1).DataBodyR&zwnj;&#8203;ange)</code>"}], "tags": [], "owner": {"reputation": 651, "user_id": 9650803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SmX47.png?s=128&g=1", "display_name": "PoorlyWrittenCode", "link": "https://stackoverflow.com/users/9650803/poorlywrittencode"}, "is_accepted": true, "score": 0, "last_activity_date": 1524051756, "last_edit_date": 1524051756, "creation_date": 1524048453, "answer_id": 49897794, "question_id": 49896829, "link": "https://stackoverflow.com/questions/49896829/delete-excel-table-column-based-on-heading-name-in-a-list/49897794#49897794", "title": "Delete Excel table column based on heading name in a list", "body": "<p>Would something like this work? Assuming all of your headings are in the first row.</p>\n\n<pre><code>Sub DeleteHeadings()\n  Dim headingsToDelete() As Variant: headingsToDelete = Array(\"a\", \"b\", \"c\")\n  Dim deletedOffset As Integer: deletedOffset = 0\n\n  For Column = 1 To ActiveSheet.UsedRange.Columns(ActiveSheet.UsedRange.Columns.Count).Column\n    If (IsInArray(ActiveSheet.Cells(1, Column).Value, headingsToDelete)) Then\n      ActiveSheet.Columns(Column - deletedOffset).Delete\n      deletedOffset = deletedOffset + 1\n    End If\n  Next\nEnd Sub\n\nFunction IsInArray(stringToBeFound As String, arr As Variant) As Boolean\n  IsInArray = (UBound(Filter(arr, stringToBeFound)) &gt; -1)\nEnd Function\n</code></pre>\n\n<p>IsInArray function:\n<a href=\"https://stackoverflow.com/questions/11109832/how-to-find-if-an-array-contains-a-string\">How to find if an array contains a string</a></p>\n\n<p>last ued column: <a href=\"http://www.globaliconnect.com/excel/index.php?Itemid=475&amp;catid=79&amp;id=86:last-used-row-last-used-column-vba&amp;option=com_content&amp;view=article\" rel=\"nofollow noreferrer\">http://www.globaliconnect.com/excel/index.php?Itemid=475&amp;catid=79&amp;id=86:last-used-row-last-used-column-vba&amp;option=com_content&amp;view=article</a></p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 45, "user_id": 9089755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e76d80f84b129684d162a81a3d1e007?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/9089755/marc"}, "edited": false, "score": 0, "creation_date": 1524124353, "post_id": 49898097, "comment_id": 86846701, "body": "No problem.  Feel free to tick as the accepted answer if it is."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1524049378, "creation_date": 1524049378, "answer_id": 49898097, "question_id": 49896829, "link": "https://stackoverflow.com/questions/49896829/delete-excel-table-column-based-on-heading-name-in-a-list/49898097#49898097", "title": "Delete Excel table column based on heading name in a list", "body": "<p>If the headings only appear once you can use:  </p>\n\n<pre><code>Public Sub DeleteSpecificColumn()\n\n    Dim rngFound As Range, rngToDelete As Range\n    Dim rDeleteValue As Range\n    Dim fstCol As Long, lstCol As Long\n\n    With ThisWorkbook.Worksheets(\"Sheet1\") 'We're working with the workbook containing the code in \"Sheet1\".\n        For Each rDeleteValue In .ListObjects(\"Delete\").ListColumns(1).DataBodyRange\n            With .Range(\"D1\", .Cells(1, .Columns.Count).End(xlToLeft)) 'References D1 to last cell in row 1 containing data.\n                Set rngFound = .Find( _\n                    What:=CStr(rDeleteValue), _\n                    Lookat:=xlWhole, SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=True)\n                If Not rngFound Is Nothing Then\n                    If rngToDelete Is Nothing Then\n                        Set rngToDelete = rngFound\n                    Else\n                        Set rngToDelete = Application.Union(rngToDelete, rngFound)\n                    End If\n                End If\n                Set rngFound = Nothing\n            End With\n        Next rDeleteValue\n    End With\n\n    If Not rngToDelete Is Nothing Then rngToDelete.EntireColumn.Delete\n\nEnd Sub  \n</code></pre>\n\n<p>If the headings appear multiple times you can use:  </p>\n\n<pre><code>Public Sub DeleteSpecificColumn()\n\n    Dim rngFound As Range, rngToDelete As Range\n    Dim rDeleteValue As Range\n    Dim fstCol As Long, lstCol As Long\n    Dim sFirstAddress As String\n\n    With ThisWorkbook.Worksheets(\"Sheet1\") 'We're working with the workbook containing the code in \"Sheet1\".\n        For Each rDeleteValue In .ListObjects(\"Delete\").ListColumns(1).DataBodyRange\n            With .Range(\"D1\", .Cells(1, .Columns.Count).End(xlToLeft)) 'References D1 to last cell in row 1 containing data.\n                Set rngFound = .Find( _\n                    What:=CStr(rDeleteValue), _\n                    Lookat:=xlWhole, SearchOrder:=xlByColumns, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=True)\n\n                If Not rngFound Is Nothing Then\n                    sFirstAddress = rngFound.Address\n\n                    Do\n                        If rngToDelete Is Nothing Then\n                            Set rngToDelete = rngFound\n                        Else\n                            Set rngToDelete = Application.Union(rngToDelete, rngFound)\n                        End If\n\n                        Set rngFound = .FindNext(rngFound)\n                    Loop While rngFound.Address &lt;&gt; sFirstAddress\n                End If\n                Set rngFound = Nothing\n            End With\n        Next rDeleteValue\n    End With\n\n    If Not rngToDelete Is Nothing Then rngToDelete.EntireColumn.Delete\n\nEnd Sub  \n</code></pre>\n\n<p>Both sets of code start at <code>D1</code> and finish at the last column containing data (or formula).  The code <code>.Cells(1, .Columns.Count).End(xlToLeft)</code> is the same as going to cell <code>XFD1</code> and pressing <code>Ctrl+Left</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 9089755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e76d80f84b129684d162a81a3d1e007?s=128&d=identicon&r=PG&f=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/9089755/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 1, "accepted_answer_id": 49897794, "answer_count": 2, "score": 0, "last_activity_date": 1524051756, "creation_date": 1524045775, "last_edit_date": 1524045823, "question_id": 49896829, "link": "https://stackoverflow.com/questions/49896829/delete-excel-table-column-based-on-heading-name-in-a-list", "title": "Delete Excel table column based on heading name in a list", "body": "<p>I have a spreadsheet of data that has the best part of 120 columns of data in it of which I don't all of them, so for file size I delete the ones I do not need. I figured this could be automated and have put together a VB function based on a script I found online which checks column headings against a list of values and if that value is in the list, it deletes the column.</p>\n\n<p>As the column count in the spreadsheet changes due to updates, rather than fix the column reference in the code, I input a start and end column into two cells which the VB code reads but for some reason, I get an error when I select the exact column count. If I choose a smaller column count (ie: table is columns D:K and I choose D:F) the code runs fine and the columns are deleted. Can anyone maybe explain where the code is falling over as I am a newbie to VB.</p>\n\n<p>Many thanks.</p>\n\n<p>Here is the code I'm using and if I can figure out how to upload the example file I will do that as well:</p>\n\n<pre><code>Sub DeleteSpecifcColumn()\n\n    Dim rngFound As Range, rngToDelete As Range\n    Dim strFirstAddress, fstCol, LstCol As String\n    Dim varList As Variant\n    Dim lngCounter As Long\n\n    fstCol = ActiveSheet.Range(\"B2\").Value\n    LstCol = ActiveSheet.Range(\"B3\").Value\n\n    Application.ScreenUpdating = False\n\n    'varList = Range(\"Sheet1!B3:B8\").Value\n    varList = ActiveSheet.ListObjects(\"Delete\").ListColumns(1).DataBodyRange\n\n    For lngCounter = LBound(varList) To UBound(varList)\n\n        'Fixed column range\n        'With ActiveSheet.Range(\"E:F\")\n\n        'Using table headings\n        'With ActiveSheet.ListObjects(\"Content\").HeaderRowRange\n\n        'Cell values on sheet to build column range and then search against list\n        With ActiveSheet.Range(vbDblQuote &amp; fstCol &amp; \":\" &amp; LstCol &amp; vbDblQuote)\n        Set rngFound = .Find( _\n                                What:=varList(lngCounter, 1), _\n                                Lookat:=xlWhole, _\n                                SearchOrder:=xlByColumns, _\n                                SearchDirection:=xlNext, _\n                                MatchCase:=True _\n                                    )\n\n            If Not rngFound Is Nothing Then\n                If rngToDelete Is Nothing Then\n                    Set rngToDelete = rngFound\n                Else\n                    Set rngToDelete = Application.Union(rngToDelete, rngFound)\n                End If\n\n                strFirstAddress = rngFound.Address\n                Set rngFound = .FindNext(After:=rngFound)\n\n                Do Until rngFound.Address = strFirstAddress\n                    Set rngToDelete = Application.Union(rngToDelete, rngFound)\n                    Set rngFound = .FindNext(After:=rngFound)\n                Loop\n            End If\n        End With\n    Next lngCounter\n\n    If Not rngToDelete Is Nothing Then rngToDelete.EntireColumn.Delete\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "selenium-webdriver", "web-scraping"], "comments": [{"owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "edited": false, "score": 0, "creation_date": 1524057173, "post_id": 49896428, "comment_id": 86816659, "body": "QHarr is this solved?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "edited": false, "score": 0, "creation_date": 1524057281, "post_id": 49896428, "comment_id": 86816739, "body": "@drec4s Not as yet.  I can see how anonygoose &#39;s suggestion might work but I have been unable to implement in a loop with .Click (including with ignoring errors)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1524057651, "post_id": 49896428, "comment_id": 86817013, "body": "Not really an answer because I&#39;m just directing you to other questions with the answer, but you need to get yourself to the right frame to find the element to click. Look at my question <a href=\"https://stackoverflow.com/questions/43808508/driving-a-website-using-vba-and-selenium\">here</a> and the follow up question <a href=\"https://stackoverflow.com/questions/43873072/driving-a-website-using-vba-and-selenium-pt2\">here</a>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1524057702, "post_id": 49896428, "comment_id": 86817048, "body": "@FreeMan Thanks. Will do."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524054567, "post_id": 49899600, "comment_id": 86814857, "body": "Hi, So how would I deploy this? I tried  bot.FindElementByXPath (&quot;//span[contains(text(), &#39;Next Page&#39;)]&quot;).Click but that didn&#39;t work. Runtime error 13. Could I use css to try and reach this?"}, {"owner": {"reputation": 696, "user_id": 475725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e91aeeecefe6d9815d33631570c500?s=128&d=identicon&r=PG", "display_name": "anonygoose", "link": "https://stackoverflow.com/users/475725/anonygoose"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524054732, "post_id": 49899600, "comment_id": 86814975, "body": "If it&#39;s the same text as the runtime error shown in your question, I would say you need to add some kind of wait before clicking the button.  The error seems to suggest something may be overlapping it for a period of time.  Try adding a 5 second wait and seeing if it helps.  If it does, you may need to research VBA/Selnium Basic waits.  The error you posted says something like &quot;Not clickable.  Other element &lt;element&gt; would receive the click&quot;"}, {"owner": {"reputation": 696, "user_id": 475725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e91aeeecefe6d9815d33631570c500?s=128&d=identicon&r=PG", "display_name": "anonygoose", "link": "https://stackoverflow.com/users/475725/anonygoose"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524055003, "post_id": 49899600, "comment_id": 86815170, "body": "That sounds like you&#39;re doing a FindElementsByClass somewhere and using spaces in the class.  E.g. bot.FindElementsByClass(&quot;this does not work in selenium webdriver&quot;);"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524055074, "post_id": 49899600, "comment_id": 86815219, "body": "Sorry. I deleted comment because I realised that. I am getting the same error 13 element not clickable at..... I introduced up to 10 second wait times."}, {"owner": {"reputation": 696, "user_id": 475725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e91aeeecefe6d9815d33631570c500?s=128&d=identicon&r=PG", "display_name": "anonygoose", "link": "https://stackoverflow.com/users/475725/anonygoose"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524055290, "post_id": 49899600, "comment_id": 86815361, "body": "So I think what&#39;s going on is the behaviour where articles load as you go further down the page.  As WebDriver reaches the bottom of the page, the last article that loads up moves up and over the navigation buttons.  I think WebDriver is only reaching the bottom of the page when you tell it to click the navigation link, so the wait isn&#39;t working.  You need to be at the bottom of the page before the click command, basically.  That way all articles will have loaded, and nothing will be above the navigation links.  At this point, I feel like your bodge of loading the pages via URL may be easiest."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 696, "user_id": 475725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e91aeeecefe6d9815d33631570c500?s=128&d=identicon&r=PG", "display_name": "anonygoose", "link": "https://stackoverflow.com/users/475725/anonygoose"}, "edited": false, "score": 0, "creation_date": 1524055365, "post_id": 49899600, "comment_id": 86815408, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/169243/discussion-between-qharr-and-anonygoose\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 696, "user_id": 475725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e91aeeecefe6d9815d33631570c500?s=128&d=identicon&r=PG", "display_name": "anonygoose", "link": "https://stackoverflow.com/users/475725/anonygoose"}, "is_accepted": false, "score": 1, "last_activity_date": 1524054106, "creation_date": 1524054106, "answer_id": 49899600, "question_id": 49896428, "link": "https://stackoverflow.com/questions/49896428/loop-over-a-set-of-pages-with-selenium-basic-vba/49899600#49899600", "title": "Loop over a set of pages with Selenium Basic (VBA)", "body": "<p>If you're only interested in clicking through each of the pages (and getting the number of pages is just an aid to doing this) then you should be able to click this element until it's no longer there:</p>\n\n<pre><code>&lt;span class=\"screen-reader-text\"&gt;Next Page&lt;/span&gt;\n</code></pre>\n\n<p>Using </p>\n\n<pre><code>bot.FindElementByXpath(\"//span[contains(text(), 'Next Page')]\")\n</code></pre>\n\n<p>Have a loop click that link on each page load.  Eventually it wont be there.  Then use VBA's error/exception handling to handle whatever the equivalent of NoSuchElementException is in this implementation of WebDriver.  You will need to re-find the element each time in the loop.</p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524058116, "post_id": 49900825, "comment_id": 86817355, "body": "Awesome. I can understand this and see how to apply in future."}], "tags": [], "owner": {"reputation": 7231, "user_id": 4915798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb8af3ae95300addb5dfa2e6cb5940c3?s=128&d=identicon&r=PG&f=1", "display_name": "afonso", "link": "https://stackoverflow.com/users/4915798/afonso"}, "is_accepted": true, "score": 3, "last_activity_date": 1524057655, "creation_date": 1524057655, "answer_id": 49900825, "question_id": 49896428, "link": "https://stackoverflow.com/questions/49896428/loop-over-a-set-of-pages-with-selenium-basic-vba/49900825#49900825", "title": "Loop over a set of pages with Selenium Basic (VBA)", "body": "<p>To <code>click</code> the element, it must be visible in the screen, so you need to scroll to the bottom of the page first (selenium might do this implicitly some times, but I don't find it reliable).</p>\n\n<p>Try this:</p>\n\n<pre><code>Option Explicit\nPublic Sub scrapeCIL()\n    Dim bot As New WebDriver, btn As Object, i As Long, pageCount As Long\n\n    bot.Start \"chrome\", \"https://codingislove.com\"\n    bot.Get \"/\"\n    pageCount = bot.FindElementsByClass(\"page-numbers\").Count\n\n    For i = 1 To pageCount\n\n        bot.ExecuteScript (\"window.scrollTo(0,document.body.scrollHeight);\")\n\n        Application.wait Now + TimeValue(\"00:00:02\")\n\n        On Error Resume Next\n        Set btn = bot.FindElementByCss(\"a[class='next page-numbers']\")\n        If btn.IsPresent = True Then\n            btn.Click\n        End If\n        On Error GoTo 0\n\n    Next i\n\n    bot.Quit\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524066522, "post_id": 49903514, "comment_id": 86823637, "body": "Nice. I think it get&#39;s to page 3, the ... pages and errors out but I can see how to use this. +1"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524066659, "post_id": 49903514, "comment_id": 86823738, "body": "Would be very nice if there was any option for <code>Explicit Wait</code> instead of <code>Hardcoded Delay</code>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524066855, "post_id": 49903514, "comment_id": 86823863, "body": "I have only just started with selenium. Don&#39;t some of the methods allow for an explicit wait? Or is that just timeout wait?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524066994, "post_id": 49903514, "comment_id": 86823956, "body": "Vba with selenium binding doesn&#39;t have that option. On the other hand, the <code>explicit wait option</code> is available when it binds with python."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524067058, "post_id": 49903514, "comment_id": 86824003, "body": "At some point I will have to start combing your Python answers. I have let that side of things slip."}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 1, "last_activity_date": 1524065106, "creation_date": 1524065106, "answer_id": 49903514, "question_id": 49896428, "link": "https://stackoverflow.com/questions/49896428/loop-over-a-set-of-pages-with-selenium-basic-vba/49903514#49903514", "title": "Loop over a set of pages with Selenium Basic (VBA)", "body": "<p>How about trying like this? Few days back I could figure out that there is an option <code>.SendKeys(\"keys.END\")</code> which will lead you to the bottom of a page so that the driver can reach out the expected element to click. I used <code>If Err.Number &lt;&gt; 0 Then Exit Do</code> within the <code>do loop</code> so that if the scraper encounters any error, it will break out of loop as in, <code>element not found error</code> in this case when the clicking on the <code>last page</code> button is done.</p>\n\n<p>Give this a shot:</p>\n\n<pre><code>Sub GetItems()\n    Dim pagenum As Object\n\n    With New ChromeDriver\n        .get \"https://codingislove.com/\"\n\n        Do\n            On Error Resume Next\n            Set pagenum = .FindElementByCss(\"a.next\")\n            pagenum.SendKeys (\"Keys.END\")\n            Application.Wait Now + TimeValue(\"00:00:03\")\n            pagenum.Click\n            If Err.Number &lt;&gt; 0 Then Exit Do\n            On Error GoTo 0\n        Loop\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<p>Reference to add to the library:</p>\n\n<pre><code>Selenium Type Library\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1585230990, "last_edit_date": 1585230990, "creation_date": 1524209064, "answer_id": 49936249, "question_id": 49896428, "link": "https://stackoverflow.com/questions/49896428/loop-over-a-set-of-pages-with-selenium-basic-vba/49936249#49936249", "title": "Loop over a set of pages with Selenium Basic (VBA)", "body": "<p>Similar principle:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetItems()\n    Dim i As Long\n\n    With New ChromeDriver\n        .Get \"https://codingislove.com/\"\n\n        For i = 1 To 6\n            .FindElementByXPath(\"//*[@id=\"\"main\"\"]/nav/div/a[3]\").SendKeys (\"Keys.PageDown\")\n\n            Application.Wait Now + TimeValue(\"00:00:02\")\n            On Error Resume Next\n            .FindElementByCss(\"a.next\").Click\n            On Error GoTo 0\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>Reference:</p>\n\n<p>'<a href=\"http://seleniumhome.blogspot.co.uk/2013/07/how-to-press-keyboard-in-selenium.html\" rel=\"nofollow noreferrer\">http://seleniumhome.blogspot.co.uk/2013/07/how-to-press-keyboard-in-selenium.html</a></p>\n"}], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2967, "favorite_count": 1, "accepted_answer_id": 49900825, "answer_count": 4, "score": 4, "last_activity_date": 1585230990, "creation_date": 1524044700, "last_edit_date": 1557478240, "question_id": 49896428, "link": "https://stackoverflow.com/questions/49896428/loop-over-a-set-of-pages-with-selenium-basic-vba", "title": "Loop over a set of pages with Selenium Basic (VBA)", "body": "<p><strong>Task:</strong></p>\n\n<p>So my first foray into Selenium and I am attempting to:</p>\n\n<ol>\n<li>Find the number of pages in a pagination set listed at the bottom of <a href=\"https://codingislove.com/\" rel=\"nofollow noreferrer\">https://codingislove.com/</a>    This is purely to support task 2 by determining the loop end.</li>\n<li>Loop over them</li>\n</ol>\n\n<p>I believe these are linked but for those that want a <strong>single</strong> issue. I simply want to find the correct collection and loop over it to load each page.</p>\n\n<p>The number of pages is, at time of writing, 6 as seen at the bottom of the webpage and shown below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4iGVB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4iGVB.png\" alt=\"Pagination set\"></a></p>\n\n<p>As an MCVE I simply want to find the number of pages and click my way through them. Using Selenium Basic.</p>\n\n<p><strong>What I have tried:</strong></p>\n\n<p>I have read through a number of online resources, I have listed but a few in references.  </p>\n\n<p><strong>Task 1)</strong> </p>\n\n<p>It seems that I should be able to find the count of pages using the <code>Size</code> property. But I can't seem to find the right object to use this with. I have made a number of attempts; a few shown below:</p>\n\n<pre><code>bot.FindElementsByXPath(\"//*[@id=\"\"main\"\"]/nav/div/a[3]\").Size '&lt;==this I think is too specific\nbot.FindElementsByClass(\"page-numbers\").Size\n</code></pre>\n\n<p>But these yield the run-time error 438: </p>\n\n<blockquote>\n  <p>\"Object does not support this property or method\"</p>\n</blockquote>\n\n<p>And the following doesn't seem to expose the required methods:</p>\n\n<pre><code>bot.FindElementByCss(\".navigation.pagination\")\n</code></pre>\n\n<p>I have fudged with </p>\n\n<pre><code>bot.FindElementsByClass(\"page-numbers\").Count + 1 \n</code></pre>\n\n<p>But would like something more robust</p>\n\n<p><strong>Task 2)</strong> </p>\n\n<p>I know that I can navigate to the next page, from page 1, with:</p>\n\n<pre><code>bot.FindElementByXPath(\"//*[@id=\"\"main\"\"]/nav/div/a[3]\").Click\n</code></pre>\n\n<p>But I can't use this in a loop presumably because the XPath needs to be updated.\nIf not updated it leads to a runtime error 13.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4wDfL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4wDfL.png\" alt=\"Run-time error 13\"></a></p>\n\n<p>As the re-directs follow a general pattern of </p>\n\n<pre><code>href=\"https://codingislove.com/page/pageNumber/\"\n</code></pre>\n\n<p>I can again fudge my way through by constructing each URL in the loop with</p>\n\n<pre><code>bot.Get \"https://codingislove.com/page/\" &amp; i &amp; \"/\"\n</code></pre>\n\n<p>But I would like something more robust.</p>\n\n<p><strong>Question:</strong></p>\n\n<p><strong>How do I loop over the pagination set in a robust fashion using selenium?</strong> Sure I am having a dense day and that there should be an easy to target  appropriate collection to loop over.</p>\n\n<p><strong>Code</strong> - My current attempt </p>\n\n<pre><code>Option Explicit\nPublic Sub scrapeCIL()\n    Dim bot As New WebDriver, i As Long, pageCount As Long\n\n    bot.Start \"chrome\", \"https://codingislove.com\"\n    bot.Get \"/\"\n    pageCount = bot.FindElementsByClass(\"page-numbers\").Count + 1 '\n\n    For i = 1 To pageCount 'technically can loop from 2 I know!\n      ' bot.FindElementByXPath(\"//*[@id=\"\"main\"\"]/nav/div/a[3]\").Click 'runtime error 13\n       ' bot.FindElementByXPath(\"//*[@id=\"\"main\"\"]/nav/div/a[2]/span\").Click ''runtime error 13\n        bot.Get \"https://codingislove.com/page/\" &amp; i &amp; \"/\"\n    Next i\n\n    Stop\n\n    bot.Quit\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Any supported browser will do. It doesn't have to be Chrome.</p>\n\n<p><strong>References:</strong></p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/35036286/finding-the-number-of-pagination-buttons-in-selenium-webdriver?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">Finding the number of pagination buttons in Selenium WebDriver</a></li>\n<li><a href=\"http://seleniumhome.blogspot.co.uk/2013/07/how-can-we-automate-pagination-using.html\" rel=\"nofollow noreferrer\">http://seleniumhome.blogspot.co.uk/2013/07/how-can-we-automate-pagination-using.html</a></li>\n</ol>\n\n<p><strong>Requirements:</strong></p>\n\n<ol>\n<li><strong><a href=\"https://github.com/florentbr/SeleniumBasic\" rel=\"nofollow noreferrer\">Selenium Basic</a></strong> </li>\n<li><a href=\"https://sites.google.com/a/chromium.org/chromedriver/downloads\" rel=\"nofollow noreferrer\">ChromeDriver 2.37</a> 'Or use IE but zoom must be at 100%</li>\n<li>VBE Tools > references > Selenium type library</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9663273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Jjjpug4bLJs/AAAAAAAAAAI/AAAAAAAAARk/g-N4fRusMe4/photo.jpg?sz=128", "display_name": "Misbah Azeez", "link": "https://stackoverflow.com/users/9663273/misbah-azeez"}, "edited": false, "score": 0, "creation_date": 1524546357, "post_id": 49896213, "comment_id": 87003834, "body": "However I have lots of worksheets, I want a code to do this for me."}], "tags": [], "owner": {"reputation": 16, "user_id": 6262535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363f8b3162bccf79eb095b8600e3b9d5?s=128&d=identicon&r=PG&f=1", "display_name": "Dani M", "link": "https://stackoverflow.com/users/6262535/dani-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1524044137, "creation_date": 1524044137, "answer_id": 49896213, "question_id": 49895995, "link": "https://stackoverflow.com/questions/49895995/excel-vba-code-to-index-all-worksheet-names-with-hyperlinks-in-a-rectangular-s/49896213#49896213", "title": "Excel VBA code to index all worksheet names with hyperlinks - in a rectangular shape (button sort of)", "body": "<p>You can do a cycle for each worksheet taking the names and create the button you want considering the names...</p>\n\n<pre><code>Dim ws As Worksheet\nFor Each ws In ActiveWorkbook.Worksheets\n    Call button(ws)\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9663273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Jjjpug4bLJs/AAAAAAAAAAI/AAAAAAAAARk/g-N4fRusMe4/photo.jpg?sz=128", "display_name": "Misbah Azeez", "link": "https://stackoverflow.com/users/9663273/misbah-azeez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524044139, "creation_date": 1524043539, "last_edit_date": 1524044139, "question_id": 49895995, "link": "https://stackoverflow.com/questions/49895995/excel-vba-code-to-index-all-worksheet-names-with-hyperlinks-in-a-rectangular-s", "title": "Excel VBA code to index all worksheet names with hyperlinks - in a rectangular shape (button sort of)", "body": "<p>Hi I am trying to write a VBA code which will help me index all the worksheet name with hyperlinks. However I do not want just the name of the worksheet written on the cell. I want all the names of the worksheet on a rectangular shape, one below the other. when you click on the shape with the worksheet name on it, it will take you to the worksheet Cell A1. \nAlso in other worksheets, a similar rectangular box that says \"back to index\" which is linked to the index page.</p>\n\n<p>Is there someone who can help me write such a code as i have almost 70 worksheets in a workbook and i am dying trying to do this manually.</p>\n\n<p>below is the specifications of the rectangular box:</p>\n\n<pre><code>Sub button()\n    ActiveSheet.Shapes.AddShape(msoShapeRectangle, 96.75, 90, 94.5, 21).Select\n    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text = \"Sheet3\"\n\n    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 6). _\n        ParagraphFormat\n        .FirstLineIndent = 0\n        .Alignment = msoAlignLeft\n    End With\n\n    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 6).Font\n        .NameComplexScript = \"+mn-cs\"\n        .NameFarEast = \"+mn-ea\"\n        .Fill.Visible = msoTrue\n        .Fill.ForeColor.ObjectThemeColor = msoThemeColorLight1\n        .Fill.ForeColor.TintAndShade = 0\n        .Fill.ForeColor.Brightness = 0\n        .Fill.Transparency = 0\n        .Fill.Solid\n        .Size = 11\n        .Name = \"+mn-lt\"\n    End With\n\n    Range(\"D9\").Select\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/hdbzG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hdbzG.jpg\" alt=\"Image of the look of the buttons, click here\"></a></p>\n"}, {"tags": ["vba", "excel", "business-objects"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1524081961, "post_id": 49895592, "comment_id": 86832186, "body": "I don&#39;t see in your code where you set <code>Application.EnableEvents = False</code>. Having a global variable <code>EnableEvents</code> is not the same thing."}, {"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1524138898, "post_id": 49895592, "comment_id": 86856417, "body": "Yes I know. I got rid of that code before I posted the snippets."}], "answers": [{"comments": [{"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1524050851, "post_id": 49895693, "comment_id": 86812448, "body": "This is a good workaround which I thought about initially! I was hoping for a more robust implementation by setting VBA event properties but this will do the trick. If there&#39;s no other answer with a more robust solution I will mark this as the correct answer. Thanks"}, {"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1524052322, "post_id": 49895693, "comment_id": 86813467, "body": "I implemented this in a way that the I set EventsEnabled to False as soon as the prompt appears and change it  to True after the ribbon is set in the ribbon onLoad. The problem now is that when I spam click, the ribbon onLoad is not executed at all."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1524052957, "post_id": 49895693, "comment_id": 86813869, "body": "Can you post any of your code? One of the main problems with customising the ribbon is it is very poorly documented."}, {"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1524054336, "post_id": 49895693, "comment_id": 86814695, "body": "please see my edited post - I added some code. I hope it helps. Thank you for responding so quickly btw."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1524054518, "post_id": 49895693, "comment_id": 86814811, "body": "Can you have a look at my update. I think from your code the issue is is that you&#39;re losing it&#39;s memory allocation when you invalidate it. It&#39;s difficult to debug the Ribbon as the debugger doesn&#39;t really work with it though"}, {"owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "edited": false, "score": 0, "creation_date": 1524055480, "post_id": 49895693, "comment_id": 86815470, "body": "Thanks! I will look into it. I actually haven&#39;t written this code. From what I know it was provided by SAP and was modified by some of my colleagues but investigating the issue is now assigned to me so I have to figure it out. Keep in mind that I will not be able to invalidate the ribbon until it&#39;s set because the if statement in Workbook_SheetActivate assures that the ribbon reference is set before invalidating. I think the issue is even more perverted!"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1524054379, "last_edit_date": 1524054379, "creation_date": 1524042739, "answer_id": 49895693, "question_id": 49895592, "link": "https://stackoverflow.com/questions/49895592/vba-how-to-temporarily-disable-the-worksheet-activate-event/49895693#49895693", "title": "VBA - How to temporarily disable the Worksheet.Activate Event?", "body": "<p>This probably isn't the best solution but is a work around.</p>\n\n<p>You could use a global variable to handle it.</p>\n\n<p>Place something like the following in a module</p>\n\n<pre><code>Public EventsEnabled As Boolean\nPublic Sub ModuleWithDisabledEvents()\n    EventsEnabled = False\n    Debug.Print EventsEnabled\n    EventsEnabled = True\n    Debug.Print EventsEnabled\nEnd Sub\n</code></pre>\n\n<p>and then on your worksheet activation wrap your <code>Activate</code> code in an if block that looks at this variable</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    If Not EventsEnabled Then\n        ' Do activate code here\n    End If\nEnd Sub\n</code></pre>\n\n<p>By changing the <code>EventsEnabled</code> variable you can get your code to ignore your <code>Activate</code> procedure even if events are enabled.</p>\n\n<hr>\n\n<p><strong>UPDATE</strong>:\nWhat are you doing with the Ribbon? This is how I've implemented custom ribbons in the past and haven't experienced your issue:</p>\n\n<p>In my XML File I have the following:</p>\n\n<pre><code>&lt;customUI onLoad=\"RibbonOnLoad\" xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n    &lt;ribbon startFromScratch=\"false\"&gt;\n        &lt;tabs&gt;\n            &lt;tab id=\"customTab\" label=\"Custom Tab\"&gt;\n                &lt;group id=\"customGroup\" label=\"Custom Group\"&gt;\n                    &lt;button id=\"customButton\" label=\"Custom Button\" imageMso=\"HappyFace\" size=\"large\" onAction=\"Callback\" getVisible=\"GetVisible\" /&gt;\n                &lt;/group&gt;\n            &lt;/tab&gt;\n        &lt;/tabs&gt;\n    &lt;/ribbon&gt;\n&lt;/customUI&gt;\n</code></pre>\n\n<p>Then in my file I have a module named 'Ribbon' which contains:</p>\n\n<pre><code>Option Explicit\nOption Private Module\nDim rib As IRibbonUI\n\nPrivate Declare Function ShellExecute _\n                         Lib \"shell32.dll\" Alias \"ShellExecuteA\" ( _\n                         ByVal hWnd As Long, _\n                         ByVal Operation As String, _\n                         ByVal Filename As String, _\n                         Optional ByVal Parameters As String, _\n                         Optional ByVal Directory As String, _\n                         Optional ByVal WindowStyle As Long = vbMinimizedFocus _\n                         ) As Long\n\n#If VBA7 Then\n    Public Declare PtrSafe Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (ByRef Destination As Any, ByRef Source As Any, ByVal Length As Long)\n#Else\n    Public Declare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (ByRef Destination As Any, ByRef Source As Any, ByVal Length As Long)\n#End If\n#If VBA7 Then\nFunction GetRibbon(ByVal lRibbonPointer As LongPtr) As Object\n#Else\nFunction GetRibbon(ByVal lRibbonPointer As Long) As Object\n#End If\nDim objRibbon As Object\nCopyMemory objRibbon, lRibbonPointer, LenB(lRibbonPointer)\nSet GetRibbon = objRibbon\nSet objRibbon = Nothing\nEnd Function\nPublic Sub RibbonOnLoad(ribbon As IRibbonUI)\n    Set rib = ribbon\n    Debug.Print \"ribbon:-\", ObjPtr(ribbon)\n    Sheet2.Cells(1, 1).Value = ObjPtr(ribbon)\nEnd Sub\nPublic Sub RefreshRibbon()\n    On Error GoTo RibbonError\n    If rib Is Nothing Then\n        Set rib = GetRibbon(Sheet2.Cells(1, 1).Value)\n        If rib Is Nothing Then GoTo RibbonError\n    Else\n        rib.Invalidate\n        Exit Sub\n    End If\n    Exit Sub\nRibbonError:\n    Debug.Print \"There is an issue with the menu bar. Please restart the tool\"\nEnd Sub\n\nPublic Sub GetVisible(control As IRibbonControl, ByRef visible)\n    visible = True\nEnd Sub\n</code></pre>\n\n<p>When the ribbon loads it sets it's memory value to <code>Sheet2</code> which it then uses to reload when it Refreshes the ribbon running <code>RefreshRibbon</code></p>\n"}, {"tags": [], "owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "is_accepted": true, "score": 0, "last_activity_date": 1524139363, "creation_date": 1524139363, "answer_id": 49920637, "question_id": 49895592, "link": "https://stackoverflow.com/questions/49895592/vba-how-to-temporarily-disable-the-worksheet-activate-event/49920637#49920637", "title": "VBA - How to temporarily disable the Worksheet.Activate Event?", "body": "<p>The problem was resolved by disabling the mouse events using <code>Application.interactive = False</code> before the selection prompt loads or the first time and re-enabling them when the ribbon has loaded. The problem was that SAP decided to use a different callback for the very first prompt called <code>onBeforeFirstPromptsDisplay</code>.As a result, my changes to the prompt callback that's in the workbook were never actually triggered because that callback is only executed when you trigger the prompt yourself through the workbook. After implementing <code>onBeforeFirstPromptsDisplay</code> everything worked. \nThanks for your input!</p>\n"}], "owner": {"reputation": 428, "user_id": 1337436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a08c4627413437f2cce94e06e8ea8d92?s=128&d=identicon&r=PG", "display_name": "ribarcheto94", "link": "https://stackoverflow.com/users/1337436/ribarcheto94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3092, "favorite_count": 0, "accepted_answer_id": 49920637, "answer_count": 2, "score": 0, "last_activity_date": 1524139363, "creation_date": 1524042478, "last_edit_date": 1524054302, "question_id": 49895592, "link": "https://stackoverflow.com/questions/49895592/vba-how-to-temporarily-disable-the-worksheet-activate-event", "title": "VBA - How to temporarily disable the Worksheet.Activate Event?", "body": "<p>I'm working on an Excel workbook that uses SAP's BusinessObjects Analysis plug-in. Whenever the workbook opens, a variable selection prompt is triggered and allows users to enter values which are then used to select data from the back-end and display it in a table format in Excel(a representation of the SAP BW Query in Excel). The problem I'm facing is the following...\nWhenever the prompt selection is complete and the selection is being processed, if you spam click the worksheet tabs you fire the <code>Worksheet.Activate</code> event. The problem is that <code>Worksheet.Activate</code> handler tries to invalidate a ribbon object which itself has not been set yet. I want to prevent that and I would like the ribbon to be invalidated only if it has been set. The problem is that the ribbon must be invalidated when the worksheet is changed in order for it to load the specific buttons in the ribbon that are unique for every worksheet. Not invalidating on activating the worksheet is not an option. It would be best to eliminate the possibility of changing worksheets, before our custom ribbon has loaded. </p>\n\n<p>Here's what I have tried without any success:</p>\n\n<ol>\n<li><p>I tried disabling interactive mode with <code>Application.Interactive = False</code> as soon as the prompt appears and re-enabling it whenever the  <code>AOCust_OnLoad(ribbon As IRibbonUI)</code> ribbon <code>onLoad</code> callback has been executed and the ribbon is set.</p></li>\n<li><p>I tried disabling all events using <code>Application.EnableEvents = False</code> as soon as the prompt appears and re-enabling them whenever the ribbon <code>onLoad</code> callback has been executed and the ribbon is set.</p></li>\n<li><p>I tried adding the following to the <code>Worksheet.Activate</code> callback but it never exits the infinite loop which is probably expected because ribbon onLoad is not a system event and is thus never triggered.</p>\n\n<pre><code>while ribbon is Nothing\n  'waiting for ribbon onload to fire and set the value\n  DoEvents\nwend\n</code></pre></li>\n</ol>\n\n<p>What is surprising with the second case is how the <code>Worksheet.Activate</code> event is fired when the events, to my understanding, are disabled.</p>\n\n<p>Do you have any idea of how I can approach this problem so that the user cannot change the worksheet before the ribbon has been set?</p>\n\n<p>Please let me know if you would like me to add code snippets to this description.</p>\n\n<p>Thanks</p>\n\n<p>EDIT - CODE ADDED</p>\n\n<p>In Microsoft Excel Objects in ThisWorkbook</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\n  If EnableEvents = True Then\n      Debug.Print \"invalidate\"\n      Call AOCust_Callbacks.AOCust_InvalidateRibbon\n  End If\nEnd Sub\n</code></pre>\n\n<p>In Module \"Custom_Ribbon\"</p>\n\n<pre><code>'Callback for Selections data onAction\n Sub PROMPT(control As IRibbonControl)\n   EnableEvents = False\n   'more prompt-related code\n End Sub\n</code></pre>\n\n<p>In Module 'AOCust_Callbacks\"</p>\n\n<pre><code>Public EnableEvents As Boolean\n\n'Callback for Ribbon OnLoad\nSub AOCust_OnLoad(ribbon As IRibbonUI)\n  Debug.Print \"setting the ribbon\"\n  'Start Highlighting for Workbook\n  StartHighlighting\n  Set AOCustRibbon = ribbon\n  Debug.Print \"the ribbon is now set\"\n  EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>When I spam click the worksheet tabs as soon as the prompt selection is complete and the selection is still processing, I no longer get the problem with the variable not being set when I try to invalidate the ribbon because of the if statement, but the problem is that the onload ribbon function is not executed.  </p>\n"}, {"tags": ["excel", "vba", "csv", "zip"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1524043464, "post_id": 49895541, "comment_id": 86807144, "body": "yeah I&#39;ve had asynchronous issues with this, I&#39;d persist with waiting and polling."}], "answers": [{"tags": [], "owner": {"reputation": 1286, "user_id": 5197034, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/55947b72a5972c1daecceb9c23a1107c?s=128&d=identicon&r=PG&f=1", "display_name": "pietz", "link": "https://stackoverflow.com/users/5197034/pietz"}, "is_accepted": false, "score": 0, "last_activity_date": 1524053795, "creation_date": 1524053795, "answer_id": 49899502, "question_id": 49895541, "link": "https://stackoverflow.com/questions/49895541/zip-csv-file-using-excel-vba/49899502#49899502", "title": "Zip CSV File using Excel VBA", "body": "<p>Wrapping <code>FilePathCSV</code> in a <code>Dir()</code> function solved my problem. I'm not sure why though.</p>\n"}], "owner": {"reputation": 1286, "user_id": 5197034, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/55947b72a5972c1daecceb9c23a1107c?s=128&d=identicon&r=PG&f=1", "display_name": "pietz", "link": "https://stackoverflow.com/users/5197034/pietz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 384, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524053795, "creation_date": 1524042303, "question_id": 49895541, "link": "https://stackoverflow.com/questions/49895541/zip-csv-file-using-excel-vba", "title": "Zip CSV File using Excel VBA", "body": "<p>I built a macro that writes a custom csv file to disk. I need to add the option to also save this file in a zipped format. I followed Ron de Bruins excellent <a href=\"https://www.rondebruin.nl/win/s7/win001.htm\" rel=\"nofollow noreferrer\">article</a> on the matter but face the problem that my zip file is empty.</p>\n\n<pre><code>NewZip (FilePathZip) 'creates an empty zip file\nSet objShell = CreateObject(\"Shell.Application\")\nobjShell.Namespace(FilePathZip).CopyHere FilePathCSV\n</code></pre>\n\n<p>FilePathZip is the full path to the new zip file I'm creating here. FilePathCSV is the full path to the CSV that was just saved to disk. Interestingly, when I switch out FilePathCSV for any other file that already exists before I run the macro, it works. Apparently, I only face this problem when trying to zip a file that was created during the runtime of the macro.</p>\n\n<p>I already checked if the CSV path is recognized by excel through Dir(FilePathCSV) and made sure that the file is closed after the writing process. I also tried adding timeouts (Wait()). I have no idea what the problem is.</p>\n"}, {"tags": ["xml", "vba", "excel", "xslt-2.0", "xpath-2.0"], "comments": [{"owner": {"reputation": 7038, "user_id": 1914902, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4afc2c0ace8a8195018ed2d3d05c6d90?s=128&d=identicon&r=PG", "display_name": "Joel M. Lamsen", "link": "https://stackoverflow.com/users/1914902/joel-m-lamsen"}, "edited": false, "score": 1, "creation_date": 1524042471, "post_id": 49895347, "comment_id": 86806423, "body": "try <code>&lt;xsl:output doctype-system=&quot;3B3_MS_R01_00_ShipmentStatusNotification.dtd&zwnj;&#8203;&quot;&#47;&gt;</code>"}, {"owner": {"reputation": 9, "user_id": 8758830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nGE9OG2PxNk/AAAAAAAAAAI/AAAAAAAAA38/UcvDR89FM8k/photo.jpg?sz=128", "display_name": "nyfin paul", "link": "https://stackoverflow.com/users/8758830/nyfin-paul"}, "reply_to_user": {"reputation": 7038, "user_id": 1914902, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4afc2c0ace8a8195018ed2d3d05c6d90?s=128&d=identicon&r=PG", "display_name": "Joel M. Lamsen", "link": "https://stackoverflow.com/users/1914902/joel-m-lamsen"}, "edited": false, "score": 0, "creation_date": 1524042608, "post_id": 49895347, "comment_id": 86806518, "body": "i tried that but not working"}, {"owner": {"reputation": 7038, "user_id": 1914902, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4afc2c0ace8a8195018ed2d3d05c6d90?s=128&d=identicon&r=PG", "display_name": "Joel M. Lamsen", "link": "https://stackoverflow.com/users/1914902/joel-m-lamsen"}, "edited": false, "score": 0, "creation_date": 1524042936, "post_id": 49895347, "comment_id": 86806765, "body": "Please see this (<a href=\"http://xsltfiddle.liberty-development.net/nc4NzQ2\" rel=\"nofollow noreferrer\">xsltfiddle.liberty-development.net/nc4NzQ2</a>)"}, {"owner": {"reputation": 6634, "user_id": 4214921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9sBcG.jpg?s=128&g=1", "display_name": "potame", "link": "https://stackoverflow.com/users/4214921/potame"}, "edited": false, "score": 0, "creation_date": 1524045557, "post_id": 49895347, "comment_id": 86808797, "body": "Please provide the relevant parts of your XSL stylesheet."}, {"owner": {"reputation": 9, "user_id": 8758830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nGE9OG2PxNk/AAAAAAAAAAI/AAAAAAAAA38/UcvDR89FM8k/photo.jpg?sz=128", "display_name": "nyfin paul", "link": "https://stackoverflow.com/users/8758830/nyfin-paul"}, "reply_to_user": {"reputation": 6634, "user_id": 4214921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9sBcG.jpg?s=128&g=1", "display_name": "potame", "link": "https://stackoverflow.com/users/4214921/potame"}, "edited": false, "score": 0, "creation_date": 1524064533, "post_id": 49895347, "comment_id": 86822203, "body": "@potame check it now"}, {"owner": {"reputation": 6634, "user_id": 4214921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9sBcG.jpg?s=128&g=1", "display_name": "potame", "link": "https://stackoverflow.com/users/4214921/potame"}, "edited": false, "score": 1, "creation_date": 1524114167, "post_id": 49895347, "comment_id": 86841667, "body": "Well, that seems to work properly : <a href=\"http://xsltransform.net/jxN8Nq6\" rel=\"nofollow noreferrer\">xsltransform.net/jxN8Nq6</a>. Please explain what&#39;s wrong for you, what&#39;s your ouput? What XSLT processor are you using?"}, {"owner": {"reputation": 9, "user_id": 8758830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nGE9OG2PxNk/AAAAAAAAAAI/AAAAAAAAA38/UcvDR89FM8k/photo.jpg?sz=128", "display_name": "nyfin paul", "link": "https://stackoverflow.com/users/8758830/nyfin-paul"}, "reply_to_user": {"reputation": 6634, "user_id": 4214921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9sBcG.jpg?s=128&g=1", "display_name": "potame", "link": "https://stackoverflow.com/users/4214921/potame"}, "edited": false, "score": 0, "creation_date": 1524125800, "post_id": 49895347, "comment_id": 86847561, "body": "@potame i am using one more macro to call the source file and template to make output please help me to understand if it have any issue"}, {"owner": {"reputation": 46640, "user_id": 317052, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GaULO.jpg?s=128&g=1", "display_name": "Daniel Haley", "link": "https://stackoverflow.com/users/317052/daniel-haley"}, "edited": false, "score": 1, "creation_date": 1524153073, "post_id": 49895347, "comment_id": 86866427, "body": "Side note: MSXML2 does not support XSLT 2.0."}, {"owner": {"reputation": 9, "user_id": 8758830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nGE9OG2PxNk/AAAAAAAAAAI/AAAAAAAAA38/UcvDR89FM8k/photo.jpg?sz=128", "display_name": "nyfin paul", "link": "https://stackoverflow.com/users/8758830/nyfin-paul"}, "reply_to_user": {"reputation": 46640, "user_id": 317052, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GaULO.jpg?s=128&g=1", "display_name": "Daniel Haley", "link": "https://stackoverflow.com/users/317052/daniel-haley"}, "edited": false, "score": 0, "creation_date": 1524209182, "post_id": 49895347, "comment_id": 86887995, "body": "@DanielHaley : Thanks for your important note. help me to understand what i have change instead of MSXML2"}], "answers": [{"tags": [], "owner": {"reputation": 137436, "user_id": 415448, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/P2vVZ.png?s=128&g=1", "display_name": "Michael Kay", "link": "https://stackoverflow.com/users/415448/michael-kay"}, "is_accepted": false, "score": 0, "last_activity_date": 1524480129, "creation_date": 1524480129, "answer_id": 49979115, "question_id": 49895347, "link": "https://stackoverflow.com/questions/49895347/how-to-generate-doctype-xml-file-on-xslt/49979115#49979115", "title": "How to generate doctype XML file on XSLT", "body": "<p>The problem is that when you do</p>\n\n<pre><code>Source.transformNodeToObject StyleSheet, Result\nResult.Save resultFile\n</code></pre>\n\n<p>the serialization of the result tree is being done by the Result.Save operation, not by the XSLT transformation, and therefore it is being done without any knowledge of the xsl:output declaration. This is because Result is a DOM Document object, so the XSLT processor merely creates a DOM, which does not involve serialization.</p>\n\n<p>I'm not an expert in this particular transformation API but I think if you supply a Stream as the second argument of transformNodeToObject then it should work.</p>\n"}], "owner": {"reputation": 9, "user_id": 8758830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nGE9OG2PxNk/AAAAAAAAAAI/AAAAAAAAA38/UcvDR89FM8k/photo.jpg?sz=128", "display_name": "nyfin paul", "link": "https://stackoverflow.com/users/8758830/nyfin-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524480129, "creation_date": 1524041807, "last_edit_date": 1524218303, "question_id": 49895347, "link": "https://stackoverflow.com/questions/49895347/how-to-generate-doctype-xml-file-on-xslt", "title": "How to generate doctype XML file on XSLT", "body": "<p>I need to convert XML format into doctype XML format with the help of XSLT FILE. Source file is normal XML.</p>\n\n<p>As per my targeted file I need to get:</p>\n\n<p><code>&lt;!DOCTYPE Pip3B3ShipmentStatusNotification SYSTEM \"3B3_MS_R01_00_ShipmentStatusNotification.dtd\"&gt;</code></p>\n\n<p>My xslt code is given below</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"iso-8859-1\"?&gt;\n&lt;xsl:transform version=\"2.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"&gt;\n    &lt;xsl:output doctype-system=\"3B3_MS_R01_00_ShipmentStatusNotification.dtd\" encoding=\"UTF-8\"  indent=\"yes\"/&gt;\n    &lt;xsl:template match=\"/\"&gt;\n        &lt;Pip3B3ShipmentStatusNotification&gt;\n            &lt;fromRole&gt;\n                &lt;PartnerRoleDescription&gt;\n                    &lt;ContactInformation&gt;\n                        &lt;contactName&gt;\n                        &lt;/contactName&gt;\n                    &lt;/ContactInformation&gt;\n                &lt;/PartnerRoleDescription&gt;\n            &lt;/fromRole&gt;\n        &lt;/Pip3B3ShipmentStatusNotification&gt;\n    &lt;/xsl:template&gt;\n&lt;/xsl:transform&gt;\n</code></pre>\n\n<p>My macro given below, please check macro and let me know if it have any issue </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub dummy()\n\n    Call Transform(\"C:\\Users\\nypaul\\Desktop\\yves\\out\\source.xml\", \"C:\\Users\\nypaul\\Desktop\\yves\\out\\template\\template.xsl\", \"C:\\Users\\nypaul\\Desktop\\yves\\out\\output.xml\")\n\n    MsgBox \"ok\"\n\nEnd Sub\n\nFunction Transform(sourceFile, styleSheetFile, resultFile) As Boolean\n\n    Dim Source As Object\n    Dim StyleSheet As Object\n    Dim Result As Object\n\n    Set Source = CreateObject(\"MSXML2.DOMDocument\")\n    Set StyleSheet = CreateObject(\"MSXML2.DOMDocument\")\n    Set Result = CreateObject(\"MSXML2.DOMDocument\")\n\n    On Error GoTo TheEnd\n\n    Transform = True\n    Source.async = False\n    Source.Load sourceFile\n\n    StyleSheet.async = False\n    StyleSheet.Load styleSheetFile\n    Source.transformNodeToObject StyleSheet, Result\n    Result.Save resultFile\n    Exit Function\n\nTheEnd:\n    Transform = False\n\nEnd Function\n</code></pre>\n\n<p>How can I understand what is the error?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9355139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535a344a532f2a6c8f34881642e62092?s=128&d=identicon&r=PG&f=1", "display_name": "Noctis", "link": "https://stackoverflow.com/users/9355139/noctis"}, "edited": false, "score": 0, "creation_date": 1524065484, "post_id": 49895502, "comment_id": 86822961, "body": "Thanks for your answer. Another more urgent project has come up that requires my immediate attention, but when I return to this work I will try this solution :)"}, {"owner": {"reputation": 115, "user_id": 9355139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535a344a532f2a6c8f34881642e62092?s=128&d=identicon&r=PG&f=1", "display_name": "Noctis", "link": "https://stackoverflow.com/users/9355139/noctis"}, "edited": false, "score": 0, "creation_date": 1525876722, "post_id": 49895502, "comment_id": 87529807, "body": "Hi there - I&#39;ve finally returned to this. I&#39;ve used the code you&#39;ve provided and have partially extended it for 6 strings. However, I&#39;m struggling with the last bit. Please could you help with this?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 115, "user_id": 9355139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535a344a532f2a6c8f34881642e62092?s=128&d=identicon&r=PG&f=1", "display_name": "Noctis", "link": "https://stackoverflow.com/users/9355139/noctis"}, "edited": false, "score": 0, "creation_date": 1525876910, "post_id": 49895502, "comment_id": 87529958, "body": "please don&#39;t add code into comments. It&#39;s unreadable, and line breaks matter in VBA. Instead edit your original question and add it there."}, {"owner": {"reputation": 115, "user_id": 9355139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535a344a532f2a6c8f34881642e62092?s=128&d=identicon&r=PG&f=1", "display_name": "Noctis", "link": "https://stackoverflow.com/users/9355139/noctis"}, "edited": false, "score": 0, "creation_date": 1525877263, "post_id": 49895502, "comment_id": 87530215, "body": "Apologies - I&#39;ve updated the original question. Thank you!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 115, "user_id": 9355139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535a344a532f2a6c8f34881642e62092?s=128&d=identicon&r=PG&f=1", "display_name": "Noctis", "link": "https://stackoverflow.com/users/9355139/noctis"}, "edited": false, "score": 0, "creation_date": 1525878513, "post_id": 49895502, "comment_id": 87531034, "body": "@Noctis see my edit. For more sub strings it is easier to use an array. To get the starting point of a substring you need to add their length."}, {"owner": {"reputation": 115, "user_id": 9355139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535a344a532f2a6c8f34881642e62092?s=128&d=identicon&r=PG&f=1", "display_name": "Noctis", "link": "https://stackoverflow.com/users/9355139/noctis"}, "edited": false, "score": 0, "creation_date": 1525940956, "post_id": 49895502, "comment_id": 87554948, "body": "Thank you very much for your help! :)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 8, "last_activity_date": 1525878468, "last_edit_date": 1592644375, "creation_date": 1524042188, "answer_id": 49895502, "question_id": 49895205, "link": "https://stackoverflow.com/questions/49895205/bold-text-in-a-concatenate-formula/49895502#49895502", "title": "Bold text in a Concatenate formula", "body": "<p>You cannot format individual characters in a cell text if that cell contains a formula.<br />\nExcel doesn't support that.</p>\n<hr />\n<h3>Workaround</h3>\n<p>The only workaround is to write that cell text as <strong>constant text</strong> (with VBA) instead of a formula (if that meets your requirement).</p>\n<p>Then you can format individual characters with:</p>\n<pre><code>Range(&quot;A1&quot;).Characters(Start:=1, Length:=10).Font.Bold = True\n</code></pre>\n<p>So to partly format a string you could adjust the following example</p>\n<pre><code>Public Sub ExampleConcatenate()\n    Dim str1 As String, str2 As String, str3 As String\n    str1 = &quot;First string &quot;\n    str2 = &quot;Second string &quot;\n    str3 = &quot;Third string&quot;\n    \n    Range(&quot;A1&quot;).Value = str1 &amp; str2 &amp; str3 'concatenate strings\n    \n    'format bold starts 1 character after str1 and is as long as str2\n    Range(&quot;A1&quot;).Characters(Start:=Len(str1) + 1, Length:=Len(str2)).Font.Bold = True\nEnd Sub\n</code></pre>\n<hr />\n<p>For more sub strings it would be easier to use an array.</p>\n<pre><code>Public Sub ExampleConcatenate()\n    \n    Dim SubStrings As Variant\n    SubStrings = Array(&quot;First string &quot;, _\n                       &quot;Second string &quot;, _\n                       &quot;Third string &quot;, _\n                       &quot;Fourth string &quot;, _\n                       &quot;Fifth string &quot;, _\n                       &quot;Sixth string&quot;)\n\n    Range(&quot;A1&quot;).Value = Join(SubStrings, &quot;&quot;)\n\n    'Note array counting starts with 0 not 1 so &quot;First string&quot; is SubStrings(0)\n    \n    'format bold starts 1 character after str1 and is as long as str2\n    Range(&quot;A1&quot;).Characters(Start:=Len(SubStrings(0)) + 1, Length:=Len(SubStrings(1))).Font.Bold = True\n    'format sub string 4\n    Range(&quot;A1&quot;).Characters(Start:=Len(SubStrings(0)) + Len(SubStrings(1)) + Len(SubStrings(2)) + 1, Length:=Len(SubStrings(3))).Font.Bold = True\n    'format sub string 6\n    Range(&quot;A1&quot;).Characters(Start:=Len(SubStrings(0)) + Len(SubStrings(1)) + Len(SubStrings(2)) + Len(SubStrings(3)) + Len(SubStrings(4)) + 1, Length:=Len(SubStrings(5))).Font.Bold = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 9355139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/535a344a532f2a6c8f34881642e62092?s=128&d=identicon&r=PG&f=1", "display_name": "Noctis", "link": "https://stackoverflow.com/users/9355139/noctis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27962, "favorite_count": 1, "accepted_answer_id": 49895502, "answer_count": 1, "score": 4, "last_activity_date": 1619164564, "creation_date": 1524041379, "last_edit_date": 1525947869, "question_id": 49895205, "link": "https://stackoverflow.com/questions/49895205/bold-text-in-a-concatenate-formula", "title": "Bold text in a Concatenate formula", "body": "<p>I would like to be able to make one or two specific words bold in my sentence when using a concatenate formula. An example is shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tyigW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tyigW.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The first sentence is using the concatenate formula. The second sentence is manually typed and formatted. Is there a way to have this formatting in the concatenate formula without having to do it manually every time?</p>\n\n<p>Please note that this is just an example and I may need to use it to make a string of three consecutive words bold in a different sentence. If a general rule was provided that I can work with going forwards that would be great!</p>\n\n<p>I am somewhat proficient with formulae but have never used VBA. However I suspect the solution for this problem may only be available using VBA. Please be considerate if a VBA solution is required as it'll take some time and effort for me to start-up and understand.</p>\n\n<p>Thanks for your time and help.</p>\n\n<p>Edit:</p>\n\n<pre><code>Public Sub ExampleConcatenate()\n    Dim str1 As String, str2 As String, str3 As String, str4 As String, str5 As String, str6 As String\n    str1 = \"First string \"\n    str2 = \"Second string \"\n    str3 = \"Third string\"\n    str4 = \"Fourth string \"\n    str5 = \"Fifth string \"\n    str6 = \"Sixth string\"\n\n\n    Range(\"A1\").Value = str1 &amp; str2 &amp; str3 &amp; str4 &amp; str5 &amp; str6 'concatenate strings\n\n    'format bold starts 1 character after str1 and is as long as str2\n    Range(\"A1\").Characters(Start:=Len(str1) + 1, Length:=Len(str2)).Font.Bold = True\nEnd Sub\n</code></pre>\n\n<p>How would I further extend the final part to make the fourth and sixth strings bold?</p>\n"}, {"tags": ["vba", "activex", "lotus-notes", "32bit-64bit", "lotus-domino"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1524046580, "post_id": 49895099, "comment_id": 86809493, "body": "Some components can be fixed by loading into a surrogate process, <a href=\"http://exceldevelopmentplatform.blogspot.com/2018/04/com-windows-wow3264-add-extra-isolation.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2018/04/&hellip;</a> .  I&#39;m not sure Lotus Notes will co-operate.."}, {"owner": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1524128622, "post_id": 49895099, "comment_id": 86849178, "body": "Thank you for your help but I didn&#39;t understand how to perform it"}, {"owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "edited": false, "score": 1, "creation_date": 1524157798, "post_id": 49895099, "comment_id": 86869172, "body": "Did you search and find this previous question? <a href=\"https://stackoverflow.com/questions/38655598/lotus-domino-on-64-bit-system-could-not-create-automation-object-error-208\" title=\"lotus domino on 64 bit system could not create automation object error 208\">stackoverflow.com/questions/38655598/&hellip;</a>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "edited": false, "score": 0, "creation_date": 1524158162, "post_id": 49895099, "comment_id": 86869358, "body": "@RichardSchwartz: very good."}, {"owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "edited": false, "score": 0, "creation_date": 1524158173, "post_id": 49895099, "comment_id": 86869365, "body": "Also, you should be aware that even though it is possible to make the Notes/Domino COM classes (mostly) work on a 64 bit system, IBM does not officially support them.  <a href=\"http://www-01.ibm.com/support/docview.wss?uid=swg21454291\" rel=\"nofollow noreferrer\">www-01.ibm.com/support/docview.wss?uid=swg21454291</a>"}, {"owner": {"reputation": 13430, "user_id": 622571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41523c6db74e0f187eae731a6871a320?s=128&d=identicon&r=PG", "display_name": "Richard Schwartz", "link": "https://stackoverflow.com/users/622571/richard-schwartz"}, "edited": false, "score": 0, "creation_date": 1524158478, "post_id": 49895099, "comment_id": 86869527, "body": "Actually, my link to a previous question was not right. That was referring to calling COM classes from a user-created DLL, not to calling the Lotus classes. My mistake. I&#39;m sure there&#39;s been a previous question here in StackOverflow regarding getting nlsxbe.dll registered on a 64 bit server.  This gives the command, but it&#39;s the same one that Takichiii says he already tried: <a href=\"https://stackoverflow.com/questions/31322360/cant-create-lotus-notes-objects/31323051#31323051\" title=\"cant create lotus notes objects\">stackoverflow.com/questions/31322360/&hellip;</a>"}], "owner": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1173, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1524066809, "creation_date": 1524041092, "last_edit_date": 1524066809, "question_id": 49895099, "link": "https://stackoverflow.com/questions/49895099/activex-component-cant-create-object-when-creating-lotus-notessession-in-vba-64", "title": "ActiveX component can&#39;t create object when creating Lotus.NotesSession in VBA 64-bits", "body": "<pre><code>Sub Macro()\n    Dim Session As NotesSession\n    Set Session = CreateObject(\"Lotus.NotesSession\")\nEnd Sub\n</code></pre>\n\n<p>In Excel 32-bits it throws no error.</p>\n\n<p>But in Excel 64-bits, it throws this error :</p>\n\n<blockquote>\n  <p>Run-time error '429': ActiveX component can't create object</p>\n</blockquote>\n\n<p>I think the reason is that <code>Lotus Domino Objects</code> library is <code>32-bit</code> (as <code>Lotus</code> itself is a 32-bits app), thus the object <code>NotesSession</code> cannot be created on an <code>Excel 64-bits</code>. </p>\n\n<p>I tried registering the ActiveX component by running <code>regsvr32</code> on <code>c:\\notes\\nlsxbe.dll</code> then <code>C:\\Notes\\notesw32.reg</code> in a command prompt. It registered the DLL successfully but still didn\u2019t solve the issue.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 3234, "user_id": 6783663, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/49ZOh.png?s=128&g=1", "display_name": "Paul Karam", "link": "https://stackoverflow.com/users/6783663/paul-karam"}, "edited": false, "score": 0, "creation_date": 1524041177, "post_id": 49895090, "comment_id": 86805575, "body": "The problem could be that 150 and 3 are being treated as strings. Therefor 3 &gt; 1. So just cast them to Integer before comparing."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 3234, "user_id": 6783663, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/49ZOh.png?s=128&g=1", "display_name": "Paul Karam", "link": "https://stackoverflow.com/users/6783663/paul-karam"}, "edited": false, "score": 0, "creation_date": 1524041199, "post_id": 49895090, "comment_id": 86805582, "body": "@PaulKaram : excellent."}, {"owner": {"reputation": 3, "user_id": 7640159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S9Wua.jpg?s=128&g=1", "display_name": "Patrick Sch&#246;pfer", "link": "https://stackoverflow.com/users/7640159/patrick-sch%c3%b6pfer"}, "reply_to_user": {"reputation": 3234, "user_id": 6783663, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/49ZOh.png?s=128&g=1", "display_name": "Paul Karam", "link": "https://stackoverflow.com/users/6783663/paul-karam"}, "edited": false, "score": 0, "creation_date": 1524041408, "post_id": 49895090, "comment_id": 86805722, "body": "@PaulKaram Thanks for the answer. For everybody who doesnt know that: Val() function is for change a string Value to Integer  <code>Val(StringArray(1,5))</code>"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1524041564, "post_id": 49895090, "comment_id": 86805826, "body": "@PatrickSch&#246;pfer <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7640159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S9Wua.jpg?s=128&g=1", "display_name": "Patrick Sch&#246;pfer", "link": "https://stackoverflow.com/users/7640159/patrick-sch%c3%b6pfer"}, "edited": false, "score": 0, "creation_date": 1524041840, "post_id": 49895213, "comment_id": 86806012, "body": "Thanks. Val() does the same as i know"}, {"owner": {"reputation": 3234, "user_id": 6783663, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/49ZOh.png?s=128&g=1", "display_name": "Paul Karam", "link": "https://stackoverflow.com/users/6783663/paul-karam"}, "reply_to_user": {"reputation": 3, "user_id": 7640159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S9Wua.jpg?s=128&g=1", "display_name": "Patrick Sch&#246;pfer", "link": "https://stackoverflow.com/users/7640159/patrick-sch%c3%b6pfer"}, "edited": false, "score": 0, "creation_date": 1524041915, "post_id": 49895213, "comment_id": 86806067, "body": "@PatrickSch&#246;pfer Yeah it does the same and more. I included three links of other ways as well."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1524044651, "post_id": 49895213, "comment_id": 86808054, "body": "<code>Convert.toInt32</code> and the &quot;many other ways&quot; link are non-VBA related. This is <code>.Net</code>"}, {"owner": {"reputation": 3234, "user_id": 6783663, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/49ZOh.png?s=128&g=1", "display_name": "Paul Karam", "link": "https://stackoverflow.com/users/6783663/paul-karam"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1524049190, "post_id": 49895213, "comment_id": 86811309, "body": "@Vityata Good point. I usually don&#39;t follow <code>VBA</code> so thing question must have been tagged with <code>VB.NET</code> before being edited. Anyways, I fixed that."}], "tags": [], "owner": {"reputation": 3234, "user_id": 6783663, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/49ZOh.png?s=128&g=1", "display_name": "Paul Karam", "link": "https://stackoverflow.com/users/6783663/paul-karam"}, "is_accepted": true, "score": 2, "last_activity_date": 1524049162, "last_edit_date": 1524049162, "creation_date": 1524041388, "answer_id": 49895213, "question_id": 49895090, "link": "https://stackoverflow.com/questions/49895090/compare-string-arrays-vba/49895213#49895213", "title": "Compare String Arrays VBA", "body": "<p>As you stated, your array type is <code>String</code>.<br>\nWhen you're comparing <code>StringArray(1,5)</code> to <code>StringArray(1,6)</code>, you are actually comparing strings.  </p>\n\n<p>In your case, you are comparing <code>150</code> to <code>3</code> <strong>as strings</strong>. Hence the result is false, because \"3\" is > \"1\" and not vice verca.</p>\n\n<p>In order to have it compare them as integers, you need to cast them to integers before. Like this:  </p>\n\n<pre><code>If Val(StringArray(1, 5)) &gt; Val(StringArray(1, 6))\n</code></pre>\n\n<p>There's other ways such as: <a href=\"https://powerspreadsheets.com/vba-string-to-number/#2-Convert-String-to-Integer\" rel=\"nofollow noreferrer\">CInt</a>.</p>\n"}], "owner": {"reputation": 3, "user_id": 7640159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S9Wua.jpg?s=128&g=1", "display_name": "Patrick Sch&#246;pfer", "link": "https://stackoverflow.com/users/7640159/patrick-sch%c3%b6pfer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 49895213, "answer_count": 1, "score": 0, "last_activity_date": 1524049162, "creation_date": 1524041071, "last_edit_date": 1524041652, "question_id": 49895090, "link": "https://stackoverflow.com/questions/49895090/compare-string-arrays-vba", "title": "Compare String Arrays VBA", "body": "<p>I have a 2 dimensional string array. In the string array are some strings and some integer numbers. I want to compare two positions of the array together.</p>\n\n<p>Example:</p>\n\n<pre><code>If StringArray(1, 5) &gt; StringArray(1, 6) Then\n    MsgBox \"Is first number is bigger\"   \nEnd if\n</code></pre>\n\n<p>My Debugger says: </p>\n\n<pre><code>StringArray(1,5) = 150\nStringArray(1,6) = 3 \nStringArray(1, 5) &gt; StringArray(1, 6) = False\n</code></pre>\n\n<p>Does someone have an idea, why the Result is false? <code>StringArray(1, 5</code>) is definitely bigger. What could be the problem? Does it have something to do with the array type and how can i change that without creating a new integer array just for 2 Values?</p>\n"}, {"tags": ["ms-access", "vba", "connection-string"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1524041599, "post_id": 49895083, "comment_id": 86805841, "body": "Can you provide the error?"}, {"owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1524041798, "post_id": 49895083, "comment_id": 86805975, "body": "Just says <code>Overflow</code> nothing else which isn&#39;t much help at all."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1524437107, "post_id": 49895083, "comment_id": 86958672, "body": "Does it work with just <code>Data Source=SQL02;</code> - with no Failover Partner defined?"}, {"owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "edited": false, "score": 0, "creation_date": 1524495817, "post_id": 49895083, "comment_id": 86984836, "body": "Yes without failover it works fine"}], "answers": [{"tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": false, "score": 0, "last_activity_date": 1524486306, "creation_date": 1524486306, "answer_id": 49981046, "question_id": 49895083, "link": "https://stackoverflow.com/questions/49895083/ms-access-ado-connection-string-with-failover-partner-option/49981046#49981046", "title": "MS Access ADO connection string with Failover Partner option", "body": "<p>I don't see the <code>Provider</code> being defined anywhere in your connection string. That is a general problem.</p>\n\n<p>I never used the failover options with ADO, but I'm pretty sure the old OLE DB Provider (<code>SQLOLEDB</code>) does not support them. Instead you should use the brand new <a href=\"https://docs.microsoft.com/en-us/sql/connect/oledb/oledb-driver-for-sql-server?view=sql-server-2017\" rel=\"nofollow noreferrer\"><code>Microsoft OLE DB Driver for SQL Server (msoledbsql)</code></a>.</p>\n"}], "owner": {"reputation": 806, "user_id": 2246365, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/CjPJT.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/2246365/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524486306, "creation_date": 1524041036, "last_edit_date": 1524070067, "question_id": 49895083, "link": "https://stackoverflow.com/questions/49895083/ms-access-ado-connection-string-with-failover-partner-option", "title": "MS Access ADO connection string with Failover Partner option", "body": "<p>Is it possible to use an ADO connection string in VBA Access with <code>failover partner</code> option included?</p>\n\n<p>My connection code looks something like this:</p>\n\n<pre><code>Public Function OpenADOConnection() As Boolean\nOn Error GoTo err_trap\n\n' Opens Global ADO Connection if it isnt already open.\n' Returns TRUE if connected\n\n          Dim boolState As Boolean\n\n    If gcnn Is Nothing Then\n          Set gcnn = New ADODB.Connection ' if the global has not been instantiated or has been destroyed\n      End If\n\n     If gcnn.state = adStateOpen Then\n         boolState = True ' already open, nothing else to do\n     Else\n         gcnn.ConnectionString = \"Data Source=SQL01;Failover Partner=SQL02;Initial Catalog=DBNAME;Integrated Security=True\"\n       gcnn.Open\n       If gcnn.state = adStateOpen Then\n           boolState = True\n       Else\n            boolState = False ' cannot open connection so return false\n       End If\n    End If\n\n    OpenADOConnection = boolState ' return the connection state\n\nexit_here:\n    Exit Function\n\nerr_trap:\n    OpenADOConnection = False\n    Call MsgBox(\"Unable to connect to the database. Please notify Database Administrator!\" &amp; vbCrLf &amp; _\n              \"(This error CANNOT be logged!\", vbCritical, \"ADO Connection Failed:\", \"\", 0)\n200       Resume exit_here\n\nEnd Function\n</code></pre>\n\n<p>Currently, it fails to open the connection so I'm not sure what I'm missing or even if it's possible to achieve this. </p>\n\n<p>Essentially I want the connection to automatically failover without user interference and knowledge.</p>\n"}, {"tags": ["excel", "excel-charts", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9620040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa09c52c51a831bc26e639d16c75309?s=128&d=identicon&r=PG&f=1", "display_name": "Kristianwalker1993", "link": "https://stackoverflow.com/users/9620040/kristianwalker1993"}, "is_accepted": false, "score": 0, "last_activity_date": 1524066078, "creation_date": 1524066078, "answer_id": 49903816, "question_id": 49894845, "link": "https://stackoverflow.com/questions/49894845/toggle-series-within-a-chart-using-vba/49903816#49903816", "title": "Toggle Series within a Chart using VBA", "body": "<p>Fixed this by replacing some code, if a bar chart is required use this:</p>\n\n<pre><code> With ActiveChart\n        .HasLegend = False\n        .HasLegend = True\n        For iSres = .SeriesCollection.Count To 1 Step -1\n            If ListBox1.Selected(iSres - 1) Then\n                .SeriesCollection(iSres).fill.Visible = msoTrue\n                .SeriesCollection(iSres).MarkerStyle = xlAutomatic\n            Else\n                .SeriesCollection(iSres).fill.Visible = msoFalse\n                .SeriesCollection(iSres).MarkerStyle = xlNone\n                .Legend.LegendEntries(iSres).Delete\n            End If\n        Next\n        .Deselect\n    End With\n    Unload Me\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1524360100, "creation_date": 1524360100, "answer_id": 49961688, "question_id": 49894845, "link": "https://stackoverflow.com/questions/49894845/toggle-series-within-a-chart-using-vba/49961688#49961688", "title": "Toggle Series within a Chart using VBA", "body": "<p>If you're using Excel 2013 or 2016, you can easily filter the series without VBA. Select the chart, and click on the lowest of the three \"skittles\" beside the chart. A filter fly-out appears with checkboxes for each series in the chart. Uncheck a box and click Apply to hide the series, then check it to make it appear again.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8xBWa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8xBWa.png\" alt=\"Filtering series in a chart\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 9620040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa09c52c51a831bc26e639d16c75309?s=128&d=identicon&r=PG&f=1", "display_name": "Kristianwalker1993", "link": "https://stackoverflow.com/users/9620040/kristianwalker1993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 286, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1524360100, "creation_date": 1524040254, "last_edit_date": 1531161705, "question_id": 49894845, "link": "https://stackoverflow.com/questions/49894845/toggle-series-within-a-chart-using-vba", "title": "Toggle Series within a Chart using VBA", "body": "<p>Good Morning people,</p>\n\n<p>I am looking to toggle a chart series using VBA and user-form to select specific series, I've had success with a line chart. However when I try to use a bar chart, it does not seem to update the data, only the legend.</p>\n\n<p>The VBA code I am using is:</p>\n\n<p>Module:</p>\n\n<pre><code>Option Explicit\nSub ChartContent() 'Excel VBA process to select the chart and show the userform.\nActiveSheet.ChartObjects.Select \nufChart.Show \n\nEnd Sub\n</code></pre>\n\n<p>Userform:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub cmdApply_Click()\n    Dim iSres As Integer\n    Application.ScreenUpdating = False\n\n    With ActiveChart\n        .HasLegend = False\n        .HasLegend = True\n        For iSres = .SeriesCollection.Count To 1 Step -1\n            If ListBox1.Selected(iSres - 1) Then\n                .SeriesCollection(iSres).Border.LineStyle = xlAutomatic\n                .SeriesCollection(iSres).MarkerStyle = xlAutomatic\n            Else\n                .SeriesCollection(iSres).Border.LineStyle = xlNone\n                .SeriesCollection(iSres).MarkerStyle = xlNone\n                .Legend.LegendEntries(iSres).Delete\n            End If\n        Next\n        .Deselect\n    End With\n    Unload Me\nEnd Sub\n\nPrivate Sub cmdCancel_Click()\n  Unload Me\nEnd Sub\n\nPrivate Sub ListBox1_Click()\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Dim iSres As Integer\n\n    With ActiveChart\n        For iSres = 1 To .SeriesCollection.Count\n            ListBox1.AddItem .SeriesCollection(iSres).Name\n            ListBox1.Selected(ListBox1.ListCount - 1) = Not (.SeriesCollection(iSres).Border.LineStyle = xlNone)\n        Next\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Would anyone have any suggestions on why this may be occurring and possible solutions so I could apply this VBA to a bar chart, I am not quite sure as to why its not updating with a bar chart.</p>\n\n<p>Many thanks,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1138, "user_id": 1770778, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6d871ac3e8253dcc4fe15b0d5707dd2a?s=128&d=identicon&r=PG", "display_name": "ffonz", "link": "https://stackoverflow.com/users/1770778/ffonz"}, "edited": false, "score": 0, "creation_date": 1524053611, "post_id": 49894726, "comment_id": 86814247, "body": "Maybe you can make use of Bookmarks in Word? Place bookmarks at the places where you want to paste your pictures and give the bookmark a name. Before you paste set the range to this bookmark and you get the right picture at the right spot."}, {"owner": {"reputation": 7, "user_id": 8300795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8aa6eedc3e07075461e085219838695?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/8300795/dibyendu"}, "reply_to_user": {"reputation": 1138, "user_id": 1770778, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6d871ac3e8253dcc4fe15b0d5707dd2a?s=128&d=identicon&r=PG", "display_name": "ffonz", "link": "https://stackoverflow.com/users/1770778/ffonz"}, "edited": false, "score": 0, "creation_date": 1524055272, "post_id": 49894726, "comment_id": 86815342, "body": "Can you give me a link to your description as an example....."}, {"owner": {"reputation": 1138, "user_id": 1770778, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6d871ac3e8253dcc4fe15b0d5707dd2a?s=128&d=identicon&r=PG", "display_name": "ffonz", "link": "https://stackoverflow.com/users/1770778/ffonz"}, "edited": false, "score": 0, "creation_date": 1524055897, "post_id": 49894726, "comment_id": 86815789, "body": "Here a link about <a href=\"https://support.office.com/en-us/article/add-or-delete-bookmarks-d13f4bab-fb76-4e09-9c3a-239e1a0c1568\" rel=\"nofollow noreferrer\">bookmarks</a> in Word. And <a href=\"https://stackoverflow.com/questions/2725550/how-to-jump-to-a-bookmark-in-word-vba-and-insert-text\">here</a> a stackoverflow question about using bookmarks with VBA."}, {"owner": {"reputation": 7, "user_id": 8300795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8aa6eedc3e07075461e085219838695?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/8300795/dibyendu"}, "reply_to_user": {"reputation": 1138, "user_id": 1770778, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/6d871ac3e8253dcc4fe15b0d5707dd2a?s=128&d=identicon&r=PG", "display_name": "ffonz", "link": "https://stackoverflow.com/users/1770778/ffonz"}, "edited": false, "score": 0, "creation_date": 1524337736, "post_id": 49894726, "comment_id": 86934947, "body": "Thank you very much..... I have solved the problem with bookmarks"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8300795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8aa6eedc3e07075461e085219838695?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/8300795/dibyendu"}, "edited": false, "score": 0, "creation_date": 1524055180, "post_id": 49895718, "comment_id": 86815286, "body": "Can you share your code, so that I can try to fit your code according to my conditions"}], "tags": [], "owner": {"reputation": 16, "user_id": 6262535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363f8b3162bccf79eb095b8600e3b9d5?s=128&d=identicon&r=PG&f=1", "display_name": "Dani M", "link": "https://stackoverflow.com/users/6262535/dani-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1524042814, "creation_date": 1524042814, "answer_id": 49895718, "question_id": 49894726, "link": "https://stackoverflow.com/questions/49894726/paste-table-picture-from-excel-to-word-to-specific-paragraph-and-page/49895718#49895718", "title": "Paste table picture from excel to word to specific paragraph and page", "body": "<p>I have a entire word file with excel inputs, but i made it the other way arround...</p>\n\n<p>On the world you can reference the picture from de excel file and the text you need, every time you open the word file it will update those inputs.</p>\n"}], "owner": {"reputation": 7, "user_id": 8300795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8aa6eedc3e07075461e085219838695?s=128&d=identicon&r=PG&f=1", "display_name": "dibyendu", "link": "https://stackoverflow.com/users/8300795/dibyendu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524042814, "creation_date": 1524039889, "last_edit_date": 1531161705, "question_id": 49894726, "link": "https://stackoverflow.com/questions/49894726/paste-table-picture-from-excel-to-word-to-specific-paragraph-and-page", "title": "Paste table picture from excel to word to specific paragraph and page", "body": "<p>The following excel vba code paste table as picture from excel to word file at the start location one after another as may times the code runs. Please some body help me with the code to past the table as picture in paragraph 9 and when it run second time and so on should able to paste in second page of paragraph 9 and so on.</p>\n\n<pre><code>Set objDoc = objWord.activedocument\nSet rng = objWord.Selection\n\nwb.Windows(1).View = xlNormalView\n\nwb.Worksheets(1).Range(Worksheets(1).UsedRange.Address).CopyPicture Appearance:=xlScreen, Format:=xlPicture\nrng.Paste\nrng.typeparagraph\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1525544534, "creation_date": 1525544534, "answer_id": 50192702, "question_id": 49894309, "link": "https://stackoverflow.com/questions/49894309/append-csv-sheets-to-excel-using-vb-script/50192702#50192702", "title": "append csv sheets to excel using vb script", "body": "<p>Can you just use VB to do the job, instead of VB?</p>\n\n<pre><code>' Merge data from multiple files into separate sheets\nSub R_AnalysisMerger2()\n    Dim WSA As Worksheet\n    Dim bookList As Workbook\n    Dim SelectedFiles As Variant\n    Dim NFile As Long\n    Dim FileName As String\n    Dim Ws As Worksheet, vDB As Variant, rngT As Range\n    Dim vFn, myFn As String\n\n    Application.ScreenUpdating = False\n\n    SelectedFiles = Application.GetOpenFilename(filefilter:=\"Excel Files (*.csv*), *.csv*\", MultiSelect:=True)\n    If IsEmpty(SelectedFiles) Then Exit Sub\n\n    For NFile = LBound(SelectedFiles) To UBound(SelectedFiles)\n        FileName = SelectedFiles(NFile)\n        vFn = Split(FileName, \"\\\")\n        myFn = vFn(UBound(vFn))\n        myFn = Replace(myFn, \".csv\", \"\")\n        Set bookList = Workbooks.Open(FileName, Format:=2)\n        Set WSA = bookList.Sheets(1)\n        vDB = WSA.UsedRange\n        bookList.Close (0)\n        Set Ws = Sheets.Add(after:=Sheets(Sheets.Count))\n        ActiveSheet.Name = myFn\n        Ws.Range(\"a1\").Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB\n    Next\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9589318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3af8f7400955fcf9f8a316550caa3da?s=128&d=identicon&r=PG&f=1", "display_name": "Rajat Chopra", "link": "https://stackoverflow.com/users/9589318/rajat-chopra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525544534, "creation_date": 1524038550, "last_edit_date": 1531161705, "question_id": 49894309, "link": "https://stackoverflow.com/questions/49894309/append-csv-sheets-to-excel-using-vb-script", "title": "append csv sheets to excel using vb script", "body": "<p>I am generating 7 csv files and 1 excel file : A.xls from my R code. I need to copy each csv file to A.xls as a separate sheet and append it to A.xls</p>\n"}, {"tags": ["vba", "sap-gui"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9662838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8db8972341261d7b120de4974e0741f?s=128&d=identicon&r=PG&f=1", "display_name": "Logan9Fingers", "link": "https://stackoverflow.com/users/9662838/logan9fingers"}, "edited": false, "score": 0, "creation_date": 1524043304, "post_id": 49894515, "comment_id": 86807034, "body": "Thanks so much for this. I will be sure to take you up on your kind offer of help for future queries as our current SAP implementation leaves a lot to be desired and I will no doubt be back."}, {"owner": {"reputation": 37, "user_id": 9662838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8db8972341261d7b120de4974e0741f?s=128&d=identicon&r=PG&f=1", "display_name": "Logan9Fingers", "link": "https://stackoverflow.com/users/9662838/logan9fingers"}, "edited": false, "score": 0, "creation_date": 1524049446, "post_id": 49894515, "comment_id": 86811482, "body": "Hi, when I implement this for some reason it does not select the whole row, when I run the script the cursor highlights the block next to the row (where you would click if you were to select it manually) with a dotted square outline but its as if it does not then &#39;click&#39; to select and highlight the actual row. The script then breaks at session.findById(&quot;wnd[0]/tbar[1]/btn[14]&quot;).press"}, {"owner": {"reputation": 363, "user_id": 8853275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eF7kmwnaDMo/AAAAAAAAAAI/AAAAAAAAD7w/BWrknx4Mvpc/photo.jpg?sz=128", "display_name": "Nelson Vides", "link": "https://stackoverflow.com/users/8853275/nelson-vides"}, "reply_to_user": {"reputation": 37, "user_id": 9662838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8db8972341261d7b120de4974e0741f?s=128&d=identicon&r=PG&f=1", "display_name": "Logan9Fingers", "link": "https://stackoverflow.com/users/9662838/logan9fingers"}, "edited": false, "score": 0, "creation_date": 1524050180, "post_id": 49894515, "comment_id": 86811959, "body": "@Logan9Fingers, I just checked how I had it exactly in my codebase, pretty much as I said, I just cleaned it a bit now. I think that maybe you also want to select a cell in particular, not just the row. There are functions in GuiGridView called &quot;SetCurrentCell&quot; and &quot;PressButton&quot; that both take as a parameter the row number and the column name (.ColumnOrder would also tell you the column names by the way), you can explore those maybe. What error do you get exactly at that line by the way?"}, {"owner": {"reputation": 37, "user_id": 9662838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8db8972341261d7b120de4974e0741f?s=128&d=identicon&r=PG&f=1", "display_name": "Logan9Fingers", "link": "https://stackoverflow.com/users/9662838/logan9fingers"}, "edited": false, "score": 0, "creation_date": 1524066746, "post_id": 49894515, "comment_id": 86823793, "body": "It works now. I don&#39;t know what I was doing wrong. Thanks for updating, much appreciated."}, {"owner": {"reputation": 37, "user_id": 9662838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8db8972341261d7b120de4974e0741f?s=128&d=identicon&r=PG&f=1", "display_name": "Logan9Fingers", "link": "https://stackoverflow.com/users/9662838/logan9fingers"}, "edited": false, "score": 0, "creation_date": 1525251854, "post_id": 49894515, "comment_id": 87279358, "body": "Please could you answer this question if you get chance? <a href=\"https://stackoverflow.com/questions/50130754/how-to-set-current-cell-on-sap-guicontainershell-in-c\" title=\"how to set current cell on sap guicontainershell in c\">stackoverflow.com/questions/50130754/&hellip;</a>"}, {"owner": {"reputation": 539, "user_id": 245764, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3960576e63d6f7c89728e8ee6ca7486?s=128&d=identicon&r=PG", "display_name": "Tathagat Verma", "link": "https://stackoverflow.com/users/245764/tathagat-verma"}, "edited": false, "score": 0, "creation_date": 1525724339, "post_id": 49894515, "comment_id": 87461056, "body": "Hello, I was using &quot;....CurrentCellRow&quot; to get the current row index of the grid; something like this., { session.findById(&quot;wnd[0]/usr/tabs........[1,session.findById&zwnj;&#8203;(&quot;wnd[0]/usr/tabs...&zwnj;&#8203;.&quot;).CurrentCellRow]&quot;&zwnj;&#8203;).text = &quot;..Some Value..&quot; }; but get the error - &quot;Object Doesn&#39;t support this property or method&quot;."}], "tags": [], "owner": {"reputation": 363, "user_id": 8853275, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eF7kmwnaDMo/AAAAAAAAAAI/AAAAAAAAD7w/BWrknx4Mvpc/photo.jpg?sz=128", "display_name": "Nelson Vides", "link": "https://stackoverflow.com/users/8853275/nelson-vides"}, "is_accepted": true, "score": 1, "last_activity_date": 1524049833, "last_edit_date": 1524049833, "creation_date": 1524039210, "answer_id": 49894515, "question_id": 49894098, "link": "https://stackoverflow.com/questions/49894098/how-to-select-current-row-in-sap-gui-grid-view-with-vba-macro/49894515#49894515", "title": "How to select current row in SAP GUI Grid View with VBA Macro?", "body": "<p>First of all I'd really recommend you add a reference to the native SAP library. Go to your VBA Editor, click Tools, then References, then Browse, and find this file: \"C:\\Program Files\\SAP\\FrontEnd\\SAPgui\\sapfewse.ocx\". Add it, and now you'll have types and libraries and coding for SAP will be a lot easier, safer, and slightly faster (Variant types in VBA impose a tiny overhead that in this case is totally unnecessary). Get familiar with this new library if you are going to do any SAP scripting more than once.</p>\n\n<p>Second, about this problem, what you have is a shell, of type <code>GuiShell</code>, which inherits from <code>GuiGridView</code>. <code>GuiGridView</code> looks like a table, a classic Excel-like set of rows and columns. In your transaction, is showing you a big list of orders, in which you go click the \"Find\" button, put the order you're looking for, and then close the Search Window. Back to your (Grid)Shell, this cell has been selected (Grid has properties <code>SelectedCells</code>, <code>SelectedRows</code>, <code>SelectedColumns</code> that get all set when you go find something), but then you go and modify the value of <code>SelectedRows</code> to a specific one.</p>\n\n<p>So yeah, upon find, a cell has been selected, so all you need is to query its row and then assign it where you need:</p>\n\n<pre><code>Dim numrRow As Long\nnumrRow = session.FindById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").CurrentCellRow\nsession.FindById(\"wnd[0]/usr/cntlGRID1/shellcont/shell\").SelectedRows = numrRow\n</code></pre>\n\n<p>where \"thisShell\" is however you do to find a reference to the Shell (<code>session.findByID(\"blabla\")</code> for example, but I'd advise to reduce all the findByID's, they're very slow and type-unsafe).</p>\n\n<p>If you need help about this SAP libraries, feel free to maybe make some new post and ping me on the comments about it.</p>\n"}], "owner": {"reputation": 37, "user_id": 9662838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8db8972341261d7b120de4974e0741f?s=128&d=identicon&r=PG&f=1", "display_name": "Logan9Fingers", "link": "https://stackoverflow.com/users/9662838/logan9fingers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7190, "favorite_count": 2, "accepted_answer_id": 49894515, "answer_count": 1, "score": 1, "last_activity_date": 1610052588, "creation_date": 1524037861, "last_edit_date": 1610052588, "question_id": 49894098, "link": "https://stackoverflow.com/questions/49894098/how-to-select-current-row-in-sap-gui-grid-view-with-vba-macro", "title": "How to select current row in SAP GUI Grid View with VBA Macro?", "body": "<p>I am trying to automate a repetitive task in the SAP GUI. I need to search for an order number, select the row that the order number is in and then click a button to complete the task. I have recorded a macro which gives me:</p>\n\n<pre><code>session.findById(\"wnd[0]\").maximize\nsession.findById(\"wnd[0]/usr/cntlCONTAINER/shellcont/shell\").pressToolbarButton \"&amp;FIND\"\nsession.findById(\"wnd[1]/usr/txtGS_SEARCH-VALUE\").text = \"4521305207\"\nsession.findById(\"wnd[1]/usr/txtGS_SEARCH-VALUE\").caretPosition = 10\nsession.findById(\"wnd[1]/tbar[0]/btn[0]\").press\nsession.findById(\"wnd[1]/tbar[0]/btn[12]\").press\nsession.findById(\"wnd[0]/usr/cntlCONTAINER/shellcont/shell\").currentCellColumn = \"\"\nsession.findById(\"wnd[0]/usr/cntlCONTAINER/shellcont/shell\").selectedRows = \"2894\"\nsession.findById(\"wnd[0]/tbar[1]/btn[14]\").press\nsession.findById(\"wnd[1]/usr/chk[1,6]\").selected = true\n</code></pre>\n\n<p>The line:</p>\n\n<pre><code>session.findById(\"wnd[1]/usr/txtGS_SEARCH-VALUE\").text = \"4521305207\"\n</code></pre>\n\n<p>Corresponds to the order I want to search, but if I change this value it still tries to process the same order that the macro was recorded on, I'm assuming because of the line:</p>\n\n<pre><code>session.findById(\"wnd[0]/usr/cntlCONTAINER/shellcont/shell\").selectedRows = \"2894\"\n</code></pre>\n\n<p>Does anyone know how I would go about finding the number of the row which corresponds to the outcome of the SEARCH-VALUE and then using that as the .selectedRows = \"\"?</p>\n"}, {"tags": ["vba", "date", "filtering", "rows"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1524038806, "creation_date": 1524038806, "answer_id": 49894388, "question_id": 49893800, "link": "https://stackoverflow.com/questions/49893800/filtering-rows-by-date-the-last-7-days/49894388#49894388", "title": "Filtering rows by date (The last 7 days)", "body": "<p>My answer will focus on the date test. I haven't looked at the other parts of your code.\nReplace </p>\n\n<pre><code>(xVal &gt;= Date - 7)\n</code></pre>\n\n<p>with</p>\n\n<pre><code>(xVal &gt;= Now - 7)\n</code></pre>\n\n<p>and you will get a step closer. There are some minor issues here, since Now will give you today's date with time, making the edge cases somewhat tricky. Also - have a look at the DateDiff function</p>\n"}], "owner": {"reputation": 5, "user_id": 9631381, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ahmet", "link": "https://stackoverflow.com/users/9631381/ahmet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524038806, "creation_date": 1524036948, "last_edit_date": 1524037032, "question_id": 49893800, "link": "https://stackoverflow.com/questions/49893800/filtering-rows-by-date-the-last-7-days", "title": "Filtering rows by date (The last 7 days)", "body": "<p>I want to filter the rows by date.</p>\n\n<p>I want to keep the rows dated today and one week before. </p>\n\n<p>I have modified below code from the other sources however does not work.</p>\n\n<p>My question is how to modify the code for 7 days or 15 days, and how can I simply drop the rows other than my filtering days in the same worksheet rather than copying to another sheet?\nI can see the problem is <code>If TypeName(xVal) = \"Date\" And (xVal &gt;= Date - 7) Then</code> but I cannot solve.</p>\n\n<p>Please check the code out below: </p>\n\n<pre><code>Sub CopyRowWithCurrentDate()\n\n    Dim xRgS As Range, xRgD As Range, xCell As Range\n    Dim I As Long, xCol As Long, J As Long\n    Dim xVal As Variant\n\n    On Error Resume Next\n\n    Set xRgS = Application.InputBox(\"Select the Date Column:\", \"Filter On Date\", Selection.Address, , , , , 8)\n\n    If xRgS Is Nothing Then Exit Sub\n    Set xRgD = Application.InputBox(\"Select a destination cell:\", \"Filter On Date\", , , , , , 8)\n\n    If xRgD Is Nothing Then Exit Sub\n    xCol = xRgS.Rows.Count\n    Set xRgS = xRgS(1)\n    Application.CutCopyMode = False\n\n    J = 0\n    For I = 1 To xCol\n        Set xCell = xRgS.Offset(I - 1, 0)\n        xVal = xCell.Value\n\n        If TypeName(xVal) = \"Date\" And (xVal &gt;= Date - 7) Then\n            xCell.EntireRow.Copy xRgD.Offset(J, 0)\n            J = J + 1\n        End If\n\n    Next\n\n    Application.CutCopyMode = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1524036172, "post_id": 49893528, "comment_id": 86802563, "body": "<i>&quot;There&#39;s no ID, <b>Tagname</b>, etc...&quot;</i> But there is. The tagname is <code>button</code>."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1524036247, "post_id": 49893528, "comment_id": 86802607, "body": "You can use <code>IE.Document.getElementsByTagName(&quot;button&quot;)(&lt;index_ID&gt;)</code>"}], "owner": {"reputation": 1, "user_id": 9662752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ffe09a8cf55f728c8b54aaff0d5359b?s=128&d=identicon&r=PG&f=1", "display_name": "Musikaman", "link": "https://stackoverflow.com/users/9662752/musikaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524036067, "creation_date": 1524036067, "question_id": 49893528, "link": "https://stackoverflow.com/questions/49893528/getelementby-what-address-a-webpage-button-in-vba", "title": "GetElementBy What? Address a webpage button in VBA", "body": "<p>I'm trying to suss out how I need to address this button on a webpage via VBA. </p>\n\n<pre><code>&lt;button type=\"button\" onclick=\"moveOptions(this.form['things'],this.form['selected_things']);\"&gt;Move Down&lt;/button&gt;\n</code></pre>\n\n<p>There's no ID, Tagname, etc which I would normally use. Alternatively if there was another way to trigger the onclick event independently that would work as well. It's one of those dual tables where values are in one table and you select and click to move to the other. I've already gotten the selection portion down.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1524036047, "post_id": 49893510, "comment_id": 86802497, "body": "&quot;<i>The code I have tried keeps throwing back errors</i>&quot; ... And what would those be?"}, {"owner": {"reputation": 11, "user_id": 9662704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c458f472d4bce0d101e2dd39ad4f0?s=128&d=identicon&r=PG&f=1", "display_name": "loudSquirrel", "link": "https://stackoverflow.com/users/9662704/loudsquirrel"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1524036341, "post_id": 49893510, "comment_id": 86802655, "body": "When .Column(0, &gt;ListCount......  is run I get:  Run-time error &#39;381&#39;: Could not set the Column property. Invalid property array index."}, {"owner": {"reputation": 11, "user_id": 9662704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c458f472d4bce0d101e2dd39ad4f0?s=128&d=identicon&r=PG&f=1", "display_name": "loudSquirrel", "link": "https://stackoverflow.com/users/9662704/loudsquirrel"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1524039118, "post_id": 49893510, "comment_id": 86804296, "body": "I am assuming the error is because I am referring to a .Column but giving a Column and Row reference within the brackets.  I just don&#39;t know how to get around this issue."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9662704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c458f472d4bce0d101e2dd39ad4f0?s=128&d=identicon&r=PG&f=1", "display_name": "loudSquirrel", "link": "https://stackoverflow.com/users/9662704/loudsquirrel"}, "edited": false, "score": 0, "creation_date": 1524041223, "post_id": 49894960, "comment_id": 86805600, "body": "Thanks AcsErno.  The ComboBox is empty as the code runs.  So surely .ListCount will address the fist entry on the ComboBox?  I have tried adding in the -1 but it does not change the error.  Tried +1 also, without success."}, {"owner": {"reputation": 11, "user_id": 9662704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c458f472d4bce0d101e2dd39ad4f0?s=128&d=identicon&r=PG&f=1", "display_name": "loudSquirrel", "link": "https://stackoverflow.com/users/9662704/loudsquirrel"}, "edited": false, "score": 0, "creation_date": 1524048274, "post_id": 49894960, "comment_id": 86810674, "body": "I am afraid those suggestions haven&#39;t helped me.  The first suggestion still throws up the same error.  I&#39;m not sure how to fill an array from my For loop at the moment, I will look into it.   I have also noticed that while debugging that if I hover over the problem line of code I get a tooltip of:  .Column(0, .ListCount) = &lt;Object variable or With block variable not set&gt;."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1524048751, "last_edit_date": 1524048751, "creation_date": 1524040627, "answer_id": 49894960, "question_id": 49893510, "link": "https://stackoverflow.com/questions/49893510/multicolumn-combobox-population/49894960#49894960", "title": "MultiColumn ComboBox population", "body": "<p>You should use </p>\n\n<pre><code>.Column(0, .ListCount - 1) = ws.Cells(x, 3)\n.Column(1, .ListCount - 1) = x\n</code></pre>\n\n<p>to address the last entry. This is becasue <code>.ListCount</code> returns the natural number of entries (0 if empty, 1 if 1 entry, etc), while <code>.Column()</code> behaves like 0 based arrays, so 1st entry is at <code>.Column(0,...)</code>.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>You can use <code>.AddItem</code> to add 1 more row to combobox and then fill the values one by one like this: </p>\n\n<pre><code>ComboBox.AddItem\nWith ComboBox\n    .Column(0, .ListCount - 1) = ws.Cells(x, 3)\n    .Column(1, .ListCount - 1) = x\nEnd With\n</code></pre>\n\n<p>Alternatively, you can fill an array with values and load it into the combobox in one step like this: </p>\n\n<pre><code>Dim cBuf(2, 0 to 2)\ncBuf(0, 0) = \"John\"\ncBuf(0, 1) = 1982\n...\nComboBox = cBuf\n</code></pre>\n\n<p>Read more here <a href=\"https://stackoverflow.com/questions/13371892/how-to-create-two-columns-lookup-combobox-in-excel-vba-userform\">enter link description here</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9662704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c458f472d4bce0d101e2dd39ad4f0?s=128&d=identicon&r=PG&f=1", "display_name": "loudSquirrel", "link": "https://stackoverflow.com/users/9662704/loudsquirrel"}, "is_accepted": false, "score": 0, "last_activity_date": 1524121482, "creation_date": 1524121482, "answer_id": 49914742, "question_id": 49893510, "link": "https://stackoverflow.com/questions/49893510/multicolumn-combobox-population/49914742#49914742", "title": "MultiColumn ComboBox population", "body": "<p>So big thanks to AcsErno.  The solution to my problem was to create a new entry (.AddItem) for the ComboBox then to assign values to each column of the new entry.  My code now reads as below and works as I wanted.</p>\n\n<pre><code>For x = 5 To i\n    If ws.Cells(x, 1) = \"\" And ws.Cells(x, 3) &lt;&gt; \"\" Then\n        With ComboBox\n            .AddItem\n            .Column(0, .ListCount - 1) = ws.Cells(x, 3)\n            .Column(1, .ListCount - 1) = x\n        End With\n     End If\nNext x\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9662704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/847c458f472d4bce0d101e2dd39ad4f0?s=128&d=identicon&r=PG&f=1", "display_name": "loudSquirrel", "link": "https://stackoverflow.com/users/9662704/loudsquirrel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1524121482, "creation_date": 1524035969, "last_edit_date": 1524036430, "question_id": 49893510, "link": "https://stackoverflow.com/questions/49893510/multicolumn-combobox-population", "title": "MultiColumn ComboBox population", "body": "<p>I am trying to populate a multi column combobox on a userform from data on a worksheet.  </p>\n\n<p>For a range of rows, if the first column is blank and the third column is not blank I want to store the third column value and row number into the combobox.  The code I have tried keeps throwing the error:</p>\n\n<blockquote>\n  <p>Run-time error '381': Could not set the Column property. Invalid property array index</p>\n</blockquote>\n\n<pre><code>For x = 5 To i\nIf ws.Cells(x, 1) = \"\" And ws.Cells(x, 3) &lt;&gt; \"\" Then\n    With ComboBox\n        .Column(0, .ListCount) = ws.Cells(x, 3)\n        .Column(1, .ListCount) = x\n    End With\nEnd If\nNext x\n</code></pre>\n\n<p>The combobox has had its column count set to 2 in properties.\nThanks in advance.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4293506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f63ddc11e18f5f34e7325d7c19092268?s=128&d=identicon&r=PG&f=1", "display_name": "Ergin", "link": "https://stackoverflow.com/users/4293506/ergin"}, "edited": false, "score": 0, "creation_date": 1524043698, "post_id": 49895218, "comment_id": 86807318, "body": "The macro saves messages as outlook message format successfully not text format as you claim. I see that it&#39;s extension is msg, not txt"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 23, "user_id": 4293506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f63ddc11e18f5f34e7325d7c19092268?s=128&d=identicon&r=PG&f=1", "display_name": "Ergin", "link": "https://stackoverflow.com/users/4293506/ergin"}, "edited": false, "score": 1, "creation_date": 1524045166, "post_id": 49895218, "comment_id": 86808473, "body": "@Ergin The extension has nothing to do with the format contained inside the file. So just because you name the extension <code>.msg</code> dosn&#39;t automatically make the format a Outlook message. Inside the file it can still be a text file. You can rename any extension but that never changes the format inside the file! What we can definitley say is that <code>olSaveAsMsg</code> does not exist as you can read in the documentation I linked. So use <code>Option Explicit</code> and you will see it."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 23, "user_id": 4293506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f63ddc11e18f5f34e7325d7c19092268?s=128&d=identicon&r=PG&f=1", "display_name": "Ergin", "link": "https://stackoverflow.com/users/4293506/ergin"}, "edited": false, "score": 1, "creation_date": 1524100492, "post_id": 49895218, "comment_id": 86838333, "body": "@Ergin PEH is correct, it should be <code>oMail.SaveAs sPath &amp; sName, olMsg</code>"}, {"owner": {"reputation": 23, "user_id": 4293506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f63ddc11e18f5f34e7325d7c19092268?s=128&d=identicon&r=PG&f=1", "display_name": "Ergin", "link": "https://stackoverflow.com/users/4293506/ergin"}, "edited": false, "score": 0, "creation_date": 1524129783, "post_id": 49895218, "comment_id": 86849959, "body": "Adding Option Explicit and correcting last code as oMail.SaveAs sPath &amp; sName, olMsg fixed my problem. Many thanks all of you for your kind assist."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1524041768, "last_edit_date": 1524041768, "creation_date": 1524041401, "answer_id": 49895218, "question_id": 49893493, "link": "https://stackoverflow.com/questions/49893493/outlook-macro-for-moving-message-to-hdd-works-but-opening-the-message-gives-erro/49895218#49895218", "title": "Outlook macro for moving message to HDD works but opening the message gives error", "body": "<p>I think <code>olSaveAsMsg</code> is wrong and because you didn't use <code>Option Explicit</code> you didn't see that. So I recommend to write <code>Option Explicit</code> at the top of your module. Then you will see that <code>olSaveAsMsg</code> is considered as variable and it is not declared.<br>\nIt should now throw an error <em>\"Variable is not defined\"</em>.</p>\n\n<p>Because the empty variable probably casts to <code>0</code> which means <code>olTXT</code> according to <a href=\"https://technet.microsoft.com/en-us/library/ff869250(v=office.14).aspx\" rel=\"nofollow noreferrer\">OlSaveAsType Enumeration</a>, it is very likely that your message is saved in text format, and therefore Outlook can not open it.</p>\n\n<p>So save it in the Outlook message format it should be </p>\n\n<ul>\n<li><code>olMSG</code> for <em>\"Outlook message format\"</em> or </li>\n<li><code>olMSGUnicode</code> for <em>\"Outlook Unicode message format\"</em>.</li>\n</ul>\n"}], "owner": {"reputation": 23, "user_id": 4293506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f63ddc11e18f5f34e7325d7c19092268?s=128&d=identicon&r=PG&f=1", "display_name": "Ergin", "link": "https://stackoverflow.com/users/4293506/ergin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 49895218, "answer_count": 1, "score": 1, "last_activity_date": 1593004182, "creation_date": 1524035927, "last_edit_date": 1593004182, "question_id": 49893493, "link": "https://stackoverflow.com/questions/49893493/outlook-macro-for-moving-message-to-hdd-works-but-opening-the-message-gives-erro", "title": "Outlook macro for moving message to HDD works but opening the message gives error", "body": "<p>I have an Outlook macro to move incoming message to HDD via Outlook rules and it works fine. </p>\n\n<p>But problem is when I open the message on HDD copied via macro, I get this error message </p>\n\n<blockquote>\n  <p><em>\"We can't open xxxxx. It's possible the file is already open, or you don't have permission to open it. To check your permissions, right-click the file folder, then click Properties.\"</em></p>\n</blockquote>\n\n<p>I checked my permissions and found no problem. I also closed Outlook and try to open the saved message but nothing changed, I still get same error message. </p>\n\n<p>How can we solve this error ?</p>\n\n<pre><code>Public Sub AutoSave(oMail As Outlook.MailItem)\n    Dim dtDate As Date\n    Dim sName As String\n    Dim sFile As String\n    Dim sExt As String\n\n    sPath = \"C:\\Users\\xxxuser\\Desktop\\\"\n    sExt = \".msg\"\n    sName = oMail.Subject\n    ReplaceCharsForFileName sName, \"_\"\n    dtDate = oMail.ReceivedTime\n    sName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, _\n    vbUseSystem) &amp; Format(dtDate, \"-hhnnss\", _\n    vbUseSystemDayOfWeek, vbUseSystem) &amp; \"-\" &amp; sName &amp; sExt\n\n    oMail.SaveAs sPath &amp; sName, olSaveAsMsg\n\nEnd Sub\n\nPublic Sub ReplaceCharsForFileName(sName As String, _\n    sChr As String _\n    )\n    sName = Replace(sName, \"/\", sChr)\n    sName = Replace(sName, \"\", sChr)\n    sName = Replace(sName, \"FW:\", sChr)\n    sName = Replace(sName, \"RE:\", sChr)\n    sName = Replace(sName, \":\", sChr)\n    sName = Replace(sName, \"?\", sChr)\n    sName = Replace(sName, Chr(34), sChr)\n    sName = Replace(sName, \"&lt;\", sChr)\n    sName = Replace(sName, \"&gt;\", sChr)\n    sName = Replace(sName, \"|\", sChr)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9484103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cade0815e149200c77ddfc2961496bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea M.", "link": "https://stackoverflow.com/users/9484103/andrea-m"}, "edited": false, "score": 0, "creation_date": 1524054997, "post_id": 49899038, "comment_id": 86815167, "body": "Ok thanks, I understand what you&#39;re meaning, yet if I try what you suggested (line 4), it gives me error (&quot;Expected: end of statement&quot;). I split the line in two, &quot;Dim ProjDate As DateTime&quot; and &quot;ProjDate = DateTime(StartDate.Year, StartDate.Month, StartDate.Day, 9, 0, 0, 0)&quot;, yet it tells me &quot;Automation type not supported in Visual Basic&quot;. I&#39;m using Excel 2010, I do not know if it can be the problem."}, {"owner": {"reputation": 301, "user_id": 6765719, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FXG4j.jpg?s=128&g=1", "display_name": "Eric Christoph", "link": "https://stackoverflow.com/users/6765719/eric-christoph"}, "reply_to_user": {"reputation": 17, "user_id": 9484103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cade0815e149200c77ddfc2961496bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea M.", "link": "https://stackoverflow.com/users/9484103/andrea-m"}, "edited": false, "score": 1, "creation_date": 1524148661, "post_id": 49899038, "comment_id": 86863390, "body": "See Rachel&#39;s answer below; she&#39;s better at this than I am."}], "tags": [], "owner": {"reputation": 301, "user_id": 6765719, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FXG4j.jpg?s=128&g=1", "display_name": "Eric Christoph", "link": "https://stackoverflow.com/users/6765719/eric-christoph"}, "is_accepted": false, "score": 0, "last_activity_date": 1524052657, "last_edit_date": 1524052657, "creation_date": 1524052327, "answer_id": 49899038, "question_id": 49893440, "link": "https://stackoverflow.com/questions/49893440/start-date-from-excel-to-ms-project-with-vba/49899038#49899038", "title": "Start Date from excel to ms project (with VBA)", "body": "<p>Why not just set the hour to 9:00am before setting the project start? This should help: <a href=\"http://how-to-set-only-time-part-of-a-datetime\" rel=\"nofollow noreferrer\">How to set only the time part of a datetime</a></p>\n\n<pre><code>Dim StartDate As Date\n\nStartDate = wbAs.Worksheets(i).Cells(j, 2).Value\nDim ProjDate As DateTime = New DateTime(StartDate.Year, StartDate.Month, StartDate.Day,9,0,0,0)\nprProject.Tasks(i).Start = ProjDate\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1524072355, "creation_date": 1524072355, "answer_id": 49905624, "question_id": 49893440, "link": "https://stackoverflow.com/questions/49893440/start-date-from-excel-to-ms-project-with-vba/49905624#49905624", "title": "Start Date from excel to ms project (with VBA)", "body": "<h2>Quick Answer</h2>\n\n<p>Add the missing hour portion to a date-only value to get the correct start date <strong>and time</strong> in Project:</p>\n\n<pre><code>prProject.Tasks(i).Start = StartDate + prProject.DefaultStartTime\n</code></pre>\n\n<h2>Long Answer</h2>\n\n<p>Dates always have a time component, but if not set explicitly it is 12:00 AM. Dates are actually numbers with the integer part representing the day and the fraction part representing the time. In VBA, today's date is 43208 (e.g. April 18, 2018 is the 43,208th day if you start at 1/1/1900).</p>\n\n<p>The value you wanted to enter was the date from Excel + 9:00 AM which is 9 \u00f7 24.</p>\n\n<p>While you can add 9 \u00f7 24, what you should do is to use the default start time set up in your schedule. Using that value will save you from having to update your code if the default start time changes (or differs in another schedule that you might run this macro  on).</p>\n"}], "owner": {"reputation": 17, "user_id": 9484103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cade0815e149200c77ddfc2961496bbb?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea M.", "link": "https://stackoverflow.com/users/9484103/andrea-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1151, "favorite_count": 0, "accepted_answer_id": 49905624, "answer_count": 2, "score": 0, "last_activity_date": 1524072355, "creation_date": 1524035751, "question_id": 49893440, "link": "https://stackoverflow.com/questions/49893440/start-date-from-excel-to-ms-project-with-vba", "title": "Start Date from excel to ms project (with VBA)", "body": "<p>I'm trying to transfer the data of a project from MS Excel to MS Project with VBA.</p>\n\n<p>The problem is that, as I'm doing it now, the starting hour of each task is set at 12:00 AM, which gives me problems on the evaluation of the EndDate (assuming that I operate with StartDate and Duration of each activity).</p>\n\n<pre><code>Dim StartDate As Date\n\nFor j = 1 To 10000\n    StartDate = wbAs.Worksheets(i).Cells(j, 2).Value\n    prProject.Tasks(i).Start = StartDate\n    i = i + 1\n</code></pre>\n\n<p>I did not copy the whole code since it is a bit long, I hope it is understandable. \nBasically, I cycle on each row of an Excel worksheet and I transfer in MS Project the StartDate of each activity, present in the 2nd column.</p>\n\n<p>Doing like that, I'm not able to pass the StartHour, while I'd like to tell MS Project that all the activities are starting at 09:00 AM.\nIs that possible?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1524034336, "last_edit_date": 1524034336, "creation_date": 1524033915, "answer_id": 49892925, "question_id": 49892629, "link": "https://stackoverflow.com/questions/49892629/vba-rename-sheets-based-on-inputbox-cell-value/49892925#49892925", "title": "VBA rename sheets based on Inputbox cell value", "body": "<p>This should work for you:</p>\n\n<pre><code>Sub RenameSheet()\n    Dim ws As Worksheet, CellID As Range\n    For Each ws In ThisWorkbook.Worksheets\n        Set CellID = Application.InputBox(\"Cell reference to label sheets\", Type:=8)\n        Set CellID = ws.Cells(CellID.Row, CellID.Column)\n        On Error Resume Next\n        ws.Name = CellID\n        On Error GoTo 0\n        If ws.Name &lt;&gt; CellID.Value Then\n            MsgBox ws.Name &amp; \" Was Not renamed, the suggested name was invalid\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>This code will set your range twice, because the inputbox assumes <code>ActiveSheet</code>, as there's no way to assign the worksheet name to your input range without typing it out.</p>\n\n<p>Therefore, once you type in the cell address, it will utilize the <code>.Row</code> and <code>.Column</code> properties of the inputrange of the activesheet, while assigning them to the correct worksheet since we didn't qualify the worksheet in <code>CellID.Row</code> and <code>CellID.Column</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9662483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3c9e6871fbbcc5f83a3dc9dd13ad47b?s=128&d=identicon&r=PG&f=1", "display_name": "MSurv", "link": "https://stackoverflow.com/users/9662483/msurv"}, "edited": false, "score": 0, "creation_date": 1524048878, "post_id": 49893362, "comment_id": 86811070, "body": "Thanks, this is a great help - I am very new to VBA and am self taught. Is there away that the input cell range is applied to all sheets rather than having to do so for each sheet. So if A3 is selected then all sheets are named on the value contained within A3 of the respective sheet."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 13, "user_id": 9662483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3c9e6871fbbcc5f83a3dc9dd13ad47b?s=128&d=identicon&r=PG&f=1", "display_name": "MSurv", "link": "https://stackoverflow.com/users/9662483/msurv"}, "edited": false, "score": 0, "creation_date": 1524055581, "post_id": 49893362, "comment_id": 86815543, "body": "@Mholyoake See my edit. I added the alternative solution, so you can investigate the difference. If this solved your question please mark it as solution."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1524055546, "last_edit_date": 1524055546, "creation_date": 1524035473, "answer_id": 49893362, "question_id": 49892629, "link": "https://stackoverflow.com/questions/49892629/vba-rename-sheets-based-on-inputbox-cell-value/49893362#49893362", "title": "VBA rename sheets based on Inputbox cell value", "body": "<p>I suggest the following changes.</p>\n\n<p>Also it would be a good idea to activate the current sheet so the user always automatically selects a cell on the correct sheet.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub RenameSheet()\n    Dim ws As Worksheet\n    For Each ws In Worksheets\n\n        ws.Activate 'so we automatically are on the correct sheet to select a range\n\n        Dim CellID As Range\n        Set CellID = Application.InputBox(\"Cell reference to label sheets\", Type:=8)\n\n        If CellID.Count &gt; 1 Then 'check how many cells were selected\n            MsgBox \"Please select only one cell!\", vbExclamation\n            Exit Sub\n        End If\n\n        If Len(CellID.Value) &gt; 0 Then\n            On Error Resume Next\n            ws.Name = CellID.Value\n            'catch the error\n            If Err.Number &lt;&gt; 0 Then MsgBox ws.Name &amp; \" Was Not renamed, the suggested name was invalid\"\n            On Error GoTo 0\n        Else\n            MsgBox ws.Name &amp; \" Was Not renamed, the suggested name was empty\"\n        End If\n    Next ws\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Alternative to select the address once and use the same address on every worksheet.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub RenameSheet()\n    Dim CellID As Range\n    Set CellID = Application.InputBox(\"Cell reference to label sheets\", Type:=8)\n\n    If CellID.Count &gt; 1 Then 'check how many cells were selected\n        MsgBox \"Please select only one cell!\", vbExclamation\n        Exit Sub\n    End If\n\n    Dim NameAddress As String\n    NameAddress = CellID.Address(External:=False)\n\n    Dim ws As Worksheet\n    For Each ws In Worksheets\n        If Len(ws.Range(NameAddress).Value) &gt; 0 Then\n            On Error Resume Next\n            ws.Name = ws.Range(NameAddress).Value\n            If Err.Number &lt;&gt; 0 Then MsgBox ws.Name &amp; \" Was Not renamed, the suggested name was invalid\"\n            On Error GoTo 0\n        Else\n            MsgBox ws.Name &amp; \" Was Not renamed, the suggested name was empty\"\n        End If\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9662483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3c9e6871fbbcc5f83a3dc9dd13ad47b?s=128&d=identicon&r=PG&f=1", "display_name": "MSurv", "link": "https://stackoverflow.com/users/9662483/msurv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 900, "favorite_count": 0, "accepted_answer_id": 49893362, "answer_count": 2, "score": 1, "last_activity_date": 1524055546, "creation_date": 1524032909, "last_edit_date": 1524032982, "question_id": 49892629, "link": "https://stackoverflow.com/questions/49892629/vba-rename-sheets-based-on-inputbox-cell-value", "title": "VBA rename sheets based on Inputbox cell value", "body": "<p>I would like to rename sheets based on the same cell within each sheet. When i run the macro rather than having the cell predefined I would like to use an input box to define what cell the sheets are to be named after. This is what I have so far- currently it works for only cell C8.</p>\n\n<pre><code>Sub RenameSheet()\nDim ws As Worksheet\nFor Each ws In Worksheets\n    On Error Resume Next\n    If Len(ws.Range(\"C8\")) &gt; 0 Then\n        ws.Name = ws.Range(\"C8\").Value\n    End If \n    On Error GoTo 0\n    If ws.Name &lt;&gt; ws.Range(\"C8\").Value Then\n        MsgBox ws.Name &amp; \" Was Not renamed, the suggested name was invalid\"\n    End If\nNext \nEnd Sub\n</code></pre>\n\n<p>I think this code would help but I cannot get it to run</p>\n\n<pre><code>Set CellID = Application.InputBox(\"Cell reference to label sheets\", Type:=8)\n</code></pre>\n\n<p>Anyone have help on this?</p>\n"}, {"tags": ["excel", "vba", "search", "replace", "named"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9662509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b98c55fb0c71319ae600cd0826ba7df2?s=128&d=identicon&r=PG&f=1", "display_name": "BobsYourUncle", "link": "https://stackoverflow.com/users/9662509/bobsyouruncle"}, "edited": false, "score": 0, "creation_date": 1524051933, "post_id": 49892893, "comment_id": 86813203, "body": "Thanks, but I don&#39;t think that&#39;ll do what I want. I need to search and replace a string within various named ranges, not the entire name."}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 3, "user_id": 9662509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b98c55fb0c71319ae600cd0826ba7df2?s=128&d=identicon&r=PG&f=1", "display_name": "BobsYourUncle", "link": "https://stackoverflow.com/users/9662509/bobsyouruncle"}, "edited": false, "score": 0, "creation_date": 1524170686, "post_id": 49892893, "comment_id": 86875860, "body": "@BobsYourUncle Did that sort it for you?"}, {"owner": {"reputation": 3, "user_id": 9662509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b98c55fb0c71319ae600cd0826ba7df2?s=128&d=identicon&r=PG&f=1", "display_name": "BobsYourUncle", "link": "https://stackoverflow.com/users/9662509/bobsyouruncle"}, "edited": false, "score": 0, "creation_date": 1524194129, "post_id": 49892893, "comment_id": 86882378, "body": "Yes! This worked perfectly! Thanks very much. This saved me hours of tedious work @jeffreyweir"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": true, "score": 0, "last_activity_date": 1524087625, "last_edit_date": 1524087625, "creation_date": 1524033814, "answer_id": 49892893, "question_id": 49892582, "link": "https://stackoverflow.com/questions/49892582/search-and-replace-within-named-ranges-vba-for-excel/49892893#49892893", "title": "Search and Replace within Named Ranges - VBA for Excel", "body": "<p>That should be as simple as iterating through your list of names to change and doing this:</p>\n\n<pre><code>ActiveWorkbook.Names(\"SomeName\").Name = \"SomeOtherName\"\n</code></pre>\n\n<p>Here's a routine that will do that for you:</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nSub ReplaceNamePart(vMapping As Variant)\nDim nm  As Name\nDim sOld As String\nDim sNew As String\nDim i As Long\n\n\nFor i = 1 To UBound(vMapping)\n    sOld = vMapping(i, 1)\n    sNew = vMapping(i, 2)\n    For Each nm In ActiveWorkbook.Names\n        If InStr(nm.Name, sOld) &gt; 1 Then nm.Name = Replace(nm.Name, sOld, sNew)\n    Next nm\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>...and here's how you would call it:</p>\n\n<pre><code>Sub ReplaceNamePart_Caller()\nDim v As Variant\n\nv = Range(\"NameChange\").ListObject.DataBodyRange\nReplaceNamePart v\nEnd Sub\n</code></pre>\n\n<p>That Caller sub requires you to put your name change mapping in an Excel Table like so:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kfcoI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kfcoI.png\" alt=\"enter image description here\"></a></p>\n\n<p>...and to name that Table NameChange:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HGy52.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HGy52.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's an example of how things look before you run the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LZMhn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LZMhn.png\" alt=\"enter image description here\"></a></p>\n\n<p>...and here's the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/E0DJr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E0DJr.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8608712"}, "is_accepted": false, "score": 0, "last_activity_date": 1524053716, "last_edit_date": 1524053716, "creation_date": 1524046088, "answer_id": 49896960, "question_id": 49892582, "link": "https://stackoverflow.com/questions/49892582/search-and-replace-within-named-ranges-vba-for-excel/49896960#49896960", "title": "Search and Replace within Named Ranges - VBA for Excel", "body": "<p>You can try something like this with inputboxes to enter strings to find and replace:</p>\n\n<pre><code>    Sub search_replace__string()\n\nDim nm\n\nFor Each nm In ActiveWorkbook.Names\nOn Error Resume Next\n\nIf nm.RefersToRange.Parent.Name &lt;&gt; ActiveSheet.Name Then GoTo thenextnamedrange\n\nMsgBox nm.Name\n\nWith ThisWorkbook.ActiveSheet.Range(nm.Name)\n\nDim i, j, FirstRow, FirstCol, LastRow, LastCol As Long\nDim SelText, RepText, myStr As String\n\nFirstRow = .Row\nFirstCol = .Column\nLastRow = .End(xlDown).Row\nLastCol = .End(xlToRight).Column\n\n SelText = InputBox(\"Enter String\", \"Search for...\")\n RepText = InputBox(\"Enter String\", \"Replace with...\")\n If SelText = \"\" Then\n MsgBox \"String not found\"\n Exit Sub\n End If\n For j = FirstCol To LastCol\n For i = FirstRow To LastRow\n If InStr(Cells(i, j), SelText) Then\n\n    myStr = Cells(i, j).Value\n    Cells(i, j).Value = Replace(myStr, SelText, RepText)\n\n End If\n Next\n Next\n\nEnd With\n\nthenextnamedrange:\nNext nm\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9662509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b98c55fb0c71319ae600cd0826ba7df2?s=128&d=identicon&r=PG&f=1", "display_name": "BobsYourUncle", "link": "https://stackoverflow.com/users/9662509/bobsyouruncle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1558, "favorite_count": 0, "accepted_answer_id": 49892893, "answer_count": 2, "score": 0, "last_activity_date": 1524087625, "creation_date": 1524032712, "question_id": 49892582, "link": "https://stackoverflow.com/questions/49892582/search-and-replace-within-named-ranges-vba-for-excel", "title": "Search and Replace within Named Ranges - VBA for Excel", "body": "<p>I have an Excel spreadsheet with about a hundred named ranges. I'd like to run a script to find certain strings within those named ranges and replace it with another string. The problem is about changing the names of named ranges while keeping the underlying cell references the same.</p>\n\n<p>The standard Excel Search and Replace function doesn't work on named ranges.</p>\n\n<p>For example: Named range = \"Turnover_Shop_ABC_2018\", and I want to replace the text \"Shop_ABC\" with \"Store_XYZ\". There are a few strings that I need to search and replace for but the macro doesn't need to be complicated: I don't mind running the script and manually updating the search strings each time.</p>\n\n<p>Any help very much appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1524423201, "post_id": 49892477, "comment_id": 86955062, "body": "Added a simple solution looping through a datafield array of the used range. Additionally, I show an alternative based on @Jon-Crowell&#39;s interesting approach."}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1534448248, "post_id": 49969357, "comment_id": 90720070, "body": "@Pherdindy, could you give my two approaches in my answer a try? I&#39;d appreciate if you marked it as accepted in case you found a helpful solution."}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1524421796, "creation_date": 1524421796, "answer_id": 49969357, "question_id": 49892477, "link": "https://stackoverflow.com/questions/49892477/how-to-count-hidden-filtered-out-rows-that-has-content-in-them-using-excel-vba/49969357#49969357", "title": "How to count hidden/filtered out rows that has content in them using excel VBA?", "body": "<p><strong>Loop through datafield array in used range</strong></p>\n\n<p>The solid <code>End(xlUp)</code> method fails with hidden rows, as there is nothing to move in the visible range. Therefore I'd simply try to loop through the used range starting in the last row of column B and check for values. </p>\n\n<p><strong>Hint:</strong> It's good practice to use a variant <strong>datafield Array</strong> (called <code>v</code> in the example code) as looping through ranges via VBA is slow.:</p>\n\n<p><strong>Example Code</strong></p>\n\n<pre><code>Sub FindLastRow()\nDim i As Long, Total_rows_Pick As Long\nDim ws As Worksheet, v As Variant\nSet ws = ThisWorkbook.Worksheets(\"Pick-ups\")\nv = ws.Range(\"B1:B\" &amp; ws.UsedRange.Rows.Count)  ' write data into 1-based 2-dim datafield array\nFor i = UBound(v) To 2 Step -1                  ' start search in last row of used range\n    If Len(v(i, 1) &amp; \"\") &lt;&gt; 0 Then              ' take first value\n       Exit For\n    End If\nNext i\ntotal_rows_pic = i                              ' last row with value\nMsgBox Total_rows_Pick\nEnd Sub\n</code></pre>\n\n<p><strong>Alternative solution via temporary sheet</strong></p>\n\n<p>Jon Crowell showed an alternative solution by copying the original data sheet to a <em>temporary</em> sheet; unhiding all rows there allows to use the original method to find the last row:</p>\n\n<pre><code>Sub FindLastRow2()\n' Modified source: https://stackoverflow.com/questions/14200392/finding-the-last-row-of-an-excel-spreadsheet-when-the-last-row-is-hidden\n' Thx:  Jon Crowell\n  Dim Total_rows_Pick As Long, ws As Worksheet\n  Set ws = ThisWorkbook.Worksheets(\"Pick-ups\")\n' copy original data to temporary sheet and unhide all rows\n  ws.Copy Before:=ws\n  With ActiveSheet                  ' &lt;&lt; temporary sheet only\n    ' [1]turn off autofiltering\n      If .AutoFilterMode Then .AutoFilterMode = False\n    ' [2] unhide all rows\n      .Columns(\"B:B\").EntireRow.Hidden = False\n    ' [3] get the last row there\n      Total_rows_Pick = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n    ' [4] delete the temporary sheet\n      Application.DisplayAlerts = False\n      .Delete\n      Application.DisplayAlerts = True\n  End With\n  MsgBox Total_rows_Pick\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1032, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524421796, "creation_date": 1524032318, "last_edit_date": 1531164843, "question_id": 49892477, "link": "https://stackoverflow.com/questions/49892477/how-to-count-hidden-filtered-out-rows-that-has-content-in-them-using-excel-vba", "title": "How to count hidden/filtered out rows that has content in them using excel VBA?", "body": "<p>The code below only shows the count of the visible rows, however, when the rows are filtered prior to running the code, it won't detect the hidden rows.</p>\n\n<pre><code>Total_rows_Pick = Workbooks(\"Job Production Monitoring.xlsm\").Worksheets(\"Pick-ups\").Range(\"B\" &amp; Rows.count).End(xlUp).Row\n</code></pre>\n\n<p>What should I do to get the equivalent code which includes detecting even hidden/filtered out rows that has text written in them?</p>\n\n<p>Example of my filtered worksheet is  (notice row 2 is filtered out):\n<a href=\"https://i.stack.imgur.com/JZjLM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JZjLM.png\" alt=\"Filtered Worksheet\"></a></p>\n\n<p>After running the line of code above,the locals window only count the headers, but not row 2.</p>\n\n<p>The screenshot of the variable as shown in the locals window:\n<a href=\"https://i.stack.imgur.com/3zArt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3zArt.png\" alt=\"Only header is counted\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1524030045, "post_id": 49891943, "comment_id": 86799421, "body": "Which line cause error?"}, {"owner": {"reputation": 11, "user_id": 9662318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c795b229e1ff76f5fb27ea9532402999?s=128&d=identicon&r=PG&f=1", "display_name": "John C", "link": "https://stackoverflow.com/users/9662318/john-c"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1524030201, "post_id": 49891943, "comment_id": 86799477, "body": "Month = Split(Me.TextBox1.Text, &quot;/&quot;)(1)  Is where the debug tool is pointing me, sorry"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1524030301, "post_id": 49891943, "comment_id": 86799506, "body": "What&#39;s the value of <code>Me.TextBox1.Text</code> ?  If it doesn&#39;t contain at least one &quot;/&quot; this line will fail."}, {"owner": {"reputation": 11, "user_id": 9662318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c795b229e1ff76f5fb27ea9532402999?s=128&d=identicon&r=PG&f=1", "display_name": "John C", "link": "https://stackoverflow.com/users/9662318/john-c"}, "edited": false, "score": 0, "creation_date": 1524030982, "post_id": 49891943, "comment_id": 86799788, "body": "Value of the textbox is a button selected date, userform macro enters it as dd-mm-yyyy, will add the code for this to the original post.   What has me most stumped is that the new and old versions of the files work perfectly on standard staff logins, only issue appears to be on our management accounts"}], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 0, "last_activity_date": 1524033152, "creation_date": 1524033152, "answer_id": 49892699, "question_id": 49891943, "link": "https://stackoverflow.com/questions/49891943/subscript-out-of-range-when-using-date-input-macro/49892699#49892699", "title": "Subscript out of range when using date input macro", "body": "<p>The documentation for <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">Format Function (Visual Basic for Applications)</a> states:</p>\n\n<blockquote>\n  <p><strong>User-Defined Date/Time Formats (Format Function)</strong> The following table\n  identifies characters you can use to create user-defined date/time\n  formats:</p>\n  \n  <p>( / ) <strong>Date separator</strong>. In some locales, other characters\n  may be used to represent the date separator. The date separator\n  separates the day, month, and year when date values are formatted. The\n  actual character used as the date separator in formatted output is\n  determined by your system settings.</p>\n</blockquote>\n\n<p>That means the <code>/</code> in format strings for dates is locale dependent. Example:</p>\n\n<pre><code>Dim s As String\ns = Format(Now(), \"d/mm/yyyy\")\nMsgBox s\n</code></pre>\n\n<p>in my German Excel results in <code>s</code> = <code>18.04.2018</code> today because in my German locale the dot <code>.</code> is the date separator.</p>\n\n<p>If you always wants the slash being the separator between day month and year in your date strings, then do using:</p>\n\n<pre><code>Dim s As String\ns = Format(Now(), \"d\\/mm\\/yyyy\")\nMsgBox s\n</code></pre>\n\n<p>There the backslash masks the slash not having special meaning as \"the date separator\" .</p>\n"}], "owner": {"reputation": 11, "user_id": 9662318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c795b229e1ff76f5fb27ea9532402999?s=128&d=identicon&r=PG&f=1", "display_name": "John C", "link": "https://stackoverflow.com/users/9662318/john-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524033152, "creation_date": 1524029901, "last_edit_date": 1524031088, "question_id": 49891943, "link": "https://stackoverflow.com/questions/49891943/subscript-out-of-range-when-using-date-input-macro", "title": "Subscript out of range when using date input macro", "body": "<p>Admittedly bit of a rookie/novice here but have successfully modified a fair bit of code in the past. Running a macro that brings up a UI box to enter date and client booking fields, previous editions of the file worked without issue, however since porting macros etc into a 2016 excel file, I now get this error on even previously working copies. Have tested and previous files work fine on all other logins/computers other than my own. </p>\n\n<p>Receiving Error 9, subscript out of range pointing to the following code, which reads off of a calendar generated on a hidden worksheet;</p>\n\n<p>Code is ;</p>\n\n<pre><code>'~~&gt; Ok Button\nPrivate Sub CommandButton53_Click()\n   BookedInDate = Me.TextBox1.Text\n\n   Dim Day As String\n   Dim Month As String\n   Dim Year As String\n\n   Day = Split(Me.TextBox1.Text, \"/\")(0)\n    Month = Split(Me.TextBox1.Text, \"/\")(1)\n     Year = Split(Me.TextBox1.Text, \"/\")(2)\n\n   BookedDate = DateSerial(Year, Month, Day)\n\n'   ActiveSheet.Range(\"BE\" &amp; cell.row).Value = Me.txtTimeIn.Text\n\n   varTimeIn = Replace(Me.txtTimeIn.Text, \".\", \":\")\n\n\n\n   'BookedDate = dateserial(me.TextBox1.\n   'WSLoc2.Close\n\n\n '  WSLoc2.Delete\n\n\n   Unload Me\n   End Sub\n</code></pre>\n\n<p>Absolutely wracking my brain trying to figure out mainly why I am now receiving this error on previously functional workbooks, any advice would be greatly appreciated. Debug tool is pointing me at</p>\n\n<pre><code>Month = Split(Me.TextBox1.Text, \"/\")(1)\n</code></pre>\n\n<p>Code that the split function references:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n Dim dat As Date\n    dat = DateAdd(\"m\", 1, DateSerial(Val(Format(CommandButton45.Caption, \"YYYY\")), Val(Format(CommandButton45.Caption, \"MM\")), 1))\n'    GenerateCal Format(Now(), \"dd/mm/yyyy\")\n    CommandButton45.Caption = Format(Now(), \"mmm - yyyy\")\n    Me.TextBox1.Text = Format(Now(), \"d/mm/yyyy\")\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "loops", "dynamic"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524026115, "post_id": 49891047, "comment_id": 86798079, "body": "<code>Dim ClosingPrice200Array as Variant</code> - just declare it as a Variant, not an array of variants"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9661955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c365306f1848878f38bed9bc5b63a?s=128&d=identicon&r=PG&f=1", "display_name": "user9661955", "link": "https://stackoverflow.com/users/9661955/user9661955"}, "edited": false, "score": 0, "creation_date": 1524094540, "post_id": 49891314, "comment_id": 86836902, "body": "Thank you both so much for your time. Just for my learning - to fully qualify all my objects you mean to tell excel exactly where the object (cells) are that I&#39;m trying to manipulate, so I&#39;ve omitted <code>Worksheets(&quot;Data processing&quot;)</code> and also omitted using the <code>With &#47; End With</code> statement. Clearly there is a reason I need to use a <code>With</code> statement instead of just saying <code>ClosingPrice200Array = Worksheets(&quot;Data processing&quot;).Range(.Cells(firstRow, 5), .Cells(lastRow, 5)).Value</code>, can you please advise why you used the <code>with</code> instead? Just so I don&#39;t make the same mistake again. Thank you again!"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 23, "user_id": 9661955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c365306f1848878f38bed9bc5b63a?s=128&d=identicon&r=PG&f=1", "display_name": "user9661955", "link": "https://stackoverflow.com/users/9661955/user9661955"}, "edited": false, "score": 0, "creation_date": 1524097874, "post_id": 49891314, "comment_id": 86837711, "body": "See my edit. Hope that helps! Also, if either of these two answers that you were provided solved your problem, don&#39;t forget to mark one as accepted to let others know that you no longer need assistance."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1524097817, "last_edit_date": 1524097817, "creation_date": 1524026468, "answer_id": 49891314, "question_id": 49891047, "link": "https://stackoverflow.com/questions/49891047/how-to-pass-values-to-array-then-loop-through-a-data-set/49891314#49891314", "title": "How to pass values to array then loop through a data set", "body": "<p>You need to qualify <em>all your objects</em> to your worksheet when setting the range for your array.</p>\n\n<p>So replace this line:</p>\n\n<pre><code>ClosingPrice200Array = Sheets(\"Data processing\").Range(Cells(FirstRow, 5), Cells(Lastrow, 5)).Value\n</code></pre>\n\n<p>With</p>\n\n<pre><code>With Worksheets(\"Data processing\")\n    ClosingPrice200Array = .Range(.Cells(firstRow, 5), .Cells(lastRow, 5)).Value\nEnd With\n</code></pre>\n\n<p>Also, ensure that you are declaring your array as type <strong>Variant</strong> as stated by <a href=\"https://stackoverflow.com/questions/49891047/how-to-pass-values-to-array-then-loop-through-a-data-set/49891314#comment86798079_49891047\">Tim William's comment</a>.</p>\n\n<hr>\n\n<p>Editing in response to <a href=\"https://stackoverflow.com/questions/49891047/how-to-pass-values-to-array-then-loop-through-a-data-set/49891314?noredirect=1#comment86836902_49891314\">OP's question</a>:</p>\n\n<blockquote>\n  <p>can you please advise why you used the with instead?</p>\n</blockquote>\n\n<p>You are <em>never required</em> to use a <code>With...End With</code> statement. This statement simply makes your code more readable and also can save some keystrokes.</p>\n\n<p>If you didn't use the with statement, you would have had to type out your <code>Worksheets(\"Data processing\")</code> three times in that line:</p>\n\n<ol>\n<li>Worksheets(\"Data processing\").Range()</li>\n<li>Worksheets(\"Data processing\").Cells(firstRow, 5)</li>\n<li>Worksheets(\"Data processing\").Cells(lastRow, 5)</li>\n</ol>\n\n<p>This would make it less readable with this being the outcome:</p>\n\n<pre><code>ClosingPrice200Array = Worksheets(\"Data processing\").Range(Worksheets(\"Data processing\").Cells(firstRow, 5), Worksheets(\"Data processing\").Cells(lastRow, 5)).Value\n</code></pre>\n\n<p>While the above works, it just makes sense <strong>not to type out <code>Worksheets(\"Data processing\")</code> three times</strong>, but instead use the with statement.</p>\n\n<p>The reason your code wasn't working is that you only qualified your <code>Range()</code> object to the worksheet, but not the <code>Cells()</code> objects within your <code>Range()</code>, which meant you were using the active sheet instead.</p>\n\n<p>You can qualify objects inside a with statement by using placing a period <code>.</code> in front of the child objects.</p>\n\n<p>Here's another example of using a With statement:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    .Range(\"A1\") = \"Blah\"\n    .Cells(1, 1) = \"Blah\"\n    .Range(\"F:F\").Clear\nEnd With\n</code></pre>\n\n<p>If you didn't use the with statement, you would have had to type the worksheet out three times:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"A1\") = \"Blah\"\nWorksheets(\"Sheet1\").Cells(1, 1) = \"Blah\"\nWorksheets(\"Sheet1\").Range(\"F:F\").Clear\n</code></pre>\n\n<p>So again, it's optional but useful. You just needed to qualify both of your <code>Cells()</code> objects to the worksheet.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 9661955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c365306f1848878f38bed9bc5b63a?s=128&d=identicon&r=PG&f=1", "display_name": "user9661955", "link": "https://stackoverflow.com/users/9661955/user9661955"}, "edited": false, "score": 0, "creation_date": 1524535039, "post_id": 49892795, "comment_id": 87001286, "body": "I tried to assign variables in the For loop and an operator - are there restrictions in loops?  <code>Dma200current = WorksheetFunction.Average(.Offset(CurrentRowOffset))                                  .Cells(.CurrentRowOffset - 1, 2).Value = YesterdaysOpen                 .Cells(.CurrentRowOffset - 1, 3).Value = YesterdaysHigh &#39;the above are to assign values to these variables on the current row                 .Cells(.Rows.Count).Offset(CurrentRowOffset, 5).Value = Dma200current                                  .Cells(.Rows.Count).Offset(CurrentRowOffset, 6).Value = DMASlopeCurrent</code>"}, {"owner": {"reputation": 23, "user_id": 9661955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c365306f1848878f38bed9bc5b63a?s=128&d=identicon&r=PG&f=1", "display_name": "user9661955", "link": "https://stackoverflow.com/users/9661955/user9661955"}, "edited": false, "score": 0, "creation_date": 1524535540, "post_id": 49892795, "comment_id": 87001378, "body": "the above variables have been declared as &#39;Double&#39; at the start of the sub as the same type as the Dma200current which i will compare them to. Can a loop only have one data type? Have tried declaring them all as &#39;Long&#39; but didn&#39;t see to work.   I am trying to compare yesterday&#39;s data to today, perform some operations and then assign the result to a variable, then assign the value of a cell on the spreadsheet to that variable (in some cases)."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1524033474, "creation_date": 1524033474, "answer_id": 49892795, "question_id": 49891047, "link": "https://stackoverflow.com/questions/49891047/how-to-pass-values-to-array-then-loop-through-a-data-set/49892795#49892795", "title": "How to pass values to array then loop through a data set", "body": "<p>you can directly use <code>WorksheetFunction.Average()</code> function and work with ranges:</p>\n\n<pre><code>Option Explicit\n\nSub Calculate200DMA()\n    Dim MovingAverageLength As Long, LastRow As Long\n    MovingAverageLength = Application.InputBox(\"Input Required\", \"Moving Average Length\", 200, , , , , 1)\n\n    Dim FirstRow As Long, CurrentRowOffset As Long, LastRowOffset As Long\n\n    FirstRow = 2\n    With Sheets(\"Data processing\")\n        LastRow = .Cells(.Rows.Count, 4).End(xlUp).Row\n        LastRowOffset = (LastRow - FirstRow + 1) - MovingAverageLength ' set the last offset from first row\n        With .Cells(FirstRow, 4).Resize(MovingAverageLength) ' reference the first range to sum\n            For CurrentRowOffset = 0 To LastRowOffset\n                .Cells(.Rows.Count).Offset(CurrentRowOffset, 6).Value = WorksheetFunction.Average(.Offset(CurrentRowOffset))\n            Next\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9661955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d40c365306f1848878f38bed9bc5b63a?s=128&d=identicon&r=PG&f=1", "display_name": "user9661955", "link": "https://stackoverflow.com/users/9661955/user9661955"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 49892795, "answer_count": 2, "score": 2, "last_activity_date": 1524097817, "creation_date": 1524024623, "last_edit_date": 1524025656, "question_id": 49891047, "link": "https://stackoverflow.com/questions/49891047/how-to-pass-values-to-array-then-loop-through-a-data-set", "title": "How to pass values to array then loop through a data set", "body": "<p>I'm trying to build a loop to sum 200 consecutive rows (or a number of rows determined from an input box) from Column E, then move the range down one cell and recalculate (loop) until it has gone through all the used cells in the named worksheet. </p>\n\n<p>the length/size of the Array is static for the purposes of the loop, it is requested from the user via an inputbox and is to remain the same until the loop is completed.</p>\n\n<p>So far I have completed the calculation once using static cell references eg. \"E2:E201\" shown below:</p>\n\n<pre><code>ClosingPrice200Array = Range(\"E2:E201\").Value\n</code></pre>\n\n<p>So i know the code can calculate the Sum of the range and divide by a variable.</p>\n\n<p>The problems I'm having include:</p>\n\n<ol>\n<li>I want to sum the next 200 consecutive rows from E3:E202, then E4:E203 etc all the way down to the last used row without naming every change of range. </li>\n</ol>\n\n<p>To do this I have declared row variables, confirmed I have counted the correct number of rows and attempted to pass the first range (E2:E201) to the named array using row variables however I am getting a \"Compile error: Can't assign to Array\" from my code:</p>\n\n<pre><code>Sub Calculate200DMA()\n\n    Dim Dma200current As Double\n    Dim SumLast200Days As Long\n    Dim MovingAverageLength As Integer\n    MovingAverageLength = Application.InputBox(\"Input Required\", \"Moving Average Length\", 200, , , , , 1)\n    Dim ClosingPrice200Array(MovingAverageLength) as Variant \n</code></pre>\n\n<p>'can't remember if an array size needs to be a constant but I can create other array variables to cater for that in need, so please advise if I cannot dynamically adjust the Array size each time it runs the macro.  </p>\n\n<pre><code>Dim FirstRow As Integer\nDim Lastrow As Integer\nDim CurrentRow As Integer\nDim NumberOfRows As Long\n\n'count number of rows to be used in the For loop\nSheets(\"Data processing\").Select\nNumberOfRows = ActiveSheet.UsedRange.Rows.Count\n\nFirstRow = 2\nCurrentRow = FirstRow + (MovingAverageLength - 1)\nLastrow = CurrentRow\n</code></pre>\n\n<p>'this is the row causing the compile error:</p>\n\n<pre><code>ClosingPrice200Array = Sheets(\"Data processing\").Range(Cells(FirstRow, 5), Cells(Lastrow, 5)).Value\n</code></pre>\n\n<p>'the rest seems to work correctly in terms of calculating the number i want:</p>\n\n<pre><code>SumLast200Days = Excel.WorksheetFunction.Sum(ClosingPrice200Array)\nDma200current = SumLast200Days / MovingAverageLength\nSheets(\"Data processing\").Cells(CurrentRow, 10).Value = Dma200current\n\n'then i want to increment to the For loop but i have not written the start nor end loop yet because not sure exactly how to write (have been googling how to populate the array first)\nFirstRow = FirstRow + 1\nLastrow = Lastrow + 1\nCurrentRow = CurrentRow + 1\n</code></pre>\n\n<ol start=\"2\">\n<li><p>Also the input box is not appearing to prompt input of the length (number of rows) for the range. This is my code for the input box:</p>\n\n<p><code>Dim MovingAverageLength As Integer\nMovingAverageLength = Application.InputBox(\"Input Required\", \"MovingAverageLength\", 200, , , , , 1)</code></p></li>\n</ol>\n\n<p>Thank you in advance for helping. Could not find exactly something which solved the problem in my google searches (here or elsewhere) so far.</p>\n\n<p>John</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1524028353, "post_id": 49891005, "comment_id": 86798778, "body": "One of the simplest methods is to place all your data into an array first, make changes there, then rewrite your array to the spreadsheet. This way you are not making numerous calls to your worksheet."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1524028608, "post_id": 49891005, "comment_id": 86798869, "body": "Also, while this wouldn&#39;t affect your performance, not sure why you need to <code>Set BaseWorkbook = ThisWorkbook</code>, as <code>ThisWorkbook</code> never changes - and it&#39;s the same amount of characters to type. Seems extremely redundant to me. It would make since to set your worksheet object instead."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6045600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f7f9edb85691a8459c2e13a3ad2362?s=128&d=identicon&r=PG&f=1", "display_name": "Hoang Manh Ha", "link": "https://stackoverflow.com/users/6045600/hoang-manh-ha"}, "edited": false, "score": 0, "creation_date": 1524034327, "post_id": 49892052, "comment_id": 86801537, "body": "Thanks for your reply.  As the original post.  Row i will run from top row to bottom row. Row J will run from row I to bottom row.  Is there any wrong here."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 21, "user_id": 6045600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f7f9edb85691a8459c2e13a3ad2362?s=128&d=identicon&r=PG&f=1", "display_name": "Hoang Manh Ha", "link": "https://stackoverflow.com/users/6045600/hoang-manh-ha"}, "edited": false, "score": 0, "creation_date": 1524034561, "post_id": 49892052, "comment_id": 86801654, "body": "Have you tried the code? Because it appears in your code the variable <code>j</code> was simply <code>i - 1</code>. Since this difference is constant, there is no need for another variable to track it."}, {"owner": {"reputation": 21, "user_id": 6045600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f7f9edb85691a8459c2e13a3ad2362?s=128&d=identicon&r=PG&f=1", "display_name": "Hoang Manh Ha", "link": "https://stackoverflow.com/users/6045600/hoang-manh-ha"}, "edited": false, "score": 0, "creation_date": 1524034998, "post_id": 49892052, "comment_id": 86801888, "body": "I have try your code.  Sorry.  Row I run from top to bottom. Row J run from top to Row I-1.  Anyway, thank for suggestion of using array."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1524030875, "last_edit_date": 1524030875, "creation_date": 1524030351, "answer_id": 49892052, "question_id": 49891005, "link": "https://stackoverflow.com/questions/49891005/how-to-quick-search-then-update-delete-row-if-found/49892052#49892052", "title": "How to quick search then update/delete row if found", "body": "<p>Keep in mind, in many cases deleting a lot of data in the worksheet can be \"expensive\", as in it may take a lot of processing power. This will likely be the most taxing portion of your code.</p>\n\n<p>I made some significant improvements to your code.<br>\nInstead of reading the cells directly from the worksheet, I've added the data to a multi dimensional array. We will compare values there instead.</p>\n\n<p>Also, do not delete your rows one at a time; instead, create a special range that tracks the rows to delete, then delete them all at once.</p>\n\n<p>Also, since you are no longer making countless read/writes to your worksheet, you no longer need to worry about the <code>ScreenUpdating</code> and <code>Calculation</code> properties of your application, so I removed those.</p>\n\n<p>Take a look at this, you should see some decent improvements:</p>\n\n<pre><code>Sub DeleteProjectDuplicate()\n\n    Dim wsProjectInfo As Worksheet  '&lt;-- No need to set ThisWorkbook, declare the ws instead\n    Set wsProjectInfo = ThisWorkbook.Worksheets(\"Project Info\")\n\n    Application.EnableEvents = False\n\n    Dim i As Long   '&lt;-- no need to use 'j'\n    Dim wsDataArr() As Variant, delRng As Range\n    wsDataArr = wsProjectInfo.UsedRange.Value   '&lt;-- move your data to an array\n\n    With wsProjectInfo\n        For i = 3 To UBound(wsDataArr) - 1\n            If wsDataArr(i, 10) = wsDataArr(i + 1, 10) Then\n                If delRng Is Nothing Then\n                    Set delRng = .Rows(i + 1)\n                Else\n                    Set delRng = Union(delRng, .Rows(i + 1))\n                End If\n                If wsDataArr(i + 1, 7) &gt; wsDataArr(i, 7) Then\n                    wsDataArr(i, 7) = wsDataArr(i + 1, 7)   '&lt;-- Write data to array, not ws\n                End If\n            End If\n        Next\n        .UsedRange = wsDataArr  '&lt;-- rewrite the worksheet with updated data\n    End With\n\n    If Not delRng Is Nothing Then delRng.Delete '&lt;-- Delete your rows all at once\n\n    MsgBox \"Complete\"\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6045600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f7f9edb85691a8459c2e13a3ad2362?s=128&d=identicon&r=PG&f=1", "display_name": "Hoang Manh Ha", "link": "https://stackoverflow.com/users/6045600/hoang-manh-ha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1524030875, "creation_date": 1524024332, "last_edit_date": 1524028375, "question_id": 49891005, "link": "https://stackoverflow.com/questions/49891005/how-to-quick-search-then-update-delete-row-if-found", "title": "How to quick search then update/delete row if found", "body": "<p>I am doing the code that.</p>\n\n<pre><code>Sub DeleteProjectDuplicate()\n    Dim BaseWorkbook As Workbook\n    Set BaseWorkbook = ThisWorkbook\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n    Dim i, j As Long\n    Dim needDelete As Boolean\n    i = 4\n        Do While BaseWorkbook.Sheets(\"Project Info\").Cells(i, 10).Value &lt;&gt; \"\"\n            needDelete = False\n                For j = 3 To i - 1\n                    If BaseWorkbook.Sheets(\"Project Info\").Cells(i, 10).Value = BaseWorkbook.Sheets(\"Project Info\").Cells(j, 10).Value Then\n                        needDelete = True\n\n                        If BaseWorkbook.Sheets(\"Project Info\").Cells(i, 7).Value &gt; BaseWorkbook.Sheets(\"Project Info\").Cells(j, 7).Value Then\n                            BaseWorkbook.Sheets(\"Project Info\").Cells(j, 7).Value = BaseWorkbook.Sheets(\"Project Info\").Cells(i, 7).Value\n                        End If\n                        Exit For\n                    End If\n                Next j\n                If needDelete Then\n                    BaseWorkbook.Worksheets(\"Project Info\").Rows(i).EntireRow.Delete\n                Else\n                    i = i + 1\n                End If\n        Loop\n    MsgBox (\"Complete\")\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>It work but for the large data it take longtime to process. How can I improve it for better.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 148, "user_id": 3077926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o1OUf.png?s=128&g=1", "display_name": "Calaris", "link": "https://stackoverflow.com/users/3077926/calaris"}, "is_accepted": true, "score": 0, "last_activity_date": 1524140996, "creation_date": 1524140996, "answer_id": 49921178, "question_id": 49890942, "link": "https://stackoverflow.com/questions/49890942/how-to-add-a-combo-box-on-a-navigation-forma-as-a-filter/49921178#49921178", "title": "How to add a combo box on a navigation forma as a filter", "body": "<p>You could add some VBA code to activate a filter on your subform(s). In my example I added a clickevent for an OK-button to apply the filter, but you could also make it an afterupdate event on your combobox:</p>\n\n<pre><code>Private Sub cmdOK_Click()\nIf IsNull(Me.cmbFilter) Then\n   Me.subfrmName1.Form.Filter = \"\"\n   Me.subfrmName2.Form.Filter = \"\"\n   Me.subfrmName1.Form.FilterOn = False\n   Me.subfrmName2.Form.FilterOn = False\nElse\n  Me.subfrmName1.Form.Filter = \"[State]='\" &amp; Me.cmbFilter.Value &amp; \"'\"\n  Me.subfrmName2.Form.Filter = \"[State]='\" &amp; Me.cmbFilter.Value &amp; \"'\"\n  Me.subfrmName1.Form.FilterOn = True\n  Me.subfrmName2.Form.FilterOn = True\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 49921178, "answer_count": 1, "score": 0, "last_activity_date": 1593973493, "creation_date": 1524023814, "last_edit_date": 1593973493, "question_id": 49890942, "link": "https://stackoverflow.com/questions/49890942/how-to-add-a-combo-box-on-a-navigation-forma-as-a-filter", "title": "How to add a combo box on a navigation forma as a filter", "body": "<p>I am fairly new to Access. </p>\n\n<p>I have two forms. I put these two forms into a navigation form with each form on a tab. now I want to have a combo box on the navigation form that will serve as a filter for both of the two forms inside the navigation form. the combo box will have the values coming from a field in another table. How do I do this. Thank you, and sorry I am fairly new to this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/58pZc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/58pZc.png\" alt=\"Sample image is shown\"></a></p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524022577, "post_id": 49890417, "comment_id": 86797164, "body": "You&#39;re copying the full columns A:AZ  - you can only ever paste that on row 1."}, {"owner": {"reputation": 93, "user_id": 4964842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fdfc008abebd148260dcb2a34d69d22?s=128&d=identicon&r=PG&f=1", "display_name": "Apis ", "link": "https://stackoverflow.com/users/4964842/apis"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524216085, "post_id": 49890417, "comment_id": 86892104, "body": "But the row was based on the iLast value. So it keeps changing every time it&#39;s looping. @TimWilliams"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524265395, "post_id": 49890417, "comment_id": 86918155, "body": "Yes but you were copying a whole column, so you can only paste that into a whole column (which starts at row 1...)"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 4964842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fdfc008abebd148260dcb2a34d69d22?s=128&d=identicon&r=PG&f=1", "display_name": "Apis ", "link": "https://stackoverflow.com/users/4964842/apis"}, "edited": false, "score": 0, "creation_date": 1524215699, "post_id": 49890964, "comment_id": 86891849, "body": "Thank you so much. Sorry for late response. Your method totally worked!!!"}], "tags": [], "owner": {"reputation": 586, "user_id": 9633414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a4ec5f0dbe53ee0a2153b37138b17?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/9633414/j-doe"}, "is_accepted": true, "score": 1, "last_activity_date": 1524024005, "creation_date": 1524024005, "answer_id": 49890964, "question_id": 49890417, "link": "https://stackoverflow.com/questions/49890417/copy-multiple-workbook-into-single-workbook-you-cannot-paste-here-because-the-c/49890964#49890964", "title": "Copy multiple workbook into single workbook &quot;you cannot paste here because the copy area vba&quot;", "body": "<p>If I understood correctly what you are trying to do, I suggest a slightly different approach in 1 go:</p>\n\n<pre><code>Sub Select_File_Click()\n    Dim Wb As Workbook: Set Wb = ThisWorkbook\n    Dim Sh1 As Worksheet: Set Sh1 = Wb.Sheets(\"Sheet1\")\n    Dim Sh2 As Worksheet: Set Sh2 = Wb.Sheets(\"Copy\")\n    Dim i As Integer, Cnt As Integer\n    Dim Wbt As Workbook\n\n    Sh1.Range(\"A:D\").ClearContents\n    Sh2.Cells.Clear\n    Cnt = 1\n\n    ' Open the file dialog\n    With Application.FileDialog(msoFileDialogFilePicker) 'Using a file picker instead of open\n        .AllowMultiSelect = True\n        .Filters.Clear\n        .Filters.Add \"comma-separated values\", \"*.csv\"\n        .InitialFileName = \"*.*\"\n        .InitialView = msoFileDialogViewDetails\n        .Show\n\n        For i = 1 To .SelectedItems.Count\n\n            'You dont actually need the 4 lines below if you only need to do the copy\n            ' Add Hyperlinks\n            Sh1.Cells(i, 3).Worksheet.Hyperlinks.Add Anchor:=Sh1.Cells(i, 3), Address:=.SelectedItems(i), TextToDisplay:=.SelectedItems(i)\n            ' Add file as formula\n            Sh1.Cells(i, 4).FormulaR1C1 = \"=TRIM(RIGHT(SUBSTITUTE(RC[-1],\"\"\\\"\",REPT(\"\" \"\",99)),99))\"\n\n            Set Wbt = Workbooks.Open(.SelectedItems(i))\n            Intersect(Wbt.Sheets(1).UsedRange, Wbt.Sheets(1).Columns(\"A:AZ\")).Copy Sh2.Range(\"A\" &amp; Cnt)\n            Cnt = Cnt + Intersect(Wbt.Sheets(1).UsedRange, Wbt.Sheets(1).Columns(\"A:AZ\")).Rows.Count\n            Wbt.Saved = True\n            Wbt.Close\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4964842, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2fdfc008abebd148260dcb2a34d69d22?s=128&d=identicon&r=PG&f=1", "display_name": "Apis ", "link": "https://stackoverflow.com/users/4964842/apis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 49890964, "answer_count": 1, "score": 1, "last_activity_date": 1524024005, "creation_date": 1524020120, "last_edit_date": 1524020351, "question_id": 49890417, "link": "https://stackoverflow.com/questions/49890417/copy-multiple-workbook-into-single-workbook-you-cannot-paste-here-because-the-c", "title": "Copy multiple workbook into single workbook &quot;you cannot paste here because the copy area vba&quot;", "body": "<p>I'm trying to open all the selected file using the <code>filedialog</code> method and then copy all the content inside the selected path to the current workbook. The first path file manage to copy all the content, when it come to the second one, the error:</p>\n\n<blockquote>\n  <p>\"you cannot paste here because the copy area, select just one cell in the paste area etc.\"</p>\n</blockquote>\n\n<p>Below is my code:</p>\n\n<pre><code>Sub Select_File_Click()\nDim lngCount As Long\n    Dim cl As Range\n    Dim c2 As Range\n    Dim ItemType As String\n\n    ThisWorkbook.Sheets(\"Sheet1\").Range(\"A:D\").ClearContents\n    Set cl = ActiveSheet.Cells(1, 3)\n    ' Open the file dialog\n    With Application.FileDialog(msoFileDialogOpen)\n        .AllowMultiSelect = True\n        .Filters.Clear\n        .Filters.Add \"comma-separated values\", \"*.csv\"\n        .InitialFileName = \"*\" &amp; ItemType &amp; \"*.*\"\n        .InitialView = msoFileDialogViewDetails\n        .Show\n        For lngCount = 1 To .SelectedItems.Count\n\n            ' Add Hyperlinks\n            cl.Worksheet.Hyperlinks.Add _\n            Anchor:=cl, Address:=.SelectedItems(lngCount), _\n                TextToDisplay:=.SelectedItems(lngCount)\n            ' Add file name\n            'cl.Offset(0, 1) = _\n            '    Mid(.SelectedItems(lngCount), InStrRev(.SelectedItems(lngCount), \"\\\") + 1)\n            ' Add file as formula\n            cl.Offset(0, 1).FormulaR1C1 = _\n                 \"=TRIM(RIGHT(SUBSTITUTE(RC[-1],\"\"\\\"\",REPT(\"\" \"\",99)),99))\"\n\n\n            Set cl = cl.Offset(1, 0)\n            Set c2 = cl.Offset(0, 1)\n        Next lngCount\n        Sheets(1).Cells(1, 1) = .SelectedItems.Count\n\nEnd With\nEnd Sub\n\nSub All_data_Click()\nDim Count As Integer\nDim iLast As Long\n\nThisWorkbook.Sheets(\"Copy\").Range(\"A1:AZ5000\").ClearContents\nCount = ThisWorkbook.Sheets(1).Cells(1, 1)\niLast = 1\n\nFor i = 1 To Count\npth = ThisWorkbook.Sheets(\"Sheet1\").Cells(i, 3).Value 'Select folder path\nSet LookupWB = Workbooks.Open(Filename:=pth)\nSet sourceColumn1 = ThisWorkbook.Sheets(\"Copy\")\nSet Source = ActiveWorkbook.Sheets(1)\nSet sourceColumn1 = Source.Columns(\"A:AZ\")\nSet targetColumn1 = ThisWorkbook.Worksheets(\"Copy\").Rows(iLast)\nsourceColumn1.Copy Destination:=targetColumn1   &lt;---Error Here: \niLast = iLast + sourceColumn1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>Is there any idea to solve this problem? I'm lost already.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1524019272, "post_id": 49890239, "comment_id": 86796405, "body": "<code>If appIE.document.getElementsByClassName(&quot;alert-block&quot;).length = 0 Then &#39;Do task 1</code>"}, {"owner": {"reputation": 21, "user_id": 6045600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f7f9edb85691a8459c2e13a3ad2362?s=128&d=identicon&r=PG&f=1", "display_name": "Hoang Manh Ha", "link": "https://stackoverflow.com/users/6045600/hoang-manh-ha"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1524019965, "post_id": 49890239, "comment_id": 86796558, "body": "Thanks. It work."}, {"owner": {"reputation": 21, "user_id": 6045600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f7f9edb85691a8459c2e13a3ad2362?s=128&d=identicon&r=PG&f=1", "display_name": "Hoang Manh Ha", "link": "https://stackoverflow.com/users/6045600/hoang-manh-ha"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1524080258, "post_id": 49890239, "comment_id": 86831290, "body": "Can you tell me the way to check if  getElementById(&quot;num-bids&quot;). Doesnot exist."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1524100923, "post_id": 49890239, "comment_id": 86838461, "body": "<code>If IsNull(appIE.document.getElementById(&quot;num-bids&quot;)) Then &#39;Do task 1</code>"}], "owner": {"reputation": 21, "user_id": 6045600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f7f9edb85691a8459c2e13a3ad2362?s=128&d=identicon&r=PG&f=1", "display_name": "Hoang Manh Ha", "link": "https://stackoverflow.com/users/6045600/hoang-manh-ha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 941, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524021356, "creation_date": 1524018709, "last_edit_date": 1524021356, "question_id": 49890239, "link": "https://stackoverflow.com/questions/49890239/how-to-detect-if-element-is-not-exist-in-vba", "title": "How to detect if element is not exist in VBA", "body": "<p>I am trying to scrapping the data from website.\nNormally the website doesnot have the class \"alert-block\" and I can get</p>\n\n<p>getElementById(\"project_status\").innerText\ngetElementById(\"num-bids\").innerText</p>\n\n<p>But for some reason someone delete something then it have \"alert-block\"</p>\n\n<p>So I Want to check</p>\n\n<p>I have try</p>\n\n<pre><code>If appIE.document.getElementsByClassName(\"alert-block\") Is Nothing Then '\n            'Do task 1.\n    else\n    'do task 2\n    enter code here\nEnd if\n</code></pre>\n\n<p>But I failed</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "edited": false, "score": 2, "creation_date": 1524031424, "post_id": 49890195, "comment_id": 86799964, "body": "<code>Cells(i, 5).TextToColumns</code> will distribute the Order Numbers column wise. You could then use <code>transpose</code> to distribute them to row i + 1."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9371924, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KeScTs-Fe7M/AAAAAAAAAAI/AAAAAAAAACw/3t_Uia_T3JA/photo.jpg?sz=128", "display_name": "Blackbutterfly", "link": "https://stackoverflow.com/users/9371924/blackbutterfly"}, "edited": false, "score": 0, "creation_date": 1524111969, "post_id": 49908362, "comment_id": 86841065, "body": "Hi,  There are chances that there will be more then one comma.  I tried copying and pasting the code it comes up with user defined type not defined referencing      dim order() as variable, cell as range"}, {"owner": {"reputation": 38, "user_id": 9169471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cecb8dda71233746d0f64bdcd55f9779?s=128&d=identicon&r=PG&f=1", "display_name": "mcflame", "link": "https://stackoverflow.com/users/9169471/mcflame"}, "reply_to_user": {"reputation": 45, "user_id": 9371924, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KeScTs-Fe7M/AAAAAAAAAAI/AAAAAAAAACw/3t_Uia_T3JA/photo.jpg?sz=128", "display_name": "Blackbutterfly", "link": "https://stackoverflow.com/users/9371924/blackbutterfly"}, "edited": false, "score": 0, "creation_date": 1524238756, "post_id": 49908362, "comment_id": 86906749, "body": "I just edited the code. Sorry about that! It should have said Variant instead of variable. Also added a few extra lines for completeness."}, {"owner": {"reputation": 45, "user_id": 9371924, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KeScTs-Fe7M/AAAAAAAAAAI/AAAAAAAAACw/3t_Uia_T3JA/photo.jpg?sz=128", "display_name": "Blackbutterfly", "link": "https://stackoverflow.com/users/9371924/blackbutterfly"}, "edited": false, "score": 0, "creation_date": 1524551870, "post_id": 49908362, "comment_id": 87006083, "body": "This has fixed the problem"}], "tags": [], "owner": {"reputation": 38, "user_id": 9169471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cecb8dda71233746d0f64bdcd55f9779?s=128&d=identicon&r=PG&f=1", "display_name": "mcflame", "link": "https://stackoverflow.com/users/9169471/mcflame"}, "is_accepted": true, "score": 0, "last_activity_date": 1524241380, "last_edit_date": 1524241380, "creation_date": 1524082702, "answer_id": 49908362, "question_id": 49890195, "link": "https://stackoverflow.com/questions/49890195/vba-copy-entire-row-deleting-all-text-to-the-right-of-the-first-comma-and-inser/49908362#49908362", "title": "VBA: Copy Entire Row Deleting All Text to the right of the first comma and insert it in the next Row", "body": "<p>If there is a chance of there being more than two commas in a cell, I would use an array. Does the column ever change? If not I would do something like this...</p>\n\n<pre><code>Sub comma()\n\nDim Order As Variant, cell As Range\nFor Each cell In Range(\"E:E\") 'Enter static column reference here\n    If cell.Value Like \"*,*\" Then\n        Order = Split(cell, \",\")\n        For i = LBound(Order) To UBound(Order)\n            If i = 0 Then\n            cell.Value = Order(i)\n        Else\n            cell.EntireRow.Copy\n            cell.EntireRow.Insert\n            Range(\"E\" &amp; cell.Row) = Trim(Order(i))\n        End If\n        Next i\n    Else\n    End If\nNext cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9371924, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KeScTs-Fe7M/AAAAAAAAAAI/AAAAAAAAACw/3t_Uia_T3JA/photo.jpg?sz=128", "display_name": "Blackbutterfly", "link": "https://stackoverflow.com/users/9371924/blackbutterfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 49908362, "answer_count": 1, "score": 0, "last_activity_date": 1593643257, "creation_date": 1524018293, "last_edit_date": 1593643257, "question_id": 49890195, "link": "https://stackoverflow.com/questions/49890195/vba-copy-entire-row-deleting-all-text-to-the-right-of-the-first-comma-and-inser", "title": "VBA: Copy Entire Row Deleting All Text to the right of the first comma and insert it in the next Row", "body": "<p>I am trying to create a Macro which will help me look for \",\" and if it finds it. It will copy the entire row without the first \",\" it sees and insert another row underneath.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cHrV8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cHrV8.png\" alt=\"enter image description here\"></a></p>\n\n<p>For example. 9877352, 9877354</p>\n\n<p>It will turn that one line into two lines with the same information.</p>\n\n<p>Only different is 9877352 will be on one row and then 9877354 will be in the following row in the same table.</p>\n\n<p>Code So Far:</p>\n\n<pre><code>Sub comma()\n    Dim i As Long\n    Dim text As String\n    Dim myCell As Range\n\n    FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 2 To FinalRow\n        thisvalue = Cells(i, 5).Value\n\n        If thisvalue Like \"*,*\" Then\n            Cells(i, 5).EntireRow.Copy\n\n            'I don't know what to put here\n\n            'Cells(i, 5).EntireRow.Insert\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1524084416, "post_id": 49889753, "comment_id": 86833449, "body": "Post your current code we maybe able to modify it to  outlook vba"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1524126379, "post_id": 49889753, "comment_id": 86847862, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/3166265/11683\">Open an html page in default browser with VBA?</a>"}, {"owner": {"reputation": 51, "user_id": 6879798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YCOSY.jpg?s=128&g=1", "display_name": "ImsorryDaveImafraidIcantdothat", "link": "https://stackoverflow.com/users/6879798/imsorrydaveimafraidicantdothat"}, "edited": false, "score": 0, "creation_date": 1524127581, "post_id": 49889753, "comment_id": 86848541, "body": "I tried using shell as the code in the article &quot;Open an html page in default browser with VBA?&quot;. Using shell doesn&#39;t do HTML encoding which FollowHyperlink does."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6879798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YCOSY.jpg?s=128&g=1", "display_name": "ImsorryDaveImafraidIcantdothat", "link": "https://stackoverflow.com/users/6879798/imsorrydaveimafraidicantdothat"}, "is_accepted": false, "score": 0, "last_activity_date": 1524730286, "creation_date": 1524730286, "answer_id": 50037984, "question_id": 49889753, "link": "https://stackoverflow.com/questions/49889753/is-there-any-method-equivalent-for-followhyperlink-in-outlook-vba/50037984#50037984", "title": "Is there any method equivalent for &quot;FollowHyperlink&quot; in Outlook VBA?", "body": "<p>I've decided to use Word.Application object and use \"FollowHyperlink\" from a Word object. It worked!</p>\n\n<p>Now I can Google translate emails in Germany to English as soon as I receive them. :-)</p>\n\n<pre><code>Public Sub ClipboardGoogleTranslate_2EN()\n\n    Dim wdApp As Word.Application\n\n    Set wdApp = CreateObject(\"Word.Application\")\n\n    wdApp.Run \"ClipboardGoogleTranslate_2EN\"\n\n    wdApp.Quit\n\n    Set wdApp = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6879798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YCOSY.jpg?s=128&g=1", "display_name": "ImsorryDaveImafraidIcantdothat", "link": "https://stackoverflow.com/users/6879798/imsorrydaveimafraidicantdothat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 936, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593004024, "creation_date": 1524014865, "last_edit_date": 1593004024, "question_id": 49889753, "link": "https://stackoverflow.com/questions/49889753/is-there-any-method-equivalent-for-followhyperlink-in-outlook-vba", "title": "Is there any method equivalent for &quot;FollowHyperlink&quot; in Outlook VBA?", "body": "<p>Is there any method in Outlook VBA equivalent to Excel's <code>FollowHyperlink</code>?</p>\n\n<p>I made an Excel VBA macro that posts the text in the clipboard to a specific site using <code>FollowHyperlink</code> method.</p>\n\n<p>I want to do the same thing with Outlook VBA but I couldn't find the method.</p>\n\n<p>Any method that does the same thing as simply as <code>FollowHyperlink</code> is quite fine.</p>\n\n<p>Here is the Excel VBA version of a function that post the content of the clipboard to Google translation. I want to make an Outlook version of this one.</p>\n\n<pre><code>Public Sub GoogleTranslate_2EN()\n    Dim clipBoard As New DataObject\n    With clipBoard\n    On Error Resume Next\n        .GetFromClipboard\n        Dim targetText As String\n        targetText = .GetText\n    On Error GoTo 0\n    End With\n\n    Dim URL As String\n    URL = \"https://translate.google.co.jp/?hl=en&amp;tab=wT#auto/en/\" &amp; targetText\n\n    ThisWorkbook.FollowHyperlink Address:=URL, newWindow:=False, AddHistory:=True\nEnd Sub\n</code></pre>\n"}, {"tags": ["json", "vba", "jscript"], "comments": [{"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1524039424, "post_id": 49889663, "comment_id": 86804498, "body": "VBA is a case insensitive language and the JScript  object <code>Issues</code> is case sensitive. Either use <code>CallByName(Issues, &quot;total&quot;, vbGet)</code> or use a <a href=\"https://gist.github.com/florentbr/12c90342af901b39350eaee6a72bed3d#file-1-jsonre-bas\" rel=\"nofollow noreferrer\">JSON parser</a>: <code>Issues(&quot;total&quot;)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9661552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a568f3f257d96d6b2c741544b454ad34?s=128&d=identicon&r=PG&f=1", "display_name": "pmeeks", "link": "https://stackoverflow.com/users/9661552/pmeeks"}, "edited": false, "score": 0, "creation_date": 1524066798, "post_id": 49891474, "comment_id": 86823826, "body": "Thanks for your reply.  This worked!  Does exactly what I need."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1524068516, "post_id": 49891474, "comment_id": 86824921, "body": "@omegastripes - thanks for the fix"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1524052151, "last_edit_date": 1524052151, "creation_date": 1524027476, "answer_id": 49891474, "question_id": 49889663, "link": "https://stackoverflow.com/questions/49889663/parsing-a-json-object-in-vba/49891474#49891474", "title": "Parsing a JSON Object in VBA", "body": "<p>Borrowing from the linked question, something like this should work:</p>\n\n<pre><code>'.... \nstrX = ObjHTTP.responsetext\nscriptControl.Eval(\"var o = (\" + strX + \");\")\nscriptControl.AddCode \"function getProp(propName) { return o[propName]; } \"\n\nWith Sheets(\"Test\")\n    .Cells(1, 1) = scriptControl.Run(\"getProp\", \"expand\")  \n    .Cells(1, 2) = scriptControl.Run(\"getProp\", \"startAt\")\n    .Cells(1, 3) = scriptControl.Run(\"getProp\", \"maxResults\")\n    .Cells(1, 4) = scriptControl.Run(\"getProp\", \"total\")\nEnd With\n</code></pre>\n\n<p>Having said that though, you should instead use this code: <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">https://github.com/VBA-tools/VBA-JSON</a></p>\n"}], "owner": {"reputation": 3, "user_id": 9661552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a568f3f257d96d6b2c741544b454ad34?s=128&d=identicon&r=PG&f=1", "display_name": "pmeeks", "link": "https://stackoverflow.com/users/9661552/pmeeks"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2242, "favorite_count": 0, "closed_date": 1524071853, "accepted_answer_id": 49891474, "answer_count": 1, "score": 0, "last_activity_date": 1524052151, "creation_date": 1524014142, "question_id": 49889663, "link": "https://stackoverflow.com/questions/49889663/parsing-a-json-object-in-vba", "closed_reason": "Duplicate", "title": "Parsing a JSON Object in VBA", "body": "<p>I am parsing a JSON object in VBA.  I found a code example on this forum that works great. However, one of the fields in the object is \"total\".  in my code, I am trying to get the total, but \"total\" is being switched to \"Total\".  I get an error 438 at runtime.  Here is the code snipit:</p>\n\n<pre><code>Dim Issues As Object\nDim scriptControl As Object\n\nSet scriptControl = CreateObject(\"MSScriptControl.ScriptControl\")\nscriptControl.Language = \"JScript\"\n\nSet ObjHTTP = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\nURL = \"http://&lt;url&gt;.com:10005/rest/api/2/search\"\n\nObjHTTP.Open \"POST\", URL, False\nObjHTTP.SetRequestHeader \"Authorization\", \"Basic &lt;userid / password&gt;\"\nObjHTTP.SetRequestHeader \"Content-Type\", \"application/json\"\n\n'Get the new work intake for the month.\nObjHTTP.send (\"{\"\"jql\"\":\"\"&lt;my query here&gt;\"\":[\"\"id\"\"],\"\"maxResults\"\":1}\")\nstrX = ObjHTTP.responsetext\nSet Issues = scriptControl.Eval(\"(\" + strX + \")\")\n\nWith Sheets(\"Test\")\n    .Cells(1, 1) = Issues.expand  --this works\n    .Cells(1, 2) = Issues.startAt --this works\n    .Cells(1, 3) = Issues.maxResults -- this works\n    .Cells(1, 4) = Issues.Total  -- JSON object is \"total\"  editor keeps switching to \"Total\"\nEnd With\n</code></pre>\n\n<p>\nDoes anyone know why I cannot use Issues.total?</p>\n"}]